import{d as D,i as U,j as e,r,u as A}from"./index-D4vNMbjC.js";import{H as R}from"./Header-pR_-c_0r.js";import{a as o}from"./axios-L6U4YIEh.js";import{p as b}from"./default_profile-HTeSV8ma.js";import"./backSymbol-0aRp874W.js";var m={},E=U;Object.defineProperty(m,"__esModule",{value:!0});var h=m.default=void 0,_=E(D()),u=e;h=m.default=(0,_.default)([(0,u.jsx)("circle",{cx:"12",cy:"12",r:"3.2"},"0"),(0,u.jsx)("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt");const P=()=>{const l="https://i10c203.p.ssafy.io",t=JSON.parse(localStorage.getItem("user")),[g,j]=r.useState(t==null?void 0:t.nickname),[x,n]=r.useState(!1),[c,f]=r.useState(t==null?void 0:t.imageUrl),[v,N]=r.useState(t==null?void 0:t.imageUrl),d=A(),p=()=>{localStorage.removeItem("jwt"),localStorage.removeItem("user"),d("/login",{replace:!0})},y=async()=>{try{await o.delete(`${l}/api/log-out`,{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}}),p()}catch(a){console.log(a)}},S=async()=>{try{await o.delete(`${l}/api/users`,{headers:{Authorization:localStorage.getItem("jwt")}}),p()}catch(a){console.log(a)}},C=a=>{j(a.target.value)},w=()=>{n(!0)},I=a=>{const i=a.target.files[0],s=new FileReader;s.readAsDataURL(i),s.onloadend=()=>{N(s.result),f(i)}},k=async()=>{try{let a;if(t.imageUrl!==c){const s=new FormData;s.append("images",c),s.append("type","PROFILE"),a=await o.post(`${l}/api/images`,s,{headers:{Authorization:localStorage.getItem("jwt")}})}const i=await o.put(`${l}/api/users`,{imageUrl:a?a.data.imageNames[0]:c,nickname:g},{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}});localStorage.setItem("user",i.config.data),d("/user/mypage")}catch(a){console.log(a)}};return r.useEffect(()=>{t||d("/login")},[]),e.jsxs("div",{className:"mypage-edit",children:[e.jsx(R,{centerText:"My 정보수정",align:"center"}),e.jsx("div",{className:"complete",onClick:k,children:"완료"}),e.jsx("div",{className:"profile",children:e.jsxs("label",{htmlFor:"profile-img",children:[e.jsx("img",{src:v||b,alt:"",className:"profile-img"}),e.jsx("input",{type:"file",accept:"image/*",id:"profile-img",onChange:I}),e.jsx("div",{children:e.jsx(h,{})})]})}),e.jsxs("div",{className:"user-info",children:[e.jsx("div",{className:"info-title",children:"닉네임"}),e.jsx("input",{className:"info-nick",type:"text",value:g,onChange:C})]}),e.jsxs("div",{className:"user-change",children:[e.jsx("button",{className:"logout",onClick:y,children:"로그아웃"}),e.jsx("button",{className:"resign",onClick:w,children:"회원탈퇴"})]}),x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"filter-open",onClick:()=>n(!1)}),e.jsxs("div",{className:"filter-content",children:[e.jsx("h2",{children:"회원 탈퇴"}),e.jsxs("div",{className:"leave-content",children:[e.jsx("div",{children:"회원 탈퇴 시 계정 정보가 삭제되어 복구가 불가해요"}),e.jsx("div",{children:"정말로 탈퇴하시겠어요?"})]}),e.jsxs("div",{className:"btn",children:[e.jsx("button",{className:"cancel",onClick:()=>n(!1),children:"더 써볼래요"}),e.jsx("button",{className:"leave",onClick:S,children:"떠날래요"})]})]})]})]})};export{P as default};
