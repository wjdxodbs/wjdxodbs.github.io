import{e as p,a as C,r as d,j as e,h as g,i as V,k as E,R as N,d as w,l as H}from"./index-xE7cjMde.js";import{l as M,H as _}from"./Header-DKN4F9u1.js";import{l as R}from"./login-_F8kWCPK.js";import{a as A}from"./common-BDZuGjqk.js";import{F as Y,b as $}from"./index-O0aa0uDP.js";import{G as b}from"./ping-UIu7tjBm.js";import{d as v}from"./dayjs.min-DwhgRnG2.js";import{L as G}from"./Loading-DrI7_MaB.js";const Z=()=>{const s=p(M),n=C(),a=()=>{s(!1)},o=async()=>{try{await R(),localStorage.removeItem("jwt"),a(),n("/login",{replace:!0})}catch(i){console.error(i)}};return d.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]),e.jsxs("div",{className:"LogoutModal",children:[e.jsx("div",{className:"background",onClick:a}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"title",children:"로그아웃"}),e.jsx("div",{className:"content",children:"로그아웃 하시겠습니까?"})]}),e.jsxs("div",{className:"btn",children:[e.jsx("button",{onClick:a,children:"아니오"}),e.jsx("button",{onClick:o,children:"예"})]})]})]})},D=A(),z=async()=>{try{const{data:s}=await D.get("/users/user/thrown-song");return s}catch(s){throw console.log(s),s}},O=async()=>{try{const{data:s}=await D.get("/users/user/picked-song");return s}catch(s){throw console.log(s),s}},U=async()=>{try{const{data:s}=await D.get("/users/user/profile");return s}catch(s){throw console.log(s),s}},L=g({key:"throwngFilterModal",default:!1}),F=g({key:"myNickName",default:""}),B=g({key:"throwngFilter",default:"전체"}),W=g({key:"pageIdx",default:!1}),P=g({key:"myThrowHistoryList",default:[]}),T=g({key:"myPickHistoryList",default:[]}),q=()=>{const[s,n]=d.useState(0),[a,o]=d.useState(0),[i,j]=d.useState(0),[y,c]=d.useState("NONE"),x=p(F);d.useEffect(()=>{m()},[]);const m=async()=>{const t=await U();n(t.level),o(t.thrownCount),j(t.pickCount),c(t.isBlock),x(t.nickName)},l=t=>{switch(t){case 2:return"linear-gradient(to right, #ffffff, var(--level-gold))";case 3:return"linear-gradient(to right, #ffffff, var(--level-platinum))";case 4:return"linear-gradient(to right, #ffffff, var(--main-color))";default:return"linear-gradient(to right, #ffffff, #52DC22)"}},f=t=>{switch(t){case 2:return"var(--level-gold)";case 3:return"var(--main-platinum)";case 4:return"var(--main-color)";default:return"#52DC22"}},r=t=>{switch(t){case 1:return"이어폰";case 2:return"버즈";case 3:return"버즈프로";case 4:return"VVIP";default:return"이어폰"}},h=()=>{let t,u;return s===1?(t=20,u=a):s===4?(t=1e3,u=a+i):(t=100,u=a+i),u/t*100};return e.jsx("div",{className:"MyLevel",children:y!=="NONE"?e.jsx("div",{className:"block-message",children:e.jsx("p",{children:"7일 동안 음악 두기 기능이 정지됩니다."})}):e.jsxs("div",{className:"level-div",children:[e.jsxs("div",{className:"level-info",children:[e.jsxs("div",{className:"level-color",style:{color:f(s),border:`2px solid ${f(s)}`},children:["Lv.",s," ",r(s)]}),e.jsxs("div",{className:"drop-pick",children:["두기 : ",a,s===1&&e.jsx("span",{children:"/20"}),s===2&&e.jsx("span",{children:"/100"}),s===3&&e.jsx("span",{children:"/100"}),s===4&&e.jsx("span",{children:"/1000"})]}),s!==1&&e.jsxs("div",{className:"drop-pick",children:["줍기 : ",i,s===2&&e.jsx("span",{children:"/100"}),s===3&&e.jsx("span",{children:"/100"}),s===4&&e.jsx("span",{children:"/1000"})]})]}),e.jsx("div",{className:"level-bar",children:e.jsx("div",{className:"level-bar-fill",style:{width:`${h()}%`,background:l(s)}})})]})})};function J(s){return b({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M2.00488 9.49979V3.99979C2.00488 3.4475 2.4526 2.99979 3.00488 2.99979H21.0049C21.5572 2.99979 22.0049 3.4475 22.0049 3.99979V9.49979C20.6242 9.49979 19.5049 10.6191 19.5049 11.9998C19.5049 13.3805 20.6242 14.4998 22.0049 14.4998V19.9998C22.0049 20.5521 21.5572 20.9998 21.0049 20.9998H3.00488C2.4526 20.9998 2.00488 20.5521 2.00488 19.9998V14.4998C3.38559 14.4998 4.50488 13.3805 4.50488 11.9998C4.50488 10.6191 3.38559 9.49979 2.00488 9.49979ZM14.0049 4.99979H4.00488V7.96755C5.4866 8.7039 6.50488 10.2329 6.50488 11.9998C6.50488 13.7666 5.4866 15.2957 4.00488 16.032V18.9998H14.0049V4.99979ZM16.0049 4.99979V18.9998H20.0049V16.032C18.5232 15.2957 17.5049 13.7666 17.5049 11.9998C17.5049 10.2329 18.5232 8.7039 20.0049 7.96755V4.99979H16.0049Z"},child:[]}]})(s)}const K=()=>{const s=C(),n=a=>{a.preventDefault(),s("/user/notification",{replace:!0})};return e.jsx("div",{className:"MyPageMenu",children:e.jsxs("div",{className:"menu-body",children:[e.jsxs("div",{className:"menu-item",onClick:a=>n(a),children:[e.jsx(Y,{}),e.jsx("div",{className:"desc",children:"알림"})]}),e.jsxs("div",{className:"menu-item",children:[e.jsx(J,{}),e.jsx("div",{className:"desc",children:"쿠폰함"})]})]})})};function Q(s){return b({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M17.657 5.304c-3.124-3.073-8.189-3.073-11.313 0-3.124 3.074-3.124 8.057 0 11.13l5.656 5.565 5.657-5.565c3.124-3.073 3.124-8.056 0-11.13zm-5.657 8.195c-.668 0-1.295-.26-1.768-.732-.975-.975-.975-2.561 0-3.536.472-.472 1.1-.732 1.768-.732s1.296.26 1.768.732c.975.975.975 2.562 0 3.536-.472.472-1.1.732-1.768.732z"},child:[]}]})(s)}var I={exports:{}};(function(s,n){(function(a,o){s.exports=o()})(V,function(){return function(a,o,i){o.prototype.isBetween=function(j,y,c,x){var m=i(j),l=i(y),f=(x=x||"()")[0]==="(",r=x[1]===")";return(f?this.isAfter(m,c):!this.isBefore(m,c))&&(r?this.isBefore(l,c):!this.isAfter(l,c))||(f?this.isBefore(m,c):!this.isAfter(m,c))&&(r?this.isAfter(l,c):!this.isBefore(l,c))}}})})(I);var X=I.exports;const ee=E(X),se=({pageIdx:s,setHistoryCnt:n})=>{const[a,o]=d.useState([]),i=N(B),j=N(P),y=N(T),c=v(),x=v().subtract(7,"days"),m=C();v.extend(ee);const l=()=>{const h=(s?y:j).filter(t=>{const u=t.dropDate?t.dropDate:t.pickDate,k=v(u);switch(i){case"오늘":return c.isSame(k,"day");case"이번 주":return v(c).isBetween(x,c,"day","[]");case"이번 달":return c.isSame(k,"month");case"전체":return!0;default:return!1}}).sort((t,u)=>{const k=t.dropDate?t.dropDate:t.pickDate,S=u.dropDate?u.dropDate:u.pickDate;return v(S).diff(v(k))});o(h),n(h.length)};d.useEffect(()=>{l()},[i,s,j,y]);const f=r=>{"myThrowId"in r?m(`/music/pick/${r.myThrowId}`):"myPickId"in r&&m(`/music/pick/${r.throwId}`)};return e.jsx("div",{className:"MyThrowngHistroyList",children:e.jsx("div",{className:"list-body",children:a.length>0?a.map((r,h)=>e.jsxs("div",{className:"result-item",onClick:()=>f(r),children:[e.jsxs("div",{className:"item-header",children:[s?e.jsx("div",{className:"item-date",children:v(r.pickDate).format("YYYY-MM-DD")}):e.jsx("div",{className:"item-date",children:v(r.dropDate).format("YYYY-MM-DD")}),e.jsxs("div",{className:"item-location",children:[e.jsx(Q,{})," ",r.location]})]}),e.jsxs("div",{className:"item",children:[e.jsx("div",{className:"img-container",children:e.jsx("img",{src:r.albumImage,alt:""})}),e.jsxs("div",{className:"item-detail",children:[e.jsx("div",{className:"item-title",children:r.title}),e.jsx("div",{className:"item-artist",children:r.artist}),e.jsx("div",{className:"item-comment",children:r.comment})]})]})]},h)):e.jsx("div",{className:"no-result",children:"내역이 없습니다."})})})},te=()=>{const s=p(L),[n,a]=w(B),o=i=>{a(i)};return e.jsxs("div",{className:"MyThrowngHistoryFilterModal",children:[e.jsx("div",{className:"background",onClick:()=>s(!1)}),e.jsxs("div",{className:"modal",children:[e.jsx("div",{className:"header",children:"상세조회"}),e.jsx("hr",{}),e.jsxs("div",{className:"body",children:[e.jsx("div",{className:"body-header",children:"조회기간"}),e.jsx("div",{className:"filter-list",children:["오늘","이번 주","이번 달","전체"].map(i=>e.jsx("div",{className:`filter-item ${n===i?"selected":""}`,onClick:()=>o(i),children:i},i))})]})]})]})},ae=()=>{const[s,n]=w(W),[a,o]=d.useState(0),[i,j]=w(L),y=H(L),c=p(P),x=p(T),[m,l]=d.useState(!1);d.useEffect(()=>{y(),f()},[s]);const f=async()=>{if(l(!0),s){const h=await O();x(h),l(!1)}else{const h=await z();c(h),l(!1)}},r=()=>{j(!i)};return e.jsx("div",{className:"MyThrowngHistoryMenu",children:m?e.jsx(G,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"menu-header",children:[e.jsxs("div",{className:"header-btn-div",children:[e.jsx("div",{className:`btn-item ${s?"active":""}`,onClick:()=>n(!1),children:"두기"}),e.jsx("div",{className:`btn-item ${s?"":"active"}`,onClick:()=>n(!0),children:"줍기"})]}),e.jsxs("div",{className:"song-cnt",children:["전체 ",a,"개"]}),e.jsx("div",{className:"filter-div",onClick:r,children:e.jsxs("div",{className:"filter",children:[e.jsx("div",{children:"필터"}),e.jsx($,{})]})})]}),e.jsx(se,{pageIdx:s,setHistoryCnt:o}),i&&e.jsx(te,{})]})})},he=()=>{const s=N(F),n=N(M),a=H(M);return d.useEffect(()=>{a()},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"MyPage",children:[e.jsx(_,{centerText:"마이쓰롱",type:"logout"}),e.jsxs("div",{className:"body",children:[e.jsx("div",{className:"name",children:s}),e.jsx(q,{}),e.jsx(K,{}),e.jsx(ae,{})]})]}),n&&e.jsx(Z,{})]})};export{he as default};
