import{r as a,d as b,e as w,R as m,h as j,j as e,a as C}from"./index-DyI6-lzT.js";import{m as I,u as f,H as M}from"./Header-CbrAwtZW.js";import{w as N}from"./whiteBox-CgJCDTJb.js";import{a as U}from"./index-DqFQZBPx.js";import{s as R}from"./atoms-BX0bsWNU.js";import{l as y,a as D}from"./atoms-Cwd3sqKy.js";import{p as S}from"./MusicSearchApi-DCz2VPDJ.js";import{M as _}from"./MusicDropBtn-BCt-upXU.js";import"./ping-Bf9ewFiT.js";import"./common-CgW3NMxz.js";const k=()=>{const u=a.useRef(null),i=a.useRef(null),[n,x]=a.useState(!1),[c,o]=b(I),g=w(f),t=m(R),r=j(f);a.useEffect(()=>{if(i.current){const s=i.current.scrollWidth,l=i.current.clientWidth;s>l?x(!0):x(!1)}o(""),r()},[]);const h=()=>{u.current.click()},p=s=>{if(s.target.files&&s.target.files[0]){const l=s.target.files[0];g(l),o(URL.createObjectURL(l))}};return e.jsxs("div",{className:"MusicDropHeader",children:[e.jsx("div",{className:"album-image-container",children:e.jsx("img",{className:"album-image",src:t.albumImage,alt:""})}),e.jsxs("div",{className:"cover",children:[e.jsx("div",{className:"black-cover"}),e.jsx("div",{className:"black-gradient"}),e.jsxs("div",{className:"content",children:[e.jsx(M,{}),e.jsxs("div",{className:"content-bottom",children:[e.jsxs("div",{children:[e.jsx("div",{className:"title",children:e.jsx("div",{ref:i,className:`scrolling-text ${n?"animated":""}`,children:t.title})}),e.jsx("div",{className:"artist",children:t.artist})]}),e.jsxs("div",{className:"upload-image-div",onClick:h,children:[e.jsx("img",{src:c||N,alt:"",className:"upload-image",onError:s=>{s.currentTarget.src=N}}),!c&&e.jsx(U,{})]}),c&&e.jsx("div",{className:"reselect-image",onClick:h,children:"이미지 다시 선택하기"}),e.jsx("input",{type:"file",ref:u,hidden:!0,onChange:p,className:"image-input"})]})]})]})]})},B=()=>{const[u,i]=a.useState(0),[n,x]=a.useState(""),c=a.useRef(null),o=m(y),g=m(D),t=m(f);C();const r=m(R),h=j(f),p=j(I),s=d=>{d.target.value.length<=50?(x(d.target.value),i(d.target.value.length)):alert("텍스트는 최대 50자까지 입력 가능합니다.")},l=async d=>{if(d.preventDefault(),n.trim().length===0){alert("노래에 대한 감정이나 상황을 적어주세요.");return}if(t&&t.size>95e5){alert("사진의 용량이 너무 큽니다. 다른 사진을 사용해 주세요."),h(),p();return}const v={longitude:o.lng,latitude:o.lat,location:g,imageUrl:t,comment:n.trim(),title:r.title,artist:r.artist,albumImageUrl:r.albumImage};console.log(v.imageUrl),await S(r.youtubeId,v)};return e.jsx("div",{className:"MusicDrop",children:e.jsxs("div",{className:"body",children:[e.jsxs("div",{className:"header",children:[e.jsxs("p",{children:[e.jsx("span",{children:g}),"에"]}),"음악을 두고 갈까요?"]}),e.jsxs("form",{className:"form-div",children:[e.jsxs("div",{className:"input-div",children:[e.jsx("textarea",{onChange:s,placeholder:"노래, 현재 감정, 상황, 관련 에피소드, 거리, 가수 등 떠오르는 말을 적어보세요.",value:n,maxLength:50,className:"input-area",ref:c,required:!0}),e.jsxs("div",{className:"input-count",children:[u,"/50"]})]}),e.jsx("div",{className:"waring-div",children:e.jsx("div",{className:"warning-msg",children:"텍스트 및 사진은 생략이 가능하며 욕설, 성희롱, 비방과 같은 내용은 삭제됩니다."})}),e.jsx(_,{onClick:l,btnText:"쓰롱하기"})]})]})})},A=()=>e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx(B,{})]});export{A as default};
