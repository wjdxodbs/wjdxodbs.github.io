import{j as e,r as c,e as j,F as v}from"./index-COAnT1ag.js";import{N as b}from"./NoneNavHeader-C4i4OJLn.js";import{a as f}from"./axios-Bo0ATomq.js";import{U as p}from"./UserFundProgressBar-BHKYKFhb.js";import{P as w}from"./Prompt-CwDaB1aj.js";import{N as m}from"./NoneData-BxVWZOSB.js";import"./index--05Lzcyg.js";import"./iconBase-C_KlNhWT.js";import"./index-DNl-2OPf.js";import"./ModalButton-CHLZnwZb.js";import"./profileImg-Fhzvd9kH.js";const g=({state:t,handleChange:a,value:r,text:o})=>e.jsxs("label",{className:`flex-1 flex items-center justify-center text-[2vh] cursor-pointer ${t===r&&"border-t-2 border-t-transparent border-b-2 border-b-red-600 font-bold text-white"}`,children:[e.jsx("input",{checked:t===r,value:r,name:"fund_state",type:"radio",className:"hidden input",onChange:a}),o]}),y=({state:t,handleChange:a})=>e.jsxs("div",{className:"w-[100%] h-[5vh] flex border-b-[1px] border-b-red-600 text-textGray",children:[e.jsx(g,{state:t,handleChange:a,value:"success",text:"펀딩성공"}),e.jsx(g,{state:t,handleChange:a,value:"fail",text:"펀딩실패"})]}),N=({item:t,removeFund:a})=>{const[r,o]=c.useState(!1),d=j(),x=async()=>{try{const s=await f.get(`https://j10C204.p.ssafy.io/api/reservations/get/${t.reservationId}`,{headers:{Authorization:localStorage.getItem("jwt")}});d(`/user/ticket/${s.data}`,{state:s.data})}catch(s){console.log(s)}},h=async()=>{try{const s=await f.put(`https://j10C204.p.ssafy.io/api/reservations/cancel/${t.reservationId}`,null,{headers:{Authorization:localStorage.getItem("jwt")}});console.log(s),a(t.reservationId)}catch(s){console.log(s)}},u=s=>{const l=new Date,n=new Date(s);return l.setHours(0,0,0,0),n.setHours(0,0,0,0),(n.getTime()-l.getTime())/(1e3*60*60)/24};return e.jsxs("div",{className:"flex flex-col bg-bgGray p-[2vh] rounded-lg gap-[2vh] shadow-test",children:[e.jsxs("div",{className:"w-full flex gap-[2vh]",children:[e.jsx("img",{className:"w-[9vh] h-[13vh] object-cover rounded brightness-[90%]",src:t.poster,alt:"",loading:"lazy"}),e.jsxs("div",{className:"relative flex flex-col justify-between w-full",children:[e.jsxs("div",{className:"flex items-center w-full gap-[2vh] ",children:[e.jsx("div",{className:"flex-1 text-[2.5vh] font-bold w-0 overflow-hidden text-ellipsis whitespace-nowrap ",children:t.title}),e.jsx("div",{className:"text-[1.5vh] text-textGray",children:`${v(t.date)}`})]}),e.jsx(p,{type:"success-bar",attendCnt:t.attendCnt,goalCnt:t.goalCnt})]})]}),e.jsxs("div",{className:"flex gap-[1vh]",children:[u(t.date)>1&&e.jsx("button",{className:"flex-1 p-[1vh] border border-textGray rounded-lg text-[2vh]",onClick:()=>o(!0),children:"좌석취소"}),e.jsx("button",{className:"flex-1 p-[1vh] border border-textGray rounded-lg text-[2vh]",onClick:x,children:"티켓확인"})]}),r&&e.jsx(w,{onClose:()=>o(!1),onConfirm:h})]})},C=({successData:t,removeFund:a})=>e.jsx(e.Fragment,{children:t.length?t.map(r=>e.jsx(N,{item:r,removeFund:a},r.reservationId)):e.jsx(m,{content:"성공한 펀딩이 없습니다."})}),F=({item:t})=>e.jsx("div",{className:"flex flex-col bg-bgGray p-[2vh] rounded-[1vh] gap-[2vh] shadow-test",children:e.jsxs("div",{className:"w-full flex gap-[2vh]",children:[e.jsx("img",{className:"w-[9vh] h-[13vh] object-cover rounded-[0.5vh] brightness-[90%]",src:t.poster,alt:"",loading:"lazy"}),e.jsxs("div",{className:"relative flex flex-col justify-between w-full ",children:[e.jsxs("div",{className:"flex items-center w-full gap-[3vh] ",children:[e.jsx("div",{className:"flex-1 text-[2.5vh] font-bold w-0 overflow-hidden text-ellipsis whitespace-nowrap ",children:t.title}),e.jsx("div",{className:" text-[1.5vh] text-textGray",children:`${v(t.date)}`})]}),e.jsx(p,{type:"fail-bar",attendCnt:t.attendCnt,goalCnt:t.goalCnt})]})]})}),I=({failData:t})=>e.jsx(e.Fragment,{children:t.length?t.map(a=>e.jsx(F,{item:a},a.reservationId)):e.jsx(m,{content:"실패한 펀딩이 없습니다."})}),E=()=>{const[t,a]=c.useState("success"),[r,o]=c.useState([]),[d,x]=c.useState([]),h=s=>{a(s.target.value)},u=s=>{o(l=>l.filter(n=>n.reservationId!==s))};return c.useEffect(()=>{(async()=>{try{const n=(await f.get("https://j10C204.p.ssafy.io/api/fundings/result",{headers:{Authorization:localStorage.getItem("jwt")}})).data;console.log(n),o(n.filter(i=>i.fundingFinalResult)),x(n.filter(i=>!i.fundingFinalResult))}catch(l){console.log(l)}})()},[]),e.jsxs("div",{className:"FundingCompletedPage",children:[e.jsx(b,{centerText:"애프터 무딩"}),e.jsxs("div",{className:"FundingCompletedPage-body ",children:[e.jsx(y,{state:t,handleChange:h}),e.jsx("div",{className:"none-scroll h-[88vh] overflow-auto p-[3vh] flex flex-col gap-[3vh] relative",children:t==="success"?e.jsx(C,{successData:r,removeFund:u}):e.jsx(I,{failData:d})})]})]})};export{E as default};
