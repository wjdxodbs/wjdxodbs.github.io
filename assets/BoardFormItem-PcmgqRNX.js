import{d as K,i as $,j as e,r as a,u as V,h as q}from"./index-jMApTOil.js";/* empty css                      */import{d as G}from"./AddOutlined-qh-EUegE.js";import{h as J,m as Q,i as W,j as X}from"./board-trRPgBQ3.js";import{a as L}from"./axios-L6U4YIEh.js";import{M as Y}from"./marker_place_off-DaVJSVdB.js";import{b as Z,c as ee,M as te,a as se}from"./marker_place-o5LaL0-X.js";var R={},ae=$;Object.defineProperty(R,"__esModule",{value:!0});var F=R.default=void 0,ne=ae(K()),ie=e;F=R.default=(0,ne.default)((0,ie.jsx)("path",{d:"M20 10V8h-4V4h-2v4h-4V4H8v4H4v2h4v4H4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4zm-6 4h-4v-4h4z"}),"TagOutlined");const le=({fishSpot:m,setFishSpot:i})=>{const[d,C]=a.useState({lat:36.172823447489336,lng:127.8675122717897}),[S,w]=a.useState(""),[b,x]=a.useState(13),[k,g]=a.useState([]),[N,j]=a.useState(null),h=a.useRef(),c=a.useRef(),o=async l=>{l.preventDefault();try{const n=await L.get("https://i10c203.p.ssafy.io/api/spots",{params:{keyword:S},headers:{Authorization:localStorage.getItem("jwt")}});console.log(n.data.spots),g(n.data.spots),h.current.setLevel(13),h.current.setCenter(new kakao.maps.LatLng(36.172823447489336,127.8675122717897)),c.current.blur()}catch(n){console.log(n)}},u=()=>{j(null),i({}),c.current.blur()},v=(l,n)=>{j(l),i(n)};return e.jsxs("div",{children:[e.jsx(Z,{center:d,ref:h,level:b,onClick:u,children:e.jsx(ee,{minLevel:11,averageCenter:!0,children:k.map((l,n)=>e.jsx(te,{position:{lat:l.latitude,lng:l.longitude},onClick:()=>v(n,l),image:N===n?{src:se,size:{width:28,height:40}}:{src:Y,size:{width:18,height:25}}},l.spotId))})}),e.jsx("form",{onSubmit:o,children:e.jsx("input",{type:"text",ref:c,value:S,onChange:l=>w(l.target.value)})}),m&&e.jsx("div",{children:e.jsx("div",{className:"space-info",children:m.name})})]})},ge=({type:m,categoryId:i,boardData:d})=>{const C=V(),S="https://i10c203.p.ssafy.io",w=localStorage.getItem("jwt"),b=q().id,[x,k]=a.useState(""),[g,N]=a.useState(""),j=a.useRef(),[h,c]=a.useState(""),[o,u]=a.useState([]),[v,l]=a.useState(""),[n,f]=a.useState([]),[p,U]=a.useState({}),[y,A]=a.useState(""),[B,E]=a.useState("");a.useEffect(()=>{d&&(l(d.content),u(d.hashtags),k("0"),N(d.boardImageUrl),console.log(v),console.log(o),console.log(x),console.log(g))},[d]);const H=t=>{console.log("2w"),t.preventDefault();let s=t.target.files[0],r=new FileReader;r.onloadend=re=>{k(s),N(r.result)},s&&r.readAsDataURL(s),O(s)},O=t=>{const s=new FormData;s.append("images",t),s.append("type","LIVEROOM"),L.post(S+"/api/images",s,{headers:{Authorization:w,"Content-Type":"multipart/form-data"}}).then(r=>{E(r.data.imageNames[0])}).catch(r=>console.log(r))},_=t=>{console.log("cleick"),t.preventDefault(),j.current.click()},D=async t=>{t==="create"&&await J({categoryId:i,content:v,fishBookId:y,hashTags:o,fishingSpotId:p.spotId,imageUrl:B,latitude:p.latitude,longitude:p.longitude}).then(s=>{console.log(s),C("/media/board")}),t==="modify"&&await Q({categoryId:i,content:v,fishBookId:y,hashTags:o,fishingSpotId:p.spotId,imageUrl:g,latitude:p.latitude,longitude:p.longitude},b).then(s=>{console.log(s),C(`/media/board/${b}`)})},T=async t=>{await W(t.trim()).then(s=>{f(s)})},z=async t=>{await X(t.trim()).then(s=>{f(s),console.log(n)})},P=(t,s)=>{if(i==1)A(t),u([s]),c(""),f([]);else if(i==2){if(o.length==5){alert("5개까지 등록가능합니다."),c(""),f([]);return}const r=[...o,s];u(r),c(""),f([])}},M=t=>{if(t.key==="Enter"&&i==1){alert("물고기 이름을 눌러주세요");return}else if(t.key==="Enter"&&i==2){if(o.length==5){alert("5개까지 등록가능합니다."),c(""),f([]);return}c("");const s=[...o,h];u(s)}},I=t=>{console.log(t);const s=o.filter(r=>r!==t);u(s)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"post-area",children:[e.jsxs("div",{className:"post-item",children:[e.jsxs("div",{className:"post-sub",children:[i==1&&e.jsx("div",{children:"잡은 물고기를 등록해 주세요"}),i==2&&e.jsx("div",{children:"리뷰를 작성해 주세요."})]}),e.jsxs("div",{className:"post-image-upload",children:[g&&e.jsx("img",{className:"img_preview",src:g}),e.jsx("input",{ref:j,hidden:!0,id:"file",type:"file",onChange:H}),e.jsxs("div",{className:`shadow ${x?"reupload-btn blue-bd":"upload-btn bg-blue"}`,onClick:_,children:[!x&&e.jsx(G,{}),x&&"이미지 다시 선택하기"]})]})]}),e.jsxs("div",{className:"post-item",children:[e.jsx("div",{className:"post-sub",children:"장소"}),e.jsx("div",{className:"position",children:e.jsx(le,{fishSpot:p,setFishSpot:U})})]}),e.jsxs("div",{className:"post-item",children:[e.jsxs("div",{className:"post-sub",children:[i==1&&e.jsx("div",{children:"물고기종류"}),i==2&&e.jsx("div",{children:"해시태그"})]}),e.jsxs("div",{className:"hashtag-add",children:[e.jsx("div",{className:"hashtag-icon shadow bg-blue",children:e.jsx(F,{})}),i==1&&e.jsx("input",{className:"hashtag-search",type:"text",value:h,onKeyUp:t=>T(t.target.value),onChange:t=>c(t.target.value),onKeyDown:t=>M(t),placeholder:"물고기이름"}),i==2&&e.jsx("input",{className:"hashtag-search",type:"text",value:h,onKeyUp:t=>z(t.target.value),onChange:t=>c(t.target.value),onKeyDown:t=>M(t),placeholder:"최대 5개까지 입력할 수 있어요"})]}),e.jsx("ul",{className:`auto-area ${n&&n.length!=0?"":"none"}`,children:n&&n.length!=0&&e.jsx(e.Fragment,{children:n.map(t=>e.jsx("li",{className:"blue-bd",onClick:s=>P(t.id,t.name),children:t.name},t.id))})}),e.jsx("ul",{className:"hashtag-add-area",children:o&&e.jsx(e.Fragment,{children:o.map((t,s)=>e.jsx("li",{className:"blue-bd blue-fc",onClick:r=>I(t),children:t},s))})})]}),e.jsxs("div",{className:"post-item",children:[e.jsx("div",{className:"post-sub",children:"하고싶은 말"}),e.jsx("textarea",{value:v,onChange:t=>l(t.target.value)})]}),e.jsxs("div",{className:"post-add-btn bg-blue",onClick:t=>D(m),children:[m==="create"&&e.jsx("div",{children:"등록하기"}),m==="modify"&&e.jsx("div",{children:"수정하기"})]})]})})};export{ge as B};
