import{r as a,d as b,R as d,e as w,l as m,j as e,a as y}from"./index-BSoqsAux.js";import{H as C}from"./Header-DFFgy22b.js";import{a as B}from"./index-BOWFv5Bf.js";import{m as I,u as A}from"./atoms-C2UOxej6.js";import{s as S}from"./atoms-BMSdPmdo.js";import{p as D,a as M}from"./MusicSearchApi-DEPvDYNp.js";import{l as V,a as _}from"./atoms-BPiURzhw.js";import{M as k}from"./MusicDropBtn-D0Qp9TIu.js";import{a as J}from"./atoms-CKgit-3i.js";import{L}from"./Loading-Bc5pEY05.js";import"./ping-BO6phXmh.js";import"./index-Co6n4StN.js";import"./common-BDZuGjqk.js";const N="data:image/webp;base64,UklGRogAAABXRUJQVlA4WAoAAAAQAAAAlQAAlQAAQUxQSAoAAAABB1DAiAhERP8DVlA4IFgAAABwCACdASqWAJYAPpFIoU0lpCMiIGgAsBIJaW7hdfAAO6HVUmyYh1VJsmIdVSbJiHVUmyYh1VJsmIdVSbJiHVUmyYh1VJsmIdVSbIIAAP7/k5gAAAAAAAAA",H=()=>{const r=a.useRef(null),t=a.useRef(null),[f,n]=a.useState(!1),[u,h]=b(I),l=d(S),g=w(A),x=m(I),p=m(A);a.useEffect(()=>{if(t.current){const s=t.current.scrollWidth,i=t.current.clientWidth;s>i?n(!0):n(!1)}x(),p()},[]);const o=()=>{r.current.click()},j=async s=>{if(s.target.files&&s.target.files[0]){const i=s.target.files[0];if(i.size>5e6){alert("사진의 용량이 너무 커요. 다른 사진을 사용해 주세요."),x(),p();return}else{h(URL.createObjectURL(i));const v=await D(i);g(v)}}};return e.jsxs("div",{className:"MusicDropHeader",children:[e.jsx("img",{className:"album-image",src:l.albumImage,alt:""}),e.jsxs("div",{className:"cover",children:[e.jsx("div",{className:"black-cover"}),e.jsx("div",{className:"black-gradient"}),e.jsxs("div",{className:"content",children:[e.jsx(C,{}),e.jsxs("div",{className:"content-bottom",children:[e.jsxs("div",{className:"info",children:[e.jsx("div",{className:"title",children:e.jsx("div",{ref:t,className:`scrolling-text ${f?"animated":""}`,children:l.title})}),e.jsx("div",{className:"artist",children:l.artist})]}),e.jsxs("div",{className:"upload-image-div",onClick:o,children:[e.jsx("img",{src:u||N,alt:"",className:"upload-image",onError:s=>{s.currentTarget.src=N}}),!u&&e.jsx(B,{})]}),e.jsx("input",{type:"file",ref:r,hidden:!0,onChange:j,className:"image-input"})]})]})]})]})},P=({setIsLoading:r})=>{const[t,f]=a.useState(0),[n,u]=a.useState(""),h=a.useRef(null),l=d(V),g=d(_),x=d(A),p=y(),o=d(S),j=m(A),s=m(I),i=m(J),v=c=>{c.target.value.length<=50?(u(c.target.value),f(c.target.value.length)):alert("텍스트는 최대 50자까지 입력 가능합니다.")},U=async c=>{if(r(!0),c.preventDefault(),n.trim().length===0){alert("노래, 현재 감정, 상황, 관련 에피소드, 거리, 가수 등 떠오르는 말을 적어보세요."),r(!1);return}const R={longitude:l.lng,latitude:l.lat,location:g,comment:n.trim(),title:o.title,imageUrl:x,artist:o.artist,albumImageUrl:o.albumImage};await M(o.youtubeId,R)==="Song_400_2"&&alert(`하루 쓰롱 개수를 초과하였습니다.
내일 다시 쓰롱 해주세요.`),j(),s(),i(),p("/",{replace:!0})};return e.jsxs("div",{className:"MusicDropBody",children:[e.jsxs("div",{className:"header",children:[e.jsxs("p",{children:[e.jsx("span",{children:g}),"에"]}),"음악을 두고 갈까요?"]}),e.jsxs("form",{className:"form-div",children:[e.jsxs("div",{className:"div",children:[e.jsxs("div",{className:"input-div",children:[e.jsx("textarea",{onChange:v,placeholder:"노래, 현재 감정, 상황, 관련 에피소드, 거리, 가수 등 떠오르는 말을 적어보세요.",value:n,maxLength:50,className:"input-area none-scroll",ref:h,required:!0}),e.jsxs("div",{className:"input-count",children:[t,"/50"]})]}),e.jsx("div",{className:"warning-msg",children:"텍스트 및 사진은 생략이 가능하며 욕설, 성희롱, 비방과 같은 내용은 삭제됩니다."})]}),e.jsx(k,{onClick:U,btnText:"쓰롱하기"})]})]})},ee=()=>{const[r,t]=a.useState(!1);return e.jsx(e.Fragment,{children:r?e.jsx(L,{}):e.jsxs("div",{className:"MusicDrop",children:[e.jsx(H,{}),e.jsx(P,{setIsLoading:t})]})})};export{ee as default};
