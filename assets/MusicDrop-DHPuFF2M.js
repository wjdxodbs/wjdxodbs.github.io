import{r as a,d as S,R as d,e as b,l as A,j as e,a as w}from"./index-DeEZXqpS.js";import{m as I,u as h,H as y}from"./Header-G95rvQSz.js";import{a as C}from"./index-rJFpE54V.js";import{s as U}from"./atoms-D_nTueaA.js";import{p as B,a as D}from"./MusicSearchApi-MgdmLZRF.js";import{l as M,a as V}from"./atoms-Cs9gKt9Y.js";import{M as k}from"./MusicDropBtn-BUlvm6yL.js";import{L as J}from"./Loading-BIzm1voN.js";import"./ping-NSZuLFCQ.js";import"./index-Co6n4StN.js";import"./common-CgW3NMxz.js";const N="data:image/webp;base64,UklGRogAAABXRUJQVlA4WAoAAAAQAAAAlQAAlQAAQUxQSAoAAAABB1DAiAhERP8DVlA4IFgAAABwCACdASqWAJYAPpFIoU0lpCMiIGgAsBIJaW7hdfAAO6HVUmyYh1VJsmIdVSbJiHVUmyYh1VJsmIdVSbJiHVUmyYh1VJsmIdVSbIIAAP7/k5gAAAAAAAAA",L=()=>{const i=a.useRef(null),t=a.useRef(null),[p,n]=a.useState(!1),[m,f]=S(I),r=d(U),u=b(h),g=A(I),x=A(h);console.log(r),a.useEffect(()=>{if(t.current){const s=t.current.scrollWidth,l=t.current.clientWidth;s>l?n(!0):n(!1)}g(),x()},[]);const c=()=>{i.current.click()},j=async s=>{if(s.target.files&&s.target.files[0]){const l=s.target.files[0];if(l.size>5e6){alert("사진의 용량이 너무 커요. 다른 사진을 사용해 주세요."),g(),x();return}else{f(URL.createObjectURL(l));const v=await B(l);u(v)}}};return e.jsxs("div",{className:"MusicDropHeader",children:[e.jsx("img",{className:"album-image",src:r.albumImage,alt:""}),e.jsxs("div",{className:"cover",children:[e.jsx("div",{className:"black-cover"}),e.jsx("div",{className:"black-gradient"}),e.jsxs("div",{className:"content",children:[e.jsx(y,{}),e.jsxs("div",{className:"content-bottom",children:[e.jsxs("div",{className:"info",children:[e.jsx("div",{className:"title",children:e.jsx("div",{ref:t,className:`scrolling-text ${p?"animated":""}`,children:r.title})}),e.jsx("div",{className:"artist",children:r.artist})]}),e.jsxs("div",{className:"upload-image-div",onClick:c,children:[e.jsx("img",{src:m||N,alt:"",className:"upload-image",onError:s=>{s.currentTarget.src=N}}),!m&&e.jsx(C,{})]}),e.jsx("input",{type:"file",ref:i,hidden:!0,onChange:j,className:"image-input"})]})]})]})]})},_=({setIsLoading:i})=>{const[t,p]=a.useState(0),[n,m]=a.useState(""),f=a.useRef(null),r=d(M),u=d(V),g=d(h),x=w(),c=d(U),j=A(h),s=A(I),l=o=>{o.target.value.length<=50?(m(o.target.value),p(o.target.value.length)):alert("텍스트는 최대 50자까지 입력 가능합니다.")},v=async o=>{if(i(!0),o.preventDefault(),n.trim().length===0){alert("노래, 현재 감정, 상황, 관련 에피소드, 거리, 가수 등 떠오르는 말을 적어보세요."),i(!1);return}const R={longitude:r.lng,latitude:r.lat,location:u,comment:n.trim(),title:c.title,imageUrl:g,artist:c.artist,albumImageUrl:c.albumImage};await D(c.youtubeId,R),j(),s(),x("/",{replace:!0})};return e.jsxs("div",{className:"MusicDropBody",children:[e.jsxs("div",{className:"header",children:[e.jsxs("p",{children:[e.jsx("span",{children:u}),"에"]}),"음악을 두고 갈까요?"]}),e.jsxs("form",{className:"form-div",children:[e.jsxs("div",{className:"div",children:[e.jsxs("div",{className:"input-div",children:[e.jsx("textarea",{onChange:l,placeholder:"노래, 현재 감정, 상황, 관련 에피소드, 거리, 가수 등 떠오르는 말을 적어보세요.",value:n,maxLength:50,className:"input-area none-scroll",ref:f,required:!0}),e.jsxs("div",{className:"input-count",children:[t,"/50"]})]}),e.jsx("div",{className:"warning-msg",children:"텍스트 및 사진은 생략이 가능하며 욕설, 성희롱, 비방과 같은 내용은 삭제됩니다."})]}),e.jsx(k,{onClick:v,btnText:"쓰롱하기"})]})]})},z=()=>{const[i,t]=a.useState(!1);return e.jsx(e.Fragment,{children:i?e.jsx(J,{}):e.jsxs("div",{className:"MusicDrop",children:[e.jsx(L,{}),e.jsx(_,{setIsLoading:t})]})})};export{z as default};
