import{r as a,d as S,R as d,e as b,l as A,j as e,a as w}from"./index-xE7cjMde.js";import{H as y}from"./Header-DKN4F9u1.js";import{a as C}from"./index-Bezwo5rA.js";import{m as I,u as p}from"./atoms-DzRpczWy.js";import{s as U}from"./atoms-BTZhRRhW.js";import{p as B,a as D}from"./MusicSearchApi-DEPvDYNp.js";import{l as M,a as V}from"./atoms-CJxmZCWz.js";import{M as _}from"./MusicDropBtn-CFXGz5JB.js";import{L as k}from"./Loading-DrI7_MaB.js";import"./ping-UIu7tjBm.js";import"./index-Co6n4StN.js";import"./common-BDZuGjqk.js";const N="data:image/webp;base64,UklGRogAAABXRUJQVlA4WAoAAAAQAAAAlQAAlQAAQUxQSAoAAAABB1DAiAhERP8DVlA4IFgAAABwCACdASqWAJYAPpFIoU0lpCMiIGgAsBIJaW7hdfAAO6HVUmyYh1VJsmIdVSbJiHVUmyYh1VJsmIdVSbJiHVUmyYh1VJsmIdVSbIIAAP7/k5gAAAAAAAAA",J=()=>{const i=a.useRef(null),t=a.useRef(null),[h,l]=a.useState(!1),[m,f]=S(I),n=d(U),u=b(p),g=A(I),x=A(p);a.useEffect(()=>{if(t.current){const s=t.current.scrollWidth,r=t.current.clientWidth;s>r?l(!0):l(!1)}g(),x()},[]);const o=()=>{i.current.click()},j=async s=>{if(s.target.files&&s.target.files[0]){const r=s.target.files[0];if(r.size>5e6){alert("사진의 용량이 너무 커요. 다른 사진을 사용해 주세요."),g(),x();return}else{f(URL.createObjectURL(r));const v=await B(r);u(v)}}};return e.jsxs("div",{className:"MusicDropHeader",children:[e.jsx("img",{className:"album-image",src:n.albumImage,alt:""}),e.jsxs("div",{className:"cover",children:[e.jsx("div",{className:"black-cover"}),e.jsx("div",{className:"black-gradient"}),e.jsxs("div",{className:"content",children:[e.jsx(y,{}),e.jsxs("div",{className:"content-bottom",children:[e.jsxs("div",{className:"info",children:[e.jsx("div",{className:"title",children:e.jsx("div",{ref:t,className:`scrolling-text ${h?"animated":""}`,children:n.title})}),e.jsx("div",{className:"artist",children:n.artist})]}),e.jsxs("div",{className:"upload-image-div",onClick:o,children:[e.jsx("img",{src:m||N,alt:"",className:"upload-image",onError:s=>{s.currentTarget.src=N}}),!m&&e.jsx(C,{})]}),e.jsx("input",{type:"file",ref:i,hidden:!0,onChange:j,className:"image-input"})]})]})]})]})},L=({setIsLoading:i})=>{const[t,h]=a.useState(0),[l,m]=a.useState(""),f=a.useRef(null),n=d(M),u=d(V),g=d(p),x=w(),o=d(U),j=A(p),s=A(I),r=c=>{c.target.value.length<=50?(m(c.target.value),h(c.target.value.length)):alert("텍스트는 최대 50자까지 입력 가능합니다.")},v=async c=>{if(i(!0),c.preventDefault(),l.trim().length===0){alert("노래, 현재 감정, 상황, 관련 에피소드, 거리, 가수 등 떠오르는 말을 적어보세요."),i(!1);return}const R={longitude:n.lng,latitude:n.lat,location:u,comment:l.trim(),title:o.title,imageUrl:g,artist:o.artist,albumImageUrl:o.albumImage};await D(o.youtubeId,R)==="Song_400_2"&&alert(`하루 쓰롱 개수를 초과하였습니다.
내일 다시 쓰롱 해주세요.`),j(),s(),x("/",{replace:!0})};return e.jsxs("div",{className:"MusicDropBody",children:[e.jsxs("div",{className:"header",children:[e.jsxs("p",{children:[e.jsx("span",{children:u}),"에"]}),"음악을 두고 갈까요?"]}),e.jsxs("form",{className:"form-div",children:[e.jsxs("div",{className:"div",children:[e.jsxs("div",{className:"input-div",children:[e.jsx("textarea",{onChange:r,placeholder:"노래, 현재 감정, 상황, 관련 에피소드, 거리, 가수 등 떠오르는 말을 적어보세요.",value:l,maxLength:50,className:"input-area none-scroll",ref:f,required:!0}),e.jsxs("div",{className:"input-count",children:[t,"/50"]})]}),e.jsx("div",{className:"warning-msg",children:"텍스트 및 사진은 생략이 가능하며 욕설, 성희롱, 비방과 같은 내용은 삭제됩니다."})]}),e.jsx(_,{onClick:v,btnText:"쓰롱하기"})]})]})},$=()=>{const[i,t]=a.useState(!1);return e.jsx(e.Fragment,{children:i?e.jsx(k,{}):e.jsxs("div",{className:"MusicDrop",children:[e.jsx(J,{}),e.jsx(L,{setIsLoading:t})]})})};export{$ as default};
