import{r as t,a as C,R as v,j as s}from"./index-CRA80s5I.js";import{H as g}from"./Header-D7U5NxiC.js";import{d as c}from"./dayjs.min-VwQ33oIq.js";import{g as T,p as I}from"./MyCouponAPi-C70N0fhb.js";import{d as M}from"./atoms-or8nhcxV.js";import{L as S}from"./Loading-X59TbE_K.js";import{T as E,t as l}from"./toastMsg-CBIrIJ29.js";import"./iconBase-DRrAfuwq.js";import"./AddressContent-B7cbalNm.js";import"./common-BDZuGjqk.js";const w=()=>{const[n,N]=t.useState([]),h=C(),y=v(M),[x,i]=t.useState(!1);t.useEffect(()=>{i(!0),d()},[]);const d=async()=>{const o=await T();N(o),i(!1)},f=async o=>{const e=n.find(p=>p.couponId===o);if(!e)return;if(window.confirm(`${e.couponName}을 적용하시겠어요?`)){if(e.couponName==="닉네임 변경 쿠폰"){y(e.couponId),h("/user/mypage/change-nickname");return}if(n.some(a=>a.couponName===e.couponName&&a.couponStatus==="사용 중")){l("동일한 쿠폰을 사용중이에요");return}const u=["THROWNG_INF","THROWNG_TWICE","THROWNG_LEVEL","THROWNG_FIVE"];if(u.includes(e.couponType)&&n.some(m=>u.includes(m.couponType)&&m.couponStatus==="사용 중")){l("같은 유형의 쿠폰을 사용중이에요");return}const j={couponId:o,couponType:e.couponType};await I(j),d()}};return s.jsxs("div",{className:"MyCouponBody",children:[x?s.jsx(S,{}):n.length>0?n.map(o=>{const e=Math.ceil(c(o.couponEndDate).diff(c(),"day",!0)),r=e<=1;return s.jsxs("div",{className:"coupon-body",children:[s.jsxs("div",{className:"coupon-header",children:[s.jsx("div",{className:"coupon-title",children:o.couponName}),s.jsx("div",{className:"coupon-desc",children:o.couponDescription})]}),s.jsx("div",{className:`coupon-apply ${o.couponStatus==="사용 전"?"":"inactive"}`,onClick:()=>o.couponStatus==="사용 전"&&f(o.couponId),children:s.jsx("div",{className:`coupon-apply-btn ${o.couponStatus!=="사용 전"&&"coupon-apply-active"}`,children:o.couponStatus})}),s.jsx("hr",{}),s.jsxs("div",{className:"coupon-end-date",children:[s.jsx("div",{className:`${r&&"coupon-end-date-how-imminent"}`,children:`D-${e}`}),s.jsxs("div",{className:"coupon-end-date-when",children:[c(o.couponEndDate).format("YY/MM/DD HH:mm:ss"),"까지"]})]})]},o.couponId)}):s.jsx("div",{className:"SearchedWords",children:s.jsxs("div",{className:"no-word-container",children:[s.jsx("div",{className:"title",children:"앗!"}),s.jsx("div",{className:"subtitle",children:"사용 가능한 쿠폰이 없습니다."})]})}),s.jsx(E,{})]})},O=()=>s.jsxs("div",{className:"MyCouponPage",children:[s.jsx(g,{centerText:"쿠폰함"}),s.jsx("div",{className:"body none-scroll",children:s.jsx(w,{})})]});export{O as default};
