import{d as j,u as P,r as d,j as e,t as E}from"./index-u2Gvw5X7.js";import{N}from"./NoneNavHeader-a-WfEfyy.js";import{L as b}from"./Loading-BgOpaWmb.js";import{T as S}from"./Common-CeOQ02Lw.js";import"./index-Bet7odq9.js";import"./iconBase-mEdiO_nV.js";import"./index-COOfumwh.js";var c;function _(n,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=document.querySelector('[src="'.concat(n,'"]'));if(t!=null&&c!==void 0)return c;if(t!=null&&m(s)!==void 0)return Promise.resolve(m(s));var i=document.createElement("script");return i.src=n,o.priority!==void 0&&(i.fetchPriority=o.priority),c=new Promise(function(a,r){document.head.appendChild(i),window.addEventListener("TossPayments:initialize:".concat(s),function(){m(s)!==void 0?a(m(s)):r(new Error("[TossPayments SDK] Failed to load script: [".concat(n,"]")))})}),c}function m(n){return window[n]}var R="https://js.tosspayments.com/v1/payment-widget";function T(n,s,o){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=t.src,a=i===void 0?R:i;return typeof window>"u"?Promise.resolve({}):_(a,"PaymentWidget").then(function(r){return r(n,s,o)})}const M="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let W=(n=21)=>{let s="",o=crypto.getRandomValues(new Uint8Array(n));for(;n--;)s+=M[o[n]&63];return s};var L={VITE_BASE_URL:"https://j10c204.p.ssafy.io",VITE_REDIRECT_URL:"https://j10c204.p.ssafy.io",VITE_TOSS_API_KEY:"test_ck_Poxy1XQL8RxWO1957404V7nO5Wml",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const f=W();console.log(f);const C=()=>{const n="test_ck_Poxy1XQL8RxWO1957404V7nO5Wml",s=j(),o=P();console.log(o.state),o.state||s("/");const[t,i]=d.useState(null),[a]=d.useState(o.state),[r]=d.useState(o.state.fundinfo.price),[g,x]=d.useState(!0),[h,p]=d.useState(!1);d.useEffect(()=>{const u=f;console.log(L),(async()=>{try{const l=await T(n,u);i(l)}catch(l){console.error("Error fetching payment widget:",l)}})()},[]),d.useEffect(()=>{if(t==null)return;t.renderPaymentMethods("#payment-widget",{value:r},{variantKey:"DEFAULT"}).on("ready",()=>{p(!0),x(!1)}),t.renderAgreement("#agreement",{variantKey:"AGREEMENT"})},[t,r]);const y=async()=>{if(t==null)return;const v=t.renderPaymentMethods("#payment-widget",{value:r}).getSelectedPaymentMethod().method;try{await(t==null?void 0:t.requestPayment({orderId:f,orderName:a.movieTitle,successUrl:`${window.location.origin}/fund/payment/success?fundingCount=1&fundingId=${a.fundinfo.fundingId}&method=${v}`,failUrl:`${window.location.origin}/fund/payment/fail`}))}catch(l){console.error("Error requesting payment:",l);const w=l.message;E(w)}};return e.jsxs("div",{className:"bg-white h-[100vh] flex flex-col",children:[e.jsxs("div",{className:"text-black bg-[#F5F5F5] rounded-b-[3vh] shadow-bgShadow",children:[e.jsx(N,{centerText:"펀딩신청"}),e.jsxs("div",{className:"flex justify-between p-[3vh]",children:[e.jsx("div",{className:"text-[20px] font-bold",children:"총 결제 금액"}),e.jsxs("div",{className:"text-[20px] font-bold",children:[r,"원"]})]})]}),e.jsxs("div",{className:"flex-1 none-scroll flex flex-col gap-[5vh] overflow-auto w-[100%] pt-[3vh]",children:[e.jsxs("div",{className:"text-[#333D4B] flex flex-col gap-[2vh] px-[3vh] z-10",children:[e.jsx("div",{className:"font-bold text-[20px]",children:"펀딩 정보"}),e.jsxs("div",{className:"flex gap-[2vh]",children:[e.jsx("img",{src:a.poster,alt:"",className:"w-[13vh] rounded-[1vh]"}),e.jsxs("div",{className:"flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{children:a.movieTitle}),e.jsx("div",{children:`${a.fundinfo.date} ${a.fundinfo.time}`}),e.jsx("div",{children:a.fundinfo.cinemaName})]}),e.jsx("div",{children:"일반 1"})]})]})]}),e.jsxs("div",{className:"relative top-[-11vh]",children:[e.jsx("div",{className:"w-[100%] h-[5vh] bg-white absolute top-0 z-[1]"}),e.jsxs("div",{className:"h-[1vh]",children:[e.jsx("div",{id:"payment-widget"}),e.jsx("div",{id:"agreement"})]})]})]}),h&&e.jsx("div",{className:"flex p-[3vh]",children:e.jsx("button",{id:"payment-button",disabled:!h,onClick:y,className:"flex-1 text-[2.5vh] font-bold rounded-[1vh] p-[2vh] shadow-bgRed bg-red-600",children:"결제하기"})}),g&&e.jsx(b,{}),e.jsx(S,{})]})};export{C as default};
