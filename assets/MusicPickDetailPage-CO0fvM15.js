import{i as h,f as u,j as e,R as f,e as k,m as p,a as R,r as o,u as b}from"./index-BRTXqXD8.js";import{G as v}from"./ping-Bhccv61s.js";import{d as y}from"./dayjs.min-Ccx1GtWW.js";import{t as w,T as S}from"./toastMsg-2rmg4Wq8.js";import{y as C}from"./youtubeMusic-xhMXNxMa.js";import{a as M}from"./common-BDZuGjqk.js";import{b as P}from"./atoms-BlNiEAy-.js";import{H as D}from"./Header-2_9HD2r7.js";import{I as _,a as I}from"./index-CqYR_9FH.js";import{L as O}from"./Loading-Hr6NlqCz.js";import"./index-Co6n4StN.js";function V(t){return v({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M388.8 896.4v-27.198c.6-2.2 1.6-4.2 2-6.4 8.8-57.2 56.4-102.4 112.199-106.2 62.4-4.4 115.2 31.199 132.4 89.199 2.2 7.6 3.8 15.6 5.8 23.4v27.2c-.6 1.8-1.6 3.399-1.8 5.399-8.6 52.8-46.6 93-98.6 104.4-4 .8-8 2-12 3h-27.2c-1.8-.6-3.6-1.6-5.4-1.8-52-8.4-91.599-45.4-103.6-96.8-1.2-5-2.6-9.6-3.8-14.2zm252.4-768.797l-.001 27.202c-.6 2.2-1.6 4.2-1.8 6.4-9 57.6-56.8 102.6-113.2 106.2-62.2 4-114.8-32-131.8-90.2-2.2-7.401-3.8-15-5.6-22.401v-27.2c.6-1.8 1.6-3.4 2-5.2 9.6-52 39.8-86 90.2-102.2 6.6-2.2 13.6-3.4 20.4-5.2h27.2c1.8.6 3.6 1.6 5.4 1.8 52.2 8.6 91.6 45.4 103.6 96.8 1.201 4.8 2.401 9.4 3.601 13.999zm-.001 370.801v27.2c-.6 2.2-1.6 4.2-2 6.4-9 57.4-58.6 103.6-114.6 106-63 2.8-116.4-35.2-131.4-93.8-1.6-6.2-3-12.4-4.4-18.6v-27.2c.6-2.2 1.6-4.2 2-6.4 8.8-57.4 58.6-103.601 114.6-106.2 63-3 116.4 35.2 131.4 93.8 1.6 6.4 3 12.6 4.4 18.8z"},child:[]}]})(t)}function A(t){return v({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M120,16V8a8,8,0,0,1,16,0v8a8,8,0,0,1-16,0Zm80,32a8,8,0,0,0,5.66-2.34l8-8a8,8,0,0,0-11.32-11.32l-8,8A8,8,0,0,0,200,48ZM50.34,45.66A8,8,0,0,0,61.66,34.34l-8-8A8,8,0,0,0,42.34,37.66Zm87,26.45a8,8,0,1,0-2.64,15.78C153.67,91.08,168,108.32,168,128a8,8,0,0,0,16,0C184,100.6,163.93,76.57,137.32,72.11ZM232,176v24a16,16,0,0,1-16,16H40a16,16,0,0,1-16-16V176a16,16,0,0,1,16-16V128a88,88,0,0,1,88.67-88c48.15.36,87.33,40.29,87.33,89v31A16,16,0,0,1,232,176ZM56,160H200V129c0-40-32.05-72.71-71.45-73H128a72,72,0,0,0-72,72Zm160,40V176H40v24H216Z"},child:[]}]})(t)}const j=h({key:"optionModalState",default:!1}),m=h({key:"reportModalState",default:!1});h({key:"musicInfoState",default:{address:"",albumImage:"",artist:"",content:"",itemImage:"",pickupStatus:!1,throwId:0,thrownDate:"",title:"",previewUrl:""}});const B=()=>{const t=u(m),s=u(j);return e.jsxs("div",{className:"OptionModal",children:[e.jsx("div",{className:"background",onClick:()=>s(!1)}),e.jsxs("div",{className:"content",children:[e.jsxs("div",{className:"report",children:[e.jsx(A,{}),e.jsx("div",{onClick:()=>{s(!1),t(!0)},children:"신고하기"})]}),e.jsx("button",{className:"close",onClick:()=>s(!1),children:"닫기"})]})]})},E=({content:t})=>{const s=u(m),c=()=>{w("신고 완료"),s(!1)};return e.jsx("li",{onClick:c,children:t})},H=["마음에 들지 않습니다","스팸","혐호 발언 또는 상징","불법 또는 규제 상품 판매","기타 문제"],T=()=>{const t=u(m);return e.jsxs("div",{className:"ReportModal",children:[e.jsx("div",{className:"background",onClick:()=>t(!1)}),e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"report",children:"신고"}),e.jsx("hr",{}),e.jsxs("div",{className:"content",children:[e.jsxs("div",{className:"title",children:[e.jsx("div",{children:"이 음악을 신고하는 이유"}),e.jsx("div",{children:"회원님의 신고는 익명으로 처리됩니다."})]}),e.jsx("ul",{className:"reson",children:H.map(s=>e.jsx(E,{content:s},s))})]})]})]})},Z=async t=>{try{const{data:s}=await M().get(`/music/thrown/${t}`);return s}catch(s){throw console.error(s),s}},U=async t=>{try{await M().post(`/music/pick/${t}`)}catch(s){throw s}},$=({musicInfo:t})=>{const s=f(m),[c,l]=k(j),r=p(P),n=R(),a=y(t.thrownDate),x=async()=>{try{await U(t.throwId),r(),n("/")}catch(d){console.error(d)}},i=()=>{const d=encodeURIComponent(t.title),g=encodeURIComponent(t.artist),N=`https://music.youtube.com/search?q=${d}-${g}`;window.location.href=N};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"MusicPickDetailBottom",children:[e.jsxs("div",{className:"top",children:[e.jsx("div",{className:"option",children:e.jsx(V,{onClick:()=>l(!0)})}),e.jsx("div",{className:"content",children:t.content}),e.jsx("div",{className:"date",children:a.format("YY.MM.DD")})]}),e.jsxs("div",{className:"bottom",children:[e.jsxs("button",{className:"listen",onClick:i,children:[e.jsx("img",{src:C,alt:""}),e.jsx("div",{children:"바로 듣기"})]}),e.jsx("button",{className:`pick ${t.pickupStatus&&"disable"}`,onClick:x,disabled:t.pickupStatus,children:"줍기"})]})]}),c&&e.jsx(B,{}),s&&e.jsx(T,{}),e.jsx(S,{})]})},W=({musicInfo:t})=>{const s=o.useRef(null),[c,l]=o.useState(!1),[r,n]=o.useState(!0),a=o.useRef(null);o.useEffect(()=>{if(s.current){const i=s.current.scrollWidth,d=s.current.clientWidth;i>d?l(!0):l(!1)}a.current&&a.current.play().catch(i=>{console.error("Audio play failed",i),n(!1)})},[]);const x=()=>{a.current&&(r?a.current.pause():a.current.play(),n(!r))};return e.jsxs("div",{className:"MusicPickDetailTop",children:[e.jsx("img",{className:"album-image",src:t.albumImage,alt:""}),e.jsxs("div",{className:"cover",children:[e.jsx("div",{className:"black-cover"}),e.jsx("div",{className:"black-gradient"}),e.jsxs("div",{className:"content",children:[e.jsx(D,{centerText:t.address,type:"address"}),t.previewUrl&&e.jsxs("div",{className:"volume",onClick:x,children:[r?e.jsx(_,{}):e.jsx(I,{}),e.jsx("audio",{ref:a,src:t.previewUrl})]}),e.jsxs("div",{className:"content-bottom",children:[e.jsxs("div",{children:[e.jsx("div",{className:"title",children:e.jsx("div",{ref:s,className:`scrolling-text ${c?"animated":""}`,children:t.title})}),e.jsx("div",{className:"artist",children:t.artist})]}),e.jsx("img",{src:t.itemImage||t.albumImage,alt:"",onError:i=>{i.currentTarget.src=t.albumImage}})]})]})]})]})},te=()=>{const t=p(j),s=p(m),[c,l]=o.useState({address:"",albumImage:"",artist:"",content:"",itemImage:"",pickupStatus:!1,throwId:0,thrownDate:"",title:""}),{id:r}=b(),n=async()=>{try{const a=await Z(r);l(a)}catch(a){console.log(a)}};return o.useEffect(()=>{t(),s(),n()},[]),e.jsx("div",{className:"MusicPickDetailPage",children:c.artist?e.jsxs(e.Fragment,{children:[e.jsx(W,{musicInfo:c}),e.jsx($,{musicInfo:c})]}):e.jsx(O,{})})};export{te as default};
