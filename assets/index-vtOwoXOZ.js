var fS=Object.defineProperty;var pS=(rp,_d,np)=>_d in rp?fS(rp,_d,{enumerable:!0,configurable:!0,writable:!0,value:np}):rp[_d]=np;var Zv=(rp,_d,np)=>(pS(rp,typeof _d!="symbol"?_d+"":_d,np),np);function _mergeNamespaces(rp,_d){for(var np=0;np<_d.length;np++){const ap=_d[np];if(typeof ap!="string"&&!Array.isArray(ap)){for(const sp in ap)if(sp!=="default"&&!(sp in rp)){const lp=Object.getOwnPropertyDescriptor(ap,sp);lp&&Object.defineProperty(rp,sp,lp.get?lp:{enumerable:!0,get:()=>ap[sp]})}}}return Object.freeze(Object.defineProperty(rp,Symbol.toStringTag,{value:"Module"}))}(function(){const _d=document.createElement("link").relList;if(_d&&_d.supports&&_d.supports("modulepreload"))return;for(const sp of document.querySelectorAll('link[rel="modulepreload"]'))ap(sp);new MutationObserver(sp=>{for(const lp of sp)if(lp.type==="childList")for(const up of lp.addedNodes)up.tagName==="LINK"&&up.rel==="modulepreload"&&ap(up)}).observe(document,{childList:!0,subtree:!0});function np(sp){const lp={};return sp.integrity&&(lp.integrity=sp.integrity),sp.referrerPolicy&&(lp.referrerPolicy=sp.referrerPolicy),sp.crossOrigin==="use-credentials"?lp.credentials="include":sp.crossOrigin==="anonymous"?lp.credentials="omit":lp.credentials="same-origin",lp}function ap(sp){if(sp.ep)return;sp.ep=!0;const lp=np(sp);fetch(sp.href,lp)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(rp){return rp&&rp.__esModule&&Object.prototype.hasOwnProperty.call(rp,"default")?rp.default:rp}function getAugmentedNamespace(rp){if(rp.__esModule)return rp;var _d=rp.default;if(typeof _d=="function"){var np=function ap(){return this instanceof ap?Reflect.construct(_d,arguments,this.constructor):_d.apply(this,arguments)};np.prototype=_d.prototype}else np={};return Object.defineProperty(np,"__esModule",{value:!0}),Object.keys(rp).forEach(function(ap){var sp=Object.getOwnPropertyDescriptor(rp,ap);Object.defineProperty(np,ap,sp.get?sp:{enumerable:!0,get:function(){return rp[ap]}})}),np}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$3=Symbol.for("react.element"),n$3=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r$2=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$4=Symbol.for("react.forward_ref"),w$2=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$2(rp){return rp===null||typeof rp!="object"?null:(rp=z$2&&rp[z$2]||rp["@@iterator"],typeof rp=="function"?rp:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$2(rp,_d,np){this.props=rp,this.context=_d,this.refs=D$2,this.updater=np||B$2}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(rp,_d){if(typeof rp!="object"&&typeof rp!="function"&&rp!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,rp,_d,"setState")};E$2.prototype.forceUpdate=function(rp){this.updater.enqueueForceUpdate(this,rp,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$2(rp,_d,np){this.props=rp,this.context=_d,this.refs=D$2,this.updater=np||B$2}var H$2=G$2.prototype=new F$1;H$2.constructor=G$2;C$2(H$2,E$2.prototype);H$2.isPureReactComponent=!0;var I$2=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$2={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$2(rp,_d,np){var ap,sp={},lp=null,up=null;if(_d!=null)for(ap in _d.ref!==void 0&&(up=_d.ref),_d.key!==void 0&&(lp=""+_d.key),_d)J$1.call(_d,ap)&&!L$2.hasOwnProperty(ap)&&(sp[ap]=_d[ap]);var cp=arguments.length-2;if(cp===1)sp.children=np;else if(1<cp){for(var dp=Array(cp),hp=0;hp<cp;hp++)dp[hp]=arguments[hp+2];sp.children=dp}if(rp&&rp.defaultProps)for(ap in cp=rp.defaultProps,cp)sp[ap]===void 0&&(sp[ap]=cp[ap]);return{$$typeof:l$3,type:rp,key:lp,ref:up,props:sp,_owner:K$2.current}}function N$2(rp,_d){return{$$typeof:l$3,type:rp.type,key:_d,ref:rp.ref,props:rp.props,_owner:rp._owner}}function O$2(rp){return typeof rp=="object"&&rp!==null&&rp.$$typeof===l$3}function escape$1(rp){var _d={"=":"=0",":":"=2"};return"$"+rp.replace(/[=:]/g,function(np){return _d[np]})}var P$2=/\/+/g;function Q$2(rp,_d){return typeof rp=="object"&&rp!==null&&rp.key!=null?escape$1(""+rp.key):_d.toString(36)}function R$3(rp,_d,np,ap,sp){var lp=typeof rp;(lp==="undefined"||lp==="boolean")&&(rp=null);var up=!1;if(rp===null)up=!0;else switch(lp){case"string":case"number":up=!0;break;case"object":switch(rp.$$typeof){case l$3:case n$3:up=!0}}if(up)return up=rp,sp=sp(up),rp=ap===""?"."+Q$2(up,0):ap,I$2(sp)?(np="",rp!=null&&(np=rp.replace(P$2,"$&/")+"/"),R$3(sp,_d,np,"",function(hp){return hp})):sp!=null&&(O$2(sp)&&(sp=N$2(sp,np+(!sp.key||up&&up.key===sp.key?"":(""+sp.key).replace(P$2,"$&/")+"/")+rp)),_d.push(sp)),1;if(up=0,ap=ap===""?".":ap+":",I$2(rp))for(var cp=0;cp<rp.length;cp++){lp=rp[cp];var dp=ap+Q$2(lp,cp);up+=R$3(lp,_d,np,dp,sp)}else if(dp=A$2(rp),typeof dp=="function")for(rp=dp.call(rp),cp=0;!(lp=rp.next()).done;)lp=lp.value,dp=ap+Q$2(lp,cp++),up+=R$3(lp,_d,np,dp,sp);else if(lp==="object")throw _d=String(rp),Error("Objects are not valid as a React child (found: "+(_d==="[object Object]"?"object with keys {"+Object.keys(rp).join(", ")+"}":_d)+"). If you meant to render a collection of children, use an array instead.");return up}function S$2(rp,_d,np){if(rp==null)return rp;var ap=[],sp=0;return R$3(rp,ap,"","",function(lp){return _d.call(np,lp,sp++)}),ap}function T$2(rp){if(rp._status===-1){var _d=rp._result;_d=_d(),_d.then(function(np){(rp._status===0||rp._status===-1)&&(rp._status=1,rp._result=np)},function(np){(rp._status===0||rp._status===-1)&&(rp._status=2,rp._result=np)}),rp._status===-1&&(rp._status=0,rp._result=_d)}if(rp._status===1)return rp._result.default;throw rp._result}var U$2={current:null},V$2={transition:null},W$2={ReactCurrentDispatcher:U$2,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$2};react_production_min.Children={map:S$2,forEach:function(rp,_d,np){S$2(rp,function(){_d.apply(this,arguments)},np)},count:function(rp){var _d=0;return S$2(rp,function(){_d++}),_d},toArray:function(rp){return S$2(rp,function(_d){return _d})||[]},only:function(rp){if(!O$2(rp))throw Error("React.Children.only expected to receive a single React element child.");return rp}};react_production_min.Component=E$2;react_production_min.Fragment=p$3;react_production_min.Profiler=r$2;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$2;react_production_min.Suspense=w$2;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.cloneElement=function(rp,_d,np){if(rp==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+rp+".");var ap=C$2({},rp.props),sp=rp.key,lp=rp.ref,up=rp._owner;if(_d!=null){if(_d.ref!==void 0&&(lp=_d.ref,up=K$2.current),_d.key!==void 0&&(sp=""+_d.key),rp.type&&rp.type.defaultProps)var cp=rp.type.defaultProps;for(dp in _d)J$1.call(_d,dp)&&!L$2.hasOwnProperty(dp)&&(ap[dp]=_d[dp]===void 0&&cp!==void 0?cp[dp]:_d[dp])}var dp=arguments.length-2;if(dp===1)ap.children=np;else if(1<dp){cp=Array(dp);for(var hp=0;hp<dp;hp++)cp[hp]=arguments[hp+2];ap.children=cp}return{$$typeof:l$3,type:rp.type,key:sp,ref:lp,props:ap,_owner:up}};react_production_min.createContext=function(rp){return rp={$$typeof:u$1,_currentValue:rp,_currentValue2:rp,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},rp.Provider={$$typeof:t$2,_context:rp},rp.Consumer=rp};react_production_min.createElement=M$2;react_production_min.createFactory=function(rp){var _d=M$2.bind(null,rp);return _d.type=rp,_d};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(rp){return{$$typeof:v$4,render:rp}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(rp){return{$$typeof:y$1,_payload:{_status:-1,_result:rp},_init:T$2}};react_production_min.memo=function(rp,_d){return{$$typeof:x$1,type:rp,compare:_d===void 0?null:_d}};react_production_min.startTransition=function(rp){var _d=V$2.transition;V$2.transition={};try{rp()}finally{V$2.transition=_d}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(rp,_d){return U$2.current.useCallback(rp,_d)};react_production_min.useContext=function(rp){return U$2.current.useContext(rp)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(rp){return U$2.current.useDeferredValue(rp)};react_production_min.useEffect=function(rp,_d){return U$2.current.useEffect(rp,_d)};react_production_min.useId=function(){return U$2.current.useId()};react_production_min.useImperativeHandle=function(rp,_d,np){return U$2.current.useImperativeHandle(rp,_d,np)};react_production_min.useInsertionEffect=function(rp,_d){return U$2.current.useInsertionEffect(rp,_d)};react_production_min.useLayoutEffect=function(rp,_d){return U$2.current.useLayoutEffect(rp,_d)};react_production_min.useMemo=function(rp,_d){return U$2.current.useMemo(rp,_d)};react_production_min.useReducer=function(rp,_d,np){return U$2.current.useReducer(rp,_d,np)};react_production_min.useRef=function(rp){return U$2.current.useRef(rp)};react_production_min.useState=function(rp){return U$2.current.useState(rp)};react_production_min.useSyncExternalStore=function(rp,_d,np){return U$2.current.useSyncExternalStore(rp,_d,np)};react_production_min.useTransition=function(){return U$2.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$2=reactExports,k$2=Symbol.for("react.element"),l$2=Symbol.for("react.fragment"),m$3=Object.prototype.hasOwnProperty,n$2=f$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$1(rp,_d,np){var ap,sp={},lp=null,up=null;np!==void 0&&(lp=""+np),_d.key!==void 0&&(lp=""+_d.key),_d.ref!==void 0&&(up=_d.ref);for(ap in _d)m$3.call(_d,ap)&&!p$2.hasOwnProperty(ap)&&(sp[ap]=_d[ap]);if(rp&&rp.defaultProps)for(ap in _d=rp.defaultProps,_d)sp[ap]===void 0&&(sp[ap]=_d[ap]);return{$$typeof:k$2,type:rp,key:lp,ref:up,props:sp,_owner:n$2.current}}reactJsxRuntime_production_min.Fragment=l$2;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler$2={exports:{}},scheduler_production_min$2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(rp){function _d(Ip,kp){var Up=Ip.length;Ip.push(kp);e:for(;0<Up;){var Gp=Up-1>>>1,Wp=Ip[Gp];if(0<sp(Wp,kp))Ip[Gp]=kp,Ip[Up]=Wp,Up=Gp;else break e}}function np(Ip){return Ip.length===0?null:Ip[0]}function ap(Ip){if(Ip.length===0)return null;var kp=Ip[0],Up=Ip.pop();if(Up!==kp){Ip[0]=Up;e:for(var Gp=0,Wp=Ip.length,Qp=Wp>>>1;Gp<Qp;){var Xp=2*(Gp+1)-1,rm=Ip[Xp],Kp=Xp+1,lm=Ip[Kp];if(0>sp(rm,Up))Kp<Wp&&0>sp(lm,rm)?(Ip[Gp]=lm,Ip[Kp]=Up,Gp=Kp):(Ip[Gp]=rm,Ip[Xp]=Up,Gp=Xp);else if(Kp<Wp&&0>sp(lm,Up))Ip[Gp]=lm,Ip[Kp]=Up,Gp=Kp;else break e}}return kp}function sp(Ip,kp){var Up=Ip.sortIndex-kp.sortIndex;return Up!==0?Up:Ip.id-kp.id}if(typeof performance=="object"&&typeof performance.now=="function"){var lp=performance;rp.unstable_now=function(){return lp.now()}}else{var up=Date,cp=up.now();rp.unstable_now=function(){return up.now()-cp}}var dp=[],hp=[],fp=1,pp=null,mp=3,gp=!1,yp=!1,xp=!1,_p=typeof setTimeout=="function"?setTimeout:null,vp=typeof clearTimeout=="function"?clearTimeout:null,bp=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Ep(Ip){for(var kp=np(hp);kp!==null;){if(kp.callback===null)ap(hp);else if(kp.startTime<=Ip)ap(hp),kp.sortIndex=kp.expirationTime,_d(dp,kp);else break;kp=np(hp)}}function Sp(Ip){if(xp=!1,Ep(Ip),!yp)if(np(dp)!==null)yp=!0,Lp(Ap);else{var kp=np(hp);kp!==null&&Bp(Sp,kp.startTime-Ip)}}function Ap(Ip,kp){yp=!1,xp&&(xp=!1,vp(Mp),Mp=-1),gp=!0;var Up=mp;try{for(Ep(kp),pp=np(dp);pp!==null&&(!(pp.expirationTime>kp)||Ip&&!$p());){var Gp=pp.callback;if(typeof Gp=="function"){pp.callback=null,mp=pp.priorityLevel;var Wp=Gp(pp.expirationTime<=kp);kp=rp.unstable_now(),typeof Wp=="function"?pp.callback=Wp:pp===np(dp)&&ap(dp),Ep(kp)}else ap(dp);pp=np(dp)}if(pp!==null)var Qp=!0;else{var Xp=np(hp);Xp!==null&&Bp(Sp,Xp.startTime-kp),Qp=!1}return Qp}finally{pp=null,mp=Up,gp=!1}}var Rp=!1,Tp=null,Mp=-1,Op=5,Pp=-1;function $p(){return!(rp.unstable_now()-Pp<Op)}function zp(){if(Tp!==null){var Ip=rp.unstable_now();Pp=Ip;var kp=!0;try{kp=Tp(!0,Ip)}finally{kp?Dp():(Rp=!1,Tp=null)}}else Rp=!1}var Dp;if(typeof bp=="function")Dp=function(){bp(zp)};else if(typeof MessageChannel<"u"){var Fp=new MessageChannel,jp=Fp.port2;Fp.port1.onmessage=zp,Dp=function(){jp.postMessage(null)}}else Dp=function(){_p(zp,0)};function Lp(Ip){Tp=Ip,Rp||(Rp=!0,Dp())}function Bp(Ip,kp){Mp=_p(function(){Ip(rp.unstable_now())},kp)}rp.unstable_IdlePriority=5,rp.unstable_ImmediatePriority=1,rp.unstable_LowPriority=4,rp.unstable_NormalPriority=3,rp.unstable_Profiling=null,rp.unstable_UserBlockingPriority=2,rp.unstable_cancelCallback=function(Ip){Ip.callback=null},rp.unstable_continueExecution=function(){yp||gp||(yp=!0,Lp(Ap))},rp.unstable_forceFrameRate=function(Ip){0>Ip||125<Ip?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Op=0<Ip?Math.floor(1e3/Ip):5},rp.unstable_getCurrentPriorityLevel=function(){return mp},rp.unstable_getFirstCallbackNode=function(){return np(dp)},rp.unstable_next=function(Ip){switch(mp){case 1:case 2:case 3:var kp=3;break;default:kp=mp}var Up=mp;mp=kp;try{return Ip()}finally{mp=Up}},rp.unstable_pauseExecution=function(){},rp.unstable_requestPaint=function(){},rp.unstable_runWithPriority=function(Ip,kp){switch(Ip){case 1:case 2:case 3:case 4:case 5:break;default:Ip=3}var Up=mp;mp=Ip;try{return kp()}finally{mp=Up}},rp.unstable_scheduleCallback=function(Ip,kp,Up){var Gp=rp.unstable_now();switch(typeof Up=="object"&&Up!==null?(Up=Up.delay,Up=typeof Up=="number"&&0<Up?Gp+Up:Gp):Up=Gp,Ip){case 1:var Wp=-1;break;case 2:Wp=250;break;case 5:Wp=1073741823;break;case 4:Wp=1e4;break;default:Wp=5e3}return Wp=Up+Wp,Ip={id:fp++,callback:kp,priorityLevel:Ip,startTime:Up,expirationTime:Wp,sortIndex:-1},Up>Gp?(Ip.sortIndex=Up,_d(hp,Ip),np(dp)===null&&Ip===np(hp)&&(xp?(vp(Mp),Mp=-1):xp=!0,Bp(Sp,Up-Gp))):(Ip.sortIndex=Wp,_d(dp,Ip),yp||gp||(yp=!0,Lp(Ap))),Ip},rp.unstable_shouldYield=$p,rp.unstable_wrapCallback=function(Ip){var kp=mp;return function(){var Up=mp;mp=kp;try{return Ip.apply(this,arguments)}finally{mp=Up}}}})(scheduler_production_min$2);scheduler$2.exports=scheduler_production_min$2;var schedulerExports$1=scheduler$2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa$1=reactExports,ca$1=schedulerExports$1;function p$1(rp){for(var _d="https://reactjs.org/docs/error-decoder.html?invariant="+rp,np=1;np<arguments.length;np++)_d+="&args[]="+encodeURIComponent(arguments[np]);return"Minified React error #"+rp+"; visit "+_d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da$1=new Set,ea$1={};function fa$1(rp,_d){ha$1(rp,_d),ha$1(rp+"Capture",_d)}function ha$1(rp,_d){for(ea$1[rp]=_d,rp=0;rp<_d.length;rp++)da$1.add(_d[rp])}var ia$1=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja$1=Object.prototype.hasOwnProperty,ka$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la$1={},ma$1={};function oa$1(rp){return ja$1.call(ma$1,rp)?!0:ja$1.call(la$1,rp)?!1:ka$1.test(rp)?ma$1[rp]=!0:(la$1[rp]=!0,!1)}function pa$1(rp,_d,np,ap){if(np!==null&&np.type===0)return!1;switch(typeof _d){case"function":case"symbol":return!0;case"boolean":return ap?!1:np!==null?!np.acceptsBooleans:(rp=rp.toLowerCase().slice(0,5),rp!=="data-"&&rp!=="aria-");default:return!1}}function qa$1(rp,_d,np,ap){if(_d===null||typeof _d>"u"||pa$1(rp,_d,np,ap))return!0;if(ap)return!1;if(np!==null)switch(np.type){case 3:return!_d;case 4:return _d===!1;case 5:return isNaN(_d);case 6:return isNaN(_d)||1>_d}return!1}function v$3(rp,_d,np,ap,sp,lp,up){this.acceptsBooleans=_d===2||_d===3||_d===4,this.attributeName=ap,this.attributeNamespace=sp,this.mustUseProperty=np,this.propertyName=rp,this.type=_d,this.sanitizeURL=lp,this.removeEmptyString=up}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(rp){z$1[rp]=new v$3(rp,0,!1,rp,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(rp){var _d=rp[0];z$1[_d]=new v$3(_d,1,!1,rp[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(rp){z$1[rp]=new v$3(rp,2,!1,rp.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(rp){z$1[rp]=new v$3(rp,2,!1,rp,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(rp){z$1[rp]=new v$3(rp,3,!1,rp.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(rp){z$1[rp]=new v$3(rp,3,!0,rp,null,!1,!1)});["capture","download"].forEach(function(rp){z$1[rp]=new v$3(rp,4,!1,rp,null,!1,!1)});["cols","rows","size","span"].forEach(function(rp){z$1[rp]=new v$3(rp,6,!1,rp,null,!1,!1)});["rowSpan","start"].forEach(function(rp){z$1[rp]=new v$3(rp,5,!1,rp.toLowerCase(),null,!1,!1)});var ra$1=/[\-:]([a-z])/g;function sa$1(rp){return rp[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(rp){var _d=rp.replace(ra$1,sa$1);z$1[_d]=new v$3(_d,1,!1,rp,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(rp){var _d=rp.replace(ra$1,sa$1);z$1[_d]=new v$3(_d,1,!1,rp,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(rp){var _d=rp.replace(ra$1,sa$1);z$1[_d]=new v$3(_d,1,!1,rp,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(rp){z$1[rp]=new v$3(rp,1,!1,rp.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$3("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(rp){z$1[rp]=new v$3(rp,1,!1,rp.toLowerCase(),null,!0,!0)});function ta$1(rp,_d,np,ap){var sp=z$1.hasOwnProperty(_d)?z$1[_d]:null;(sp!==null?sp.type!==0:ap||!(2<_d.length)||_d[0]!=="o"&&_d[0]!=="O"||_d[1]!=="n"&&_d[1]!=="N")&&(qa$1(_d,np,sp,ap)&&(np=null),ap||sp===null?oa$1(_d)&&(np===null?rp.removeAttribute(_d):rp.setAttribute(_d,""+np)):sp.mustUseProperty?rp[sp.propertyName]=np===null?sp.type===3?!1:"":np:(_d=sp.attributeName,ap=sp.attributeNamespace,np===null?rp.removeAttribute(_d):(sp=sp.type,np=sp===3||sp===4&&np===!0?"":""+np,ap?rp.setAttributeNS(ap,_d,np):rp.setAttribute(_d,np))))}var ua$1=aa$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va$1=Symbol.for("react.element"),wa$1=Symbol.for("react.portal"),ya$1=Symbol.for("react.fragment"),za$1=Symbol.for("react.strict_mode"),Aa$1=Symbol.for("react.profiler"),Ba$1=Symbol.for("react.provider"),Ca$1=Symbol.for("react.context"),Da$1=Symbol.for("react.forward_ref"),Ea$1=Symbol.for("react.suspense"),Fa$1=Symbol.for("react.suspense_list"),Ga$1=Symbol.for("react.memo"),Ha$1=Symbol.for("react.lazy"),Ia$1=Symbol.for("react.offscreen"),Ja$1=Symbol.iterator;function Ka$1(rp){return rp===null||typeof rp!="object"?null:(rp=Ja$1&&rp[Ja$1]||rp["@@iterator"],typeof rp=="function"?rp:null)}var A$1=Object.assign,La$1;function Ma$1(rp){if(La$1===void 0)try{throw Error()}catch(np){var _d=np.stack.trim().match(/\n( *(at )?)/);La$1=_d&&_d[1]||""}return`
`+La$1+rp}var Na$1=!1;function Oa$1(rp,_d){if(!rp||Na$1)return"";Na$1=!0;var np=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_d)if(_d=function(){throw Error()},Object.defineProperty(_d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_d,[])}catch(hp){var ap=hp}Reflect.construct(rp,[],_d)}else{try{_d.call()}catch(hp){ap=hp}rp.call(_d.prototype)}else{try{throw Error()}catch(hp){ap=hp}rp()}}catch(hp){if(hp&&ap&&typeof hp.stack=="string"){for(var sp=hp.stack.split(`
`),lp=ap.stack.split(`
`),up=sp.length-1,cp=lp.length-1;1<=up&&0<=cp&&sp[up]!==lp[cp];)cp--;for(;1<=up&&0<=cp;up--,cp--)if(sp[up]!==lp[cp]){if(up!==1||cp!==1)do if(up--,cp--,0>cp||sp[up]!==lp[cp]){var dp=`
`+sp[up].replace(" at new "," at ");return rp.displayName&&dp.includes("<anonymous>")&&(dp=dp.replace("<anonymous>",rp.displayName)),dp}while(1<=up&&0<=cp);break}}}finally{Na$1=!1,Error.prepareStackTrace=np}return(rp=rp?rp.displayName||rp.name:"")?Ma$1(rp):""}function Pa$1(rp){switch(rp.tag){case 5:return Ma$1(rp.type);case 16:return Ma$1("Lazy");case 13:return Ma$1("Suspense");case 19:return Ma$1("SuspenseList");case 0:case 2:case 15:return rp=Oa$1(rp.type,!1),rp;case 11:return rp=Oa$1(rp.type.render,!1),rp;case 1:return rp=Oa$1(rp.type,!0),rp;default:return""}}function Qa$1(rp){if(rp==null)return null;if(typeof rp=="function")return rp.displayName||rp.name||null;if(typeof rp=="string")return rp;switch(rp){case ya$1:return"Fragment";case wa$1:return"Portal";case Aa$1:return"Profiler";case za$1:return"StrictMode";case Ea$1:return"Suspense";case Fa$1:return"SuspenseList"}if(typeof rp=="object")switch(rp.$$typeof){case Ca$1:return(rp.displayName||"Context")+".Consumer";case Ba$1:return(rp._context.displayName||"Context")+".Provider";case Da$1:var _d=rp.render;return rp=rp.displayName,rp||(rp=_d.displayName||_d.name||"",rp=rp!==""?"ForwardRef("+rp+")":"ForwardRef"),rp;case Ga$1:return _d=rp.displayName||null,_d!==null?_d:Qa$1(rp.type)||"Memo";case Ha$1:_d=rp._payload,rp=rp._init;try{return Qa$1(rp(_d))}catch{}}return null}function Ra$1(rp){var _d=rp.type;switch(rp.tag){case 24:return"Cache";case 9:return(_d.displayName||"Context")+".Consumer";case 10:return(_d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return rp=_d.render,rp=rp.displayName||rp.name||"",_d.displayName||(rp!==""?"ForwardRef("+rp+")":"ForwardRef");case 7:return"Fragment";case 5:return _d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa$1(_d);case 8:return _d===za$1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _d=="function")return _d.displayName||_d.name||null;if(typeof _d=="string")return _d}return null}function Sa$1(rp){switch(typeof rp){case"boolean":case"number":case"string":case"undefined":return rp;case"object":return rp;default:return""}}function Ta$1(rp){var _d=rp.type;return(rp=rp.nodeName)&&rp.toLowerCase()==="input"&&(_d==="checkbox"||_d==="radio")}function Ua$1(rp){var _d=Ta$1(rp)?"checked":"value",np=Object.getOwnPropertyDescriptor(rp.constructor.prototype,_d),ap=""+rp[_d];if(!rp.hasOwnProperty(_d)&&typeof np<"u"&&typeof np.get=="function"&&typeof np.set=="function"){var sp=np.get,lp=np.set;return Object.defineProperty(rp,_d,{configurable:!0,get:function(){return sp.call(this)},set:function(up){ap=""+up,lp.call(this,up)}}),Object.defineProperty(rp,_d,{enumerable:np.enumerable}),{getValue:function(){return ap},setValue:function(up){ap=""+up},stopTracking:function(){rp._valueTracker=null,delete rp[_d]}}}}function Va$1(rp){rp._valueTracker||(rp._valueTracker=Ua$1(rp))}function Wa$1(rp){if(!rp)return!1;var _d=rp._valueTracker;if(!_d)return!0;var np=_d.getValue(),ap="";return rp&&(ap=Ta$1(rp)?rp.checked?"true":"false":rp.value),rp=ap,rp!==np?(_d.setValue(rp),!0):!1}function Xa$1(rp){if(rp=rp||(typeof document<"u"?document:void 0),typeof rp>"u")return null;try{return rp.activeElement||rp.body}catch{return rp.body}}function Ya$1(rp,_d){var np=_d.checked;return A$1({},_d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:np??rp._wrapperState.initialChecked})}function Za$1(rp,_d){var np=_d.defaultValue==null?"":_d.defaultValue,ap=_d.checked!=null?_d.checked:_d.defaultChecked;np=Sa$1(_d.value!=null?_d.value:np),rp._wrapperState={initialChecked:ap,initialValue:np,controlled:_d.type==="checkbox"||_d.type==="radio"?_d.checked!=null:_d.value!=null}}function ab(rp,_d){_d=_d.checked,_d!=null&&ta$1(rp,"checked",_d,!1)}function bb(rp,_d){ab(rp,_d);var np=Sa$1(_d.value),ap=_d.type;if(np!=null)ap==="number"?(np===0&&rp.value===""||rp.value!=np)&&(rp.value=""+np):rp.value!==""+np&&(rp.value=""+np);else if(ap==="submit"||ap==="reset"){rp.removeAttribute("value");return}_d.hasOwnProperty("value")?cb(rp,_d.type,np):_d.hasOwnProperty("defaultValue")&&cb(rp,_d.type,Sa$1(_d.defaultValue)),_d.checked==null&&_d.defaultChecked!=null&&(rp.defaultChecked=!!_d.defaultChecked)}function db(rp,_d,np){if(_d.hasOwnProperty("value")||_d.hasOwnProperty("defaultValue")){var ap=_d.type;if(!(ap!=="submit"&&ap!=="reset"||_d.value!==void 0&&_d.value!==null))return;_d=""+rp._wrapperState.initialValue,np||_d===rp.value||(rp.value=_d),rp.defaultValue=_d}np=rp.name,np!==""&&(rp.name=""),rp.defaultChecked=!!rp._wrapperState.initialChecked,np!==""&&(rp.name=np)}function cb(rp,_d,np){(_d!=="number"||Xa$1(rp.ownerDocument)!==rp)&&(np==null?rp.defaultValue=""+rp._wrapperState.initialValue:rp.defaultValue!==""+np&&(rp.defaultValue=""+np))}var eb=Array.isArray;function fb(rp,_d,np,ap){if(rp=rp.options,_d){_d={};for(var sp=0;sp<np.length;sp++)_d["$"+np[sp]]=!0;for(np=0;np<rp.length;np++)sp=_d.hasOwnProperty("$"+rp[np].value),rp[np].selected!==sp&&(rp[np].selected=sp),sp&&ap&&(rp[np].defaultSelected=!0)}else{for(np=""+Sa$1(np),_d=null,sp=0;sp<rp.length;sp++){if(rp[sp].value===np){rp[sp].selected=!0,ap&&(rp[sp].defaultSelected=!0);return}_d!==null||rp[sp].disabled||(_d=rp[sp])}_d!==null&&(_d.selected=!0)}}function gb(rp,_d){if(_d.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},_d,{value:void 0,defaultValue:void 0,children:""+rp._wrapperState.initialValue})}function hb(rp,_d){var np=_d.value;if(np==null){if(np=_d.children,_d=_d.defaultValue,np!=null){if(_d!=null)throw Error(p$1(92));if(eb(np)){if(1<np.length)throw Error(p$1(93));np=np[0]}_d=np}_d==null&&(_d=""),np=_d}rp._wrapperState={initialValue:Sa$1(np)}}function ib(rp,_d){var np=Sa$1(_d.value),ap=Sa$1(_d.defaultValue);np!=null&&(np=""+np,np!==rp.value&&(rp.value=np),_d.defaultValue==null&&rp.defaultValue!==np&&(rp.defaultValue=np)),ap!=null&&(rp.defaultValue=""+ap)}function jb(rp){var _d=rp.textContent;_d===rp._wrapperState.initialValue&&_d!==""&&_d!==null&&(rp.value=_d)}function kb(rp){switch(rp){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(rp,_d){return rp==null||rp==="http://www.w3.org/1999/xhtml"?kb(_d):rp==="http://www.w3.org/2000/svg"&&_d==="foreignObject"?"http://www.w3.org/1999/xhtml":rp}var mb,nb=function(rp){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(_d,np,ap,sp){MSApp.execUnsafeLocalFunction(function(){return rp(_d,np,ap,sp)})}:rp}(function(rp,_d){if(rp.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in rp)rp.innerHTML=_d;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+_d.valueOf().toString()+"</svg>",_d=mb.firstChild;rp.firstChild;)rp.removeChild(rp.firstChild);for(;_d.firstChild;)rp.appendChild(_d.firstChild)}});function ob(rp,_d){if(_d){var np=rp.firstChild;if(np&&np===rp.lastChild&&np.nodeType===3){np.nodeValue=_d;return}}rp.textContent=_d}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(rp){qb.forEach(function(_d){_d=_d+rp.charAt(0).toUpperCase()+rp.substring(1),pb[_d]=pb[rp]})});function rb(rp,_d,np){return _d==null||typeof _d=="boolean"||_d===""?"":np||typeof _d!="number"||_d===0||pb.hasOwnProperty(rp)&&pb[rp]?(""+_d).trim():_d+"px"}function sb(rp,_d){rp=rp.style;for(var np in _d)if(_d.hasOwnProperty(np)){var ap=np.indexOf("--")===0,sp=rb(np,_d[np],ap);np==="float"&&(np="cssFloat"),ap?rp.setProperty(np,sp):rp[np]=sp}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(rp,_d){if(_d){if(tb[rp]&&(_d.children!=null||_d.dangerouslySetInnerHTML!=null))throw Error(p$1(137,rp));if(_d.dangerouslySetInnerHTML!=null){if(_d.children!=null)throw Error(p$1(60));if(typeof _d.dangerouslySetInnerHTML!="object"||!("__html"in _d.dangerouslySetInnerHTML))throw Error(p$1(61))}if(_d.style!=null&&typeof _d.style!="object")throw Error(p$1(62))}}function vb(rp,_d){if(rp.indexOf("-")===-1)return typeof _d.is=="string";switch(rp){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(rp){return rp=rp.target||rp.srcElement||window,rp.correspondingUseElement&&(rp=rp.correspondingUseElement),rp.nodeType===3?rp.parentNode:rp}var yb=null,zb=null,Ab=null;function Bb(rp){if(rp=Cb(rp)){if(typeof yb!="function")throw Error(p$1(280));var _d=rp.stateNode;_d&&(_d=Db(_d),yb(rp.stateNode,rp.type,_d))}}function Eb(rp){zb?Ab?Ab.push(rp):Ab=[rp]:zb=rp}function Fb(){if(zb){var rp=zb,_d=Ab;if(Ab=zb=null,Bb(rp),_d)for(rp=0;rp<_d.length;rp++)Bb(_d[rp])}}function Gb(rp,_d){return rp(_d)}function Hb(){}var Ib=!1;function Jb(rp,_d,np){if(Ib)return rp(_d,np);Ib=!0;try{return Gb(rp,_d,np)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(rp,_d){var np=rp.stateNode;if(np===null)return null;var ap=Db(np);if(ap===null)return null;np=ap[_d];e:switch(_d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(ap=!ap.disabled)||(rp=rp.type,ap=!(rp==="button"||rp==="input"||rp==="select"||rp==="textarea")),rp=!ap;break e;default:rp=!1}if(rp)return null;if(np&&typeof np!="function")throw Error(p$1(231,_d,typeof np));return np}var Lb=!1;if(ia$1)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(rp,_d,np,ap,sp,lp,up,cp,dp){var hp=Array.prototype.slice.call(arguments,3);try{_d.apply(np,hp)}catch(fp){this.onError(fp)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(rp){Ob=!0,Pb=rp}};function Tb(rp,_d,np,ap,sp,lp,up,cp,dp){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(rp,_d,np,ap,sp,lp,up,cp,dp){if(Tb.apply(this,arguments),Ob){if(Ob){var hp=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=hp)}}function Vb(rp){var _d=rp,np=rp;if(rp.alternate)for(;_d.return;)_d=_d.return;else{rp=_d;do _d=rp,_d.flags&4098&&(np=_d.return),rp=_d.return;while(rp)}return _d.tag===3?np:null}function Wb(rp){if(rp.tag===13){var _d=rp.memoizedState;if(_d===null&&(rp=rp.alternate,rp!==null&&(_d=rp.memoizedState)),_d!==null)return _d.dehydrated}return null}function Xb(rp){if(Vb(rp)!==rp)throw Error(p$1(188))}function Yb(rp){var _d=rp.alternate;if(!_d){if(_d=Vb(rp),_d===null)throw Error(p$1(188));return _d!==rp?null:rp}for(var np=rp,ap=_d;;){var sp=np.return;if(sp===null)break;var lp=sp.alternate;if(lp===null){if(ap=sp.return,ap!==null){np=ap;continue}break}if(sp.child===lp.child){for(lp=sp.child;lp;){if(lp===np)return Xb(sp),rp;if(lp===ap)return Xb(sp),_d;lp=lp.sibling}throw Error(p$1(188))}if(np.return!==ap.return)np=sp,ap=lp;else{for(var up=!1,cp=sp.child;cp;){if(cp===np){up=!0,np=sp,ap=lp;break}if(cp===ap){up=!0,ap=sp,np=lp;break}cp=cp.sibling}if(!up){for(cp=lp.child;cp;){if(cp===np){up=!0,np=lp,ap=sp;break}if(cp===ap){up=!0,ap=lp,np=sp;break}cp=cp.sibling}if(!up)throw Error(p$1(189))}}if(np.alternate!==ap)throw Error(p$1(190))}if(np.tag!==3)throw Error(p$1(188));return np.stateNode.current===np?rp:_d}function Zb(rp){return rp=Yb(rp),rp!==null?$b(rp):null}function $b(rp){if(rp.tag===5||rp.tag===6)return rp;for(rp=rp.child;rp!==null;){var _d=$b(rp);if(_d!==null)return _d;rp=rp.sibling}return null}var ac$1=ca$1.unstable_scheduleCallback,bc$1=ca$1.unstable_cancelCallback,cc$1=ca$1.unstable_shouldYield,dc$1=ca$1.unstable_requestPaint,B$1=ca$1.unstable_now,ec$1=ca$1.unstable_getCurrentPriorityLevel,fc$1=ca$1.unstable_ImmediatePriority,gc$1=ca$1.unstable_UserBlockingPriority,hc$1=ca$1.unstable_NormalPriority,ic$1=ca$1.unstable_LowPriority,jc$1=ca$1.unstable_IdlePriority,kc$1=null,lc$1=null;function mc$1(rp){if(lc$1&&typeof lc$1.onCommitFiberRoot=="function")try{lc$1.onCommitFiberRoot(kc$1,rp,void 0,(rp.current.flags&128)===128)}catch{}}var oc$1=Math.clz32?Math.clz32:nc$1,pc$1=Math.log,qc$1=Math.LN2;function nc$1(rp){return rp>>>=0,rp===0?32:31-(pc$1(rp)/qc$1|0)|0}var rc$1=64,sc$1=4194304;function tc$1(rp){switch(rp&-rp){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return rp&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return rp&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return rp}}function uc$1(rp,_d){var np=rp.pendingLanes;if(np===0)return 0;var ap=0,sp=rp.suspendedLanes,lp=rp.pingedLanes,up=np&268435455;if(up!==0){var cp=up&~sp;cp!==0?ap=tc$1(cp):(lp&=up,lp!==0&&(ap=tc$1(lp)))}else up=np&~sp,up!==0?ap=tc$1(up):lp!==0&&(ap=tc$1(lp));if(ap===0)return 0;if(_d!==0&&_d!==ap&&!(_d&sp)&&(sp=ap&-ap,lp=_d&-_d,sp>=lp||sp===16&&(lp&4194240)!==0))return _d;if(ap&4&&(ap|=np&16),_d=rp.entangledLanes,_d!==0)for(rp=rp.entanglements,_d&=ap;0<_d;)np=31-oc$1(_d),sp=1<<np,ap|=rp[np],_d&=~sp;return ap}function vc$1(rp,_d){switch(rp){case 1:case 2:case 4:return _d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc$1(rp,_d){for(var np=rp.suspendedLanes,ap=rp.pingedLanes,sp=rp.expirationTimes,lp=rp.pendingLanes;0<lp;){var up=31-oc$1(lp),cp=1<<up,dp=sp[up];dp===-1?(!(cp&np)||cp&ap)&&(sp[up]=vc$1(cp,_d)):dp<=_d&&(rp.expiredLanes|=cp),lp&=~cp}}function xc$1(rp){return rp=rp.pendingLanes&-1073741825,rp!==0?rp:rp&1073741824?1073741824:0}function yc$1(){var rp=rc$1;return rc$1<<=1,!(rc$1&4194240)&&(rc$1=64),rp}function zc$1(rp){for(var _d=[],np=0;31>np;np++)_d.push(rp);return _d}function Ac$1(rp,_d,np){rp.pendingLanes|=_d,_d!==536870912&&(rp.suspendedLanes=0,rp.pingedLanes=0),rp=rp.eventTimes,_d=31-oc$1(_d),rp[_d]=np}function Bc$1(rp,_d){var np=rp.pendingLanes&~_d;rp.pendingLanes=_d,rp.suspendedLanes=0,rp.pingedLanes=0,rp.expiredLanes&=_d,rp.mutableReadLanes&=_d,rp.entangledLanes&=_d,_d=rp.entanglements;var ap=rp.eventTimes;for(rp=rp.expirationTimes;0<np;){var sp=31-oc$1(np),lp=1<<sp;_d[sp]=0,ap[sp]=-1,rp[sp]=-1,np&=~lp}}function Cc$1(rp,_d){var np=rp.entangledLanes|=_d;for(rp=rp.entanglements;np;){var ap=31-oc$1(np),sp=1<<ap;sp&_d|rp[ap]&_d&&(rp[ap]|=_d),np&=~sp}}var C$1=0;function Dc$1(rp){return rp&=-rp,1<rp?4<rp?rp&268435455?16:536870912:4:1}var Ec$1,Fc$1,Gc$1,Hc$1,Ic$1,Jc$1=!1,Kc$1=[],Lc$1=null,Mc$1=null,Nc$1=null,Oc$1=new Map,Pc$1=new Map,Qc$1=[],Rc$1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc$1(rp,_d){switch(rp){case"focusin":case"focusout":Lc$1=null;break;case"dragenter":case"dragleave":Mc$1=null;break;case"mouseover":case"mouseout":Nc$1=null;break;case"pointerover":case"pointerout":Oc$1.delete(_d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc$1.delete(_d.pointerId)}}function Tc$1(rp,_d,np,ap,sp,lp){return rp===null||rp.nativeEvent!==lp?(rp={blockedOn:_d,domEventName:np,eventSystemFlags:ap,nativeEvent:lp,targetContainers:[sp]},_d!==null&&(_d=Cb(_d),_d!==null&&Fc$1(_d)),rp):(rp.eventSystemFlags|=ap,_d=rp.targetContainers,sp!==null&&_d.indexOf(sp)===-1&&_d.push(sp),rp)}function Uc$1(rp,_d,np,ap,sp){switch(_d){case"focusin":return Lc$1=Tc$1(Lc$1,rp,_d,np,ap,sp),!0;case"dragenter":return Mc$1=Tc$1(Mc$1,rp,_d,np,ap,sp),!0;case"mouseover":return Nc$1=Tc$1(Nc$1,rp,_d,np,ap,sp),!0;case"pointerover":var lp=sp.pointerId;return Oc$1.set(lp,Tc$1(Oc$1.get(lp)||null,rp,_d,np,ap,sp)),!0;case"gotpointercapture":return lp=sp.pointerId,Pc$1.set(lp,Tc$1(Pc$1.get(lp)||null,rp,_d,np,ap,sp)),!0}return!1}function Vc$1(rp){var _d=Wc$1(rp.target);if(_d!==null){var np=Vb(_d);if(np!==null){if(_d=np.tag,_d===13){if(_d=Wb(np),_d!==null){rp.blockedOn=_d,Ic$1(rp.priority,function(){Gc$1(np)});return}}else if(_d===3&&np.stateNode.current.memoizedState.isDehydrated){rp.blockedOn=np.tag===3?np.stateNode.containerInfo:null;return}}}rp.blockedOn=null}function Xc$1(rp){if(rp.blockedOn!==null)return!1;for(var _d=rp.targetContainers;0<_d.length;){var np=Yc$1(rp.domEventName,rp.eventSystemFlags,_d[0],rp.nativeEvent);if(np===null){np=rp.nativeEvent;var ap=new np.constructor(np.type,np);wb=ap,np.target.dispatchEvent(ap),wb=null}else return _d=Cb(np),_d!==null&&Fc$1(_d),rp.blockedOn=np,!1;_d.shift()}return!0}function Zc$1(rp,_d,np){Xc$1(rp)&&np.delete(_d)}function $c$1(){Jc$1=!1,Lc$1!==null&&Xc$1(Lc$1)&&(Lc$1=null),Mc$1!==null&&Xc$1(Mc$1)&&(Mc$1=null),Nc$1!==null&&Xc$1(Nc$1)&&(Nc$1=null),Oc$1.forEach(Zc$1),Pc$1.forEach(Zc$1)}function ad(rp,_d){rp.blockedOn===_d&&(rp.blockedOn=null,Jc$1||(Jc$1=!0,ca$1.unstable_scheduleCallback(ca$1.unstable_NormalPriority,$c$1)))}function bd(rp){function _d(sp){return ad(sp,rp)}if(0<Kc$1.length){ad(Kc$1[0],rp);for(var np=1;np<Kc$1.length;np++){var ap=Kc$1[np];ap.blockedOn===rp&&(ap.blockedOn=null)}}for(Lc$1!==null&&ad(Lc$1,rp),Mc$1!==null&&ad(Mc$1,rp),Nc$1!==null&&ad(Nc$1,rp),Oc$1.forEach(_d),Pc$1.forEach(_d),np=0;np<Qc$1.length;np++)ap=Qc$1[np],ap.blockedOn===rp&&(ap.blockedOn=null);for(;0<Qc$1.length&&(np=Qc$1[0],np.blockedOn===null);)Vc$1(np),np.blockedOn===null&&Qc$1.shift()}var cd=ua$1.ReactCurrentBatchConfig,dd=!0;function ed(rp,_d,np,ap){var sp=C$1,lp=cd.transition;cd.transition=null;try{C$1=1,fd(rp,_d,np,ap)}finally{C$1=sp,cd.transition=lp}}function gd(rp,_d,np,ap){var sp=C$1,lp=cd.transition;cd.transition=null;try{C$1=4,fd(rp,_d,np,ap)}finally{C$1=sp,cd.transition=lp}}function fd(rp,_d,np,ap){if(dd){var sp=Yc$1(rp,_d,np,ap);if(sp===null)hd(rp,_d,ap,id$2,np),Sc$1(rp,ap);else if(Uc$1(sp,rp,_d,np,ap))ap.stopPropagation();else if(Sc$1(rp,ap),_d&4&&-1<Rc$1.indexOf(rp)){for(;sp!==null;){var lp=Cb(sp);if(lp!==null&&Ec$1(lp),lp=Yc$1(rp,_d,np,ap),lp===null&&hd(rp,_d,ap,id$2,np),lp===sp)break;sp=lp}sp!==null&&ap.stopPropagation()}else hd(rp,_d,ap,null,np)}}var id$2=null;function Yc$1(rp,_d,np,ap){if(id$2=null,rp=xb(ap),rp=Wc$1(rp),rp!==null)if(_d=Vb(rp),_d===null)rp=null;else if(np=_d.tag,np===13){if(rp=Wb(_d),rp!==null)return rp;rp=null}else if(np===3){if(_d.stateNode.current.memoizedState.isDehydrated)return _d.tag===3?_d.stateNode.containerInfo:null;rp=null}else _d!==rp&&(rp=null);return id$2=rp,null}function jd(rp){switch(rp){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$1()){case fc$1:return 1;case gc$1:return 4;case hc$1:case ic$1:return 16;case jc$1:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var rp,_d=ld,np=_d.length,ap,sp="value"in kd?kd.value:kd.textContent,lp=sp.length;for(rp=0;rp<np&&_d[rp]===sp[rp];rp++);var up=np-rp;for(ap=1;ap<=up&&_d[np-ap]===sp[lp-ap];ap++);return md=sp.slice(rp,1<ap?1-ap:void 0)}function od(rp){var _d=rp.keyCode;return"charCode"in rp?(rp=rp.charCode,rp===0&&_d===13&&(rp=13)):rp=_d,rp===10&&(rp=13),32<=rp||rp===13?rp:0}function pd(){return!0}function qd(){return!1}function rd(rp){function _d(np,ap,sp,lp,up){this._reactName=np,this._targetInst=sp,this.type=ap,this.nativeEvent=lp,this.target=up,this.currentTarget=null;for(var cp in rp)rp.hasOwnProperty(cp)&&(np=rp[cp],this[cp]=np?np(lp):lp[cp]);return this.isDefaultPrevented=(lp.defaultPrevented!=null?lp.defaultPrevented:lp.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(_d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var np=this.nativeEvent;np&&(np.preventDefault?np.preventDefault():typeof np.returnValue!="unknown"&&(np.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var np=this.nativeEvent;np&&(np.stopPropagation?np.stopPropagation():typeof np.cancelBubble!="unknown"&&(np.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),_d}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(rp){return rp.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(rp){return rp.relatedTarget===void 0?rp.fromElement===rp.srcElement?rp.toElement:rp.fromElement:rp.relatedTarget},movementX:function(rp){return"movementX"in rp?rp.movementX:(rp!==yd&&(yd&&rp.type==="mousemove"?(wd=rp.screenX-yd.screenX,xd=rp.screenY-yd.screenY):xd=wd=0,yd=rp),wd)},movementY:function(rp){return"movementY"in rp?rp.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(rp){return"clipboardData"in rp?rp.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(rp){var _d=this.nativeEvent;return _d.getModifierState?_d.getModifierState(rp):(rp=Od[rp])?!!_d[rp]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(rp){if(rp.key){var _d=Md[rp.key]||rp.key;if(_d!=="Unidentified")return _d}return rp.type==="keypress"?(rp=od(rp),rp===13?"Enter":String.fromCharCode(rp)):rp.type==="keydown"||rp.type==="keyup"?Nd[rp.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(rp){return rp.type==="keypress"?od(rp):0},keyCode:function(rp){return rp.type==="keydown"||rp.type==="keyup"?rp.keyCode:0},which:function(rp){return rp.type==="keypress"?od(rp):rp.type==="keydown"||rp.type==="keyup"?rp.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(rp){return"deltaX"in rp?rp.deltaX:"wheelDeltaX"in rp?-rp.wheelDeltaX:0},deltaY:function(rp){return"deltaY"in rp?rp.deltaY:"wheelDeltaY"in rp?-rp.wheelDeltaY:"wheelDelta"in rp?-rp.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$1=ia$1&&"CompositionEvent"in window,be$1=null;ia$1&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia$1&&"TextEvent"in window&&!be$1,de$1=ia$1&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee$1=" ",fe$1=!1;function ge$1(rp,_d){switch(rp){case"keyup":return $d.indexOf(_d.keyCode)!==-1;case"keydown":return _d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(rp){return rp=rp.detail,typeof rp=="object"&&"data"in rp?rp.data:null}var ie$1=!1;function je$1(rp,_d){switch(rp){case"compositionend":return he$1(_d);case"keypress":return _d.which!==32?null:(fe$1=!0,ee$1);case"textInput":return rp=_d.data,rp===ee$1&&fe$1?null:rp;default:return null}}function ke$1(rp,_d){if(ie$1)return rp==="compositionend"||!ae$1&&ge$1(rp,_d)?(rp=nd(),md=ld=kd=null,ie$1=!1,rp):null;switch(rp){case"paste":return null;case"keypress":if(!(_d.ctrlKey||_d.altKey||_d.metaKey)||_d.ctrlKey&&_d.altKey){if(_d.char&&1<_d.char.length)return _d.char;if(_d.which)return String.fromCharCode(_d.which)}return null;case"compositionend":return de$1&&_d.locale!=="ko"?null:_d.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(rp){var _d=rp&&rp.nodeName&&rp.nodeName.toLowerCase();return _d==="input"?!!le$1[rp.type]:_d==="textarea"}function ne$1(rp,_d,np,ap){Eb(ap),_d=oe$1(_d,"onChange"),0<_d.length&&(np=new td("onChange","change",null,np,ap),rp.push({event:np,listeners:_d}))}var pe$1=null,qe$1=null;function re$3(rp){se$1(rp,0)}function te$1(rp){var _d=ue$1(rp);if(Wa$1(_d))return rp}function ve$1(rp,_d){if(rp==="change")return _d}var we$1=!1;if(ia$1){var xe$1;if(ia$1){var ye$1="oninput"in document;if(!ye$1){var ze$1=document.createElement("div");ze$1.setAttribute("oninput","return;"),ye$1=typeof ze$1.oninput=="function"}xe$1=ye$1}else xe$1=!1;we$1=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae$1(){pe$1&&(pe$1.detachEvent("onpropertychange",Be$1),qe$1=pe$1=null)}function Be$1(rp){if(rp.propertyName==="value"&&te$1(qe$1)){var _d=[];ne$1(_d,qe$1,rp,xb(rp)),Jb(re$3,_d)}}function Ce$1(rp,_d,np){rp==="focusin"?(Ae$1(),pe$1=_d,qe$1=np,pe$1.attachEvent("onpropertychange",Be$1)):rp==="focusout"&&Ae$1()}function De$1(rp){if(rp==="selectionchange"||rp==="keyup"||rp==="keydown")return te$1(qe$1)}function Ee$1(rp,_d){if(rp==="click")return te$1(_d)}function Fe$1(rp,_d){if(rp==="input"||rp==="change")return te$1(_d)}function Ge$1(rp,_d){return rp===_d&&(rp!==0||1/rp===1/_d)||rp!==rp&&_d!==_d}var He$1=typeof Object.is=="function"?Object.is:Ge$1;function Ie$1(rp,_d){if(He$1(rp,_d))return!0;if(typeof rp!="object"||rp===null||typeof _d!="object"||_d===null)return!1;var np=Object.keys(rp),ap=Object.keys(_d);if(np.length!==ap.length)return!1;for(ap=0;ap<np.length;ap++){var sp=np[ap];if(!ja$1.call(_d,sp)||!He$1(rp[sp],_d[sp]))return!1}return!0}function Je$1(rp){for(;rp&&rp.firstChild;)rp=rp.firstChild;return rp}function Ke$1(rp,_d){var np=Je$1(rp);rp=0;for(var ap;np;){if(np.nodeType===3){if(ap=rp+np.textContent.length,rp<=_d&&ap>=_d)return{node:np,offset:_d-rp};rp=ap}e:{for(;np;){if(np.nextSibling){np=np.nextSibling;break e}np=np.parentNode}np=void 0}np=Je$1(np)}}function Le$1(rp,_d){return rp&&_d?rp===_d?!0:rp&&rp.nodeType===3?!1:_d&&_d.nodeType===3?Le$1(rp,_d.parentNode):"contains"in rp?rp.contains(_d):rp.compareDocumentPosition?!!(rp.compareDocumentPosition(_d)&16):!1:!1}function Me$1(){for(var rp=window,_d=Xa$1();_d instanceof rp.HTMLIFrameElement;){try{var np=typeof _d.contentWindow.location.href=="string"}catch{np=!1}if(np)rp=_d.contentWindow;else break;_d=Xa$1(rp.document)}return _d}function Ne$1(rp){var _d=rp&&rp.nodeName&&rp.nodeName.toLowerCase();return _d&&(_d==="input"&&(rp.type==="text"||rp.type==="search"||rp.type==="tel"||rp.type==="url"||rp.type==="password")||_d==="textarea"||rp.contentEditable==="true")}function Oe$1(rp){var _d=Me$1(),np=rp.focusedElem,ap=rp.selectionRange;if(_d!==np&&np&&np.ownerDocument&&Le$1(np.ownerDocument.documentElement,np)){if(ap!==null&&Ne$1(np)){if(_d=ap.start,rp=ap.end,rp===void 0&&(rp=_d),"selectionStart"in np)np.selectionStart=_d,np.selectionEnd=Math.min(rp,np.value.length);else if(rp=(_d=np.ownerDocument||document)&&_d.defaultView||window,rp.getSelection){rp=rp.getSelection();var sp=np.textContent.length,lp=Math.min(ap.start,sp);ap=ap.end===void 0?lp:Math.min(ap.end,sp),!rp.extend&&lp>ap&&(sp=ap,ap=lp,lp=sp),sp=Ke$1(np,lp);var up=Ke$1(np,ap);sp&&up&&(rp.rangeCount!==1||rp.anchorNode!==sp.node||rp.anchorOffset!==sp.offset||rp.focusNode!==up.node||rp.focusOffset!==up.offset)&&(_d=_d.createRange(),_d.setStart(sp.node,sp.offset),rp.removeAllRanges(),lp>ap?(rp.addRange(_d),rp.extend(up.node,up.offset)):(_d.setEnd(up.node,up.offset),rp.addRange(_d)))}}for(_d=[],rp=np;rp=rp.parentNode;)rp.nodeType===1&&_d.push({element:rp,left:rp.scrollLeft,top:rp.scrollTop});for(typeof np.focus=="function"&&np.focus(),np=0;np<_d.length;np++)rp=_d[np],rp.element.scrollLeft=rp.left,rp.element.scrollTop=rp.top}}var Pe$1=ia$1&&"documentMode"in document&&11>=document.documentMode,Qe$1=null,Re$1=null,Se$1=null,Te$1=!1;function Ue$1(rp,_d,np){var ap=np.window===np?np.document:np.nodeType===9?np:np.ownerDocument;Te$1||Qe$1==null||Qe$1!==Xa$1(ap)||(ap=Qe$1,"selectionStart"in ap&&Ne$1(ap)?ap={start:ap.selectionStart,end:ap.selectionEnd}:(ap=(ap.ownerDocument&&ap.ownerDocument.defaultView||window).getSelection(),ap={anchorNode:ap.anchorNode,anchorOffset:ap.anchorOffset,focusNode:ap.focusNode,focusOffset:ap.focusOffset}),Se$1&&Ie$1(Se$1,ap)||(Se$1=ap,ap=oe$1(Re$1,"onSelect"),0<ap.length&&(_d=new td("onSelect","select",null,_d,np),rp.push({event:_d,listeners:ap}),_d.target=Qe$1)))}function Ve$1(rp,_d){var np={};return np[rp.toLowerCase()]=_d.toLowerCase(),np["Webkit"+rp]="webkit"+_d,np["Moz"+rp]="moz"+_d,np}var We$1={animationend:Ve$1("Animation","AnimationEnd"),animationiteration:Ve$1("Animation","AnimationIteration"),animationstart:Ve$1("Animation","AnimationStart"),transitionend:Ve$1("Transition","TransitionEnd")},Xe$1={},Ye$1={};ia$1&&(Ye$1=document.createElement("div").style,"AnimationEvent"in window||(delete We$1.animationend.animation,delete We$1.animationiteration.animation,delete We$1.animationstart.animation),"TransitionEvent"in window||delete We$1.transitionend.transition);function Ze$1(rp){if(Xe$1[rp])return Xe$1[rp];if(!We$1[rp])return rp;var _d=We$1[rp],np;for(np in _d)if(_d.hasOwnProperty(np)&&np in Ye$1)return Xe$1[rp]=_d[np];return rp}var $e$1=Ze$1("animationend"),af$1=Ze$1("animationiteration"),bf$1=Ze$1("animationstart"),cf$1=Ze$1("transitionend"),df$1=new Map,ef$1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff$1(rp,_d){df$1.set(rp,_d),fa$1(_d,[rp])}for(var gf$1=0;gf$1<ef$1.length;gf$1++){var hf$1=ef$1[gf$1],jf$1=hf$1.toLowerCase(),kf$1=hf$1[0].toUpperCase()+hf$1.slice(1);ff$1(jf$1,"on"+kf$1)}ff$1($e$1,"onAnimationEnd");ff$1(af$1,"onAnimationIteration");ff$1(bf$1,"onAnimationStart");ff$1("dblclick","onDoubleClick");ff$1("focusin","onFocus");ff$1("focusout","onBlur");ff$1(cf$1,"onTransitionEnd");ha$1("onMouseEnter",["mouseout","mouseover"]);ha$1("onMouseLeave",["mouseout","mouseover"]);ha$1("onPointerEnter",["pointerout","pointerover"]);ha$1("onPointerLeave",["pointerout","pointerover"]);fa$1("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa$1("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa$1("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa$1("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa$1("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa$1("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf$1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf$1=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf$1));function nf$1(rp,_d,np){var ap=rp.type||"unknown-event";rp.currentTarget=np,Ub(ap,_d,void 0,rp),rp.currentTarget=null}function se$1(rp,_d){_d=(_d&4)!==0;for(var np=0;np<rp.length;np++){var ap=rp[np],sp=ap.event;ap=ap.listeners;e:{var lp=void 0;if(_d)for(var up=ap.length-1;0<=up;up--){var cp=ap[up],dp=cp.instance,hp=cp.currentTarget;if(cp=cp.listener,dp!==lp&&sp.isPropagationStopped())break e;nf$1(sp,cp,hp),lp=dp}else for(up=0;up<ap.length;up++){if(cp=ap[up],dp=cp.instance,hp=cp.currentTarget,cp=cp.listener,dp!==lp&&sp.isPropagationStopped())break e;nf$1(sp,cp,hp),lp=dp}}}if(Qb)throw rp=Rb,Qb=!1,Rb=null,rp}function D$1(rp,_d){var np=_d[of$1];np===void 0&&(np=_d[of$1]=new Set);var ap=rp+"__bubble";np.has(ap)||(pf$1(_d,rp,2,!1),np.add(ap))}function qf$1(rp,_d,np){var ap=0;_d&&(ap|=4),pf$1(np,rp,ap,_d)}var rf$1="_reactListening"+Math.random().toString(36).slice(2);function sf$1(rp){if(!rp[rf$1]){rp[rf$1]=!0,da$1.forEach(function(np){np!=="selectionchange"&&(mf$1.has(np)||qf$1(np,!1,rp),qf$1(np,!0,rp))});var _d=rp.nodeType===9?rp:rp.ownerDocument;_d===null||_d[rf$1]||(_d[rf$1]=!0,qf$1("selectionchange",!1,_d))}}function pf$1(rp,_d,np,ap){switch(jd(_d)){case 1:var sp=ed;break;case 4:sp=gd;break;default:sp=fd}np=sp.bind(null,_d,np,rp),sp=void 0,!Lb||_d!=="touchstart"&&_d!=="touchmove"&&_d!=="wheel"||(sp=!0),ap?sp!==void 0?rp.addEventListener(_d,np,{capture:!0,passive:sp}):rp.addEventListener(_d,np,!0):sp!==void 0?rp.addEventListener(_d,np,{passive:sp}):rp.addEventListener(_d,np,!1)}function hd(rp,_d,np,ap,sp){var lp=ap;if(!(_d&1)&&!(_d&2)&&ap!==null)e:for(;;){if(ap===null)return;var up=ap.tag;if(up===3||up===4){var cp=ap.stateNode.containerInfo;if(cp===sp||cp.nodeType===8&&cp.parentNode===sp)break;if(up===4)for(up=ap.return;up!==null;){var dp=up.tag;if((dp===3||dp===4)&&(dp=up.stateNode.containerInfo,dp===sp||dp.nodeType===8&&dp.parentNode===sp))return;up=up.return}for(;cp!==null;){if(up=Wc$1(cp),up===null)return;if(dp=up.tag,dp===5||dp===6){ap=lp=up;continue e}cp=cp.parentNode}}ap=ap.return}Jb(function(){var hp=lp,fp=xb(np),pp=[];e:{var mp=df$1.get(rp);if(mp!==void 0){var gp=td,yp=rp;switch(rp){case"keypress":if(od(np)===0)break e;case"keydown":case"keyup":gp=Rd;break;case"focusin":yp="focus",gp=Fd;break;case"focusout":yp="blur",gp=Fd;break;case"beforeblur":case"afterblur":gp=Fd;break;case"click":if(np.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":gp=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":gp=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":gp=Vd;break;case $e$1:case af$1:case bf$1:gp=Hd;break;case cf$1:gp=Xd;break;case"scroll":gp=vd;break;case"wheel":gp=Zd;break;case"copy":case"cut":case"paste":gp=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":gp=Td}var xp=(_d&4)!==0,_p=!xp&&rp==="scroll",vp=xp?mp!==null?mp+"Capture":null:mp;xp=[];for(var bp=hp,Ep;bp!==null;){Ep=bp;var Sp=Ep.stateNode;if(Ep.tag===5&&Sp!==null&&(Ep=Sp,vp!==null&&(Sp=Kb(bp,vp),Sp!=null&&xp.push(tf$4(bp,Sp,Ep)))),_p)break;bp=bp.return}0<xp.length&&(mp=new gp(mp,yp,null,np,fp),pp.push({event:mp,listeners:xp}))}}if(!(_d&7)){e:{if(mp=rp==="mouseover"||rp==="pointerover",gp=rp==="mouseout"||rp==="pointerout",mp&&np!==wb&&(yp=np.relatedTarget||np.fromElement)&&(Wc$1(yp)||yp[uf$1]))break e;if((gp||mp)&&(mp=fp.window===fp?fp:(mp=fp.ownerDocument)?mp.defaultView||mp.parentWindow:window,gp?(yp=np.relatedTarget||np.toElement,gp=hp,yp=yp?Wc$1(yp):null,yp!==null&&(_p=Vb(yp),yp!==_p||yp.tag!==5&&yp.tag!==6)&&(yp=null)):(gp=null,yp=hp),gp!==yp)){if(xp=Bd,Sp="onMouseLeave",vp="onMouseEnter",bp="mouse",(rp==="pointerout"||rp==="pointerover")&&(xp=Td,Sp="onPointerLeave",vp="onPointerEnter",bp="pointer"),_p=gp==null?mp:ue$1(gp),Ep=yp==null?mp:ue$1(yp),mp=new xp(Sp,bp+"leave",gp,np,fp),mp.target=_p,mp.relatedTarget=Ep,Sp=null,Wc$1(fp)===hp&&(xp=new xp(vp,bp+"enter",yp,np,fp),xp.target=Ep,xp.relatedTarget=_p,Sp=xp),_p=Sp,gp&&yp)t:{for(xp=gp,vp=yp,bp=0,Ep=xp;Ep;Ep=vf$1(Ep))bp++;for(Ep=0,Sp=vp;Sp;Sp=vf$1(Sp))Ep++;for(;0<bp-Ep;)xp=vf$1(xp),bp--;for(;0<Ep-bp;)vp=vf$1(vp),Ep--;for(;bp--;){if(xp===vp||vp!==null&&xp===vp.alternate)break t;xp=vf$1(xp),vp=vf$1(vp)}xp=null}else xp=null;gp!==null&&wf$1(pp,mp,gp,xp,!1),yp!==null&&_p!==null&&wf$1(pp,_p,yp,xp,!0)}}e:{if(mp=hp?ue$1(hp):window,gp=mp.nodeName&&mp.nodeName.toLowerCase(),gp==="select"||gp==="input"&&mp.type==="file")var Ap=ve$1;else if(me$1(mp))if(we$1)Ap=Fe$1;else{Ap=De$1;var Rp=Ce$1}else(gp=mp.nodeName)&&gp.toLowerCase()==="input"&&(mp.type==="checkbox"||mp.type==="radio")&&(Ap=Ee$1);if(Ap&&(Ap=Ap(rp,hp))){ne$1(pp,Ap,np,fp);break e}Rp&&Rp(rp,mp,hp),rp==="focusout"&&(Rp=mp._wrapperState)&&Rp.controlled&&mp.type==="number"&&cb(mp,"number",mp.value)}switch(Rp=hp?ue$1(hp):window,rp){case"focusin":(me$1(Rp)||Rp.contentEditable==="true")&&(Qe$1=Rp,Re$1=hp,Se$1=null);break;case"focusout":Se$1=Re$1=Qe$1=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue$1(pp,np,fp);break;case"selectionchange":if(Pe$1)break;case"keydown":case"keyup":Ue$1(pp,np,fp)}var Tp;if(ae$1)e:{switch(rp){case"compositionstart":var Mp="onCompositionStart";break e;case"compositionend":Mp="onCompositionEnd";break e;case"compositionupdate":Mp="onCompositionUpdate";break e}Mp=void 0}else ie$1?ge$1(rp,np)&&(Mp="onCompositionEnd"):rp==="keydown"&&np.keyCode===229&&(Mp="onCompositionStart");Mp&&(de$1&&np.locale!=="ko"&&(ie$1||Mp!=="onCompositionStart"?Mp==="onCompositionEnd"&&ie$1&&(Tp=nd()):(kd=fp,ld="value"in kd?kd.value:kd.textContent,ie$1=!0)),Rp=oe$1(hp,Mp),0<Rp.length&&(Mp=new Ld(Mp,rp,null,np,fp),pp.push({event:Mp,listeners:Rp}),Tp?Mp.data=Tp:(Tp=he$1(np),Tp!==null&&(Mp.data=Tp)))),(Tp=ce$1?je$1(rp,np):ke$1(rp,np))&&(hp=oe$1(hp,"onBeforeInput"),0<hp.length&&(fp=new Ld("onBeforeInput","beforeinput",null,np,fp),pp.push({event:fp,listeners:hp}),fp.data=Tp))}se$1(pp,_d)})}function tf$4(rp,_d,np){return{instance:rp,listener:_d,currentTarget:np}}function oe$1(rp,_d){for(var np=_d+"Capture",ap=[];rp!==null;){var sp=rp,lp=sp.stateNode;sp.tag===5&&lp!==null&&(sp=lp,lp=Kb(rp,np),lp!=null&&ap.unshift(tf$4(rp,lp,sp)),lp=Kb(rp,_d),lp!=null&&ap.push(tf$4(rp,lp,sp))),rp=rp.return}return ap}function vf$1(rp){if(rp===null)return null;do rp=rp.return;while(rp&&rp.tag!==5);return rp||null}function wf$1(rp,_d,np,ap,sp){for(var lp=_d._reactName,up=[];np!==null&&np!==ap;){var cp=np,dp=cp.alternate,hp=cp.stateNode;if(dp!==null&&dp===ap)break;cp.tag===5&&hp!==null&&(cp=hp,sp?(dp=Kb(np,lp),dp!=null&&up.unshift(tf$4(np,dp,cp))):sp||(dp=Kb(np,lp),dp!=null&&up.push(tf$4(np,dp,cp)))),np=np.return}up.length!==0&&rp.push({event:_d,listeners:up})}var xf$1=/\r\n?/g,yf$1=/\u0000|\uFFFD/g;function zf$1(rp){return(typeof rp=="string"?rp:""+rp).replace(xf$1,`
`).replace(yf$1,"")}function Af$1(rp,_d,np){if(_d=zf$1(_d),zf$1(rp)!==_d&&np)throw Error(p$1(425))}function Bf$1(){}var Cf$1=null,Df$1=null;function Ef$1(rp,_d){return rp==="textarea"||rp==="noscript"||typeof _d.children=="string"||typeof _d.children=="number"||typeof _d.dangerouslySetInnerHTML=="object"&&_d.dangerouslySetInnerHTML!==null&&_d.dangerouslySetInnerHTML.__html!=null}var Ff$1=typeof setTimeout=="function"?setTimeout:void 0,Gf$1=typeof clearTimeout=="function"?clearTimeout:void 0,Hf$1=typeof Promise=="function"?Promise:void 0,Jf$1=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf$1<"u"?function(rp){return Hf$1.resolve(null).then(rp).catch(If$1)}:Ff$1;function If$1(rp){setTimeout(function(){throw rp})}function Kf$1(rp,_d){var np=_d,ap=0;do{var sp=np.nextSibling;if(rp.removeChild(np),sp&&sp.nodeType===8)if(np=sp.data,np==="/$"){if(ap===0){rp.removeChild(sp),bd(_d);return}ap--}else np!=="$"&&np!=="$?"&&np!=="$!"||ap++;np=sp}while(np);bd(_d)}function Lf$1(rp){for(;rp!=null;rp=rp.nextSibling){var _d=rp.nodeType;if(_d===1||_d===3)break;if(_d===8){if(_d=rp.data,_d==="$"||_d==="$!"||_d==="$?")break;if(_d==="/$")return null}}return rp}function Mf$1(rp){rp=rp.previousSibling;for(var _d=0;rp;){if(rp.nodeType===8){var np=rp.data;if(np==="$"||np==="$!"||np==="$?"){if(_d===0)return rp;_d--}else np==="/$"&&_d++}rp=rp.previousSibling}return null}var Nf$1=Math.random().toString(36).slice(2),Of$1="__reactFiber$"+Nf$1,Pf$1="__reactProps$"+Nf$1,uf$1="__reactContainer$"+Nf$1,of$1="__reactEvents$"+Nf$1,Qf$1="__reactListeners$"+Nf$1,Rf$1="__reactHandles$"+Nf$1;function Wc$1(rp){var _d=rp[Of$1];if(_d)return _d;for(var np=rp.parentNode;np;){if(_d=np[uf$1]||np[Of$1]){if(np=_d.alternate,_d.child!==null||np!==null&&np.child!==null)for(rp=Mf$1(rp);rp!==null;){if(np=rp[Of$1])return np;rp=Mf$1(rp)}return _d}rp=np,np=rp.parentNode}return null}function Cb(rp){return rp=rp[Of$1]||rp[uf$1],!rp||rp.tag!==5&&rp.tag!==6&&rp.tag!==13&&rp.tag!==3?null:rp}function ue$1(rp){if(rp.tag===5||rp.tag===6)return rp.stateNode;throw Error(p$1(33))}function Db(rp){return rp[Pf$1]||null}var Sf$1=[],Tf$1=-1;function Uf$1(rp){return{current:rp}}function E$1(rp){0>Tf$1||(rp.current=Sf$1[Tf$1],Sf$1[Tf$1]=null,Tf$1--)}function G$1(rp,_d){Tf$1++,Sf$1[Tf$1]=rp.current,rp.current=_d}var Vf$1={},H$1=Uf$1(Vf$1),Wf$1=Uf$1(!1),Xf$1=Vf$1;function Yf$1(rp,_d){var np=rp.type.contextTypes;if(!np)return Vf$1;var ap=rp.stateNode;if(ap&&ap.__reactInternalMemoizedUnmaskedChildContext===_d)return ap.__reactInternalMemoizedMaskedChildContext;var sp={},lp;for(lp in np)sp[lp]=_d[lp];return ap&&(rp=rp.stateNode,rp.__reactInternalMemoizedUnmaskedChildContext=_d,rp.__reactInternalMemoizedMaskedChildContext=sp),sp}function Zf$1(rp){return rp=rp.childContextTypes,rp!=null}function $f$1(){E$1(Wf$1),E$1(H$1)}function ag(rp,_d,np){if(H$1.current!==Vf$1)throw Error(p$1(168));G$1(H$1,_d),G$1(Wf$1,np)}function bg(rp,_d,np){var ap=rp.stateNode;if(_d=_d.childContextTypes,typeof ap.getChildContext!="function")return np;ap=ap.getChildContext();for(var sp in ap)if(!(sp in _d))throw Error(p$1(108,Ra$1(rp)||"Unknown",sp));return A$1({},np,ap)}function cg(rp){return rp=(rp=rp.stateNode)&&rp.__reactInternalMemoizedMergedChildContext||Vf$1,Xf$1=H$1.current,G$1(H$1,rp),G$1(Wf$1,Wf$1.current),!0}function dg(rp,_d,np){var ap=rp.stateNode;if(!ap)throw Error(p$1(169));np?(rp=bg(rp,_d,Xf$1),ap.__reactInternalMemoizedMergedChildContext=rp,E$1(Wf$1),E$1(H$1),G$1(H$1,rp)):E$1(Wf$1),G$1(Wf$1,np)}var eg=null,fg=!1,gg=!1;function hg(rp){eg===null?eg=[rp]:eg.push(rp)}function ig(rp){fg=!0,hg(rp)}function jg(){if(!gg&&eg!==null){gg=!0;var rp=0,_d=C$1;try{var np=eg;for(C$1=1;rp<np.length;rp++){var ap=np[rp];do ap=ap(!0);while(ap!==null)}eg=null,fg=!1}catch(sp){throw eg!==null&&(eg=eg.slice(rp+1)),ac$1(fc$1,jg),sp}finally{C$1=_d,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(rp,_d){kg[lg++]=ng,kg[lg++]=mg,mg=rp,ng=_d}function ug(rp,_d,np){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=rp;var ap=rg;rp=sg;var sp=32-oc$1(ap)-1;ap&=~(1<<sp),np+=1;var lp=32-oc$1(_d)+sp;if(30<lp){var up=sp-sp%5;lp=(ap&(1<<up)-1).toString(32),ap>>=up,sp-=up,rg=1<<32-oc$1(_d)+sp|np<<sp|ap,sg=lp+rp}else rg=1<<lp|np<<sp|ap,sg=rp}function vg(rp){rp.return!==null&&(tg(rp,1),ug(rp,1,0))}function wg(rp){for(;rp===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;rp===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(rp,_d){var np=Bg(5,null,null,0);np.elementType="DELETED",np.stateNode=_d,np.return=rp,_d=rp.deletions,_d===null?(rp.deletions=[np],rp.flags|=16):_d.push(np)}function Cg(rp,_d){switch(rp.tag){case 5:var np=rp.type;return _d=_d.nodeType!==1||np.toLowerCase()!==_d.nodeName.toLowerCase()?null:_d,_d!==null?(rp.stateNode=_d,xg=rp,yg=Lf$1(_d.firstChild),!0):!1;case 6:return _d=rp.pendingProps===""||_d.nodeType!==3?null:_d,_d!==null?(rp.stateNode=_d,xg=rp,yg=null,!0):!1;case 13:return _d=_d.nodeType!==8?null:_d,_d!==null?(np=qg!==null?{id:rg,overflow:sg}:null,rp.memoizedState={dehydrated:_d,treeContext:np,retryLane:1073741824},np=Bg(18,null,null,0),np.stateNode=_d,np.return=rp,rp.child=np,xg=rp,yg=null,!0):!1;default:return!1}}function Dg(rp){return(rp.mode&1)!==0&&(rp.flags&128)===0}function Eg(rp){if(I$1){var _d=yg;if(_d){var np=_d;if(!Cg(rp,_d)){if(Dg(rp))throw Error(p$1(418));_d=Lf$1(np.nextSibling);var ap=xg;_d&&Cg(rp,_d)?Ag(ap,np):(rp.flags=rp.flags&-4097|2,I$1=!1,xg=rp)}}else{if(Dg(rp))throw Error(p$1(418));rp.flags=rp.flags&-4097|2,I$1=!1,xg=rp}}}function Fg(rp){for(rp=rp.return;rp!==null&&rp.tag!==5&&rp.tag!==3&&rp.tag!==13;)rp=rp.return;xg=rp}function Gg(rp){if(rp!==xg)return!1;if(!I$1)return Fg(rp),I$1=!0,!1;var _d;if((_d=rp.tag!==3)&&!(_d=rp.tag!==5)&&(_d=rp.type,_d=_d!=="head"&&_d!=="body"&&!Ef$1(rp.type,rp.memoizedProps)),_d&&(_d=yg)){if(Dg(rp))throw Hg(),Error(p$1(418));for(;_d;)Ag(rp,_d),_d=Lf$1(_d.nextSibling)}if(Fg(rp),rp.tag===13){if(rp=rp.memoizedState,rp=rp!==null?rp.dehydrated:null,!rp)throw Error(p$1(317));e:{for(rp=rp.nextSibling,_d=0;rp;){if(rp.nodeType===8){var np=rp.data;if(np==="/$"){if(_d===0){yg=Lf$1(rp.nextSibling);break e}_d--}else np!=="$"&&np!=="$!"&&np!=="$?"||_d++}rp=rp.nextSibling}yg=null}}else yg=xg?Lf$1(rp.stateNode.nextSibling):null;return!0}function Hg(){for(var rp=yg;rp;)rp=Lf$1(rp.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(rp){zg===null?zg=[rp]:zg.push(rp)}var Kg=ua$1.ReactCurrentBatchConfig;function Lg(rp,_d){if(rp&&rp.defaultProps){_d=A$1({},_d),rp=rp.defaultProps;for(var np in rp)_d[np]===void 0&&(_d[np]=rp[np]);return _d}return _d}var Mg=Uf$1(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(rp){var _d=Mg.current;E$1(Mg),rp._currentValue=_d}function Sg(rp,_d,np){for(;rp!==null;){var ap=rp.alternate;if((rp.childLanes&_d)!==_d?(rp.childLanes|=_d,ap!==null&&(ap.childLanes|=_d)):ap!==null&&(ap.childLanes&_d)!==_d&&(ap.childLanes|=_d),rp===np)break;rp=rp.return}}function Tg(rp,_d){Ng=rp,Pg=Og=null,rp=rp.dependencies,rp!==null&&rp.firstContext!==null&&(rp.lanes&_d&&(Ug=!0),rp.firstContext=null)}function Vg(rp){var _d=rp._currentValue;if(Pg!==rp)if(rp={context:rp,memoizedValue:_d,next:null},Og===null){if(Ng===null)throw Error(p$1(308));Og=rp,Ng.dependencies={lanes:0,firstContext:rp}}else Og=Og.next=rp;return _d}var Wg=null;function Xg(rp){Wg===null?Wg=[rp]:Wg.push(rp)}function Yg(rp,_d,np,ap){var sp=_d.interleaved;return sp===null?(np.next=np,Xg(_d)):(np.next=sp.next,sp.next=np),_d.interleaved=np,Zg(rp,ap)}function Zg(rp,_d){rp.lanes|=_d;var np=rp.alternate;for(np!==null&&(np.lanes|=_d),np=rp,rp=rp.return;rp!==null;)rp.childLanes|=_d,np=rp.alternate,np!==null&&(np.childLanes|=_d),np=rp,rp=rp.return;return np.tag===3?np.stateNode:null}var $g=!1;function ah$1(rp){rp.updateQueue={baseState:rp.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh$1(rp,_d){rp=rp.updateQueue,_d.updateQueue===rp&&(_d.updateQueue={baseState:rp.baseState,firstBaseUpdate:rp.firstBaseUpdate,lastBaseUpdate:rp.lastBaseUpdate,shared:rp.shared,effects:rp.effects})}function ch$1(rp,_d){return{eventTime:rp,lane:_d,tag:0,payload:null,callback:null,next:null}}function dh$1(rp,_d,np){var ap=rp.updateQueue;if(ap===null)return null;if(ap=ap.shared,K$1&2){var sp=ap.pending;return sp===null?_d.next=_d:(_d.next=sp.next,sp.next=_d),ap.pending=_d,Zg(rp,np)}return sp=ap.interleaved,sp===null?(_d.next=_d,Xg(ap)):(_d.next=sp.next,sp.next=_d),ap.interleaved=_d,Zg(rp,np)}function eh$1(rp,_d,np){if(_d=_d.updateQueue,_d!==null&&(_d=_d.shared,(np&4194240)!==0)){var ap=_d.lanes;ap&=rp.pendingLanes,np|=ap,_d.lanes=np,Cc$1(rp,np)}}function fh$1(rp,_d){var np=rp.updateQueue,ap=rp.alternate;if(ap!==null&&(ap=ap.updateQueue,np===ap)){var sp=null,lp=null;if(np=np.firstBaseUpdate,np!==null){do{var up={eventTime:np.eventTime,lane:np.lane,tag:np.tag,payload:np.payload,callback:np.callback,next:null};lp===null?sp=lp=up:lp=lp.next=up,np=np.next}while(np!==null);lp===null?sp=lp=_d:lp=lp.next=_d}else sp=lp=_d;np={baseState:ap.baseState,firstBaseUpdate:sp,lastBaseUpdate:lp,shared:ap.shared,effects:ap.effects},rp.updateQueue=np;return}rp=np.lastBaseUpdate,rp===null?np.firstBaseUpdate=_d:rp.next=_d,np.lastBaseUpdate=_d}function gh$1(rp,_d,np,ap){var sp=rp.updateQueue;$g=!1;var lp=sp.firstBaseUpdate,up=sp.lastBaseUpdate,cp=sp.shared.pending;if(cp!==null){sp.shared.pending=null;var dp=cp,hp=dp.next;dp.next=null,up===null?lp=hp:up.next=hp,up=dp;var fp=rp.alternate;fp!==null&&(fp=fp.updateQueue,cp=fp.lastBaseUpdate,cp!==up&&(cp===null?fp.firstBaseUpdate=hp:cp.next=hp,fp.lastBaseUpdate=dp))}if(lp!==null){var pp=sp.baseState;up=0,fp=hp=dp=null,cp=lp;do{var mp=cp.lane,gp=cp.eventTime;if((ap&mp)===mp){fp!==null&&(fp=fp.next={eventTime:gp,lane:0,tag:cp.tag,payload:cp.payload,callback:cp.callback,next:null});e:{var yp=rp,xp=cp;switch(mp=_d,gp=np,xp.tag){case 1:if(yp=xp.payload,typeof yp=="function"){pp=yp.call(gp,pp,mp);break e}pp=yp;break e;case 3:yp.flags=yp.flags&-65537|128;case 0:if(yp=xp.payload,mp=typeof yp=="function"?yp.call(gp,pp,mp):yp,mp==null)break e;pp=A$1({},pp,mp);break e;case 2:$g=!0}}cp.callback!==null&&cp.lane!==0&&(rp.flags|=64,mp=sp.effects,mp===null?sp.effects=[cp]:mp.push(cp))}else gp={eventTime:gp,lane:mp,tag:cp.tag,payload:cp.payload,callback:cp.callback,next:null},fp===null?(hp=fp=gp,dp=pp):fp=fp.next=gp,up|=mp;if(cp=cp.next,cp===null){if(cp=sp.shared.pending,cp===null)break;mp=cp,cp=mp.next,mp.next=null,sp.lastBaseUpdate=mp,sp.shared.pending=null}}while(!0);if(fp===null&&(dp=pp),sp.baseState=dp,sp.firstBaseUpdate=hp,sp.lastBaseUpdate=fp,_d=sp.shared.interleaved,_d!==null){sp=_d;do up|=sp.lane,sp=sp.next;while(sp!==_d)}else lp===null&&(sp.shared.lanes=0);hh$1|=up,rp.lanes=up,rp.memoizedState=pp}}function ih$1(rp,_d,np){if(rp=_d.effects,_d.effects=null,rp!==null)for(_d=0;_d<rp.length;_d++){var ap=rp[_d],sp=ap.callback;if(sp!==null){if(ap.callback=null,ap=np,typeof sp!="function")throw Error(p$1(191,sp));sp.call(ap)}}}var jh$1=new aa$1.Component().refs;function kh$1(rp,_d,np,ap){_d=rp.memoizedState,np=np(ap,_d),np=np==null?_d:A$1({},_d,np),rp.memoizedState=np,rp.lanes===0&&(rp.updateQueue.baseState=np)}var nh$1={isMounted:function(rp){return(rp=rp._reactInternals)?Vb(rp)===rp:!1},enqueueSetState:function(rp,_d,np){rp=rp._reactInternals;var ap=L$1(),sp=lh$1(rp),lp=ch$1(ap,sp);lp.payload=_d,np!=null&&(lp.callback=np),_d=dh$1(rp,lp,sp),_d!==null&&(mh$1(_d,rp,sp,ap),eh$1(_d,rp,sp))},enqueueReplaceState:function(rp,_d,np){rp=rp._reactInternals;var ap=L$1(),sp=lh$1(rp),lp=ch$1(ap,sp);lp.tag=1,lp.payload=_d,np!=null&&(lp.callback=np),_d=dh$1(rp,lp,sp),_d!==null&&(mh$1(_d,rp,sp,ap),eh$1(_d,rp,sp))},enqueueForceUpdate:function(rp,_d){rp=rp._reactInternals;var np=L$1(),ap=lh$1(rp),sp=ch$1(np,ap);sp.tag=2,_d!=null&&(sp.callback=_d),_d=dh$1(rp,sp,ap),_d!==null&&(mh$1(_d,rp,ap,np),eh$1(_d,rp,ap))}};function oh$1(rp,_d,np,ap,sp,lp,up){return rp=rp.stateNode,typeof rp.shouldComponentUpdate=="function"?rp.shouldComponentUpdate(ap,lp,up):_d.prototype&&_d.prototype.isPureReactComponent?!Ie$1(np,ap)||!Ie$1(sp,lp):!0}function ph$1(rp,_d,np){var ap=!1,sp=Vf$1,lp=_d.contextType;return typeof lp=="object"&&lp!==null?lp=Vg(lp):(sp=Zf$1(_d)?Xf$1:H$1.current,ap=_d.contextTypes,lp=(ap=ap!=null)?Yf$1(rp,sp):Vf$1),_d=new _d(np,lp),rp.memoizedState=_d.state!==null&&_d.state!==void 0?_d.state:null,_d.updater=nh$1,rp.stateNode=_d,_d._reactInternals=rp,ap&&(rp=rp.stateNode,rp.__reactInternalMemoizedUnmaskedChildContext=sp,rp.__reactInternalMemoizedMaskedChildContext=lp),_d}function qh$1(rp,_d,np,ap){rp=_d.state,typeof _d.componentWillReceiveProps=="function"&&_d.componentWillReceiveProps(np,ap),typeof _d.UNSAFE_componentWillReceiveProps=="function"&&_d.UNSAFE_componentWillReceiveProps(np,ap),_d.state!==rp&&nh$1.enqueueReplaceState(_d,_d.state,null)}function rh$1(rp,_d,np,ap){var sp=rp.stateNode;sp.props=np,sp.state=rp.memoizedState,sp.refs=jh$1,ah$1(rp);var lp=_d.contextType;typeof lp=="object"&&lp!==null?sp.context=Vg(lp):(lp=Zf$1(_d)?Xf$1:H$1.current,sp.context=Yf$1(rp,lp)),sp.state=rp.memoizedState,lp=_d.getDerivedStateFromProps,typeof lp=="function"&&(kh$1(rp,_d,lp,np),sp.state=rp.memoizedState),typeof _d.getDerivedStateFromProps=="function"||typeof sp.getSnapshotBeforeUpdate=="function"||typeof sp.UNSAFE_componentWillMount!="function"&&typeof sp.componentWillMount!="function"||(_d=sp.state,typeof sp.componentWillMount=="function"&&sp.componentWillMount(),typeof sp.UNSAFE_componentWillMount=="function"&&sp.UNSAFE_componentWillMount(),_d!==sp.state&&nh$1.enqueueReplaceState(sp,sp.state,null),gh$1(rp,np,sp,ap),sp.state=rp.memoizedState),typeof sp.componentDidMount=="function"&&(rp.flags|=4194308)}function sh$1(rp,_d,np){if(rp=np.ref,rp!==null&&typeof rp!="function"&&typeof rp!="object"){if(np._owner){if(np=np._owner,np){if(np.tag!==1)throw Error(p$1(309));var ap=np.stateNode}if(!ap)throw Error(p$1(147,rp));var sp=ap,lp=""+rp;return _d!==null&&_d.ref!==null&&typeof _d.ref=="function"&&_d.ref._stringRef===lp?_d.ref:(_d=function(up){var cp=sp.refs;cp===jh$1&&(cp=sp.refs={}),up===null?delete cp[lp]:cp[lp]=up},_d._stringRef=lp,_d)}if(typeof rp!="string")throw Error(p$1(284));if(!np._owner)throw Error(p$1(290,rp))}return rp}function th$1(rp,_d){throw rp=Object.prototype.toString.call(_d),Error(p$1(31,rp==="[object Object]"?"object with keys {"+Object.keys(_d).join(", ")+"}":rp))}function uh$1(rp){var _d=rp._init;return _d(rp._payload)}function vh$1(rp){function _d(vp,bp){if(rp){var Ep=vp.deletions;Ep===null?(vp.deletions=[bp],vp.flags|=16):Ep.push(bp)}}function np(vp,bp){if(!rp)return null;for(;bp!==null;)_d(vp,bp),bp=bp.sibling;return null}function ap(vp,bp){for(vp=new Map;bp!==null;)bp.key!==null?vp.set(bp.key,bp):vp.set(bp.index,bp),bp=bp.sibling;return vp}function sp(vp,bp){return vp=wh$1(vp,bp),vp.index=0,vp.sibling=null,vp}function lp(vp,bp,Ep){return vp.index=Ep,rp?(Ep=vp.alternate,Ep!==null?(Ep=Ep.index,Ep<bp?(vp.flags|=2,bp):Ep):(vp.flags|=2,bp)):(vp.flags|=1048576,bp)}function up(vp){return rp&&vp.alternate===null&&(vp.flags|=2),vp}function cp(vp,bp,Ep,Sp){return bp===null||bp.tag!==6?(bp=xh$1(Ep,vp.mode,Sp),bp.return=vp,bp):(bp=sp(bp,Ep),bp.return=vp,bp)}function dp(vp,bp,Ep,Sp){var Ap=Ep.type;return Ap===ya$1?fp(vp,bp,Ep.props.children,Sp,Ep.key):bp!==null&&(bp.elementType===Ap||typeof Ap=="object"&&Ap!==null&&Ap.$$typeof===Ha$1&&uh$1(Ap)===bp.type)?(Sp=sp(bp,Ep.props),Sp.ref=sh$1(vp,bp,Ep),Sp.return=vp,Sp):(Sp=yh$1(Ep.type,Ep.key,Ep.props,null,vp.mode,Sp),Sp.ref=sh$1(vp,bp,Ep),Sp.return=vp,Sp)}function hp(vp,bp,Ep,Sp){return bp===null||bp.tag!==4||bp.stateNode.containerInfo!==Ep.containerInfo||bp.stateNode.implementation!==Ep.implementation?(bp=zh$1(Ep,vp.mode,Sp),bp.return=vp,bp):(bp=sp(bp,Ep.children||[]),bp.return=vp,bp)}function fp(vp,bp,Ep,Sp,Ap){return bp===null||bp.tag!==7?(bp=Ah$1(Ep,vp.mode,Sp,Ap),bp.return=vp,bp):(bp=sp(bp,Ep),bp.return=vp,bp)}function pp(vp,bp,Ep){if(typeof bp=="string"&&bp!==""||typeof bp=="number")return bp=xh$1(""+bp,vp.mode,Ep),bp.return=vp,bp;if(typeof bp=="object"&&bp!==null){switch(bp.$$typeof){case va$1:return Ep=yh$1(bp.type,bp.key,bp.props,null,vp.mode,Ep),Ep.ref=sh$1(vp,null,bp),Ep.return=vp,Ep;case wa$1:return bp=zh$1(bp,vp.mode,Ep),bp.return=vp,bp;case Ha$1:var Sp=bp._init;return pp(vp,Sp(bp._payload),Ep)}if(eb(bp)||Ka$1(bp))return bp=Ah$1(bp,vp.mode,Ep,null),bp.return=vp,bp;th$1(vp,bp)}return null}function mp(vp,bp,Ep,Sp){var Ap=bp!==null?bp.key:null;if(typeof Ep=="string"&&Ep!==""||typeof Ep=="number")return Ap!==null?null:cp(vp,bp,""+Ep,Sp);if(typeof Ep=="object"&&Ep!==null){switch(Ep.$$typeof){case va$1:return Ep.key===Ap?dp(vp,bp,Ep,Sp):null;case wa$1:return Ep.key===Ap?hp(vp,bp,Ep,Sp):null;case Ha$1:return Ap=Ep._init,mp(vp,bp,Ap(Ep._payload),Sp)}if(eb(Ep)||Ka$1(Ep))return Ap!==null?null:fp(vp,bp,Ep,Sp,null);th$1(vp,Ep)}return null}function gp(vp,bp,Ep,Sp,Ap){if(typeof Sp=="string"&&Sp!==""||typeof Sp=="number")return vp=vp.get(Ep)||null,cp(bp,vp,""+Sp,Ap);if(typeof Sp=="object"&&Sp!==null){switch(Sp.$$typeof){case va$1:return vp=vp.get(Sp.key===null?Ep:Sp.key)||null,dp(bp,vp,Sp,Ap);case wa$1:return vp=vp.get(Sp.key===null?Ep:Sp.key)||null,hp(bp,vp,Sp,Ap);case Ha$1:var Rp=Sp._init;return gp(vp,bp,Ep,Rp(Sp._payload),Ap)}if(eb(Sp)||Ka$1(Sp))return vp=vp.get(Ep)||null,fp(bp,vp,Sp,Ap,null);th$1(bp,Sp)}return null}function yp(vp,bp,Ep,Sp){for(var Ap=null,Rp=null,Tp=bp,Mp=bp=0,Op=null;Tp!==null&&Mp<Ep.length;Mp++){Tp.index>Mp?(Op=Tp,Tp=null):Op=Tp.sibling;var Pp=mp(vp,Tp,Ep[Mp],Sp);if(Pp===null){Tp===null&&(Tp=Op);break}rp&&Tp&&Pp.alternate===null&&_d(vp,Tp),bp=lp(Pp,bp,Mp),Rp===null?Ap=Pp:Rp.sibling=Pp,Rp=Pp,Tp=Op}if(Mp===Ep.length)return np(vp,Tp),I$1&&tg(vp,Mp),Ap;if(Tp===null){for(;Mp<Ep.length;Mp++)Tp=pp(vp,Ep[Mp],Sp),Tp!==null&&(bp=lp(Tp,bp,Mp),Rp===null?Ap=Tp:Rp.sibling=Tp,Rp=Tp);return I$1&&tg(vp,Mp),Ap}for(Tp=ap(vp,Tp);Mp<Ep.length;Mp++)Op=gp(Tp,vp,Mp,Ep[Mp],Sp),Op!==null&&(rp&&Op.alternate!==null&&Tp.delete(Op.key===null?Mp:Op.key),bp=lp(Op,bp,Mp),Rp===null?Ap=Op:Rp.sibling=Op,Rp=Op);return rp&&Tp.forEach(function($p){return _d(vp,$p)}),I$1&&tg(vp,Mp),Ap}function xp(vp,bp,Ep,Sp){var Ap=Ka$1(Ep);if(typeof Ap!="function")throw Error(p$1(150));if(Ep=Ap.call(Ep),Ep==null)throw Error(p$1(151));for(var Rp=Ap=null,Tp=bp,Mp=bp=0,Op=null,Pp=Ep.next();Tp!==null&&!Pp.done;Mp++,Pp=Ep.next()){Tp.index>Mp?(Op=Tp,Tp=null):Op=Tp.sibling;var $p=mp(vp,Tp,Pp.value,Sp);if($p===null){Tp===null&&(Tp=Op);break}rp&&Tp&&$p.alternate===null&&_d(vp,Tp),bp=lp($p,bp,Mp),Rp===null?Ap=$p:Rp.sibling=$p,Rp=$p,Tp=Op}if(Pp.done)return np(vp,Tp),I$1&&tg(vp,Mp),Ap;if(Tp===null){for(;!Pp.done;Mp++,Pp=Ep.next())Pp=pp(vp,Pp.value,Sp),Pp!==null&&(bp=lp(Pp,bp,Mp),Rp===null?Ap=Pp:Rp.sibling=Pp,Rp=Pp);return I$1&&tg(vp,Mp),Ap}for(Tp=ap(vp,Tp);!Pp.done;Mp++,Pp=Ep.next())Pp=gp(Tp,vp,Mp,Pp.value,Sp),Pp!==null&&(rp&&Pp.alternate!==null&&Tp.delete(Pp.key===null?Mp:Pp.key),bp=lp(Pp,bp,Mp),Rp===null?Ap=Pp:Rp.sibling=Pp,Rp=Pp);return rp&&Tp.forEach(function(zp){return _d(vp,zp)}),I$1&&tg(vp,Mp),Ap}function _p(vp,bp,Ep,Sp){if(typeof Ep=="object"&&Ep!==null&&Ep.type===ya$1&&Ep.key===null&&(Ep=Ep.props.children),typeof Ep=="object"&&Ep!==null){switch(Ep.$$typeof){case va$1:e:{for(var Ap=Ep.key,Rp=bp;Rp!==null;){if(Rp.key===Ap){if(Ap=Ep.type,Ap===ya$1){if(Rp.tag===7){np(vp,Rp.sibling),bp=sp(Rp,Ep.props.children),bp.return=vp,vp=bp;break e}}else if(Rp.elementType===Ap||typeof Ap=="object"&&Ap!==null&&Ap.$$typeof===Ha$1&&uh$1(Ap)===Rp.type){np(vp,Rp.sibling),bp=sp(Rp,Ep.props),bp.ref=sh$1(vp,Rp,Ep),bp.return=vp,vp=bp;break e}np(vp,Rp);break}else _d(vp,Rp);Rp=Rp.sibling}Ep.type===ya$1?(bp=Ah$1(Ep.props.children,vp.mode,Sp,Ep.key),bp.return=vp,vp=bp):(Sp=yh$1(Ep.type,Ep.key,Ep.props,null,vp.mode,Sp),Sp.ref=sh$1(vp,bp,Ep),Sp.return=vp,vp=Sp)}return up(vp);case wa$1:e:{for(Rp=Ep.key;bp!==null;){if(bp.key===Rp)if(bp.tag===4&&bp.stateNode.containerInfo===Ep.containerInfo&&bp.stateNode.implementation===Ep.implementation){np(vp,bp.sibling),bp=sp(bp,Ep.children||[]),bp.return=vp,vp=bp;break e}else{np(vp,bp);break}else _d(vp,bp);bp=bp.sibling}bp=zh$1(Ep,vp.mode,Sp),bp.return=vp,vp=bp}return up(vp);case Ha$1:return Rp=Ep._init,_p(vp,bp,Rp(Ep._payload),Sp)}if(eb(Ep))return yp(vp,bp,Ep,Sp);if(Ka$1(Ep))return xp(vp,bp,Ep,Sp);th$1(vp,Ep)}return typeof Ep=="string"&&Ep!==""||typeof Ep=="number"?(Ep=""+Ep,bp!==null&&bp.tag===6?(np(vp,bp.sibling),bp=sp(bp,Ep),bp.return=vp,vp=bp):(np(vp,bp),bp=xh$1(Ep,vp.mode,Sp),bp.return=vp,vp=bp),up(vp)):np(vp,bp)}return _p}var Bh$1=vh$1(!0),Ch$1=vh$1(!1),Dh$1={},Eh$1=Uf$1(Dh$1),Fh$1=Uf$1(Dh$1),Gh$1=Uf$1(Dh$1);function Hh$1(rp){if(rp===Dh$1)throw Error(p$1(174));return rp}function Ih$1(rp,_d){switch(G$1(Gh$1,_d),G$1(Fh$1,rp),G$1(Eh$1,Dh$1),rp=_d.nodeType,rp){case 9:case 11:_d=(_d=_d.documentElement)?_d.namespaceURI:lb(null,"");break;default:rp=rp===8?_d.parentNode:_d,_d=rp.namespaceURI||null,rp=rp.tagName,_d=lb(_d,rp)}E$1(Eh$1),G$1(Eh$1,_d)}function Jh$1(){E$1(Eh$1),E$1(Fh$1),E$1(Gh$1)}function Kh$1(rp){Hh$1(Gh$1.current);var _d=Hh$1(Eh$1.current),np=lb(_d,rp.type);_d!==np&&(G$1(Fh$1,rp),G$1(Eh$1,np))}function Lh$1(rp){Fh$1.current===rp&&(E$1(Eh$1),E$1(Fh$1))}var M$1=Uf$1(0);function Mh$1(rp){for(var _d=rp;_d!==null;){if(_d.tag===13){var np=_d.memoizedState;if(np!==null&&(np=np.dehydrated,np===null||np.data==="$?"||np.data==="$!"))return _d}else if(_d.tag===19&&_d.memoizedProps.revealOrder!==void 0){if(_d.flags&128)return _d}else if(_d.child!==null){_d.child.return=_d,_d=_d.child;continue}if(_d===rp)break;for(;_d.sibling===null;){if(_d.return===null||_d.return===rp)return null;_d=_d.return}_d.sibling.return=_d.return,_d=_d.sibling}return null}var Nh$1=[];function Oh$1(){for(var rp=0;rp<Nh$1.length;rp++)Nh$1[rp]._workInProgressVersionPrimary=null;Nh$1.length=0}var Ph$1=ua$1.ReactCurrentDispatcher,Qh$1=ua$1.ReactCurrentBatchConfig,Rh$1=0,N$1=null,O$1=null,P$1=null,Sh$1=!1,Th$1=!1,Uh$1=0,Vh$1=0;function Q$1(){throw Error(p$1(321))}function Wh$1(rp,_d){if(_d===null)return!1;for(var np=0;np<_d.length&&np<rp.length;np++)if(!He$1(rp[np],_d[np]))return!1;return!0}function Xh$1(rp,_d,np,ap,sp,lp){if(Rh$1=lp,N$1=_d,_d.memoizedState=null,_d.updateQueue=null,_d.lanes=0,Ph$1.current=rp===null||rp.memoizedState===null?Yh$1:Zh$1,rp=np(ap,sp),Th$1){lp=0;do{if(Th$1=!1,Uh$1=0,25<=lp)throw Error(p$1(301));lp+=1,P$1=O$1=null,_d.updateQueue=null,Ph$1.current=$h$1,rp=np(ap,sp)}while(Th$1)}if(Ph$1.current=ai$1,_d=O$1!==null&&O$1.next!==null,Rh$1=0,P$1=O$1=N$1=null,Sh$1=!1,_d)throw Error(p$1(300));return rp}function bi$1(){var rp=Uh$1!==0;return Uh$1=0,rp}function ci$1(){var rp={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P$1===null?N$1.memoizedState=P$1=rp:P$1=P$1.next=rp,P$1}function di$1(){if(O$1===null){var rp=N$1.alternate;rp=rp!==null?rp.memoizedState:null}else rp=O$1.next;var _d=P$1===null?N$1.memoizedState:P$1.next;if(_d!==null)P$1=_d,O$1=rp;else{if(rp===null)throw Error(p$1(310));O$1=rp,rp={memoizedState:O$1.memoizedState,baseState:O$1.baseState,baseQueue:O$1.baseQueue,queue:O$1.queue,next:null},P$1===null?N$1.memoizedState=P$1=rp:P$1=P$1.next=rp}return P$1}function ei$1(rp,_d){return typeof _d=="function"?_d(rp):_d}function fi$1(rp){var _d=di$1(),np=_d.queue;if(np===null)throw Error(p$1(311));np.lastRenderedReducer=rp;var ap=O$1,sp=ap.baseQueue,lp=np.pending;if(lp!==null){if(sp!==null){var up=sp.next;sp.next=lp.next,lp.next=up}ap.baseQueue=sp=lp,np.pending=null}if(sp!==null){lp=sp.next,ap=ap.baseState;var cp=up=null,dp=null,hp=lp;do{var fp=hp.lane;if((Rh$1&fp)===fp)dp!==null&&(dp=dp.next={lane:0,action:hp.action,hasEagerState:hp.hasEagerState,eagerState:hp.eagerState,next:null}),ap=hp.hasEagerState?hp.eagerState:rp(ap,hp.action);else{var pp={lane:fp,action:hp.action,hasEagerState:hp.hasEagerState,eagerState:hp.eagerState,next:null};dp===null?(cp=dp=pp,up=ap):dp=dp.next=pp,N$1.lanes|=fp,hh$1|=fp}hp=hp.next}while(hp!==null&&hp!==lp);dp===null?up=ap:dp.next=cp,He$1(ap,_d.memoizedState)||(Ug=!0),_d.memoizedState=ap,_d.baseState=up,_d.baseQueue=dp,np.lastRenderedState=ap}if(rp=np.interleaved,rp!==null){sp=rp;do lp=sp.lane,N$1.lanes|=lp,hh$1|=lp,sp=sp.next;while(sp!==rp)}else sp===null&&(np.lanes=0);return[_d.memoizedState,np.dispatch]}function gi$1(rp){var _d=di$1(),np=_d.queue;if(np===null)throw Error(p$1(311));np.lastRenderedReducer=rp;var ap=np.dispatch,sp=np.pending,lp=_d.memoizedState;if(sp!==null){np.pending=null;var up=sp=sp.next;do lp=rp(lp,up.action),up=up.next;while(up!==sp);He$1(lp,_d.memoizedState)||(Ug=!0),_d.memoizedState=lp,_d.baseQueue===null&&(_d.baseState=lp),np.lastRenderedState=lp}return[lp,ap]}function hi$1(){}function ii$1(rp,_d){var np=N$1,ap=di$1(),sp=_d(),lp=!He$1(ap.memoizedState,sp);if(lp&&(ap.memoizedState=sp,Ug=!0),ap=ap.queue,ji$1(ki$1.bind(null,np,ap,rp),[rp]),ap.getSnapshot!==_d||lp||P$1!==null&&P$1.memoizedState.tag&1){if(np.flags|=2048,li$1(9,mi$1.bind(null,np,ap,sp,_d),void 0,null),R$2===null)throw Error(p$1(349));Rh$1&30||ni$1(np,_d,sp)}return sp}function ni$1(rp,_d,np){rp.flags|=16384,rp={getSnapshot:_d,value:np},_d=N$1.updateQueue,_d===null?(_d={lastEffect:null,stores:null},N$1.updateQueue=_d,_d.stores=[rp]):(np=_d.stores,np===null?_d.stores=[rp]:np.push(rp))}function mi$1(rp,_d,np,ap){_d.value=np,_d.getSnapshot=ap,oi$1(_d)&&pi$1(rp)}function ki$1(rp,_d,np){return np(function(){oi$1(_d)&&pi$1(rp)})}function oi$1(rp){var _d=rp.getSnapshot;rp=rp.value;try{var np=_d();return!He$1(rp,np)}catch{return!0}}function pi$1(rp){var _d=Zg(rp,1);_d!==null&&mh$1(_d,rp,1,-1)}function qi$1(rp){var _d=ci$1();return typeof rp=="function"&&(rp=rp()),_d.memoizedState=_d.baseState=rp,rp={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei$1,lastRenderedState:rp},_d.queue=rp,rp=rp.dispatch=ri$1.bind(null,N$1,rp),[_d.memoizedState,rp]}function li$1(rp,_d,np,ap){return rp={tag:rp,create:_d,destroy:np,deps:ap,next:null},_d=N$1.updateQueue,_d===null?(_d={lastEffect:null,stores:null},N$1.updateQueue=_d,_d.lastEffect=rp.next=rp):(np=_d.lastEffect,np===null?_d.lastEffect=rp.next=rp:(ap=np.next,np.next=rp,rp.next=ap,_d.lastEffect=rp)),rp}function si$1(){return di$1().memoizedState}function ti$1(rp,_d,np,ap){var sp=ci$1();N$1.flags|=rp,sp.memoizedState=li$1(1|_d,np,void 0,ap===void 0?null:ap)}function ui$1(rp,_d,np,ap){var sp=di$1();ap=ap===void 0?null:ap;var lp=void 0;if(O$1!==null){var up=O$1.memoizedState;if(lp=up.destroy,ap!==null&&Wh$1(ap,up.deps)){sp.memoizedState=li$1(_d,np,lp,ap);return}}N$1.flags|=rp,sp.memoizedState=li$1(1|_d,np,lp,ap)}function vi$1(rp,_d){return ti$1(8390656,8,rp,_d)}function ji$1(rp,_d){return ui$1(2048,8,rp,_d)}function wi$1(rp,_d){return ui$1(4,2,rp,_d)}function xi$1(rp,_d){return ui$1(4,4,rp,_d)}function yi$1(rp,_d){if(typeof _d=="function")return rp=rp(),_d(rp),function(){_d(null)};if(_d!=null)return rp=rp(),_d.current=rp,function(){_d.current=null}}function zi$1(rp,_d,np){return np=np!=null?np.concat([rp]):null,ui$1(4,4,yi$1.bind(null,_d,rp),np)}function Ai$1(){}function Bi$1(rp,_d){var np=di$1();_d=_d===void 0?null:_d;var ap=np.memoizedState;return ap!==null&&_d!==null&&Wh$1(_d,ap[1])?ap[0]:(np.memoizedState=[rp,_d],rp)}function Ci$1(rp,_d){var np=di$1();_d=_d===void 0?null:_d;var ap=np.memoizedState;return ap!==null&&_d!==null&&Wh$1(_d,ap[1])?ap[0]:(rp=rp(),np.memoizedState=[rp,_d],rp)}function Di$1(rp,_d,np){return Rh$1&21?(He$1(np,_d)||(np=yc$1(),N$1.lanes|=np,hh$1|=np,rp.baseState=!0),_d):(rp.baseState&&(rp.baseState=!1,Ug=!0),rp.memoizedState=np)}function Ei$1(rp,_d){var np=C$1;C$1=np!==0&&4>np?np:4,rp(!0);var ap=Qh$1.transition;Qh$1.transition={};try{rp(!1),_d()}finally{C$1=np,Qh$1.transition=ap}}function Fi$1(){return di$1().memoizedState}function Gi$1(rp,_d,np){var ap=lh$1(rp);if(np={lane:ap,action:np,hasEagerState:!1,eagerState:null,next:null},Hi$1(rp))Ii$1(_d,np);else if(np=Yg(rp,_d,np,ap),np!==null){var sp=L$1();mh$1(np,rp,ap,sp),Ji$1(np,_d,ap)}}function ri$1(rp,_d,np){var ap=lh$1(rp),sp={lane:ap,action:np,hasEagerState:!1,eagerState:null,next:null};if(Hi$1(rp))Ii$1(_d,sp);else{var lp=rp.alternate;if(rp.lanes===0&&(lp===null||lp.lanes===0)&&(lp=_d.lastRenderedReducer,lp!==null))try{var up=_d.lastRenderedState,cp=lp(up,np);if(sp.hasEagerState=!0,sp.eagerState=cp,He$1(cp,up)){var dp=_d.interleaved;dp===null?(sp.next=sp,Xg(_d)):(sp.next=dp.next,dp.next=sp),_d.interleaved=sp;return}}catch{}finally{}np=Yg(rp,_d,sp,ap),np!==null&&(sp=L$1(),mh$1(np,rp,ap,sp),Ji$1(np,_d,ap))}}function Hi$1(rp){var _d=rp.alternate;return rp===N$1||_d!==null&&_d===N$1}function Ii$1(rp,_d){Th$1=Sh$1=!0;var np=rp.pending;np===null?_d.next=_d:(_d.next=np.next,np.next=_d),rp.pending=_d}function Ji$1(rp,_d,np){if(np&4194240){var ap=_d.lanes;ap&=rp.pendingLanes,np|=ap,_d.lanes=np,Cc$1(rp,np)}}var ai$1={readContext:Vg,useCallback:Q$1,useContext:Q$1,useEffect:Q$1,useImperativeHandle:Q$1,useInsertionEffect:Q$1,useLayoutEffect:Q$1,useMemo:Q$1,useReducer:Q$1,useRef:Q$1,useState:Q$1,useDebugValue:Q$1,useDeferredValue:Q$1,useTransition:Q$1,useMutableSource:Q$1,useSyncExternalStore:Q$1,useId:Q$1,unstable_isNewReconciler:!1},Yh$1={readContext:Vg,useCallback:function(rp,_d){return ci$1().memoizedState=[rp,_d===void 0?null:_d],rp},useContext:Vg,useEffect:vi$1,useImperativeHandle:function(rp,_d,np){return np=np!=null?np.concat([rp]):null,ti$1(4194308,4,yi$1.bind(null,_d,rp),np)},useLayoutEffect:function(rp,_d){return ti$1(4194308,4,rp,_d)},useInsertionEffect:function(rp,_d){return ti$1(4,2,rp,_d)},useMemo:function(rp,_d){var np=ci$1();return _d=_d===void 0?null:_d,rp=rp(),np.memoizedState=[rp,_d],rp},useReducer:function(rp,_d,np){var ap=ci$1();return _d=np!==void 0?np(_d):_d,ap.memoizedState=ap.baseState=_d,rp={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rp,lastRenderedState:_d},ap.queue=rp,rp=rp.dispatch=Gi$1.bind(null,N$1,rp),[ap.memoizedState,rp]},useRef:function(rp){var _d=ci$1();return rp={current:rp},_d.memoizedState=rp},useState:qi$1,useDebugValue:Ai$1,useDeferredValue:function(rp){return ci$1().memoizedState=rp},useTransition:function(){var rp=qi$1(!1),_d=rp[0];return rp=Ei$1.bind(null,rp[1]),ci$1().memoizedState=rp,[_d,rp]},useMutableSource:function(){},useSyncExternalStore:function(rp,_d,np){var ap=N$1,sp=ci$1();if(I$1){if(np===void 0)throw Error(p$1(407));np=np()}else{if(np=_d(),R$2===null)throw Error(p$1(349));Rh$1&30||ni$1(ap,_d,np)}sp.memoizedState=np;var lp={value:np,getSnapshot:_d};return sp.queue=lp,vi$1(ki$1.bind(null,ap,lp,rp),[rp]),ap.flags|=2048,li$1(9,mi$1.bind(null,ap,lp,np,_d),void 0,null),np},useId:function(){var rp=ci$1(),_d=R$2.identifierPrefix;if(I$1){var np=sg,ap=rg;np=(ap&~(1<<32-oc$1(ap)-1)).toString(32)+np,_d=":"+_d+"R"+np,np=Uh$1++,0<np&&(_d+="H"+np.toString(32)),_d+=":"}else np=Vh$1++,_d=":"+_d+"r"+np.toString(32)+":";return rp.memoizedState=_d},unstable_isNewReconciler:!1},Zh$1={readContext:Vg,useCallback:Bi$1,useContext:Vg,useEffect:ji$1,useImperativeHandle:zi$1,useInsertionEffect:wi$1,useLayoutEffect:xi$1,useMemo:Ci$1,useReducer:fi$1,useRef:si$1,useState:function(){return fi$1(ei$1)},useDebugValue:Ai$1,useDeferredValue:function(rp){var _d=di$1();return Di$1(_d,O$1.memoizedState,rp)},useTransition:function(){var rp=fi$1(ei$1)[0],_d=di$1().memoizedState;return[rp,_d]},useMutableSource:hi$1,useSyncExternalStore:ii$1,useId:Fi$1,unstable_isNewReconciler:!1},$h$1={readContext:Vg,useCallback:Bi$1,useContext:Vg,useEffect:ji$1,useImperativeHandle:zi$1,useInsertionEffect:wi$1,useLayoutEffect:xi$1,useMemo:Ci$1,useReducer:gi$1,useRef:si$1,useState:function(){return gi$1(ei$1)},useDebugValue:Ai$1,useDeferredValue:function(rp){var _d=di$1();return O$1===null?_d.memoizedState=rp:Di$1(_d,O$1.memoizedState,rp)},useTransition:function(){var rp=gi$1(ei$1)[0],_d=di$1().memoizedState;return[rp,_d]},useMutableSource:hi$1,useSyncExternalStore:ii$1,useId:Fi$1,unstable_isNewReconciler:!1};function Ki$1(rp,_d){try{var np="",ap=_d;do np+=Pa$1(ap),ap=ap.return;while(ap);var sp=np}catch(lp){sp=`
Error generating stack: `+lp.message+`
`+lp.stack}return{value:rp,source:_d,stack:sp,digest:null}}function Li$1(rp,_d,np){return{value:rp,source:null,stack:np??null,digest:_d??null}}function Mi$1(rp,_d){try{console.error(_d.value)}catch(np){setTimeout(function(){throw np})}}var Ni$1=typeof WeakMap=="function"?WeakMap:Map;function Oi$1(rp,_d,np){np=ch$1(-1,np),np.tag=3,np.payload={element:null};var ap=_d.value;return np.callback=function(){Pi$1||(Pi$1=!0,Qi$1=ap),Mi$1(rp,_d)},np}function Ri$1(rp,_d,np){np=ch$1(-1,np),np.tag=3;var ap=rp.type.getDerivedStateFromError;if(typeof ap=="function"){var sp=_d.value;np.payload=function(){return ap(sp)},np.callback=function(){Mi$1(rp,_d)}}var lp=rp.stateNode;return lp!==null&&typeof lp.componentDidCatch=="function"&&(np.callback=function(){Mi$1(rp,_d),typeof ap!="function"&&(Si$1===null?Si$1=new Set([this]):Si$1.add(this));var up=_d.stack;this.componentDidCatch(_d.value,{componentStack:up!==null?up:""})}),np}function Ti$1(rp,_d,np){var ap=rp.pingCache;if(ap===null){ap=rp.pingCache=new Ni$1;var sp=new Set;ap.set(_d,sp)}else sp=ap.get(_d),sp===void 0&&(sp=new Set,ap.set(_d,sp));sp.has(np)||(sp.add(np),rp=Ui$1.bind(null,rp,_d,np),_d.then(rp,rp))}function Vi$1(rp){do{var _d;if((_d=rp.tag===13)&&(_d=rp.memoizedState,_d=_d!==null?_d.dehydrated!==null:!0),_d)return rp;rp=rp.return}while(rp!==null);return null}function Wi$1(rp,_d,np,ap,sp){return rp.mode&1?(rp.flags|=65536,rp.lanes=sp,rp):(rp===_d?rp.flags|=65536:(rp.flags|=128,np.flags|=131072,np.flags&=-52805,np.tag===1&&(np.alternate===null?np.tag=17:(_d=ch$1(-1,1),_d.tag=2,dh$1(np,_d,1))),np.lanes|=1),rp)}var Xi$1=ua$1.ReactCurrentOwner,Ug=!1;function Yi$1(rp,_d,np,ap){_d.child=rp===null?Ch$1(_d,null,np,ap):Bh$1(_d,rp.child,np,ap)}function Zi$1(rp,_d,np,ap,sp){np=np.render;var lp=_d.ref;return Tg(_d,sp),ap=Xh$1(rp,_d,np,ap,lp,sp),np=bi$1(),rp!==null&&!Ug?(_d.updateQueue=rp.updateQueue,_d.flags&=-2053,rp.lanes&=~sp,$i$1(rp,_d,sp)):(I$1&&np&&vg(_d),_d.flags|=1,Yi$1(rp,_d,ap,sp),_d.child)}function aj(rp,_d,np,ap,sp){if(rp===null){var lp=np.type;return typeof lp=="function"&&!bj(lp)&&lp.defaultProps===void 0&&np.compare===null&&np.defaultProps===void 0?(_d.tag=15,_d.type=lp,cj(rp,_d,lp,ap,sp)):(rp=yh$1(np.type,null,ap,_d,_d.mode,sp),rp.ref=_d.ref,rp.return=_d,_d.child=rp)}if(lp=rp.child,!(rp.lanes&sp)){var up=lp.memoizedProps;if(np=np.compare,np=np!==null?np:Ie$1,np(up,ap)&&rp.ref===_d.ref)return $i$1(rp,_d,sp)}return _d.flags|=1,rp=wh$1(lp,ap),rp.ref=_d.ref,rp.return=_d,_d.child=rp}function cj(rp,_d,np,ap,sp){if(rp!==null){var lp=rp.memoizedProps;if(Ie$1(lp,ap)&&rp.ref===_d.ref)if(Ug=!1,_d.pendingProps=ap=lp,(rp.lanes&sp)!==0)rp.flags&131072&&(Ug=!0);else return _d.lanes=rp.lanes,$i$1(rp,_d,sp)}return dj(rp,_d,np,ap,sp)}function ej(rp,_d,np){var ap=_d.pendingProps,sp=ap.children,lp=rp!==null?rp.memoizedState:null;if(ap.mode==="hidden")if(!(_d.mode&1))_d.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(fj,gj),gj|=np;else{if(!(np&1073741824))return rp=lp!==null?lp.baseLanes|np:np,_d.lanes=_d.childLanes=1073741824,_d.memoizedState={baseLanes:rp,cachePool:null,transitions:null},_d.updateQueue=null,G$1(fj,gj),gj|=rp,null;_d.memoizedState={baseLanes:0,cachePool:null,transitions:null},ap=lp!==null?lp.baseLanes:np,G$1(fj,gj),gj|=ap}else lp!==null?(ap=lp.baseLanes|np,_d.memoizedState=null):ap=np,G$1(fj,gj),gj|=ap;return Yi$1(rp,_d,sp,np),_d.child}function hj(rp,_d){var np=_d.ref;(rp===null&&np!==null||rp!==null&&rp.ref!==np)&&(_d.flags|=512,_d.flags|=2097152)}function dj(rp,_d,np,ap,sp){var lp=Zf$1(np)?Xf$1:H$1.current;return lp=Yf$1(_d,lp),Tg(_d,sp),np=Xh$1(rp,_d,np,ap,lp,sp),ap=bi$1(),rp!==null&&!Ug?(_d.updateQueue=rp.updateQueue,_d.flags&=-2053,rp.lanes&=~sp,$i$1(rp,_d,sp)):(I$1&&ap&&vg(_d),_d.flags|=1,Yi$1(rp,_d,np,sp),_d.child)}function ij(rp,_d,np,ap,sp){if(Zf$1(np)){var lp=!0;cg(_d)}else lp=!1;if(Tg(_d,sp),_d.stateNode===null)jj(rp,_d),ph$1(_d,np,ap),rh$1(_d,np,ap,sp),ap=!0;else if(rp===null){var up=_d.stateNode,cp=_d.memoizedProps;up.props=cp;var dp=up.context,hp=np.contextType;typeof hp=="object"&&hp!==null?hp=Vg(hp):(hp=Zf$1(np)?Xf$1:H$1.current,hp=Yf$1(_d,hp));var fp=np.getDerivedStateFromProps,pp=typeof fp=="function"||typeof up.getSnapshotBeforeUpdate=="function";pp||typeof up.UNSAFE_componentWillReceiveProps!="function"&&typeof up.componentWillReceiveProps!="function"||(cp!==ap||dp!==hp)&&qh$1(_d,up,ap,hp),$g=!1;var mp=_d.memoizedState;up.state=mp,gh$1(_d,ap,up,sp),dp=_d.memoizedState,cp!==ap||mp!==dp||Wf$1.current||$g?(typeof fp=="function"&&(kh$1(_d,np,fp,ap),dp=_d.memoizedState),(cp=$g||oh$1(_d,np,cp,ap,mp,dp,hp))?(pp||typeof up.UNSAFE_componentWillMount!="function"&&typeof up.componentWillMount!="function"||(typeof up.componentWillMount=="function"&&up.componentWillMount(),typeof up.UNSAFE_componentWillMount=="function"&&up.UNSAFE_componentWillMount()),typeof up.componentDidMount=="function"&&(_d.flags|=4194308)):(typeof up.componentDidMount=="function"&&(_d.flags|=4194308),_d.memoizedProps=ap,_d.memoizedState=dp),up.props=ap,up.state=dp,up.context=hp,ap=cp):(typeof up.componentDidMount=="function"&&(_d.flags|=4194308),ap=!1)}else{up=_d.stateNode,bh$1(rp,_d),cp=_d.memoizedProps,hp=_d.type===_d.elementType?cp:Lg(_d.type,cp),up.props=hp,pp=_d.pendingProps,mp=up.context,dp=np.contextType,typeof dp=="object"&&dp!==null?dp=Vg(dp):(dp=Zf$1(np)?Xf$1:H$1.current,dp=Yf$1(_d,dp));var gp=np.getDerivedStateFromProps;(fp=typeof gp=="function"||typeof up.getSnapshotBeforeUpdate=="function")||typeof up.UNSAFE_componentWillReceiveProps!="function"&&typeof up.componentWillReceiveProps!="function"||(cp!==pp||mp!==dp)&&qh$1(_d,up,ap,dp),$g=!1,mp=_d.memoizedState,up.state=mp,gh$1(_d,ap,up,sp);var yp=_d.memoizedState;cp!==pp||mp!==yp||Wf$1.current||$g?(typeof gp=="function"&&(kh$1(_d,np,gp,ap),yp=_d.memoizedState),(hp=$g||oh$1(_d,np,hp,ap,mp,yp,dp)||!1)?(fp||typeof up.UNSAFE_componentWillUpdate!="function"&&typeof up.componentWillUpdate!="function"||(typeof up.componentWillUpdate=="function"&&up.componentWillUpdate(ap,yp,dp),typeof up.UNSAFE_componentWillUpdate=="function"&&up.UNSAFE_componentWillUpdate(ap,yp,dp)),typeof up.componentDidUpdate=="function"&&(_d.flags|=4),typeof up.getSnapshotBeforeUpdate=="function"&&(_d.flags|=1024)):(typeof up.componentDidUpdate!="function"||cp===rp.memoizedProps&&mp===rp.memoizedState||(_d.flags|=4),typeof up.getSnapshotBeforeUpdate!="function"||cp===rp.memoizedProps&&mp===rp.memoizedState||(_d.flags|=1024),_d.memoizedProps=ap,_d.memoizedState=yp),up.props=ap,up.state=yp,up.context=dp,ap=hp):(typeof up.componentDidUpdate!="function"||cp===rp.memoizedProps&&mp===rp.memoizedState||(_d.flags|=4),typeof up.getSnapshotBeforeUpdate!="function"||cp===rp.memoizedProps&&mp===rp.memoizedState||(_d.flags|=1024),ap=!1)}return kj(rp,_d,np,ap,lp,sp)}function kj(rp,_d,np,ap,sp,lp){hj(rp,_d);var up=(_d.flags&128)!==0;if(!ap&&!up)return sp&&dg(_d,np,!1),$i$1(rp,_d,lp);ap=_d.stateNode,Xi$1.current=_d;var cp=up&&typeof np.getDerivedStateFromError!="function"?null:ap.render();return _d.flags|=1,rp!==null&&up?(_d.child=Bh$1(_d,rp.child,null,lp),_d.child=Bh$1(_d,null,cp,lp)):Yi$1(rp,_d,cp,lp),_d.memoizedState=ap.state,sp&&dg(_d,np,!0),_d.child}function lj(rp){var _d=rp.stateNode;_d.pendingContext?ag(rp,_d.pendingContext,_d.pendingContext!==_d.context):_d.context&&ag(rp,_d.context,!1),Ih$1(rp,_d.containerInfo)}function mj(rp,_d,np,ap,sp){return Ig(),Jg(sp),_d.flags|=256,Yi$1(rp,_d,np,ap),_d.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(rp){return{baseLanes:rp,cachePool:null,transitions:null}}function pj(rp,_d,np){var ap=_d.pendingProps,sp=M$1.current,lp=!1,up=(_d.flags&128)!==0,cp;if((cp=up)||(cp=rp!==null&&rp.memoizedState===null?!1:(sp&2)!==0),cp?(lp=!0,_d.flags&=-129):(rp===null||rp.memoizedState!==null)&&(sp|=1),G$1(M$1,sp&1),rp===null)return Eg(_d),rp=_d.memoizedState,rp!==null&&(rp=rp.dehydrated,rp!==null)?(_d.mode&1?rp.data==="$!"?_d.lanes=8:_d.lanes=1073741824:_d.lanes=1,null):(up=ap.children,rp=ap.fallback,lp?(ap=_d.mode,lp=_d.child,up={mode:"hidden",children:up},!(ap&1)&&lp!==null?(lp.childLanes=0,lp.pendingProps=up):lp=qj(up,ap,0,null),rp=Ah$1(rp,ap,np,null),lp.return=_d,rp.return=_d,lp.sibling=rp,_d.child=lp,_d.child.memoizedState=oj(np),_d.memoizedState=nj,rp):rj(_d,up));if(sp=rp.memoizedState,sp!==null&&(cp=sp.dehydrated,cp!==null))return sj(rp,_d,up,ap,cp,sp,np);if(lp){lp=ap.fallback,up=_d.mode,sp=rp.child,cp=sp.sibling;var dp={mode:"hidden",children:ap.children};return!(up&1)&&_d.child!==sp?(ap=_d.child,ap.childLanes=0,ap.pendingProps=dp,_d.deletions=null):(ap=wh$1(sp,dp),ap.subtreeFlags=sp.subtreeFlags&14680064),cp!==null?lp=wh$1(cp,lp):(lp=Ah$1(lp,up,np,null),lp.flags|=2),lp.return=_d,ap.return=_d,ap.sibling=lp,_d.child=ap,ap=lp,lp=_d.child,up=rp.child.memoizedState,up=up===null?oj(np):{baseLanes:up.baseLanes|np,cachePool:null,transitions:up.transitions},lp.memoizedState=up,lp.childLanes=rp.childLanes&~np,_d.memoizedState=nj,ap}return lp=rp.child,rp=lp.sibling,ap=wh$1(lp,{mode:"visible",children:ap.children}),!(_d.mode&1)&&(ap.lanes=np),ap.return=_d,ap.sibling=null,rp!==null&&(np=_d.deletions,np===null?(_d.deletions=[rp],_d.flags|=16):np.push(rp)),_d.child=ap,_d.memoizedState=null,ap}function rj(rp,_d){return _d=qj({mode:"visible",children:_d},rp.mode,0,null),_d.return=rp,rp.child=_d}function tj(rp,_d,np,ap){return ap!==null&&Jg(ap),Bh$1(_d,rp.child,null,np),rp=rj(_d,_d.pendingProps.children),rp.flags|=2,_d.memoizedState=null,rp}function sj(rp,_d,np,ap,sp,lp,up){if(np)return _d.flags&256?(_d.flags&=-257,ap=Li$1(Error(p$1(422))),tj(rp,_d,up,ap)):_d.memoizedState!==null?(_d.child=rp.child,_d.flags|=128,null):(lp=ap.fallback,sp=_d.mode,ap=qj({mode:"visible",children:ap.children},sp,0,null),lp=Ah$1(lp,sp,up,null),lp.flags|=2,ap.return=_d,lp.return=_d,ap.sibling=lp,_d.child=ap,_d.mode&1&&Bh$1(_d,rp.child,null,up),_d.child.memoizedState=oj(up),_d.memoizedState=nj,lp);if(!(_d.mode&1))return tj(rp,_d,up,null);if(sp.data==="$!"){if(ap=sp.nextSibling&&sp.nextSibling.dataset,ap)var cp=ap.dgst;return ap=cp,lp=Error(p$1(419)),ap=Li$1(lp,ap,void 0),tj(rp,_d,up,ap)}if(cp=(up&rp.childLanes)!==0,Ug||cp){if(ap=R$2,ap!==null){switch(up&-up){case 4:sp=2;break;case 16:sp=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:sp=32;break;case 536870912:sp=268435456;break;default:sp=0}sp=sp&(ap.suspendedLanes|up)?0:sp,sp!==0&&sp!==lp.retryLane&&(lp.retryLane=sp,Zg(rp,sp),mh$1(ap,rp,sp,-1))}return uj(),ap=Li$1(Error(p$1(421))),tj(rp,_d,up,ap)}return sp.data==="$?"?(_d.flags|=128,_d.child=rp.child,_d=vj.bind(null,rp),sp._reactRetry=_d,null):(rp=lp.treeContext,yg=Lf$1(sp.nextSibling),xg=_d,I$1=!0,zg=null,rp!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=rp.id,sg=rp.overflow,qg=_d),_d=rj(_d,ap.children),_d.flags|=4096,_d)}function wj(rp,_d,np){rp.lanes|=_d;var ap=rp.alternate;ap!==null&&(ap.lanes|=_d),Sg(rp.return,_d,np)}function xj(rp,_d,np,ap,sp){var lp=rp.memoizedState;lp===null?rp.memoizedState={isBackwards:_d,rendering:null,renderingStartTime:0,last:ap,tail:np,tailMode:sp}:(lp.isBackwards=_d,lp.rendering=null,lp.renderingStartTime=0,lp.last=ap,lp.tail=np,lp.tailMode=sp)}function yj(rp,_d,np){var ap=_d.pendingProps,sp=ap.revealOrder,lp=ap.tail;if(Yi$1(rp,_d,ap.children,np),ap=M$1.current,ap&2)ap=ap&1|2,_d.flags|=128;else{if(rp!==null&&rp.flags&128)e:for(rp=_d.child;rp!==null;){if(rp.tag===13)rp.memoizedState!==null&&wj(rp,np,_d);else if(rp.tag===19)wj(rp,np,_d);else if(rp.child!==null){rp.child.return=rp,rp=rp.child;continue}if(rp===_d)break e;for(;rp.sibling===null;){if(rp.return===null||rp.return===_d)break e;rp=rp.return}rp.sibling.return=rp.return,rp=rp.sibling}ap&=1}if(G$1(M$1,ap),!(_d.mode&1))_d.memoizedState=null;else switch(sp){case"forwards":for(np=_d.child,sp=null;np!==null;)rp=np.alternate,rp!==null&&Mh$1(rp)===null&&(sp=np),np=np.sibling;np=sp,np===null?(sp=_d.child,_d.child=null):(sp=np.sibling,np.sibling=null),xj(_d,!1,sp,np,lp);break;case"backwards":for(np=null,sp=_d.child,_d.child=null;sp!==null;){if(rp=sp.alternate,rp!==null&&Mh$1(rp)===null){_d.child=sp;break}rp=sp.sibling,sp.sibling=np,np=sp,sp=rp}xj(_d,!0,np,null,lp);break;case"together":xj(_d,!1,null,null,void 0);break;default:_d.memoizedState=null}return _d.child}function jj(rp,_d){!(_d.mode&1)&&rp!==null&&(rp.alternate=null,_d.alternate=null,_d.flags|=2)}function $i$1(rp,_d,np){if(rp!==null&&(_d.dependencies=rp.dependencies),hh$1|=_d.lanes,!(np&_d.childLanes))return null;if(rp!==null&&_d.child!==rp.child)throw Error(p$1(153));if(_d.child!==null){for(rp=_d.child,np=wh$1(rp,rp.pendingProps),_d.child=np,np.return=_d;rp.sibling!==null;)rp=rp.sibling,np=np.sibling=wh$1(rp,rp.pendingProps),np.return=_d;np.sibling=null}return _d.child}function zj(rp,_d,np){switch(_d.tag){case 3:lj(_d),Ig();break;case 5:Kh$1(_d);break;case 1:Zf$1(_d.type)&&cg(_d);break;case 4:Ih$1(_d,_d.stateNode.containerInfo);break;case 10:var ap=_d.type._context,sp=_d.memoizedProps.value;G$1(Mg,ap._currentValue),ap._currentValue=sp;break;case 13:if(ap=_d.memoizedState,ap!==null)return ap.dehydrated!==null?(G$1(M$1,M$1.current&1),_d.flags|=128,null):np&_d.child.childLanes?pj(rp,_d,np):(G$1(M$1,M$1.current&1),rp=$i$1(rp,_d,np),rp!==null?rp.sibling:null);G$1(M$1,M$1.current&1);break;case 19:if(ap=(np&_d.childLanes)!==0,rp.flags&128){if(ap)return yj(rp,_d,np);_d.flags|=128}if(sp=_d.memoizedState,sp!==null&&(sp.rendering=null,sp.tail=null,sp.lastEffect=null),G$1(M$1,M$1.current),ap)break;return null;case 22:case 23:return _d.lanes=0,ej(rp,_d,np)}return $i$1(rp,_d,np)}var Aj,Bj,Cj,Dj;Aj=function(rp,_d){for(var np=_d.child;np!==null;){if(np.tag===5||np.tag===6)rp.appendChild(np.stateNode);else if(np.tag!==4&&np.child!==null){np.child.return=np,np=np.child;continue}if(np===_d)break;for(;np.sibling===null;){if(np.return===null||np.return===_d)return;np=np.return}np.sibling.return=np.return,np=np.sibling}};Bj=function(){};Cj=function(rp,_d,np,ap){var sp=rp.memoizedProps;if(sp!==ap){rp=_d.stateNode,Hh$1(Eh$1.current);var lp=null;switch(np){case"input":sp=Ya$1(rp,sp),ap=Ya$1(rp,ap),lp=[];break;case"select":sp=A$1({},sp,{value:void 0}),ap=A$1({},ap,{value:void 0}),lp=[];break;case"textarea":sp=gb(rp,sp),ap=gb(rp,ap),lp=[];break;default:typeof sp.onClick!="function"&&typeof ap.onClick=="function"&&(rp.onclick=Bf$1)}ub(np,ap);var up;np=null;for(hp in sp)if(!ap.hasOwnProperty(hp)&&sp.hasOwnProperty(hp)&&sp[hp]!=null)if(hp==="style"){var cp=sp[hp];for(up in cp)cp.hasOwnProperty(up)&&(np||(np={}),np[up]="")}else hp!=="dangerouslySetInnerHTML"&&hp!=="children"&&hp!=="suppressContentEditableWarning"&&hp!=="suppressHydrationWarning"&&hp!=="autoFocus"&&(ea$1.hasOwnProperty(hp)?lp||(lp=[]):(lp=lp||[]).push(hp,null));for(hp in ap){var dp=ap[hp];if(cp=sp!=null?sp[hp]:void 0,ap.hasOwnProperty(hp)&&dp!==cp&&(dp!=null||cp!=null))if(hp==="style")if(cp){for(up in cp)!cp.hasOwnProperty(up)||dp&&dp.hasOwnProperty(up)||(np||(np={}),np[up]="");for(up in dp)dp.hasOwnProperty(up)&&cp[up]!==dp[up]&&(np||(np={}),np[up]=dp[up])}else np||(lp||(lp=[]),lp.push(hp,np)),np=dp;else hp==="dangerouslySetInnerHTML"?(dp=dp?dp.__html:void 0,cp=cp?cp.__html:void 0,dp!=null&&cp!==dp&&(lp=lp||[]).push(hp,dp)):hp==="children"?typeof dp!="string"&&typeof dp!="number"||(lp=lp||[]).push(hp,""+dp):hp!=="suppressContentEditableWarning"&&hp!=="suppressHydrationWarning"&&(ea$1.hasOwnProperty(hp)?(dp!=null&&hp==="onScroll"&&D$1("scroll",rp),lp||cp===dp||(lp=[])):(lp=lp||[]).push(hp,dp))}np&&(lp=lp||[]).push("style",np);var hp=lp;(_d.updateQueue=hp)&&(_d.flags|=4)}};Dj=function(rp,_d,np,ap){np!==ap&&(_d.flags|=4)};function Ej(rp,_d){if(!I$1)switch(rp.tailMode){case"hidden":_d=rp.tail;for(var np=null;_d!==null;)_d.alternate!==null&&(np=_d),_d=_d.sibling;np===null?rp.tail=null:np.sibling=null;break;case"collapsed":np=rp.tail;for(var ap=null;np!==null;)np.alternate!==null&&(ap=np),np=np.sibling;ap===null?_d||rp.tail===null?rp.tail=null:rp.tail.sibling=null:ap.sibling=null}}function S$1(rp){var _d=rp.alternate!==null&&rp.alternate.child===rp.child,np=0,ap=0;if(_d)for(var sp=rp.child;sp!==null;)np|=sp.lanes|sp.childLanes,ap|=sp.subtreeFlags&14680064,ap|=sp.flags&14680064,sp.return=rp,sp=sp.sibling;else for(sp=rp.child;sp!==null;)np|=sp.lanes|sp.childLanes,ap|=sp.subtreeFlags,ap|=sp.flags,sp.return=rp,sp=sp.sibling;return rp.subtreeFlags|=ap,rp.childLanes=np,_d}function Fj(rp,_d,np){var ap=_d.pendingProps;switch(wg(_d),_d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(_d),null;case 1:return Zf$1(_d.type)&&$f$1(),S$1(_d),null;case 3:return ap=_d.stateNode,Jh$1(),E$1(Wf$1),E$1(H$1),Oh$1(),ap.pendingContext&&(ap.context=ap.pendingContext,ap.pendingContext=null),(rp===null||rp.child===null)&&(Gg(_d)?_d.flags|=4:rp===null||rp.memoizedState.isDehydrated&&!(_d.flags&256)||(_d.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(rp,_d),S$1(_d),null;case 5:Lh$1(_d);var sp=Hh$1(Gh$1.current);if(np=_d.type,rp!==null&&_d.stateNode!=null)Cj(rp,_d,np,ap,sp),rp.ref!==_d.ref&&(_d.flags|=512,_d.flags|=2097152);else{if(!ap){if(_d.stateNode===null)throw Error(p$1(166));return S$1(_d),null}if(rp=Hh$1(Eh$1.current),Gg(_d)){ap=_d.stateNode,np=_d.type;var lp=_d.memoizedProps;switch(ap[Of$1]=_d,ap[Pf$1]=lp,rp=(_d.mode&1)!==0,np){case"dialog":D$1("cancel",ap),D$1("close",ap);break;case"iframe":case"object":case"embed":D$1("load",ap);break;case"video":case"audio":for(sp=0;sp<lf$1.length;sp++)D$1(lf$1[sp],ap);break;case"source":D$1("error",ap);break;case"img":case"image":case"link":D$1("error",ap),D$1("load",ap);break;case"details":D$1("toggle",ap);break;case"input":Za$1(ap,lp),D$1("invalid",ap);break;case"select":ap._wrapperState={wasMultiple:!!lp.multiple},D$1("invalid",ap);break;case"textarea":hb(ap,lp),D$1("invalid",ap)}ub(np,lp),sp=null;for(var up in lp)if(lp.hasOwnProperty(up)){var cp=lp[up];up==="children"?typeof cp=="string"?ap.textContent!==cp&&(lp.suppressHydrationWarning!==!0&&Af$1(ap.textContent,cp,rp),sp=["children",cp]):typeof cp=="number"&&ap.textContent!==""+cp&&(lp.suppressHydrationWarning!==!0&&Af$1(ap.textContent,cp,rp),sp=["children",""+cp]):ea$1.hasOwnProperty(up)&&cp!=null&&up==="onScroll"&&D$1("scroll",ap)}switch(np){case"input":Va$1(ap),db(ap,lp,!0);break;case"textarea":Va$1(ap),jb(ap);break;case"select":case"option":break;default:typeof lp.onClick=="function"&&(ap.onclick=Bf$1)}ap=sp,_d.updateQueue=ap,ap!==null&&(_d.flags|=4)}else{up=sp.nodeType===9?sp:sp.ownerDocument,rp==="http://www.w3.org/1999/xhtml"&&(rp=kb(np)),rp==="http://www.w3.org/1999/xhtml"?np==="script"?(rp=up.createElement("div"),rp.innerHTML="<script><\/script>",rp=rp.removeChild(rp.firstChild)):typeof ap.is=="string"?rp=up.createElement(np,{is:ap.is}):(rp=up.createElement(np),np==="select"&&(up=rp,ap.multiple?up.multiple=!0:ap.size&&(up.size=ap.size))):rp=up.createElementNS(rp,np),rp[Of$1]=_d,rp[Pf$1]=ap,Aj(rp,_d,!1,!1),_d.stateNode=rp;e:{switch(up=vb(np,ap),np){case"dialog":D$1("cancel",rp),D$1("close",rp),sp=ap;break;case"iframe":case"object":case"embed":D$1("load",rp),sp=ap;break;case"video":case"audio":for(sp=0;sp<lf$1.length;sp++)D$1(lf$1[sp],rp);sp=ap;break;case"source":D$1("error",rp),sp=ap;break;case"img":case"image":case"link":D$1("error",rp),D$1("load",rp),sp=ap;break;case"details":D$1("toggle",rp),sp=ap;break;case"input":Za$1(rp,ap),sp=Ya$1(rp,ap),D$1("invalid",rp);break;case"option":sp=ap;break;case"select":rp._wrapperState={wasMultiple:!!ap.multiple},sp=A$1({},ap,{value:void 0}),D$1("invalid",rp);break;case"textarea":hb(rp,ap),sp=gb(rp,ap),D$1("invalid",rp);break;default:sp=ap}ub(np,sp),cp=sp;for(lp in cp)if(cp.hasOwnProperty(lp)){var dp=cp[lp];lp==="style"?sb(rp,dp):lp==="dangerouslySetInnerHTML"?(dp=dp?dp.__html:void 0,dp!=null&&nb(rp,dp)):lp==="children"?typeof dp=="string"?(np!=="textarea"||dp!=="")&&ob(rp,dp):typeof dp=="number"&&ob(rp,""+dp):lp!=="suppressContentEditableWarning"&&lp!=="suppressHydrationWarning"&&lp!=="autoFocus"&&(ea$1.hasOwnProperty(lp)?dp!=null&&lp==="onScroll"&&D$1("scroll",rp):dp!=null&&ta$1(rp,lp,dp,up))}switch(np){case"input":Va$1(rp),db(rp,ap,!1);break;case"textarea":Va$1(rp),jb(rp);break;case"option":ap.value!=null&&rp.setAttribute("value",""+Sa$1(ap.value));break;case"select":rp.multiple=!!ap.multiple,lp=ap.value,lp!=null?fb(rp,!!ap.multiple,lp,!1):ap.defaultValue!=null&&fb(rp,!!ap.multiple,ap.defaultValue,!0);break;default:typeof sp.onClick=="function"&&(rp.onclick=Bf$1)}switch(np){case"button":case"input":case"select":case"textarea":ap=!!ap.autoFocus;break e;case"img":ap=!0;break e;default:ap=!1}}ap&&(_d.flags|=4)}_d.ref!==null&&(_d.flags|=512,_d.flags|=2097152)}return S$1(_d),null;case 6:if(rp&&_d.stateNode!=null)Dj(rp,_d,rp.memoizedProps,ap);else{if(typeof ap!="string"&&_d.stateNode===null)throw Error(p$1(166));if(np=Hh$1(Gh$1.current),Hh$1(Eh$1.current),Gg(_d)){if(ap=_d.stateNode,np=_d.memoizedProps,ap[Of$1]=_d,(lp=ap.nodeValue!==np)&&(rp=xg,rp!==null))switch(rp.tag){case 3:Af$1(ap.nodeValue,np,(rp.mode&1)!==0);break;case 5:rp.memoizedProps.suppressHydrationWarning!==!0&&Af$1(ap.nodeValue,np,(rp.mode&1)!==0)}lp&&(_d.flags|=4)}else ap=(np.nodeType===9?np:np.ownerDocument).createTextNode(ap),ap[Of$1]=_d,_d.stateNode=ap}return S$1(_d),null;case 13:if(E$1(M$1),ap=_d.memoizedState,rp===null||rp.memoizedState!==null&&rp.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&_d.mode&1&&!(_d.flags&128))Hg(),Ig(),_d.flags|=98560,lp=!1;else if(lp=Gg(_d),ap!==null&&ap.dehydrated!==null){if(rp===null){if(!lp)throw Error(p$1(318));if(lp=_d.memoizedState,lp=lp!==null?lp.dehydrated:null,!lp)throw Error(p$1(317));lp[Of$1]=_d}else Ig(),!(_d.flags&128)&&(_d.memoizedState=null),_d.flags|=4;S$1(_d),lp=!1}else zg!==null&&(Gj(zg),zg=null),lp=!0;if(!lp)return _d.flags&65536?_d:null}return _d.flags&128?(_d.lanes=np,_d):(ap=ap!==null,ap!==(rp!==null&&rp.memoizedState!==null)&&ap&&(_d.child.flags|=8192,_d.mode&1&&(rp===null||M$1.current&1?T$1===0&&(T$1=3):uj())),_d.updateQueue!==null&&(_d.flags|=4),S$1(_d),null);case 4:return Jh$1(),Bj(rp,_d),rp===null&&sf$1(_d.stateNode.containerInfo),S$1(_d),null;case 10:return Rg(_d.type._context),S$1(_d),null;case 17:return Zf$1(_d.type)&&$f$1(),S$1(_d),null;case 19:if(E$1(M$1),lp=_d.memoizedState,lp===null)return S$1(_d),null;if(ap=(_d.flags&128)!==0,up=lp.rendering,up===null)if(ap)Ej(lp,!1);else{if(T$1!==0||rp!==null&&rp.flags&128)for(rp=_d.child;rp!==null;){if(up=Mh$1(rp),up!==null){for(_d.flags|=128,Ej(lp,!1),ap=up.updateQueue,ap!==null&&(_d.updateQueue=ap,_d.flags|=4),_d.subtreeFlags=0,ap=np,np=_d.child;np!==null;)lp=np,rp=ap,lp.flags&=14680066,up=lp.alternate,up===null?(lp.childLanes=0,lp.lanes=rp,lp.child=null,lp.subtreeFlags=0,lp.memoizedProps=null,lp.memoizedState=null,lp.updateQueue=null,lp.dependencies=null,lp.stateNode=null):(lp.childLanes=up.childLanes,lp.lanes=up.lanes,lp.child=up.child,lp.subtreeFlags=0,lp.deletions=null,lp.memoizedProps=up.memoizedProps,lp.memoizedState=up.memoizedState,lp.updateQueue=up.updateQueue,lp.type=up.type,rp=up.dependencies,lp.dependencies=rp===null?null:{lanes:rp.lanes,firstContext:rp.firstContext}),np=np.sibling;return G$1(M$1,M$1.current&1|2),_d.child}rp=rp.sibling}lp.tail!==null&&B$1()>Hj&&(_d.flags|=128,ap=!0,Ej(lp,!1),_d.lanes=4194304)}else{if(!ap)if(rp=Mh$1(up),rp!==null){if(_d.flags|=128,ap=!0,np=rp.updateQueue,np!==null&&(_d.updateQueue=np,_d.flags|=4),Ej(lp,!0),lp.tail===null&&lp.tailMode==="hidden"&&!up.alternate&&!I$1)return S$1(_d),null}else 2*B$1()-lp.renderingStartTime>Hj&&np!==1073741824&&(_d.flags|=128,ap=!0,Ej(lp,!1),_d.lanes=4194304);lp.isBackwards?(up.sibling=_d.child,_d.child=up):(np=lp.last,np!==null?np.sibling=up:_d.child=up,lp.last=up)}return lp.tail!==null?(_d=lp.tail,lp.rendering=_d,lp.tail=_d.sibling,lp.renderingStartTime=B$1(),_d.sibling=null,np=M$1.current,G$1(M$1,ap?np&1|2:np&1),_d):(S$1(_d),null);case 22:case 23:return Ij(),ap=_d.memoizedState!==null,rp!==null&&rp.memoizedState!==null!==ap&&(_d.flags|=8192),ap&&_d.mode&1?gj&1073741824&&(S$1(_d),_d.subtreeFlags&6&&(_d.flags|=8192)):S$1(_d),null;case 24:return null;case 25:return null}throw Error(p$1(156,_d.tag))}function Jj(rp,_d){switch(wg(_d),_d.tag){case 1:return Zf$1(_d.type)&&$f$1(),rp=_d.flags,rp&65536?(_d.flags=rp&-65537|128,_d):null;case 3:return Jh$1(),E$1(Wf$1),E$1(H$1),Oh$1(),rp=_d.flags,rp&65536&&!(rp&128)?(_d.flags=rp&-65537|128,_d):null;case 5:return Lh$1(_d),null;case 13:if(E$1(M$1),rp=_d.memoizedState,rp!==null&&rp.dehydrated!==null){if(_d.alternate===null)throw Error(p$1(340));Ig()}return rp=_d.flags,rp&65536?(_d.flags=rp&-65537|128,_d):null;case 19:return E$1(M$1),null;case 4:return Jh$1(),null;case 10:return Rg(_d.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U$1=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Mj(rp,_d){var np=rp.ref;if(np!==null)if(typeof np=="function")try{np(null)}catch(ap){W$1(rp,_d,ap)}else np.current=null}function Nj(rp,_d,np){try{np()}catch(ap){W$1(rp,_d,ap)}}var Oj=!1;function Pj(rp,_d){if(Cf$1=dd,rp=Me$1(),Ne$1(rp)){if("selectionStart"in rp)var np={start:rp.selectionStart,end:rp.selectionEnd};else e:{np=(np=rp.ownerDocument)&&np.defaultView||window;var ap=np.getSelection&&np.getSelection();if(ap&&ap.rangeCount!==0){np=ap.anchorNode;var sp=ap.anchorOffset,lp=ap.focusNode;ap=ap.focusOffset;try{np.nodeType,lp.nodeType}catch{np=null;break e}var up=0,cp=-1,dp=-1,hp=0,fp=0,pp=rp,mp=null;t:for(;;){for(var gp;pp!==np||sp!==0&&pp.nodeType!==3||(cp=up+sp),pp!==lp||ap!==0&&pp.nodeType!==3||(dp=up+ap),pp.nodeType===3&&(up+=pp.nodeValue.length),(gp=pp.firstChild)!==null;)mp=pp,pp=gp;for(;;){if(pp===rp)break t;if(mp===np&&++hp===sp&&(cp=up),mp===lp&&++fp===ap&&(dp=up),(gp=pp.nextSibling)!==null)break;pp=mp,mp=pp.parentNode}pp=gp}np=cp===-1||dp===-1?null:{start:cp,end:dp}}else np=null}np=np||{start:0,end:0}}else np=null;for(Df$1={focusedElem:rp,selectionRange:np},dd=!1,V$1=_d;V$1!==null;)if(_d=V$1,rp=_d.child,(_d.subtreeFlags&1028)!==0&&rp!==null)rp.return=_d,V$1=rp;else for(;V$1!==null;){_d=V$1;try{var yp=_d.alternate;if(_d.flags&1024)switch(_d.tag){case 0:case 11:case 15:break;case 1:if(yp!==null){var xp=yp.memoizedProps,_p=yp.memoizedState,vp=_d.stateNode,bp=vp.getSnapshotBeforeUpdate(_d.elementType===_d.type?xp:Lg(_d.type,xp),_p);vp.__reactInternalSnapshotBeforeUpdate=bp}break;case 3:var Ep=_d.stateNode.containerInfo;Ep.nodeType===1?Ep.textContent="":Ep.nodeType===9&&Ep.documentElement&&Ep.removeChild(Ep.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(Sp){W$1(_d,_d.return,Sp)}if(rp=_d.sibling,rp!==null){rp.return=_d.return,V$1=rp;break}V$1=_d.return}return yp=Oj,Oj=!1,yp}function Qj(rp,_d,np){var ap=_d.updateQueue;if(ap=ap!==null?ap.lastEffect:null,ap!==null){var sp=ap=ap.next;do{if((sp.tag&rp)===rp){var lp=sp.destroy;sp.destroy=void 0,lp!==void 0&&Nj(_d,np,lp)}sp=sp.next}while(sp!==ap)}}function Rj(rp,_d){if(_d=_d.updateQueue,_d=_d!==null?_d.lastEffect:null,_d!==null){var np=_d=_d.next;do{if((np.tag&rp)===rp){var ap=np.create;np.destroy=ap()}np=np.next}while(np!==_d)}}function Sj(rp){var _d=rp.ref;if(_d!==null){var np=rp.stateNode;switch(rp.tag){case 5:rp=np;break;default:rp=np}typeof _d=="function"?_d(rp):_d.current=rp}}function Tj(rp){var _d=rp.alternate;_d!==null&&(rp.alternate=null,Tj(_d)),rp.child=null,rp.deletions=null,rp.sibling=null,rp.tag===5&&(_d=rp.stateNode,_d!==null&&(delete _d[Of$1],delete _d[Pf$1],delete _d[of$1],delete _d[Qf$1],delete _d[Rf$1])),rp.stateNode=null,rp.return=null,rp.dependencies=null,rp.memoizedProps=null,rp.memoizedState=null,rp.pendingProps=null,rp.stateNode=null,rp.updateQueue=null}function Uj(rp){return rp.tag===5||rp.tag===3||rp.tag===4}function Vj(rp){e:for(;;){for(;rp.sibling===null;){if(rp.return===null||Uj(rp.return))return null;rp=rp.return}for(rp.sibling.return=rp.return,rp=rp.sibling;rp.tag!==5&&rp.tag!==6&&rp.tag!==18;){if(rp.flags&2||rp.child===null||rp.tag===4)continue e;rp.child.return=rp,rp=rp.child}if(!(rp.flags&2))return rp.stateNode}}function Wj(rp,_d,np){var ap=rp.tag;if(ap===5||ap===6)rp=rp.stateNode,_d?np.nodeType===8?np.parentNode.insertBefore(rp,_d):np.insertBefore(rp,_d):(np.nodeType===8?(_d=np.parentNode,_d.insertBefore(rp,np)):(_d=np,_d.appendChild(rp)),np=np._reactRootContainer,np!=null||_d.onclick!==null||(_d.onclick=Bf$1));else if(ap!==4&&(rp=rp.child,rp!==null))for(Wj(rp,_d,np),rp=rp.sibling;rp!==null;)Wj(rp,_d,np),rp=rp.sibling}function Xj(rp,_d,np){var ap=rp.tag;if(ap===5||ap===6)rp=rp.stateNode,_d?np.insertBefore(rp,_d):np.appendChild(rp);else if(ap!==4&&(rp=rp.child,rp!==null))for(Xj(rp,_d,np),rp=rp.sibling;rp!==null;)Xj(rp,_d,np),rp=rp.sibling}var X$1=null,Yj=!1;function Zj(rp,_d,np){for(np=np.child;np!==null;)ak(rp,_d,np),np=np.sibling}function ak(rp,_d,np){if(lc$1&&typeof lc$1.onCommitFiberUnmount=="function")try{lc$1.onCommitFiberUnmount(kc$1,np)}catch{}switch(np.tag){case 5:U$1||Mj(np,_d);case 6:var ap=X$1,sp=Yj;X$1=null,Zj(rp,_d,np),X$1=ap,Yj=sp,X$1!==null&&(Yj?(rp=X$1,np=np.stateNode,rp.nodeType===8?rp.parentNode.removeChild(np):rp.removeChild(np)):X$1.removeChild(np.stateNode));break;case 18:X$1!==null&&(Yj?(rp=X$1,np=np.stateNode,rp.nodeType===8?Kf$1(rp.parentNode,np):rp.nodeType===1&&Kf$1(rp,np),bd(rp)):Kf$1(X$1,np.stateNode));break;case 4:ap=X$1,sp=Yj,X$1=np.stateNode.containerInfo,Yj=!0,Zj(rp,_d,np),X$1=ap,Yj=sp;break;case 0:case 11:case 14:case 15:if(!U$1&&(ap=np.updateQueue,ap!==null&&(ap=ap.lastEffect,ap!==null))){sp=ap=ap.next;do{var lp=sp,up=lp.destroy;lp=lp.tag,up!==void 0&&(lp&2||lp&4)&&Nj(np,_d,up),sp=sp.next}while(sp!==ap)}Zj(rp,_d,np);break;case 1:if(!U$1&&(Mj(np,_d),ap=np.stateNode,typeof ap.componentWillUnmount=="function"))try{ap.props=np.memoizedProps,ap.state=np.memoizedState,ap.componentWillUnmount()}catch(cp){W$1(np,_d,cp)}Zj(rp,_d,np);break;case 21:Zj(rp,_d,np);break;case 22:np.mode&1?(U$1=(ap=U$1)||np.memoizedState!==null,Zj(rp,_d,np),U$1=ap):Zj(rp,_d,np);break;default:Zj(rp,_d,np)}}function bk(rp){var _d=rp.updateQueue;if(_d!==null){rp.updateQueue=null;var np=rp.stateNode;np===null&&(np=rp.stateNode=new Lj),_d.forEach(function(ap){var sp=ck.bind(null,rp,ap);np.has(ap)||(np.add(ap),ap.then(sp,sp))})}}function dk(rp,_d){var np=_d.deletions;if(np!==null)for(var ap=0;ap<np.length;ap++){var sp=np[ap];try{var lp=rp,up=_d,cp=up;e:for(;cp!==null;){switch(cp.tag){case 5:X$1=cp.stateNode,Yj=!1;break e;case 3:X$1=cp.stateNode.containerInfo,Yj=!0;break e;case 4:X$1=cp.stateNode.containerInfo,Yj=!0;break e}cp=cp.return}if(X$1===null)throw Error(p$1(160));ak(lp,up,sp),X$1=null,Yj=!1;var dp=sp.alternate;dp!==null&&(dp.return=null),sp.return=null}catch(hp){W$1(sp,_d,hp)}}if(_d.subtreeFlags&12854)for(_d=_d.child;_d!==null;)ek(_d,rp),_d=_d.sibling}function ek(rp,_d){var np=rp.alternate,ap=rp.flags;switch(rp.tag){case 0:case 11:case 14:case 15:if(dk(_d,rp),fk(rp),ap&4){try{Qj(3,rp,rp.return),Rj(3,rp)}catch(xp){W$1(rp,rp.return,xp)}try{Qj(5,rp,rp.return)}catch(xp){W$1(rp,rp.return,xp)}}break;case 1:dk(_d,rp),fk(rp),ap&512&&np!==null&&Mj(np,np.return);break;case 5:if(dk(_d,rp),fk(rp),ap&512&&np!==null&&Mj(np,np.return),rp.flags&32){var sp=rp.stateNode;try{ob(sp,"")}catch(xp){W$1(rp,rp.return,xp)}}if(ap&4&&(sp=rp.stateNode,sp!=null)){var lp=rp.memoizedProps,up=np!==null?np.memoizedProps:lp,cp=rp.type,dp=rp.updateQueue;if(rp.updateQueue=null,dp!==null)try{cp==="input"&&lp.type==="radio"&&lp.name!=null&&ab(sp,lp),vb(cp,up);var hp=vb(cp,lp);for(up=0;up<dp.length;up+=2){var fp=dp[up],pp=dp[up+1];fp==="style"?sb(sp,pp):fp==="dangerouslySetInnerHTML"?nb(sp,pp):fp==="children"?ob(sp,pp):ta$1(sp,fp,pp,hp)}switch(cp){case"input":bb(sp,lp);break;case"textarea":ib(sp,lp);break;case"select":var mp=sp._wrapperState.wasMultiple;sp._wrapperState.wasMultiple=!!lp.multiple;var gp=lp.value;gp!=null?fb(sp,!!lp.multiple,gp,!1):mp!==!!lp.multiple&&(lp.defaultValue!=null?fb(sp,!!lp.multiple,lp.defaultValue,!0):fb(sp,!!lp.multiple,lp.multiple?[]:"",!1))}sp[Pf$1]=lp}catch(xp){W$1(rp,rp.return,xp)}}break;case 6:if(dk(_d,rp),fk(rp),ap&4){if(rp.stateNode===null)throw Error(p$1(162));sp=rp.stateNode,lp=rp.memoizedProps;try{sp.nodeValue=lp}catch(xp){W$1(rp,rp.return,xp)}}break;case 3:if(dk(_d,rp),fk(rp),ap&4&&np!==null&&np.memoizedState.isDehydrated)try{bd(_d.containerInfo)}catch(xp){W$1(rp,rp.return,xp)}break;case 4:dk(_d,rp),fk(rp);break;case 13:dk(_d,rp),fk(rp),sp=rp.child,sp.flags&8192&&(lp=sp.memoizedState!==null,sp.stateNode.isHidden=lp,!lp||sp.alternate!==null&&sp.alternate.memoizedState!==null||(gk=B$1())),ap&4&&bk(rp);break;case 22:if(fp=np!==null&&np.memoizedState!==null,rp.mode&1?(U$1=(hp=U$1)||fp,dk(_d,rp),U$1=hp):dk(_d,rp),fk(rp),ap&8192){if(hp=rp.memoizedState!==null,(rp.stateNode.isHidden=hp)&&!fp&&rp.mode&1)for(V$1=rp,fp=rp.child;fp!==null;){for(pp=V$1=fp;V$1!==null;){switch(mp=V$1,gp=mp.child,mp.tag){case 0:case 11:case 14:case 15:Qj(4,mp,mp.return);break;case 1:Mj(mp,mp.return);var yp=mp.stateNode;if(typeof yp.componentWillUnmount=="function"){ap=mp,np=mp.return;try{_d=ap,yp.props=_d.memoizedProps,yp.state=_d.memoizedState,yp.componentWillUnmount()}catch(xp){W$1(ap,np,xp)}}break;case 5:Mj(mp,mp.return);break;case 22:if(mp.memoizedState!==null){hk(pp);continue}}gp!==null?(gp.return=mp,V$1=gp):hk(pp)}fp=fp.sibling}e:for(fp=null,pp=rp;;){if(pp.tag===5){if(fp===null){fp=pp;try{sp=pp.stateNode,hp?(lp=sp.style,typeof lp.setProperty=="function"?lp.setProperty("display","none","important"):lp.display="none"):(cp=pp.stateNode,dp=pp.memoizedProps.style,up=dp!=null&&dp.hasOwnProperty("display")?dp.display:null,cp.style.display=rb("display",up))}catch(xp){W$1(rp,rp.return,xp)}}}else if(pp.tag===6){if(fp===null)try{pp.stateNode.nodeValue=hp?"":pp.memoizedProps}catch(xp){W$1(rp,rp.return,xp)}}else if((pp.tag!==22&&pp.tag!==23||pp.memoizedState===null||pp===rp)&&pp.child!==null){pp.child.return=pp,pp=pp.child;continue}if(pp===rp)break e;for(;pp.sibling===null;){if(pp.return===null||pp.return===rp)break e;fp===pp&&(fp=null),pp=pp.return}fp===pp&&(fp=null),pp.sibling.return=pp.return,pp=pp.sibling}}break;case 19:dk(_d,rp),fk(rp),ap&4&&bk(rp);break;case 21:break;default:dk(_d,rp),fk(rp)}}function fk(rp){var _d=rp.flags;if(_d&2){try{e:{for(var np=rp.return;np!==null;){if(Uj(np)){var ap=np;break e}np=np.return}throw Error(p$1(160))}switch(ap.tag){case 5:var sp=ap.stateNode;ap.flags&32&&(ob(sp,""),ap.flags&=-33);var lp=Vj(rp);Xj(rp,lp,sp);break;case 3:case 4:var up=ap.stateNode.containerInfo,cp=Vj(rp);Wj(rp,cp,up);break;default:throw Error(p$1(161))}}catch(dp){W$1(rp,rp.return,dp)}rp.flags&=-3}_d&4096&&(rp.flags&=-4097)}function ik(rp,_d,np){V$1=rp,jk(rp)}function jk(rp,_d,np){for(var ap=(rp.mode&1)!==0;V$1!==null;){var sp=V$1,lp=sp.child;if(sp.tag===22&&ap){var up=sp.memoizedState!==null||Kj;if(!up){var cp=sp.alternate,dp=cp!==null&&cp.memoizedState!==null||U$1;cp=Kj;var hp=U$1;if(Kj=up,(U$1=dp)&&!hp)for(V$1=sp;V$1!==null;)up=V$1,dp=up.child,up.tag===22&&up.memoizedState!==null?kk(sp):dp!==null?(dp.return=up,V$1=dp):kk(sp);for(;lp!==null;)V$1=lp,jk(lp),lp=lp.sibling;V$1=sp,Kj=cp,U$1=hp}lk(rp)}else sp.subtreeFlags&8772&&lp!==null?(lp.return=sp,V$1=lp):lk(rp)}}function lk(rp){for(;V$1!==null;){var _d=V$1;if(_d.flags&8772){var np=_d.alternate;try{if(_d.flags&8772)switch(_d.tag){case 0:case 11:case 15:U$1||Rj(5,_d);break;case 1:var ap=_d.stateNode;if(_d.flags&4&&!U$1)if(np===null)ap.componentDidMount();else{var sp=_d.elementType===_d.type?np.memoizedProps:Lg(_d.type,np.memoizedProps);ap.componentDidUpdate(sp,np.memoizedState,ap.__reactInternalSnapshotBeforeUpdate)}var lp=_d.updateQueue;lp!==null&&ih$1(_d,lp,ap);break;case 3:var up=_d.updateQueue;if(up!==null){if(np=null,_d.child!==null)switch(_d.child.tag){case 5:np=_d.child.stateNode;break;case 1:np=_d.child.stateNode}ih$1(_d,up,np)}break;case 5:var cp=_d.stateNode;if(np===null&&_d.flags&4){np=cp;var dp=_d.memoizedProps;switch(_d.type){case"button":case"input":case"select":case"textarea":dp.autoFocus&&np.focus();break;case"img":dp.src&&(np.src=dp.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(_d.memoizedState===null){var hp=_d.alternate;if(hp!==null){var fp=hp.memoizedState;if(fp!==null){var pp=fp.dehydrated;pp!==null&&bd(pp)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U$1||_d.flags&512&&Sj(_d)}catch(mp){W$1(_d,_d.return,mp)}}if(_d===rp){V$1=null;break}if(np=_d.sibling,np!==null){np.return=_d.return,V$1=np;break}V$1=_d.return}}function hk(rp){for(;V$1!==null;){var _d=V$1;if(_d===rp){V$1=null;break}var np=_d.sibling;if(np!==null){np.return=_d.return,V$1=np;break}V$1=_d.return}}function kk(rp){for(;V$1!==null;){var _d=V$1;try{switch(_d.tag){case 0:case 11:case 15:var np=_d.return;try{Rj(4,_d)}catch(dp){W$1(_d,np,dp)}break;case 1:var ap=_d.stateNode;if(typeof ap.componentDidMount=="function"){var sp=_d.return;try{ap.componentDidMount()}catch(dp){W$1(_d,sp,dp)}}var lp=_d.return;try{Sj(_d)}catch(dp){W$1(_d,lp,dp)}break;case 5:var up=_d.return;try{Sj(_d)}catch(dp){W$1(_d,up,dp)}}}catch(dp){W$1(_d,_d.return,dp)}if(_d===rp){V$1=null;break}var cp=_d.sibling;if(cp!==null){cp.return=_d.return,V$1=cp;break}V$1=_d.return}}var mk=Math.ceil,nk=ua$1.ReactCurrentDispatcher,ok=ua$1.ReactCurrentOwner,pk=ua$1.ReactCurrentBatchConfig,K$1=0,R$2=null,Y$1=null,Z$1=0,gj=0,fj=Uf$1(0),T$1=0,qk=null,hh$1=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi$1=!1,Qi$1=null,Si$1=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L$1(){return K$1&6?B$1():Bk!==-1?Bk:Bk=B$1()}function lh$1(rp){return rp.mode&1?K$1&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Ck===0&&(Ck=yc$1()),Ck):(rp=C$1,rp!==0||(rp=window.event,rp=rp===void 0?16:jd(rp.type)),rp):1}function mh$1(rp,_d,np,ap){if(50<zk)throw zk=0,Ak=null,Error(p$1(185));Ac$1(rp,np,ap),(!(K$1&2)||rp!==R$2)&&(rp===R$2&&(!(K$1&2)&&(rk|=np),T$1===4&&Dk(rp,Z$1)),Ek(rp,ap),np===1&&K$1===0&&!(_d.mode&1)&&(Hj=B$1()+500,fg&&jg()))}function Ek(rp,_d){var np=rp.callbackNode;wc$1(rp,_d);var ap=uc$1(rp,rp===R$2?Z$1:0);if(ap===0)np!==null&&bc$1(np),rp.callbackNode=null,rp.callbackPriority=0;else if(_d=ap&-ap,rp.callbackPriority!==_d){if(np!=null&&bc$1(np),_d===1)rp.tag===0?ig(Fk.bind(null,rp)):hg(Fk.bind(null,rp)),Jf$1(function(){!(K$1&6)&&jg()}),np=null;else{switch(Dc$1(ap)){case 1:np=fc$1;break;case 4:np=gc$1;break;case 16:np=hc$1;break;case 536870912:np=jc$1;break;default:np=hc$1}np=Gk(np,Hk.bind(null,rp))}rp.callbackPriority=_d,rp.callbackNode=np}}function Hk(rp,_d){if(Bk=-1,Ck=0,K$1&6)throw Error(p$1(327));var np=rp.callbackNode;if(Ik()&&rp.callbackNode!==np)return null;var ap=uc$1(rp,rp===R$2?Z$1:0);if(ap===0)return null;if(ap&30||ap&rp.expiredLanes||_d)_d=Jk(rp,ap);else{_d=ap;var sp=K$1;K$1|=2;var lp=Kk();(R$2!==rp||Z$1!==_d)&&(vk=null,Hj=B$1()+500,Lk(rp,_d));do try{Mk();break}catch(cp){Nk(rp,cp)}while(!0);Qg(),nk.current=lp,K$1=sp,Y$1!==null?_d=0:(R$2=null,Z$1=0,_d=T$1)}if(_d!==0){if(_d===2&&(sp=xc$1(rp),sp!==0&&(ap=sp,_d=Ok(rp,sp))),_d===1)throw np=qk,Lk(rp,0),Dk(rp,ap),Ek(rp,B$1()),np;if(_d===6)Dk(rp,ap);else{if(sp=rp.current.alternate,!(ap&30)&&!Pk(sp)&&(_d=Jk(rp,ap),_d===2&&(lp=xc$1(rp),lp!==0&&(ap=lp,_d=Ok(rp,lp))),_d===1))throw np=qk,Lk(rp,0),Dk(rp,ap),Ek(rp,B$1()),np;switch(rp.finishedWork=sp,rp.finishedLanes=ap,_d){case 0:case 1:throw Error(p$1(345));case 2:Qk(rp,uk,vk);break;case 3:if(Dk(rp,ap),(ap&130023424)===ap&&(_d=gk+500-B$1(),10<_d)){if(uc$1(rp,0)!==0)break;if(sp=rp.suspendedLanes,(sp&ap)!==ap){L$1(),rp.pingedLanes|=rp.suspendedLanes&sp;break}rp.timeoutHandle=Ff$1(Qk.bind(null,rp,uk,vk),_d);break}Qk(rp,uk,vk);break;case 4:if(Dk(rp,ap),(ap&4194240)===ap)break;for(_d=rp.eventTimes,sp=-1;0<ap;){var up=31-oc$1(ap);lp=1<<up,up=_d[up],up>sp&&(sp=up),ap&=~lp}if(ap=sp,ap=B$1()-ap,ap=(120>ap?120:480>ap?480:1080>ap?1080:1920>ap?1920:3e3>ap?3e3:4320>ap?4320:1960*mk(ap/1960))-ap,10<ap){rp.timeoutHandle=Ff$1(Qk.bind(null,rp,uk,vk),ap);break}Qk(rp,uk,vk);break;case 5:Qk(rp,uk,vk);break;default:throw Error(p$1(329))}}}return Ek(rp,B$1()),rp.callbackNode===np?Hk.bind(null,rp):null}function Ok(rp,_d){var np=tk;return rp.current.memoizedState.isDehydrated&&(Lk(rp,_d).flags|=256),rp=Jk(rp,_d),rp!==2&&(_d=uk,uk=np,_d!==null&&Gj(_d)),rp}function Gj(rp){uk===null?uk=rp:uk.push.apply(uk,rp)}function Pk(rp){for(var _d=rp;;){if(_d.flags&16384){var np=_d.updateQueue;if(np!==null&&(np=np.stores,np!==null))for(var ap=0;ap<np.length;ap++){var sp=np[ap],lp=sp.getSnapshot;sp=sp.value;try{if(!He$1(lp(),sp))return!1}catch{return!1}}}if(np=_d.child,_d.subtreeFlags&16384&&np!==null)np.return=_d,_d=np;else{if(_d===rp)break;for(;_d.sibling===null;){if(_d.return===null||_d.return===rp)return!0;_d=_d.return}_d.sibling.return=_d.return,_d=_d.sibling}}return!0}function Dk(rp,_d){for(_d&=~sk,_d&=~rk,rp.suspendedLanes|=_d,rp.pingedLanes&=~_d,rp=rp.expirationTimes;0<_d;){var np=31-oc$1(_d),ap=1<<np;rp[np]=-1,_d&=~ap}}function Fk(rp){if(K$1&6)throw Error(p$1(327));Ik();var _d=uc$1(rp,0);if(!(_d&1))return Ek(rp,B$1()),null;var np=Jk(rp,_d);if(rp.tag!==0&&np===2){var ap=xc$1(rp);ap!==0&&(_d=ap,np=Ok(rp,ap))}if(np===1)throw np=qk,Lk(rp,0),Dk(rp,_d),Ek(rp,B$1()),np;if(np===6)throw Error(p$1(345));return rp.finishedWork=rp.current.alternate,rp.finishedLanes=_d,Qk(rp,uk,vk),Ek(rp,B$1()),null}function Rk(rp,_d){var np=K$1;K$1|=1;try{return rp(_d)}finally{K$1=np,K$1===0&&(Hj=B$1()+500,fg&&jg())}}function Sk(rp){xk!==null&&xk.tag===0&&!(K$1&6)&&Ik();var _d=K$1;K$1|=1;var np=pk.transition,ap=C$1;try{if(pk.transition=null,C$1=1,rp)return rp()}finally{C$1=ap,pk.transition=np,K$1=_d,!(K$1&6)&&jg()}}function Ij(){gj=fj.current,E$1(fj)}function Lk(rp,_d){rp.finishedWork=null,rp.finishedLanes=0;var np=rp.timeoutHandle;if(np!==-1&&(rp.timeoutHandle=-1,Gf$1(np)),Y$1!==null)for(np=Y$1.return;np!==null;){var ap=np;switch(wg(ap),ap.tag){case 1:ap=ap.type.childContextTypes,ap!=null&&$f$1();break;case 3:Jh$1(),E$1(Wf$1),E$1(H$1),Oh$1();break;case 5:Lh$1(ap);break;case 4:Jh$1();break;case 13:E$1(M$1);break;case 19:E$1(M$1);break;case 10:Rg(ap.type._context);break;case 22:case 23:Ij()}np=np.return}if(R$2=rp,Y$1=rp=wh$1(rp.current,null),Z$1=gj=_d,T$1=0,qk=null,sk=rk=hh$1=0,uk=tk=null,Wg!==null){for(_d=0;_d<Wg.length;_d++)if(np=Wg[_d],ap=np.interleaved,ap!==null){np.interleaved=null;var sp=ap.next,lp=np.pending;if(lp!==null){var up=lp.next;lp.next=sp,ap.next=up}np.pending=ap}Wg=null}return rp}function Nk(rp,_d){do{var np=Y$1;try{if(Qg(),Ph$1.current=ai$1,Sh$1){for(var ap=N$1.memoizedState;ap!==null;){var sp=ap.queue;sp!==null&&(sp.pending=null),ap=ap.next}Sh$1=!1}if(Rh$1=0,P$1=O$1=N$1=null,Th$1=!1,Uh$1=0,ok.current=null,np===null||np.return===null){T$1=1,qk=_d,Y$1=null;break}e:{var lp=rp,up=np.return,cp=np,dp=_d;if(_d=Z$1,cp.flags|=32768,dp!==null&&typeof dp=="object"&&typeof dp.then=="function"){var hp=dp,fp=cp,pp=fp.tag;if(!(fp.mode&1)&&(pp===0||pp===11||pp===15)){var mp=fp.alternate;mp?(fp.updateQueue=mp.updateQueue,fp.memoizedState=mp.memoizedState,fp.lanes=mp.lanes):(fp.updateQueue=null,fp.memoizedState=null)}var gp=Vi$1(up);if(gp!==null){gp.flags&=-257,Wi$1(gp,up,cp,lp,_d),gp.mode&1&&Ti$1(lp,hp,_d),_d=gp,dp=hp;var yp=_d.updateQueue;if(yp===null){var xp=new Set;xp.add(dp),_d.updateQueue=xp}else yp.add(dp);break e}else{if(!(_d&1)){Ti$1(lp,hp,_d),uj();break e}dp=Error(p$1(426))}}else if(I$1&&cp.mode&1){var _p=Vi$1(up);if(_p!==null){!(_p.flags&65536)&&(_p.flags|=256),Wi$1(_p,up,cp,lp,_d),Jg(Ki$1(dp,cp));break e}}lp=dp=Ki$1(dp,cp),T$1!==4&&(T$1=2),tk===null?tk=[lp]:tk.push(lp),lp=up;do{switch(lp.tag){case 3:lp.flags|=65536,_d&=-_d,lp.lanes|=_d;var vp=Oi$1(lp,dp,_d);fh$1(lp,vp);break e;case 1:cp=dp;var bp=lp.type,Ep=lp.stateNode;if(!(lp.flags&128)&&(typeof bp.getDerivedStateFromError=="function"||Ep!==null&&typeof Ep.componentDidCatch=="function"&&(Si$1===null||!Si$1.has(Ep)))){lp.flags|=65536,_d&=-_d,lp.lanes|=_d;var Sp=Ri$1(lp,cp,_d);fh$1(lp,Sp);break e}}lp=lp.return}while(lp!==null)}Tk(np)}catch(Ap){_d=Ap,Y$1===np&&np!==null&&(Y$1=np=np.return);continue}break}while(!0)}function Kk(){var rp=nk.current;return nk.current=ai$1,rp===null?ai$1:rp}function uj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),R$2===null||!(hh$1&268435455)&&!(rk&268435455)||Dk(R$2,Z$1)}function Jk(rp,_d){var np=K$1;K$1|=2;var ap=Kk();(R$2!==rp||Z$1!==_d)&&(vk=null,Lk(rp,_d));do try{Uk();break}catch(sp){Nk(rp,sp)}while(!0);if(Qg(),K$1=np,nk.current=ap,Y$1!==null)throw Error(p$1(261));return R$2=null,Z$1=0,T$1}function Uk(){for(;Y$1!==null;)Vk(Y$1)}function Mk(){for(;Y$1!==null&&!cc$1();)Vk(Y$1)}function Vk(rp){var _d=Wk(rp.alternate,rp,gj);rp.memoizedProps=rp.pendingProps,_d===null?Tk(rp):Y$1=_d,ok.current=null}function Tk(rp){var _d=rp;do{var np=_d.alternate;if(rp=_d.return,_d.flags&32768){if(np=Jj(np,_d),np!==null){np.flags&=32767,Y$1=np;return}if(rp!==null)rp.flags|=32768,rp.subtreeFlags=0,rp.deletions=null;else{T$1=6,Y$1=null;return}}else if(np=Fj(np,_d,gj),np!==null){Y$1=np;return}if(_d=_d.sibling,_d!==null){Y$1=_d;return}Y$1=_d=rp}while(_d!==null);T$1===0&&(T$1=5)}function Qk(rp,_d,np){var ap=C$1,sp=pk.transition;try{pk.transition=null,C$1=1,Xk(rp,_d,np,ap)}finally{pk.transition=sp,C$1=ap}return null}function Xk(rp,_d,np,ap){do Ik();while(xk!==null);if(K$1&6)throw Error(p$1(327));np=rp.finishedWork;var sp=rp.finishedLanes;if(np===null)return null;if(rp.finishedWork=null,rp.finishedLanes=0,np===rp.current)throw Error(p$1(177));rp.callbackNode=null,rp.callbackPriority=0;var lp=np.lanes|np.childLanes;if(Bc$1(rp,lp),rp===R$2&&(Y$1=R$2=null,Z$1=0),!(np.subtreeFlags&2064)&&!(np.flags&2064)||wk||(wk=!0,Gk(hc$1,function(){return Ik(),null})),lp=(np.flags&15990)!==0,np.subtreeFlags&15990||lp){lp=pk.transition,pk.transition=null;var up=C$1;C$1=1;var cp=K$1;K$1|=4,ok.current=null,Pj(rp,np),ek(np,rp),Oe$1(Df$1),dd=!!Cf$1,Df$1=Cf$1=null,rp.current=np,ik(np),dc$1(),K$1=cp,C$1=up,pk.transition=lp}else rp.current=np;if(wk&&(wk=!1,xk=rp,yk=sp),lp=rp.pendingLanes,lp===0&&(Si$1=null),mc$1(np.stateNode),Ek(rp,B$1()),_d!==null)for(ap=rp.onRecoverableError,np=0;np<_d.length;np++)sp=_d[np],ap(sp.value,{componentStack:sp.stack,digest:sp.digest});if(Pi$1)throw Pi$1=!1,rp=Qi$1,Qi$1=null,rp;return yk&1&&rp.tag!==0&&Ik(),lp=rp.pendingLanes,lp&1?rp===Ak?zk++:(zk=0,Ak=rp):zk=0,jg(),null}function Ik(){if(xk!==null){var rp=Dc$1(yk),_d=pk.transition,np=C$1;try{if(pk.transition=null,C$1=16>rp?16:rp,xk===null)var ap=!1;else{if(rp=xk,xk=null,yk=0,K$1&6)throw Error(p$1(331));var sp=K$1;for(K$1|=4,V$1=rp.current;V$1!==null;){var lp=V$1,up=lp.child;if(V$1.flags&16){var cp=lp.deletions;if(cp!==null){for(var dp=0;dp<cp.length;dp++){var hp=cp[dp];for(V$1=hp;V$1!==null;){var fp=V$1;switch(fp.tag){case 0:case 11:case 15:Qj(8,fp,lp)}var pp=fp.child;if(pp!==null)pp.return=fp,V$1=pp;else for(;V$1!==null;){fp=V$1;var mp=fp.sibling,gp=fp.return;if(Tj(fp),fp===hp){V$1=null;break}if(mp!==null){mp.return=gp,V$1=mp;break}V$1=gp}}}var yp=lp.alternate;if(yp!==null){var xp=yp.child;if(xp!==null){yp.child=null;do{var _p=xp.sibling;xp.sibling=null,xp=_p}while(xp!==null)}}V$1=lp}}if(lp.subtreeFlags&2064&&up!==null)up.return=lp,V$1=up;else e:for(;V$1!==null;){if(lp=V$1,lp.flags&2048)switch(lp.tag){case 0:case 11:case 15:Qj(9,lp,lp.return)}var vp=lp.sibling;if(vp!==null){vp.return=lp.return,V$1=vp;break e}V$1=lp.return}}var bp=rp.current;for(V$1=bp;V$1!==null;){up=V$1;var Ep=up.child;if(up.subtreeFlags&2064&&Ep!==null)Ep.return=up,V$1=Ep;else e:for(up=bp;V$1!==null;){if(cp=V$1,cp.flags&2048)try{switch(cp.tag){case 0:case 11:case 15:Rj(9,cp)}}catch(Ap){W$1(cp,cp.return,Ap)}if(cp===up){V$1=null;break e}var Sp=cp.sibling;if(Sp!==null){Sp.return=cp.return,V$1=Sp;break e}V$1=cp.return}}if(K$1=sp,jg(),lc$1&&typeof lc$1.onPostCommitFiberRoot=="function")try{lc$1.onPostCommitFiberRoot(kc$1,rp)}catch{}ap=!0}return ap}finally{C$1=np,pk.transition=_d}}return!1}function Yk(rp,_d,np){_d=Ki$1(np,_d),_d=Oi$1(rp,_d,1),rp=dh$1(rp,_d,1),_d=L$1(),rp!==null&&(Ac$1(rp,1,_d),Ek(rp,_d))}function W$1(rp,_d,np){if(rp.tag===3)Yk(rp,rp,np);else for(;_d!==null;){if(_d.tag===3){Yk(_d,rp,np);break}else if(_d.tag===1){var ap=_d.stateNode;if(typeof _d.type.getDerivedStateFromError=="function"||typeof ap.componentDidCatch=="function"&&(Si$1===null||!Si$1.has(ap))){rp=Ki$1(np,rp),rp=Ri$1(_d,rp,1),_d=dh$1(_d,rp,1),rp=L$1(),_d!==null&&(Ac$1(_d,1,rp),Ek(_d,rp));break}}_d=_d.return}}function Ui$1(rp,_d,np){var ap=rp.pingCache;ap!==null&&ap.delete(_d),_d=L$1(),rp.pingedLanes|=rp.suspendedLanes&np,R$2===rp&&(Z$1&np)===np&&(T$1===4||T$1===3&&(Z$1&130023424)===Z$1&&500>B$1()-gk?Lk(rp,0):sk|=np),Ek(rp,_d)}function Zk(rp,_d){_d===0&&(rp.mode&1?(_d=sc$1,sc$1<<=1,!(sc$1&130023424)&&(sc$1=4194304)):_d=1);var np=L$1();rp=Zg(rp,_d),rp!==null&&(Ac$1(rp,_d,np),Ek(rp,np))}function vj(rp){var _d=rp.memoizedState,np=0;_d!==null&&(np=_d.retryLane),Zk(rp,np)}function ck(rp,_d){var np=0;switch(rp.tag){case 13:var ap=rp.stateNode,sp=rp.memoizedState;sp!==null&&(np=sp.retryLane);break;case 19:ap=rp.stateNode;break;default:throw Error(p$1(314))}ap!==null&&ap.delete(_d),Zk(rp,np)}var Wk;Wk=function(rp,_d,np){if(rp!==null)if(rp.memoizedProps!==_d.pendingProps||Wf$1.current)Ug=!0;else{if(!(rp.lanes&np)&&!(_d.flags&128))return Ug=!1,zj(rp,_d,np);Ug=!!(rp.flags&131072)}else Ug=!1,I$1&&_d.flags&1048576&&ug(_d,ng,_d.index);switch(_d.lanes=0,_d.tag){case 2:var ap=_d.type;jj(rp,_d),rp=_d.pendingProps;var sp=Yf$1(_d,H$1.current);Tg(_d,np),sp=Xh$1(null,_d,ap,rp,sp,np);var lp=bi$1();return _d.flags|=1,typeof sp=="object"&&sp!==null&&typeof sp.render=="function"&&sp.$$typeof===void 0?(_d.tag=1,_d.memoizedState=null,_d.updateQueue=null,Zf$1(ap)?(lp=!0,cg(_d)):lp=!1,_d.memoizedState=sp.state!==null&&sp.state!==void 0?sp.state:null,ah$1(_d),sp.updater=nh$1,_d.stateNode=sp,sp._reactInternals=_d,rh$1(_d,ap,rp,np),_d=kj(null,_d,ap,!0,lp,np)):(_d.tag=0,I$1&&lp&&vg(_d),Yi$1(null,_d,sp,np),_d=_d.child),_d;case 16:ap=_d.elementType;e:{switch(jj(rp,_d),rp=_d.pendingProps,sp=ap._init,ap=sp(ap._payload),_d.type=ap,sp=_d.tag=$k(ap),rp=Lg(ap,rp),sp){case 0:_d=dj(null,_d,ap,rp,np);break e;case 1:_d=ij(null,_d,ap,rp,np);break e;case 11:_d=Zi$1(null,_d,ap,rp,np);break e;case 14:_d=aj(null,_d,ap,Lg(ap.type,rp),np);break e}throw Error(p$1(306,ap,""))}return _d;case 0:return ap=_d.type,sp=_d.pendingProps,sp=_d.elementType===ap?sp:Lg(ap,sp),dj(rp,_d,ap,sp,np);case 1:return ap=_d.type,sp=_d.pendingProps,sp=_d.elementType===ap?sp:Lg(ap,sp),ij(rp,_d,ap,sp,np);case 3:e:{if(lj(_d),rp===null)throw Error(p$1(387));ap=_d.pendingProps,lp=_d.memoizedState,sp=lp.element,bh$1(rp,_d),gh$1(_d,ap,null,np);var up=_d.memoizedState;if(ap=up.element,lp.isDehydrated)if(lp={element:ap,isDehydrated:!1,cache:up.cache,pendingSuspenseBoundaries:up.pendingSuspenseBoundaries,transitions:up.transitions},_d.updateQueue.baseState=lp,_d.memoizedState=lp,_d.flags&256){sp=Ki$1(Error(p$1(423)),_d),_d=mj(rp,_d,ap,np,sp);break e}else if(ap!==sp){sp=Ki$1(Error(p$1(424)),_d),_d=mj(rp,_d,ap,np,sp);break e}else for(yg=Lf$1(_d.stateNode.containerInfo.firstChild),xg=_d,I$1=!0,zg=null,np=Ch$1(_d,null,ap,np),_d.child=np;np;)np.flags=np.flags&-3|4096,np=np.sibling;else{if(Ig(),ap===sp){_d=$i$1(rp,_d,np);break e}Yi$1(rp,_d,ap,np)}_d=_d.child}return _d;case 5:return Kh$1(_d),rp===null&&Eg(_d),ap=_d.type,sp=_d.pendingProps,lp=rp!==null?rp.memoizedProps:null,up=sp.children,Ef$1(ap,sp)?up=null:lp!==null&&Ef$1(ap,lp)&&(_d.flags|=32),hj(rp,_d),Yi$1(rp,_d,up,np),_d.child;case 6:return rp===null&&Eg(_d),null;case 13:return pj(rp,_d,np);case 4:return Ih$1(_d,_d.stateNode.containerInfo),ap=_d.pendingProps,rp===null?_d.child=Bh$1(_d,null,ap,np):Yi$1(rp,_d,ap,np),_d.child;case 11:return ap=_d.type,sp=_d.pendingProps,sp=_d.elementType===ap?sp:Lg(ap,sp),Zi$1(rp,_d,ap,sp,np);case 7:return Yi$1(rp,_d,_d.pendingProps,np),_d.child;case 8:return Yi$1(rp,_d,_d.pendingProps.children,np),_d.child;case 12:return Yi$1(rp,_d,_d.pendingProps.children,np),_d.child;case 10:e:{if(ap=_d.type._context,sp=_d.pendingProps,lp=_d.memoizedProps,up=sp.value,G$1(Mg,ap._currentValue),ap._currentValue=up,lp!==null)if(He$1(lp.value,up)){if(lp.children===sp.children&&!Wf$1.current){_d=$i$1(rp,_d,np);break e}}else for(lp=_d.child,lp!==null&&(lp.return=_d);lp!==null;){var cp=lp.dependencies;if(cp!==null){up=lp.child;for(var dp=cp.firstContext;dp!==null;){if(dp.context===ap){if(lp.tag===1){dp=ch$1(-1,np&-np),dp.tag=2;var hp=lp.updateQueue;if(hp!==null){hp=hp.shared;var fp=hp.pending;fp===null?dp.next=dp:(dp.next=fp.next,fp.next=dp),hp.pending=dp}}lp.lanes|=np,dp=lp.alternate,dp!==null&&(dp.lanes|=np),Sg(lp.return,np,_d),cp.lanes|=np;break}dp=dp.next}}else if(lp.tag===10)up=lp.type===_d.type?null:lp.child;else if(lp.tag===18){if(up=lp.return,up===null)throw Error(p$1(341));up.lanes|=np,cp=up.alternate,cp!==null&&(cp.lanes|=np),Sg(up,np,_d),up=lp.sibling}else up=lp.child;if(up!==null)up.return=lp;else for(up=lp;up!==null;){if(up===_d){up=null;break}if(lp=up.sibling,lp!==null){lp.return=up.return,up=lp;break}up=up.return}lp=up}Yi$1(rp,_d,sp.children,np),_d=_d.child}return _d;case 9:return sp=_d.type,ap=_d.pendingProps.children,Tg(_d,np),sp=Vg(sp),ap=ap(sp),_d.flags|=1,Yi$1(rp,_d,ap,np),_d.child;case 14:return ap=_d.type,sp=Lg(ap,_d.pendingProps),sp=Lg(ap.type,sp),aj(rp,_d,ap,sp,np);case 15:return cj(rp,_d,_d.type,_d.pendingProps,np);case 17:return ap=_d.type,sp=_d.pendingProps,sp=_d.elementType===ap?sp:Lg(ap,sp),jj(rp,_d),_d.tag=1,Zf$1(ap)?(rp=!0,cg(_d)):rp=!1,Tg(_d,np),ph$1(_d,ap,sp),rh$1(_d,ap,sp,np),kj(null,_d,ap,!0,rp,np);case 19:return yj(rp,_d,np);case 22:return ej(rp,_d,np)}throw Error(p$1(156,_d.tag))};function Gk(rp,_d){return ac$1(rp,_d)}function al$1(rp,_d,np,ap){this.tag=rp,this.key=np,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=ap,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(rp,_d,np,ap){return new al$1(rp,_d,np,ap)}function bj(rp){return rp=rp.prototype,!(!rp||!rp.isReactComponent)}function $k(rp){if(typeof rp=="function")return bj(rp)?1:0;if(rp!=null){if(rp=rp.$$typeof,rp===Da$1)return 11;if(rp===Ga$1)return 14}return 2}function wh$1(rp,_d){var np=rp.alternate;return np===null?(np=Bg(rp.tag,_d,rp.key,rp.mode),np.elementType=rp.elementType,np.type=rp.type,np.stateNode=rp.stateNode,np.alternate=rp,rp.alternate=np):(np.pendingProps=_d,np.type=rp.type,np.flags=0,np.subtreeFlags=0,np.deletions=null),np.flags=rp.flags&14680064,np.childLanes=rp.childLanes,np.lanes=rp.lanes,np.child=rp.child,np.memoizedProps=rp.memoizedProps,np.memoizedState=rp.memoizedState,np.updateQueue=rp.updateQueue,_d=rp.dependencies,np.dependencies=_d===null?null:{lanes:_d.lanes,firstContext:_d.firstContext},np.sibling=rp.sibling,np.index=rp.index,np.ref=rp.ref,np}function yh$1(rp,_d,np,ap,sp,lp){var up=2;if(ap=rp,typeof rp=="function")bj(rp)&&(up=1);else if(typeof rp=="string")up=5;else e:switch(rp){case ya$1:return Ah$1(np.children,sp,lp,_d);case za$1:up=8,sp|=8;break;case Aa$1:return rp=Bg(12,np,_d,sp|2),rp.elementType=Aa$1,rp.lanes=lp,rp;case Ea$1:return rp=Bg(13,np,_d,sp),rp.elementType=Ea$1,rp.lanes=lp,rp;case Fa$1:return rp=Bg(19,np,_d,sp),rp.elementType=Fa$1,rp.lanes=lp,rp;case Ia$1:return qj(np,sp,lp,_d);default:if(typeof rp=="object"&&rp!==null)switch(rp.$$typeof){case Ba$1:up=10;break e;case Ca$1:up=9;break e;case Da$1:up=11;break e;case Ga$1:up=14;break e;case Ha$1:up=16,ap=null;break e}throw Error(p$1(130,rp==null?rp:typeof rp,""))}return _d=Bg(up,np,_d,sp),_d.elementType=rp,_d.type=ap,_d.lanes=lp,_d}function Ah$1(rp,_d,np,ap){return rp=Bg(7,rp,ap,_d),rp.lanes=np,rp}function qj(rp,_d,np,ap){return rp=Bg(22,rp,ap,_d),rp.elementType=Ia$1,rp.lanes=np,rp.stateNode={isHidden:!1},rp}function xh$1(rp,_d,np){return rp=Bg(6,rp,null,_d),rp.lanes=np,rp}function zh$1(rp,_d,np){return _d=Bg(4,rp.children!==null?rp.children:[],rp.key,_d),_d.lanes=np,_d.stateNode={containerInfo:rp.containerInfo,pendingChildren:null,implementation:rp.implementation},_d}function bl$1(rp,_d,np,ap,sp){this.tag=_d,this.containerInfo=rp,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc$1(0),this.expirationTimes=zc$1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc$1(0),this.identifierPrefix=ap,this.onRecoverableError=sp,this.mutableSourceEagerHydrationData=null}function cl$1(rp,_d,np,ap,sp,lp,up,cp,dp){return rp=new bl$1(rp,_d,np,cp,dp),_d===1?(_d=1,lp===!0&&(_d|=8)):_d=0,lp=Bg(3,null,null,_d),rp.current=lp,lp.stateNode=rp,lp.memoizedState={element:ap,isDehydrated:np,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah$1(lp),rp}function dl$1(rp,_d,np){var ap=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa$1,key:ap==null?null:""+ap,children:rp,containerInfo:_d,implementation:np}}function el$1(rp){if(!rp)return Vf$1;rp=rp._reactInternals;e:{if(Vb(rp)!==rp||rp.tag!==1)throw Error(p$1(170));var _d=rp;do{switch(_d.tag){case 3:_d=_d.stateNode.context;break e;case 1:if(Zf$1(_d.type)){_d=_d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_d=_d.return}while(_d!==null);throw Error(p$1(171))}if(rp.tag===1){var np=rp.type;if(Zf$1(np))return bg(rp,np,_d)}return _d}function fl$1(rp,_d,np,ap,sp,lp,up,cp,dp){return rp=cl$1(np,ap,!0,rp,sp,lp,up,cp,dp),rp.context=el$1(null),np=rp.current,ap=L$1(),sp=lh$1(np),lp=ch$1(ap,sp),lp.callback=_d??null,dh$1(np,lp,sp),rp.current.lanes=sp,Ac$1(rp,sp,ap),Ek(rp,ap),rp}function gl$1(rp,_d,np,ap){var sp=_d.current,lp=L$1(),up=lh$1(sp);return np=el$1(np),_d.context===null?_d.context=np:_d.pendingContext=np,_d=ch$1(lp,up),_d.payload={element:rp},ap=ap===void 0?null:ap,ap!==null&&(_d.callback=ap),rp=dh$1(sp,_d,up),rp!==null&&(mh$1(rp,sp,up,lp),eh$1(rp,sp,up)),up}function hl$1(rp){if(rp=rp.current,!rp.child)return null;switch(rp.child.tag){case 5:return rp.child.stateNode;default:return rp.child.stateNode}}function il$1(rp,_d){if(rp=rp.memoizedState,rp!==null&&rp.dehydrated!==null){var np=rp.retryLane;rp.retryLane=np!==0&&np<_d?np:_d}}function jl$1(rp,_d){il$1(rp,_d),(rp=rp.alternate)&&il$1(rp,_d)}function kl$1(){return null}var ll$1=typeof reportError=="function"?reportError:function(rp){console.error(rp)};function ml$1(rp){this._internalRoot=rp}nl$1.prototype.render=ml$1.prototype.render=function(rp){var _d=this._internalRoot;if(_d===null)throw Error(p$1(409));gl$1(rp,_d,null,null)};nl$1.prototype.unmount=ml$1.prototype.unmount=function(){var rp=this._internalRoot;if(rp!==null){this._internalRoot=null;var _d=rp.containerInfo;Sk(function(){gl$1(null,rp,null,null)}),_d[uf$1]=null}};function nl$1(rp){this._internalRoot=rp}nl$1.prototype.unstable_scheduleHydration=function(rp){if(rp){var _d=Hc$1();rp={blockedOn:null,target:rp,priority:_d};for(var np=0;np<Qc$1.length&&_d!==0&&_d<Qc$1[np].priority;np++);Qc$1.splice(np,0,rp),np===0&&Vc$1(rp)}};function ol$1(rp){return!(!rp||rp.nodeType!==1&&rp.nodeType!==9&&rp.nodeType!==11)}function pl$1(rp){return!(!rp||rp.nodeType!==1&&rp.nodeType!==9&&rp.nodeType!==11&&(rp.nodeType!==8||rp.nodeValue!==" react-mount-point-unstable "))}function ql$1(){}function rl$1(rp,_d,np,ap,sp){if(sp){if(typeof ap=="function"){var lp=ap;ap=function(){var hp=hl$1(up);lp.call(hp)}}var up=fl$1(_d,ap,rp,0,null,!1,!1,"",ql$1);return rp._reactRootContainer=up,rp[uf$1]=up.current,sf$1(rp.nodeType===8?rp.parentNode:rp),Sk(),up}for(;sp=rp.lastChild;)rp.removeChild(sp);if(typeof ap=="function"){var cp=ap;ap=function(){var hp=hl$1(dp);cp.call(hp)}}var dp=cl$1(rp,0,!1,null,null,!1,!1,"",ql$1);return rp._reactRootContainer=dp,rp[uf$1]=dp.current,sf$1(rp.nodeType===8?rp.parentNode:rp),Sk(function(){gl$1(_d,dp,np,ap)}),dp}function sl$1(rp,_d,np,ap,sp){var lp=np._reactRootContainer;if(lp){var up=lp;if(typeof sp=="function"){var cp=sp;sp=function(){var dp=hl$1(up);cp.call(dp)}}gl$1(_d,up,rp,sp)}else up=rl$1(np,_d,rp,sp,ap);return hl$1(up)}Ec$1=function(rp){switch(rp.tag){case 3:var _d=rp.stateNode;if(_d.current.memoizedState.isDehydrated){var np=tc$1(_d.pendingLanes);np!==0&&(Cc$1(_d,np|1),Ek(_d,B$1()),!(K$1&6)&&(Hj=B$1()+500,jg()))}break;case 13:Sk(function(){var ap=Zg(rp,1);if(ap!==null){var sp=L$1();mh$1(ap,rp,1,sp)}}),jl$1(rp,1)}};Fc$1=function(rp){if(rp.tag===13){var _d=Zg(rp,134217728);if(_d!==null){var np=L$1();mh$1(_d,rp,134217728,np)}jl$1(rp,134217728)}};Gc$1=function(rp){if(rp.tag===13){var _d=lh$1(rp),np=Zg(rp,_d);if(np!==null){var ap=L$1();mh$1(np,rp,_d,ap)}jl$1(rp,_d)}};Hc$1=function(){return C$1};Ic$1=function(rp,_d){var np=C$1;try{return C$1=rp,_d()}finally{C$1=np}};yb=function(rp,_d,np){switch(_d){case"input":if(bb(rp,np),_d=np.name,np.type==="radio"&&_d!=null){for(np=rp;np.parentNode;)np=np.parentNode;for(np=np.querySelectorAll("input[name="+JSON.stringify(""+_d)+'][type="radio"]'),_d=0;_d<np.length;_d++){var ap=np[_d];if(ap!==rp&&ap.form===rp.form){var sp=Db(ap);if(!sp)throw Error(p$1(90));Wa$1(ap),bb(ap,sp)}}}break;case"textarea":ib(rp,np);break;case"select":_d=np.value,_d!=null&&fb(rp,!!np.multiple,_d,!1)}};Gb=Rk;Hb=Sk;var tl$1={usingClientEntryPoint:!1,Events:[Cb,ue$1,Db,Eb,Fb,Rk]},ul$1={findFiberByHostInstance:Wc$1,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl$1={bundleType:ul$1.bundleType,version:ul$1.version,rendererPackageName:ul$1.rendererPackageName,rendererConfig:ul$1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$1.ReactCurrentDispatcher,findHostInstanceByFiber:function(rp){return rp=Zb(rp),rp===null?null:rp.stateNode},findFiberByHostInstance:ul$1.findFiberByHostInstance||kl$1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl$1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl$1.isDisabled&&wl$1.supportsFiber)try{kc$1=wl$1.inject(vl$1),lc$1=wl$1}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl$1;reactDom_production_min.createPortal=function(rp,_d){var np=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol$1(_d))throw Error(p$1(200));return dl$1(rp,_d,null,np)};reactDom_production_min.createRoot=function(rp,_d){if(!ol$1(rp))throw Error(p$1(299));var np=!1,ap="",sp=ll$1;return _d!=null&&(_d.unstable_strictMode===!0&&(np=!0),_d.identifierPrefix!==void 0&&(ap=_d.identifierPrefix),_d.onRecoverableError!==void 0&&(sp=_d.onRecoverableError)),_d=cl$1(rp,1,!1,null,null,np,!1,ap,sp),rp[uf$1]=_d.current,sf$1(rp.nodeType===8?rp.parentNode:rp),new ml$1(_d)};reactDom_production_min.findDOMNode=function(rp){if(rp==null)return null;if(rp.nodeType===1)return rp;var _d=rp._reactInternals;if(_d===void 0)throw typeof rp.render=="function"?Error(p$1(188)):(rp=Object.keys(rp).join(","),Error(p$1(268,rp)));return rp=Zb(_d),rp=rp===null?null:rp.stateNode,rp};reactDom_production_min.flushSync=function(rp){return Sk(rp)};reactDom_production_min.hydrate=function(rp,_d,np){if(!pl$1(_d))throw Error(p$1(200));return sl$1(null,rp,_d,!0,np)};reactDom_production_min.hydrateRoot=function(rp,_d,np){if(!ol$1(rp))throw Error(p$1(405));var ap=np!=null&&np.hydratedSources||null,sp=!1,lp="",up=ll$1;if(np!=null&&(np.unstable_strictMode===!0&&(sp=!0),np.identifierPrefix!==void 0&&(lp=np.identifierPrefix),np.onRecoverableError!==void 0&&(up=np.onRecoverableError)),_d=fl$1(_d,null,rp,1,np??null,sp,!1,lp,up),rp[uf$1]=_d.current,sf$1(rp),ap)for(rp=0;rp<ap.length;rp++)np=ap[rp],sp=np._getVersion,sp=sp(np._source),_d.mutableSourceEagerHydrationData==null?_d.mutableSourceEagerHydrationData=[np,sp]:_d.mutableSourceEagerHydrationData.push(np,sp);return new nl$1(_d)};reactDom_production_min.render=function(rp,_d,np){if(!pl$1(_d))throw Error(p$1(200));return sl$1(null,rp,_d,!1,np)};reactDom_production_min.unmountComponentAtNode=function(rp){if(!pl$1(rp))throw Error(p$1(40));return rp._reactRootContainer?(Sk(function(){sl$1(null,null,rp,!1,function(){rp._reactRootContainer=null,rp[uf$1]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(rp,_d,np,ap){if(!pl$1(np))throw Error(p$1(200));if(rp==null||rp._reactInternals===void 0)throw Error(p$1(38));return sl$1(rp,_d,np,!1,ap)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(rp){console.error(rp)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs(reactDomExports);/**
 * @remix-run/router v1.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$6(){return _extends$6=Object.assign?Object.assign.bind():function(rp){for(var _d=1;_d<arguments.length;_d++){var np=arguments[_d];for(var ap in np)Object.prototype.hasOwnProperty.call(np,ap)&&(rp[ap]=np[ap])}return rp},_extends$6.apply(this,arguments)}var Action;(function(rp){rp.Pop="POP",rp.Push="PUSH",rp.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(rp){rp===void 0&&(rp={});function _d(ap,sp){let{pathname:lp,search:up,hash:cp}=ap.location;return createLocation("",{pathname:lp,search:up,hash:cp},sp.state&&sp.state.usr||null,sp.state&&sp.state.key||"default")}function np(ap,sp){return typeof sp=="string"?sp:createPath(sp)}return getUrlBasedHistory(_d,np,null,rp)}function invariant$1(rp,_d){if(rp===!1||rp===null||typeof rp>"u")throw new Error(_d)}function warning(rp,_d){if(!rp){typeof console<"u"&&console.warn(_d);try{throw new Error(_d)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(rp,_d){return{usr:rp.state,key:rp.key,idx:_d}}function createLocation(rp,_d,np,ap){return np===void 0&&(np=null),_extends$6({pathname:typeof rp=="string"?rp:rp.pathname,search:"",hash:""},typeof _d=="string"?parsePath(_d):_d,{state:np,key:_d&&_d.key||ap||createKey()})}function createPath(rp){let{pathname:_d="/",search:np="",hash:ap=""}=rp;return np&&np!=="?"&&(_d+=np.charAt(0)==="?"?np:"?"+np),ap&&ap!=="#"&&(_d+=ap.charAt(0)==="#"?ap:"#"+ap),_d}function parsePath(rp){let _d={};if(rp){let np=rp.indexOf("#");np>=0&&(_d.hash=rp.substr(np),rp=rp.substr(0,np));let ap=rp.indexOf("?");ap>=0&&(_d.search=rp.substr(ap),rp=rp.substr(0,ap)),rp&&(_d.pathname=rp)}return _d}function getUrlBasedHistory(rp,_d,np,ap){ap===void 0&&(ap={});let{window:sp=document.defaultView,v5Compat:lp=!1}=ap,up=sp.history,cp=Action.Pop,dp=null,hp=fp();hp==null&&(hp=0,up.replaceState(_extends$6({},up.state,{idx:hp}),""));function fp(){return(up.state||{idx:null}).idx}function pp(){cp=Action.Pop;let _p=fp(),vp=_p==null?null:_p-hp;hp=_p,dp&&dp({action:cp,location:xp.location,delta:vp})}function mp(_p,vp){cp=Action.Push;let bp=createLocation(xp.location,_p,vp);np&&np(bp,_p),hp=fp()+1;let Ep=getHistoryState(bp,hp),Sp=xp.createHref(bp);try{up.pushState(Ep,"",Sp)}catch(Ap){if(Ap instanceof DOMException&&Ap.name==="DataCloneError")throw Ap;sp.location.assign(Sp)}lp&&dp&&dp({action:cp,location:xp.location,delta:1})}function gp(_p,vp){cp=Action.Replace;let bp=createLocation(xp.location,_p,vp);np&&np(bp,_p),hp=fp();let Ep=getHistoryState(bp,hp),Sp=xp.createHref(bp);up.replaceState(Ep,"",Sp),lp&&dp&&dp({action:cp,location:xp.location,delta:0})}function yp(_p){let vp=sp.location.origin!=="null"?sp.location.origin:sp.location.href,bp=typeof _p=="string"?_p:createPath(_p);return invariant$1(vp,"No window.location.(origin|href) available to create URL for href: "+bp),new URL(bp,vp)}let xp={get action(){return cp},get location(){return rp(sp,up)},listen(_p){if(dp)throw new Error("A history only accepts one active listener");return sp.addEventListener(PopStateEventType,pp),dp=_p,()=>{sp.removeEventListener(PopStateEventType,pp),dp=null}},createHref(_p){return _d(sp,_p)},createURL:yp,encodeLocation(_p){let vp=yp(_p);return{pathname:vp.pathname,search:vp.search,hash:vp.hash}},push:mp,replace:gp,go(_p){return up.go(_p)}};return xp}var ResultType;(function(rp){rp.data="data",rp.deferred="deferred",rp.redirect="redirect",rp.error="error"})(ResultType||(ResultType={}));function matchRoutes(rp,_d,np){np===void 0&&(np="/");let ap=typeof _d=="string"?parsePath(_d):_d,sp=stripBasename(ap.pathname||"/",np);if(sp==null)return null;let lp=flattenRoutes(rp);rankRouteBranches(lp);let up=null;for(let cp=0;up==null&&cp<lp.length;++cp)up=matchRouteBranch(lp[cp],safelyDecodeURI(sp));return up}function flattenRoutes(rp,_d,np,ap){_d===void 0&&(_d=[]),np===void 0&&(np=[]),ap===void 0&&(ap="");let sp=(lp,up,cp)=>{let dp={relativePath:cp===void 0?lp.path||"":cp,caseSensitive:lp.caseSensitive===!0,childrenIndex:up,route:lp};dp.relativePath.startsWith("/")&&(invariant$1(dp.relativePath.startsWith(ap),'Absolute route path "'+dp.relativePath+'" nested under path '+('"'+ap+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),dp.relativePath=dp.relativePath.slice(ap.length));let hp=joinPaths([ap,dp.relativePath]),fp=np.concat(dp);lp.children&&lp.children.length>0&&(invariant$1(lp.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+hp+'".')),flattenRoutes(lp.children,_d,fp,hp)),!(lp.path==null&&!lp.index)&&_d.push({path:hp,score:computeScore(hp,lp.index),routesMeta:fp})};return rp.forEach((lp,up)=>{var cp;if(lp.path===""||!((cp=lp.path)!=null&&cp.includes("?")))sp(lp,up);else for(let dp of explodeOptionalSegments(lp.path))sp(lp,up,dp)}),_d}function explodeOptionalSegments(rp){let _d=rp.split("/");if(_d.length===0)return[];let[np,...ap]=_d,sp=np.endsWith("?"),lp=np.replace(/\?$/,"");if(ap.length===0)return sp?[lp,""]:[lp];let up=explodeOptionalSegments(ap.join("/")),cp=[];return cp.push(...up.map(dp=>dp===""?lp:[lp,dp].join("/"))),sp&&cp.push(...up),cp.map(dp=>rp.startsWith("/")&&dp===""?"/":dp)}function rankRouteBranches(rp){rp.sort((_d,np)=>_d.score!==np.score?np.score-_d.score:compareIndexes(_d.routesMeta.map(ap=>ap.childrenIndex),np.routesMeta.map(ap=>ap.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=rp=>rp==="*";function computeScore(rp,_d){let np=rp.split("/"),ap=np.length;return np.some(isSplat)&&(ap+=splatPenalty),_d&&(ap+=indexRouteValue),np.filter(sp=>!isSplat(sp)).reduce((sp,lp)=>sp+(paramRe.test(lp)?dynamicSegmentValue:lp===""?emptySegmentValue:staticSegmentValue),ap)}function compareIndexes(rp,_d){return rp.length===_d.length&&rp.slice(0,-1).every((ap,sp)=>ap===_d[sp])?rp[rp.length-1]-_d[_d.length-1]:0}function matchRouteBranch(rp,_d){let{routesMeta:np}=rp,ap={},sp="/",lp=[];for(let up=0;up<np.length;++up){let cp=np[up],dp=up===np.length-1,hp=sp==="/"?_d:_d.slice(sp.length)||"/",fp=matchPath({path:cp.relativePath,caseSensitive:cp.caseSensitive,end:dp},hp);if(!fp)return null;Object.assign(ap,fp.params);let pp=cp.route;lp.push({params:ap,pathname:joinPaths([sp,fp.pathname]),pathnameBase:normalizePathname(joinPaths([sp,fp.pathnameBase])),route:pp}),fp.pathnameBase!=="/"&&(sp=joinPaths([sp,fp.pathnameBase]))}return lp}function matchPath(rp,_d){typeof rp=="string"&&(rp={path:rp,caseSensitive:!1,end:!0});let[np,ap]=compilePath(rp.path,rp.caseSensitive,rp.end),sp=_d.match(np);if(!sp)return null;let lp=sp[0],up=lp.replace(/(.)\/+$/,"$1"),cp=sp.slice(1);return{params:ap.reduce((hp,fp,pp)=>{let{paramName:mp,isOptional:gp}=fp;if(mp==="*"){let xp=cp[pp]||"";up=lp.slice(0,lp.length-xp.length).replace(/(.)\/+$/,"$1")}const yp=cp[pp];return gp&&!yp?hp[mp]=void 0:hp[mp]=safelyDecodeURIComponent(yp||"",mp),hp},{}),pathname:lp,pathnameBase:up,pattern:rp}}function compilePath(rp,_d,np){_d===void 0&&(_d=!1),np===void 0&&(np=!0),warning(rp==="*"||!rp.endsWith("*")||rp.endsWith("/*"),'Route path "'+rp+'" will be treated as if it were '+('"'+rp.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+rp.replace(/\*$/,"/*")+'".'));let ap=[],sp="^"+rp.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(up,cp,dp)=>(ap.push({paramName:cp,isOptional:dp!=null}),dp?"/?([^\\/]+)?":"/([^\\/]+)"));return rp.endsWith("*")?(ap.push({paramName:"*"}),sp+=rp==="*"||rp==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):np?sp+="\\/*$":rp!==""&&rp!=="/"&&(sp+="(?:(?=\\/|$))"),[new RegExp(sp,_d?void 0:"i"),ap]}function safelyDecodeURI(rp){try{return decodeURI(rp)}catch(_d){return warning(!1,'The URL path "'+rp+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+_d+").")),rp}}function safelyDecodeURIComponent(rp,_d){try{return decodeURIComponent(rp)}catch(np){return warning(!1,'The value for the URL param "'+_d+'" will not be decoded because'+(' the string "'+rp+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+np+").")),rp}}function stripBasename(rp,_d){if(_d==="/")return rp;if(!rp.toLowerCase().startsWith(_d.toLowerCase()))return null;let np=_d.endsWith("/")?_d.length-1:_d.length,ap=rp.charAt(np);return ap&&ap!=="/"?null:rp.slice(np)||"/"}function resolvePath(rp,_d){_d===void 0&&(_d="/");let{pathname:np,search:ap="",hash:sp=""}=typeof rp=="string"?parsePath(rp):rp;return{pathname:np?np.startsWith("/")?np:resolvePathname(np,_d):_d,search:normalizeSearch(ap),hash:normalizeHash(sp)}}function resolvePathname(rp,_d){let np=_d.replace(/\/+$/,"").split("/");return rp.split("/").forEach(sp=>{sp===".."?np.length>1&&np.pop():sp!=="."&&np.push(sp)}),np.length>1?np.join("/"):"/"}function getInvalidPathError(rp,_d,np,ap){return"Cannot include a '"+rp+"' character in a manually specified "+("`to."+_d+"` field ["+JSON.stringify(ap)+"].  Please separate it out to the ")+("`to."+np+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(rp){return rp.filter((_d,np)=>np===0||_d.route.path&&_d.route.path.length>0)}function getResolveToMatches(rp,_d){let np=getPathContributingMatches(rp);return _d?np.map((ap,sp)=>sp===rp.length-1?ap.pathname:ap.pathnameBase):np.map(ap=>ap.pathnameBase)}function resolveTo(rp,_d,np,ap){ap===void 0&&(ap=!1);let sp;typeof rp=="string"?sp=parsePath(rp):(sp=_extends$6({},rp),invariant$1(!sp.pathname||!sp.pathname.includes("?"),getInvalidPathError("?","pathname","search",sp)),invariant$1(!sp.pathname||!sp.pathname.includes("#"),getInvalidPathError("#","pathname","hash",sp)),invariant$1(!sp.search||!sp.search.includes("#"),getInvalidPathError("#","search","hash",sp)));let lp=rp===""||sp.pathname==="",up=lp?"/":sp.pathname,cp;if(up==null)cp=np;else{let pp=_d.length-1;if(!ap&&up.startsWith("..")){let mp=up.split("/");for(;mp[0]==="..";)mp.shift(),pp-=1;sp.pathname=mp.join("/")}cp=pp>=0?_d[pp]:"/"}let dp=resolvePath(sp,cp),hp=up&&up!=="/"&&up.endsWith("/"),fp=(lp||up===".")&&np.endsWith("/");return!dp.pathname.endsWith("/")&&(hp||fp)&&(dp.pathname+="/"),dp}const joinPaths=rp=>rp.join("/").replace(/\/\/+/g,"/"),normalizePathname=rp=>rp.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=rp=>!rp||rp==="?"?"":rp.startsWith("?")?rp:"?"+rp,normalizeHash=rp=>!rp||rp==="#"?"":rp.startsWith("#")?rp:"#"+rp;function isRouteErrorResponse(rp){return rp!=null&&typeof rp.status=="number"&&typeof rp.statusText=="string"&&typeof rp.internal=="boolean"&&"data"in rp}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$5(){return _extends$5=Object.assign?Object.assign.bind():function(rp){for(var _d=1;_d<arguments.length;_d++){var np=arguments[_d];for(var ap in np)Object.prototype.hasOwnProperty.call(np,ap)&&(rp[ap]=np[ap])}return rp},_extends$5.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(rp,_d){let{relative:np}=_d===void 0?{}:_d;useInRouterContext()||invariant$1(!1);let{basename:ap,navigator:sp}=reactExports.useContext(NavigationContext),{hash:lp,pathname:up,search:cp}=useResolvedPath(rp,{relative:np}),dp=up;return ap!=="/"&&(dp=up==="/"?ap:joinPaths([ap,up])),sp.createHref({pathname:dp,search:cp,hash:lp})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant$1(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$4(rp){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(rp)}function useNavigate(){let{isDataRoute:rp}=reactExports.useContext(RouteContext);return rp?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant$1(!1);let rp=reactExports.useContext(DataRouterContext),{basename:_d,future:np,navigator:ap}=reactExports.useContext(NavigationContext),{matches:sp}=reactExports.useContext(RouteContext),{pathname:lp}=useLocation(),up=JSON.stringify(getResolveToMatches(sp,np.v7_relativeSplatPath)),cp=reactExports.useRef(!1);return useIsomorphicLayoutEffect$4(()=>{cp.current=!0}),reactExports.useCallback(function(hp,fp){if(fp===void 0&&(fp={}),!cp.current)return;if(typeof hp=="number"){ap.go(hp);return}let pp=resolveTo(hp,JSON.parse(up),lp,fp.relative==="path");rp==null&&_d!=="/"&&(pp.pathname=pp.pathname==="/"?_d:joinPaths([_d,pp.pathname])),(fp.replace?ap.replace:ap.push)(pp,fp.state,fp)},[_d,ap,up,lp,rp])}const OutletContext=reactExports.createContext(null);function useOutlet(rp){let _d=reactExports.useContext(RouteContext).outlet;return _d&&reactExports.createElement(OutletContext.Provider,{value:rp},_d)}function useParams(){let{matches:rp}=reactExports.useContext(RouteContext),_d=rp[rp.length-1];return _d?_d.params:{}}function useResolvedPath(rp,_d){let{relative:np}=_d===void 0?{}:_d,{future:ap}=reactExports.useContext(NavigationContext),{matches:sp}=reactExports.useContext(RouteContext),{pathname:lp}=useLocation(),up=JSON.stringify(getResolveToMatches(sp,ap.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(rp,JSON.parse(up),lp,np==="path"),[rp,up,lp,np])}function useRoutes(rp,_d){return useRoutesImpl(rp,_d)}function useRoutesImpl(rp,_d,np,ap){useInRouterContext()||invariant$1(!1);let{navigator:sp}=reactExports.useContext(NavigationContext),{matches:lp}=reactExports.useContext(RouteContext),up=lp[lp.length-1],cp=up?up.params:{};up&&up.pathname;let dp=up?up.pathnameBase:"/";up&&up.route;let hp=useLocation(),fp;if(_d){var pp;let _p=typeof _d=="string"?parsePath(_d):_d;dp==="/"||(pp=_p.pathname)!=null&&pp.startsWith(dp)||invariant$1(!1),fp=_p}else fp=hp;let mp=fp.pathname||"/",gp=dp==="/"?mp:mp.slice(dp.length)||"/",yp=matchRoutes(rp,{pathname:gp}),xp=_renderMatches(yp&&yp.map(_p=>Object.assign({},_p,{params:Object.assign({},cp,_p.params),pathname:joinPaths([dp,sp.encodeLocation?sp.encodeLocation(_p.pathname).pathname:_p.pathname]),pathnameBase:_p.pathnameBase==="/"?dp:joinPaths([dp,sp.encodeLocation?sp.encodeLocation(_p.pathnameBase).pathname:_p.pathnameBase])})),lp,np,ap);return _d&&xp?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$5({pathname:"/",search:"",hash:"",state:null,key:"default"},fp),navigationType:Action.Pop}},xp):xp}function DefaultErrorComponent(){let rp=useRouteError(),_d=isRouteErrorResponse(rp)?rp.status+" "+rp.statusText:rp instanceof Error?rp.message:JSON.stringify(rp),np=rp instanceof Error?rp.stack:null,sp={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},_d),np?reactExports.createElement("pre",{style:sp},np):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(_d){super(_d),this.state={location:_d.location,revalidation:_d.revalidation,error:_d.error}}static getDerivedStateFromError(_d){return{error:_d}}static getDerivedStateFromProps(_d,np){return np.location!==_d.location||np.revalidation!=="idle"&&_d.revalidation==="idle"?{error:_d.error,location:_d.location,revalidation:_d.revalidation}:{error:_d.error!==void 0?_d.error:np.error,location:np.location,revalidation:_d.revalidation||np.revalidation}}componentDidCatch(_d,np){console.error("React Router caught the following error during render",_d,np)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(rp){let{routeContext:_d,match:np,children:ap}=rp,sp=reactExports.useContext(DataRouterContext);return sp&&sp.static&&sp.staticContext&&(np.route.errorElement||np.route.ErrorBoundary)&&(sp.staticContext._deepestRenderedBoundaryId=np.route.id),reactExports.createElement(RouteContext.Provider,{value:_d},ap)}function _renderMatches(rp,_d,np,ap){var sp;if(_d===void 0&&(_d=[]),np===void 0&&(np=null),ap===void 0&&(ap=null),rp==null){var lp;if((lp=np)!=null&&lp.errors)rp=np.matches;else return null}let up=rp,cp=(sp=np)==null?void 0:sp.errors;if(cp!=null){let fp=up.findIndex(pp=>pp.route.id&&(cp==null?void 0:cp[pp.route.id]));fp>=0||invariant$1(!1),up=up.slice(0,Math.min(up.length,fp+1))}let dp=!1,hp=-1;if(np&&ap&&ap.v7_partialHydration)for(let fp=0;fp<up.length;fp++){let pp=up[fp];if((pp.route.HydrateFallback||pp.route.hydrateFallbackElement)&&(hp=fp),pp.route.id){let{loaderData:mp,errors:gp}=np,yp=pp.route.loader&&mp[pp.route.id]===void 0&&(!gp||gp[pp.route.id]===void 0);if(pp.route.lazy||yp){dp=!0,hp>=0?up=up.slice(0,hp+1):up=[up[0]];break}}}return up.reduceRight((fp,pp,mp)=>{let gp,yp=!1,xp=null,_p=null;np&&(gp=cp&&pp.route.id?cp[pp.route.id]:void 0,xp=pp.route.errorElement||defaultErrorElement,dp&&(hp<0&&mp===0?(warningOnce("route-fallback",!1),yp=!0,_p=null):hp===mp&&(yp=!0,_p=pp.route.hydrateFallbackElement||null)));let vp=_d.concat(up.slice(0,mp+1)),bp=()=>{let Ep;return gp?Ep=xp:yp?Ep=_p:pp.route.Component?Ep=reactExports.createElement(pp.route.Component,null):pp.route.element?Ep=pp.route.element:Ep=fp,reactExports.createElement(RenderedRoute,{match:pp,routeContext:{outlet:fp,matches:vp,isDataRoute:np!=null},children:Ep})};return np&&(pp.route.ErrorBoundary||pp.route.errorElement||mp===0)?reactExports.createElement(RenderErrorBoundary,{location:np.location,revalidation:np.revalidation,component:xp,error:gp,children:bp(),routeContext:{outlet:null,matches:vp,isDataRoute:!0}}):bp()},null)}var DataRouterHook$1=function(rp){return rp.UseBlocker="useBlocker",rp.UseRevalidator="useRevalidator",rp.UseNavigateStable="useNavigate",rp}(DataRouterHook$1||{}),DataRouterStateHook$1=function(rp){return rp.UseBlocker="useBlocker",rp.UseLoaderData="useLoaderData",rp.UseActionData="useActionData",rp.UseRouteError="useRouteError",rp.UseNavigation="useNavigation",rp.UseRouteLoaderData="useRouteLoaderData",rp.UseMatches="useMatches",rp.UseRevalidator="useRevalidator",rp.UseNavigateStable="useNavigate",rp.UseRouteId="useRouteId",rp}(DataRouterStateHook$1||{});function useDataRouterContext$1(rp){let _d=reactExports.useContext(DataRouterContext);return _d||invariant$1(!1),_d}function useDataRouterState(rp){let _d=reactExports.useContext(DataRouterStateContext);return _d||invariant$1(!1),_d}function useRouteContext(rp){let _d=reactExports.useContext(RouteContext);return _d||invariant$1(!1),_d}function useCurrentRouteId(rp){let _d=useRouteContext(),np=_d.matches[_d.matches.length-1];return np.route.id||invariant$1(!1),np.route.id}function useRouteError(){var rp;let _d=reactExports.useContext(RouteErrorContext),np=useDataRouterState(DataRouterStateHook$1.UseRouteError),ap=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return _d!==void 0?_d:(rp=np.errors)==null?void 0:rp[ap]}function useNavigateStable(){let{router:rp}=useDataRouterContext$1(DataRouterHook$1.UseNavigateStable),_d=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),np=reactExports.useRef(!1);return useIsomorphicLayoutEffect$4(()=>{np.current=!0}),reactExports.useCallback(function(sp,lp){lp===void 0&&(lp={}),np.current&&(typeof sp=="number"?rp.navigate(sp):rp.navigate(sp,_extends$5({fromRouteId:_d},lp)))},[rp,_d])}const alreadyWarned={};function warningOnce(rp,_d,np){!_d&&!alreadyWarned[rp]&&(alreadyWarned[rp]=!0)}function Outlet(rp){return useOutlet(rp.context)}function Route(rp){invariant$1(!1)}function Router(rp){let{basename:_d="/",children:np=null,location:ap,navigationType:sp=Action.Pop,navigator:lp,static:up=!1,future:cp}=rp;useInRouterContext()&&invariant$1(!1);let dp=_d.replace(/^\/*/,"/"),hp=reactExports.useMemo(()=>({basename:dp,navigator:lp,static:up,future:_extends$5({v7_relativeSplatPath:!1},cp)}),[dp,cp,lp,up]);typeof ap=="string"&&(ap=parsePath(ap));let{pathname:fp="/",search:pp="",hash:mp="",state:gp=null,key:yp="default"}=ap,xp=reactExports.useMemo(()=>{let _p=stripBasename(fp,dp);return _p==null?null:{location:{pathname:_p,search:pp,hash:mp,state:gp,key:yp},navigationType:sp}},[dp,fp,pp,mp,gp,yp,sp]);return xp==null?null:reactExports.createElement(NavigationContext.Provider,{value:hp},reactExports.createElement(LocationContext.Provider,{children:np,value:xp}))}function Routes(rp){let{children:_d,location:np}=rp;return useRoutes(createRoutesFromChildren(_d),np)}new Promise(()=>{});function createRoutesFromChildren(rp,_d){_d===void 0&&(_d=[]);let np=[];return reactExports.Children.forEach(rp,(ap,sp)=>{if(!reactExports.isValidElement(ap))return;let lp=[..._d,sp];if(ap.type===reactExports.Fragment){np.push.apply(np,createRoutesFromChildren(ap.props.children,lp));return}ap.type!==Route&&invariant$1(!1),!ap.props.index||!ap.props.children||invariant$1(!1);let up={id:ap.props.id||lp.join("-"),caseSensitive:ap.props.caseSensitive,element:ap.props.element,Component:ap.props.Component,index:ap.props.index,path:ap.props.path,loader:ap.props.loader,action:ap.props.action,errorElement:ap.props.errorElement,ErrorBoundary:ap.props.ErrorBoundary,hasErrorBoundary:ap.props.ErrorBoundary!=null||ap.props.errorElement!=null,shouldRevalidate:ap.props.shouldRevalidate,handle:ap.props.handle,lazy:ap.props.lazy};ap.props.children&&(up.children=createRoutesFromChildren(ap.props.children,lp)),np.push(up)}),np}/**
 * React Router DOM v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(rp){for(var _d=1;_d<arguments.length;_d++){var np=arguments[_d];for(var ap in np)Object.prototype.hasOwnProperty.call(np,ap)&&(rp[ap]=np[ap])}return rp},_extends$4.apply(this,arguments)}function _objectWithoutPropertiesLoose$2(rp,_d){if(rp==null)return{};var np={},ap=Object.keys(rp),sp,lp;for(lp=0;lp<ap.length;lp++)sp=ap[lp],!(_d.indexOf(sp)>=0)&&(np[sp]=rp[sp]);return np}function isModifiedEvent(rp){return!!(rp.metaKey||rp.altKey||rp.ctrlKey||rp.shiftKey)}function shouldProcessLinkClick(rp,_d){return rp.button===0&&(!_d||_d==="_self")&&!isModifiedEvent(rp)}const _excluded$a=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],_excluded2=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],ViewTransitionContext=reactExports.createContext({isTransitioning:!1}),START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(rp){let{basename:_d,children:np,future:ap,window:sp}=rp,lp=reactExports.useRef();lp.current==null&&(lp.current=createBrowserHistory({window:sp,v5Compat:!0}));let up=lp.current,[cp,dp]=reactExports.useState({action:up.action,location:up.location}),{v7_startTransition:hp}=ap||{},fp=reactExports.useCallback(pp=>{hp&&startTransitionImpl?startTransitionImpl(()=>dp(pp)):dp(pp)},[dp,hp]);return reactExports.useLayoutEffect(()=>up.listen(fp),[up,fp]),reactExports.createElement(Router,{basename:_d,children:np,location:cp.location,navigationType:cp.action,navigator:up,future:ap})}const isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(_d,np){let{onClick:ap,relative:sp,reloadDocument:lp,replace:up,state:cp,target:dp,to:hp,preventScrollReset:fp,unstable_viewTransition:pp}=_d,mp=_objectWithoutPropertiesLoose$2(_d,_excluded$a),{basename:gp}=reactExports.useContext(NavigationContext),yp,xp=!1;if(typeof hp=="string"&&ABSOLUTE_URL_REGEX.test(hp)&&(yp=hp,isBrowser$1))try{let Ep=new URL(window.location.href),Sp=hp.startsWith("//")?new URL(Ep.protocol+hp):new URL(hp),Ap=stripBasename(Sp.pathname,gp);Sp.origin===Ep.origin&&Ap!=null?hp=Ap+Sp.search+Sp.hash:xp=!0}catch{}let _p=useHref(hp,{relative:sp}),vp=useLinkClickHandler(hp,{replace:up,state:cp,target:dp,preventScrollReset:fp,relative:sp,unstable_viewTransition:pp});function bp(Ep){ap&&ap(Ep),Ep.defaultPrevented||vp(Ep)}return reactExports.createElement("a",_extends$4({},mp,{href:yp||_p,onClick:xp||lp?ap:bp,ref:np,target:dp}))}),NavLink=reactExports.forwardRef(function(_d,np){let{"aria-current":ap="page",caseSensitive:sp=!1,className:lp="",end:up=!1,style:cp,to:dp,unstable_viewTransition:hp,children:fp}=_d,pp=_objectWithoutPropertiesLoose$2(_d,_excluded2),mp=useResolvedPath(dp,{relative:pp.relative}),gp=useLocation(),yp=reactExports.useContext(DataRouterStateContext),{navigator:xp,basename:_p}=reactExports.useContext(NavigationContext),vp=yp!=null&&useViewTransitionState(mp)&&hp===!0,bp=xp.encodeLocation?xp.encodeLocation(mp).pathname:mp.pathname,Ep=gp.pathname,Sp=yp&&yp.navigation&&yp.navigation.location?yp.navigation.location.pathname:null;sp||(Ep=Ep.toLowerCase(),Sp=Sp?Sp.toLowerCase():null,bp=bp.toLowerCase()),Sp&&_p&&(Sp=stripBasename(Sp,_p)||Sp);const Ap=bp!=="/"&&bp.endsWith("/")?bp.length-1:bp.length;let Rp=Ep===bp||!up&&Ep.startsWith(bp)&&Ep.charAt(Ap)==="/",Tp=Sp!=null&&(Sp===bp||!up&&Sp.startsWith(bp)&&Sp.charAt(bp.length)==="/"),Mp={isActive:Rp,isPending:Tp,isTransitioning:vp},Op=Rp?ap:void 0,Pp;typeof lp=="function"?Pp=lp(Mp):Pp=[lp,Rp?"active":null,Tp?"pending":null,vp?"transitioning":null].filter(Boolean).join(" ");let $p=typeof cp=="function"?cp(Mp):cp;return reactExports.createElement(Link,_extends$4({},pp,{"aria-current":Op,className:Pp,ref:np,style:$p,to:dp,unstable_viewTransition:hp}),typeof fp=="function"?fp(Mp):fp)});var DataRouterHook;(function(rp){rp.UseScrollRestoration="useScrollRestoration",rp.UseSubmit="useSubmit",rp.UseSubmitFetcher="useSubmitFetcher",rp.UseFetcher="useFetcher",rp.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(rp){rp.UseFetcher="useFetcher",rp.UseFetchers="useFetchers",rp.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useDataRouterContext(rp){let _d=reactExports.useContext(DataRouterContext);return _d||invariant$1(!1),_d}function useLinkClickHandler(rp,_d){let{target:np,replace:ap,state:sp,preventScrollReset:lp,relative:up,unstable_viewTransition:cp}=_d===void 0?{}:_d,dp=useNavigate(),hp=useLocation(),fp=useResolvedPath(rp,{relative:up});return reactExports.useCallback(pp=>{if(shouldProcessLinkClick(pp,np)){pp.preventDefault();let mp=ap!==void 0?ap:createPath(hp)===createPath(fp);dp(rp,{replace:mp,state:sp,preventScrollReset:lp,relative:up,unstable_viewTransition:cp})}},[hp,dp,fp,ap,sp,np,rp,lp,up,cp])}function useViewTransitionState(rp,_d){_d===void 0&&(_d={});let np=reactExports.useContext(ViewTransitionContext);np==null&&invariant$1(!1);let{basename:ap}=useDataRouterContext(DataRouterHook.useViewTransitionState),sp=useResolvedPath(rp,{relative:_d.relative});if(!np.isTransitioning)return!1;let lp=stripBasename(np.currentLocation.pathname,ap)||np.currentLocation.pathname,up=stripBasename(np.nextLocation.pathname,ap)||np.nextLocation.pathname;return matchPath(sp.pathname,up)!=null||matchPath(sp.pathname,lp)!=null}var client={},m$2=reactDomExports;client.createRoot=m$2.createRoot,client.hydrateRoot=m$2.hydrateRoot;var DefaultContext={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},IconContext=React.createContext&&React.createContext(DefaultContext),_excluded$9=["attr","size","title"];function _objectWithoutProperties(rp,_d){if(rp==null)return{};var np=_objectWithoutPropertiesLoose$1(rp,_d),ap,sp;if(Object.getOwnPropertySymbols){var lp=Object.getOwnPropertySymbols(rp);for(sp=0;sp<lp.length;sp++)ap=lp[sp],!(_d.indexOf(ap)>=0)&&Object.prototype.propertyIsEnumerable.call(rp,ap)&&(np[ap]=rp[ap])}return np}function _objectWithoutPropertiesLoose$1(rp,_d){if(rp==null)return{};var np={},ap=Object.keys(rp),sp,lp;for(lp=0;lp<ap.length;lp++)sp=ap[lp],!(_d.indexOf(sp)>=0)&&(np[sp]=rp[sp]);return np}function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(rp){for(var _d=1;_d<arguments.length;_d++){var np=arguments[_d];for(var ap in np)Object.prototype.hasOwnProperty.call(np,ap)&&(rp[ap]=np[ap])}return rp},_extends$3.apply(this,arguments)}function ownKeys$1(rp,_d){var np=Object.keys(rp);if(Object.getOwnPropertySymbols){var ap=Object.getOwnPropertySymbols(rp);_d&&(ap=ap.filter(function(sp){return Object.getOwnPropertyDescriptor(rp,sp).enumerable})),np.push.apply(np,ap)}return np}function _objectSpread(rp){for(var _d=1;_d<arguments.length;_d++){var np=arguments[_d]!=null?arguments[_d]:{};_d%2?ownKeys$1(Object(np),!0).forEach(function(ap){_defineProperty$3(rp,ap,np[ap])}):Object.getOwnPropertyDescriptors?Object.defineProperties(rp,Object.getOwnPropertyDescriptors(np)):ownKeys$1(Object(np)).forEach(function(ap){Object.defineProperty(rp,ap,Object.getOwnPropertyDescriptor(np,ap))})}return rp}function _defineProperty$3(rp,_d,np){return _d=_toPropertyKey$1(_d),_d in rp?Object.defineProperty(rp,_d,{value:np,enumerable:!0,configurable:!0,writable:!0}):rp[_d]=np,rp}function _toPropertyKey$1(rp){var _d=_toPrimitive$2(rp,"string");return typeof _d=="symbol"?_d:String(_d)}function _toPrimitive$2(rp,_d){if(typeof rp!="object"||rp===null)return rp;var np=rp[Symbol.toPrimitive];if(np!==void 0){var ap=np.call(rp,_d||"default");if(typeof ap!="object")return ap;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_d==="string"?String:Number)(rp)}function Tree2Element(rp){return rp&&rp.map((_d,np)=>React.createElement(_d.tag,_objectSpread({key:np},_d.attr),Tree2Element(_d.child)))}function GenIcon(rp){return _d=>React.createElement(IconBase,_extends$3({attr:_objectSpread({},rp.attr)},_d),Tree2Element(rp.child))}function IconBase(rp){var _d=np=>{var{attr:ap,size:sp,title:lp}=rp,up=_objectWithoutProperties(rp,_excluded$9),cp=sp||np.size||"1em",dp;return np.className&&(dp=np.className),rp.className&&(dp=(dp?dp+" ":"")+rp.className),React.createElement("svg",_extends$3({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},np.attr,ap,up,{className:dp,style:_objectSpread(_objectSpread({color:rp.color||np.color},np.style),rp.style),height:cp,width:cp,xmlns:"http://www.w3.org/2000/svg"}),lp&&React.createElement("title",null,lp),rp.children)};return IconContext!==void 0?React.createElement(IconContext.Consumer,null,np=>_d(np)):_d(DefaultContext)}const defaultImg="/assets/login_img-97L6e1Qs.webp";function isObject$8(rp){return rp!==null&&typeof rp=="object"&&"constructor"in rp&&rp.constructor===Object}function extend$4(rp,_d){rp===void 0&&(rp={}),_d===void 0&&(_d={}),Object.keys(_d).forEach(np=>{typeof rp[np]>"u"?rp[np]=_d[np]:isObject$8(_d[np])&&isObject$8(rp[np])&&Object.keys(_d[np]).length>0&&extend$4(rp[np],_d[np])})}const ssrDocument={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function getDocument(){const rp=typeof document<"u"?document:{};return extend$4(rp,ssrDocument),rp}const ssrWindow={document:ssrDocument,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(rp){return typeof setTimeout>"u"?(rp(),null):setTimeout(rp,0)},cancelAnimationFrame(rp){typeof setTimeout>"u"||clearTimeout(rp)}};function getWindow(){const rp=typeof window<"u"?window:{};return extend$4(rp,ssrWindow),rp}function classesToTokens(rp){return rp===void 0&&(rp=""),rp.trim().split(" ").filter(_d=>!!_d.trim())}function deleteProps(rp){const _d=rp;Object.keys(_d).forEach(np=>{try{_d[np]=null}catch{}try{delete _d[np]}catch{}})}function nextTick(rp,_d){return _d===void 0&&(_d=0),setTimeout(rp,_d)}function now$1(){return Date.now()}function getComputedStyle$1(rp){const _d=getWindow();let np;return _d.getComputedStyle&&(np=_d.getComputedStyle(rp,null)),!np&&rp.currentStyle&&(np=rp.currentStyle),np||(np=rp.style),np}function getTranslate(rp,_d){_d===void 0&&(_d="x");const np=getWindow();let ap,sp,lp;const up=getComputedStyle$1(rp);return np.WebKitCSSMatrix?(sp=up.transform||up.webkitTransform,sp.split(",").length>6&&(sp=sp.split(", ").map(cp=>cp.replace(",",".")).join(", ")),lp=new np.WebKitCSSMatrix(sp==="none"?"":sp)):(lp=up.MozTransform||up.OTransform||up.MsTransform||up.msTransform||up.transform||up.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),ap=lp.toString().split(",")),_d==="x"&&(np.WebKitCSSMatrix?sp=lp.m41:ap.length===16?sp=parseFloat(ap[12]):sp=parseFloat(ap[4])),_d==="y"&&(np.WebKitCSSMatrix?sp=lp.m42:ap.length===16?sp=parseFloat(ap[13]):sp=parseFloat(ap[5])),sp||0}function isObject$7(rp){return typeof rp=="object"&&rp!==null&&rp.constructor&&Object.prototype.toString.call(rp).slice(8,-1)==="Object"}function isNode(rp){return typeof window<"u"&&typeof window.HTMLElement<"u"?rp instanceof HTMLElement:rp&&(rp.nodeType===1||rp.nodeType===11)}function extend$3(){const rp=Object(arguments.length<=0?void 0:arguments[0]),_d=["__proto__","constructor","prototype"];for(let np=1;np<arguments.length;np+=1){const ap=np<0||arguments.length<=np?void 0:arguments[np];if(ap!=null&&!isNode(ap)){const sp=Object.keys(Object(ap)).filter(lp=>_d.indexOf(lp)<0);for(let lp=0,up=sp.length;lp<up;lp+=1){const cp=sp[lp],dp=Object.getOwnPropertyDescriptor(ap,cp);dp!==void 0&&dp.enumerable&&(isObject$7(rp[cp])&&isObject$7(ap[cp])?ap[cp].__swiper__?rp[cp]=ap[cp]:extend$3(rp[cp],ap[cp]):!isObject$7(rp[cp])&&isObject$7(ap[cp])?(rp[cp]={},ap[cp].__swiper__?rp[cp]=ap[cp]:extend$3(rp[cp],ap[cp])):rp[cp]=ap[cp])}}}return rp}function setCSSProperty(rp,_d,np){rp.style.setProperty(_d,np)}function animateCSSModeScroll(rp){let{swiper:_d,targetPosition:np,side:ap}=rp;const sp=getWindow(),lp=-_d.translate;let up=null,cp;const dp=_d.params.speed;_d.wrapperEl.style.scrollSnapType="none",sp.cancelAnimationFrame(_d.cssModeFrameID);const hp=np>lp?"next":"prev",fp=(mp,gp)=>hp==="next"&&mp>=gp||hp==="prev"&&mp<=gp,pp=()=>{cp=new Date().getTime(),up===null&&(up=cp);const mp=Math.max(Math.min((cp-up)/dp,1),0),gp=.5-Math.cos(mp*Math.PI)/2;let yp=lp+gp*(np-lp);if(fp(yp,np)&&(yp=np),_d.wrapperEl.scrollTo({[ap]:yp}),fp(yp,np)){_d.wrapperEl.style.overflow="hidden",_d.wrapperEl.style.scrollSnapType="",setTimeout(()=>{_d.wrapperEl.style.overflow="",_d.wrapperEl.scrollTo({[ap]:yp})}),sp.cancelAnimationFrame(_d.cssModeFrameID);return}_d.cssModeFrameID=sp.requestAnimationFrame(pp)};pp()}function getSlideTransformEl(rp){return rp.querySelector(".swiper-slide-transform")||rp.shadowRoot&&rp.shadowRoot.querySelector(".swiper-slide-transform")||rp}function elementChildren(rp,_d){return _d===void 0&&(_d=""),[...rp.children].filter(np=>np.matches(_d))}function showWarning(rp){try{console.warn(rp);return}catch{}}function createElement(rp,_d){_d===void 0&&(_d=[]);const np=document.createElement(rp);return np.classList.add(...Array.isArray(_d)?_d:classesToTokens(_d)),np}function elementPrevAll(rp,_d){const np=[];for(;rp.previousElementSibling;){const ap=rp.previousElementSibling;_d?ap.matches(_d)&&np.push(ap):np.push(ap),rp=ap}return np}function elementNextAll(rp,_d){const np=[];for(;rp.nextElementSibling;){const ap=rp.nextElementSibling;_d?ap.matches(_d)&&np.push(ap):np.push(ap),rp=ap}return np}function elementStyle(rp,_d){return getWindow().getComputedStyle(rp,null).getPropertyValue(_d)}function elementIndex(rp){let _d=rp,np;if(_d){for(np=0;(_d=_d.previousSibling)!==null;)_d.nodeType===1&&(np+=1);return np}}function elementParents(rp,_d){const np=[];let ap=rp.parentElement;for(;ap;)_d?ap.matches(_d)&&np.push(ap):np.push(ap),ap=ap.parentElement;return np}function elementTransitionEnd(rp,_d){function np(ap){ap.target===rp&&(_d.call(rp,ap),rp.removeEventListener("transitionend",np))}_d&&rp.addEventListener("transitionend",np)}function elementOuterSize(rp,_d,np){const ap=getWindow();return np?rp[_d==="width"?"offsetWidth":"offsetHeight"]+parseFloat(ap.getComputedStyle(rp,null).getPropertyValue(_d==="width"?"margin-right":"margin-top"))+parseFloat(ap.getComputedStyle(rp,null).getPropertyValue(_d==="width"?"margin-left":"margin-bottom")):rp.offsetWidth}let support;function calcSupport(){const rp=getWindow(),_d=getDocument();return{smoothScroll:_d.documentElement&&_d.documentElement.style&&"scrollBehavior"in _d.documentElement.style,touch:!!("ontouchstart"in rp||rp.DocumentTouch&&_d instanceof rp.DocumentTouch)}}function getSupport(){return support||(support=calcSupport()),support}let deviceCached;function calcDevice(rp){let{userAgent:_d}=rp===void 0?{}:rp;const np=getSupport(),ap=getWindow(),sp=ap.navigator.platform,lp=_d||ap.navigator.userAgent,up={ios:!1,android:!1},cp=ap.screen.width,dp=ap.screen.height,hp=lp.match(/(Android);?[\s\/]+([\d.]+)?/);let fp=lp.match(/(iPad).*OS\s([\d_]+)/);const pp=lp.match(/(iPod)(.*OS\s([\d_]+))?/),mp=!fp&&lp.match(/(iPhone\sOS|iOS)\s([\d_]+)/),gp=sp==="Win32";let yp=sp==="MacIntel";const xp=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!fp&&yp&&np.touch&&xp.indexOf(`${cp}x${dp}`)>=0&&(fp=lp.match(/(Version)\/([\d.]+)/),fp||(fp=[0,1,"13_0_0"]),yp=!1),hp&&!gp&&(up.os="android",up.android=!0),(fp||mp||pp)&&(up.os="ios",up.ios=!0),up}function getDevice(rp){return rp===void 0&&(rp={}),deviceCached||(deviceCached=calcDevice(rp)),deviceCached}let browser;function calcBrowser(){const rp=getWindow();let _d=!1;function np(){const ap=rp.navigator.userAgent.toLowerCase();return ap.indexOf("safari")>=0&&ap.indexOf("chrome")<0&&ap.indexOf("android")<0}if(np()){const ap=String(rp.navigator.userAgent);if(ap.includes("Version/")){const[sp,lp]=ap.split("Version/")[1].split(" ")[0].split(".").map(up=>Number(up));_d=sp<16||sp===16&&lp<2}}return{isSafari:_d||np(),needPerspectiveFix:_d,isWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(rp.navigator.userAgent)}}function getBrowser(){return browser||(browser=calcBrowser()),browser}function Resize(rp){let{swiper:_d,on:np,emit:ap}=rp;const sp=getWindow();let lp=null,up=null;const cp=()=>{!_d||_d.destroyed||!_d.initialized||(ap("beforeResize"),ap("resize"))},dp=()=>{!_d||_d.destroyed||!_d.initialized||(lp=new ResizeObserver(pp=>{up=sp.requestAnimationFrame(()=>{const{width:mp,height:gp}=_d;let yp=mp,xp=gp;pp.forEach(_p=>{let{contentBoxSize:vp,contentRect:bp,target:Ep}=_p;Ep&&Ep!==_d.el||(yp=bp?bp.width:(vp[0]||vp).inlineSize,xp=bp?bp.height:(vp[0]||vp).blockSize)}),(yp!==mp||xp!==gp)&&cp()})}),lp.observe(_d.el))},hp=()=>{up&&sp.cancelAnimationFrame(up),lp&&lp.unobserve&&_d.el&&(lp.unobserve(_d.el),lp=null)},fp=()=>{!_d||_d.destroyed||!_d.initialized||ap("orientationchange")};np("init",()=>{if(_d.params.resizeObserver&&typeof sp.ResizeObserver<"u"){dp();return}sp.addEventListener("resize",cp),sp.addEventListener("orientationchange",fp)}),np("destroy",()=>{hp(),sp.removeEventListener("resize",cp),sp.removeEventListener("orientationchange",fp)})}function Observer(rp){let{swiper:_d,extendParams:np,on:ap,emit:sp}=rp;const lp=[],up=getWindow(),cp=function(fp,pp){pp===void 0&&(pp={});const mp=up.MutationObserver||up.WebkitMutationObserver,gp=new mp(yp=>{if(_d.__preventObserver__)return;if(yp.length===1){sp("observerUpdate",yp[0]);return}const xp=function(){sp("observerUpdate",yp[0])};up.requestAnimationFrame?up.requestAnimationFrame(xp):up.setTimeout(xp,0)});gp.observe(fp,{attributes:typeof pp.attributes>"u"?!0:pp.attributes,childList:typeof pp.childList>"u"?!0:pp.childList,characterData:typeof pp.characterData>"u"?!0:pp.characterData}),lp.push(gp)},dp=()=>{if(_d.params.observer){if(_d.params.observeParents){const fp=elementParents(_d.hostEl);for(let pp=0;pp<fp.length;pp+=1)cp(fp[pp])}cp(_d.hostEl,{childList:_d.params.observeSlideChildren}),cp(_d.wrapperEl,{attributes:!1})}},hp=()=>{lp.forEach(fp=>{fp.disconnect()}),lp.splice(0,lp.length)};np({observer:!1,observeParents:!1,observeSlideChildren:!1}),ap("init",dp),ap("destroy",hp)}var eventsEmitter={on(rp,_d,np){const ap=this;if(!ap.eventsListeners||ap.destroyed||typeof _d!="function")return ap;const sp=np?"unshift":"push";return rp.split(" ").forEach(lp=>{ap.eventsListeners[lp]||(ap.eventsListeners[lp]=[]),ap.eventsListeners[lp][sp](_d)}),ap},once(rp,_d,np){const ap=this;if(!ap.eventsListeners||ap.destroyed||typeof _d!="function")return ap;function sp(){ap.off(rp,sp),sp.__emitterProxy&&delete sp.__emitterProxy;for(var lp=arguments.length,up=new Array(lp),cp=0;cp<lp;cp++)up[cp]=arguments[cp];_d.apply(ap,up)}return sp.__emitterProxy=_d,ap.on(rp,sp,np)},onAny(rp,_d){const np=this;if(!np.eventsListeners||np.destroyed||typeof rp!="function")return np;const ap=_d?"unshift":"push";return np.eventsAnyListeners.indexOf(rp)<0&&np.eventsAnyListeners[ap](rp),np},offAny(rp){const _d=this;if(!_d.eventsListeners||_d.destroyed||!_d.eventsAnyListeners)return _d;const np=_d.eventsAnyListeners.indexOf(rp);return np>=0&&_d.eventsAnyListeners.splice(np,1),_d},off(rp,_d){const np=this;return!np.eventsListeners||np.destroyed||!np.eventsListeners||rp.split(" ").forEach(ap=>{typeof _d>"u"?np.eventsListeners[ap]=[]:np.eventsListeners[ap]&&np.eventsListeners[ap].forEach((sp,lp)=>{(sp===_d||sp.__emitterProxy&&sp.__emitterProxy===_d)&&np.eventsListeners[ap].splice(lp,1)})}),np},emit(){const rp=this;if(!rp.eventsListeners||rp.destroyed||!rp.eventsListeners)return rp;let _d,np,ap;for(var sp=arguments.length,lp=new Array(sp),up=0;up<sp;up++)lp[up]=arguments[up];return typeof lp[0]=="string"||Array.isArray(lp[0])?(_d=lp[0],np=lp.slice(1,lp.length),ap=rp):(_d=lp[0].events,np=lp[0].data,ap=lp[0].context||rp),np.unshift(ap),(Array.isArray(_d)?_d:_d.split(" ")).forEach(dp=>{rp.eventsAnyListeners&&rp.eventsAnyListeners.length&&rp.eventsAnyListeners.forEach(hp=>{hp.apply(ap,[dp,...np])}),rp.eventsListeners&&rp.eventsListeners[dp]&&rp.eventsListeners[dp].forEach(hp=>{hp.apply(ap,np)})}),rp}};function updateSize(){const rp=this;let _d,np;const ap=rp.el;typeof rp.params.width<"u"&&rp.params.width!==null?_d=rp.params.width:_d=ap.clientWidth,typeof rp.params.height<"u"&&rp.params.height!==null?np=rp.params.height:np=ap.clientHeight,!(_d===0&&rp.isHorizontal()||np===0&&rp.isVertical())&&(_d=_d-parseInt(elementStyle(ap,"padding-left")||0,10)-parseInt(elementStyle(ap,"padding-right")||0,10),np=np-parseInt(elementStyle(ap,"padding-top")||0,10)-parseInt(elementStyle(ap,"padding-bottom")||0,10),Number.isNaN(_d)&&(_d=0),Number.isNaN(np)&&(np=0),Object.assign(rp,{width:_d,height:np,size:rp.isHorizontal()?_d:np}))}function updateSlides(){const rp=this;function _d(Pp,$p){return parseFloat(Pp.getPropertyValue(rp.getDirectionLabel($p))||0)}const np=rp.params,{wrapperEl:ap,slidesEl:sp,size:lp,rtlTranslate:up,wrongRTL:cp}=rp,dp=rp.virtual&&np.virtual.enabled,hp=dp?rp.virtual.slides.length:rp.slides.length,fp=elementChildren(sp,`.${rp.params.slideClass}, swiper-slide`),pp=dp?rp.virtual.slides.length:fp.length;let mp=[];const gp=[],yp=[];let xp=np.slidesOffsetBefore;typeof xp=="function"&&(xp=np.slidesOffsetBefore.call(rp));let _p=np.slidesOffsetAfter;typeof _p=="function"&&(_p=np.slidesOffsetAfter.call(rp));const vp=rp.snapGrid.length,bp=rp.slidesGrid.length;let Ep=np.spaceBetween,Sp=-xp,Ap=0,Rp=0;if(typeof lp>"u")return;typeof Ep=="string"&&Ep.indexOf("%")>=0?Ep=parseFloat(Ep.replace("%",""))/100*lp:typeof Ep=="string"&&(Ep=parseFloat(Ep)),rp.virtualSize=-Ep,fp.forEach(Pp=>{up?Pp.style.marginLeft="":Pp.style.marginRight="",Pp.style.marginBottom="",Pp.style.marginTop=""}),np.centeredSlides&&np.cssMode&&(setCSSProperty(ap,"--swiper-centered-offset-before",""),setCSSProperty(ap,"--swiper-centered-offset-after",""));const Tp=np.grid&&np.grid.rows>1&&rp.grid;Tp?rp.grid.initSlides(fp):rp.grid&&rp.grid.unsetSlides();let Mp;const Op=np.slidesPerView==="auto"&&np.breakpoints&&Object.keys(np.breakpoints).filter(Pp=>typeof np.breakpoints[Pp].slidesPerView<"u").length>0;for(let Pp=0;Pp<pp;Pp+=1){Mp=0;let $p;if(fp[Pp]&&($p=fp[Pp]),Tp&&rp.grid.updateSlide(Pp,$p,fp),!(fp[Pp]&&elementStyle($p,"display")==="none")){if(np.slidesPerView==="auto"){Op&&(fp[Pp].style[rp.getDirectionLabel("width")]="");const zp=getComputedStyle($p),Dp=$p.style.transform,Fp=$p.style.webkitTransform;if(Dp&&($p.style.transform="none"),Fp&&($p.style.webkitTransform="none"),np.roundLengths)Mp=rp.isHorizontal()?elementOuterSize($p,"width",!0):elementOuterSize($p,"height",!0);else{const jp=_d(zp,"width"),Lp=_d(zp,"padding-left"),Bp=_d(zp,"padding-right"),Ip=_d(zp,"margin-left"),kp=_d(zp,"margin-right"),Up=zp.getPropertyValue("box-sizing");if(Up&&Up==="border-box")Mp=jp+Ip+kp;else{const{clientWidth:Gp,offsetWidth:Wp}=$p;Mp=jp+Lp+Bp+Ip+kp+(Wp-Gp)}}Dp&&($p.style.transform=Dp),Fp&&($p.style.webkitTransform=Fp),np.roundLengths&&(Mp=Math.floor(Mp))}else Mp=(lp-(np.slidesPerView-1)*Ep)/np.slidesPerView,np.roundLengths&&(Mp=Math.floor(Mp)),fp[Pp]&&(fp[Pp].style[rp.getDirectionLabel("width")]=`${Mp}px`);fp[Pp]&&(fp[Pp].swiperSlideSize=Mp),yp.push(Mp),np.centeredSlides?(Sp=Sp+Mp/2+Ap/2+Ep,Ap===0&&Pp!==0&&(Sp=Sp-lp/2-Ep),Pp===0&&(Sp=Sp-lp/2-Ep),Math.abs(Sp)<1/1e3&&(Sp=0),np.roundLengths&&(Sp=Math.floor(Sp)),Rp%np.slidesPerGroup===0&&mp.push(Sp),gp.push(Sp)):(np.roundLengths&&(Sp=Math.floor(Sp)),(Rp-Math.min(rp.params.slidesPerGroupSkip,Rp))%rp.params.slidesPerGroup===0&&mp.push(Sp),gp.push(Sp),Sp=Sp+Mp+Ep),rp.virtualSize+=Mp+Ep,Ap=Mp,Rp+=1}}if(rp.virtualSize=Math.max(rp.virtualSize,lp)+_p,up&&cp&&(np.effect==="slide"||np.effect==="coverflow")&&(ap.style.width=`${rp.virtualSize+Ep}px`),np.setWrapperSize&&(ap.style[rp.getDirectionLabel("width")]=`${rp.virtualSize+Ep}px`),Tp&&rp.grid.updateWrapperSize(Mp,mp),!np.centeredSlides){const Pp=[];for(let $p=0;$p<mp.length;$p+=1){let zp=mp[$p];np.roundLengths&&(zp=Math.floor(zp)),mp[$p]<=rp.virtualSize-lp&&Pp.push(zp)}mp=Pp,Math.floor(rp.virtualSize-lp)-Math.floor(mp[mp.length-1])>1&&mp.push(rp.virtualSize-lp)}if(dp&&np.loop){const Pp=yp[0]+Ep;if(np.slidesPerGroup>1){const $p=Math.ceil((rp.virtual.slidesBefore+rp.virtual.slidesAfter)/np.slidesPerGroup),zp=Pp*np.slidesPerGroup;for(let Dp=0;Dp<$p;Dp+=1)mp.push(mp[mp.length-1]+zp)}for(let $p=0;$p<rp.virtual.slidesBefore+rp.virtual.slidesAfter;$p+=1)np.slidesPerGroup===1&&mp.push(mp[mp.length-1]+Pp),gp.push(gp[gp.length-1]+Pp),rp.virtualSize+=Pp}if(mp.length===0&&(mp=[0]),Ep!==0){const Pp=rp.isHorizontal()&&up?"marginLeft":rp.getDirectionLabel("marginRight");fp.filter(($p,zp)=>!np.cssMode||np.loop?!0:zp!==fp.length-1).forEach($p=>{$p.style[Pp]=`${Ep}px`})}if(np.centeredSlides&&np.centeredSlidesBounds){let Pp=0;yp.forEach(zp=>{Pp+=zp+(Ep||0)}),Pp-=Ep;const $p=Pp-lp;mp=mp.map(zp=>zp<=0?-xp:zp>$p?$p+_p:zp)}if(np.centerInsufficientSlides){let Pp=0;if(yp.forEach($p=>{Pp+=$p+(Ep||0)}),Pp-=Ep,Pp<lp){const $p=(lp-Pp)/2;mp.forEach((zp,Dp)=>{mp[Dp]=zp-$p}),gp.forEach((zp,Dp)=>{gp[Dp]=zp+$p})}}if(Object.assign(rp,{slides:fp,snapGrid:mp,slidesGrid:gp,slidesSizesGrid:yp}),np.centeredSlides&&np.cssMode&&!np.centeredSlidesBounds){setCSSProperty(ap,"--swiper-centered-offset-before",`${-mp[0]}px`),setCSSProperty(ap,"--swiper-centered-offset-after",`${rp.size/2-yp[yp.length-1]/2}px`);const Pp=-rp.snapGrid[0],$p=-rp.slidesGrid[0];rp.snapGrid=rp.snapGrid.map(zp=>zp+Pp),rp.slidesGrid=rp.slidesGrid.map(zp=>zp+$p)}if(pp!==hp&&rp.emit("slidesLengthChange"),mp.length!==vp&&(rp.params.watchOverflow&&rp.checkOverflow(),rp.emit("snapGridLengthChange")),gp.length!==bp&&rp.emit("slidesGridLengthChange"),np.watchSlidesProgress&&rp.updateSlidesOffset(),rp.emit("slidesUpdated"),!dp&&!np.cssMode&&(np.effect==="slide"||np.effect==="fade")){const Pp=`${np.containerModifierClass}backface-hidden`,$p=rp.el.classList.contains(Pp);pp<=np.maxBackfaceHiddenSlides?$p||rp.el.classList.add(Pp):$p&&rp.el.classList.remove(Pp)}}function updateAutoHeight(rp){const _d=this,np=[],ap=_d.virtual&&_d.params.virtual.enabled;let sp=0,lp;typeof rp=="number"?_d.setTransition(rp):rp===!0&&_d.setTransition(_d.params.speed);const up=cp=>ap?_d.slides[_d.getSlideIndexByData(cp)]:_d.slides[cp];if(_d.params.slidesPerView!=="auto"&&_d.params.slidesPerView>1)if(_d.params.centeredSlides)(_d.visibleSlides||[]).forEach(cp=>{np.push(cp)});else for(lp=0;lp<Math.ceil(_d.params.slidesPerView);lp+=1){const cp=_d.activeIndex+lp;if(cp>_d.slides.length&&!ap)break;np.push(up(cp))}else np.push(up(_d.activeIndex));for(lp=0;lp<np.length;lp+=1)if(typeof np[lp]<"u"){const cp=np[lp].offsetHeight;sp=cp>sp?cp:sp}(sp||sp===0)&&(_d.wrapperEl.style.height=`${sp}px`)}function updateSlidesOffset(){const rp=this,_d=rp.slides,np=rp.isElement?rp.isHorizontal()?rp.wrapperEl.offsetLeft:rp.wrapperEl.offsetTop:0;for(let ap=0;ap<_d.length;ap+=1)_d[ap].swiperSlideOffset=(rp.isHorizontal()?_d[ap].offsetLeft:_d[ap].offsetTop)-np-rp.cssOverflowAdjustment()}function updateSlidesProgress(rp){rp===void 0&&(rp=this&&this.translate||0);const _d=this,np=_d.params,{slides:ap,rtlTranslate:sp,snapGrid:lp}=_d;if(ap.length===0)return;typeof ap[0].swiperSlideOffset>"u"&&_d.updateSlidesOffset();let up=-rp;sp&&(up=rp),ap.forEach(dp=>{dp.classList.remove(np.slideVisibleClass,np.slideFullyVisibleClass)}),_d.visibleSlidesIndexes=[],_d.visibleSlides=[];let cp=np.spaceBetween;typeof cp=="string"&&cp.indexOf("%")>=0?cp=parseFloat(cp.replace("%",""))/100*_d.size:typeof cp=="string"&&(cp=parseFloat(cp));for(let dp=0;dp<ap.length;dp+=1){const hp=ap[dp];let fp=hp.swiperSlideOffset;np.cssMode&&np.centeredSlides&&(fp-=ap[0].swiperSlideOffset);const pp=(up+(np.centeredSlides?_d.minTranslate():0)-fp)/(hp.swiperSlideSize+cp),mp=(up-lp[0]+(np.centeredSlides?_d.minTranslate():0)-fp)/(hp.swiperSlideSize+cp),gp=-(up-fp),yp=gp+_d.slidesSizesGrid[dp],xp=gp>=0&&gp<=_d.size-_d.slidesSizesGrid[dp];(gp>=0&&gp<_d.size-1||yp>1&&yp<=_d.size||gp<=0&&yp>=_d.size)&&(_d.visibleSlides.push(hp),_d.visibleSlidesIndexes.push(dp),ap[dp].classList.add(np.slideVisibleClass)),xp&&ap[dp].classList.add(np.slideFullyVisibleClass),hp.progress=sp?-pp:pp,hp.originalProgress=sp?-mp:mp}}function updateProgress(rp){const _d=this;if(typeof rp>"u"){const fp=_d.rtlTranslate?-1:1;rp=_d&&_d.translate&&_d.translate*fp||0}const np=_d.params,ap=_d.maxTranslate()-_d.minTranslate();let{progress:sp,isBeginning:lp,isEnd:up,progressLoop:cp}=_d;const dp=lp,hp=up;if(ap===0)sp=0,lp=!0,up=!0;else{sp=(rp-_d.minTranslate())/ap;const fp=Math.abs(rp-_d.minTranslate())<1,pp=Math.abs(rp-_d.maxTranslate())<1;lp=fp||sp<=0,up=pp||sp>=1,fp&&(sp=0),pp&&(sp=1)}if(np.loop){const fp=_d.getSlideIndexByData(0),pp=_d.getSlideIndexByData(_d.slides.length-1),mp=_d.slidesGrid[fp],gp=_d.slidesGrid[pp],yp=_d.slidesGrid[_d.slidesGrid.length-1],xp=Math.abs(rp);xp>=mp?cp=(xp-mp)/yp:cp=(xp+yp-gp)/yp,cp>1&&(cp-=1)}Object.assign(_d,{progress:sp,progressLoop:cp,isBeginning:lp,isEnd:up}),(np.watchSlidesProgress||np.centeredSlides&&np.autoHeight)&&_d.updateSlidesProgress(rp),lp&&!dp&&_d.emit("reachBeginning toEdge"),up&&!hp&&_d.emit("reachEnd toEdge"),(dp&&!lp||hp&&!up)&&_d.emit("fromEdge"),_d.emit("progress",sp)}function updateSlidesClasses(){const rp=this,{slides:_d,params:np,slidesEl:ap,activeIndex:sp}=rp,lp=rp.virtual&&np.virtual.enabled,up=rp.grid&&np.grid&&np.grid.rows>1,cp=pp=>elementChildren(ap,`.${np.slideClass}${pp}, swiper-slide${pp}`)[0];_d.forEach(pp=>{pp.classList.remove(np.slideActiveClass,np.slideNextClass,np.slidePrevClass)});let dp,hp,fp;if(lp)if(np.loop){let pp=sp-rp.virtual.slidesBefore;pp<0&&(pp=rp.virtual.slides.length+pp),pp>=rp.virtual.slides.length&&(pp-=rp.virtual.slides.length),dp=cp(`[data-swiper-slide-index="${pp}"]`)}else dp=cp(`[data-swiper-slide-index="${sp}"]`);else up?(dp=_d.filter(pp=>pp.column===sp)[0],fp=_d.filter(pp=>pp.column===sp+1)[0],hp=_d.filter(pp=>pp.column===sp-1)[0]):dp=_d[sp];dp&&(dp.classList.add(np.slideActiveClass),up?(fp&&fp.classList.add(np.slideNextClass),hp&&hp.classList.add(np.slidePrevClass)):(fp=elementNextAll(dp,`.${np.slideClass}, swiper-slide`)[0],np.loop&&!fp&&(fp=_d[0]),fp&&fp.classList.add(np.slideNextClass),hp=elementPrevAll(dp,`.${np.slideClass}, swiper-slide`)[0],np.loop&&!hp===0&&(hp=_d[_d.length-1]),hp&&hp.classList.add(np.slidePrevClass))),rp.emitSlidesClasses()}const processLazyPreloader=(rp,_d)=>{if(!rp||rp.destroyed||!rp.params)return;const np=()=>rp.isElement?"swiper-slide":`.${rp.params.slideClass}`,ap=_d.closest(np());if(ap){let sp=ap.querySelector(`.${rp.params.lazyPreloaderClass}`);!sp&&rp.isElement&&(ap.shadowRoot?sp=ap.shadowRoot.querySelector(`.${rp.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{ap.shadowRoot&&(sp=ap.shadowRoot.querySelector(`.${rp.params.lazyPreloaderClass}`),sp&&sp.remove())})),sp&&sp.remove()}},unlazy=(rp,_d)=>{if(!rp.slides[_d])return;const np=rp.slides[_d].querySelector('[loading="lazy"]');np&&np.removeAttribute("loading")},preload$1=rp=>{if(!rp||rp.destroyed||!rp.params)return;let _d=rp.params.lazyPreloadPrevNext;const np=rp.slides.length;if(!np||!_d||_d<0)return;_d=Math.min(_d,np);const ap=rp.params.slidesPerView==="auto"?rp.slidesPerViewDynamic():Math.ceil(rp.params.slidesPerView),sp=rp.activeIndex;if(rp.params.grid&&rp.params.grid.rows>1){const up=sp,cp=[up-_d];cp.push(...Array.from({length:_d}).map((dp,hp)=>up+ap+hp)),rp.slides.forEach((dp,hp)=>{cp.includes(dp.column)&&unlazy(rp,hp)});return}const lp=sp+ap-1;if(rp.params.rewind||rp.params.loop)for(let up=sp-_d;up<=lp+_d;up+=1){const cp=(up%np+np)%np;(cp<sp||cp>lp)&&unlazy(rp,cp)}else for(let up=Math.max(sp-_d,0);up<=Math.min(lp+_d,np-1);up+=1)up!==sp&&(up>lp||up<sp)&&unlazy(rp,up)};function getActiveIndexByTranslate(rp){const{slidesGrid:_d,params:np}=rp,ap=rp.rtlTranslate?rp.translate:-rp.translate;let sp;for(let lp=0;lp<_d.length;lp+=1)typeof _d[lp+1]<"u"?ap>=_d[lp]&&ap<_d[lp+1]-(_d[lp+1]-_d[lp])/2?sp=lp:ap>=_d[lp]&&ap<_d[lp+1]&&(sp=lp+1):ap>=_d[lp]&&(sp=lp);return np.normalizeSlideIndex&&(sp<0||typeof sp>"u")&&(sp=0),sp}function updateActiveIndex(rp){const _d=this,np=_d.rtlTranslate?_d.translate:-_d.translate,{snapGrid:ap,params:sp,activeIndex:lp,realIndex:up,snapIndex:cp}=_d;let dp=rp,hp;const fp=gp=>{let yp=gp-_d.virtual.slidesBefore;return yp<0&&(yp=_d.virtual.slides.length+yp),yp>=_d.virtual.slides.length&&(yp-=_d.virtual.slides.length),yp};if(typeof dp>"u"&&(dp=getActiveIndexByTranslate(_d)),ap.indexOf(np)>=0)hp=ap.indexOf(np);else{const gp=Math.min(sp.slidesPerGroupSkip,dp);hp=gp+Math.floor((dp-gp)/sp.slidesPerGroup)}if(hp>=ap.length&&(hp=ap.length-1),dp===lp&&!_d.params.loop){hp!==cp&&(_d.snapIndex=hp,_d.emit("snapIndexChange"));return}if(dp===lp&&_d.params.loop&&_d.virtual&&_d.params.virtual.enabled){_d.realIndex=fp(dp);return}const pp=_d.grid&&sp.grid&&sp.grid.rows>1;let mp;if(_d.virtual&&sp.virtual.enabled&&sp.loop)mp=fp(dp);else if(pp){const gp=_d.slides.filter(xp=>xp.column===dp)[0];let yp=parseInt(gp.getAttribute("data-swiper-slide-index"),10);Number.isNaN(yp)&&(yp=Math.max(_d.slides.indexOf(gp),0)),mp=Math.floor(yp/sp.grid.rows)}else if(_d.slides[dp]){const gp=_d.slides[dp].getAttribute("data-swiper-slide-index");gp?mp=parseInt(gp,10):mp=dp}else mp=dp;Object.assign(_d,{previousSnapIndex:cp,snapIndex:hp,previousRealIndex:up,realIndex:mp,previousIndex:lp,activeIndex:dp}),_d.initialized&&preload$1(_d),_d.emit("activeIndexChange"),_d.emit("snapIndexChange"),(_d.initialized||_d.params.runCallbacksOnInit)&&(up!==mp&&_d.emit("realIndexChange"),_d.emit("slideChange"))}function updateClickedSlide(rp,_d){const np=this,ap=np.params;let sp=rp.closest(`.${ap.slideClass}, swiper-slide`);!sp&&np.isElement&&_d&&_d.length>1&&_d.includes(rp)&&[..._d.slice(_d.indexOf(rp)+1,_d.length)].forEach(cp=>{!sp&&cp.matches&&cp.matches(`.${ap.slideClass}, swiper-slide`)&&(sp=cp)});let lp=!1,up;if(sp){for(let cp=0;cp<np.slides.length;cp+=1)if(np.slides[cp]===sp){lp=!0,up=cp;break}}if(sp&&lp)np.clickedSlide=sp,np.virtual&&np.params.virtual.enabled?np.clickedIndex=parseInt(sp.getAttribute("data-swiper-slide-index"),10):np.clickedIndex=up;else{np.clickedSlide=void 0,np.clickedIndex=void 0;return}ap.slideToClickedSlide&&np.clickedIndex!==void 0&&np.clickedIndex!==np.activeIndex&&np.slideToClickedSlide()}var update={updateSize,updateSlides,updateAutoHeight,updateSlidesOffset,updateSlidesProgress,updateProgress,updateSlidesClasses,updateActiveIndex,updateClickedSlide};function getSwiperTranslate(rp){rp===void 0&&(rp=this.isHorizontal()?"x":"y");const _d=this,{params:np,rtlTranslate:ap,translate:sp,wrapperEl:lp}=_d;if(np.virtualTranslate)return ap?-sp:sp;if(np.cssMode)return sp;let up=getTranslate(lp,rp);return up+=_d.cssOverflowAdjustment(),ap&&(up=-up),up||0}function setTranslate(rp,_d){const np=this,{rtlTranslate:ap,params:sp,wrapperEl:lp,progress:up}=np;let cp=0,dp=0;const hp=0;np.isHorizontal()?cp=ap?-rp:rp:dp=rp,sp.roundLengths&&(cp=Math.floor(cp),dp=Math.floor(dp)),np.previousTranslate=np.translate,np.translate=np.isHorizontal()?cp:dp,sp.cssMode?lp[np.isHorizontal()?"scrollLeft":"scrollTop"]=np.isHorizontal()?-cp:-dp:sp.virtualTranslate||(np.isHorizontal()?cp-=np.cssOverflowAdjustment():dp-=np.cssOverflowAdjustment(),lp.style.transform=`translate3d(${cp}px, ${dp}px, ${hp}px)`);let fp;const pp=np.maxTranslate()-np.minTranslate();pp===0?fp=0:fp=(rp-np.minTranslate())/pp,fp!==up&&np.updateProgress(rp),np.emit("setTranslate",np.translate,_d)}function minTranslate(){return-this.snapGrid[0]}function maxTranslate(){return-this.snapGrid[this.snapGrid.length-1]}function translateTo(rp,_d,np,ap,sp){rp===void 0&&(rp=0),_d===void 0&&(_d=this.params.speed),np===void 0&&(np=!0),ap===void 0&&(ap=!0);const lp=this,{params:up,wrapperEl:cp}=lp;if(lp.animating&&up.preventInteractionOnTransition)return!1;const dp=lp.minTranslate(),hp=lp.maxTranslate();let fp;if(ap&&rp>dp?fp=dp:ap&&rp<hp?fp=hp:fp=rp,lp.updateProgress(fp),up.cssMode){const pp=lp.isHorizontal();if(_d===0)cp[pp?"scrollLeft":"scrollTop"]=-fp;else{if(!lp.support.smoothScroll)return animateCSSModeScroll({swiper:lp,targetPosition:-fp,side:pp?"left":"top"}),!0;cp.scrollTo({[pp?"left":"top"]:-fp,behavior:"smooth"})}return!0}return _d===0?(lp.setTransition(0),lp.setTranslate(fp),np&&(lp.emit("beforeTransitionStart",_d,sp),lp.emit("transitionEnd"))):(lp.setTransition(_d),lp.setTranslate(fp),np&&(lp.emit("beforeTransitionStart",_d,sp),lp.emit("transitionStart")),lp.animating||(lp.animating=!0,lp.onTranslateToWrapperTransitionEnd||(lp.onTranslateToWrapperTransitionEnd=function(mp){!lp||lp.destroyed||mp.target===this&&(lp.wrapperEl.removeEventListener("transitionend",lp.onTranslateToWrapperTransitionEnd),lp.onTranslateToWrapperTransitionEnd=null,delete lp.onTranslateToWrapperTransitionEnd,np&&lp.emit("transitionEnd"))}),lp.wrapperEl.addEventListener("transitionend",lp.onTranslateToWrapperTransitionEnd))),!0}var translate={getTranslate:getSwiperTranslate,setTranslate,minTranslate,maxTranslate,translateTo};function setTransition(rp,_d){const np=this;np.params.cssMode||(np.wrapperEl.style.transitionDuration=`${rp}ms`,np.wrapperEl.style.transitionDelay=rp===0?"0ms":""),np.emit("setTransition",rp,_d)}function transitionEmit(rp){let{swiper:_d,runCallbacks:np,direction:ap,step:sp}=rp;const{activeIndex:lp,previousIndex:up}=_d;let cp=ap;if(cp||(lp>up?cp="next":lp<up?cp="prev":cp="reset"),_d.emit(`transition${sp}`),np&&lp!==up){if(cp==="reset"){_d.emit(`slideResetTransition${sp}`);return}_d.emit(`slideChangeTransition${sp}`),cp==="next"?_d.emit(`slideNextTransition${sp}`):_d.emit(`slidePrevTransition${sp}`)}}function transitionStart(rp,_d){rp===void 0&&(rp=!0);const np=this,{params:ap}=np;ap.cssMode||(ap.autoHeight&&np.updateAutoHeight(),transitionEmit({swiper:np,runCallbacks:rp,direction:_d,step:"Start"}))}function transitionEnd(rp,_d){rp===void 0&&(rp=!0);const np=this,{params:ap}=np;np.animating=!1,!ap.cssMode&&(np.setTransition(0),transitionEmit({swiper:np,runCallbacks:rp,direction:_d,step:"End"}))}var transition={setTransition,transitionStart,transitionEnd};function slideTo(rp,_d,np,ap,sp){rp===void 0&&(rp=0),_d===void 0&&(_d=this.params.speed),np===void 0&&(np=!0),typeof rp=="string"&&(rp=parseInt(rp,10));const lp=this;let up=rp;up<0&&(up=0);const{params:cp,snapGrid:dp,slidesGrid:hp,previousIndex:fp,activeIndex:pp,rtlTranslate:mp,wrapperEl:gp,enabled:yp}=lp;if(lp.animating&&cp.preventInteractionOnTransition||!yp&&!ap&&!sp)return!1;const xp=Math.min(lp.params.slidesPerGroupSkip,up);let _p=xp+Math.floor((up-xp)/lp.params.slidesPerGroup);_p>=dp.length&&(_p=dp.length-1);const vp=-dp[_p];if(cp.normalizeSlideIndex)for(let Ep=0;Ep<hp.length;Ep+=1){const Sp=-Math.floor(vp*100),Ap=Math.floor(hp[Ep]*100),Rp=Math.floor(hp[Ep+1]*100);typeof hp[Ep+1]<"u"?Sp>=Ap&&Sp<Rp-(Rp-Ap)/2?up=Ep:Sp>=Ap&&Sp<Rp&&(up=Ep+1):Sp>=Ap&&(up=Ep)}if(lp.initialized&&up!==pp&&(!lp.allowSlideNext&&(mp?vp>lp.translate&&vp>lp.minTranslate():vp<lp.translate&&vp<lp.minTranslate())||!lp.allowSlidePrev&&vp>lp.translate&&vp>lp.maxTranslate()&&(pp||0)!==up))return!1;up!==(fp||0)&&np&&lp.emit("beforeSlideChangeStart"),lp.updateProgress(vp);let bp;if(up>pp?bp="next":up<pp?bp="prev":bp="reset",mp&&-vp===lp.translate||!mp&&vp===lp.translate)return lp.updateActiveIndex(up),cp.autoHeight&&lp.updateAutoHeight(),lp.updateSlidesClasses(),cp.effect!=="slide"&&lp.setTranslate(vp),bp!=="reset"&&(lp.transitionStart(np,bp),lp.transitionEnd(np,bp)),!1;if(cp.cssMode){const Ep=lp.isHorizontal(),Sp=mp?vp:-vp;if(_d===0){const Ap=lp.virtual&&lp.params.virtual.enabled;Ap&&(lp.wrapperEl.style.scrollSnapType="none",lp._immediateVirtual=!0),Ap&&!lp._cssModeVirtualInitialSet&&lp.params.initialSlide>0?(lp._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{gp[Ep?"scrollLeft":"scrollTop"]=Sp})):gp[Ep?"scrollLeft":"scrollTop"]=Sp,Ap&&requestAnimationFrame(()=>{lp.wrapperEl.style.scrollSnapType="",lp._immediateVirtual=!1})}else{if(!lp.support.smoothScroll)return animateCSSModeScroll({swiper:lp,targetPosition:Sp,side:Ep?"left":"top"}),!0;gp.scrollTo({[Ep?"left":"top"]:Sp,behavior:"smooth"})}return!0}return lp.setTransition(_d),lp.setTranslate(vp),lp.updateActiveIndex(up),lp.updateSlidesClasses(),lp.emit("beforeTransitionStart",_d,ap),lp.transitionStart(np,bp),_d===0?lp.transitionEnd(np,bp):lp.animating||(lp.animating=!0,lp.onSlideToWrapperTransitionEnd||(lp.onSlideToWrapperTransitionEnd=function(Sp){!lp||lp.destroyed||Sp.target===this&&(lp.wrapperEl.removeEventListener("transitionend",lp.onSlideToWrapperTransitionEnd),lp.onSlideToWrapperTransitionEnd=null,delete lp.onSlideToWrapperTransitionEnd,lp.transitionEnd(np,bp))}),lp.wrapperEl.addEventListener("transitionend",lp.onSlideToWrapperTransitionEnd)),!0}function slideToLoop(rp,_d,np,ap){rp===void 0&&(rp=0),_d===void 0&&(_d=this.params.speed),np===void 0&&(np=!0),typeof rp=="string"&&(rp=parseInt(rp,10));const sp=this,lp=sp.grid&&sp.params.grid&&sp.params.grid.rows>1;let up=rp;if(sp.params.loop)if(sp.virtual&&sp.params.virtual.enabled)up=up+sp.virtual.slidesBefore;else{let cp;if(lp){const mp=up*sp.params.grid.rows;cp=sp.slides.filter(gp=>gp.getAttribute("data-swiper-slide-index")*1===mp)[0].column}else cp=sp.getSlideIndexByData(up);const dp=lp?Math.ceil(sp.slides.length/sp.params.grid.rows):sp.slides.length,{centeredSlides:hp}=sp.params;let fp=sp.params.slidesPerView;fp==="auto"?fp=sp.slidesPerViewDynamic():(fp=Math.ceil(parseFloat(sp.params.slidesPerView,10)),hp&&fp%2===0&&(fp=fp+1));let pp=dp-cp<fp;if(hp&&(pp=pp||cp<Math.ceil(fp/2)),pp){const mp=hp?cp<sp.activeIndex?"prev":"next":cp-sp.activeIndex-1<sp.params.slidesPerView?"next":"prev";sp.loopFix({direction:mp,slideTo:!0,activeSlideIndex:mp==="next"?cp+1:cp-dp+1,slideRealIndex:mp==="next"?sp.realIndex:void 0})}if(lp){const mp=up*sp.params.grid.rows;up=sp.slides.filter(gp=>gp.getAttribute("data-swiper-slide-index")*1===mp)[0].column}else up=sp.getSlideIndexByData(up)}return requestAnimationFrame(()=>{sp.slideTo(up,_d,np,ap)}),sp}function slideNext(rp,_d,np){rp===void 0&&(rp=this.params.speed),_d===void 0&&(_d=!0);const ap=this,{enabled:sp,params:lp,animating:up}=ap;if(!sp)return ap;let cp=lp.slidesPerGroup;lp.slidesPerView==="auto"&&lp.slidesPerGroup===1&&lp.slidesPerGroupAuto&&(cp=Math.max(ap.slidesPerViewDynamic("current",!0),1));const dp=ap.activeIndex<lp.slidesPerGroupSkip?1:cp,hp=ap.virtual&&lp.virtual.enabled;if(lp.loop){if(up&&!hp&&lp.loopPreventsSliding)return!1;if(ap.loopFix({direction:"next"}),ap._clientLeft=ap.wrapperEl.clientLeft,ap.activeIndex===ap.slides.length-1&&lp.cssMode)return requestAnimationFrame(()=>{ap.slideTo(ap.activeIndex+dp,rp,_d,np)}),!0}return lp.rewind&&ap.isEnd?ap.slideTo(0,rp,_d,np):ap.slideTo(ap.activeIndex+dp,rp,_d,np)}function slidePrev(rp,_d,np){rp===void 0&&(rp=this.params.speed),_d===void 0&&(_d=!0);const ap=this,{params:sp,snapGrid:lp,slidesGrid:up,rtlTranslate:cp,enabled:dp,animating:hp}=ap;if(!dp)return ap;const fp=ap.virtual&&sp.virtual.enabled;if(sp.loop){if(hp&&!fp&&sp.loopPreventsSliding)return!1;ap.loopFix({direction:"prev"}),ap._clientLeft=ap.wrapperEl.clientLeft}const pp=cp?ap.translate:-ap.translate;function mp(vp){return vp<0?-Math.floor(Math.abs(vp)):Math.floor(vp)}const gp=mp(pp),yp=lp.map(vp=>mp(vp));let xp=lp[yp.indexOf(gp)-1];if(typeof xp>"u"&&sp.cssMode){let vp;lp.forEach((bp,Ep)=>{gp>=bp&&(vp=Ep)}),typeof vp<"u"&&(xp=lp[vp>0?vp-1:vp])}let _p=0;if(typeof xp<"u"&&(_p=up.indexOf(xp),_p<0&&(_p=ap.activeIndex-1),sp.slidesPerView==="auto"&&sp.slidesPerGroup===1&&sp.slidesPerGroupAuto&&(_p=_p-ap.slidesPerViewDynamic("previous",!0)+1,_p=Math.max(_p,0))),sp.rewind&&ap.isBeginning){const vp=ap.params.virtual&&ap.params.virtual.enabled&&ap.virtual?ap.virtual.slides.length-1:ap.slides.length-1;return ap.slideTo(vp,rp,_d,np)}else if(sp.loop&&ap.activeIndex===0&&sp.cssMode)return requestAnimationFrame(()=>{ap.slideTo(_p,rp,_d,np)}),!0;return ap.slideTo(_p,rp,_d,np)}function slideReset(rp,_d,np){rp===void 0&&(rp=this.params.speed),_d===void 0&&(_d=!0);const ap=this;return ap.slideTo(ap.activeIndex,rp,_d,np)}function slideToClosest(rp,_d,np,ap){rp===void 0&&(rp=this.params.speed),_d===void 0&&(_d=!0),ap===void 0&&(ap=.5);const sp=this;let lp=sp.activeIndex;const up=Math.min(sp.params.slidesPerGroupSkip,lp),cp=up+Math.floor((lp-up)/sp.params.slidesPerGroup),dp=sp.rtlTranslate?sp.translate:-sp.translate;if(dp>=sp.snapGrid[cp]){const hp=sp.snapGrid[cp],fp=sp.snapGrid[cp+1];dp-hp>(fp-hp)*ap&&(lp+=sp.params.slidesPerGroup)}else{const hp=sp.snapGrid[cp-1],fp=sp.snapGrid[cp];dp-hp<=(fp-hp)*ap&&(lp-=sp.params.slidesPerGroup)}return lp=Math.max(lp,0),lp=Math.min(lp,sp.slidesGrid.length-1),sp.slideTo(lp,rp,_d,np)}function slideToClickedSlide(){const rp=this,{params:_d,slidesEl:np}=rp,ap=_d.slidesPerView==="auto"?rp.slidesPerViewDynamic():_d.slidesPerView;let sp=rp.clickedIndex,lp;const up=rp.isElement?"swiper-slide":`.${_d.slideClass}`;if(_d.loop){if(rp.animating)return;lp=parseInt(rp.clickedSlide.getAttribute("data-swiper-slide-index"),10),_d.centeredSlides?sp<rp.loopedSlides-ap/2||sp>rp.slides.length-rp.loopedSlides+ap/2?(rp.loopFix(),sp=rp.getSlideIndex(elementChildren(np,`${up}[data-swiper-slide-index="${lp}"]`)[0]),nextTick(()=>{rp.slideTo(sp)})):rp.slideTo(sp):sp>rp.slides.length-ap?(rp.loopFix(),sp=rp.getSlideIndex(elementChildren(np,`${up}[data-swiper-slide-index="${lp}"]`)[0]),nextTick(()=>{rp.slideTo(sp)})):rp.slideTo(sp)}else rp.slideTo(sp)}var slide={slideTo,slideToLoop,slideNext,slidePrev,slideReset,slideToClosest,slideToClickedSlide};function loopCreate(rp){const _d=this,{params:np,slidesEl:ap}=_d;if(!np.loop||_d.virtual&&_d.params.virtual.enabled)return;const sp=()=>{elementChildren(ap,`.${np.slideClass}, swiper-slide`).forEach((pp,mp)=>{pp.setAttribute("data-swiper-slide-index",mp)})},lp=_d.grid&&np.grid&&np.grid.rows>1,up=np.slidesPerGroup*(lp?np.grid.rows:1),cp=_d.slides.length%up!==0,dp=lp&&_d.slides.length%np.grid.rows!==0,hp=fp=>{for(let pp=0;pp<fp;pp+=1){const mp=_d.isElement?createElement("swiper-slide",[np.slideBlankClass]):createElement("div",[np.slideClass,np.slideBlankClass]);_d.slidesEl.append(mp)}};if(cp){if(np.loopAddBlankSlides){const fp=up-_d.slides.length%up;hp(fp),_d.recalcSlides(),_d.updateSlides()}else showWarning("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");sp()}else if(dp){if(np.loopAddBlankSlides){const fp=np.grid.rows-_d.slides.length%np.grid.rows;hp(fp),_d.recalcSlides(),_d.updateSlides()}else showWarning("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");sp()}else sp();_d.loopFix({slideRealIndex:rp,direction:np.centeredSlides?void 0:"next"})}function loopFix(rp){let{slideRealIndex:_d,slideTo:np=!0,direction:ap,setTranslate:sp,activeSlideIndex:lp,byController:up,byMousewheel:cp}=rp===void 0?{}:rp;const dp=this;if(!dp.params.loop)return;dp.emit("beforeLoopFix");const{slides:hp,allowSlidePrev:fp,allowSlideNext:pp,slidesEl:mp,params:gp}=dp,{centeredSlides:yp}=gp;if(dp.allowSlidePrev=!0,dp.allowSlideNext=!0,dp.virtual&&gp.virtual.enabled){np&&(!gp.centeredSlides&&dp.snapIndex===0?dp.slideTo(dp.virtual.slides.length,0,!1,!0):gp.centeredSlides&&dp.snapIndex<gp.slidesPerView?dp.slideTo(dp.virtual.slides.length+dp.snapIndex,0,!1,!0):dp.snapIndex===dp.snapGrid.length-1&&dp.slideTo(dp.virtual.slidesBefore,0,!1,!0)),dp.allowSlidePrev=fp,dp.allowSlideNext=pp,dp.emit("loopFix");return}let xp=gp.slidesPerView;xp==="auto"?xp=dp.slidesPerViewDynamic():(xp=Math.ceil(parseFloat(gp.slidesPerView,10)),yp&&xp%2===0&&(xp=xp+1));const _p=gp.slidesPerGroupAuto?xp:gp.slidesPerGroup;let vp=_p;vp%_p!==0&&(vp+=_p-vp%_p),vp+=gp.loopAdditionalSlides,dp.loopedSlides=vp;const bp=dp.grid&&gp.grid&&gp.grid.rows>1;hp.length<xp+vp?showWarning("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):bp&&gp.grid.fill==="row"&&showWarning("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const Ep=[],Sp=[];let Ap=dp.activeIndex;typeof lp>"u"?lp=dp.getSlideIndex(hp.filter(Dp=>Dp.classList.contains(gp.slideActiveClass))[0]):Ap=lp;const Rp=ap==="next"||!ap,Tp=ap==="prev"||!ap;let Mp=0,Op=0;const Pp=bp?Math.ceil(hp.length/gp.grid.rows):hp.length,zp=(bp?hp[lp].column:lp)+(yp&&typeof sp>"u"?-xp/2+.5:0);if(zp<vp){Mp=Math.max(vp-zp,_p);for(let Dp=0;Dp<vp-zp;Dp+=1){const Fp=Dp-Math.floor(Dp/Pp)*Pp;if(bp){const jp=Pp-Fp-1;for(let Lp=hp.length-1;Lp>=0;Lp-=1)hp[Lp].column===jp&&Ep.push(Lp)}else Ep.push(Pp-Fp-1)}}else if(zp+xp>Pp-vp){Op=Math.max(zp-(Pp-vp*2),_p);for(let Dp=0;Dp<Op;Dp+=1){const Fp=Dp-Math.floor(Dp/Pp)*Pp;bp?hp.forEach((jp,Lp)=>{jp.column===Fp&&Sp.push(Lp)}):Sp.push(Fp)}}if(dp.__preventObserver__=!0,requestAnimationFrame(()=>{dp.__preventObserver__=!1}),Tp&&Ep.forEach(Dp=>{hp[Dp].swiperLoopMoveDOM=!0,mp.prepend(hp[Dp]),hp[Dp].swiperLoopMoveDOM=!1}),Rp&&Sp.forEach(Dp=>{hp[Dp].swiperLoopMoveDOM=!0,mp.append(hp[Dp]),hp[Dp].swiperLoopMoveDOM=!1}),dp.recalcSlides(),gp.slidesPerView==="auto"?dp.updateSlides():bp&&(Ep.length>0&&Tp||Sp.length>0&&Rp)&&dp.slides.forEach((Dp,Fp)=>{dp.grid.updateSlide(Fp,Dp,dp.slides)}),gp.watchSlidesProgress&&dp.updateSlidesOffset(),np){if(Ep.length>0&&Tp){if(typeof _d>"u"){const Dp=dp.slidesGrid[Ap],jp=dp.slidesGrid[Ap+Mp]-Dp;cp?dp.setTranslate(dp.translate-jp):(dp.slideTo(Ap+Mp,0,!1,!0),sp&&(dp.touchEventsData.startTranslate=dp.touchEventsData.startTranslate-jp,dp.touchEventsData.currentTranslate=dp.touchEventsData.currentTranslate-jp))}else if(sp){const Dp=bp?Ep.length/gp.grid.rows:Ep.length;dp.slideTo(dp.activeIndex+Dp,0,!1,!0),dp.touchEventsData.currentTranslate=dp.translate}}else if(Sp.length>0&&Rp)if(typeof _d>"u"){const Dp=dp.slidesGrid[Ap],jp=dp.slidesGrid[Ap-Op]-Dp;cp?dp.setTranslate(dp.translate-jp):(dp.slideTo(Ap-Op,0,!1,!0),sp&&(dp.touchEventsData.startTranslate=dp.touchEventsData.startTranslate-jp,dp.touchEventsData.currentTranslate=dp.touchEventsData.currentTranslate-jp))}else{const Dp=bp?Sp.length/gp.grid.rows:Sp.length;dp.slideTo(dp.activeIndex-Dp,0,!1,!0)}}if(dp.allowSlidePrev=fp,dp.allowSlideNext=pp,dp.controller&&dp.controller.control&&!up){const Dp={slideRealIndex:_d,direction:ap,setTranslate:sp,activeSlideIndex:lp,byController:!0};Array.isArray(dp.controller.control)?dp.controller.control.forEach(Fp=>{!Fp.destroyed&&Fp.params.loop&&Fp.loopFix({...Dp,slideTo:Fp.params.slidesPerView===gp.slidesPerView?np:!1})}):dp.controller.control instanceof dp.constructor&&dp.controller.control.params.loop&&dp.controller.control.loopFix({...Dp,slideTo:dp.controller.control.params.slidesPerView===gp.slidesPerView?np:!1})}dp.emit("loopFix")}function loopDestroy(){const rp=this,{params:_d,slidesEl:np}=rp;if(!_d.loop||rp.virtual&&rp.params.virtual.enabled)return;rp.recalcSlides();const ap=[];rp.slides.forEach(sp=>{const lp=typeof sp.swiperSlideIndex>"u"?sp.getAttribute("data-swiper-slide-index")*1:sp.swiperSlideIndex;ap[lp]=sp}),rp.slides.forEach(sp=>{sp.removeAttribute("data-swiper-slide-index")}),ap.forEach(sp=>{np.append(sp)}),rp.recalcSlides(),rp.slideTo(rp.realIndex,0)}var loop={loopCreate,loopFix,loopDestroy};function setGrabCursor(rp){const _d=this;if(!_d.params.simulateTouch||_d.params.watchOverflow&&_d.isLocked||_d.params.cssMode)return;const np=_d.params.touchEventsTarget==="container"?_d.el:_d.wrapperEl;_d.isElement&&(_d.__preventObserver__=!0),np.style.cursor="move",np.style.cursor=rp?"grabbing":"grab",_d.isElement&&requestAnimationFrame(()=>{_d.__preventObserver__=!1})}function unsetGrabCursor(){const rp=this;rp.params.watchOverflow&&rp.isLocked||rp.params.cssMode||(rp.isElement&&(rp.__preventObserver__=!0),rp[rp.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",rp.isElement&&requestAnimationFrame(()=>{rp.__preventObserver__=!1}))}var grabCursor={setGrabCursor,unsetGrabCursor};function closestElement(rp,_d){_d===void 0&&(_d=this);function np(ap){if(!ap||ap===getDocument()||ap===getWindow())return null;ap.assignedSlot&&(ap=ap.assignedSlot);const sp=ap.closest(rp);return!sp&&!ap.getRootNode?null:sp||np(ap.getRootNode().host)}return np(_d)}function preventEdgeSwipe(rp,_d,np){const ap=getWindow(),{params:sp}=rp,lp=sp.edgeSwipeDetection,up=sp.edgeSwipeThreshold;return lp&&(np<=up||np>=ap.innerWidth-up)?lp==="prevent"?(_d.preventDefault(),!0):!1:!0}function onTouchStart(rp){const _d=this,np=getDocument();let ap=rp;ap.originalEvent&&(ap=ap.originalEvent);const sp=_d.touchEventsData;if(ap.type==="pointerdown"){if(sp.pointerId!==null&&sp.pointerId!==ap.pointerId)return;sp.pointerId=ap.pointerId}else ap.type==="touchstart"&&ap.targetTouches.length===1&&(sp.touchId=ap.targetTouches[0].identifier);if(ap.type==="touchstart"){preventEdgeSwipe(_d,ap,ap.targetTouches[0].pageX);return}const{params:lp,touches:up,enabled:cp}=_d;if(!cp||!lp.simulateTouch&&ap.pointerType==="mouse"||_d.animating&&lp.preventInteractionOnTransition)return;!_d.animating&&lp.cssMode&&lp.loop&&_d.loopFix();let dp=ap.target;if(lp.touchEventsTarget==="wrapper"&&!_d.wrapperEl.contains(dp)||"which"in ap&&ap.which===3||"button"in ap&&ap.button>0||sp.isTouched&&sp.isMoved)return;const hp=!!lp.noSwipingClass&&lp.noSwipingClass!=="",fp=ap.composedPath?ap.composedPath():ap.path;hp&&ap.target&&ap.target.shadowRoot&&fp&&(dp=fp[0]);const pp=lp.noSwipingSelector?lp.noSwipingSelector:`.${lp.noSwipingClass}`,mp=!!(ap.target&&ap.target.shadowRoot);if(lp.noSwiping&&(mp?closestElement(pp,dp):dp.closest(pp))){_d.allowClick=!0;return}if(lp.swipeHandler&&!dp.closest(lp.swipeHandler))return;up.currentX=ap.pageX,up.currentY=ap.pageY;const gp=up.currentX,yp=up.currentY;if(!preventEdgeSwipe(_d,ap,gp))return;Object.assign(sp,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),up.startX=gp,up.startY=yp,sp.touchStartTime=now$1(),_d.allowClick=!0,_d.updateSize(),_d.swipeDirection=void 0,lp.threshold>0&&(sp.allowThresholdMove=!1);let xp=!0;dp.matches(sp.focusableElements)&&(xp=!1,dp.nodeName==="SELECT"&&(sp.isTouched=!1)),np.activeElement&&np.activeElement.matches(sp.focusableElements)&&np.activeElement!==dp&&np.activeElement.blur();const _p=xp&&_d.allowTouchMove&&lp.touchStartPreventDefault;(lp.touchStartForcePreventDefault||_p)&&!dp.isContentEditable&&ap.preventDefault(),lp.freeMode&&lp.freeMode.enabled&&_d.freeMode&&_d.animating&&!lp.cssMode&&_d.freeMode.onTouchStart(),_d.emit("touchStart",ap)}function onTouchMove(rp){const _d=getDocument(),np=this,ap=np.touchEventsData,{params:sp,touches:lp,rtlTranslate:up,enabled:cp}=np;if(!cp||!sp.simulateTouch&&rp.pointerType==="mouse")return;let dp=rp;if(dp.originalEvent&&(dp=dp.originalEvent),dp.type==="pointermove"&&(ap.touchId!==null||dp.pointerId!==ap.pointerId))return;let hp;if(dp.type==="touchmove"){if(hp=[...dp.changedTouches].filter(Rp=>Rp.identifier===ap.touchId)[0],!hp||hp.identifier!==ap.touchId)return}else hp=dp;if(!ap.isTouched){ap.startMoving&&ap.isScrolling&&np.emit("touchMoveOpposite",dp);return}const fp=hp.pageX,pp=hp.pageY;if(dp.preventedByNestedSwiper){lp.startX=fp,lp.startY=pp;return}if(!np.allowTouchMove){dp.target.matches(ap.focusableElements)||(np.allowClick=!1),ap.isTouched&&(Object.assign(lp,{startX:fp,startY:pp,currentX:fp,currentY:pp}),ap.touchStartTime=now$1());return}if(sp.touchReleaseOnEdges&&!sp.loop){if(np.isVertical()){if(pp<lp.startY&&np.translate<=np.maxTranslate()||pp>lp.startY&&np.translate>=np.minTranslate()){ap.isTouched=!1,ap.isMoved=!1;return}}else if(fp<lp.startX&&np.translate<=np.maxTranslate()||fp>lp.startX&&np.translate>=np.minTranslate())return}if(_d.activeElement&&dp.target===_d.activeElement&&dp.target.matches(ap.focusableElements)){ap.isMoved=!0,np.allowClick=!1;return}ap.allowTouchCallbacks&&np.emit("touchMove",dp),lp.previousX=lp.currentX,lp.previousY=lp.currentY,lp.currentX=fp,lp.currentY=pp;const mp=lp.currentX-lp.startX,gp=lp.currentY-lp.startY;if(np.params.threshold&&Math.sqrt(mp**2+gp**2)<np.params.threshold)return;if(typeof ap.isScrolling>"u"){let Rp;np.isHorizontal()&&lp.currentY===lp.startY||np.isVertical()&&lp.currentX===lp.startX?ap.isScrolling=!1:mp*mp+gp*gp>=25&&(Rp=Math.atan2(Math.abs(gp),Math.abs(mp))*180/Math.PI,ap.isScrolling=np.isHorizontal()?Rp>sp.touchAngle:90-Rp>sp.touchAngle)}if(ap.isScrolling&&np.emit("touchMoveOpposite",dp),typeof ap.startMoving>"u"&&(lp.currentX!==lp.startX||lp.currentY!==lp.startY)&&(ap.startMoving=!0),ap.isScrolling){ap.isTouched=!1;return}if(!ap.startMoving)return;np.allowClick=!1,!sp.cssMode&&dp.cancelable&&dp.preventDefault(),sp.touchMoveStopPropagation&&!sp.nested&&dp.stopPropagation();let yp=np.isHorizontal()?mp:gp,xp=np.isHorizontal()?lp.currentX-lp.previousX:lp.currentY-lp.previousY;sp.oneWayMovement&&(yp=Math.abs(yp)*(up?1:-1),xp=Math.abs(xp)*(up?1:-1)),lp.diff=yp,yp*=sp.touchRatio,up&&(yp=-yp,xp=-xp);const _p=np.touchesDirection;np.swipeDirection=yp>0?"prev":"next",np.touchesDirection=xp>0?"prev":"next";const vp=np.params.loop&&!sp.cssMode,bp=np.touchesDirection==="next"&&np.allowSlideNext||np.touchesDirection==="prev"&&np.allowSlidePrev;if(!ap.isMoved){if(vp&&bp&&np.loopFix({direction:np.swipeDirection}),ap.startTranslate=np.getTranslate(),np.setTransition(0),np.animating){const Rp=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});np.wrapperEl.dispatchEvent(Rp)}ap.allowMomentumBounce=!1,sp.grabCursor&&(np.allowSlideNext===!0||np.allowSlidePrev===!0)&&np.setGrabCursor(!0),np.emit("sliderFirstMove",dp)}let Ep;if(new Date().getTime(),ap.isMoved&&ap.allowThresholdMove&&_p!==np.touchesDirection&&vp&&bp&&Math.abs(yp)>=1){Object.assign(lp,{startX:fp,startY:pp,currentX:fp,currentY:pp,startTranslate:ap.currentTranslate}),ap.loopSwapReset=!0,ap.startTranslate=ap.currentTranslate;return}np.emit("sliderMove",dp),ap.isMoved=!0,ap.currentTranslate=yp+ap.startTranslate;let Sp=!0,Ap=sp.resistanceRatio;if(sp.touchReleaseOnEdges&&(Ap=0),yp>0?(vp&&bp&&!Ep&&ap.allowThresholdMove&&ap.currentTranslate>(sp.centeredSlides?np.minTranslate()-np.slidesSizesGrid[np.activeIndex+1]:np.minTranslate())&&np.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),ap.currentTranslate>np.minTranslate()&&(Sp=!1,sp.resistance&&(ap.currentTranslate=np.minTranslate()-1+(-np.minTranslate()+ap.startTranslate+yp)**Ap))):yp<0&&(vp&&bp&&!Ep&&ap.allowThresholdMove&&ap.currentTranslate<(sp.centeredSlides?np.maxTranslate()+np.slidesSizesGrid[np.slidesSizesGrid.length-1]:np.maxTranslate())&&np.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:np.slides.length-(sp.slidesPerView==="auto"?np.slidesPerViewDynamic():Math.ceil(parseFloat(sp.slidesPerView,10)))}),ap.currentTranslate<np.maxTranslate()&&(Sp=!1,sp.resistance&&(ap.currentTranslate=np.maxTranslate()+1-(np.maxTranslate()-ap.startTranslate-yp)**Ap))),Sp&&(dp.preventedByNestedSwiper=!0),!np.allowSlideNext&&np.swipeDirection==="next"&&ap.currentTranslate<ap.startTranslate&&(ap.currentTranslate=ap.startTranslate),!np.allowSlidePrev&&np.swipeDirection==="prev"&&ap.currentTranslate>ap.startTranslate&&(ap.currentTranslate=ap.startTranslate),!np.allowSlidePrev&&!np.allowSlideNext&&(ap.currentTranslate=ap.startTranslate),sp.threshold>0)if(Math.abs(yp)>sp.threshold||ap.allowThresholdMove){if(!ap.allowThresholdMove){ap.allowThresholdMove=!0,lp.startX=lp.currentX,lp.startY=lp.currentY,ap.currentTranslate=ap.startTranslate,lp.diff=np.isHorizontal()?lp.currentX-lp.startX:lp.currentY-lp.startY;return}}else{ap.currentTranslate=ap.startTranslate;return}!sp.followFinger||sp.cssMode||((sp.freeMode&&sp.freeMode.enabled&&np.freeMode||sp.watchSlidesProgress)&&(np.updateActiveIndex(),np.updateSlidesClasses()),sp.freeMode&&sp.freeMode.enabled&&np.freeMode&&np.freeMode.onTouchMove(),np.updateProgress(ap.currentTranslate),np.setTranslate(ap.currentTranslate))}function onTouchEnd(rp){const _d=this,np=_d.touchEventsData;let ap=rp;ap.originalEvent&&(ap=ap.originalEvent);let sp;if(ap.type==="touchend"||ap.type==="touchcancel"){if(sp=[...ap.changedTouches].filter(Ap=>Ap.identifier===np.touchId)[0],!sp||sp.identifier!==np.touchId)return}else{if(np.touchId!==null||ap.pointerId!==np.pointerId)return;sp=ap}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(ap.type)&&!(["pointercancel","contextmenu"].includes(ap.type)&&(_d.browser.isSafari||_d.browser.isWebView)))return;np.pointerId=null,np.touchId=null;const{params:up,touches:cp,rtlTranslate:dp,slidesGrid:hp,enabled:fp}=_d;if(!fp||!up.simulateTouch&&ap.pointerType==="mouse")return;if(np.allowTouchCallbacks&&_d.emit("touchEnd",ap),np.allowTouchCallbacks=!1,!np.isTouched){np.isMoved&&up.grabCursor&&_d.setGrabCursor(!1),np.isMoved=!1,np.startMoving=!1;return}up.grabCursor&&np.isMoved&&np.isTouched&&(_d.allowSlideNext===!0||_d.allowSlidePrev===!0)&&_d.setGrabCursor(!1);const pp=now$1(),mp=pp-np.touchStartTime;if(_d.allowClick){const Ap=ap.path||ap.composedPath&&ap.composedPath();_d.updateClickedSlide(Ap&&Ap[0]||ap.target,Ap),_d.emit("tap click",ap),mp<300&&pp-np.lastClickTime<300&&_d.emit("doubleTap doubleClick",ap)}if(np.lastClickTime=now$1(),nextTick(()=>{_d.destroyed||(_d.allowClick=!0)}),!np.isTouched||!np.isMoved||!_d.swipeDirection||cp.diff===0&&!np.loopSwapReset||np.currentTranslate===np.startTranslate&&!np.loopSwapReset){np.isTouched=!1,np.isMoved=!1,np.startMoving=!1;return}np.isTouched=!1,np.isMoved=!1,np.startMoving=!1;let gp;if(up.followFinger?gp=dp?_d.translate:-_d.translate:gp=-np.currentTranslate,up.cssMode)return;if(up.freeMode&&up.freeMode.enabled){_d.freeMode.onTouchEnd({currentPos:gp});return}const yp=gp>=-_d.maxTranslate()&&!_d.params.loop;let xp=0,_p=_d.slidesSizesGrid[0];for(let Ap=0;Ap<hp.length;Ap+=Ap<up.slidesPerGroupSkip?1:up.slidesPerGroup){const Rp=Ap<up.slidesPerGroupSkip-1?1:up.slidesPerGroup;typeof hp[Ap+Rp]<"u"?(yp||gp>=hp[Ap]&&gp<hp[Ap+Rp])&&(xp=Ap,_p=hp[Ap+Rp]-hp[Ap]):(yp||gp>=hp[Ap])&&(xp=Ap,_p=hp[hp.length-1]-hp[hp.length-2])}let vp=null,bp=null;up.rewind&&(_d.isBeginning?bp=up.virtual&&up.virtual.enabled&&_d.virtual?_d.virtual.slides.length-1:_d.slides.length-1:_d.isEnd&&(vp=0));const Ep=(gp-hp[xp])/_p,Sp=xp<up.slidesPerGroupSkip-1?1:up.slidesPerGroup;if(mp>up.longSwipesMs){if(!up.longSwipes){_d.slideTo(_d.activeIndex);return}_d.swipeDirection==="next"&&(Ep>=up.longSwipesRatio?_d.slideTo(up.rewind&&_d.isEnd?vp:xp+Sp):_d.slideTo(xp)),_d.swipeDirection==="prev"&&(Ep>1-up.longSwipesRatio?_d.slideTo(xp+Sp):bp!==null&&Ep<0&&Math.abs(Ep)>up.longSwipesRatio?_d.slideTo(bp):_d.slideTo(xp))}else{if(!up.shortSwipes){_d.slideTo(_d.activeIndex);return}_d.navigation&&(ap.target===_d.navigation.nextEl||ap.target===_d.navigation.prevEl)?ap.target===_d.navigation.nextEl?_d.slideTo(xp+Sp):_d.slideTo(xp):(_d.swipeDirection==="next"&&_d.slideTo(vp!==null?vp:xp+Sp),_d.swipeDirection==="prev"&&_d.slideTo(bp!==null?bp:xp))}}function onResize(){const rp=this,{params:_d,el:np}=rp;if(np&&np.offsetWidth===0)return;_d.breakpoints&&rp.setBreakpoint();const{allowSlideNext:ap,allowSlidePrev:sp,snapGrid:lp}=rp,up=rp.virtual&&rp.params.virtual.enabled;rp.allowSlideNext=!0,rp.allowSlidePrev=!0,rp.updateSize(),rp.updateSlides(),rp.updateSlidesClasses();const cp=up&&_d.loop;(_d.slidesPerView==="auto"||_d.slidesPerView>1)&&rp.isEnd&&!rp.isBeginning&&!rp.params.centeredSlides&&!cp?rp.slideTo(rp.slides.length-1,0,!1,!0):rp.params.loop&&!up?rp.slideToLoop(rp.realIndex,0,!1,!0):rp.slideTo(rp.activeIndex,0,!1,!0),rp.autoplay&&rp.autoplay.running&&rp.autoplay.paused&&(clearTimeout(rp.autoplay.resizeTimeout),rp.autoplay.resizeTimeout=setTimeout(()=>{rp.autoplay&&rp.autoplay.running&&rp.autoplay.paused&&rp.autoplay.resume()},500)),rp.allowSlidePrev=sp,rp.allowSlideNext=ap,rp.params.watchOverflow&&lp!==rp.snapGrid&&rp.checkOverflow()}function onClick(rp){const _d=this;_d.enabled&&(_d.allowClick||(_d.params.preventClicks&&rp.preventDefault(),_d.params.preventClicksPropagation&&_d.animating&&(rp.stopPropagation(),rp.stopImmediatePropagation())))}function onScroll(){const rp=this,{wrapperEl:_d,rtlTranslate:np,enabled:ap}=rp;if(!ap)return;rp.previousTranslate=rp.translate,rp.isHorizontal()?rp.translate=-_d.scrollLeft:rp.translate=-_d.scrollTop,rp.translate===0&&(rp.translate=0),rp.updateActiveIndex(),rp.updateSlidesClasses();let sp;const lp=rp.maxTranslate()-rp.minTranslate();lp===0?sp=0:sp=(rp.translate-rp.minTranslate())/lp,sp!==rp.progress&&rp.updateProgress(np?-rp.translate:rp.translate),rp.emit("setTranslate",rp.translate,!1)}function onLoad(rp){const _d=this;processLazyPreloader(_d,rp.target),!(_d.params.cssMode||_d.params.slidesPerView!=="auto"&&!_d.params.autoHeight)&&_d.update()}function onDocumentTouchStart(){const rp=this;rp.documentTouchHandlerProceeded||(rp.documentTouchHandlerProceeded=!0,rp.params.touchReleaseOnEdges&&(rp.el.style.touchAction="auto"))}const events$2=(rp,_d)=>{const np=getDocument(),{params:ap,el:sp,wrapperEl:lp,device:up}=rp,cp=!!ap.nested,dp=_d==="on"?"addEventListener":"removeEventListener",hp=_d;np[dp]("touchstart",rp.onDocumentTouchStart,{passive:!1,capture:cp}),sp[dp]("touchstart",rp.onTouchStart,{passive:!1}),sp[dp]("pointerdown",rp.onTouchStart,{passive:!1}),np[dp]("touchmove",rp.onTouchMove,{passive:!1,capture:cp}),np[dp]("pointermove",rp.onTouchMove,{passive:!1,capture:cp}),np[dp]("touchend",rp.onTouchEnd,{passive:!0}),np[dp]("pointerup",rp.onTouchEnd,{passive:!0}),np[dp]("pointercancel",rp.onTouchEnd,{passive:!0}),np[dp]("touchcancel",rp.onTouchEnd,{passive:!0}),np[dp]("pointerout",rp.onTouchEnd,{passive:!0}),np[dp]("pointerleave",rp.onTouchEnd,{passive:!0}),np[dp]("contextmenu",rp.onTouchEnd,{passive:!0}),(ap.preventClicks||ap.preventClicksPropagation)&&sp[dp]("click",rp.onClick,!0),ap.cssMode&&lp[dp]("scroll",rp.onScroll),ap.updateOnWindowResize?rp[hp](up.ios||up.android?"resize orientationchange observerUpdate":"resize observerUpdate",onResize,!0):rp[hp]("observerUpdate",onResize,!0),sp[dp]("load",rp.onLoad,{capture:!0})};function attachEvents(){const rp=this,{params:_d}=rp;rp.onTouchStart=onTouchStart.bind(rp),rp.onTouchMove=onTouchMove.bind(rp),rp.onTouchEnd=onTouchEnd.bind(rp),rp.onDocumentTouchStart=onDocumentTouchStart.bind(rp),_d.cssMode&&(rp.onScroll=onScroll.bind(rp)),rp.onClick=onClick.bind(rp),rp.onLoad=onLoad.bind(rp),events$2(rp,"on")}function detachEvents(){events$2(this,"off")}var events$1$1={attachEvents,detachEvents};const isGridEnabled=(rp,_d)=>rp.grid&&_d.grid&&_d.grid.rows>1;function setBreakpoint(){const rp=this,{realIndex:_d,initialized:np,params:ap,el:sp}=rp,lp=ap.breakpoints;if(!lp||lp&&Object.keys(lp).length===0)return;const up=rp.getBreakpoint(lp,rp.params.breakpointsBase,rp.el);if(!up||rp.currentBreakpoint===up)return;const dp=(up in lp?lp[up]:void 0)||rp.originalParams,hp=isGridEnabled(rp,ap),fp=isGridEnabled(rp,dp),pp=ap.enabled;hp&&!fp?(sp.classList.remove(`${ap.containerModifierClass}grid`,`${ap.containerModifierClass}grid-column`),rp.emitContainerClasses()):!hp&&fp&&(sp.classList.add(`${ap.containerModifierClass}grid`),(dp.grid.fill&&dp.grid.fill==="column"||!dp.grid.fill&&ap.grid.fill==="column")&&sp.classList.add(`${ap.containerModifierClass}grid-column`),rp.emitContainerClasses()),["navigation","pagination","scrollbar"].forEach(vp=>{if(typeof dp[vp]>"u")return;const bp=ap[vp]&&ap[vp].enabled,Ep=dp[vp]&&dp[vp].enabled;bp&&!Ep&&rp[vp].disable(),!bp&&Ep&&rp[vp].enable()});const mp=dp.direction&&dp.direction!==ap.direction,gp=ap.loop&&(dp.slidesPerView!==ap.slidesPerView||mp),yp=ap.loop;mp&&np&&rp.changeDirection(),extend$3(rp.params,dp);const xp=rp.params.enabled,_p=rp.params.loop;Object.assign(rp,{allowTouchMove:rp.params.allowTouchMove,allowSlideNext:rp.params.allowSlideNext,allowSlidePrev:rp.params.allowSlidePrev}),pp&&!xp?rp.disable():!pp&&xp&&rp.enable(),rp.currentBreakpoint=up,rp.emit("_beforeBreakpoint",dp),np&&(gp?(rp.loopDestroy(),rp.loopCreate(_d),rp.updateSlides()):!yp&&_p?(rp.loopCreate(_d),rp.updateSlides()):yp&&!_p&&rp.loopDestroy()),rp.emit("breakpoint",dp)}function getBreakpoint(rp,_d,np){if(_d===void 0&&(_d="window"),!rp||_d==="container"&&!np)return;let ap=!1;const sp=getWindow(),lp=_d==="window"?sp.innerHeight:np.clientHeight,up=Object.keys(rp).map(cp=>{if(typeof cp=="string"&&cp.indexOf("@")===0){const dp=parseFloat(cp.substr(1));return{value:lp*dp,point:cp}}return{value:cp,point:cp}});up.sort((cp,dp)=>parseInt(cp.value,10)-parseInt(dp.value,10));for(let cp=0;cp<up.length;cp+=1){const{point:dp,value:hp}=up[cp];_d==="window"?sp.matchMedia(`(min-width: ${hp}px)`).matches&&(ap=dp):hp<=np.clientWidth&&(ap=dp)}return ap||"max"}var breakpoints={setBreakpoint,getBreakpoint};function prepareClasses(rp,_d){const np=[];return rp.forEach(ap=>{typeof ap=="object"?Object.keys(ap).forEach(sp=>{ap[sp]&&np.push(_d+sp)}):typeof ap=="string"&&np.push(_d+ap)}),np}function addClasses(){const rp=this,{classNames:_d,params:np,rtl:ap,el:sp,device:lp}=rp,up=prepareClasses(["initialized",np.direction,{"free-mode":rp.params.freeMode&&np.freeMode.enabled},{autoheight:np.autoHeight},{rtl:ap},{grid:np.grid&&np.grid.rows>1},{"grid-column":np.grid&&np.grid.rows>1&&np.grid.fill==="column"},{android:lp.android},{ios:lp.ios},{"css-mode":np.cssMode},{centered:np.cssMode&&np.centeredSlides},{"watch-progress":np.watchSlidesProgress}],np.containerModifierClass);_d.push(...up),sp.classList.add(..._d),rp.emitContainerClasses()}function removeClasses(){const rp=this,{el:_d,classNames:np}=rp;_d.classList.remove(...np),rp.emitContainerClasses()}var classes={addClasses,removeClasses};function checkOverflow(){const rp=this,{isLocked:_d,params:np}=rp,{slidesOffsetBefore:ap}=np;if(ap){const sp=rp.slides.length-1,lp=rp.slidesGrid[sp]+rp.slidesSizesGrid[sp]+ap*2;rp.isLocked=rp.size>lp}else rp.isLocked=rp.snapGrid.length===1;np.allowSlideNext===!0&&(rp.allowSlideNext=!rp.isLocked),np.allowSlidePrev===!0&&(rp.allowSlidePrev=!rp.isLocked),_d&&_d!==rp.isLocked&&(rp.isEnd=!1),_d!==rp.isLocked&&rp.emit(rp.isLocked?"lock":"unlock")}var checkOverflow$1={checkOverflow},defaults$2={init:!0,direction:"horizontal",oneWayMovement:!1,touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function moduleExtendParams(rp,_d){return function(ap){ap===void 0&&(ap={});const sp=Object.keys(ap)[0],lp=ap[sp];if(typeof lp!="object"||lp===null){extend$3(_d,ap);return}if(rp[sp]===!0&&(rp[sp]={enabled:!0}),sp==="navigation"&&rp[sp]&&rp[sp].enabled&&!rp[sp].prevEl&&!rp[sp].nextEl&&(rp[sp].auto=!0),["pagination","scrollbar"].indexOf(sp)>=0&&rp[sp]&&rp[sp].enabled&&!rp[sp].el&&(rp[sp].auto=!0),!(sp in rp&&"enabled"in lp)){extend$3(_d,ap);return}typeof rp[sp]=="object"&&!("enabled"in rp[sp])&&(rp[sp].enabled=!0),rp[sp]||(rp[sp]={enabled:!1}),extend$3(_d,ap)}}const prototypes={eventsEmitter,update,translate,transition,slide,loop,grabCursor,events:events$1$1,breakpoints,checkOverflow:checkOverflow$1,classes},extendedDefaults={};let Swiper$1=class Fy{constructor(){let _d,np;for(var ap=arguments.length,sp=new Array(ap),lp=0;lp<ap;lp++)sp[lp]=arguments[lp];sp.length===1&&sp[0].constructor&&Object.prototype.toString.call(sp[0]).slice(8,-1)==="Object"?np=sp[0]:[_d,np]=sp,np||(np={}),np=extend$3({},np),_d&&!np.el&&(np.el=_d);const up=getDocument();if(np.el&&typeof np.el=="string"&&up.querySelectorAll(np.el).length>1){const fp=[];return up.querySelectorAll(np.el).forEach(pp=>{const mp=extend$3({},np,{el:pp});fp.push(new Fy(mp))}),fp}const cp=this;cp.__swiper__=!0,cp.support=getSupport(),cp.device=getDevice({userAgent:np.userAgent}),cp.browser=getBrowser(),cp.eventsListeners={},cp.eventsAnyListeners=[],cp.modules=[...cp.__modules__],np.modules&&Array.isArray(np.modules)&&cp.modules.push(...np.modules);const dp={};cp.modules.forEach(fp=>{fp({params:np,swiper:cp,extendParams:moduleExtendParams(np,dp),on:cp.on.bind(cp),once:cp.once.bind(cp),off:cp.off.bind(cp),emit:cp.emit.bind(cp)})});const hp=extend$3({},defaults$2,dp);return cp.params=extend$3({},hp,extendedDefaults,np),cp.originalParams=extend$3({},cp.params),cp.passedParams=extend$3({},np),cp.params&&cp.params.on&&Object.keys(cp.params.on).forEach(fp=>{cp.on(fp,cp.params.on[fp])}),cp.params&&cp.params.onAny&&cp.onAny(cp.params.onAny),Object.assign(cp,{enabled:cp.params.enabled,el:_d,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return cp.params.direction==="horizontal"},isVertical(){return cp.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:cp.params.allowSlideNext,allowSlidePrev:cp.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:cp.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:cp.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),cp.emit("_swiper"),cp.params.init&&cp.init(),cp}getDirectionLabel(_d){return this.isHorizontal()?_d:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[_d]}getSlideIndex(_d){const{slidesEl:np,params:ap}=this,sp=elementChildren(np,`.${ap.slideClass}, swiper-slide`),lp=elementIndex(sp[0]);return elementIndex(_d)-lp}getSlideIndexByData(_d){return this.getSlideIndex(this.slides.filter(np=>np.getAttribute("data-swiper-slide-index")*1===_d)[0])}recalcSlides(){const _d=this,{slidesEl:np,params:ap}=_d;_d.slides=elementChildren(np,`.${ap.slideClass}, swiper-slide`)}enable(){const _d=this;_d.enabled||(_d.enabled=!0,_d.params.grabCursor&&_d.setGrabCursor(),_d.emit("enable"))}disable(){const _d=this;_d.enabled&&(_d.enabled=!1,_d.params.grabCursor&&_d.unsetGrabCursor(),_d.emit("disable"))}setProgress(_d,np){const ap=this;_d=Math.min(Math.max(_d,0),1);const sp=ap.minTranslate(),up=(ap.maxTranslate()-sp)*_d+sp;ap.translateTo(up,typeof np>"u"?0:np),ap.updateActiveIndex(),ap.updateSlidesClasses()}emitContainerClasses(){const _d=this;if(!_d.params._emitClasses||!_d.el)return;const np=_d.el.className.split(" ").filter(ap=>ap.indexOf("swiper")===0||ap.indexOf(_d.params.containerModifierClass)===0);_d.emit("_containerClasses",np.join(" "))}getSlideClasses(_d){const np=this;return np.destroyed?"":_d.className.split(" ").filter(ap=>ap.indexOf("swiper-slide")===0||ap.indexOf(np.params.slideClass)===0).join(" ")}emitSlidesClasses(){const _d=this;if(!_d.params._emitClasses||!_d.el)return;const np=[];_d.slides.forEach(ap=>{const sp=_d.getSlideClasses(ap);np.push({slideEl:ap,classNames:sp}),_d.emit("_slideClass",ap,sp)}),_d.emit("_slideClasses",np)}slidesPerViewDynamic(_d,np){_d===void 0&&(_d="current"),np===void 0&&(np=!1);const ap=this,{params:sp,slides:lp,slidesGrid:up,slidesSizesGrid:cp,size:dp,activeIndex:hp}=ap;let fp=1;if(typeof sp.slidesPerView=="number")return sp.slidesPerView;if(sp.centeredSlides){let pp=lp[hp]?lp[hp].swiperSlideSize:0,mp;for(let gp=hp+1;gp<lp.length;gp+=1)lp[gp]&&!mp&&(pp+=lp[gp].swiperSlideSize,fp+=1,pp>dp&&(mp=!0));for(let gp=hp-1;gp>=0;gp-=1)lp[gp]&&!mp&&(pp+=lp[gp].swiperSlideSize,fp+=1,pp>dp&&(mp=!0))}else if(_d==="current")for(let pp=hp+1;pp<lp.length;pp+=1)(np?up[pp]+cp[pp]-up[hp]<dp:up[pp]-up[hp]<dp)&&(fp+=1);else for(let pp=hp-1;pp>=0;pp-=1)up[hp]-up[pp]<dp&&(fp+=1);return fp}update(){const _d=this;if(!_d||_d.destroyed)return;const{snapGrid:np,params:ap}=_d;ap.breakpoints&&_d.setBreakpoint(),[..._d.el.querySelectorAll('[loading="lazy"]')].forEach(up=>{up.complete&&processLazyPreloader(_d,up)}),_d.updateSize(),_d.updateSlides(),_d.updateProgress(),_d.updateSlidesClasses();function sp(){const up=_d.rtlTranslate?_d.translate*-1:_d.translate,cp=Math.min(Math.max(up,_d.maxTranslate()),_d.minTranslate());_d.setTranslate(cp),_d.updateActiveIndex(),_d.updateSlidesClasses()}let lp;if(ap.freeMode&&ap.freeMode.enabled&&!ap.cssMode)sp(),ap.autoHeight&&_d.updateAutoHeight();else{if((ap.slidesPerView==="auto"||ap.slidesPerView>1)&&_d.isEnd&&!ap.centeredSlides){const up=_d.virtual&&ap.virtual.enabled?_d.virtual.slides:_d.slides;lp=_d.slideTo(up.length-1,0,!1,!0)}else lp=_d.slideTo(_d.activeIndex,0,!1,!0);lp||sp()}ap.watchOverflow&&np!==_d.snapGrid&&_d.checkOverflow(),_d.emit("update")}changeDirection(_d,np){np===void 0&&(np=!0);const ap=this,sp=ap.params.direction;return _d||(_d=sp==="horizontal"?"vertical":"horizontal"),_d===sp||_d!=="horizontal"&&_d!=="vertical"||(ap.el.classList.remove(`${ap.params.containerModifierClass}${sp}`),ap.el.classList.add(`${ap.params.containerModifierClass}${_d}`),ap.emitContainerClasses(),ap.params.direction=_d,ap.slides.forEach(lp=>{_d==="vertical"?lp.style.width="":lp.style.height=""}),ap.emit("changeDirection"),np&&ap.update()),ap}changeLanguageDirection(_d){const np=this;np.rtl&&_d==="rtl"||!np.rtl&&_d==="ltr"||(np.rtl=_d==="rtl",np.rtlTranslate=np.params.direction==="horizontal"&&np.rtl,np.rtl?(np.el.classList.add(`${np.params.containerModifierClass}rtl`),np.el.dir="rtl"):(np.el.classList.remove(`${np.params.containerModifierClass}rtl`),np.el.dir="ltr"),np.update())}mount(_d){const np=this;if(np.mounted)return!0;let ap=_d||np.params.el;if(typeof ap=="string"&&(ap=document.querySelector(ap)),!ap)return!1;ap.swiper=np,ap.parentNode&&ap.parentNode.host&&ap.parentNode.host.nodeName==="SWIPER-CONTAINER"&&(np.isElement=!0);const sp=()=>`.${(np.params.wrapperClass||"").trim().split(" ").join(".")}`;let up=ap&&ap.shadowRoot&&ap.shadowRoot.querySelector?ap.shadowRoot.querySelector(sp()):elementChildren(ap,sp())[0];return!up&&np.params.createElements&&(up=createElement("div",np.params.wrapperClass),ap.append(up),elementChildren(ap,`.${np.params.slideClass}`).forEach(cp=>{up.append(cp)})),Object.assign(np,{el:ap,wrapperEl:up,slidesEl:np.isElement&&!ap.parentNode.host.slideSlots?ap.parentNode.host:up,hostEl:np.isElement?ap.parentNode.host:ap,mounted:!0,rtl:ap.dir.toLowerCase()==="rtl"||elementStyle(ap,"direction")==="rtl",rtlTranslate:np.params.direction==="horizontal"&&(ap.dir.toLowerCase()==="rtl"||elementStyle(ap,"direction")==="rtl"),wrongRTL:elementStyle(up,"display")==="-webkit-box"}),!0}init(_d){const np=this;if(np.initialized||np.mount(_d)===!1)return np;np.emit("beforeInit"),np.params.breakpoints&&np.setBreakpoint(),np.addClasses(),np.updateSize(),np.updateSlides(),np.params.watchOverflow&&np.checkOverflow(),np.params.grabCursor&&np.enabled&&np.setGrabCursor(),np.params.loop&&np.virtual&&np.params.virtual.enabled?np.slideTo(np.params.initialSlide+np.virtual.slidesBefore,0,np.params.runCallbacksOnInit,!1,!0):np.slideTo(np.params.initialSlide,0,np.params.runCallbacksOnInit,!1,!0),np.params.loop&&np.loopCreate(),np.attachEvents();const sp=[...np.el.querySelectorAll('[loading="lazy"]')];return np.isElement&&sp.push(...np.hostEl.querySelectorAll('[loading="lazy"]')),sp.forEach(lp=>{lp.complete?processLazyPreloader(np,lp):lp.addEventListener("load",up=>{processLazyPreloader(np,up.target)})}),preload$1(np),np.initialized=!0,preload$1(np),np.emit("init"),np.emit("afterInit"),np}destroy(_d,np){_d===void 0&&(_d=!0),np===void 0&&(np=!0);const ap=this,{params:sp,el:lp,wrapperEl:up,slides:cp}=ap;return typeof ap.params>"u"||ap.destroyed||(ap.emit("beforeDestroy"),ap.initialized=!1,ap.detachEvents(),sp.loop&&ap.loopDestroy(),np&&(ap.removeClasses(),lp.removeAttribute("style"),up.removeAttribute("style"),cp&&cp.length&&cp.forEach(dp=>{dp.classList.remove(sp.slideVisibleClass,sp.slideFullyVisibleClass,sp.slideActiveClass,sp.slideNextClass,sp.slidePrevClass),dp.removeAttribute("style"),dp.removeAttribute("data-swiper-slide-index")})),ap.emit("destroy"),Object.keys(ap.eventsListeners).forEach(dp=>{ap.off(dp)}),_d!==!1&&(ap.el.swiper=null,deleteProps(ap)),ap.destroyed=!0),null}static extendDefaults(_d){extend$3(extendedDefaults,_d)}static get extendedDefaults(){return extendedDefaults}static get defaults(){return defaults$2}static installModule(_d){Fy.prototype.__modules__||(Fy.prototype.__modules__=[]);const np=Fy.prototype.__modules__;typeof _d=="function"&&np.indexOf(_d)<0&&np.push(_d)}static use(_d){return Array.isArray(_d)?(_d.forEach(np=>Fy.installModule(np)),Fy):(Fy.installModule(_d),Fy)}};Object.keys(prototypes).forEach(rp=>{Object.keys(prototypes[rp]).forEach(_d=>{Swiper$1.prototype[_d]=prototypes[rp][_d]})});Swiper$1.use([Resize,Observer]);const paramsList=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function isObject$6(rp){return typeof rp=="object"&&rp!==null&&rp.constructor&&Object.prototype.toString.call(rp).slice(8,-1)==="Object"&&!rp.__swiper__}function extend$2(rp,_d){const np=["__proto__","constructor","prototype"];Object.keys(_d).filter(ap=>np.indexOf(ap)<0).forEach(ap=>{typeof rp[ap]>"u"?rp[ap]=_d[ap]:isObject$6(_d[ap])&&isObject$6(rp[ap])&&Object.keys(_d[ap]).length>0?_d[ap].__swiper__?rp[ap]=_d[ap]:extend$2(rp[ap],_d[ap]):rp[ap]=_d[ap]})}function needsNavigation(rp){return rp===void 0&&(rp={}),rp.navigation&&typeof rp.navigation.nextEl>"u"&&typeof rp.navigation.prevEl>"u"}function needsPagination(rp){return rp===void 0&&(rp={}),rp.pagination&&typeof rp.pagination.el>"u"}function needsScrollbar(rp){return rp===void 0&&(rp={}),rp.scrollbar&&typeof rp.scrollbar.el>"u"}function uniqueClasses(rp){rp===void 0&&(rp="");const _d=rp.split(" ").map(ap=>ap.trim()).filter(ap=>!!ap),np=[];return _d.forEach(ap=>{np.indexOf(ap)<0&&np.push(ap)}),np.join(" ")}function wrapperClass(rp){return rp===void 0&&(rp=""),rp?rp.includes("swiper-wrapper")?rp:`swiper-wrapper ${rp}`:"swiper-wrapper"}function updateSwiper(rp){let{swiper:_d,slides:np,passedParams:ap,changedParams:sp,nextEl:lp,prevEl:up,scrollbarEl:cp,paginationEl:dp}=rp;const hp=sp.filter(Op=>Op!=="children"&&Op!=="direction"&&Op!=="wrapperClass"),{params:fp,pagination:pp,navigation:mp,scrollbar:gp,virtual:yp,thumbs:xp}=_d;let _p,vp,bp,Ep,Sp,Ap,Rp,Tp;sp.includes("thumbs")&&ap.thumbs&&ap.thumbs.swiper&&fp.thumbs&&!fp.thumbs.swiper&&(_p=!0),sp.includes("controller")&&ap.controller&&ap.controller.control&&fp.controller&&!fp.controller.control&&(vp=!0),sp.includes("pagination")&&ap.pagination&&(ap.pagination.el||dp)&&(fp.pagination||fp.pagination===!1)&&pp&&!pp.el&&(bp=!0),sp.includes("scrollbar")&&ap.scrollbar&&(ap.scrollbar.el||cp)&&(fp.scrollbar||fp.scrollbar===!1)&&gp&&!gp.el&&(Ep=!0),sp.includes("navigation")&&ap.navigation&&(ap.navigation.prevEl||up)&&(ap.navigation.nextEl||lp)&&(fp.navigation||fp.navigation===!1)&&mp&&!mp.prevEl&&!mp.nextEl&&(Sp=!0);const Mp=Op=>{_d[Op]&&(_d[Op].destroy(),Op==="navigation"?(_d.isElement&&(_d[Op].prevEl.remove(),_d[Op].nextEl.remove()),fp[Op].prevEl=void 0,fp[Op].nextEl=void 0,_d[Op].prevEl=void 0,_d[Op].nextEl=void 0):(_d.isElement&&_d[Op].el.remove(),fp[Op].el=void 0,_d[Op].el=void 0))};sp.includes("loop")&&_d.isElement&&(fp.loop&&!ap.loop?Ap=!0:!fp.loop&&ap.loop?Rp=!0:Tp=!0),hp.forEach(Op=>{if(isObject$6(fp[Op])&&isObject$6(ap[Op]))Object.assign(fp[Op],ap[Op]),(Op==="navigation"||Op==="pagination"||Op==="scrollbar")&&"enabled"in ap[Op]&&!ap[Op].enabled&&Mp(Op);else{const Pp=ap[Op];(Pp===!0||Pp===!1)&&(Op==="navigation"||Op==="pagination"||Op==="scrollbar")?Pp===!1&&Mp(Op):fp[Op]=ap[Op]}}),hp.includes("controller")&&!vp&&_d.controller&&_d.controller.control&&fp.controller&&fp.controller.control&&(_d.controller.control=fp.controller.control),sp.includes("children")&&np&&yp&&fp.virtual.enabled?(yp.slides=np,yp.update(!0)):sp.includes("virtual")&&yp&&fp.virtual.enabled&&(np&&(yp.slides=np),yp.update(!0)),sp.includes("children")&&np&&fp.loop&&(Tp=!0),_p&&xp.init()&&xp.update(!0),vp&&(_d.controller.control=fp.controller.control),bp&&(_d.isElement&&(!dp||typeof dp=="string")&&(dp=document.createElement("div"),dp.classList.add("swiper-pagination"),dp.part.add("pagination"),_d.el.appendChild(dp)),dp&&(fp.pagination.el=dp),pp.init(),pp.render(),pp.update()),Ep&&(_d.isElement&&(!cp||typeof cp=="string")&&(cp=document.createElement("div"),cp.classList.add("swiper-scrollbar"),cp.part.add("scrollbar"),_d.el.appendChild(cp)),cp&&(fp.scrollbar.el=cp),gp.init(),gp.updateSize(),gp.setTranslate()),Sp&&(_d.isElement&&((!lp||typeof lp=="string")&&(lp=document.createElement("div"),lp.classList.add("swiper-button-next"),lp.innerHTML=_d.hostEl.constructor.nextButtonSvg,lp.part.add("button-next"),_d.el.appendChild(lp)),(!up||typeof up=="string")&&(up=document.createElement("div"),up.classList.add("swiper-button-prev"),up.innerHTML=_d.hostEl.constructor.prevButtonSvg,up.part.add("button-prev"),_d.el.appendChild(up))),lp&&(fp.navigation.nextEl=lp),up&&(fp.navigation.prevEl=up),mp.init(),mp.update()),sp.includes("allowSlideNext")&&(_d.allowSlideNext=ap.allowSlideNext),sp.includes("allowSlidePrev")&&(_d.allowSlidePrev=ap.allowSlidePrev),sp.includes("direction")&&_d.changeDirection(ap.direction,!1),(Ap||Tp)&&_d.loopDestroy(),(Rp||Tp)&&_d.loopCreate(),_d.update()}function getParams(rp,_d){rp===void 0&&(rp={}),_d===void 0&&(_d=!0);const np={on:{}},ap={},sp={};extend$2(np,defaults$2),np._emitClasses=!0,np.init=!1;const lp={},up=paramsList.map(dp=>dp.replace(/_/,"")),cp=Object.assign({},rp);return Object.keys(cp).forEach(dp=>{typeof rp[dp]>"u"||(up.indexOf(dp)>=0?isObject$6(rp[dp])?(np[dp]={},sp[dp]={},extend$2(np[dp],rp[dp]),extend$2(sp[dp],rp[dp])):(np[dp]=rp[dp],sp[dp]=rp[dp]):dp.search(/on[A-Z]/)===0&&typeof rp[dp]=="function"?_d?ap[`${dp[2].toLowerCase()}${dp.substr(3)}`]=rp[dp]:np.on[`${dp[2].toLowerCase()}${dp.substr(3)}`]=rp[dp]:lp[dp]=rp[dp])}),["navigation","pagination","scrollbar"].forEach(dp=>{np[dp]===!0&&(np[dp]={}),np[dp]===!1&&delete np[dp]}),{params:np,passedParams:sp,rest:lp,events:ap}}function mountSwiper(rp,_d){let{el:np,nextEl:ap,prevEl:sp,paginationEl:lp,scrollbarEl:up,swiper:cp}=rp;needsNavigation(_d)&&ap&&sp&&(cp.params.navigation.nextEl=ap,cp.originalParams.navigation.nextEl=ap,cp.params.navigation.prevEl=sp,cp.originalParams.navigation.prevEl=sp),needsPagination(_d)&&lp&&(cp.params.pagination.el=lp,cp.originalParams.pagination.el=lp),needsScrollbar(_d)&&up&&(cp.params.scrollbar.el=up,cp.originalParams.scrollbar.el=up),cp.init(np)}function getChangedParams(rp,_d,np,ap,sp){const lp=[];if(!_d)return lp;const up=dp=>{lp.indexOf(dp)<0&&lp.push(dp)};if(np&&ap){const dp=ap.map(sp),hp=np.map(sp);dp.join("")!==hp.join("")&&up("children"),ap.length!==np.length&&up("children")}return paramsList.filter(dp=>dp[0]==="_").map(dp=>dp.replace(/_/,"")).forEach(dp=>{if(dp in rp&&dp in _d)if(isObject$6(rp[dp])&&isObject$6(_d[dp])){const hp=Object.keys(rp[dp]),fp=Object.keys(_d[dp]);hp.length!==fp.length?up(dp):(hp.forEach(pp=>{rp[dp][pp]!==_d[dp][pp]&&up(dp)}),fp.forEach(pp=>{rp[dp][pp]!==_d[dp][pp]&&up(dp)}))}else rp[dp]!==_d[dp]&&up(dp)}),lp}const updateOnVirtualData=rp=>{!rp||rp.destroyed||!rp.params.virtual||rp.params.virtual&&!rp.params.virtual.enabled||(rp.updateSlides(),rp.updateProgress(),rp.updateSlidesClasses(),rp.parallax&&rp.params.parallax&&rp.params.parallax.enabled&&rp.parallax.setTranslate())};function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(rp){for(var _d=1;_d<arguments.length;_d++){var np=arguments[_d];for(var ap in np)Object.prototype.hasOwnProperty.call(np,ap)&&(rp[ap]=np[ap])}return rp},_extends$2.apply(this,arguments)}function isChildSwiperSlide(rp){return rp.type&&rp.type.displayName&&rp.type.displayName.includes("SwiperSlide")}function processChildren(rp){const _d=[];return React.Children.toArray(rp).forEach(np=>{isChildSwiperSlide(np)?_d.push(np):np.props&&np.props.children&&processChildren(np.props.children).forEach(ap=>_d.push(ap))}),_d}function getChildren(rp){const _d=[],np={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return React.Children.toArray(rp).forEach(ap=>{if(isChildSwiperSlide(ap))_d.push(ap);else if(ap.props&&ap.props.slot&&np[ap.props.slot])np[ap.props.slot].push(ap);else if(ap.props&&ap.props.children){const sp=processChildren(ap.props.children);sp.length>0?sp.forEach(lp=>_d.push(lp)):np["container-end"].push(ap)}else np["container-end"].push(ap)}),{slides:_d,slots:np}}function renderVirtual(rp,_d,np){if(!np)return null;const ap=fp=>{let pp=fp;return fp<0?pp=_d.length+fp:pp>=_d.length&&(pp=pp-_d.length),pp},sp=rp.isHorizontal()?{[rp.rtlTranslate?"right":"left"]:`${np.offset}px`}:{top:`${np.offset}px`},{from:lp,to:up}=np,cp=rp.params.loop?-_d.length:0,dp=rp.params.loop?_d.length*2:_d.length,hp=[];for(let fp=cp;fp<dp;fp+=1)fp>=lp&&fp<=up&&hp.push(_d[ap(fp)]);return hp.map((fp,pp)=>React.cloneElement(fp,{swiper:rp,style:sp,key:`slide-${pp}`}))}function useIsomorphicLayoutEffect$3(rp,_d){return typeof window>"u"?reactExports.useEffect(rp,_d):reactExports.useLayoutEffect(rp,_d)}const SwiperSlideContext=reactExports.createContext(null),SwiperContext=reactExports.createContext(null),Swiper=reactExports.forwardRef(function(rp,_d){let{className:np,tag:ap="div",wrapperTag:sp="div",children:lp,onSwiper:up,...cp}=rp===void 0?{}:rp,dp=!1;const[hp,fp]=reactExports.useState("swiper"),[pp,mp]=reactExports.useState(null),[gp,yp]=reactExports.useState(!1),xp=reactExports.useRef(!1),_p=reactExports.useRef(null),vp=reactExports.useRef(null),bp=reactExports.useRef(null),Ep=reactExports.useRef(null),Sp=reactExports.useRef(null),Ap=reactExports.useRef(null),Rp=reactExports.useRef(null),Tp=reactExports.useRef(null),{params:Mp,passedParams:Op,rest:Pp,events:$p}=getParams(cp),{slides:zp,slots:Dp}=getChildren(lp),Fp=()=>{yp(!gp)};Object.assign(Mp.on,{_containerClasses(kp,Up){fp(Up)}});const jp=()=>{Object.assign(Mp.on,$p),dp=!0;const kp={...Mp};if(delete kp.wrapperClass,vp.current=new Swiper$1(kp),vp.current.virtual&&vp.current.params.virtual.enabled){vp.current.virtual.slides=zp;const Up={cache:!1,slides:zp,renderExternal:mp,renderExternalUpdate:!1};extend$2(vp.current.params.virtual,Up),extend$2(vp.current.originalParams.virtual,Up)}};_p.current||jp(),vp.current&&vp.current.on("_beforeBreakpoint",Fp);const Lp=()=>{dp||!$p||!vp.current||Object.keys($p).forEach(kp=>{vp.current.on(kp,$p[kp])})},Bp=()=>{!$p||!vp.current||Object.keys($p).forEach(kp=>{vp.current.off(kp,$p[kp])})};reactExports.useEffect(()=>()=>{vp.current&&vp.current.off("_beforeBreakpoint",Fp)}),reactExports.useEffect(()=>{!xp.current&&vp.current&&(vp.current.emitSlidesClasses(),xp.current=!0)}),useIsomorphicLayoutEffect$3(()=>{if(_d&&(_d.current=_p.current),!!_p.current)return vp.current.destroyed&&jp(),mountSwiper({el:_p.current,nextEl:Sp.current,prevEl:Ap.current,paginationEl:Rp.current,scrollbarEl:Tp.current,swiper:vp.current},Mp),up&&up(vp.current),()=>{vp.current&&!vp.current.destroyed&&vp.current.destroy(!0,!1)}},[]),useIsomorphicLayoutEffect$3(()=>{Lp();const kp=getChangedParams(Op,bp.current,zp,Ep.current,Up=>Up.key);return bp.current=Op,Ep.current=zp,kp.length&&vp.current&&!vp.current.destroyed&&updateSwiper({swiper:vp.current,slides:zp,passedParams:Op,changedParams:kp,nextEl:Sp.current,prevEl:Ap.current,scrollbarEl:Tp.current,paginationEl:Rp.current}),()=>{Bp()}}),useIsomorphicLayoutEffect$3(()=>{updateOnVirtualData(vp.current)},[pp]);function Ip(){return Mp.virtual?renderVirtual(vp.current,zp,pp):zp.map((kp,Up)=>React.cloneElement(kp,{swiper:vp.current,swiperSlideIndex:Up}))}return React.createElement(ap,_extends$2({ref:_p,className:uniqueClasses(`${hp}${np?` ${np}`:""}`)},Pp),React.createElement(SwiperContext.Provider,{value:vp.current},Dp["container-start"],React.createElement(sp,{className:wrapperClass(Mp.wrapperClass)},Dp["wrapper-start"],Ip(),Dp["wrapper-end"]),needsNavigation(Mp)&&React.createElement(React.Fragment,null,React.createElement("div",{ref:Ap,className:"swiper-button-prev"}),React.createElement("div",{ref:Sp,className:"swiper-button-next"})),needsScrollbar(Mp)&&React.createElement("div",{ref:Tp,className:"swiper-scrollbar"}),needsPagination(Mp)&&React.createElement("div",{ref:Rp,className:"swiper-pagination"}),Dp["container-end"]))});Swiper.displayName="Swiper";const SwiperSlide=reactExports.forwardRef(function(rp,_d){let{tag:np="div",children:ap,className:sp="",swiper:lp,zoom:up,lazy:cp,virtualIndex:dp,swiperSlideIndex:hp,...fp}=rp===void 0?{}:rp;const pp=reactExports.useRef(null),[mp,gp]=reactExports.useState("swiper-slide"),[yp,xp]=reactExports.useState(!1);function _p(Sp,Ap,Rp){Ap===pp.current&&gp(Rp)}useIsomorphicLayoutEffect$3(()=>{if(typeof hp<"u"&&(pp.current.swiperSlideIndex=hp),_d&&(_d.current=pp.current),!(!pp.current||!lp)){if(lp.destroyed){mp!=="swiper-slide"&&gp("swiper-slide");return}return lp.on("_slideClass",_p),()=>{lp&&lp.off("_slideClass",_p)}}}),useIsomorphicLayoutEffect$3(()=>{lp&&pp.current&&!lp.destroyed&&gp(lp.getSlideClasses(pp.current))},[lp]);const vp={isActive:mp.indexOf("swiper-slide-active")>=0,isVisible:mp.indexOf("swiper-slide-visible")>=0,isPrev:mp.indexOf("swiper-slide-prev")>=0,isNext:mp.indexOf("swiper-slide-next")>=0},bp=()=>typeof ap=="function"?ap(vp):ap,Ep=()=>{xp(!0)};return React.createElement(np,_extends$2({ref:pp,className:uniqueClasses(`${mp}${sp?` ${sp}`:""}`),"data-swiper-slide-index":dp,onLoad:Ep},fp),up&&React.createElement(SwiperSlideContext.Provider,{value:vp},React.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":typeof up=="number"?up:void 0},bp(),cp&&!yp&&React.createElement("div",{className:"swiper-lazy-preloader"}))),!up&&React.createElement(SwiperSlideContext.Provider,{value:vp},bp(),cp&&!yp&&React.createElement("div",{className:"swiper-lazy-preloader"})))});SwiperSlide.displayName="SwiperSlide";function createElementIfNotDefined(rp,_d,np,ap){return rp.params.createElements&&Object.keys(ap).forEach(sp=>{if(!np[sp]&&np.auto===!0){let lp=elementChildren(rp.el,`.${ap[sp]}`)[0];lp||(lp=createElement("div",ap[sp]),lp.className=ap[sp],rp.el.append(lp)),np[sp]=lp,_d[sp]=lp}}),np}function classesToSelector(rp){return rp===void 0&&(rp=""),`.${rp.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function Pagination(rp){let{swiper:_d,extendParams:np,on:ap,emit:sp}=rp;const lp="swiper-pagination";np({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:bp=>bp,formatFractionTotal:bp=>bp,bulletClass:`${lp}-bullet`,bulletActiveClass:`${lp}-bullet-active`,modifierClass:`${lp}-`,currentClass:`${lp}-current`,totalClass:`${lp}-total`,hiddenClass:`${lp}-hidden`,progressbarFillClass:`${lp}-progressbar-fill`,progressbarOppositeClass:`${lp}-progressbar-opposite`,clickableClass:`${lp}-clickable`,lockClass:`${lp}-lock`,horizontalClass:`${lp}-horizontal`,verticalClass:`${lp}-vertical`,paginationDisabledClass:`${lp}-disabled`}}),_d.pagination={el:null,bullets:[]};let up,cp=0;const dp=bp=>(Array.isArray(bp)?bp:[bp]).filter(Ep=>!!Ep);function hp(){return!_d.params.pagination.el||!_d.pagination.el||Array.isArray(_d.pagination.el)&&_d.pagination.el.length===0}function fp(bp,Ep){const{bulletActiveClass:Sp}=_d.params.pagination;bp&&(bp=bp[`${Ep==="prev"?"previous":"next"}ElementSibling`],bp&&(bp.classList.add(`${Sp}-${Ep}`),bp=bp[`${Ep==="prev"?"previous":"next"}ElementSibling`],bp&&bp.classList.add(`${Sp}-${Ep}-${Ep}`)))}function pp(bp){const Ep=bp.target.closest(classesToSelector(_d.params.pagination.bulletClass));if(!Ep)return;bp.preventDefault();const Sp=elementIndex(Ep)*_d.params.slidesPerGroup;if(_d.params.loop){if(_d.realIndex===Sp)return;_d.slideToLoop(Sp)}else _d.slideTo(Sp)}function mp(){const bp=_d.rtl,Ep=_d.params.pagination;if(hp())return;let Sp=_d.pagination.el;Sp=dp(Sp);let Ap,Rp;const Tp=_d.virtual&&_d.params.virtual.enabled?_d.virtual.slides.length:_d.slides.length,Mp=_d.params.loop?Math.ceil(Tp/_d.params.slidesPerGroup):_d.snapGrid.length;if(_d.params.loop?(Rp=_d.previousRealIndex||0,Ap=_d.params.slidesPerGroup>1?Math.floor(_d.realIndex/_d.params.slidesPerGroup):_d.realIndex):typeof _d.snapIndex<"u"?(Ap=_d.snapIndex,Rp=_d.previousSnapIndex):(Rp=_d.previousIndex||0,Ap=_d.activeIndex||0),Ep.type==="bullets"&&_d.pagination.bullets&&_d.pagination.bullets.length>0){const Op=_d.pagination.bullets;let Pp,$p,zp;if(Ep.dynamicBullets&&(up=elementOuterSize(Op[0],_d.isHorizontal()?"width":"height",!0),Sp.forEach(Dp=>{Dp.style[_d.isHorizontal()?"width":"height"]=`${up*(Ep.dynamicMainBullets+4)}px`}),Ep.dynamicMainBullets>1&&Rp!==void 0&&(cp+=Ap-(Rp||0),cp>Ep.dynamicMainBullets-1?cp=Ep.dynamicMainBullets-1:cp<0&&(cp=0)),Pp=Math.max(Ap-cp,0),$p=Pp+(Math.min(Op.length,Ep.dynamicMainBullets)-1),zp=($p+Pp)/2),Op.forEach(Dp=>{const Fp=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(jp=>`${Ep.bulletActiveClass}${jp}`)].map(jp=>typeof jp=="string"&&jp.includes(" ")?jp.split(" "):jp).flat();Dp.classList.remove(...Fp)}),Sp.length>1)Op.forEach(Dp=>{const Fp=elementIndex(Dp);Fp===Ap?Dp.classList.add(...Ep.bulletActiveClass.split(" ")):_d.isElement&&Dp.setAttribute("part","bullet"),Ep.dynamicBullets&&(Fp>=Pp&&Fp<=$p&&Dp.classList.add(...`${Ep.bulletActiveClass}-main`.split(" ")),Fp===Pp&&fp(Dp,"prev"),Fp===$p&&fp(Dp,"next"))});else{const Dp=Op[Ap];if(Dp&&Dp.classList.add(...Ep.bulletActiveClass.split(" ")),_d.isElement&&Op.forEach((Fp,jp)=>{Fp.setAttribute("part",jp===Ap?"bullet-active":"bullet")}),Ep.dynamicBullets){const Fp=Op[Pp],jp=Op[$p];for(let Lp=Pp;Lp<=$p;Lp+=1)Op[Lp]&&Op[Lp].classList.add(...`${Ep.bulletActiveClass}-main`.split(" "));fp(Fp,"prev"),fp(jp,"next")}}if(Ep.dynamicBullets){const Dp=Math.min(Op.length,Ep.dynamicMainBullets+4),Fp=(up*Dp-up)/2-zp*up,jp=bp?"right":"left";Op.forEach(Lp=>{Lp.style[_d.isHorizontal()?jp:"top"]=`${Fp}px`})}}Sp.forEach((Op,Pp)=>{if(Ep.type==="fraction"&&(Op.querySelectorAll(classesToSelector(Ep.currentClass)).forEach($p=>{$p.textContent=Ep.formatFractionCurrent(Ap+1)}),Op.querySelectorAll(classesToSelector(Ep.totalClass)).forEach($p=>{$p.textContent=Ep.formatFractionTotal(Mp)})),Ep.type==="progressbar"){let $p;Ep.progressbarOpposite?$p=_d.isHorizontal()?"vertical":"horizontal":$p=_d.isHorizontal()?"horizontal":"vertical";const zp=(Ap+1)/Mp;let Dp=1,Fp=1;$p==="horizontal"?Dp=zp:Fp=zp,Op.querySelectorAll(classesToSelector(Ep.progressbarFillClass)).forEach(jp=>{jp.style.transform=`translate3d(0,0,0) scaleX(${Dp}) scaleY(${Fp})`,jp.style.transitionDuration=`${_d.params.speed}ms`})}Ep.type==="custom"&&Ep.renderCustom?(Op.innerHTML=Ep.renderCustom(_d,Ap+1,Mp),Pp===0&&sp("paginationRender",Op)):(Pp===0&&sp("paginationRender",Op),sp("paginationUpdate",Op)),_d.params.watchOverflow&&_d.enabled&&Op.classList[_d.isLocked?"add":"remove"](Ep.lockClass)})}function gp(){const bp=_d.params.pagination;if(hp())return;const Ep=_d.virtual&&_d.params.virtual.enabled?_d.virtual.slides.length:_d.grid&&_d.params.grid.rows>1?_d.slides.length/Math.ceil(_d.params.grid.rows):_d.slides.length;let Sp=_d.pagination.el;Sp=dp(Sp);let Ap="";if(bp.type==="bullets"){let Rp=_d.params.loop?Math.ceil(Ep/_d.params.slidesPerGroup):_d.snapGrid.length;_d.params.freeMode&&_d.params.freeMode.enabled&&Rp>Ep&&(Rp=Ep);for(let Tp=0;Tp<Rp;Tp+=1)bp.renderBullet?Ap+=bp.renderBullet.call(_d,Tp,bp.bulletClass):Ap+=`<${bp.bulletElement} ${_d.isElement?'part="bullet"':""} class="${bp.bulletClass}"></${bp.bulletElement}>`}bp.type==="fraction"&&(bp.renderFraction?Ap=bp.renderFraction.call(_d,bp.currentClass,bp.totalClass):Ap=`<span class="${bp.currentClass}"></span> / <span class="${bp.totalClass}"></span>`),bp.type==="progressbar"&&(bp.renderProgressbar?Ap=bp.renderProgressbar.call(_d,bp.progressbarFillClass):Ap=`<span class="${bp.progressbarFillClass}"></span>`),_d.pagination.bullets=[],Sp.forEach(Rp=>{bp.type!=="custom"&&(Rp.innerHTML=Ap||""),bp.type==="bullets"&&_d.pagination.bullets.push(...Rp.querySelectorAll(classesToSelector(bp.bulletClass)))}),bp.type!=="custom"&&sp("paginationRender",Sp[0])}function yp(){_d.params.pagination=createElementIfNotDefined(_d,_d.originalParams.pagination,_d.params.pagination,{el:"swiper-pagination"});const bp=_d.params.pagination;if(!bp.el)return;let Ep;typeof bp.el=="string"&&_d.isElement&&(Ep=_d.el.querySelector(bp.el)),!Ep&&typeof bp.el=="string"&&(Ep=[...document.querySelectorAll(bp.el)]),Ep||(Ep=bp.el),!(!Ep||Ep.length===0)&&(_d.params.uniqueNavElements&&typeof bp.el=="string"&&Array.isArray(Ep)&&Ep.length>1&&(Ep=[..._d.el.querySelectorAll(bp.el)],Ep.length>1&&(Ep=Ep.filter(Sp=>elementParents(Sp,".swiper")[0]===_d.el)[0])),Array.isArray(Ep)&&Ep.length===1&&(Ep=Ep[0]),Object.assign(_d.pagination,{el:Ep}),Ep=dp(Ep),Ep.forEach(Sp=>{bp.type==="bullets"&&bp.clickable&&Sp.classList.add(...(bp.clickableClass||"").split(" ")),Sp.classList.add(bp.modifierClass+bp.type),Sp.classList.add(_d.isHorizontal()?bp.horizontalClass:bp.verticalClass),bp.type==="bullets"&&bp.dynamicBullets&&(Sp.classList.add(`${bp.modifierClass}${bp.type}-dynamic`),cp=0,bp.dynamicMainBullets<1&&(bp.dynamicMainBullets=1)),bp.type==="progressbar"&&bp.progressbarOpposite&&Sp.classList.add(bp.progressbarOppositeClass),bp.clickable&&Sp.addEventListener("click",pp),_d.enabled||Sp.classList.add(bp.lockClass)}))}function xp(){const bp=_d.params.pagination;if(hp())return;let Ep=_d.pagination.el;Ep&&(Ep=dp(Ep),Ep.forEach(Sp=>{Sp.classList.remove(bp.hiddenClass),Sp.classList.remove(bp.modifierClass+bp.type),Sp.classList.remove(_d.isHorizontal()?bp.horizontalClass:bp.verticalClass),bp.clickable&&(Sp.classList.remove(...(bp.clickableClass||"").split(" ")),Sp.removeEventListener("click",pp))})),_d.pagination.bullets&&_d.pagination.bullets.forEach(Sp=>Sp.classList.remove(...bp.bulletActiveClass.split(" ")))}ap("changeDirection",()=>{if(!_d.pagination||!_d.pagination.el)return;const bp=_d.params.pagination;let{el:Ep}=_d.pagination;Ep=dp(Ep),Ep.forEach(Sp=>{Sp.classList.remove(bp.horizontalClass,bp.verticalClass),Sp.classList.add(_d.isHorizontal()?bp.horizontalClass:bp.verticalClass)})}),ap("init",()=>{_d.params.pagination.enabled===!1?vp():(yp(),gp(),mp())}),ap("activeIndexChange",()=>{typeof _d.snapIndex>"u"&&mp()}),ap("snapIndexChange",()=>{mp()}),ap("snapGridLengthChange",()=>{gp(),mp()}),ap("destroy",()=>{xp()}),ap("enable disable",()=>{let{el:bp}=_d.pagination;bp&&(bp=dp(bp),bp.forEach(Ep=>Ep.classList[_d.enabled?"remove":"add"](_d.params.pagination.lockClass)))}),ap("lock unlock",()=>{mp()}),ap("click",(bp,Ep)=>{const Sp=Ep.target,Ap=dp(_d.pagination.el);if(_d.params.pagination.el&&_d.params.pagination.hideOnClick&&Ap&&Ap.length>0&&!Sp.classList.contains(_d.params.pagination.bulletClass)){if(_d.navigation&&(_d.navigation.nextEl&&Sp===_d.navigation.nextEl||_d.navigation.prevEl&&Sp===_d.navigation.prevEl))return;const Rp=Ap[0].classList.contains(_d.params.pagination.hiddenClass);sp(Rp===!0?"paginationShow":"paginationHide"),Ap.forEach(Tp=>Tp.classList.toggle(_d.params.pagination.hiddenClass))}});const _p=()=>{_d.el.classList.remove(_d.params.pagination.paginationDisabledClass);let{el:bp}=_d.pagination;bp&&(bp=dp(bp),bp.forEach(Ep=>Ep.classList.remove(_d.params.pagination.paginationDisabledClass))),yp(),gp(),mp()},vp=()=>{_d.el.classList.add(_d.params.pagination.paginationDisabledClass);let{el:bp}=_d.pagination;bp&&(bp=dp(bp),bp.forEach(Ep=>Ep.classList.add(_d.params.pagination.paginationDisabledClass))),xp()};Object.assign(_d.pagination,{enable:_p,disable:vp,render:gp,update:mp,init:yp,destroy:xp})}function effectInit(rp){const{effect:_d,swiper:np,on:ap,setTranslate:sp,setTransition:lp,overwriteParams:up,perspective:cp,recreateShadows:dp,getEffectParams:hp}=rp;ap("beforeInit",()=>{if(np.params.effect!==_d)return;np.classNames.push(`${np.params.containerModifierClass}${_d}`),cp&&cp()&&np.classNames.push(`${np.params.containerModifierClass}3d`);const pp=up?up():{};Object.assign(np.params,pp),Object.assign(np.originalParams,pp)}),ap("setTranslate",()=>{np.params.effect===_d&&sp()}),ap("setTransition",(pp,mp)=>{np.params.effect===_d&&lp(mp)}),ap("transitionEnd",()=>{if(np.params.effect===_d&&dp){if(!hp||!hp().slideShadows)return;np.slides.forEach(pp=>{pp.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(mp=>mp.remove())}),dp()}});let fp;ap("virtualUpdate",()=>{np.params.effect===_d&&(np.slides.length||(fp=!0),requestAnimationFrame(()=>{fp&&np.slides&&np.slides.length&&(sp(),fp=!1)}))})}function effectTarget(rp,_d){const np=getSlideTransformEl(_d);return np!==_d&&(np.style.backfaceVisibility="hidden",np.style["-webkit-backface-visibility"]="hidden"),np}function effectVirtualTransitionEnd(rp){let{swiper:_d,duration:np,transformElements:ap,allSlides:sp}=rp;const{activeIndex:lp}=_d,up=cp=>cp.parentElement?cp.parentElement:_d.slides.filter(hp=>hp.shadowRoot&&hp.shadowRoot===cp.parentNode)[0];if(_d.params.virtualTranslate&&np!==0){let cp=!1,dp;sp?dp=ap:dp=ap.filter(hp=>{const fp=hp.classList.contains("swiper-slide-transform")?up(hp):hp;return _d.getSlideIndex(fp)===lp}),dp.forEach(hp=>{elementTransitionEnd(hp,()=>{if(cp||!_d||_d.destroyed)return;cp=!0,_d.animating=!1;const fp=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});_d.wrapperEl.dispatchEvent(fp)})})}}function createShadow$1(rp,_d,np){const ap=`swiper-slide-shadow${np?`-${np}`:""}${rp?` swiper-slide-shadow-${rp}`:""}`,sp=getSlideTransformEl(_d);let lp=sp.querySelector(`.${ap.split(" ").join(".")}`);return lp||(lp=createElement("div",ap.split(" ")),sp.append(lp)),lp}function EffectCoverflow(rp){let{swiper:_d,extendParams:np,on:ap}=rp;np({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),effectInit({effect:"coverflow",swiper:_d,on:ap,setTranslate:()=>{const{width:up,height:cp,slides:dp,slidesSizesGrid:hp}=_d,fp=_d.params.coverflowEffect,pp=_d.isHorizontal(),mp=_d.translate,gp=pp?-mp+up/2:-mp+cp/2,yp=pp?fp.rotate:-fp.rotate,xp=fp.depth;for(let _p=0,vp=dp.length;_p<vp;_p+=1){const bp=dp[_p],Ep=hp[_p],Sp=bp.swiperSlideOffset,Ap=(gp-Sp-Ep/2)/Ep,Rp=typeof fp.modifier=="function"?fp.modifier(Ap):Ap*fp.modifier;let Tp=pp?yp*Rp:0,Mp=pp?0:yp*Rp,Op=-xp*Math.abs(Rp),Pp=fp.stretch;typeof Pp=="string"&&Pp.indexOf("%")!==-1&&(Pp=parseFloat(fp.stretch)/100*Ep);let $p=pp?0:Pp*Rp,zp=pp?Pp*Rp:0,Dp=1-(1-fp.scale)*Math.abs(Rp);Math.abs(zp)<.001&&(zp=0),Math.abs($p)<.001&&($p=0),Math.abs(Op)<.001&&(Op=0),Math.abs(Tp)<.001&&(Tp=0),Math.abs(Mp)<.001&&(Mp=0),Math.abs(Dp)<.001&&(Dp=0),_d.browser&&_d.browser.isSafari&&(Math.abs(Tp)/90%2===1&&(Tp+=.001),Math.abs(Mp)/90%2===1&&(Mp+=.001));const Fp=`translate3d(${zp}px,${$p}px,${Op}px)  rotateX(${Mp}deg) rotateY(${Tp}deg) scale(${Dp})`,jp=effectTarget(fp,bp);if(jp.style.transform=Fp,bp.style.zIndex=-Math.abs(Math.round(Rp))+1,fp.slideShadows){let Lp=pp?bp.querySelector(".swiper-slide-shadow-left"):bp.querySelector(".swiper-slide-shadow-top"),Bp=pp?bp.querySelector(".swiper-slide-shadow-right"):bp.querySelector(".swiper-slide-shadow-bottom");Lp||(Lp=createShadow$1("coverflow",bp,pp?"left":"top")),Bp||(Bp=createShadow$1("coverflow",bp,pp?"right":"bottom")),Lp&&(Lp.style.opacity=Rp>0?Rp:0),Bp&&(Bp.style.opacity=-Rp>0?-Rp:0)}}},setTransition:up=>{_d.slides.map(dp=>getSlideTransformEl(dp)).forEach(dp=>{dp.style.transitionDuration=`${up}ms`,dp.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(hp=>{hp.style.transitionDuration=`${up}ms`})})},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}function EffectCards(rp){let{swiper:_d,extendParams:np,on:ap}=rp;np({cardsEffect:{slideShadows:!0,rotate:!0,perSlideRotate:2,perSlideOffset:8}}),effectInit({effect:"cards",swiper:_d,on:ap,setTranslate:()=>{const{slides:up,activeIndex:cp,rtlTranslate:dp}=_d,hp=_d.params.cardsEffect,{startTranslate:fp,isTouched:pp}=_d.touchEventsData,mp=dp?-_d.translate:_d.translate;for(let gp=0;gp<up.length;gp+=1){const yp=up[gp],xp=yp.progress,_p=Math.min(Math.max(xp,-4),4);let vp=yp.swiperSlideOffset;_d.params.centeredSlides&&!_d.params.cssMode&&(_d.wrapperEl.style.transform=`translateX(${_d.minTranslate()}px)`),_d.params.centeredSlides&&_d.params.cssMode&&(vp-=up[0].swiperSlideOffset);let bp=_d.params.cssMode?-vp-_d.translate:-vp,Ep=0;const Sp=-100*Math.abs(_p);let Ap=1,Rp=-hp.perSlideRotate*_p,Tp=hp.perSlideOffset-Math.abs(_p)*.75;const Mp=_d.virtual&&_d.params.virtual.enabled?_d.virtual.from+gp:gp,Op=(Mp===cp||Mp===cp-1)&&_p>0&&_p<1&&(pp||_d.params.cssMode)&&mp<fp,Pp=(Mp===cp||Mp===cp+1)&&_p<0&&_p>-1&&(pp||_d.params.cssMode)&&mp>fp;if(Op||Pp){const Fp=(1-Math.abs((Math.abs(_p)-.5)/.5))**.5;Rp+=-28*_p*Fp,Ap+=-.5*Fp,Tp+=96*Fp,Ep=`${-25*Fp*Math.abs(_p)}%`}if(_p<0?bp=`calc(${bp}px ${dp?"-":"+"} (${Tp*Math.abs(_p)}%))`:_p>0?bp=`calc(${bp}px ${dp?"-":"+"} (-${Tp*Math.abs(_p)}%))`:bp=`${bp}px`,!_d.isHorizontal()){const Fp=Ep;Ep=bp,bp=Fp}const $p=_p<0?`${1+(1-Ap)*_p}`:`${1-(1-Ap)*_p}`,zp=`
        translate3d(${bp}, ${Ep}, ${Sp}px)
        rotateZ(${hp.rotate?dp?-Rp:Rp:0}deg)
        scale(${$p})
      `;if(hp.slideShadows){let Fp=yp.querySelector(".swiper-slide-shadow");Fp||(Fp=createShadow$1("cards",yp)),Fp&&(Fp.style.opacity=Math.min(Math.max((Math.abs(_p)-.5)/.5,0),1))}yp.style.zIndex=-Math.abs(Math.round(xp))+up.length;const Dp=effectTarget(hp,yp);Dp.style.transform=zp}},setTransition:up=>{const cp=_d.slides.map(dp=>getSlideTransformEl(dp));cp.forEach(dp=>{dp.style.transitionDuration=`${up}ms`,dp.querySelectorAll(".swiper-slide-shadow").forEach(hp=>{hp.style.transitionDuration=`${up}ms`})}),effectVirtualTransitionEnd({swiper:_d,duration:up,transformElements:cp})},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0,virtualTranslate:!_d.params.cssMode})})}var PersonOutlineOutlined={},interopRequireDefault={exports:{}};(function(rp){function _d(np){return np&&np.__esModule?np:{default:np}}rp.exports=_d,rp.exports.__esModule=!0,rp.exports.default=rp.exports})(interopRequireDefault);var interopRequireDefaultExports=interopRequireDefault.exports,createSvgIcon$1={};function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(rp){for(var _d=1;_d<arguments.length;_d++){var np=arguments[_d];for(var ap in np)Object.prototype.hasOwnProperty.call(np,ap)&&(rp[ap]=np[ap])}return rp},_extends$1.apply(this,arguments)}function isPlainObject$2(rp){if(typeof rp!="object"||rp===null)return!1;const _d=Object.getPrototypeOf(rp);return(_d===null||_d===Object.prototype||Object.getPrototypeOf(_d)===null)&&!(Symbol.toStringTag in rp)&&!(Symbol.iterator in rp)}function deepClone$1(rp){if(!isPlainObject$2(rp))return rp;const _d={};return Object.keys(rp).forEach(np=>{_d[np]=deepClone$1(rp[np])}),_d}function deepmerge(rp,_d,np={clone:!0}){const ap=np.clone?_extends$1({},rp):rp;return isPlainObject$2(rp)&&isPlainObject$2(_d)&&Object.keys(_d).forEach(sp=>{sp!=="__proto__"&&(isPlainObject$2(_d[sp])&&sp in rp&&isPlainObject$2(rp[sp])?ap[sp]=deepmerge(rp[sp],_d[sp],np):np.clone?ap[sp]=isPlainObject$2(_d[sp])?deepClone$1(_d[sp]):_d[sp]:ap[sp]=_d[sp])}),ap}var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function rp(ap,sp,lp,up,cp,dp){if(dp!==ReactPropTypesSecret){var hp=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw hp.name="Invariant Violation",hp}}rp.isRequired=rp;function _d(){return rp}var np={array:rp,bigint:rp,bool:rp,func:rp,number:rp,object:rp,string:rp,symbol:rp,any:rp,arrayOf:_d,element:rp,elementType:rp,instanceOf:_d,node:rp,objectOf:_d,oneOf:_d,oneOfType:_d,shape:_d,exact:_d,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return np.PropTypes=np,np};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;function formatMuiErrorMessage(rp){let _d="https://mui.com/production-error/?code="+rp;for(let np=1;np<arguments.length;np+=1)_d+="&args[]="+encodeURIComponent(arguments[np]);return"Minified MUI error #"+rp+"; visit "+_d+" for the full message."}function capitalize(rp){if(typeof rp!="string")throw new Error(formatMuiErrorMessage(7));return rp.charAt(0).toUpperCase()+rp.slice(1)}function createChainedFunction(...rp){return rp.reduce((_d,np)=>np==null?_d:function(...sp){_d.apply(this,sp),np.apply(this,sp)},()=>{})}function debounce$2(rp,_d=166){let np;function ap(...sp){const lp=()=>{rp.apply(this,sp)};clearTimeout(np),np=setTimeout(lp,_d)}return ap.clear=()=>{clearTimeout(np)},ap}function deprecatedPropType(rp,_d){return()=>null}function isMuiElement(rp,_d){var np,ap;return reactExports.isValidElement(rp)&&_d.indexOf((np=rp.type.muiName)!=null?np:(ap=rp.type)==null||(ap=ap._payload)==null||(ap=ap.value)==null?void 0:ap.muiName)!==-1}function ownerDocument(rp){return rp&&rp.ownerDocument||document}function ownerWindow(rp){return ownerDocument(rp).defaultView||window}function requirePropFactory(rp,_d){return()=>null}function setRef(rp,_d){typeof rp=="function"?rp(_d):rp&&(rp.current=_d)}const useEnhancedEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,useEnhancedEffect$1=useEnhancedEffect;let globalId=0;function useGlobalId(rp){const[_d,np]=reactExports.useState(rp),ap=rp||_d;return reactExports.useEffect(()=>{_d==null&&(globalId+=1,np(`mui-${globalId}`))},[_d]),ap}const maybeReactUseId=React$1.useId;function useId(rp){if(maybeReactUseId!==void 0){const _d=maybeReactUseId();return rp??_d}return useGlobalId(rp)}function unsupportedProp(rp,_d,np,ap,sp){return null}function useControlled({controlled:rp,default:_d,name:np,state:ap="value"}){const{current:sp}=reactExports.useRef(rp!==void 0),[lp,up]=reactExports.useState(_d),cp=sp?rp:lp,dp=reactExports.useCallback(hp=>{sp||up(hp)},[]);return[cp,dp]}function useEventCallback(rp){const _d=reactExports.useRef(rp);return useEnhancedEffect$1(()=>{_d.current=rp}),reactExports.useRef((...np)=>(0,_d.current)(...np)).current}function useForkRef(...rp){return reactExports.useMemo(()=>rp.every(_d=>_d==null)?null:_d=>{rp.forEach(np=>{setRef(np,_d)})},rp)}let hadKeyboardEvent=!0,hadFocusVisibleRecently=!1,hadFocusVisibleRecentlyTimeout;const inputTypesWhitelist={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function focusTriggersKeyboardModality(rp){const{type:_d,tagName:np}=rp;return!!(np==="INPUT"&&inputTypesWhitelist[_d]&&!rp.readOnly||np==="TEXTAREA"&&!rp.readOnly||rp.isContentEditable)}function handleKeyDown(rp){rp.metaKey||rp.altKey||rp.ctrlKey||(hadKeyboardEvent=!0)}function handlePointerDown(){hadKeyboardEvent=!1}function handleVisibilityChange(){this.visibilityState==="hidden"&&hadFocusVisibleRecently&&(hadKeyboardEvent=!0)}function prepare$1(rp){rp.addEventListener("keydown",handleKeyDown,!0),rp.addEventListener("mousedown",handlePointerDown,!0),rp.addEventListener("pointerdown",handlePointerDown,!0),rp.addEventListener("touchstart",handlePointerDown,!0),rp.addEventListener("visibilitychange",handleVisibilityChange,!0)}function isFocusVisible(rp){const{target:_d}=rp;try{return _d.matches(":focus-visible")}catch{}return hadKeyboardEvent||focusTriggersKeyboardModality(_d)}function useIsFocusVisible(){const rp=reactExports.useCallback(sp=>{sp!=null&&prepare$1(sp.ownerDocument)},[]),_d=reactExports.useRef(!1);function np(){return _d.current?(hadFocusVisibleRecently=!0,window.clearTimeout(hadFocusVisibleRecentlyTimeout),hadFocusVisibleRecentlyTimeout=window.setTimeout(()=>{hadFocusVisibleRecently=!1},100),_d.current=!1,!0):!1}function ap(sp){return isFocusVisible(sp)?(_d.current=!0,!0):!1}return{isFocusVisibleRef:_d,onFocus:ap,onBlur:np,ref:rp}}function resolveProps(rp,_d){const np=_extends$1({},_d);return Object.keys(rp).forEach(ap=>{if(ap.toString().match(/^(components|slots)$/))np[ap]=_extends$1({},rp[ap],np[ap]);else if(ap.toString().match(/^(componentsProps|slotProps)$/)){const sp=rp[ap]||{},lp=_d[ap];np[ap]={},!lp||!Object.keys(lp)?np[ap]=sp:!sp||!Object.keys(sp)?np[ap]=lp:(np[ap]=_extends$1({},lp),Object.keys(sp).forEach(up=>{np[ap][up]=resolveProps(sp[up],lp[up])}))}else np[ap]===void 0&&(np[ap]=rp[ap])}),np}function composeClasses(rp,_d,np=void 0){const ap={};return Object.keys(rp).forEach(sp=>{ap[sp]=rp[sp].reduce((lp,up)=>{if(up){const cp=_d(up);cp!==""&&lp.push(cp),np&&np[up]&&lp.push(np[up])}return lp},[]).join(" ")}),ap}const defaultGenerator=rp=>rp,createClassNameGenerator=()=>{let rp=defaultGenerator;return{configure(_d){rp=_d},generate(_d){return rp(_d)},reset(){rp=defaultGenerator}}},ClassNameGenerator=createClassNameGenerator(),globalStateClasses={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function generateUtilityClass(rp,_d,np="Mui"){const ap=globalStateClasses[_d];return ap?`${np}-${ap}`:`${ClassNameGenerator.generate(rp)}-${_d}`}function generateUtilityClasses(rp,_d,np="Mui"){const ap={};return _d.forEach(sp=>{ap[sp]=generateUtilityClass(rp,sp,np)}),ap}function clamp$1(rp,_d=Number.MIN_SAFE_INTEGER,np=Number.MAX_SAFE_INTEGER){return Math.max(_d,Math.min(rp,np))}function _objectWithoutPropertiesLoose(rp,_d){if(rp==null)return{};var np={},ap=Object.keys(rp),sp,lp;for(lp=0;lp<ap.length;lp++)sp=ap[lp],!(_d.indexOf(sp)>=0)&&(np[sp]=rp[sp]);return np}function r$1(rp){var _d,np,ap="";if(typeof rp=="string"||typeof rp=="number")ap+=rp;else if(typeof rp=="object")if(Array.isArray(rp)){var sp=rp.length;for(_d=0;_d<sp;_d++)rp[_d]&&(np=r$1(rp[_d]))&&(ap&&(ap+=" "),ap+=np)}else for(np in rp)rp[np]&&(ap&&(ap+=" "),ap+=np);return ap}function clsx(){for(var rp,_d,np=0,ap="",sp=arguments.length;np<sp;np++)(rp=arguments[np])&&(_d=r$1(rp))&&(ap&&(ap+=" "),ap+=_d);return ap}function memoize$1(rp){var _d=Object.create(null);return function(np){return _d[np]===void 0&&(_d[np]=rp(np)),_d[np]}}var reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=memoize$1(function(rp){return reactPropsRegex.test(rp)||rp.charCodeAt(0)===111&&rp.charCodeAt(1)===110&&rp.charCodeAt(2)<91});function sheetForTag(rp){if(rp.sheet)return rp.sheet;for(var _d=0;_d<document.styleSheets.length;_d++)if(document.styleSheets[_d].ownerNode===rp)return document.styleSheets[_d]}function createStyleElement(rp){var _d=document.createElement("style");return _d.setAttribute("data-emotion",rp.key),rp.nonce!==void 0&&_d.setAttribute("nonce",rp.nonce),_d.appendChild(document.createTextNode("")),_d.setAttribute("data-s",""),_d}var StyleSheet=function(){function rp(np){var ap=this;this._insertTag=function(sp){var lp;ap.tags.length===0?ap.insertionPoint?lp=ap.insertionPoint.nextSibling:ap.prepend?lp=ap.container.firstChild:lp=ap.before:lp=ap.tags[ap.tags.length-1].nextSibling,ap.container.insertBefore(sp,lp),ap.tags.push(sp)},this.isSpeedy=np.speedy===void 0?!0:np.speedy,this.tags=[],this.ctr=0,this.nonce=np.nonce,this.key=np.key,this.container=np.container,this.prepend=np.prepend,this.insertionPoint=np.insertionPoint,this.before=null}var _d=rp.prototype;return _d.hydrate=function(ap){ap.forEach(this._insertTag)},_d.insert=function(ap){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(createStyleElement(this));var sp=this.tags[this.tags.length-1];if(this.isSpeedy){var lp=sheetForTag(sp);try{lp.insertRule(ap,lp.cssRules.length)}catch{}}else sp.appendChild(document.createTextNode(ap));this.ctr++},_d.flush=function(){this.tags.forEach(function(ap){return ap.parentNode&&ap.parentNode.removeChild(ap)}),this.tags=[],this.ctr=0},rp}(),MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",LAYER="@layer",abs=Math.abs,from=String.fromCharCode,assign$3=Object.assign;function hash(rp,_d){return charat(rp,0)^45?(((_d<<2^charat(rp,0))<<2^charat(rp,1))<<2^charat(rp,2))<<2^charat(rp,3):0}function trim$1(rp){return rp.trim()}function match(rp,_d){return(rp=_d.exec(rp))?rp[0]:rp}function replace(rp,_d,np){return rp.replace(_d,np)}function indexof(rp,_d){return rp.indexOf(_d)}function charat(rp,_d){return rp.charCodeAt(_d)|0}function substr(rp,_d,np){return rp.slice(_d,np)}function strlen(rp){return rp.length}function sizeof(rp){return rp.length}function append(rp,_d){return _d.push(rp),rp}function combine(rp,_d){return rp.map(_d).join("")}var line=1,column=1,length=0,position=0,character=0,characters="";function node(rp,_d,np,ap,sp,lp,up){return{value:rp,root:_d,parent:np,type:ap,props:sp,children:lp,line,column,length:up,return:""}}function copy(rp,_d){return assign$3(node("",null,null,"",null,null,0),rp,{length:-rp.length},_d)}function char(){return character}function prev(){return character=position>0?charat(characters,--position):0,column--,character===10&&(column=1,line--),character}function next(){return character=position<length?charat(characters,position++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position)}function caret(){return position}function slice$1(rp,_d){return substr(characters,rp,_d)}function token(rp){switch(rp){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(rp){return line=column=1,length=strlen(characters=rp),position=0,[]}function dealloc(rp){return characters="",rp}function delimit(rp){return trim$1(slice$1(position-1,delimiter(rp===91?rp+2:rp===40?rp+1:rp)))}function whitespace(rp){for(;(character=peek())&&character<33;)next();return token(rp)>2||token(character)>3?"":" "}function escaping(rp,_d){for(;--_d&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice$1(rp,caret()+(_d<6&&peek()==32&&next()==32))}function delimiter(rp){for(;next();)switch(character){case rp:return position;case 34:case 39:rp!==34&&rp!==39&&delimiter(character);break;case 40:rp===41&&delimiter(rp);break;case 92:next();break}return position}function commenter(rp,_d){for(;next()&&rp+character!==57;)if(rp+character===84&&peek()===47)break;return"/*"+slice$1(_d,position-1)+"*"+from(rp===47?rp:next())}function identifier(rp){for(;!token(peek());)next();return slice$1(rp,position)}function compile(rp){return dealloc(parse$2("",null,null,null,[""],rp=alloc(rp),0,[0],rp))}function parse$2(rp,_d,np,ap,sp,lp,up,cp,dp){for(var hp=0,fp=0,pp=up,mp=0,gp=0,yp=0,xp=1,_p=1,vp=1,bp=0,Ep="",Sp=sp,Ap=lp,Rp=ap,Tp=Ep;_p;)switch(yp=bp,bp=next()){case 40:if(yp!=108&&charat(Tp,pp-1)==58){indexof(Tp+=replace(delimit(bp),"&","&\f"),"&\f")!=-1&&(vp=-1);break}case 34:case 39:case 91:Tp+=delimit(bp);break;case 9:case 10:case 13:case 32:Tp+=whitespace(yp);break;case 92:Tp+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),_d,np),dp);break;default:Tp+="/"}break;case 123*xp:cp[hp++]=strlen(Tp)*vp;case 125*xp:case 59:case 0:switch(bp){case 0:case 125:_p=0;case 59+fp:vp==-1&&(Tp=replace(Tp,/\f/g,"")),gp>0&&strlen(Tp)-pp&&append(gp>32?declaration(Tp+";",ap,np,pp-1):declaration(replace(Tp," ","")+";",ap,np,pp-2),dp);break;case 59:Tp+=";";default:if(append(Rp=ruleset(Tp,_d,np,hp,fp,sp,cp,Ep,Sp=[],Ap=[],pp),lp),bp===123)if(fp===0)parse$2(Tp,_d,Rp,Rp,Sp,lp,pp,cp,Ap);else switch(mp===99&&charat(Tp,3)===110?100:mp){case 100:case 108:case 109:case 115:parse$2(rp,Rp,Rp,ap&&append(ruleset(rp,Rp,Rp,0,0,sp,cp,Ep,sp,Sp=[],pp),Ap),sp,Ap,pp,cp,ap?Sp:Ap);break;default:parse$2(Tp,Rp,Rp,Rp,[""],Ap,0,cp,Ap)}}hp=fp=gp=0,xp=vp=1,Ep=Tp="",pp=up;break;case 58:pp=1+strlen(Tp),gp=yp;default:if(xp<1){if(bp==123)--xp;else if(bp==125&&xp++==0&&prev()==125)continue}switch(Tp+=from(bp),bp*xp){case 38:vp=fp>0?1:(Tp+="\f",-1);break;case 44:cp[hp++]=(strlen(Tp)-1)*vp,vp=1;break;case 64:peek()===45&&(Tp+=delimit(next())),mp=peek(),fp=pp=strlen(Ep=Tp+=identifier(caret())),bp++;break;case 45:yp===45&&strlen(Tp)==2&&(xp=0)}}return lp}function ruleset(rp,_d,np,ap,sp,lp,up,cp,dp,hp,fp){for(var pp=sp-1,mp=sp===0?lp:[""],gp=sizeof(mp),yp=0,xp=0,_p=0;yp<ap;++yp)for(var vp=0,bp=substr(rp,pp+1,pp=abs(xp=up[yp])),Ep=rp;vp<gp;++vp)(Ep=trim$1(xp>0?mp[vp]+" "+bp:replace(bp,/&\f/g,mp[vp])))&&(dp[_p++]=Ep);return node(rp,_d,np,sp===0?RULESET:cp,dp,hp,fp)}function comment(rp,_d,np){return node(rp,_d,np,COMMENT,from(char()),substr(rp,2,-2),0)}function declaration(rp,_d,np,ap){return node(rp,_d,np,DECLARATION,substr(rp,0,ap),substr(rp,ap+1,-1),ap)}function serialize(rp,_d){for(var np="",ap=sizeof(rp),sp=0;sp<ap;sp++)np+=_d(rp[sp],sp,rp,_d)||"";return np}function stringify$3(rp,_d,np,ap){switch(rp.type){case LAYER:if(rp.children.length)break;case IMPORT:case DECLARATION:return rp.return=rp.return||rp.value;case COMMENT:return"";case KEYFRAMES:return rp.return=rp.value+"{"+serialize(rp.children,ap)+"}";case RULESET:rp.value=rp.props.join(",")}return strlen(np=serialize(rp.children,ap))?rp.return=rp.value+"{"+np+"}":""}function middleware(rp){var _d=sizeof(rp);return function(np,ap,sp,lp){for(var up="",cp=0;cp<_d;cp++)up+=rp[cp](np,ap,sp,lp)||"";return up}}function rulesheet(rp){return function(_d){_d.root||(_d=_d.return)&&rp(_d)}}var identifierWithPointTracking=function(_d,np,ap){for(var sp=0,lp=0;sp=lp,lp=peek(),sp===38&&lp===12&&(np[ap]=1),!token(lp);)next();return slice$1(_d,position)},toRules=function(_d,np){var ap=-1,sp=44;do switch(token(sp)){case 0:sp===38&&peek()===12&&(np[ap]=1),_d[ap]+=identifierWithPointTracking(position-1,np,ap);break;case 2:_d[ap]+=delimit(sp);break;case 4:if(sp===44){_d[++ap]=peek()===58?"&\f":"",np[ap]=_d[ap].length;break}default:_d[ap]+=from(sp)}while(sp=next());return _d},getRules=function(_d,np){return dealloc(toRules(alloc(_d),np))},fixedElements=new WeakMap,compat=function(_d){if(!(_d.type!=="rule"||!_d.parent||_d.length<1)){for(var np=_d.value,ap=_d.parent,sp=_d.column===ap.column&&_d.line===ap.line;ap.type!=="rule";)if(ap=ap.parent,!ap)return;if(!(_d.props.length===1&&np.charCodeAt(0)!==58&&!fixedElements.get(ap))&&!sp){fixedElements.set(_d,!0);for(var lp=[],up=getRules(np,lp),cp=ap.props,dp=0,hp=0;dp<up.length;dp++)for(var fp=0;fp<cp.length;fp++,hp++)_d.props[hp]=lp[dp]?up[dp].replace(/&\f/g,cp[fp]):cp[fp]+" "+up[dp]}}},removeLabel=function(_d){if(_d.type==="decl"){var np=_d.value;np.charCodeAt(0)===108&&np.charCodeAt(2)===98&&(_d.return="",_d.value="")}};function prefix(rp,_d){switch(hash(rp,_d)){case 5103:return WEBKIT+"print-"+rp+rp;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+rp+rp;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+rp+MOZ+rp+MS+rp+rp;case 6828:case 4268:return WEBKIT+rp+MS+rp+rp;case 6165:return WEBKIT+rp+MS+"flex-"+rp+rp;case 5187:return WEBKIT+rp+replace(rp,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+rp;case 5443:return WEBKIT+rp+MS+"flex-item-"+replace(rp,/flex-|-self/,"")+rp;case 4675:return WEBKIT+rp+MS+"flex-line-pack"+replace(rp,/align-content|flex-|-self/,"")+rp;case 5548:return WEBKIT+rp+MS+replace(rp,"shrink","negative")+rp;case 5292:return WEBKIT+rp+MS+replace(rp,"basis","preferred-size")+rp;case 6060:return WEBKIT+"box-"+replace(rp,"-grow","")+WEBKIT+rp+MS+replace(rp,"grow","positive")+rp;case 4554:return WEBKIT+replace(rp,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+rp;case 6187:return replace(replace(replace(rp,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),rp,"")+rp;case 5495:case 3959:return replace(rp,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace(replace(rp,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+rp+rp;case 4095:case 3583:case 4068:case 2532:return replace(rp,/(.+)-inline(.+)/,WEBKIT+"$1$2")+rp;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(rp)-1-_d>6)switch(charat(rp,_d+1)){case 109:if(charat(rp,_d+4)!==45)break;case 102:return replace(rp,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(rp,_d+3)==108?"$3":"$2-$3"))+rp;case 115:return~indexof(rp,"stretch")?prefix(replace(rp,"stretch","fill-available"),_d)+rp:rp}break;case 4949:if(charat(rp,_d+1)!==115)break;case 6444:switch(charat(rp,strlen(rp)-3-(~indexof(rp,"!important")&&10))){case 107:return replace(rp,":",":"+WEBKIT)+rp;case 101:return replace(rp,/(.+:)([^;!]+)(;|!.+)?/,"$1"+WEBKIT+(charat(rp,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+rp}break;case 5936:switch(charat(rp,_d+11)){case 114:return WEBKIT+rp+MS+replace(rp,/[svh]\w+-[tblr]{2}/,"tb")+rp;case 108:return WEBKIT+rp+MS+replace(rp,/[svh]\w+-[tblr]{2}/,"tb-rl")+rp;case 45:return WEBKIT+rp+MS+replace(rp,/[svh]\w+-[tblr]{2}/,"lr")+rp}return WEBKIT+rp+MS+rp+rp}return rp}var prefixer=function(_d,np,ap,sp){if(_d.length>-1&&!_d.return)switch(_d.type){case DECLARATION:_d.return=prefix(_d.value,_d.length);break;case KEYFRAMES:return serialize([copy(_d,{value:replace(_d.value,"@","@"+WEBKIT)})],sp);case RULESET:if(_d.length)return combine(_d.props,function(lp){switch(match(lp,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return serialize([copy(_d,{props:[replace(lp,/:(read-\w+)/,":"+MOZ+"$1")]})],sp);case"::placeholder":return serialize([copy(_d,{props:[replace(lp,/:(plac\w+)/,":"+WEBKIT+"input-$1")]}),copy(_d,{props:[replace(lp,/:(plac\w+)/,":"+MOZ+"$1")]}),copy(_d,{props:[replace(lp,/:(plac\w+)/,MS+"input-$1")]})],sp)}return""})}},defaultStylisPlugins=[prefixer],createCache=function(_d){var np=_d.key;if(np==="css"){var ap=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(ap,function(xp){var _p=xp.getAttribute("data-emotion");_p.indexOf(" ")!==-1&&(document.head.appendChild(xp),xp.setAttribute("data-s",""))})}var sp=_d.stylisPlugins||defaultStylisPlugins,lp={},up,cp=[];up=_d.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+np+' "]'),function(xp){for(var _p=xp.getAttribute("data-emotion").split(" "),vp=1;vp<_p.length;vp++)lp[_p[vp]]=!0;cp.push(xp)});var dp,hp=[compat,removeLabel];{var fp,pp=[stringify$3,rulesheet(function(xp){fp.insert(xp)})],mp=middleware(hp.concat(sp,pp)),gp=function(_p){return serialize(compile(_p),mp)};dp=function(_p,vp,bp,Ep){fp=bp,gp(_p?_p+"{"+vp.styles+"}":vp.styles),Ep&&(yp.inserted[vp.name]=!0)}}var yp={key:np,sheet:new StyleSheet({key:np,container:up,nonce:_d.nonce,speedy:_d.speedy,prepend:_d.prepend,insertionPoint:_d.insertionPoint}),nonce:_d.nonce,inserted:lp,registered:{},insert:dp};return yp.sheet.hydrate(cp),yp},isBrowser=!0;function getRegisteredStyles(rp,_d,np){var ap="";return np.split(" ").forEach(function(sp){rp[sp]!==void 0?_d.push(rp[sp]+";"):ap+=sp+" "}),ap}var registerStyles=function(_d,np,ap){var sp=_d.key+"-"+np.name;(ap===!1||isBrowser===!1)&&_d.registered[sp]===void 0&&(_d.registered[sp]=np.styles)},insertStyles=function(_d,np,ap){registerStyles(_d,np,ap);var sp=_d.key+"-"+np.name;if(_d.inserted[np.name]===void 0){var lp=np;do _d.insert(np===lp?"."+sp:"",lp,_d.sheet,!0),lp=lp.next;while(lp!==void 0)}};function murmur2(rp){for(var _d=0,np,ap=0,sp=rp.length;sp>=4;++ap,sp-=4)np=rp.charCodeAt(ap)&255|(rp.charCodeAt(++ap)&255)<<8|(rp.charCodeAt(++ap)&255)<<16|(rp.charCodeAt(++ap)&255)<<24,np=(np&65535)*1540483477+((np>>>16)*59797<<16),np^=np>>>24,_d=(np&65535)*1540483477+((np>>>16)*59797<<16)^(_d&65535)*1540483477+((_d>>>16)*59797<<16);switch(sp){case 3:_d^=(rp.charCodeAt(ap+2)&255)<<16;case 2:_d^=(rp.charCodeAt(ap+1)&255)<<8;case 1:_d^=rp.charCodeAt(ap)&255,_d=(_d&65535)*1540483477+((_d>>>16)*59797<<16)}return _d^=_d>>>13,_d=(_d&65535)*1540483477+((_d>>>16)*59797<<16),((_d^_d>>>15)>>>0).toString(36)}var unitlessKeys={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function(_d){return _d.charCodeAt(1)===45},isProcessableValue=function(_d){return _d!=null&&typeof _d!="boolean"},processStyleName=memoize$1(function(rp){return isCustomProperty(rp)?rp:rp.replace(hyphenateRegex,"-$&").toLowerCase()}),processStyleValue=function(_d,np){switch(_d){case"animation":case"animationName":if(typeof np=="string")return np.replace(animationRegex,function(ap,sp,lp){return cursor={name:sp,styles:lp,next:cursor},sp})}return unitlessKeys[_d]!==1&&!isCustomProperty(_d)&&typeof np=="number"&&np!==0?np+"px":np},noComponentSelectorMessage="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function handleInterpolation(rp,_d,np){if(np==null)return"";if(np.__emotion_styles!==void 0)return np;switch(typeof np){case"boolean":return"";case"object":{if(np.anim===1)return cursor={name:np.name,styles:np.styles,next:cursor},np.name;if(np.styles!==void 0){var ap=np.next;if(ap!==void 0)for(;ap!==void 0;)cursor={name:ap.name,styles:ap.styles,next:cursor},ap=ap.next;var sp=np.styles+";";return sp}return createStringFromObject(rp,_d,np)}case"function":{if(rp!==void 0){var lp=cursor,up=np(rp);return cursor=lp,handleInterpolation(rp,_d,up)}break}}if(_d==null)return np;var cp=_d[np];return cp!==void 0?cp:np}function createStringFromObject(rp,_d,np){var ap="";if(Array.isArray(np))for(var sp=0;sp<np.length;sp++)ap+=handleInterpolation(rp,_d,np[sp])+";";else for(var lp in np){var up=np[lp];if(typeof up!="object")_d!=null&&_d[up]!==void 0?ap+=lp+"{"+_d[up]+"}":isProcessableValue(up)&&(ap+=processStyleName(lp)+":"+processStyleValue(lp,up)+";");else if(Array.isArray(up)&&typeof up[0]=="string"&&(_d==null||_d[up[0]]===void 0))for(var cp=0;cp<up.length;cp++)isProcessableValue(up[cp])&&(ap+=processStyleName(lp)+":"+processStyleValue(lp,up[cp])+";");else{var dp=handleInterpolation(rp,_d,up);switch(lp){case"animation":case"animationName":{ap+=processStyleName(lp)+":"+dp+";";break}default:ap+=lp+"{"+dp+"}"}}}return ap}var labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g,cursor,serializeStyles=function(_d,np,ap){if(_d.length===1&&typeof _d[0]=="object"&&_d[0]!==null&&_d[0].styles!==void 0)return _d[0];var sp=!0,lp="";cursor=void 0;var up=_d[0];up==null||up.raw===void 0?(sp=!1,lp+=handleInterpolation(ap,np,up)):lp+=up[0];for(var cp=1;cp<_d.length;cp++)lp+=handleInterpolation(ap,np,_d[cp]),sp&&(lp+=up[cp]);labelPattern.lastIndex=0;for(var dp="",hp;(hp=labelPattern.exec(lp))!==null;)dp+="-"+hp[1];var fp=murmur2(lp)+dp;return{name:fp,styles:lp,next:cursor}},syncFallback=function(_d){return _d()},useInsertionEffect=React$1.useInsertionEffect?React$1.useInsertionEffect:!1,useInsertionEffectAlwaysWithSyncFallback=useInsertionEffect||syncFallback,EmotionCacheContext=reactExports.createContext(typeof HTMLElement<"u"?createCache({key:"css"}):null);EmotionCacheContext.Provider;var withEmotionCache=function(_d){return reactExports.forwardRef(function(np,ap){var sp=reactExports.useContext(EmotionCacheContext);return _d(np,sp,ap)})},ThemeContext=reactExports.createContext({}),testOmitPropsOnStringTag=isPropValid,testOmitPropsOnComponent=function(_d){return _d!=="theme"},getDefaultShouldForwardProp=function(_d){return typeof _d=="string"&&_d.charCodeAt(0)>96?testOmitPropsOnStringTag:testOmitPropsOnComponent},composeShouldForwardProps=function(_d,np,ap){var sp;if(np){var lp=np.shouldForwardProp;sp=_d.__emotion_forwardProp&&lp?function(up){return _d.__emotion_forwardProp(up)&&lp(up)}:lp}return typeof sp!="function"&&ap&&(sp=_d.__emotion_forwardProp),sp},Insertion=function(_d){var np=_d.cache,ap=_d.serialized,sp=_d.isStringTag;return registerStyles(np,ap,sp),useInsertionEffectAlwaysWithSyncFallback(function(){return insertStyles(np,ap,sp)}),null},createStyled$1=function rp(_d,np){var ap=_d.__emotion_real===_d,sp=ap&&_d.__emotion_base||_d,lp,up;np!==void 0&&(lp=np.label,up=np.target);var cp=composeShouldForwardProps(_d,np,ap),dp=cp||getDefaultShouldForwardProp(sp),hp=!dp("as");return function(){var fp=arguments,pp=ap&&_d.__emotion_styles!==void 0?_d.__emotion_styles.slice(0):[];if(lp!==void 0&&pp.push("label:"+lp+";"),fp[0]==null||fp[0].raw===void 0)pp.push.apply(pp,fp);else{pp.push(fp[0][0]);for(var mp=fp.length,gp=1;gp<mp;gp++)pp.push(fp[gp],fp[0][gp])}var yp=withEmotionCache(function(xp,_p,vp){var bp=hp&&xp.as||sp,Ep="",Sp=[],Ap=xp;if(xp.theme==null){Ap={};for(var Rp in xp)Ap[Rp]=xp[Rp];Ap.theme=reactExports.useContext(ThemeContext)}typeof xp.className=="string"?Ep=getRegisteredStyles(_p.registered,Sp,xp.className):xp.className!=null&&(Ep=xp.className+" ");var Tp=serializeStyles(pp.concat(Sp),_p.registered,Ap);Ep+=_p.key+"-"+Tp.name,up!==void 0&&(Ep+=" "+up);var Mp=hp&&cp===void 0?getDefaultShouldForwardProp(bp):dp,Op={};for(var Pp in xp)hp&&Pp==="as"||Mp(Pp)&&(Op[Pp]=xp[Pp]);return Op.className=Ep,Op.ref=vp,reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(Insertion,{cache:_p,serialized:Tp,isStringTag:typeof bp=="string"}),reactExports.createElement(bp,Op))});return yp.displayName=lp!==void 0?lp:"Styled("+(typeof sp=="string"?sp:sp.displayName||sp.name||"Component")+")",yp.defaultProps=_d.defaultProps,yp.__emotion_real=yp,yp.__emotion_base=sp,yp.__emotion_styles=pp,yp.__emotion_forwardProp=cp,Object.defineProperty(yp,"toString",{value:function(){return"."+up}}),yp.withComponent=function(xp,_p){return rp(xp,_extends$1({},np,_p,{shouldForwardProp:composeShouldForwardProps(yp,_p,!0)})).apply(void 0,pp)},yp}},tags=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],newStyled=createStyled$1.bind();tags.forEach(function(rp){newStyled[rp]=newStyled(rp)});function styled$1(rp,_d){return newStyled(rp,_d)}const internal_processStyles=(rp,_d)=>{Array.isArray(rp.__emotion_styles)&&(rp.__emotion_styles=_d(rp.__emotion_styles))},_excluded$8=["values","unit","step"],sortBreakpointsValues=rp=>{const _d=Object.keys(rp).map(np=>({key:np,val:rp[np]}))||[];return _d.sort((np,ap)=>np.val-ap.val),_d.reduce((np,ap)=>_extends$1({},np,{[ap.key]:ap.val}),{})};function createBreakpoints(rp){const{values:_d={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:np="px",step:ap=5}=rp,sp=_objectWithoutPropertiesLoose(rp,_excluded$8),lp=sortBreakpointsValues(_d),up=Object.keys(lp);function cp(mp){return`@media (min-width:${typeof _d[mp]=="number"?_d[mp]:mp}${np})`}function dp(mp){return`@media (max-width:${(typeof _d[mp]=="number"?_d[mp]:mp)-ap/100}${np})`}function hp(mp,gp){const yp=up.indexOf(gp);return`@media (min-width:${typeof _d[mp]=="number"?_d[mp]:mp}${np}) and (max-width:${(yp!==-1&&typeof _d[up[yp]]=="number"?_d[up[yp]]:gp)-ap/100}${np})`}function fp(mp){return up.indexOf(mp)+1<up.length?hp(mp,up[up.indexOf(mp)+1]):cp(mp)}function pp(mp){const gp=up.indexOf(mp);return gp===0?cp(up[1]):gp===up.length-1?dp(up[gp]):hp(mp,up[up.indexOf(mp)+1]).replace("@media","@media not all and")}return _extends$1({keys:up,values:lp,up:cp,down:dp,between:hp,only:fp,not:pp,unit:np},sp)}const shape={borderRadius:4},shape$1=shape;function merge$1(rp,_d){return _d?deepmerge(rp,_d,{clone:!1}):rp}const values={xs:0,sm:600,md:900,lg:1200,xl:1536},defaultBreakpoints={keys:["xs","sm","md","lg","xl"],up:rp=>`@media (min-width:${values[rp]}px)`};function handleBreakpoints(rp,_d,np){const ap=rp.theme||{};if(Array.isArray(_d)){const lp=ap.breakpoints||defaultBreakpoints;return _d.reduce((up,cp,dp)=>(up[lp.up(lp.keys[dp])]=np(_d[dp]),up),{})}if(typeof _d=="object"){const lp=ap.breakpoints||defaultBreakpoints;return Object.keys(_d).reduce((up,cp)=>{if(Object.keys(lp.values||values).indexOf(cp)!==-1){const dp=lp.up(cp);up[dp]=np(_d[cp],cp)}else{const dp=cp;up[dp]=_d[dp]}return up},{})}return np(_d)}function createEmptyBreakpointObject(rp={}){var _d;return((_d=rp.keys)==null?void 0:_d.reduce((ap,sp)=>{const lp=rp.up(sp);return ap[lp]={},ap},{}))||{}}function removeUnusedBreakpoints(rp,_d){return rp.reduce((np,ap)=>{const sp=np[ap];return(!sp||Object.keys(sp).length===0)&&delete np[ap],np},_d)}function getPath(rp,_d,np=!0){if(!_d||typeof _d!="string")return null;if(rp&&rp.vars&&np){const ap=`vars.${_d}`.split(".").reduce((sp,lp)=>sp&&sp[lp]?sp[lp]:null,rp);if(ap!=null)return ap}return _d.split(".").reduce((ap,sp)=>ap&&ap[sp]!=null?ap[sp]:null,rp)}function getStyleValue(rp,_d,np,ap=np){let sp;return typeof rp=="function"?sp=rp(np):Array.isArray(rp)?sp=rp[np]||ap:sp=getPath(rp,np)||ap,_d&&(sp=_d(sp,ap,rp)),sp}function style$1(rp){const{prop:_d,cssProperty:np=rp.prop,themeKey:ap,transform:sp}=rp,lp=up=>{if(up[_d]==null)return null;const cp=up[_d],dp=up.theme,hp=getPath(dp,ap)||{};return handleBreakpoints(up,cp,pp=>{let mp=getStyleValue(hp,sp,pp);return pp===mp&&typeof pp=="string"&&(mp=getStyleValue(hp,sp,`${_d}${pp==="default"?"":capitalize(pp)}`,pp)),np===!1?mp:{[np]:mp}})};return lp.propTypes={},lp.filterProps=[_d],lp}function memoize(rp){const _d={};return np=>(_d[np]===void 0&&(_d[np]=rp(np)),_d[np])}const properties={m:"margin",p:"padding"},directions={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},aliases={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},getCssProperties=memoize(rp=>{if(rp.length>2)if(aliases[rp])rp=aliases[rp];else return[rp];const[_d,np]=rp.split(""),ap=properties[_d],sp=directions[np]||"";return Array.isArray(sp)?sp.map(lp=>ap+lp):[ap+sp]}),marginKeys=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],paddingKeys=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...marginKeys,...paddingKeys];function createUnaryUnit(rp,_d,np,ap){var sp;const lp=(sp=getPath(rp,_d,!1))!=null?sp:np;return typeof lp=="number"?up=>typeof up=="string"?up:lp*up:Array.isArray(lp)?up=>typeof up=="string"?up:lp[up]:typeof lp=="function"?lp:()=>{}}function createUnarySpacing(rp){return createUnaryUnit(rp,"spacing",8)}function getValue(rp,_d){if(typeof _d=="string"||_d==null)return _d;const np=Math.abs(_d),ap=rp(np);return _d>=0?ap:typeof ap=="number"?-ap:`-${ap}`}function getStyleFromPropValue(rp,_d){return np=>rp.reduce((ap,sp)=>(ap[sp]=getValue(_d,np),ap),{})}function resolveCssProperty(rp,_d,np,ap){if(_d.indexOf(np)===-1)return null;const sp=getCssProperties(np),lp=getStyleFromPropValue(sp,ap),up=rp[np];return handleBreakpoints(rp,up,lp)}function style(rp,_d){const np=createUnarySpacing(rp.theme);return Object.keys(rp).map(ap=>resolveCssProperty(rp,_d,ap,np)).reduce(merge$1,{})}function margin(rp){return style(rp,marginKeys)}margin.propTypes={};margin.filterProps=marginKeys;function padding(rp){return style(rp,paddingKeys)}padding.propTypes={};padding.filterProps=paddingKeys;function createSpacing(rp=8){if(rp.mui)return rp;const _d=createUnarySpacing({spacing:rp}),np=(...ap)=>(ap.length===0?[1]:ap).map(lp=>{const up=_d(lp);return typeof up=="number"?`${up}px`:up}).join(" ");return np.mui=!0,np}function compose(...rp){const _d=rp.reduce((ap,sp)=>(sp.filterProps.forEach(lp=>{ap[lp]=sp}),ap),{}),np=ap=>Object.keys(ap).reduce((sp,lp)=>_d[lp]?merge$1(sp,_d[lp](ap)):sp,{});return np.propTypes={},np.filterProps=rp.reduce((ap,sp)=>ap.concat(sp.filterProps),[]),np}function borderTransform(rp){return typeof rp!="number"?rp:`${rp}px solid`}function createBorderStyle(rp,_d){return style$1({prop:rp,themeKey:"borders",transform:_d})}const border=createBorderStyle("border",borderTransform),borderTop=createBorderStyle("borderTop",borderTransform),borderRight=createBorderStyle("borderRight",borderTransform),borderBottom=createBorderStyle("borderBottom",borderTransform),borderLeft=createBorderStyle("borderLeft",borderTransform),borderColor=createBorderStyle("borderColor"),borderTopColor=createBorderStyle("borderTopColor"),borderRightColor=createBorderStyle("borderRightColor"),borderBottomColor=createBorderStyle("borderBottomColor"),borderLeftColor=createBorderStyle("borderLeftColor"),outline=createBorderStyle("outline",borderTransform),outlineColor=createBorderStyle("outlineColor"),borderRadius=rp=>{if(rp.borderRadius!==void 0&&rp.borderRadius!==null){const _d=createUnaryUnit(rp.theme,"shape.borderRadius",4),np=ap=>({borderRadius:getValue(_d,ap)});return handleBreakpoints(rp,rp.borderRadius,np)}return null};borderRadius.propTypes={};borderRadius.filterProps=["borderRadius"];compose(border,borderTop,borderRight,borderBottom,borderLeft,borderColor,borderTopColor,borderRightColor,borderBottomColor,borderLeftColor,borderRadius,outline,outlineColor);const gap=rp=>{if(rp.gap!==void 0&&rp.gap!==null){const _d=createUnaryUnit(rp.theme,"spacing",8),np=ap=>({gap:getValue(_d,ap)});return handleBreakpoints(rp,rp.gap,np)}return null};gap.propTypes={};gap.filterProps=["gap"];const columnGap=rp=>{if(rp.columnGap!==void 0&&rp.columnGap!==null){const _d=createUnaryUnit(rp.theme,"spacing",8),np=ap=>({columnGap:getValue(_d,ap)});return handleBreakpoints(rp,rp.columnGap,np)}return null};columnGap.propTypes={};columnGap.filterProps=["columnGap"];const rowGap=rp=>{if(rp.rowGap!==void 0&&rp.rowGap!==null){const _d=createUnaryUnit(rp.theme,"spacing",8),np=ap=>({rowGap:getValue(_d,ap)});return handleBreakpoints(rp,rp.rowGap,np)}return null};rowGap.propTypes={};rowGap.filterProps=["rowGap"];const gridColumn=style$1({prop:"gridColumn"}),gridRow=style$1({prop:"gridRow"}),gridAutoFlow=style$1({prop:"gridAutoFlow"}),gridAutoColumns=style$1({prop:"gridAutoColumns"}),gridAutoRows=style$1({prop:"gridAutoRows"}),gridTemplateColumns=style$1({prop:"gridTemplateColumns"}),gridTemplateRows=style$1({prop:"gridTemplateRows"}),gridTemplateAreas=style$1({prop:"gridTemplateAreas"}),gridArea=style$1({prop:"gridArea"});compose(gap,columnGap,rowGap,gridColumn,gridRow,gridAutoFlow,gridAutoColumns,gridAutoRows,gridTemplateColumns,gridTemplateRows,gridTemplateAreas,gridArea);function paletteTransform(rp,_d){return _d==="grey"?_d:rp}const color$1=style$1({prop:"color",themeKey:"palette",transform:paletteTransform}),bgcolor=style$1({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:paletteTransform}),backgroundColor=style$1({prop:"backgroundColor",themeKey:"palette",transform:paletteTransform});compose(color$1,bgcolor,backgroundColor);function sizingTransform(rp){return rp<=1&&rp!==0?`${rp*100}%`:rp}const width=style$1({prop:"width",transform:sizingTransform}),maxWidth=rp=>{if(rp.maxWidth!==void 0&&rp.maxWidth!==null){const _d=np=>{var ap,sp;const lp=((ap=rp.theme)==null||(ap=ap.breakpoints)==null||(ap=ap.values)==null?void 0:ap[np])||values[np];return lp?((sp=rp.theme)==null||(sp=sp.breakpoints)==null?void 0:sp.unit)!=="px"?{maxWidth:`${lp}${rp.theme.breakpoints.unit}`}:{maxWidth:lp}:{maxWidth:sizingTransform(np)}};return handleBreakpoints(rp,rp.maxWidth,_d)}return null};maxWidth.filterProps=["maxWidth"];const minWidth=style$1({prop:"minWidth",transform:sizingTransform}),height=style$1({prop:"height",transform:sizingTransform}),maxHeight=style$1({prop:"maxHeight",transform:sizingTransform}),minHeight=style$1({prop:"minHeight",transform:sizingTransform});style$1({prop:"size",cssProperty:"width",transform:sizingTransform});style$1({prop:"size",cssProperty:"height",transform:sizingTransform});const boxSizing=style$1({prop:"boxSizing"});compose(width,maxWidth,minWidth,height,maxHeight,minHeight,boxSizing);const defaultSxConfig={border:{themeKey:"borders",transform:borderTransform},borderTop:{themeKey:"borders",transform:borderTransform},borderRight:{themeKey:"borders",transform:borderTransform},borderBottom:{themeKey:"borders",transform:borderTransform},borderLeft:{themeKey:"borders",transform:borderTransform},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:borderTransform},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:borderRadius},color:{themeKey:"palette",transform:paletteTransform},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:paletteTransform},backgroundColor:{themeKey:"palette",transform:paletteTransform},p:{style:padding},pt:{style:padding},pr:{style:padding},pb:{style:padding},pl:{style:padding},px:{style:padding},py:{style:padding},padding:{style:padding},paddingTop:{style:padding},paddingRight:{style:padding},paddingBottom:{style:padding},paddingLeft:{style:padding},paddingX:{style:padding},paddingY:{style:padding},paddingInline:{style:padding},paddingInlineStart:{style:padding},paddingInlineEnd:{style:padding},paddingBlock:{style:padding},paddingBlockStart:{style:padding},paddingBlockEnd:{style:padding},m:{style:margin},mt:{style:margin},mr:{style:margin},mb:{style:margin},ml:{style:margin},mx:{style:margin},my:{style:margin},margin:{style:margin},marginTop:{style:margin},marginRight:{style:margin},marginBottom:{style:margin},marginLeft:{style:margin},marginX:{style:margin},marginY:{style:margin},marginInline:{style:margin},marginInlineStart:{style:margin},marginInlineEnd:{style:margin},marginBlock:{style:margin},marginBlockStart:{style:margin},marginBlockEnd:{style:margin},displayPrint:{cssProperty:!1,transform:rp=>({"@media print":{display:rp}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:gap},rowGap:{style:rowGap},columnGap:{style:columnGap},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:sizingTransform},maxWidth:{style:maxWidth},minWidth:{transform:sizingTransform},height:{transform:sizingTransform},maxHeight:{transform:sizingTransform},minHeight:{transform:sizingTransform},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},defaultSxConfig$1=defaultSxConfig;function objectsHaveSameKeys(...rp){const _d=rp.reduce((ap,sp)=>ap.concat(Object.keys(sp)),[]),np=new Set(_d);return rp.every(ap=>np.size===Object.keys(ap).length)}function callIfFn(rp,_d){return typeof rp=="function"?rp(_d):rp}function unstable_createStyleFunctionSx(){function rp(np,ap,sp,lp){const up={[np]:ap,theme:sp},cp=lp[np];if(!cp)return{[np]:ap};const{cssProperty:dp=np,themeKey:hp,transform:fp,style:pp}=cp;if(ap==null)return null;if(hp==="typography"&&ap==="inherit")return{[np]:ap};const mp=getPath(sp,hp)||{};return pp?pp(up):handleBreakpoints(up,ap,yp=>{let xp=getStyleValue(mp,fp,yp);return yp===xp&&typeof yp=="string"&&(xp=getStyleValue(mp,fp,`${np}${yp==="default"?"":capitalize(yp)}`,yp)),dp===!1?xp:{[dp]:xp}})}function _d(np){var ap;const{sx:sp,theme:lp={}}=np||{};if(!sp)return null;const up=(ap=lp.unstable_sxConfig)!=null?ap:defaultSxConfig$1;function cp(dp){let hp=dp;if(typeof dp=="function")hp=dp(lp);else if(typeof dp!="object")return dp;if(!hp)return null;const fp=createEmptyBreakpointObject(lp.breakpoints),pp=Object.keys(fp);let mp=fp;return Object.keys(hp).forEach(gp=>{const yp=callIfFn(hp[gp],lp);if(yp!=null)if(typeof yp=="object")if(up[gp])mp=merge$1(mp,rp(gp,yp,lp,up));else{const xp=handleBreakpoints({theme:lp},yp,_p=>({[gp]:_p}));objectsHaveSameKeys(xp,yp)?mp[gp]=_d({sx:yp,theme:lp}):mp=merge$1(mp,xp)}else mp=merge$1(mp,rp(gp,yp,lp,up))}),removeUnusedBreakpoints(pp,mp)}return Array.isArray(sp)?sp.map(cp):cp(sp)}return _d}const styleFunctionSx=unstable_createStyleFunctionSx();styleFunctionSx.filterProps=["sx"];const _excluded$7=["breakpoints","palette","spacing","shape"];function createTheme$1(rp={},..._d){const{breakpoints:np={},palette:ap={},spacing:sp,shape:lp={}}=rp,up=_objectWithoutPropertiesLoose(rp,_excluded$7),cp=createBreakpoints(np),dp=createSpacing(sp);let hp=deepmerge({breakpoints:cp,direction:"ltr",components:{},palette:_extends$1({mode:"light"},ap),spacing:dp,shape:_extends$1({},shape$1,lp)},up);return hp=_d.reduce((fp,pp)=>deepmerge(fp,pp),hp),hp.unstable_sxConfig=_extends$1({},defaultSxConfig$1,up==null?void 0:up.unstable_sxConfig),hp.unstable_sx=function(pp){return styleFunctionSx({sx:pp,theme:this})},hp}function isObjectEmpty$1(rp){return Object.keys(rp).length===0}function useTheme$1(rp=null){const _d=reactExports.useContext(ThemeContext);return!_d||isObjectEmpty$1(_d)?rp:_d}const systemDefaultTheme$1=createTheme$1();function useTheme(rp=systemDefaultTheme$1){return useTheme$1(rp)}const _excluded$6=["variant"];function isEmpty$1(rp){return rp.length===0}function propsToClassKey(rp){const{variant:_d}=rp,np=_objectWithoutPropertiesLoose(rp,_excluded$6);let ap=_d||"";return Object.keys(np).sort().forEach(sp=>{sp==="color"?ap+=isEmpty$1(ap)?rp[sp]:capitalize(rp[sp]):ap+=`${isEmpty$1(ap)?sp:capitalize(sp)}${capitalize(rp[sp].toString())}`}),ap}const _excluded$5=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function isEmpty(rp){return Object.keys(rp).length===0}function isStringTag(rp){return typeof rp=="string"&&rp.charCodeAt(0)>96}const getStyleOverrides=(rp,_d)=>_d.components&&_d.components[rp]&&_d.components[rp].styleOverrides?_d.components[rp].styleOverrides:null,transformVariants=rp=>{let _d=0;const np={};return rp&&rp.forEach(ap=>{let sp="";typeof ap.props=="function"?(sp=`callback${_d}`,_d+=1):sp=propsToClassKey(ap.props),np[sp]=ap.style}),np},getVariantStyles=(rp,_d)=>{let np=[];return _d&&_d.components&&_d.components[rp]&&_d.components[rp].variants&&(np=_d.components[rp].variants),transformVariants(np)},variantsResolver=(rp,_d,np)=>{const{ownerState:ap={}}=rp,sp=[];let lp=0;return np&&np.forEach(up=>{let cp=!0;if(typeof up.props=="function"){const dp=_extends$1({},rp,ap);cp=up.props(dp)}else Object.keys(up.props).forEach(dp=>{ap[dp]!==up.props[dp]&&rp[dp]!==up.props[dp]&&(cp=!1)});cp&&(typeof up.props=="function"?sp.push(_d[`callback${lp}`]):sp.push(_d[propsToClassKey(up.props)])),typeof up.props=="function"&&(lp+=1)}),sp},themeVariantsResolver=(rp,_d,np,ap)=>{var sp;const lp=np==null||(sp=np.components)==null||(sp=sp[ap])==null?void 0:sp.variants;return variantsResolver(rp,_d,lp)};function shouldForwardProp(rp){return rp!=="ownerState"&&rp!=="theme"&&rp!=="sx"&&rp!=="as"}const systemDefaultTheme=createTheme$1(),lowercaseFirstLetter=rp=>rp&&rp.charAt(0).toLowerCase()+rp.slice(1);function resolveTheme({defaultTheme:rp,theme:_d,themeId:np}){return isEmpty(_d)?rp:_d[np]||_d}function defaultOverridesResolver(rp){return rp?(_d,np)=>np[rp]:null}const muiStyledFunctionResolver=({styledArg:rp,props:_d,defaultTheme:np,themeId:ap})=>{const sp=rp(_extends$1({},_d,{theme:resolveTheme(_extends$1({},_d,{defaultTheme:np,themeId:ap}))}));let lp;if(sp&&sp.variants&&(lp=sp.variants,delete sp.variants),lp){const up=variantsResolver(_d,transformVariants(lp),lp);return[sp,...up]}return sp};function createStyled(rp={}){const{themeId:_d,defaultTheme:np=systemDefaultTheme,rootShouldForwardProp:ap=shouldForwardProp,slotShouldForwardProp:sp=shouldForwardProp}=rp,lp=up=>styleFunctionSx(_extends$1({},up,{theme:resolveTheme(_extends$1({},up,{defaultTheme:np,themeId:_d}))}));return lp.__mui_systemSx=!0,(up,cp={})=>{internal_processStyles(up,Sp=>Sp.filter(Ap=>!(Ap!=null&&Ap.__mui_systemSx)));const{name:dp,slot:hp,skipVariantsResolver:fp,skipSx:pp,overridesResolver:mp=defaultOverridesResolver(lowercaseFirstLetter(hp))}=cp,gp=_objectWithoutPropertiesLoose(cp,_excluded$5),yp=fp!==void 0?fp:hp&&hp!=="Root"&&hp!=="root"||!1,xp=pp||!1;let _p,vp=shouldForwardProp;hp==="Root"||hp==="root"?vp=ap:hp?vp=sp:isStringTag(up)&&(vp=void 0);const bp=styled$1(up,_extends$1({shouldForwardProp:vp,label:_p},gp)),Ep=(Sp,...Ap)=>{const Rp=Ap?Ap.map(Pp=>{if(typeof Pp=="function"&&Pp.__emotion_real!==Pp)return $p=>muiStyledFunctionResolver({styledArg:Pp,props:$p,defaultTheme:np,themeId:_d});if(isPlainObject$2(Pp)){let $p=Pp,zp;return Pp&&Pp.variants&&(zp=Pp.variants,delete $p.variants,$p=Dp=>{let Fp=Pp;return variantsResolver(Dp,transformVariants(zp),zp).forEach(Lp=>{Fp=deepmerge(Fp,Lp)}),Fp}),$p}return Pp}):[];let Tp=Sp;if(isPlainObject$2(Sp)){let Pp;Sp&&Sp.variants&&(Pp=Sp.variants,delete Tp.variants,Tp=$p=>{let zp=Sp;return variantsResolver($p,transformVariants(Pp),Pp).forEach(Fp=>{zp=deepmerge(zp,Fp)}),zp})}else typeof Sp=="function"&&Sp.__emotion_real!==Sp&&(Tp=Pp=>muiStyledFunctionResolver({styledArg:Sp,props:Pp,defaultTheme:np,themeId:_d}));dp&&mp&&Rp.push(Pp=>{const $p=resolveTheme(_extends$1({},Pp,{defaultTheme:np,themeId:_d})),zp=getStyleOverrides(dp,$p);if(zp){const Dp={};return Object.entries(zp).forEach(([Fp,jp])=>{Dp[Fp]=typeof jp=="function"?jp(_extends$1({},Pp,{theme:$p})):jp}),mp(Pp,Dp)}return null}),dp&&!yp&&Rp.push(Pp=>{const $p=resolveTheme(_extends$1({},Pp,{defaultTheme:np,themeId:_d}));return themeVariantsResolver(Pp,getVariantStyles(dp,$p),$p,dp)}),xp||Rp.push(lp);const Mp=Rp.length-Ap.length;if(Array.isArray(Sp)&&Mp>0){const Pp=new Array(Mp).fill("");Tp=[...Sp,...Pp],Tp.raw=[...Sp.raw,...Pp]}const Op=bp(Tp,...Rp);return up.muiName&&(Op.muiName=up.muiName),Op};return bp.withConfig&&(Ep.withConfig=bp.withConfig),Ep}}function getThemeProps(rp){const{theme:_d,name:np,props:ap}=rp;return!_d||!_d.components||!_d.components[np]||!_d.components[np].defaultProps?ap:resolveProps(_d.components[np].defaultProps,ap)}function useThemeProps$1({props:rp,name:_d,defaultTheme:np,themeId:ap}){let sp=useTheme(np);return ap&&(sp=sp[ap]||sp),getThemeProps({theme:sp,name:_d,props:rp})}function clampWrapper(rp,_d=0,np=1){return clamp$1(rp,_d,np)}function hexToRgb(rp){rp=rp.slice(1);const _d=new RegExp(`.{1,${rp.length>=6?2:1}}`,"g");let np=rp.match(_d);return np&&np[0].length===1&&(np=np.map(ap=>ap+ap)),np?`rgb${np.length===4?"a":""}(${np.map((ap,sp)=>sp<3?parseInt(ap,16):Math.round(parseInt(ap,16)/255*1e3)/1e3).join(", ")})`:""}function decomposeColor(rp){if(rp.type)return rp;if(rp.charAt(0)==="#")return decomposeColor(hexToRgb(rp));const _d=rp.indexOf("("),np=rp.substring(0,_d);if(["rgb","rgba","hsl","hsla","color"].indexOf(np)===-1)throw new Error(formatMuiErrorMessage(9,rp));let ap=rp.substring(_d+1,rp.length-1),sp;if(np==="color"){if(ap=ap.split(" "),sp=ap.shift(),ap.length===4&&ap[3].charAt(0)==="/"&&(ap[3]=ap[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(sp)===-1)throw new Error(formatMuiErrorMessage(10,sp))}else ap=ap.split(",");return ap=ap.map(lp=>parseFloat(lp)),{type:np,values:ap,colorSpace:sp}}function recomposeColor(rp){const{type:_d,colorSpace:np}=rp;let{values:ap}=rp;return _d.indexOf("rgb")!==-1?ap=ap.map((sp,lp)=>lp<3?parseInt(sp,10):sp):_d.indexOf("hsl")!==-1&&(ap[1]=`${ap[1]}%`,ap[2]=`${ap[2]}%`),_d.indexOf("color")!==-1?ap=`${np} ${ap.join(" ")}`:ap=`${ap.join(", ")}`,`${_d}(${ap})`}function hslToRgb(rp){rp=decomposeColor(rp);const{values:_d}=rp,np=_d[0],ap=_d[1]/100,sp=_d[2]/100,lp=ap*Math.min(sp,1-sp),up=(hp,fp=(hp+np/30)%12)=>sp-lp*Math.max(Math.min(fp-3,9-fp,1),-1);let cp="rgb";const dp=[Math.round(up(0)*255),Math.round(up(8)*255),Math.round(up(4)*255)];return rp.type==="hsla"&&(cp+="a",dp.push(_d[3])),recomposeColor({type:cp,values:dp})}function getLuminance(rp){rp=decomposeColor(rp);let _d=rp.type==="hsl"||rp.type==="hsla"?decomposeColor(hslToRgb(rp)).values:rp.values;return _d=_d.map(np=>(rp.type!=="color"&&(np/=255),np<=.03928?np/12.92:((np+.055)/1.055)**2.4)),Number((.2126*_d[0]+.7152*_d[1]+.0722*_d[2]).toFixed(3))}function getContrastRatio(rp,_d){const np=getLuminance(rp),ap=getLuminance(_d);return(Math.max(np,ap)+.05)/(Math.min(np,ap)+.05)}function darken(rp,_d){if(rp=decomposeColor(rp),_d=clampWrapper(_d),rp.type.indexOf("hsl")!==-1)rp.values[2]*=1-_d;else if(rp.type.indexOf("rgb")!==-1||rp.type.indexOf("color")!==-1)for(let np=0;np<3;np+=1)rp.values[np]*=1-_d;return recomposeColor(rp)}function lighten(rp,_d){if(rp=decomposeColor(rp),_d=clampWrapper(_d),rp.type.indexOf("hsl")!==-1)rp.values[2]+=(100-rp.values[2])*_d;else if(rp.type.indexOf("rgb")!==-1)for(let np=0;np<3;np+=1)rp.values[np]+=(255-rp.values[np])*_d;else if(rp.type.indexOf("color")!==-1)for(let np=0;np<3;np+=1)rp.values[np]+=(1-rp.values[np])*_d;return recomposeColor(rp)}function createMixins(rp,_d){return _extends$1({toolbar:{minHeight:56,[rp.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[rp.up("sm")]:{minHeight:64}}},_d)}const common$1={black:"#000",white:"#fff"},common$2=common$1,grey={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},grey$1=grey,purple={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},purple$1=purple,red={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},red$1=red,orange={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},orange$1=orange,blue={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},blue$1=blue,lightBlue={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},lightBlue$1=lightBlue,green={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},green$1=green,_excluded$4=["mode","contrastThreshold","tonalOffset"],light={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:common$2.white,default:common$2.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},dark={text:{primary:common$2.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:common$2.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function addLightOrDark(rp,_d,np,ap){const sp=ap.light||ap,lp=ap.dark||ap*1.5;rp[_d]||(rp.hasOwnProperty(np)?rp[_d]=rp[np]:_d==="light"?rp.light=lighten(rp.main,sp):_d==="dark"&&(rp.dark=darken(rp.main,lp)))}function getDefaultPrimary(rp="light"){return rp==="dark"?{main:blue$1[200],light:blue$1[50],dark:blue$1[400]}:{main:blue$1[700],light:blue$1[400],dark:blue$1[800]}}function getDefaultSecondary(rp="light"){return rp==="dark"?{main:purple$1[200],light:purple$1[50],dark:purple$1[400]}:{main:purple$1[500],light:purple$1[300],dark:purple$1[700]}}function getDefaultError(rp="light"){return rp==="dark"?{main:red$1[500],light:red$1[300],dark:red$1[700]}:{main:red$1[700],light:red$1[400],dark:red$1[800]}}function getDefaultInfo(rp="light"){return rp==="dark"?{main:lightBlue$1[400],light:lightBlue$1[300],dark:lightBlue$1[700]}:{main:lightBlue$1[700],light:lightBlue$1[500],dark:lightBlue$1[900]}}function getDefaultSuccess(rp="light"){return rp==="dark"?{main:green$1[400],light:green$1[300],dark:green$1[700]}:{main:green$1[800],light:green$1[500],dark:green$1[900]}}function getDefaultWarning(rp="light"){return rp==="dark"?{main:orange$1[400],light:orange$1[300],dark:orange$1[700]}:{main:"#ed6c02",light:orange$1[500],dark:orange$1[900]}}function createPalette(rp){const{mode:_d="light",contrastThreshold:np=3,tonalOffset:ap=.2}=rp,sp=_objectWithoutPropertiesLoose(rp,_excluded$4),lp=rp.primary||getDefaultPrimary(_d),up=rp.secondary||getDefaultSecondary(_d),cp=rp.error||getDefaultError(_d),dp=rp.info||getDefaultInfo(_d),hp=rp.success||getDefaultSuccess(_d),fp=rp.warning||getDefaultWarning(_d);function pp(xp){return getContrastRatio(xp,dark.text.primary)>=np?dark.text.primary:light.text.primary}const mp=({color:xp,name:_p,mainShade:vp=500,lightShade:bp=300,darkShade:Ep=700})=>{if(xp=_extends$1({},xp),!xp.main&&xp[vp]&&(xp.main=xp[vp]),!xp.hasOwnProperty("main"))throw new Error(formatMuiErrorMessage(11,_p?` (${_p})`:"",vp));if(typeof xp.main!="string")throw new Error(formatMuiErrorMessage(12,_p?` (${_p})`:"",JSON.stringify(xp.main)));return addLightOrDark(xp,"light",bp,ap),addLightOrDark(xp,"dark",Ep,ap),xp.contrastText||(xp.contrastText=pp(xp.main)),xp},gp={dark,light};return deepmerge(_extends$1({common:_extends$1({},common$2),mode:_d,primary:mp({color:lp,name:"primary"}),secondary:mp({color:up,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:mp({color:cp,name:"error"}),warning:mp({color:fp,name:"warning"}),info:mp({color:dp,name:"info"}),success:mp({color:hp,name:"success"}),grey:grey$1,contrastThreshold:np,getContrastText:pp,augmentColor:mp,tonalOffset:ap},gp[_d]),sp)}const _excluded$3=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function round(rp){return Math.round(rp*1e5)/1e5}const caseAllCaps={textTransform:"uppercase"},defaultFontFamily='"Roboto", "Helvetica", "Arial", sans-serif';function createTypography(rp,_d){const np=typeof _d=="function"?_d(rp):_d,{fontFamily:ap=defaultFontFamily,fontSize:sp=14,fontWeightLight:lp=300,fontWeightRegular:up=400,fontWeightMedium:cp=500,fontWeightBold:dp=700,htmlFontSize:hp=16,allVariants:fp,pxToRem:pp}=np,mp=_objectWithoutPropertiesLoose(np,_excluded$3),gp=sp/14,yp=pp||(vp=>`${vp/hp*gp}rem`),xp=(vp,bp,Ep,Sp,Ap)=>_extends$1({fontFamily:ap,fontWeight:vp,fontSize:yp(bp),lineHeight:Ep},ap===defaultFontFamily?{letterSpacing:`${round(Sp/bp)}em`}:{},Ap,fp),_p={h1:xp(lp,96,1.167,-1.5),h2:xp(lp,60,1.2,-.5),h3:xp(up,48,1.167,0),h4:xp(up,34,1.235,.25),h5:xp(up,24,1.334,0),h6:xp(cp,20,1.6,.15),subtitle1:xp(up,16,1.75,.15),subtitle2:xp(cp,14,1.57,.1),body1:xp(up,16,1.5,.15),body2:xp(up,14,1.43,.15),button:xp(cp,14,1.75,.4,caseAllCaps),caption:xp(up,12,1.66,.4),overline:xp(up,12,2.66,1,caseAllCaps),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return deepmerge(_extends$1({htmlFontSize:hp,pxToRem:yp,fontFamily:ap,fontSize:sp,fontWeightLight:lp,fontWeightRegular:up,fontWeightMedium:cp,fontWeightBold:dp},_p),mp,{clone:!1})}const shadowKeyUmbraOpacity=.2,shadowKeyPenumbraOpacity=.14,shadowAmbientShadowOpacity=.12;function createShadow(...rp){return[`${rp[0]}px ${rp[1]}px ${rp[2]}px ${rp[3]}px rgba(0,0,0,${shadowKeyUmbraOpacity})`,`${rp[4]}px ${rp[5]}px ${rp[6]}px ${rp[7]}px rgba(0,0,0,${shadowKeyPenumbraOpacity})`,`${rp[8]}px ${rp[9]}px ${rp[10]}px ${rp[11]}px rgba(0,0,0,${shadowAmbientShadowOpacity})`].join(",")}const shadows=["none",createShadow(0,2,1,-1,0,1,1,0,0,1,3,0),createShadow(0,3,1,-2,0,2,2,0,0,1,5,0),createShadow(0,3,3,-2,0,3,4,0,0,1,8,0),createShadow(0,2,4,-1,0,4,5,0,0,1,10,0),createShadow(0,3,5,-1,0,5,8,0,0,1,14,0),createShadow(0,3,5,-1,0,6,10,0,0,1,18,0),createShadow(0,4,5,-2,0,7,10,1,0,2,16,1),createShadow(0,5,5,-3,0,8,10,1,0,3,14,2),createShadow(0,5,6,-3,0,9,12,1,0,3,16,2),createShadow(0,6,6,-3,0,10,14,1,0,4,18,3),createShadow(0,6,7,-4,0,11,15,1,0,4,20,3),createShadow(0,7,8,-4,0,12,17,2,0,5,22,4),createShadow(0,7,8,-4,0,13,19,2,0,5,24,4),createShadow(0,7,9,-4,0,14,21,2,0,5,26,4),createShadow(0,8,9,-5,0,15,22,2,0,6,28,5),createShadow(0,8,10,-5,0,16,24,2,0,6,30,5),createShadow(0,8,11,-5,0,17,26,2,0,6,32,5),createShadow(0,9,11,-5,0,18,28,2,0,7,34,6),createShadow(0,9,12,-6,0,19,29,2,0,7,36,6),createShadow(0,10,13,-6,0,20,31,3,0,8,38,7),createShadow(0,10,13,-6,0,21,33,3,0,8,40,7),createShadow(0,10,14,-6,0,22,35,3,0,8,42,7),createShadow(0,11,14,-7,0,23,36,3,0,9,44,8),createShadow(0,11,15,-7,0,24,38,3,0,9,46,8)],_excluded$2=["duration","easing","delay"],easing={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},duration={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function formatMs(rp){return`${Math.round(rp)}ms`}function getAutoHeightDuration(rp){if(!rp)return 0;const _d=rp/36;return Math.round((4+15*_d**.25+_d/5)*10)}function createTransitions(rp){const _d=_extends$1({},easing,rp.easing),np=_extends$1({},duration,rp.duration);return _extends$1({getAutoHeightDuration,create:(sp=["all"],lp={})=>{const{duration:up=np.standard,easing:cp=_d.easeInOut,delay:dp=0}=lp;return _objectWithoutPropertiesLoose(lp,_excluded$2),(Array.isArray(sp)?sp:[sp]).map(hp=>`${hp} ${typeof up=="string"?up:formatMs(up)} ${cp} ${typeof dp=="string"?dp:formatMs(dp)}`).join(",")}},rp,{easing:_d,duration:np})}const zIndex={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},zIndex$1=zIndex,_excluded$1=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function createTheme(rp={},..._d){const{mixins:np={},palette:ap={},transitions:sp={},typography:lp={}}=rp,up=_objectWithoutPropertiesLoose(rp,_excluded$1);if(rp.vars)throw new Error(formatMuiErrorMessage(18));const cp=createPalette(ap),dp=createTheme$1(rp);let hp=deepmerge(dp,{mixins:createMixins(dp.breakpoints,np),palette:cp,shadows:shadows.slice(),typography:createTypography(cp,lp),transitions:createTransitions(sp),zIndex:_extends$1({},zIndex$1),applyDarkStyles(fp){return this.vars?{[this.getColorSchemeSelector("dark").replace(/(\[[^\]]+\])/,":where($1)")]:fp}:this.palette.mode==="dark"?fp:{}}});return hp=deepmerge(hp,up),hp=_d.reduce((fp,pp)=>deepmerge(fp,pp),hp),hp.unstable_sxConfig=_extends$1({},defaultSxConfig$1,up==null?void 0:up.unstable_sxConfig),hp.unstable_sx=function(pp){return styleFunctionSx({sx:pp,theme:this})},hp}const defaultTheme=createTheme(),defaultTheme$1=defaultTheme,THEME_ID="$$material";function useThemeProps({props:rp,name:_d}){return useThemeProps$1({props:rp,name:_d,defaultTheme:defaultTheme$1,themeId:THEME_ID})}const rootShouldForwardProp=rp=>shouldForwardProp(rp)&&rp!=="classes",styled=createStyled({themeId:THEME_ID,defaultTheme:defaultTheme$1,rootShouldForwardProp});function getSvgIconUtilityClass(rp){return generateUtilityClass("MuiSvgIcon",rp)}generateUtilityClasses("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _excluded=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],useUtilityClasses=rp=>{const{color:_d,fontSize:np,classes:ap}=rp,sp={root:["root",_d!=="inherit"&&`color${capitalize(_d)}`,`fontSize${capitalize(np)}`]};return composeClasses(sp,getSvgIconUtilityClass,ap)},SvgIconRoot=styled("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(rp,_d)=>{const{ownerState:np}=rp;return[_d.root,np.color!=="inherit"&&_d[`color${capitalize(np.color)}`],_d[`fontSize${capitalize(np.fontSize)}`]]}})(({theme:rp,ownerState:_d})=>{var np,ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:_d.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(np=rp.transitions)==null||(ap=np.create)==null?void 0:ap.call(np,"fill",{duration:(sp=rp.transitions)==null||(sp=sp.duration)==null?void 0:sp.shorter}),fontSize:{inherit:"inherit",small:((lp=rp.typography)==null||(up=lp.pxToRem)==null?void 0:up.call(lp,20))||"1.25rem",medium:((cp=rp.typography)==null||(dp=cp.pxToRem)==null?void 0:dp.call(cp,24))||"1.5rem",large:((hp=rp.typography)==null||(fp=hp.pxToRem)==null?void 0:fp.call(hp,35))||"2.1875rem"}[_d.fontSize],color:(pp=(mp=(rp.vars||rp).palette)==null||(mp=mp[_d.color])==null?void 0:mp.main)!=null?pp:{action:(gp=(rp.vars||rp).palette)==null||(gp=gp.action)==null?void 0:gp.active,disabled:(yp=(rp.vars||rp).palette)==null||(yp=yp.action)==null?void 0:yp.disabled,inherit:void 0}[_d.color]}}),SvgIcon=reactExports.forwardRef(function(_d,np){const ap=useThemeProps({props:_d,name:"MuiSvgIcon"}),{children:sp,className:lp,color:up="inherit",component:cp="svg",fontSize:dp="medium",htmlColor:hp,inheritViewBox:fp=!1,titleAccess:pp,viewBox:mp="0 0 24 24"}=ap,gp=_objectWithoutPropertiesLoose(ap,_excluded),yp=reactExports.isValidElement(sp)&&sp.type==="svg",xp=_extends$1({},ap,{color:up,component:cp,fontSize:dp,instanceFontSize:_d.fontSize,inheritViewBox:fp,viewBox:mp,hasSvgAsChild:yp}),_p={};fp||(_p.viewBox=mp);const vp=useUtilityClasses(xp);return jsxRuntimeExports.jsxs(SvgIconRoot,_extends$1({as:cp,className:clsx(vp.root,lp),focusable:"false",color:hp,"aria-hidden":pp?void 0:!0,role:pp?"img":void 0,ref:np},_p,gp,yp&&sp.props,{ownerState:xp,children:[yp?sp.props.children:sp,pp?jsxRuntimeExports.jsx("title",{children:pp}):null]}))});SvgIcon.muiName="SvgIcon";function createSvgIcon(rp,_d){function np(ap,sp){return jsxRuntimeExports.jsx(SvgIcon,_extends$1({"data-testid":`${_d}Icon`,ref:sp},ap,{children:rp}))}return np.muiName=SvgIcon.muiName,reactExports.memo(reactExports.forwardRef(np))}const unstable_ClassNameGenerator={configure:rp=>{ClassNameGenerator.configure(rp)}},utils$2=Object.freeze(Object.defineProperty({__proto__:null,capitalize,createChainedFunction,createSvgIcon,debounce:debounce$2,deprecatedPropType,isMuiElement,ownerDocument,ownerWindow,requirePropFactory,setRef,unstable_ClassNameGenerator,unstable_useEnhancedEffect:useEnhancedEffect$1,unstable_useId:useId,unsupportedProp,useControlled,useEventCallback,useForkRef,useIsFocusVisible},Symbol.toStringTag,{value:"Module"})),require$$0$3=getAugmentedNamespace(utils$2);var hasRequiredCreateSvgIcon;function requireCreateSvgIcon(){return hasRequiredCreateSvgIcon||(hasRequiredCreateSvgIcon=1,function(rp){"use client";Object.defineProperty(rp,"__esModule",{value:!0}),Object.defineProperty(rp,"default",{enumerable:!0,get:function(){return _d.createSvgIcon}});var _d=require$$0$3}(createSvgIcon$1)),createSvgIcon$1}var _interopRequireDefault$P=interopRequireDefaultExports;Object.defineProperty(PersonOutlineOutlined,"__esModule",{value:!0});var default_1$A=PersonOutlineOutlined.default=void 0,_createSvgIcon$A=_interopRequireDefault$P(requireCreateSvgIcon()),_jsxRuntime$A=jsxRuntimeExports;default_1$A=PersonOutlineOutlined.default=(0,_createSvgIcon$A.default)((0,_jsxRuntime$A.jsx)("path",{d:"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4"}),"PersonOutlineOutlined");var Camera$1={},_interopRequireDefault$O=interopRequireDefaultExports;Object.defineProperty(Camera$1,"__esModule",{value:!0});var default_1$z=Camera$1.default=void 0,_createSvgIcon$z=_interopRequireDefault$O(requireCreateSvgIcon()),_jsxRuntime$z=jsxRuntimeExports;default_1$z=Camera$1.default=(0,_createSvgIcon$z.default)((0,_jsxRuntime$z.jsx)("path",{d:"m9.4 10.5 4.77-8.26C13.47 2.09 12.75 2 12 2c-2.4 0-4.6.85-6.32 2.25l3.66 6.35zM21.54 9c-.92-2.92-3.15-5.26-6-6.34L11.88 9zm.26 1h-7.49l.29.5 4.76 8.25C21 16.97 22 14.61 22 12c0-.69-.07-1.35-.2-2M8.54 12l-3.9-6.75C3.01 7.03 2 9.39 2 12c0 .69.07 1.35.2 2h7.49zm-6.08 3c.92 2.92 3.15 5.26 6 6.34L12.12 15zm11.27 0-3.9 6.76c.7.15 1.42.24 2.17.24 2.4 0 4.6-.85 6.32-2.25l-3.66-6.35z"}),"Camera");var DashboardOutlined={},_interopRequireDefault$N=interopRequireDefaultExports;Object.defineProperty(DashboardOutlined,"__esModule",{value:!0});var default_1$y=DashboardOutlined.default=void 0,_createSvgIcon$y=_interopRequireDefault$N(requireCreateSvgIcon()),_jsxRuntime$y=jsxRuntimeExports;default_1$y=DashboardOutlined.default=(0,_createSvgIcon$y.default)((0,_jsxRuntime$y.jsx)("path",{d:"M19 5v2h-4V5zM9 5v6H5V5zm10 8v6h-4v-6zM9 17v2H5v-2zM21 3h-8v6h8zM11 3H3v10h8zm10 8h-8v10h8zm-10 4H3v6h8z"}),"DashboardOutlined");var HomeOutlined={},_interopRequireDefault$M=interopRequireDefaultExports;Object.defineProperty(HomeOutlined,"__esModule",{value:!0});var default_1$x=HomeOutlined.default=void 0,_createSvgIcon$x=_interopRequireDefault$M(requireCreateSvgIcon()),_jsxRuntime$x=jsxRuntimeExports;default_1$x=HomeOutlined.default=(0,_createSvgIcon$x.default)((0,_jsxRuntime$x.jsx)("path",{d:"m12 5.69 5 4.5V18h-2v-6H9v6H7v-7.81zM12 3 2 12h3v8h6v-6h2v6h6v-8h3z"}),"HomeOutlined");var LocationOnOutlined={},_interopRequireDefault$L=interopRequireDefaultExports;Object.defineProperty(LocationOnOutlined,"__esModule",{value:!0});var default_1$w=LocationOnOutlined.default=void 0,_createSvgIcon$w=_interopRequireDefault$L(requireCreateSvgIcon()),_jsxRuntime$w=jsxRuntimeExports;default_1$w=LocationOnOutlined.default=(0,_createSvgIcon$w.default)([(0,_jsxRuntime$w.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,_jsxRuntime$w.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");var CameraAltOutlined={},_interopRequireDefault$K=interopRequireDefaultExports;Object.defineProperty(CameraAltOutlined,"__esModule",{value:!0});var default_1$v=CameraAltOutlined.default=void 0,_createSvgIcon$v=_interopRequireDefault$K(requireCreateSvgIcon()),_jsxRuntime$v=jsxRuntimeExports;default_1$v=CameraAltOutlined.default=(0,_createSvgIcon$v.default)((0,_jsxRuntime$v.jsx)("path",{d:"M20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 14H4V6h4.05l1.83-2h4.24l1.83 2H20zM12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0 8c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3"}),"CameraAltOutlined");var PhotoLibraryOutlined={},_interopRequireDefault$J=interopRequireDefaultExports;Object.defineProperty(PhotoLibraryOutlined,"__esModule",{value:!0});var default_1$u=PhotoLibraryOutlined.default=void 0,_createSvgIcon$u=_interopRequireDefault$J(requireCreateSvgIcon()),_jsxRuntime$u=jsxRuntimeExports;default_1$u=PhotoLibraryOutlined.default=(0,_createSvgIcon$u.default)((0,_jsxRuntime$u.jsx)("path",{d:"M20 4v12H8V4zm0-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 9.67 1.69 2.26 2.48-3.1L19 15H9zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6z"}),"PhotoLibraryOutlined");const Navbar=()=>{const rp=useNavigate();localStorage.getItem("jwt");const[_d,np]=reactExports.useState(!1),ap=sp=>{const lp=sp.target.files[0],up=new FileReader;up.readAsDataURL(lp),up.onloadend=()=>[rp("/fish/image/edit",{state:{value:up.result}})]};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"container",children:[jsxRuntimeExports.jsx("div",{className:"Navbar_body",children:jsxRuntimeExports.jsx(Outlet,{})}),jsxRuntimeExports.jsxs("nav",{className:"nav",children:[jsxRuntimeExports.jsxs(NavLink,{to:"/",className:"nav-item",children:[jsxRuntimeExports.jsx(default_1$x,{}),jsxRuntimeExports.jsx("span",{children:""})]}),jsxRuntimeExports.jsxs(NavLink,{to:"/fish/map",className:"nav-item",children:[jsxRuntimeExports.jsx(default_1$w,{}),jsxRuntimeExports.jsx("span",{children:""})]}),jsxRuntimeExports.jsxs("div",{className:"nav-item hidden",children:[jsxRuntimeExports.jsxs("svg",{className:"icon",stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("circle",{cx:"9",cy:"21",r:"1"}),jsxRuntimeExports.jsx("circle",{cx:"20",cy:"21",r:"1"}),jsxRuntimeExports.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),jsxRuntimeExports.jsx("span",{children:"Home"})]}),jsxRuntimeExports.jsx("div",{className:"nav-item btn ",children:jsxRuntimeExports.jsx("div",{className:"custum-file-upload bg-blue",onClick:()=>np(!0),children:jsxRuntimeExports.jsx(default_1$z,{})})}),jsxRuntimeExports.jsxs(NavLink,{to:"/media",className:"nav-item ",children:[jsxRuntimeExports.jsx(default_1$y,{}),jsxRuntimeExports.jsx("span",{children:"RoomList"})]}),jsxRuntimeExports.jsxs(NavLink,{to:"/user/mypage",className:"nav-item",children:[jsxRuntimeExports.jsx(default_1$A,{}),jsxRuntimeExports.jsx("span",{children:""})]})]}),_d&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"choice",onClick:()=>np(!1)}),jsxRuntimeExports.jsxs("div",{className:"camera-content",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"file1",children:[jsxRuntimeExports.jsx(default_1$v,{})," ",jsxRuntimeExports.jsx("input",{type:"file",id:"file1",accept:"image/*",capture:"camera",onChange:ap})]}),jsxRuntimeExports.jsxs("label",{htmlFor:"file2",children:[jsxRuntimeExports.jsx(default_1$u,{})," ",jsxRuntimeExports.jsx("input",{type:"file",id:"file2",accept:"image/*",onChange:ap})]})]})]})]})})},SHOWS=[{page:0,title:"Tutorial",url:"/tutorial"},{page:1,title:"",url:"/fishbook"},{page:2,title:"",url:"/aquarium"}],Slider=({setBack:rp})=>{const _d=useNavigate(),np=ap=>{_d(ap)};return jsxRuntimeExports.jsx("div",{className:"slider",children:jsxRuntimeExports.jsx(Swiper,{modules:[EffectCoverflow],effect:"coverflow",slidesPerView:1.4,centeredSlides:!0,mousewheel:{invert:!1},onSlideChange:ap=>{rp(ap.activeIndex)},spaceBetween:-100,slideToClickedSlide:!0,coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},children:SHOWS.map((ap,sp)=>jsxRuntimeExports.jsx(SwiperSlide,{className:`slider${ap.page}`,onClick:()=>np(ap.url),children:ap.title},sp))})})},logo="/assets/Logo-WtStl40p.svg";var Phishing={},_interopRequireDefault$I=interopRequireDefaultExports;Object.defineProperty(Phishing,"__esModule",{value:!0});var default_1$t=Phishing.default=void 0,_createSvgIcon$t=_interopRequireDefault$I(requireCreateSvgIcon()),_jsxRuntime$t=jsxRuntimeExports;default_1$t=Phishing.default=(0,_createSvgIcon$t.default)((0,_jsxRuntime$t.jsx)("path",{d:"M19 9c0-1.3-.84-2.4-2-2.82V2h-2v4.18C13.84 6.6 13 7.7 13 9s.84 2.4 2 2.82V15c0 2.21-1.79 4-4 4s-4-1.79-4-4v-1h3L5 9v6c0 3.31 2.69 6 6 6s6-2.69 6-6v-3.18c1.16-.42 2-1.52 2-2.82m-3 1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"Phishing");const HomePage=()=>{const[rp,_d]=reactExports.useState(0),np=useNavigate(),ap=sp=>_d(sp);return reactExports.useEffect(()=>{localStorage.getItem("jwt")||np("/login")},[]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:`home slider${rp}`,children:[jsxRuntimeExports.jsxs("div",{className:"Home_header",children:[jsxRuntimeExports.jsx("img",{src:logo,alt:"logo"}),jsxRuntimeExports.jsx(Link,{to:"/chatbot","aria-label":" ",children:jsxRuntimeExports.jsx(default_1$t,{})})]}),jsxRuntimeExports.jsx(Slider,{setBack:ap})]})})};var dist$1={},customMobilenet={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t$1=function(rp,_d){return(t$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(np,ap){np.__proto__=ap}||function(np,ap){for(var sp in ap)ap.hasOwnProperty(sp)&&(np[sp]=ap[sp])})(rp,_d)};function e(rp,_d){function np(){this.constructor=rp}t$1(rp,_d),rp.prototype=_d===null?Object.create(_d):(np.prototype=_d.prototype,new np)}function n$1(rp,_d,np,ap){return new(np||(np=Promise))(function(sp,lp){function up(hp){try{dp(ap.next(hp))}catch(fp){lp(fp)}}function cp(hp){try{dp(ap.throw(hp))}catch(fp){lp(fp)}}function dp(hp){hp.done?sp(hp.value):new np(function(fp){fp(hp.value)}).then(up,cp)}dp((ap=ap.apply(rp,_d||[])).next())})}function r(rp,_d){var np,ap,sp,lp,up={label:0,sent:function(){if(1&sp[0])throw sp[1];return sp[1]},trys:[],ops:[]};return lp={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(lp[Symbol.iterator]=function(){return this}),lp;function cp(dp){return function(hp){return function(fp){if(np)throw new TypeError("Generator is already executing.");for(;up;)try{if(np=1,ap&&(sp=2&fp[0]?ap.return:fp[0]?ap.throw||((sp=ap.return)&&sp.call(ap),0):ap.next)&&!(sp=sp.call(ap,fp[1])).done)return sp;switch(ap=0,sp&&(fp=[2&fp[0],sp.value]),fp[0]){case 0:case 1:sp=fp;break;case 4:return up.label++,{value:fp[1],done:!1};case 5:up.label++,ap=fp[1],fp=[0];continue;case 7:fp=up.ops.pop(),up.trys.pop();continue;default:if(!(sp=(sp=up.trys).length>0&&sp[sp.length-1])&&(fp[0]===6||fp[0]===2)){up=0;continue}if(fp[0]===3&&(!sp||fp[1]>sp[0]&&fp[1]<sp[3])){up.label=fp[1];break}if(fp[0]===6&&up.label<sp[1]){up.label=sp[1],sp=fp;break}if(sp&&up.label<sp[2]){up.label=sp[2],up.ops.push(fp);break}sp[2]&&up.ops.pop(),up.trys.pop();continue}fp=_d.call(rp,up)}catch(pp){fp=[6,pp],ap=0}finally{np=sp=0}if(5&fp[0])throw fp[1];return{value:fp[0]?fp[1]:void 0,done:!0}}([dp,hp])}}}var o=function(){function rp(_d){this.global=_d,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return rp.prototype.setPlatform=function(_d,np){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+np+"."),this.platformName=_d,this.platform=np},rp.prototype.registerFlag=function(_d,np,ap){if(this.flagRegistry[_d]={evaluationFn:np,setHook:ap},this.urlFlags[_d]!=null){var sp=this.urlFlags[_d];console.warn("Setting feature override from URL "+_d+": "+sp+"."),this.set(_d,sp)}},rp.prototype.get=function(_d){return _d in this.flags?this.flags[_d]:(this.flags[_d]=this.evaluateFlag(_d),this.flags[_d])},rp.prototype.getNumber=function(_d){return this.get(_d)},rp.prototype.getBool=function(_d){return this.get(_d)},rp.prototype.getFlags=function(){return this.flags},Object.defineProperty(rp.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),rp.prototype.set=function(_d,np){if(this.flagRegistry[_d]==null)throw new Error("Cannot set flag "+_d+" as it has not been registered.");this.flags[_d]=np,this.flagRegistry[_d].setHook!=null&&this.flagRegistry[_d].setHook(np)},rp.prototype.evaluateFlag=function(_d){if(this.flagRegistry[_d]==null)throw new Error("Cannot evaluate flag '"+_d+"': no evaluation function found.");return this.flagRegistry[_d].evaluationFn()},rp.prototype.setFlags=function(_d){this.flags=Object.assign({},_d)},rp.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},rp.prototype.populateURLFlags=function(){var _d=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var np,ap,sp=(np=this.global.location.search,ap={},np.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(lp){for(var up=[],cp=1;cp<arguments.length;cp++)up[cp-1]=arguments[cp];return function(dp,hp,fp){dp[decodeURIComponent(hp)]=decodeURIComponent(fp||"")}(ap,up[0],up[1]),up.join("=")}),ap);"tfjsflags"in sp&&sp.tfjsflags.split(",").forEach(function(lp){var up=lp.split(":"),cp=up[0],dp=up[1];_d.urlFlags[cp]=function(hp,fp){if((fp=fp.toLowerCase())==="true"||fp==="false")return fp==="true";if(""+ +fp===fp)return+fp;throw new Error("Could not parse value flag value "+fp+" for flag "+hp+".")}(cp,dp)})}},rp}();function a$1(){return i$3}var i$3=null,u=new Map;function s(rp,_d){var np=f$1(rp,_d);return u.get(np)}function c$1(rp){for(var _d=u.entries(),np=[];;){var ap=_d.next(),sp=ap.done,lp=ap.value;if(sp)break;var up=lp[0],cp=lp[1];up.split("_")[0]===rp&&np.push(cp)}return np}function l$1(rp){var _d=rp.kernelName,np=rp.backendName,ap=f$1(_d,np);if(u.has(ap))throw new Error("The kernel '"+_d+"' for backend '"+np+"' is already registered");u.set(ap,rp)}function h$1(rp,_d){var np=f$1(rp,_d);if(!u.has(np))throw new Error("The kernel '"+rp+"' for backend '"+_d+"' is not registered");u.delete(np)}function f$1(rp,_d){return _d+"_"+rp}function p(rp){for(var _d=rp.length,np=0,ap=0;_d>0;)ap=Math.random()*_d|0,np=rp[--_d],rp[_d]=rp[ap],rp[ap]=np}function d(rp,_d,np){return Math.max(rp,Math.min(_d,np))}function v$2(rp){return rp%2==0?rp:rp+1}function m$1(rp){for(var _d=0,np=0;np<rp.length;np++)_d+=rp[np];return _d}function g(rp,_d){if(!rp)throw new Error(typeof _d=="string"?_d:_d())}function y(rp,_d,np){np===void 0&&(np=""),g(C(rp,_d),function(){return np+" Shapes "+rp+" and "+_d+" must match"})}function x(rp){g(rp!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function b(rp,_d,np){if(_d===void 0&&(_d=[]),np===void 0&&(np=!1),_d==null&&(_d=[]),Array.isArray(rp)||B(rp)&&!np)for(var ap=0;ap<rp.length;++ap)b(rp[ap],_d,np);else _d.push(rp);return _d}function w$1(rp){if(rp.length===0)return 1;for(var _d=rp[0],np=1;np<rp.length;np++)_d*=rp[np];return _d}function C(rp,_d){if(rp===_d)return!0;if(rp==null||_d==null||rp.length!==_d.length)return!1;for(var np=0;np<rp.length;np++)if(rp[np]!==_d[np])return!1;return!0}function E(rp){return rp%1==0}function R$1(rp){if(Math.tanh!=null)return Math.tanh(rp);if(rp===1/0)return 1;if(rp===-1/0)return-1;var _d=Math.exp(2*rp);return(_d-1)/(_d+1)}function I(rp){var _d=Math.ceil(Math.sqrt(rp));return[_d,Math.ceil(rp/_d)]}function k$1(rp,_d){return _d<=rp.length?rp:rp+" ".repeat(_d-rp.length)}function S(rp,_d,np){return _d===void 0&&(_d=function(ap){return 0}),new Promise(function(ap,sp){var lp=0,up=function(){if(rp())ap();else{var cp=_d(++lp);np!=null&&lp>=np?sp():setTimeout(up,cp)}};up()})}function A(rp,_d){for(var np=1,ap=-1,sp=0;sp<rp.length;++sp)if(rp[sp]>=0)np*=rp[sp];else if(rp[sp]===-1){if(ap!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+ap+" and dim "+sp);ap=sp}else if(rp[sp]<0)throw Error("Shapes can not be < 0. Found "+rp[sp]+" at dim "+sp);if(ap===-1){if(_d>0&&_d!==np)throw Error("Size("+_d+") must match the product of shape "+rp);return rp}if(np===0)throw Error("Cannot infer the missing size in ["+rp+"] when there are 0 elements");if(_d%np!=0)throw Error("The implicit shape can't be a fractional number. Got "+_d+" / "+np);var lp=rp.slice();return lp[ap]=_d/np,lp}function D(rp,_d){var np=_d.length;return g((rp=rp==null?_d.map(function(ap,sp){return sp}):[].concat(rp)).every(function(ap){return ap>=-np&&ap<np}),function(){return"All values in axis param must be in range [-"+np+", "+np+") but got axis "+rp}),g(rp.every(function(ap){return E(ap)}),function(){return"All values in axis param must be integers but got axis "+rp}),rp.map(function(ap){return ap<0?np+ap:ap})}function T(rp,_d){for(var np=[],ap=[],sp=_d!=null&&Array.isArray(_d)&&_d.length===0,lp=_d==null||sp?null:D(_d,rp).sort(),up=0,cp=0;cp<rp.length;++cp){if(lp!=null){if(lp[up]===cp&&rp[cp]!==1)throw new Error("Can't squeeze axis "+cp+" since its dim '"+rp[cp]+"' is not 1");(lp[up]==null||lp[up]>cp)&&rp[cp]===1&&(np.push(rp[cp]),ap.push(cp)),lp[up]<=cp&&up++}rp[cp]!==1&&(np.push(rp[cp]),ap.push(cp))}return{newShape:np,keptDims:ap}}function N(rp,_d){var np=null;if(rp==null||rp==="float32")np=new Float32Array(_d);else if(rp==="int32")np=new Int32Array(_d);else{if(rp!=="bool")throw new Error("Unknown data type "+rp);np=new Uint8Array(_d)}return np}function F(rp,_d){var np=null;if(rp==null||rp==="float32")np=new Float32Array(_d);else if(rp==="int32")np=new Int32Array(_d);else if(rp==="bool")np=new Uint8Array(_d);else{if(rp!=="string")throw new Error("Unknown data type "+rp);np=new Array(_d)}return np}function O(rp,_d){for(var np=0;np<rp.length;np++){var ap=rp[np];if(isNaN(ap)||!isFinite(ap))throw Error("A tensor of type "+_d+" being uploaded contains "+ap+".")}}function _(rp){return rp==="bool"||rp==="complex64"||rp==="float32"||rp==="int32"||rp==="string"}function M(rp,_d){return _d!=="complex64"&&(_d!=="float32"||rp==="complex64")&&(_d!=="int32"||rp==="float32"||rp==="complex64")&&(_d!=="bool"||rp!=="bool")}function B(rp){return rp instanceof Float32Array||rp instanceof Int32Array||rp instanceof Uint8Array}function P(rp){if(rp==="float32"||rp==="int32")return 4;if(rp==="complex64")return 8;if(rp==="bool")return 1;throw new Error("Unknown dtype "+rp)}function L(rp){if(rp==null)return 0;var _d=0;return rp.forEach(function(np){return _d+=np.length}),_d}function W(rp){return typeof rp=="string"||rp instanceof String}function U(rp){return typeof rp=="boolean"}function V(rp){return typeof rp=="number"}function z(rp){return Array.isArray(rp)?z(rp[0]):rp instanceof Float32Array?"float32":rp instanceof Int32Array||rp instanceof Uint8Array?"int32":V(rp)?"float32":W(rp)?"string":U(rp)?"bool":"float32"}function G(rp){return!!(rp&&rp.constructor&&rp.call&&rp.apply)}function H(rp,_d){for(var np=_d;np<rp;++np)if(rp%np==0)return np;return rp}function q(rp){var _d=rp.length;if(_d<2)return[];var np=new Array(_d-1);np[_d-2]=rp[_d-1];for(var ap=_d-3;ap>=0;--ap)np[ap]=np[ap+1]*rp[ap+1];return np}function K(rp,_d,np){if(_d==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(rp)&&(rp=b(rp)),np&&O(rp,_d),function(lp,up){return lp instanceof Float32Array&&up==="float32"||lp instanceof Int32Array&&up==="int32"||lp instanceof Uint8Array&&up==="bool"}(rp,_d))return rp;if(_d==null||_d==="float32"||_d==="complex64")return new Float32Array(rp);if(_d==="int32")return new Int32Array(rp);if(_d==="bool"){for(var ap=new Uint8Array(rp.length),sp=0;sp<ap.length;++sp)Math.round(rp[sp])!==0&&(ap[sp]=1);return ap}throw new Error("Unknown data type "+_d)}function j$1(rp,_d){if(rp.length===0)return _d[0];var np=rp.reduce(function(ap,sp){return ap*sp});if(np===0)return[];if(np!==_d.length)throw new Error("["+rp+"] does not match the input size.");return function ap(sp,lp,up){var cp=new Array;if(lp.length===1)for(var dp=lp[0],hp=0;hp<dp;hp++)cp[hp]=up[sp+hp];else{dp=lp[0];var fp=lp.slice(1),pp=fp.reduce(function(mp,gp){return mp*gp});for(hp=0;hp<dp;hp++)cp[hp]=ap(sp+hp*pp,fp,up)}return cp}(0,rp,_d)}function X(rp,_d){for(var np=$$1(rp,_d),ap=0;ap<np.length;ap++)np[ap]=1;return np}function $$1(rp,_d){if(_d==null||_d==="float32"||_d==="complex64")return new Float32Array(rp);if(_d==="int32")return new Int32Array(rp);if(_d==="bool")return new Uint8Array(rp);throw new Error("Unknown data type "+_d)}function Y(){return a$1().platform.now()}function Q(rp){rp.forEach(function(_d){g(Number.isInteger(_d)&&_d>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+rp+"]."})})}function J(rp,_d){return _d===void 0&&(_d="utf-8"),_d=_d||"utf-8",a$1().platform.encode(rp,_d)}function Z(rp,_d){return _d===void 0&&(_d="utf-8"),_d=_d||"utf-8",a$1().platform.decode(rp,_d)}var tt=Object.freeze({shuffle:p,clamp:d,nearestLargerEven:v$2,sum:m$1,randUniform:function(rp,_d){var np=Math.random();return _d*np+(1-np)*rp},distSquared:function(rp,_d){for(var np=0,ap=0;ap<rp.length;ap++){var sp=Number(rp[ap])-Number(_d[ap]);np+=sp*sp}return np},assert:g,assertShapesMatch:y,assertNonNull:x,flatten:b,sizeFromShape:w$1,isScalarShape:function(rp){return rp.length===0},arraysEqual:C,isInt:E,tanh:R$1,sizeToSquarishShape:I,createShuffledIndices:function(rp){for(var _d=new Uint32Array(rp),np=0;np<rp;++np)_d[np]=np;return p(_d),_d},rightPad:k$1,repeatedTry:S,inferFromImplicitShape:A,parseAxisParam:D,squeezeShape:T,getTypedArrayFromDType:N,getArrayFromDType:F,checkConversionForErrors:O,isValidDtype:_,hasEncodingLoss:M,isTypedArray:B,bytesPerElement:P,bytesFromStringArray:L,isString:W,isBoolean:U,isNumber:V,inferDtype:z,isFunction:G,nearestDivisor:H,computeStrides:q,toTypedArray:K,toNestedArray:j$1,makeOnesTypedArray:X,makeZerosTypedArray:$$1,now:Y,assertNonNegativeIntegerDimensions:Q,fetch:function(rp,_d){return a$1().platform.fetch(rp,_d)},encodeString:J,decodeString:Z}),et=function(){function rp(_d,np){this.backendTimer=_d,this.logger=np,np==null&&(this.logger=new nt)}return rp.prototype.profileKernel=function(_d,np,ap){var sp,lp=this,up=this.backendTimer.time(function(){sp=ap()});return sp.forEach(function(cp){cp.data().then(function(dp){(function(hp,fp,pp){if(fp!=="float32")return!1;for(var mp=0;mp<hp.length;mp++){var gp=hp[mp];if(isNaN(gp)||!isFinite(gp))return console.warn("Found "+gp+" in the result of '"+pp+"'"),!0}})(dp,cp.dtype,_d),up.then(function(hp){var fp="";hp.getExtraProfileInfo!=null&&(fp=hp.getExtraProfileInfo()),lp.logger.logKernelProfile(_d,cp,dp,hp.kernelMs,np,fp)})})}),sp},rp}(),nt=function(){function rp(){}return rp.prototype.logKernelProfile=function(_d,np,ap,sp,lp,up){var cp=k$1(sp+"ms",9),dp=k$1(_d,25),hp=np.rank,fp=np.size,pp=k$1(np.shape.toString(),14),mp="";for(var gp in lp){var yp=lp[gp].shape,xp=yp.length;mp+=gp+": "+xp+"D "+(xp>0?yp:"")+" "}console.log("%c"+dp+"	%c"+cp+"	%c"+hp+"D "+pp+"	%c"+fp+"	%c"+mp+"	%c"+up,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},rp}(),rt=20,ot=3,at=7;function it(rp,_d,np,ap){var sp=q(_d),lp=function(hp,fp,pp,mp){var gp=w$1(fp),yp=mp[mp.length-1],xp=new Array(yp).fill(0),_p=fp.length,vp=pp==="complex64"?ct(hp):hp;if(_p>1)for(var bp=0;bp<gp/yp;bp++)for(var Ep=bp*yp,Sp=0;Sp<yp;Sp++)xp[Sp]=Math.max(xp[Sp],ut(vp[Ep+Sp],0,pp).length);return xp}(rp,_d,np,sp),up=_d.length,cp=function hp(fp,pp,mp,gp,yp,xp){xp===void 0&&(xp=!0);var _p=mp==="complex64"?2:1,vp=pp[0],bp=pp.length;if(bp===0){if(mp==="complex64"){var Ep=ct(fp);return[ut(Ep[0],0,mp)]}return mp==="bool"?[st(fp[0])]:[fp[0].toString()]}if(bp===1){if(vp>rt){var Sp=ot*_p,Ap=Array.from(fp.slice(0,Sp)),Rp=Array.from(fp.slice(vp-ot*_p,vp));return mp==="complex64"&&(Ap=ct(Ap),Rp=ct(Rp)),["["+Ap.map(function(Bp,Ip){return ut(Bp,yp[Ip],mp)}).join(", ")+", ..., "+Rp.map(function(Bp,Ip){return ut(Bp,yp[vp-ot+Ip],mp)}).join(", ")+"]"]}var Tp=mp==="complex64"?ct(fp):Array.from(fp);return["["+Tp.map(function(Bp,Ip){return ut(Bp,yp[Ip],mp)}).join(", ")+"]"]}var Mp=pp.slice(1),Op=gp.slice(1),Pp=gp[0]*_p,$p=[];if(vp>rt){for(var zp=0;zp<ot;zp++){var Dp=zp*Pp,Fp=Dp+Pp;$p.push.apply($p,hp(fp.slice(Dp,Fp),Mp,mp,Op,yp,!1))}$p.push("...");for(var zp=vp-ot;zp<vp;zp++){var Dp=zp*Pp,Fp=Dp+Pp;$p.push.apply($p,hp(fp.slice(Dp,Fp),Mp,mp,Op,yp,zp===vp-1))}}else for(var zp=0;zp<vp;zp++){var Dp=zp*Pp,Fp=Dp+Pp;$p.push.apply($p,hp(fp.slice(Dp,Fp),Mp,mp,Op,yp,zp===vp-1))}var jp=bp===2?",":"";$p[0]="["+$p[0]+jp;for(var zp=1;zp<$p.length-1;zp++)$p[zp]=" "+$p[zp]+jp;for(var Lp=`,
`,zp=2;zp<bp;zp++)Lp+=`
`;return $p[$p.length-1]=" "+$p[$p.length-1]+"]"+(xp?"":Lp),$p}(rp,_d,np,sp,lp),dp=["Tensor"];return ap&&(dp.push("  dtype: "+np),dp.push("  rank: "+up),dp.push("  shape: ["+_d+"]"),dp.push("  values:")),dp.push(cp.map(function(hp){return"    "+hp}).join(`
`)),dp.join(`
`)}function ut(rp,_d,np){return k$1(Array.isArray(rp)?parseFloat(rp[0].toFixed(at))+" + "+parseFloat(rp[1].toFixed(at))+"j":W(rp)?"'"+rp+"'":np==="bool"?st(rp):parseFloat(rp.toFixed(at)).toString(),_d)}function st(rp){return rp===0?"false":"true"}function ct(rp){for(var _d=[],np=0;np<rp.length;np+=2)_d.push([rp[np],rp[np+1]]);return _d}var lt=function(){function rp(_d,np,ap){var sp=this;if(this.dtype=np,this.shape=_d.slice(),this.size=w$1(_d),ap!=null){var lp=ap.length;g(lp===this.size,function(){return"Length of values '"+lp+"' does not match the size inferred by the shape '"+sp.size+"'."})}if(np==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=ap||F(np,this.size),this.strides=q(_d)}return rp.prototype.set=function(_d){for(var np=this,ap=[],sp=1;sp<arguments.length;sp++)ap[sp-1]=arguments[sp];ap.length===0&&(ap=[0]),g(ap.length===this.rank,function(){return"The number of provided coordinates ("+ap.length+") must match the rank ("+np.rank+")"});var lp=this.locToIndex(ap);this.values[lp]=_d},rp.prototype.get=function(){for(var _d=[],np=0;np<arguments.length;np++)_d[np]=arguments[np];_d.length===0&&(_d=[0]);for(var ap=0,sp=0,lp=_d;sp<lp.length;sp++){var up=lp[sp];if(up<0||up>=this.shape[ap]){var cp="Requested out of range element at "+_d+".   Buffer shape="+this.shape;throw new Error(cp)}ap++}for(var dp=_d[_d.length-1],hp=0;hp<_d.length-1;++hp)dp+=this.strides[hp]*_d[hp];return this.values[dp]},rp.prototype.locToIndex=function(_d){if(this.rank===0)return 0;if(this.rank===1)return _d[0];for(var np=_d[_d.length-1],ap=0;ap<_d.length-1;++ap)np+=this.strides[ap]*_d[ap];return np},rp.prototype.indexToLoc=function(_d){if(this.rank===0)return[];if(this.rank===1)return[_d];for(var np=new Array(this.shape.length),ap=0;ap<np.length-1;++ap)np[ap]=Math.floor(_d/this.strides[ap]),_d-=np[ap]*this.strides[ap];return np[np.length-1]=_d,np},Object.defineProperty(rp.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),rp.prototype.toTensor=function(){return ht().makeTensor(this.values,this.shape,this.dtype)},rp}(),ht=null,ft=null,pt=null,dt=function(){function rp(_d,np,ap,sp){this.kept=!1,this.isDisposedInternal=!1,this.shape=_d.slice(),this.dtype=np||"float32",this.size=w$1(_d),this.strides=q(_d),this.dataId=ap,this.id=sp,this.rankType=this.rank<5?this.rank.toString():"higher"}return rp.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},rp.prototype.asScalar=function(){return this.throwIfDisposed(),g(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},rp.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},rp.prototype.as2D=function(_d,np){return this.throwIfDisposed(),this.reshape([_d,np])},rp.prototype.as3D=function(_d,np,ap){return this.throwIfDisposed(),this.reshape([_d,np,ap])},rp.prototype.as4D=function(_d,np,ap,sp){return this.throwIfDisposed(),this.reshape([_d,np,ap,sp])},rp.prototype.as5D=function(_d,np,ap,sp,lp){return this.throwIfDisposed(),this.reshape([_d,np,ap,sp,lp])},rp.prototype.asType=function(_d){return this.throwIfDisposed(),ft.cast(this,_d)},Object.defineProperty(rp.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),rp.prototype.buffer=function(){return n$1(this,void 0,void 0,function(){var _d;return r(this,function(np){switch(np.label){case 0:return[4,this.data()];case 1:return _d=np.sent(),[2,ft.buffer(this.shape,this.dtype,_d)]}})})},rp.prototype.bufferSync=function(){return ft.buffer(this.shape,this.dtype,this.dataSync())},rp.prototype.array=function(){return n$1(this,void 0,void 0,function(){var _d;return r(this,function(np){switch(np.label){case 0:return[4,this.data()];case 1:return _d=np.sent(),[2,j$1(this.shape,_d)]}})})},rp.prototype.arraySync=function(){return j$1(this.shape,this.dataSync())},rp.prototype.data=function(){return n$1(this,void 0,void 0,function(){var _d,np;return r(this,function(ap){switch(ap.label){case 0:return this.throwIfDisposed(),_d=ht().read(this.dataId),this.dtype!=="string"?[3,2]:[4,_d];case 1:np=ap.sent();try{return[2,np.map(function(sp){return Z(sp)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}ap.label=2;case 2:return[2,_d]}})})},rp.prototype.dataSync=function(){this.throwIfDisposed();var _d=ht().readSync(this.dataId);if(this.dtype==="string")try{return _d.map(function(np){return Z(np)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return _d},rp.prototype.bytes=function(){return n$1(this,void 0,void 0,function(){var _d;return r(this,function(np){switch(np.label){case 0:return this.throwIfDisposed(),[4,ht().read(this.dataId)];case 1:return _d=np.sent(),this.dtype==="string"?[2,_d]:[2,new Uint8Array(_d.buffer)]}})})},rp.prototype.dispose=function(){this.isDisposed||(ht().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(rp.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),rp.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},rp.prototype.toFloat=function(){return this.asType("float32")},rp.prototype.toInt=function(){return this.asType("int32")},rp.prototype.toBool=function(){return this.asType("bool")},rp.prototype.print=function(_d){return _d===void 0&&(_d=!1),ft.print(this,_d)},rp.prototype.reshape=function(_d){return this.throwIfDisposed(),ft.reshape(this,_d)},rp.prototype.reshapeAs=function(_d){return this.throwIfDisposed(),this.reshape(_d.shape)},rp.prototype.expandDims=function(_d){return _d===void 0&&(_d=0),ft.expandDims(this,_d)},rp.prototype.cumsum=function(_d,np,ap){return _d===void 0&&(_d=0),np===void 0&&(np=!1),ap===void 0&&(ap=!1),ft.cumsum(this,_d,np,ap)},rp.prototype.squeeze=function(_d){return this.throwIfDisposed(),ft.squeeze(this,_d)},rp.prototype.clone=function(){return this.throwIfDisposed(),ft.clone(this)},rp.prototype.oneHot=function(_d,np,ap){return this.throwIfDisposed(),ft.oneHot(this,_d,np,ap)},rp.prototype.toString=function(_d){return _d===void 0&&(_d=!1),it(this.dataSync(),this.shape,this.dtype,_d)},rp.prototype.tile=function(_d){return this.throwIfDisposed(),ft.tile(this,_d)},rp.prototype.gather=function(_d,np){return np===void 0&&(np=0),this.throwIfDisposed(),ft.gather(this,_d,np)},rp.prototype.matMul=function(_d,np,ap){return np===void 0&&(np=!1),ap===void 0&&(ap=!1),this.throwIfDisposed(),ft.matMul(this,_d,np,ap)},rp.prototype.dot=function(_d){return this.throwIfDisposed(),ft.dot(this,_d)},rp.prototype.norm=function(_d,np,ap){return _d===void 0&&(_d="euclidean"),np===void 0&&(np=null),ap===void 0&&(ap=!1),this.throwIfDisposed(),ft.norm(this,_d,np,ap)},rp.prototype.slice=function(_d,np){return this.throwIfDisposed(),ft.slice(this,_d,np)},rp.prototype.reverse=function(_d){return this.throwIfDisposed(),ft.reverse(this,_d)},rp.prototype.concat=function(_d,np){return np===void 0&&(np=0),this.throwIfDisposed(),_d instanceof rp&&(_d=[_d]),ft.concat([this].concat(_d),np)},rp.prototype.split=function(_d,np){return np===void 0&&(np=0),this.throwIfDisposed(),ft.split(this,_d,np)},rp.prototype.stack=function(_d,np){return np===void 0&&(np=0),ft.stack([this,_d],np)},rp.prototype.unstack=function(_d){return _d===void 0&&(_d=0),ft.unstack(this,_d)},rp.prototype.pad=function(_d,np){return np===void 0&&(np=0),ft.pad(this,_d,np)},rp.prototype.batchNormalization=function(_d,np,ap,sp,lp){return ap===void 0&&(ap=.001),pt("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(_d,np,lp,sp,ap)},rp.prototype.batchNorm=function(_d,np,ap,sp,lp){return lp===void 0&&(lp=.001),this.throwIfDisposed(),ft.batchNorm(this,_d,np,ap,sp,lp)},rp.prototype.all=function(_d,np){return _d===void 0&&(_d=null),np===void 0&&(np=!1),this.throwIfDisposed(),ft.all(this,_d,np)},rp.prototype.any=function(_d,np){return _d===void 0&&(_d=null),np===void 0&&(np=!1),this.throwIfDisposed(),ft.any(this,_d,np)},rp.prototype.logSumExp=function(_d,np){return _d===void 0&&(_d=null),np===void 0&&(np=!1),this.throwIfDisposed(),ft.logSumExp(this,_d,np)},rp.prototype.sum=function(_d,np){return _d===void 0&&(_d=null),np===void 0&&(np=!1),this.throwIfDisposed(),ft.sum(this,_d,np)},rp.prototype.prod=function(_d,np){return _d===void 0&&(_d=null),np===void 0&&(np=!1),this.throwIfDisposed(),ft.prod(this,_d,np)},rp.prototype.mean=function(_d,np){return _d===void 0&&(_d=null),np===void 0&&(np=!1),this.throwIfDisposed(),ft.mean(this,_d,np)},rp.prototype.min=function(_d,np){return _d===void 0&&(_d=null),np===void 0&&(np=!1),this.throwIfDisposed(),ft.min(this,_d,np)},rp.prototype.max=function(_d,np){return _d===void 0&&(_d=null),np===void 0&&(np=!1),this.throwIfDisposed(),ft.max(this,_d,np)},rp.prototype.argMin=function(_d){return _d===void 0&&(_d=null),this.throwIfDisposed(),ft.argMin(this,_d)},rp.prototype.argMax=function(_d){return _d===void 0&&(_d=null),this.throwIfDisposed(),ft.argMax(this,_d)},rp.prototype.cast=function(_d){return this.throwIfDisposed(),ft.cast(this,_d)},rp.prototype.add=function(_d){return this.throwIfDisposed(),ft.add(this,_d)},rp.prototype.addStrict=function(_d){return this.throwIfDisposed(),ft.addStrict(this,_d)},rp.prototype.atan2=function(_d){return this.throwIfDisposed(),ft.atan2(this,_d)},rp.prototype.sub=function(_d){return this.throwIfDisposed(),ft.sub(this,_d)},rp.prototype.subStrict=function(_d){return this.throwIfDisposed(),ft.subStrict(this,_d)},rp.prototype.pow=function(_d){return this.throwIfDisposed(),ft.pow(this,_d)},rp.prototype.powStrict=function(_d){return this.throwIfDisposed(),ft.powStrict(this,_d)},rp.prototype.mul=function(_d){return this.throwIfDisposed(),ft.mul(this,_d)},rp.prototype.mulStrict=function(_d){return this.throwIfDisposed(),ft.mulStrict(this,_d)},rp.prototype.div=function(_d){return this.throwIfDisposed(),ft.div(this,_d)},rp.prototype.floorDiv=function(_d){return this.throwIfDisposed(),ft.floorDiv(this,_d)},rp.prototype.divStrict=function(_d){return this.throwIfDisposed(),ft.divStrict(this,_d)},rp.prototype.minimum=function(_d){return this.throwIfDisposed(),ft.minimum(this,_d)},rp.prototype.minimumStrict=function(_d){return this.throwIfDisposed(),ft.minimumStrict(this,_d)},rp.prototype.maximum=function(_d){return this.throwIfDisposed(),ft.maximum(this,_d)},rp.prototype.maximumStrict=function(_d){return this.throwIfDisposed(),ft.maximumStrict(this,_d)},rp.prototype.mod=function(_d){return this.throwIfDisposed(),ft.mod(this,_d)},rp.prototype.modStrict=function(_d){return this.throwIfDisposed(),ft.modStrict(this,_d)},rp.prototype.squaredDifference=function(_d){return this.throwIfDisposed(),ft.squaredDifference(this,_d)},rp.prototype.squaredDifferenceStrict=function(_d){return this.throwIfDisposed(),ft.squaredDifferenceStrict(this,_d)},rp.prototype.transpose=function(_d){return this.throwIfDisposed(),ft.transpose(this,_d)},rp.prototype.notEqual=function(_d){return this.throwIfDisposed(),ft.notEqual(this,_d)},rp.prototype.notEqualStrict=function(_d){return this.throwIfDisposed(),ft.notEqualStrict(this,_d)},rp.prototype.less=function(_d){return this.throwIfDisposed(),ft.less(this,_d)},rp.prototype.lessStrict=function(_d){return this.throwIfDisposed(),ft.lessStrict(this,_d)},rp.prototype.equal=function(_d){return this.throwIfDisposed(),ft.equal(this,_d)},rp.prototype.equalStrict=function(_d){return this.throwIfDisposed(),ft.equalStrict(this,_d)},rp.prototype.lessEqual=function(_d){return this.throwIfDisposed(),ft.lessEqual(this,_d)},rp.prototype.lessEqualStrict=function(_d){return this.throwIfDisposed(),ft.lessEqualStrict(this,_d)},rp.prototype.greater=function(_d){return this.throwIfDisposed(),ft.greater(this,_d)},rp.prototype.greaterStrict=function(_d){return this.throwIfDisposed(),ft.greaterStrict(this,_d)},rp.prototype.greaterEqual=function(_d){return this.throwIfDisposed(),ft.greaterEqual(this,_d)},rp.prototype.greaterEqualStrict=function(_d){return this.throwIfDisposed(),ft.greaterEqualStrict(this,_d)},rp.prototype.logicalAnd=function(_d){return this.throwIfDisposed(),ft.logicalAnd(this,_d)},rp.prototype.logicalOr=function(_d){return this.throwIfDisposed(),ft.logicalOr(this,_d)},rp.prototype.logicalNot=function(){return this.throwIfDisposed(),ft.logicalNot(this)},rp.prototype.logicalXor=function(_d){return this.throwIfDisposed(),ft.logicalXor(this,_d)},rp.prototype.where=function(_d,np){return this.throwIfDisposed(),ft.where(_d,this,np)},rp.prototype.neg=function(){return this.throwIfDisposed(),ft.neg(this)},rp.prototype.ceil=function(){return this.throwIfDisposed(),ft.ceil(this)},rp.prototype.floor=function(){return this.throwIfDisposed(),ft.floor(this)},rp.prototype.sign=function(){return this.throwIfDisposed(),ft.sign(this)},rp.prototype.isNaN=function(){return this.throwIfDisposed(),ft.isNaN(this)},rp.prototype.isInf=function(){return this.throwIfDisposed(),ft.isInf(this)},rp.prototype.isFinite=function(){return this.throwIfDisposed(),ft.isFinite(this)},rp.prototype.exp=function(){return this.throwIfDisposed(),ft.exp(this)},rp.prototype.expm1=function(){return this.throwIfDisposed(),ft.expm1(this)},rp.prototype.log=function(){return this.throwIfDisposed(),ft.log(this)},rp.prototype.log1p=function(){return this.throwIfDisposed(),ft.log1p(this)},rp.prototype.sqrt=function(){return this.throwIfDisposed(),ft.sqrt(this)},rp.prototype.rsqrt=function(){return this.throwIfDisposed(),ft.rsqrt(this)},rp.prototype.square=function(){return this.throwIfDisposed(),ft.square(this)},rp.prototype.reciprocal=function(){return this.throwIfDisposed(),ft.reciprocal(this)},rp.prototype.abs=function(){return this.throwIfDisposed(),ft.abs(this)},rp.prototype.clipByValue=function(_d,np){return this.throwIfDisposed(),ft.clipByValue(this,_d,np)},rp.prototype.relu=function(){return this.throwIfDisposed(),ft.relu(this)},rp.prototype.relu6=function(){return this.throwIfDisposed(),ft.relu6(this)},rp.prototype.elu=function(){return this.throwIfDisposed(),ft.elu(this)},rp.prototype.selu=function(){return this.throwIfDisposed(),ft.selu(this)},rp.prototype.leakyRelu=function(_d){return _d===void 0&&(_d=.2),this.throwIfDisposed(),ft.leakyRelu(this,_d)},rp.prototype.prelu=function(_d){return this.throwIfDisposed(),ft.prelu(this,_d)},rp.prototype.sigmoid=function(){return this.throwIfDisposed(),ft.sigmoid(this)},rp.prototype.logSigmoid=function(){return this.throwIfDisposed(),ft.logSigmoid(this)},rp.prototype.softplus=function(){return this.throwIfDisposed(),ft.softplus(this)},rp.prototype.zerosLike=function(){return this.throwIfDisposed(),ft.zerosLike(this)},rp.prototype.onesLike=function(){return this.throwIfDisposed(),ft.onesLike(this)},rp.prototype.sin=function(){return this.throwIfDisposed(),ft.sin(this)},rp.prototype.cos=function(){return this.throwIfDisposed(),ft.cos(this)},rp.prototype.tan=function(){return this.throwIfDisposed(),ft.tan(this)},rp.prototype.asin=function(){return this.throwIfDisposed(),ft.asin(this)},rp.prototype.acos=function(){return this.throwIfDisposed(),ft.acos(this)},rp.prototype.atan=function(){return this.throwIfDisposed(),ft.atan(this)},rp.prototype.sinh=function(){return this.throwIfDisposed(),ft.sinh(this)},rp.prototype.cosh=function(){return this.throwIfDisposed(),ft.cosh(this)},rp.prototype.tanh=function(){return this.throwIfDisposed(),ft.tanh(this)},rp.prototype.asinh=function(){return this.throwIfDisposed(),ft.asinh(this)},rp.prototype.acosh=function(){return this.throwIfDisposed(),ft.acosh(this)},rp.prototype.atanh=function(){return this.throwIfDisposed(),ft.atanh(this)},rp.prototype.erf=function(){return this.throwIfDisposed(),ft.erf(this)},rp.prototype.round=function(){return this.throwIfDisposed(),ft.round(this)},rp.prototype.step=function(_d){return _d===void 0&&(_d=0),this.throwIfDisposed(),ft.step(this,_d)},rp.prototype.softmax=function(_d){return _d===void 0&&(_d=-1),this.throwIfDisposed(),ft.softmax(this,_d)},rp.prototype.logSoftmax=function(_d){return _d===void 0&&(_d=-1),this.throwIfDisposed(),ft.logSoftmax(this,_d)},rp.prototype.resizeBilinear=function(_d,np){return np===void 0&&(np=!1),this.throwIfDisposed(),ft.image.resizeBilinear(this,_d,np)},rp.prototype.resizeNearestNeighbor=function(_d,np){return np===void 0&&(np=!1),this.throwIfDisposed(),ft.image.resizeNearestNeighbor(this,_d,np)},rp.prototype.conv1d=function(_d,np,ap,sp,lp,up){return sp===void 0&&(sp="NWC"),lp===void 0&&(lp=1),this.throwIfDisposed(),ft.conv1d(this,_d,np,ap,sp,lp,up)},rp.prototype.conv2d=function(_d,np,ap,sp,lp,up){return sp===void 0&&(sp="NHWC"),lp===void 0&&(lp=[1,1]),this.throwIfDisposed(),ft.conv2d(this,_d,np,ap,sp,lp,up)},rp.prototype.conv2dTranspose=function(_d,np,ap,sp,lp){return this.throwIfDisposed(),ft.conv2dTranspose(this,_d,np,ap,sp,lp)},rp.prototype.depthwiseConv2D=function(_d,np,ap,sp,lp,up){return sp===void 0&&(sp="NHWC"),lp===void 0&&(lp=[1,1]),this.throwIfDisposed(),ft.depthwiseConv2d(this,_d,np,ap,sp,lp,up)},rp.prototype.separableConv2d=function(_d,np,ap,sp,lp,up){return lp===void 0&&(lp=[1,1]),up===void 0&&(up="NHWC"),this.throwIfDisposed(),ft.separableConv2d(this,_d,np,ap,sp,lp,up)},rp.prototype.avgPool=function(_d,np,ap,sp){return this.throwIfDisposed(),ft.avgPool(this,_d,np,ap,sp)},rp.prototype.maxPool=function(_d,np,ap,sp){return this.throwIfDisposed(),ft.maxPool(this,_d,np,ap,sp)},rp.prototype.localResponseNormalization=function(_d,np,ap,sp){return _d===void 0&&(_d=5),np===void 0&&(np=1),ap===void 0&&(ap=1),sp===void 0&&(sp=.5),ft.localResponseNormalization(this,_d,np,ap,sp)},rp.prototype.pool=function(_d,np,ap,sp,lp){return this.throwIfDisposed(),ft.pool(this,_d,np,ap,sp,lp)},rp.prototype.variable=function(_d,np,ap){return _d===void 0&&(_d=!0),this.throwIfDisposed(),ht().makeVariable(this,_d,np,ap)},rp.prototype.unsortedSegmentSum=function(_d,np){return this.throwIfDisposed(),ft.unsortedSegmentSum(this,_d,np)},rp.prototype.batchToSpaceND=function(_d,np){return this.throwIfDisposed(),ft.batchToSpaceND(this,_d,np)},rp.prototype.spaceToBatchND=function(_d,np){return this.throwIfDisposed(),ft.spaceToBatchND(this,_d,np)},rp.prototype.topk=function(_d,np){return _d===void 0&&(_d=1),np===void 0&&(np=!0),this.throwIfDisposed(),ft.topk(this,_d,np)},rp.prototype.stridedSlice=function(_d,np,ap,sp,lp,up,cp,dp){return sp===void 0&&(sp=0),lp===void 0&&(lp=0),up===void 0&&(up=0),cp===void 0&&(cp=0),dp===void 0&&(dp=0),this.throwIfDisposed(),ft.stridedSlice(this,_d,np,ap,sp,lp,up,cp,dp)},rp.prototype.depthToSpace=function(_d,np){return this.throwIfDisposed(),ft.depthToSpace(this,_d,np)},rp.prototype.fft=function(){return this.throwIfDisposed(),ft.spectral.fft(this)},rp.prototype.ifft=function(){return this.throwIfDisposed(),ft.spectral.ifft(this)},rp.prototype.rfft=function(){return this.throwIfDisposed(),ft.spectral.rfft(this)},rp.prototype.irfft=function(){return this.throwIfDisposed(),ft.spectral.irfft(this)},rp}();Object.defineProperty(dt,Symbol.hasInstance,{value:function(rp){return!!rp&&rp.dataId!=null&&rp.shape!=null&&rp.dtype!=null}});var vt,mt,gt,yt,xt,bt=function(rp){function _d(np,ap,sp,lp){var up=rp.call(this,np.shape,np.dtype,np.dataId,lp)||this;return up.trainable=ap,up.name=sp,up}return e(_d,rp),_d.prototype.assign=function(np){if(np.dtype!==this.dtype)throw new Error("dtype of the new value ("+np.dtype+") and previous value ("+this.dtype+") must match");if(!C(np.shape,this.shape))throw new Error("shape of the new value ("+np.shape+") and previous value ("+this.shape+") must match");ht().disposeTensor(this),this.dataId=np.dataId,ht().incRef(this,null)},_d.prototype.dispose=function(){ht().disposeVariable(this),this.isDisposedInternal=!0},_d}(dt);Object.defineProperty(bt,Symbol.hasInstance,{value:function(rp){return rp instanceof dt&&rp.assign!=null&&rp.assign instanceof Function}}),function(rp){rp.R0="R0",rp.R1="R1",rp.R2="R2",rp.R3="R3",rp.R4="R4",rp.R5="R5",rp.R6="R6"}(vt||(vt={})),function(rp){rp.float32="float32",rp.int32="int32",rp.bool="int32",rp.complex64="complex64"}(mt||(mt={})),function(rp){rp.float32="float32",rp.int32="int32",rp.bool="bool",rp.complex64="complex64"}(gt||(gt={})),function(rp){rp.float32="float32",rp.int32="float32",rp.bool="float32",rp.complex64="complex64"}(yt||(yt={})),function(rp){rp.float32="complex64",rp.int32="complex64",rp.bool="complex64",rp.complex64="complex64"}(xt||(xt={}));var wt={float32:yt,int32:mt,bool:gt,complex64:xt};function Ct(rp,_d){if(rp==="string"||_d==="string"){if(rp==="string"&&_d==="string")return"string";throw new Error("Can not upcast "+rp+" with "+_d)}return wt[rp][_d]}function Et(rp){return Ct(rp,"int32")}function Rt(rp,_d){if(rp.dtype===_d.dtype)return[rp,_d];var np=Ct(rp.dtype,_d.dtype);return[rp.cast(np),_d.cast(np)]}function It(rp,_d){g(rp.dtype===_d.dtype,function(){return"The dtypes of the first("+rp.dtype+") and second("+_d.dtype+") input must match"})}function kt(rp){var _d=[];return function np(ap,sp,lp){if(ap!=null){if(ap instanceof dt)return void sp.push(ap);if(up=ap,!(!Array.isArray(up)&&typeof up!="object")){var up,cp=ap;for(var dp in cp){var hp=cp[dp];lp.has(hp)||(lp.add(hp),np(hp,sp,lp))}}}}(rp,_d,new Set),_d}var St,At=Object.freeze({makeTypesMatch:Rt,assertTypesMatch:It,isTensorInList:function(rp,_d){for(var np=0;np<_d.length;np++)if(_d[np].id===rp.id)return!0;return!1},getTensorsInContainer:kt}),Dt=function(){function rp(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return rp.prototype.dispose=function(){for(var _d in this.registeredVariables)this.registeredVariables[_d].dispose()},rp}(),Tt=function(){function rp(_d){this.ENV=_d,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Dt}return rp.prototype.ready=function(){return n$1(this,void 0,void 0,function(){var _d,np,ap;return r(this,function(sp){switch(sp.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];_d=this.getSortedBackends(),np=0,sp.label=1;case 1:return np<_d.length?(ap=_d[np],[4,this.initializeBackend(ap).success]):[3,5];case 2:return sp.sent()?[4,this.setBackend(ap)]:[3,4];case 3:return sp.sent(),[2];case 4:return np++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(rp.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(this.backendInstance==null){var _d=this.initializeBackendsAndReturnBest(),np=_d.name;if(_d.asyncInit)throw new Error("The highest priority backend '"+np+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(np)}return this.backendInstance},enumerable:!0,configurable:!0}),rp.prototype.backendNames=function(){return Object.keys(this.registryFactory)},rp.prototype.findBackend=function(_d){return!(_d in this.registry)&&(!(_d in this.registryFactory)||this.initializeBackend(_d).asyncInit)?null:this.registry[_d]},rp.prototype.findBackendFactory=function(_d){return _d in this.registryFactory?this.registryFactory[_d].factory:null},rp.prototype.registerBackend=function(_d,np,ap){return ap===void 0&&(ap=1),_d in this.registryFactory?(console.warn(_d+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[_d]={factory:np,priority:ap},!0)},rp.prototype.setBackend=function(_d){return n$1(this,void 0,void 0,function(){var np,ap,sp;return r(this,function(lp){switch(lp.label){case 0:if(this.registryFactory[_d]==null)throw new Error("Backend name '"+_d+"' not found in registry");return this.backendName=_d,this.registry[_d]!=null?[3,4]:(this.backendInstance=null,np=this.initializeBackend(_d),ap=np.success,np.asyncInit?[4,ap]:[3,2]);case 1:return sp=lp.sent(),[3,3];case 2:sp=ap,lp.label=3;case 3:if(!sp)return[2,!1];lp.label=4;case 4:return this.backendInstance=this.registry[_d],this.setupRegisteredKernels(),this.profiler=new et(this.backendInstance),[2,!0]}})})},rp.prototype.setupRegisteredKernels=function(){var _d=this;c$1(this.backendName).forEach(function(np){np.setupFunc!=null&&np.setupFunc(_d.backendInstance)})},rp.prototype.disposeRegisteredKernels=function(_d){var np=this;c$1(_d).forEach(function(ap){ap.disposeFunc!=null&&ap.disposeFunc(np.registry[_d])})},rp.prototype.initializeBackend=function(_d){var np=this,ap=this.registryFactory[_d];if(ap==null)throw new Error("Cannot initialize backend "+_d+", no registration found.");try{var sp=ap.factory();if(Promise.resolve(sp)===sp){var lp=++this.pendingBackendInitId,up=sp.then(function(cp){return!(lp<np.pendingBackendInitId)&&(np.registry[_d]=cp,np.pendingBackendInit=null,!0)}).catch(function(cp){return!(lp<np.pendingBackendInitId)&&(np.pendingBackendInit=null,console.warn("Initialization of backend "+_d+" failed"),console.warn(cp.stack||cp.message),!1)});return this.pendingBackendInit=up,{success:up,asyncInit:!0}}return this.registry[_d]=sp,{success:!0,asyncInit:!1}}catch(cp){return console.warn("Initialization of backend "+_d+" failed"),console.warn(cp.stack||cp.message),{success:!1,asyncInit:!1}}},rp.prototype.removeBackend=function(_d){if(!(_d in this.registryFactory))throw new Error(_d+" backend not found in registry");this.backendName===_d&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,_d in this.registry&&(this.disposeRegisteredKernels(_d),this.registry[_d].dispose(),delete this.registry[_d]),delete this.registryFactory[_d],this.backendName===_d&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},rp.prototype.getSortedBackends=function(){var _d=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(np,ap){return _d.registryFactory[ap].priority-_d.registryFactory[np].priority})},rp.prototype.initializeBackendsAndReturnBest=function(){for(var _d=this.getSortedBackends(),np=0;np<_d.length;np++){var ap=_d[np],sp=this.initializeBackend(ap),lp=sp.success,up=sp.asyncInit;if(up||lp)return{name:ap,asyncInit:up}}throw new Error("Could not initialize any backends, all backend initializations failed.")},rp.prototype.moveData=function(_d,np){var ap=this.state.tensorInfo.get(np),sp=ap.backend,lp=this.readSync(np);sp.disposeData(np),ap.backend=_d,_d.move(np,lp,ap.shape,ap.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},rp.prototype.tidy=function(_d,np){var ap,sp=this,lp=null;if(np==null){if(typeof _d!="function")throw new Error("Please provide a function to tidy()");np=_d}else{if(typeof _d!="string"&&!(_d instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof np!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");lp=_d}return this.scopedRun(function(){return sp.startScope(lp)},function(){return sp.endScope(ap)},function(){return(ap=np())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),ap})},rp.prototype.scopedRun=function(_d,np,ap){_d();try{var sp=ap();return np(),sp}catch(lp){throw np(),lp}},rp.prototype.nextTensorId=function(){return rp.nextTensorId++},rp.prototype.nextVariableId=function(){return rp.nextVariableId++},rp.prototype.clone=function(_d){var np=this.makeTensorFromDataId(_d.dataId,_d.shape,_d.dtype),ap={x:_d};return this.addTapeNode(this.state.activeScope.name,ap,[np],function(sp){return{x:function(){return sp.toFloat()}}},[]),np},rp.prototype.runKernel=function(_d,np,ap,sp,lp){return this.runKernelFunc(null,np,null,_d,ap,sp,lp)},rp.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},rp.prototype.checkKernelForMemLeak=function(_d,np,ap){var sp=this.backend.numDataIds(),lp=0;ap.forEach(function(dp){lp+=dp.dtype==="complex64"?3:1});var up=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],cp=sp-np-lp-up;if(cp>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+cp+" data ids) after running '"+_d+"'")},rp.prototype.runKernelFunc=function(_d,np,ap,sp,lp,up,cp){var dp,hp=this;up===void 0&&(up=[]),cp===void 0&&(cp=[]);var fp,pp=[],mp=this.isTapeOn(),gp=this.state.activeScope!=null?this.state.activeScope.name:"",yp=function(Ep){mp&&(pp=Ep.map(function(Sp){return hp.keep(hp.clone(Sp))}))},xp=this.state.numBytes,_p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var vp,bp=s(sp,this.backendName);return fp=bp!=null?function(){var Ep=hp.backend.numDataIds();vp=bp.kernelFunc({inputs:np,attrs:lp,backend:hp.backend});var Sp=Array.isArray(vp)?vp:[vp];hp.shouldCheckForMemLeaks()&&hp.checkKernelForMemLeak(gp,Ep,Sp);var Ap=Sp.map(function(Tp){var Mp=Tp.dataId,Op=Tp.shape,Pp=Tp.dtype;return hp.makeTensorFromDataId(Mp,Op,Pp)}),Rp=Ap.filter(function(Tp,Mp){return cp[Mp]});return yp(up.slice().concat(Rp)),Ap}:function(){var Ep=hp.backend.numDataIds();vp=hp.tidy(function(){return _d(hp.backend,yp)});var Sp=Array.isArray(vp)?vp:[vp];return hp.shouldCheckForMemLeaks()&&hp.checkKernelForMemLeak(gp,Ep,Sp),Sp},this.scopedRun(function(){return hp.state.kernelDepth++},function(){return hp.state.kernelDepth--},function(){dp=hp.ENV.getBool("DEBUG")?hp.profiler.profileKernel(gp,np,function(){return fp()}):fp()}),mp&&this.addTapeNode(gp,np,dp,ap,pp),this.state.profiling&&this.state.activeProfile.kernels.push({name:gp,bytesAdded:this.state.numBytes-xp,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-_p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(np).map(function(Ep){return np[Ep].shape}),outputShapes:dp.map(function(Ep){return Ep.shape})}),Array.isArray(vp)?dp:dp[0]},rp.prototype.makeTensor=function(_d,np,ap,sp){if(_d==null)throw new Error("Values passed to engine.makeTensor() are null");ap=ap||"float32",sp=sp||this.backend;var lp=_d;ap==="string"&&W(_d[0])&&(lp=_d.map(function(fp){return J(fp)}));var up=sp.write(lp,np,ap),cp=new dt(np,ap,up,this.nextTensorId());if(this.incRef(cp,sp),ap==="string"){var dp=this.state.tensorInfo.get(up),hp=L(lp);this.state.numBytes+=hp-dp.bytes,dp.bytes=hp}return cp},rp.prototype.makeTensorFromDataId=function(_d,np,ap,sp){var lp=new dt(np,ap=ap||"float32",_d,this.nextTensorId());return this.incRef(lp,sp),lp},rp.prototype.makeVariable=function(_d,np,ap,sp){np===void 0&&(np=!0),ap=ap||this.nextVariableId().toString(),sp!=null&&sp!==_d.dtype&&(_d=_d.asType(sp));var lp=new bt(_d,np,ap,this.nextTensorId());if(this.state.registeredVariables[lp.name]!=null)throw new Error("Variable with name "+lp.name+" was already registered");return this.state.registeredVariables[lp.name]=lp,this.incRef(lp,this.backend),lp},rp.prototype.incRef=function(_d,np){var ap=this.state.tensorInfo.has(_d.dataId)?this.state.tensorInfo.get(_d.dataId).refCount:0;if(this.state.numTensors++,_d.dtype==="string"&&this.state.numStringTensors++,ap===0){this.state.numDataBuffers++;var sp=0;_d.dtype!=="complex64"&&_d.dtype!=="string"&&(sp=_d.size*P(_d.dtype)),this.state.tensorInfo.set(_d.dataId,{backend:np||this.backend,dtype:_d.dtype,shape:_d.shape,bytes:sp,refCount:0}),this.state.numBytes+=sp}this.state.tensorInfo.get(_d.dataId).refCount++,_d instanceof bt||this.track(_d)},rp.prototype.disposeTensor=function(_d){if(this.state.tensorInfo.has(_d.dataId)){this.state.numTensors--,_d.dtype==="string"&&this.state.numStringTensors--;var np=this.state.tensorInfo.get(_d.dataId);np.refCount<=1?(_d.dtype!=="complex64"&&(this.state.numBytes-=np.bytes),this.state.numDataBuffers--,np.backend.disposeData(_d.dataId),this.state.tensorInfo.delete(_d.dataId)):this.state.tensorInfo.get(_d.dataId).refCount--}},rp.prototype.disposeVariables=function(){for(var _d in this.state.registeredVariables){var np=this.state.registeredVariables[_d];this.disposeVariable(np)}},rp.prototype.disposeVariable=function(_d){this.disposeTensor(_d),this.state.registeredVariables[_d.name]!=null&&delete this.state.registeredVariables[_d.name]},rp.prototype.memory=function(){var _d=this.backend.memory();return _d.numTensors=this.state.numTensors,_d.numDataBuffers=this.state.numDataBuffers,_d.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(_d.unreliable=!0,_d.reasons==null&&(_d.reasons=[]),_d.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),_d},rp.prototype.profile=function(_d){return n$1(this,void 0,void 0,function(){var np,ap;return r(this,function(sp){return this.state.profiling=!0,np=this.state.numBytes,ap=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=_d(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(lp){return lp.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-np,this.state.activeProfile.newTensors=this.state.numTensors-ap,[2,this.state.activeProfile]})})},rp.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},rp.prototype.addTapeNode=function(_d,np,ap,sp,lp){var up=this,cp={id:this.state.nextTapeNodeId++,name:_d,inputs:np,outputs:ap,saved:lp};sp!=null&&(cp.gradient=function(dp){return dp=dp.map(function(hp,fp){if(hp==null){var pp=ap[fp],mp=$$1(pp.size,pp.dtype);return up.makeTensor(mp,pp.shape,pp.dtype)}return hp}),sp(dp.length>1?dp:dp[0],lp)}),this.state.activeTape.push(cp)},rp.prototype.keep=function(_d){return _d.kept=!0,_d},rp.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},rp.prototype.endTape=function(){this.state.gradientDepth--},rp.prototype.startScope=function(_d){var np={track:[],name:"unnamed scope",id:this.state.nextScopeId++};_d&&(np.name=_d),this.state.scopeStack.push(np),this.state.activeScope=np},rp.prototype.endScope=function(_d){for(var np=this,ap=kt(_d),sp=new Set(ap.map(function(dp){return dp.id})),lp=0;lp<this.state.activeScope.track.length;lp++){var up=this.state.activeScope.track[lp];up.kept||sp.has(up.id)||up.dispose()}var cp=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],ap.forEach(function(dp){dp.kept||dp.scopeId!==cp.id||np.track(dp)})},rp.prototype.gradients=function(_d,np,ap,sp){var lp=this;if(sp===void 0&&(sp=!1),g(np.length>0,function(){return"gradients() received an empty list of xs."}),ap!=null&&ap.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+ap.dtype+"'");var up=this.scopedRun(function(){return lp.startTape()},function(){return lp.endTape()},function(){return lp.tidy("forward",_d)});g(up instanceof dt,function(){return"The result y returned by f() must be a tensor."});var cp=function(dp,hp,fp){for(var pp={},mp={},gp=0;gp<hp.length;gp++)pp[hp[gp].id]=!0;for(gp=0;gp<dp.length;gp++){var yp=(Rp=dp[gp]).inputs;for(var xp in yp){for(var _p=yp[xp],vp=!1,bp=0;bp<hp.length;bp++)if(pp[_p.id]){Rp.outputs.forEach(function(Pp){return pp[Pp.id]=!0}),vp=!0,mp[Rp.id]=!0;break}if(vp)break}}var Ep={};Ep[fp.id]=!0;var Sp={};for(gp=dp.length-1;gp>=0;gp--)for(yp=(Rp=dp[gp]).inputs,bp=0;bp<Rp.outputs.length;bp++)if(Ep[Rp.outputs[bp].id]){for(var xp in yp)Ep[yp[xp].id]=!0,Sp[Rp.id]=!0;break}var Ap=[];for(gp=0;gp<dp.length;gp++){var Rp;if(mp[(Rp=dp[gp]).id]&&Sp[Rp.id]){var Tp={};for(var xp in Rp.inputs){var Mp=Rp.inputs[xp];pp[Mp.id]&&(Tp[xp]=Mp)}var Op=Object.assign({},Rp);Op.inputs=Tp,Op.outputs=Rp.outputs,Ap.push(Op)}}return Ap}(this.state.activeTape,np,up);if(!sp&&cp.length===0&&np.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var dp,hp,fp={};fp[up.id]=ap??(dp=up.shape,hp=X(w$1(dp),"float32"),Nt.makeTensor(hp,dp,"float32")),function(mp,gp,yp){for(var xp=function(vp){var bp=gp[vp],Ep=[];if(bp.outputs.forEach(function(Tp){var Mp=mp[Tp.id];Mp!=null?Ep.push(Mp):Ep.push(null)}),bp.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+bp.name+".");var Sp=bp.gradient(Ep),Ap=function(Tp){if(!(Tp in Sp))throw new Error("Cannot backprop through input "+Tp+". Available gradients found: "+Object.keys(Sp)+".");var Mp=yp(function(){return Sp[Tp]()});if(Mp.dtype!=="float32")throw new Error("Error in gradient for op "+bp.name+". The gradient of input "+Tp+" must have 'float32' dtype, but has '"+Mp.dtype+"'");var Op=bp.inputs[Tp];if(!C(Mp.shape,Op.shape))throw new Error("Error in gradient for op "+bp.name+". The gradient of input '"+Tp+"' has shape '"+Mp.shape+"', which does not match the shape of the input '"+Op.shape+"'");if(mp[Op.id]==null)mp[Op.id]=Mp;else{var Pp=mp[Op.id];mp[Op.id]=Pp.add(Mp),Pp.dispose()}};for(var Rp in bp.inputs)Ap(Rp)},_p=gp.length-1;_p>=0;_p--)xp(_p)}(fp,cp,function(mp){return lp.tidy(mp)});var pp=np.map(function(mp){return fp[mp.id]});return lp.state.gradientDepth===0&&(lp.state.activeTape.forEach(function(mp){for(var gp in mp.saved)mp.saved[gp].dispose()}),lp.state.activeTape=null),{value:up,grads:pp}})},rp.prototype.customGrad=function(_d){var np=this;return g(G(_d),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var ap,sp=[],lp=0;lp<arguments.length;lp++)sp[lp]=arguments[lp];g(sp.every(function(cp){return cp instanceof dt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var up={};return sp.forEach(function(cp,dp){up[dp]=cp}),np.runKernelFunc(function(cp,dp){return g((ap=_d.apply(void 0,sp.concat([dp]))).value instanceof dt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),g(G(ap.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),ap.value},up,function(cp,dp){var hp=ap.gradFunc(cp,dp),fp=Array.isArray(hp)?hp:[hp];g(fp.length===sp.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),g(fp.every(function(mp){return mp instanceof dt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var pp={};return fp.forEach(function(mp,gp){pp[gp]=function(){return mp}}),pp})}},rp.prototype.readSync=function(_d){return this.state.tensorInfo.get(_d).backend.readSync(_d)},rp.prototype.read=function(_d){return this.state.tensorInfo.get(_d).backend.read(_d)},rp.prototype.fromPixels=function(_d,np){return this.backend.fromPixels(_d,np)},rp.prototype.time=function(_d){return n$1(this,void 0,void 0,function(){var np,ap;return r(this,function(sp){switch(sp.label){case 0:return np=Y(),[4,this.backend.time(_d)];case 1:return(ap=sp.sent()).wallMs=Y()-np,[2,ap]}})})},rp.prototype.track=function(_d){return this.state.activeScope!=null&&(_d.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(_d)),_d},Object.defineProperty(rp.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),rp.prototype.reset=function(){for(var _d in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Dt,this.registry)this.disposeRegisteredKernels(_d),this.registry[_d].dispose(),delete this.registry[_d];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},rp.nextTensorId=0,rp.nextVariableId=0,rp}(),Nt=function(){var rp=function(){if(St==null){var np=void 0;if(typeof window<"u")np=window;else if(typeof global<"u")np=global;else if(typeof process<"u")np=process;else{if(typeof self>"u")throw new Error("Could not find a global object");np=self}St=np}return St}();if(rp._tfengine==null){var _d=new o(rp);rp._tfengine=new Tt(_d)}return function(np){i$3=np}(rp._tfengine.ENV),ht=function(){return rp._tfengine},rp._tfengine}();function Ft(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Ot=a$1();Ot.registerFlag("DEBUG",function(){return!1},function(rp){rp&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Ot.registerFlag("IS_BROWSER",function(){return Ft()}),Ot.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Ot.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Ot.registerFlag("PROD",function(){return!1}),Ot.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Ot.getBool("DEBUG")}),Ot.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Ot.registerFlag("IS_TEST",function(){return!1});var _t,Mt,Bt,Pt={},Lt={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Wt(rp,_d){Pt[rp]=_d}function Ut(rp){rp in Pt||(Pt[rp]=function(np){if(np!==1&&np!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var ap=Vt(np);return ap.addEventListener("webglcontextlost",function(sp){sp.preventDefault(),delete Pt[np]},!1),np===1?ap.getContext("webgl",Lt)||ap.getContext("experimental-webgl",Lt):ap.getContext("webgl2",Lt)}(rp));var _d=Pt[rp];return _d.isContextLost()?(delete Pt[rp],Ut(rp)):(_d.disable(_d.DEPTH_TEST),_d.disable(_d.STENCIL_TEST),_d.disable(_d.BLEND),_d.disable(_d.DITHER),_d.disable(_d.POLYGON_OFFSET_FILL),_d.disable(_d.SAMPLE_COVERAGE),_d.enable(_d.SCISSOR_TEST),_d.enable(_d.CULL_FACE),_d.cullFace(_d.BACK),Pt[rp])}function Vt(rp){if(typeof OffscreenCanvas<"u"&&rp===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function zt(rp,_d){return[_d,rp]}function Gt(rp){var _d=w$1(rp);return I(Math.ceil(_d/4))}function Ht(rp,_d){return[Math.max(1,Math.ceil(_d/2)),Math.max(1,Math.ceil(rp/2))]}function qt(rp,_d){var np,ap,sp,lp,up,cp,dp,hp,fp,pp=rp;return a$1().getNumber("WEBGL_VERSION")===2?(np=pp.R32F,ap=pp.R16F,sp=pp.RGBA16F,lp=pp.RGBA32F,up=pp.RED,cp=4,dp=1,hp=pp.HALF_FLOAT,fp=pp.FLOAT):(np=rp.RGBA,ap=rp.RGBA,sp=rp.RGBA,lp=pp.RGBA,up=rp.RGBA,cp=4,dp=4,hp=_d!=null?_d.HALF_FLOAT_OES:null,fp=rp.FLOAT),{internalFormatFloat:np,internalFormatHalfFloat:ap,internalFormatPackedHalfFloat:sp,internalFormatPackedFloat:lp,textureFormatFloat:up,downloadTextureFormat:rp.RGBA,downloadUnpackNumChannels:cp,defaultNumChannels:dp,textureTypeHalfFloat:hp,textureTypeFloat:fp}}function Kt(rp,_d,np){var ap=np();return _d&&function(sp){var lp=sp.getError();if(lp!==sp.NO_ERROR)throw new Error("WebGL Error: "+Yt(sp,lp))}(rp),ap}(function(rp){rp[rp.DENSE=0]="DENSE",rp[rp.SHARED_BATCH=1]="SHARED_BATCH"})(_t||(_t={})),function(rp){rp[rp.RENDER=0]="RENDER",rp[rp.UPLOAD=1]="UPLOAD",rp[rp.PIXELS=2]="PIXELS",rp[rp.DOWNLOAD=3]="DOWNLOAD"}(Mt||(Mt={})),function(rp){rp[rp.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",rp[rp.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",rp[rp.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",rp[rp.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",rp[rp.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Bt||(Bt={}));var jt=596e-10,Xt=65504;function $t(rp){return!!(a$1().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||rp===0||jt<Math.abs(rp)&&Math.abs(rp)<Xt)}function Yt(rp,_d){switch(_d){case rp.NO_ERROR:return"NO_ERROR";case rp.INVALID_ENUM:return"INVALID_ENUM";case rp.INVALID_VALUE:return"INVALID_VALUE";case rp.INVALID_OPERATION:return"INVALID_OPERATION";case rp.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case rp.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case rp.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+_d}}function Qt(rp,_d,np){return be(rp,_d,function(){return rp.getExtension(np)},'Extension "'+np+'" not supported on this browser.')}function Jt(rp,_d,np){var ap=be(rp,_d,function(){return rp.createShader(rp.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Kt(rp,_d,function(){return rp.shaderSource(ap,np)}),Kt(rp,_d,function(){return rp.compileShader(ap)}),rp.getShaderParameter(ap,rp.COMPILE_STATUS)===!1)throw console.log(rp.getShaderInfoLog(ap)),new Error("Failed to compile vertex shader.");return ap}function Zt(rp,_d,np){var ap=be(rp,_d,function(){return rp.createShader(rp.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Kt(rp,_d,function(){return rp.shaderSource(ap,np)}),Kt(rp,_d,function(){return rp.compileShader(ap)}),rp.getShaderParameter(ap,rp.COMPILE_STATUS)===!1)throw function(sp,lp){var up=ne.exec(lp);if(up==null)return console.log("Couldn't parse line number in error: "+lp),void console.log(sp);for(var cp=+up[1],dp=sp.split(`
`),hp=dp.length.toString().length+2,fp=dp.map(function(_p,vp){return k$1((vp+1).toString(),hp)+_p}),pp=0,mp=0;mp<fp.length;mp++)pp=Math.max(fp[mp].length,pp);var gp=fp.slice(0,cp-1),yp=fp.slice(cp-1,cp),xp=fp.slice(cp);console.log(gp.join(`
`)),console.log(lp.split(`
`)[0]),console.log("%c "+k$1(yp[0],pp),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(xp.join(`
`))}(np,rp.getShaderInfoLog(ap)),new Error("Failed to compile fragment shader.");return ap}var te,ee,ne=/ERROR: [0-9]+:([0-9]+):/g;function re$2(rp,_d){return be(rp,_d,function(){return rp.createProgram()},"Unable to create WebGLProgram.")}function oe(rp,_d,np){if(Kt(rp,_d,function(){return rp.linkProgram(np)}),rp.getProgramParameter(np,rp.LINK_STATUS)===!1)throw console.log(rp.getProgramInfoLog(np)),new Error("Failed to link vertex and fragment shaders.")}function ae(rp,_d,np){if(Kt(rp,_d,function(){return rp.validateProgram(np)}),rp.getProgramParameter(np,rp.VALIDATE_STATUS)===!1)throw console.log(rp.getProgramInfoLog(np)),new Error("Shader program validation failed.")}function ie(rp,_d,np){var ap=be(rp,_d,function(){return rp.createBuffer()},"Unable to create WebGLBuffer");return Kt(rp,_d,function(){return rp.bindBuffer(rp.ARRAY_BUFFER,ap)}),Kt(rp,_d,function(){return rp.bufferData(rp.ARRAY_BUFFER,np,rp.STATIC_DRAW)}),ap}function ue(rp,_d,np){var ap=be(rp,_d,function(){return rp.createBuffer()},"Unable to create WebGLBuffer");return Kt(rp,_d,function(){return rp.bindBuffer(rp.ELEMENT_ARRAY_BUFFER,ap)}),Kt(rp,_d,function(){return rp.bufferData(rp.ELEMENT_ARRAY_BUFFER,np,rp.STATIC_DRAW)}),ap}function se(rp,_d){return be(rp,_d,function(){return rp.createTexture()},"Unable to create WebGLTexture.")}function ce(rp,_d){var np=a$1().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(rp<=0||_d<=0){var ap="["+rp+"x"+_d+"]";throw new Error("Requested texture size "+ap+" is invalid.")}if(rp>np||_d>np)throw ap="["+rp+"x"+_d+"]",new Error("Requested texture size "+ap+" greater than WebGL maximum on this browser / GPU "+("["+np+"x"+np+"]")+".")}function le(rp,_d){return be(rp,_d,function(){return rp.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function he(rp,_d,np,ap,sp,lp,up,cp){var dp=rp.getAttribLocation(np,ap);return dp!==-1&&(Kt(rp,_d,function(){return rp.bindBuffer(rp.ARRAY_BUFFER,sp)}),Kt(rp,_d,function(){return rp.vertexAttribPointer(dp,lp,rp.FLOAT,!1,up,cp)}),Kt(rp,_d,function(){return rp.enableVertexAttribArray(dp)}),!0)}function fe(rp,_d,np,ap){we(rp,ap),Kt(rp,_d,function(){return rp.activeTexture(rp.TEXTURE0+ap)}),Kt(rp,_d,function(){return rp.bindTexture(rp.TEXTURE_2D,np)})}function pe(rp,_d,np,ap){return be(rp,_d,function(){return rp.getUniformLocation(np,ap)},'uniform "'+ap+'" not present in program.')}function de(rp,_d,np){return rp.getUniformLocation(_d,np)}function ve(rp,_d,np,ap,sp,lp){Kt(rp,_d,function(){return fe(rp,_d,ap,lp)}),Kt(rp,_d,function(){return rp.uniform1i(sp,lp)})}function me(rp,_d,np,ap){Kt(rp,_d,function(){return rp.bindFramebuffer(rp.FRAMEBUFFER,ap)}),Kt(rp,_d,function(){return rp.framebufferTexture2D(rp.FRAMEBUFFER,rp.COLOR_ATTACHMENT0,rp.TEXTURE_2D,np,0)})}function ge(rp,_d,np){Kt(rp,_d,function(){return rp.bindFramebuffer(rp.FRAMEBUFFER,np)}),Kt(rp,_d,function(){return rp.framebufferTexture2D(rp.FRAMEBUFFER,rp.COLOR_ATTACHMENT0,rp.TEXTURE_2D,null,0)})}function ye(rp){var _d=rp.checkFramebufferStatus(rp.FRAMEBUFFER);if(_d!==rp.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+xe(rp,_d))}function xe(rp,_d){switch(_d){case rp.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case rp.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case rp.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case rp.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+_d}}function be(rp,_d,np,ap){var sp=Kt(rp,_d,function(){return np()});if(sp==null)throw new Error(ap);return sp}function we(rp,_d){var np=rp.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,ap=_d+rp.TEXTURE0;if(ap<rp.TEXTURE0||ap>np)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+np+"]")+".")}function Ce(rp,_d){return _d===void 0&&(_d=2),w$1(rp.slice(0,rp.length-_d))}function Ee(rp){if(rp.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[rp.length>1?rp[rp.length-2]:1,rp[rp.length-1]]}function Re(rp){var _d=[1,1,1];return rp.length===0||rp.length===1&&rp[0]===1||(_d=[Ce(rp)].concat(Ee(rp))),_d}function Ie(rp,_d){var np;_d===void 0&&(_d=!1);var ap=a$1().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(_d&&(ap*=2,(rp=rp.map(function(hp,fp){return fp>=rp.length-2?v$2(rp[fp]):rp[fp]})).length===1&&(rp=[2,rp[0]])),rp.length!==2){var sp=T(rp);rp=sp.newShape}var lp=w$1(rp);if(rp.length<=1&&lp<=ap)return[1,lp];if(rp.length===2&&rp[0]<=ap&&rp[1]<=ap)return rp;if(rp.length===3&&rp[0]*rp[1]<=ap&&rp[2]<=ap)return[rp[0]*rp[1],rp[2]];if(rp.length===3&&rp[0]<=ap&&rp[1]*rp[2]<=ap)return[rp[0],rp[1]*rp[2]];if(rp.length===4&&rp[0]*rp[1]*rp[2]<=ap&&rp[3]<=ap)return[rp[0]*rp[1]*rp[2],rp[3]];if(rp.length===4&&rp[0]<=ap&&rp[1]*rp[2]*rp[3]<=ap)return[rp[0],rp[1]*rp[2]*rp[3]];if(_d){var up=Ce(rp),cp=2,dp=2;return rp.length&&(cp=(np=Ee(rp))[0],dp=np[1]),I(lp=up*(cp/2)*(dp/2)).map(function(hp){return 2*hp})}return I(lp)}function ke(rp){return rp%2==0}function Se(rp,_d){if(C(rp=rp.slice(-2),_d=_d.slice(-2))||!rp.length||!_d.length||rp[0]===0||rp[1]===0||_d[0]===0||_d[1]===0)return!0;if(rp.length!==_d.length){var np=rp.slice(-1)[0],ap=_d.slice(-1)[0];if(np===ap||ke(np)&&ke(ap)&&(rp[0]===1||_d[0]===1))return!0}return rp[1]===_d[1]&&ke(rp[0])&&ke(_d[0])}function Ae(rp){if(te==null){var _d=Ut(rp);te=_d.getParameter(_d.MAX_TEXTURE_SIZE)}return te}function De(rp){if(ee==null){var _d=Ut(rp);ee=_d.getParameter(_d.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ee)}function Te(rp){if(rp===0)return 0;var _d=Ut(rp);return Ne(_d,"EXT_disjoint_timer_query_webgl2")&&rp===2?2:Ne(_d,"EXT_disjoint_timer_query")?1:0}function Ne(rp,_d){return rp.getExtension(_d)!=null}function Fe(rp){try{if(Ut(rp)!=null)return!0}catch{return!1}return!1}function Oe(rp){if(rp===0)return!1;var _d=Ut(rp);if(rp===1){if(!Ne(_d,"OES_texture_float"))return!1}else if(!Ne(_d,"EXT_color_buffer_float"))return!1;return Me(_d)}function _e(rp){if(rp===0)return!1;var _d=Ut(rp);if(rp!==1){if(Ne(_d,"EXT_color_buffer_float"))return Me(_d);if(Ne(_d,"EXT_color_buffer_half_float")){var np=_d.getExtension("EXT_color_buffer_half_float");return function(ap,sp){var lp=qt(ap,sp),up=ap.createTexture();ap.bindTexture(ap.TEXTURE_2D,up),ap.texImage2D(ap.TEXTURE_2D,0,lp.internalFormatHalfFloat,1,1,0,lp.textureFormatFloat,lp.textureTypeHalfFloat,null);var cp=ap.createFramebuffer();ap.bindFramebuffer(ap.FRAMEBUFFER,cp),ap.framebufferTexture2D(ap.FRAMEBUFFER,ap.COLOR_ATTACHMENT0,ap.TEXTURE_2D,up,0);var dp=ap.checkFramebufferStatus(ap.FRAMEBUFFER)===ap.FRAMEBUFFER_COMPLETE;return ap.bindTexture(ap.TEXTURE_2D,null),ap.bindFramebuffer(ap.FRAMEBUFFER,null),ap.deleteTexture(up),ap.deleteFramebuffer(cp),dp}(_d,np)}return!1}return!!Ne(_d,"OES_texture_float")&&!!Ne(_d,"WEBGL_color_buffer_float")&&Me(_d)}function Me(rp){var _d=qt(rp),np=rp.createTexture();rp.bindTexture(rp.TEXTURE_2D,np),rp.texImage2D(rp.TEXTURE_2D,0,_d.internalFormatFloat,1,1,0,_d.textureFormatFloat,_d.textureTypeFloat,null);var ap=rp.createFramebuffer();rp.bindFramebuffer(rp.FRAMEBUFFER,ap),rp.framebufferTexture2D(rp.FRAMEBUFFER,rp.COLOR_ATTACHMENT0,rp.TEXTURE_2D,np,0);var sp=rp.checkFramebufferStatus(rp.FRAMEBUFFER)===rp.FRAMEBUFFER_COMPLETE;return rp.bindTexture(rp.TEXTURE_2D,null),rp.bindFramebuffer(rp.FRAMEBUFFER,null),rp.deleteTexture(np),rp.deleteFramebuffer(ap),sp}function Be(rp){return rp===2&&Ut(rp).fenceSync!=null}var Pe=Object.freeze({callAndCheck:Kt,canBeRepresented:$t,getWebGLErrorMessage:Yt,getExtensionOrThrow:Qt,createVertexShader:Jt,createFragmentShader:Zt,createProgram:re$2,linkProgram:oe,validateProgram:ae,createStaticVertexBuffer:ie,createStaticIndexBuffer:ue,getNumChannels:function(){return a$1().getNumber("WEBGL_VERSION")===2?1:4},createTexture:se,validateTextureSize:ce,createFramebuffer:le,bindVertexBufferToProgramAttribute:he,bindTextureUnit:fe,unbindTextureUnit:function(rp,_d,np){we(rp,np),Kt(rp,_d,function(){return rp.activeTexture(rp.TEXTURE0+np)}),Kt(rp,_d,function(){return rp.bindTexture(rp.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:pe,getProgramUniformLocation:de,bindTextureToProgramUniformSampler:ve,bindCanvasToFramebuffer:function(rp,_d){Kt(rp,_d,function(){return rp.bindFramebuffer(rp.FRAMEBUFFER,null)}),Kt(rp,_d,function(){return rp.viewport(0,0,rp.canvas.width,rp.canvas.height)}),Kt(rp,_d,function(){return rp.scissor(0,0,rp.canvas.width,rp.canvas.height)})},bindColorTextureToFramebuffer:me,unbindColorTextureFromFramebuffer:ge,validateFramebuffer:ye,getFramebufferErrorMessage:xe,getBatchDim:Ce,getRowsCols:Ee,getShapeAs3D:Re,getTextureShapeFromLogicalShape:Ie,isReshapeFree:Se,getWebGLMaxTextureSize:Ae,resetMaxTextureSize:function(){te=null},resetMaxTexturesInShader:function(){ee=null},getMaxTexturesInShader:De,getWebGLDisjointQueryTimerVersion:Te,hasExtension:Ne,isWebGLVersionEnabled:Fe,isCapableOfRenderingToFloatTexture:Oe,isDownloadFloatTextureEnabled:_e,isWebGLFenceEnabled:Be}),Le=a$1();function We(){a$1().set("PROD",!0)}function Ue(){a$1().set("DEBUG",!0)}function Ve(){a$1().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function ze(rp){a$1().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(rp+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ge(){Nt.disposeVariables()}function He(){return Nt}function qe(){return Nt.memory()}function Ke(rp){return Nt.profile(rp)}function je(rp,_d){return Nt.tidy(rp,_d)}function Xe(rp){kt(rp).forEach(function(_d){return _d.dispose()})}function $e(rp){return Nt.keep(rp)}function Ye(rp){return Nt.time(rp)}function Qe(rp){return Nt.setBackend(rp)}function Je(){return Nt.ready()}function Ze(){return Nt.backendName}function tn(rp){Nt.removeBackend(rp)}function en(rp){return Nt.findBackend(rp)}function nn(rp){return Nt.findBackendFactory(rp)}function rn(rp,_d,np){return np===void 0&&(np=1),Nt.registerBackend(rp,_d,np)}function on(){return Nt.backend}function an(rp,_d){a$1().setPlatform(rp,_d)}function un(){for(var rp=[],_d=0;_d<arguments.length;_d++)rp[_d]=arguments[_d];a$1().getBool("IS_TEST")||console.warn.apply(console,rp)}function sn(rp,_d){var np=rp;if(B(rp))return _d==="string"?[]:[rp.length];if(!Array.isArray(rp))return[];for(var ap=[];Array.isArray(np)||B(np)&&_d!=="string";)ap.push(np.length),np=np[0];return Array.isArray(rp)&&a$1().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function sp(lp,up,cp){if(cp=cp||[],!Array.isArray(lp)&&!B(lp))return void g(up.length===0,function(){return"Element arr["+cp.join("][")+"] is a primitive, but should be an array/TypedArray of "+up[0]+" elements"});g(up.length>0,function(){return"Element arr["+cp.join("][")+"] should be a primitive, but is an array of "+lp.length+" elements"}),g(lp.length===up[0],function(){return"Element arr["+cp.join("][")+"] should have "+up[0]+" elements, but has "+lp.length+" elements"});for(var dp=up.slice(1),hp=0;hp<lp.length;++hp)sp(lp[hp],dp,cp.concat(hp))}(rp,ap,[]),ap}function cn(rp,_d,np,ap){if(rp!=null&&(rp!=="numeric"&&rp!==_d||rp==="numeric"&&_d==="string"))throw new Error("Argument '"+np+"' passed to '"+ap+"' must be "+rp+" tensor, but got "+_d+" tensor")}function ln(rp,_d,np,ap){if(ap===void 0&&(ap="numeric"),rp instanceof dt)return cn(ap,rp.dtype,_d,np),rp;var sp=z(rp);if(sp!=="string"&&["bool","int32","float32"].indexOf(ap)>=0&&(sp=ap),cn(ap,sp,_d,np),rp==null||!B(rp)&&!Array.isArray(rp)&&typeof rp!="number"&&typeof rp!="boolean"&&typeof rp!="string"){var lp=rp==null?"null":rp.constructor.name;throw new Error("Argument '"+_d+"' passed to '"+np+"' must be a Tensor or TensorLike, but got '"+lp+"'")}var up=sn(rp,sp);B(rp)||Array.isArray(rp)||(rp=[rp]);var cp=sp!=="string"?K(rp,sp,a$1().getBool("DEBUG")):b(rp,[],!0);return Nt.makeTensor(cp,up,sp)}function hn(rp,_d,np,ap){if(ap===void 0&&(ap="numeric"),!Array.isArray(rp))throw new Error("Argument "+_d+" passed to "+np+" must be a `Tensor[]` or `TensorLike[]`");return rp.map(function(sp,lp){return ln(sp,_d+"["+lp+"]",np)},ap)}function fn(rp,_d){for(var np=0;np<rp.length;++np)if(rp[rp.length-np-1]!==_d-1-np)return!1;return!0}function pn(rp,_d,np){for(var ap=rp.length+_d.length,sp=[],lp=0,up=0,cp=0;cp<ap;cp++)np.indexOf(cp)===-1?sp.push(rp[lp++]):sp.push(_d[up++]);return sp}function dn(rp,_d){for(var np=[],ap=rp.length,sp=0;sp<ap;sp++)_d.indexOf(sp)===-1&&np.push(rp[sp]);return[np,_d.map(function(lp){return rp[lp]})]}function vn(rp,_d){return pn(rp,_d.map(function(np){return 1}),_d)}function mn(rp,_d,np){g(fn(_d,np),function(){return rp+" supports only inner-most axes for now. Got axes "+_d+" and rank-"+np+" input."})}function gn(rp,_d){if(fn(rp,_d))return null;for(var np=[],ap=0;ap<_d;++ap)rp.indexOf(ap)===-1&&np.push(ap);return rp.forEach(function(sp){return np.push(sp)}),np}function yn(rp){return rp.map(function(_d,np){return[np,_d]}).sort(function(_d,np){return _d[1]-np[1]}).map(function(_d){return _d[0]})}function xn(rp,_d){for(var np=[],ap=_d-rp;ap<_d;++ap)np.push(ap);return np}function bn(rp,_d){var np=rp[0].length;rp.forEach(function(sp,lp){g(sp.length===np,function(){return"Error in concat"+np+"D: rank of tensors["+lp+"] must be the same as the rank of the rest ("+np+")"})}),g(_d>=0&&_d<np,function(){return"Error in concat"+np+"D: axis must be between 0 and "+(np-1)+"."});var ap=rp[0];rp.forEach(function(sp,lp){for(var up=0;up<np;up++)g(up===_d||sp[up]===ap[up],function(){return"Error in concat"+np+"D: Shape of tensors["+lp+"] ("+sp+") does not match the shape of the rest ("+ap+") along the non-concatenated axis "+lp+"."})})}function wn(rp,_d){for(var np=rp[0].slice(),ap=1;ap<rp.length;ap++)np[_d]+=rp[ap][_d];return np}function Cn(rp){var _d=Object.keys(rp);if(_d.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+_d.length+" keys.");var np=_d[0],ap=rp[np];np.endsWith("_")&&(np=np.substring(0,np.length-1));var sp=function(){for(var lp=[],up=0;up<arguments.length;up++)lp[up]=arguments[up];Nt.startScope(np);try{var cp=ap.apply(void 0,lp);return cp instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Nt.endScope(cp),cp}catch(dp){throw Nt.endScope(null),dp}};return Object.defineProperty(sp,"name",{value:np,configurable:!0}),sp}Le.registerFlag("HAS_WEBGL",function(){return Le.getNumber("WEBGL_VERSION")>0}),Le.registerFlag("WEBGL_VERSION",function(){return Fe(2)?2:Fe(1)?1:0}),Le.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Le.get("WEBGL_VERSION")===2}),Le.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Le.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Le.registerFlag("WEBGL_PACK",function(){return Le.getBool("HAS_WEBGL")}),Le.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_CLIP",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Le.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_PACK_REDUCE",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_CONV_IM2COL",function(){return Le.getBool("WEBGL_PACK")}),Le.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return Ae(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return De(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var rp=Le.getNumber("WEBGL_VERSION");return rp===0?0:Te(rp)}),Le.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Le.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(rp=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(rp)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(rp.substr(0,4))));var rp}),Le.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return Oe(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Le.getBool("WEBGL_FORCE_F16_TEXTURES")&&Le.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Le.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return _e(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return Be(Le.getNumber("WEBGL_VERSION"))}),Le.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Le.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),pt=ze;var En=Cn({complex_:function(rp,_d){var np=ln(rp,"real","complex"),ap=ln(_d,"imag","complex");return y(np.shape,ap.shape,"real and imag shapes, "+np.shape+" and "+ap.shape+", must match in call to tf.complex()."),Nt.runKernelFunc(function(sp){return sp.complex(np,ap)},{$real:np,$imag:ap})}}),Rn=Cn({real_:function(rp){var _d=ln(rp,"input","real");return Nt.runKernelFunc(function(np){return np.real(_d)},{$input:_d})}}),In=Cn({imag_:function(rp){var _d=ln(rp,"input","imag");return Nt.runKernelFunc(function(np){return np.imag(_d)},{$input:_d})}});function kn(rp,_d,np){return Sn(rp,_d,sn(rp,np),np)}function Sn(rp,_d,np,ap){if(ap==null&&(ap=z(rp)),ap==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!B(rp)&&!Array.isArray(rp)&&typeof rp!="number"&&typeof rp!="boolean"&&typeof rp!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(_d!=null){Q(_d);var sp=w$1(_d),lp=w$1(np);g(sp===lp,function(){return"Based on the provided shape, ["+_d+"], the tensor should have "+sp+" values but has "+lp});for(var up=0;up<np.length;++up){var cp=np[up],dp=up!==np.length-1||cp!==w$1(_d.slice(up));g(np[up]===_d[up]||!dp,function(){return"Error creating a new Tensor. Inferred shape ("+np+") does not match the provided shape ("+_d+"). "})}}return B(rp)||Array.isArray(rp)||(rp=[rp]),_d=_d||np,rp=ap!=="string"?K(rp,ap,a$1().getBool("DEBUG")):b(rp,[],!0),Nt.makeTensor(rp,_d,ap)}function An(rp,_d){if((B(rp)&&_d!=="string"||Array.isArray(rp))&&_d!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(_d==="string"&&B(rp)&&!(rp instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Sn(rp,[],[],_d)}function Dn(rp,_d){x(rp);var np=sn(rp,_d);if(np.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Sn(rp,null,np,_d)}function Tn(rp,_d,np){if(x(rp),_d!=null&&_d.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var ap=sn(rp,np);if(ap.length!==2&&ap.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(ap.length===1&&_d==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Sn(rp,_d,ap,np)}function Nn(rp,_d,np){if(x(rp),_d!=null&&_d.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var ap=sn(rp,np);if(ap.length!==3&&ap.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(ap.length===1&&_d==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Sn(rp,_d,ap,np)}function Fn(rp,_d,np){if(x(rp),_d!=null&&_d.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var ap=sn(rp,np);if(ap.length!==4&&ap.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(ap.length===1&&_d==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Sn(rp,_d,ap,np)}function On(rp,_d,np){if(x(rp),_d!=null&&_d.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var ap=sn(rp,np);if(ap.length!==5&&ap.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(ap.length===1&&_d==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Sn(rp,_d,ap,np)}function _n(rp,_d,np){if(x(rp),_d!=null&&_d.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var ap=sn(rp,np);if(ap.length!==6&&ap.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(ap.length===1&&_d==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Sn(rp,_d=_d||ap,ap,np)}function Mn(rp,_d,np,ap){return _d===void 0&&(_d=!0),Nt.makeVariable(rp,_d,np,ap)}function Bn(rp,_d){if(_d===void 0&&(_d="float32"),_d==="complex64"){var np=Bn(rp,"float32"),ap=Pn(rp,"float32");return En(np,ap)}var sp=X(w$1(rp),_d);return Nt.makeTensor(sp,rp,_d)}function Pn(rp,_d){if(_d===void 0&&(_d="float32"),_d==="complex64"){var np=Pn(rp,"float32"),ap=Pn(rp,"float32");return En(np,ap)}var sp=$$1(w$1(rp),_d);return Nt.makeTensor(sp,rp,_d)}function Ln(rp,_d,np){return Nt.runKernelFunc(function(ap){return ap.fill(rp,_d,np)},{})}function Wn(rp,_d,np){if(np<=0)throw new Error("The number of values should be positive.");return Nt.runKernelFunc(function(ap){return ap.linspace(rp,_d,np)},{})}function Un(rp,_d,np,ap){if(np===void 0&&(np=1),ap===void 0&&(ap="float32"),np===0)throw new Error("Cannot have a step of zero");if(rp===_d||rp<_d&&np<0||_d<rp&&np>1)return Pn([0],ap);var sp=$$1(Math.abs(Math.ceil((_d-rp)/np)),ap);_d<rp&&np===1&&(np=-1),sp[0]=rp;for(var lp=1;lp<sp.length;lp++)sp[lp]=sp[lp-1]+np;return Dn(sp,ap)}var Vn=Cn({onesLike_:function(rp){var _d=ln(rp,"x","onesLike");if(_d.dtype==="complex64"){var np=Vn(Rn(_d)),ap=zn(In(_d));return En(np,ap)}return Nt.runKernelFunc(function(sp){return sp.onesLike(_d)},{$x:_d},function(sp,lp){return{$x:function(){return zn(sp)}}})}}),zn=Cn({zerosLike_:function(rp){var _d=ln(rp,"x","zerosLike");return Nt.runKernelFunc(function(np){return np.zerosLike(_d)},{$x:_d},function(np,ap){return{$x:function(){return zn(np)}}})}}),Gn=Cn({concat_:function(rp,_d){_d===void 0&&(_d=0),g(rp.length>=1,function(){return"Pass at least one tensor to concat"});var np=hn(rp,"tensors","concat");np[0].dtype==="complex64"&&np.forEach(function(up){if(up.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+up.dtype+". ")}),_d=D(_d,np[0].shape)[0];var ap=wn(np.map(function(up){return up.shape}),_d);if(w$1(ap)===0)return kn([],ap);if((np=np.filter(function(up){return up.size>0})).length===1)return np[0];var sp=np.map(function(up){return up.shape});bn(sp,_d);var lp=np;return Nt.runKernelFunc(function(up){return up.concat(np,_d)},lp,function(up){var cp=sp.map(function(dp){return dp[_d]});return Xn(up,cp,_d).map(function(dp){return function(){return dp}})})}}),Hn=Cn({concat1d_:function(rp){return Gn(rp,0)}}),qn=Cn({concat2d_:function(rp,_d){return Gn(rp,_d)}}),Kn=Cn({concat3d_:function(rp,_d){return Gn(rp,_d)}}),jn=Cn({concat4d_:function(rp,_d){return Gn(rp,_d)}}),Xn=Cn({split_:function(rp,_d,np){np===void 0&&(np=0);var ap,sp=ln(rp,"x","split");return np=D(np,sp.shape)[0],typeof _d=="number"?(g(sp.shape[np]%_d==0,function(){return"Number of splits must evenly divide the axis."}),ap=new Array(_d).fill(sp.shape[np]/_d)):(g(sp.shape[np]===_d.reduce(function(lp,up){return lp+up}),function(){return"The sum of sizes must match the size of the axis dimension."}),ap=_d),Nt.runKernelFunc(function(lp){return lp.split(sp,ap,np)},{$x:sp},function(lp){return{$x:function(){return Gn(lp,np)}}})}});function $n(rp,_d){return rp(_d={exports:{}},_d.exports),_d.exports}var Yn=$n(function(rp){(function(_d,np,ap){function sp(cp){var dp,hp=this,fp=(dp=4022871197,function(pp){pp=pp.toString();for(var mp=0;mp<pp.length;mp++){var gp=.02519603282416938*(dp+=pp.charCodeAt(mp));gp-=dp=gp>>>0,dp=(gp*=dp)>>>0,dp+=4294967296*(gp-=dp)}return 23283064365386963e-26*(dp>>>0)});hp.next=function(){var pp=2091639*hp.s0+23283064365386963e-26*hp.c;return hp.s0=hp.s1,hp.s1=hp.s2,hp.s2=pp-(hp.c=0|pp)},hp.c=1,hp.s0=fp(" "),hp.s1=fp(" "),hp.s2=fp(" "),hp.s0-=fp(cp),hp.s0<0&&(hp.s0+=1),hp.s1-=fp(cp),hp.s1<0&&(hp.s1+=1),hp.s2-=fp(cp),hp.s2<0&&(hp.s2+=1),fp=null}function lp(cp,dp){return dp.c=cp.c,dp.s0=cp.s0,dp.s1=cp.s1,dp.s2=cp.s2,dp}function up(cp,dp){var hp=new sp(cp),fp=dp&&dp.state,pp=hp.next;return pp.int32=function(){return 4294967296*hp.next()|0},pp.double=function(){return pp()+11102230246251565e-32*(2097152*pp()|0)},pp.quick=pp,fp&&(typeof fp=="object"&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.alea=up})(0,rp,!1)}),Qn=$n(function(rp){(function(_d,np,ap){function sp(cp){var dp=this,hp="";dp.x=0,dp.y=0,dp.z=0,dp.w=0,dp.next=function(){var pp=dp.x^dp.x<<11;return dp.x=dp.y,dp.y=dp.z,dp.z=dp.w,dp.w^=dp.w>>>19^pp^pp>>>8},cp===(0|cp)?dp.x=cp:hp+=cp;for(var fp=0;fp<hp.length+64;fp++)dp.x^=0|hp.charCodeAt(fp),dp.next()}function lp(cp,dp){return dp.x=cp.x,dp.y=cp.y,dp.z=cp.z,dp.w=cp.w,dp}function up(cp,dp){var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=((hp.next()>>>11)+(hp.next()>>>0)/4294967296)/2097152;while(mp===0);return mp},pp.int32=hp.next,pp.quick=pp,fp&&(typeof fp=="object"&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.xor128=up})(0,rp,!1)}),Jn=$n(function(rp){(function(_d,np,ap){function sp(cp){var dp=this,hp="";dp.next=function(){var pp=dp.x^dp.x>>>2;return dp.x=dp.y,dp.y=dp.z,dp.z=dp.w,dp.w=dp.v,(dp.d=dp.d+362437|0)+(dp.v=dp.v^dp.v<<4^pp^pp<<1)|0},dp.x=0,dp.y=0,dp.z=0,dp.w=0,dp.v=0,cp===(0|cp)?dp.x=cp:hp+=cp;for(var fp=0;fp<hp.length+64;fp++)dp.x^=0|hp.charCodeAt(fp),fp==hp.length&&(dp.d=dp.x<<10^dp.x>>>4),dp.next()}function lp(cp,dp){return dp.x=cp.x,dp.y=cp.y,dp.z=cp.z,dp.w=cp.w,dp.v=cp.v,dp.d=cp.d,dp}function up(cp,dp){var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=((hp.next()>>>11)+(hp.next()>>>0)/4294967296)/2097152;while(mp===0);return mp},pp.int32=hp.next,pp.quick=pp,fp&&(typeof fp=="object"&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.xorwow=up})(0,rp,!1)}),Zn=$n(function(rp){(function(_d,np,ap){function sp(cp){var dp=this;dp.next=function(){var hp,fp,pp=dp.x,mp=dp.i;return hp=pp[mp],fp=(hp^=hp>>>7)^hp<<24,fp^=(hp=pp[mp+1&7])^hp>>>10,fp^=(hp=pp[mp+3&7])^hp>>>3,fp^=(hp=pp[mp+4&7])^hp<<7,hp=pp[mp+7&7],fp^=(hp^=hp<<13)^hp<<9,pp[mp]=fp,dp.i=mp+1&7,fp},function(hp,fp){var pp,mp=[];if(fp===(0|fp))mp[0]=fp;else for(fp=""+fp,pp=0;pp<fp.length;++pp)mp[7&pp]=mp[7&pp]<<15^fp.charCodeAt(pp)+mp[pp+1&7]<<13;for(;mp.length<8;)mp.push(0);for(pp=0;pp<8&&mp[pp]===0;++pp);for(pp==8?mp[7]=-1:mp[pp],hp.x=mp,hp.i=0,pp=256;pp>0;--pp)hp.next()}(dp,cp)}function lp(cp,dp){return dp.x=cp.x.slice(),dp.i=cp.i,dp}function up(cp,dp){cp==null&&(cp=+new Date);var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=((hp.next()>>>11)+(hp.next()>>>0)/4294967296)/2097152;while(mp===0);return mp},pp.int32=hp.next,pp.quick=pp,fp&&(fp.x&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.xorshift7=up})(0,rp,!1)}),tr=$n(function(rp){(function(_d,np,ap){function sp(cp){var dp=this;dp.next=function(){var hp,fp,pp=dp.w,mp=dp.X,gp=dp.i;return dp.w=pp=pp+1640531527|0,fp=mp[gp+34&127],hp=mp[gp=gp+1&127],fp^=fp<<13,hp^=hp<<17,fp^=fp>>>15,hp^=hp>>>12,fp=mp[gp]=fp^hp,dp.i=gp,fp+(pp^pp>>>16)|0},function(hp,fp){var pp,mp,gp,yp,xp,_p=[],vp=128;for(fp===(0|fp)?(mp=fp,fp=null):(fp+="\0",mp=0,vp=Math.max(vp,fp.length)),gp=0,yp=-32;yp<vp;++yp)fp&&(mp^=fp.charCodeAt((yp+32)%fp.length)),yp===0&&(xp=mp),mp^=mp<<10,mp^=mp>>>15,mp^=mp<<4,mp^=mp>>>13,yp>=0&&(xp=xp+1640531527|0,gp=(pp=_p[127&yp]^=mp+xp)==0?gp+1:0);for(gp>=128&&(_p[127&(fp&&fp.length||0)]=-1),gp=127,yp=512;yp>0;--yp)mp=_p[gp+34&127],pp=_p[gp=gp+1&127],mp^=mp<<13,pp^=pp<<17,mp^=mp>>>15,pp^=pp>>>12,_p[gp]=mp^pp;hp.w=xp,hp.X=_p,hp.i=gp}(dp,cp)}function lp(cp,dp){return dp.i=cp.i,dp.w=cp.w,dp.X=cp.X.slice(),dp}function up(cp,dp){cp==null&&(cp=+new Date);var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=((hp.next()>>>11)+(hp.next()>>>0)/4294967296)/2097152;while(mp===0);return mp},pp.int32=hp.next,pp.quick=pp,fp&&(fp.X&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.xor4096=up})(0,rp,!1)}),er=$n(function(rp){(function(_d,np,ap){function sp(cp){var dp=this,hp="";dp.next=function(){var pp=dp.b,mp=dp.c,gp=dp.d,yp=dp.a;return pp=pp<<25^pp>>>7^mp,mp=mp-gp|0,gp=gp<<24^gp>>>8^yp,yp=yp-pp|0,dp.b=pp=pp<<20^pp>>>12^mp,dp.c=mp=mp-gp|0,dp.d=gp<<16^mp>>>16^yp,dp.a=yp-pp|0},dp.a=0,dp.b=0,dp.c=-1640531527,dp.d=1367130551,cp===Math.floor(cp)?(dp.a=cp/4294967296|0,dp.b=0|cp):hp+=cp;for(var fp=0;fp<hp.length+20;fp++)dp.b^=0|hp.charCodeAt(fp),dp.next()}function lp(cp,dp){return dp.a=cp.a,dp.b=cp.b,dp.c=cp.c,dp.d=cp.d,dp}function up(cp,dp){var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=((hp.next()>>>11)+(hp.next()>>>0)/4294967296)/2097152;while(mp===0);return mp},pp.int32=hp.next,pp.quick=pp,fp&&(typeof fp=="object"&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.tychei=up})(0,rp,!1)}),nr=$n(function(rp){(function(_d,np){var ap,sp=this,lp=256,up=6,cp="random",dp=np.pow(lp,up),hp=np.pow(2,52),fp=2*hp,pp=lp-1;function mp(vp,bp,Ep){var Sp=[],Ap=xp(function Mp(Op,Pp){var $p,zp=[],Dp=typeof Op;if(Pp&&Dp=="object")for($p in Op)try{zp.push(Mp(Op[$p],Pp-1))}catch{}return zp.length?zp:Dp=="string"?Op:Op+"\0"}((bp=bp==1?{entropy:!0}:bp||{}).entropy?[vp,_p(_d)]:vp??function(){try{var Mp;return ap&&(Mp=ap.randomBytes)?Mp=Mp(lp):(Mp=new Uint8Array(lp),(sp.crypto||sp.msCrypto).getRandomValues(Mp)),_p(Mp)}catch{var Op=sp.navigator,Pp=Op&&Op.plugins;return[+new Date,sp,Pp,sp.screen,_p(_d)]}}(),3),Sp),Rp=new gp(Sp),Tp=function(){for(var Mp=Rp.g(up),Op=dp,Pp=0;Mp<hp;)Mp=(Mp+Pp)*lp,Op*=lp,Pp=Rp.g(1);for(;Mp>=fp;)Mp/=2,Op/=2,Pp>>>=1;return(Mp+Pp)/Op};return Tp.int32=function(){return 0|Rp.g(4)},Tp.quick=function(){return Rp.g(4)/4294967296},Tp.double=Tp,xp(_p(Rp.S),_d),(bp.pass||Ep||function(Mp,Op,Pp,$p){return $p&&($p.S&&yp($p,Rp),Mp.state=function(){return yp(Rp,{})}),Pp?(np[cp]=Mp,Op):Mp})(Tp,Ap,"global"in bp?bp.global:this==np,bp.state)}function gp(vp){var bp,Ep=vp.length,Sp=this,Ap=0,Rp=Sp.i=Sp.j=0,Tp=Sp.S=[];for(Ep||(vp=[Ep++]);Ap<lp;)Tp[Ap]=Ap++;for(Ap=0;Ap<lp;Ap++)Tp[Ap]=Tp[Rp=pp&Rp+vp[Ap%Ep]+(bp=Tp[Ap])],Tp[Rp]=bp;(Sp.g=function(Mp){for(var Op,Pp=0,$p=Sp.i,zp=Sp.j,Dp=Sp.S;Mp--;)Op=Dp[$p=pp&$p+1],Pp=Pp*lp+Dp[pp&(Dp[$p]=Dp[zp=pp&zp+Op])+(Dp[zp]=Op)];return Sp.i=$p,Sp.j=zp,Pp})(lp)}function yp(vp,bp){return bp.i=vp.i,bp.j=vp.j,bp.S=vp.S.slice(),bp}function xp(vp,bp){for(var Ep,Sp=vp+"",Ap=0;Ap<Sp.length;)bp[pp&Ap]=pp&(Ep^=19*bp[pp&Ap])+Sp.charCodeAt(Ap++);return _p(bp)}function _p(vp){return String.fromCharCode.apply(0,vp)}if(np["seed"+cp]=mp,xp(np.random(),_d),rp.exports){rp.exports=mp;try{ap=require("crypto")}catch{}}})([],Math)});nr.alea=Yn,nr.xor128=Qn,nr.xorwow=Jn,nr.xorshift7=Zn,nr.xor4096=tr,nr.tychei=er;var rr=nr.alea,or=function(){function rp(_d,np,ap,sp,lp){this.mean=_d,this.stdDev=np,this.dtype=ap,this.nextVal=NaN,this.truncated=sp,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var up=lp||Math.random();this.random=rr(up.toString())}return rp.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var _d=this.nextVal;return this.nextVal=NaN,_d}for(var np,ap,sp=!1;!sp;){var lp=void 0,up=void 0,cp=void 0;do cp=(lp=2*this.random()-1)*lp+(up=2*this.random()-1)*up;while(cp>=1||cp===0);var dp=Math.sqrt(-2*Math.log(cp)/cp);np=this.mean+this.stdDev*lp*dp,ap=this.mean+this.stdDev*up*dp,this.truncated&&!this.isValidTruncated(np)||(sp=!0)}return this.truncated&&!this.isValidTruncated(ap)||(this.nextVal=this.convertValue(ap)),this.convertValue(np)},rp.prototype.convertValue=function(_d){return this.dtype==null||this.dtype==="float32"?_d:Math.round(_d)},rp.prototype.isValidTruncated=function(_d){return _d<=this.upper&&_d>=this.lower},rp}(),ar=function(){function rp(_d,np,ap,sp){this.alpha=_d,this.beta=1/np,this.dtype=ap;var lp=sp||Math.random();this.randu=rr(lp.toString()),this.randn=new or(0,1,ap,!1,this.randu()),this.d=_d<1?_d+2/3:_d-1/3,this.c=1/Math.sqrt(9*this.d)}return rp.prototype.nextValue=function(){for(var _d,np,ap,sp,lp,up;;){do sp=this.randn.nextValue(),up=1+this.c*sp;while(up<=0);if(up*=up*up,np=1-.331*(_d=sp*sp)*_d,ap=.5*_d+this.d*(1-up+Math.log(up)),(lp=this.randu())<np||Math.log(lp)<ap)break}return up=1/this.beta*this.d*up,this.alpha<1&&(up*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(up)},rp.prototype.convertValue=function(_d){return this.dtype==="float32"?_d:Math.round(_d)},rp}(),ir=function(){function rp(_d,np,ap,sp){var lp=this;if(_d===void 0&&(_d=0),np===void 0&&(np=1),this.canReturnFloat=function(){return lp.dtype==null||lp.dtype==="float32"},this.min=_d,this.range=np-_d,this.dtype=ap,sp==null&&(sp=Math.random()),typeof sp=="number"&&(sp=sp.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+_d+" - "+np+" <= 1 and dtype is not float");this.random=rr(sp)}return rp.prototype.convertValue=function(_d){return this.canReturnFloat()?_d:Math.round(_d)},rp.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},rp}();function ur(rp,_d,np){return _d===void 0&&(_d="float32"),_d=_d||"float32",Q(rp),new lt(rp,_d,np)}function sr$1(rp,_d){_d===void 0&&(_d=!1),console.log(rp.toString(_d))}var cr=Cn({batchToSpaceND_:function(rp,_d,np){var ap=ln(rp,"x","batchToSpaceND"),sp=_d.reduce(function(lp,up){return lp*up});return g(ap.rank>=1+_d.length,function(){return"input rank is "+ap.rank+" but should be > than blockShape.length "+_d.length}),g(np.length===_d.length,function(){return"crops.length is "+np.length+" but should be equal to blockShape.length  "+_d.length}),g(ap.shape[0]%sp==0,function(){return"input tensor batch is "+ap.shape[0]+" but is not divisible by the product of the elements of blockShape "+_d.join(" * ")+" === "+sp}),Nt.runKernelFunc(function(lp){return lp.batchToSpaceND(ap,_d,np)},{$x:ap},function(lp){return{$x:function(){return lp.spaceToBatchND(_d,np)}}})}}),lr=Cn({cast_:function(rp,_d){var np=ln(rp,"x","cast");if(!_(_d))throw new Error("Failed to cast to unknown dtype "+_d);if(_d==="string"&&np.dtype!=="string"||_d!=="string"&&np.dtype==="string")throw new Error("Only strings can be casted to strings");var ap={dtype:_d};return Nt.runKernelFunc(function(sp){return sp.cast(np,_d)},{x:np},function(sp){return{x:function(){return sp.clone()}}},"Cast",ap)}}),hr=Cn({clone_:function(rp){var _d=ln(rp,"x","clone",null);return Nt.runKernelFunc(function(){return Nt.makeTensorFromDataId(_d.dataId,_d.shape,_d.dtype)},{$x:_d},function(np){return{$x:function(){return np.toFloat()}}})}}),fr$1=Cn({cumsum_:function(rp,_d,np,ap){_d===void 0&&(_d=0),np===void 0&&(np=!1),ap===void 0&&(ap=!1);var sp=ln(rp,"x","cumsum"),lp=gn([_d|=0],sp.rank),up=sp;lp!=null&&(up=sp.transpose(lp));var cp=xn(1,sp.rank)[0],dp=Nt.runKernelFunc(function(hp){return hp.cumsum(up,cp,np,ap)},{permutedX:up},function(hp){return{permutedX:function(){return hp.cumsum(_d,np,!ap)}}});return lp!=null&&(dp=dp.transpose(lp)),dp}}),pr=Cn({depthToSpace_:function(rp,_d,np){np===void 0&&(np="NHWC");var ap=ln(rp,"x","depthToSpace"),sp=np==="NHWC"?ap.shape[1]:ap.shape[2],lp=np==="NHWC"?ap.shape[2]:ap.shape[3],up=np==="NHWC"?ap.shape[3]:ap.shape[1];return g(sp*_d>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+sp+" and "+_d+`  for depthToSpace with input shape
      `+ap.shape}),g(lp*_d>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+lp+" and "+_d+` for depthToSpace with input shape
          `+ap.shape}),g(up%(_d*_d)==0,function(){return"Dimension size must be evenly divisible by "+_d*_d+" but is "+up+" for depthToSpace with input shape "+ap.shape}),Nt.runKernelFunc(function(cp){return cp.depthToSpace(ap,_d,np)},{$x:ap})}}),dr=Cn({expandDims_:function(rp,_d){_d===void 0&&(_d=0);var np=ln(rp,"x","expandDims",null);g(_d<=np.rank,function(){return"Axis must be <= rank of the tensor"});var ap=np.shape.slice();return _d<0&&(g(-(np.rank+1)<=_d,function(){return"Axis must be in the interval ["+-(np.rank+1)+", "+np.rank+"]"}),_d=np.rank+_d+1),ap.splice(_d,0,1),Sr(np,ap)}}),vr=Cn({eye_:function(rp,_d,np,ap){ap===void 0&&(ap="float32"),_d==null&&(_d=rp);for(var sp=ur([rp,_d],ap),lp=rp<=_d?rp:_d,up=0;up<lp;++up)sp.set(1,up,up);var cp=sp.toTensor().as2D(rp,_d);if(np==null)return cp;if(np.length===1)return Nr(dr(cp,0),[np[0],1,1]);if(np.length===2)return Nr(dr(dr(cp,0),0),[np[0],np[1],1,1]);if(np.length===3)return Nr(dr(dr(dr(cp,0),0),0),[np[0],np[1],np[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+np.length+"D.")}}),mr=Cn({multinomial_:function(rp,_d,np,ap){ap===void 0&&(ap=!1);var sp=ln(rp,"logits","multinomial"),lp=sp.size,up=sp.rank;if(lp<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+lp+".");if(up>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+up);np=np||Math.random();var cp=up===1?sp.as2D(1,-1):sp,dp=Nt.runKernelFunc(function(hp){return hp.multinomial(cp,ap,_d,np)},{logits2D:cp});return up===1?dp.as1D():dp}}),gr=Cn({oneHot_:function(rp,_d,np,ap){if(np===void 0&&(np=1),ap===void 0&&(ap=0),_d<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+_d);var sp=ln(rp,"indices","oneHot","int32"),lp=sp.shape.concat([_d]);return sp=sp.flatten(),Nt.runKernelFunc(function(up){return up.oneHot(sp,_d,np,ap)},{$indices:sp},function(up){return{$indices:function(){return Pn(sp.shape,"float32")}}}).reshape(lp)}}),yr=Cn({pad_:function(rp,_d,np){np===void 0&&(np=0);var ap=ln(rp,"x","pad");if(ap.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var sp=_d.map(function(lp){return lp[0]});return Nt.runKernelFunc(function(lp){return lp.pad(ap,_d,np)},{$x:ap},function(lp){return{$x:function(){return lp.slice(sp,ap.shape)}}})}}),xr=Cn({pad1d_:function(rp,_d,np){return np===void 0&&(np=0),g(_d.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),yr(rp,[_d],np)}}),br=Cn({pad2d_:function(rp,_d,np){return np===void 0&&(np=0),g(_d.length===2&&_d[0].length===2&&_d[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),yr(rp,_d,np)}}),wr=Cn({pad3d_:function(rp,_d,np){return np===void 0&&(np=0),g(_d.length===3&&_d[0].length===2&&_d[1].length===2&&_d[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),yr(rp,_d,np)}}),Cr=Cn({pad4d_:function(rp,_d,np){return np===void 0&&(np=0),g(_d.length===4&&_d[0].length===2&&_d[1].length===2&&_d[2].length===2&&_d[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),yr(rp,_d,np)}}),Er=Cn({rand_:function(rp,_d,np){var ap=w$1(rp),sp=null;if(np==null||np==="float32")sp=new Float32Array(ap);else if(np==="int32")sp=new Int32Array(ap);else{if(np!=="bool")throw new Error("Unknown data type "+np);sp=new Uint8Array(ap)}for(var lp=0;lp<ap;lp++)sp[lp]=_d();return Nt.makeTensor(sp,rp,np)}}),Rr=Cn({randomNormal_:function(rp,_d,np,ap,sp){if(_d===void 0&&(_d=0),np===void 0&&(np=1),ap!=null&&ap==="bool")throw new Error("Unsupported data type "+ap);for(var lp=new or(_d,np,ap,!1,sp),up=ur(rp,ap),cp=0;cp<up.values.length;cp++)up.values[cp]=lp.nextValue();return up.toTensor()}}),Ir=Cn({randomGamma_:function(rp,_d,np,ap,sp){if(np===void 0&&(np=1),ap===void 0&&(ap="float32"),np==null&&(np=1),ap==null&&(ap="float32"),ap!=="float32"&&ap!=="int32")throw new Error("Unsupported data type "+ap);for(var lp=new ar(_d,np,ap,sp),up=ur(rp,ap),cp=0;cp<up.values.length;cp++)up.values[cp]=lp.nextValue();return up.toTensor()}}),kr=Cn({randomUniform_:function(rp,_d,np,ap,sp){_d===void 0&&(_d=0),np===void 0&&(np=1),ap===void 0&&(ap="float32");for(var lp=ur(rp,ap),up=new ir(_d,np,null,sp),cp=0;cp<lp.values.length;cp++)lp.values[cp]=up.nextValue();return lp.toTensor()}}),Sr=Cn({reshape_:function(rp,_d){var np=ln(rp,"x","reshape",null);_d=A(_d,np.size),g(np.size===w$1(_d),function(){return"new shape and old shape must have the same number of elements."});var ap={shape:_d};return Nt.runKernelFunc(function(sp){return sp.reshape(np,_d)},{x:np},function(sp){return{x:function(){return sp.reshape(np.shape)}}},"Reshape",ap)}}),Ar=Cn({spaceToBatchND_:function(rp,_d,np){var ap=ln(rp,"x","spaceToBatchND");return g(ap.rank>=1+_d.length,function(){return"input rank "+ap.rank+" should be > than [blockShape] "+_d.length}),g(np.length===_d.length,function(){return"paddings.shape[0] "+np.length+" must be equal to [blockShape] "+_d.length}),g(ap.shape.reduce(function(sp,lp,up){return up>0&&up<=_d.length?sp&&(lp+np[up-1][0]+np[up-1][1])%_d[up-1]==0:sp},!0),function(){return"input spatial dimensions "+ap.shape.slice(1)+" with paddings "+np.toString()+" must be divisible by blockShapes "+_d.toString()}),Nt.runKernelFunc(function(sp){return sp.spaceToBatchND(ap,_d,np)},{$x:ap},function(sp){return{$x:function(){return sp.batchToSpaceND(_d,np)}}})}}),Dr=Cn({squeeze_:function(rp,_d){var np=ln(rp,"x","squeeze");return Sr(np,T(np.shape,_d).newShape)}}),Tr=Cn({stack_:function(rp,_d){_d===void 0&&(_d=0);var np=hn(rp,"tensors","stack");if(g(np.length>=1,function(){return"Pass at least one tensor to tf.stack"}),np.length===1)return np[0].expandDims(_d);var ap=np[0].rank,sp=np[0].shape,lp=np[0].dtype;g(_d<=ap,function(){return"Axis must be <= rank of the tensor"}),np.forEach(function(cp){y(sp,cp.shape,"All tensors passed to stack must have matching shapes")}),np.forEach(function(cp){g(lp===cp.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var up=np.map(function(cp){return cp.expandDims(_d)});return Gn(up,_d)}}),Nr=Cn({tile_:function(rp,_d){var np=ln(rp,"x","tile",null);return g(np.rank===_d.length,function(){return"Error in transpose: rank of input "+np.rank+" must match length of reps "+_d+"."}),Nt.runKernelFunc(function(ap,sp){var lp=ap.tile(np,_d);return sp([np]),lp},{$x:np},function(ap,sp){var lp=sp[0];return{$x:function(){var up=zn(lp);if(lp.rank===1)for(var cp=0;cp<_d[0];++cp)up=up.add(ap.slice([cp*lp.shape[0]],[lp.shape[0]]));else if(lp.rank===2)for(cp=0;cp<_d[0];++cp)for(var dp=0;dp<_d[1];++dp)up=up.add(ap.slice([cp*lp.shape[0],dp*lp.shape[1]],[lp.shape[0],lp.shape[1]]));else if(lp.rank===3)for(cp=0;cp<_d[0];++cp)for(dp=0;dp<_d[1];++dp)for(var hp=0;hp<_d[2];++hp)up=up.add(ap.slice([cp*lp.shape[0],dp*lp.shape[1],hp*lp.shape[2]],[lp.shape[0],lp.shape[1],lp.shape[2]]));else{if(lp.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+lp.rank+" tensors yet.");for(cp=0;cp<_d[0];++cp)for(dp=0;dp<_d[1];++dp)for(hp=0;hp<_d[2];++hp)for(var fp=0;fp<_d[3];++fp)up=up.add(ap.slice([cp*lp.shape[0],dp*lp.shape[1],hp*lp.shape[2],fp*lp.shape[3]],[lp.shape[0],lp.shape[1],lp.shape[2],lp.shape[3]]))}return up}}})}}),Fr=Cn({truncatedNormal_:function(rp,_d,np,ap,sp){if(_d===void 0&&(_d=0),np===void 0&&(np=1),ap!=null&&ap==="bool")throw new Error("Unsupported data type "+ap);for(var lp=new or(_d,np,ap,!0,sp),up=ur(rp,ap),cp=0;cp<up.values.length;cp++)up.values[cp]=lp.nextValue();return up.toTensor()}}),Or=Cn({unstack_:function(rp,_d){_d===void 0&&(_d=0),_d=_d||0;var np=ln(rp,"x","unstack");return g(_d>=-np.shape.length&&_d<np.shape.length,function(){return"Axis = "+_d+" is not in [-"+np.shape.length+", "+np.shape.length+")"}),_d<0&&(_d+=np.shape.length),Nt.runKernelFunc(function(ap){return ap.unstack(np,_d)},{$x:np},function(ap){return{$x:function(){return Tr(ap,_d)}}})}}),_r=function(rp,_d){return n$1(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp,hp,fp,pp;return r(this,function(mp){switch(mp.label){case 0:return np=ln(rp,"x","setdiff1d"),ap=ln(_d,"y","setdiff1d"),g(np.dtype===ap.dtype,function(){return"x and y should have the same dtype, but got x ("+np.dtype+") and y ("+ap.dtype+")."}),g(np.rank===1,function(){return"x should be 1D tensor, but got x ("+np.shape+")."}),g(ap.rank===1,function(){return"y should be 1D tensor, but got y ("+ap.shape+")."}),[4,np.data()];case 1:return sp=mp.sent(),[4,ap.data()];case 2:for(lp=mp.sent(),up=new Set(lp),cp=0,fp=0;fp<sp.length;fp++)up.has(sp[fp])||cp++;for(dp=new lt([cp],np.dtype),hp=new lt([cp],"int32"),fp=0,pp=0;fp<sp.length;fp++)up.has(sp[fp])||(dp.values[pp]=sp[fp],hp.values[pp]=fp,pp++);return[2,[dp.toTensor(),hp.toTensor()]]}})})};function Mr(rp,_d,np,ap){ap===void 0&&(ap=!0);var sp=[];if(ap)(sp=sp.concat(_d.slice(0))).push(rp[0]/np),sp=sp.concat(rp.slice(1));else{sp=sp.concat(rp[0]);for(var lp=_d.length,up=0;up<lp;++up)sp=sp.concat([rp[up+1]/_d[up],_d[up]]);sp=sp.concat(rp.slice(lp+1))}return sp}function Br(rp,_d,np){np===void 0&&(np=!0);var ap=[];if(np){ap.push(_d);for(var sp=_d+1;sp<rp;++sp)sp<=2*_d?(ap.push(sp),ap.push(sp-(_d+1))):ap.push(sp)}else{var lp=[],up=[];for(sp=1;sp<rp;++sp)sp>=2*_d+1||sp%2==1?up.push(sp):lp.push(sp);ap.push.apply(ap,lp),ap.push(0),ap.push.apply(ap,up)}return ap}function Pr(rp,_d,np,ap){ap===void 0&&(ap=!0);var sp=[];ap?sp.push(rp[0]/np):sp.push(rp[0]*np);for(var lp=1;lp<rp.length;++lp)lp<=_d.length?ap?sp.push(_d[lp-1]*rp[lp]):sp.push(rp[lp]/_d[lp-1]):sp.push(rp[lp]);return sp}function Lr(rp,_d){for(var np=[0],ap=0;ap<_d;++ap)np.push(rp[ap][0]);return np}function Wr(rp,_d,np){for(var ap=rp.slice(0,1),sp=0;sp<np;++sp)ap.push(rp[sp+1]-_d[sp][0]-_d[sp][1]);return ap}function Ur(rp,_d){if(rp.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+rp.rank+".");if(_d.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+_d.rank+".");if(_d.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+_d.dtype+".");if(_d.shape[_d.rank-1]>rp.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+_d.shape[_d.rank-1]+" vs. "+rp.rank);if(rp.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+rp.shape+".");for(var np=_d.shape,ap=np[np.length-1],sp=1,lp=0;lp<np.length-1;++lp)sp*=np[lp];var up=rp.shape,cp=np.slice();cp.pop();var dp=1;for(lp=ap;lp<rp.rank;++lp)dp*=up[lp],cp.push(up[lp]);var hp=q(rp.shape).map(function(fp){return fp/dp}).concat([1]).slice(0,ap);return[cp,sp,dp,hp]}var Vr=30;function zr(rp){return rp<=Vr?rp:H(rp,Math.floor(Math.sqrt(rp)))}function Gr(rp,_d,np){if(_d.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+_d.rank+".");if(rp.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+rp.rank+".");if(_d.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+_d.dtype);if(np.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+np);if(np.length===0){if(_d.size===0)throw new Error("Indices specified for empty output. indices shape: "+_d.shape);if(rp.size===0)throw new Error("Updates specified for empty output. updates shape: "+rp.shape)}(function(ap,sp,lp){var up=sp.rank>1?sp.shape[sp.rank-1]:1,cp=sp.rank>1?sp.rank-1:1,dp="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+lp.shape+", indices.shape: "+sp.shape+", shape: "+ap+", sliceDim: "+up+", and batchDim: "+cp+".";if(lp.rank<cp)throw new Error(dp+" update.rank < "+cp+". ");if(ap.length<up+(lp.rank-cp))throw new Error(dp+" Output shape length < "+(up+(lp.rank-cp)));if(lp.rank!==cp+ap.length-up)throw new Error(dp+" update.rank != "+(cp+ap.length-up));for(var hp=0;hp<cp;++hp)if(lp.shape[hp]!==sp.shape[hp])throw new Error(dp+" updates.shape["+hp+"] ("+lp.shape[hp]+") != indices.shape["+hp+"] ("+sp.shape[hp]+").");for(hp=0;hp<lp.rank-cp;++hp)if(lp.shape[hp+cp]!==ap[hp+up])throw new Error(dp+" updates.shape["+(hp+cp)+"] ("+lp.shape[hp+cp]+") != shape["+(hp+cp)+"] ("+ap[hp+cp]+")")})(np,_d,rp)}function Hr(rp,_d,np){for(var ap=_d.rank>1?_d.shape[_d.rank-1]:1,sp=np.length,lp=1,up=ap;up<sp;++up)lp*=np[up];var cp=ap<1?1:ap;return{sliceRank:ap,numUpdates:_d.size/cp,sliceSize:lp,strides:q(np.slice(0,ap)).concat([1]),outputSize:w$1(np)}}function qr(rp,_d,np){g(rp.rank===_d.length,function(){return"Error in slice"+rp.rank+"D: Length of begin "+_d+" must match the rank of the array ("+rp.rank+")."}),g(rp.rank===np.length,function(){return"Error in slice"+rp.rank+"D: Length of size "+np+" must match the rank of the array ("+rp.rank+")."});for(var ap=function(lp){g(_d[lp]+np[lp]<=rp.shape[lp],function(){return"Error in slice"+rp.rank+"D: begin["+lp+"] + size["+lp+"] ("+(_d[lp]+np[lp])+") would overflow input.shape["+lp+"] ("+rp.shape[lp]+")"})},sp=0;sp<rp.rank;++sp)ap(sp)}function Kr(rp){for(var _d=[],np=0;rp>0;)1&rp&&_d.push(np),rp/=2,np++;return _d}function jr(rp,_d,np){for(var ap=[],sp=0;sp<rp.length;sp++)ap[sp]=Math.ceil((_d[sp]-rp[sp])/np[sp]);return ap}function Xr(rp,_d,np,ap,sp){var lp=_d[sp],up=np[sp]||1;(rp&1<<sp||lp==null)&&(lp=up>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var cp=ap[sp];return lp<0&&(lp+=cp),lp=d(0,lp,cp-1)}function $r(rp,_d,np,ap,sp){var lp=_d[sp],up=np[sp]||1;(rp&1<<sp||lp==null)&&(lp=up>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var cp=ap[sp];return lp<0&&(lp+=cp),lp=up>0?d(0,lp,cp):d(-1,lp,cp-1)}function Yr(rp,_d,np){for(var ap=np.length,sp=0;sp<np.length;sp++)if(np[sp]>1){ap=sp;break}for(sp=ap+1;sp<np.length;sp++)if(_d[sp]>0||np[sp]!==rp[sp])return!1;return!0}function Qr(rp,_d){for(var np=rp.length>0?rp[rp.length-1]:1,ap=0;ap<rp.length-1;ap++)np+=rp[ap]*_d[ap];return np}var Jr=Object.freeze({assertParamsValid:qr,maskToAxes:Kr,computeOutShape:jr,startForAxis:Xr,stopForAxis:$r,isSliceContinous:Yr,computeFlatOffset:Qr});function Zr(rp){return g(G(rp),function(){return"The f passed in grad(f) must be a function"}),function(_d,np){var ap=ln(_d,"x","tf.grad",null),sp=np!=null?ln(np,"dy","tf.grad"):null;return Nt.tidy(function(){var lp=Nt.gradients(function(){return rp(ap)},[ap],sp),up=lp.value,cp=lp.grads;return sp!=null&&y(up.shape,sp.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),ao(cp),cp[0]})}}function to(rp){return g(G(rp),function(){return"The f passed in grads(f) must be a function"}),function(_d,np){g(Array.isArray(_d),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var ap=hn(_d,"args","tf.grads",null),sp=np!=null?ln(np,"dy","tf.grads"):null;return Nt.tidy(function(){var lp=Nt.gradients(function(){return rp.apply(void 0,ap)},ap,sp),up=lp.value,cp=lp.grads;return sp!=null&&y(up.shape,sp.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ao(cp),cp})}}function eo(rp){return g(G(rp),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(_d,np){g(_d instanceof dt,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),g(np==null||np instanceof dt,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var ap=Nt.gradients(function(){return rp(_d)},[_d],np),sp=ap.grads,lp=ap.value;return ao(sp),{grad:sp[0],value:lp}}}function no(rp){return g(G(rp),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(_d,np){g(Array.isArray(_d)&&_d.every(function(sp){return sp instanceof dt}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),g(np==null||np instanceof dt,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var ap=Nt.gradients(function(){return rp.apply(void 0,_d)},_d,np);return np!=null&&y(ap.value.shape,np.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ao(ap.grads),ap}}function ro(rp,_d){g(G(rp),function(){return"The f passed in variableGrads(f) must be a function"}),g(_d==null||Array.isArray(_d)&&_d.every(function(fp){return fp instanceof bt}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var np=_d!=null;if(!np)for(var ap in _d=[],Nt.registeredVariables)_d.push(Nt.registeredVariables[ap]);var sp=np?_d.filter(function(fp){return!fp.trainable}):null,lp=_d.length;g((_d=_d.filter(function(fp){return fp.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+lp+" variables is trainable."});var up=Nt.gradients(rp,_d,null,!0),cp=up.value,dp=up.grads;g(dp.some(function(fp){return fp!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),g(cp.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+cp.rank+" tensor"});var hp={};return _d.forEach(function(fp,pp){dp[pp]!=null&&(hp[fp.name]=dp[pp])}),sp!=null&&sp.forEach(function(fp){return hp[fp.name]=null}),{value:cp,grads:hp}}function oo(rp){return Nt.customGrad(rp)}function ao(rp){if(rp.filter(function(_d){return _d==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var io=Cn({softmax_:function(rp,_d){_d===void 0&&(_d=-1);var np=ln(rp,"logits","softmax");if(_d===-1&&(_d=np.rank-1),_d!==np.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+np.rank+" and dim was "+_d);return oo(function(ap,sp){var lp=ap.logSumExp([_d],!0),up=ap.toFloat().sub(lp).exp();return sp([up]),{value:up,gradFunc:function(cp,dp){var hp=dp[0],fp=cp.mul(hp);return fp.sub(fp.sum([_d],!0).mul(hp))}}})(np)}}),uo=Cn({logSoftmax_:function(rp,_d){_d===void 0&&(_d=-1);var np=ln(rp,"logits","logSoftmax");if(_d===-1&&(_d=np.rank-1),_d!==np.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+np.rank+" and axis was "+_d);return oo(function(ap,sp){var lp=ap.max(_d,!0),up=ap.sub(lp),cp=up.toFloat().sub(up.exp().sum(_d,!0).log());return sp([cp]),{value:cp,gradFunc:function(dp,hp){var fp=hp[0].exp();return dp.sub(dp.sum(_d,!0).mul(fp))}}})(np)}}),so=function(){function rp(_d,np){this.backend=_d,this.dataMover=np,this.data=new WeakMap,this.dataIdsCount=0}return rp.prototype.get=function(_d){return this.data.has(_d)||this.dataMover.moveData(this.backend,_d),this.data.get(_d)},rp.prototype.set=function(_d,np){this.dataIdsCount++,this.data.set(_d,np)},rp.prototype.has=function(_d){return this.data.has(_d)},rp.prototype.delete=function(_d){return this.dataIdsCount--,this.data.delete(_d)},rp.prototype.numDataIds=function(){return this.dataIdsCount},rp}(),co=function(){function rp(){}return rp.prototype.time=function(_d){return lo()},rp.prototype.read=function(_d){return lo()},rp.prototype.readSync=function(_d){return lo()},rp.prototype.numDataIds=function(){return lo()},rp.prototype.disposeData=function(_d){return lo()},rp.prototype.fromPixels=function(_d,np){return lo()},rp.prototype.write=function(_d,np,ap){return lo()},rp.prototype.move=function(_d,np,ap,sp){return lo()},rp.prototype.memory=function(){return lo()},rp.prototype.floatPrecision=function(){return lo()},rp.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},rp.prototype.batchMatMul=function(_d,np,ap,sp){return lo()},rp.prototype.fusedBatchMatMul=function(_d){return _d.a,_d.b,_d.transposeA,_d.transposeB,_d.bias,_d.activation,_d.preluActivationWeights,lo()},rp.prototype.slice=function(_d,np,ap){return lo()},rp.prototype.stridedSlice=function(_d,np,ap,sp){return lo()},rp.prototype.unstack=function(_d,np){return lo()},rp.prototype.reverse=function(_d,np){return lo()},rp.prototype.concat=function(_d,np){return lo()},rp.prototype.neg=function(_d){return lo()},rp.prototype.add=function(_d,np){return lo()},rp.prototype.addN=function(_d){return lo()},rp.prototype.subtract=function(_d,np){return lo()},rp.prototype.multiply=function(_d,np){return lo()},rp.prototype.realDivide=function(_d,np){return lo()},rp.prototype.floorDiv=function(_d,np){return lo()},rp.prototype.sum=function(_d,np){return lo()},rp.prototype.prod=function(_d,np){return lo()},rp.prototype.unsortedSegmentSum=function(_d,np,ap){return lo()},rp.prototype.argMin=function(_d,np){return lo()},rp.prototype.argMax=function(_d,np){return lo()},rp.prototype.equal=function(_d,np){return lo()},rp.prototype.notEqual=function(_d,np){return lo()},rp.prototype.less=function(_d,np){return lo()},rp.prototype.lessEqual=function(_d,np){return lo()},rp.prototype.greater=function(_d,np){return lo()},rp.prototype.greaterEqual=function(_d,np){return lo()},rp.prototype.logicalNot=function(_d){return lo()},rp.prototype.logicalAnd=function(_d,np){return lo()},rp.prototype.logicalOr=function(_d,np){return lo()},rp.prototype.where=function(_d){return lo()},rp.prototype.select=function(_d,np,ap){return lo()},rp.prototype.topk=function(_d,np,ap){return lo()},rp.prototype.min=function(_d,np){return lo()},rp.prototype.minimum=function(_d,np){return lo()},rp.prototype.mod=function(_d,np){return lo()},rp.prototype.max=function(_d,np){return lo()},rp.prototype.maximum=function(_d,np){return lo()},rp.prototype.all=function(_d,np){return lo()},rp.prototype.any=function(_d,np){return lo()},rp.prototype.squaredDifference=function(_d,np){return lo()},rp.prototype.ceil=function(_d){return lo()},rp.prototype.floor=function(_d){return lo()},rp.prototype.round=function(_d){return lo()},rp.prototype.sign=function(_d){return lo()},rp.prototype.isNaN=function(_d){return lo()},rp.prototype.isInf=function(_d){return lo()},rp.prototype.isFinite=function(_d){return lo()},rp.prototype.pow=function(_d,np){return lo()},rp.prototype.exp=function(_d){return lo()},rp.prototype.expm1=function(_d){return lo()},rp.prototype.log=function(_d){return lo()},rp.prototype.log1p=function(_d){return lo()},rp.prototype.sqrt=function(_d){return lo()},rp.prototype.rsqrt=function(_d){return lo()},rp.prototype.square=function(_d){return lo()},rp.prototype.reciprocal=function(_d){return lo()},rp.prototype.relu=function(_d){return lo()},rp.prototype.relu6=function(_d){return lo()},rp.prototype.prelu=function(_d,np){return lo()},rp.prototype.elu=function(_d){return lo()},rp.prototype.eluDer=function(_d,np){return lo()},rp.prototype.selu=function(_d){return lo()},rp.prototype.int=function(_d){return lo()},rp.prototype.clip=function(_d,np,ap){return lo()},rp.prototype.abs=function(_d){return lo()},rp.prototype.complexAbs=function(_d){return lo()},rp.prototype.sigmoid=function(_d){return lo()},rp.prototype.softplus=function(_d){return lo()},rp.prototype.sin=function(_d){return lo()},rp.prototype.cos=function(_d){return lo()},rp.prototype.tan=function(_d){return lo()},rp.prototype.asin=function(_d){return lo()},rp.prototype.acos=function(_d){return lo()},rp.prototype.atan=function(_d){return lo()},rp.prototype.atan2=function(_d,np){return lo()},rp.prototype.sinh=function(_d){return lo()},rp.prototype.cosh=function(_d){return lo()},rp.prototype.tanh=function(_d){return lo()},rp.prototype.asinh=function(_d){return lo()},rp.prototype.acosh=function(_d){return lo()},rp.prototype.atanh=function(_d){return lo()},rp.prototype.erf=function(_d){return lo()},rp.prototype.step=function(_d,np){return lo()},rp.prototype.fusedConv2d=function(_d){return _d.input,_d.filter,_d.convInfo,_d.bias,_d.activation,_d.preluActivationWeights,lo()},rp.prototype.conv2d=function(_d,np,ap){return lo()},rp.prototype.conv2dDerInput=function(_d,np,ap){return lo()},rp.prototype.conv2dDerFilter=function(_d,np,ap){return lo()},rp.prototype.fusedDepthwiseConv2D=function(_d){return _d.input,_d.filter,_d.convInfo,_d.bias,_d.activation,_d.preluActivationWeights,lo()},rp.prototype.depthwiseConv2D=function(_d,np,ap){return lo()},rp.prototype.depthwiseConv2DDerInput=function(_d,np,ap){return lo()},rp.prototype.depthwiseConv2DDerFilter=function(_d,np,ap){return lo()},rp.prototype.conv3d=function(_d,np,ap){return lo()},rp.prototype.conv3dDerInput=function(_d,np,ap){return lo()},rp.prototype.conv3dDerFilter=function(_d,np,ap){return lo()},rp.prototype.maxPool=function(_d,np){return lo()},rp.prototype.maxPoolBackprop=function(_d,np,ap,sp){return lo()},rp.prototype.avgPool=function(_d,np){return lo()},rp.prototype.avgPoolBackprop=function(_d,np,ap){return lo()},rp.prototype.avgPool3d=function(_d,np){return lo()},rp.prototype.avgPool3dBackprop=function(_d,np,ap){return lo()},rp.prototype.maxPool3d=function(_d,np){return lo()},rp.prototype.maxPool3dBackprop=function(_d,np,ap,sp){return lo()},rp.prototype.reshape=function(_d,np){return lo()},rp.prototype.cast=function(_d,np){return lo()},rp.prototype.tile=function(_d,np){return lo()},rp.prototype.pad=function(_d,np,ap){return lo()},rp.prototype.transpose=function(_d,np){return lo()},rp.prototype.gather=function(_d,np,ap){return lo()},rp.prototype.gatherND=function(_d,np){return lo()},rp.prototype.scatterND=function(_d,np,ap){return lo()},rp.prototype.batchToSpaceND=function(_d,np,ap){return lo()},rp.prototype.spaceToBatchND=function(_d,np,ap){return lo()},rp.prototype.resizeBilinear=function(_d,np,ap,sp){return lo()},rp.prototype.resizeBilinearBackprop=function(_d,np,ap){return lo()},rp.prototype.resizeNearestNeighbor=function(_d,np,ap,sp){return lo()},rp.prototype.resizeNearestNeighborBackprop=function(_d,np,ap){return lo()},rp.prototype.batchNormalization=function(_d,np,ap,sp,lp,up){return lo()},rp.prototype.localResponseNormalization4D=function(_d,np,ap,sp,lp){return lo()},rp.prototype.LRNGrad=function(_d,np,ap,sp,lp,up,cp){return lo()},rp.prototype.multinomial=function(_d,np,ap,sp){return lo()},rp.prototype.oneHot=function(_d,np,ap,sp){return lo()},rp.prototype.cumsum=function(_d,np,ap,sp){return lo()},rp.prototype.nonMaxSuppression=function(_d,np,ap,sp,lp){return lo()},rp.prototype.fft=function(_d){return lo()},rp.prototype.ifft=function(_d){return lo()},rp.prototype.complex=function(_d,np){return lo()},rp.prototype.real=function(_d){return lo()},rp.prototype.imag=function(_d){return lo()},rp.prototype.cropAndResize=function(_d,np,ap,sp,lp,up){return lo()},rp.prototype.depthToSpace=function(_d,np,ap){return lo()},rp.prototype.split=function(_d,np,ap){return lo()},rp.prototype.sparseToDense=function(_d,np,ap,sp){return lo()},rp.prototype.diag=function(_d){return lo()},rp.prototype.fill=function(_d,np,ap){throw new Error("Not yet implemented.")},rp.prototype.onesLike=function(_d){return lo()},rp.prototype.zerosLike=function(_d){return lo()},rp.prototype.linspace=function(_d,np,ap){return lo()},rp.prototype.dispose=function(){return lo()},rp}();function lo(){throw new Error("Not yet implemented or not found in the registry. Did you forget to import the kernel?")}function ho(rp,_d){for(var np=rp.length,ap=[],sp=0;sp<np;sp++){var lp=np-1-sp,up=rp[lp]||1;(_d[_d.length-1-sp]||1)>1&&up===1&&ap.unshift(lp)}return ap}function fo(rp,_d){for(var np=[],ap=0;ap<_d.length;ap++){var sp=rp[rp.length-ap-1],lp=_d.length-ap-1,up=_d[lp];(sp==null||sp===1&&up>1)&&np.unshift(lp)}return np}function po(rp,_d){for(var np=[],ap=Math.max(rp.length,_d.length),sp=0;sp<ap;sp++){var lp=rp[rp.length-sp-1];lp==null&&(lp=1);var up=_d[_d.length-sp-1];if(up==null&&(up=1),lp===1)np.unshift(up);else if(up===1)np.unshift(lp);else{if(lp!==up)throw Error("Operands could not be broadcast together with shapes "+rp+" and "+_d+".");np.unshift(lp)}}return np}function vo(rp,_d,np,ap,sp,lp,up){up===void 0&&(up="channelsLast");var cp,dp=bo(_d),hp=dp[0],fp=dp[1];if(up==="channelsLast")cp=[hp,fp,rp[3],rp[3]];else{if(up!=="channelsFirst")throw new Error("Unknown dataFormat "+up);cp=[hp,fp,rp[1],rp[1]]}return go(rp,cp,np,ap,sp,lp,!1,up)}function mo(rp,_d,np,ap,sp,lp,up){up===void 0&&(up="NDHWC");var cp,dp,hp=wo(_d),fp=hp[0],pp=hp[1],mp=hp[2];if(up==="NDHWC")dp="channelsLast",cp=[fp,pp,mp,rp[4],rp[4]];else{if(up!=="NCDHW")throw new Error("Unknown dataFormat "+up);dp="channelsFirst",cp=[fp,pp,mp,rp[1],rp[1]]}return yo(rp,cp,np,ap,sp,!1,dp,lp)}function go(rp,_d,np,ap,sp,lp,up,cp){up===void 0&&(up=!1),cp===void 0&&(cp="channelsLast");var dp=[-1,-1,-1,-1],hp=dp[0],fp=dp[1],pp=dp[2],mp=dp[3];if(cp==="channelsLast")hp=rp[0],fp=rp[1],pp=rp[2],mp=rp[3];else{if(cp!=="channelsFirst")throw new Error("Unknown dataFormat "+cp);hp=rp[0],mp=rp[1],fp=rp[2],pp=rp[3]}var gp,yp=_d[0],xp=_d[1],_p=_d[3],vp=bo(np),bp=vp[0],Ep=vp[1],Sp=bo(ap),Ap=Sp[0],Rp=Sp[1],Tp=Co(yp,Ap),Mp=Co(xp,Rp),Op=function(Fp,jp,Lp,Bp,Ip,kp,Up,Gp){var Wp,Qp,Xp;if(typeof Fp=="number"){var rm=Fp===0?"VALID":"NUMBER";Wp={top:Fp,bottom:Fp,left:Fp,right:Fp,type:rm};var Kp=function(sm,Zp,mm,fm,_m){fm==null&&(fm=xo(sm,Zp,mm));var zm=sm[0],tm=sm[1],Jp=Eo((zm-Zp+2*fm)/mm+1,_m);g(E(Jp),function(){return"The output # of rows ("+Jp+") must be an integer. Change the stride and/or zero pad parameters"});var pm=Eo((tm-Zp+2*fm)/mm+1,_m);return g(E(pm),function(){return"The output # of columns ("+pm+") must be an integer. Change the stride and/or zero pad parameters"}),[Jp,pm]}([jp,Lp],kp,Bp,Fp,Gp);Qp=Kp[0],Xp=Kp[1]}else if(Fp==="same"){Qp=Math.ceil(jp/Bp),Xp=Math.ceil(Lp/Ip);var lm=Math.max(0,(Qp-1)*Bp+kp-jp),cm=Math.max(0,(Xp-1)*Ip+Up-Lp),gm=Math.floor(lm/2),Mm=lm-gm,dm=Math.floor(cm/2),em=cm-dm;Wp={top:gm,bottom:Mm,left:dm,right:em,type:"SAME"}}else{if(Fp!=="valid")throw Error("Unknown padding parameter: "+Fp);Wp={top:0,bottom:0,left:0,right:0,type:"VALID"},Qp=Math.ceil((jp-kp+1)/Bp),Xp=Math.ceil((Lp-Up+1)/Ip)}return{padInfo:Wp,outHeight:Qp,outWidth:Xp}}(sp,fp,pp,bp,Ep,Tp,Mp,lp),Pp=Op.padInfo,$p=Op.outHeight,zp=Op.outWidth,Dp=up?_p*mp:_p;return cp==="channelsFirst"?gp=[hp,Dp,$p,zp]:cp==="channelsLast"&&(gp=[hp,$p,zp,Dp]),{batchSize:hp,dataFormat:cp,inHeight:fp,inWidth:pp,inChannels:mp,outHeight:$p,outWidth:zp,outChannels:Dp,padInfo:Pp,strideHeight:bp,strideWidth:Ep,filterHeight:yp,filterWidth:xp,effectiveFilterHeight:Tp,effectiveFilterWidth:Mp,dilationHeight:Ap,dilationWidth:Rp,inShape:rp,outShape:gp,filterShape:_d}}function yo(rp,_d,np,ap,sp,lp,up,cp){lp===void 0&&(lp=!1),up===void 0&&(up="channelsLast");var dp=[-1,-1,-1,-1,-1],hp=dp[0],fp=dp[1],pp=dp[2],mp=dp[3],gp=dp[4];if(up==="channelsLast")hp=rp[0],fp=rp[1],pp=rp[2],mp=rp[3],gp=rp[4];else{if(up!=="channelsFirst")throw new Error("Unknown dataFormat "+up);hp=rp[0],gp=rp[1],fp=rp[2],pp=rp[3],mp=rp[4]}var yp,xp=_d[0],_p=_d[1],vp=_d[2],bp=_d[4],Ep=wo(np),Sp=Ep[0],Ap=Ep[1],Rp=Ep[2],Tp=wo(ap),Mp=Tp[0],Op=Tp[1],Pp=Tp[2],$p=Co(xp,Mp),zp=Co(_p,Op),Dp=Co(vp,Pp),Fp=function(Up,Gp,Wp,Qp,Xp,rm,Kp,lm,cm,gm,Mm){var dm,em,sm,Zp;if(typeof Up=="number"){var mm=Up===0?"VALID":"NUMBER";dm={top:Up,bottom:Up,left:Up,right:Up,front:Up,back:Up,type:mm};var fm=function(Pm,Im,Dm,jm,Fm,av){Fm==null&&(Fm=xo(Pm,Im,jm));var lv=Pm[0],tv=Pm[1],Jm=Pm[2],um=Eo((lv-Im+2*Fm)/jm+1,av);g(E(um),function(){return"The output # of depths ("+um+") must be an integer. Change the stride and/or zero pad parameters"});var Yp=Eo((tv-Im+2*Fm)/jm+1,av);g(E(Yp),function(){return"The output # of rows ("+Yp+") must be an integer. Change the stride and/or zero pad parameters"});var hm=Eo((Jm-Im+2*Fm)/jm+1,av);return g(E(hm),function(){return"The output # of columns ("+hm+") must be an integer. Change the stride and/or zero pad parameters"}),[um,Yp,hm,Dm]}([Gp,Wp,Qp,1],lm,1,Xp,Up,Mm);em=fm[0],sm=fm[1],Zp=fm[2]}else if(Up==="same"){em=Math.ceil(Gp/Xp),sm=Math.ceil(Wp/rm),Zp=Math.ceil(Qp/Kp);var _m=(em-1)*Xp+lm-Gp,zm=(sm-1)*rm+cm-Wp,tm=(Zp-1)*Kp+gm-Qp,Jp=Math.floor(_m/2),pm=_m-Jp,km=Math.floor(zm/2),ym=zm-km,Em=Math.floor(tm/2),Bm=tm-Em;dm={top:km,bottom:ym,left:Em,right:Bm,front:Jp,back:pm,type:"SAME"}}else{if(Up!=="valid")throw Error("Unknown padding parameter: "+Up);dm={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},em=Math.ceil((Gp-lm+1)/Xp),sm=Math.ceil((Wp-cm+1)/rm),Zp=Math.ceil((Qp-gm+1)/Kp)}return{padInfo:dm,outDepth:em,outHeight:sm,outWidth:Zp}}(sp,fp,pp,mp,Sp,Ap,Rp,$p,zp,Dp,cp),jp=Fp.padInfo,Lp=Fp.outDepth,Bp=Fp.outHeight,Ip=Fp.outWidth,kp=lp?bp*gp:bp;return up==="channelsFirst"?yp=[hp,kp,Lp,Bp,Ip]:up==="channelsLast"&&(yp=[hp,Lp,Bp,Ip,kp]),{batchSize:hp,dataFormat:up,inDepth:fp,inHeight:pp,inWidth:mp,inChannels:gp,outDepth:Lp,outHeight:Bp,outWidth:Ip,outChannels:kp,padInfo:jp,strideDepth:Sp,strideHeight:Ap,strideWidth:Rp,filterDepth:xp,filterHeight:_p,filterWidth:vp,effectiveFilterDepth:$p,effectiveFilterHeight:zp,effectiveFilterWidth:Dp,dilationDepth:Mp,dilationHeight:Op,dilationWidth:Pp,inShape:rp,outShape:yp,filterShape:_d}}function xo(rp,_d,np,ap){ap===void 0&&(ap=1);var sp=Co(_d,ap);return Math.floor((rp[0]*(np-1)-np+sp)/2)}function bo(rp){return typeof rp=="number"?[rp,rp,rp]:rp.length===2?[rp[0],rp[1],1]:rp}function wo(rp){return typeof rp=="number"?[rp,rp,rp]:rp}function Co(rp,_d){return _d<=1?rp:rp+(rp-1)*(_d-1)}function Eo(rp,_d){if(!_d)return rp;switch(_d){case"round":return Math.round(rp);case"ceil":return Math.ceil(rp);case"floor":return Math.floor(rp);default:throw new Error("Unknown roundingMode "+_d)}}function Ro(rp){var _d=bo(rp),np=_d[0],ap=_d[1],sp=_d[2];return np===1&&ap===1&&sp===1}function Io(rp,_d){return Ro(rp)||Ro(_d)}function ko(rp){if(rp==="NHWC")return"channelsLast";if(rp==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+rp)}function So(rp,_d,np){if(_d==="complex64"){if(rp.dtype==="complex64")return rp.clone();var ap=Pn(rp.shape),sp=rp.toFloat(),lp=np.complex(sp,ap);return ap.dispose(),sp.dispose(),lp}if(!M(rp.dtype,_d))return Nt.makeTensorFromDataId(rp.dataId,rp.shape,_d);if(rp.dtype==="complex64"){var up=np.real(rp);return lp=up.cast(_d),up.dispose(),lp}if(_d==="int32")return np.int(rp);if(_d==="bool"){var cp=An(0,rp.dtype);return lp=np.notEqual(rp,cp),cp.dispose(),lp}throw new Error("Error in Cast: failed to cast "+rp.dtype+" to "+_d)}function Ao(rp,_d){return Nt.makeTensorFromDataId(rp.dataId,_d,rp.dtype)}function Do(rp,_d,np){var ap=(_d-rp)/(np-1),sp=$$1(np,"float32");sp[0]=rp;for(var lp=1;lp<sp.length;lp++)sp[lp]=sp[lp-1]+ap;return Dn(sp,"float32")}var To=Object.freeze({castTensor:So,reshapeTensor:Ao,linspaceImpl:Do,upcastType:Ct,axesAreInnerMostDims:fn,combineLocations:pn,computeOutAndReduceShapes:dn,expandShapeToKeepDim:vn,assertAxesAreInnerMostDims:mn,getAxesPermutation:gn,getUndoAxesPermutation:yn,getInnerMostAxes:xn,getBroadcastDims:ho,getReductionAxes:fo,assertAndGetBroadcastShape:po,assertParamsConsistent:bn,computeOutShape:wn,computePool2DInfo:vo,computePool3DInfo:mo,computeConv2DInfo:go,computeConv3DInfo:yo,computeDefaultPad:xo,tupleValuesAreOne:Ro,eitherStridesOrDilationsAreOne:Io,convertConv2DDataFormat:ko});function No(rp,_d){if(rp.length!==_d.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+rp.length+", imag: "+_d.length+".");for(var np=new Float32Array(2*rp.length),ap=0;ap<np.length;ap+=2)np[ap]=rp[ap/2],np[ap+1]=_d[ap/2];return np}function Fo(rp,_d){return{real:rp[2*_d],imag:rp[2*_d+1]}}function Oo(rp,_d,np,ap){rp[2*ap]=_d,rp[2*ap+1]=np}function _o(rp,_d,np){var ap=(np?2:-2)*Math.PI*(rp/_d);return{real:Math.cos(ap),imag:Math.sin(ap)}}function Mo(rp,_d,np,ap,sp){for(var lp=Array.from(_d).map(function(gp,yp){return{score:gp,boxIndex:yp}}).filter(function(gp){return gp.score>sp}).sort(function(gp,yp){return yp.score-gp.score}),up=[],cp=0;cp<lp.length;cp++){var dp=lp[cp],hp=dp.score,fp=dp.boxIndex;if(hp<sp)break;for(var pp=!1,mp=up.length-1;mp>=0;--mp)if(Bo(rp,fp,up[mp])>=ap){pp=!0;break}if(!pp&&(up.push(fp),up.length>=np))break}return Dn(up,"int32")}function Bo(rp,_d,np){var ap=rp.subarray(4*_d,4*_d+4),sp=rp.subarray(4*np,4*np+4),lp=Math.min(ap[0],ap[2]),up=Math.min(ap[1],ap[3]),cp=Math.max(ap[0],ap[2]),dp=Math.max(ap[1],ap[3]),hp=Math.min(sp[0],sp[2]),fp=Math.min(sp[1],sp[3]),pp=Math.max(sp[0],sp[2]),mp=Math.max(sp[1],sp[3]),gp=(cp-lp)*(dp-up),yp=(pp-hp)*(mp-fp);if(gp<=0||yp<=0)return 0;var xp=Math.max(lp,hp),_p=Math.max(up,fp),vp=Math.min(cp,pp),bp=Math.min(dp,mp),Ep=Math.max(vp-xp,0)*Math.max(bp-_p,0);return Ep/(gp+yp-Ep)}function Po(rp,_d,np){var ap=new Array(rp.rank).fill(0),sp=rp.shape.slice();return _d.map(function(lp){sp[np]=lp;var up=rp.slice(ap,sp);return ap[np]+=lp,up})}function Lo(rp,_d){for(var np=new Array(rp.rank),ap=0;ap<np.length;ap++)np[ap]=rp.shape[ap]*_d[ap];var sp=ur(np,rp.dtype);for(ap=0;ap<sp.values.length;++ap){for(var lp=sp.indexToLoc(ap),up=new Array(rp.rank),cp=0;cp<up.length;cp++)up[cp]=lp[cp]%rp.shape[cp];var dp=rp.locToIndex(up);sp.values[ap]=rp.values[dp]}return sp.toTensor()}function Wo(rp,_d,np,ap,sp){for(var lp=_d[_d.length-1],up=[rp.length/lp,lp],cp=up[0],dp=up[1],hp=N(np,cp*ap),fp=N("int32",cp*ap),pp=0;pp<cp;pp++){for(var mp=pp*dp,gp=rp.subarray(mp,mp+dp),yp=[],xp=0;xp<gp.length;xp++)yp.push({value:gp[xp],index:xp});yp.sort(function(Sp,Ap){return Ap.value-Sp.value});var _p=pp*ap,vp=hp.subarray(_p,_p+ap),bp=fp.subarray(_p,_p+ap);for(xp=0;xp<ap;xp++)vp[xp]=yp[xp].value,bp[xp]=yp[xp].index}var Ep=_d.slice();return Ep[Ep.length-1]=ap,[kn(hp,Ep,np),kn(fp,Ep,"int32")]}function Uo(rp,_d){for(var np=[],ap=0;ap<_d.length;ap++)_d[ap]&&np.push(ap);var sp=ur(rp,"int32"),lp=ur([np.length,rp.length],"int32");for(ap=0;ap<np.length;ap++){var up=sp.indexToLoc(np[ap]),cp=ap*rp.length;lp.values.set(up,cp)}return lp.toTensor()}var Vo=function(){return function(rp,_d){this.outputShape=[],this.outputShape=rp,this.variableNames=_d.map(function(sp,lp){return"T"+lp});var np=[];this.variableNames.forEach(function(sp){np.push("float v"+sp+" = get"+sp+"AtOutCoords();")});var ap=this.variableNames.map(function(sp){return"v"+sp}).join(" + ");this.userCode=`
      void main() {
        `+np.join(`
        `)+`

        float result = `+ap+`;
        setOutput(result);
      }
    `}}(),zo=function(){return function(rp,_d){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=rp,this.variableNames=_d.map(function(sp,lp){return"T"+lp});var np=[];this.variableNames.forEach(function(sp){np.push("vec4 v"+sp+" = get"+sp+"AtOutCoords();")});var ap=this.variableNames.map(function(sp){return"v"+sp}).join(" + ");this.userCode=`
      void main() {
        `+np.join(`
        `)+`

        vec4 result = `+ap+`;
        setOutput(result);
      }
    `}}(),Go=function(){return function(rp,_d,np){this.variableNames=["A"];var ap=rp.windowSize,sp=rp.batchSize,lp=rp.inSize,up=Math.ceil(lp/ap);np||this.variableNames.push("bestIndicesA"),this.outputShape=[sp,up];var cp=_d==="max"?">":"<",dp=np?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+ap+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+ap+`; i++) {
          int inIdx = `+dp+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+cp+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}();function Ho(rp,_d){return["x","y","z","w","u","v"].slice(0,_d).map(function(np){return rp+"."+np})}function qo(rp,_d){return _d===1?[rp]:Ho(rp,_d)}function Ko(){var rp,_d,np,ap,sp,lp,up,cp,dp,hp;return a$1().getNumber("WEBGL_VERSION")===2?(rp="#version 300 es",_d="in",np="out",ap="in",sp="texture",lp="outputColor",up="out vec4 outputColor;",cp=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,dp="",hp=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(rp="",_d="attribute",np="varying",ap="varying",sp="texture2D",lp="gl_FragColor",up="",cp=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,dp=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,hp=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:rp,attribute:_d,varyingVs:np,varyingFs:ap,texture2D:sp,output:lp,defineOutput:up,defineSpecialNaN:cp,defineSpecialInf:dp,defineRound:hp}}function jo(rp,_d,np){np===void 0&&(np="index");var ap=q(_d);return ap.map(function(sp,lp){return"int "+rp[lp]+" = "+np+" / "+sp+"; "+(lp===ap.length-1?"int "+rp[lp+1]+" = "+np+" - "+rp[lp]+" * "+sp:"index -= "+rp[lp]+" * "+sp)+";"}).join("")}function Xo(rp){var _d=q(rp).map(function(np){return np.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+_d[0]+" + coords.y * "+_d[1]+` + coords.z;
  }
`}var $o=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function Yo(rp,_d,np,ap){var sp=[];rp.forEach(function(gp){var yp=w$1(gp.shapeInfo.logicalShape);gp.shapeInfo.isUniform?sp.push("uniform float "+gp.name+(yp>1?"["+yp+"]":"")+";"):(sp.push("uniform sampler2D "+gp.name+";"),sp.push("uniform int offset"+gp.name+";"))});var lp,up,cp=sp.join(`
`),dp=rp.map(function(gp){return function(yp,xp,_p){_p===void 0&&(_p=!1);var vp="";vp+=_p?Jo(yp):Qo(yp);var bp=yp.shapeInfo.logicalShape,Ep=xp.logicalShape;return bp.length<=Ep.length&&(vp+=_p?function(Sp,Ap){var Rp,Tp=Sp.name,Mp=Tp.charAt(0).toUpperCase()+Tp.slice(1),Op="get"+Mp+"AtOutCoords",Pp=Sp.shapeInfo.logicalShape.length,$p=Ap.logicalShape.length,zp=ho(Sp.shapeInfo.logicalShape,Ap.logicalShape),Dp=aa($p),Fp=$p-Pp,jp=["x","y","z","w","u","v"];Rp=Pp===0?"":$p<2&&zp.length>=1?"coords = 0;":zp.map(function(Wp){return"coords."+jp[Wp+Fp]+" = 0;"}).join(`
`);var Lp="";Lp=$p<2&&Pp>0?"coords":Sp.shapeInfo.logicalShape.map(function(Wp,Qp){return"coords."+jp[Qp+Fp]}).join(", ");var Bp="return outputValue;",Ip=w$1(Sp.shapeInfo.logicalShape)===1,kp=w$1(Ap.logicalShape)===1;if(Pp!==1||Ip||kp){if(Ip&&!kp)Bp=$p===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(zp.length){var Up=Pp-2,Gp=Pp-1;zp.indexOf(Up)>-1&&zp.indexOf(Gp)>-1?Bp="return vec4(outputValue.x);":zp.indexOf(Up)>-1?Bp="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":zp.indexOf(Gp)>-1&&(Bp="return vec4(outputValue.xx, outputValue.zz);")}}else Bp=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+Op+`() {
      `+Dp+` coords = getOutputCoords();
      `+Rp+`
      vec4 outputValue = get`+Mp+"("+Lp+`);
      `+Bp+`
    }
  `}(yp,xp):function(Sp,Ap){var Rp=Sp.name,Tp=Rp.charAt(0).toUpperCase()+Rp.slice(1),Mp="get"+Tp+"AtOutCoords",Op=Ap.texShape,Pp=Sp.shapeInfo.texShape,$p=Sp.shapeInfo.logicalShape.length,zp=Ap.logicalShape.length;if(!Sp.shapeInfo.isUniform&&$p===zp&&Sp.shapeInfo.flatOffset==null&&C(Pp,Op))return`
      float `+Mp+`() {
        return sampleTexture(`+Rp+`, resultUV);
      }
    `;var Dp,Fp=aa(zp),jp=ho(Sp.shapeInfo.logicalShape,Ap.logicalShape),Lp=zp-$p,Bp=["x","y","z","w","u","v"];Dp=$p===0?"":zp<2&&jp.length>=1?"coords = 0;":jp.map(function(kp){return"coords."+Bp[kp+Lp]+" = 0;"}).join(`
`);var Ip="";return Ip=zp<2&&$p>0?"coords":Sp.shapeInfo.logicalShape.map(function(kp,Up){return"coords."+Bp[Up+Lp]}).join(", "),`
    float `+Mp+`() {
      `+Fp+` coords = getOutputCoords();
      `+Dp+`
      return get`+Tp+"("+Ip+`);
    }
  `}(yp,xp)),vp}(gp,_d,ap)}).join(`
`),hp=_d.texShape,fp=Ko(),pp=function(gp){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+gp.texture2D+`(textureSampler, uv).r;
    }
  `}(fp),mp=function(gp){return gp.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+gp.varyingFs+` vec2 resultUV;
    `+gp.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+gp.defineSpecialNaN+`
    `+gp.defineSpecialInf+`
    `+gp.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+Zo+`
    `+ta+`
    `+ea+`
  `}(fp);return _d.isPacked?(lp=function(gp,yp){switch(gp.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(Sp,Ap){var Rp=[Math.ceil(Ap[0]/2),Math.ceil(Ap[1]/2)];return Rp[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+Rp[1]+`.0);
      }
    `:Rp[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+Rp[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+Rp[0]+", "+Rp[1]+`));
      return 2 * (resTexRC.x * `+Rp[1]+` + resTexRC.y);
    }
  `}(0,yp);case 2:return function(Sp,Ap){var Rp=[Math.ceil(Ap[0]/2),Math.ceil(Ap[1]/2)];if(C(Sp,Ap))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+Rp[0]+", "+Rp[1]+`));
      }
    `;var Tp=Math.ceil(Sp[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+Rp[0]+", "+Rp[1]+`));

      int index = resTexRC.x * `+Rp[1]+` + resTexRC.y;
      int r = 2 * (index / `+Tp+`);
      int c = imod(index, `+Tp+`) * 2;

      return ivec2(r, c);
    }
  `}(gp,yp);case 3:return xp=gp,_p=yp,vp=[Math.ceil(_p[0]/2),Math.ceil(_p[1]/2)],bp=Math.ceil(xp[2]/2),Ep=bp*Math.ceil(xp[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+vp[0]+", "+vp[1]+`));
      int index = resTexRC.x * `+vp[1]+` + resTexRC.y;

      int b = index / `+Ep+`;
      index -= b * `+Ep+`;

      int r = 2 * (index / `+bp+`);
      int c = imod(index, `+bp+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(Sp,Ap){for(var Rp=[Math.ceil(Ap[0]/2),Math.ceil(Ap[1]/2)],Tp=Math.ceil(Sp[Sp.length-1]/2),Mp=Tp*Math.ceil(Sp[Sp.length-2]/2),Op=Mp,Pp="",$p="b, r, c",zp=2;zp<Sp.length-1;zp++)Op*=Sp[Sp.length-zp-1],Pp=`
      int b`+zp+" = index / "+Op+`;
      index -= b`+zp+" * "+Op+`;
    `+Pp,$p="b"+zp+", "+$p;return`
    ivec`+Sp.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+Rp[0]+", "+Rp[1]+`));
      int index = resTexRC.x * `+Rp[1]+` + resTexRC.y;

      `+Pp+`

      int b = index / `+Mp+`;
      index -= b * `+Mp+`;

      int r = 2 * (index / `+Tp+`);
      int c = imod(index, `+Tp+`) * 2;

      return ivec`+Sp.length+"("+$p+`);
    }
  `}(gp,yp)}var xp,_p,vp,bp,Ep}(_d.logicalShape,hp),up=function(gp){return`
    void setOutput(vec4 val) {
      `+gp.output+` = val;
    }
  `}(fp)):(lp=function(gp,yp){switch(gp.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(vp,bp){return bp[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+bp[1]+`.0);
      }
    `:bp[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+bp[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+bp[0]+", "+bp[1]+`));
      return resTexRC.x * `+bp[1]+` + resTexRC.y;
    }
  `}(0,yp);case 2:return function(vp,bp){return C(vp,bp)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+bp[0]+", "+bp[1]+`));
      }
    `:vp[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+bp[0]+", "+bp[1]+`));
        int index = resTexRC.x * `+bp[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:vp[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+bp[0]+", "+bp[1]+`));
        int index = resTexRC.x * `+bp[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+bp[0]+", "+bp[1]+`));
      int index = resTexRC.x * `+bp[1]+` + resTexRC.y;
      int r = index / `+vp[1]+`;
      int c = index - r * `+vp[1]+`;
      return ivec2(r, c);
    }
  `}(gp,yp);case 3:return xp=yp,_p=jo(["r","c","d"],gp),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+xp[0]+", "+xp[1]+`));
      int index = resTexRC.x * `+xp[1]+` + resTexRC.y;
      `+_p+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(vp,bp){var Ep=jo(["r","c","d","d2"],vp);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+bp[0]+", "+bp[1]+`));
      int index = resTexRC.x * `+bp[1]+` + resTexRC.y;
      `+Ep+`
      return ivec4(r, c, d, d2);
    }
  `}(gp,yp);case 5:return function(vp,bp){var Ep=jo(["r","c","d","d2","d3"],vp);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+bp[0]+`,
                             `+bp[1]+`));

      int index = resTexRC.x * `+bp[1]+` + resTexRC.y;

      `+Ep+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(gp,yp);case 6:return function(vp,bp){var Ep=jo(["r","c","d","d2","d3","d4"],vp);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+bp[0]+", "+bp[1]+`));
      int index = resTexRC.x * `+bp[1]+` + resTexRC.y;

      `+Ep+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(gp,yp);default:throw new Error(gp.length+"-D output sampling is not yet supported")}var xp,_p}(_d.logicalShape,hp),up=function(gp){return`
    void setOutput(float val) {
      `+gp.output+` = vec4(val, 0, 0, 0);
    }
  `}(fp)),ap&&(mp+=na),[mp,pp,up,cp,lp,dp,np].join(`
`)}function Qo(rp){var _d=rp.shapeInfo.logicalShape;switch(_d.length){case 0:return function(np){var ap=np.name,sp="get"+ap.charAt(0).toUpperCase()+ap.slice(1);if(np.shapeInfo.isUniform)return"float "+sp+"() {return "+ap+";}";var lp=np.shapeInfo.texShape,up=lp[0],cp=lp[1];if(up===1&&cp===1)return`
      float `+sp+`() {
        return sampleTexture(`+ap+`, halfCR);
      }
    `;var dp=np.shapeInfo.texShape,hp=dp[0],fp=dp[1],pp=ra(ap);return`
    float `+sp+`() {
      vec2 uv = uvFromFlat(`+hp+", "+fp+", "+pp+`);
      return sampleTexture(`+ap+`, uv);
    }
  `}(rp);case 1:return function(np){var ap=np.name,sp="get"+ap.charAt(0).toUpperCase()+ap.slice(1);if(np.shapeInfo.isUniform)return`
      float `+sp+`(int index) {
        `+oa(np)+`
      }
    `;var lp=np.shapeInfo.texShape,up=lp[0],cp=lp[1];if(cp===1&&up===1)return`
      float `+sp+`(int index) {
        return sampleTexture(`+ap+`, halfCR);
      }
    `;var dp=ra(ap);return cp===1?`
      float `+sp+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+dp+") + 0.5) / "+up+`.0);
        return sampleTexture(`+ap+`, uv);
      }
    `:up===1?`
      float `+sp+`(int index) {
        vec2 uv = vec2((float(index + `+dp+") + 0.5) / "+cp+`.0, 0.5);
        return sampleTexture(`+ap+`, uv);
      }
    `:`
    float `+sp+`(int index) {
      vec2 uv = uvFromFlat(`+up+", "+cp+", index + "+dp+`);
      return sampleTexture(`+ap+`, uv);
    }
  `}(rp);case 2:return function(np){var ap=np.shapeInfo.logicalShape,sp=np.name,lp="get"+sp.charAt(0).toUpperCase()+sp.slice(1),up=np.shapeInfo.texShape;if(up!=null&&C(ap,up)){var cp=up[0],dp=up[1];return`
    float `+lp+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+dp+".0, "+cp+`.0);
      return sampleTexture(`+sp+`, uv);
    }
  `}var hp=T(ap),fp=hp.newShape,pp=hp.keptDims,mp=fp;if(mp.length<ap.length){var gp=ia(np,mp);return`
      `+Qo(gp)+`
      float `+lp+`(int row, int col) {
        return `+lp+"("+ua(["row","col"],pp)+`);
      }
    `}if(np.shapeInfo.isUniform)return`
      float `+lp+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+ap[1]+`, 1)));
        `+oa(np)+`
      }
    `;var yp=up[0],xp=up[1],_p=ra(sp);return xp===1?`
    float `+lp+`(int row, int col) {
      float index = dot(vec3(row, col, `+_p+"), vec3("+ap[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+yp+`.0);
      return sampleTexture(`+sp+`, uv);
    }
  `:yp===1?`
    float `+lp+`(int row, int col) {
      float index = dot(vec3(row, col, `+_p+"), vec3("+ap[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+xp+`.0, 0.5);
      return sampleTexture(`+sp+`, uv);
    }
  `:`
  float `+lp+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+ap[1]+" + col + "+_p+`;
    vec2 uv = uvFromFlat(`+yp+", "+xp+`, index);
    return sampleTexture(`+sp+`, uv);
  }
`}(rp);case 3:return function(np){var ap=np.shapeInfo.logicalShape,sp=np.name,lp="get"+sp.charAt(0).toUpperCase()+sp.slice(1),up=ap[1]*ap[2],cp=ap[2],dp=T(ap),hp=dp.newShape,fp=dp.keptDims,pp=hp;if(pp.length<ap.length){var mp=ia(np,pp);return`
        `+Qo(mp)+`
        float `+lp+`(int row, int col, int depth) {
          return `+lp+"("+ua(["row","col","depth"],fp)+`);
        }
      `}if(np.shapeInfo.isUniform)return`
      float `+lp+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+up+", "+cp+`, 1)));
        `+oa(np)+`
      }
    `;var gp=np.shapeInfo.texShape,yp=gp[0],xp=gp[1],_p=np.shapeInfo.flatOffset;if(xp===up&&_p==null)return`
        float `+lp+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+cp+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+xp+".0, "+yp+`.0);
          return sampleTexture(`+sp+`, uv);
        }
      `;if(xp===cp&&_p==null)return`
    float `+lp+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+ap[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+xp+".0, "+yp+`.0);
      return sampleTexture(`+sp+`, uv);
    }
  `;var vp=ra(sp);return`
      float `+lp+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+up+" + col * "+cp+" + depth + "+vp+`;
        vec2 uv = uvFromFlat(`+yp+", "+xp+`, index);
        return sampleTexture(`+sp+`, uv);
      }
  `}(rp);case 4:return function(np){var ap=np.shapeInfo.logicalShape,sp=np.name,lp="get"+sp.charAt(0).toUpperCase()+sp.slice(1),up=ap[3],cp=ap[2]*up,dp=ap[1]*cp,hp=T(ap),fp=hp.newShape,pp=hp.keptDims;if(fp.length<ap.length){var mp=ia(np,fp);return`
      `+Qo(mp)+`
      float `+lp+`(int row, int col, int depth, int depth2) {
        return `+lp+"("+ua(["row","col","depth","depth2"],pp)+`);
      }
    `}if(np.shapeInfo.isUniform)return`
      float `+lp+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+dp+", "+cp+", "+up+`, 1)));
        `+oa(np)+`
      }
    `;var gp=np.shapeInfo.flatOffset,yp=np.shapeInfo.texShape,xp=yp[0],_p=yp[1];if(_p===dp&&gp==null)return`
      float `+lp+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+cp+", "+up+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+_p+".0, "+xp+`.0);
        return sampleTexture(`+sp+`, uv);
      }
    `;if(_p===up&&gp==null)return`
      float `+lp+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+ap[1]*ap[2]+", "+ap[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+_p+".0, "+xp+`.0);
        return sampleTexture(`+sp+`, uv);
      }
    `;var vp=ra(sp);return`
    float `+lp+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+dp+" + col * "+cp+` +
          depth * `+up+` + depth2;
      vec2 uv = uvFromFlat(`+xp+", "+_p+", index + "+vp+`);
      return sampleTexture(`+sp+`, uv);
    }
  `}(rp);case 5:return function(np){var ap=np.shapeInfo.logicalShape,sp=np.name,lp="get"+sp.charAt(0).toUpperCase()+sp.slice(1),up=ap[4],cp=ap[3]*up,dp=ap[2]*cp,hp=ap[1]*dp,fp=T(ap),pp=fp.newShape,mp=fp.keptDims;if(pp.length<ap.length){var gp=ia(np,pp);return`
      `+Qo(gp)+`
      float `+lp+`(int row, int col, int depth, int depth2, int depth3) {
        return `+lp+"("+ua(["row","col","depth","depth2","depth3"],mp)+`);
      }
    `}if(np.shapeInfo.isUniform)return`
      float `+lp+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+hp+", "+dp+", "+cp+", "+up+`)) +
          depth3;
        `+oa(np)+`
      }
    `;var yp=np.shapeInfo.flatOffset,xp=np.shapeInfo.texShape,_p=xp[0],vp=xp[1];if(vp===hp&&yp==null)return`
      float `+lp+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+dp+", "+cp+", "+up+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+vp+".0, "+_p+`.0);
        return sampleTexture(`+sp+`, uv);
      }
    `;if(vp===up&&yp==null)return`
      float `+lp+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+ap[1]*ap[2]*ap[3]+`,
               `+ap[2]*ap[3]+", "+ap[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+vp+".0, "+_p+`.0);
        return sampleTexture(`+sp+`, uv);
      }
    `;var bp=ra(sp);return`
    float `+lp+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+hp+" + col * "+dp+" + depth * "+cp+` +
          depth2 * `+up+" + depth3 + "+bp+`;
      vec2 uv = uvFromFlat(`+_p+", "+vp+`, index);
      return sampleTexture(`+sp+`, uv);
    }
  `}(rp);case 6:return function(np){var ap=np.shapeInfo.logicalShape,sp=np.name,lp="get"+sp.charAt(0).toUpperCase()+sp.slice(1),up=T(ap),cp=up.newShape,dp=up.keptDims;if(cp.length<ap.length){var hp=ia(np,cp);return`
      `+Qo(hp)+`
      float `+lp+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+lp+"("+ua(["row","col","depth","depth2","depth3","depth4"],dp)+`);
      }
    `}var fp=ap[5],pp=ap[4]*fp,mp=ap[3]*pp,gp=ap[2]*mp,yp=ap[1]*gp;if(np.shapeInfo.isUniform)return`
      float `+lp+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+yp+", "+gp+", "+mp+", "+pp+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+fp+`, 1)));
        `+oa(np)+`
      }
    `;var xp=np.shapeInfo.flatOffset,_p=np.shapeInfo.texShape,vp=_p[0],bp=_p[1];if(bp===yp&&xp==null)return`
      float `+lp+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+gp+", "+mp+", "+pp+", "+fp+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+bp+".0, "+vp+`.0);
        return sampleTexture(`+sp+`, uv);
      }
    `;if(bp===fp&&xp==null)return`
      float `+lp+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+ap[1]*ap[2]*ap[3]*ap[4]+`,
               `+ap[2]*ap[3]*ap[4]+`,
               `+ap[3]*ap[4]+`,
               `+ap[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+bp+".0, "+vp+`.0);
        return sampleTexture(`+sp+`, uv);
      }
    `;var Ep=ra(sp);return`
    float `+lp+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+yp+" + col * "+gp+" + depth * "+mp+` +
          depth2 * `+pp+" + depth3 * "+fp+" + depth4 + "+Ep+`;
      vec2 uv = uvFromFlat(`+vp+", "+bp+`, index);
      return sampleTexture(`+sp+`, uv);
    }
  `}(rp);default:throw new Error(_d.length+"-D input sampling is not yet supported")}}function Jo(rp){var _d,np,ap;switch(rp.shapeInfo.logicalShape.length){case 0:return _d=rp.name,np="get"+_d.charAt(0).toUpperCase()+_d.slice(1),ap=Ko(),`
    vec4 `+np+`() {
      return `+ap.texture2D+"("+_d+`, halfCR);
    }
  `;case 1:return function(sp){var lp=sp.name,up="get"+lp.charAt(0).toUpperCase()+lp.slice(1),cp=sp.shapeInfo.texShape,dp=[Math.ceil(cp[0]/2),Math.ceil(cp[1]/2)],hp=Ko();return`
    vec4 `+up+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+dp[0]+", "+dp[1]+`, index);
      return `+hp.texture2D+"("+lp+`, uv);
    }
  `}(rp);case 2:return function(sp){var lp=sp.shapeInfo.logicalShape,up=sp.name,cp="get"+up.charAt(0).toUpperCase()+up.slice(1),dp=sp.shapeInfo.texShape,hp=dp[0],fp=dp[1],pp=Ko();if(dp!=null&&C(lp,dp))return`
      vec4 `+cp+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+fp+".0, "+hp+`.0);

        return `+pp.texture2D+"("+up+`, uv);
      }
    `;var mp=[Math.ceil(dp[0]/2),Math.ceil(dp[1]/2)],gp=Math.ceil(lp[1]/2);return`
    vec4 `+cp+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+gp+", "+mp[0]+", "+mp[1]+`, row, col);
      return `+pp.texture2D+"("+up+`, uv);
    }
  `}(rp);case 3:return function(sp){var lp=sp.shapeInfo.logicalShape,up=sp.name,cp="get"+up.charAt(0).toUpperCase()+up.slice(1),dp=sp.shapeInfo.texShape,hp=[Math.ceil(dp[0]/2),Math.ceil(dp[1]/2)];if(lp[0]===1){var fp=lp.slice(1),pp=ia(sp,fp);return`
        `+Jo(pp)+`
        vec4 `+cp+`(int b, int row, int col) {
          return `+cp+"("+ua(["b","row","col"],[1,2])+`);
        }
      `}var mp=hp[0],gp=hp[1],yp=Math.ceil(lp[2]/2),xp=yp*Math.ceil(lp[1]/2),_p=Ko();return`
    vec4 `+cp+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+mp+", "+gp+", "+xp+", "+yp+`, b, row, col);
      return `+_p.texture2D+"("+up+`, uv);
    }
  `}(rp);default:return function(sp){for(var lp=sp.shapeInfo.logicalShape,up=lp.length,cp=sp.name,dp="get"+cp.charAt(0).toUpperCase()+cp.slice(1),hp=sp.shapeInfo.texShape,fp=[Math.ceil(hp[0]/2),Math.ceil(hp[1]/2)],pp=fp[0],mp=fp[1],gp=Math.ceil(lp[up-1]/2),yp=gp*Math.ceil(lp[up-2]/2),xp="int b, int row, int col",_p="b * "+yp+" + (row / 2) * "+gp+" + (col / 2)",vp=2;vp<up-1;vp++)xp="int b"+vp+", "+xp,yp*=lp[up-vp-1],_p="b"+vp+" * "+yp+" + "+_p;var bp=Ko();return`
    vec4 `+dp+"("+xp+`) {
      int index = `+_p+`;
      int texR = index / `+mp+`;
      int texC = index - texR * `+mp+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+mp+", "+pp+`);
      return `+bp.texture2D+"("+cp+`, uv);
    }
  `}(rp)}}var Zo=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ta=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ea=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,na=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function ra(rp){return"offset"+rp}function oa(rp){var _d=rp.name,np=w$1(rp.shapeInfo.logicalShape);return np<2?"return "+_d+";":`
    for (int i = 0; i < `+np+`; i++) {
      if (i == index) {
        return `+_d+`[i];
      }
    }
  `}function aa(rp){if(rp<=1)return"int";if(rp===2)return"ivec2";if(rp===3)return"ivec3";if(rp===4)return"ivec4";if(rp===5)return"ivec5";if(rp===6)return"ivec6";throw Error("GPU for rank "+rp+" is not yet supported")}function ia(rp,_d){var np=JSON.parse(JSON.stringify(rp));return np.shapeInfo.logicalShape=_d,np}function ua(rp,_d){return _d.map(function(np){return rp[np]}).join(", ")}var sa=function(){return function(rp,_d,np,ap){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,g(rp.length>2,function(){return"Packed arg"+(np.charAt(0).toUpperCase()+np.slice(1))+" supports only inputs with rank above 2."});var sp=rp[rp.length-1],lp=Math.ceil(sp/_d);this.outputShape=rp.slice(0,-1),lp>1&&this.outputShape.push(lp),ap||this.variableNames.push("bestIndicesA");var up,cp,dp=this.outputShape,hp=dp.length,fp=aa(hp),pp=qo("coords",hp);if(lp===1){var mp=aa(cp=hp+1);up=`
        `+mp+" sourceLocR = "+mp+"("+pp.join()+`, 0);
        ++`+pp[hp-1]+`;
        `+mp+" sourceLocG = "+mp+"("+pp.join()+`, 0);
        ++`+pp[hp-2]+`;
        `+mp+" sourceLocA = "+mp+"("+pp.join()+`, 0);
        --`+pp[hp-1]+`;
        `+mp+" sourceLocB = "+mp+"("+pp.join()+`, 0);
        --`+pp[hp-2]+";"}else cp=hp,up=`
        `+fp+` sourceLocR = coords;
        ++`+pp[hp-1]+`;
        `+fp+` sourceLocG = coords;
        ++`+pp[hp-2]+`;
        `+fp+` sourceLocA = coords;
        --`+pp[hp-1]+`;
        `+fp+` sourceLocB = coords;
        --`+pp[hp-2]+";";var gp=["x","y","z","w","u","v"].slice(0,cp),yp="."+gp[cp-1],xp=gp.map(function(Mp){return"int "+Mp}),_p=qo("sourceLocR",cp-1).concat("inIdx.r"),vp=qo("sourceLocG",cp-1).concat("inIdx.g"),bp=qo("sourceLocB",cp-1).concat("inIdx.b"),Ep=qo("sourceLocA",cp-1).concat("inIdx.a"),Sp=np==="max"?"greaterThan":"lessThan",Ap=ap?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+_p.join()+`),
                             getBestIndicesAChannel(`+vp.join()+`),
                             getBestIndicesAChannel(`+bp.join()+`),
                             getBestIndicesAChannel(`+Ep.join()+")));",Rp=`vec4(
            getAChannel(`+_p.join()+`),
            hasNextCol ? getAChannel(`+vp.join()+`) : 0.,
            hasNextRow ? getAChannel(`+bp.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+Ep.join()+") : 0.)",Tp=ap?"":`
      float getBestIndicesAChannel(`+xp.join()+`) {
        return getChannel(getBestIndicesA(`+gp.join()+`),
                                          vec2(`+gp.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+xp.join()+`) {
        return getChannel(getA(`+gp.join()+`),
                               vec2(`+gp.slice(-2).join()+`));
      }
      `+Tp+`
      void main() {
        `+fp+` coords = getOutputCoords();
        bool hasNextCol = `+pp[hp-1]+" < "+(dp[hp-1]-1)+`;
        bool hasNextRow = `+pp[hp-2]+" < "+(dp[hp-2]-1)+`;
        `+up+`
        ivec4 srcIdx = ivec4(sourceLocR`+yp+", sourceLocG"+yp+`,
          sourceLocB`+yp+", sourceLocA"+yp+") * "+_d+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+Rp+`;

        for (int i = 0; i < `+_d+`; i++) {
          inIdx = srcIdx;
          `+Ap+`
          vec4 candidate = `+Rp+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+Sp+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}(),ca=function(){return function(rp){this.variableNames=["dy"],this.outputShape=rp.inShape;var _d=rp.filterHeight,np=rp.filterWidth,ap=rp.strideHeight,sp=rp.strideWidth,lp=rp.dilationHeight,up=rp.dilationWidth,cp=rp.effectiveFilterHeight,dp=rp.effectiveFilterWidth,hp=cp-1-rp.padInfo.top,fp=dp-1-rp.padInfo.left,pp=1/(_d*np);this.userCode=`
      const ivec2 pads = ivec2(`+hp+", "+fp+`);
      const float avgMultiplier = float(`+pp+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+cp+`;
            wR += `+lp+`) {
          float dyR = float(dyRCorner + wR) / `+ap+`.0;

          if (dyR < 0.0 || dyR >= `+rp.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+dp+`;
            wC+= `+up+`) {
            float dyC = float(dyCCorner + wC) / `+sp+`.0;

            if (dyC < 0.0 || dyC >= `+rp.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}(),la=function(){return function(rp){this.variableNames=["dy"],this.outputShape=rp.inShape;var _d=rp.filterDepth,np=rp.filterHeight,ap=rp.filterWidth,sp=rp.strideDepth,lp=rp.strideHeight,up=rp.strideWidth,cp=rp.dilationDepth,dp=rp.dilationHeight,hp=rp.dilationWidth,fp=rp.effectiveFilterDepth,pp=rp.effectiveFilterHeight,mp=rp.effectiveFilterWidth,gp=fp-1-rp.padInfo.front,yp=pp-1-rp.padInfo.top,xp=mp-1-rp.padInfo.left,_p=1/(_d*np*ap);this.userCode=`
      const ivec3 pads = ivec3(`+gp+", "+yp+", "+xp+`);
      const float avgMultiplier = float(`+_p+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+fp+`;
            wD += `+cp+`) {
          float dyD = float(dyDCorner + wD) / `+sp+`.0;

          if (dyD < 0.0 || dyD >= `+rp.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+pp+`;
              wR += `+dp+`) {
            float dyR = float(dyRCorner + wR) / `+lp+`.0;

            if (dyR < 0.0 || dyR >= `+rp.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+mp+`;
                wC += `+hp+`) {
              float dyC = float(dyCCorner + wC) / `+up+`.0;

              if (dyC < 0.0 || dyC >= `+rp.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),ha=function(){return function(rp,_d,np,ap,sp,lp){this.outputShape=[],this.variableNames=["x","mean","variance"],po(rp,_d),po(rp,np);var up="0.0";ap!=null&&(po(rp,ap),this.variableNames.push("offset"),up="getOffsetAtOutCoords()");var cp="1.0";sp!=null&&(po(rp,sp),this.variableNames.push("scale"),cp="getScaleAtOutCoords()"),this.outputShape=rp,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+up+`;
        float scale = `+cp+`;
        float inv = scale * inversesqrt(variance + float(`+lp+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}(),fa=function(){return function(rp,_d,np,ap,sp,lp){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],po(rp,_d),po(rp,np);var up="vec4(0.0)";ap!=null&&(po(rp,ap),this.variableNames.push("offset"),up="getOffsetAtOutCoords()");var cp="vec4(1.0)";sp!=null&&(po(rp,sp),this.variableNames.push("scale"),cp="getScaleAtOutCoords()"),this.outputShape=rp,this.userCode=`
      void main() {
        vec4 offset = `+up+`;
        vec4 scale = `+cp+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+lp+`));

        setOutput((x - mean) * inv + offset);
      }
    `}}(),pa="return areal * breal - aimag * bimag;",da="return areal * bimag + aimag * breal;",va=function(){return function(rp,_d,np){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=po(_d,np),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+rp+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}(),ma="return a + b;",ga="return a - b;",ya="return a * b;",xa="return (a < 0.) ? b * a : a;",ba=function(){return function(rp,_d,np){this.variableNames=["A","B"],this.outputShape=po(_d,np),this.userCode=`
      float binaryOperation(float a, float b) {
        `+rp+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}(),wa=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Ca=function(){return function(rp,_d,np,ap){ap===void 0&&(ap=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=po(_d,np);var sp=this.outputShape.length,lp="";if(ap)if(sp===0||w$1(this.outputShape)===1)lp=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(lp=`
          `+aa(sp)+` coords = getOutputCoords();
        `,sp===1)lp+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var up=qo("coords",sp);lp+=`
            bool nextRowOutOfBounds =
              (`+up[sp-2]+" + 1) >= "+this.outputShape[sp-2]+`;
            bool nextColOutOfBounds =
              (`+up[sp-1]+" + 1) >= "+this.outputShape[sp-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+rp+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+lp+`

        setOutput(result);
      }
    `}}(),Ea=function(){function rp(_d){this.variableNames=["A"],this.outputShape=_d,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return rp.prototype.getCustomSetupFunc=function(_d,np){var ap=this;return function(sp,lp){ap.minLoc==null&&(ap.minLoc=sp.getUniformLocationNoThrow(lp,"minVal"),ap.maxLoc=sp.getUniformLocationNoThrow(lp,"maxVal")),sp.gl.uniform1f(ap.minLoc,_d),sp.gl.uniform1f(ap.maxLoc,np)}},rp}(),Ra=function(){function rp(_d){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_d,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return rp.prototype.getCustomSetupFunc=function(_d,np){var ap=this;return function(sp,lp){ap.minLoc==null&&(ap.minLoc=sp.getUniformLocationNoThrow(lp,"minVal"),ap.maxLoc=sp.getUniformLocationNoThrow(lp,"maxVal")),sp.gl.uniform1f(ap.minLoc,_d),sp.gl.uniform1f(ap.maxLoc,np)}},rp}(),Ia=function(){return function(rp){this.variableNames=["real","imag"],this.outputShape=rp,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}(),ka=function(){return function(rp){this.outputShape=[],this.outputShape=wn(rp,1),this.variableNames=rp.map(function(cp,dp){return"T"+dp});var _d=new Array(rp.length-1);_d[0]=rp[0][1];for(var np=1;np<_d.length;np++)_d[np]=_d[np-1]+rp[np][1];var ap=["if (yC < "+_d[0]+") setOutput(getT0(yR, yC));"];for(np=1;np<_d.length;np++){var sp=_d[np-1];ap.push("else if (yC < "+_d[np]+") setOutput(getT"+np+"(yR, yC-"+sp+"));")}var lp=_d.length,up=_d[_d.length-1];ap.push("else setOutput(getT"+lp+"(yR, yC-"+up+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+ap.join(`
        `)+`
      }
    `}}(),Sa=function(){return function(rp,_d){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=wn(rp,_d);var np=this.outputShape,ap=np.length,sp=aa(ap),lp=qo("coords",ap),up=["x","y","z","w","u","v"].slice(0,ap);this.variableNames=rp.map(function(_p,vp){return"T"+vp});var cp=new Array(rp.length-1);cp[0]=rp[0][_d];for(var dp=1;dp<cp.length;dp++)cp[dp]=cp[dp-1]+rp[dp][_d];var hp=up[_d],fp=up.slice(-2),pp=up.join(),mp="if ("+hp+" < "+cp[0]+`) {
        return getChannel(
            getT0(`+pp+"), vec2("+fp.join()+`));
        }`;for(dp=1;dp<cp.length;dp++){var gp=cp[dp-1];mp+=`
        if (`+hp+" < "+cp[dp]+"  && "+hp+" >= "+cp[dp-1]+`) {
          return getChannel(
            getT`+dp+"("+Aa(up,hp,gp)+`),
            vec2(`+Aa(fp,hp,gp)+`));
        }`}var yp=cp.length,xp=cp[cp.length-1];mp+=`
        return getChannel(
          getT`+yp+"("+Aa(up,hp,xp)+`),
          vec2(`+Aa(fp,hp,xp)+"));",this.userCode=`
      float getValue(`+up.map(function(_p){return"int "+_p})+`) {
        `+mp+`
      }

      void main() {
        `+sp+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+lp+`), 0., 0., 0.);

        `+lp[ap-1]+" = "+lp[ap-1]+` + 1;
        if (`+lp[ap-1]+" < "+np[ap-1]+`) {
          result.g = getValue(`+lp+`);
        }

        `+lp[ap-2]+" = "+lp[ap-2]+` + 1;
        if (`+lp[ap-2]+" < "+np[ap-2]+`) {
          result.a = getValue(`+lp+`);
        }

        `+lp[ap-1]+" = "+lp[ap-1]+` - 1;
        if (`+lp[ap-2]+" < "+np[ap-2]+` &&
            `+lp[ap-1]+" < "+np[ap-1]+`) {
          result.b = getValue(`+lp+`);
        }
        setOutput(result);
      }
    `}}();function Aa(rp,_d,np){var ap=rp.indexOf(_d);return rp.map(function(sp,lp){return lp===ap?sp+" - "+np:sp}).join()}var Da=function(){return function(rp){this.variableNames=["x","dy"],this.outputShape=rp.filterShape;var _d=rp.strideHeight,np=rp.strideWidth,ap=rp.padInfo.top,sp=rp.padInfo.left,lp=rp.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+rp.batchSize+`; b++) {
          for (int yR = 0; yR < `+rp.outHeight+`; yR++) {
            int xR = wR + yR * `+_d+" - "+ap+`;

            if (xR < 0 || xR >= `+rp.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+rp.outWidth+`; yC++) {
              int xC = wC + yC * `+np+" - "+sp+`;

              if (xC < 0 || xC >= `+rp.inWidth+`) {
                continue;
              }

              if (`+lp+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),Ta=function(){return function(rp){this.variableNames=["dy","W"],this.outputShape=rp.inShape;var _d=rp.filterHeight,np=rp.filterWidth,ap=rp.strideHeight,sp=rp.strideWidth,lp=rp.dataFormat==="channelsLast",up=_d-1-rp.padInfo.top,cp=np-1-rp.padInfo.left,dp=lp?1:2,hp=lp?2:3,fp=lp?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+up+", "+cp+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+fp+`];

        ivec2 dyCorner = ivec2(coords[`+dp+"], coords["+hp+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+_d+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+ap+`.0;

          if (dyR < 0.0 || dyR >= `+rp.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+_d+` - 1 - wR;

          for (int wC = 0; wC < `+np+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+sp+`.0;

            if (dyC < 0.0 || dyC >= `+rp.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+np+` - 1 - wC;

            for (int d2 = 0; d2 < `+rp.outChannels+`; d2++) {

              if (`+lp+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),Na=function(){return function(rp){this.variableNames=["x","dy"],this.outputShape=rp.filterShape;var _d=rp.strideDepth,np=rp.strideHeight,ap=rp.strideWidth,sp=rp.padInfo.front,lp=rp.padInfo.top,up=rp.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+rp.batchSize+`; b++) {
          for (int yF = 0; yF < `+rp.outDepth+`; yF++) {
            int xF = wF + yF * `+_d+" - "+sp+`;

            if (xF < 0 || xF >= `+rp.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+rp.outHeight+`; yR++) {
              int xR = wR + yR * `+np+" - "+lp+`;

              if (xR < 0 || xR >= `+rp.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+rp.outWidth+`; yC++) {
                int xC = wC + yC * `+ap+" - "+up+`;

                if (xC < 0 || xC >= `+rp.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),Fa=function(){return function(rp){this.variableNames=["dy","W"],this.outputShape=rp.inShape;var _d=rp.filterDepth,np=rp.filterHeight,ap=rp.filterWidth,sp=rp.strideDepth,lp=rp.strideHeight,up=rp.strideWidth,cp=_d-1-rp.padInfo.front,dp=np-1-rp.padInfo.top,hp=ap-1-rp.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+cp+", "+dp+", "+hp+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+_d+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+sp+`.0;

          if (dyF < 0.0 || dyF >= `+rp.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+_d+` - 1 - wF;

          for (int wR = 0; wR < `+np+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+lp+`.0;

            if (dyR < 0.0 || dyR >= `+rp.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+np+` - 1 - wR;

            for (int wC = 0; wC < `+ap+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+up+`.0;

              if (dyC < 0.0 || dyC >= `+rp.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+ap+` - 1 - wC;

              for (int d2 = 0; d2 < `+rp.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),Oa=function(){return function(rp){this.variableNames=["x","dy"],this.outputShape=rp.filterShape;var _d=rp.strideHeight,np=rp.strideWidth,ap=rp.padInfo.top,sp=rp.padInfo.left,lp=rp.outChannels/rp.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+lp+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+rp.batchSize+`; b++) {
          for (int yR = 0; yR < `+rp.outHeight+`; yR++) {
            int xR = wR + yR * `+_d+" - "+ap+`;

            if (xR < 0 || xR >= `+rp.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+rp.outWidth+`; yC++) {
              int xC = wC + yC * `+np+" - "+sp+`;

              if (xC < 0 || xC >= `+rp.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),_a=function(){return function(rp){this.variableNames=["dy","W"],this.outputShape=rp.inShape;var _d=rp.filterHeight,np=rp.filterWidth,ap=rp.strideHeight,sp=rp.strideWidth,lp=_d-1-rp.padInfo.top,up=np-1-rp.padInfo.left,cp=rp.outChannels/rp.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+lp+", "+up+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+_d+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+ap+`.0;

          if (dyR < 0.0 || dyR >= `+rp.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+_d+` - 1 - wR;

          for (int wC = 0; wC < `+np+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+sp+`.0;

            if (dyC < 0.0 || dyC >= `+rp.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+np+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+cp+`; dm++) {
              int d2 = d1 * `+cp+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),Ma=function(){return function(rp,_d,np,ap){_d===void 0&&(_d=!1),np===void 0&&(np=null),ap===void 0&&(ap=!1),this.variableNames=["x","W"],this.outputShape=rp.outShape;var sp=rp.padInfo.top,lp=rp.padInfo.left,up=rp.strideHeight,cp=rp.strideWidth,dp=rp.dilationHeight,hp=rp.dilationWidth,fp=rp.filterHeight,pp=rp.filterWidth,mp=4*Math.floor(rp.inChannels/4),gp=rp.inChannels%4,yp=rp.dataFormat==="channelsLast",xp=yp?1:2,_p=yp?2:3,vp=yp?3:1,bp="",Ep="";np&&(bp=ap?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+np+`
        }`:`
          float activation(float x) {
            `+np+`
          }
        `,Ep="result = activation(result);");var Sp=_d?"result += getBiasAtOutCoords();":"";_d&&this.variableNames.push("bias"),ap&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+bp+`

      const ivec2 strides = ivec2(`+up+", "+cp+`);
      const ivec2 pads = ivec2(`+sp+", "+lp+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+vp+`];

        ivec2 xRCCorner =
            ivec2(coords[`+xp+"], coords["+_p+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+fp+`; wR++) {
          int xR = xRCorner + wR * `+dp+`;

          if (xR < 0 || xR >= `+rp.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+pp+`; wC++) {
            int xC = xCCorner + wC * `+hp+`;

            if (xC < 0 || xC >= `+rp.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+mp+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+yp+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(gp===1)+`) {

              if (`+yp+`) {
                dotProd +=
                    getX(batch, xR, xC, `+mp+`) *
                    getW(wR, wC, `+mp+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+mp+`, xR, xC) *
                    getW(wR, wC, `+mp+`, d2);
              }

            } else if (`+(gp===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+mp+`, d2),
                getW(wR, wC, `+mp+` + 1, d2)
              );

              if (`+yp+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+mp+`),
                  getX(batch, xR, xC, `+mp+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+mp+`, xR, xC),
                  getX(batch, `+mp+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(gp===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+mp+`, d2),
                getW(wR, wC, `+mp+` + 1, d2),
                getW(wR, wC, `+mp+` + 2, d2)
              );

              if (`+yp+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+mp+`),
                  getX(batch, xR, xC, `+mp+` + 1),
                  getX(batch, xR, xC, `+mp+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+mp+`, xR, xC),
                  getX(batch, `+mp+` + 1, xR, xC),
                  getX(batch, `+mp+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+Sp+`
        `+Ep+`
        setOutput(result);
      }
    `}}(),Ba=function(){return function(rp){this.variableNames=["x","W"],this.outputShape=rp.outShape;var _d=rp.padInfo.front,np=rp.padInfo.top,ap=rp.padInfo.left,sp=rp.strideDepth,lp=rp.strideHeight,up=rp.strideWidth,cp=rp.dilationDepth,dp=rp.dilationHeight,hp=rp.dilationWidth,fp=rp.filterDepth,pp=rp.filterHeight,mp=rp.filterWidth,gp=4*Math.floor(rp.inChannels/4),yp=rp.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+sp+", "+lp+", "+up+`);
      const ivec3 pads = ivec3(`+_d+", "+np+", "+ap+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+fp+`; wF++) {
          int xF = xFCorner + wF * `+cp+`;

          if (xF < 0 || xF >= `+rp.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+pp+`; wR++) {
            int xR = xRCorner + wR * `+dp+`;

            if (xR < 0 || xR >= `+rp.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+mp+`; wC++) {
              int xC = xCCorner + wC * `+hp+`;

              if (xC < 0 || xC >= `+rp.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+gp+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(yp===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+gp+`) *
                  getW(wF, wR, wC, `+gp+`, d2);
              } else if (`+(yp===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+gp+`),
                  getX(batch, xF, xR, xC, `+gp+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+gp+`, d2),
                  getW(wF, wR, wC, `+gp+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(yp===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+gp+`),
                  getX(batch, xF, xR, xC, `+gp+` + 1),
                  getX(batch, xF, xR, xC, `+gp+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+gp+`, d2),
                  getW(wF, wR, wC, `+gp+` + 1, d2),
                  getW(wF, wR, wC, `+gp+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),Pa=function(){return function(rp,_d,np,ap){_d===void 0&&(_d=!1),np===void 0&&(np=null),ap===void 0&&(ap=!1),this.variableNames=["x","W"],this.outputShape=rp.outShape;var sp=rp.inHeight,lp=rp.inWidth,up=rp.padInfo.top,cp=rp.padInfo.left,dp=rp.strideHeight,hp=rp.strideWidth,fp=rp.dilationHeight,pp=rp.dilationWidth,mp=rp.filterHeight,gp=rp.filterWidth,yp=rp.outChannels/rp.inChannels,xp="",_p="";np&&(xp=ap?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+np+`
        }`:`
          float activation(float x) {
            `+np+`
          }
        `,_p="result = activation(result);");var vp=_d?"result += getBiasAtOutCoords();":"";_d&&this.variableNames.push("bias"),ap&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+xp+`

      const ivec2 strides = ivec2(`+dp+", "+hp+`);
      const ivec2 pads = ivec2(`+up+", "+cp+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+yp+`;
        int q = d2 - d1 * `+yp+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+mp+`; wR++) {
          int xR = xRCorner + wR * `+fp+`;

          if (xR < 0 || xR >= `+sp+`) {
            continue;
          }

          for (int wC = 0; wC < `+gp+`; wC++) {
            int xC = xCCorner + wC * `+pp+`;

            if (xC < 0 || xC >= `+lp+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+vp+`
        `+_p+`
        setOutput(result);
      }
    `}}(),La=function(){return function(rp,_d,np,ap){_d===void 0&&(_d=!1),np===void 0&&(np=null),ap===void 0&&(ap=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=rp.outShape;for(var sp=rp.inHeight,lp=rp.inWidth,up=rp.padInfo.top,cp=rp.padInfo.left,dp=rp.strideHeight,hp=rp.strideWidth,fp=rp.dilationHeight,pp=rp.dilationWidth,mp=rp.filterHeight,gp=rp.filterWidth,yp=gp,xp="int xR; int xC; int xCOffset;",_p=0;_p<mp;_p++)for(var vp=0;vp<gp;vp++)xp+=`
          vec4 xTexelR`+_p+"C"+2*vp+` = vec4(0.);
          vec4 wR`+_p+"C"+vp+` = vec4(0.);
          vec4 xR`+_p+"C"+vp+" = vec4(0.);";for(_p=0;_p<mp;_p++)for(var bp=0;bp<yp;bp++){if(xp+=`
          xR = xRCorner + `+_p*fp+`;
          xC = xCCorner + `+(vp=2*bp)*pp+`;
        `,hp===1){if(vp<gp&&(xp+=cp%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+sp+" && xCOffset >= 0 && xCOffset < "+lp+`) {
                  xTexelR`+_p+"C"+vp+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+_p+"C"+vp+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+sp+" && xCOffset >= 0 && xCOffset < "+lp+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);
                  xR`+_p+"C"+vp+" = vec4(previous.zw, xTexelR"+_p+"C"+vp+`.xy);
                } else {
                  xR`+_p+"C"+vp+" = vec4(0, 0, xTexelR"+_p+"C"+vp+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+sp+" && xC >= 0 && xC < "+lp+`) {
                  xTexelR`+_p+"C"+vp+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+_p+"C"+vp+` = vec4(0.);
                }

                xR`+_p+"C"+vp+" = xTexelR"+_p+"C"+vp+`;
              `,vp+1<gp)){var Ep=cp%2==0?v$2(pp):pp;pp%2==0&&cp%2==1||pp%2!=0&&cp%2!=1?(xp+=`
                  xCOffset = xC + `+cp%2+" + "+Ep+`;

                  if(xR >= 0 && xR < `+sp+` &&
                    xCOffset >= 0 && xCOffset < `+lp+`) {
                    xTexelR`+_p+"C"+(vp+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,pp>1&&(xp+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+sp+` &&
                      xCOffset >= 0 && xCOffset < `+lp+`) {
                      xTexelR`+_p+"C"+vp+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+_p+"C"+vp+` = vec4(0.);
                    }
                  `),xp+=`
                  xR`+_p+"C"+(vp+1)+` = vec4(
                    xTexelR`+_p+"C"+vp+".zw, xTexelR"+_p+"C"+(vp+2)+`.xy);
                `):xp+=`
                  xCOffset = xC + `+Ep+`;

                  if(xR >= 0 && xR < `+sp+` &&
                    xCOffset >= 0 && xCOffset < `+lp+`) {
                    xTexelR`+_p+"C"+(vp+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+_p+"C"+(vp+1)+" = xTexelR"+_p+"C"+(vp+2)+`;
                `}}else vp<gp&&(xp+=`
              if(xR >= 0 && xR < `+sp+`) {
            `,cp%2==1?(xp+=`
                xCOffset = xC + 1 - `+hp+`;
                if(xCOffset >= 0 && xCOffset < `+lp+`) {
                  xTexelR`+_p+"C"+vp+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+_p+"C"+vp+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+lp+`) {
                  xTexelR`+_p+"C"+(vp+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+_p+"C"+(vp+2)+` = vec4(0.);
                }

                xR`+_p+"C"+vp+` = vec4(
                  xTexelR`+_p+"C"+vp+".zw, xTexelR"+_p+"C"+(vp+2)+`.zw);
              `,vp+1<gp&&(xp+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+hp+`;
                  if(xCOffset >= 0 && xCOffset < `+lp+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+_p+"C"+(vp+1)+" = vec4(xTexelR"+_p+"C"+(vp+2)+`.xy, final.xy);
                `)):(xp+=`
                if(xC >= 0 && xC < `+lp+`) {
                  xTexelR`+_p+"C"+vp+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+_p+"C"+vp+` = vec4(0.);
                }

                xCOffset = xC + `+hp+`;
                if(xCOffset >= 0 && xCOffset < `+lp+`) {
                  xTexelR`+_p+"C"+(vp+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+_p+"C"+(vp+2)+` = vec4(0.);
                }

                xR`+_p+"C"+vp+` = vec4(
                  xTexelR`+_p+"C"+vp+".xy, xTexelR"+_p+"C"+(vp+2)+`.xy);
              `,vp+1<gp&&(xp+=`
                  xR`+_p+"C"+(vp+1)+` = vec4(
                    xTexelR`+_p+"C"+vp+".zw, xTexelR"+_p+"C"+(vp+2)+`.zw);
                `)),xp+="}");vp<gp&&(xp+=`
            vec4 wTexelR`+_p+"C"+vp+" = getW("+_p+", "+vp+`, d1, q);
            wR`+_p+"C"+vp+" = vec4(wTexelR"+_p+"C"+vp+".xz, wTexelR"+_p+"C"+vp+`.xz);
          `,vp+1<gp&&(xp+=`
              vec4 wTexelR`+_p+"C"+(vp+1)+" = getW("+_p+", "+(vp+1)+`, d1, q);
              wR`+_p+"C"+(vp+1)+` =
                vec4(wTexelR`+_p+"C"+(vp+1)+".xz, wTexelR"+_p+"C"+(vp+1)+".xz);"))}for(_p=0;_p<mp;_p++)for(vp=0;vp<gp;vp++)xp+="dotProd += xR"+_p+"C"+vp+" * wR"+_p+"C"+vp+";";var Sp="",Ap="";np&&(Sp=ap?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+np+`
        }`:`vec4 activation(vec4 x) {
          `+np+`
        }`,Ap="result = activation(result);");var Rp=_d?"result += getBiasAtOutCoords();":"";_d&&this.variableNames.push("bias"),ap&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+Sp+`

      const ivec2 strides = ivec2(`+dp+", "+hp+`);
      const ivec2 pads = ivec2(`+up+", "+cp+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+xp+`

        vec4 result = dotProd;
        `+Rp+`
        `+Ap+`
        setOutput(result);
      }
    `}}(),Wa=function(){return function(rp,_d,np,ap,sp){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var lp=rp[0],up=rp[1],cp=rp[2],dp=rp[3],hp=_d[0],fp=np[0],pp=np[1];this.outputShape=[hp,fp,pp,dp];var mp=ap==="bilinear"?1:0,gp=[up-1+".0",cp-1+".0"],yp=gp[0],xp=gp[1],_p=fp>1?[""+(up-1)/(fp-1),"(y2-y1) * height_ratio","y1*"+yp+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+yp],vp=_p[0],bp=_p[1],Ep=_p[2],Sp=pp>1?[""+(cp-1)/(pp-1),"(x2-x1) * width_ratio","x1*"+xp+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+xp],Ap=Sp[0],Rp=Sp[1],Tp=Sp[2];this.userCode=`
      const float height_ratio = float(`+vp+`);
      const float width_ratio = float(`+Ap+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+lp+`) {
          return;
        }

        float height_scale = `+bp+`;
        float width_scale = `+Rp+`;

        float in_y = `+Ep+`;
        if( in_y < 0.0 || in_y > `+yp+` ) {
          setOutput(float(`+sp+`));
          return;
        }
        float in_x = `+Tp+`;
        if( in_x < 0.0 || in_x > `+xp+` ) {
          setOutput(float(`+sp+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+mp+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}(),Ua=function(){return function(rp,_d,np){this.variableNames=["x"],this.outputShape=rp;var ap=rp.length,sp=rp[rp.length-1],lp=np?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(np?"return "+sp+" -i - 1;":"return i;")+`
      }

      void main() {
        `+aa(ap)+` coords = getOutputCoords();
        int end = `+Va(ap,"coords")+`;
        float val = 0.0;
        for (int i = `+sp+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+lp+` end) {
            continue;
          }
          if (idx == end && `+_d+`) {
            continue;
          }
          `+Va(ap,"coords")+` = idx;
          val += getX(`+function(up,cp){if(up===1)return""+cp;if(up===2)return cp+".x, "+cp+".y";if(up===3)return cp+".x, "+cp+".y, "+cp+".z";if(up===4)return cp+".x, "+cp+".y, "+cp+".z, "+cp+".w";throw Error("Cumulative sum for rank "+up+" is not yet supported")}(ap,"coords")+`);
        }
        setOutput(val);
      }
    `}}();function Va(rp,_d){if(rp===1)return""+_d;if(rp===2)return _d+".y";if(rp===3)return _d+".z";if(rp===4)return _d+".w";throw Error("Cumulative sum for rank "+rp+" is not yet supported")}var za=function(){return function(rp){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=_t.DENSE;var _d=Gt(rp),np=Ko();this.outputShape=rp,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+jo(["r","c","d"],rp)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+_d[0]+", "+_d[1]+`));
        int index = 4 * (resTexRC.x * `+_d[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+np.output+` = result;
      }
    `}}(),Ga=function(){return function(rp){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=_t.DENSE;var _d=Gt(rp),np=Ko();this.outputShape=rp,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+jo(["r","c","d"],rp)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+_d[0]+", "+_d[1]+`));
        int index = 4 * (resTexRC.x * `+_d[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+np.output+` = result;
      }
    `}}(),Ha=function(){function rp(_d,np,ap){this.variableNames=["x"],this.outputShape=[],this.outputShape=_d,this.blockSize=np,this.dataFormat=ap,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+np+`;
      int offset_h = imod(h, `+np+`);
      int in_w = w / `+np+`;
      int offset_w = imod(w, `+np+`);
      int offset_d = (offset_h * `+np+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return rp.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},rp.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},rp.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},rp.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},rp.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},rp}(),qa=function(){return function(rp){this.variableNames=["X"],this.outputShape=[rp,rp],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}(),Ka=function(){return function(rp){this.variableNames=["A"],this.outTexUsage=Mt.DOWNLOAD;var _d=Ko();this.outputShape=rp,this.userCode=`
      `+$o+`

      void main() {
        float x = getAAtOutCoords();
        `+_d.output+` = encode_float(x);
      }
    `}}(),ja=function(){return function(rp){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Mt.DOWNLOAD;var _d=Ko();this.outputShape=rp,this.userCode=`
      `+$o+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+_d.output+` = encode_float(x);
      }
    `}}(),Xa=function(){return function(rp,_d,np){np===void 0&&(np=!1),this.variableNames=["A"];var ap=Ko(),sp=_d[0],lp=_d[1];this.outputShape=rp;var up="result";np&&(up="floor(result * 255. + 0.5)"),this.userCode=`
      `+Xo(rp)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+lp+`;
        int c = imod(flatIndex, `+lp+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+lp+".0, "+sp+`.0);
        vec4 values = `+ap.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+ap.output+" = vec4("+up+`, 0., 0., 0.);
      }
    `}}(),$a=function(){return function(rp,_d,np){np===void 0&&(np=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var ap=Ko(),sp=_d[0],lp=_d[1];this.outputShape=rp;var up="",cp="result";np&&(cp="floor(result * 255. + 0.5)");for(var dp=0;dp<=1;dp++)for(var hp=0;hp<=1;hp++){var fp=2*dp+hp;up+=`
          localCoords = coords;
          if(localCoords[2] + `+hp+" < "+rp[2]+`) {
            localCoords[2] += `+hp+`;
            if(localCoords[1] + `+dp+" < "+rp[1]+`) {
              localCoords[1] += `+dp+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+lp+`;
              c = imod(flatIndex, `+lp+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+lp+".0, "+sp+`.0);
              values = `+ap.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+fp+`] = values[0];
              } else if(offset == 1) {
                result[`+fp+`] = values[1];
              } else if(offset == 2) {
                result[`+fp+`] = values[2];
              } else {
                result[`+fp+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Xo(rp)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+up+`

        `+ap.output+" = "+cp+`;
      }
    `}}(),Ya="return real * expR - imag * expI;",Qa="return real * expI + imag * expR;",Ja=function(){return function(rp,_d,np){this.variableNames=["real","imag"];var ap=_d[1];this.outputShape=_d;var sp=np?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,lp=np?ap+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+sp+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+rp+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+ap+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+ap+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+lp+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}(),Za=function(){function rp(_d,np){this.outputShape=[],this.variableNames=["x"],this.outputShape=_d,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return rp.prototype.getCustomSetupFunc=function(_d){var np=this;return function(ap,sp){np.valueLoc==null&&(np.valueLoc=ap.getUniformLocationNoThrow(sp,"value")),ap.gl.uniform1f(np.valueLoc,_d)}},rp}(),ti=function(){return function(rp){this.variableNames=["A"];var _d=Ko(),np=rp[0],ap=rp[1];this.outputShape=rp,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+ap+".0, "+np+`.0);

        vec4 values = `+_d.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}(),ei=function(){return function(rp){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var _d=Ko(),np=rp[0],ap=rp[1];this.outputShape=rp,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+ap+".0, "+np+`.0);
            vec4 values = `+_d.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+_d.output+` = result;
      }
    `}}(),ni=function(){return function(rp,_d,np){this.variableNames=["A","indices"];var ap=rp.slice();ap[np]=_d,this.outputShape=ap,this.rank=ap.length;var sp=aa(this.rank),lp=function(up,cp){var dp=up.length;if(dp>4)throw Error("Gather for rank "+dp+" is not yet supported");if(dp===1)return"int(getIndices(resRC))";for(var hp=["resRC.x","resRC.y","resRC.z","resRC.w"],fp=[],pp=0;pp<up.length;pp++)pp===cp?fp.push("int(getIndices("+hp[pp]+"))"):fp.push(""+hp[pp]);return fp.join()}(rp,np);this.userCode=`
      void main() {
        `+sp+` resRC = getOutputCoords();
        setOutput(getA(`+lp+`));
      }
    `}}(),ri=function(){return function(rp,_d,np){this.sliceDim=rp,this.strides=_d,this.variableNames=["x","indices"],this.outputShape=np;var ap=aa(_d.length),sp=aa(np.length),lp=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+ap+" strides = "+ap+"("+this.strides+`);
         void main() {
          `+sp+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+lp+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}}();function oi(rp,_d){var np=Ko();return Jt(rp,_d,np.version+`
    precision highp float;
    `+np.attribute+` vec3 clipSpacePos;
    `+np.attribute+` vec2 uv;
    `+np.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function ai(rp,_d){return ie(rp,_d,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function ii(rp,_d){return ue(rp,_d,new Uint16Array([0,1,2,2,1,3]))}function ui(rp,_d,np,ap,sp,lp,up){ce(np,ap);var cp=se(rp,_d),dp=rp.TEXTURE_2D;return Kt(rp,_d,function(){return rp.bindTexture(dp,cp)}),Kt(rp,_d,function(){return rp.texParameteri(dp,rp.TEXTURE_WRAP_S,rp.CLAMP_TO_EDGE)}),Kt(rp,_d,function(){return rp.texParameteri(dp,rp.TEXTURE_WRAP_T,rp.CLAMP_TO_EDGE)}),Kt(rp,_d,function(){return rp.texParameteri(dp,rp.TEXTURE_MIN_FILTER,rp.NEAREST)}),Kt(rp,_d,function(){return rp.texParameteri(dp,rp.TEXTURE_MAG_FILTER,rp.NEAREST)}),Kt(rp,_d,function(){return rp.texImage2D(dp,0,sp,np,ap,0,lp,up,null)}),Kt(rp,_d,function(){return rp.bindTexture(rp.TEXTURE_2D,null)}),cp}function si(rp,_d,np,ap,sp){var lp=zt(np,ap);return ui(rp,_d,lp[0],lp[1],sp.internalFormatFloat,sp.textureFormatFloat,rp.FLOAT)}function ci(rp,_d,np,ap,sp){var lp=zt(np,ap);return ui(rp,_d,lp[0],lp[1],sp.internalFormatHalfFloat,sp.textureFormatFloat,sp.textureTypeHalfFloat)}function li(rp,_d,np,ap,sp){var lp=zt(np,ap);return ui(rp,_d,lp[0],lp[1],rp.RGBA,rp.RGBA,rp.UNSIGNED_BYTE)}function hi(rp,_d,np,ap,sp){var lp=Ht(np,ap);return ui(rp,_d,lp[0],lp[1],sp.internalFormatPackedFloat,rp.RGBA,rp.FLOAT)}function fi(rp,_d,np,ap,sp){var lp=Ht(np,ap);return ui(rp,_d,lp[0],lp[1],sp.internalFormatPackedHalfFloat,rp.RGBA,sp.textureTypeHalfFloat)}function pi(rp,_d,np,ap){return Kt(rp,_d,function(){return rp.bindBuffer(rp.ARRAY_BUFFER,ap)}),he(rp,_d,np,"clipSpacePos",ap,3,20,0)&&he(rp,_d,np,"uv",ap,2,20,12)}function di(rp,_d,np,ap,sp,lp,up){var cp,dp,hp;Kt(rp,_d,function(){return rp.bindTexture(rp.TEXTURE_2D,np)}),lp instanceof Uint8Array?(cp=new Uint8Array(ap*sp*4),dp=rp.UNSIGNED_BYTE,hp=rp.RGBA):(cp=new Float32Array(ap*sp*4),dp=rp.FLOAT,hp=up.internalFormatPackedFloat),cp.set(lp),Kt(rp,_d,function(){return rp.texImage2D(rp.TEXTURE_2D,0,hp,ap,sp,0,rp.RGBA,dp,cp)}),Kt(rp,_d,function(){return rp.bindTexture(rp.TEXTURE_2D,null)})}function vi(rp,_d,np,ap){Kt(rp,_d,function(){return rp.bindTexture(rp.TEXTURE_2D,np)}),ap.data instanceof Uint8Array?Kt(rp,_d,function(){return rp.texImage2D(rp.TEXTURE_2D,0,rp.RGBA,ap.width,ap.height,0,rp.RGBA,rp.UNSIGNED_BYTE,ap.data)}):Kt(rp,_d,function(){return rp.texImage2D(rp.TEXTURE_2D,0,rp.RGBA,rp.RGBA,rp.UNSIGNED_BYTE,ap)}),Kt(rp,_d,function(){return rp.bindTexture(rp.TEXTURE_2D,null)})}function mi(rp,_d,np,ap,sp){var lp=rp.createBuffer();Kt(rp,_d,function(){return rp.bindBuffer(rp.PIXEL_PACK_BUFFER,lp)});var up=16*np*ap;return Kt(rp,_d,function(){return rp.bufferData(rp.PIXEL_PACK_BUFFER,up,rp.STREAM_READ)}),Kt(rp,_d,function(){return rp.readPixels(0,0,ap,np,rp.RGBA,rp.FLOAT,0)}),Kt(rp,_d,function(){return rp.bindBuffer(rp.PIXEL_PACK_BUFFER,null)}),lp}function gi(rp,_d,np){var ap=rp,sp=new Float32Array(np);return ap.bindBuffer(ap.PIXEL_PACK_BUFFER,_d),ap.getBufferSubData(ap.PIXEL_PACK_BUFFER,0,sp),ap.bindBuffer(ap.PIXEL_PACK_BUFFER,null),sp}function yi(rp,_d,np,ap,sp){var lp=zt(np,ap),up=lp[0],cp=lp[1],dp=new Uint8Array(np*ap*4);return Kt(rp,_d,function(){return rp.readPixels(0,0,up,cp,sp.downloadTextureFormat,rp.UNSIGNED_BYTE,dp)}),new Float32Array(dp.buffer)}function xi(rp,_d,np,ap,sp,lp,up,cp){var dp=rp,hp=new Float32Array(function(fp,pp){var mp=Ht(fp,pp);return mp[0]*mp[1]*4}(lp,up));return dp.bindBuffer(dp.PIXEL_PACK_BUFFER,_d),dp.getBufferSubData(dp.PIXEL_PACK_BUFFER,0,hp),dp.bindBuffer(dp.PIXEL_PACK_BUFFER,null),hp}function bi(rp,_d,np,ap){var sp=new Float32Array(np*ap*4);return Kt(rp,_d,function(){return rp.readPixels(0,0,ap,np,rp.RGBA,rp.FLOAT,sp)}),sp}var wi=Object.freeze({createVertexShader:oi,createVertexBuffer:ai,createIndexBuffer:ii,createFloat32MatrixTexture:si,createFloat16MatrixTexture:ci,createUnsignedBytesMatrixTexture:li,createPackedMatrixTexture:hi,createFloat16PackedMatrixTexture:fi,bindVertexProgramAttributeStreams:pi,uploadDenseMatrixToTexture:di,uploadPixelDataToTexture:vi,createBufferFromOutputTexture:mi,downloadFloat32MatrixFromBuffer:gi,downloadByteEncodedFloatMatrixFromOutputTexture:yi,downloadPackedMatrixFromBuffer:xi,downloadMatrixFromPackedOutputTexture:bi}),Ci=function(){function rp(_d){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var np=a$1().getNumber("WEBGL_VERSION");if(_d!=null?(this.gl=_d,Wt(np,_d)):this.gl=Ut(np),a$1().getNumber("WEBGL_VERSION")===1)this.textureFloatExtension=Qt(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=Qt(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(Ne(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!Ne(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=ai(this.gl,this.debug),this.indexBuffer=ii(this.gl,this.debug),this.framebuffer=le(this.gl,this.debug),this.textureConfig=qt(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(rp.prototype,"debug",{get:function(){return a$1().getBool("DEBUG")},enumerable:!0,configurable:!0}),rp.prototype.dispose=function(){var _d=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var np=this.gl;Kt(np,this.debug,function(){return np.finish()}),Kt(np,this.debug,function(){return np.bindFramebuffer(np.FRAMEBUFFER,null)}),Kt(np,this.debug,function(){return np.deleteFramebuffer(_d.framebuffer)}),Kt(np,this.debug,function(){return np.bindBuffer(np.ARRAY_BUFFER,null)}),Kt(np,this.debug,function(){return np.bindBuffer(np.ELEMENT_ARRAY_BUFFER,null)}),Kt(np,this.debug,function(){return np.deleteBuffer(_d.indexBuffer)}),this.disposed=!0}},rp.prototype.createFloat32MatrixTexture=function(_d,np){return this.throwIfDisposed(),si(this.gl,this.debug,_d,np,this.textureConfig)},rp.prototype.createFloat16MatrixTexture=function(_d,np){return this.throwIfDisposed(),ci(this.gl,this.debug,_d,np,this.textureConfig)},rp.prototype.createUnsignedBytesMatrixTexture=function(_d,np){return this.throwIfDisposed(),li(this.gl,this.debug,_d,np,this.textureConfig)},rp.prototype.uploadPixelDataToTexture=function(_d,np){this.throwIfDisposed(),vi(this.gl,this.debug,_d,np)},rp.prototype.uploadDenseMatrixToTexture=function(_d,np,ap,sp){this.throwIfDisposed(),di(this.gl,this.debug,_d,np,ap,sp,this.textureConfig)},rp.prototype.createFloat16PackedMatrixTexture=function(_d,np){return this.throwIfDisposed(),fi(this.gl,this.debug,_d,np,this.textureConfig)},rp.prototype.createPackedMatrixTexture=function(_d,np){return this.throwIfDisposed(),hi(this.gl,this.debug,_d,np,this.textureConfig)},rp.prototype.deleteMatrixTexture=function(_d){var np=this;this.throwIfDisposed(),this.outputTexture===_d&&(ge(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Kt(this.gl,this.debug,function(){return np.gl.deleteTexture(_d)})},rp.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(_d,np,ap){var sp=this;return this.downloadMatrixDriver(_d,function(){return yi(sp.gl,sp.debug,np,ap,sp.textureConfig)})},rp.prototype.downloadPackedMatrixFromBuffer=function(_d,np,ap,sp,lp,up){return xi(this.gl,_d,0,0,0,lp,up,this.textureConfig)},rp.prototype.downloadFloat32MatrixFromBuffer=function(_d,np){return gi(this.gl,_d,np)},rp.prototype.createBufferFromTexture=function(_d,np,ap){this.bindTextureToFrameBuffer(_d);var sp=mi(this.gl,this.debug,np,ap,this.textureConfig);return this.unbindTextureToFrameBuffer(),sp},rp.prototype.createAndWaitForFence=function(){var _d=this.createFence(this.gl);return this.pollFence(_d)},rp.prototype.createFence=function(_d){var np,ap,sp=this;if(a$1().getBool("WEBGL_FENCE_API_ENABLED")){var lp=_d,up=lp.fenceSync(lp.SYNC_GPU_COMMANDS_COMPLETE,0);_d.flush(),ap=function(){var cp=lp.clientWaitSync(up,0,0);return cp===lp.ALREADY_SIGNALED||cp===lp.CONDITION_SATISFIED},np=up}else a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(np=this.beginQuery(),this.endQuery(),ap=function(){return sp.isQueryAvailable(np,a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):ap=function(){return!0};return{query:np,isFencePassed:ap}},rp.prototype.downloadMatrixFromPackedTexture=function(_d,np,ap){var sp=this;return this.downloadMatrixDriver(_d,function(){return bi(sp.gl,sp.debug,np,ap)})},rp.prototype.createProgram=function(_d){this.throwIfDisposed();var np=this.gl,ap=Zt(np,this.debug,_d),sp=oi(np,this.debug),lp=re$2(np,this.debug);return Kt(np,this.debug,function(){return np.attachShader(lp,sp)}),Kt(np,this.debug,function(){return np.attachShader(lp,ap)}),oe(np,this.debug,lp),this.debug&&ae(np,this.debug,lp),this.vertexAttrsAreBound||(this.setProgram(lp),this.vertexAttrsAreBound=pi(np,this.debug,this.program,this.vertexBuffer)),lp},rp.prototype.deleteProgram=function(_d){var np=this;this.throwIfDisposed(),_d===this.program&&(this.program=null),_d!=null&&Kt(this.gl,this.debug,function(){return np.gl.deleteProgram(_d)})},rp.prototype.setProgram=function(_d){var np=this;this.throwIfDisposed(),this.program=_d,this.program!=null&&this.debug&&ae(this.gl,this.debug,this.program),Kt(this.gl,this.debug,function(){return np.gl.useProgram(_d)})},rp.prototype.getUniformLocation=function(_d,np,ap){return ap===void 0&&(ap=!0),this.throwIfDisposed(),ap?pe(this.gl,this.debug,_d,np):de(this.gl,_d,np)},rp.prototype.getAttributeLocation=function(_d,np){var ap=this;return this.throwIfDisposed(),Kt(this.gl,this.debug,function(){return ap.gl.getAttribLocation(_d,np)})},rp.prototype.getUniformLocationNoThrow=function(_d,np){return this.throwIfDisposed(),this.gl.getUniformLocation(_d,np)},rp.prototype.setInputMatrixTexture=function(_d,np,ap){this.throwIfDisposed(),this.throwIfNoProgram(),ve(this.gl,this.debug,this.program,_d,np,ap)},rp.prototype.setOutputMatrixTexture=function(_d,np,ap){this.setOutputMatrixTextureDriver(_d,ap,np)},rp.prototype.setOutputPackedMatrixTexture=function(_d,np,ap){this.throwIfDisposed();var sp=Ht(np,ap),lp=sp[0],up=sp[1];this.setOutputMatrixTextureDriver(_d,lp,up)},rp.prototype.setOutputMatrixWriteRegion=function(_d,np,ap,sp){this.setOutputMatrixWriteRegionDriver(ap,_d,sp,np)},rp.prototype.setOutputPackedMatrixWriteRegion=function(_d,np,ap,sp){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},rp.prototype.debugValidate=function(){this.program!=null&&ae(this.gl,this.debug,this.program),ye(this.gl)},rp.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var _d=this.gl;this.debug&&this.debugValidate(),Kt(_d,this.debug,function(){return _d.drawElements(_d.TRIANGLES,6,_d.UNSIGNED_SHORT,0)})},rp.prototype.blockUntilAllProgramsCompleted=function(){var _d=this;this.throwIfDisposed(),Kt(this.gl,this.debug,function(){return _d.gl.finish()})},rp.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Qt(this.gl,this.debug,a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},rp.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},rp.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},rp.prototype.beginQuery=function(){if(a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var _d=this.gl,np=this.getQueryTimerExtensionWebGL2(),ap=_d.createQuery();return _d.beginQuery(np.TIME_ELAPSED_EXT,ap),ap}var sp=this.getQueryTimerExtensionWebGL1(),lp=sp.createQueryEXT();return sp.beginQueryEXT(sp.TIME_ELAPSED_EXT,lp),lp},rp.prototype.endQuery=function(){if(a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var _d=this.getQueryTimerExtensionWebGL1();_d.endQueryEXT(_d.TIME_ELAPSED_EXT)}else{var np=this.gl,ap=this.getQueryTimerExtensionWebGL2();np.endQuery(ap.TIME_ELAPSED_EXT)}},rp.prototype.waitForQueryAndGetTime=function(_d){return n$1(this,void 0,void 0,function(){var np=this;return r(this,function(ap){switch(ap.label){case 0:return[4,S(function(){return np.disposed||np.isQueryAvailable(_d,a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return ap.sent(),[2,this.getQueryTime(_d,a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},rp.prototype.getQueryTime=function(_d,np){if(np===0)return null;if(np===2){var ap=this.gl;return ap.getQueryParameter(_d,ap.QUERY_RESULT)/1e6}var sp=this.getQueryTimerExtensionWebGL1();return sp.getQueryObjectEXT(_d,sp.QUERY_RESULT_EXT)/1e6},rp.prototype.isQueryAvailable=function(_d,np){if(np===0)return!0;if(np===2){var ap=this.gl,sp=this.getQueryTimerExtensionWebGL2(),lp=ap.getQueryParameter(_d,ap.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(sp.GPU_DISJOINT_EXT)),lp&&!this.disjoint}return lp=(sp=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(_d,sp.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(sp.GPU_DISJOINT_EXT)),lp&&!this.disjoint},rp.prototype.pollFence=function(_d){var np=this;return new Promise(function(ap){np.addItemToPoll(function(){return _d.isFencePassed()},function(){return ap()})})},rp.prototype.pollItems=function(){for(var _d=function(ap){for(var sp=0;sp<ap.length;++sp){var lp=ap[sp]();if(!lp)break}return sp-1}(this.itemsToPoll.map(function(ap){return ap.isDoneFn})),np=0;np<=_d;++np)(0,this.itemsToPoll[np].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(_d+1)},rp.prototype.addItemToPoll=function(_d,np){var ap=this;this.itemsToPoll.push({isDoneFn:_d,resolveFn:np}),this.itemsToPoll.length>1||S(function(){return ap.pollItems(),ap.itemsToPoll.length===0})},rp.prototype.bindTextureToFrameBuffer=function(_d){this.throwIfDisposed(),me(this.gl,this.debug,_d,this.framebuffer),this.debug&&ye(this.gl)},rp.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(me(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&ye(this.gl)):ge(this.gl,this.debug,this.framebuffer)},rp.prototype.downloadMatrixDriver=function(_d,np){this.bindTextureToFrameBuffer(_d);var ap=np();return this.unbindTextureToFrameBuffer(),ap},rp.prototype.setOutputMatrixTextureDriver=function(_d,np,ap){this.throwIfDisposed();var sp=this.gl;me(sp,this.debug,_d,this.framebuffer),this.debug&&ye(sp),this.outputTexture=_d,Kt(sp,this.debug,function(){return sp.viewport(0,0,np,ap)}),Kt(sp,this.debug,function(){return sp.scissor(0,0,np,ap)})},rp.prototype.setOutputMatrixWriteRegionDriver=function(_d,np,ap,sp){var lp=this;this.throwIfDisposed(),Kt(this.gl,this.debug,function(){return lp.gl.scissor(_d,np,ap,sp)})},rp.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},rp.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},rp}();function Ei(rp,_d){if(rp.length!==_d.length)throw Error("Binary was compiled with "+rp.length+" inputs, but was executed with "+_d.length+" inputs");rp.forEach(function(np,ap){var sp=np.logicalShape,lp=_d[ap],up=lp.shape;if(!C(sp,up))throw Error("Binary was compiled with different shapes than the current args. Shapes "+sp+" and "+up+" must match");if(!np.isUniform||!lp.isUniform){var cp=np.texShape,dp=lp.isUniform?null:lp.texData.texShape;if(!C(cp,dp))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+cp+" and "+dp+" must match")}})}var Ri=function(){return function(rp,_d,np){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=rp;for(var ap=np.filterWidth,sp=np.inChannels,lp=np.strideWidth,up=np.strideHeight,cp=np.padInfo,dp=np.outWidth,hp=np.dilationWidth,fp=np.dilationHeight,pp=np.dataFormat,mp=cp.left,gp=cp.top,yp=sp*ap,xp=Ko(),_p=pp==="channelsLast",vp=_p?0:1,bp=_p?1:2,Ep="",Sp=0;Sp<=1;Sp++)for(var Ap=0;Ap<=1;Ap++)Ep+=`
          blockIndex = rc.y + `+Ap+`;
          pos = rc.x + `+Sp+`;

          if(blockIndex < `+rp[1]+" && pos < "+rp[0]+`) {
            offsetY = int(blockIndex / (`+dp+")) * "+up+" - "+gp+`;
            d0 = offsetY + `+fp+" * (pos / "+yp+`);

            if(d0 < `+_d[vp]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+dp+".) * "+lp+". - "+mp+`.);
              d1 = offsetX + `+hp+" * (int(mod(float(pos), "+yp+".) / "+sp+`.));

              if(d1 < `+_d[bp]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+sp+`.));

                if (`+_p+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*Sp+Ap)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*Sp+Ap)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+Ep+`

        `+xp.output+` = result;
      }
    `}}(),Ii=function(){return function(rp,_d,np,ap,sp){this.variableNames=["x"],this.outputShape=[];var lp,up=_d,cp=rp[3]-1;this.outputShape=rp;var dp="float("+np+") + float("+ap+") * sum";lp=sp===.5?"inversesqrt("+dp+")":sp===1?"1.0/("+dp+")":"exp(log("+dp+") * float(-"+sp+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+up+"; j <= "+up+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+cp+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+lp+`;
        setOutput(val);
      }
    `}}(),ki=function(){return function(rp,_d,np,ap,sp){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=rp,this.depth=rp[3],this.depthRadius=_d,this.bias=np,this.alpha=ap,this.beta=sp,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+_d+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+_d+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+ap+") * norm + float("+np+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+ap+`)
                * float(`+sp+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+sp+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}(),Si=function(){return function(rp,_d,np,ap,sp){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var lp,up=_d,cp=rp[3]-1;this.outputShape=rp;var dp="float("+np+") + float("+ap+") * sum";lp=sp===.5?"inversesqrt("+dp+")":sp===1?"1.0/("+dp+")":"exp(log("+dp+") * float(-"+sp+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+up+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+up+"; j <= "+up+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+cp+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+lp+`;
        setOutput(result);
      }
    `}}(),Ai=function(){return function(rp){this.variableNames=["dy","maxPos"],this.outputShape=rp.inShape;var _d=rp.strideHeight,np=rp.strideWidth,ap=rp.dilationHeight,sp=rp.effectiveFilterHeight,lp=rp.effectiveFilterWidth,up=sp-1-rp.padInfo.top,cp=lp-1-rp.padInfo.left,dp=sp*lp-1;this.userCode=`
      const ivec2 pads = ivec2(`+up+", "+cp+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+sp+`;
          wR += `+ap+`) {
          float dyR = float(dyRCorner + wR) / `+_d+`.0;

          if (dyR < 0.0 || dyR >= `+rp.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+lp+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+np+`.0;

            if (dyC < 0.0 || dyC >= `+rp.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+dp+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+lp+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}(),Di=function(){return function(rp){this.variableNames=["dy","maxPos"],this.outputShape=rp.inShape;var _d=rp.strideDepth,np=rp.strideHeight,ap=rp.strideWidth,sp=rp.dilationDepth,lp=rp.dilationHeight,up=rp.dilationWidth,cp=rp.effectiveFilterDepth,dp=rp.effectiveFilterHeight,hp=rp.effectiveFilterWidth,fp=cp-1-rp.padInfo.front,pp=dp-1-rp.padInfo.top,mp=hp-1-rp.padInfo.left,gp=cp*dp*hp-1;this.userCode=`
      const ivec3 pads = ivec3(`+fp+", "+pp+", "+mp+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+cp+`;
           wD += `+sp+`) {
          float dyD = float(dyDCorner + wD) / `+_d+`.0;

          if (dyD < 0.0 || dyD >= `+rp.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+dp+`;
              wR += `+lp+`) {
            float dyR = float(dyRCorner + wR) / `+np+`.0;

            if (dyR < 0.0 || dyR >= `+rp.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+hp+`;
                wC += `+up+`) {
              float dyC = float(dyCCorner + wC) / `+ap+`.0;

              if (dyC < 0.0 || dyC >= `+rp.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+gp+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+dp+" * "+hp+` +
                  wR * `+hp+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),Ti=function(){return function(rp,_d,np,ap,sp,lp,up){np===void 0&&(np=!1),ap===void 0&&(ap=!1),sp===void 0&&(sp=!1),lp===void 0&&(lp=null),up===void 0&&(up=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_d;var cp=np?rp[1]:rp[2],dp=Math.ceil(cp/2),hp=np?"i * 2, rc.y":"rc.y, i * 2",fp=ap?"rc.z, i * 2":"i * 2, rc.z",pp=np?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],mp=ap?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],gp="",yp="";lp&&(gp=up?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+lp+`
        }`:`vec4 activation(vec4 x) {
          `+lp+`
        }`,yp="result = activation(result);");var xp=sp?"result += getBiasAtOutCoords();":"";sp&&this.variableNames.push("bias"),up&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+gp+`

      const float sharedDimension = `+dp+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+dp+`; i++) {
          vec4 a = getMatrixA(rc.x, `+hp+`);
          vec4 b = getMatrixB(rc.x, `+fp+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+pp[0]+" * "+mp[0]+`);
          result += (`+pp[1]+" * "+mp[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+xp+`

        `+yp+`

        setOutput(result);
      }
    `}}(),Ni=function(){function rp(_d,np,ap){this.variableNames=["probs"],this.outputShape=[_d,ap],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(np-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(np-1)+`));
      }
    `}return rp.prototype.getCustomSetupFunc=function(_d){var np=this;return function(ap,sp){np.seedLoc==null&&(np.seedLoc=ap.getUniformLocation(sp,"seed")),ap.gl.uniform1f(np.seedLoc,_d)}},rp}(),Fi=function(){return function(rp,_d,np,ap){this.variableNames=["indices"],this.outputShape=[rp,_d],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+ap+"), float("+np+`),
                      float(index == coords.y)));
      }
    `}}(),Oi=function(){return function(rp){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=rp;var _d=rp.length;if(_d===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var np=qo("rc",_d),ap=aa(_d),sp=function(cp,dp,hp){if(cp===1)return"rc > "+dp[0];for(var fp="",pp=cp-2;pp<cp;pp++)fp+=hp[pp]+" >= "+dp[pp],pp<cp-1&&(fp+="||");return fp}(_d,rp,np),lp=function(cp,dp,hp,fp){if(cp===1)return"";var pp=fp.slice(-2);return`
    int r = `+pp[0]+`;
    int c = `+pp[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+dp+`;
    bool rEdge = rp1 >= `+hp+`;
  `}(_d,rp[rp.length-1],rp[rp.length-2],np),up=function(cp,dp){var hp=cp.length,fp=function(pp,mp){for(var gp=[],yp=0;yp<=1;yp++)for(var xp=0;xp<=1;xp++){for(var _p=(yp===0?"r":"rp1")+", "+(xp===0?"c":"cp1"),vp=2;vp<pp;vp++)_p=mp[mp.length-1-vp]+","+_p;gp.push(_p)}return gp}(hp,dp);return hp===1?`getA(rc),
            rc + 1 >= `+cp[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+fp[0]+`),
          cEdge ? 0. : getA(`+fp[1]+`),
          rEdge ? 0. : getA(`+fp[2]+`),
          rEdge || cEdge ? 0. : getA(`+fp[3]+")"}(rp,np);this.userCode=`
        void main() {
          `+ap+` rc = getOutputCoords();

          if(`+sp+`) {
            setOutput(vec4(0));
          } else {
            `+lp+`

            setOutput(vec4(`+up+`));
          }
        }
      `}}}(),_i=function(){return function(rp,_d,np){this.variableNames=["x"],this.outputShape=_d.map(function(dp,hp){return dp[0]+rp[hp]+dp[1]});var ap=rp.length,sp=aa(ap),lp=_d.map(function(dp){return dp[0]}).join(","),up=_d.map(function(dp,hp){return dp[0]+rp[hp]}).join(","),cp=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,ap);this.userCode=ap!==1?`
      `+sp+" start = "+sp+"("+lp+`);
      `+sp+" end = "+sp+"("+up+`);

      void main() {
        `+sp+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+np+`));
        } else {
          `+sp+` coords = outC - start;
          setOutput(getX(`+cp+`));
        }
      }
    `:`
        int start = `+lp+`;
        int end = `+up+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+np+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `}}(),Mi=function(){return function(rp,_d,np){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_d.map(function(_p,vp){return _p[0]+rp[vp]+_p[1]});for(var ap=rp.length,sp=aa(ap),lp=_d.map(function(_p){return _p[0]}).join(","),up=_d.map(function(_p,vp){return _p[0]+rp[vp]}).join(","),cp=qo("rc",ap),dp=qo("source",ap),hp=cp[ap-1]+" < "+this.outputShape[ap-1],fp=ap===1?"source":"vec2("+dp.slice(-2).join()+")",pp=[sp+" rc = outputLoc;",cp[ap-1]+` += 1;
       if(`+hp+`) {
      `,ap===1?"":`}
       rc = outputLoc;
       `+cp[ap-2]+` += 1;
       if(`+cp[ap-2]+" < "+this.outputShape[ap-2]+") {",ap===1?"":"  "+cp[ap-1]+` += 1;
         if(`+hp+") {"],mp=ap===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",gp="",yp=0,xp=ap===1?2:4;yp<xp;yp++)gp+=`
        `+pp[yp]+`
        if (`+mp+`) {
          result[`+yp+"] = float("+np+`);
        } else {
          `+sp+` source = rc - start;
          result[`+yp+"] = getChannel(getX("+dp.join()+"), "+fp+`);
        }
      `;gp+=ap===1?"} ":"}}",this.userCode=`
      const `+sp+" start = "+sp+"("+lp+`);
      const `+sp+" end = "+sp+"("+up+`);

      void main() {
        `+sp+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+gp+`
        setOutput(result);
      }
    `}}(),Bi=function(){return function(rp,_d,np){if(this.variableNames=["x"],_d==="avg"&&np)throw new Error("Cannot compute positions for average pool.");var ap=rp.filterWidth,sp=rp.strideHeight,lp=rp.strideWidth,up=rp.dilationHeight,cp=rp.dilationWidth,dp=rp.effectiveFilterHeight,hp=rp.effectiveFilterWidth,fp=rp.padInfo.top,pp=rp.padInfo.left;this.outputShape=rp.outShape;var mp=_d==="avg",gp="0.0";if(mp||(gp="-1.0 / 1e-20"),np)this.userCode=`
        const ivec2 strides = ivec2(`+sp+", "+lp+`);
        const ivec2 pads = ivec2(`+fp+", "+pp+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+dp+`;
              wR += `+up+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+rp.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+hp+`;
                wC += `+cp+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+rp.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+hp+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var yp=_d+"("+_d+"("+_d+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";_d==="avg"&&(yp="avgValue / count");var xp=4*Math.floor(ap/4),_p=ap%4,vp=`
      if (`+mp+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+sp+", "+lp+`);
      const ivec2 pads = ivec2(`+fp+", "+pp+`);
      const float initializationValue = `+gp+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+rp.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+gp+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+dp+`;
            wR += `+up+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+rp.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+xp+`; wC += 4) {
            int xC = xCCorner + wC * `+cp+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+cp+`, d),
              getValue(batch, xR, xC + 2 * `+cp+`, d),
              getValue(batch, xR, xC + 3 * `+cp+`, d)
            );

            `+vp+`
          }

          int xC = xCCorner + `+xp+`;
          if (`+(_p===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+vp+`
          } else if (`+(_p===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+cp+`, d),
              initializationValue,
              initializationValue
            );

            `+vp+`
          } else if (`+(_p===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+cp+`, d),
              getValue(batch, xR, xC + 2 * `+cp+`, d),
              initializationValue
            );

            `+vp+`
          }
        }
        setOutput(`+yp+`);
      }
    `}}}(),Pi=function(){return function(rp,_d,np){if(this.variableNames=["x"],_d==="avg"&&np)throw new Error("Cannot compute positions for average pool.");var ap=rp.filterWidth,sp=rp.strideDepth,lp=rp.strideHeight,up=rp.strideWidth,cp=rp.dilationDepth,dp=rp.dilationHeight,hp=rp.dilationWidth,fp=rp.effectiveFilterDepth,pp=rp.effectiveFilterHeight,mp=rp.effectiveFilterWidth,gp=rp.padInfo.front,yp=rp.padInfo.top,xp=rp.padInfo.left;this.outputShape=rp.outShape;var _p=_d==="avg",vp="0.0";if(_p||(vp="-1.0 / 1e-20"),np)this.userCode=`
        const ivec3 strides =
            ivec3(`+sp+", "+lp+", "+up+`);
        const ivec3 pads = ivec3(`+gp+", "+yp+", "+xp+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+fp+`;
              wD += `+cp+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+rp.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+pp+`;
                wR += `+dp+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+rp.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+mp+`;
                  wC += `+hp+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+rp.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+pp+" * "+mp+` +
                      wR * `+mp+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var bp=_d+"("+_d+"("+_d+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";_d==="avg"&&(bp="avgValue / count");var Ep=4*Math.floor(ap/4),Sp=ap%4,Ap=`
      if (`+_p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+sp+", "+lp+", "+up+`);
      const ivec3 pads = ivec3(`+gp+", "+yp+", "+xp+`);
      const float initializationValue = `+vp+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+rp.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+vp+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+fp+`;
            wD += `+cp+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+rp.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+pp+`;
            wR += `+dp+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+rp.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+Ep+`; wC += 4) {
              int xC = xCCorner + wC * `+hp+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+hp+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+hp+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+hp+`, ch)
              );

              `+Ap+`
            }

            int xC = xCCorner + `+Ep+`;
            if (`+(Sp===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+Ap+`
            } else if (`+(Sp===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+hp+`, ch),
                initializationValue,
                initializationValue
              );

              `+Ap+`
            } else if (`+(Sp===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+hp+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+hp+`, ch),
                initializationValue
              );

              `+Ap+`
            }
          }
          setOutput(`+bp+`);
        }
      }
    `}}}(),Li=function(){return function(rp,_d){this.variableNames=["x"];var np=rp.windowSize,ap=rp.batchSize,sp=rp.inSize,lp=Math.ceil(sp/np);this.outputShape=[ap,lp];var up="0.0",cp="";_d==="prod"?up="1.0":_d==="min"?(up="1.0 / 1e-20",cp="min"):_d==="max"&&(up="-1.0 / 1e-20",cp="max");var dp=_d+"("+_d+"("+_d+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";_d==="sum"?dp="sumValue":_d==="prod"?dp="prodValue":_d==="all"?dp="allValue":_d==="any"&&(dp="anyValue");var hp=4*Math.floor(np/4),fp=np%4,pp=`
      if (`+(_d==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(_d==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+cp+`(values, minMaxValue);
      }
    `,mp="vec4";_d==="all"?(up="1.0",pp=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,mp="bvec4"):_d==="any"&&(up="0.0",pp=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,mp="bvec4");var gp="";sp%np>0&&(gp=`
        if (inIdx < 0 || inIdx >= `+sp+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+up+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+gp+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+np+`;

        vec4 minMaxValue = vec4(`+up+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+hp+`; i += 4) {
          int inIdx = inOffset + i;
          `+mp+" values = "+mp+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+pp+`
        }

        int inIdx = inOffset + `+hp+`;
        if (`+(fp===1)+`) {
          `+mp+" values = "+mp+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+pp+`
        } else if (`+(fp===2)+`) {
          `+mp+" values = "+mp+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+pp+`
        } else if (`+(fp===3)+`) {
          `+mp+" values = "+mp+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+pp+`
        }
        setOutput(`+dp+`);
      }
    `}}(),Wi=function(){return function(rp,_d){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=rp;for(var np="",ap=0;ap<4;ap++){var sp="thisRC = rc;";ap%2==1&&(sp+="thisRC.z += 1;"),ap>1&&(sp+="thisRC.y += 1;"),np+=`
        `+sp+`
        `+(ap>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+ap+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(ap>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+jo(["r","c","d"],_d)+`
      return ivec3(r, c, d);
    }
  
      `+Xo(rp)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+rp[1]+`;
        int cols = `+rp[2]+`;

        `+np+`

        setOutput(result);
      }
    `}}(),Ui=function(){return function(rp,_d,np){this.variableNames=["dy"],this.outputShape=[],this.outputShape=_d.shape;var ap=_d.shape,sp=ap[1],lp=ap[2],up=rp.shape,cp=up[1],dp=up[2],hp=[np&&cp>1?sp-1:sp,np&&dp>1?lp-1:lp],fp=[np&&cp>1?cp-1:cp,np&&dp>1?dp-1:dp],pp=hp[0]/fp[0],mp=hp[1]/fp[1],gp=1/pp,yp=1/mp,xp=2*Math.ceil(gp)+2,_p=2*Math.ceil(yp)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+pp+`);
        const float widthScale = float(`+mp+`);

        const float invHeightScale = float(`+gp+`);
        const float invWidthScale = float(`+yp+`);

        const int winHeight = int(`+xp+`);
        const int winWidth = int(`+_p+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+cp+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+dp+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(sp-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(lp-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}(),Vi=function(){return function(rp,_d,np,ap){this.variableNames=["A"],this.outputShape=[];var sp=rp[0],lp=rp[1],up=rp[2],cp=rp[3];this.outputShape=[sp,_d,np,cp];var dp=[ap&&_d>1?lp-1:lp,ap&&np>1?up-1:up],hp=[ap&&_d>1?_d-1:_d,ap&&np>1?np-1:np];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+dp[0]/hp[0]+`,
          `+dp[1]/hp[1]+`);
      const vec2 inputShapeRC = vec2(`+lp+".0, "+up+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}(),zi=function(){return function(rp,_d,np,ap){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var sp=rp[0],lp=rp[1],up=rp[2],cp=rp[3];this.outputShape=[sp,_d,np,cp];var dp=[ap&&_d>1?lp-1:lp,ap&&np>1?up-1:up],hp=[ap&&_d>1?_d-1:_d,ap&&np>1?np-1:np];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+dp[0]/hp[0]+`,
          `+dp[1]/hp[1]+`,
          `+dp[1]/hp[1]+`);
      const vec3 inputShapeRC = vec3(`+lp+".0, "+up+`.0,
                                     `+up+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(cp-1)+`;
        bool hasNextRow = coords.z < `+(np-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}(),Gi=function(){return function(rp,_d,np){this.variableNames=["dy"],this.outputShape=[],this.outputShape=_d.shape;var ap=_d.shape,sp=ap[1],lp=ap[2],up=rp.shape,cp=up[1],dp=up[2],hp=[np&&cp>1?sp-1:sp,np&&dp>1?lp-1:lp],fp=[np&&cp>1?cp-1:cp,np&&dp>1?dp-1:dp],pp=hp[0]/fp[0],mp=hp[1]/fp[1],gp=1/pp,yp=1/mp,xp=2*Math.ceil(gp)+2,_p=2*Math.ceil(yp)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+pp+`);
        const float widthScale = float(`+mp+`);

        const float invHeightScale = float(`+gp+`);
        const float invWidthScale = float(`+yp+`);

        const int winHeight = int(`+xp+`);
        const int winWidth = int(`+_p+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+cp+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+dp+`) {
              continue;
            }

            float sourceFracRow =
              float(`+hp[0]+`) *
                (float(dyR) / float(`+fp[0]+`));

            float sourceFracCol =
                float(`+hp[1]+`) *
                  (float(dyC) / float(`+fp[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+sp+`) - 1),
                `+np+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+lp+`) - 1),
                `+np+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}(),Hi=function(){return function(rp,_d,np,ap){this.variableNames=["A"],this.outputShape=[];var sp=rp[0],lp=rp[1],up=rp[2],cp=rp[3];this.outputShape=[sp,_d,np,cp];var dp=[ap&&_d>1?lp-1:lp,ap&&np>1?up-1:up],hp=[ap&&_d>1?_d-1:_d,ap&&np>1?np-1:np],fp=ap?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+dp[0]/hp[0]+`,
          `+dp[1]/hp[1]+`);
      const vec2 inputShapeRC = vec2(`+lp+".0, "+up+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+fp+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}(),qi=function(){return function(rp,_d){this.variableNames=["x"];var np=rp.length;if(np>4)throw new Error("WebGL backend: Reverse of rank-"+np+" tensor is not yet supported");if(this.outputShape=rp,np!==1){var ap=rp.map(function(lp,up){return function(cp){return _d.indexOf(cp)!==-1&&rp[cp]!==1?rp[cp]+" - coords["+cp+"] - 1":"coords["+cp+"]"}(up)}).join(","),sp=aa(np);this.userCode=`
      void main() {
        `+sp+` coords = getOutputCoords();
        setOutput(getX(`+ap+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+rp[0]+` - coord - 1));
        }
      `}}(),Ki=function(){return function(rp,_d){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var np=rp.length;if(np>4)throw new Error("WebGL backend: Reverse of rank-"+np+" tensor is not yet supported");this.outputShape=rp;var ap=qo("rc",np),sp=ap[np-1]+" + 1 < "+this.outputShape[np-1],lp=ap[np-2]+" + 1 < "+this.outputShape[np-2],up=aa(np);function cp(dp){var hp=rp.map(function(fp,pp){return function(mp,gp){return _d.indexOf(mp)!==-1&&rp[mp]!==1?rp[mp]+" - "+gp[mp]+" - 1":""+gp[mp]}(pp,dp)});return"getChannel(getX("+hp.join(",")+"), vec2("+hp.slice(-2).join(",")+"))"}this.userCode=np===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+rp[0]+` - rc - 1),
            `+rp[0]+` - rc - 1);
          if(`+sp+`){
              result.g = getChannel(getX(`+rp[0]+` - (rc  + 1) - 1),
                `+rp[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+up+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(dp){return cp(dp)}(ap.slice())+`;
          if(`+sp+`){
            result.g = `+function(dp){return dp[np-1]="("+dp[np-1]+" + 1)",cp(dp)}(ap.slice())+`;
          }
          if(`+lp+`) {
            result.b = `+function(dp){return dp[np-2]="("+dp[np-2]+" + 1)",cp(dp)}(ap.slice())+`;
            if(`+sp+`) {
              result.a = `+function(dp){return dp[np-1]="("+dp[np-1]+" + 1)",dp[np-2]="("+dp[np-2]+" + 1)",cp(dp)}(ap.slice())+`;
            }
          }
          setOutput(result);
        }
    `}}(),ji=function(){return function(rp,_d,np,ap,sp,lp,up){this.variableNames=["updates","indices","defaultValue"],this.outputShape=lp;var cp=aa(sp.length),dp=aa(lp.length),hp="";np===1?hp="i":np===2&&(hp="i, j");var fp="getIndices("+hp+")",pp="";ap===1?pp="i":ap===2&&(pp="i, coords[1]");var mp="getUpdates("+pp+")",gp=_d>1?"strides[j]":"strides";this.userCode=`
        `+cp+" strides = "+cp+"("+sp+`);

        void main() {
          `+dp+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+rp+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+_d+`; j++) {
              int index = round(`+fp+`);
              flattenedIndex += index * `+gp+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+mp+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}(),Xi=function(){return function(rp,_d){this.variableNames=["x","segmentIds"];var np=rp.windowSize,ap=rp.batchSize,sp=rp.inSize,lp=rp.numSegments,up=lp*Math.ceil(sp/np);this.outputShape=[ap,up];var cp=4*Math.floor(np/4),dp=np%4,hp=`
        sumValue += dot(values, segFilter);
    `,fp="";sp%np>0&&(fp=`
        if (inIdx < 0 || inIdx >= `+sp+`) {
          return initializationValue;
        }
      `);var pp="";sp%np>0&&(pp=`
        if (inIdx < 0 || inIdx >= `+sp+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+fp+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+pp+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+lp+")) * float("+np+`));
        int currentSeg = int(mod(float(outIdx), float(`+lp+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+cp+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+hp+`
        }

        int inIdx = inOffset + `+cp+`;
        if (`+(dp===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+hp+`
        } else if (`+(dp===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+hp+`
        } else if (`+(dp===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+hp+`
        }
        setOutput(sumValue);
      }
    `}}(),$i=function(){return function(rp,_d,np){var ap,sp;if(this.variableNames=["c","a","b"],this.outputShape=_d,np>4)throw Error("Where for rank "+np+" is not yet supported");if(np===1)sp="resRC",ap="resRC";else{for(var lp=["resRC.x","resRC.y","resRC.z","resRC.w"],up=[],cp=[],dp=0;dp<_d.length;dp++)cp.push(""+lp[dp]),dp<rp&&up.push(""+lp[dp]);ap=up.join(),sp=cp.join()}var hp=aa(np);this.userCode=`
      void main() {
        `+hp+` resRC = getOutputCoords();
        float cVal = getC(`+ap+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+sp+`));
        } else {
          setOutput(getB(`+sp+`));
        }
      }
    `}}(),Yi=function(){function rp(_d){this.variableNames=["source"],this.outputShape=_d,this.rank=_d.length;var np,ap=aa(this.rank),sp="uniform int start["+this.rank+"];",lp=function(up){if(up===1)return"sourceLoc";if(up<=6)return Qi.slice(0,up).map(function(cp){return"sourceLoc."+cp}).join(",");throw Error("Slicing for rank "+up+" is not yet supported")}(this.rank);np=`
        `+ap+` sourceLoc;
        `+ap+` coords = getOutputCoords();
        `+_d.map(function(up,cp){return"sourceLoc."+Qi[cp]+" = start["+cp+"] + coords."+Qi[cp]+";"}).join(`
`)+`
      `,this.userCode=`
      `+sp+`
      void main() {
        `+np+`
        setOutput(getSource(`+lp+`));
      }
    `}return rp.prototype.getCustomSetupFunc=function(_d){var np=this;if(_d.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+_d.length+")");return function(ap,sp){np.startLoc==null&&(np.startLoc=ap.getUniformLocationNoThrow(sp,"start"),np.startLoc==null)||ap.gl.uniform1iv(np.startLoc,_d)}},rp}(),Qi=["x","y","z","w","u","v"],Ji=function(){function rp(_d){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_d,this.rank=_d.length;var np=aa(this.rank),ap=qo("coords",this.rank),sp=qo("sourceLoc",this.rank),lp=this.rank===1?"sourceLoc":"vec2("+sp.slice(-2).join()+")",up="getChannel(getSource("+sp.join()+"), "+lp+")",cp=`
      result.x = `+up+`;
      if (++`+ap[this.rank-1]+" < "+_d[this.rank-1]+`) {
        ++`+sp[this.rank-1]+`;
        result.y = `+up+`;
        --`+sp[this.rank-1]+`;
      }
    `,dp=this.rank===1?"":`
      --`+ap[this.rank-1]+`;
      if (++`+ap[this.rank-2]+" < "+_d[this.rank-2]+`) {
        ++`+sp[this.rank-2]+`;
        result.z = `+up+`;
        if (++`+ap[this.rank-1]+" < "+_d[this.rank-1]+`) {
          ++`+sp[this.rank-1]+`;
          result.w = `+up+`;
        }
      }
    `,hp=this.rank<=4?`sourceLoc = coords +
            `+np+"("+_d.map(function(fp,pp){return"start["+pp+"]"}).join()+");":_d.map(function(fp,pp){return sp[pp]+" = "+ap[pp]+" + start["+pp+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+np+` coords = getOutputCoords();
        `+np+` sourceLoc;
        `+hp+`
        vec4 result = vec4(0.);
        `+cp+`
        `+dp+`
        setOutput(result);
      }
    `}return rp.prototype.getCustomSetupFunc=function(_d){var np=this;if(_d.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+_d.length+")");return function(ap,sp){np.startLoc==null&&(np.startLoc=ap.getUniformLocationNoThrow(sp,"start"),np.startLoc==null)||ap.gl.uniform1iv(np.startLoc,_d)}},rp}(),Zi=function(){return function(rp,_d,np){this.variableNames=["x"],this.outputShape=np;var ap=np.length,sp=aa(np.length),lp=aa(np.length),up="";if(ap===1)up="coords * strides + begin";else{var cp=0;up=np.map(function(dp,hp){return cp++,np.length===1?"coords * strides["+hp+"] + begin["+hp+"]":"coords["+(cp-1)+"] * strides["+hp+"] + begin["+hp+"]"}).join(",")}this.userCode=`
      `+sp+" begin = "+sp+"("+rp+`);
      `+sp+" strides = "+sp+"("+_d+`);

      void main() {
        `+lp+` coords = getOutputCoords();
        setOutput(getX(`+up+`));
      }
    `}}(),tu=function(){function rp(_d){this.gpgpu=_d,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return rp.prototype.acquireTexture=function(_d,np,ap){var sp,lp=eu(np,ap),up=nu(_d,lp,ap);if(up in this.freeTextures||(this.freeTextures[up]=[]),up in this.usedTextures||(this.usedTextures[up]=[]),this.freeTextures[up].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var cp=this.freeTextures[up].shift();return this.usedTextures[up].push(cp),cp}return this.numUsedTextures++,this.log(),lp===Bt.PACKED_2X2_FLOAT32?sp=this.gpgpu.createPackedMatrixTexture(_d[0],_d[1]):lp===Bt.PACKED_2X2_FLOAT16?sp=this.gpgpu.createFloat16PackedMatrixTexture(_d[0],_d[1]):lp===Bt.UNPACKED_FLOAT32?sp=this.gpgpu.createFloat32MatrixTexture(_d[0],_d[1]):lp===Bt.UNPACKED_FLOAT16?sp=this.gpgpu.createFloat16MatrixTexture(_d[0],_d[1]):lp===Bt.PACKED_4X1_UNSIGNED_BYTE&&(sp=this.gpgpu.createUnsignedBytesMatrixTexture(_d[0],_d[1])),this.usedTextures[up].push(sp),sp},rp.prototype.releaseTexture=function(_d,np,ap,sp){if(this.freeTextures!=null){var lp=nu(np,eu(ap,sp),sp);lp in this.freeTextures||(this.freeTextures[lp]=[]),this.freeTextures[lp].push(_d),this.numFreeTextures++,this.numUsedTextures--;var up=this.usedTextures[lp],cp=up.indexOf(_d);if(cp<0)throw new Error("Cannot release a texture that was never provided by this texture manager");up.splice(cp,1),this.log()}},rp.prototype.log=function(){if(this.logEnabled){var _d=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+_d+")")}},rp.prototype.getNumUsedTextures=function(){return this.numUsedTextures},rp.prototype.getNumFreeTextures=function(){return this.numFreeTextures},rp.prototype.dispose=function(){var _d=this;if(this.freeTextures!=null){for(var np in this.freeTextures)this.freeTextures[np].forEach(function(ap){_d.gpgpu.deleteMatrixTexture(ap)});for(var np in this.usedTextures)this.usedTextures[np].forEach(function(sp){_d.gpgpu.deleteMatrixTexture(sp)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},rp}();function eu(rp,_d){if(rp===Mt.UPLOAD)return Bt.PACKED_2X2_FLOAT32;if(rp===Mt.RENDER||rp==null)return function(np){return a$1().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?np?Bt.PACKED_2X2_FLOAT32:Bt.UNPACKED_FLOAT32:np?Bt.PACKED_2X2_FLOAT16:Bt.UNPACKED_FLOAT16}(_d);if(rp===Mt.DOWNLOAD||rp===Mt.PIXELS)return Bt.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+rp)}function nu(rp,_d,np){return rp[0]+"_"+rp[1]+"_"+_d+"_"+np}var ru=function(){return function(rp,_d){this.variableNames=["A"];for(var np=new Array(rp.length),ap=0;ap<np.length;ap++)np[ap]=rp[ap]*_d[ap];this.outputShape=np,this.rank=np.length;var sp=aa(this.rank),lp=function(up){var cp=up.length;if(cp>5)throw Error("Tile for rank "+cp+" is not yet supported");if(cp===1)return"imod(resRC, "+up[0]+")";for(var dp=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],hp=[],fp=0;fp<up.length;fp++)hp.push("imod("+dp[fp]+", "+up[fp]+")");return hp.join()}(rp);this.userCode=`
      void main() {
        `+sp+` resRC = getOutputCoords();
        setOutput(getA(`+lp+`));
      }
    `}}(),ou=function(){return function(rp,_d){this.variableNames=["A"];for(var np=new Array(rp.length),ap=0;ap<np.length;ap++)np[ap]=rp[_d[ap]];this.outputShape=np,this.rank=np.length;var sp=aa(this.rank),lp=function(up){var cp=up.length;if(cp>6)throw Error("Transpose for rank "+cp+" is not yet supported");for(var dp=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],hp=new Array(cp),fp=0;fp<up.length;fp++)hp[up[fp]]=dp[fp];return hp.join()}(_d);this.userCode=`
    void main() {
      `+sp+` resRC = getOutputCoords();
      setOutput(getA(`+lp+`));
    }
    `}}(),au=function(){return function(rp,_d){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var np=new Array(rp.length),ap=0;ap<np.length;ap++)np[ap]=rp[_d[ap]];if(this.outputShape=np,this.rank=np.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var sp=aa(this.rank),lp=Ho("rc",this.rank),up=new Array(this.rank);for(ap=0;ap<_d.length;ap++)up[_d[ap]]=lp[ap];var cp="vec2("+up.slice(-2).join()+")",dp="++"+lp[this.rank-1]+" < "+np[this.rank-1],hp="getChannel(getA("+up.join()+"), "+cp+")";this.userCode=`
    void main() {
      `+sp+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+hp+`;
      if(`+dp+`) {
        result[1] = `+hp+`;
      }
      --`+lp[this.rank-1]+`;
      if(++`+lp[this.rank-2]+" < "+np[this.rank-2]+`) {
        result[2] = `+hp+`;
        if(`+dp+`) {
          result[3] = `+hp+`;
        }
      }
      setOutput(result);
    }
    `}}(),iu=1.7580993408473768,uu=1.0507009873554805,su=function(){return function(rp,_d){this.variableNames=["A"],this.outputShape=rp,this.userCode=`
      float unaryOperation(float x) {
        `+_d+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}(),cu="if (isnan(x)) return x;",lu="return x;",hu="return abs(x);",fu=cu+`
  return (x < 0.0) ? 0.0 : x;
`,pu=cu+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,du="return (x >= 0.0) ? x : (exp(x) - 1.0);",vu=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+iu+`;
  float scale = `+uu+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,mu="return -x;",gu="return ceil(x);",yu="return floor(x);",xu="return exp(x);",bu="return exp(x) - 1.0;",wu=cu+`
  return sin(x);
`,Cu=cu+`
  return cos(x);
`,Eu=cu+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Ru=cu+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Iu=cu+`
  return atan(x);
`,ku=cu+"return log(x + sqrt(x * x + 1.0));",Su=cu+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,Au=cu+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Du="return x;",Tu="return x;",Nu=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Fu=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ou=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,_u=function(){return function(rp,_d){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=rp,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+_d+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}(),Mu=function(){return function(rp){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=rp;var _d=rp.length,np=qo("rc",_d),ap=aa(_d),sp=function(cp,dp){if(cp===1)return"rc";for(var hp="",fp=0;fp<cp;fp++)hp+=dp[fp],fp<cp-1&&(hp+=",");return hp}(_d,np),lp=np.slice(-2),up=_d<=1?"rc":"vec2("+lp.join(",")+")";this.userCode=`
      void main() {
        `+ap+` rc = getOutputCoords();
        vec4 packedInput = getA(`+sp+`);

        setOutput(getChannel(packedInput, `+up+`));
      }
    `}}(),Bu={};function Pu(rp,_d){if(_d===void 0&&(_d=!1),rp==="linear")return _d?Tu:lu;if(rp==="relu")return _d?Nu:fu;if(rp==="elu")return _d?Ou:du;if(rp==="relu6")return _d?Fu:pu;if(rp==="prelu")return _d?wa:xa;throw new Error("Activation "+rp+" has not been implemented for the WebGL backend.")}var Lu=600,Wu=function(rp){function _d(np){var ap,sp=rp.call(this)||this;if(sp.gpgpu=np,sp.pendingRead=new WeakMap,sp.pendingDisposal=new WeakSet,sp.dataRefCount=new WeakMap,sp.numBytesInGPU=0,sp.uploadWaitMs=0,sp.downloadWaitMs=0,sp.warnedAboutMemory=!1,sp.pendingDeletes=0,sp.disposed=!1,!a$1().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(np==null){var lp=Ut(a$1().getNumber("WEBGL_VERSION"));sp.binaryCache=((ap=a$1().getNumber("WEBGL_VERSION"))in Bu||(Bu[ap]={}),Bu[ap]),sp.gpgpu=new Ci(lp),sp.canvas=lp.canvas,sp.gpgpuCreatedLocally=!0}else sp.binaryCache={},sp.gpgpuCreatedLocally=!1,sp.canvas=np.gl.canvas;return sp.textureManager=new tu(sp.gpgpu),sp.numMBBeforeWarning=a$1().global.screen==null?1024:a$1().global.screen.height*a$1().global.screen.width*window.devicePixelRatio*Lu/1024/1024,sp.texData=new so(sp,Nt),sp}return e(_d,rp),_d.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},_d.prototype.fromPixels=function(np,ap){if(np==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var sp=typeof OffscreenCanvas<"u"&&np instanceof OffscreenCanvas||typeof HTMLCanvasElement<"u"&&np instanceof HTMLCanvasElement,lp=np.data instanceof Uint8Array,up=typeof ImageData<"u"&&np instanceof ImageData,cp=typeof HTMLVideoElement<"u"&&np instanceof HTMLVideoElement,dp=typeof HTMLImageElement<"u"&&np instanceof HTMLImageElement,hp=cp?[np.videoWidth,np.videoHeight]:[np.width,np.height],fp=hp[0],pp=hp[1],mp=[pp,fp],gp=[pp,fp,ap];if(!(sp||lp||up||cp||dp))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+np.constructor.name);(dp||cp)&&(this.fromPixels2DContext==null&&(this.fromPixels2DContext=Vt(a$1().getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=fp,this.fromPixels2DContext.canvas.height=pp,this.fromPixels2DContext.drawImage(np,0,0,fp,pp),np=this.fromPixels2DContext.canvas);var yp,xp,_p=this.makeTensorInfo(mp,"int32");return this.texData.get(_p.dataId).usage=Mt.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(_p.dataId),np),a$1().getBool("WEBGL_PACK")?(yp=new ei(gp),xp=this.compileAndRun(yp,[_p])):(yp=new ti(gp),xp=this.compileAndRun(yp,[_p])),this.disposeData(_p.dataId),xp},_d.prototype.write=function(np,ap,sp){if(a$1().getBool("DEBUG")&&this.checkNumericalProblems(np),sp==="complex64"&&np!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var lp={};return this.texData.set(lp,{shape:ap,dtype:sp,values:np,usage:Mt.UPLOAD}),lp},_d.prototype.move=function(np,ap,sp,lp){if(a$1().getBool("DEBUG")&&this.checkNumericalProblems(ap),lp==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(np,{shape:sp,dtype:lp,values:ap,usage:Mt.UPLOAD})},_d.prototype.readSync=function(np){var ap=this.texData.get(np),sp=ap.values,lp=ap.dtype,up=ap.complexTensors,cp=ap.slice,dp=ap.shape,hp=ap.isPacked;if(cp!=null){var fp=void 0;fp=hp?new _u(dp,Du):new su(dp,Du);var pp=this.runWebGLProgram(fp,[{dataId:np,shape:dp,dtype:lp}],lp),mp=this.readSync(pp.dataId);return this.disposeData(pp.dataId),mp}if(sp!=null)return this.convertAndCacheOnCPU(np);if(lp==="string")return sp;var gp,yp,xp=this.activeTimers!=null;return xp&&(gp=Y()),lp==="complex64"?yp=No(up.real.dataSync(),up.imag.dataSync()):yp=this.getValuesFromTexture(np),xp&&(this.downloadWaitMs+=Y()-gp),this.convertAndCacheOnCPU(np,yp)},_d.prototype.read=function(np){return n$1(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p,vp,bp,Ep,Sp,Ap,Rp,Tp,Mp;return r(this,function(Op){switch(Op.label){case 0:if(this.pendingRead.has(np))return ap=this.pendingRead.get(np),[2,new Promise(function(Pp){return ap.push(Pp)})];if(sp=this.texData.get(np),lp=sp.values,up=sp.shape,cp=sp.slice,dp=sp.dtype,hp=sp.complexTensors,fp=sp.isPacked,cp!=null)return pp=void 0,pp=fp?new _u(up,Du):new su(up,Du),mp=this.runWebGLProgram(pp,[{dataId:np,shape:up,dtype:dp}],dp),gp=this.read(mp.dataId),this.disposeData(mp.dataId),[2,gp];if(lp!=null)return[2,this.convertAndCacheOnCPU(np)];if(!a$1().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&a$1().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return yp=null,dp!=="complex64"&&a$1().get("WEBGL_BUFFER_SUPPORTED")&&(xp=this.decode(np),_p=this.texData.get(xp.dataId),yp=(Mp=this.gpgpu).createBufferFromTexture.apply(Mp,[_p.texture].concat(Gt(up)))),this.pendingRead.set(np,[]),dp==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:Op.sent(),Op.label=2;case 2:return dp!=="complex64"?[3,4]:[4,Promise.all([hp.real.data(),hp.imag.data()])];case 3:return bp=Op.sent(),Ep=bp[0],Sp=bp[1],vp=No(Ep,Sp),[3,5];case 4:yp==null?vp=this.getValuesFromTexture(np):(Ap=w$1(up),vp=this.gpgpu.downloadFloat32MatrixFromBuffer(yp,Ap)),Op.label=5;case 5:return xp!=null&&this.disposeData(xp.dataId),Rp=this.convertAndCacheOnCPU(np,vp),Tp=this.pendingRead.get(np),this.pendingRead.delete(np),Tp.forEach(function(Pp){return Pp(Rp)}),this.pendingDisposal.has(np)&&(this.pendingDisposal.delete(np),this.disposeData(np),this.pendingDeletes--),[2,Rp]}})})},_d.prototype.checkNumericalProblems=function(np){if(np!=null)for(var ap=0;ap<np.length;ap++){var sp=np[ap];if(!$t(sp))throw a$1().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+sp+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+sp+" cannot be represented on this device.")}},_d.prototype.getValuesFromTexture=function(np){var ap,sp=this.texData.get(np),lp=sp.shape,up=sp.dtype,cp=sp.isPacked,dp=w$1(lp);if(a$1().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var hp=this.decode(np),fp=this.texData.get(hp.dataId),pp=(ap=this.gpgpu).downloadMatrixFromPackedTexture.apply(ap,[fp.texture].concat(Gt(lp))).subarray(0,dp);return this.disposeData(hp.dataId),pp}var mp=a$1().getBool("WEBGL_PACK")&&cp===!0,gp=mp?Re(lp):lp,yp=mp?new ja(gp):new Ka(gp),xp=this.runWebGLProgram(yp,[{shape:gp,dtype:up,dataId:np}],"float32"),_p=this.texData.get(xp.dataId),vp=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(_p.texture,_p.texShape[0],_p.texShape[1]).subarray(0,dp);return this.disposeData(xp.dataId),vp},_d.prototype.time=function(np){return n$1(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp;return r(this,function(fp){switch(fp.label){case 0:return ap=this.activeTimers,sp=[],lp=!1,this.programTimersStack==null?(this.programTimersStack=sp,lp=!0):this.activeTimers.push(sp),this.activeTimers=sp,np(),up=b(this.activeTimers.map(function(pp){return pp.query})).filter(function(pp){return pp!=null}),cp=b(this.activeTimers.map(function(pp){return pp.name})).filter(function(pp){return pp!=null}),this.activeTimers=ap,lp&&(this.programTimersStack=null),[4,Promise.all(up)];case 1:return dp=fp.sent(),hp={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:m$1(dp),getExtraProfileInfo:function(){return dp.map(function(pp,mp){return{name:cp[mp],ms:pp}}).map(function(pp){return pp.name+": "+pp.ms}).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,hp]}})})},_d.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},_d.prototype.startTimer=function(){return a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:Y(),endMs:null}},_d.prototype.endTimer=function(np){return a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),np):(np.endMs=Y(),np)},_d.prototype.getQueryTime=function(np){return n$1(this,void 0,void 0,function(){var ap;return r(this,function(sp){return a$1().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(np)]:[2,(ap=np).endMs-ap.startMs]})})},_d.prototype.disposeData=function(np){if(!this.pendingDisposal.has(np)){if(this.pendingRead.has(np))return this.pendingDisposal.add(np),void this.pendingDeletes++;if(this.texData.has(np)){this.releaseGPUData(np);var ap=this.texData.get(np).complexTensors;ap!=null&&(ap.real.dispose(),ap.imag.dispose()),this.texData.delete(np)}}},_d.prototype.releaseGPUData=function(np){var ap=this.texData.get(np),sp=ap.texture,lp=ap.dtype,up=ap.texShape,cp=ap.usage,dp=ap.isPacked,hp=ap.slice,fp=hp&&hp.origDataId||np,pp=this.dataRefCount.get(fp);pp>1?this.dataRefCount.set(fp,pp-1):(this.dataRefCount.delete(fp),sp!=null&&(this.numBytesInGPU-=this.computeBytes(up,lp),this.textureManager.releaseTexture(sp,up,cp,dp)));var mp=this.texData.get(np);mp.texture=null,mp.texShape=null,mp.isPacked=!1,mp.slice=null},_d.prototype.getTexture=function(np){return this.uploadToGPU(np),this.texData.get(np).texture},_d.prototype.getDataInfo=function(np){return this.texData.get(np)},_d.prototype.getCPUBackend=function(){return a$1().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=Nt.findBackend("cpu")),this.cpuBackend):null},_d.prototype.shouldExecuteOnCPU=function(np,ap){var sp=this;return ap===void 0&&(ap=128),this.getCPUBackend()!=null&&np.every(function(lp){return sp.texData.get(lp.dataId).texture==null&&lp.size<ap})},_d.prototype.getGPGPUContext=function(){return this.gpgpu},_d.prototype.complex=function(np,ap){var sp=this.makeOutput(np.shape,"complex64");return this.texData.get(sp.dataId).complexTensors={real:Nt.keep(np.clone()),imag:Nt.keep(ap.clone())},sp},_d.prototype.real=function(np){return this.texData.get(np.dataId).complexTensors.real.clone()},_d.prototype.imag=function(np){return this.texData.get(np.dataId).complexTensors.imag.clone()},_d.prototype.slice=function(np,ap,sp){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.slice(np,ap,sp);if(w$1(sp)===0)return kn([],sp,np.dtype);var lp=this.texData.get(np.dataId).isPacked,up=Yr(np.shape,ap,sp);if(lp||!up){var cp=a$1().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ji(sp):new Yi(sp),dp=cp.getCustomSetupFunc(ap);return this.compileAndRun(cp,[np],null,dp)}return this.uploadToGPU(np.dataId),this.shallowSlice(np,ap,sp)},_d.prototype.shallowSlice=function(np,ap,sp){var lp=this.texData.get(np.dataId),up=this.makeOutput(sp,np.dtype),cp=this.texData.get(up.dataId);Object.assign(cp,lp),cp.shape=sp,cp.dtype=np.dtype;var dp=Qr(ap,np.strides);lp.slice&&(dp+=lp.slice.flatOffset),cp.slice={flatOffset:dp,origDataId:lp.slice&&lp.slice.origDataId||np.dataId};var hp=this.dataRefCount.get(cp.slice.origDataId)||1;return this.dataRefCount.set(cp.slice.origDataId,hp+1),up},_d.prototype.stridedSlice=function(np,ap,sp,lp){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.stridedSlice(np,ap,sp,lp);var up=jr(ap,sp,lp);if(up.some(function(dp){return dp===0}))return kn([],up);var cp=new Zi(ap,lp,up);return this.compileAndRun(cp,[np])},_d.prototype.reverse=function(np,ap){var sp=a$1().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ki(np.shape,ap):new qi(np.shape,ap);return this.compileAndRun(sp,[np])},_d.prototype.concat=function(np,ap){if(np[0].dtype==="complex64"){var sp=np.map(function(gp){return Rn(gp)}),lp=np.map(function(gp){return In(gp)});return En(this.concat(sp,ap),this.concat(lp,ap))}if(this.shouldExecuteOnCPU(np))return this.cpuBackend.concat(np,ap);if(np.length===1)return np[0];if(np.length>a$1().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var up=Math.floor(np.length/2),cp=this.concat(np.slice(0,up),ap),dp=this.concat(np.slice(up),ap);return this.concat([cp,dp],ap)}if(a$1().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&np[0].rank>1){var hp=new Sa(np.map(function(gp){return gp.shape}),ap);return this.compileAndRun(hp,np)}var fp=wn(np.map(function(gp){return gp.shape}),ap),pp=np.map(function(gp){return gp.as2D(-1,w$1(gp.shape.slice(ap)))}),mp=new ka(pp.map(function(gp){return gp.shape}));return this.compileAndRun(mp,pp).reshape(fp)},_d.prototype.neg=function(np){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.neg(np);if(a$1().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(np,mu,np.dtype);var ap=new su(np.shape,mu);return this.compileAndRun(ap,[np])},_d.prototype.batchMatMul=function(np,ap,sp,lp){var up=sp?np.shape[2]:np.shape[1],cp=lp?ap.shape[1]:ap.shape[2],dp=sp?np.shape[1]:np.shape[2],hp=np.shape[0];if((up===1||cp===1)&&dp>1e3){sp&&(np=np.transpose([0,2,1])),lp&&(ap=ap.transpose([0,2,1]));var fp=cp===1?np:np.as3D(hp,dp,1),pp=cp===1?2:1,mp=cp===1?ap.as3D(hp,1,dp):ap;return this.multiply(fp,mp).sum(pp,!0)}var gp=Ct(np.dtype,ap.dtype),yp=new Ti(np.shape,[hp,up,cp],sp,lp);return this.compileAndRun(yp,[np,ap],gp)},_d.prototype.fusedBatchMatMul=function(np){var ap=np.a,sp=np.b,lp=np.transposeA,up=np.transposeB,cp=np.bias,dp=np.activation,hp=np.preluActivationWeights,fp=lp?ap.shape[2]:ap.shape[1],pp=up?sp.shape[1]:sp.shape[2],mp=ap.shape[0],gp=Ct(ap.dtype,sp.dtype),yp=cp!=null,xp=hp!=null,_p=dp?Pu(dp,!0):null,vp=new Ti(ap.shape,[mp,fp,pp],lp,up,yp,_p,xp),bp=[ap,sp];return cp&&bp.push(cp),hp&&bp.push(hp),this.compileAndRun(vp,bp,gp)},_d.prototype.multiply=function(np,ap){if(np.dtype==="complex64"){var sp=this.texData.get(np.dataId),lp=this.texData.get(ap.dataId),up=new va(pa,np.shape,ap.shape),cp=new va(da,np.shape,ap.shape),dp=[this.makeComplexComponentTensorInfo(np,sp.complexTensors.real),this.makeComplexComponentTensorInfo(np,sp.complexTensors.imag),this.makeComplexComponentTensorInfo(ap,lp.complexTensors.real),this.makeComplexComponentTensorInfo(ap,lp.complexTensors.imag)],hp=this.compileAndRun(up,dp),fp=this.compileAndRun(cp,dp),pp=this.complex(hp,fp);return hp.dispose(),fp.dispose(),pp}if(this.shouldExecuteOnCPU([np,ap]))return this.cpuBackend.multiply(np,ap);if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,ya,np.dtype);var mp=new ba(ya,np.shape,ap.shape);return this.compileAndRun(mp,[np,ap],np.dtype)},_d.prototype.batchNormalization=function(np,ap,sp,lp,up,cp){var dp=[np,ap,sp],hp=null;cp!=null&&(hp=cp.shape,dp.push(cp));var fp=null;if(up!=null&&(fp=up.shape,dp.push(up)),a$1().getBool("WEBGL_PACK_NORMALIZATION")){var pp=new fa(np.shape,ap.shape,sp.shape,hp,fp,lp);return this.compileAndRun(pp,dp)}var mp=new ha(np.shape,ap.shape,sp.shape,hp,fp,lp);return this.compileAndRun(mp,dp)},_d.prototype.localResponseNormalization4D=function(np,ap,sp,lp,up){var cp=a$1().getBool("WEBGL_PACK_NORMALIZATION")?new Si(np.shape,ap,sp,lp,up):new Ii(np.shape,ap,sp,lp,up);return this.compileAndRun(cp,[np])},_d.prototype.LRNGrad=function(np,ap,sp,lp,up,cp,dp){var hp=new ki(ap.shape,lp,up,cp,dp);return this.compileAndRun(hp,[ap,sp,np])},_d.prototype.tile=function(np,ap){if(np.dtype==="string"){var sp=this.readSync(np.dataId).map(function(up){return Z(up)});return Lo(ur(np.shape,np.dtype,sp),ap)}var lp=new ru(np.shape,ap);return this.compileAndRun(lp,[np])},_d.prototype.pad=function(np,ap,sp){var lp=a$1().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Mi(np.shape,ap,sp):new _i(np.shape,ap,sp);return this.compileAndRun(lp,[np])},_d.prototype.transpose=function(np,ap){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.transpose(np,ap);var sp=a$1().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new au(np.shape,ap):new ou(np.shape,ap);return this.compileAndRun(sp,[np])},_d.prototype.gather=function(np,ap,sp){if(this.shouldExecuteOnCPU([np,ap]))return this.cpuBackend.gather(np,ap,sp);var lp=new ni(np.shape,ap.size,sp);return this.compileAndRun(lp,[np,ap])},_d.prototype.batchToSpaceND=function(np,ap,sp){g(np.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var lp=ap.reduce(function(pp,mp){return pp*mp}),up=Mr(np.shape,ap,lp),cp=Br(up.length,ap.length),dp=Pr(np.shape,ap,lp),hp=Lr(sp,ap.length),fp=Wr(dp,sp,ap.length);return np.reshape(up).transpose(cp).reshape(dp).slice(hp,fp)},_d.prototype.spaceToBatchND=function(np,ap,sp){g(np.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var lp=ap.reduce(function(mp,gp){return mp*gp}),up=[[0,0]];up.push.apply(up,sp);for(var cp=1+ap.length;cp<np.shape.length;++cp)up.push([0,0]);var dp=np.pad(up),hp=Mr(dp.shape,ap,lp,!1),fp=Br(hp.length,ap.length,!1),pp=Pr(dp.shape,ap,lp,!1);return dp.reshape(hp).transpose(fp).reshape(pp)},_d.prototype.reduce=function(np,ap,sp){var lp=np.shape[0],up=np.shape[1],cp=zr(up),dp=new Li({windowSize:cp,inSize:up,batchSize:lp},ap),hp=this.compileAndRun(dp,[np],sp);return hp.shape[1]===1?hp:this.reduce(hp,ap,sp)},_d.prototype.argReduce=function(np,ap,sp){sp===void 0&&(sp=null);var lp=np.shape[0],up=np.shape[1];sp!=null&&(lp=sp.shape[0],up=sp.shape[1]);var cp=zr(up),dp=new Go({windowSize:cp,inSize:up,batchSize:lp},ap,sp==null),hp=[np];sp!=null&&hp.push(sp);var fp=this.compileAndRun(dp,hp,"int32");return fp.shape[1]===1?fp:this.argReduce(np,ap,fp)},_d.prototype.argReducePacked=function(np,ap,sp){sp===void 0&&(sp=null);var lp=sp!=null?sp.shape:np.shape,up=zr(lp[lp.length-1]),cp=new sa(lp,up,ap,sp==null),dp=sp==null?[np]:[np,sp],hp=this.compileAndRun(cp,dp,"int32");return hp.rank===np.rank?this.argReducePacked(np,ap,hp):hp},_d.prototype.sum=function(np,ap){mn("sum",ap,np.rank);var sp=dn(np.shape,ap),lp=sp[0],up=w$1(sp[1]),cp=np.as2D(-1,up),dp=Et(np.dtype);return this.reduce(cp,"sum",dp).reshape(lp)},_d.prototype.prod=function(np,ap){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.prod(np,ap);var sp=dn(np.shape,ap),lp=sp[0],up=w$1(sp[1]),cp=np.as2D(-1,up),dp=Et(np.dtype);return this.reduce(cp,"prod",dp).reshape(lp)},_d.prototype.unsortedSegmentSum=function(np,ap,sp){var lp=0,up=gn([lp],np.rank),cp=np;up!=null&&(cp=np.transpose(up),lp=xn(1,np.rank)[0]);var dp=function(gp,yp,xp){for(var _p=[],vp=gp.length,bp=0;bp<vp;bp++)bp!==yp?_p.push(gp[bp]):_p.push(xp);return _p}(cp.shape,lp,sp),hp=w$1([cp.shape[lp]]),fp=cp.as2D(-1,hp),pp=Et(np.dtype),mp=this.segOpCompute(fp,"unsortedSegmentSum",ap,pp,sp).reshape(dp);return up!=null&&(mp=mp.transpose(yn(up))),mp},_d.prototype.segOpCompute=function(np,ap,sp,lp,up){var cp=np.shape[0],dp=np.shape[1],hp=function(mp,gp){var yp,xp=!1;for(mp<=Vr?(yp=mp,xp=!0):yp=H(mp,Math.floor(Math.sqrt(mp)));!xp;)yp>gp||yp===mp?xp=!0:yp=H(mp,yp+1);return yp}(dp,up),fp=new Xi({windowSize:hp,inSize:dp,batchSize:cp,numSegments:up},ap),pp=this.compileAndRun(fp,[np,sp],lp);return pp.shape[1]===up?pp:(sp=Un(0,up).tile([dp/hp]),this.segOpCompute(pp,ap,sp,lp,up))},_d.prototype.argMinMaxReduce=function(np,ap,sp){var lp=[ap];if(mn("arg"+sp.charAt(0).toUpperCase()+sp.slice(1),lp,np.rank),!a$1().getBool("WEBGL_PACK_REDUCE")||np.rank<=2){var up=dn(np.shape,lp),cp=up[0],dp=w$1(up[1]),hp=np.as2D(-1,dp);return this.argReduce(hp,sp).reshape(cp)}return this.argReducePacked(np,sp)},_d.prototype.argMin=function(np,ap){return this.argMinMaxReduce(np,ap,"min")},_d.prototype.argMax=function(np,ap){return this.argMinMaxReduce(np,ap,"max")},_d.prototype.cumsum=function(np,ap,sp,lp){if(ap!==np.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(np.rank-1)+" but got axis="+ap);var up=new Ua(np.shape,sp,lp);return this.compileAndRun(up,[np])},_d.prototype.equal=function(np,ap){if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  return vec4(equal(a, b));
`,"bool");var sp=new ba("return float(a == b);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"bool")},_d.prototype.notEqual=function(np,ap){if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  return vec4(notEqual(a, b));
`,"bool");var sp=new ba("return float(a != b);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"bool")},_d.prototype.less=function(np,ap){if(this.shouldExecuteOnCPU([np,ap]))return this.cpuBackend.less(np,ap);if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  return vec4(lessThan(a, b));
`,"bool");var sp=new ba("return float(a < b);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"bool")},_d.prototype.lessEqual=function(np,ap){if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  return vec4(lessThanEqual(a, b));
`,"bool");var sp=new ba("return float(a <= b);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"bool")},_d.prototype.greater=function(np,ap){if(this.shouldExecuteOnCPU([np,ap]))return this.cpuBackend.greater(np,ap);if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  return vec4(greaterThan(a, b));
`,"bool");var sp=new ba("return float(a > b);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"bool")},_d.prototype.greaterEqual=function(np,ap){if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var sp=new ba("return float(a >= b);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"bool")},_d.prototype.logicalNot=function(np){var ap=new su(np.shape,"return float(!(x >= 1.0));");return this.compileAndRun(ap,[np])},_d.prototype.logicalAnd=function(np,ap){if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var sp=new ba("return float(a >= 1.0 && b >= 1.0);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"bool")},_d.prototype.logicalOr=function(np,ap){if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var sp=new ba("return float(a >= 1.0 || b >= 1.0);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"bool")},_d.prototype.select=function(np,ap,sp){var lp=new $i(np.rank,ap.shape,ap.rank);return this.compileAndRun(lp,[np,ap,sp],Ct(ap.dtype,sp.dtype))},_d.prototype.where=function(np){un("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var ap=np.dataSync();return Uo(np.shape,ap)},_d.prototype.topk=function(np,ap,sp){return Wo(np.dataSync(),np.shape,np.dtype,ap)},_d.prototype.min=function(np,ap){mn("min",ap,np.rank);var sp=dn(np.shape,ap),lp=sp[0],up=w$1(sp[1]),cp=np.as2D(-1,up);return this.reduce(cp,"min",cp.dtype).reshape(lp)},_d.prototype.minimum=function(np,ap){if(this.shouldExecuteOnCPU([np,ap]))return this.cpuBackend.minimum(np,ap);var sp=a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ca(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,np.shape,ap.shape):new ba(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,np.shape,ap.shape);return this.compileAndRun(sp,[np,ap])},_d.prototype.mod=function(np,ap){var sp=a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ca(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,np.shape,ap.shape):new ba(`if (b == 0.0) return NAN;
  return mod(a, b);`,np.shape,ap.shape);return this.compileAndRun(sp,[np,ap])},_d.prototype.max=function(np,ap){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.max(np,ap);mn("max",ap,np.rank);var sp=dn(np.shape,ap),lp=sp[0],up=w$1(sp[1]),cp=np.as2D(-1,up);return this.reduce(cp,"max",cp.dtype).reshape(lp)},_d.prototype.maximum=function(np,ap){if(this.shouldExecuteOnCPU([np,ap]))return this.cpuBackend.maximum(np,ap);var sp=a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ca(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,np.shape,ap.shape):new ba(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,np.shape,ap.shape);return this.compileAndRun(sp,[np,ap])},_d.prototype.all=function(np,ap){mn("all",ap,np.rank);var sp=dn(np.shape,ap),lp=sp[0],up=w$1(sp[1]),cp=np.as2D(-1,up);return this.reduce(cp,"all",cp.dtype).reshape(lp)},_d.prototype.any=function(np,ap){mn("any",ap,np.rank);var sp=dn(np.shape,ap),lp=sp[0],up=w$1(sp[1]),cp=np.as2D(-1,up);return this.reduce(cp,"any",cp.dtype).reshape(lp)},_d.prototype.squaredDifference=function(np,ap){var sp=a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ca("return (a - b) * (a - b);",np.shape,ap.shape):new ba("return (a - b) * (a - b);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap])},_d.prototype.realDivide=function(np,ap){if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var sp=new ba(`
if (a == b) {
  return 1.0;
};
return a / b;`,np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"float32")},_d.prototype.floorDiv=function(np,ap){if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var sp=new ba(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,np.shape,ap.shape);return this.compileAndRun(sp,[np,ap],"int32")},_d.prototype.add=function(np,ap){if(np.dtype==="complex64"&&ap.dtype==="complex64")return this.complexSeparableBinaryOp(np,ap,ma);if(this.shouldExecuteOnCPU([np,ap]))return this.cpuBackend.add(np,ap);var sp=Ct(np.dtype,ap.dtype);if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,ma,sp);var lp=new ba(ma,np.shape,ap.shape);return this.compileAndRun(lp,[np,ap],sp)},_d.prototype.packedUnaryOp=function(np,ap,sp){var lp=new _u(np.shape,ap);return this.compileAndRun(lp,[np],sp)},_d.prototype.packedBinaryOp=function(np,ap,sp,lp,up){up===void 0&&(up=!1);var cp=new Ca(sp,np.shape,ap.shape,up);return this.compileAndRun(cp,[np,ap],lp)},_d.prototype.complexSeparableBinaryOp=function(np,ap,sp){var lp=this,up=this.texData.get(np.dataId),cp=this.texData.get(ap.dataId),dp=[[up.complexTensors.real,cp.complexTensors.real],[up.complexTensors.imag,cp.complexTensors.imag]].map(function(mp){var gp=mp[0],yp=mp[1],xp=lp.makeComplexComponentTensorInfo(np,gp),_p=lp.makeComplexComponentTensorInfo(ap,yp),vp=new ba(sp,np.shape,ap.shape);return lp.compileAndRun(vp,[xp,_p],Ct(gp.dtype,yp.dtype))}),hp=dp[0],fp=dp[1],pp=this.complex(hp,fp);return hp.dispose(),fp.dispose(),pp},_d.prototype.makeComplexComponentTensorInfo=function(np,ap){return{dataId:ap.dataId,dtype:ap.dtype,shape:np.shape}},_d.prototype.addN=function(np){if(np.length===1)return np[0];if(np.length>a$1().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var ap=Math.floor(np.length/2),sp=this.addN(np.slice(0,ap)),lp=this.addN(np.slice(ap));return this.addN([sp,lp])}var up=np.map(function(hp){return hp.dtype}).reduce(function(hp,fp){return Ct(hp,fp)}),cp=np.map(function(hp){return hp.shape}),dp=a$1().getBool("WEBGL_PACK")?new zo(np[0].shape,cp):new Vo(np[0].shape,cp);return this.compileAndRun(dp,np,up)},_d.prototype.subtract=function(np,ap){if(np.dtype==="complex64"&&ap.dtype==="complex64")return this.complexSeparableBinaryOp(np,ap,ga);if(this.shouldExecuteOnCPU([np,ap]))return this.cpuBackend.subtract(np,ap);var sp=Ct(np.dtype,ap.dtype);if(a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(np,ap,ga,np.dtype);var lp=new ba(ga,np.shape,ap.shape);return this.compileAndRun(lp,[np,ap],sp)},_d.prototype.pow=function(np,ap){var sp=a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ca(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,np.shape,ap.shape):new ba(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,np.shape,ap.shape),lp=Ct(np.dtype,ap.dtype);return this.compileAndRun(sp,[np,ap],lp)},_d.prototype.ceil=function(np){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.ceil(np);if(a$1().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(np,gu,np.dtype);var ap=new su(np.shape,gu);return this.compileAndRun(ap,[np])},_d.prototype.floor=function(np){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.floor(np);if(a$1().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(np,yu,np.dtype);var ap=new su(np.shape,yu);return this.compileAndRun(ap,[np])},_d.prototype.sign=function(np){var ap=new su(np.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(ap,[np])},_d.prototype.isNaN=function(np){var ap=new su(np.shape,"return float(isnan(x));");return this.compileAndRun(ap,[np],"bool")},_d.prototype.isInf=function(np){var ap=new su(np.shape,"return float(isinf(x));");return this.compileAndRun(ap,[np],"bool")},_d.prototype.isFinite=function(np){var ap=new su(np.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(ap,[np],"bool")},_d.prototype.round=function(np){var ap=new su(np.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(ap,[np])},_d.prototype.exp=function(np){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.exp(np);if(a$1().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(np,xu,np.dtype);var ap=new su(np.shape,xu);return this.compileAndRun(ap,[np])},_d.prototype.expm1=function(np){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.expm1(np);if(a$1().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(np,bu,np.dtype);var ap=new su(np.shape,bu);return this.compileAndRun(ap,[np])},_d.prototype.log=function(np){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.log(np);if(a$1().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(np,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,np.dtype);var ap=new su(np.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(ap,[np])},_d.prototype.log1p=function(np){var ap=new su(np.shape,"return log(1.0 + x);");return this.compileAndRun(ap,[np])},_d.prototype.sqrt=function(np){var ap=new su(np.shape,"return sqrt(x);");return this.compileAndRun(ap,[np])},_d.prototype.rsqrt=function(np){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.rsqrt(np);var ap=new su(np.shape,"return inversesqrt(x);");return this.compileAndRun(ap,[np])},_d.prototype.reciprocal=function(np){var ap=new su(np.shape,"return 1.0 / x;");return this.compileAndRun(ap,[np])},_d.prototype.relu=function(np){var ap;return ap=a$1().getBool("WEBGL_PACK")?new _u(np.shape,Nu):new su(np.shape,fu),this.compileAndRun(ap,[np])},_d.prototype.relu6=function(np){var ap;return ap=a$1().getBool("WEBGL_PACK")?new _u(np.shape,Fu):new su(np.shape,pu),this.compileAndRun(ap,[np])},_d.prototype.prelu=function(np,ap){var sp=a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ca(wa,np.shape,ap.shape):new ba(xa,np.shape,ap.shape);return this.compileAndRun(sp,[np,ap])},_d.prototype.elu=function(np){if(a$1().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(np,Ou,np.dtype);var ap=new su(np.shape,du);return this.compileAndRun(ap,[np])},_d.prototype.eluDer=function(np,ap){var sp=a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ca(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,np.shape,ap.shape):new ba("return (b >= 1.0) ? a : a * (b + 1.0);",np.shape,ap.shape);return this.compileAndRun(sp,[np,ap])},_d.prototype.selu=function(np){var ap=new su(np.shape,vu);return this.compileAndRun(ap,[np])},_d.prototype.int=function(np){var ap=new su(np.shape,"return float(int(x));");return this.compileAndRun(ap,[np],"int32")},_d.prototype.clip=function(np,ap,sp){var lp,up=(lp=a$1().getBool("WEBGL_PACK_CLIP")?new Ra(np.shape):new Ea(np.shape)).getCustomSetupFunc(ap,sp);return this.compileAndRun(lp,[np],null,up)},_d.prototype.abs=function(np){if(this.shouldExecuteOnCPU([np]))return this.cpuBackend.abs(np);if(a$1().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(np,hu,np.dtype);var ap=new su(np.shape,hu);return this.compileAndRun(ap,[np])},_d.prototype.complexAbs=function(np){var ap=this.texData.get(np.dataId),sp=new Ia(np.shape),lp=[this.makeComplexComponentTensorInfo(np,ap.complexTensors.real),this.makeComplexComponentTensorInfo(np,ap.complexTensors.imag)];return this.compileAndRun(sp,lp)},_d.prototype.sigmoid=function(np){var ap=new su(np.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(ap,[np])},_d.prototype.softplus=function(np){var ap=new su(np.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(ap,[np])},_d.prototype.sin=function(np){var ap=new su(np.shape,wu);return this.compileAndRun(ap,[np])},_d.prototype.cos=function(np){var ap=new su(np.shape,Cu);return this.compileAndRun(ap,[np])},_d.prototype.tan=function(np){var ap=new su(np.shape,"return tan(x);");return this.compileAndRun(ap,[np])},_d.prototype.asin=function(np){var ap=new su(np.shape,Eu);return this.compileAndRun(ap,[np])},_d.prototype.acos=function(np){var ap=new su(np.shape,Ru);return this.compileAndRun(ap,[np])},_d.prototype.atan=function(np){var ap=new su(np.shape,Iu);return this.compileAndRun(ap,[np])},_d.prototype.atan2=function(np,ap){var sp=a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ca(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,np.shape,ap.shape):new ba(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,np.shape,ap.shape);return this.compileAndRun(sp,[np,ap])},_d.prototype.sinh=function(np){var ap=new su(np.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(ap,[np])},_d.prototype.cosh=function(np){var ap=new su(np.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(ap,[np])},_d.prototype.tanh=function(np){var ap=new su(np.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(ap,[np])},_d.prototype.asinh=function(np){var ap=new su(np.shape,ku);return this.compileAndRun(ap,[np])},_d.prototype.acosh=function(np){var ap=new su(np.shape,Su);return this.compileAndRun(ap,[np])},_d.prototype.atanh=function(np){var ap=new su(np.shape,Au);return this.compileAndRun(ap,[np])},_d.prototype.erf=function(np){var ap=new su(np.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(ap,[np])},_d.prototype.step=function(np,ap){var sp=new su(np.shape,function(lp){return lp===void 0&&(lp=0),cu+`
    return x > 0.0 ? 1.0 : float(`+lp+`);
  `}(ap));return this.compileAndRun(sp,[np])},_d.prototype.conv2dByMatMul=function(np,ap,sp,lp,up,cp){var dp=np.shape,hp=this.texData.get(np.dataId),fp=sp.inChannels,pp=dp[0]*dp[1]*dp[2],mp=sp.outChannels,gp=sp.dataFormat==="channelsLast",yp=(pp===1||mp===1)&&fp>1e3,xp=dp[2]%2!=0&&!!hp.isPacked;if(yp||!a$1().getBool("WEBGL_LAZILY_UNPACK")||!a$1().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!xp){var _p=gp?dp[0]*dp[1]*dp[2]:dp[0]*dp[2]*dp[3],vp=this.reshape(np,[1,_p,sp.inChannels]),bp=this.reshape(ap,[1,sp.inChannels,sp.outChannels]);return this.reshape(this.fusedBatchMatMul({a:vp,b:bp,transposeA:!1,transposeB:!1,bias:lp,activation:up,preluActivationWeights:cp}),sp.outShape)}var Ep=gp?dp[0]*dp[1]*(dp[2]+1):dp[0]*dp[2]*(dp[3]+1),Sp={dataId:np.dataId,shape:[1,Ep,sp.inChannels],dtype:np.dtype},Ap=hp.shape;hp.shape=hp.shape.slice(),hp.shape[hp.shape.length-2]++,g(Se(hp.shape,Sp.shape),function(){return"packed reshape "+hp.shape+" to "+Sp.shape+" isn't free"});var Rp=this.reshape(ap,[1,sp.inChannels,sp.outChannels]),Tp=this.fusedBatchMatMul({a:Sp,b:Rp,transposeA:!1,transposeB:!1,bias:lp,activation:up,preluActivationWeights:cp}),Mp=this.texData.get(Tp.dataId);return g(Mp.isPacked,function(){return"batchMatMul result is expected to be packed"}),hp.shape=Ap,Mp.shape=sp.outShape,Nt.makeTensorFromDataId(Tp.dataId,sp.outShape,Tp.dtype)},_d.prototype.conv2dWithIm2Row=function(np,ap,sp,lp,up,cp){var dp=sp.filterWidth,hp=sp.filterHeight,fp=sp.inChannels,pp=sp.outWidth,mp=sp.outHeight,gp=sp.dataFormat==="channelsLast",yp=dp*hp*fp,xp=mp*pp,_p=[yp,xp],vp=np.squeeze([0]),bp=ap.reshape([1,yp,-1]),Ep=new Ri(_p,vp.shape,sp),Sp=this.compileAndRun(Ep,[vp]).reshape([1,_p[0],_p[1]]),Ap=lp!=null,Rp=cp!=null,Tp=up?Pu(up,!0):null,Mp=new Ti(Sp.shape,[1,xp,sp.outChannels],!0,!1,Ap,Tp,Rp),Op=[Sp,bp];lp&&Op.push(lp),Rp&&Op.push(cp);var Pp=this.compileAndRun(Mp,Op);return gp?Pp.reshape([1,mp,pp,sp.outChannels]):Pp.reshape([1,sp.outChannels,mp,pp])},_d.prototype.fusedConv2d=function(np){var ap=np.input,sp=np.filter,lp=np.convInfo,up=np.bias,cp=np.activation,dp=np.preluActivationWeights;if(lp.filterHeight===1&&lp.filterWidth===1&&lp.dilationHeight===1&&lp.dilationWidth===1&&lp.strideHeight===1&&lp.strideWidth===1&&(lp.padInfo.type==="SAME"||lp.padInfo.type==="VALID"))return this.conv2dByMatMul(ap,sp,lp,up,cp,dp);if(a$1().getBool("WEBGL_CONV_IM2COL")&&ap.shape[0]===1)return this.conv2dWithIm2Row(ap,sp,lp,up,cp,dp);var hp=up!=null,fp=dp!=null,pp=cp?Pu(cp,!1):null,mp=new Ma(lp,hp,pp,fp),gp=[ap,sp];return up&&gp.push(up),dp&&gp.push(dp),this.compileAndRun(mp,gp)},_d.prototype.conv2d=function(np,ap,sp){if(sp.filterHeight===1&&sp.filterWidth===1&&sp.dilationHeight===1&&sp.dilationWidth===1&&sp.strideHeight===1&&sp.strideWidth===1&&(sp.padInfo.type==="SAME"||sp.padInfo.type==="VALID"))return this.conv2dByMatMul(np,ap,sp);if(a$1().getBool("WEBGL_CONV_IM2COL")&&np.shape[0]===1)return this.conv2dWithIm2Row(np,ap,sp);var lp=new Ma(sp);return this.compileAndRun(lp,[np,ap])},_d.prototype.conv2dDerInput=function(np,ap,sp){var lp=new Ta(sp);return this.compileAndRun(lp,[np,ap])},_d.prototype.conv2dDerFilter=function(np,ap,sp){var lp=new Da(sp);return this.compileAndRun(lp,[np,ap])},_d.prototype.fusedDepthwiseConv2D=function(np){var ap,sp=np.input,lp=np.filter,up=np.convInfo,cp=np.bias,dp=np.activation,hp=np.preluActivationWeights,fp=a$1().getBool("WEBGL_PACK_DEPTHWISECONV")&&up.strideWidth<=2&&up.outChannels/up.inChannels==1,pp=dp?Pu(dp,fp):null,mp=[sp,lp],gp=cp!=null,yp=hp!=null;return gp&&mp.push(cp),yp&&mp.push(hp),fp?(ap=new La(up,gp,pp,yp),this.compileAndRun(ap,mp)):(ap=new Pa(up,gp,pp,yp),this.compileAndRun(ap,mp))},_d.prototype.depthwiseConv2D=function(np,ap,sp){var lp;return a$1().getBool("WEBGL_PACK_DEPTHWISECONV")&&sp.strideWidth<=2&&sp.outChannels/sp.inChannels==1?(lp=new La(sp),this.compileAndRun(lp,[np,ap])):(lp=new Pa(sp),this.compileAndRun(lp,[np,ap]))},_d.prototype.depthwiseConv2DDerInput=function(np,ap,sp){var lp=new _a(sp);return this.compileAndRun(lp,[np,ap])},_d.prototype.depthwiseConv2DDerFilter=function(np,ap,sp){var lp=new Oa(sp);return this.compileAndRun(lp,[np,ap])},_d.prototype.conv3d=function(np,ap,sp){var lp=new Ba(sp);return this.compileAndRun(lp,[np,ap])},_d.prototype.conv3dDerInput=function(np,ap,sp){var lp=new Fa(sp);return this.compileAndRun(lp,[np,ap])},_d.prototype.conv3dDerFilter=function(np,ap,sp){var lp=new Na(sp);return this.compileAndRun(lp,[np,ap])},_d.prototype.maxPool=function(np,ap){var sp=new Bi(ap,"max",!1);return this.compileAndRun(sp,[np])},_d.prototype.avgPool=function(np,ap){var sp=new Bi(ap,"avg",!1);return this.compileAndRun(sp,[np],"float32")},_d.prototype.maxPoolBackprop=function(np,ap,sp,lp){var up=new Bi(lp,"max",!0),cp=this.compileAndRun(up,[ap]),dp=new Ai(lp),hp=this.compileAndRun(dp,[np,cp],ap.dtype);return cp.dispose(),hp},_d.prototype.avgPoolBackprop=function(np,ap,sp){var lp=new ca(sp);return this.compileAndRun(lp,[np],ap.dtype)},_d.prototype.cast=function(np,ap){return So(np,ap,this)},_d.prototype.unstack=function(np,ap){for(var sp=np.shape[ap],lp=new Array(np.rank-1),up=0,cp=0;cp<np.rank;cp++)cp!==ap&&(lp[up++]=np.shape[cp]);var dp=new Array(np.rank).fill(0),hp=np.shape.slice();hp[ap]=1;var fp=new Array(sp);for(cp=0;cp<fp.length;cp++)dp[ap]=cp,fp[cp]=this.slice(np,dp,hp).reshape(lp);return fp},_d.prototype.avgPool3d=function(np,ap){var sp=new Pi(ap,"avg",!1);return this.compileAndRun(sp,[np],"float32")},_d.prototype.avgPool3dBackprop=function(np,ap,sp){var lp=new la(sp);return this.compileAndRun(lp,[np],ap.dtype)},_d.prototype.maxPool3d=function(np,ap){var sp=new Pi(ap,"max",!1);return this.compileAndRun(sp,[np],"float32")},_d.prototype.maxPool3dBackprop=function(np,ap,sp,lp){var up=new Pi(lp,"max",!0),cp=this.compileAndRun(up,[ap]),dp=new Di(lp),hp=this.compileAndRun(dp,[np,cp],ap.dtype);return cp.dispose(),hp},_d.prototype.reshape=function(np,ap){var sp=this.texData.get(np.dataId);if(sp.isPacked&&!Se(np.shape,ap)&&(sp.texture===null||!Se(sp.shape,ap))){var lp=this.packedReshape(np,ap);return Nt.makeTensorFromDataId(lp.dataId,lp.shape,lp.dtype)}return Ao(np,ap)},_d.prototype.resizeBilinear=function(np,ap,sp,lp){var up=a$1().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new zi(np.shape,ap,sp,lp):new Vi(np.shape,ap,sp,lp);return this.compileAndRun(up,[np])},_d.prototype.resizeBilinearBackprop=function(np,ap,sp){var lp=new Ui(np,ap,sp);return this.compileAndRun(lp,[np])},_d.prototype.resizeNearestNeighbor=function(np,ap,sp,lp){var up=new Hi(np.shape,ap,sp,lp);return this.compileAndRun(up,[np])},_d.prototype.resizeNearestNeighborBackprop=function(np,ap,sp){var lp=new Gi(np,ap,sp);return this.compileAndRun(lp,[np])},_d.prototype.multinomial=function(np,ap,sp,lp){var up=ap?np:io(np),cp=up.shape[0],dp=up.shape[1],hp=new Ni(cp,dp,sp),fp=hp.getCustomSetupFunc(lp);return this.compileAndRun(hp,[up],"int32",fp)},_d.prototype.oneHot=function(np,ap,sp,lp){var up=new Fi(np.size,ap,sp,lp);return this.compileAndRun(up,[np])},_d.prototype.diag=function(np){var ap=new qa(np.size);return this.compileAndRun(ap,[np])},_d.prototype.nonMaxSuppression=function(np,ap,sp,lp,up){return un("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Mo(np.dataSync(),ap.dataSync(),sp,lp,up)},_d.prototype.cropAndResize=function(np,ap,sp,lp,up,cp){var dp=new Wa(np.shape,ap.shape,lp,up,cp);return this.compileAndRun(dp,[np,ap,sp])},_d.prototype.depthToSpace=function(np,ap,sp){g(ap>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+ap});var lp=np.shape[0],up=sp==="NHWC"?np.shape[1]:np.shape[2],cp=sp==="NHWC"?np.shape[2]:np.shape[3],dp=sp==="NHWC"?np.shape[3]:np.shape[1],hp=up*ap,fp=cp*ap,pp=dp/(ap*ap),mp=new Ha(sp==="NHWC"?[lp,hp,fp,pp]:[lp,pp,hp,fp],ap,sp);return this.compileAndRun(mp,[np])},_d.prototype.split=function(np,ap,sp){return Po(np,ap,sp)},_d.prototype.scatterND=function(np,ap,sp){var lp=Hr(0,np,sp),up=lp.sliceRank,cp=lp.numUpdates,dp=lp.sliceSize,hp=lp.strides,fp=lp.outputSize,pp=[fp/dp,dp],mp=np.reshape([cp,up]),gp=ap.reshape([cp,dp]);if(fp===0)return Ao(kn([]),sp);var yp=An(0),xp=new ji(cp,up,mp.rank,gp.rank,hp,pp);return this.compileAndRun(xp,[gp,mp,yp]).reshape(sp)},_d.prototype.sparseToDense=function(np,ap,sp,lp){var up=Hr(0,np,sp),cp=up.sliceRank,dp=up.numUpdates,hp=up.strides,fp=up.outputSize,pp=new ji(dp,cp,np.rank,ap.rank,hp,[fp,1],!1);return this.compileAndRun(pp,[ap,np,lp]).reshape(sp)},_d.prototype.fft=function(np){return this.fftImpl(np,!1)},_d.prototype.ifft=function(np){return this.fftImpl(np,!0)},_d.prototype.fftImpl=function(np,ap){var sp=this.texData.get(np.dataId),lp=new Ja(Ya,np.shape,ap),up=new Ja(Qa,np.shape,ap),cp=[this.makeComplexComponentTensorInfo(np,sp.complexTensors.real),this.makeComplexComponentTensorInfo(np,sp.complexTensors.imag)],dp=this.compileAndRun(lp,cp),hp=this.compileAndRun(up,cp),fp=this.complex(dp,hp).as2D(np.shape[0],np.shape[1]);return dp.dispose(),hp.dispose(),fp},_d.prototype.gatherND=function(np,ap){var sp=ap.shape,lp=sp[sp.length-1],up=Ur(np,ap),cp=up[0],dp=up[1],hp=up[2],fp=up[3],pp=ap.reshape([dp,lp]),mp=np.reshape([np.size/hp,hp]),gp=new ri(lp,fp,[dp,hp]);return this.compileAndRun(gp,[mp,pp]).reshape(cp)},_d.prototype.fill=function(np,ap,sp){if((sp=sp||z(ap))==="string"){var lp=F(sp,w$1(np));return lp.fill(ap),Nt.makeTensor(lp,np,sp,this)}var up=new Za(np,ap),cp=up.getCustomSetupFunc(ap);return this.compileAndRun(up,[],sp,cp)},_d.prototype.onesLike=function(np){if(np.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(np.shape,1,np.dtype)},_d.prototype.zerosLike=function(np){return this.fill(np.shape,np.dtype==="string"?"":0,np.dtype)},_d.prototype.linspace=function(np,ap,sp){return Do(np,ap,sp)},_d.prototype.makeTensorInfo=function(np,ap){var sp=this.write(null,np,ap);return this.texData.get(sp).usage=null,{dataId:sp,shape:np,dtype:ap}},_d.prototype.makeOutput=function(np,ap){var sp=this.makeTensorInfo(np,ap).dataId;return Nt.makeTensorFromDataId(sp,np,ap,this)},_d.prototype.unpackTensor=function(np){var ap=new Mu(np.shape);return this.runWebGLProgram(ap,[np],np.dtype)},_d.prototype.packTensor=function(np){var ap=new Oi(np.shape);return this.runWebGLProgram(ap,[np],np.dtype,null,!0)},_d.prototype.packedReshape=function(np,ap){var sp=[Ce(np.shape)].concat(Ee(np.shape)),lp={dtype:np.dtype,shape:sp,dataId:np.dataId},up=[Ce(ap)].concat(Ee(ap)),cp=new Wi(up,sp),dp=this.runWebGLProgram(cp,[lp],np.dtype,null,!0);return{dataId:dp.dataId,shape:ap,dtype:dp.dtype}},_d.prototype.decode=function(np){var ap,sp=this.texData.get(np),lp=sp.isPacked,up=sp.shape,cp=sp.dtype,dp=Re(up);return ap=lp?new Ga(dp):new za(dp),{dtype:cp,shape:up,dataId:this.runWebGLProgram(ap,[{shape:dp,dtype:cp,dataId:np}],cp,null,!0).dataId}},_d.prototype.runWebGLProgram=function(np,ap,sp,lp,up){var cp=this;up===void 0&&(up=!1);var dp=this.makeTensorInfo(np.outputShape,sp),hp=this.texData.get(dp.dataId);if(np.packedOutput&&(hp.isPacked=!0),np.outPackingScheme===_t.DENSE){var fp=Gt(np.outputShape);hp.texShape=fp.map(function(Ep){return 2*Ep})}if(np.outTexUsage!=null&&(hp.usage=np.outTexUsage),w$1(dp.shape)===0)return hp.values=N(dp.dtype,0),dp;var pp=[],mp=ap.map(function(Ep){if(Ep.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var Sp=cp.texData.get(Ep.dataId);if(Sp.texture==null){if(!np.packedInputs&&w$1(Ep.shape)<=a$1().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:Ep.shape,texData:null,isUniform:!0,uniformValues:Sp.values};np.packedInputs&&(Sp.isPacked=!0,Sp.shape=Ep.shape)}else if(!!Sp.isPacked!=!!np.packedInputs)Ep=Sp.isPacked?cp.unpackTensor(Ep):cp.packTensor(Ep),pp.push(Ep),Sp=cp.texData.get(Ep.dataId);else if(Sp.isPacked&&!Se(Sp.shape,Ep.shape)){var Ap=Ep,Rp=Ep.shape;Ep.shape=Sp.shape,Ep=cp.packedReshape(Ep,Rp),pp.push(Ep),Sp=cp.texData.get(Ep.dataId),Ap.shape=Rp}return cp.uploadToGPU(Ep.dataId),{shape:Ep.shape,texData:Sp,isUniform:!1}});this.uploadToGPU(dp.dataId);var gp,yp={shape:dp.shape,texData:hp,isUniform:!1},xp=function(Ep,Sp,Ap){var Rp="";Sp.concat(Ap).forEach(function(Op){var Pp=Op.texData!=null&&Op.texData.slice!=null&&Op.texData.slice.flatOffset>0,$p=Op.isUniform?"uniform":Op.texData.texShape;Rp+=Op.shape+"_"+$p+"_"+Pp});var Tp=Ep.userCode,Mp=Ep.constructor.name;return Mp+="_"+Rp+"_"+Tp}(np,mp,yp),_p=this.getAndSaveBinary(xp,function(){return function(Ep,Sp,Ap,Rp){var Tp=Sp.userCode,Mp=Ap.map(function(Ip,kp){var Up={logicalShape:Ip.shape,texShape:Ip.isUniform?null:Ip.texData.texShape,isUniform:Ip.isUniform,isPacked:!Ip.isUniform&&Ip.texData.isPacked,flatOffset:null};return Ip.texData!=null&&Ip.texData.slice!=null&&Ip.texData.slice.flatOffset>0&&(Up.flatOffset=Ip.texData.slice.flatOffset),{name:Sp.variableNames[kp],shapeInfo:Up}}),Op=Mp.map(function(Ip){return Ip.shapeInfo}),Pp={logicalShape:Rp.shape,texShape:Rp.texData.texShape,isUniform:!1,isPacked:Rp.texData.isPacked,flatOffset:null},$p=Yo(Mp,Pp,Tp,Sp.packedInputs),zp=Ep.createProgram($p),Dp=null,Fp=Ep.getUniformLocation(zp,"NAN",!1);a$1().getNumber("WEBGL_VERSION")===1&&(Dp=Ep.getUniformLocation(zp,"INFINITY",!1));for(var jp={},Lp=0;Lp<Sp.variableNames.length;Lp++){var Bp=Sp.variableNames[Lp];jp[Bp]=Ep.getUniformLocation(zp,Bp,!1),jp["offset"+Bp]=Ep.getUniformLocation(zp,"offset"+Bp,!1)}return{program:Sp,source:$p,webGLProgram:zp,uniformLocations:jp,inShapeInfos:Op,outShapeInfo:Pp,infLoc:Dp,nanLoc:Fp}}(cp.gpgpu,np,mp,yp)}),vp=this.activeTimers!=null;if(vp&&(gp=this.startTimer()),function(Ep,Sp,Ap,Rp,Tp){Ei(Sp.inShapeInfos,Ap),Ei([Sp.outShapeInfo],[Rp]);var Mp=Rp.texData.texture,Op=Rp.texData.texShape;Rp.texData.isPacked?Ep.setOutputPackedMatrixTexture(Mp,Op[0],Op[1]):Ep.setOutputMatrixTexture(Mp,Op[0],Op[1]),Ep.setProgram(Sp.webGLProgram),a$1().getNumber("WEBGL_VERSION")===1&&Sp.infLoc!==null&&Ep.gl.uniform1f(Sp.infLoc,1/0),Sp.nanLoc!==null&&Ep.gl.uniform1f(Sp.nanLoc,NaN),Ap.forEach(function(Pp,$p){var zp=Sp.program.variableNames[$p],Dp=Sp.uniformLocations[zp],Fp=Sp.uniformLocations["offset"+zp];if(Dp!=null)if(Pp.isUniform)if(w$1(Pp.shape)<2)Ep.gl.uniform1f(Dp,Pp.uniformValues[0]);else{var jp=Pp.uniformValues;jp instanceof Float32Array||(jp=new Float32Array(jp)),Ep.gl.uniform1fv(Dp,jp)}else Pp.texData.slice!=null&&Fp!=null&&Ep.gl.uniform1i(Fp,Pp.texData.slice.flatOffset),Ep.setInputMatrixTexture(Pp.texData.texture,Dp,$p)}),Tp!=null&&Tp(Ep,Sp.webGLProgram),Ep.executeProgram()}(this.gpgpu,_p,mp,yp,lp),pp.forEach(function(Ep){return cp.disposeData(Ep.dataId)}),vp&&(gp=this.endTimer(gp),this.activeTimers.push({name:np.constructor.name,query:this.getQueryTime(gp)})),!a$1().getBool("WEBGL_LAZILY_UNPACK")&&hp.isPacked&&up===!1){var bp=this.unpackTensor(dp);return this.disposeData(dp.dataId),bp}return dp},_d.prototype.compileAndRun=function(np,ap,sp,lp,up){up===void 0&&(up=!1),sp=sp||ap[0].dtype;var cp=this.runWebGLProgram(np,ap,sp,lp,up);return Nt.makeTensorFromDataId(cp.dataId,cp.shape,cp.dtype)},_d.prototype.getAndSaveBinary=function(np,ap){return np in this.binaryCache||(this.binaryCache[np]=ap()),this.binaryCache[np]},_d.prototype.getTextureManager=function(){return this.textureManager},_d.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.fromPixels2DContext!=null&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},_d.prototype.floatPrecision=function(){var np=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=je(function(){if(!a$1().get("WEBGL_RENDER_FLOAT32_ENABLED")){var ap=a$1().getBool("DEBUG");a$1().set("DEBUG",!1);var sp=np.abs(An(1e-8)).dataSync()[0];if(a$1().set("DEBUG",ap),sp>0)return 32}return 16})),this.floatPrecisionValue},_d.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},_d.prototype.uploadToGPU=function(np){var ap,sp=this.texData.get(np),lp=sp.shape,up=sp.dtype,cp=sp.values,dp=sp.texture,hp=sp.usage,fp=sp.isPacked;if(dp==null){var pp,mp=this.activeTimers!=null;mp&&(pp=Y());var gp=sp.texShape;if(gp==null&&(gp=Ie(lp,fp),sp.texShape=gp),cp!=null){var yp=Re(lp),xp=void 0,_p=gp[1],vp=gp[0],bp=cp instanceof Uint8Array;fp?(_p=(ap=Ht(gp[0],gp[1]))[0],vp=ap[1],xp=new $a(yp,[vp,_p],bp)):xp=new Xa(yp,[vp,_p],bp);var Ep=this.makeTensorInfo([vp,_p],up);this.texData.get(Ep.dataId).usage=bp?Mt.PIXELS:Mt.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(Ep.dataId),_p,vp,cp);var Sp=this.runWebGLProgram(xp,[Ep],up,null,!0),Ap=this.texData.get(Sp.dataId);sp.texture=Ap.texture,sp.texShape=Ap.texShape,sp.isPacked=Ap.isPacked,sp.usage=Ap.usage,this.disposeData(Ep.dataId),this.texData.delete(Sp.dataId),sp.values=null,mp&&(this.uploadWaitMs+=Y()-pp)}else{var Rp=this.acquireTexture(gp,hp,up,fp);sp.texture=Rp}}},_d.prototype.convertAndCacheOnCPU=function(np,ap){var sp=this.texData.get(np),lp=sp.dtype;return this.releaseGPUData(np),ap!=null&&(sp.values=function(up,cp){if(cp==="float32"||cp==="complex64")return up;if(cp==="int32"||cp==="bool"){for(var dp=cp==="int32"?new Int32Array(up.length):new Uint8Array(up.length),hp=0;hp<dp.length;++hp)dp[hp]=Math.round(up[hp]);return dp}throw new Error("Unknown dtype "+cp)}(ap,lp)),sp.values},_d.prototype.acquireTexture=function(np,ap,sp,lp){if(this.numBytesInGPU+=this.computeBytes(np,sp),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var up=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+up+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(np,ap,lp)},_d.prototype.computeBytes=function(np,ap){return np[0]*np[1]*P(ap)},_d}(co);Ft()&&Nt.registerBackend("webgl",function(){return new Wu},2);var Uu=Cn({square_:function(rp){var _d=ln(rp,"x","square"),np=[_d];return Nt.runKernelFunc(function(ap,sp){return sp([_d]),ap.square(_d)},{x:_d},function(ap,sp){var lp=sp[0];return{x:function(){return ap.mul(lp.toFloat().mul(2))}}},"Square",{},np,[])}}),Vu=Cn({abs_:function(rp){var _d=ln(rp,"x","abs");return _d.dtype==="complex64"?Nt.runKernelFunc(function(np){return np.complexAbs(_d)},{$x:_d}):Nt.runKernelFunc(function(np,ap){var sp=np.abs(_d);return ap([_d]),sp},{x:_d},function(np,ap){var sp=ap[0];return{x:function(){return np.mul(sp.toFloat().step(-1))}}},"Abs")}}),zu=Cn({acos_:function(rp){var _d=ln(rp,"x","acos");return Nt.runKernelFunc(function(np,ap){var sp=np.acos(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.divStrict(An(1).sub(sp.toFloat().square()).sqrt()).neg()}}})}}),Gu=Cn({acosh_:function(rp){var _d=ln(rp,"x","acosh");return Nt.runKernelFunc(function(np,ap){var sp=np.acosh(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.divStrict(sp.toFloat().square().sub(1).sqrt())}}})}}),Hu=Cn({asin_:function(rp){var _d=ln(rp,"x","asin");return Nt.runKernelFunc(function(np,ap){var sp=np.asin(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.divStrict(An(1).sub(sp.toFloat().square()).sqrt())}}})}}),qu=Cn({asinh_:function(rp){var _d=ln(rp,"x","asinh");return Nt.runKernelFunc(function(np,ap){var sp=np.asinh(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.divStrict(An(1).add(sp.toFloat().square()).sqrt())}}})}}),Ku=Cn({atan_:function(rp){var _d=ln(rp,"x","atan");return Nt.runKernelFunc(function(np,ap){var sp=np.atan(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.div(sp.toFloat().square().add(1))}}})}}),ju=Cn({atanh_:function(rp){var _d=ln(rp,"x","atanh");return Nt.runKernelFunc(function(np,ap){var sp=np.atanh(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.div(An(1).sub(sp.toFloat().square()))}}})}}),Xu=Cn({ceil_:function(rp){var _d=ln(rp,"x","ceil");return Nt.runKernelFunc(function(np){return np.ceil(_d)},{$x:_d},function(np){return{$x:function(){return zn(np)}}})}}),$u=Cn({clipByValue_:function(rp,_d,np){var ap=ln(rp,"x","clipByValue");return g(_d<=np,function(){return"Error in clip: min ("+_d+") must be less than or equal to max ("+np+")."}),Nt.runKernelFunc(function(sp,lp){var up=sp.clip(ap,_d,np);return lp([ap]),up},{$x:ap},function(sp,lp){var up=lp[0];return{$x:function(){return sp.where(up.greaterEqual(_d).logicalAnd(up.lessEqual(np)),zn(sp))}}})}}),Yu=Cn({cos_:function(rp){var _d=ln(rp,"x","cos");return Nt.runKernelFunc(function(np,ap){var sp=np.cos(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return sp.toFloat().sin().neg().mul(np)}}})}}),Qu=Cn({cosh_:function(rp){var _d=ln(rp,"x","cosh");return Nt.runKernelFunc(function(np,ap){var sp=np.cosh(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return sp.toFloat().sinh().mulStrict(np)}}})}}),Ju=Cn({erf_:function(rp){var _d=ln(rp,"x","erf");return g(_d.dtype==="int32"||_d.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),_d.dtype==="int32"&&(_d=_d.toFloat()),Nt.runKernelFunc(function(np,ap){var sp=np.erf(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.mul(sp.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Zu=Cn({exp_:function(rp){var _d=ln(rp,"x","exp");return Nt.runKernelFunc(function(np,ap){var sp=np.exp(_d);return ap([sp]),sp},{$x:_d},function(np,ap){return{$x:function(){return np.mulStrict(ap[0])}}})}}),ts=Cn({expm1_:function(rp){var _d=ln(rp,"x","expm1");return Nt.runKernelFunc(function(np,ap){var sp=np.expm1(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.mul(sp.exp())}}})}}),es=Cn({floor_:function(rp){var _d=ln(rp,"x","floor");return Nt.runKernelFunc(function(np){return np.floor(_d)},{$x:_d},function(np){return{$x:function(){return zn(np)}}})}}),ns=Cn({log_:function(rp){var _d=ln(rp,"x","log");return Nt.runKernelFunc(function(np,ap){var sp=np.log(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.div(sp.toFloat())}}})}}),rs=Cn({log1p_:function(rp){var _d=ln(rp,"x","log1p");return Nt.runKernelFunc(function(np,ap){var sp=np.log1p(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.div(sp.add(1))}}})}}),os=Cn({logSigmoid_:function(rp){var _d=ln(rp,"x","logSigmoid");return Nt.runKernelFunc(function(np,ap){var sp=np.softplus(_d.neg()).neg();return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.mul(sp.neg().sigmoid())}}})}}),as=Cn({neg_:function(rp){var _d=ln(rp,"x","neg");return Nt.runKernelFunc(function(np){return np.neg(_d)},{$x:_d},function(np){return{$x:function(){return np.neg()}}})}}),is$1=Cn({reciprocal_:function(rp){var _d=ln(rp,"x","reciprocal");return Nt.runKernelFunc(function(np,ap){var sp=np.reciprocal(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.div(sp.square().neg())}}})}}),us=Cn({round_:function(rp){var _d=ln(rp,"x","round");return Nt.runKernelFunc(function(np){return np.round(_d)},{$x:_d},function(np){return{$x:function(){return zn(np)}}})}}),ss=Cn({rsqrt_:function(rp){var _d=ln(rp,"x","rsqrt");return Nt.runKernelFunc(function(np,ap){var sp=np.rsqrt(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.div(sp.pow(1.5).mul(2)).neg()}}})}}),cs=Cn({sigmoid_:function(rp){var _d=ln(rp,"x","sigmoid");return Nt.runKernelFunc(function(np,ap){var sp=np.sigmoid(_d);return ap([sp]),sp},{x:_d},function(np,ap){var sp=ap[0];return{x:function(){return np.mul(sp.mul(An(1).sub(sp)))}}},"Sigmoid")}}),ls=Cn({sign_:function(rp){var _d=ln(rp,"x","sign");return Nt.runKernelFunc(function(np){return np.sign(_d)},{$x:_d},function(np){return{$x:function(){return zn(np)}}})}}),hs=Cn({isNaN_:function(rp){var _d=ln(rp,"x","isNaN");return Nt.runKernelFunc(function(np){return np.isNaN(_d)},{$x:_d},function(np){return{$x:function(){return zn(np)}}})}}),fs=Cn({isInf_:function(rp){var _d=ln(rp,"x","isInf");return Nt.runKernelFunc(function(np){return np.isInf(_d)},{$x:_d},function(np){return{$x:function(){return zn(np)}}})}}),ps=Cn({isFinite_:function(rp){var _d=ln(rp,"x","isFinite");return Nt.runKernelFunc(function(np){return np.isFinite(_d)},{$x:_d},function(np){return{$x:function(){return zn(np)}}})}}),ds=Cn({sin_:function(rp){var _d=ln(rp,"x","sin");return Nt.runKernelFunc(function(np,ap){var sp=np.sin(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return sp.toFloat().cos().mul(np)}}})}}),vs=Cn({sinh_:function(rp){var _d=ln(rp,"x","sinh");return Nt.runKernelFunc(function(np,ap){var sp=np.sinh(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return sp.toFloat().cosh().mulStrict(np)}}})}}),ms=Cn({softplus_:function(rp){var _d=ln(rp,"x","softplus");return Nt.runKernelFunc(function(np,ap){var sp=np.softplus(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.mul(sp.sigmoid())}}})}}),gs=Cn({sqrt_:function(rp){var _d=ln(rp,"x","sqrt");return Nt.runKernelFunc(function(np,ap){var sp=np.sqrt(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.div(sp.toFloat().sqrt().mul(2))}}})}}),ys=Cn({step_:function(rp,_d){_d===void 0&&(_d=0);var np=ln(rp,"x","step");return Nt.runKernelFunc(function(ap){return ap.step(np,_d)},{$x:np},function(ap){return{$x:function(){return zn(ap)}}})}}),xs=Cn({tan_:function(rp){var _d=ln(rp,"x","tan");return Nt.runKernelFunc(function(np,ap){var sp=np.tan(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.div(sp.cos().square())}}})}}),bs=Cn({tanh_:function(rp){var _d=ln(rp,"x","tanh");return Nt.runKernelFunc(function(np,ap){var sp=np.tanh(_d);return ap([sp]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return An(1).sub(sp.square()).mulStrict(np)}}})}});function ws(rp,_d,np,ap,sp,lp){var up,cp,dp=ln(rp,"x","batchNorm"),hp=ln(_d,"mean","batchNorm"),fp=ln(np,"variance","batchNorm");return sp!=null&&(up=ln(sp,"scale","batchNorm")),ap!=null&&(cp=ln(ap,"offset","batchNorm")),g(dp.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+dp.rank+"."}),g(hp.rank===2||hp.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+hp.rank+"."}),g(fp.rank===2||fp.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+fp.rank+"."}),up!=null&&g(up.rank===2||up.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+up.rank+"."}),cp!=null&&g(cp.rank===2||cp.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+cp.rank+"."}),Rs(dp,hp,fp,cp,up,lp)}function Cs(rp,_d,np,ap,sp,lp){var up,cp,dp=ln(rp,"x","batchNorm"),hp=ln(_d,"mean","batchNorm"),fp=ln(np,"variance","batchNorm");return sp!=null&&(up=ln(sp,"scale","batchNorm")),ap!=null&&(cp=ln(ap,"offset","batchNorm")),g(dp.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+dp.rank+"."}),g(hp.rank===3||hp.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+hp.rank+"."}),g(fp.rank===3||fp.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+fp.rank+"."}),up!=null&&g(up.rank===3||up.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+up.rank+"."}),cp!=null&&g(cp.rank===3||cp.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+cp.rank+"."}),Rs(dp,hp,fp,cp,up,lp)}function Es(rp,_d,np,ap,sp,lp){var up,cp,dp=ln(rp,"x","batchNorm"),hp=ln(_d,"mean","batchNorm"),fp=ln(np,"variance","batchNorm");return sp!=null&&(up=ln(sp,"scale","batchNorm")),ap!=null&&(cp=ln(ap,"offset","batchNorm")),g(dp.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+dp.rank+"."}),g(hp.rank===4||hp.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+hp.rank+"."}),g(fp.rank===4||fp.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+fp.rank+"."}),up!=null&&g(up.rank===4||up.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+up.rank+"."}),cp!=null&&g(cp.rank===4||cp.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+cp.rank+"."}),Rs(dp,hp,fp,cp,up,lp)}function Rs(rp,_d,np,ap,sp,lp){lp==null&&(lp=.001);var up,cp,dp,hp=ln(rp,"x","batchNorm"),fp=ln(_d,"mean","batchNorm"),pp=ln(np,"variance","batchNorm");sp!=null&&(up=ln(sp,"scale","batchNorm")),ap!=null&&(cp=ln(ap,"offset","batchNorm")),g(fp.rank===pp.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),g(cp==null||fp.rank===cp.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),g(up==null||fp.rank===up.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),dp=hp.rank===0||hp.rank===1?hp.as4D(1,1,1,hp.size):hp.rank===2?hp.as4D(1,1,hp.shape[0],hp.shape[1]):hp.rank===3?hp.as4D(1,hp.shape[0],hp.shape[1],hp.shape[2]):hp;var mp=[hp,fp,pp,up];return Nt.runKernelFunc(function(gp,yp){var xp=gp.batchNormalization(dp,Is(fp),Is(pp),lp,Is(up),Is(cp));return yp([hp,fp,pp,up]),xp},{x:hp,mean:fp,variance:pp,scale:up,offset:cp},function(gp,yp){var xp=yp,_p=xp[0],vp=xp[1],bp=xp[2],Ep=xp[3],Sp=Ep??An(1),Ap=fo(vp.shape,dp.shape),Rp=[];if(vp.rank===1){for(var Tp=0;Tp<dp.shape.length-1;++Tp)Rp.push(dp.shape[Tp]);Rp.push(1)}var Mp=_p.sub(vp),Op=gp.mul(Sp),Pp=ss(bp.add(An(lp))),$p=Pp.mul(Pp).mul(Pp).mul(An(-.5));return{x:function(){return vp.rank===1?gp.mul(Nr(Pp.as4D(1,1,1,vp.shape[0]),Rp)).mul(Sp).reshape(_p.shape):gp.mul(Pp).mul(Sp).reshape(_p.shape)},mean:function(){var zp=Pp.mul(An(-1)).mul(Op);return vp.rank===1&&(zp=zp.sum(Ap)),zp.reshape(vp.shape)},variance:function(){var zp=$p.mul(Mp).mul(Op);return vp.rank===1&&(zp=zp.sum(Ap)),zp.reshape(vp.shape)},scale:function(){var zp=Mp.mul(Pp),Dp=gp.mul(zp);return vp.rank===1&&(Dp=Dp.sum(Ap)),Dp.reshape(vp.shape)},offset:function(){var zp=gp;return vp.rank===1&&(zp=zp.sum(Ap)),zp.reshape(vp.shape)}}},"BatchNormalization",{varianceEpsilon:lp},mp).reshape(hp.shape)}function Is(rp){return rp==null?null:rp.rank===0?rp.as1D():rp.rank===1?rp:rp.rank===2?rp.as4D(1,1,rp.shape[0],rp.shape[1]):rp.rank===3?rp.as4D(1,rp.shape[0],rp.shape[1],rp.shape[2]):rp}function ks(){ze("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Ss=Cn({batchNormalization2d_:function(rp,_d,np,ap,sp,lp){return ap===void 0&&(ap=.001),ks(),ws(rp,_d,np,lp,sp,ap)}}),As=Cn({batchNormalization3d_:function(rp,_d,np,ap,sp,lp){return ap===void 0&&(ap=.001),ks(),Cs(rp,_d,np,lp,sp,ap)}}),Ds=Cn({batchNormalization4d_:function(rp,_d,np,ap,sp,lp){return ap===void 0&&(ap=.001),ks(),Es(rp,_d,np,lp,sp,ap)}}),Ts=Cn({batchNormalization_:function(rp,_d,np,ap,sp,lp){return ap===void 0&&(ap=.001),ks(),Rs(rp,_d,np,lp,sp,ap)}}),Ns=Cn({batchNorm_:Rs}),Fs=Cn({batchNorm2d_:ws}),Os=Cn({batchNorm3d_:Cs}),_s=Cn({batchNorm4d_:Es}),Ms=Cn({logicalAnd_:function(rp,_d){var np=ln(rp,"a","logicalAnd","bool"),ap=ln(_d,"b","logicalAnd","bool");return po(np.shape,ap.shape),Nt.runKernelFunc(function(sp){return sp.logicalAnd(np,ap)},{$a:np,$b:ap})}}),Bs=Cn({logicalNot_:function(rp){var _d=ln(rp,"x","logicalNot","bool");return Nt.runKernelFunc(function(np){return np.logicalNot(_d)},{$x:_d})}}),Ps=Cn({logicalOr_:function(rp,_d){var np=ln(rp,"a","logicalOr","bool"),ap=ln(_d,"b","logicalOr","bool");return po(np.shape,ap.shape),Nt.runKernelFunc(function(sp){return sp.logicalOr(np,ap)},{$a:np,$b:ap})}}),Ls=Cn({logicalXor_:function(rp,_d){var np=ln(rp,"a","logicalXor","bool"),ap=ln(_d,"b","logicalXor","bool");return po(np.shape,ap.shape),Ps(rp,_d).logicalAnd(Ms(rp,_d).logicalNot())}}),Ws=Cn({where_:function(rp,_d,np){var ap=ln(_d,"a","where"),sp=ln(np,"b","where"),lp=ln(rp,"condition","where","bool");return y(ap.shape,sp.shape,"Error in where: "),lp.rank===1?g(lp.shape[0]===ap.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):y(lp.shape,sp.shape,"Error in where: "),Nt.runKernelFunc(function(up,cp){var dp=up.select(lp,ap,sp);return cp([lp]),dp},{$condition:lp,$a:ap,$b:sp},function(up,cp){var dp=cp[0];return{$condition:function(){return zn(dp).toFloat()},$a:function(){return up.mul(dp.cast(up.dtype))},$b:function(){return up.mul(dp.logicalNot().cast(up.dtype))}}})}}),Us=function(rp){return n$1(this,void 0,void 0,function(){var _d,np,ap;return r(this,function(sp){switch(sp.label){case 0:return[4,(_d=ln(rp,"condition","whereAsync","bool")).data()];case 1:return np=sp.sent(),ap=Uo(_d.shape,np),rp!==_d&&_d.dispose(),[2,ap]}})})},Vs=Cn({add_:function(rp,_d){var np,ap=ln(rp,"a","add"),sp=ln(_d,"b","add");np=Rt(ap,sp),ap=np[0],sp=np[1];var lp=po(ap.shape,sp.shape);return Nt.runKernelFunc(function(up){return up.add(ap,sp)},{a:ap,b:sp},function(up){return{a:function(){var cp=up,dp=fo(ap.shape,lp);return dp.length>0&&(cp=cp.sum(dp)),cp.reshape(ap.shape)},b:function(){var cp=up,dp=fo(sp.shape,lp);return dp.length>0&&(cp=cp.sum(dp)),cp.reshape(sp.shape)}}},"Add")}}),zs=Cn({addN_:function(rp){g(Array.isArray(rp),function(){return"The argument passed to tf.addN() must be a list of tensors"}),g(rp.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+rp.length});var _d=rp.map(function(sp,lp){return ln(sp,"tensors"+lp,"addN")}),np=_d[0];_d.forEach(function(sp){if(sp.dtype!==np.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),_d.forEach(function(sp){if(!C(sp.shape,np.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var ap=_d;return Nt.runKernelFunc(function(sp){return sp.addN(_d)},ap,function(sp){var lp={};return _d.forEach(function(up,cp){lp[cp]=function(){return sp.clone()}}),lp})}}),Gs=Cn({addStrict_:function(rp,_d){var np=ln(rp,"a","addStrict"),ap=ln(_d,"b","addStrict");return y(np.shape,ap.shape,"Error in addStrict: "),np.add(ap)}}),Hs=Cn({atan2_:function(rp,_d){var np,ap=ln(rp,"a","atan2"),sp=ln(_d,"b","atan2");np=Rt(ap,sp),ap=np[0],sp=np[1];var lp=po(ap.shape,sp.shape);return Nt.runKernelFunc(function(up,cp){var dp=up.atan2(ap,sp);return cp([ap,sp]),dp},{$a:ap,$b:sp},function(up,cp){var dp=cp[0],hp=cp[1];return{$a:function(){var fp=Vs(dp.square(),hp.square()),pp=up.mul(hp.div(fp)),mp=fo(dp.shape,lp);return mp.length>0&&(pp=pp.sum(mp)),pp.reshape(dp.shape)},$b:function(){var fp=Vs(dp.square(),hp.square()),pp=as(up.mul(dp.div(fp))),mp=fo(hp.shape,lp);return mp.length>0&&(pp=pp.sum(mp)),pp.reshape(hp.shape)}}})}}),qs=Cn({div_:function(rp,_d){var np,ap=ln(rp,"a","div"),sp=ln(_d,"b","div");if(np=Rt(ap,sp),ap=np[0],sp=np[1],ap.dtype==="int32"&&sp.dtype==="int32")return js(ap,sp);var lp=po(ap.shape,sp.shape);return Nt.runKernelFunc(function(up,cp){var dp=up.realDivide(ap,sp);return cp([ap,sp]),dp},{a:ap,b:sp},function(up,cp){var dp=cp[0],hp=cp[1];return{a:function(){var fp=up.div(hp.toFloat()),pp=fo(dp.shape,lp);return pp.length>0?fp.sum(pp).reshape(dp.shape):fp},b:function(){var fp=up.mul(dp.toFloat()),pp=fo(hp.shape,lp);pp.length>0&&(fp=fp.sum(pp).reshape(hp.shape));var mp=hp.square();return fp.div(mp.toFloat()).neg()}}},"Div")}}),Ks=Cn({divStrict_:function(rp,_d){var np=ln(rp,"a","div"),ap=ln(_d,"b","div");return y(np.shape,ap.shape,"Error in divideStrict: "),np.div(ap)}}),js=Cn({floorDiv_:function(rp,_d){var np,ap=ln(rp,"a","floorDiv"),sp=ln(_d,"b","floorDiv");np=Rt(ap,sp),ap=np[0],sp=np[1];var lp=po(ap.shape,sp.shape);return Nt.runKernelFunc(function(up,cp){var dp=up.floorDiv(ap,sp);return cp([ap,sp]),dp},{$a:ap,$b:sp},function(up,cp){var dp=cp[0],hp=cp[1];return{$a:function(){var fp=up.div(hp.toFloat()),pp=fo(dp.shape,lp);return pp.length>0?fp.sum(pp).reshape(dp.shape):fp},$b:function(){var fp=up.mul(dp.toFloat()),pp=fo(hp.shape,lp);pp.length>0&&(fp=fp.sum(pp).reshape(hp.shape));var mp=hp.square();return fp.div(mp.toFloat()).neg()}}})}}),Xs=Cn({maximum_:function(rp,_d){var np,ap=ln(rp,"a","maximum"),sp=ln(_d,"b","maximum");return np=Rt(ap,sp),ap=np[0],sp=np[1],ap.dtype==="bool"&&(ap=ap.toInt(),sp=sp.toInt()),po(ap.shape,sp.shape),Nt.runKernelFunc(function(lp,up){var cp=lp.maximum(ap,sp);return up([ap,sp]),cp},{$a:ap,$b:sp},function(lp,up){var cp=up[0],dp=up[1];return{$a:function(){return lp.mul(cp.greaterEqual(dp).toFloat())},$b:function(){return lp.mul(cp.less(dp).toFloat())}}})}}),$s=Cn({maximumStrict_:function(rp,_d){var np=ln(rp,"a","maximumStrict"),ap=ln(_d,"b","maximumStrict");return y(np.shape,ap.shape,"Error in maximumStrict: "),np.maximum(ap)}}),Ys=Cn({minimum_:function(rp,_d){var np,ap=ln(rp,"a","minimum"),sp=ln(_d,"b","minimum");return np=Rt(ap,sp),ap=np[0],sp=np[1],ap.dtype==="bool"&&(ap=ap.toInt(),sp=sp.toInt()),po(ap.shape,sp.shape),Nt.runKernelFunc(function(lp,up){var cp=lp.minimum(ap,sp);return up([ap,sp]),cp},{$a:ap,$b:sp},function(lp,up){var cp=up[0],dp=up[1];return{$a:function(){return lp.mul(cp.lessEqual(dp).toFloat())},$b:function(){return lp.mul(cp.greater(dp).toFloat())}}})}}),Qs=Cn({minimumStrict_:function(rp,_d){var np=ln(rp,"a","minimumStrict"),ap=ln(_d,"b","minimumStrict");return y(np.shape,ap.shape,"Error in minimumStrict: "),np.minimum(ap)}}),Js=Cn({mod_:function(rp,_d){var np,ap=ln(rp,"a","mod"),sp=ln(_d,"b","mod");np=Rt(ap,sp),ap=np[0],sp=np[1];var lp=po(ap.shape,sp.shape);return Nt.runKernelFunc(function(up,cp){var dp=up.mod(ap,sp);return cp([ap,sp]),dp},{$a:ap,$b:sp},function(up,cp){var dp=cp[0],hp=cp[1];return{$a:function(){var fp=fo(dp.shape,lp);return fp.length>0?up.sum(fp).reshape(dp.shape):up},$b:function(){var fp=up.mul(dp.div(hp).floor().neg()),pp=fo(hp.shape,lp);return pp.length>0?fp.sum(pp).reshape(hp.shape):fp}}})}}),Zs=Cn({modStrict_:function(rp,_d){var np=ln(rp,"a","modStrict"),ap=ln(_d,"b","modStrict");return y(np.shape,ap.shape,"Error in modStrict: "),np.mod(ap)}}),tc=Cn({mul_:function(rp,_d){var np,ap=ln(rp,"a","mul"),sp=ln(_d,"b","mul");np=Rt(ap,sp),ap=np[0],sp=np[1];var lp=po(ap.shape,sp.shape);return Nt.runKernelFunc(function(up,cp){var dp=up.multiply(ap,sp);return cp([ap,sp]),dp},{a:ap,b:sp},function(up,cp){var dp=cp[0],hp=cp[1];return{a:function(){var fp=up.mul(hp.toFloat()),pp=fo(dp.shape,lp);return pp.length>0?fp.sum(pp).reshape(dp.shape):fp},b:function(){var fp=up.mul(dp.toFloat()),pp=fo(hp.shape,lp);return pp.length>0?fp.sum(pp).reshape(hp.shape):fp}}},"Mul")}}),ec=Cn({mulStrict_:function(rp,_d){var np=ln(rp,"a","mul"),ap=ln(_d,"b","mul");return y(np.shape,ap.shape,"Error in multiplyStrict: "),np.mul(ap)}}),nc=Cn({pow_:function(rp,_d){var np=ln(rp,"base","pow"),ap=ln(_d,"exp","pow"),sp=po(np.shape,ap.shape);return rp=np.cast(Ct(np.dtype,ap.dtype)),_d=ap.cast(Ct(np.dtype,ap.dtype)),Nt.runKernelFunc(function(lp,up){var cp=lp.pow(np,ap);return up([np,ap,cp]),cp},{$base:np,$exp:ap},function(lp,up){var cp=up[0],dp=up[1],hp=up[2];return{$base:function(){var fp=dp.toFloat(),pp=lp.mul(fp.mul(cp.pow(fp.sub(An(1))))),mp=fo(cp.shape,sp);return mp.length>0&&(pp=pp.sum(mp)),pp.reshape(cp.shape)},$exp:function(){var fp=cp.greater(0),pp=cp.log().where(fp,zn(cp)),mp=lp.mul(hp.mul(pp)),gp=fo(dp.shape,sp);return gp.length>0&&(mp=mp.sum(gp)),mp.reshape(dp.shape)}}})}}),rc=Cn({powStrict_:function(rp,_d){return y(rp.shape,_d.shape,"Error in powStrict: "),rp.pow(_d)}}),oc=Cn({squaredDifference_:function(rp,_d){var np,ap=ln(rp,"a","squaredDifference"),sp=ln(_d,"b","squaredDifference");return np=Rt(ap,sp),ap=np[0],sp=np[1],po(ap.shape,sp.shape),Nt.runKernelFunc(function(lp,up){var cp=lp.squaredDifference(ap,sp);return up([ap,sp]),cp},{$a:ap,$b:sp},function(lp,up){var cp=up[0],dp=up[1],hp=An(2);return{$a:function(){return lp.mul(cp.sub(dp).mul(hp))},$b:function(){return lp.mul(dp.sub(cp).mul(hp))}}})}}),ac=Cn({squaredDifferenceStrict_:function(rp,_d){var np=ln(rp,"a","squaredDifferenceStrict"),ap=ln(_d,"b","squaredDifferenceStrict");return y(np.shape,ap.shape,"Error in squaredDifferenceStrict: "),np.squaredDifference(ap)}}),ic=Cn({sub_:function(rp,_d){var np,ap=ln(rp,"a","sub"),sp=ln(_d,"b","sub");np=Rt(ap,sp),ap=np[0],sp=np[1];var lp=po(ap.shape,sp.shape);return Nt.runKernelFunc(function(up){return up.subtract(ap,sp)},{a:ap,b:sp},function(up){return{a:function(){var cp=up,dp=fo(ap.shape,lp);return dp.length>0&&(cp=cp.sum(dp)),cp.reshape(ap.shape)},b:function(){var cp=up,dp=fo(sp.shape,lp);return dp.length>0&&(cp=cp.sum(dp)),cp.neg().reshape(sp.shape)}}},"Sub")}}),uc=Cn({subStrict_:function(rp,_d){var np=ln(rp,"a","subStrict"),ap=ln(_d,"b","subStrict");return y(np.shape,ap.shape,"Error in subStrict: "),np.sub(ap)}}),sc=Cn({equal_:function(rp,_d){var np,ap=ln(rp,"a","equal"),sp=ln(_d,"b","equal");return np=Rt(ap,sp),ap=np[0],sp=np[1],po(ap.shape,sp.shape),Nt.runKernelFunc(function(lp){return lp.equal(ap,sp)},{$a:ap,$b:sp})}}),cc=Cn({equalStrict_:function(rp,_d){var np=ln(rp,"a","equalStrict"),ap=ln(_d,"b","equalStrict");return y(np.shape,ap.shape,"Error in equalStrict: "),np.equal(ap)}}),lc=Cn({greater_:function(rp,_d){var np,ap=ln(rp,"a","greater"),sp=ln(_d,"b","greater");return np=Rt(ap,sp),ap=np[0],sp=np[1],po(ap.shape,sp.shape),Nt.runKernelFunc(function(lp){return lp.greater(ap,sp)},{$a:ap,$b:sp})}}),hc=Cn({greaterEqual_:function(rp,_d){var np,ap=ln(rp,"a","greaterEqual"),sp=ln(_d,"b","greaterEqual");return np=Rt(ap,sp),ap=np[0],sp=np[1],po(ap.shape,sp.shape),Nt.runKernelFunc(function(lp,up){var cp=lp.greaterEqual(ap,sp);return up([ap,sp]),cp},{$a:ap,$b:sp},function(lp,up){var cp=up[0],dp=up[1];return{$a:function(){return zn(cp)},$b:function(){return zn(dp)}}})}}),fc=Cn({greaterEqualStrict_:function(rp,_d){var np=ln(rp,"a","greaterEqualStrict"),ap=ln(_d,"b","greaterEqualStrict");return y(np.shape,ap.shape,"Error in greaterEqualStrict: "),np.greaterEqual(ap)}}),pc=Cn({greaterStrict_:function(rp,_d){var np=ln(rp,"a","greaterStrict"),ap=ln(_d,"b","greaterStrict");return y(np.shape,ap.shape,"Error in greaterStrict: "),np.greater(ap)}}),dc=Cn({less_:function(rp,_d){var np,ap=ln(rp,"a","less"),sp=ln(_d,"b","less");return np=Rt(ap,sp),ap=np[0],sp=np[1],po(ap.shape,sp.shape),Nt.runKernelFunc(function(lp){return lp.less(ap,sp)},{$a:ap,$b:sp})}}),vc=Cn({lessEqual_:function(rp,_d){var np,ap=ln(rp,"a","lessEqual"),sp=ln(_d,"b","lessEqual");return np=Rt(ap,sp),ap=np[0],sp=np[1],po(ap.shape,sp.shape),Nt.runKernelFunc(function(lp){return lp.lessEqual(ap,sp)},{$a:ap,$b:sp})}}),mc=Cn({lessEqualStrict_:function(rp,_d){var np=ln(rp,"a","lessEqualStrict"),ap=ln(_d,"b","lessEqualStrict");return y(np.shape,ap.shape,"Error in lessEqualStrict: "),np.lessEqual(ap)}}),gc=Cn({lessStrict_:function(rp,_d){var np=ln(rp,"a","lessStrict"),ap=ln(_d,"b","lessStrict");return y(np.shape,ap.shape,"Error in lessStrict: "),np.less(ap)}}),yc=Cn({notEqual_:function(rp,_d){var np,ap=ln(rp,"a","notEqual"),sp=ln(_d,"b","notEqual");return np=Rt(ap,sp),ap=np[0],sp=np[1],po(ap.shape,sp.shape),Nt.runKernelFunc(function(lp){return lp.notEqual(ap,sp)},{$a:ap,$b:sp})}}),xc=Cn({notEqualStrict_:function(rp,_d){var np=ln(rp,"a","notEqualStrict"),ap=ln(_d,"b","notEqualStrict");return y(np.shape,ap.shape,"Error in notEqualStrict: "),np.notEqual(ap)}});function bc(rp,_d){for(var np=[],ap=rp;ap<_d;++ap)np.push(ap);return np}function wc(rp){for(var _d=[],np=0;np<rp.length;++np)for(var ap=0;ap<rp[np].length;++ap)_d.push(rp[np][ap]);return _d}var Cc=Cn({gather_:function(rp,_d,np){np===void 0&&(np=0);var ap=ln(rp,"x","gather"),sp=ln(_d,"indices","gather","int32");np=D(np,ap.shape)[0];var lp=function(up,cp,dp){for(var hp=up.shape[dp],fp=[],pp=1,mp=1,gp=0;gp<dp;gp++)fp.push(up.shape[gp]),pp*=up.shape[gp];for(gp=0;gp<cp.rank;gp++)fp.push(cp.shape[gp]);for(gp=dp+1;gp<up.rank;gp++)fp.push(up.shape[gp]),mp*=up.shape[gp];return{batchSize:pp,sliceSize:mp,dimSize:hp,outputShape:fp}}(ap,sp,np);return Nt.runKernelFunc(function(up,cp){var dp=up.gather(ap,sp.flatten(),np);return cp([sp]),dp},{$x:ap},function(up,cp){var dp=cp[0];return{$x:function(){var hp=ap.shape,fp=dp.size,pp=hp.slice(0,np),mp=pp.length,gp=hp.slice(np,hp.length).slice(1),yp=gp.length,xp=bc(0,mp),_p=bc(mp+1,mp+1+yp),vp=wc([pp,[fp],gp]),bp=up.reshape(vp),Ep=dp.reshape([fp]),Sp=wc([[mp],xp,_p]),Ap=bp.transpose(Sp),Rp=Ec(Ap,Ep,ap.shape[np]),Tp=yn(Sp);return Rp=Rp.transpose(Tp)}}}).reshape(lp.outputShape)}}),Ec=Cn({unsortedSegmentSum_:function(rp,_d,np){var ap=ln(rp,"x","unsortedSegmentSum"),sp=ln(_d,"segmentIds","unsortedSegmentSum","int32");return g(E(np),function(){return"numSegments must be of dtype int"}),Nt.runKernelFunc(function(lp,up){var cp=lp.unsortedSegmentSum(ap,sp,np);return up([sp]),cp},{$x:ap},function(lp,up){var cp=up[0];return{$x:function(){return function(dp,hp){for(var fp=Xs(hp,zn(hp)),pp=Cc(dp,fp),mp=hc(hp,An(0,"int32")),gp=pp.rank-mp.rank,yp=0;yp<gp;++yp)mp=dr(mp,yp+1);mp=Ms(mp,Bn(pp.shape,"bool"));var xp=zn(pp);return Ws(mp,pp,xp)}(lp,cp)}}})}}),Rc=function(rp,_d,np){return n$1(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp;return r(this,function(_p){switch(_p.label){case 0:for(ap=ln(rp,"tensor","boolMask"),sp=ln(_d,"mask","boolMask","bool"),lp=np??0,up=sp.rank,cp=ap.shape,g(up>0,function(){return"mask cannot be scalar"}),y(cp.slice(lp,lp+up),sp.shape,"mask's shape must match the first K dimensions of tensor's shape,"),dp=1,hp=lp;hp<lp+up;hp++)dp*=cp[hp];return fp=cp.slice(0,lp).concat([dp],cp.slice(lp+up)),pp=ap.reshape(fp),mp=sp.reshape([-1]),[4,Us(mp)];case 1:return gp=_p.sent(),yp=gp.squeeze([1]),xp=Cc(pp,yp,lp),rp!==ap&&ap.dispose(),_d!==sp&&sp.dispose(),yp.dispose(),pp.dispose(),mp.dispose(),gp.dispose(),[2,xp]}})})};function Ic(rp,_d,np,ap,sp,lp,up){lp===void 0&&(lp="NHWC"),g(rp.length===_d.rank,function(){return"Length of inShape ("+rp.length+") and rank of dy ("+_d.rank+") must match"});var cp=rp,dp=_d,hp=!1;_d.rank===3&&(hp=!0,dp=_d.as4D(1,_d.shape[0],_d.shape[1],_d.shape[2]),cp=[1,rp[0],rp[1],rp[2]]),g(cp.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+cp.length+"."}),g(dp.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+dp.rank}),g(np.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+np.rank});var fp=lp==="NHWC"?cp[3]:cp[1],pp=lp==="NHWC"?dp.shape[3]:dp.shape[1];g(fp===np.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+fp+") must match input depth for filter "+np.shape[2]+"."}),g(pp===np.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+pp+") must match output depth for filter "+np.shape[3]+"."}),up!=null&&g(E(sp),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+up+" but got pad "+sp+"."});var mp=ko(lp),gp=go(cp,np.shape,ap,1,sp,up,!1,mp),yp=Nt.runKernelFunc(function(xp,_p){var vp=xp.conv2dDerInput(dp,np,gp);return _p([np,dp]),vp},{dy4D:dp,filter:np},function(xp,_p){var vp=_p[0],bp=_p[1];return{dy4D:function(){return Dc(xp,vp,ap,sp,lp,1,up)},filter:function(){return Nc(xp,bp,vp.shape,ap,sp,lp,up)}}});return hp?yp.as3D(yp.shape[1],yp.shape[2],yp.shape[3]):yp}function kc(rp){var _d=function(lp){return typeof lp=="number"?[lp,lp,lp]:lp.length===2?[lp[0],lp[1],1]:lp}(rp),np=_d[0],ap=_d[1],sp=_d[2];return np===1&&ap===1&&sp===1}function Sc(rp,_d,np,ap,sp){g(rp.length===_d.rank,function(){return"Length of inShape ("+rp.length+") and rank of dy ("+_d.rank+") must match"});var lp=rp,up=_d,cp=!1;_d.rank===4&&(cp=!0,up=_d.as5D(1,_d.shape[0],_d.shape[1],_d.shape[2],_d.shape[3]),lp=[1,rp[0],rp[1],rp[2],rp[3]]);var dp=lp[4],hp=up.shape[4];g(lp.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+lp.length+"."}),g(up.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+up.rank}),g(np.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+np.rank}),g(dp===np.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+dp+") must match input depth for filter "+np.shape[3]+"."}),g(hp===np.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+hp+") must match output depth for filter "+np.shape[4]+"."});var fp=yo(lp,np.shape,ap,1,sp),pp=Nt.runKernelFunc(function(mp){return mp.conv3dDerInput(up,np,fp)},{dy5D:up});return cp?pp.as4D(pp.shape[1],pp.shape[2],pp.shape[3],pp.shape[4]):pp}var Ac=Cn({conv1d_:function(rp,_d,np,ap,sp,lp,up){sp===void 0&&(sp="NWC"),lp===void 0&&(lp=1);var cp=ln(rp,"x","conv1d"),dp=ln(_d,"filter","conv1d"),hp=cp,fp=!1;cp.rank===2&&(fp=!0,hp=cp.as3D(1,cp.shape[0],cp.shape[1])),g(hp.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+hp.rank+"."}),g(dp.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+dp.rank+"."}),up!=null&&g(E(ap),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+up+" but got pad "+ap+"."}),g(hp.shape[2]===dp.shape[1],function(){return"Error in conv1d: depth of input ("+hp.shape[2]+") must match input depth for filter "+dp.shape[1]+"."}),g(Io(np,lp),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+np+" and dilation '"+lp+"'"}),g(sp==="NWC",function(){return"Error in conv1d: got dataFormat of "+sp+" but only NWC is currently supported."});var pp=dp.as4D(1,dp.shape[0],dp.shape[1],dp.shape[2]),mp=hp.as4D(hp.shape[0],1,hp.shape[1],hp.shape[2]),gp=Dc(mp,pp,[1,np],ap,"NHWC",[1,lp],up);return fp?gp.as2D(gp.shape[2],gp.shape[3]):gp.as3D(gp.shape[0],gp.shape[2],gp.shape[3])}}),Dc=Cn({conv2d_:function(rp,_d,np,ap,sp,lp,up){sp===void 0&&(sp="NHWC"),lp===void 0&&(lp=[1,1]);var cp=ln(rp,"x","conv2d"),dp=ln(_d,"filter","conv2d"),hp=cp,fp=!1;cp.rank===3&&(fp=!0,hp=cp.as4D(1,cp.shape[0],cp.shape[1],cp.shape[2])),g(hp.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+hp.rank+"."}),g(dp.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+dp.rank+"."}),up!=null&&g(E(ap),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+up+" but got pad "+ap+"."});var pp=sp==="NHWC"?hp.shape[3]:hp.shape[1];g(pp===dp.shape[2],function(){return"Error in conv2d: depth of input ("+pp+") must match input depth for filter "+dp.shape[2]+"."}),g(Io(np,lp),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+np+" and dilations '"+lp+"'"});var mp=ko(sp),gp=go(hp.shape,dp.shape,np,lp,ap,up,!1,mp),yp=Nt.runKernelFunc(function(xp,_p){var vp=xp.conv2d(hp,dp,gp);return _p([dp,hp]),vp},{x:hp,$filter:dp},function(xp,_p){var vp=_p,bp=vp[0],Ep=vp[1];return g(Ro(lp),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+lp+"'"}),{x:function(){return Fc(Ep.shape,xp,bp,np,ap,sp)},$filter:function(){return Nc(Ep,xp,bp.shape,np,ap,sp)}}});return fp?yp.as3D(yp.shape[1],yp.shape[2],yp.shape[3]):yp}}),Tc=Cn({conv3d_:function(rp,_d,np,ap,sp,lp){sp===void 0&&(sp="NDHWC"),lp===void 0&&(lp=[1,1,1]);var up=ln(rp,"x","conv3d"),cp=ln(_d,"filter","conv3d"),dp=up,hp=!1;up.rank===4&&(hp=!0,dp=up.as5D(1,up.shape[0],up.shape[1],up.shape[2],up.shape[3])),g(dp.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+dp.rank+"."}),g(cp.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+cp.rank+"."}),g(dp.shape[4]===cp.shape[3],function(){return"Error in conv3d: depth of input ("+dp.shape[4]+") must match input depth for filter "+cp.shape[3]+"."}),g(function(mp,gp){return kc(mp)||kc(gp)}(np,lp),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+np+" and dilations '"+lp+"'"}),g(sp==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+sp+" but only NDHWC is currently supported."});var fp=yo(dp.shape,cp.shape,np,lp,ap),pp=Nt.runKernelFunc(function(mp,gp){var yp=mp.conv3d(dp,cp,fp);return gp([dp,cp]),yp},{x:dp,$filter:cp},function(mp,gp){g(kc(lp),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+lp+"'"});var yp=gp[0],xp=gp[1];return{x:function(){return Sc(yp.shape,mp,xp,np,ap)},$filter:function(){return function(_p,vp,bp,Ep,Sp){var Ap=_p;_p.rank===4&&(Ap=_p.as5D(1,_p.shape[0],_p.shape[1],_p.shape[2],_p.shape[3]));var Rp=vp;Rp.rank===4&&(Rp=vp.as5D(1,vp.shape[0],vp.shape[1],vp.shape[2],vp.shape[3])),g(Ap.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+Ap.shape+"."}),g(Rp.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+Rp.shape+"."}),g(bp.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+bp+"."}),g(Ap.shape[4]===bp[3],function(){return"Error in conv3dDerFilter: depth of input "+Ap.shape[4]+") must match input depth in filter ("+bp[3]+"."}),g(Rp.shape[4]===bp[4],function(){return"Error in conv3dDerFilter: depth of dy ("+Rp.shape[4]+") must match output depth for filter ("+bp[4]+")."});var Tp=yo(Ap.shape,bp,Ep,1,Sp);return Nt.runKernelFunc(function(Mp){return Mp.conv3dDerFilter(Ap,Rp,Tp)},{x5D:Ap,dy5D:Rp})}(yp,mp,xp.shape,np,ap)}}});return hp?pp.as4D(pp.shape[1],pp.shape[2],pp.shape[3],pp.shape[4]):pp}}),Nc=Cn({conv2dDerFilter_:function(rp,_d,np,ap,sp,lp,up){lp===void 0&&(lp="NHWC");var cp=rp;rp.rank===3&&(cp=rp.as4D(1,rp.shape[0],rp.shape[1],rp.shape[2]));var dp=_d;dp.rank===3&&(dp=_d.as4D(1,_d.shape[0],_d.shape[1],_d.shape[2])),g(cp.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+cp.shape+"."}),g(dp.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+dp.shape+"."}),g(np.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+np+"."});var hp=lp==="NHWC"?cp.shape[3]:cp.shape[1],fp=lp==="NHWC"?dp.shape[3]:dp.shape[1];g(hp===np[2],function(){return"Error in conv2dDerFilter: depth of input "+hp+") must match input depth in filter ("+np[2]+"."}),g(fp===np[3],function(){return"Error in conv2dDerFilter: depth of dy ("+fp+") must match output depth for filter ("+np[3]+")."}),up!=null&&g(E(sp),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+up+" but got pad "+sp+"."});var pp=ko(lp),mp=go(cp.shape,np,ap,1,sp,up,!1,pp);return Nt.runKernelFunc(function(gp){return gp.conv2dDerFilter(cp,dp,mp)},{x4D:cp,dy4D:dp})}}),Fc=Cn({conv2dDerInput_:Ic}),Oc=Cn({depthwiseConv2d_:function(rp,_d,np,ap,sp,lp,up){lp===void 0&&(lp=[1,1]);var cp=ln(rp,"x","depthwiseConv2d"),dp=ln(_d,"filter","depthwiseConv2d"),hp=cp,fp=!1;cp.rank===3&&(fp=!0,hp=cp.as4D(1,cp.shape[0],cp.shape[1],cp.shape[2])),g(hp.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+hp.rank+"."}),g(dp.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+dp.rank+"."}),g(hp.shape[3]===dp.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+hp.shape[3]+") must match the inChannels dimension in filter "+dp.shape[2]+"."}),lp==null&&(lp=[1,1]),g(Io(np,lp),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+np+" and dilations '"+lp+"'"}),up!=null&&g(E(ap),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+up+" but got pad "+ap+"."});var pp=go(hp.shape,dp.shape,np,lp,ap,up,!0),mp=Nt.runKernelFunc(function(gp,yp){var xp=gp.depthwiseConv2D(hp,dp,pp);return yp([hp,dp]),xp},{x:hp,$filter:dp},function(gp,yp){g(Ro(lp),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+lp+"'"});var xp=yp[0],_p=yp[1];return{x:function(){return _c(xp.shape,gp,_p,pp)},$filter:function(){return Mc(xp,gp,_p.shape,pp)}}});return fp?mp.as3D(mp.shape[1],mp.shape[2],mp.shape[3]):mp}}),_c=Cn({depthwiseConv2dDerInput_:function(rp,_d,np,ap){var sp=_d,lp=!1;_d.rank===3&&(lp=!0,sp=_d.as4D(1,_d.shape[0],_d.shape[1],_d.shape[2]));var up=Nt.runKernelFunc(function(cp){return cp.depthwiseConv2DDerInput(sp,np,ap)},{dy4D:sp});return lp?up.as3D(up.shape[1],up.shape[2],up.shape[3]):up}}),Mc=Cn({depthwiseConv2dDerFilter_:function(rp,_d,np,ap){var sp=rp;rp.rank===3&&(sp=rp.as4D(1,rp.shape[0],rp.shape[1],rp.shape[2]));var lp=_d;return lp.rank===3&&(lp=_d.as4D(1,_d.shape[0],_d.shape[1],_d.shape[2])),Nt.runKernelFunc(function(up){return up.depthwiseConv2DDerFilter(sp,lp,ap)},{x4D:sp,dy4D:lp})}}),Bc=Cn({separableConv2d_:function(rp,_d,np,ap,sp,lp,up){lp===void 0&&(lp=[1,1]),up===void 0&&(up="NHWC");var cp=ln(rp,"x","separableConv2d"),dp=ln(_d,"depthwiseFilter","separableConv2d"),hp=ln(np,"pointwiseFilter","separableConv2d"),fp=cp,pp=!1;if(cp.rank===3&&(pp=!0,fp=cp.as4D(1,cp.shape[0],cp.shape[1],cp.shape[2])),up==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");g(fp.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+fp.rank+"."}),g(dp.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+dp.rank+"."}),g(hp.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+dp.rank+"."}),g(hp.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+hp.shape[0]+"."}),g(hp.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+hp.shape[1]+"."});var mp=dp.shape[2],gp=dp.shape[3];g(hp.shape[2]===mp*gp,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+mp*gp+", but got "+hp.shape[2]+"."});var yp=Oc(fp,dp,ap,sp,up,lp),xp=Dc(yp,hp,1,"valid",up);return pp?xp.as3D(xp.shape[1],xp.shape[2],xp.shape[3]):xp}}),Pc=Cn({conv2dTranspose_:function(rp,_d,np,ap,sp,lp){return Ic(np,ln(rp,"x","conv2dTranspose"),ln(_d,"filter","conv2dTranspose"),ap,sp,"NHWC",lp)}}),Lc=Cn({conv3dTranspose_:function(rp,_d,np,ap,sp){return Sc(np,ln(rp,"x","conv3dTranspose"),ln(_d,"filter","conv3dTranspose"),ap,sp)}}),Wc=Cn({matMul_:function(rp,_d,np,ap){var sp;np===void 0&&(np=!1),ap===void 0&&(ap=!1);var lp=ln(rp,"a","matMul"),up=ln(_d,"b","matMul");sp=Rt(lp,up),lp=sp[0],up=sp[1];var cp=np?lp.shape[lp.rank-2]:lp.shape[lp.rank-1],dp=ap?up.shape[up.rank-1]:up.shape[up.rank-2],hp=np?lp.shape[lp.rank-1]:lp.shape[lp.rank-2],fp=ap?up.shape[up.rank-2]:up.shape[up.rank-1],pp=lp.shape.slice(0,-2),mp=up.shape.slice(0,-2),gp=w$1(pp),yp=w$1(mp);g(lp.rank>=2&&up.rank>=2&&lp.rank===up.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+lp.rank+" and "+up.rank+"."}),g(C(pp,mp),function(){return"Error in matMul: outer dimensions ("+pp+") and ("+mp+") of Tensors with shapes "+lp.shape+" and "+up.shape+" must match."}),g(cp===dp,function(){return"Error in matMul: inner shapes ("+cp+") and ("+dp+") of Tensors with shapes "+lp.shape+" and "+up.shape+" and transposeA="+np+" and transposeB="+ap+" must match."});var xp=lp.shape.slice(0,-2).concat([hp,fp]),_p=np?lp.as3D(gp,cp,hp):lp.as3D(gp,hp,cp),vp=ap?up.as3D(yp,fp,dp):up.as3D(yp,dp,fp),bp={transposeA:np,transposeB:ap};return Nt.runKernelFunc(function(Ep,Sp){var Ap=Ep.batchMatMul(_p,vp,np,ap);return Sp([_p,vp]),Ap},{a:_p,b:vp},function(Ep,Sp){var Ap=Sp,Rp=Ap[0],Tp=Ap[1];return np||ap?!np&&ap?{a:function(){return Ep.matMul(Tp,!1,!1)},b:function(){return Ep.matMul(Rp,!0,!1)}}:np&&!ap?{a:function(){return Tp.matMul(Ep,!1,!0)},b:function(){return Rp.matMul(Ep,!1,!1)}}:{a:function(){return Tp.matMul(Ep,!0,!0)},b:function(){return Ep.matMul(Rp,!0,!0)}}:{a:function(){return Ep.matMul(Tp,!1,!0)},b:function(){return Rp.matMul(Ep,!0,!1)}}},"BatchMatMul",bp).reshape(xp)}}),Uc=Cn({dot_:function(rp,_d){var np=ln(rp,"t1","dot"),ap=ln(_d,"t2","dot");g(!(np.rank!==1&&np.rank!==2||ap.rank!==1&&ap.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+np.rank+" and "+ap.rank+"."});var sp=np.rank===1?np.size:np.shape[1],lp=ap.rank===1?ap.size:ap.shape[0];return g(sp===lp,function(){return"Error in dot: inner dimensions of inputs must match, but got "+sp+" and "+lp+"."}),np.rank===1&&ap.rank===1?np.as2D(1,-1).matMul(ap.as2D(-1,1)).asScalar():np.rank===1&&ap.rank===2?np.as2D(1,-1).matMul(ap.as2D(ap.shape[0],ap.shape[1])).as1D():np.rank===2&&ap.rank===1?np.matMul(ap.as2D(-1,1)).as1D():np.matMul(ap.as2D(ap.shape[0],ap.shape[1]))}}),Vc=Cn({outerProduct_:function(rp,_d){var np=ln(rp,"v1","outerProduct"),ap=ln(_d,"v2","outerProduct");return g(np.rank===1&&ap.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+np.rank+" and "+ap.rank+"."}),np.as2D(-1,1).matMul(ap.as2D(1,-1))}}),zc=Cn({reverse_:function(rp,_d){var np=ln(rp,"x","reverse");if(np.rank===0)return np.clone();var ap=D(_d,np.shape);return Nt.runKernelFunc(function(sp){return sp.reverse(np,ap)},{$x:np},function(sp){return{$x:function(){return sp.reverse(ap)}}}).reshapeAs(np)}}),Gc=Cn({reverse1d_:function(rp){var _d=ln(rp,"x","reverse");return g(_d.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+_d.rank+"."}),zc(_d,0)}}),Hc=Cn({reverse2d_:function(rp,_d){var np=ln(rp,"x","reverse");return g(np.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+np.rank+"."}),zc(np,_d)}}),qc=Cn({reverse3d_:function(rp,_d){var np=ln(rp,"x","reverse");return g(np.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+np.rank+"."}),zc(np,_d)}}),Kc=Cn({reverse4d_:function(rp,_d){var np=ln(rp,"x","reverse");return g(np.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+np.rank+"."}),zc(np,_d)}});function jc(rp,_d,np,ap,sp,lp){var up=ln(rp,"x","maxPool"),cp=up,dp=!1;up.rank===3&&(dp=!0,cp=up.as4D(1,up.shape[0],up.shape[1],up.shape[2])),ap==null&&(ap=[1,1]),g(cp.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+cp.rank+"."}),g(Io(np,ap),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+np+" and dilations '"+ap+"'"}),lp!=null&&g(E(sp),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+lp+" but got pad "+sp+"."});var hp=vo(cp.shape,_d,np,ap,sp,lp),fp=Nt.runKernelFunc(function(pp,mp){var gp=pp.maxPool(cp,hp);return mp([cp,gp]),gp},{x:cp},function(pp,mp){var gp=mp[0],yp=mp[1];return{x:function(){return function(xp,_p,vp,bp,Ep,Sp,Ap,Rp){var Tp=ln(xp,"dy","maxPoolBackprop"),Mp=ln(_p,"input","maxPoolBackprop"),Op=ln(vp,"output","maxPoolBackprop");g(Mp.rank===Tp.rank,function(){return"Rank of input ("+Mp.rank+") does not match rank of dy ("+Tp.rank+")"}),Sp==null&&(Sp=[1,1]),g(Io(Ep,Sp),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+Ep+" and dilations '"+Sp+"'"}),g(Tp.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+Tp.rank+"."}),g(Mp.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+Mp.rank+"."}),Rp!=null&&g(E(Ap),function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+Rp+" but got pad "+Ap+"."});var Pp=vo(Mp.shape,bp,Ep,Sp,Ap,Rp);return Nt.runKernelFunc(function($p){return $p.maxPoolBackprop(Tp,Mp,Op,Pp)},{$dy:Tp,$input:Mp})}(pp,gp,yp,_d,np,ap,sp)}}});return dp?fp.as3D(fp.shape[1],fp.shape[2],fp.shape[3]):fp}function Xc(rp,_d,np,ap,sp,lp){var up=ln(rp,"x","avgPool","float32");ap==null&&(ap=[1,1]),g(Io(np,ap),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+np+" and dilations '"+ap+"'"});var cp=up,dp=!1;up.rank===3&&(dp=!0,cp=up.as4D(1,up.shape[0],up.shape[1],up.shape[2])),g(cp.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+cp.rank+"."}),lp!=null&&g(E(sp),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+lp+" but got pad "+sp+"."});var hp=vo(cp.shape,_d,np,ap,sp,lp),fp=Nt.runKernelFunc(function(pp){return pp.avgPool(cp,hp)},{x:cp},function(pp){return{x:function(){return function(mp,gp,yp,xp,_p,vp){var bp=ln(mp,"dy","avgPoolBackprop"),Ep=ln(gp,"input","avgPoolBackprop");g(Ep.rank===bp.rank,function(){return"Rank of input ("+Ep.rank+") does not match rank of dy ("+bp.rank+")"}),_p==null&&(_p=[1,1]),g(Io(xp,_p),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+xp+" and dilations '"+_p+"'"});var Sp=Ep,Ap=bp,Rp=!1;Ep.rank===3&&(Rp=!0,Sp=Ep.as4D(1,Ep.shape[0],Ep.shape[1],Ep.shape[2]),Ap=bp.as4D(1,bp.shape[0],bp.shape[1],bp.shape[2])),g(Ap.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+Ap.rank+"."}),g(Sp.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+Sp.rank+"."});var Tp=vo(Sp.shape,yp,xp,_p,vp),Mp=Nt.runKernelFunc(function(Op){return Op.avgPoolBackprop(Ap,Sp,Tp)},{dy4D:Ap,input4D:Sp});return Rp?Mp.as3D(Mp.shape[1],Mp.shape[2],Mp.shape[3]):Mp}(pp,cp,_d,np,ap,sp)}}});return fp=fp.cast(up.dtype),dp?fp.as3D(fp.shape[1],fp.shape[2],fp.shape[3]):fp}var $c=Cn({maxPool_:function(rp,_d,np,ap,sp){return jc(rp,_d,np,1,ap,sp)}}),Yc=Cn({avgPool_:function(rp,_d,np,ap,sp){return Xc(rp,_d,np,1,ap,sp)}}),Qc=Cn({pool_:function(rp,_d,np,ap,sp,lp){sp==null&&(sp=[1,1]),lp==null&&(lp=1),ap===0&&(ap="valid");var up=ln(rp,"x","maxPool"),cp=up,dp=!1;up.rank===3&&(dp=!0,cp=up.as4D(1,up.shape[0],up.shape[1],up.shape[2])),g(Io(lp,sp),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+lp+" and dilations '"+sp+"'"});var hp,fp=vo(cp.shape,_d,lp,sp,ap),pp=[fp.dilationHeight,fp.dilationWidth];hp=ap==="same"?function(Sp,Ap){var Rp=Sp.map(function(Op,Pp){return Op+(Op-1)*(Ap[Pp]-1)}).map(function(Op){return Op-1}),Tp=Rp.map(function(Op){return Math.floor(Op/2)}),Mp=Rp.map(function(Op,Pp){return Op-Tp[Pp]});return Rp.map(function(Op,Pp){return[Tp[Pp],Mp[Pp]]})}([fp.filterHeight,fp.filterWidth],pp):[[0,0],[0,0]];var mp=pp[0]===1&&pp[1]===1,gp=function(Sp,Ap,Rp){var Tp=Rp.map(function(Fp){return Fp[0]}),Mp=Rp.map(function(Fp){return Fp[1]}),Op=Sp.concat(Tp,Mp),Pp=Ap.map(function(Fp,jp){return(Fp-Op[jp]%Fp)%Fp}),$p=Mp.map(function(Fp,jp){return Fp+Pp[jp]}),zp=Ap.map(function(Fp,jp){return[Tp[jp],$p[jp]]}),Dp=Ap.map(function(Fp,jp){return[0,Pp[jp]]});return[zp,Dp]}([fp.inHeight,fp.inWidth],pp,hp),yp=gp[0],xp=gp[1],_p=mp?ap:"valid",vp=mp?cp:Ar(cp,pp,yp),bp=(np==="avg"?function(){return Xc(vp,_d,lp,1,_p)}:function(){return jc(vp,_d,lp,1,_p)})(),Ep=mp?bp:cr(bp,pp,xp);return dp?Ep.as3D(Ep.shape[1],Ep.shape[2],Ep.shape[3]):Ep}}),Jc=Cn({maxPool3d_:function(rp,_d,np,ap,sp,lp,up){lp===void 0&&(lp="NDHWC");var cp=ln(rp,"x","maxPool3d"),dp=cp,hp=!1;cp.rank===4&&(hp=!0,dp=cp.as5D(1,cp.shape[0],cp.shape[1],cp.shape[2],cp.shape[3])),up==null&&(up=[1,1,1]),g(dp.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+dp.rank+"."}),g(lp==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+lp}),g(Io(np,up),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+np+" and dilations '"+up+"'"}),sp!=null&&g(E(ap),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+sp+" but got pad "+ap+"."});var fp=mo(dp.shape,_d,np,up,ap,sp,lp),pp=Nt.runKernelFunc(function(mp,gp){var yp=mp.maxPool3d(dp,fp);return gp([dp,yp]),yp},{x:dp},function(mp,gp){var yp=gp[0],xp=gp[1];return{x:function(){return function(_p,vp,bp,Ep,Sp,Ap,Rp,Tp){var Mp=ln(_p,"dy","maxPool3dBackprop"),Op=ln(vp,"input","maxPool3dBackprop"),Pp=ln(bp,"output","maxPool3dBackprop"),$p=Mp,zp=Op,Dp=Pp,Fp=!1;Op.rank===4&&(Fp=!0,$p=Mp.as5D(1,Mp.shape[0],Mp.shape[1],Mp.shape[2],Mp.shape[3]),zp=Op.as5D(1,Op.shape[0],Op.shape[1],Op.shape[2],Op.shape[3]),Dp=Pp.as5D(1,Pp.shape[0],Pp.shape[1],Pp.shape[2],Pp.shape[3])),g($p.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+$p.rank+"."}),g(zp.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+zp.rank+"."}),g(Dp.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+Dp.rank+"."}),Ap==null&&(Ap=[1,1,1]),g(Io(Sp,Ap),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+Sp+" and dilations '"+Ap+"'"}),Tp!=null&&g(E(Rp),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+Tp+" but got pad "+Rp+"."});var jp=mo(zp.shape,Ep,Sp,Ap,Rp,Tp),Lp=Nt.runKernelFunc(function(Bp){return Bp.maxPool3dBackprop($p,zp,Dp,jp)},{dy5D:$p,input5D:zp});return Fp?Lp.as4D(Lp.shape[1],Lp.shape[2],Lp.shape[3],Lp.shape[4]):Lp}(mp,yp,xp,_d,np,up,ap,sp)}}});return hp?pp.as4D(pp.shape[1],pp.shape[2],pp.shape[3],pp.shape[4]):pp}}),Zc=Cn({avgPool3d_:function(rp,_d,np,ap,sp,lp,up){lp===void 0&&(lp="NDHWC");var cp=ln(rp,"x","avgPool3d","float32"),dp=cp,hp=!1;cp.rank===4&&(hp=!0,dp=cp.as5D(1,cp.shape[0],cp.shape[1],cp.shape[2],cp.shape[3])),up==null&&(up=[1,1,1]),g(dp.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+dp.rank+"."}),g(lp==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+lp}),g(Io(np,up),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+np+" and dilations '"+up+"'"}),sp!=null&&g(E(ap),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+sp+" but got pad "+ap+"."});var fp=mo(dp.shape,_d,np,up,ap,sp,lp),pp=Nt.runKernelFunc(function(mp){return mp.avgPool3d(dp,fp)},{x:dp},function(mp){return{x:function(){return function(gp,yp,xp,_p,vp,bp,Ep){var Sp=ln(gp,"dy","avgPool3dBackprop"),Ap=ln(yp,"input","avgPool3dBackprop"),Rp=Sp,Tp=Ap,Mp=!1;Ap.rank===4&&(Mp=!0,Rp=Sp.as5D(1,Sp.shape[0],Sp.shape[1],Sp.shape[2],Sp.shape[3]),Tp=Ap.as5D(1,Ap.shape[0],Ap.shape[1],Ap.shape[2],Ap.shape[3])),g(Rp.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+Rp.rank+"."}),g(Tp.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+Tp.rank+"."}),vp==null&&(vp=[1,1,1]),g(Io(_p,vp),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+_p+" and dilations '"+vp+"'"}),Ep!=null&&g(E(bp),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+Ep+" but got pad "+bp+"."});var Op=mo(Tp.shape,xp,_p,vp,bp,Ep),Pp=Nt.runKernelFunc(function($p){return $p.avgPool3dBackprop(Rp,Tp,Op)},{dy5D:Rp,input5D:Tp});return Mp?Pp.as4D(Pp.shape[1],Pp.shape[2],Pp.shape[3],Pp.shape[4]):Pp}(mp,dp,_d,np,up,ap,sp)}}});return pp=pp.cast(dp.dtype),hp?pp.as4D(pp.shape[1],pp.shape[2],pp.shape[3],pp.shape[4]):pp}}),tl=Cn({slice_:function(rp,_d,np){var ap,sp,lp=ln(rp,"x","slice");if(lp.rank===0)throw new Error("Slicing scalar is not possible");(ap=typeof _d=="number"?[_d].concat(new Array(lp.rank-1).fill(0)):_d.length<lp.rank?_d.concat(new Array(lp.rank-_d.length).fill(0)):_d.slice()).forEach(function(dp){g(dp!==-1,function(){return"slice() does not support negative begin indexing."})}),sp=(sp=np==null?new Array(lp.rank).fill(-1):typeof np=="number"?[np].concat(new Array(lp.rank-1).fill(-1)):np.length<lp.rank?np.concat(new Array(lp.rank-np.length).fill(-1)):np).map(function(dp,hp){return dp>=0?dp:(g(dp===-1,function(){return"Negative size values should be exactly -1 but got "+dp+" for the slice() size at index "+hp+"."}),lp.shape[hp]-ap[hp])}),qr(lp,ap,sp);var up=lp.shape,cp={begin:ap,size:sp};return Nt.runKernelFunc(function(dp){return dp.slice(lp,ap,sp)},{x:lp},function(dp){for(var hp=[],fp=0;fp<dp.rank;fp++)hp.push([ap[fp],up[fp]-ap[fp]-sp[fp]]);return{x:function(){return dp.pad(hp)}}},"Slice",cp)}}),el=Cn({slice1d_:function(rp,_d,np){var ap=ln(rp,"x","slice1d");return g(ap.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+ap.rank+" tensor"}),tl(ap,[_d],[np])}}),nl=Cn({slice2d_:function(rp,_d,np){var ap=ln(rp,"x","slice2d");return g(ap.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+ap.rank+" tensor"}),tl(ap,_d,np)}}),rl=Cn({slice3d_:function(rp,_d,np){var ap=ln(rp,"x","slice3d");return g(ap.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+ap.rank+" tensor"}),tl(ap,_d,np)}}),ol=Cn({slice4d_:function(rp,_d,np){var ap=ln(rp,"x","slice4d");return g(ap.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+ap.rank+" tensor"}),tl(ap,_d,np)}});function al(rp,_d,np,ap,sp){return _d.rank<np.rank&&(_d=_d.reshape(vn(_d.shape,ap))),rp.rank<np.rank&&(rp=rp.reshape(vn(rp.shape,ap))),{$x:function(){var lp=rp.mul(np.equal(_d).cast(rp.dtype));return sp==null?lp:lp.transpose(sp)}}}var il=Cn({all_:function(rp,_d,np){_d===void 0&&(_d=null),np===void 0&&(np=!1);var ap=ln(rp,"x","all","bool"),sp=D(_d,ap.shape),lp=sp,up=gn(lp,ap.rank);up!=null&&(ap=ap.transpose(up),lp=xn(lp.length,ap.rank));var cp=Nt.runKernelFunc(function(hp){return hp.all(ap,lp)},{$x:ap});if(np){var dp=vn(cp.shape,sp);return cp.reshape(dp)}return cp}}),ul=Cn({any_:function(rp,_d,np){_d===void 0&&(_d=null),np===void 0&&(np=!1);var ap=ln(rp,"x","any","bool"),sp=D(_d,ap.shape),lp=sp,up=gn(lp,ap.rank);up!=null&&(ap=ap.transpose(up),lp=xn(lp.length,ap.rank));var cp=Nt.runKernelFunc(function(hp){return hp.any(ap,lp)},{$x:ap});if(np){var dp=vn(cp.shape,sp);return cp.reshape(dp)}return cp}}),sl=Cn({argMax_:function(rp,_d){_d===void 0&&(_d=0);var np=ln(rp,"x","argMax");_d==null&&(_d=0);var ap=D(_d,np.shape),sp=gn(ap,np.rank);return sp!=null&&(np=np.transpose(sp),ap=xn(ap.length,np.rank)),Nt.runKernelFunc(function(lp,up){var cp=lp.argMax(np,ap[0]);return up([np]),cp},{$x:np},function(lp,up){var cp=up[0];return{$x:function(){return zn(cp)}}})}}),cl=Cn({argMin_:function(rp,_d){_d===void 0&&(_d=0);var np=ln(rp,"x","argMin");_d==null&&(_d=0);var ap=D(_d,np.shape),sp=gn(ap,np.rank);return sp!=null&&(np=np.transpose(sp),ap=xn(ap.length,np.rank)),Nt.runKernelFunc(function(lp,up){var cp=lp.argMin(np,ap[0]);return up([np]),cp},{$x:np},function(lp,up){var cp=up[0];return{$x:function(){return zn(cp)}}})}}),ll=Cn({logSumExp_:function(rp,_d,np){_d===void 0&&(_d=null),np===void 0&&(np=!1);var ap=ln(rp,"x","logSumExp"),sp=D(_d,ap.shape),lp=ap.max(sp,!0),up=ap.sub(lp).exp().sum(sp).log(),cp=lp.reshape(up.shape).add(up);if(np){var dp=vn(cp.shape,sp);return cp.reshape(dp)}return cp}}),hl=Cn({max_:function(rp,_d,np){_d===void 0&&(_d=null),np===void 0&&(np=!1);var ap=ln(rp,"x","max"),sp=ap,lp=D(_d,ap.shape),up=lp,cp=gn(up,ap.rank);cp!=null&&(ap=ap.transpose(cp),up=xn(up.length,ap.rank));var dp=Nt.runKernelFunc(function(fp,pp){var mp=fp.max(ap,up);return pp([sp,mp]),mp},{$x:ap},function(fp,pp){return al(fp,pp[1],pp[0],lp,cp)});if(np){var hp=vn(dp.shape,lp);dp=dp.reshape(hp)}return dp}}),fl=Cn({mean_:function(rp,_d,np){_d===void 0&&(_d=null),np===void 0&&(np=!1);var ap=ln(rp,"x","mean"),sp=D(_d,ap.shape),lp=w$1(dn(ap.shape,sp)[1]);return oo(function(up){var cp=An(lp);return{value:(cp.dtype===up.dtype?up:up.cast(cp.dtype)).div(cp).sum(_d,np),gradFunc:function(dp){var hp=up.shape.slice();return sp.forEach(function(fp){hp[fp]=1}),dp.reshape(hp).mul(Bn(up.shape,"float32")).div(lp)}}})(ap)}}),pl=Cn({min_:function(rp,_d,np){_d===void 0&&(_d=null),np===void 0&&(np=!1);var ap=ln(rp,"x","min"),sp=ap,lp=D(_d,ap.shape),up=lp,cp=gn(up,ap.rank);cp!=null&&(ap=ap.transpose(cp),up=xn(up.length,ap.rank));var dp=Nt.runKernelFunc(function(fp,pp){var mp=fp.min(ap,up);return pp([sp,mp]),mp},{$x:ap},function(fp,pp){return al(fp,pp[1],pp[0],lp,cp)});if(np){var hp=vn(dp.shape,lp);dp=dp.reshape(hp)}return dp}}),dl=Cn({moments_:function(rp,_d,np){_d===void 0&&(_d=null),np===void 0&&(np=!1);var ap=D(_d,(rp=ln(rp,"x","moments")).shape),sp=rp.mean(ap,np),lp=sp.shape;np||(lp=vn(sp.shape,ap));var up=rp.toFloat().sub(sp.reshape(lp)).square();return{mean:sp,variance:up.mean(ap,np)}}}),vl=Cn({sum_:function(rp,_d,np){_d===void 0&&(_d=null),np===void 0&&(np=!1);var ap=ln(rp,"x","sum");ap.dtype==="bool"&&(ap=ap.toInt());var sp=D(_d,ap.shape);return oo(function(lp){var up=gn(sp,lp.rank),cp=sp,dp=lp;up!=null&&(dp=lp.transpose(up),cp=xn(cp.length,lp.rank));var hp=Nt.runKernelFunc(function(pp){return pp.sum(dp,cp)},{permutedX:dp});if(np){var fp=vn(hp.shape,sp);hp=hp.reshape(fp)}return{value:hp,gradFunc:function(pp){var mp=lp.shape.slice();return sp.forEach(function(gp){mp[gp]=1}),pp.reshape(mp).mul(Bn(lp.shape,"float32"))}}})(ap)}}),ml=Cn({prod_:function(rp,_d,np){_d===void 0&&(_d=null),np===void 0&&(np=!1);var ap=ln(rp,"x","prod");ap.dtype==="bool"&&(ap=ap.toInt());var sp=D(_d,ap.shape),lp=gn(sp,ap.rank),up=sp,cp=ap;lp!=null&&(cp=ap.transpose(lp),up=xn(up.length,ap.rank));var dp=Nt.runKernelFunc(function(fp){return fp.prod(cp,up)},{permutedX:cp});if(np){var hp=vn(dp.shape,sp);dp=dp.reshape(hp)}return dp}}),gl=Cn({elu_:function(rp){var _d=ln(rp,"x","elu");return Nt.runKernelFunc(function(np,ap){var sp=np.elu(_d);return ap([sp]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return Nt.runKernelFunc(function(lp){return lp.eluDer(np,sp)},{dy:np,y:sp})}}})}}),yl=Cn({leakyRelu_:function(rp,_d){_d===void 0&&(_d=.2);var np=ln(rp,"x","leakyRelu");return Xs(An(_d).mul(np),np)}}),xl=Cn({prelu_:function(rp,_d){var np=ln(rp,"x","prelu"),ap=ln(_d,"alpha","prelu");return Nt.runKernelFunc(function(sp,lp){var up=sp.prelu(np,ap);return lp([np,ap]),up},{x:np,alpha:ap},function(sp,lp){var up=lp[0],cp=lp[1],dp=up.greater(0);return{x:function(){return Ws(dp,sp,sp.mul(cp))},alpha:function(){var hp=Ws(dp,zn(sp),sp.mul(up)),fp=fo(cp.shape,sp.shape);return fp.length>0&&(hp=hp.sum(fp)),hp.reshape(cp.shape)}}},"Prelu")}}),bl=Cn({relu_:function(rp){var _d=ln(rp,"x","relu");return _d.dtype==="bool"?_d.toInt():Nt.runKernelFunc(function(np,ap){var sp=np.relu(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){return np.mulStrict(sp.step().toFloat())}}})}}),wl=Cn({relu6_:function(rp){var _d=ln(rp,"x","relu6");return _d.dtype==="bool"?_d.toInt():Nt.runKernelFunc(function(np,ap){var sp=np.relu6(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0],lp=sp.lessEqual(6).mul(sp.step());return{$x:function(){return np.mulStrict(lp.toFloat())}}})}}),Cl=Cn({selu_:function(rp){var _d=ln(rp,"x","selu");return Nt.runKernelFunc(function(np,ap){var sp=np.selu(_d);return ap([_d]),sp},{$x:_d},function(np,ap){var sp=ap[0];return{$x:function(){var lp=sp.greater(An(0)),up=An(iu),cp=An(uu),dp=np.mul(cp),hp=np.mul(up).mul(sp.toFloat().exp());return Ws(lp,dp,hp)}}})}}),El=Cn({transpose_:function(rp,_d){var np=ln(rp,"x","transpose");return _d==null&&(_d=np.shape.map(function(ap,sp){return sp}).reverse()),g(np.rank===_d.length,function(){return"Error in transpose: rank of input "+np.rank+" must match length of perm "+_d+"."}),_d.forEach(function(ap){g(ap>=0&&ap<np.rank,function(){return"All entries in 'perm' must be between 0 and "+(np.rank-1)+" but got "+_d})}),np.rank<=1?np.clone():Nt.runKernelFunc(function(ap){return ap.transpose(np,_d)},{$x:np},function(ap){var sp=yn(_d);return{$x:function(){return ap.transpose(sp)}}})}}),Rl=Cn({localResponseNormalization_:function(rp,_d,np,ap,sp){_d===void 0&&(_d=5),np===void 0&&(np=1),ap===void 0&&(ap=1),sp===void 0&&(sp=.5);var lp=ln(rp,"x","localResponseNormalization");g(lp.rank===4||lp.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+lp.rank+"."}),g(E(_d),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+_d+"."});var up=lp,cp=!1;lp.rank===3&&(cp=!0,up=lp.as4D(1,lp.shape[0],lp.shape[1],lp.shape[2]));var dp=Nt.runKernelFunc(function(hp,fp){var pp=hp.localResponseNormalization4D(up,_d,np,ap,sp);return fp([up,pp]),pp},{x4D:up},function(hp,fp){var pp=fp[0],mp=fp[1];return{x4D:function(){return Nt.runKernelFunc(function(gp){return gp.LRNGrad(hp,pp,mp,_d,np,ap,sp)},{})}}});return cp?dp.as3D(dp.shape[1],dp.shape[2],dp.shape[3]):dp}}),Il=Cn({norm_:function(rp,_d,np,ap){_d===void 0&&(_d="euclidean"),np===void 0&&(np=null),ap===void 0&&(ap=!1);var sp=function cp(dp,hp,fp){if(fp===void 0&&(fp=null),dp.rank===0)return dp.abs();if(dp.rank!==1&&fp===null)return cp(dp.reshape([-1]),hp,fp);if(dp.rank===1||typeof fp=="number"||Array.isArray(fp)&&fp.length===1){if(hp===1)return dp.abs().sum(fp);if(hp===1/0)return dp.abs().max(fp);if(hp===-1/0)return dp.abs().min(fp);if(hp==="euclidean"||hp===2)return dp.abs().pow(An(2,"int32")).sum(fp).sqrt();throw new Error("Error in norm: invalid ord value: "+hp)}if(Array.isArray(fp)&&fp.length===2){if(hp===1)return dp.abs().sum(fp[0]).max(fp[1]-1);if(hp===1/0)return dp.abs().sum(fp[1]).max(fp[0]);if(hp===-1/0)return dp.abs().sum(fp[1]).min(fp[0]);if(hp==="fro"||hp==="euclidean")return dp.square().sum(fp).sqrt();throw new Error("Error in norm: invalid ord value: "+hp)}throw new Error("Error in norm: invalid axis: "+fp)}(rp=ln(rp,"x","norm"),_d,np),lp=sp.shape;if(ap){var up=D(np,rp.shape);lp=vn(sp.shape,up)}return sp.reshape(lp)}}),kl=Cn({basicLSTMCell_:function(rp,_d,np,ap,sp,lp){var up=ln(rp,"forgetBias","basicLSTMCell"),cp=ln(_d,"lstmKernel","basicLSTMCell"),dp=ln(np,"lstmBias","basicLSTMCell"),hp=ln(ap,"data","basicLSTMCell"),fp=ln(sp,"c","basicLSTMCell"),pp=ln(lp,"h","basicLSTMCell"),mp=hp.concat(pp,1).matMul(cp).add(dp),gp=mp.shape[0],yp=mp.shape[1]/4,xp=[gp,yp],_p=mp.slice([0,0],xp),vp=mp.slice([0,yp],xp),bp=mp.slice([0,2*yp],xp),Ep=mp.slice([0,3*yp],xp),Sp=_p.sigmoid().mulStrict(vp.tanh()).addStrict(fp.mulStrict(up.add(bp).sigmoid())),Ap=Sp.tanh().mulStrict(Ep.sigmoid());return[Sp,Ap]}}),Sl=Cn({multiRNNCell_:function(rp,_d,np,ap){for(var sp=ln(_d,"data","multiRNNCell"),lp=hn(np,"c","multiRNNCell"),up=hn(ap,"h","multiRNNCell"),cp=sp,dp=[],hp=0;hp<rp.length;hp++){var fp=rp[hp](cp,lp[hp],up[hp]);dp.push(fp[0]),dp.push(fp[1]),cp=fp[1]}var pp=[],mp=[];for(hp=0;hp<dp.length;hp+=2)pp.push(dp[hp]),mp.push(dp[hp+1]);return[pp,mp]}}),Al=Cn({movingAverage_:function(rp,_d,np,ap,sp){sp===void 0&&(sp=!0);var lp=ln(rp,"v","movingAverage"),up=ln(_d,"x","movingAverage"),cp=ln(np,"decay","movingAverage");It(lp,up),g(C(lp.shape,up.shape),function(){return"Shape mismatch in v and x"});var dp=An(1),hp=dp.sub(cp),fp=up.sub(lp).mul(hp);if(sp){g(ap!=null,function(){return"When using zeroDebias: true, step is required."});var pp=ln(ap,"step","movingAverage");fp=fp.div(dp.sub(nc(cp,pp)))}return lp.add(fp)}}),Dl=Cn({stridedSlice_:function(rp,_d,np,ap,sp,lp,up,cp,dp){if(sp===void 0&&(sp=0),lp===void 0&&(lp=0),up===void 0&&(up=0),cp===void 0&&(cp=0),dp===void 0&&(dp=0),ap==null&&(ap=new Array(_d.length)),up!==0)throw new Error("ellipsis mask is not yet supported");var hp=ln(rp,"x","stridedSlice"),fp=Kr(cp),pp=hp.shape.slice();fp.forEach(function(_p){_d[_p]=0,np[_p]=1,pp.splice(_p,0,1)}),hp=hp.reshape(pp);for(var mp=0;mp<hp.rank;mp++)_d[mp]=Xr(sp,_d,ap,hp.shape,mp),np[mp]=$r(lp,np,ap,hp.shape,mp),ap[mp]=ap[mp]||1;var gp=Kr(dp);gp.forEach(function(_p){np[_p]=_d[_p]+1,ap[_p]=1});var yp=jr(_d,np,ap),xp=yp.filter(function(_p,vp){return gp.indexOf(vp)===-1});return ap.every(function(_p){return _p===1})?tl(hp,_d,yp).reshape(xp):Nt.runKernelFunc(function(_p){return _p.stridedSlice(hp,_d,np,ap)},{$x:hp}).reshape(xp)}}),Tl=Cn({topk_:function(rp,_d,np){_d===void 0&&(_d=1),np===void 0&&(np=!0);var ap=ln(rp,"x","topk");if(ap.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var sp=ap.shape[ap.shape.length-1];if(_d>sp)throw new Error("'k' passed to topk() must be <= the last dimension ("+sp+") but got "+_d);var lp=Nt.runKernelFunc(function(up){return up.topk(ap,_d,np)},{$x:ap});return{values:lp[0],indices:lp[1]}}}),Nl=Cn({scatterND_:function(rp,_d,np){var ap=ln(rp,"indices","scatterND","int32"),sp=ln(_d,"updates","scatterND");return Gr(sp,ap,np),Nt.runKernelFunc(function(lp){return lp.scatterND(ap,sp,np)},{$indices:ap,$updates:sp})}}),Fl=Cn({fft_:function(rp){g(rp.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+rp.dtype+"."});var _d=rp.shape[rp.shape.length-1],np=rp.size/_d,ap=rp.as2D(np,_d);return Nt.runKernelFunc(function(sp){return sp.fft(ap)},{input:rp}).reshape(rp.shape)}}),Ol=Cn({ifft_:function(rp){g(rp.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+rp.dtype+"."});var _d=rp.shape[rp.shape.length-1],np=rp.size/_d,ap=rp.as2D(np,_d);return Nt.runKernelFunc(function(sp){return sp.ifft(ap)},{input:rp}).reshape(rp.shape)}}),_l=Cn({rfft_:function(rp,_d){g(rp.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+rp.dtype});var np,ap=rp.shape[rp.shape.length-1],sp=rp.size/ap;if(_d!=null&&_d<ap){var lp=rp.shape.map(function(vp){return 0}),up=rp.shape.map(function(vp){return vp});up[rp.shape.length-1]=_d,np=rp.slice(lp,up),ap=_d}else if(_d!=null&&_d>ap){var cp=rp.shape.map(function(vp){return vp});cp[rp.shape.length-1]=_d-ap,np=rp.concat(Pn(cp),rp.shape.length-1),ap=_d}else np=rp;var dp=np.zerosLike(),hp=En(np,dp).as2D(sp,ap),fp=Fl(hp),pp=Math.floor(ap/2)+1,mp=Rn(fp),gp=In(fp),yp=mp.split([pp,ap-pp],mp.shape.length-1),xp=gp.split([pp,ap-pp],gp.shape.length-1),_p=np.shape.slice();return _p[np.shape.length-1]=pp,En(yp[0],xp[0]).reshape(_p)}}),Ml=Cn({irfft_:function(rp){var _d=rp.shape[rp.shape.length-1],np=rp.size/_d;if(_d<=2){var ap=rp.as2D(np,_d),sp=Ol(ap);return Rn(sp)}var lp=[np,2*(_d-1)],up=Rn(rp).as2D(np,_d),cp=In(rp).as2D(np,_d),dp=up.slice([0,1],[np,_d-2]).reverse(1),hp=cp.slice([0,1],[np,_d-2]).reverse(1).mul(An(-1)),fp=up.concat(dp,1),pp=cp.concat(hp,1);return ap=En(fp,pp).as2D(lp[0],lp[1]),sp=Ol(ap),Rn(sp)}}),Bl=Object.freeze({fft:Fl,ifft:Ol,rfft:_l,irfft:Ml}),Pl=Cn({sparseToDense_:function(rp,_d,np,ap){ap===void 0&&(ap=0);var sp=ln(rp,"sparseIndices","sparseToDense","int32"),lp=ln(_d,"sparseValues","sparseToDense"),up=ln(ap,"defaultValue","sparseToDense",lp.dtype);return function(cp,dp,hp,fp){if(cp.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+cp.dtype+".");if(cp.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+cp.shape+".");var pp=cp.rank>0?cp.shape[0]:1,mp=cp.rank>1?cp.shape[1]:1;if(hp.length!==mp)throw new Error("outputShape has incorrect number of elements:, "+hp.length+", should be: "+mp+".");var gp=dp.size;if(dp.rank!==0&&(dp.rank!==1||gp!==pp))throw new Error("sparseValues has incorrect shape "+dp.shape+", should be [] or ["+pp+"]");if(dp.dtype!==fp.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(sp,lp,np,up),Nt.runKernelFunc(function(cp){return cp.sparseToDense(sp,lp,np,up)},{$sparseIndices:sp,$sparseValues:lp,$defaultValue:up})}}),Ll=Cn({gatherND_:function(rp,_d){var np=ln(_d,"indices","gatherND","int32"),ap=ln(rp,"x","gatherND");return Nt.runKernelFunc(function(sp){return sp.gatherND(ap,np)},{$x:ap,$indices:np})}}),Wl=Cn({diag_:function(rp){var _d=ln(rp,"x","diag").flatten(),np=rp.shape.concat(rp.shape);return Nt.runKernelFunc(function(ap){return ap.diag(_d)},{$x:_d}).reshape(np)}}),Ul=Cn({dropout_:function(rp,_d,np,ap){var sp=ln(rp,"x","dropout");if(g(sp.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+sp.dtype+" tensor instead."}),g(_d>=0&&_d<1,function(){return"rate must be a float in the range [0, 1), but got "+_d+"."}),_d===0)return rp instanceof dt?sp.clone():sp;var lp=function(dp,hp){if(hp==null)return dp.shape.slice();if(C(dp.shape,hp))return hp;if(dp.shape.length===hp.length){for(var fp=[],pp=0;pp<dp.shape.length;pp++)hp[pp]==null&&dp.shape[pp]!=null?fp.push(dp.shape[pp]):fp.push(hp[pp]);return fp}return hp}(sp,np),up=1-_d,cp=kr(lp,0,1,"float32",ap).add(up).floor().div(up);return sp.mul(cp)}});function Vl(rp,_d,np){for(var ap=1-rp%2,sp=new Float32Array(rp),lp=0;lp<rp;++lp){var up=2*Math.PI*lp/(rp+ap-1);sp[lp]=_d-np*Math.cos(up)}return Dn(sp,"float32")}var zl=Cn({hannWindow_:function(rp){return Vl(rp,.5,.5)}}),Gl=Cn({hammingWindow_:function(rp){return Vl(rp,.54,.46)}}),Hl=Cn({frame_:function(rp,_d,np,ap,sp){ap===void 0&&(ap=!1),sp===void 0&&(sp=0);for(var lp=0,up=[];lp+_d<=rp.size;)up.push(tl(rp,lp,_d)),lp+=np;if(ap)for(;lp<rp.size;){var cp=lp+_d-rp.size,dp=Gn([tl(rp,lp,_d-cp),Ln([cp],sp)]);up.push(dp),lp+=np}return up.length===0?Tn([],[0,_d]):Gn(up).as2D(up.length,_d)}}),ql=Cn({stft_:function(rp,_d,np,ap,sp){var lp;sp===void 0&&(sp=zl),ap==null&&(lp=_d,ap=Math.floor(Math.pow(2,Math.ceil(Math.log(lp)/Math.log(2)))));for(var up=Hl(rp,_d,np),cp=tc(up,sp(_d)),dp=[],hp=0;hp<up.shape[0];hp++)dp.push(_l(cp.slice([hp,0],[1,_d]),ap));return Gn(dp)}}),Kl=Object.freeze({hannWindow:zl,hammingWindow:Gl,frame:Hl,stft:ql}),jl,Xl=function(rp,_d,np){return np===void 0&&(np=1),n$1(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p;return r(this,function(vp){switch(vp.label){case 0:return ap=ln(rp,"predictions","inTopK"),sp=ln(_d,"targets","inTopK"),g(ap.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+ap.rank}),g(ap.rank-1===sp.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+ap.rank+" and targets rank "+sp.rank}),y(ap.shape.slice(0,ap.shape.length-1),sp.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),lp=ap.shape[ap.shape.length-1],g(np>0&&np<=lp,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+lp+"), but got "+np}),[4,ap.data()];case 1:return up=vp.sent(),[4,sp.data()];case 2:for(cp=vp.sent(),dp=[up.length/lp,lp],fp=dp[1],pp=N("bool",hp=dp[0]),mp=0;mp<hp;mp++){for(gp=mp*fp,yp=up.subarray(gp,gp+fp),xp=[],_p=0;_p<yp.length;_p++)xp.push({value:yp[_p],index:_p});for(xp.sort(function(bp,Ep){return Ep.value-bp.value}),pp[mp]=0,_p=0;_p<np;_p++)if(xp[_p].index===cp[mp]){pp[mp]=1;break}}return rp!==ap&&ap.dispose(),_d!==sp&&sp.dispose(),[2,kn(pp,sp.shape,"bool")]}})})};(function(rp){rp[rp.NONE=0]="NONE",rp[rp.MEAN=1]="MEAN",rp[rp.SUM=2]="SUM",rp[rp.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(jl||(jl={}));var $l=Cn({absoluteDifference_:function(rp,_d,np,ap){ap===void 0&&(ap=jl.SUM_BY_NONZERO_WEIGHTS);var sp=ln(rp,"labels","absoluteDifference"),lp=ln(_d,"predictions","absoluteDifference"),up=null;np!=null&&(up=ln(np,"weights","absoluteDifference")),y(sp.shape,lp.shape,"Error in absoluteDifference: ");var cp=sp.sub(lp).abs();return Yl(cp,up,ap)}}),Yl=Cn({computeWeightedLoss_:function(rp,_d,np){np===void 0&&(np=jl.SUM_BY_NONZERO_WEIGHTS);var ap=ln(rp,"losses","computeWeightedLoss"),sp=null;_d!=null&&(sp=ln(_d,"weights","computeWeightedLoss"));var lp=sp==null?ap:ap.mul(sp);if(np===jl.NONE)return lp;if(np===jl.SUM)return lp.sum();if(np===jl.MEAN){if(sp==null)return lp.mean();var up=ap.size/sp.size,cp=lp.sum().div(sp.sum());return up>1?cp.div(An(up)):cp}if(np===jl.SUM_BY_NONZERO_WEIGHTS){if(sp==null)return lp.sum().div(An(ap.size));var dp=sp.mul(Bn(ap.shape)).notEqual(An(0)).sum().toFloat();return lp.sum().div(dp)}throw Error("Unknown reduction: "+np)}}),Ql=Cn({cosineDistance_:function(rp,_d,np,ap,sp){sp===void 0&&(sp=jl.SUM_BY_NONZERO_WEIGHTS);var lp=ln(rp,"labels","cosineDistance"),up=ln(_d,"predictions","cosineDistance"),cp=null;ap!=null&&(cp=ln(ap,"weights","cosineDistance")),y(lp.shape,up.shape,"Error in cosineDistance: ");var dp=An(1).sub(lp.mul(up).sum(np,!0));return Yl(dp,cp,sp)}}),Jl=Cn({hingeLoss_:function(rp,_d,np,ap){ap===void 0&&(ap=jl.SUM_BY_NONZERO_WEIGHTS);var sp=ln(rp,"labels","hingeLoss"),lp=ln(_d,"predictions","hingeLoss"),up=null;np!=null&&(up=ln(np,"weights","hingeLoss")),y(sp.shape,lp.shape,"Error in hingeLoss: ");var cp=An(1);sp=An(2).mul(sp).sub(cp);var dp=cp.sub(sp.mul(lp)).relu();return Yl(dp,up,ap)}}),Zl=Cn({huberLoss_:function(rp,_d,np,ap,sp){ap===void 0&&(ap=1),sp===void 0&&(sp=jl.SUM_BY_NONZERO_WEIGHTS);var lp=ln(rp,"labels","huberLoss"),up=ln(_d,"predictions","huberLoss"),cp=null;np!=null&&(cp=ln(np,"weights","huberLoss")),y(lp.shape,up.shape,"Error in huberLoss: ");var dp=An(ap),hp=up.sub(lp).abs(),fp=Ys(hp,dp),pp=hp.sub(fp),mp=An(.5).mul(fp.square()).add(dp.mul(pp));return Yl(mp,cp,sp)}}),th=Cn({logLoss_:function(rp,_d,np,ap,sp){ap===void 0&&(ap=1e-7),sp===void 0&&(sp=jl.SUM_BY_NONZERO_WEIGHTS);var lp=ln(rp,"labels","logLoss"),up=ln(_d,"predictions","logLoss"),cp=null;np!=null&&(cp=ln(np,"weights","logLoss")),y(lp.shape,up.shape,"Error in logLoss: ");var dp=An(1),hp=An(ap),fp=lp.mul(up.add(hp).log()).neg().sub(dp.sub(lp).mul(dp.sub(up).add(hp).log()));return Yl(fp,cp,sp)}}),eh=Cn({meanSquaredError_:function(rp,_d,np,ap){ap===void 0&&(ap=jl.SUM_BY_NONZERO_WEIGHTS);var sp=ln(rp,"labels","meanSquaredError"),lp=ln(_d,"predictions","meanSquaredError"),up=null;np!=null&&(up=ln(np,"weights","meanSquaredError")),y(sp.shape,lp.shape,"Error in meanSquaredError: ");var cp=sp.squaredDifference(lp);return Yl(cp,up,ap)}}),nh=Cn({sigmoidCrossEntropy_:function(rp,_d,np,ap,sp){ap===void 0&&(ap=0),sp===void 0&&(sp=jl.SUM_BY_NONZERO_WEIGHTS);var lp=ln(rp,"multiClassLabels","sigmoidCrossEntropy"),up=ln(_d,"logits","sigmoidCrossEntropy"),cp=null;if(np!=null&&(cp=ln(np,"weights","sigmoidCrossEntropy")),y(lp.shape,up.shape,"Error in sigmoidCrossEntropy: "),ap>0){var dp=An(ap),hp=An(1),fp=An(.5);lp=lp.mul(hp.sub(dp)).add(fp.mul(dp))}var pp=function(mp,gp){var yp=ln(mp,"labels","sigmoidCrossEntropyWithLogits"),xp=ln(gp,"logits","sigmoidCrossEntropyWithLogits");y(yp.shape,xp.shape,"Error in sigmoidCrossEntropyWithLogits: ");var _p=xp.relu(),vp=xp.mul(yp),bp=xp.abs().neg().exp().log1p();return _p.sub(vp).add(bp)}(lp,up);return Yl(pp,cp,sp)}}),rh=Cn({softmaxCrossEntropy_:function(rp,_d,np,ap,sp){ap===void 0&&(ap=0),sp===void 0&&(sp=jl.SUM_BY_NONZERO_WEIGHTS);var lp=ln(rp,"onehotLabels","softmaxCrossEntropy"),up=ln(_d,"logits","softmaxCrossEntropy"),cp=null;if(np!=null&&(cp=ln(np,"weights","softmaxCrossEntropy")),y(lp.shape,up.shape,"Error in softmaxCrossEntropy: "),ap>0){var dp=An(ap),hp=An(1),fp=An(lp.shape[1]);lp=lp.mul(hp.sub(dp)).add(dp.div(fp))}var pp=function(mp,gp,yp){if(yp===void 0&&(yp=-1),yp===-1&&(yp=gp.rank-1),yp!==gp.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+gp.rank+" and dim was "+yp);return oo(function(xp,_p,vp){var bp=_p.logSumExp([yp],!0),Ep=_p.toFloat().sub(bp);return vp([xp,Ep]),{value:Ep.mul(xp).neg().sum([yp]),gradFunc:function(Sp,Ap){var Rp=Ap[0],Tp=Ap[1],Mp=vn(Sp.shape,[yp]);return[Sp.reshape(Mp).mul(Rp.toFloat().sub(Tp.exp())),Sp.reshape(Mp).mul(Tp.exp().sub(Rp.toFloat()))]}}})(mp,gp)}(lp,up);return Yl(pp,cp,sp)}}),oh=Object.freeze({get Reduction(){return jl},absoluteDifference:$l,computeWeightedLoss:Yl,cosineDistance:Ql,hingeLoss:Jl,huberLoss:Zl,logLoss:th,meanSquaredError:eh,sigmoidCrossEntropy:nh,softmaxCrossEntropy:rh});function ah(rp,_d){return _d===void 0&&(_d=!1),Nt.tidy(function(){if(rp.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+rp.shape.length+"D Tensor.");for(var np=rp.shape[0],ap=rp.shape[1],sp=vr(np),lp=rp.clone(),up=Tn([[1]],[1,1]),cp=up.clone(),dp=np>=ap?ap:np,hp=function(pp){var mp,gp=lp,yp=cp,xp=sp;mp=Nt.tidy(function(){var _p=lp.slice([pp,pp],[np-pp,1]),vp=_p.norm(),bp=lp.slice([pp,pp],[1,1]),Ep=Tn([[-1]]).where(bp.greater(0),Tn([[1]])),Sp=bp.sub(Ep.mul(vp)),Ap=_p.div(Sp);cp=Ap.shape[0]===1?up.clone():up.concat(Ap.slice([1,0],[Ap.shape[0]-1,Ap.shape[1]]),0);var Rp=Ep.matMul(Sp).div(vp).neg(),Tp=lp.slice([pp,0],[np-pp,ap]),Mp=Rp.mul(cp);if(pp===0)lp=Tp.sub(Mp.matMul(cp.transpose().matMul(Tp)));else{var Op=Tp.sub(Mp.matMul(cp.transpose().matMul(Tp)));lp=lp.slice([0,0],[pp,ap]).concat(Op,0)}var Pp=sp.slice([0,pp],[np,sp.shape[1]-pp]);if(pp===0)sp=Pp.sub(Pp.matMul(cp).matMul(Mp.transpose()));else{var $p=Pp.sub(Pp.matMul(cp).matMul(Mp.transpose()));sp=sp.slice([0,0],[np,pp]).concat($p,1)}return[cp,lp,sp]}),cp=mp[0],lp=mp[1],sp=mp[2],Xe([gp,yp,xp])},fp=0;fp<dp;++fp)hp(fp);return!_d&&np>ap&&(sp=sp.slice([0,0],[np,ap]),lp=lp.slice([0,0],[ap,ap])),[sp,lp]})}var ih=Cn({gramSchmidt_:function(rp){var _d;if(Array.isArray(rp)){_d=!1,g(rp!=null&&rp.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var np=rp[0].shape[0],ap=function(dp){g(rp[dp].shape[0]===np,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+rp[dp].shape[0]+" vs. "+np+")"})},sp=1;sp<rp.length;++sp)ap(sp)}else _d=!0,rp=Xn(rp,rp.shape[0],0).map(function(dp){return Dr(dp,[0])});g(rp.length<=rp[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+rp.length+") exceeds number of dimensions ("+rp[0].shape[0]+")."});var lp=[],up=rp,cp=function(dp){lp.push(Nt.tidy(function(){var hp=up[dp];if(dp>0)for(var fp=0;fp<dp;++fp){var pp=vl(lp[fp].mulStrict(hp)).mul(lp[fp]);hp=hp.sub(pp)}return hp.div(Il(hp,"euclidean"))}))};for(sp=0;sp<rp.length;++sp)cp(sp);return _d?Tr(lp,0):lp}}),uh=Cn({qr_:function(rp,_d){if(_d===void 0&&(_d=!1),rp.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+rp.rank);if(rp.rank===2)return ah(rp,_d);var np=rp.shape.slice(0,rp.shape.length-2).reduce(function(up,cp){return up*cp}),ap=Or(rp.reshape([np,rp.shape[rp.shape.length-2],rp.shape[rp.shape.length-1]]),0),sp=[],lp=[];return ap.forEach(function(up){var cp=ah(up,_d),dp=cp[0],hp=cp[1];sp.push(dp),lp.push(hp)}),[Tr(sp,0).reshape(rp.shape),Tr(lp,0).reshape(rp.shape)]}}),sh=Object.freeze({gramSchmidt:ih,qr:uh});function ch(rp,_d,np,ap,sp){ap==null&&(ap=.5),sp==null&&(sp=Number.NEGATIVE_INFINITY);var lp=rp.shape[0];return np=Math.min(np,lp),g(0<=ap&&ap<=1,function(){return"iouThreshold must be in [0, 1], but was '"+ap+"'"}),g(rp.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+rp.rank+"'"}),g(rp.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+rp.shape[1]}),g(_d.rank===1,function(){return"scores must be a 1D tensor"}),g(_d.shape[0]===lp,function(){return"scores has incompatible shape with boxes. Expected "+lp+", but was "+_d.shape[0]}),{maxOutputSize:np,iouThreshold:ap,scoreThreshold:sp}}var lh=Cn({resizeBilinear_:function(rp,_d,np){np===void 0&&(np=!1);var ap=ln(rp,"images","resizeBilinear");g(ap.rank===3||ap.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+ap.rank+"."}),g(_d.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+_d+"."});var sp=ap,lp=!1;ap.rank===3&&(lp=!0,sp=ap.as4D(1,ap.shape[0],ap.shape[1],ap.shape[2]));var up=_d[0],cp=_d[1],dp=Nt.runKernelFunc(function(hp,fp){return fp([sp]),hp.resizeBilinear(sp,up,cp,np)},{batchImages:sp},function(hp,fp){return{batchImages:function(){return Nt.runKernelFunc(function(pp){return pp.resizeBilinearBackprop(hp,fp[0],np)},{})}}});return lp?dp.as3D(dp.shape[1],dp.shape[2],dp.shape[3]):dp}}),hh=Cn({resizeNearestNeighbor_:function(rp,_d,np){np===void 0&&(np=!1);var ap=ln(rp,"images","resizeNearestNeighbor");g(ap.rank===3||ap.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+ap.rank+"."}),g(_d.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+_d+"."}),g(ap.dtype==="float32"||ap.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var sp=ap,lp=!1;ap.rank===3&&(lp=!0,sp=ap.as4D(1,ap.shape[0],ap.shape[1],ap.shape[2]));var up=_d[0],cp=_d[1],dp=Nt.runKernelFunc(function(hp,fp){return fp([sp]),hp.resizeNearestNeighbor(sp,up,cp,np)},{batchImages:sp},function(hp,fp){return{batchImages:function(){return Nt.runKernelFunc(function(pp){return pp.resizeNearestNeighborBackprop(hp,fp[0],np)},{})}}});return lp?dp.as3D(dp.shape[1],dp.shape[2],dp.shape[3]):dp}}),fh=Cn({nonMaxSuppression_:function(rp,_d,np,ap,sp){ap===void 0&&(ap=.5),sp===void 0&&(sp=Number.NEGATIVE_INFINITY);var lp=ln(rp,"boxes","nonMaxSuppression"),up=ln(_d,"scores","nonMaxSuppression"),cp=ch(lp,up,np,ap,sp);return np=cp.maxOutputSize,ap=cp.iouThreshold,sp=cp.scoreThreshold,Nt.runKernelFunc(function(dp){return dp.nonMaxSuppression(lp,up,np,ap,sp)},{$boxes:lp})}}),ph=function(rp,_d,np,ap,sp){return ap===void 0&&(ap=.5),sp===void 0&&(sp=Number.NEGATIVE_INFINITY),n$1(this,void 0,void 0,function(){var lp,up,cp,dp,hp,fp,pp;return r(this,function(mp){switch(mp.label){case 0:return lp=ln(rp,"boxes","nonMaxSuppressionAsync"),up=ln(_d,"scores","nonMaxSuppressionAsync"),cp=ch(lp,up,np,ap,sp),np=cp.maxOutputSize,ap=cp.iouThreshold,sp=cp.scoreThreshold,[4,Promise.all([lp.data(),up.data()])];case 1:return dp=mp.sent(),hp=dp[0],fp=dp[1],pp=Mo(hp,fp,np,ap,sp),lp!==rp&&lp.dispose(),up!==_d&&up.dispose(),[2,pp]}})})},dh=Cn({cropAndResize_:function(rp,_d,np,ap,sp,lp){var up=ln(rp,"image","cropAndResize","float32"),cp=ln(_d,"boxes","cropAndResize","float32"),dp=ln(np,"boxInd","cropAndResize","int32");sp=sp||"bilinear",lp=lp||0;var hp=cp.shape[0];return g(up.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+up.rank+"."}),g(cp.rank===2&&cp.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+hp+",4] but had shape "+cp.shape+"."}),g(dp.rank===1&&dp.shape[0]===hp,function(){return"Error in cropAndResize: boxInd must be have size ["+hp+"] but had shape "+cp.shape+"."}),g(ap.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+ap.length+"."}),g(ap[0]>=1&&ap[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+ap}),g(sp==="bilinear"||sp==="nearest",function(){return"method must be bilinear or nearest, but was "+sp}),Nt.runKernelFunc(function(fp,pp){return fp.cropAndResize(up,cp,dp,ap,sp,lp)},{$image:up,$boxes:cp})}}),vh=Object.freeze({resizeBilinear:lh,resizeNearestNeighbor:hh,nonMaxSuppression:fh,nonMaxSuppressionAsync:ph,cropAndResize:dh}),mh=function(rp,_d){return!(rp>0)&&(_d==="linear"||_d==="relu")},gh=function(rp,_d,np){if(np==null||np==="linear")return rp;if(np==="relu")return rp.mul(_d.step());throw new Error("Gradient for activation "+np+" has not been implemented yet.")},yh=function(rp,_d){var np=_d,ap=fo(rp.shape,_d.shape);return ap.length>0&&(np=np.sum(ap)),np.reshape(rp.shape)},xh=function(rp,_d,np){if(_d==="linear")return rp;if(_d==="relu")return bl(rp);if(_d==="elu")return gl(rp);if(_d==="relu6")return wl(rp);if(_d==="prelu")return xl(rp,np);throw new Error("Unknown fused activation "+_d+".")},bh=Cn({matMul_:function(rp){var _d,np=rp.a,ap=rp.b,sp=rp.transposeA,lp=sp!==void 0&&sp,up=rp.transposeB,cp=up!==void 0&&up,dp=rp.bias,hp=rp.activation,fp=hp===void 0?"linear":hp,pp=rp.preluActivationWeights;if(mh(Nt.state.gradientDepth,fp)===!1){var mp=Wc(np,ap,lp,cp);return dp!=null&&(mp=Vs(mp,dp)),xh(mp,fp,pp)}var gp=ln(np,"a","fused matMul"),yp=ln(ap,"b","fused matMul");_d=Rt(gp,yp),gp=_d[0],yp=_d[1];var xp=lp?gp.shape[gp.rank-2]:gp.shape[gp.rank-1],_p=cp?yp.shape[yp.rank-1]:yp.shape[yp.rank-2],vp=lp?gp.shape[gp.rank-1]:gp.shape[gp.rank-2],bp=cp?yp.shape[yp.rank-2]:yp.shape[yp.rank-1],Ep=gp.shape.slice(0,-2),Sp=yp.shape.slice(0,-2),Ap=w$1(Ep),Rp=w$1(Sp);g(gp.rank>=2&&yp.rank>=2&&gp.rank===yp.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+gp.rank+" and "+yp.rank+"."}),g(C(Ep,Sp),function(){return"Error in fused matMul: outer dimensions ("+Ep+") and ("+Sp+") of Tensors with shapes "+gp.shape+" and "+yp.shape+" must match."}),g(xp===_p,function(){return"Error in fused matMul: inner shapes ("+xp+") and ("+_p+") of Tensors with shapes "+gp.shape+" and "+yp.shape+" and transposeA="+lp+" and transposeB="+cp+" must match."});var Tp,Mp,Op=gp.shape.slice(0,-2).concat([vp,bp]),Pp=lp?gp.as3D(Ap,xp,vp):gp.as3D(Ap,vp,xp),$p=cp?yp.as3D(Rp,bp,_p):yp.as3D(Rp,_p,bp);dp!=null&&po(Op,(Tp=Rt(Tp=ln(dp,"bias","fused matMul"),gp)[0]).shape),pp!=null&&(Mp=ln(pp,"prelu weights","fused matMul"));var zp={$a:Pp,$b:$p};return dp!=null&&(zp.$bias=Tp),pp!=null&&(zp.$preluActivationWeights=Mp),Nt.runKernelFunc(function(Dp,Fp){var jp=Dp.fusedBatchMatMul({a:Pp,b:$p,transposeA:lp,transposeB:cp,bias:Tp,activation:fp,preluActivationWeights:Mp});return Fp([Pp,$p,jp]),jp},zp,function(Dp,Fp){var jp=Fp[0],Lp=Fp[1],Bp=Fp[2],Ip=gh(Dp,Bp,fp),kp={};return dp!=null&&(kp={$bias:function(){return yh(Tp,Ip)}}),Object.assign(lp||cp?!lp&&cp?{$a:function(){return Ip.matMul(Lp,!1,!1)},$b:function(){return Ip.matMul(jp,!0,!1)}}:lp&&!cp?{$a:function(){return Lp.matMul(Ip,!1,!0)},$b:function(){return jp.matMul(Ip,!1,!1)}}:{$a:function(){return Lp.matMul(Ip,!0,!0)},$b:function(){return Ip.matMul(jp,!0,!0)}}:{$a:function(){return Ip.matMul(Lp,!1,!0)},$b:function(){return jp.matMul(Ip,!0,!1)}},kp)}).reshape(Op)}}),wh=Cn({conv2d_:function(rp){var _d=rp.x,np=rp.filter,ap=rp.strides,sp=rp.pad,lp=rp.dataFormat,up=lp===void 0?"NHWC":lp,cp=rp.dilations,dp=cp===void 0?[1,1]:cp,hp=rp.dimRoundingMode,fp=rp.bias,pp=rp.activation,mp=pp===void 0?"linear":pp,gp=rp.preluActivationWeights;if(mp=mp||"linear",mh(Nt.state.gradientDepth,mp)===!1){var yp=Dc(_d,np,ap,sp,up,dp,hp);return fp!=null&&(yp=Vs(yp,fp)),xh(yp,mp,gp)}var xp=ln(_d,"x","conv2d"),_p=ln(np,"filter","conv2d"),vp=xp,bp=!1;xp.rank===3&&(bp=!0,vp=xp.as4D(1,xp.shape[0],xp.shape[1],xp.shape[2])),g(vp.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+vp.rank+"."}),g(_p.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+_p.rank+"."}),hp!=null&&g(E(sp),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+hp+" but got pad "+sp+"."}),g(vp.shape[3]===_p.shape[2],function(){return"Error in conv2d: depth of input ("+vp.shape[3]+") must match input depth for filter "+_p.shape[2]+"."}),g(Io(ap,dp),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+ap+" and dilations '"+dp+"'"}),g(up==="NHWC",function(){return"Error in conv2d: got dataFormat of "+up+" but only NHWC is currently supported."});var Ep,Sp,Ap=go(vp.shape,_p.shape,ap,dp,sp,hp);fp!=null&&(Ep=Rt(Ep=ln(fp,"bias","fused conv2d"),xp)[0],po(Ap.outShape,Ep.shape)),gp!=null&&(Sp=ln(gp,"prelu weights","fused conv2d"));var Rp={x:vp,$filter:_p};fp!=null&&(Rp.$bias=Ep),gp!=null&&(Rp.$preluActivationWeights=Sp);var Tp=Nt.runKernelFunc(function(Mp,Op){var Pp=Mp.fusedConv2d({input:vp,filter:_p,convInfo:Ap,bias:Ep,activation:mp,preluActivationWeights:Sp});return Op([_p,vp,Pp]),Pp},Rp,function(Mp,Op){var Pp=Op,$p=Pp[0],zp=Pp[1],Dp=Pp[2],Fp=gh(Mp,Dp,mp);g(Ro(dp),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+dp+"'"});var jp={};return fp!=null&&(jp={$bias:function(){return yh(Ep,Fp)}}),Object.assign({x:function(){return Fc(zp.shape,Fp,$p,ap,sp)},$filter:function(){return Nc(zp,Fp,$p.shape,ap,sp)}},jp)});return bp?Tp.as3D(Tp.shape[1],Tp.shape[2],Tp.shape[3]):Tp}}),Ch=Cn({depthwiseConv2d_:function(rp){var _d=rp.x,np=rp.filter,ap=rp.strides,sp=rp.pad,lp=rp.dataFormat,up=lp===void 0?"NHWC":lp,cp=rp.dilations,dp=cp===void 0?[1,1]:cp,hp=rp.dimRoundingMode,fp=rp.bias,pp=rp.activation,mp=pp===void 0?"linear":pp,gp=rp.preluActivationWeights;if(mh(Nt.state.gradientDepth,mp)===!1){var yp=Oc(_d,np,ap,sp,up,dp,hp);return fp!=null&&(yp=Vs(yp,fp)),xh(yp,mp,gp)}var xp=ln(_d,"x","depthwiseConv2d"),_p=ln(np,"filter","depthwiseConv2d"),vp=xp,bp=!1;xp.rank===3&&(bp=!0,vp=xp.as4D(1,xp.shape[0],xp.shape[1],xp.shape[2])),g(vp.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+vp.rank+"."}),g(_p.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+_p.rank+"."}),g(vp.shape[3]===_p.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+vp.shape[3]+") must match the inChannels dimension in filter "+_p.shape[2]+"."}),dp==null&&(dp=[1,1]),g(Io(ap,dp),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+ap+" and dilations '"+dp+"'"}),hp!=null&&g(E(sp),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+hp+" but got pad "+sp+"."});var Ep,Sp,Ap=go(vp.shape,_p.shape,ap,dp,sp,hp,!0);fp!=null&&(Ep=Rt(Ep=ln(fp,"bias","fused conv2d"),xp)[0],po(Ap.outShape,Ep.shape)),gp!=null&&(Sp=ln(gp,"prelu weights","fused depthwiseConv2d"));var Rp={x:vp,$filter:_p};fp!=null&&(Rp.$bias=Ep),gp!=null&&(Rp.$preluActivationWeights=Sp);var Tp=Nt.runKernelFunc(function(Mp,Op){var Pp=Mp.fusedDepthwiseConv2D({input:vp,filter:_p,convInfo:Ap,bias:Ep,activation:mp,preluActivationWeights:Sp});return Op([vp,_p,Pp]),Pp},Rp,function(Mp,Op){g(Ro(dp),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+dp+"'"});var Pp=Op[0],$p=Op[1],zp=Op[2],Dp=gh(Mp,zp,mp),Fp={};return fp!=null&&(Fp={$bias:function(){return yh(Ep,Dp)}}),Object.assign({x:function(){return _c(Pp.shape,Dp,$p,Ap)},$filter:function(){return Mc(Pp,Dp,$p.shape,Ap)}},Fp)});return bp?Tp.as3D(Tp.shape[1],Tp.shape[2],Tp.shape[3]):Tp}}),Eh=Object.freeze({matMul:bh,conv2d:wh,depthwiseConv2d:Ch}),Rh=Object.freeze({image:vh,linalg:sh,losses:oh,spectral:Bl,fused:Eh,signal:Kl,square:Uu,conv1d:Ac,conv2d:Dc,conv3d:Tc,depthwiseConv2d:Oc,separableConv2d:Bc,conv2dTranspose:Pc,conv3dTranspose:Lc,op:Cn,batchNormalization2d:Ss,batchNormalization3d:As,batchNormalization4d:Ds,batchNormalization:Ts,batchNorm:Ns,batchNorm2d:Fs,batchNorm3d:Os,batchNorm4d:_s,booleanMaskAsync:Rc,complex:En,real:Rn,imag:In,concat:Gn,concat1d:Hn,concat2d:qn,concat3d:Kn,concat4d:jn,split:Xn,matMul:Wc,dot:Uc,outerProduct:Vc,reverse:zc,reverse1d:Gc,reverse2d:Hc,reverse3d:qc,reverse4d:Kc,maxPool:$c,avgPool:Yc,pool:Qc,maxPool3d:Jc,avgPool3d:Zc,slice:tl,slice1d:el,slice2d:nl,slice3d:rl,slice4d:ol,abs:Vu,acos:zu,acosh:Gu,asin:Hu,asinh:qu,atan:Ku,atanh:ju,ceil:Xu,clipByValue:$u,cos:Yu,cosh:Qu,erf:Ju,exp:Zu,expm1:ts,floor:es,log:ns,log1p:rs,logSigmoid:os,neg:as,reciprocal:is$1,round:us,rsqrt:ss,sigmoid:cs,sign:ls,isNaN:hs,isInf:fs,isFinite:ps,sin:ds,sinh:vs,softplus:ms,sqrt:gs,step:ys,tan:xs,tanh:bs,all:il,any:ul,argMax:sl,argMin:cl,logSumExp:ll,max:hl,mean:fl,min:pl,moments:dl,sum:vl,prod:ml,equal:sc,equalStrict:cc,greater:lc,greaterEqual:hc,greaterEqualStrict:fc,greaterStrict:pc,less:dc,lessEqual:vc,lessEqualStrict:mc,lessStrict:gc,notEqual:yc,notEqualStrict:xc,add:Vs,addN:zs,addStrict:Gs,atan2:Hs,div:qs,divStrict:Ks,floorDiv:js,maximum:Xs,maximumStrict:$s,minimum:Ys,minimumStrict:Qs,mod:Js,modStrict:Zs,mul:tc,mulStrict:ec,pow:nc,powStrict:rc,squaredDifference:oc,squaredDifferenceStrict:ac,sub:ic,subStrict:uc,elu:gl,leakyRelu:yl,prelu:xl,relu:bl,relu6:wl,selu:Cl,logicalAnd:Ms,logicalNot:Bs,logicalOr:Ps,logicalXor:Ls,where:Ws,whereAsync:Us,buffer:ur,print:sr$1,batchToSpaceND:cr,cast:lr,clone:hr,cumsum:fr$1,depthToSpace:pr,expandDims:dr,eye:vr,multinomial:mr,oneHot:gr,pad:yr,pad1d:xr,pad2d:br,pad3d:wr,pad4d:Cr,rand:Er,randomNormal:Rr,randomGamma:Ir,randomUniform:kr,reshape:Sr,spaceToBatchND:Ar,squeeze:Dr,stack:Tr,tile:Nr,truncatedNormal:Fr,unstack:Or,setdiff1dAsync:_r,fill:Ln,linspace:Wn,ones:Bn,range:Un,scalar:An,tensor:kn,tensor1d:Dn,tensor2d:Tn,tensor3d:Nn,tensor4d:Fn,tensor5d:On,tensor6d:_n,variable:Mn,zeros:Pn,onesLike:Vn,zerosLike:zn,transpose:El,softmax:io,logSoftmax:uo,localResponseNormalization:Rl,norm:Il,gather:Cc,unsortedSegmentSum:Ec,basicLSTMCell:kl,multiRNNCell:Sl,movingAverage:Al,stridedSlice:Dl,topk:Tl,scatterND:Nl,fft:Fl,ifft:Ol,rfft:_l,irfft:Ml,sparseToDense:Pl,gatherND:Ll,diag:Wl,dropout:Ul,hannWindow:zl,hammingWindow:Gl,frame:Hl,stft:ql,inTopKAsync:Xl});function Ih(rp,_d){Array.isArray(rp)||(rp=[rp]),rp.forEach(function(np){np!=null&&g(np.dtype!=="complex64",function(){return _d+" does not support complex64 tensors."})})}function kh(rp,_d,np,ap){if(np==="linear")return rp.linear(_d);if(np==="relu")return rp.relu(_d);if(np==="elu")return rp.elu(_d);if(np==="relu6")return rp.relu6(_d);if(np==="prelu")return rp.prelu(_d,ap);throw new Error("Activation "+np+" has not been implemented for the CPU backend.")}var Sh=function(rp){function _d(){var np=rp.call(this)||this;if(np.blockSize=48,np.firstUse=!0,a$1().get("IS_BROWSER")){var ap=typeof OffscreenCanvas<"u"?new OffscreenCanvas(300,150):typeof document<"u"?document.createElement("canvas"):null;ap!==null&&(np.fromPixels2DContext=ap.getContext("2d"))}return np.data=new so(np,Nt),np}return e(_d,rp),_d.prototype.write=function(np,ap,sp){this.firstUse&&(this.firstUse=!1,a$1().get("IS_NODE")&&un(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================
`));var lp={};return this.data.set(lp,{values:np,dtype:sp}),lp},_d.prototype.move=function(np,ap,sp,lp){this.data.set(np,{values:ap,dtype:lp})},_d.prototype.numDataIds=function(){return this.data.numDataIds()},_d.prototype.fromPixels=function(np,ap){if(np==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var sp,lp,up=np.data instanceof Uint8Array,cp=typeof ImageData<"u"&&np instanceof ImageData,dp=typeof HTMLVideoElement<"u"&&np instanceof HTMLVideoElement,hp=typeof HTMLImageElement<"u"&&np instanceof HTMLImageElement,fp=dp?[np.videoWidth,np.videoHeight]:[np.width,np.height],pp=fp[0],mp=fp[1];if(a$1().get("IS_NODE")&&np.getContext==null)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(np.getContext!=null)sp=np.getContext("2d").getImageData(0,0,pp,mp).data;else if(cp||up)sp=np.data;else{if(!hp&&!dp)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+np.constructor.name);if(this.fromPixels2DContext==null)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=pp,this.fromPixels2DContext.canvas.height=mp,this.fromPixels2DContext.drawImage(np,0,0,pp,mp),sp=this.fromPixels2DContext.getImageData(0,0,pp,mp).data}if(ap===4)lp=new Int32Array(sp);else{var gp=pp*mp;lp=new Int32Array(gp*ap);for(var yp=0;yp<gp;yp++)for(var xp=0;xp<ap;++xp)lp[yp*ap+xp]=sp[4*yp+xp]}return Nn(lp,[mp,pp,ap],"int32")},_d.prototype.read=function(np){return n$1(this,void 0,void 0,function(){return r(this,function(ap){return[2,this.readSync(np)]})})},_d.prototype.readSync=function(np){var ap=this.data.get(np),sp=ap.dtype,lp=ap.complexTensors;return sp==="complex64"?No(this.readSync(lp.real.dataId),this.readSync(lp.imag.dataId)):this.data.get(np).values},_d.prototype.bufferSync=function(np){var ap=this.readSync(np.dataId),sp=ap;if(np.dtype==="string")try{sp=ap.map(function(lp){return Z(lp)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ur(np.shape,np.dtype,sp)},_d.prototype.makeOutput=function(np,ap,sp){var lp=this.write(np,ap,sp);return Nt.makeTensorFromDataId(lp,ap,sp,this)},_d.prototype.disposeData=function(np){if(this.data.has(np)){var ap=this.data.get(np).complexTensors;ap!=null&&(ap.real.dispose(),ap.imag.dispose()),this.data.delete(np)}},_d.prototype.time=function(np){return n$1(this,void 0,void 0,function(){var ap;return r(this,function(sp){return ap=Y(),np(),[2,{kernelMs:Y()-ap}]})})},_d.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},_d.prototype.complex=function(np,ap){var sp=this.makeOutput(null,np.shape,"complex64");return this.data.get(sp.dataId).complexTensors={real:Nt.keep(np.clone()),imag:Nt.keep(ap.clone())},sp},_d.prototype.real=function(np){return this.data.get(np.dataId).complexTensors.real.clone()},_d.prototype.imag=function(np){return this.data.get(np.dataId).complexTensors.imag.clone()},_d.prototype.slice=function(np,ap,sp){if(Ih(np,"slice"),Yr(np.shape,ap,sp)){var lp=Qr(ap,np.strides),up=w$1(sp);return kn(this.readSync(np.dataId).subarray(lp,lp+up),sp,np.dtype)}for(var cp=ur(sp,np.dtype),dp=this.bufferSync(np),hp=0;hp<cp.size;++hp){var fp=cp.indexToLoc(hp).map(function(pp,mp){return pp+ap[mp]});cp.values[hp]=dp.get.apply(dp,fp)}return cp.toTensor()},_d.prototype.stridedSlice=function(np,ap,sp,lp){Ih(np,"stridedSlice");var up=jr(ap,sp,lp);if(up.some(function(gp){return gp===0}))return kn([],up);for(var cp=ur(up,np.dtype),dp=this.bufferSync(np),hp=0;hp<cp.size;hp++){for(var fp=cp.indexToLoc(hp),pp=new Array(fp.length),mp=0;mp<pp.length;mp++)pp[mp]=fp[mp]*lp[mp]+ap[mp];cp.set.apply(cp,[dp.get.apply(dp,pp)].concat(fp))}return cp.toTensor()},_d.prototype.diag=function(np){for(var ap=this.readSync(np.dataId),sp=ur([np.size,np.size],np.dtype),lp=sp.values,up=0;up<ap.length;up++)lp[up*np.size+up]=ap[up];return sp.toTensor()},_d.prototype.unstack=function(np,ap){for(var sp=np.shape[ap],lp=new Array(np.rank-1),up=0,cp=0;cp<np.rank;cp++)cp!==ap&&(lp[up++]=np.shape[cp]);var dp=new Array(np.rank).fill(0),hp=np.shape.slice();hp[ap]=1;var fp=new Array(sp);for(cp=0;cp<fp.length;cp++)dp[ap]=cp,fp[cp]=this.slice(np,dp,hp).reshape(lp);return fp},_d.prototype.reverse=function(np,ap){Ih(np,"reverse");for(var sp=ur(np.shape,np.dtype),lp=this.bufferSync(np),up=function(dp){var hp=sp.indexToLoc(dp),fp=hp.slice();ap.forEach(function(pp){return fp[pp]=np.shape[pp]-1-fp[pp]}),sp.set.apply(sp,[lp.get.apply(lp,fp)].concat(hp))},cp=0;cp<sp.size;cp++)up(cp);return sp.toTensor()},_d.prototype.concat=function(np,ap){var sp=this;if(np[0].dtype==="complex64"){var lp=np.map(function(gp){return Rn(gp)}),up=np.map(function(gp){return In(gp)});return En(this.concat(lp,ap),this.concat(up,ap))}var cp=np.map(function(gp){var yp=w$1(gp.shape.slice(ap));return gp.as2D(-1,yp)}),dp=wn(cp.map(function(gp){return gp.shape}),1),hp=ur(dp,np[0].dtype).values;if(cp[0].shape[0]===1){var fp=0;cp.forEach(function(gp){hp.set(sp.readSync(gp.dataId),fp),fp+=gp.size})}else{var pp=0;cp.forEach(function(gp){for(var yp=sp.readSync(gp.dataId),xp=0,_p=0;_p<gp.shape[0];++_p)for(var vp=_p*dp[1]+pp,bp=0;bp<gp.shape[1];++bp)hp[vp+bp]=yp[xp++];pp+=gp.shape[1]})}var mp=wn(np.map(function(gp){return gp.shape}),ap);return kn(hp,mp,np[0].dtype)},_d.prototype.neg=function(np){return Ih(np,"neg"),this.multiply(An(-1),np)},_d.prototype.add=function(np,ap){return np.dtype==="complex64"||ap.dtype==="complex64"?this.broadcastedBinaryComplexOp(np.cast("complex64"),ap.cast("complex64"),function(sp,lp,up,cp){return{real:sp+up,imag:lp+cp}}):this.broadcastedBinaryOp(np,ap,Ct(np.dtype,ap.dtype),function(sp,lp){return sp+lp})},_d.prototype.addN=function(np){var ap=this;Ih(np,"addN");for(var sp=np.map(function(fp){return ap.readSync(fp.dataId)}),lp=ur(np[0].shape,np[0].dtype),up=lp.values,cp=0;cp<np.length;cp++)for(var dp=sp[cp],hp=0;hp<up.length;hp++)up[hp]+=dp[hp];return lp.toTensor()},_d.prototype.subtract=function(np,ap){return np.dtype==="complex64"||ap.dtype==="complex64"?this.broadcastedBinaryComplexOp(np.cast("complex64"),ap.cast("complex64"),function(sp,lp,up,cp){return{real:sp-up,imag:lp-cp}}):this.broadcastedBinaryOp(np,ap,Ct(np.dtype,ap.dtype),function(sp,lp){return sp-lp})},_d.prototype.pow=function(np,ap){return Ih([np,ap],"pow"),this.broadcastedBinaryOp(np,ap,np.dtype,function(sp,lp){return Math.pow(sp,lp)})},_d.prototype.batchMatMul=function(np,ap,sp,lp){Ih([np,ap],"matMul");for(var up=sp?np.shape[1]:np.shape[2],cp=sp?np.shape[2]:np.shape[1],dp=lp?ap.shape[1]:ap.shape[2],hp=np.shape[0],fp=this.readSync(np.dataId),pp=this.readSync(ap.dataId),mp=sp?[np.strides[0],1,np.strides[1]]:[np.strides[0],np.strides[1],1],gp=mp[0],yp=mp[1],xp=mp[2],_p=lp?[1,ap.strides[1],ap.strides[0]]:[ap.strides[1],1,ap.strides[0]],vp=_p[0],bp=_p[1],Ep=_p[2],Sp=cp*dp,Ap=ur([hp,cp,dp],np.dtype),Rp=Ap.values,Tp=this.blockSize,Mp=0;Mp<hp;Mp++)for(var Op=0;Op<cp;Op+=Tp)for(var Pp=0;Pp<dp;Pp+=Tp)for(var $p=0;$p<up;$p+=Tp)for(var zp=Math.min(Op+Tp,cp),Dp=Math.min(Pp+Tp,dp),Fp=Math.min($p+Tp,up),jp=Op;jp<zp;jp++)for(var Lp=Pp;Lp<Dp;Lp++){for(var Bp=0,Ip=$p;Ip<Fp;Ip++)Bp+=fp[Mp*gp+jp*yp+Ip*xp]*pp[Ip*vp+Lp*bp+Mp*Ep];Rp[Mp*Sp+(jp*dp+Lp)]+=Bp}return Ap.toTensor()},_d.prototype.fusedBatchMatMul=function(np){var ap=np.a,sp=np.b,lp=np.transposeA,up=np.transposeB,cp=np.bias,dp=np.activation,hp=np.preluActivationWeights,fp=this.batchMatMul(ap,sp,lp,up);return cp&&(fp=this.add(fp,cp)),dp&&(fp=kh(this,fp,dp,hp)),fp},_d.prototype.multiply=function(np,ap){return np.dtype==="complex64"||ap.dtype==="complex64"?this.broadcastedBinaryComplexOp(np.cast("complex64"),ap.cast("complex64"),function(sp,lp,up,cp){return{real:sp*up-lp*cp,imag:sp*cp+lp*up}}):this.broadcastedBinaryOp(np,ap,Ct(np.dtype,ap.dtype),function(sp,lp){return sp*lp})},_d.prototype.realDivide=function(np,ap){return Ih([np,ap],"realDivide"),this.broadcastedBinaryOp(np,ap,"float32",function(sp,lp){return sp/lp})},_d.prototype.floorDiv=function(np,ap){return Ih([np,ap],"floorDiv"),this.broadcastedBinaryOp(np,ap,"int32",function(sp,lp){return Math.floor(sp/lp)})},_d.prototype.sum=function(np,ap){Ih(np,"sum"),mn("sum",ap,np.rank);for(var sp=dn(np.shape,ap),lp=sp[0],up=sp[1],cp=Pn(lp,Ct(np.dtype,"int32")),dp=w$1(up),hp=this.readSync(cp.dataId),fp=this.readSync(np.dataId),pp=0;pp<hp.length;++pp){for(var mp=pp*dp,gp=0,yp=0;yp<dp;++yp)gp+=fp[mp+yp];hp[pp]=gp}return cp},_d.prototype.prod=function(np,ap){Ih(np,"sum");for(var sp=dn(np.shape,ap),lp=sp[0],up=sp[1],cp=Pn(lp,Ct(np.dtype,"int32")),dp=w$1(up),hp=this.readSync(cp.dataId),fp=this.readSync(np.dataId),pp=0;pp<hp.length;++pp){for(var mp=pp*dp,gp=1,yp=0;yp<dp;++yp)gp*=fp[mp+yp];hp[pp]=gp}return cp},_d.prototype.unsortedSegmentSum=function(np,ap,sp){Ih(np,"unsortedSegmentSum");for(var lp=[],up=np.rank-ap.rank,cp=0;cp<up;++cp)ap=ap.expandDims(cp+1);for(cp=0;cp<sp;++cp){var dp=An(cp,"int32"),hp=sc(dp,ap).asType("float32").mul(np).sum(0);lp.push(hp)}return Tr(lp)},_d.prototype.argMin=function(np,ap){Ih(np,"argMin");var sp=[ap];mn("argMin",sp,np.rank);for(var lp=dn(np.shape,sp),up=lp[0],cp=lp[1],dp=Pn(up,"int32"),hp=w$1(cp),fp=this.readSync(dp.dataId),pp=this.readSync(np.dataId),mp=0;mp<fp.length;++mp){for(var gp=mp*hp,yp=pp[gp],xp=0,_p=0;_p<hp;++_p){var vp=pp[gp+_p];vp<yp&&(yp=vp,xp=_p)}fp[mp]=xp}return dp},_d.prototype.argMax=function(np,ap){Ih(np,"argMax");var sp=[ap];mn("argMax",sp,np.rank);for(var lp=dn(np.shape,sp),up=lp[0],cp=lp[1],dp=Pn(up,"int32"),hp=w$1(cp),fp=this.readSync(dp.dataId),pp=this.readSync(np.dataId),mp=0;mp<fp.length;++mp){for(var gp=mp*hp,yp=pp[gp],xp=0,_p=0;_p<hp;++_p){var vp=pp[gp+_p];vp>yp&&(yp=vp,xp=_p)}fp[mp]=xp}return dp},_d.prototype.cumsum=function(np,ap,sp,lp){if(Ih(np,"cumsum"),ap!==np.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(np.rank-1)+" but got axis="+ap);for(var up=Ct(np.dtype,"int32"),cp=Pn(np.shape,up),dp=this.readSync(cp.dataId),hp=this.readSync(np.dataId),fp=np.shape[np.rank-1],pp=lp?function(_p,vp){return _p+fp-vp-1}:function(_p,vp){return _p+vp},mp=0;mp<hp.length;mp+=fp)for(var gp=0;gp<fp;gp++){var yp=pp(mp,gp);if(gp===0)dp[yp]=sp?0:hp[yp];else{var xp=pp(mp,gp-1);dp[yp]=sp?hp[xp]+dp[xp]:hp[yp]+dp[xp]}}return cp},_d.prototype.equal=function(np,ap){return Ih([np,ap],"equal"),this.broadcastedBinaryOp(np,ap,"bool",function(sp,lp){return sp===lp?1:0})},_d.prototype.notEqual=function(np,ap){return Ih([np,ap],"notEqual"),this.broadcastedBinaryOp(np,ap,"bool",function(sp,lp){return sp!==lp?1:0})},_d.prototype.less=function(np,ap){return Ih([np,ap],"less"),this.broadcastedBinaryOp(np,ap,"bool",function(sp,lp){return sp<lp?1:0})},_d.prototype.lessEqual=function(np,ap){return Ih([np,ap],"lessEqual"),this.broadcastedBinaryOp(np,ap,"bool",function(sp,lp){return sp<=lp?1:0})},_d.prototype.greater=function(np,ap){return Ih([np,ap],"greater"),this.broadcastedBinaryOp(np,ap,"bool",function(sp,lp){return sp>lp?1:0})},_d.prototype.greaterEqual=function(np,ap){return Ih([np,ap],"greaterEqual"),this.broadcastedBinaryOp(np,ap,"bool",function(sp,lp){return sp>=lp?1:0})},_d.prototype.logicalNot=function(np){Ih(np,"logicalNot");for(var ap=this.readSync(np.dataId),sp=new Uint8Array(ap.length),lp=0;lp<ap.length;++lp)sp[lp]=ap[lp]?0:1;return this.makeOutput(sp,np.shape,"bool")},_d.prototype.logicalAnd=function(np,ap){return Ih([np,ap],"logicalAnd"),this.broadcastedBinaryOp(np,ap,"bool",function(sp,lp){return sp&&lp})},_d.prototype.logicalOr=function(np,ap){return Ih([np,ap],"logicalOr"),this.broadcastedBinaryOp(np,ap,"bool",function(sp,lp){return sp||lp})},_d.prototype.select=function(np,ap,sp){Ih([np,ap,sp],"select");for(var lp=this.readSync(np.dataId),up=this.readSync(ap.dataId),cp=this.readSync(sp.dataId),dp=Pn(ap.shape,Ct(ap.dtype,sp.dtype)),hp=this.readSync(dp.dataId),fp=0,pp=np.rank===0||np.rank>1||ap.rank===1?1:w$1(ap.shape.slice(1)),mp=0;mp<lp.length;mp++)for(var gp=0;gp<pp;gp++)lp[mp]===1?hp[fp++]=up[mp]:hp[fp++]=cp[mp];return dp},_d.prototype.where=function(np){Ih([np],"where");var ap=this.readSync(np.dataId);return Uo(np.shape,ap)},_d.prototype.topk=function(np,ap,sp){return Ih(np,"topk"),Wo(this.readSync(np.dataId),np.shape,np.dtype,ap)},_d.prototype.min=function(np,ap){Ih(np,"min"),mn("min",ap,np.rank);for(var sp=dn(np.shape,ap),lp=sp[0],up=sp[1],cp=Pn(lp,np.dtype),dp=w$1(up),hp=this.readSync(cp.dataId),fp=this.readSync(np.dataId),pp=0;pp<hp.length;++pp){for(var mp=pp*dp,gp=fp[mp],yp=0;yp<dp;++yp){var xp=fp[mp+yp];xp<gp&&(gp=xp)}hp[pp]=gp}return cp},_d.prototype.minimum=function(np,ap){return Ih([np,ap],"minimum"),this.broadcastedBinaryOp(np,ap,np.dtype,function(sp,lp){return Math.min(sp,lp)})},_d.prototype.mod=function(np,ap){return Ih([np,ap],"mod"),this.broadcastedBinaryOp(np,ap,np.dtype,function(sp,lp){var up=sp%lp;return sp<0&&lp<0||sp>=0&&lp>=0?up:(up+lp)%lp})},_d.prototype.max=function(np,ap){Ih(np,"max"),mn("max",ap,np.rank);for(var sp=dn(np.shape,ap),lp=sp[0],up=sp[1],cp=Pn(lp,np.dtype),dp=w$1(up),hp=this.readSync(cp.dataId),fp=this.readSync(np.dataId),pp=0;pp<hp.length;++pp){for(var mp=pp*dp,gp=fp[mp],yp=0;yp<dp;++yp){var xp=fp[mp+yp];xp>gp&&(gp=xp)}hp[pp]=gp}return cp},_d.prototype.maximum=function(np,ap){return Ih([np,ap],"maximum"),this.broadcastedBinaryOp(np,ap,np.dtype,function(sp,lp){return Math.max(sp,lp)})},_d.prototype.all=function(np,ap){Ih(np,"all"),mn("all",ap,np.rank);for(var sp=dn(np.shape,ap),lp=sp[0],up=sp[1],cp=Pn(lp,np.dtype),dp=w$1(up),hp=this.readSync(cp.dataId),fp=this.readSync(np.dataId),pp=0;pp<hp.length;++pp){for(var mp=pp*dp,gp=fp[mp],yp=0;yp<dp;++yp){var xp=fp[mp+yp];gp=gp&&xp}hp[pp]=gp}return cp},_d.prototype.any=function(np,ap){Ih(np,"any"),mn("any",ap,np.rank);for(var sp=dn(np.shape,ap),lp=sp[0],up=sp[1],cp=Pn(lp,np.dtype),dp=w$1(up),hp=this.readSync(cp.dataId),fp=this.readSync(np.dataId),pp=0;pp<hp.length;++pp){for(var mp=pp*dp,gp=fp[mp],yp=0;yp<dp;++yp){var xp=fp[mp+yp];gp=gp||xp}hp[pp]=gp}return cp},_d.prototype.squaredDifference=function(np,ap){return Ih([np,ap],"squaredDifference"),this.broadcastedBinaryOp(np,ap,np.dtype,function(sp,lp){var up=sp-lp;return up*up})},_d.prototype.ceil=function(np){Ih(np,"ceil");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp)sp[lp]=Math.ceil(ap[lp]);return this.makeOutput(sp,np.shape,"float32")},_d.prototype.floor=function(np){Ih(np,"floor");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp)sp[lp]=Math.floor(ap[lp]);return this.makeOutput(sp,np.shape,"float32")},_d.prototype.sign=function(np){Ih(np,"x");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp)ap[lp]<0?sp[lp]=-1:ap[lp]>0?sp[lp]=1:sp[lp]=0;return this.makeOutput(sp,np.shape,"float32")},_d.prototype.isNaN=function(np){Ih(np,"x");for(var ap=this.readSync(np.dataId),sp=new Uint8Array(ap.length),lp=0;lp<ap.length;++lp)Number.isNaN(ap[lp])&&(sp[lp]=1);return this.makeOutput(sp,np.shape,"bool")},_d.prototype.isInf=function(np){Ih(np,"x");for(var ap=this.readSync(np.dataId),sp=new Uint8Array(ap.length),lp=0;lp<ap.length;++lp)Math.abs(ap[lp])===1/0&&(sp[lp]=1);return this.makeOutput(sp,np.shape,"bool")},_d.prototype.isFinite=function(np){Ih(np,"x");for(var ap=this.readSync(np.dataId),sp=new Uint8Array(ap.length),lp=0;lp<ap.length;++lp)Number.isFinite(ap[lp])&&(sp[lp]=1);return this.makeOutput(sp,np.shape,"bool")},_d.prototype.round=function(np){Ih(np,"round");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp){var up=Math.floor(ap[lp]);ap[lp]-up<.5?sp[lp]=Math.floor(ap[lp]):ap[lp]-up>.5?sp[lp]=Math.ceil(ap[lp]):sp[lp]=up%2==0?up:up+1}return this.makeOutput(sp,np.shape,"float32")},_d.prototype.exp=function(np){Ih(np,"exp");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp)sp[lp]=Math.exp(ap[lp]);return this.makeOutput(sp,np.shape,"float32")},_d.prototype.expm1=function(np){Ih(np,"expm1");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp)sp[lp]=Math.expm1(ap[lp]);return this.makeOutput(sp,np.shape,"float32")},_d.prototype.log=function(np){Ih(np,"log");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp){var up=ap[lp];sp[lp]=Math.log(up)}return this.makeOutput(sp,np.shape,"float32")},_d.prototype.log1p=function(np){Ih(np,"log1p");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp){var up=ap[lp];sp[lp]=Math.log1p(up)}return this.makeOutput(sp,np.shape,"float32")},_d.prototype.sqrt=function(np){Ih(np,"sqrt");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp){var up=ap[lp];sp[lp]=Math.sqrt(up)}return this.makeOutput(sp,np.shape,"float32")},_d.prototype.rsqrt=function(np){Ih(np,"rsqrt");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp){var up=ap[lp];sp[lp]=1/Math.sqrt(up)}return this.makeOutput(sp,np.shape,"float32")},_d.prototype.reciprocal=function(np){Ih(np,"reciprocal");for(var ap=this.readSync(np.dataId),sp=new Float32Array(ap.length),lp=0;lp<ap.length;++lp)sp[lp]=1/ap[lp];return this.makeOutput(sp,np.shape,"float32")},_d.prototype.linear=function(np){return np},_d.prototype.relu=function(np){Ih(np,"relu");for(var ap=Pn(np.shape,np.dtype),sp=this.readSync(ap.dataId),lp=this.readSync(np.dataId),up=0;up<lp.length;++up)sp[up]=Math.max(0,lp[up]);return ap},_d.prototype.relu6=function(np){Ih(np,"relu");for(var ap=Pn(np.shape,np.dtype),sp=this.readSync(ap.dataId),lp=this.readSync(np.dataId),up=0;up<lp.length;++up)sp[up]=Math.min(Math.max(0,lp[up]),6);return ap},_d.prototype.prelu=function(np,ap){return Ih([np,ap],"prelu"),this.broadcastedBinaryOp(np,ap,np.dtype,function(sp,lp){return sp<0?lp*sp:sp})},_d.prototype.elu=function(np){Ih(np,"elu");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp){var up=sp[lp];ap[lp]=up>=0?up:Math.exp(up)-1}return this.makeOutput(ap,np.shape,"float32")},_d.prototype.eluDer=function(np,ap){Ih([np,ap],"eluDer");for(var sp=new Float32Array(ap.size),lp=this.readSync(ap.dataId),up=this.readSync(np.dataId),cp=0;cp<lp.length;++cp){var dp=lp[cp];sp[cp]=dp>=1?up[cp]:up[cp]*(dp+1)}return this.makeOutput(sp,ap.shape,"float32")},_d.prototype.selu=function(np){Ih(np,"selu");for(var ap=iu,sp=uu,lp=new Float32Array(np.size),up=this.readSync(np.dataId),cp=0;cp<up.length;++cp){var dp=up[cp];lp[cp]=dp>=0?sp*dp:ap*(Math.exp(dp)-1)}return this.makeOutput(lp,np.shape,"float32")},_d.prototype.clip=function(np,ap,sp){Ih(np,"clip");for(var lp=new Float32Array(np.size),up=this.readSync(np.dataId),cp=0;cp<up.length;++cp){var dp=up[cp];lp[cp]=dp>sp?sp:dp<ap?ap:dp}return this.makeOutput(lp,np.shape,"float32")},_d.prototype.abs=function(np){for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.abs(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.complexAbs=function(np){for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<np.size;++lp){var up=sp[2*lp],cp=sp[2*lp+1];ap[lp]=Math.hypot(up,cp)}return this.makeOutput(ap,np.shape,"float32")},_d.prototype.int=function(np){Ih(np,"int");for(var ap=new Int32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=sp[lp];return this.makeOutput(ap,np.shape,"int32")},_d.prototype.sigmoid=function(np){Ih(np,"sigmoid");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=1/(1+Math.exp(-sp[lp]));return this.makeOutput(ap,np.shape,"float32")},_d.prototype.softplus=function(np){Ih(np,"softplus");for(var ap=Math.log(11920928955078125e-23)+2,sp=new Float32Array(np.size),lp=this.readSync(np.dataId),up=0;up<lp.length;++up){var cp=lp[up]>-ap,dp=lp[up]<ap,hp=Math.exp(lp[up]),fp=void 0;fp=dp?hp:cp?lp[up]:Math.log(1+hp),sp[up]=fp}return this.makeOutput(sp,np.shape,"float32")},_d.prototype.sin=function(np){Ih(np,"sin");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.sin(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.cos=function(np){Ih(np,"cos");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.cos(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.tan=function(np){Ih(np,"tan");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.tan(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.asin=function(np){Ih(np,"asin");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.asin(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.acos=function(np){Ih(np,"acos");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.acos(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.atan=function(np){Ih(np,"atan");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.atan(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.atan2=function(np,ap){return Ih([np,ap],"atan2"),this.broadcastedBinaryOp(np,ap,np.dtype,function(sp,lp){return Math.atan2(sp,lp)})},_d.prototype.sinh=function(np){Ih(np,"sinh");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.sinh(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.cosh=function(np){Ih(np,"cosh");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.cosh(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.tanh=function(np){Ih(np,"tanh");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=R$1(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.asinh=function(np){Ih(np,"asinh");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.asinh(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.acosh=function(np){Ih(np,"acosh");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.acosh(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.atanh=function(np){Ih(np,"atanh");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp)ap[lp]=Math.atanh(sp[lp]);return this.makeOutput(ap,np.shape,"float32")},_d.prototype.erf=function(np){Ih(np,"erf");for(var ap=new Float32Array(np.size),sp=this.readSync(np.dataId),lp=0;lp<sp.length;++lp){var up=Math.sign(sp[lp]),cp=Math.abs(sp[lp]),dp=1/(1+.3275911*cp);ap[lp]=up*(1-((((1.061405429*dp-1.453152027)*dp+1.421413741)*dp-.284496736)*dp+.254829592)*dp*Math.exp(-cp*cp))}return this.makeOutput(ap,np.shape,"float32")},_d.prototype.step=function(np,ap){ap===void 0&&(ap=0),Ih(np,"step");for(var sp=new Float32Array(np.size),lp=this.readSync(np.dataId),up=0;up<lp.length;++up){var cp=lp[up];isNaN(cp)?sp[up]=NaN:sp[up]=cp>0?1:ap}return this.makeOutput(sp,np.shape,"float32")},_d.prototype.fusedConv2d=function(np){var ap=np.input,sp=np.filter,lp=np.convInfo,up=np.bias,cp=np.activation,dp=np.preluActivationWeights,hp=this.conv2d(ap,sp,lp);return up&&(hp=this.add(hp,up)),cp&&(hp=kh(this,hp,cp,dp)),hp},_d.prototype.conv2d=function(np,ap,sp){Ih([np,ap],"conv2d");for(var lp=sp.filterHeight,up=sp.filterWidth,cp=sp.dilationHeight,dp=sp.dilationWidth,hp=sp.padInfo.left,fp=sp.padInfo.top,pp=sp.dataFormat==="channelsLast",mp=ur(sp.outShape,np.dtype),gp=np.strides[0],yp=pp?np.strides[1]:np.strides[2],xp=pp?np.strides[2]:1,_p=pp?1:np.strides[1],vp=mp.strides[0],bp=pp?mp.strides[1]:mp.strides[2],Ep=pp?mp.strides[2]:1,Sp=pp?1:mp.strides[1],Ap=this.readSync(np.dataId),Rp=this.readSync(ap.dataId),Tp=mp.values,Mp=0;Mp<sp.batchSize;++Mp)for(var Op=Mp*gp,Pp=Mp*vp,$p=0;$p<sp.outHeight;++$p)for(var zp=Pp+$p*bp,Dp=$p*sp.strideHeight-fp,Fp=0;Fp<lp;Fp++){var jp=Dp+Fp*cp;if(!(jp<0||jp>=sp.inHeight))for(var Lp=Fp*ap.strides[0],Bp=Op+jp*yp,Ip=0;Ip<sp.outWidth;++Ip)for(var kp=zp+Ip*Ep,Up=Ip*sp.strideWidth-hp,Gp=0;Gp<up;Gp++){var Wp=Up+Gp*dp;if(!(Wp<0||Wp>=sp.inWidth))for(var Qp=Bp+Wp*xp,Xp=Lp+Gp*ap.strides[1],rm=0;rm<sp.inChannels;++rm){for(var Kp=Ap[Qp+rm*_p],lm=0;lm<sp.outChannels;++lm)Tp[kp+lm*Sp]+=Kp*Rp[Xp+lm];Xp+=sp.outChannels}}}return mp.toTensor()},_d.prototype.conv3d=function(np,ap,sp){for(var lp=sp.filterDepth,up=sp.filterHeight,cp=sp.filterWidth,dp=sp.dilationDepth,hp=sp.dilationHeight,fp=sp.dilationWidth,pp=sp.padInfo.front,mp=sp.padInfo.left,gp=sp.padInfo.top,yp=ur(sp.outShape,np.dtype),xp=this.readSync(np.dataId),_p=this.readSync(ap.dataId),vp=yp.values,bp=0;bp<sp.batchSize;++bp)for(var Ep=bp*np.strides[0],Sp=bp*yp.strides[0],Ap=0;Ap<sp.outDepth;++Ap)for(var Rp=Sp+Ap*yp.strides[1],Tp=Ap*sp.strideDepth-pp,Mp=0;Mp<lp;Mp++){var Op=Tp+Mp*dp;if(!(Op<0||Op>=sp.inDepth))for(var Pp=Mp*ap.strides[0],$p=Ep+Op*np.strides[1],zp=0;zp<sp.outHeight;++zp)for(var Dp=Rp+zp*yp.strides[2],Fp=zp*sp.strideHeight-gp,jp=0;jp<up;jp++){var Lp=Fp+jp*hp;if(!(Lp<0||Lp>=sp.inHeight))for(var Bp=Pp+jp*ap.strides[1],Ip=$p+Lp*np.strides[2],kp=0;kp<sp.outWidth;++kp)for(var Up=Dp+kp*sp.outChannels,Gp=kp*sp.strideWidth-mp,Wp=0;Wp<cp;Wp++){var Qp=Gp+Wp*fp;if(!(Qp<0||Qp>=sp.inWidth))for(var Xp=Bp+Wp*ap.strides[2],rm=Ip+Qp*sp.inChannels,Kp=Xp,lm=0;lm<sp.inChannels;++lm){for(var cm=xp[rm+lm],gm=0;gm<sp.outChannels;++gm)vp[Up+gm]+=cm*_p[Kp+gm];Kp+=sp.outChannels}}}}return yp.toTensor()},_d.prototype.conv2dDerInput=function(np,ap,sp){Ih([np,ap],"conv2dDerInput");for(var lp=ur(sp.inShape,"float32"),up=lp.values,cp=this.readSync(np.dataId),dp=this.readSync(ap.dataId),hp=ap.strides,fp=hp[0],pp=hp[1],mp=hp[2],gp=sp.batchSize,yp=sp.filterHeight,xp=sp.filterWidth,_p=sp.inChannels,vp=sp.inHeight,bp=sp.inWidth,Ep=sp.outChannels,Sp=sp.outHeight,Ap=sp.outWidth,Rp=sp.strideHeight,Tp=sp.strideWidth,Mp=sp.dataFormat,Op=yp-1-sp.padInfo.top,Pp=xp-1-sp.padInfo.left,$p=Mp==="channelsLast",zp=lp.strides[0],Dp=$p?lp.strides[1]:lp.strides[2],Fp=$p?lp.strides[2]:1,jp=$p?1:lp.strides[1],Lp=np.strides[0],Bp=$p?np.strides[1]:np.strides[2],Ip=$p?np.strides[2]:1,kp=$p?1:np.strides[1],Up=0;Up<gp;++Up)for(var Gp=0;Gp<_p;++Gp)for(var Wp=0;Wp<vp;++Wp)for(var Qp=Wp-Op,Xp=Math.max(0,Math.ceil(Qp/Rp)),rm=Math.min(Sp,(yp+Qp)/Rp),Kp=0;Kp<bp;++Kp){for(var lm=Kp-Pp,cm=Math.max(0,Math.ceil(lm/Tp)),gm=Math.min(Ap,(xp+lm)/Tp),Mm=0,dm=Xp;dm<rm;++dm)for(var em=dm*Rp-Qp,sm=cm;sm<gm;++sm)for(var Zp=Lp*Up+Bp*dm+Ip*sm,mm=fp*(yp-1-em)+pp*(xp-1-(sm*Tp-lm))+mp*Gp,fm=0;fm<Ep;++fm)Mm+=cp[Zp+kp*fm]*dp[mm+fm];up[zp*Up+Dp*Wp+Fp*Kp+jp*Gp]=Mm}return lp.toTensor()},_d.prototype.conv3dDerInput=function(np,ap,sp){for(var lp=ur(sp.inShape,"float32"),up=lp.values,cp=lp.strides,dp=cp[0],hp=cp[1],fp=cp[2],pp=cp[3],mp=this.readSync(np.dataId),gp=np.strides,yp=gp[0],xp=gp[1],_p=gp[2],vp=gp[3],bp=this.readSync(ap.dataId),Ep=ap.strides,Sp=Ep[0],Ap=Ep[1],Rp=Ep[2],Tp=Ep[3],Mp=sp.batchSize,Op=sp.filterDepth,Pp=sp.filterHeight,$p=sp.filterWidth,zp=sp.inChannels,Dp=sp.inDepth,Fp=sp.inHeight,jp=sp.inWidth,Lp=sp.outChannels,Bp=sp.outDepth,Ip=sp.outHeight,kp=sp.outWidth,Up=sp.strideDepth,Gp=sp.strideHeight,Wp=sp.strideWidth,Qp=Op-1-sp.padInfo.front,Xp=Pp-1-sp.padInfo.top,rm=$p-1-sp.padInfo.left,Kp=0;Kp<Mp;++Kp)for(var lm=0;lm<zp;++lm)for(var cm=0;cm<Dp;++cm)for(var gm=cm-Qp,Mm=Math.max(0,Math.ceil(gm/Up)),dm=Math.min(Bp,(Op+gm)/Up),em=0;em<Fp;++em)for(var sm=em-Xp,Zp=Math.max(0,Math.ceil(sm/Gp)),mm=Math.min(Ip,(Pp+sm)/Gp),fm=0;fm<jp;++fm){for(var _m=fm-rm,zm=Math.max(0,Math.ceil(_m/Wp)),tm=Math.min(kp,($p+_m)/Wp),Jp=0,pm=Mm;pm<dm;++pm)for(var km=pm*Up-gm,ym=Zp;ym<mm;++ym)for(var Em=ym*Gp-sm,Bm=zm;Bm<tm;++Bm)for(var Pm=yp*Kp+xp*pm+_p*ym+vp*Bm,Im=Sp*(Op-1-km)+Ap*(Pp-1-Em)+Rp*($p-1-(Bm*Wp-_m))+Tp*lm,Dm=0;Dm<Lp;++Dm)Jp+=mp[Pm+Dm]*bp[Im+Dm];up[dp*Kp+hp*cm+fp*em+pp*fm+lm]=Jp}return lp.toTensor()},_d.prototype.conv2dDerFilter=function(np,ap,sp){Ih([np,ap],"conv2dDerFilter");for(var lp=sp.strideHeight,up=sp.strideWidth,cp=sp.filterHeight,dp=sp.filterWidth,hp=sp.dataFormat==="channelsLast",fp=ur(sp.filterShape,"float32"),pp=sp.padInfo.left,mp=sp.padInfo.top,gp=this.bufferSync(np),yp=this.bufferSync(ap),xp=0;xp<cp;++xp)for(var _p=Math.max(0,Math.ceil((mp-xp)/lp)),vp=Math.min(sp.outHeight,(sp.inHeight+mp-xp)/lp),bp=0;bp<dp;++bp)for(var Ep=Math.max(0,Math.ceil((pp-bp)/up)),Sp=Math.min(sp.outWidth,(sp.inWidth+pp-bp)/up),Ap=0;Ap<sp.inChannels;++Ap)for(var Rp=0;Rp<sp.outChannels;++Rp){for(var Tp=0,Mp=0;Mp<sp.batchSize;++Mp)for(var Op=_p;Op<vp;++Op)for(var Pp=xp+Op*lp-mp,$p=Ep;$p<Sp;++$p){var zp=bp+$p*up-pp;Tp+=hp?gp.get(Mp,Pp,zp,Ap)*yp.get(Mp,Op,$p,Rp):gp.get(Mp,Ap,Pp,zp)*yp.get(Mp,Rp,Op,$p)}fp.set(Tp,xp,bp,Ap,Rp)}return fp.toTensor()},_d.prototype.conv3dDerFilter=function(np,ap,sp){for(var lp=sp.strideDepth,up=sp.strideHeight,cp=sp.strideWidth,dp=sp.filterDepth,hp=sp.filterHeight,fp=sp.filterWidth,pp=ur(sp.filterShape,"float32"),mp=pp.values,gp=pp.strides,yp=gp[0],xp=gp[1],_p=gp[2],vp=gp[3],bp=this.readSync(ap.dataId),Ep=ap.strides,Sp=Ep[0],Ap=Ep[1],Rp=Ep[2],Tp=Ep[3],Mp=this.readSync(np.dataId),Op=np.strides,Pp=Op[0],$p=Op[1],zp=Op[2],Dp=Op[3],Fp=sp.padInfo.front,jp=sp.padInfo.left,Lp=sp.padInfo.top,Bp=0;Bp<dp;++Bp)for(var Ip=Math.max(0,Math.ceil((Fp-Bp)/lp)),kp=Math.min(sp.outDepth,(sp.inDepth+Fp-Bp)/lp),Up=Bp*yp,Gp=0;Gp<hp;++Gp)for(var Wp=Math.max(0,Math.ceil((Lp-Gp)/up)),Qp=Math.min(sp.outHeight,(sp.inHeight+Lp-Gp)/up),Xp=Gp*xp+Up,rm=0;rm<fp;++rm)for(var Kp=Math.max(0,Math.ceil((jp-rm)/cp)),lm=Math.min(sp.outWidth,(sp.inWidth+jp-rm)/cp),cm=rm*_p+Xp,gm=0;gm<sp.inChannels;++gm)for(var Mm=gm*vp+cm,dm=0;dm<sp.outChannels;++dm){for(var em=0,sm=0;sm<sp.batchSize;++sm)for(var Zp=sm*Pp,mm=sm*Sp,fm=Ip;fm<kp;++fm)for(var _m=(Bp+fm*lp-Fp)*$p+Zp,zm=fm*Ap+mm,tm=Wp;tm<Qp;++tm)for(var Jp=(Gp+tm*up-Lp)*zp+_m,pm=tm*Rp+zm,km=Kp;km<lm;++km){var ym=km*Tp+pm;em+=Mp[(rm+km*cp-jp)*Dp+Jp+gm]*bp[ym+dm]}mp[Mm+dm]=em}return pp.toTensor()},_d.prototype.fusedDepthwiseConv2D=function(np){var ap=np.input,sp=np.filter,lp=np.convInfo,up=np.bias,cp=np.activation,dp=np.preluActivationWeights,hp=this.depthwiseConv2D(ap,sp,lp);return up&&(hp=this.add(hp,up)),cp&&(hp=kh(this,hp,cp,dp)),hp},_d.prototype.depthwiseConv2D=function(np,ap,sp){Ih([np,ap],"depthwiseConv2D");for(var lp=sp.filterHeight,up=sp.filterWidth,cp=sp.dilationHeight,dp=sp.dilationWidth,hp=sp.padInfo.left,fp=sp.padInfo.top,pp=sp.outChannels/sp.inChannels,mp=ur(sp.outShape,np.dtype),gp=this.readSync(np.dataId),yp=this.readSync(ap.dataId),xp=mp.values,_p=0;_p<sp.batchSize;++_p)for(var vp=_p*np.strides[0],bp=_p*mp.strides[0],Ep=0;Ep<sp.outHeight;++Ep)for(var Sp=bp+Ep*mp.strides[1],Ap=Ep*sp.strideHeight-hp,Rp=0;Rp<lp;++Rp){var Tp=Ap+Rp*cp;if(!(Tp<0||Tp>=sp.inHeight))for(var Mp=Rp*ap.strides[0],Op=vp+Tp*np.strides[1],Pp=0;Pp<sp.outWidth;++Pp)for(var $p=Sp+Pp*mp.strides[2],zp=Pp*sp.strideWidth-fp,Dp=0;Dp<up;++Dp){var Fp=zp+Dp*dp;if(!(Fp<0||Fp>=sp.inWidth))for(var jp=Mp+Dp*ap.strides[1],Lp=Op+Fp*sp.inChannels,Bp=$p,Ip=jp,kp=0;kp<sp.inChannels;++kp){for(var Up=gp[Lp+kp],Gp=0;Gp<pp;++Gp)xp[Bp+Gp]+=Up*yp[Ip+Gp];Bp+=pp,Ip+=pp}}}return mp.toTensor()},_d.prototype.depthwiseConv2DDerInput=function(np,ap,sp){Ih([np,ap],"depthwiseConv2DDerInput");for(var lp=ur(sp.inShape,"float32"),up=lp.values,cp=lp.strides,dp=cp[0],hp=cp[1],fp=cp[2],pp=this.readSync(np.dataId),mp=np.strides,gp=mp[0],yp=mp[1],xp=mp[2],_p=this.readSync(ap.dataId),vp=ap.strides,bp=vp[0],Ep=vp[1],Sp=vp[2],Ap=sp.batchSize,Rp=sp.filterHeight,Tp=sp.filterWidth,Mp=sp.inChannels,Op=sp.inHeight,Pp=sp.inWidth,$p=sp.outChannels,zp=sp.outHeight,Dp=sp.outWidth,Fp=sp.strideHeight,jp=sp.strideWidth,Lp=Rp-1-sp.padInfo.top,Bp=Tp-1-sp.padInfo.left,Ip=$p/Mp,kp=0;kp<Ap;++kp)for(var Up=0;Up<Mp;++Up)for(var Gp=0;Gp<Op;++Gp)for(var Wp=Gp-Lp,Qp=Math.max(0,Math.ceil(Wp/Fp)),Xp=Math.min(zp,(Rp+Wp)/Fp),rm=0;rm<Pp;++rm){for(var Kp=rm-Bp,lm=Math.max(0,Math.ceil(Kp/jp)),cm=Math.min(Dp,(Tp+Kp)/jp),gm=0,Mm=Qp;Mm<Xp;++Mm)for(var dm=Mm*Fp-Wp,em=lm;em<cm;++em)for(var sm=gp*kp+yp*Mm+xp*em,Zp=bp*(Rp-1-dm)+Ep*(Tp-1-(em*jp-Kp))+Sp*Up,mm=0;mm<Ip;++mm)gm+=pp[sm+(Up*Ip+mm)]*_p[Zp+mm];up[dp*kp+hp*Gp+fp*rm+Up]=gm}return lp.toTensor()},_d.prototype.depthwiseConv2DDerFilter=function(np,ap,sp){Ih([np,ap],"depthwiseConv2DDerFilter");for(var lp=sp.strideHeight,up=sp.strideWidth,cp=sp.filterHeight,dp=sp.filterWidth,hp=ur(sp.filterShape,"float32"),fp=sp.padInfo.left,pp=sp.padInfo.top,mp=sp.outChannels/sp.inChannels,gp=this.bufferSync(np),yp=this.bufferSync(ap),xp=0;xp<cp;++xp)for(var _p=Math.max(0,Math.ceil((pp-xp)/lp)),vp=Math.min(sp.outHeight,(sp.inHeight+pp-xp)/lp),bp=0;bp<dp;++bp)for(var Ep=Math.max(0,Math.ceil((fp-bp)/up)),Sp=Math.min(sp.outWidth,(sp.inWidth+fp-bp)/up),Ap=0;Ap<sp.outChannels;++Ap){for(var Rp=Math.trunc(Ap/mp),Tp=Ap%mp,Mp=0,Op=0;Op<sp.batchSize;++Op)for(var Pp=_p;Pp<vp;++Pp)for(var $p=xp+Pp*lp-pp,zp=Ep;zp<Sp;++zp){var Dp=bp+zp*up-fp;Mp+=gp.get(Op,$p,Dp,Rp)*yp.get(Op,Pp,zp,Ap)}hp.set(Mp,xp,bp,Rp,Tp)}return hp.toTensor()},_d.prototype.tile=function(np,ap){return Ih(np,"tile"),Lo(this.bufferSync(np),ap)},_d.prototype.pad=function(np,ap,sp){Ih(np,"pad");var lp=ap.map(function(mp,gp){return mp[0]+np.shape[gp]+mp[1]}),up=ap.map(function(mp){return mp[0]}),cp=this.bufferSync(np),dp=ur(lp,np.dtype);sp!==0&&dp.values.fill(sp);for(var hp=0;hp<np.size;hp++){var fp=cp.indexToLoc(hp),pp=fp.map(function(mp,gp){return mp+up[gp]});dp.set.apply(dp,[cp.get.apply(cp,fp)].concat(pp))}return dp.toTensor()},_d.prototype.transpose=function(np,ap){Ih(np,"transpose");for(var sp=new Array(np.rank),lp=0;lp<sp.length;lp++)sp[lp]=np.shape[ap[lp]];var up=this.readSync(np.dataId),cp=ur(sp,np.dtype),dp=this.bufferSync(np);for(lp=0;lp<np.size;++lp){for(var hp=dp.indexToLoc(lp),fp=new Array(hp.length),pp=0;pp<fp.length;pp++)fp[pp]=hp[ap[pp]];var mp=cp.locToIndex(fp);cp.values[mp]=up[lp]}return cp.toTensor()},_d.prototype.gather=function(np,ap,sp){Ih([np,ap],"gather");var lp=np.shape.slice(),up=this.readSync(ap.dataId);lp[sp]=up.length;for(var cp=ur(lp,np.dtype),dp=this.bufferSync(np),hp=0;hp<cp.size;++hp){var fp=cp.indexToLoc(hp),pp=fp.slice();pp[sp]=up[fp[sp]];var mp=dp.locToIndex(pp);cp.values[hp]=dp.values[mp]}return cp.toTensor()},_d.prototype.batchToSpaceND=function(np,ap,sp){Ih([np],"batchToSpaceND");var lp=ap.reduce(function(pp,mp){return pp*mp}),up=Mr(np.shape,ap,lp),cp=Br(up.length,ap.length),dp=Pr(np.shape,ap,lp),hp=Lr(sp,ap.length),fp=Wr(dp,sp,ap.length);return np.reshape(up).transpose(cp).reshape(dp).slice(hp,fp)},_d.prototype.spaceToBatchND=function(np,ap,sp){Ih([np],"spaceToBatchND");var lp=ap.reduce(function(mp,gp){return mp*gp}),up=[[0,0]];up.push.apply(up,sp);for(var cp=1+ap.length;cp<np.shape.length;++cp)up.push([0,0]);var dp=np.pad(up),hp=Mr(dp.shape,ap,lp,!1),fp=Br(hp.length,ap.length,!1),pp=Pr(dp.shape,ap,lp,!1);return dp.reshape(hp).transpose(fp).reshape(pp)},_d.prototype.pool=function(np,ap,sp){Ih(np,"pool");for(var lp=ap.strideHeight,up=ap.strideWidth,cp=ap.dilationHeight,dp=ap.dilationWidth,hp=ap.effectiveFilterHeight,fp=ap.effectiveFilterWidth,pp=ap.padInfo.top,mp=ap.padInfo.left,gp=sp==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,yp=this.readSync(np.dataId),xp=ur(ap.outShape,np.dtype),_p=xp.values,vp=ap.outShape[1]*ap.outShape[2]*ap.outShape[3],bp=ap.outShape[2]*ap.outShape[3],Ep=ap.outShape[3],Sp=0;Sp<ap.batchSize;++Sp)for(var Ap=Sp*vp,Rp=Sp*np.strides[0],Tp=0;Tp<ap.inChannels;++Tp)for(var Mp=0;Mp<ap.outHeight;++Mp)for(var Op=Mp*lp-pp,Pp=Math.max(0,Op),$p=Math.min(ap.inHeight,hp+Op),zp=Ap+Mp*bp,Dp=0;Dp<ap.outWidth;++Dp){for(var Fp=Dp*up-mp,jp=Math.max(0,Fp),Lp=Math.min(ap.inWidth,fp+Fp),Bp=gp,Ip=0,kp=0,Up=Pp;Up<$p;Up+=cp){for(var Gp=Rp+Up*np.strides[1],Wp=jp;Wp<Lp;Wp+=dp){var Qp=yp[Gp+Wp*np.strides[2]+Tp];sp==="max"&&Qp>Bp?Bp=Qp:sp==="avg"&&(Ip+=Qp,kp++)}if(isNaN(Bp))break}_p[zp+Dp*Ep+Tp]=sp==="avg"?Ip/kp:Bp}return xp.toTensor()},_d.prototype.maxPool=function(np,ap){return this.pool(np,ap,"max")},_d.prototype.maxPoolPositions=function(np,ap){for(var sp=ur(ap.outShape,"int32"),lp=ap.strideHeight,up=ap.strideWidth,cp=ap.dilationHeight,dp=ap.dilationWidth,hp=ap.effectiveFilterHeight,fp=ap.effectiveFilterWidth,pp=ap.padInfo.top,mp=ap.padInfo.left,gp=this.bufferSync(np),yp=0;yp<ap.batchSize;++yp)for(var xp=0;xp<ap.inChannels;++xp)for(var _p=0;_p<ap.outHeight;++_p){for(var vp=_p*lp-pp,bp=vp;bp<0;)bp+=cp;for(var Ep=Math.min(ap.inHeight,hp+vp),Sp=0;Sp<ap.outWidth;++Sp){for(var Ap=Sp*up-mp,Rp=Ap;Rp<0;)Rp+=dp;for(var Tp=Math.min(ap.inWidth,fp+Ap),Mp=Number.NEGATIVE_INFINITY,Op=-1,Pp=bp;Pp<Ep;Pp+=cp)for(var $p=Pp-vp,zp=Rp;zp<Tp;zp+=dp){var Dp=zp-Ap,Fp=gp.get(yp,Pp,zp,xp);Fp>Mp&&(Mp=Fp,Op=$p*fp+Dp)}sp.set(Op,yp,_p,Sp,xp)}}return sp.toTensor()},_d.prototype.maxPoolBackprop=function(np,ap,sp,lp){Ih([ap,sp],"maxPoolBackprop");for(var up=this.maxPoolPositions(ap,lp),cp=lp.strideHeight,dp=lp.strideWidth,hp=lp.dilationHeight,fp=lp.dilationWidth,pp=lp.effectiveFilterHeight,mp=lp.effectiveFilterWidth,gp=mp-1-lp.padInfo.left,yp=pp-1-lp.padInfo.top,xp=ur(ap.shape,"float32"),_p=this.bufferSync(up),vp=this.bufferSync(np),bp=0;bp<lp.batchSize;++bp)for(var Ep=0;Ep<lp.inChannels;++Ep)for(var Sp=0;Sp<lp.inHeight;++Sp)for(var Ap=0;Ap<lp.inWidth;++Ap){for(var Rp=Sp-yp,Tp=Ap-gp,Mp=0,Op=0;Op<pp;Op+=hp){var Pp=(Rp+Op)/cp;if(!(Pp<0||Pp>=lp.outHeight||Math.floor(Pp)!==Pp))for(var $p=0;$p<mp;$p+=fp){var zp=(Tp+$p)/dp;if(!(zp<0||zp>=lp.outWidth||Math.floor(zp)!==zp)){var Dp=pp*mp-1-_p.get(bp,Pp,zp,Ep)===Op*mp+$p?1:0;Dp!==0&&(Mp+=vp.get(bp,Pp,zp,Ep)*Dp)}}}xp.set(Mp,bp,Sp,Ap,Ep)}return xp.toTensor()},_d.prototype.avgPoolBackprop=function(np,ap,sp){Ih([np,ap],"avgPoolBackprop");for(var lp=sp.strideHeight,up=sp.strideWidth,cp=sp.filterHeight,dp=sp.filterWidth,hp=sp.dilationHeight,fp=sp.dilationWidth,pp=sp.effectiveFilterHeight,mp=sp.effectiveFilterWidth,gp=mp-1-sp.padInfo.left,yp=pp-1-sp.padInfo.top,xp=ur(ap.shape,"float32"),_p=1/(cp*dp),vp=this.bufferSync(np),bp=0;bp<sp.batchSize;++bp)for(var Ep=0;Ep<sp.inChannels;++Ep)for(var Sp=0;Sp<sp.inHeight;++Sp)for(var Ap=0;Ap<sp.inWidth;++Ap){for(var Rp=Sp-yp,Tp=Ap-gp,Mp=0,Op=0;Op<pp;Op+=hp){var Pp=(Rp+Op)/lp;if(!(Pp<0||Pp>=sp.outHeight||Math.floor(Pp)!==Pp))for(var $p=0;$p<mp;$p+=fp){var zp=(Tp+$p)/up;zp<0||zp>=sp.outWidth||Math.floor(zp)!==zp||(Mp+=vp.get(bp,Pp,zp,Ep))}}xp.set(Mp*_p,bp,Sp,Ap,Ep)}return xp.toTensor()},_d.prototype.pool3d=function(np,ap,sp){Ih(np,"pool3d");for(var lp=ap.strideDepth,up=ap.strideHeight,cp=ap.strideWidth,dp=ap.dilationDepth,hp=ap.dilationHeight,fp=ap.dilationWidth,pp=ap.effectiveFilterDepth,mp=ap.effectiveFilterHeight,gp=ap.effectiveFilterWidth,yp=ap.padInfo.front,xp=ap.padInfo.top,_p=ap.padInfo.left,vp=sp==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,bp=this.readSync(np.dataId),Ep=ur(ap.outShape,np.dtype),Sp=Ep.values,Ap=ap.outShape[1]*ap.outShape[2]*ap.outShape[3]*ap.outShape[4],Rp=ap.outShape[2]*ap.outShape[3]*ap.outShape[4],Tp=ap.outShape[3]*ap.outShape[4],Mp=ap.outShape[4],Op=0;Op<ap.batchSize;++Op)for(var Pp=Op*Ap,$p=Op*np.strides[0],zp=0;zp<ap.inChannels;++zp)for(var Dp=0;Dp<ap.outDepth;++Dp){for(var Fp=Dp*lp-yp,jp=Fp;jp<0;)jp+=dp;for(var Lp=Math.min(ap.inDepth,pp+Fp),Bp=Pp+Dp*Rp,Ip=0;Ip<ap.outHeight;++Ip){for(var kp=Ip*up-xp,Up=kp;Up<0;)Up+=hp;for(var Gp=Math.min(ap.inHeight,mp+kp),Wp=Bp+Ip*Tp,Qp=0;Qp<ap.outWidth;++Qp){for(var Xp=Qp*cp-_p,rm=Xp;rm<0;)rm+=fp;for(var Kp=Math.min(ap.inWidth,gp+Xp),lm=Wp+Qp*Mp,cm=vp,gm=0,Mm=0,dm=jp;dm<Lp;dm+=dp){for(var em=$p+dm*np.strides[1],sm=Up;sm<Gp;sm+=hp){for(var Zp=em+sm*np.strides[2],mm=rm;mm<Kp;mm+=fp){var fm=bp[Zp+mm*np.strides[3]+zp];if(sp==="max"&&fm>cm?cm=fm:sp==="avg"&&(gm+=fm,Mm++),isNaN(cm))break}if(isNaN(cm))break}if(isNaN(cm))break}Sp[lm+zp]=sp==="avg"?gm/Mm:cm}}}return Ep.toTensor()},_d.prototype.avgPool3d=function(np,ap){return Ih(np,"avgPool3d"),this.pool3d(np,ap,"avg").toFloat()},_d.prototype.avgPool3dBackprop=function(np,ap,sp){Ih([np,ap],"avgPool3dBackprop");for(var lp=sp.strideDepth,up=sp.strideHeight,cp=sp.strideWidth,dp=sp.filterDepth,hp=sp.filterHeight,fp=sp.filterWidth,pp=sp.dilationDepth,mp=sp.dilationHeight,gp=sp.dilationWidth,yp=sp.effectiveFilterDepth,xp=sp.effectiveFilterHeight,_p=sp.effectiveFilterWidth,vp=yp-1-sp.padInfo.front,bp=_p-1-sp.padInfo.left,Ep=xp-1-sp.padInfo.top,Sp=ur(ap.shape,"float32"),Ap=1/(dp*hp*fp),Rp=this.bufferSync(np),Tp=0;Tp<sp.batchSize;++Tp)for(var Mp=0;Mp<sp.inChannels;++Mp)for(var Op=0;Op<sp.inDepth;++Op)for(var Pp=0;Pp<sp.inHeight;++Pp)for(var $p=0;$p<sp.inWidth;++$p){for(var zp=Op-vp,Dp=Pp-Ep,Fp=$p-bp,jp=0,Lp=0;Lp<yp;Lp+=pp){var Bp=(zp+Lp)/lp;if(!(Bp<0||Bp>=sp.outDepth||Math.floor(Bp)!==Bp))for(var Ip=0;Ip<xp;Ip+=mp){var kp=(Dp+Ip)/up;if(!(kp<0||kp>=sp.outHeight||Math.floor(kp)!==kp))for(var Up=0;Up<_p;Up+=gp){var Gp=(Fp+Up)/cp;Gp<0||Gp>=sp.outWidth||Math.floor(Gp)!==Gp||(jp+=Rp.get(Tp,Bp,kp,Gp,Mp))}}}Sp.set(jp*Ap,Tp,Op,Pp,$p,Mp)}return Sp.toTensor()},_d.prototype.maxPool3d=function(np,ap){return Ih(np,"maxPool3d"),this.pool3d(np,ap,"max").toFloat()},_d.prototype.maxPool3dPositions=function(np,ap){for(var sp=ur(ap.outShape,"int32"),lp=ap.strideDepth,up=ap.strideHeight,cp=ap.strideWidth,dp=ap.dilationDepth,hp=ap.dilationHeight,fp=ap.dilationWidth,pp=ap.effectiveFilterDepth,mp=ap.effectiveFilterHeight,gp=ap.effectiveFilterWidth,yp=ap.padInfo.front,xp=ap.padInfo.top,_p=ap.padInfo.left,vp=this.bufferSync(np),bp=0;bp<ap.batchSize;++bp)for(var Ep=0;Ep<ap.inChannels;++Ep)for(var Sp=0;Sp<ap.outDepth;++Sp){for(var Ap=Sp*lp-yp,Rp=Ap;Rp<0;)Rp+=dp;for(var Tp=Math.min(ap.inDepth,pp+Ap),Mp=0;Mp<ap.outHeight;++Mp){for(var Op=Mp*up-xp,Pp=Op;Pp<0;)Pp+=hp;for(var $p=Math.min(ap.inHeight,mp+Op),zp=0;zp<ap.outWidth;++zp){for(var Dp=zp*cp-_p,Fp=Dp;Fp<0;)Fp+=fp;for(var jp=Math.min(ap.inWidth,gp+Dp),Lp=Number.NEGATIVE_INFINITY,Bp=-1,Ip=Rp;Ip<Tp;Ip+=dp)for(var kp=Ip-Ap,Up=Pp;Up<$p;Up+=hp)for(var Gp=Up-Op,Wp=Fp;Wp<jp;Wp+=fp){var Qp=Wp-Dp,Xp=vp.get(bp,Ip,Up,Wp,Ep);Xp>=Lp&&(Lp=Xp,Bp=kp*mp*gp+Gp*mp+Qp)}sp.set(Bp,bp,Sp,Mp,zp,Ep)}}}return sp.toTensor()},_d.prototype.maxPool3dBackprop=function(np,ap,sp,lp){Ih([ap,sp],"maxPool3dBackprop");for(var up=this.maxPool3dPositions(ap,lp),cp=lp.strideDepth,dp=lp.strideHeight,hp=lp.strideWidth,fp=lp.dilationDepth,pp=lp.dilationHeight,mp=lp.dilationWidth,gp=lp.effectiveFilterDepth,yp=lp.effectiveFilterHeight,xp=lp.effectiveFilterWidth,_p=gp-1-lp.padInfo.front,vp=xp-1-lp.padInfo.left,bp=yp-1-lp.padInfo.top,Ep=ur(ap.shape,"float32"),Sp=this.bufferSync(up),Ap=this.bufferSync(np),Rp=0;Rp<lp.batchSize;++Rp)for(var Tp=0;Tp<lp.inChannels;++Tp)for(var Mp=0;Mp<lp.inDepth;++Mp)for(var Op=0;Op<lp.inHeight;++Op)for(var Pp=0;Pp<lp.inWidth;++Pp){for(var $p=Mp-_p,zp=Op-bp,Dp=Pp-vp,Fp=0,jp=0;jp<gp;jp+=fp){var Lp=($p+jp)/cp;if(!(Lp<0||Lp>=lp.outDepth||Math.floor(Lp)!==Lp))for(var Bp=0;Bp<yp;Bp+=pp){var Ip=(zp+Bp)/dp;if(!(Ip<0||Ip>=lp.outHeight||Math.floor(Ip)!==Ip))for(var kp=0;kp<xp;kp+=mp){var Up=(Dp+kp)/hp;if(!(Up<0||Up>=lp.outWidth||Math.floor(Up)!==Up)){var Gp=gp*yp*xp-1-Sp.get(Rp,Lp,Ip,Up,Tp)===jp*yp*xp+Bp*xp+kp?1:0;Gp!==0&&(Fp+=Ap.get(Rp,Lp,Ip,Up,Tp)*Gp)}}}}Ep.set(Fp,Rp,Mp,Op,Pp,Tp)}return Ep.toTensor()},_d.prototype.cast=function(np,ap){return So(np,ap,this)},_d.prototype.reshape=function(np,ap){return Ao(np,ap)},_d.prototype.avgPool=function(np,ap){return Ih(np,"avgPool"),this.pool(np,ap,"avg").toFloat()},_d.prototype.resizeBilinear=function(np,ap,sp,lp){Ih(np,"resizeBilinear");for(var up=np.shape,cp=up[0],dp=up[1],hp=up[2],fp=up[3],pp=this.readSync(np.dataId),mp=new Float32Array(w$1([cp,ap,sp,fp])),gp=[lp&&ap>1?dp-1:dp,lp&&sp>1?hp-1:hp],yp=[lp&&ap>1?ap-1:ap,lp&&sp>1?sp-1:sp],xp=0,_p=gp[0]/yp[0],vp=gp[1]/yp[1],bp=0;bp<cp;bp++)for(var Ep=0;Ep<ap;Ep++)for(var Sp=_p*Ep,Ap=Math.floor(Sp),Rp=Sp-Ap,Tp=Math.min(dp-1,Math.ceil(Sp)),Mp=bp*np.strides[0]+Ap*np.strides[1],Op=bp*np.strides[0]+Tp*np.strides[1],Pp=0;Pp<sp;Pp++)for(var $p=vp*Pp,zp=Math.floor($p),Dp=$p-zp,Fp=Math.min(hp-1,Math.ceil($p)),jp=Mp+zp*np.strides[2],Lp=Op+zp*np.strides[2],Bp=Mp+ +Fp*np.strides[2],Ip=Op+Fp*np.strides[2],kp=0;kp<fp;kp++){var Up=pp[jp+kp],Gp=pp[Lp+kp],Wp=Up+(pp[Bp+kp]-Up)*Dp,Qp=Wp+(Gp+(pp[Ip+kp]-Gp)*Dp-Wp)*Rp;mp[xp++]=Qp}return kn(mp,[cp,ap,sp,fp])},_d.prototype.resizeBilinearBackprop=function(np,ap,sp){Ih([np,ap],"resizeBilinearBackprop");for(var lp=ap.shape,up=lp[0],cp=lp[1],dp=lp[2],hp=lp[3],fp=np.shape,pp=fp[1],mp=fp[2],gp=new Float32Array(up*cp*dp*hp),yp=[sp&&pp>1?cp-1:cp,sp&&mp>1?dp-1:dp],xp=[sp&&pp>1?pp-1:pp,sp&&mp>1?mp-1:mp],_p=yp[0]/xp[0],vp=yp[1]/xp[1],bp=this.readSync(np.dataId),Ep=0,Sp=0;Sp<up;Sp++)for(var Ap=Sp*ap.strides[0],Rp=0;Rp<pp;Rp++)for(var Tp=Rp*_p,Mp=Math.floor(Tp),Op=Math.min(Math.ceil(Tp),cp-1),Pp=Ap+Mp*ap.strides[1],$p=Ap+Op*ap.strides[1],zp=Tp-Mp,Dp=1-zp,Fp=0;Fp<mp;Fp++)for(var jp=Fp*vp,Lp=Math.floor(jp),Bp=Math.min(Math.ceil(jp),dp-1),Ip=jp-Lp,kp=1-Ip,Up=Pp+Lp*ap.strides[2],Gp=Pp+Bp*ap.strides[2],Wp=$p+Lp*ap.strides[2],Qp=$p+Bp*ap.strides[2],Xp=Dp*kp,rm=Dp*Ip,Kp=zp*kp,lm=zp*Ip,cm=0;cm<hp;cm++){var gm=bp[Ep++];gp[Up+cm]+=gm*Xp,gp[Gp+cm]+=gm*rm,gp[Wp+cm]+=gm*Kp,gp[Qp+cm]+=gm*lm}return Fn(gp,[up,dp,cp,hp],ap.dtype)},_d.prototype.resizeNearestNeighbor=function(np,ap,sp,lp){Ih(np,"resizeNearestNeighbor");for(var up=np.shape,cp=up[0],dp=up[1],hp=up[2],fp=up[3],pp=this.readSync(np.dataId),mp=new Float32Array(cp*ap*sp*fp),gp=[lp&&ap>1?dp-1:dp,lp&&sp>1?hp-1:hp],yp=[lp&&ap>1?ap-1:ap,lp&&sp>1?sp-1:sp],xp=gp[0]/yp[0],_p=gp[1]/yp[1],vp=0,bp=0;bp<cp;bp++)for(var Ep=bp*np.strides[0],Sp=0;Sp<ap;Sp++)for(var Ap=xp*Sp,Rp=Ep+Math.min(dp-1,lp?Math.round(Ap):Math.floor(Ap))*np.strides[1],Tp=0;Tp<sp;Tp++)for(var Mp=_p*Tp,Op=Rp+Math.min(hp-1,lp?Math.round(Mp):Math.floor(Mp))*np.strides[2],Pp=0;Pp<fp;Pp++){var $p=pp[Op+Pp];mp[vp++]=$p}return kn(mp,[cp,ap,sp,fp],np.dtype)},_d.prototype.resizeNearestNeighborBackprop=function(np,ap,sp){Ih([np,ap],"resizeNearestNeighborBackprop");for(var lp=ap.shape,up=lp[0],cp=lp[1],dp=lp[2],hp=lp[3],fp=np.shape,pp=fp[1],mp=fp[2],gp=new Float32Array(up*cp*dp*hp),yp=this.readSync(np.dataId),xp=[sp&&pp>1?cp-1:cp,sp&&mp>1?dp-1:dp],_p=[sp&&pp>1?pp-1:pp,sp&&mp>1?mp-1:mp],vp=xp[0]/_p[0],bp=xp[1]/_p[1],Ep=1/vp,Sp=1/bp,Ap=2*Math.ceil(Ep)+2,Rp=2*Math.ceil(Sp)+2,Tp=0;Tp<up;Tp++)for(var Mp=Tp*ap.strides[0],Op=0;Op<cp;Op++)for(var Pp=Mp+Op*ap.strides[1],$p=Math.floor(Op*Ep),zp=Math.floor($p-Ap/2),Dp=0;Dp<dp;Dp++)for(var Fp=Pp+Dp*ap.strides[2],jp=Math.floor(Dp*Sp),Lp=Math.floor(jp-Rp/2),Bp=0;Bp<hp;Bp++){for(var Ip=0,kp=0;kp<Ap;kp++){var Up=kp+zp;if(!(Up<0||Up>=pp)){var Gp=Mp+Up*np.strides[1],Wp=Up*vp;if(Op===Math.min(cp-1,sp?Math.round(Wp):Math.floor(Wp)))for(var Qp=0;Qp<Rp;Qp++){var Xp=Qp+Lp;if(!(Xp<0||Xp>=mp)){var rm=Gp+Xp*np.strides[2],Kp=Xp*bp;Dp===Math.min(dp-1,sp?Math.round(Kp):Math.floor(Kp))&&(Ip+=yp[rm+Bp])}}}}gp[Fp+Bp]=Ip}return Fn(gp,ap.shape,ap.dtype)},_d.prototype.batchNormalization=function(np,ap,sp,lp,up,cp){Ih([np,ap,sp,up,cp],"batchNorm");for(var dp=this.readSync(np.dataId),hp=this.readSync(ap.dataId),fp=this.readSync(sp.dataId),pp=up?this.readSync(up.dataId):new Float32Array([1]),mp=cp?this.readSync(cp.dataId):new Float32Array([0]),gp=new Float32Array(dp.length),yp=mp.length,xp=pp.length,_p=fp.length,vp=hp.length,bp=0,Ep=0,Sp=0,Ap=0,Rp=0;Rp<dp.length;++Rp)gp[Rp]=mp[bp++]+(dp[Rp]-hp[Ep++])*pp[Sp++]/Math.sqrt(fp[Ap++]+lp),bp>=yp&&(bp=0),Ep>=vp&&(Ep=0),Sp>=xp&&(Sp=0),Ap>=_p&&(Ap=0);return Fn(gp,np.shape)},_d.prototype.localResponseNormalization4D=function(np,ap,sp,lp,up){Ih(np,"localResponseNormalization4D");var cp=np.shape[3],dp=cp-1,hp=this.readSync(np.dataId),fp=np.size,pp=new Float32Array(fp);function mp(_p){for(var vp=_p%cp,bp=_p-vp+Math.max(0,vp-ap),Ep=_p-vp+Math.min(vp+ap,dp),Sp=0;bp<=Ep;bp++){var Ap=hp[bp];Sp+=Ap*Ap}return Sp}for(var gp=0;gp<fp;gp++){var yp=mp(gp),xp=hp[gp]*Math.pow(sp+lp*yp,-up);pp[gp]=xp}return Fn(pp,np.shape)},_d.prototype.LRNGrad=function(np,ap,sp,lp,up,cp,dp){Ih(np,"LRNGrad");for(var hp=np.shape[3],fp=this.readSync(np.dataId),pp=this.readSync(ap.dataId),mp=this.readSync(sp.dataId),gp=new Float32Array(np.size),yp=np.size,xp=0;xp<yp;xp++){for(var _p=xp%hp,vp=xp-_p+Math.max(0,_p-lp),bp=xp-_p+Math.min(hp,_p+lp+1),Ep=0,Sp=vp;Sp<bp;Sp++)Ep+=Math.pow(pp[Sp],2);for(Ep=cp*Ep+up,Sp=vp;Sp<bp;Sp++){var Ap=-2*cp*dp*pp[Sp]*mp[xp]/Ep;xp===Sp&&(Ap+=Math.pow(Ep,-dp)),Ap*=fp[xp],gp[Sp]+=Ap}}return Fn(gp,np.shape)},_d.prototype.multinomial=function(np,ap,sp,lp){Ih(np,"multinomial");for(var up=ap?np:io(np),cp=up.shape[0],dp=up.shape[1],hp=Pn([cp,sp],"int32"),fp=this.readSync(hp.dataId),pp=this.readSync(up.dataId),mp=0;mp<cp;++mp){var gp=mp*dp,yp=new Float32Array(dp-1);yp[0]=pp[gp];for(var xp=1;xp<yp.length;++xp)yp[xp]=yp[xp-1]+pp[gp+xp];for(var _p=rr(lp.toString()),vp=mp*sp,bp=0;bp<sp;++bp){var Ep=_p();fp[vp+bp]=yp.length;for(var Sp=0;Sp<yp.length;Sp++)if(Ep<yp[Sp]){fp[vp+bp]=Sp;break}}}return hp},_d.prototype.oneHot=function(np,ap,sp,lp){Ih(np,"oneHot");var up=new Float32Array(np.size*ap);up.fill(lp);for(var cp=this.readSync(np.dataId),dp=0;dp<np.size;++dp)cp[dp]>=0&&cp[dp]<ap&&(up[dp*ap+cp[dp]]=sp);return Tn(up,[np.size,ap],"int32")},_d.prototype.nonMaxSuppression=function(np,ap,sp,lp,up){return Ih(np,"nonMaxSuppression"),Mo(this.readSync(np.dataId),this.readSync(ap.dataId),sp,lp,up)},_d.prototype.fft=function(np){return this.fftBatch(np,!1)},_d.prototype.ifft=function(np){return this.fftBatch(np,!0)},_d.prototype.fftBatch=function(np,ap){for(var sp=np.shape[0],lp=np.shape[1],up=ur(np.shape,"float32"),cp=ur(np.shape,"float32"),dp=Rn(np).as2D(sp,lp),hp=In(np).as2D(sp,lp),fp=0;fp<sp;fp++)for(var pp=dp.slice([fp,0],[1,lp]),mp=hp.slice([fp,0],[1,lp]),gp=En(pp,mp),yp=this.readSync(this.fftImpl(gp,ap).dataId),xp=0;xp<lp;xp++){var _p=Fo(yp,xp);up.values[fp*lp+xp]=_p.real,cp.values[fp*lp+xp]=_p.imag}return En(up.toTensor(),cp.toTensor()).as2D(sp,lp)},_d.prototype.fftImpl=function(np,ap){var sp=np.as1D(),lp=sp.size;if(this.isExponentOf2(lp)){var up=this.fftRadix2(sp,lp,ap).as2D(np.shape[0],np.shape[1]);return ap&&(up=En(Rn(up).div(An(lp)),In(up).div(An(lp)))),up}var cp=this.readSync(np.dataId),dp=function(hp){for(var fp=new Float32Array(hp.length/2),pp=new Float32Array(hp.length/2),mp=0;mp<hp.length;mp+=2)fp[mp/2]=hp[mp],pp[mp/2]=hp[mp+1];return{real:fp,imag:pp}}(this.fourierTransformByMatmul(cp,lp,ap));return En(dp.real,dp.imag).as2D(np.shape[0],np.shape[1])},_d.prototype.isExponentOf2=function(np){return(np&np-1)==0},_d.prototype.fftRadix2=function(np,ap,sp){if(ap===1)return np;var lp=this.readSync(np.dataId),up=ap/2,cp=function(vp){for(var bp=Math.ceil(vp.length/4),Ep=new Float32Array(bp),Sp=new Float32Array(bp),Ap=0;Ap<vp.length;Ap+=4)Ep[Math.floor(Ap/4)]=vp[Ap],Sp[Math.floor(Ap/4)]=vp[Ap+1];return{real:Ep,imag:Sp}}(lp),dp=En(cp.real,cp.imag).as1D(),hp=function(vp){for(var bp=Math.floor(vp.length/4),Ep=new Float32Array(bp),Sp=new Float32Array(bp),Ap=2;Ap<vp.length;Ap+=4)Ep[Math.floor(Ap/4)]=vp[Ap],Sp[Math.floor(Ap/4)]=vp[Ap+1];return{real:Ep,imag:Sp}}(lp),fp=En(hp.real,hp.imag).as1D();dp=this.fftRadix2(dp,up,sp),fp=this.fftRadix2(fp,up,sp);var pp=function(vp,bp){for(var Ep=new Float32Array(vp/2),Sp=new Float32Array(vp/2),Ap=0;Ap<Math.ceil(vp/2);Ap++){var Rp=(bp?2:-2)*Math.PI*(Ap/vp);Ep[Ap]=Math.cos(Rp),Sp[Ap]=Math.sin(Rp)}return{real:Ep,imag:Sp}}(ap,sp),mp=En(pp.real,pp.imag).mul(fp),gp=dp.add(mp),yp=dp.sub(mp),xp=Rn(gp).concat(Rn(yp)),_p=In(gp).concat(In(yp));return En(xp,_p).as1D()},_d.prototype.fourierTransformByMatmul=function(np,ap,sp){for(var lp=new Float32Array(2*ap),up=0;up<ap;up++){for(var cp=0,dp=0,hp=0;hp<ap;hp++){var fp=_o(up*hp,ap,sp),pp=Fo(np,hp);cp+=pp.real*fp.real-pp.imag*fp.imag,dp+=pp.real*fp.imag+pp.imag*fp.real}sp&&(cp/=ap,dp/=ap),Oo(lp,cp,dp,up)}return lp},_d.prototype.depthToSpace=function(np,ap,sp){g(sp==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+sp}),g(ap>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+ap});for(var lp=np.shape[0],up=np.shape[1],cp=np.shape[2],dp=np.shape[3],hp=up*ap,fp=cp*ap,pp=dp/(ap*ap),mp=this.readSync(np.dataId),gp=new Float32Array(lp*hp*fp*pp),yp=0,xp=0;xp<lp;++xp)for(var _p=0;_p<hp;++_p)for(var vp=Math.floor(_p/ap),bp=_p%ap,Ep=0;Ep<fp;++Ep)for(var Sp=Math.floor(Ep/ap),Ap=(bp*ap+Ep%ap)*pp,Rp=0;Rp<pp;++Rp){var Tp=Rp+Ap+dp*(Sp+cp*(vp+up*xp));gp[yp++]=mp[Tp]}return Fn(gp,[lp,hp,fp,pp])},_d.prototype.broadcastedBinaryOp=function(np,ap,sp,lp){var up=po(np.shape,ap.shape),cp=ur(up,sp),dp=this.readSync(np.dataId),hp=this.readSync(ap.dataId),fp=ho(np.shape,up),pp=ho(ap.shape,up),mp=cp.values;if(fp.length+pp.length===0)for(var gp=0;gp<mp.length;++gp)mp[gp]=lp(dp[gp%dp.length],hp[gp%hp.length]);else{var yp=this.bufferSync(np),xp=this.bufferSync(ap),_p=function(vp){var bp=cp.indexToLoc(vp),Ep=bp.slice(-np.rank);fp.forEach(function(Tp){return Ep[Tp]=0});var Sp=yp.locToIndex(Ep),Ap=bp.slice(-ap.rank);pp.forEach(function(Tp){return Ap[Tp]=0});var Rp=xp.locToIndex(Ap);mp[vp]=lp(dp[Sp],hp[Rp])};for(gp=0;gp<mp.length;++gp)_p(gp)}return cp.toTensor()},_d.prototype.broadcastedBinaryComplexOp=function(np,ap,sp){var lp=po(np.shape,ap.shape),up=ur(lp,"float32"),cp=ur(lp,"float32"),dp=this.readSync(np.dataId),hp=this.readSync(ap.dataId),fp=ho(np.shape,lp),pp=ho(ap.shape,lp),mp=up.values,gp=cp.values;if(fp.length+pp.length===0)for(var yp=0;yp<mp.length;yp++){var xp=yp%dp.length,_p=yp%hp.length,vp=sp(dp[2*xp],dp[2*xp+1],hp[2*_p],hp[2*_p+1]);mp[yp]=vp.real,gp[yp]=vp.imag}else{var bp=this.bufferSync(this.data.get(np.dataId).complexTensors.real),Ep=this.bufferSync(this.data.get(ap.dataId).complexTensors.real),Sp=function(Ap){var Rp=up.indexToLoc(Ap),Tp=Rp.slice(-np.rank);fp.forEach(function(zp){return Tp[zp]=0});var Mp=bp.locToIndex(Tp),Op=Rp.slice(-ap.rank);pp.forEach(function(zp){return Op[zp]=0});var Pp=Ep.locToIndex(Op),$p=sp(dp[2*Mp],dp[2*Mp+1],hp[2*Pp],hp[2*Pp+1]);mp[Ap]=$p.real,gp[Ap]=$p.imag};for(yp=0;yp<mp.length;yp++)Sp(yp)}return this.complex(up.toTensor(),cp.toTensor())},_d.prototype.split=function(np,ap,sp){return Po(np,ap,sp)},_d.prototype.dispose=function(){},_d.prototype.floatPrecision=function(){return 32},_d.prototype.epsilon=function(){return 1e-7},_d.prototype.cropAndResize=function(np,ap,sp,lp,up,cp){for(var dp=np.shape,hp=dp[0],fp=dp[1],pp=dp[2],mp=dp[3],gp=ap.shape[0],yp=lp[0],xp=lp[1],_p=ur([gp,yp,xp,mp],np.dtype),vp=this.readSync(ap.dataId),bp=this.readSync(sp.dataId),Ep=this.readSync(np.dataId),Sp=np.strides,Ap=_p.strides,Rp=0;Rp<gp;Rp++){var Tp=4*Rp,Mp=vp[Tp],Op=vp[Tp+1],Pp=vp[Tp+2],$p=vp[Tp+3],zp=bp[Rp];if(!(zp>=hp))for(var Dp=yp>1?(Pp-Mp)*(fp-1)/(yp-1):0,Fp=xp>1?($p-Op)*(pp-1)/(xp-1):0,jp=0;jp<yp;jp++){var Lp=yp>1?Mp*(fp-1)+jp*Dp:.5*(Mp+Pp)*(fp-1);if(Lp<0||Lp>fp-1)for(var Bp=0;Bp<xp;Bp++)for(var Ip=0;Ip<mp;Ip++){var kp=Ip+Bp*Ap[2]+jp*Ap[1]+Rp*Ap[0];_p.values[kp]=cp}else if(up==="bilinear"){var Up=Math.floor(Lp),Gp=Math.ceil(Lp),Wp=Lp-Up;for(Bp=0;Bp<xp;Bp++)if((dm=xp>1?Op*(pp-1)+Bp*Fp:.5*(Op+$p)*(pp-1))<0||dm>pp-1)for(Ip=0;Ip<mp;Ip++)kp=Ip+Bp*Ap[2]+jp*Ap[1]+Rp*Ap[0],_p.values[kp]=cp;else{var Qp=Math.floor(dm),Xp=Math.ceil(dm),rm=dm-Qp;for(Ip=0;Ip<mp;Ip++){var Kp=Ep[kp=Ip+Qp*Sp[2]+Up*Sp[1]+zp*Sp[0]],lm=Ep[kp=Ip+Xp*Sp[2]+Up*Sp[1]+zp*Sp[0]],cm=Ep[kp=Ip+Qp*Sp[2]+Gp*Sp[1]+zp*Sp[0]],gm=Kp+(lm-Kp)*rm,Mm=cm+(Ep[kp=Ip+Xp*Sp[2]+Gp*Sp[1]+zp*Sp[0]]-cm)*rm;kp=Ip+Bp*Ap[2]+jp*Ap[1]+Rp*Ap[0],_p.values[kp]=gm+(Mm-gm)*Wp}}}else for(Bp=0;Bp<xp;++Bp){var dm;if((dm=xp>1?Op*(pp-1)+Bp*Fp:.5*(Op+$p)*(pp-1))<0||dm>pp-1)for(Ip=0;Ip<mp;Ip++)kp=Ip+Bp*Ap[2]+jp*Ap[1]+Rp*Ap[0],_p.values[kp]=cp;else{var em=Math.round(dm),sm=Math.round(Lp);for(Ip=0;Ip<mp;Ip++){var Zp=Ip+em*Sp[2]+sm*Sp[1]+zp*Sp[0],mm=Ip+Bp*Ap[2]+jp*Ap[1]+Rp*Ap[0];_p.values[mm]=Ep[Zp]}}}}}return _p.toTensor()},_d.prototype.sparseToDense=function(np,ap,sp,lp){var up=Hr(0,np,sp),cp=up.sliceRank,dp=up.numUpdates,hp=up.sliceSize,fp=up.strides,pp=up.outputSize;return this.scatter(np,ap,sp,pp,hp,dp,cp,fp,lp,!1)},_d.prototype.gatherND=function(np,ap){var sp=ap.shape,lp=sp[sp.length-1],up=Ur(np,ap),cp=up[0],dp=up[1],hp=up[2],fp=up[3];if(dp===0)return kn([],cp,np.dtype);for(var pp=new lt([dp,hp],np.dtype),mp=this.readSync(ap.dataId),gp=this.readSync(np.dataId),yp=0;yp<dp;yp++){for(var xp=[],_p=0,vp=0;vp<lp;vp++){var bp=mp[yp*lp+vp];_p+=bp*fp[vp],xp.push(bp)}if(_p<0||_p>=np.size/hp)throw new Error("Invalid indices: "+xp+" does not index into "+np.shape);for(var Ep=0;Ep<hp;Ep++)pp.values[yp*hp+Ep]=gp[_p*hp+Ep]}return pp.toTensor().reshape(cp)},_d.prototype.scatterND=function(np,ap,sp){var lp=Hr(0,np,sp),up=lp.sliceRank,cp=lp.numUpdates,dp=lp.sliceSize,hp=lp.strides,fp=lp.outputSize,pp=An(0);return this.scatter(np,ap,sp,fp,dp,cp,up,hp,pp,!0)},_d.prototype.fill=function(np,ap,sp){var lp=F(sp=sp||z(ap),w$1(np));return lp.fill(ap),Nt.makeTensor(lp,np,sp,this)},_d.prototype.onesLike=function(np){if(np.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(np.shape,1,np.dtype)},_d.prototype.zerosLike=function(np){var ap=F(np.dtype,w$1(np.shape));return this.makeOutput(ap,np.shape,np.dtype)},_d.prototype.linspace=function(np,ap,sp){return Do(np,ap,sp)},_d.prototype.scatter=function(np,ap,sp,lp,up,cp,dp,hp,fp,pp){var mp=[lp/up,up],gp=this.readSync(np.dataId),yp=this.readSync(ap.dataId);if(lp===0)return kn([],sp,ap.dtype);var xp=new lt(mp,ap.dtype);xp.values.fill(this.readSync(fp.dataId)[0]);for(var _p=0;_p<cp;_p++){for(var vp=[],bp=0,Ep=0;Ep<dp;Ep++){var Sp=gp[_p*dp+Ep];vp.push(Sp),bp+=Sp*hp[Ep]}if(bp<0||bp>=lp/up)throw new Error("Invalid indices: "+vp+" does not index into "+sp);for(var Ap=0;Ap<up;Ap++)pp?xp.values[bp*up+Ap]+=yp[_p*up+Ap]:xp.values[bp*up+Ap]=ap.rank===0?yp[0]:yp[_p*up+Ap]}return xp.toTensor().reshape(sp)},_d}(co);Nt.registerBackend("cpu",function(){return new Sh},1),l$1({kernelName:"Square",backendName:"cpu",kernelFunc:function(rp){var _d=rp.inputs,np=rp.backend,ap=_d.x,sp=np;Ih(ap,"square");for(var lp=sp.data.get(ap.dataId).values,up=new Float32Array(lp.length),cp=0;cp<lp.length;++cp){var dp=lp[cp];up[cp]=dp*dp}return{dataId:sp.write(up,ap.shape,ap.dtype),shape:ap.shape,dtype:ap.dtype}}}),l$1({kernelName:"Square",backendName:"webgl",kernelFunc:function(rp){var _d=rp.inputs,np=rp.backend,ap=_d.x,sp=np,lp=new su(ap.shape,"return x * x;");return sp.runWebGLProgram(lp,[ap],ap.dtype)}});var Ah=function(){function rp(){}return rp.prototype.fetch=function(_d,np){return fetch(_d,np)},rp.prototype.now=function(){return performance.now()},rp.prototype.encode=function(_d,np){if(np!=="utf-8"&&np!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+np);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(_d)},rp.prototype.decode=function(_d,np){return new TextDecoder(np).decode(_d)},rp}();a$1().get("IS_BROWSER")&&a$1().setPlatform("browser",new Ah);var Dh,Th=function(){return require("node-fetch")},Nh=function(){function rp(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return rp.prototype.fetch=function(_d,np){return a$1().global.fetch!=null?a$1().global.fetch(_d,np):(Dh==null&&(Dh=Th()),Dh(_d,np))},rp.prototype.now=function(){var _d=process.hrtime();return 1e3*_d[0]+_d[1]/1e6},rp.prototype.encode=function(_d,np){if(np!=="utf-8"&&np!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+np);return this.textEncoder.encode(_d)},rp.prototype.decode=function(_d,np){return _d.length===0?"":new this.util.TextDecoder(np).decode(_d)},rp}();a$1().get("IS_NODE")&&a$1().setPlatform("node",new Nh);var Fh={float32:4,int32:4,uint16:2,uint8:1,bool:1},Oh=4;function _h(rp,_d){for(var np={},ap=0,sp=function(cp){var dp=cp.name,hp=cp.dtype,fp=cp.shape,pp=w$1(fp),mp=void 0;if("quantization"in cp){var gp=cp.quantization;if(gp.dtype!=="uint8"&&gp.dtype!=="uint16")throw new Error("Weight "+cp.name+" has unknown quantization dtype "+gp.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var yp=Fh[gp.dtype],xp=rp.slice(ap,ap+pp*yp),_p=gp.dtype==="uint8"?new Uint8Array(xp):new Uint16Array(xp);if(hp==="float32")mp=Float32Array.from(_p,function(Rp){return Rp*gp.scale+gp.min});else{if(hp!=="int32")throw new Error("Unsupported dtype in weight '"+dp+"': "+hp);mp=Int32Array.from(_p,function(Rp){return Math.round(Rp*gp.scale+gp.min)})}ap+=pp*yp}else if(hp==="string"){var vp=w$1(cp.shape);mp=[];for(var bp=0;bp<vp;bp++){var Ep=new Uint32Array(rp.slice(ap,ap+Oh))[0];ap+=Oh;var Sp=new Uint8Array(rp.slice(ap,ap+Ep));mp.push(Sp),ap+=Ep}}else{var Ap=Fh[hp];if(xp=rp.slice(ap,ap+pp*Ap),hp==="float32")mp=new Float32Array(xp);else if(hp==="int32")mp=new Int32Array(xp);else{if(hp!=="bool")throw new Error("Unsupported dtype in weight '"+dp+"': "+hp);mp=new Uint8Array(xp)}ap+=pp*Ap}np[dp]=kn(mp,fp,hp)},lp=0,up=_d;lp<up.length;lp++)sp(up[lp]);return np}function Mh(rp){if(rp===null)throw new Error("Invalid input value: "+JSON.stringify(rp));var _d=0,np=[];rp.forEach(function(lp){if(_d+=lp.byteLength,np.push(lp.byteLength===lp.buffer.byteLength?lp:new lp.constructor(lp)),!(lp instanceof Float32Array||lp instanceof Int32Array||lp instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+lp.constructor.name)});var ap=new Uint8Array(_d),sp=0;return np.forEach(function(lp){ap.set(new Uint8Array(lp.buffer),sp),sp+=lp.byteLength}),ap.buffer}var Bh=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Ph(rp){return Bh?Buffer.byteLength(rp):new Blob([rp]).size}function Lh(rp){var _d=0;rp.forEach(function(sp){_d+=sp.byteLength});var np=new Uint8Array(_d),ap=0;return rp.forEach(function(sp){np.set(new Uint8Array(sp),ap),ap+=sp.byteLength}),np.buffer}function Wh(rp){for(rp=rp.trim();rp.endsWith("/");)rp=rp.slice(0,rp.length-1);var _d=rp.split("/");return _d[_d.length-1]}function Uh(rp){if(rp.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:rp.modelTopology==null?0:Ph(JSON.stringify(rp.modelTopology)),weightSpecsBytes:rp.weightSpecs==null?0:Ph(JSON.stringify(rp.weightSpecs)),weightDataBytes:rp.weightData==null?0:rp.weightData.byteLength}}var Vh=function(){function rp(){this.saveRouters=[],this.loadRouters=[]}return rp.getInstance=function(){return rp.instance==null&&(rp.instance=new rp),rp.instance},rp.registerSaveRouter=function(_d){rp.getInstance().saveRouters.push(_d)},rp.registerLoadRouter=function(_d){rp.getInstance().loadRouters.push(_d)},rp.getSaveHandlers=function(_d){return rp.getHandlers(_d,"save")},rp.getLoadHandlers=function(_d,np){return rp.getHandlers(_d,"load",np)},rp.getHandlers=function(_d,np,ap){var sp=[];return(np==="load"?rp.getInstance().loadRouters:rp.getInstance().saveRouters).forEach(function(lp){var up=lp(_d,ap);up!==null&&sp.push(up)}),sp},rp}(),zh="://",Gh=function(){function rp(){this.managers={}}return rp.getInstance=function(){return rp.instance==null&&(rp.instance=new rp),rp.instance},rp.registerManager=function(_d,np){g(_d!=null,function(){return"scheme must not be undefined or null."}),_d.endsWith(zh)&&(_d=_d.slice(0,_d.indexOf(zh))),g(_d.length>0,function(){return"scheme must not be an empty string."});var ap=rp.getInstance();g(ap.managers[_d]==null,function(){return"A model store manager is already registered for scheme '"+_d+"'."}),ap.managers[_d]=np},rp.getManager=function(_d){var np=this.getInstance().managers[_d];if(np==null)throw new Error("Cannot find model manager for scheme '"+_d+"'");return np},rp.getSchemes=function(){return Object.keys(this.getInstance().managers)},rp}();function Hh(rp){if(rp.indexOf(zh)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Gh.getSchemes().join(","));return{scheme:rp.split(zh)[0],path:rp.split(zh)[1]}}function qh(rp,_d,np){return np===void 0&&(np=!1),n$1(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp,fp,pp;return r(this,function(mp){switch(mp.label){case 0:return g(rp!==_d,function(){return"Old path and new path are the same: '"+rp+"'"}),g((ap=Vh.getLoadHandlers(rp)).length>0,function(){return"Copying failed because no load handler is found for source URL "+rp+"."}),g(ap.length<2,function(){return"Copying failed because more than one ("+ap.length+") load handlers for source URL "+rp+"."}),sp=ap[0],g((lp=Vh.getSaveHandlers(_d)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+_d+"."}),g(lp.length<2,function(){return"Copying failed because more than one ("+ap.length+") save handlers for destination URL "+_d+"."}),up=lp[0],cp=Hh(rp).scheme,dp=Hh(rp).path,hp=cp===Hh(rp).scheme,[4,sp.load()];case 1:return fp=mp.sent(),np&&hp?[4,Gh.getManager(cp).removeModel(dp)]:[3,3];case 2:mp.sent(),mp.label=3;case 3:return[4,up.save(fp)];case 4:return pp=mp.sent(),!np||hp?[3,6]:[4,Gh.getManager(cp).removeModel(dp)];case 5:mp.sent(),mp.label=6;case 6:return[2,pp.modelArtifactsInfo]}})})}var Kh="models_store",jh="model_info_store";function Xh(){if(!a$1().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var rp=window,_d=rp.indexedDB||rp.mozIndexedDB||rp.webkitIndexedDB||rp.msIndexedDB||rp.shimIndexedDB;if(_d==null)throw new Error("The current browser does not appear to support IndexedDB.");return _d}function $h(rp){var _d=rp.result;_d.createObjectStore(Kh,{keyPath:"modelPath"}),_d.createObjectStore(jh,{keyPath:"modelPath"})}var Yh=function(){function rp(_d){if(this.indexedDB=Xh(),_d==null||!_d)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=_d}return rp.prototype.save=function(_d){return n$1(this,void 0,void 0,function(){return r(this,function(np){if(_d.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,_d)]})})},rp.prototype.load=function(){return n$1(this,void 0,void 0,function(){return r(this,function(_d){return[2,this.databaseAction(this.modelPath)]})})},rp.prototype.databaseAction=function(_d,np){var ap=this;return new Promise(function(sp,lp){var up=ap.indexedDB.open("tensorflowjs",1);up.onupgradeneeded=function(){return $h(up)},up.onsuccess=function(){var cp=up.result;if(np==null){var dp=cp.transaction(Kh,"readonly"),hp=dp.objectStore(Kh).get(ap.modelPath);hp.onsuccess=function(){if(hp.result==null)return cp.close(),lp(new Error("Cannot find model with path '"+ap.modelPath+"' in IndexedDB."));sp(hp.result.modelArtifacts)},hp.onerror=function(xp){return cp.close(),lp(hp.error)},dp.oncomplete=function(){return cp.close()}}else{var fp,pp=Uh(np),mp=cp.transaction(jh,"readwrite"),gp=mp.objectStore(jh),yp=gp.put({modelPath:ap.modelPath,modelArtifactsInfo:pp});yp.onsuccess=function(){var xp=(fp=cp.transaction(Kh,"readwrite")).objectStore(Kh).put({modelPath:ap.modelPath,modelArtifacts:np,modelArtifactsInfo:pp});xp.onsuccess=function(){return sp({modelArtifactsInfo:pp})},xp.onerror=function(_p){var vp=(gp=mp.objectStore(jh)).delete(ap.modelPath);vp.onsuccess=function(){return cp.close(),lp(xp.error)},vp.onerror=function(bp){return cp.close(),lp(xp.error)}}},yp.onerror=function(xp){return cp.close(),lp(yp.error)},mp.oncomplete=function(){fp==null?cp.close():fp.oncomplete=function(){return cp.close()}}}},up.onerror=function(cp){return lp(up.error)}})},rp.URL_SCHEME="indexeddb://",rp}(),Qh=function(rp){return a$1().getBool("IS_BROWSER")&&!Array.isArray(rp)&&rp.startsWith(Yh.URL_SCHEME)?(_d=rp.slice(Yh.URL_SCHEME.length),new Yh(_d)):null;var _d};Vh.registerSaveRouter(Qh),Vh.registerLoadRouter(Qh);var Jh=function(){function rp(){this.indexedDB=Xh()}return rp.prototype.listModels=function(){return n$1(this,void 0,void 0,function(){var _d=this;return r(this,function(np){return[2,new Promise(function(ap,sp){var lp=_d.indexedDB.open("tensorflowjs",1);lp.onupgradeneeded=function(){return $h(lp)},lp.onsuccess=function(){var up=lp.result,cp=up.transaction(jh,"readonly"),dp=cp.objectStore(jh).getAll();dp.onsuccess=function(){for(var hp={},fp=0,pp=dp.result;fp<pp.length;fp++){var mp=pp[fp];hp[mp.modelPath]=mp.modelArtifactsInfo}ap(hp)},dp.onerror=function(hp){return up.close(),sp(dp.error)},cp.oncomplete=function(){return up.close()}},lp.onerror=function(up){return sp(lp.error)}})]})})},rp.prototype.removeModel=function(_d){return n$1(this,void 0,void 0,function(){var np=this;return r(this,function(ap){var sp;return _d=(sp=_d).startsWith(Yh.URL_SCHEME)?sp.slice(Yh.URL_SCHEME.length):sp,[2,new Promise(function(lp,up){var cp=np.indexedDB.open("tensorflowjs",1);cp.onupgradeneeded=function(){return $h(cp)},cp.onsuccess=function(){var dp,hp=cp.result,fp=hp.transaction(jh,"readwrite"),pp=fp.objectStore(jh),mp=pp.get(_d);mp.onsuccess=function(){if(mp.result==null)return hp.close(),up(new Error("Cannot find model with path '"+_d+"' in IndexedDB."));var gp=pp.delete(_d),yp=function(){var xp=(dp=hp.transaction(Kh,"readwrite")).objectStore(Kh).delete(_d);xp.onsuccess=function(){return lp(mp.result.modelArtifactsInfo)},xp.onerror=function(_p){return up(mp.error)}};gp.onsuccess=yp,gp.onerror=function(xp){return yp(),hp.close(),up(mp.error)}},mp.onerror=function(gp){return hp.close(),up(mp.error)},fp.oncomplete=function(){dp==null?hp.close():dp.oncomplete=function(){return hp.close()}}},cp.onerror=function(dp){return up(cp.error)}})]})})},rp}();if(a$1().getBool("IS_BROWSER"))try{Gh.registerManager(Yh.URL_SCHEME,new Jh)}catch{}var Zh="/",tf$3="tensorflowjs_models",ef="info",nf="model_topology",rf="weight_specs",of="weight_data",af="model_metadata";function uf(rp){return{info:[tf$3,rp,ef].join(Zh),topology:[tf$3,rp,nf].join(Zh),weightSpecs:[tf$3,rp,rf].join(Zh),weightData:[tf$3,rp,of].join(Zh),modelMetadata:[tf$3,rp,af].join(Zh)}}function sf(rp){var _d=rp.split(Zh);if(_d.length<3)throw new Error("Invalid key format: "+rp);return _d.slice(1,_d.length-1).join(Zh)}var cf=function(){function rp(_d){if(!a$1().getBool("IS_BROWSER")||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,_d==null||!_d)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=_d,this.keys=uf(this.modelPath)}return rp.prototype.save=function(_d){return n$1(this,void 0,void 0,function(){var np,ap,sp;return r(this,function(lp){if(_d.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");np=JSON.stringify(_d.modelTopology),ap=JSON.stringify(_d.weightSpecs),sp=Uh(_d);try{return this.LS.setItem(this.keys.info,JSON.stringify(sp)),this.LS.setItem(this.keys.topology,np),this.LS.setItem(this.keys.weightSpecs,ap),this.LS.setItem(this.keys.weightData,(up=_d.weightData,Bh?Buffer.from(up).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(up))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:_d.format,generatedBy:_d.generatedBy,convertedBy:_d.convertedBy})),[2,{modelArtifactsInfo:sp}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+sp.modelTopologyBytes+", weightSpecsBytes="+sp.weightSpecsBytes+", weightDataBytes="+sp.weightDataBytes+".")}var up;return[2]})})},rp.prototype.load=function(){return n$1(this,void 0,void 0,function(){var _d,np,ap,sp,lp,up,cp;return r(this,function(dp){if((_d=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(_d.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(np={},(ap=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(np.modelTopology=ap,(sp=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(np.weightSpecs=sp,(lp=this.LS.getItem(this.keys.modelMetadata))!=null&&(up=JSON.parse(lp),np.format=up.format,np.generatedBy=up.generatedBy,np.convertedBy=up.convertedBy),(cp=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return np.weightData=function(hp){if(Bh){var fp=Buffer.from(hp,"base64");return fp.buffer.slice(fp.byteOffset,fp.byteOffset+fp.byteLength)}for(var pp=atob(hp),mp=new Uint8Array(pp.length),gp=0;gp<pp.length;++gp)mp.set([pp.charCodeAt(gp)],gp);return mp.buffer}(cp),[2,np]})})},rp.URL_SCHEME="localstorage://",rp}(),lf=function(rp){return a$1().getBool("IS_BROWSER")&&!Array.isArray(rp)&&rp.startsWith(cf.URL_SCHEME)?(_d=rp.slice(cf.URL_SCHEME.length),new cf(_d)):null;var _d};Vh.registerSaveRouter(lf),Vh.registerLoadRouter(lf);var hf=function(){function rp(){g(a$1().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),g(window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return rp.prototype.listModels=function(){return n$1(this,void 0,void 0,function(){var _d,np,ap,sp,lp,up;return r(this,function(cp){for(_d={},np=tf$3+Zh,ap=Zh+ef,sp=0;sp<this.LS.length;++sp)(lp=this.LS.key(sp)).startsWith(np)&&lp.endsWith(ap)&&(up=sf(lp),_d[up]=JSON.parse(this.LS.getItem(lp)));return[2,_d]})})},rp.prototype.removeModel=function(_d){return n$1(this,void 0,void 0,function(){var np,ap;return r(this,function(sp){var lp;if(_d=(lp=_d).startsWith(cf.URL_SCHEME)?lp.slice(cf.URL_SCHEME.length):lp,np=uf(_d),this.LS.getItem(np.info)==null)throw new Error("Cannot find model at path '"+_d+"'");return ap=JSON.parse(this.LS.getItem(np.info)),this.LS.removeItem(np.info),this.LS.removeItem(np.topology),this.LS.removeItem(np.weightSpecs),this.LS.removeItem(np.weightData),[2,ap]})})},rp}();if(a$1().getBool("IS_BROWSER"))try{Gh.registerManager(cf.URL_SCHEME,new hf)}catch{}var ff="model",pf=".json",df=".weights.bin";function vf(rp){return new Promise(function(_d){return setTimeout(_d)}).then(rp)}var mf=function(){function rp(_d){if(!a$1().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");_d.startsWith(rp.URL_SCHEME)&&(_d=_d.slice(rp.URL_SCHEME.length)),_d!=null&&_d.length!==0||(_d=ff),this.modelTopologyFileName=_d+pf,this.weightDataFileName=_d+df}return rp.prototype.save=function(_d){return n$1(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp;return r(this,function(dp){switch(dp.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(np=window.URL.createObjectURL(new Blob([_d.weightData],{type:"application/octet-stream"})),!(_d.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return ap=[{paths:["./"+this.weightDataFileName],weights:_d.weightSpecs}],sp={modelTopology:_d.modelTopology,format:_d.format,generatedBy:_d.generatedBy,convertedBy:_d.convertedBy,weightsManifest:ap},lp=window.URL.createObjectURL(new Blob([JSON.stringify(sp)],{type:"application/json"})),(up=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,up.href=lp,[4,vf(function(){return up.dispatchEvent(new MouseEvent("click"))})];case 2:return dp.sent(),_d.weightData==null?[3,4]:((cp=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,cp.href=np,[4,vf(function(){return cp.dispatchEvent(new MouseEvent("click"))})]);case 3:dp.sent(),dp.label=4;case 4:return[2,{modelArtifactsInfo:Uh(_d)}]}})})},rp.URL_SCHEME="downloads://",rp}(),gf=function(){function rp(_d){if(_d==null||_d.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+_d);this.files=_d}return rp.prototype.load=function(){return n$1(this,void 0,void 0,function(){var _d,np,ap=this;return r(this,function(sp){return _d=this.files[0],np=this.files.slice(1),[2,new Promise(function(lp,up){var cp=new FileReader;cp.onload=function(dp){var hp=JSON.parse(dp.target.result),fp=hp.modelTopology;if(fp!=null){np.length===0&&lp({modelTopology:fp});var pp=hp.weightsManifest;if(pp!=null){var mp;try{mp=ap.checkManifestAndWeightFiles(pp,np)}catch(_p){return void up(_p)}var gp=[],yp=[],xp=[];pp.forEach(function(_p){_p.paths.forEach(function(vp){yp.push(vp),xp.push(null)}),gp.push.apply(gp,_p.weights)}),pp.forEach(function(_p){_p.paths.forEach(function(vp){var bp=new FileReader;bp.onload=function(Ep){var Sp=Ep.target.result,Ap=yp.indexOf(vp);xp[Ap]=Sp,xp.indexOf(null)===-1&&lp({modelTopology:fp,weightSpecs:gp,weightData:Lh(xp)})},bp.onerror=function(Ep){return up("Failed to weights data from file of path '"+vp+"'.")},bp.readAsArrayBuffer(mp[vp])})})}else up(new Error("weightManifest field is missing from file "+_d.name))}else up(new Error("modelTopology field is missing from file "+_d.name))},cp.onerror=function(dp){return up("Failed to read model topology and weights manifest JSON from file '"+_d.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},cp.readAsText(_d)})]})})},rp.prototype.checkManifestAndWeightFiles=function(_d,np){for(var ap=[],sp=np.map(function(dp){return Wh(dp.name)}),lp={},up=0,cp=_d;up<cp.length;up++)cp[up].paths.forEach(function(dp){var hp=Wh(dp);if(ap.indexOf(hp)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+hp+"'");if(ap.push(hp),sp.indexOf(hp)===-1)throw new Error("Weight file with basename '"+hp+"' is not provided.");lp[dp]=np[sp.indexOf(hp)]});if(ap.length!==np.length)throw new Error("Mismatch in the number of files in weights manifest ("+ap.length+") and the number of weight files provided ("+np.length+").");return lp},rp}();function yf(rp,_d,np,ap){(function(lp){g(lp!=null&&Array.isArray(lp)&&lp.length>0,function(){return"promises must be a none empty array"})})(rp),function(lp,up){g(lp>=0&&lp<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+lp}),g(up>=0&&up<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+up}),g(up>=lp,function(){return"startFraction must be no more than endFraction, but got startFraction "+lp+" and endFraction "+up})}(np=np??0,ap=ap??1);var sp=0;return Promise.all(rp.map(function(lp){return lp.then(function(up){var cp=np+ ++sp/rp.length*(ap-np);return _d(cp),up}),lp}))}function xf(rp,_d){return n$1(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp,hp,fp;return r(this,function(pp){switch(pp.label){case 0:return _d==null&&(_d={}),np=_d.fetchFunc==null?a$1().platform.fetch:_d.fetchFunc,ap=rp.map(function(mp){return np(mp,_d.requestInit,{isBinary:!0})}),sp=0,lp=.5,_d.onProgress!=null?[3,2]:[4,Promise.all(ap)];case 1:return up=pp.sent(),[3,4];case 2:return[4,yf(ap,_d.onProgress,sp,lp)];case 3:up=pp.sent(),pp.label=4;case 4:return cp=up.map(function(mp){return mp.arrayBuffer()}),dp=.5,hp=1,_d.onProgress!=null?[3,6]:[4,Promise.all(cp)];case 5:return fp=pp.sent(),[3,8];case 6:return[4,yf(cp,_d.onProgress,dp,hp)];case 7:fp=pp.sent(),pp.label=8;case 8:return[2,fp]}})})}function bf(rp){var _d=this;return function(np,ap,sp){return ap===void 0&&(ap=""),n$1(_d,void 0,void 0,function(){var lp,up,cp,dp,hp,fp,pp,mp,gp,yp;return r(this,function(xp){switch(xp.label){case 0:if(lp=np.map(function(){return!1}),up={},cp=sp!=null?sp.map(function(){return!1}):[],dp=[],np.forEach(function(_p,vp){var bp=0;_p.weights.forEach(function(Ep){var Sp="quantization"in Ep?Ep.quantization.dtype:Ep.dtype,Ap=Fh[Sp]*w$1(Ep.shape),Rp=function(){lp[vp]=!0,up[vp]==null&&(up[vp]=[]),up[vp].push({manifestEntry:Ep,groupOffset:bp,sizeBytes:Ap})};sp!=null?sp.forEach(function(Tp,Mp){Tp===Ep.name&&(Rp(),cp[Mp]=!0)}):Rp(),dp.push(Ep.name),bp+=Ap})}),!cp.every(function(_p){return _p}))throw hp=sp.filter(function(_p,vp){return!cp[vp]}),new Error("Could not find weights in manifest with names: "+hp.join(", ")+`. 
Manifest JSON has weights with names: `+dp.join(", ")+".");return fp=lp.reduce(function(_p,vp,bp){return vp&&_p.push(bp),_p},[]),pp=[],fp.forEach(function(_p){np[_p].paths.forEach(function(vp){var bp=ap+(ap.endsWith("/")?"":"/")+vp;pp.push(bp)})}),[4,rp(pp)];case 1:return mp=xp.sent(),gp={},yp=0,fp.forEach(function(_p){for(var vp=np[_p].paths.length,bp=0,Ep=0;Ep<vp;Ep++)bp+=mp[yp+Ep].byteLength;for(var Sp=new ArrayBuffer(bp),Ap=new Uint8Array(Sp),Rp=0,Tp=0;Tp<vp;Tp++){var Mp=new Uint8Array(mp[yp+Tp]);Ap.set(Mp,Rp),Rp+=Mp.byteLength}up[_p].forEach(function(Op){var Pp=_h(Sp.slice(Op.groupOffset,Op.groupOffset+Op.sizeBytes),[Op.manifestEntry]);for(var $p in Pp)gp[$p]=Pp[$p]}),yp+=vp}),[2,gp]}})})}}Vh.registerSaveRouter(function(rp){return a$1().getBool("IS_BROWSER")&&!Array.isArray(rp)&&rp.startsWith(mf.URL_SCHEME)?(_d=rp.slice(mf.URL_SCHEME.length),_d===void 0&&(_d="model"),new mf(_d)):null;var _d});var wf=function(){function rp(_d,np){if(this.DEFAULT_METHOD="POST",np==null&&(np={}),this.weightPathPrefix=np.weightPathPrefix,this.onProgress=np.onProgress,np.fetchFunc!=null?(g(typeof np.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=np.fetchFunc):this.fetch=a$1().platform.fetch,g(_d!=null&&_d.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(_d)&&g(_d.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+_d.length+")."}),this.path=_d,np.requestInit!=null&&np.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=np.requestInit||{}}return rp.prototype.save=function(_d){return n$1(this,void 0,void 0,function(){var np,ap,sp,lp;return r(this,function(up){switch(up.label){case 0:if(_d.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(np=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,ap=[{paths:["./model.weights.bin"],weights:_d.weightSpecs}],sp={modelTopology:_d.modelTopology,format:_d.format,generatedBy:_d.generatedBy,convertedBy:_d.convertedBy,userDefinedMetadata:_d.userDefinedMetadata,weightsManifest:ap},np.body.append("model.json",new Blob([JSON.stringify(sp)],{type:"application/json"}),"model.json"),_d.weightData!=null&&np.body.append("model.weights.bin",new Blob([_d.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,np)];case 1:if((lp=up.sent()).ok)return[2,{modelArtifactsInfo:Uh(_d),responses:[lp]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+lp.status+".")}})})},rp.prototype.load=function(){return n$1(this,void 0,void 0,function(){var _d,np,ap,sp,lp,up,cp,dp;return r(this,function(hp){switch(hp.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(_d=hp.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+_d.status+". Please verify this URL points to the model JSON of the model to load.");hp.label=2;case 2:return hp.trys.push([2,4,,5]),[4,_d.json()];case 3:return np=hp.sent(),[3,5];case 4:throw hp.sent(),ap="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?ap+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":ap+=" Please make sure the server is serving valid JSON for this request.",new Error(ap);case 5:if(sp=np.modelTopology,lp=np.weightsManifest,sp==null&&lp==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return lp==null?[3,7]:[4,this.loadWeights(lp)];case 6:dp=hp.sent(),up=dp[0],cp=dp[1],hp.label=7;case 7:return[2,{modelTopology:sp,weightSpecs:up,weightData:cp}]}})})},rp.prototype.loadWeights=function(_d){return n$1(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp,hp,fp,pp,mp;return r(this,function(gp){switch(gp.label){case 0:for(np=Array.isArray(this.path)?this.path[1]:this.path,ap=function(yp){var xp=yp.lastIndexOf("/"),_p=yp.lastIndexOf("?"),vp=yp.substring(0,xp),bp=_p>xp?yp.substring(_p):"";return[vp+"/",bp]}(np),sp=ap[0],lp=ap[1],up=this.weightPathPrefix||sp,cp=[],dp=0,hp=_d;dp<hp.length;dp++)fp=hp[dp],cp.push.apply(cp,fp.weights);return pp=[],_d.forEach(function(yp){yp.paths.forEach(function(xp){pp.push(up+xp+lp)})}),[4,xf(pp,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return mp=gp.sent(),[2,[cp,Lh(mp)]]}})})},rp.URL_SCHEME_REGEX=/^https?:\/\//,rp}();function Cf(rp){return rp.match(wf.URL_SCHEME_REGEX)!=null}var Ef=function(rp,_d){return typeof fetch>"u"?null:(Array.isArray(rp)?rp.every(function(np){return Cf(np)}):Cf(rp))?Rf(rp,{onProgress:_d}):null};function Rf(rp,_d){return new wf(rp,_d)}Vh.registerSaveRouter(Ef),Vh.registerLoadRouter(Ef);var If=function(){function rp(_d){this.modelArtifacts=_d}return rp.prototype.load=function(){return n$1(this,void 0,void 0,function(){return r(this,function(_d){return[2,this.modelArtifacts]})})},rp}(),kf=function(){function rp(_d){this.saveHandler=_d}return rp.prototype.save=function(_d){return n$1(this,void 0,void 0,function(){return r(this,function(np){return[2,this.saveHandler(_d)]})})},rp}(),Sf=Object.freeze({browserFiles:function(rp){return new gf(rp)},browserHTTPRequest:function(rp,_d){return Rf(rp,_d)},concatenateArrayBuffers:Lh,decodeWeights:_h,encodeWeights:function(rp,_d){return n$1(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp=this;return r(this,function(dp){switch(dp.label){case 0:for(np=[],ap=[],sp=Array.isArray(rp)?rp.map(function(hp){return hp.name}):Object.keys(rp),lp=function(hp){var fp=sp[hp],pp=Array.isArray(rp)?rp[hp].tensor:rp[fp];if(pp.dtype!=="float32"&&pp.dtype!=="int32"&&pp.dtype!=="bool"&&pp.dtype!=="string")throw new Error("Unsupported dtype in weight '"+fp+"': "+pp.dtype);var mp={name:fp,shape:pp.shape,dtype:pp.dtype};if(pp.dtype==="string"){var gp=new Promise(function(yp){return n$1(cp,void 0,void 0,function(){var xp,_p,vp,bp,Ep,Sp,Ap;return r(this,function(Rp){switch(Rp.label){case 0:return[4,pp.bytes()];case 1:for(xp=Rp.sent(),_p=xp.reduce(function(Tp,Mp){return Tp+Mp.length},0)+Oh*xp.length,vp=new Uint8Array(_p),bp=0,Ep=0;Ep<xp.length;Ep++)Sp=xp[Ep],Ap=new Uint8Array(new Uint32Array([Sp.length]).buffer),vp.set(Ap,bp),bp+=Oh,vp.set(Sp,bp),bp+=Sp.length;return yp(vp),[2]}})})});ap.push(gp)}else ap.push(pp.data());_d!=null&&(mp.group=_d),np.push(mp)},up=0;up<sp.length;++up)lp(up);return[4,Promise.all(ap)];case 1:return[2,{data:Mh(dp.sent()),specs:np}]}})})},fromMemory:function(rp,_d,np,ap){return arguments.length===1?rp.modelTopology!=null||rp.weightSpecs!=null?new If(rp):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new If({modelTopology:rp})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new If({modelTopology:rp,weightSpecs:_d,weightData:np,trainingConfig:ap}))},getLoadHandlers:function(rp,_d){return Vh.getLoadHandlers(rp,_d)},getModelArtifactsInfoForJSON:Uh,getSaveHandlers:function(rp){return Vh.getSaveHandlers(rp)},http:Rf,isHTTPScheme:Cf,loadWeights:function(rp,_d,np,ap){return _d===void 0&&(_d=""),n$1(this,void 0,void 0,function(){return r(this,function(sp){return[2,bf(function(lp){return xf(lp,{requestInit:ap})})(rp,_d,np)]})})},registerLoadRouter:function(rp){return Vh.registerLoadRouter(rp)},registerSaveRouter:function(rp){return Vh.registerSaveRouter(rp)},weightsLoaderFactory:bf,withSaveHandler:function(rp){return new kf(rp)},copyModel:function(rp,_d){return n$1(this,void 0,void 0,function(){return r(this,function(np){return[2,qh(rp,_d,!1)]})})},listModels:function(){return n$1(this,void 0,void 0,function(){var rp,_d,np,ap,sp,lp,up;return r(this,function(cp){switch(cp.label){case 0:rp=Gh.getSchemes(),_d={},np=0,ap=rp,cp.label=1;case 1:return np<ap.length?(sp=ap[np],[4,Gh.getManager(sp).listModels()]):[3,4];case 2:for(up in lp=cp.sent())_d[sp+zh+up]=lp[up];cp.label=3;case 3:return np++,[3,1];case 4:return[2,_d]}})})},moveModel:function(rp,_d){return n$1(this,void 0,void 0,function(){return r(this,function(np){return[2,qh(rp,_d,!0)]})})},removeModel:function(rp){return n$1(this,void 0,void 0,function(){var _d;return r(this,function(np){return _d=Hh(rp),[2,Gh.getManager(_d.scheme).removeModel(_d.path)]})})}}),Af=Cn({confusionMatrix_:function(rp,_d,np){var ap=ln(rp,"labels","confusionMatrix"),sp=ln(_d,"predictions","confusionMatrix");g(np==null||np>0&&Number.isInteger(np),function(){return"If provided, numClasses must be a positive integer, but got "+np}),g(ap.rank===1,function(){return"Expected the rank of labels to be 1, but got "+ap.rank}),g(sp.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+sp.rank}),g(ap.shape[0]===sp.shape[0],function(){return"Mismatch in the number of examples: "+ap.shape[0]+" vs. "+sp.shape[0]+". Labels and predictions should have the same number of elements."}),g(np>0&&Number.isInteger(np),function(){return"numClasses is required to be a positive integer, but got "+np});var lp=gr(ap.asType("int32"),np),up=gr(sp.asType("int32"),np);return lp.transpose().matMul(up).asType("int32")}}),Df=Object.freeze({confusionMatrix:Af}),Tf=Cn({fromPixels_:function(rp,_d){if(_d===void 0&&(_d=3),_d>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var np=typeof HTMLVideoElement<"u"&&rp instanceof HTMLVideoElement;if(np&&np&&rp.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return Nt.fromPixels(rp,_d)}}),Nf=Object.freeze({toPixels:function(rp,_d){return n$1(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p,vp,bp,Ep,Sp,Ap,Rp,Tp,Mp;return r(this,function(Op){switch(Op.label){case 0:if(np=ln(rp,"img","toPixels"),rp instanceof dt||(np=np.toInt()),np.rank!==2&&np.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+np.rank+".");if(ap=np.shape.slice(0,2),sp=ap[0],lp=ap[1],(up=np.rank===2?1:np.shape[2])>4||up===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+up);return[4,np.data()];case 1:return cp=Op.sent(),dp=np.min(),hp=np.max(),[4,Promise.all([dp.data(),hp.data()])];case 2:if(fp=Op.sent(),pp=fp[0],mp=fp[1],gp=pp[0],yp=mp[0],dp.dispose(),hp.dispose(),np.dtype==="float32"){if(gp<0||yp>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+gp+" - "+yp+"].")}else{if(np.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+np.dtype+". Please use float32 or int32 tensors.");if(gp<0||yp>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+gp+" - "+yp+"].")}for(xp=np.dtype==="float32"?255:1,_p=new Uint8ClampedArray(lp*sp*4),vp=0;vp<sp*lp;++vp)bp=void 0,Ep=void 0,Sp=void 0,Ap=void 0,up===1?(bp=cp[vp]*xp,Ep=cp[vp]*xp,Sp=cp[vp]*xp,Ap=255):up===3?(bp=cp[3*vp]*xp,Ep=cp[3*vp+1]*xp,Sp=cp[3*vp+2]*xp,Ap=255):up===4&&(bp=cp[4*vp]*xp,Ep=cp[4*vp+1]*xp,Sp=cp[4*vp+2]*xp,Ap=cp[4*vp+3]*xp),_p[0+(Rp=4*vp)]=Math.round(bp),_p[Rp+1]=Math.round(Ep),_p[Rp+2]=Math.round(Sp),_p[Rp+3]=Math.round(Ap);return _d!=null&&(_d.width=lp,_d.height=sp,Tp=_d.getContext("2d"),Mp=new ImageData(_p,lp,sp),Tp.putImageData(Mp,0,0)),np!==rp&&np.dispose(),[2,_p]}})})},fromPixels:Tf}),Ff=function(){function rp(){}return rp.prototype.getClassName=function(){return this.constructor.className},rp.fromConfig=function(_d,np){return new _d(np)},rp}(),Of=function(){function rp(){this.classNameMap={}}return rp.getMap=function(){return rp.instance==null&&(rp.instance=new rp),rp.instance},rp.register=function(_d){rp.getMap().classNameMap[_d.className]=[_d,_d.fromConfig]},rp}();function _f(rp){g(rp.className!=null,function(){return"Class being registered does not have the static className property defined."}),g(typeof rp.className=="string",function(){return"className is required to be a string, but got type "+typeof rp.className}),g(rp.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Of.register(rp)}var Mf=Object.freeze({Serializable:Ff,SerializationMap:Of,registerClass:_f}),Bf=.001,Pf=.1;function Lf(){return Nt.backend.floatPrecision()===32?Bf:Pf}function Wf(rp,_d,np){var ap=!0;if((B(rp)||B(_d))&&(ap=!1),B(rp)&&B(_d)&&(ap=!0),ap){var sp=rp.constructor.name,lp=_d.constructor.name;if(sp!==lp)throw new Error("Arrays are of different type. Actual: "+sp+". Expected: "+lp)}if(Array.isArray(rp)&&Array.isArray(_d)){var up=sn(rp),cp=sn(_d);if(!C(up,cp))throw new Error("Arrays have different shapes. Actual: ["+up+"]. Expected: ["+cp+"]")}var dp=B(rp)?rp:b(rp),hp=B(_d)?_d:b(_d);if(dp.length!==hp.length)throw new Error("Arrays have different lengths actual: "+dp.length+" vs expected: "+hp.length+`.
Actual:   `+dp+`.
Expected: `+hp+".");for(var fp=0;fp<hp.length;++fp){var pp=dp[fp],mp=hp[fp];if(!np(pp,mp))throw new Error("Arrays differ: actual["+fp+"] = "+pp+", expected["+fp+"] = "+mp+`.
Actual:   `+dp+`.
Expected: `+hp+".")}}function Uf(rp,_d,np){return!isFinite(rp)&&!isFinite(_d)||!(isNaN(rp)||isNaN(_d)||Math.abs(rp-_d)>np)}var Vf=Object.freeze({TEST_EPSILON_FLOAT16:Pf,expectArraysClose:function(rp,_d,np){return np==null&&(np=Lf()),Wf(rp,_d,function(ap,sp){return Uf(ap,sp,np)})},testEpsilon:Lf,expectPromiseToFail:function(rp,_d){rp().then(function(){return _d.fail()},function(){return _d()})},expectArraysEqual:function(rp,_d){var np=typeof _d=="string"||typeof _d=="number"||typeof _d=="boolean"?[_d]:_d;return W(rp)||W(rp[0])||W(_d)||W(_d[0])?Wf(rp,np,function(ap,sp){return ap==sp}):Wf(rp,_d,function(ap,sp){return Uf(ap,sp,0)})},expectNumbersClose:function(rp,_d,np){if(np==null&&(np=Lf()),!Uf(rp,_d,np))throw new Error("Numbers differ: actual === "+rp+", expected === "+_d)},expectValuesInRange:function(rp,_d,np){for(var ap=0;ap<rp.length;ap++)if(rp[ap]<_d||rp[ap]>np)throw new Error("Value out of range:"+rp[ap]+" low: "+_d+", high: "+np)},expectArrayBuffersEqual:function(rp,_d){expect(new Float32Array(rp)).toEqual(new Float32Array(_d))}}),zf="1.3.1",Gf=Object.freeze({gpgpu_util:wi,webgl_util:Pe,forceHalfFloat:function(){a$1().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:Wu,setWebGLContext:Wt,GPGPUContext:Ci}),Hf=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return e(_d,rp),_d.prototype.minimize=function(np,ap,sp){ap===void 0&&(ap=!1);var lp=this.computeGradients(np,sp),up=lp.value,cp=lp.grads;if(sp!=null){var dp=sp.map(function(hp){return{name:hp.name,tensor:cp[hp.name]}});this.applyGradients(dp)}else this.applyGradients(cp);return Xe(cp),ap?up:(up.dispose(),null)},Object.defineProperty(_d.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),_d.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},_d.prototype.computeGradients=function(np,ap){return ro(np,ap)},_d.prototype.dispose=function(){this.iterations_!=null&&Xe(this.iterations_)},_d.prototype.saveIterations=function(){return n$1(this,void 0,void 0,function(){return r(this,function(np){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:An(this.iterations_,"int32")}]})})},_d.prototype.getWeights=function(){return n$1(this,void 0,void 0,function(){return r(this,function(np){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},_d.prototype.setWeights=function(np){return n$1(this,void 0,void 0,function(){return r(this,function(ap){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},_d.prototype.extractIterations=function(np){return n$1(this,void 0,void 0,function(){var ap;return r(this,function(sp){switch(sp.label){case 0:return ap=this,[4,np[0].tensor.data()];case 1:return ap.iterations_=sp.sent()[0],[2,np.slice(1)]}})})},_d}(Ff);Object.defineProperty(Hf,Symbol.hasInstance,{value:function(rp){return rp.minimize!=null&&rp.computeGradients!=null&&rp.applyGradients!=null}});var qf=function(rp){function _d(np,ap,sp){sp===void 0&&(sp=null);var lp=rp.call(this)||this;return lp.learningRate=np,lp.rho=ap,lp.epsilon=sp,lp.accumulatedGrads=[],lp.accumulatedUpdates=[],sp==null&&(lp.epsilon=Nt.backend.epsilon()),lp}return e(_d,rp),_d.prototype.applyGradients=function(np){var ap=this;(Array.isArray(np)?np.map(function(sp){return sp.name}):Object.keys(np)).forEach(function(sp,lp){var up=Nt.registeredVariables[sp];ap.accumulatedGrads[lp]==null&&(ap.accumulatedGrads[lp]={originalName:sp+"/accum_grad",variable:je(function(){return zn(up).variable(!1)})}),ap.accumulatedUpdates[lp]==null&&(ap.accumulatedUpdates[lp]={originalName:sp+"/accum_var",variable:je(function(){return zn(up).variable(!1)})});var cp=Array.isArray(np)?np[lp].tensor:np[sp];if(cp!=null){var dp=ap.accumulatedGrads[lp].variable,hp=ap.accumulatedUpdates[lp].variable;je(function(){var fp=dp.mul(ap.rho).add(cp.square().mul(1-ap.rho)),pp=hp.add(ap.epsilon).sqrt().div(dp.add(ap.epsilon).sqrt()).mul(cp),mp=hp.mul(ap.rho).add(pp.square().mul(1-ap.rho));dp.assign(fp),hp.assign(mp);var gp=pp.mul(-ap.learningRate).add(up);up.assign(gp)})}}),this.incrementIterations()},_d.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Xe(this.accumulatedGrads.map(function(np){return np.variable})),Xe(this.accumulatedUpdates.map(function(np){return np.variable})))},_d.prototype.getWeights=function(){return n$1(this,void 0,void 0,function(){var np;return r(this,function(ap){switch(ap.label){case 0:return np=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[ap.sent()].concat(np.map(function(sp){return{name:sp.originalName,tensor:sp.variable}}))]}})})},_d.prototype.setWeights=function(np){return n$1(this,void 0,void 0,function(){var ap;return r(this,function(sp){switch(sp.label){case 0:return[4,this.extractIterations(np)];case 1:return np=sp.sent(),ap=np.length/2,this.accumulatedGrads=np.slice(0,ap).map(function(lp){return{originalName:lp.name,variable:lp.tensor.variable(!1)}}),this.accumulatedUpdates=np.slice(ap,2*ap).map(function(lp){return{originalName:lp.name,variable:lp.tensor.variable(!1)}}),[2]}})})},_d.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},_d.fromConfig=function(np,ap){return new np(ap.learningRate,ap.rho,ap.epsilon)},_d.className="Adadelta",_d}(Hf);_f(qf);var Kf=function(rp){function _d(np,ap){ap===void 0&&(ap=.1);var sp=rp.call(this)||this;return sp.learningRate=np,sp.initialAccumulatorValue=ap,sp.accumulatedGrads=[],sp}return e(_d,rp),_d.prototype.applyGradients=function(np){var ap=this;(Array.isArray(np)?np.map(function(sp){return sp.name}):Object.keys(np)).forEach(function(sp,lp){var up=Nt.registeredVariables[sp];ap.accumulatedGrads[lp]==null&&(ap.accumulatedGrads[lp]={originalName:sp+"/accumulator",variable:je(function(){return Ln(up.shape,ap.initialAccumulatorValue).variable(!1)})});var cp=Array.isArray(np)?np[lp].tensor:np[sp];if(cp!=null){var dp=ap.accumulatedGrads[lp].variable;je(function(){var hp=dp.add(cp.square());dp.assign(hp);var fp=cp.div(hp.add(Nt.backend.epsilon()).sqrt()).mul(-ap.learningRate).add(up);up.assign(fp)})}}),this.incrementIterations()},_d.prototype.dispose=function(){this.accumulatedGrads!=null&&Xe(this.accumulatedGrads.map(function(np){return np.variable}))},_d.prototype.getWeights=function(){return n$1(this,void 0,void 0,function(){return r(this,function(np){switch(np.label){case 0:return[4,this.saveIterations()];case 1:return[2,[np.sent()].concat(this.accumulatedGrads.map(function(ap){return{name:ap.originalName,tensor:ap.variable}}))]}})})},_d.prototype.setWeights=function(np){return n$1(this,void 0,void 0,function(){return r(this,function(ap){switch(ap.label){case 0:return[4,this.extractIterations(np)];case 1:return np=ap.sent(),this.accumulatedGrads=np.map(function(sp){return{originalName:sp.name,variable:sp.tensor.variable(!1)}}),[2]}})})},_d.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},_d.fromConfig=function(np,ap){return new np(ap.learningRate,ap.initialAccumulatorValue)},_d.className="Adagrad",_d}(Hf);_f(Kf);var jf=function(rp){function _d(np,ap,sp,lp){lp===void 0&&(lp=null);var up=rp.call(this)||this;return up.learningRate=np,up.beta1=ap,up.beta2=sp,up.epsilon=lp,up.accumulatedFirstMoment=[],up.accumulatedSecondMoment=[],je(function(){up.accBeta1=An(ap).variable(),up.accBeta2=An(sp).variable()}),lp==null&&(up.epsilon=Nt.backend.epsilon()),up}return e(_d,rp),_d.prototype.applyGradients=function(np){var ap=this,sp=Array.isArray(np)?np.map(function(lp){return lp.name}):Object.keys(np);je(function(){var lp=ic(1,ap.accBeta1),up=ic(1,ap.accBeta2);sp.forEach(function(cp,dp){var hp=Nt.registeredVariables[cp];ap.accumulatedFirstMoment[dp]==null&&(ap.accumulatedFirstMoment[dp]={originalName:cp+"/m",variable:je(function(){return zn(hp).variable(!1)})}),ap.accumulatedSecondMoment[dp]==null&&(ap.accumulatedSecondMoment[dp]={originalName:cp+"/v",variable:je(function(){return zn(hp).variable(!1)})});var fp=Array.isArray(np)?np[dp].tensor:np[cp];if(fp!=null){var pp=ap.accumulatedFirstMoment[dp].variable,mp=ap.accumulatedSecondMoment[dp].variable,gp=pp.mul(ap.beta1).add(fp.mul(1-ap.beta1)),yp=mp.mul(ap.beta2).add(fp.square().mul(1-ap.beta2)),xp=gp.div(lp),_p=yp.div(up);pp.assign(gp),mp.assign(yp);var vp=xp.div(_p.sqrt().add(ap.epsilon)).mul(-ap.learningRate).add(hp);hp.assign(vp)}}),ap.accBeta1.assign(ap.accBeta1.mul(ap.beta1)),ap.accBeta2.assign(ap.accBeta2.mul(ap.beta2))}),this.incrementIterations()},_d.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Xe(this.accumulatedFirstMoment.map(function(np){return np.variable})),this.accumulatedSecondMoment!=null&&Xe(this.accumulatedSecondMoment.map(function(np){return np.variable}))},_d.prototype.getWeights=function(){return n$1(this,void 0,void 0,function(){var np;return r(this,function(ap){switch(ap.label){case 0:return np=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[ap.sent()].concat(np.map(function(sp){return{name:sp.originalName,tensor:sp.variable}}))]}})})},_d.prototype.setWeights=function(np){return n$1(this,void 0,void 0,function(){var ap,sp=this;return r(this,function(lp){switch(lp.label){case 0:return[4,this.extractIterations(np)];case 1:return np=lp.sent(),je(function(){sp.accBeta1.assign(nc(sp.beta1,sp.iterations_+1)),sp.accBeta2.assign(nc(sp.beta2,sp.iterations_+1))}),ap=np.length/2,this.accumulatedFirstMoment=np.slice(0,ap).map(function(up){return{originalName:up.name,variable:up.tensor.variable(!1)}}),this.accumulatedSecondMoment=np.slice(ap,2*ap).map(function(up){return{originalName:up.name,variable:up.tensor.variable(!1)}}),[2]}})})},_d.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},_d.fromConfig=function(np,ap){return new np(ap.learningRate,ap.beta1,ap.beta2,ap.epsilon)},_d.className="Adam",_d}(Hf);_f(jf);var Xf=function(rp){function _d(np,ap,sp,lp,up){lp===void 0&&(lp=null),up===void 0&&(up=0);var cp=rp.call(this)||this;return cp.learningRate=np,cp.beta1=ap,cp.beta2=sp,cp.epsilon=lp,cp.decay=up,cp.accumulatedFirstMoment=[],cp.accumulatedWeightedInfNorm=[],je(function(){cp.iteration=An(0).variable(),cp.accBeta1=An(ap).variable()}),lp==null&&(cp.epsilon=Nt.backend.epsilon()),cp}return e(_d,rp),_d.prototype.applyGradients=function(np){var ap=this,sp=Array.isArray(np)?np.map(function(lp){return lp.name}):Object.keys(np);je(function(){var lp=ic(1,ap.accBeta1),up=qs(-ap.learningRate,ap.iteration.mul(ap.decay).add(1));sp.forEach(function(cp,dp){var hp=Nt.registeredVariables[cp];ap.accumulatedFirstMoment[dp]==null&&(ap.accumulatedFirstMoment[dp]={originalName:cp+"/m",variable:zn(hp).variable(!1)}),ap.accumulatedWeightedInfNorm[dp]==null&&(ap.accumulatedWeightedInfNorm[dp]={originalName:cp+"/v",variable:zn(hp).variable(!1)});var fp=Array.isArray(np)?np[dp].tensor:np[cp];if(fp!=null){var pp=ap.accumulatedFirstMoment[dp].variable,mp=ap.accumulatedWeightedInfNorm[dp].variable,gp=pp.mul(ap.beta1).add(fp.mul(1-ap.beta1)),yp=mp.mul(ap.beta2),xp=fp.abs(),_p=yp.maximum(xp);pp.assign(gp),mp.assign(_p);var vp=up.div(lp).mul(gp.div(_p.add(ap.epsilon))).add(hp);hp.assign(vp)}}),ap.iteration.assign(ap.iteration.add(1)),ap.accBeta1.assign(ap.accBeta1.mul(ap.beta1))}),this.incrementIterations()},_d.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Xe(this.accumulatedFirstMoment.map(function(np){return np.variable})),this.accumulatedWeightedInfNorm!=null&&Xe(this.accumulatedWeightedInfNorm.map(function(np){return np.variable}))},_d.prototype.getWeights=function(){return n$1(this,void 0,void 0,function(){return r(this,function(np){throw new Error("getWeights() is not implemented for Adamax yet.")})})},_d.prototype.setWeights=function(np){return n$1(this,void 0,void 0,function(){return r(this,function(ap){throw new Error("setWeights() is not implemented for Adamax yet.")})})},_d.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},_d.fromConfig=function(np,ap){return new np(ap.learningRate,ap.beta1,ap.beta2,ap.epsilon,ap.decay)},_d.className="Adamax",_d}(Hf);_f(Xf);var $f=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.learningRate=np,ap.setLearningRate(np),ap}return e(_d,rp),_d.prototype.applyGradients=function(np){var ap=this;(Array.isArray(np)?np.map(function(sp){return sp.name}):Object.keys(np)).forEach(function(sp,lp){var up=Array.isArray(np)?np[lp].tensor:np[sp];if(up!=null){var cp=Nt.registeredVariables[sp];je(function(){var dp=ap.c.mul(up).add(cp);cp.assign(dp)})}}),this.incrementIterations()},_d.prototype.setLearningRate=function(np){this.learningRate=np,this.c!=null&&this.c.dispose(),this.c=$e(An(-np))},_d.prototype.dispose=function(){this.c.dispose()},_d.prototype.getWeights=function(){return n$1(this,void 0,void 0,function(){return r(this,function(np){switch(np.label){case 0:return[4,this.saveIterations()];case 1:return[2,[np.sent()]]}})})},_d.prototype.setWeights=function(np){return n$1(this,void 0,void 0,function(){return r(this,function(ap){switch(ap.label){case 0:return[4,this.extractIterations(np)];case 1:if((np=ap.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},_d.prototype.getConfig=function(){return{learningRate:this.learningRate}},_d.fromConfig=function(np,ap){return new np(ap.learningRate)},_d.className="SGD",_d}(Hf);_f($f);var Yf=function(rp){function _d(np,ap,sp){sp===void 0&&(sp=!1);var lp=rp.call(this,np)||this;return lp.learningRate=np,lp.momentum=ap,lp.useNesterov=sp,lp.accumulations=[],lp.m=An(lp.momentum),lp}return e(_d,rp),_d.prototype.applyGradients=function(np){var ap=this;(Array.isArray(np)?np.map(function(sp){return sp.name}):Object.keys(np)).forEach(function(sp,lp){var up=Nt.registeredVariables[sp];ap.accumulations[lp]==null&&(ap.accumulations[lp]={originalName:sp+"/momentum",variable:je(function(){return zn(up).variable(!1)})});var cp=ap.accumulations[lp].variable,dp=Array.isArray(np)?np[lp].tensor:np[sp];dp!=null&&je(function(){var hp,fp=ap.m.mul(cp).add(dp);hp=ap.useNesterov?ap.c.mul(dp.add(fp.mul(ap.m))).add(up):ap.c.mul(fp).add(up),cp.assign(fp),up.assign(hp)})}),this.incrementIterations()},_d.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Xe(this.accumulations.map(function(np){return np.variable}))},_d.prototype.setMomentum=function(np){this.momentum=np},_d.prototype.getWeights=function(){return n$1(this,void 0,void 0,function(){return r(this,function(np){switch(np.label){case 0:return[4,this.saveIterations()];case 1:return[2,[np.sent()].concat(this.accumulations.map(function(ap){return{name:ap.originalName,tensor:ap.variable}}))]}})})},_d.prototype.setWeights=function(np){return n$1(this,void 0,void 0,function(){return r(this,function(ap){switch(ap.label){case 0:return[4,this.extractIterations(np)];case 1:return np=ap.sent(),this.accumulations=np.map(function(sp){return{originalName:sp.name,variable:sp.tensor.variable(!1)}}),[2]}})})},_d.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},_d.fromConfig=function(np,ap){return new np(ap.learningRate,ap.momentum,ap.useNesterov)},_d.className="Momentum",_d}($f);_f(Yf);var Qf=function(rp){function _d(np,ap,sp,lp,up){ap===void 0&&(ap=.9),sp===void 0&&(sp=0),lp===void 0&&(lp=null),up===void 0&&(up=!1);var cp=rp.call(this)||this;return cp.learningRate=np,cp.decay=ap,cp.momentum=sp,cp.epsilon=lp,cp.accumulatedMeanSquares=[],cp.accumulatedMoments=[],cp.accumulatedMeanGrads=[],cp.centered=up,lp==null&&(cp.epsilon=Nt.backend.epsilon()),cp}return e(_d,rp),_d.prototype.applyGradients=function(np){var ap=this;(Array.isArray(np)?np.map(function(sp){return sp.name}):Object.keys(np)).forEach(function(sp,lp){var up=Nt.registeredVariables[sp];ap.accumulatedMeanSquares[lp]==null&&(ap.accumulatedMeanSquares[lp]={originalName:sp+"/rms",variable:je(function(){return zn(up).variable(!1)})}),ap.accumulatedMoments[lp]==null&&(ap.accumulatedMoments[lp]={originalName:sp+"/momentum",variable:je(function(){return zn(up).variable(!1)})}),ap.accumulatedMeanGrads[lp]==null&&ap.centered&&(ap.accumulatedMeanGrads[lp]={originalName:sp+"/mg",variable:je(function(){return zn(up).variable(!1)})});var cp=Array.isArray(np)?np[lp].tensor:np[sp];if(cp!=null){var dp=ap.accumulatedMeanSquares[lp].variable,hp=ap.accumulatedMoments[lp].variable;je(function(){var fp=dp.mul(ap.decay).add(cp.square().mul(1-ap.decay));if(ap.centered){var pp=ap.accumulatedMeanGrads[lp].variable,mp=pp.mul(ap.decay).add(cp.mul(1-ap.decay)),gp=hp.mul(ap.momentum).add(cp.mul(ap.learningRate).div(fp.sub(mp.square().add(ap.epsilon)).sqrt()));dp.assign(fp),pp.assign(mp),hp.assign(gp);var yp=up.sub(gp);up.assign(yp)}else{var xp=dp.mul(ap.decay).add(cp.square().mul(1-ap.decay));gp=hp.mul(ap.momentum).add(cp.mul(ap.learningRate).div(xp.add(ap.epsilon).sqrt())),dp.assign(xp),hp.assign(gp),yp=up.sub(gp),up.assign(yp)}})}}),this.incrementIterations()},_d.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Xe(this.accumulatedMeanSquares.map(function(np){return np.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Xe(this.accumulatedMeanGrads.map(function(np){return np.variable})),this.accumulatedMoments!=null&&Xe(this.accumulatedMoments.map(function(np){return np.variable}))},_d.prototype.getWeights=function(){return n$1(this,void 0,void 0,function(){var np;return r(this,function(ap){switch(ap.label){case 0:return np=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&np.push.apply(np,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[ap.sent()].concat(np.map(function(sp){return{name:sp.originalName,tensor:sp.variable}}))]}})})},_d.prototype.setWeights=function(np){return n$1(this,void 0,void 0,function(){var ap;return r(this,function(sp){switch(sp.label){case 0:return[4,this.extractIterations(np)];case 1:return np=sp.sent(),ap=this.centered?np.length/3:np.length/2,this.accumulatedMeanSquares=np.slice(0,ap).map(function(lp){return{originalName:lp.name,variable:lp.tensor.variable(!1)}}),this.accumulatedMoments=np.slice(ap,2*ap).map(function(lp){return{originalName:lp.name,variable:lp.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=np.slice(2*ap,3*ap).map(function(lp){return{originalName:lp.name,variable:lp.tensor.variable(!1)}})),[2]}})})},_d.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},_d.fromConfig=function(np,ap){return new np(ap.learningRate,ap.decay,ap.momentum,ap.epsilon,ap.centered)},_d.className="RMSProp",_d}(Hf);_f(Qf);var Jf=function(){function rp(){}return rp.sgd=function(_d){return new $f(_d)},rp.momentum=function(_d,np,ap){return ap===void 0&&(ap=!1),new Yf(_d,np,ap)},rp.rmsprop=function(_d,np,ap,sp,lp){return np===void 0&&(np=.9),ap===void 0&&(ap=0),sp===void 0&&(sp=null),lp===void 0&&(lp=!1),new Qf(_d,np,ap,sp,lp)},rp.adam=function(_d,np,ap,sp){return _d===void 0&&(_d=.001),np===void 0&&(np=.9),ap===void 0&&(ap=.999),sp===void 0&&(sp=null),new jf(_d,np,ap,sp)},rp.adadelta=function(_d,np,ap){return _d===void 0&&(_d=.001),np===void 0&&(np=.95),ap===void 0&&(ap=null),new qf(_d,np,ap)},rp.adamax=function(_d,np,ap,sp,lp){return _d===void 0&&(_d=.002),np===void 0&&(np=.9),ap===void 0&&(ap=.999),sp===void 0&&(sp=null),lp===void 0&&(lp=0),new Xf(_d,np,ap,sp,lp)},rp.adagrad=function(_d,np){return np===void 0&&(np=.1),new Kf(_d,np)},rp}(),Zf={sgd:Jf.sgd,momentum:Jf.momentum,adadelta:Jf.adadelta,adagrad:Jf.adagrad,rmsprop:Jf.rmsprop,adamax:Jf.adamax,adam:Jf.adam},tp=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:function(rp){return rp()};function ep(){return new Promise(function(rp){return tp(function(){return rp()})})}ft=Rh;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var extendStatics$1=function(rp,_d){return(extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(np,ap){np.__proto__=ap}||function(np,ap){for(var sp in ap)ap.hasOwnProperty(sp)&&(np[sp]=ap[sp])})(rp,_d)};function __extends$h(rp,_d){function np(){this.constructor=rp}extendStatics$1(rp,_d),rp.prototype=_d===null?Object.create(_d):(np.prototype=_d.prototype,new np)}var _epsilon,__assign$2=function(){return(__assign$2=Object.assign||function(rp){for(var _d,np=1,ap=arguments.length;np<ap;np++)for(var sp in _d=arguments[np])Object.prototype.hasOwnProperty.call(_d,sp)&&(rp[sp]=_d[sp]);return rp}).apply(this,arguments)};function __awaiter$8(rp,_d,np,ap){return new(np||(np=Promise))(function(sp,lp){function up(hp){try{dp(ap.next(hp))}catch(fp){lp(fp)}}function cp(hp){try{dp(ap.throw(hp))}catch(fp){lp(fp)}}function dp(hp){hp.done?sp(hp.value):new np(function(fp){fp(hp.value)}).then(up,cp)}dp((ap=ap.apply(rp,_d||[])).next())})}function __generator$8(rp,_d){var np,ap,sp,lp,up={label:0,sent:function(){if(1&sp[0])throw sp[1];return sp[1]},trys:[],ops:[]};return lp={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(lp[Symbol.iterator]=function(){return this}),lp;function cp(dp){return function(hp){return function(fp){if(np)throw new TypeError("Generator is already executing.");for(;up;)try{if(np=1,ap&&(sp=2&fp[0]?ap.return:fp[0]?ap.throw||((sp=ap.return)&&sp.call(ap),0):ap.next)&&!(sp=sp.call(ap,fp[1])).done)return sp;switch(ap=0,sp&&(fp=[2&fp[0],sp.value]),fp[0]){case 0:case 1:sp=fp;break;case 4:return up.label++,{value:fp[1],done:!1};case 5:up.label++,ap=fp[1],fp=[0];continue;case 7:fp=up.ops.pop(),up.trys.pop();continue;default:if(!(sp=(sp=up.trys).length>0&&sp[sp.length-1])&&(fp[0]===6||fp[0]===2)){up=0;continue}if(fp[0]===3&&(!sp||fp[1]>sp[0]&&fp[1]<sp[3])){up.label=fp[1];break}if(fp[0]===6&&up.label<sp[1]){up.label=sp[1],sp=fp;break}if(sp&&up.label<sp[2]){up.label=sp[2],up.ops.push(fp);break}sp[2]&&up.ops.pop(),up.trys.pop();continue}fp=_d.call(rp,up)}catch(pp){fp=[6,pp],ap=0}finally{np=sp=0}if(5&fp[0])throw fp[1];return{value:fp[0]?fp[1]:void 0,done:!0}}([dp,hp])}}}function epsilon(){return _epsilon==null&&(_epsilon=on().epsilon()),_epsilon}function imageDataFormat(){return"channelsLast"}var AttributeError=function(rp){function _d(np){var ap=rp.call(this,np)||this;return Object.setPrototypeOf(ap,_d.prototype),ap}return __extends$h(_d,rp),_d}(Error),RuntimeError=function(rp){function _d(np){var ap=rp.call(this,np)||this;return Object.setPrototypeOf(ap,_d.prototype),ap}return __extends$h(_d,rp),_d}(Error),ValueError=function(rp){function _d(np){var ap=rp.call(this,np)||this;return Object.setPrototypeOf(ap,_d.prototype),ap}return __extends$h(_d,rp),_d}(Error),NotImplementedError=function(rp){function _d(np){var ap=rp.call(this,np)||this;return Object.setPrototypeOf(ap,_d.prototype),ap}return __extends$h(_d,rp),_d}(Error),AssertionError=function(rp){function _d(np){var ap=rp.call(this,np)||this;return Object.setPrototypeOf(ap,_d.prototype),ap}return __extends$h(_d,rp),_d}(Error);(function(rp){function _d(np){var ap=rp.call(this,np)||this;return Object.setPrototypeOf(ap,_d.prototype),ap}return __extends$h(_d,rp),_d})(Error);function pyListRepeat(rp,_d){if(Array.isArray(rp)){for(var np=[],ap=0;ap<_d;ap++)np=np.concat(rp);return np}return(np=new Array(_d)).fill(rp),np}function assert(rp,_d){if(!rp)throw new AssertionError(_d)}function count(rp,_d){for(var np=0,ap=0,sp=rp;ap<sp.length;ap++)sp[ap]===_d&&np++;return np}function singletonOrArray(rp){return rp.length===1?rp[0]:rp}function toList(rp){return Array.isArray(rp)?rp:[rp]}function toSnakeCase(rp){var _d=rp.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return _d[0]!=="_"?_d:"private"+_d}function toCamelCase$1(rp){return rp.length<=1||rp.indexOf("_")===-1?rp:rp.replace(/[_]+(\w|$)/g,function(_d,np){return np.toUpperCase()})}var _GLOBAL_CUSTOM_OBJECTS={};function serializeKerasObject(rp){if(rp==null)return null;var _d={};return _d.className=rp.getClassName(),_d.config=rp.getConfig(),_d}function convertNDArrayScalarsInConfig(rp){if(rp!=null&&typeof rp=="object")if(Array.isArray(rp))rp.forEach(function(lp){return convertNDArrayScalarsInConfig(lp)});else for(var _d=0,np=Object.keys(rp);_d<np.length;_d++){var ap=np[_d],sp=rp[ap];sp!=null&&typeof sp=="object"&&(Array.isArray(sp)||sp.type!=="ndarray"||typeof sp.value!="number"?convertNDArrayScalarsInConfig(sp):rp[ap]=sp.value)}}function deserializeKerasObject(rp,_d,np,ap,sp){var lp,up,cp;if(_d===void 0&&(_d={}),np===void 0&&(np={}),ap===void 0&&(ap="object"),sp===void 0&&(sp=!1),typeof rp=="string"){var dp=rp,hp=void 0;if(dp in np)hp=np[dp];else if(dp in _GLOBAL_CUSTOM_OBJECTS)hp=_GLOBAL_CUSTOM_OBJECTS[dp];else if((hp=_d[dp])==null)throw new ValueError("Unknown "+ap+": "+rp+`. This may be due to one of the following reasons:
1. The `+ap+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+ap+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return hp}var fp=rp;if(fp.className==null||fp.config==null)throw new ValueError(ap+": Improper config format: "+JSON.stringify(fp)+`.
'className' and 'config' must set.`);var pp=fp.className,mp=void 0,gp=void 0;if(pp in np?(mp=(lp=np[pp])[0],gp=lp[1]):pp in _GLOBAL_CUSTOM_OBJECTS?(mp=(up=_GLOBAL_CUSTOM_OBJECTS.className)[0],gp=up[1]):pp in _d&&(mp=(cp=_d[pp])[0],gp=cp[1]),mp==null)throw new ValueError("Unknown "+ap+": "+pp+`. This may be due to one of the following reasons:
1. The `+ap+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+ap+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(gp!=null){for(var yp={},xp=0,_p=Object.keys(_GLOBAL_CUSTOM_OBJECTS);xp<_p.length;xp++)yp[Rp=_p[xp]]=_GLOBAL_CUSTOM_OBJECTS[Rp];for(var vp=0,bp=Object.keys(np);vp<bp.length;vp++)yp[Rp=bp[vp]]=np[Rp];fp.config.customObjects=yp;for(var Ep=__assign$2({},_GLOBAL_CUSTOM_OBJECTS),Sp=0,Ap=Object.keys(np);Sp<Ap.length;Sp++){var Rp=Ap[Sp];_GLOBAL_CUSTOM_OBJECTS[Rp]=np[Rp]}convertNDArrayScalarsInConfig(fp.config);var Tp=gp(mp,fp.config,np,sp);return _GLOBAL_CUSTOM_OBJECTS=__assign$2({},Ep),Tp}Ep=__assign$2({},_GLOBAL_CUSTOM_OBJECTS);for(var Mp=0,Op=Object.keys(np);Mp<Op.length;Mp++)Rp=Op[Mp],_GLOBAL_CUSTOM_OBJECTS[Rp]=np[Rp];return Tp=new mp(fp.config),_GLOBAL_CUSTOM_OBJECTS=__assign$2({},Ep),Tp}function numberCompare(rp,_d){return rp<_d?-1:rp>_d?1:0}function reverseNumberCompare(rp,_d){return-1*numberCompare(rp,_d)}function unique(rp){if(rp==null)return rp;for(var _d=[],np=0,ap=rp;np<ap.length;np++){var sp=ap[np];_d.indexOf(sp)===-1&&_d.push(sp)}return _d}function isObjectEmpty(rp){if(rp==null)throw new ValueError("Invalid value in obj: "+JSON.stringify(rp));for(var _d in rp)if(rp.hasOwnProperty(_d))return!1;return!0}function checkStringTypeUnionValue(rp,_d,np){if(np!=null&&rp.indexOf(np)<0)throw new ValueError(np+" is not a valid "+_d+".  Valid values are "+rp+" or null/undefined.")}function checkArrayTypeAndLength(rp,_d,np,ap){return np===void 0&&(np=0),ap===void 0&&(ap=1/0),assert(np>=0),assert(ap>=np),Array.isArray(rp)&&rp.length>=np&&rp.length<=ap&&rp.every(function(sp){return typeof sp===_d})}function assertPositiveInteger(rp,_d){Array.isArray(rp)?(tt.assert(rp.length>0,function(){return _d+" is unexpectedly an empty array."}),rp.forEach(function(np,ap){return assertPositiveInteger(np,"element "+(ap+1)+" of "+_d)})):tt.assert(Number.isInteger(rp)&&rp>0,function(){return"Expected "+_d+" to be a positive integer, but got "+formatAsFriendlyString(rp)+"."})}function formatAsFriendlyString(rp){return rp===null?"null":Array.isArray(rp)?"["+rp.map(function(_d){return formatAsFriendlyString(_d)}).join(",")+"]":typeof rp=="string"?'"'+rp+'"':""+rp}function debounce$1(rp,_d){var np,ap=tt.now();return function(){for(var sp=[],lp=0;lp<arguments.length;lp++)sp[lp]=arguments[lp];var up=tt.now();return up-ap<_d?np:(ap=up,np=rp.apply(void 0,sp))}}function mapActivationToFusedKernel(rp){return rp==="relu"?"relu":rp==="linear"?"linear":rp==="elu"?"elu":null}function calcL2Norms(rp,_d){return je(function(){return gs(vl(ec(rp,rp),_d,!0))})}var Constraint=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.getConfig=function(){return{}},_d}(Mf.Serializable),MaxNorm=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.defaultMaxValue=2,ap.defaultAxis=0,ap.maxValue=np.maxValue!=null?np.maxValue:ap.defaultMaxValue,ap.axis=np.axis!=null?np.axis:ap.defaultAxis,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np){var ap=this;return je(function(){var sp=calcL2Norms(np,ap.axis),lp=$u(sp,0,ap.maxValue);return tc(np,qs(lp,Vs(epsilon(),sp)))})},_d.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},_d.className="MaxNorm",_d}(Constraint);Mf.registerClass(MaxNorm);var UnitNorm=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.defaultAxis=0,ap.axis=np.axis!=null?np.axis:ap.defaultAxis,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np){var ap=this;return je(function(){return qs(np,Vs(epsilon(),calcL2Norms(np,ap.axis)))})},_d.prototype.getConfig=function(){return{axis:this.axis}},_d.className="UnitNorm",_d}(Constraint);Mf.registerClass(UnitNorm);var NonNeg=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return bl(np)},_d.className="NonNeg",_d}(Constraint);Mf.registerClass(NonNeg);var MinMaxNorm=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.defaultMinValue=0,ap.defaultMaxValue=1,ap.defaultRate=1,ap.defaultAxis=0,ap.minValue=np.minValue!=null?np.minValue:ap.defaultMinValue,ap.maxValue=np.maxValue!=null?np.maxValue:ap.defaultMaxValue,ap.rate=np.rate!=null?np.rate:ap.defaultRate,ap.axis=np.axis!=null?np.axis:ap.defaultAxis,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np){var ap=this;return je(function(){var sp=calcL2Norms(np,ap.axis),lp=Vs(tc(ap.rate,$u(sp,ap.minValue,ap.maxValue)),tc(1-ap.rate,sp));return tc(np,qs(lp,Vs(epsilon(),sp)))})},_d.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},_d.className="MinMaxNorm",_d}(Constraint);Mf.registerClass(MinMaxNorm);var CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function serializeConstraint(rp){return serializeKerasObject(rp)}function deserializeConstraint(rp,_d){return _d===void 0&&(_d={}),deserializeKerasObject(rp,Mf.SerializationMap.getMap().classNameMap,_d,"constraint")}function getConstraint(rp){return rp==null?null:typeof rp=="string"?deserializeConstraint({className:rp in CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP?CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP[rp]:rp,config:{}}):rp instanceof Constraint?rp:deserializeConstraint(rp)}function maxNorm(rp){return new MaxNorm(rp)}function unitNorm(rp){return new UnitNorm(rp)}function nonNeg(){return new NonNeg}function minMaxNorm(rp){return new MinMaxNorm(rp)}var exports_constraints=Object.freeze({maxNorm,unitNorm,nonNeg,minMaxNorm}),VALID_DATA_FORMAT_VALUES=["channelsFirst","channelsLast"],VALID_PADDING_MODE_VALUES=["valid","same","causal"],VALID_POOL_MODE_VALUES=["max","avg"],VALID_BIDIRECTIONAL_MERGE_MODES=["sum","mul","concat","ave"],nameMap=new Map;function checkDataFormat(rp){checkStringTypeUnionValue(VALID_DATA_FORMAT_VALUES,"DataFormat",rp)}function checkPaddingMode(rp){checkStringTypeUnionValue(VALID_PADDING_MODE_VALUES,"PaddingMode",rp)}function checkPoolMode(rp){checkStringTypeUnionValue(VALID_POOL_MODE_VALUES,"PoolMode",rp)}var _nameScopeStack=[],_nameScopeDivider="/";function nameScope(rp,_d){_nameScopeStack.push(rp);try{var np=_d();return _nameScopeStack.pop(),np}catch(ap){throw _nameScopeStack.pop(),ap}}function currentNameScopePrefix(){return _nameScopeStack.length===0?"":_nameScopeStack.join(_nameScopeDivider)+_nameScopeDivider}function getScopedTensorName(rp){if(!isValidTensorName(rp))throw new Error("Not a valid tensor name: '"+rp+"'");return currentNameScopePrefix()+rp}function getUniqueTensorName(rp){if(!isValidTensorName(rp))throw new Error("Not a valid tensor name: '"+rp+"'");nameMap.has(rp)||nameMap.set(rp,0);var _d=nameMap.get(rp);if(nameMap.set(rp,nameMap.get(rp)+1),_d>0){var np=rp+"_"+_d;return nameMap.set(np,1),np}return rp}var tensorNameRegex=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function isValidTensorName(rp){return!!rp.match(tensorNameRegex)}function isInteger(rp){return rp===parseInt(rp.toString(),10)}function arrayProd(rp,_d,np){_d==null&&(_d=0),np==null&&(np=rp.length);for(var ap=1,sp=_d;sp<np;++sp)ap*=rp[sp];return ap}function toArray1D(rp){return rp=Array.isArray(rp)?new Float32Array(rp):rp,Dn(rp)}function min$1$1(rp){return pl(toArray1D(rp)).dataSync()[0]}function max$1(rp){return hl(toArray1D(rp)).dataSync()[0]}function range(rp,_d){if(_d<rp)throw new ValueError("end ("+_d+") < begin ("+rp+") is forbidden.");for(var np=[],ap=rp;ap<_d;++ap)np.push(ap);return np}function cast$1(rp,_d){return rp.asType(_d)}function expandDims$1(rp,_d){_d===void 0&&(_d=-1);var np=rp.shape.slice();return _d<0&&(_d=np.length+_d+1),np.splice(_d,0,1),rp.reshape(np)}function repeat(rp,_d){return je(function(){if(rp.shape.length!==2)throw new ValueError("repeat() expects a rank-2 tensor, but received a rank-"+rp.shape.length+" tensor.");return tile$1(expandDims$1(rp,1),[1,_d,1])})}function flatten$1(rp){var _d=[arrayProd(rp.shape)];return rp.reshape(_d)}function batchFlatten(rp){if(rp.rank<=1)throw new ValueError("batchFlatten requires a minimum rank of 2. Got rank: "+rp.rank+".");var _d=[rp.shape[0],arrayProd(rp.shape,1)];return rp.reshape(_d)}function sliceAlongFirstAxis(rp,_d,np){return je(function(){switch(rp.rank){case 1:return el(rp,_d,np);case 2:return nl(rp,[_d,0],[np,rp.shape[1]]);case 3:return rl(rp,[_d,0,0],[np,rp.shape[1],rp.shape[2]]);case 4:return ol(rp,[_d,0,0,0],[np,rp.shape[1],rp.shape[2],rp.shape[3]]);case 5:return tl(rp,[_d,0,0,0,0],[np,rp.shape[1],rp.shape[2],rp.shape[3],rp.shape[4]]);case 6:return tl(rp,[_d,0,0,0,0,0],[np,rp.shape[1],rp.shape[2],rp.shape[3],rp.shape[4],rp.shape[5]]);default:throw new ValueError("sliceAlongFirstAxis() received an unsupported tensor rank: "+rp.rank)}})}function sliceAlongLastAxis(rp,_d,np){return je(function(){switch(rp.rank){case 1:return el(rp,_d,np);case 2:return nl(rp,[0,_d],[rp.shape[0],np]);case 3:return rl(rp,[0,0,_d],[rp.shape[0],rp.shape[1],np]);case 4:return ol(rp,[0,0,0,_d],[rp.shape[0],rp.shape[1],rp.shape[2],np]);default:throw new ValueError("sliceAlongLastAxis() received an unsupported tensor rank: "+rp.rank)}})}function sliceAlongAxis(rp,_d,np,ap){return je(function(){switch(rp.rank){case 1:return el(rp,_d,np);case 2:switch(ap){case 1:return sliceAlongFirstAxis(rp,_d,np);case 2:return sliceAlongLastAxis(rp,_d,np);default:throw new ValueError("The axis is not within the rank of the tensor "+ap)}case 3:switch(ap){case 1:return sliceAlongFirstAxis(rp,_d,np);case 2:return rl(rp,[0,_d,0],[rp.shape[0],np,rp.shape[2]]);case 3:return sliceAlongLastAxis(rp,_d,np);default:throw new ValueError("The axis is not within the rank of the tensor "+ap)}case 4:switch(ap){case 1:return sliceAlongFirstAxis(rp,_d,np);case 2:return ol(rp,[0,_d,0,0],[rp.shape[0],np,rp.shape[2],rp.shape[3]]);case 3:return ol(rp,[0,0,_d,0],[rp.shape[0],rp.shape[1],np,rp.shape[3]]);case 4:return sliceAlongLastAxis(rp,_d,np);default:throw new ValueError("The axis is not within the rank of the tensor "+ap)}default:throw new ValueError("sliceAlongLastAxis() received an unsupported tensor rank: "+rp.rank)}})}function concatenate(rp,_d){var np;return _d===void 0&&(_d=-1),_d<0&&(_d=(np=rp[0].rank)!==0?np:0),_d===rp[0].rank&&(_d=-1),Gn(rp,_d)}function concatAlongFirstAxis(rp,_d){switch(rp.rank){case 1:return Hn([rp,_d]);case 2:return qn([rp,_d],0);case 3:return Kn([rp,_d],0);case 4:return jn([rp,_d],0);default:throw new ValueError("concatAlongFirstAxis() received an unsupported tensor rank: "+rp.rank)}}function tile$1(rp,_d){if(Array.isArray(_d)||(_d=[_d]),rp.rank!==_d.length)throw new ValueError("The length of input n ("+_d.length+") does not match the number of dimensions in input x ("+rp.rank+")");return Nr(rp,_d)}function randomNormal$1(rp,_d,np,ap,sp){return _d===void 0&&(_d=0),np===void 0&&(np=1),Rr(rp,_d,np,ap,sp)}function dot(rp,_d,np,ap){if(rp.rank<2||_d.rank<2)throw new NotImplementedError("dot requires both inputs to be rank >= 2 but got x shape = "+rp.shape+" and y shape = "+_d.shape);if(_d.rank>=3&&rp.shape.slice(-1)[0]!==(fp=_d.shape.slice(-2)[0]))throw new NotImplementedError("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+rp.shape+" and  y shape = "+_d.shape);if(rp.rank===2&&_d.rank===2){var sp=!1,lp=!1;return Eh.matMul({a:rp,b:_d,transposeA:sp,transposeB:lp,bias:ap?reshapeBias(rp.rank,ap,imageDataFormat()):null,activation:np})}var up=rp.shape.slice(),cp=up.pop();rp=rp.reshape([-1,cp]);var dp=_d.shape.slice(),hp=dp.pop(),fp=dp.pop(),pp=dp.concat([hp]),mp=Array.from({length:_d.rank},function(yp,xp){return xp===0?_d.rank-2:xp<=_d.rank-2?xp-1:xp});_d=_d.transpose(mp).reshape([fp,-1]);var gp=up.concat(pp);return sp=!1,lp=!1,Eh.matMul({a:rp,b:_d,transposeA:sp,transposeB:lp,bias:ap?reshapeBias(rp.rank,ap,imageDataFormat()):null,activation:np}).reshape(gp)}function gather$1(rp,_d,np){return je(function(){return _d=Array.isArray(_d)?Dn(_d,"int32"):_d.toInt(),Cc(rp,_d,np)})}function square(rp){return ec(rp,rp)}function reshapeBias(rp,_d,np){var ap=_d.shape;if(_d.rank!==1&&_d.rank!==rp)throw new ValueError("Unexpected bias dimensions: "+_d.rank+"; expected it to be 1 or "+rp);if(rp===5){if(np==="channelsFirst")return ap.length===1?_d.reshape([1,ap[0],1,1,1]):_d.reshape([1,ap[3],ap[0],ap[1],ap[2]]);if(np==="channelsLast")return ap.length===1?_d.reshape([1,1,1,1,ap[0]]):_d.reshape([1].concat(ap))}else if(rp===4){if(np==="channelsFirst")return ap.length===1?_d.reshape([1,ap[0],1,1]):_d.reshape([1,ap[2],ap[0],ap[1]]);if(np==="channelsLast")return ap.length===1?_d.reshape([1,1,1,ap[0]]):_d.reshape([1].concat(ap))}else if(rp===3){if(np==="channelsFirst")return ap.length===1?_d.reshape([1,ap[0],1]):_d.reshape([1,ap[1],ap[0]]);if(np==="channelsLast")return ap.length===1?_d.reshape([1,1,ap[0]]):_d.reshape([1].concat(ap))}else if(rp<3)return _d;throw new ValueError("Unsupported input rank by biasAdd: "+_d.rank)}function biasAdd(rp,_d,np){return je(function(){return np==null&&(np=imageDataFormat()),checkDataFormat(np),rp.add(reshapeBias(rp.rank,_d,np))})}function elu$1(rp,_d){if(_d===void 0&&(_d=1),_d!==1)throw new NotImplementedError("Support for alpha values other than 1 ("+_d+") is not implemented yet.");return gl(rp)}function softsign(rp){return je(function(){return qs(rp,Vu(rp).add(1))})}function dropout$1(rp,_d,np,ap){return je(function(){return Ul(rp,_d,np,ap)})}function hardSigmoid(rp){return je(function(){var _d=Vs(.5,tc(.2,rp));return $u(_d,0,1)})}function inTrainPhase(rp,_d,np){return np===void 0&&(np=!1),np?rp():_d()}var VALID_FAN_MODE_VALUES=["fanIn","fanOut","fanAvg"],VALID_DISTRIBUTION_VALUES=["normal","uniform","truncatedNormal"];function checkFanMode(rp){checkStringTypeUnionValue(VALID_FAN_MODE_VALUES,"FanMode",rp)}function checkDistribution(rp){checkStringTypeUnionValue(VALID_DISTRIBUTION_VALUES,"Distribution",rp)}var Initializer=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.fromConfigUsesCustomObjects=function(){return!1},_d.prototype.getConfig=function(){return{}},_d}(Mf.Serializable),Zeros=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){return Pn(np,ap)},_d.className="Zeros",_d}(Initializer);Mf.registerClass(Zeros);var Ones=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){return Bn(np,ap)},_d.className="Ones",_d}(Initializer);Mf.registerClass(Ones);var Constant=function(rp){function _d(np){var ap=rp.call(this)||this;if(typeof np!="object")throw new ValueError("Expected argument of type ConstantConfig but got "+np);if(np.value===void 0)throw new ValueError("config must have value set but got "+np);return ap.value=np.value,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){var sp=this;return je(function(){return tc(An(sp.value),Bn(np,ap))})},_d.prototype.getConfig=function(){return{value:this.value}},_d.className="Constant",_d}(Initializer);Mf.registerClass(Constant);var RandomUniform=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.DEFAULT_MINVAL=-.05,ap.DEFAULT_MAXVAL=.05,ap.minval=np.minval||ap.DEFAULT_MINVAL,ap.maxval=np.maxval||ap.DEFAULT_MAXVAL,ap.seed=np.seed,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){return kr(np,this.minval,this.maxval,ap)},_d.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},_d.className="RandomUniform",_d}(Initializer);Mf.registerClass(RandomUniform);var RandomNormal=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.DEFAULT_MEAN=0,ap.DEFAULT_STDDEV=.05,ap.mean=np.mean||ap.DEFAULT_MEAN,ap.stddev=np.stddev||ap.DEFAULT_STDDEV,ap.seed=np.seed,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){if((ap=ap||"float32")!=="float32"&&ap!=="int32")throw new NotImplementedError("randomNormal does not support dType "+ap+".");return randomNormal$1(np,this.mean,this.stddev,ap,this.seed)},_d.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},_d.className="RandomNormal",_d}(Initializer);Mf.registerClass(RandomNormal);var TruncatedNormal=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.DEFAULT_MEAN=0,ap.DEFAULT_STDDEV=.05,ap.mean=np.mean||ap.DEFAULT_MEAN,ap.stddev=np.stddev||ap.DEFAULT_STDDEV,ap.seed=np.seed,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){if((ap=ap||"float32")!=="float32"&&ap!=="int32")throw new NotImplementedError("truncatedNormal does not support dType "+ap+".");return Fr(np,this.mean,this.stddev,ap,this.seed)},_d.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},_d.className="TruncatedNormal",_d}(Initializer);Mf.registerClass(TruncatedNormal);var Identity=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.gain=np.gain!=null?np.gain:1,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){var sp=this;return je(function(){if(np.length!==2||np[0]!==np[1])throw new ValueError("Identity matrix initializer can only be used for 2D square matrices.");return tc(sp.gain,vr(np[0]))})},_d.prototype.getConfig=function(){return{gain:this.gain}},_d.className="Identity",_d}(Initializer);function computeFans(rp,_d){var np,ap;if(_d===void 0&&(_d="channelsLast"),checkDataFormat(_d),rp.length===2)np=rp[0],ap=rp[1];else if([3,4,5].indexOf(rp.length)!==-1)if(_d==="channelsFirst"){var sp=arrayProd(rp,2);np=rp[1]*sp,ap=rp[0]*sp}else _d==="channelsLast"&&(sp=arrayProd(rp,0,rp.length-2),np=rp[rp.length-2]*sp,ap=rp[rp.length-1]*sp);else{var lp=arrayProd(rp);np=Math.sqrt(lp),ap=Math.sqrt(lp)}return[np,ap]}Mf.registerClass(Identity);var VarianceScaling=function(rp){function _d(np){var ap=rp.call(this)||this;if(np.scale<0)throw new ValueError("scale must be a positive float. Got: "+np.scale);return ap.scale=np.scale==null?1:np.scale,ap.mode=np.mode==null?"fanIn":np.mode,checkFanMode(ap.mode),ap.distribution=np.distribution==null?"normal":np.distribution,checkDistribution(ap.distribution),ap.seed=np.seed,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){var sp=computeFans(np),lp=sp[0],up=sp[1],cp=this.scale;if(this.mode==="fanIn"?cp/=Math.max(1,lp):this.mode==="fanOut"?cp/=Math.max(1,up):cp/=Math.max(1,(lp+up)/2),this.distribution==="normal"){var dp=Math.sqrt(cp);if((ap=ap||"float32")!=="float32"&&ap!=="int32")throw new NotImplementedError(this.getClassName()+" does not support dType "+ap+".");return Fr(np,0,dp,ap,this.seed)}var hp=Math.sqrt(3*cp);return kr(np,-hp,hp,ap)},_d.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},_d.className="VarianceScaling",_d}(Initializer);Mf.registerClass(VarianceScaling);var GlorotUniform=function(rp){function _d(np){return rp.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:np==null?null:np.seed})||this}return __extends$h(_d,rp),_d.prototype.getClassName=function(){return VarianceScaling.className},_d.className="GlorotUniform",_d}(VarianceScaling);Mf.registerClass(GlorotUniform);var GlorotNormal=function(rp){function _d(np){return rp.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:np==null?null:np.seed})||this}return __extends$h(_d,rp),_d.prototype.getClassName=function(){return VarianceScaling.className},_d.className="GlorotNormal",_d}(VarianceScaling);Mf.registerClass(GlorotNormal);var HeNormal=function(rp){function _d(np){return rp.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:np==null?null:np.seed})||this}return __extends$h(_d,rp),_d.prototype.getClassName=function(){return VarianceScaling.className},_d.className="HeNormal",_d}(VarianceScaling);Mf.registerClass(HeNormal);var HeUniform=function(rp){function _d(np){return rp.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:np==null?null:np.seed})||this}return __extends$h(_d,rp),_d.prototype.getClassName=function(){return VarianceScaling.className},_d.className="HeUniform",_d}(VarianceScaling);Mf.registerClass(HeUniform);var LeCunNormal=function(rp){function _d(np){return rp.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:np==null?null:np.seed})||this}return __extends$h(_d,rp),_d.prototype.getClassName=function(){return VarianceScaling.className},_d.className="LeCunNormal",_d}(VarianceScaling);Mf.registerClass(LeCunNormal);var LeCunUniform=function(rp){function _d(np){return rp.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:np==null?null:np.seed})||this}return __extends$h(_d,rp),_d.prototype.getClassName=function(){return VarianceScaling.className},_d.className="LeCunNormal",_d}(VarianceScaling);Mf.registerClass(LeCunUniform);var Orthogonal=function(rp){function _d(np){var ap=rp.call(this)||this;if(ap.DEFAULT_GAIN=1,ap.gain=np.gain==null?ap.DEFAULT_GAIN:np.gain,ap.seed=np.seed,ap.seed!=null)throw new NotImplementedError("Random seed is not implemented for Orthogonal Initializer yet.");return ap}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){var sp=this;return je(function(){if(np.length!==2)throw new NotImplementedError("The Orthogonal Initializer does not support non-2D shapes yet.");np[0]*np[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+np[0]*np[1]+") elements: Slowness may result.");var lp=randomNormal$1(np[0]>np[1]?[np[1],np[0]]:np,0,1,"float32"),up=sh.gramSchmidt(lp);return np[0]>np[1]&&(up=up.transpose()),tc(sp.gain,up)})},_d.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},_d.className="Orthogonal",_d}(Initializer);Mf.registerClass(Orthogonal);var INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function deserializeInitializer(rp,_d){return _d===void 0&&(_d={}),deserializeKerasObject(rp,Mf.SerializationMap.getMap().classNameMap,_d,"initializer")}function serializeInitializer(rp){return serializeKerasObject(rp)}function getInitializer(rp){if(typeof rp=="string"){var _d=rp in INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP?INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP[rp]:rp;if(_d==="GlorotNormal")return new GlorotNormal;if(_d==="GlorotUniform")return new GlorotUniform;if(_d==="HeNormal")return new HeNormal;if(_d==="HeUniform")return new HeUniform;if(_d==="LeCunNormal")return new LeCunNormal;if(_d==="LeCunUniform")return new LeCunUniform;var np={};return np.className=_d,np.config={},deserializeInitializer(np)}return rp instanceof Initializer?rp:deserializeInitializer(rp)}function zeros$1(){return new Zeros}function ones$1(){return new Ones}function constant(rp){return new Constant(rp)}function randomUniform$1(rp){return new RandomUniform(rp)}function randomNormal$2(rp){return new RandomNormal(rp)}function truncatedNormal$1(rp){return new TruncatedNormal(rp)}function identity(rp){return new Identity(rp)}function varianceScaling(rp){return new VarianceScaling(rp)}function glorotUniform(rp){return new GlorotUniform(rp)}function glorotNormal(rp){return new GlorotNormal(rp)}function heNormal(rp){return new HeNormal(rp)}function heUniform(rp){return new HeUniform(rp)}function leCunNormal(rp){return new LeCunNormal(rp)}function leCunUniform(rp){return new LeCunUniform(rp)}function orthogonal(rp){return new Orthogonal(rp)}var exports_initializers=Object.freeze({zeros:zeros$1,ones:ones$1,constant,randomUniform:randomUniform$1,randomNormal:randomNormal$2,truncatedNormal:truncatedNormal$1,identity,varianceScaling,glorotUniform,glorotNormal,heNormal,heUniform,leCunNormal,leCunUniform,orthogonal}),_nextUniqueTensorId=0;function getNextUniqueTensorId(){return _nextUniqueTensorId++}var _uidPrefixes={};function getUid(rp){return rp===void 0&&(rp=""),rp in _uidPrefixes||(_uidPrefixes[rp]=0),_uidPrefixes[rp]+=1,rp+_uidPrefixes[rp].toString()}function isArrayOfShapes(rp){return Array.isArray(rp)&&Array.isArray(rp[0])}function normalizeShapeList(rp){return rp.length===0?[]:Array.isArray(rp[0])?rp:[rp]}function getExactlyOneTensor(rp){var _d;if(Array.isArray(rp)){if(rp.length!==1)throw new ValueError("Expected Tensor length to be 1; got "+rp.length);_d=rp[0]}else _d=rp;return _d}function getExactlyOneShape(rp){if(Array.isArray(rp)&&Array.isArray(rp[0])){if(rp.length===1)return(rp=rp)[0];throw new ValueError("Expected exactly 1 Shape; got "+rp.length)}return rp}function countParamsInWeights(rp){for(var _d=0,np=0,ap=rp;np<ap.length;np++){var sp=ap[np];sp.shape.length===0?_d+=1:_d+=sp.shape.reduce(function(lp,up){return lp*up})}return _d}var DEFAULT_VARIABLE_NAME_PREFIX="Variable",LayerVariable=function(){function rp(_d,np,ap,sp,lp){np===void 0&&(np="float32"),ap===void 0&&(ap=DEFAULT_VARIABLE_NAME_PREFIX),sp===void 0&&(sp=!0),lp===void 0&&(lp=null),this.dtype=np??"float32",this.shape=_d.shape,this.id=getNextUniqueTensorId(),ap=ap??DEFAULT_VARIABLE_NAME_PREFIX,this.originalName=getScopedTensorName(ap),this.name=getUniqueTensorName(this.originalName),this.trainable_=sp,this.constraint=lp,this.val=Mn(_d,this.trainable_,this.name,this.dtype)}return rp.prototype.read=function(){return this.assertNotDisposed(),this.val},rp.prototype.write=function(_d){return this.assertNotDisposed(),checkShapesMatch(this.val,_d),this.val.id!==_d.id&&(this.val.assign(_d),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},rp.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},rp.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(rp.prototype,"trainable",{get:function(){return this.trainable_},set:function(_d){this.trainable_=_d,this.val.trainable=_d},enumerable:!0,configurable:!0}),rp}();function checkShapesMatch(rp,_d){if(rp.shape.toString()!==_d.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(rp.shape)+" vs. "+JSON.stringify(_d.shape))}function batchGetValue(rp){return rp.map(function(_d){return _d.read()})}function batchSetValue(rp){rp.forEach(function(_d){_d[0].write(_d[1])})}var InputSpec=function(){return function(rp){this.dtype=rp.dtype,this.shape=rp.shape,rp.shape!=null?this.ndim=rp.shape.length:this.ndim=rp.ndim,this.maxNDim=rp.maxNDim,this.minNDim=rp.minNDim,this.axes=rp.axes||{}}}(),SymbolicTensor=function(){return function(rp,_d,np,ap,sp,lp,up){this.dtype=rp,this.shape=_d,this.sourceLayer=np,this.inputs=ap,this.callArgs=sp,this.outputTensorIndex=up,this.id=getNextUniqueTensorId(),lp!=null&&(this.originalName=getScopedTensorName(lp),this.name=getUniqueTensorName(this.originalName)),this.rank=_d.length}}(),_nextNodeID=0,Node$1=function(){function rp(_d,np){this.callArgs=np,this.id=_nextNodeID++,this.outboundLayer=_d.outboundLayer,this.inboundLayers=_d.inboundLayers,this.nodeIndices=_d.nodeIndices,this.tensorIndices=_d.tensorIndices,this.inputTensors=_d.inputTensors,this.outputTensors=_d.outputTensors,this.inputMasks=_d.inputMasks,this.outputMasks=_d.outputMasks,this.inputShapes=_d.inputShapes,this.outputShapes=_d.outputShapes;for(var ap=0,sp=_d.inboundLayers;ap<sp.length;ap++){var lp=sp[ap];lp!=null&&lp.outboundNodes.push(this)}_d.outboundLayer.inboundNodes.push(this)}return rp.prototype.getConfig=function(){for(var _d=[],np=0,ap=this.inboundLayers;np<ap.length;np++){var sp=ap[np];sp!=null?_d.push(sp.name):_d.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:_d,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},rp}(),_nextLayerID=0,Layer=function(rp){function _d(np){var ap=rp.call(this)||this;ap._callHook=null,ap._addedWeightNames=[],ap._stateful=!1,ap.id=_nextLayerID++,ap.activityRegularizer=null,ap.inputSpec=null,ap.supportsMasking=!1,ap._trainableWeights=[],ap._nonTrainableWeights=[],ap._losses=[],ap._updates=[],ap._built=!1,ap.inboundNodes=[],ap.outboundNodes=[];var sp=np.name;if(!sp){var lp=ap.getClassName();sp=toSnakeCase(lp)+"_"+getUid(lp)}if(ap.name=sp,ap.trainable_=np.trainable==null||np.trainable,np.inputShape!=null||np.batchInputShape!=null){var up=void 0;if(np.batchInputShape!=null)up=np.batchInputShape;else if(np.inputShape!=null){var cp=null;np.batchSize!=null&&(cp=np.batchSize),up=[cp].concat(np.inputShape)}ap.batchInputShape=up;var dp=np.dtype;dp==null&&(dp=np.inputDType),dp==null&&(dp="float32"),ap.dtype=dp}return np.weights!=null?ap.initialWeights=np.weights:ap.initialWeights=null,ap._refCount=null,ap.fastWeightInitDuringBuild=!1,ap}return __extends$h(_d,rp),_d.nodeKey=function(np,ap){return np.name+"_ib-"+ap.toString()},_d.prototype.getNodeAtIndex=function(np,ap){if(this.inboundNodes.length===0)throw new RuntimeError("The layer has never been called and thus has no defined "+ap+".");if(this.inboundNodes.length<=np)throw new ValueError("Asked to get "+ap+" at node "+np+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[np]},_d.prototype.getInputAt=function(np){return singletonOrArray(this.getNodeAtIndex(np,"input").inputTensors)},_d.prototype.getOutputAt=function(np){return singletonOrArray(this.getNodeAtIndex(np,"output").outputTensors)},Object.defineProperty(_d.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new AttributeError("Layer "+this.name+" is not connected, no input to return.");return singletonOrArray(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new AttributeError("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return singletonOrArray(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),_d.prototype.calculateLosses=function(){return this.losses.map(function(np){return np()})},Object.defineProperty(_d.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"built",{get:function(){return this._built},set:function(np){this._built=np},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"trainable",{get:function(){return this.trainable_},set:function(np){this._trainableWeights.forEach(function(ap){return ap.trainable=np}),this.trainable_=np},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(np){return np.trainable}):[]},set:function(np){this._trainableWeights=np},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(np){return!np.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(np){this._nonTrainableWeights=np},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),_d.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},_d.prototype.assertInputCompatibility=function(np){if(np=toList(np),this.inputSpec!=null&&this.inputSpec.length!==0){var ap=toList(this.inputSpec);if(np.length!==ap.length)throw new ValueError("Layer "+this.name+" expects "+ap.length+" inputs, but it received "+np.length+" input tensors. Input received: "+np);for(var sp=0;sp<np.length;sp++){var lp=np[sp],up=ap[sp];if(up!=null){var cp=lp.rank;if(up.ndim!=null&&cp!==up.ndim)throw new ValueError("Input "+sp+" is incompatible with layer "+this.name+": expected ndim="+up.ndim+", found ndim="+cp);if(up.maxNDim!=null&&cp>up.maxNDim)throw new ValueError("Input "+sp+" is incompatible with layer "+this.name+": expected max_ndim="+up.maxNDim+", found ndim="+cp);if(up.minNDim!=null&&cp<up.minNDim)throw new ValueError("Input "+sp+" is incompatible with layer "+this.name+": expected min_ndim="+up.minNDim+", found ndim="+cp+".");if(up.dtype!=null&&lp.dtype!==up.dtype)throw new ValueError("Input "+sp+" is incompatible with layer "+this.name+" : expected dtype="+up.dtype+", found dtype="+lp.dtype+".");if(up.axes){var dp=lp.shape;for(var hp in up.axes){var fp=Number(hp),pp=up.axes[hp],mp=fp>=0?dp[fp]:dp[dp.length+fp];if(pp!=null&&[pp,null].indexOf(mp)===-1)throw new ValueError("Input "+sp+" is incompatible with layer "+this.name+": expected axis "+fp+" of input shape to have value "+pp+" but got shape "+dp+".")}}if(up.shape!=null)for(var gp=0;gp<up.shape.length;++gp){var yp=up.shape[gp],xp=lp.shape[gp];if(yp!=null&&xp!=null&&yp!==xp)throw new ValueError("Input "+sp+" is incompatible with layer "+this.name+": expected shape="+up.shape+", found shape="+lp.shape+".")}}}}},_d.prototype.call=function(np,ap){return np},_d.prototype.invokeCallHook=function(np,ap){this._callHook!=null&&this._callHook(np,ap)},_d.prototype.setCallHook=function(np){this._callHook=np},_d.prototype.clearCallHook=function(){this._callHook=null},_d.prototype.apply=function(np,ap){var sp=this;ap=ap||{},this.assertNotDisposed();for(var lp=toList(np),up=!0,cp=0,dp=lp;cp<dp.length;cp++)if(!(dp[cp]instanceof SymbolicTensor)){up=!1;break}for(var hp=!0,fp=0,pp=lp;fp<pp.length;fp++)if(pp[fp]instanceof SymbolicTensor){hp=!1;break}if(up===hp)throw new ValueError("Arguments to apply() must be all SymbolicTensors or all Tensors");return nameScope(this.name,function(){if(!sp.built){sp.assertInputCompatibility(np);for(var mp=[],gp=0,yp=toList(np);gp<yp.length;gp++){var xp=yp[gp];mp.push(xp.shape)}sp.build(singletonOrArray(mp)),sp.built=!0,sp.initialWeights&&sp.setWeights(sp.initialWeights),sp._refCount===null&&hp&&(sp._refCount=1)}if(sp.assertInputCompatibility(np),hp){for(var _p=[],vp=0,bp=toList(Rp=sp.call(np,ap));vp<bp.length;vp++){var Ep=bp[vp];lp.indexOf(Ep)!==-1&&(Ep=Ep.clone()),_p.push(Ep)}if(Rp=singletonOrArray(_p),sp.activityRegularizer!=null)throw new NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return Rp}var Sp=collectInputShape(np),Ap=sp.computeOutputShape(Sp),Rp=void 0,Tp=guessOutputDType(np);if(sp.warnOnIncompatibleInputShape(Array.isArray(np)?Sp[0]:Sp),Rp=Ap!=null&&Ap.length>0&&Array.isArray(Ap[0])?Ap.map(function(Mp,Op){return new SymbolicTensor(Tp,Mp,sp,toList(np),ap,sp.name,Op)}):new SymbolicTensor(Tp,Ap,sp,toList(np),ap,sp.name),sp.addInboundNode(np,Rp,null,null,Sp,Ap,ap),sp._refCount++,sp.activityRegularizer!=null)throw new NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return Rp})},_d.prototype.warnOnIncompatibleInputShape=function(np){if(this.batchInputShape!=null)if(np.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(np)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var ap=!1;this.batchInputShape.forEach(function(sp,lp){sp!=null&&np[lp]!=null&&np[lp]!==sp&&(ap=!0)}),ap&&console.warn("The shape of the input tensor ("+JSON.stringify(np)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(_d.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new AttributeError("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var np=[],ap=0,sp=this.inboundNodes;ap<sp.length;ap++){var lp=sp[ap],up=JSON.stringify(lp.outputShapes);np.indexOf(up)===-1&&np.push(up)}if(np.length===1){var cp=this.inboundNodes[0].outputShapes;return Array.isArray(cp)&&Array.isArray(cp[0])&&cp.length===1?cp[0]:cp}throw new AttributeError("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),_d.prototype.countParams=function(){if(!this.built)throw new RuntimeError("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return countParamsInWeights(this.weights)},_d.prototype.build=function(np){this.built=!0},_d.prototype.getWeights=function(np){return np===void 0&&(np=!1),batchGetValue(np?this.trainableWeights:this.weights)},_d.prototype.setWeights=function(np){var ap=this;je(function(){var sp=ap.weights;if(sp.length!==np.length)throw new ValueError('You called setWeights(weights) on layer "'+ap.name+'" with a weight list of length '+np.length+", but the layer was expecting "+sp.length+" weights. Provided weights: "+np+"...");if(sp.length!==0){for(var lp=[],up=batchGetValue(sp),cp=0;cp<up.length;++cp){var dp=up[cp],hp=sp[cp],fp=np[cp];if(!tt.arraysEqual(dp.shape,fp.shape))throw new ValueError("Layer weight shape "+dp.shape+" not compatible with provided weight shape "+fp.shape);lp.push([hp,fp])}batchSetValue(lp)}})},_d.prototype.addWeight=function(np,ap,sp,lp,up,cp,dp){if(this._addedWeightNames.indexOf(np)!==-1)throw new ValueError("Duplicate weight name "+np+" for layer "+this.name);this._addedWeightNames.push(np),sp==null&&(sp="float32"),this.fastWeightInitDuringBuild&&(lp=getInitializer("zeros"));var hp=lp.apply(ap,sp),fp=new LayerVariable(hp,sp,np,cp,dp);return hp.dispose(),up!=null&&this.addLoss(function(){return up.apply(fp.read())}),cp==null&&(cp=!0),cp?this._trainableWeights.push(fp):this._nonTrainableWeights.push(fp),fp},_d.prototype.setFastWeightInitDuringBuild=function(np){this.fastWeightInitDuringBuild=np},_d.prototype.addLoss=function(np){var ap;np==null||Array.isArray(np)&&np.length===0||(np=toList(np),this._losses!==void 0&&this._losses!==null&&(ap=this.losses).push.apply(ap,np))},_d.prototype.computeOutputShape=function(np){return np},_d.prototype.computeMask=function(np,ap){var sp=this;if(!this.supportsMasking){if(ap!=null){if(!Array.isArray(ap))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");ap.forEach(function(lp){if(lp!=null)throw new TypeError("Layer "+sp.name+" does not support masking, but was passed an inputMask.")})}return null}return ap},_d.prototype.addInboundNode=function(np,ap,sp,lp,up,cp,dp){dp===void 0&&(dp=null);var hp=toList(np);ap=toList(ap),sp=toList(sp),lp=toList(lp),up=normalizeShapeList(up),cp=normalizeShapeList(cp);for(var fp=[],pp=[],mp=[],gp=0,yp=hp;gp<yp.length;gp++){var xp=yp[gp];fp.push(xp.sourceLayer),pp.push(xp.nodeIndex),mp.push(xp.tensorIndex)}new Node$1({outboundLayer:this,inboundLayers:fp,nodeIndices:pp,tensorIndices:mp,inputTensors:hp,outputTensors:ap,inputMasks:sp,outputMasks:lp,inputShapes:up,outputShapes:cp},dp);for(var _p=0;_p<ap.length;_p++)ap[_p].sourceLayer=this,ap[_p].nodeIndex=this.inboundNodes.length-1,ap[_p].tensorIndex=_p},_d.prototype.getConfig=function(){var np={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(np.batchInputShape=this.batchInputShape),this.dtype!=null&&(np.dtype=this.dtype),np},_d.prototype.disposeWeights=function(){return this.weights.forEach(function(np){return np.dispose()}),this.weights.length},_d.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},_d.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var np=0;return--this._refCount==0&&(np=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:np}},_d}(Mf.Serializable);function collectInputShape(rp){for(var _d=[],np=0,ap=rp=toList(rp);np<ap.length;np++){var sp=ap[np];_d.push(sp.shape)}return singletonOrArray(_d)}function guessOutputDType(rp){return"float32"}function getSourceInputs(rp,_d,np){if((_d==null||np!=null&&np>0)&&(_d=rp.sourceLayer,np=rp.nodeIndex),_d.inboundNodes.length===0)return[rp];var ap=_d.inboundNodes[np];if(ap.inboundLayers.length===0)return ap.inputTensors;for(var sp=[],lp=0;lp<ap.inboundLayers.length;lp++)for(var up=0,cp=getSourceInputs(ap.inputTensors[lp],ap.inboundLayers[lp],ap.nodeIndices[lp]);up<cp.length;up++){var dp=cp[up];sp.indexOf(dp)===-1&&sp.push(dp)}return sp}var ModelLoggingVerbosity,InputLayer=function(rp){function _d(np){var ap=rp.call(this,{dtype:np.dtype,name:np.name!=null?np.name:getUid("input").toString()})||this;if(np.batchSize==null&&(np.batchSize=null),np.sparse==null&&(np.sparse=!1),ap.trainable=!1,ap.built=!0,ap.sparse=np.sparse,np.inputShape!=null&&np.batchInputShape!=null)throw new ValueError("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var sp=np.batchInputShape;if(sp==null){if(np.inputShape==null)throw new ValueError("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");sp=[np.batchSize].concat(np.inputShape)}else if(np.batchSize!=null)throw new ValueError("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var lp=np.dtype||"float32";ap.batchInputShape=sp,ap.dtype=lp,ap.inputSpec=[{shape:sp}];var up=new SymbolicTensor(ap.dtype,ap.batchInputShape,ap,[],{},ap.name);return up.nodeIndex=0,up.tensorIndex=0,new Node$1({outboundLayer:ap,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[up],outputTensors:[up],inputMasks:[null],outputMasks:[null],inputShapes:[sp],outputShapes:[sp]}),ap}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){throw new ValueError("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},_d.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},_d.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},_d.className="InputLayer",_d}(Layer);function Input(rp){if(rp.batchShape==null&&rp.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(rp.batchShape!=null&&rp.shape!=null)throw new ValueError("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var _d=rp.batchShape;rp.shape!=null&&_d==null&&(_d=[null].concat(rp.shape));var np=rp.dtype;return np==null&&(np="float32"),new InputLayer({batchInputShape:_d,name:rp.name,dtype:np,sparse:rp.sparse}).inboundNodes[0].outputTensors[0]}function resolveScalarsInLogs(rp){return __awaiter$8(this,void 0,void 0,function(){var _d,np,ap,sp,lp,up,cp,dp;return __generator$8(this,function(hp){switch(hp.label){case 0:if(rp==null)return[2];for(sp in _d=[],np=[],ap=[],rp)typeof(lp=rp[sp])!="number"&&(up=lp,_d.push(up.data()),np.push(sp),ap.push(up));return _d.length>0?[4,Promise.all(_d)]:[3,2];case 1:for(cp=hp.sent(),dp=0;dp<cp.length;++dp)rp[np[dp]]=cp[dp][0];Xe(ap),hp.label=2;case 2:return[2]}})})}function disposeTensorsInLogs(rp){if(rp!=null)for(var _d in rp){var np=rp[_d];typeof np!="number"&&np.dispose()}}Mf.registerClass(InputLayer),function(rp){rp[rp.SILENT=0]="SILENT",rp[rp.VERBOSE=1]="VERBOSE"}(ModelLoggingVerbosity||(ModelLoggingVerbosity={}));var DEFAULT_YIELD_EVERY_MS=125,BaseCallback=function(){function rp(){this.validationData=null}return rp.prototype.setParams=function(_d){this.params=_d},rp.prototype.onEpochBegin=function(_d,np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){return[2]})})},rp.prototype.onEpochEnd=function(_d,np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){return[2]})})},rp.prototype.onBatchBegin=function(_d,np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){return[2]})})},rp.prototype.onBatchEnd=function(_d,np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){return[2]})})},rp.prototype.onTrainBegin=function(_d){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(np){return[2]})})},rp.prototype.onTrainEnd=function(_d){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(np){return[2]})})},rp.prototype.setModel=function(_d){},rp}(),CallbackList=function(){function rp(_d,np){np===void 0&&(np=10),_d==null&&(_d=[]),this.callbacks=_d,this.queueLength=np}return rp.prototype.append=function(_d){this.callbacks.push(_d)},rp.prototype.setParams=function(_d){for(var np=0,ap=this.callbacks;np<ap.length;np++)ap[np].setParams(_d)},rp.prototype.setModel=function(_d){for(var np=0,ap=this.callbacks;np<ap.length;np++)ap[np].setModel(_d)},rp.prototype.onEpochBegin=function(_d,np){return __awaiter$8(this,void 0,void 0,function(){var ap,sp;return __generator$8(this,function(lp){switch(lp.label){case 0:np==null&&(np={}),ap=0,sp=this.callbacks,lp.label=1;case 1:return ap<sp.length?[4,sp[ap].onEpochBegin(_d,np)]:[3,4];case 2:lp.sent(),lp.label=3;case 3:return ap++,[3,1];case 4:return[2]}})})},rp.prototype.onEpochEnd=function(_d,np){return __awaiter$8(this,void 0,void 0,function(){var ap,sp;return __generator$8(this,function(lp){switch(lp.label){case 0:np==null&&(np={}),ap=0,sp=this.callbacks,lp.label=1;case 1:return ap<sp.length?[4,sp[ap].onEpochEnd(_d,np)]:[3,4];case 2:lp.sent(),lp.label=3;case 3:return ap++,[3,1];case 4:return[2]}})})},rp.prototype.onBatchBegin=function(_d,np){return __awaiter$8(this,void 0,void 0,function(){var ap,sp;return __generator$8(this,function(lp){switch(lp.label){case 0:np==null&&(np={}),ap=0,sp=this.callbacks,lp.label=1;case 1:return ap<sp.length?[4,sp[ap].onBatchBegin(_d,np)]:[3,4];case 2:lp.sent(),lp.label=3;case 3:return ap++,[3,1];case 4:return[2]}})})},rp.prototype.onBatchEnd=function(_d,np){return __awaiter$8(this,void 0,void 0,function(){var ap,sp;return __generator$8(this,function(lp){switch(lp.label){case 0:np==null&&(np={}),ap=0,sp=this.callbacks,lp.label=1;case 1:return ap<sp.length?[4,sp[ap].onBatchEnd(_d,np)]:[3,4];case 2:lp.sent(),lp.label=3;case 3:return ap++,[3,1];case 4:return[2]}})})},rp.prototype.onTrainBegin=function(_d){return __awaiter$8(this,void 0,void 0,function(){var np,ap;return __generator$8(this,function(sp){switch(sp.label){case 0:_d==null&&(_d={}),np=0,ap=this.callbacks,sp.label=1;case 1:return np<ap.length?[4,ap[np].onTrainBegin(_d)]:[3,4];case 2:sp.sent(),sp.label=3;case 3:return np++,[3,1];case 4:return[2]}})})},rp.prototype.onTrainEnd=function(_d){return __awaiter$8(this,void 0,void 0,function(){var np,ap;return __generator$8(this,function(sp){switch(sp.label){case 0:_d==null&&(_d={}),np=0,ap=this.callbacks,sp.label=1;case 1:return np<ap.length?[4,ap[np].onTrainEnd(_d)]:[3,4];case 2:sp.sent(),sp.label=3;case 3:return np++,[3,1];case 4:return[2]}})})},rp}(),BaseLogger=function(rp){function _d(){return rp.call(this)||this}return __extends$h(_d,rp),_d.prototype.onEpochBegin=function(np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){return this.seen=0,this.totals={},[2]})})},_d.prototype.onBatchEnd=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){var sp,lp,up,cp,dp=this;return __generator$8(this,function(hp){for(cp in ap==null&&(ap={}),sp=ap.size==null?0:ap.size,this.seen+=sp,lp=function(fp){var pp=ap[fp];if(typeof pp=="number")up.totals.hasOwnProperty(fp)||(up.totals[fp]=0),up.totals[fp]=up.totals[fp]+pp*sp;else{var mp=void 0;fp in up.totals?mp=up.totals[fp]:up.totals[fp]=0;var gp=je(function(){return Vs(dp.totals[fp],tc(pp,sp))});up.totals[fp]=gp,mp!=null&&mp.dispose()}},up=this,ap)lp(cp);return[2]})})},_d.prototype.onEpochEnd=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){var sp,lp,up,cp,dp,hp=this;return __generator$8(this,function(fp){if(ap!=null)for(sp=function(pp){if(lp.totals[pp]==null)return"continue";typeof lp.totals[pp]=="number"?ap[pp]=lp.totals[pp]/lp.seen:je(function(){var mp=tc(qs(1,hp.seen),hp.totals[pp]);ap[pp]=mp,hp.totals[pp].dispose(),$e(ap[pp])})},lp=this,up=0,cp=this.params.metrics;up<cp.length;up++)dp=cp[up],sp(dp);return[2]})})},_d}(BaseCallback),History=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.onTrainBegin=function(np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){return this.epoch=[],this.history={},[2]})})},_d.prototype.onEpochEnd=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){var sp;return __generator$8(this,function(lp){for(sp in ap==null&&(ap={}),this.epoch.push(np),ap)this.history[sp]==null&&(this.history[sp]=[]),this.history[sp].push(ap[sp]);return[2]})})},_d.prototype.syncData=function(){return __awaiter$8(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp,hp,fp;return __generator$8(this,function(pp){switch(pp.label){case 0:for(lp in np=[],ap=[],sp=[],this.history)for(up=this.history[lp],cp=0;cp<up.length;++cp)typeof up[cp]!="number"&&(dp=up[cp],np.push(dp.data()),ap.push(lp),sp.push(cp));return[4,Promise.all(np)];case 1:for(hp=pp.sent(),fp=0;fp<hp.length;++fp)this.history[ap[fp]][sp[fp]].dispose(),this.history[ap[fp]][sp[fp]]=hp[fp][0];return[2]}})})},_d}(BaseCallback),CustomCallback=function(rp){function _d(np,ap){var sp=rp.call(this)||this;if(sp.currentEpoch=0,sp.yieldEvery=ap||"auto",sp.yieldEvery==="auto"&&(sp.yieldEvery=DEFAULT_YIELD_EVERY_MS),sp.yieldEvery==="never"&&np.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return tt.isNumber(sp.yieldEvery)&&(sp.maybeWait=debounce$1(sp.maybeWait.bind(sp),sp.yieldEvery)),sp.trainBegin=np.onTrainBegin,sp.trainEnd=np.onTrainEnd,sp.epochBegin=np.onEpochBegin,sp.epochEnd=np.onEpochEnd,sp.batchBegin=np.onBatchBegin,sp.batchEnd=np.onBatchEnd,sp.yield=np.onYield,sp}return __extends$h(_d,rp),_d.prototype.maybeWait=function(np,ap,sp){return __awaiter$8(this,void 0,void 0,function(){var lp;return __generator$8(this,function(up){switch(up.label){case 0:return lp=[],this.yield==null?[3,2]:[4,resolveScalarsInLogs(sp)];case 1:up.sent(),lp.push(this.yield(np,ap,sp)),up.label=2;case 2:return lp.push(ep()),[4,Promise.all(lp)];case 3:return up.sent(),[2]}})})},_d.prototype.onEpochBegin=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(sp){switch(sp.label){case 0:return this.currentEpoch=np,this.epochBegin==null?[3,3]:[4,resolveScalarsInLogs(ap)];case 1:return sp.sent(),[4,this.epochBegin(np,ap)];case 2:sp.sent(),sp.label=3;case 3:return[2]}})})},_d.prototype.onEpochEnd=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){var sp;return __generator$8(this,function(lp){switch(lp.label){case 0:return sp=[],this.epochEnd==null?[3,2]:[4,resolveScalarsInLogs(ap)];case 1:lp.sent(),sp.push(this.epochEnd(np,ap)),lp.label=2;case 2:return this.yieldEvery==="epoch"&&sp.push(ep()),[4,Promise.all(sp)];case 3:return lp.sent(),[2]}})})},_d.prototype.onBatchBegin=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(sp){switch(sp.label){case 0:return this.batchBegin==null?[3,3]:[4,resolveScalarsInLogs(ap)];case 1:return sp.sent(),[4,this.batchBegin(np,ap)];case 2:sp.sent(),sp.label=3;case 3:return[2]}})})},_d.prototype.onBatchEnd=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){var sp;return __generator$8(this,function(lp){switch(lp.label){case 0:return sp=[],this.batchEnd==null?[3,2]:[4,resolveScalarsInLogs(ap)];case 1:lp.sent(),sp.push(this.batchEnd(np,ap)),lp.label=2;case 2:return this.yieldEvery==="batch"?sp.push(ep()):tt.isNumber(this.yieldEvery)&&sp.push(this.maybeWait(this.currentEpoch,np,ap)),[4,Promise.all(sp)];case 3:return lp.sent(),[2]}})})},_d.prototype.onTrainBegin=function(np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){switch(ap.label){case 0:return this.trainBegin==null?[3,3]:[4,resolveScalarsInLogs(np)];case 1:return ap.sent(),[4,this.trainBegin(np)];case 2:ap.sent(),ap.label=3;case 3:return[2]}})})},_d.prototype.onTrainEnd=function(np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){switch(ap.label){case 0:return this.trainEnd==null?[3,3]:[4,resolveScalarsInLogs(np)];case 1:return ap.sent(),[4,this.trainEnd(np)];case 2:ap.sent(),ap.label=3;case 3:return[2]}})})},_d}(BaseCallback);function standardizeCallbacks(rp,_d){return rp==null&&(rp={}),rp instanceof BaseCallback?[rp]:Array.isArray(rp)&&rp[0]instanceof BaseCallback?rp:toList(rp).map(function(np){return new CustomCallback(np,_d)})}var CallbackConstructorRegistry=function(){function rp(){}return rp.registerCallbackConstructor=function(_d,np){tt.assert(_d>=0&&Number.isInteger(_d),function(){return"Verbosity level is expected to be an integer >= 0, but got "+_d}),rp.checkForDuplicate(np),rp.constructors[_d]==null&&(rp.constructors[_d]=[]),rp.constructors[_d].push(np)},rp.checkForDuplicate=function(_d){for(var np in rp.constructors)rp.constructors[+np].forEach(function(ap){if(ap===_d)throw new ValueError("Duplicate callback constructor.")})},rp.clear=function(){rp.constructors={}},rp.createCallbacks=function(_d){var np=[];for(var ap in rp.constructors){var sp=+ap;_d>=sp&&np.push.apply(np,rp.constructors[sp])}return np.map(function(lp){return new lp})},rp.constructors={},rp}();function configureCallbacks(rp,_d,np,ap,sp,lp,up,cp,dp){var hp=new History,fp=[new BaseLogger].concat(CallbackConstructorRegistry.createCallbacks(_d));rp!=null&&fp.push.apply(fp,rp),fp.push(hp);var pp=new CallbackList(fp);return pp.setParams({epochs:np,initialEpoch:ap,samples:sp,steps:lp,batchSize:up,verbose:_d,doValidation:cp,metrics:dp}),{callbackList:pp,history:hp}}function deserialize(rp,_d,np){return _d===void 0&&(_d={}),np===void 0&&(np=!1),deserializeKerasObject(rp,Mf.SerializationMap.getMap().classNameMap,_d,"layer",np)}function l2Normalize(rp,_d){return je(function(){rp.dtype!=="float32"&&(rp=rp.asType("float32"));var np=vl(square(rp),_d,!0),ap=Ln(np.shape,epsilon()),sp=gs(Xs(np,ap));return qs(rp,sp)})}function meanSquaredError(rp,_d){return je(function(){return fl(square(ic(_d,rp)),-1)})}function meanAbsoluteError(rp,_d){return je(function(){return fl(Vu(ic(_d,rp)),-1)})}function meanAbsolutePercentageError(rp,_d){return je(function(){var np=ic(rp,_d),ap=$u(Vu(rp),epsilon(),Number.MAX_VALUE),sp=Vu(qs(np,ap));return tc(100,fl(sp,-1))})}function meanSquaredLogarithmicError(rp,_d){return je(function(){var np=$u(_d,epsilon(),Number.MAX_VALUE),ap=ns(Vs(1,np)),sp=$u(rp,epsilon(),Number.MAX_VALUE),lp=ns(Vs(1,sp));return fl(square(ic(ap,lp)),-1)})}function squaredHinge(rp,_d){return je(function(){var np=Xs(0,ic(1,tc(rp,_d)));return fl(square(np),-1)})}function hinge(rp,_d){return je(function(){var np=Xs(0,ic(1,tc(rp,_d)));return fl(np,-1)})}function categoricalHinge(rp,_d){return je(function(){var np=vl(tc(rp,_d),-1),ap=hl(tc(ic(1,rp),_d),-1);return Xs(0,Vs(1,ic(ap,np)))})}function logcosh(rp,_d){return je(function(){var np=Math.log(2),ap=ic(_d,rp),sp=ic(Vs(ap,ms(tc(-2,ap))),np);return fl(sp,-1)})}function categoricalCrossentropy(rp,_d,np){return np===void 0&&(np=!1),je(function(){if(np)_d=io(_d);else{var ap=vl(_d,_d.shape.length-1,!0);_d=qs(_d,ap)}return _d=$u(_d,epsilon(),1-epsilon()),as(vl(tc(rp.toFloat(),ns(_d)),_d.shape.length-1))})}function sparseCategoricalCrossentropy(rp,_d){return je(function(){var np=es(flatten$1(rp)).toInt(),ap=(_d=$u(_d,epsilon(),1-epsilon())).shape;return categoricalCrossentropy(gr(np,ap[ap.length-1]).reshape(ap),_d,!1)})}function sigmoidCrossEntropyWithLogits(rp,_d){if(!tt.arraysEqual(rp.shape,_d.shape))throw new ValueError("logits and labels must have the same shape, but got shapes "+JSON.stringify(rp.shape)+" and "+JSON.stringify(_d.shape));return je(function(){var np=_d.relu(),ap=_d.abs().neg();return np.sub(_d.mul(rp)).add(ap.exp().log1p())})}function binaryCrossentropy(rp,_d){return je(function(){var np;return np=$u(_d,epsilon(),1-epsilon()),np=ns(qs(np,ic(1,np))),fl(sigmoidCrossEntropyWithLogits(rp,np),-1)})}function kullbackLeiblerDivergence(rp,_d){return je(function(){var np=$u(rp,epsilon(),1),ap=$u(_d,epsilon(),1);return vl(tc(rp,ns(qs(np,ap))),-1)})}function poisson(rp,_d){return je(function(){var np=ns(Vs(epsilon(),_d));return fl(ic(_d,tc(rp,np)),-1)})}function cosineProximity(rp,_d){return je(function(){var np=l2Normalize(rp,-1),ap=l2Normalize(_d,-1),sp=tc(np,ap);return as(vl(sp,-1))})}var lossesMap={meanSquaredError,meanAbsoluteError,meanAbsolutePercentageError,meanSquaredLogarithmicError,squaredHinge,hinge,categoricalHinge,logcosh,categoricalCrossentropy,sparseCategoricalCrossentropy,binaryCrossentropy,kullbackLeiblerDivergence,poisson,cosineProximity};function get(rp){if(typeof rp=="string"){if(rp in lossesMap)return lossesMap[rp];var _d="Unknown loss "+rp;throw rp.toLowerCase().includes("softmaxcrossentropy")&&(_d="Unknown loss "+rp+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new ValueError(_d)}return rp}function binaryAccuracy(rp,_d){return je(function(){var np=tc(.5,Vn(_d)),ap=cast$1(lc(_d,np),rp.dtype);return fl(sc(rp,ap),-1)})}function categoricalAccuracy(rp,_d){return je(function(){return cast$1(sc(sl(rp,-1),sl(_d,-1)),"float32")})}function truePositives(rp,_d){return je(function(){return Ms(rp.equal(1),_d.equal(1)).sum().cast("float32")})}function falseNegatives(rp,_d){return je(function(){return Ms(rp.equal(1),_d.equal(0)).sum().cast("float32")})}function falsePositives(rp,_d){return je(function(){return Ms(rp.equal(0),_d.equal(1)).sum().cast("float32")})}function precision(rp,_d){return je(function(){var np=truePositives(rp,_d),ap=falsePositives(rp,_d),sp=np.add(ap);return Ws(lc(sp,0),np.div(sp),0).cast("float32")})}function recall(rp,_d){return je(function(){var np=truePositives(rp,_d),ap=falseNegatives(rp,_d),sp=np.add(ap);return Ws(lc(sp,0),np.div(sp),0).cast("float32")})}function binaryCrossentropy$1(rp,_d){return binaryCrossentropy(rp,_d)}function sparseCategoricalAccuracy(rp,_d){return rp.rank===_d.rank&&(rp=rp.squeeze([rp.rank-1])),(_d=_d.argMax(-1)).dtype!==rp.dtype&&(_d=_d.asType(rp.dtype)),sc(rp,_d).asType("float32")}var mse$1=meanSquaredError,MSE$1=meanSquaredError,mae$1=meanAbsoluteError,MAE$1=meanAbsoluteError,mape$1=meanAbsolutePercentageError,MAPE$1=meanAbsolutePercentageError,categoricalCrossentropy$1=categoricalCrossentropy,cosine$1=cosineProximity,sparseCategoricalCrossentropy$1=sparseCategoricalCrossentropy,metricsMap={binaryAccuracy,categoricalAccuracy,precision,categoricalCrossentropy:categoricalCrossentropy$1,sparseCategoricalCrossentropy:sparseCategoricalCrossentropy$1,mse:mse$1,MSE:MSE$1,mae:mae$1,MAE:MAE$1,mape:mape$1,MAPE:MAPE$1,cosine:cosine$1};function get$1(rp){if(typeof rp=="string"&&rp in metricsMap)return metricsMap[rp];if(typeof rp!="string"&&rp!=null)return rp;throw new ValueError("Unknown metric "+rp)}function getLossOrMetricName(rp){if(assert(rp!==null,"Unknown LossOrMetricFn "+rp),typeof rp=="string")return rp;for(var _d=void 0,np=0,ap=Object.keys(lossesMap);np<ap.length;np++){var sp=ap[np];if(lossesMap[sp]===rp){_d=sp;break}}if(_d!==void 0)return _d;for(var lp=0,up=Object.keys(metricsMap);lp<up.length;lp++)if(sp=up[lp],metricsMap[sp]===rp){_d=sp;break}return _d!==void 0?_d:rp.name}function getOptimizer(rp){var _d={Adagrad:function(){return Zf.adagrad(.01)},Adadelta:function(){return Zf.adadelta(1,.95,epsilon())},Adam:function(){return Zf.adam(.001,.9,.999,epsilon())},Adamax:function(){return Zf.adamax(.002,.9,.999,epsilon(),0)},RMSProp:function(){return Zf.rmsprop(.001,.9,0,epsilon())},SGD:function(){return Zf.sgd(.01)}};if(_d.adagrad=_d.Adagrad,_d.adadelta=_d.Adadelta,_d.adam=_d.Adam,_d.adamax=_d.Adamax,_d.rmsprop=_d.RMSProp,_d.sgd=_d.SGD,rp in _d)return _d[rp]();throw new ValueError("Unknown Optimizer "+rp)}var MAX_USER_DEFINED_METADATA_SERIALIZED_LENGTH=1048576;function checkUserDefinedMetadata(rp,_d,np){if(np===void 0&&(np=!1),rp==null||typeof rp!="object"||Object.getPrototypeOf(rp)!==Object.prototype||!plainObjectCheck(rp))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(np){var ap=JSON.stringify(rp);ap.length>MAX_USER_DEFINED_METADATA_SERIALIZED_LENGTH&&console.warn('User-defined metadata of model "'+_d+'" is too large in size (length='+ap.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+MAX_USER_DEFINED_METADATA_SERIALIZED_LENGTH+".")}}function plainObjectCheck(rp){if(rp===null)return!0;if(typeof rp=="object"){if(Object.getPrototypeOf(rp)===Object.prototype){for(var _d=0,np=Object.keys(rp);_d<np.length;_d++){var ap=np[_d];if(typeof ap!="string"||!plainObjectCheck(rp[ap]))return!1}return!0}if(Array.isArray(rp)){for(var sp=0,lp=rp;sp<lp.length;sp++)if(!plainObjectCheck(lp[sp]))return!1;return!0}return!1}var up=typeof rp;return up==="string"||up==="number"||up==="boolean"}function printSummary(rp,_d,np,ap){ap===void 0&&(ap=console.log);var sp,lp=isModelSequentialLike(rp),up=["Layer (type)","Output shape","Param #"];if(lp?(_d=_d||65,np=np||[.45,.85,1]):(_d=_d||98,np=np||[.33,.55,.67,1]),np[np.length-1]<=1&&(np=np.map(function(mp){return Math.floor(_d*mp)})),!lp)for(var cp in up.push("Receives inputs"),sp=[],rp.nodesByDepth)sp.push.apply(sp,rp.nodesByDepth[cp]);ap("_".repeat(_d)),printRow(up,np,ap),ap("=".repeat(_d));for(var dp=rp.layers,hp=0;hp<dp.length;++hp)lp?printLayerSummary(dp[hp],np,ap):printLayerSummaryWithConnections(dp[hp],np,sp,ap),ap((hp===dp.length-1?"=":"_").repeat(_d));rp.checkTrainableWeightsConsistency();var fp=countTrainableParams(rp),pp=countParamsInWeights(rp.nonTrainableWeights);ap("Total params: "+(fp+pp)),ap("Trainable params: "+fp),ap("Non-trainable params: "+pp),ap("_".repeat(_d))}function countTrainableParams(rp){return rp.collectedTrainableWeights!=null?countParamsInWeights(rp.collectedTrainableWeights):countParamsInWeights(rp.trainableWeights)}function isModelSequentialLike(rp){var _d=!0,np=[],ap=[];for(var sp in rp.nodesByDepth)np.push(rp.nodesByDepth[sp]);for(var lp=0,up=np;lp<up.length;lp++){var cp=up[lp];if(cp.length>1||cp.length===1&&cp[0].inboundLayers.length>1){_d=!1;break}ap.push.apply(ap,cp)}if(_d)for(var dp=0,hp=rp.layers;dp<hp.length;dp++){for(var fp=!1,pp=0,mp=hp[dp].inboundNodes;pp<mp.length;pp++){var gp=mp[pp];if(ap.indexOf(gp)!==-1){if(fp){_d=!1;break}fp=!0}}if(!_d)break}return _d}function printRow(rp,_d,np){np===void 0&&(np=console.log);for(var ap="",sp=0;sp<rp.length;++sp)sp>0&&(ap=ap.slice(0,ap.length-1)+" "),ap=(ap+=rp[sp]).slice(0,_d[sp]),ap+=" ".repeat(_d[sp]-ap.length);np(ap)}function printLayerSummary(rp,_d,np){var ap;try{ap=JSON.stringify(rp.outputShape)}catch{ap="multiple"}printRow([rp.name+" ("+rp.getClassName()+")",ap,rp.countParams().toString()],_d,np)}function printLayerSummaryWithConnections(rp,_d,np,ap){var sp;try{sp=JSON.stringify(rp.outputShape)}catch{sp="multiple"}for(var lp=[],up=0,cp=rp.inboundNodes;up<cp.length;up++){var dp=cp[up];if(!(np!=null&&np.length>0&&np.indexOf(dp)===-1))for(var hp=0;hp<dp.inboundLayers.length;++hp){var fp=dp.inboundLayers[hp].name,pp=dp.nodeIndices[hp],mp=dp.tensorIndices[hp];lp.push(fp+"["+pp+"]["+mp+"]")}}var gp=rp.name,yp=rp.getClassName(),xp=lp.length===0?"":lp[0];for(printRow([gp+" ("+yp+")",sp,rp.countParams().toString(),xp],_d,ap),hp=1;hp<lp.length;++hp)printRow(["","","",lp[hp]],_d,ap)}function isArrayItemInputOrOutputName(rp,_d,np){return(rp==="inboundNodes"||rp==="outputLayers"||rp==="inputLayers")&&_d===0&&typeof np=="string"}function convertPythonicToTs(rp,_d){if(rp===null)return null;if(typeof rp=="string")return toCamelCase$1(rp);if(typeof rp=="number"||typeof rp=="boolean")return rp;if(rp instanceof Array){for(var np=[],ap=rp.length,sp=0;sp<ap;++sp){var lp=rp[sp];isArrayItemInputOrOutputName(_d,sp,lp)?np.push(lp):np.push(convertPythonicToTs(lp,_d))}return np}for(var up={},cp=0,dp=Object.keys(rp);cp<dp.length;cp++){var hp=dp[cp],fp=rp[hp];if(hp==="name"&&typeof fp=="string")up[hp]=fp;else{var pp=toCamelCase$1(hp);up[pp]=convertPythonicToTs(fp,pp)}}return up}function convertTsToPythonic(rp,_d){if(rp==null)return null;if(typeof rp=="string")return toSnakeCase(rp);if(typeof rp=="number"||typeof rp=="boolean")return rp;if(rp instanceof Array){for(var np=[],ap=rp.length,sp=0;sp<ap;++sp){var lp=rp[sp];isArrayItemInputOrOutputName(_d,sp,lp)?np.push(lp):np.push(convertTsToPythonic(lp,_d))}return np}for(var up={},cp=0,dp=Object.keys(rp);cp<dp.length;cp++){var hp=dp[cp],fp=rp[hp],pp=toSnakeCase(hp);up[pp]=hp!=="name"&&hp!=="className"||typeof fp!="string"?convertTsToPythonic(fp,hp):fp}return up}var version$9="1.3.1";function assertFeedCompatibility(rp,_d){if(rp.dtype==null||rp.dtype===_d.dtype)return _d;try{return lr(_d,rp.dtype)}catch{throw new ValueError("The dtype of the feed ("+_d.dtype+") can not be cast to the dtype of the key '"+rp.name+"' ("+rp.dtype+").")}}var FeedDict=function(){function rp(_d){if(this.id2Value={},this.id2Mask={},this.name2Id={},_d instanceof rp)for(var np in _d.id2Value)this.id2Value[np]=_d.id2Value[np],np in _d.id2Mask&&(this.id2Mask[np]=_d.id2Mask[np]);else{if(_d==null)return;for(var ap=0,sp=_d;ap<sp.length;ap++){var lp=sp[ap];this.add(lp.key,lp.value)}}}return rp.prototype.add=function(_d,np,ap){if(this.id2Value[_d.id]!=null)throw new ValueError("Duplicate key: name="+_d.name+", id="+_d.id);return this.id2Value[_d.id]=assertFeedCompatibility(_d,np),this.name2Id[_d.name]=_d.id,ap!=null&&(this.id2Mask[_d.id]=ap),this},rp.prototype.addFeed=function(_d){this.add(_d.key,_d.value)},rp.prototype.hasKey=function(_d){return this.id2Value[_d.id]!=null},rp.prototype.names=function(){return Object.keys(this.name2Id)},rp.prototype.getValue=function(_d){if(_d instanceof SymbolicTensor){if(this.id2Value[_d.id]==null)throw new ValueError("Nonexistent key: "+_d.name);return this.id2Value[_d.id]}var np=this.name2Id[_d];if(np==null)throw new ValueError("Feed dict has no SymbolicTensor name: "+_d);return this.id2Value[np]},rp.prototype.getMask=function(_d){if(_d instanceof SymbolicTensor){if(this.id2Value[_d.id]==null)throw new ValueError("Nonexistent key: "+_d.name);return this.id2Mask[_d.id]}var np=this.name2Id[_d];if(np==null)throw new ValueError("Feed dict has no SymbolicTensor name: "+_d);return this.id2Mask[np]},rp.prototype.disposeMasks=function(){this.id2Mask!=null&&Xe(this.id2Mask)},rp}(),cachedSorted={},cachedRecipientCounts={};function execute(rp,_d,np,ap){for(var sp=np!=null&&np.training,lp=Array.isArray(rp),up=lp?rp:[rp],cp=up.map(function(Gp){return Gp.name}),dp=[],hp=_d.names(),fp=0,pp=cp;fp<pp.length;fp++){var mp=pp[fp];hp.indexOf(mp)!==-1?dp.push(_d.getValue(mp)):dp.push(null)}ap!=null&&(ap.maxNumTensors=-1/0,ap.minNumTensors=1/0);var gp,yp,xp=cp.join(",")+"|"+_d.names().join(",");if(cachedSorted[xp]==null){var _p=getTopologicalSortAndRecipientCounts(up,_d);gp=_p.sorted,yp=_p.recipientCounts,cachedSorted[xp]=gp,cachedRecipientCounts[xp]=yp}gp=cachedSorted[xp],yp={},sp||Object.assign(yp,cachedRecipientCounts[xp]);for(var vp=new FeedDict(_d),bp=0;bp<gp.length;++bp){if(ap!=null){var Ep=qe().numTensors;Ep>ap.maxNumTensors&&(ap.maxNumTensors=Ep),Ep<ap.minNumTensors&&(ap.minNumTensors=Ep)}var Sp=gp[bp],Ap=Sp.sourceLayer;if(!(Ap instanceof InputLayer)){for(var Rp=[],Tp=[],Mp=[],Op=!1,Pp=0,$p=Sp.inputs;Pp<$p.length;Pp++){var zp=$p[Pp],Dp=vp.getValue(zp),Fp=vp.getMask(zp);Rp.push(Dp),Tp.push(Fp),Fp!=null&&(Op=!0),sp||(yp[zp.name]--,yp[zp.name]!==0||_d.hasKey(zp)||cp.indexOf(zp.name)!==-1||Dp.isDisposed||zp.sourceLayer.stateful===!0||Mp.push(Dp))}Op&&((np=np||{}).mask=Tp[0]);var jp=toList(Ap.apply(Rp,np)),Lp=null;Ap.supportsMasking&&(Lp=Ap.computeMask(Rp,Tp));for(var Bp=getNodeOutputs(Sp),Ip=Array.isArray(Bp)?Bp:[Bp],kp=0;kp<Ip.length;++kp){vp.hasKey(Ip[kp])||vp.add(Ip[kp],jp[kp],Array.isArray(Lp)?Lp[0]:Lp);var Up=cp.indexOf(Ip[kp].name);Up!==-1&&(dp[Up]=jp[kp])}sp||Xe(Mp)}}return vp.disposeMasks(),lp?dp:dp[0]}function getTopologicalSortAndRecipientCounts(rp,_d){tt.assert(rp!=null&&rp.length>0,function(){return"Expected at least one fetch, got none"});var np=[],ap={};if(rp.length===1){var sp=getTopologicalSortAndRecipientCountsForOneFetch(rp[0],_d);np=sp.sorted,ap=sp.recipientMap}else for(var lp=new Set,up=0,cp=rp;up<cp.length;up++){for(var dp=getTopologicalSortAndRecipientCountsForOneFetch(cp[up],_d),hp=dp.sorted,fp=dp.recipientMap,pp=0,mp=hp;pp<mp.length;pp++){var gp=mp[pp];lp.has(gp.name)||(np.push(gp),lp.add(gp.name))}var yp=function(_p){ap[_p]==null&&(ap[_p]=new Set),fp[_p].forEach(function(vp){return ap[_p].add(vp)})};for(var xp in fp)yp(xp)}return{sorted:np,recipientCounts:recipientMap2Counts(ap)}}function recipientMap2Counts(rp){var _d={};for(var np in rp)_d[np]=rp[np].size;return _d}function getTopologicalSortAndRecipientCountsForOneFetch(rp,_d){for(var np=new Set,ap=[],sp={},lp=0,up=_d.names();lp<up.length;lp++){var cp=up[lp];np.add(cp)}var dp=[],hp=[];for(dp.push(rp);dp.length>0;){var fp=dp[dp.length-1];if(np.has(fp.name))dp.pop();else{var pp=hp[hp.length-1]===dp.length-1;if(fp.inputs.length===0||pp)dp.pop(),ap.push(fp),np.add(fp.name),pp&&hp.pop();else{hp.push(dp.length-1);for(var mp=0,gp=fp.inputs;mp<gp.length;mp++){var yp=gp[mp];sp[yp.name]==null&&(sp[yp.name]=new Set),sp[yp.name].add(fp.name),np.has(yp.name)||dp.push(yp)}}}}return{sorted:ap,recipientMap:sp}}function getNodeOutputs(rp){var _d;if(rp.sourceLayer.inboundNodes.length===1)_d=rp.sourceLayer.output;else{for(var np=null,ap=0;ap<rp.sourceLayer.inboundNodes.length;++ap)for(var sp=0,lp=rp.sourceLayer.inboundNodes[ap].outputTensors;sp<lp.length;sp++)if(lp[sp].id===rp.id){np=ap;break}_d=rp.sourceLayer.getOutputAt(np)}return _d}var Container=function(rp){function _d(np){var ap=rp.call(this,{})||this;if(ap.containerNodes=new Set,ap.name=np.name,ap.name==null){var sp=ap.getClassName().toLowerCase();ap.name=getUid(sp)}if(ap.supportsMasking=!1,ap.trainable_=!0,Array.isArray(np.inputs)?ap.inputs=np.inputs.slice():ap.inputs=[np.inputs],Array.isArray(np.outputs)?ap.outputs=np.outputs.slice():ap.outputs=[np.outputs],unique(ap.inputs).length!==ap.inputs.length)throw new ValueError("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+ap.inputs.map(function(ym){return ym.name}));unique(ap.outputs).length!==ap.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+ap.outputs.map(function(ym){return ym.name})),ap.inputLayers=[],ap.inputLayersNodeIndices=[],ap.inputLayersTensorIndices=[],ap.outputLayers=[],ap.outputLayersNodeIndices=[],ap.outputLayersTensorIndices=[],ap.layers=[],ap.internalContainerRefs=[];for(var lp=0,up=ap.outputs;lp<up.length;lp++){var cp=(Pp=up[lp]).sourceLayer,dp=Pp.nodeIndex,hp=Pp.tensorIndex;ap.outputLayers.push(cp),ap.outputLayersNodeIndices.push(dp),ap.outputLayersTensorIndices.push(hp)}for(var fp=0,pp=ap.inputs;fp<pp.length;fp++)cp=(Pp=pp[fp]).sourceLayer,dp=Pp.nodeIndex,hp=Pp.tensorIndex,assert(dp===0,"input layer has >1 nodes"),assert(hp===0,"input layer has >1 tensors"),ap.inputLayers.push(cp),ap.inputLayersNodeIndices.push(dp),ap.inputLayersTensorIndices.push(hp);ap.inputNames=[],ap.outputNames=[],ap.feedInputShapes=[],ap.feedInputNames=[],ap.feedOutputNames=[];for(var mp=0;mp<ap.inputLayers.length;mp++){if(!((cp=ap.inputLayers[mp])instanceof InputLayer))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+np.inputs+". Input "+mp+" (0-based) originates from layer type "+cp.getClassName()+".");ap.inputNames.push(cp.name),ap.feedInputShapes.push(cp.batchInputShape),ap.feedInputNames.push(cp.name)}for(var gp=0,yp=ap.outputLayers;gp<yp.length;gp++)cp=yp[gp],ap.outputNames.push(cp.name);ap.internalInputShapes=ap.inputs.map(function(ym){return ym.shape}),ap.internalOutputShapes=ap.outputs.map(function(ym){return ym.shape});for(var xp={},_p={},vp={},bp={},Ep={},Sp=[],Ap=function(ym,Em,Bm,Pm,Im,Dm){Pm!=null&&Im!=null&&Dm!=null||(Pm=ym.sourceLayer,Im=ym.nodeIndex,Dm=ym.tensorIndex);var jm=Pm.inboundNodes[Im];if(Bm.indexOf(jm)!==-1)throw new RuntimeError("The tensor "+ym.name+' at layer "'+Pm.name+'" is part of a cycle.');if(Em.indexOf(jm)===-1){ap.containerNodes.add(_d.nodeKey(Pm,Im)),Pm.id in Ep||(Ep[Pm.id]=Object.keys(Ep).length),Bm.indexOf(jm)===-1&&Bm.push(jm);for(var Fm=jm.inboundLayers.length,av=0;av<Fm;av++){var lv=jm.inputTensors[av],tv=jm.inboundLayers[av],Jm=jm.nodeIndices[av],um=jm.tensorIndices[av];Ap(lv,Em,Bm,tv,Jm,um)}for(Em.push(jm);Bm.indexOf(jm)>=0;)Bm.splice(Bm.indexOf(jm),1);Sp.push(jm)}},Rp=[],Tp=[],Mp=0,Op=ap.outputs;Mp<Op.length;Mp++){var Pp=Op[Mp];Ap(Pp,Rp,Tp)}for(var $p=0,zp=Sp.slice().reverse();$p<zp.length;$p++){_p[(Zp=zp[$p]).id]=Zp,Zp.id in xp||(xp[Zp.id]=0);var Dp=xp[Zp.id],Fp=vp[Zp.outboundLayer.id]==null?0:vp[Zp.outboundLayer.id];for(Dp=Math.max(Dp,Fp),vp[Zp.outboundLayer.id]=Dp,bp[Zp.outboundLayer.id]=Zp.outboundLayer,xp[Zp.id]=Dp,mp=0;mp<Zp.inboundLayers.length;mp++){var jp=Zp.inboundLayers[mp],Lp=(dp=Zp.nodeIndices[mp],jp.inboundNodes[dp]),Bp=xp[Lp.id]==null?0:xp[Lp.id];xp[Lp.id]=Math.max(Dp+1,Bp),_p[Lp.id]=Lp}}var Ip={};for(var kp in xp)(Dp=xp[kp])in Ip||(Ip[Dp]=[]),Ip[Dp].push(_p[kp]);var Up={};for(var Gp in vp)(Dp=vp[Gp])in Up||(Up[Dp]=[]),Up[Dp].push(bp[Gp]);var Wp=Object.keys(Up).map(function(ym){return parseInt(ym,10)}).sort(reverseNumberCompare);ap.layers=[];for(var Qp=0,Xp=Wp;Qp<Xp.length;Qp++){var rm=Up[Dp=Xp[Qp]];rm.sort(function(ym,Em){var Bm=Ep[ym.id],Pm=Ep[Em.id];return Bm<Pm?-1:Bm>Pm?1:0});for(var Kp=0,lm=rm;Kp<lm.length;Kp++)(cp=lm[Kp])instanceof _d&&ap.internalContainerRefs.push(cp),ap.layers.push(cp)}ap.layersByDepth=Up,Wp=Object.keys(Ip).map(function(ym){return parseInt(ym,10)}).sort(reverseNumberCompare);for(var cm=ap.inputs.slice(),gm=[],Mm=0,dm=Wp;Mm<dm.length;Mm++)for(var em=0,sm=Ip[Dp=dm[Mm]];em<sm.length;em++){var Zp;if((cp=(Zp=sm[em]).outboundLayer)!=null){for(var mm=0,fm=Zp.inputTensors;mm<fm.length;mm++)if(Pp=fm[mm],cm.indexOf(Pp)===-1)throw new RuntimeError("Graph disconnected: cannot obtain value for tensor "+Pp+' at layer "'+cp.name+'". The following previous layers were accessed without issue: '+gm);for(var _m=0,zm=Zp.outputTensors;_m<zm.length;_m++)Pp=zm[_m],cm.push(Pp);gm.push(cp.name)}}ap.nodesByDepth=Ip;for(var tm=ap.layers.map(function(ym){return ym.name}),Jp=function(ym){var Em=tm.filter(function(Bm){return Bm===ym}).length;if(Em!==1)throw new RuntimeError('The name "'+ym+'" is used '+Em+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(tm))},pm=0,km=tm;pm<km.length;pm++)Jp(km[pm]);return ap.outboundNodes=[],ap.inboundNodes=[],new Node$1({outboundLayer:ap,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:ap.inputs,outputTensors:ap.outputs,inputMasks:ap.inputs.map(function(ym){return null}),outputMasks:ap.outputs.map(function(ym){return null}),inputShapes:ap.inputs.map(function(ym){return ym.shape}),outputShapes:ap.outputs.map(function(ym){return ym.shape})}),ap.built=!0,ap._refCount=1,ap}return __extends$h(_d,rp),_d.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},_d.prototype.dispose=function(){this.assertNotDisposed();var np={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var ap=0,sp=this.layers;ap<sp.length;ap++){var lp=sp[ap];np.numDisposedVariables+=lp.dispose().numDisposedVariables}for(var up=0,cp=this.internalContainerRefs;up<cp.length;up++){var dp=cp[up];np.numDisposedVariables+=dp.dispose().numDisposedVariables}}return np.refCountAfterDispose=this._refCount,np},Object.defineProperty(_d.prototype,"trainable",{get:function(){return this.trainable_},set:function(np){this.layers.forEach(function(ap){ap._trainableWeights.forEach(function(sp){return sp.trainable=np})}),this.trainable_=np},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new ValueError("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var np=[],ap=0,sp=this.layers;ap<sp.length;ap++){var lp=sp[ap];np=np.concat(lp.trainableWeights)}return np},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"nonTrainableWeights",{get:function(){for(var np=[],ap=0,sp=this.layers;ap<sp.length;ap++){var lp=sp[ap];np.push.apply(np,lp.nonTrainableWeights)}if(!this.trainable){for(var up=[],cp=0,dp=this.layers;cp<dp.length;cp++)lp=dp[cp],up.push.apply(up,lp.trainableWeights);return up.concat(np)}return np},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),_d.prototype.loadWeights=function(np,ap){ap===void 0&&(ap=!0);for(var sp={},lp=0,up=0,cp=this.layers;up<cp.length;up++)for(var dp=0,hp=cp[up].weights;dp<hp.length;dp++){var fp=hp[dp];if(sp[fp.originalName]!=null)throw new ValueError("Duplicate weight name: "+fp.originalName);sp[fp.originalName]=fp,lp++}var pp=[];for(var mp in np){if(sp[mp]!=null)pp.push([sp[mp],np[mp]]);else if(ap)throw new ValueError("Provided weight data has no target variable: "+mp);delete sp[mp]}if(ap){var gp=[];for(var yp in sp)gp.push(yp);if(gp.length>0)throw new ValueError(gp.length+" of "+lp+" weights are not set: "+gp)}batchSetValue(pp)},_d.prototype.updatedConfig=function(){var np=this.getConfig(),ap={};return ap.className=this.getClassName(),ap.config=np,ap.kerasVersion="tfjs-layers "+version$9,ap.backend="TensorFlow.js",ap},_d.prototype.toJSON=function(np,ap){ap===void 0&&(ap=!0);var sp=convertTsToPythonic(this.updatedConfig());return ap?JSON.stringify(sp):sp},_d.prototype.call=function(np,ap){var sp=this;return je(function(){np=toList(np);for(var lp=new FeedDict,up=0;up<sp.inputs.length;++up)lp.add(sp.inputs[up],np[up]);return execute(sp.outputs,lp,ap)})},_d.prototype.computeMask=function(np,ap){var sp=this;return je(function(){var lp;return np=toList(np),lp=ap==null?pyListRepeat(null,np.length):toList(ap),sp.runInternalGraph(np,lp)[1]})},_d.prototype.computeOutputShape=function(np){var ap=normalizeShapeList(np);if(ap.length!==this.inputLayers.length)throw new ValueError("Invalid inputShape argument "+np+": model has "+this.inputLayers.length+" tensor inputs.");for(var sp={},lp=0;lp<ap.length;lp++){var up=this.inputLayers[lp],cp=ap[lp];sp[Op=up.name+"_0_0"]=cp}var dp=Object.keys(this.nodesByDepth).map(function($p){return parseInt($p,10)}).sort(reverseNumberCompare);if(dp.length>1)for(var hp=0,fp=dp;hp<fp.length;hp++)for(var pp=fp[hp],mp=0,gp=this.nodesByDepth[pp];mp<gp.length;mp++){var yp=gp[mp];if(up=yp.outboundLayer,this.inputLayers.map(function($p){return $p.id}).indexOf(up.id)===-1){for(var xp=[],_p=0;_p<yp.inboundLayers.length;_p++){var vp=yp.inboundLayers[_p],bp=yp.nodeIndices[_p],Ep=yp.tensorIndices[_p],Sp=sp[Op=vp.name+"_"+bp+"_"+Ep];xp.push(Sp)}var Ap=normalizeShapeList(up.computeOutputShape(singletonOrArray(xp))),Rp=up.inboundNodes.indexOf(yp);for(_p=0;_p<Ap.length;_p++)sp[Op=up.name+"_"+Rp+"_"+_p]=Ap[_p]}}var Tp=[],Mp=[];for(lp=0;lp<this.outputLayers.length;lp++){up=this.outputLayers[lp],Rp=this.outputLayersNodeIndices[lp],Ep=this.outputLayersTensorIndices[lp];var Op=up.name+"_"+Rp+"_"+Ep;Mp.push(Op)}for(lp=0;lp<Mp.length;lp++){var Pp=Mp[lp];assert(Pp in sp),Tp.push(sp[Pp])}return singletonOrArray(Tp)},_d.prototype.runInternalGraph=function(np,ap){ap==null&&(ap=pyListRepeat(null,np.length));for(var sp={},lp=0;lp<this.inputs.length;++lp){var up=this.inputs[lp],cp=np[lp],dp=ap[lp];sp[up.id]=[cp,dp]}for(var hp=0,fp=Object.keys(this.nodesByDepth).map(function(Up){return parseInt(Up,10)}).sort(reverseNumberCompare);hp<fp.length;hp++)for(var pp=fp[hp],mp=0,gp=this.nodesByDepth[pp];mp<gp.length;mp++){for(var yp=gp[mp],xp=yp.outboundLayer,_p=yp.inputTensors,vp=yp.outputTensors,bp=new Array,Ep=0,Sp=_p;Ep<Sp.length;Ep++)(up=Sp[Ep]).id in sp&&bp.push(sp[up.id]);if(bp.length===_p.length){var Ap={},Rp=void 0,Tp=void 0,Mp=void 0,Op=void 0;if(yp.callArgs!=null&&(Ap=yp.callArgs),bp.length===1){var Pp=bp[0],$p=Pp[0],zp=Pp[1];Ap.mask==null&&(Ap.mask=zp),Mp=toList(xp.call($p,Ap)),Op=toList(xp.computeMask($p,zp)),Rp=[$p],Tp=[zp]}else Rp=bp.map(function(Up){return Up[0]}),Tp=bp.map(function(Up){return Up[1]}),Ap.mask==null&&(Ap.mask=Tp),Mp=toList(xp.call(Rp,Ap)),Op=toList(xp.computeMask(Rp,Tp));if(xp.activityRegularizer)throw new NotImplementedError("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(lp=0;lp<vp.length;++lp)up=vp[lp],cp=Mp[lp],dp=Op[lp],sp[up.id]=[cp,dp]}}for(var Dp=[],Fp=[],jp=[],Lp=0,Bp=this.outputs;Lp<Bp.length;Lp++){assert((up=Bp[Lp]).id in sp,"Could not compute output "+up.name+" : "+up.id);var Ip=sp[up.id],kp=Ip[0];dp=Ip[1],jp.push(kp.shape),Dp.push(kp),Fp.push(dp)}return[Dp,Fp,jp]},_d.prototype.buildNodeConversionMap=function(np){for(var ap,sp={},lp=0,up=this.layers;lp<up.length;lp++){var cp=up[lp];ap=cp instanceof _d?1:0;for(var dp=0;dp<cp.inboundNodes.length;dp++){var hp=_d.nodeKey(cp,dp);this.containerNodes.has(hp)&&(sp[hp]=ap,ap+=1)}}return sp},_d.prototype.getLayer=function(np,ap){if(ap!=null){if(this.layers.length<=ap)throw new ValueError("Was asked to retrieve layer at index "+ap+", but model only has "+this.layers.length+" layer(s).");return this.layers[ap]}if(np==null)throw new ValueError("Provide either a layer name or layer index");for(var sp=0,lp=this.layers;sp<lp.length;sp++){var up=lp[sp];if(up.name===np)return up}throw new ValueError("No such layer: "+np)},_d.prototype.calculateLosses=function(){var np=this;return je(function(){for(var ap=[],sp=0,lp=np.layers;sp<lp.length;sp++)for(var up=lp[sp],cp=0;cp<up.inboundNodes.length;++cp){var dp=_d.nodeKey(up,cp);np.containerNodes.has(dp)&&ap.push.apply(ap,up.calculateLosses())}return ap})},_d.prototype.getConfig=function(){for(var np={name:this.name},ap=this.buildNodeConversionMap(this.layers),sp=[],lp=0,up=this.layers;lp<up.length;lp++){for(var cp=(Ap=up[lp]).getClassName(),dp=Ap.getConfig(),hp=[],fp=0;fp<Ap.inboundNodes.length;fp++){var pp=Ap.inboundNodes[fp],mp=_d.nodeKey(Ap,fp),gp={};if(this.containerNodes.has(mp)){if(pp.callArgs)try{JSON.stringify(pp.callArgs),gp=pp.callArgs}catch{console.warn("Layer "+Ap.name+" was passed non-serializable keyword arguments: "+pp.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),gp={}}if(pp.inboundLayers.length>0){for(var yp=[],xp=0;xp<pp.inboundLayers.length;xp++){var _p=pp.inboundLayers[xp],vp=pp.nodeIndices[xp],bp=pp.tensorIndices[xp];(Tp=ap[_d.nodeKey(_p,vp)])==null&&(Tp=0),yp.push([_p.name,Tp,bp,gp])}hp.push(yp)}}}var Ep={};Ep.name=Ap.name,Ep.className=cp,Ep.config=dp,Ep.inboundNodes=hp,sp.push(Ep)}np.layers=sp;var Sp=[];for(xp=0;xp<this.inputLayers.length;xp++){var Ap=this.inputLayers[xp];vp=this.inputLayersNodeIndices[xp],mp=_d.nodeKey(Ap,vp),this.containerNodes.has(mp)&&((Tp=ap[mp])!==null&&Tp!==void 0||(Tp=0),bp=this.inputLayersTensorIndices[xp],Sp.push([Ap.name,Tp,bp]))}np.inputLayers=Sp;var Rp=[];for(xp=0;xp<this.outputLayers.length;xp++)if(Ap=this.outputLayers[xp],vp=this.outputLayersNodeIndices[xp],mp=_d.nodeKey(Ap,vp),this.containerNodes.has(mp)){var Tp;(Tp=ap[mp])!==null&&Tp!==void 0||(Tp=0),bp=this.outputLayersTensorIndices[xp],Rp.push([Ap.name,Tp,bp])}return np.outputLayers=Rp,np},_d.fromConfig=function(np,ap,sp,lp){lp===void 0&&(lp=!1);var up={},cp={};function dp(Lp,Bp){Lp.name in cp?cp[Lp.name].push(Bp):cp[Lp.name]=[Bp]}function hp(Lp,Bp){for(var Ip,kp=[],Up=0,Gp=Bp;Up<Gp.length;Up++){var Wp=Gp[Up],Qp=Wp[0],Xp=Wp[1],rm=Wp[2];if(Ip=Wp[3]==null?{}:Wp[3],!(Qp in up))return void dp(Lp,Bp);var Kp=up[Qp];if(Kp.inboundNodes.length<=Xp)return void dp(Lp,Bp);var lm=Kp.inboundNodes[Xp];kp.push(lm.outputTensors[rm])}kp.length>0&&Lp.apply(singletonOrArray(kp),Ip)}function fp(Lp){var Bp=Lp.name,Ip=deserialize(Lp,ap.customObjects!=null?ap.customObjects:{});Ip.setFastWeightInitDuringBuild(lp),up[Bp]=Ip,Lp.inboundNodes.forEach(function(kp){if(!(kp instanceof Array))throw new ValueError("Corrupted configuration, expected array for nodeData: "+kp);dp(Ip,kp)})}for(var pp=ap.name,mp=ap.layers,gp=0,yp=mp;gp<yp.length;gp++)fp(vp=yp[gp]);for(;!isObjectEmpty(cp);)for(var xp=0,_p=mp;xp<_p.length;xp++){var vp=_p[xp];if((jp=up[vp.name]).name in cp){var bp=cp[jp.name];delete cp[jp.name];for(var Ep=0,Sp=bp;Ep<Sp.length;Ep++)hp(jp,Sp[Ep])}}for(var Ap=[],Rp=[],Tp=0,Mp=ap.inputLayers;Tp<Mp.length;Tp++){var Op=(vp=Mp[Tp])[0],Pp=vp[1],$p=vp[2];assert(Op in up);var zp=(jp=up[Op]).inboundNodes[Pp].outputTensors;Ap.push(zp[$p])}for(var Dp=0,Fp=ap.outputLayers;Dp<Fp.length;Dp++){Op=(vp=Fp[Dp])[0],Pp=vp[1],$p=vp[2],assert(Op in up);var jp;zp=(jp=up[Op]).inboundNodes[Pp].outputTensors,Rp.push(zp[$p])}return new np({inputs:Ap,outputs:Rp,name:pp})},Object.defineProperty(_d.prototype,"stateful",{get:function(){if(this._stateful)throw new ValueError("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var np=0,ap=this.layers;np<ap.length;np++)if(ap[np].stateful)return!0;return!1},enumerable:!0,configurable:!0}),_d.prototype.resetStates=function(){var np=this;je(function(){np.layers.forEach(function(ap){ap.stateful&&ap.resetStates()})})},_d}(Layer);function standardizeSampleOrClassWeights(rp,_d,np){var ap=_d.length;if(rp==null||Array.isArray(rp)&&rp.length===0)return _d.map(function(lp){return null});if(ap===1)return Array.isArray(rp)&&rp.length===1?rp:typeof rp=="object"&&_d[0]in rp?[rp[_d[0]]]:[rp];if(Array.isArray(rp)){if(rp.length!==ap)throw new Error("Provided "+np+" is an array of "+rp.length+" element(s), but the model has "+ap+" outputs. Make sure a set of weights is provided for each model output.");return rp}if(typeof rp=="object"&&Object.keys(rp).length>0&&typeof rp[Object.keys(rp)[0]]=="object"){var sp=[];return _d.forEach(function(lp){lp in rp?sp.push(rp[lp]):sp.push(null)}),sp}throw new Error("The model has multiple ("+ap+") outputs, so "+np+" must be either an array with "+ap+" elements or an object with "+_d+" keys. Provided "+np+" not understood: "+JSON.stringify(rp))}function standardizeClassWeights(rp,_d){return standardizeSampleOrClassWeights(rp,_d,"classWeight")}function standardizeWeights(rp,_d,np,ap){return __awaiter$8(this,void 0,void 0,function(){var sp,lp,up,cp,dp;return __generator$8(this,function(hp){switch(hp.label){case 0:if(_d!=null||ap!=null)throw new Error("Support sampleWeight is not implemented yet");return np==null?[3,2]:(sp=je(function(){if(rp.shape.length===1)return rp.clone();if(rp.shape.length===2){if(rp.shape[1]>1)return rp.argMax(1);if(rp.shape[1]===1)return rp.reshape([rp.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+rp.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+rp.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),cp=(up=Array).from,[4,sp.data()]);case 1:return lp=cp.apply(up,[hp.sent()]),Xe(sp),dp=[],lp.forEach(function(fp){if(np[fp]==null)throw new Error("classWeight must contain all classes in the training data. The class "+fp+" exists in the data but not in classWeight");dp.push(np[fp])}),[2,Dn(dp,"float32")];case 2:return[2,null]}})})}function computeWeightedLoss(rp,_d){return tc(rp,_d)}var DEFAULT_VALIDATION_BATCH_SIZE=32;function standardizeDataIteratorOutput(rp,_d){var np,ap,sp=_d;np=sp.xs,ap=sp.ys,tt.assert(np!=null&&ap!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+_d});var lp=flattenTensorOrArrayOrMap("input",rp.inputNames,np),up=flattenTensorOrArrayOrMap("output",rp.outputNames,ap),cp=lp[0].shape[0];tt.assert(lp.length===rp.inputs.length,function(){return"LayersModel has "+rp.inputs.length+" inputs, but the dataset provides "+lp.length+" inputs.  (Expected input keys: "+JSON.stringify(rp.inputNames)+")"}),tt.assert(up.length===rp.outputs.length,function(){return"LayersModel has "+rp.outputs.length+" outputs, but the dataset provides "+up.length+" outputs.  (Expected output keys: "+JSON.stringify(rp.outputNames)+")"});var dp=function(mp){tt.assert(lp[mp].shape[0]===cp,function(){return"Batch size mismatch: input "+rp.inputNames[mp]+" has "+lp[mp].shape[0]+"; expected  "+cp+" based on input "+rp.inputNames[0]+"."})};for(var hp in lp)dp(hp);var fp=function(mp){tt.assert(up[mp].shape[0]===cp,function(){return"Batch size mismatch: output "+rp.outputNames[mp]+" has "+up[mp].shape[0]+"; expected  "+cp+" based on input "+rp.inputNames[0]+"."})};for(var pp in up)fp(pp);return{xs:lp,ys:up}}function flattenTensorOrArrayOrMap(rp,_d,np){if(np instanceof dt)return[np];if(Array.isArray(np))return tt.assert(np.length===_d.length,function(){return"Received an array of "+np.length+" Tensors, but expected "+_d.length+" to match the "+rp+" keys "+_d+"."}),np;for(var ap=[],sp=0,lp=_d;sp<lp.length;sp++){var up=lp[sp];if(np[up]==null)throw new ValueError("The feature data generated by the dataset lacks the required "+rp+" key '"+up+"'.");ap.push(np[up])}return ap}function standardizeTensorValidationData(rp){if(rp.length===3)throw new NotImplementedError("Validation with sample weights is not implemented yet.");return{xs:rp[0],ys:rp[1]}}function fitDataset(rp,_d,np){return __awaiter$8(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p,vp,bp,Ep,Sp,Ap,Rp,Tp,Mp,Op,Pp,$p,zp,Dp,Fp,jp,Lp,Bp,Ip,kp,Up;return __generator$8(this,function(Gp){switch(Gp.label){case 0:if(ap=np.batchesPerEpoch!=null,tt.assert(rp.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),tt.assert(np!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),tt.assert(np.epochs!=null&&np.epochs>0&&Number.isInteger(np.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+np.epochs}),tt.assert(!ap||np.batchesPerEpoch>0&&Number.isInteger(np.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+np.batchesPerEpoch}),tt.assert(np.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),rp.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");rp.isTraining=!0,Gp.label=1;case 1:return Gp.trys.push([1,,26,27]),sp=np.validationData!=null,lp=void 0,up=void 0,sp&&(isDatasetObject(np.validationData)?tt.assert(np.validationBatches==null||np.validationBatches>0&&Number.isInteger(np.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+np.validationBatches}):(cp=standardizeTensorValidationData(np.validationData),lp=cp.xs,up=cp.ys)),dp=rp.makeTrainFunction(),hp=rp.getDedupedMetricsNames(),fp=void 0,fp=sp?hp.slice().concat(hp.map(function(Wp){return"val_"+Wp})):hp.slice(),pp=standardizeCallbacks(np.callbacks,np.yieldEvery),mp=np.verbose==null?1:np.verbose,gp=configureCallbacks(pp,mp,np.epochs,null,null,getStepsPerEpoch(_d,np),null,sp,fp),yp=gp.callbackList,xp=gp.history,yp.setModel(rp),rp.history=xp,[4,yp.onTrainBegin()];case 2:return Gp.sent(),rp.stopTraining_=!1,_p=np.initialEpoch==null?0:np.initialEpoch,[4,_d.iterator()];case 3:vp=Gp.sent(),Gp.label=4;case 4:return _p<np.epochs?(bp={},[4,yp.onEpochBegin(_p)]):[3,23];case 5:return Gp.sent(),Ep=0,Sp=0,ap?[3,7]:[4,_d.iterator()];case 6:vp=Gp.sent(),Gp.label=7;case 7:return!ap||Ep<np.batchesPerEpoch?[4,vp.next()]:[3,21];case 8:return Ap=Gp.sent(),ap&&Ap.done?(console.warn("You provided `batchesPerEpoch` as "+np.batchesPerEpoch+", but your dataset iterator ran out of data after "+Ep+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+np.batchesPerEpoch*np.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):Ap.value==null?[3,15]:(Rp=standardizeDataIteratorOutput(rp,Ap.value),Tp=Rp.xs,Mp=Rp.ys,(Op={}).batch=Sp,Op.size=Tp[0].shape[0],[4,yp.onBatchBegin(Sp,Op)]);case 9:if(Gp.sent(),Pp=[],np.classWeight==null)return[3,13];$p=standardizeClassWeights(np.classWeight,rp.outputNames),Up=0,Gp.label=10;case 10:return Up<$p.length?(Dp=(zp=Pp).push,[4,standardizeWeights(Mp[Up],null,$p[Up])]):[3,13];case 11:Dp.apply(zp,[Gp.sent()]),Gp.label=12;case 12:return++Up,[3,10];case 13:for(Fp=Tp.concat(Mp).concat(Pp),jp=dp(Fp),Xe(Fp),Up=0;Up<hp.length;++Up)Lp=hp[Up],Bp=jp[Up],Op[Lp]=Bp,$e(Bp);return[4,yp.onBatchEnd(Sp,Op)];case 14:Gp.sent(),disposeTensorsInLogs(Op),Sp++,Ep++,Gp.label=15;case 15:return(ap?Ep>=np.batchesPerEpoch:Ap.done)?sp?(Ip=void 0,isDatasetObject(np.validationData)?(kp=toList,[4,rp.evaluateDataset(np.validationData,{batches:np.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return Ip=kp.apply(void 0,[Gp.sent()]),[3,18];case 17:Ip=toList(rp.evaluate(lp,up,{batchSize:np.validationBatchSize==null?DEFAULT_VALIDATION_BATCH_SIZE:np.validationBatchSize,verbose:0})),Gp.label=18;case 18:for(Up=0;Up<rp.metricsNames.length;++Up)bp["val_"+rp.metricsNames[Up]]=Ip[Up];Gp.label=19;case 19:return[3,21];case 20:return rp.stopTraining_?[3,21]:[3,7];case 21:return[4,yp.onEpochEnd(_p,bp)];case 22:return Gp.sent(),_p++,rp.stopTraining_?[3,23]:[3,4];case 23:return[4,yp.onTrainEnd()];case 24:return Gp.sent(),[4,rp.history.syncData()];case 25:return Gp.sent(),[2,rp.history];case 26:return rp.isTraining=!1,[7];case 27:return[2]}})})}function getStepsPerEpoch(rp,_d){var np=null;return _d.batchesPerEpoch!=null?np=_d.batchesPerEpoch:Number.isFinite(rp.size)&&(np=rp.size),np}function isDatasetObject(rp){return typeof rp.iterator=="function"}function isLazyIteratorObject(rp){return typeof rp.next=="function"}function evaluateDataset(rp,_d,np){return __awaiter$8(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp,fp,pp,mp;return __generator$8(this,function(gp){switch(gp.label){case 0:if(ap=(np=np||{}).batches!=null,sp=rp.testFunction,lp=[],np.verbose>0)throw new NotImplementedError("Verbose mode is not implemented yet.");return tt.assert(!ap||np.batches>0&&Number.isInteger(np.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(np.batches)}),isLazyIteratorObject(_d)?(cp=_d,[3,3]):[3,1];case 1:return[4,_d.iterator()];case 2:cp=gp.sent(),gp.label=3;case 3:up=cp,dp=0,hp=0,fp=function(){var yp;return __generator$8(this,function(xp){switch(xp.label){case 0:return[4,up.next()];case 1:return yp=xp.sent(),lp=je(function(){if(yp.value){var _p=standardizeDataIteratorOutput(rp,yp.value),vp=_p.xs,bp=_p.ys,Ep=vp.concat(bp),Sp=je(function(){return sp(Ep)});if(Xe(Ep),hp===0)for(var Ap=0;Ap<Sp.length;++Ap)lp.push(An(0));var Rp=Ep[0].shape[0],Tp=function(Mp){var Op=Sp[Mp],Pp=lp[Mp];lp[Mp]=je(function(){return Vs(lp[Mp],tc(Rp,Op))}),hp>0&&Xe(Pp)};for(Ap=0;Ap<Sp.length;++Ap)Tp(Ap);Xe(Sp),dp+=Rp,++hp}return lp}),yp.done?(ap&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+np.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},gp.label=4;case 4:return!ap||hp<np.batches?[5,fp()]:[3,6];case 5:return gp.sent()==="break"?[3,6]:[3,4];case 6:for(pp=0;pp<lp.length;++pp)mp=lp[pp],lp[pp]=qs(lp[pp],dp),Xe(mp);return[2,singletonOrArray(lp)]}})})}function checkBatchSize(rp){tt.assert(rp>0&&Number.isInteger(rp),function(){return"batchSize is required to be a positive integer, but got "+rp})}function sliceArrays(rp,_d,np){return rp==null?[null]:Array.isArray(rp)?rp.map(function(ap){return sliceAlongFirstAxis(ap,_d,np-_d)}):sliceAlongFirstAxis(rp,_d,np-_d)}function sliceArraysByIndices(rp,_d){return je(function(){return rp==null?null:Array.isArray(rp)?rp.map(function(np){return sliceArraysByIndices(np,_d)}):gather$1(rp,_d.dtype==="int32"?_d:_d.toInt())})}function makeBatches(rp,_d){for(var np=[],ap=0,sp=null;ap<rp;)(sp=ap+_d)>=rp&&(sp=rp),np.push([ap,sp]),ap=sp;return np}function fitLoop(rp,_d,np,ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp){return __awaiter$8(this,void 0,void 0,function(){var xp,_p,vp,bp,Ep,Sp,Ap,Rp;return __generator$8(this,function(Tp){switch(Tp.label){case 0:if(sp==null&&(sp=32),lp==null&&(lp=1),fp==null&&(fp=!0),mp==null&&(mp=0),xp=!1,dp!=null&&hp!=null&&(xp=!0),yp!=null&&(xp=!0,gp==null))throw new ValueError("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return(_p=rp.checkNumSamples(np,sp,gp,"steps_per_epoch"))!=null&&(vp=range(0,_p)),up==null&&(up=1),bp=configureCallbacks(cp,up,lp,mp,_p,gp,sp,xp,pp),Ep=bp.callbackList,Sp=bp.history,Ep.setModel(rp),rp.history=Sp,[4,Ep.onTrainBegin()];case 1:Tp.sent(),rp.stopTraining_=!1,Ap=function(Mp){var Op,Pp,$p,zp,Dp;return __generator$8(this,function(Fp){switch(Fp.label){case 0:return[4,Ep.onEpochBegin(Mp)];case 1:if(Fp.sent(),Op={},gp==null)return[3,2];throw new NotImplementedError("stepsPerEpoch mode is not implemented yet.");case 2:if(fp==="batch")throw new NotImplementedError("batch shuffling is not implemneted yet");fp&&tt.shuffle(vp),Pp=Dn(vp),$p=makeBatches(_p,sp),zp=function(jp){var Lp;return __generator$8(this,function(Bp){switch(Bp.label){case 0:return Lp={},[4,Ep.onBatchBegin(jp,Lp)];case 1:return Bp.sent(),je(function(){var Ip=$p[jp][0],kp=$p[jp][1],Up=sliceAlongFirstAxis(Pp,Ip,kp-Ip);Lp.batch=jp,Lp.size=kp-Ip;for(var Gp=sliceArraysByIndices(np,Up),Wp=_d(Gp),Qp=0;Qp<ap.length;++Qp){var Xp=ap[Qp],rm=Wp[Qp];Lp[Xp]=rm,$e(rm)}if(jp===$p.length-1&&xp){var Kp=rp.testLoop(dp,hp,sp);for(Qp=0;Qp<ap.length;++Qp)Xp=ap[Qp],rm=Kp[Qp],$e(rm),Op["val_"+Xp]=rm}}),[4,Ep.onBatchEnd(jp,Lp)];case 2:return Bp.sent(),disposeTensorsInLogs(Lp),rp.stopTraining_?[2,"break"]:[2]}})},Dp=0,Fp.label=3;case 3:return Dp<$p.length?[5,zp(Dp)]:[3,6];case 4:if(Fp.sent()==="break")return[3,6];Fp.label=5;case 5:return++Dp,[3,3];case 6:Pp.dispose(),Fp.label=7;case 7:return[4,Ep.onEpochEnd(Mp,Op)];case 8:return Fp.sent(),rp.stopTraining_?[2,"break"]:[2]}})},Rp=mp,Tp.label=2;case 2:return Rp<lp?[5,Ap(Rp)]:[3,5];case 3:if(Tp.sent()==="break")return[3,5];Tp.label=4;case 4:return++Rp,[3,2];case 5:return[4,Ep.onTrainEnd()];case 6:return Tp.sent(),[4,rp.history.syncData()];case 7:return Tp.sent(),[2,rp.history]}})})}function fitTensors(rp,_d,np,ap){return ap===void 0&&(ap={}),__awaiter$8(this,void 0,void 0,function(){var sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p,vp,bp,Ep,Sp,Ap,Rp,Tp,Mp,Op;return __generator$8(this,function(Pp){switch(Pp.label){case 0:if(rp.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");rp.isTraining=!0,Pp.label=1;case 1:return Pp.trys.push([1,,7,8]),checkBatchSize(pp=ap.batchSize==null?32:ap.batchSize),mp=!1,[4,rp.standardizeUserData(_d,np,ap.sampleWeight,ap.classWeight,mp,pp)];case 2:if(gp=Pp.sent(),sp=gp[0],lp=gp[1],fp=gp[2],yp=!1,xp=void 0,!(ap.validationData!=null&&ap.validationData.length>0))return[3,4];if(yp=!0,ap.validationData.length!==2)throw ap.validationData.length===3?new NotImplementedError("validationData including sample weights is not supported yet."):new ValueError("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+ap.validationData+" is invalid.");return up=ap.validationData[0],cp=ap.validationData[1],_p=!0,[4,rp.standardizeUserData(up,cp,null,null,_p,pp)];case 3:return vp=Pp.sent(),dp=vp[0],hp=vp[1],xp=dp.concat(hp),[3,5];case 4:ap.validationSplit!=null&&ap.validationSplit>0&&ap.validationSplit<1?(yp=!0,bp=Math.floor(sp[0].shape[0]*(1-ap.validationSplit)),Ep=sp[0].shape[0],dp=sliceArrays(sp,bp,Ep),sp=sliceArrays(sp,0,bp),hp=sliceArrays(lp,bp,Ep),lp=sliceArrays(lp,0,bp),xp=dp.concat(hp)):ap.validationSteps!=null&&(yp=!0),Pp.label=5;case 5:return Sp=sp.concat(lp).concat(fp),rp.checkTrainableWeightsConsistency(),Ap=rp.makeTrainFunction(),Rp=rp.getDedupedMetricsNames(),Tp=void 0,Mp=void 0,yp?(rp.makeTestFunction(),Tp=rp.testFunction,Mp=Rp.slice().concat(Rp.map(function($p){return"val_"+$p}))):(Tp=null,xp=[],Mp=Rp.slice()),Op=standardizeCallbacks(ap.callbacks,ap.yieldEvery),[4,fitLoop(rp,Ap,Sp,Rp,pp,ap.epochs,ap.verbose,Op,Tp,xp,ap.shuffle,Mp,ap.initialEpoch,null,null)];case 6:return[2,Pp.sent()];case 7:return rp.isTraining=!1,disposeNewTensors(sp,_d),disposeNewTensors(lp,np),disposeNewTensors(dp,up),disposeNewTensors(hp,cp),fp!=null&&Xe(fp),[7];case 8:return[2]}})})}function ensureTensorsRank2OrHigher(rp){var _d=[];rp instanceof dt&&(rp=[rp]);for(var np=0;np<rp.length;++np){var ap=rp[np];if(ap.rank===1)_d.push(expandDims$1(ap,1));else{if(ap.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");_d.push(ap)}}return _d}function disposeNewTensors(rp,_d){if(rp!=null){var np=[];if(_d instanceof dt)np.push(_d.id);else if(Array.isArray(_d))_d.forEach(function(dp){return np.push(dp.id)});else if(_d!=null)for(var ap in _d){var sp=_d[ap];np.push(sp.id)}var lp=[];if(rp instanceof dt)np.indexOf(rp.id)===-1&&lp.push(rp);else if(Array.isArray(rp))rp.forEach(function(dp){np.indexOf(dp.id)===-1&&lp.push(dp)});else if(rp!=null)for(var up in rp){var cp=rp[up];np.indexOf(cp.id)===-1&&lp.push(cp)}lp.forEach(function(dp){dp.isDisposed||dp.dispose()})}}function isDataTensor(rp){return rp instanceof dt}function isDataArray(rp){return Array.isArray(rp)}function isDataDict(rp){return!isDataTensor(rp)&&!isDataArray(rp)}function standardizeInputData(rp,_d,np,ap,sp){if(ap===void 0&&(ap=!0),sp===void 0&&(sp=""),_d==null||_d.length===0){if(rp!=null){var lp=!1;if(isDataArray(rp)&&rp.length>0)lp=!0;else if(isDataDict(rp)){for(var up in rp)if(rp.hasOwnProperty(up)){lp=!0;break}}else lp=!0;if(lp)throw new ValueError("Error when checking model "+sp+" expected no data, but got "+rp)}return[]}if(rp==null)return _d.map(function(_p){return null});var cp;if(isDataDict(rp)){rp=rp,cp=[];for(var dp=0,hp=_d;dp<hp.length;dp++){var fp=hp[dp];if(rp[fp]==null)throw new ValueError('No data provided for "'+fp+'". Need data for each key in: '+_d);cp.push(rp[fp])}}else if(isDataArray(rp)){if((rp=rp).length!==_d.length)throw new ValueError("Error when checking model "+sp+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+_d.length+" Tensor(s), but instead got the following list of Tensor(s): "+rp);cp=rp}else{if(rp=rp,_d.length>1)throw new ValueError("The model "+sp+" expects "+_d.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+rp.shape);cp=[rp]}if(cp=ensureTensorsRank2OrHigher(cp),np!=null){for(var pp=0;pp<_d.length;++pp)if(np[pp]!=null){var mp=cp[pp];if(mp.shape.length!==np[pp].length)throw new ValueError("Error when checking "+sp+": expected "+_d[pp]+" to have "+np[pp].length+" dimension(s). but got array with shape "+mp.shape);for(var gp=0;gp<np[pp].length;++gp)if(gp!==0||ap){var yp=mp.shape[gp],xp=np[pp][gp];if(xp!=null&&xp>=0&&yp!==xp)throw new ValueError("Error when checking "+sp+": expected "+_d[pp]+" to have shape ["+np[pp]+"], but got array with shape ["+mp.shape+"].")}}}return cp}function checkArrayLengths(rp,_d,np){var ap=unique(rp.map(function(lp){return lp.shape[0]}));ap.sort();var sp=unique(_d.map(function(lp){return lp.shape[0]}));if(sp.sort(),ap.length>1)throw new ValueError("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(rp.map(function(lp){return lp.shape})));if(sp.length>1)throw new ValueError("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(_d.map(function(lp){return lp.shape})));if(ap.length>0&&sp.length>0&&!tt.arraysEqual(ap,sp))throw new ValueError("Input Tensors should have the same number of samples as target Tensors. Found "+ap[0]+" input sample(s) and "+sp[0]+" target sample(s).")}function checkLossAndTargetCompatibility(rp,_d,np){for(var ap=[meanSquaredError,binaryCrossentropy,categoricalCrossentropy],sp=0;sp<rp.length;++sp){var lp=rp[sp],up=_d[sp],cp=np[sp];if(up!=null){if(up===categoricalCrossentropy&&lp.shape[lp.shape.length-1]===1)throw new ValueError("You are passing a target array of shape "+lp.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(ap.indexOf(up)!==-1)for(var dp=lp.shape.slice(1),hp=cp.slice(1),fp=0;fp<dp.length;++fp){var pp=dp[fp],mp=hp[fp];if(mp!=null&&pp!==mp)throw new ValueError("A target Tensor with shape "+lp.shape+" was passed for an output of shape "+cp+", while using a loss function that expects targets to have the same shape as the output.")}}}}function checkInputData(rp,_d,np,ap,sp){var lp;if(ap===void 0&&(ap=!0),sp===void 0&&(sp=""),Array.isArray(rp)){if(rp.length!==_d.length)throw new ValueError("Error when checking model "+sp+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+_d.length+" Tensor(s), but instead got "+rp.length+" Tensors(s).");lp=rp}else{if(_d.length>1)throw new ValueError("The model expects "+_d.length+" "+sp+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(rp.shape)+".");lp=[rp]}if(np!=null){for(var up=0;up<_d.length;++up)if(np[up]!=null){var cp=lp[up];if(cp.shape.length!==np[up].length)throw new ValueError("Error when checking "+sp+": expected "+_d[up]+" to have "+np[up].length+" dimension(s), but got array with shape "+JSON.stringify(cp.shape));for(var dp=0;dp<np[up].length;++dp)if(dp!==0||ap){var hp=cp.shape[dp],fp=np[up][dp];if(fp!=null&&fp!==hp)throw new ValueError("Error when checking "+sp+": expected "+_d[up]+" to have shape "+JSON.stringify(np[up])+" but got array with shape "+JSON.stringify(cp.shape)+".")}}}}function collectMetrics(rp,_d){if(rp==null||Array.isArray(rp)&&rp.length===0)return _d.map(function(dp){return[]});var np;if(typeof rp=="string"||typeof rp=="function")np=[rp];else{if(!Array.isArray(rp)&&typeof rp!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+rp);np=rp}if(Array.isArray(np))return _d.map(function(dp){return np});for(var ap=[],sp=0,lp=_d;sp<lp.length;sp++){var up=lp[sp],cp=np.hasOwnProperty(up)?np[up]:[];Array.isArray(cp)||(cp=[cp]),ap.push(cp)}return ap}var LAYERS_MODEL_FORMAT_NAME="layers-model",LayersModel=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.isTraining=!1,ap}return __extends$h(_d,rp),_d.prototype.summary=function(np,ap,sp){if(sp===void 0&&(sp=console.log),!this.built)throw new ValueError("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");printSummary(this,np,ap,sp)},_d.prototype.compile=function(np){var ap=this;if(np.loss==null&&(np.loss=[]),this.loss=np.loss,typeof np.optimizer=="string")this.optimizer_=getOptimizer(np.optimizer),this.isOptimizerOwned=!0;else{if(!(np.optimizer instanceof Hf))throw new ValueError("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=np.optimizer,this.isOptimizerOwned=!1}var sp=[];if(Array.isArray(np.loss)||typeof np.loss=="string"||typeof np.loss=="function")if(Array.isArray(np.loss)){if(np.loss.length!==this.outputs.length)throw new ValueError("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+np.loss+".");var lp=np.loss;sp=lp.map(function(_p){return get(_p)})}else{var up=get(np.loss);this.outputs.forEach(function(_p){sp.push(up)})}else{for(var cp in np.loss=np.loss,np.loss)if(this.outputNames.indexOf(cp)===-1)throw new ValueError('Unknown entry in loss dictionary: "'+cp+'". Only expected the following keys: '+this.outputNames);for(var dp=0,hp=this.outputNames;dp<hp.length;dp++){var fp=hp[dp];np.loss[fp]==null&&console.warn('Output "'+fp+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+fp+" during training"),sp.push(get(np.loss[fp]))}}this.lossFunctions=sp,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var pp=0;pp<this.outputs.length;++pp){var mp=this.internalOutputShapes[pp],gp=this.outputNames[pp];this.feedOutputNames.push(gp),this.feedOutputShapes.push(mp),this.feedLossFns.push(this.lossFunctions[pp])}var yp=[];this.metrics=np.metrics,this.metricsNames=["loss"],this.metricsTensors=[],nameScope("loss",function(){for(var _p=0;_p<ap.outputs.length;++_p)if(yp.indexOf(_p)===-1){var vp=ap.lossFunctions[_p];ap.outputs.length>1&&(ap.metricsTensors.push([vp,_p]),ap.metricsNames.push(ap.outputNames[_p]+"_loss"))}});var xp=collectMetrics(np.metrics,this.outputNames);nameScope("metric",function(){for(var _p=function(bp){if(yp.indexOf(bp)!==-1)return"continue";(function(Ep){for(var Sp,Ap,Rp,Tp=function(Pp){if(typeof Pp=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(Pp)!==-1){var $p=ap.internalOutputShapes[bp];$p[$p.length-1]===1||ap.lossFunctions[bp]===binaryCrossentropy?["accuracy","acc"].indexOf(Pp)!==-1?Ap=binaryAccuracy:["crossentropy","ce"].indexOf(Pp)!==-1&&(Ap=binaryCrossentropy$1):ap.lossFunctions[bp]===sparseCategoricalCrossentropy?["accuracy","acc"].indexOf(Pp)!==-1?Ap=sparseCategoricalAccuracy:["crossentropy","ce"].indexOf(Pp)!==-1&&(Ap=sparseCategoricalCrossentropy$1):["accuracy","acc"].indexOf(Pp)!==-1?Ap=categoricalAccuracy:["crossentropy","ce"].indexOf(Pp)!==-1&&(Ap=categoricalCrossentropy$1);var zp=void 0;["accuracy","acc"].indexOf(Pp)!==-1?zp="acc":["crossentropy","ce"].indexOf(Pp)!==-1&&(zp="ce"),Rp=Ap,Sp=""+zp}else{var Dp=get$1(Pp);Rp=Dp,Sp=""+getLossOrMetricName(Pp)}var Fp;nameScope(Sp,function(){Fp=Rp}),function(jp,Lp,Bp){ap.outputNames.length>1&&(Lp=ap.outputNames[jp]+"_"+Lp),ap.metricsNames.push(Lp),ap.metricsTensors.push([Bp,jp])}(bp,Sp,Fp)},Mp=0,Op=Ep;Mp<Op.length;Mp++)Tp(Op[Mp])})(xp[bp])},vp=0;vp<ap.outputs.length;++vp)_p(vp)}),this.collectedTrainableWeights=this.trainableWeights},_d.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},_d.prototype.evaluate=function(np,ap,sp){sp===void 0&&(sp={});var lp=sp.batchSize==null?32:sp.batchSize;checkBatchSize(lp);var up=this.standardizeUserDataXY(np,ap,!0,lp);try{var cp=up[0].concat(up[1]);this.makeTestFunction();var dp=this.testFunction;return singletonOrArray(this.testLoop(dp,cp,lp,sp.verbose,sp.steps))}finally{disposeNewTensors(up[0],np),disposeNewTensors(up[1],ap)}},_d.prototype.evaluateDataset=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(sp){return this.makeTestFunction(),[2,evaluateDataset(this,np,ap)]})})},_d.prototype.checkNumSamples=function(np,ap,sp,lp){var up;if(lp===void 0&&(lp="steps"),sp!=null){if(up=null,ap!=null)throw new ValueError("If "+lp+" is set, batchSize must be null or undefined.Got batchSize = "+ap)}else{if(np==null)throw new ValueError("Either the input data should have a defined shape, or "+lp+" shoud be specified.");up=Array.isArray(np)?np[0].shape[0]:np.shape[0]}return up},_d.prototype.execute=function(np,ap){if(Array.isArray(ap)&&ap.length===0)throw new ValueError("`outputs` is an empty Array, which is not allowed.");var sp=Array.isArray(ap),lp=sp?ap:[ap],up=this.retrieveSymbolicTensors(lp),cp=new FeedDict;if(np instanceof dt&&(np=[np]),Array.isArray(np)){if(np.length!==this.inputs.length)throw new ValueError("The number of inputs provided ("+np.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var dp=0;dp<this.inputs.length;++dp)cp.add(this.inputs[dp],np[dp])}else for(var hp=0,fp=this.inputs;hp<fp.length;hp++){var pp=fp[hp],mp=np[pp.name];if(mp==null)throw new ValueError("No value is provided for the model's input "+pp.name);cp.add(pp,mp)}var gp=execute(up,cp);return sp?gp:gp[0]},_d.prototype.retrieveSymbolicTensors=function(np){for(var ap=pyListRepeat(null,np.length),sp=np.length,lp=0,up=this.layers;lp<up.length;lp++){for(var cp=up[lp],dp=Array.isArray(cp.output)?cp.output:[cp.output],hp=dp.map(function(gp){return gp.name}),fp=0;fp<np.length;++fp){var pp=hp.indexOf(np[fp]);if(pp!==-1&&(ap[fp]=dp[pp],sp--),sp===0)break}if(sp===0)break}if(sp>0){var mp=[];throw ap.forEach(function(gp,yp){gp==null&&mp.push(np[yp])}),new ValueError("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(mp))}return ap},_d.prototype.predictLoop=function(np,ap,sp){var lp=this;return ap===void 0&&(ap=32),sp===void 0&&(sp=!1),je(function(){var up=lp.checkNumSamples(np);if(sp)throw new NotImplementedError("Verbose predictLoop() is not implemented yet.");for(var cp=makeBatches(up,ap),dp=lp.outputs.map(function(pp){return[]}),hp=function(pp){je(function(){var mp=cp[pp][0],gp=cp[pp][1],yp=sliceArrays(np,mp,gp),xp=[];if(Array.isArray(yp))for(var _p=0;_p<yp.length;++_p)xp.push({key:lp.inputs[_p],value:yp[_p]});else xp.push({key:lp.inputs[0],value:yp});var vp=new FeedDict(xp);return execute(lp.outputs,vp)}).forEach(function(mp,gp){return dp[gp].push(mp)})},fp=0;fp<cp.length;++fp)hp(fp);return singletonOrArray(dp.map(function(pp){return Gn(pp,0)}))})},_d.prototype.predict=function(np,ap){ap===void 0&&(ap={});var sp=ensureTensorsRank2OrHigher(np);checkInputData(sp,this.inputNames,this.feedInputShapes,!1);try{var lp=ap.batchSize==null?32:ap.batchSize;return checkBatchSize(lp),this.predictLoop(sp,lp)}finally{disposeNewTensors(sp,np)}},_d.prototype.predictOnBatch=function(np){checkInputData(np,this.inputNames,this.feedInputShapes,!0);var ap=(Array.isArray(np)?np[0]:np).shape[0];return this.predictLoop(np,ap)},_d.prototype.standardizeUserDataXY=function(np,ap,sp,lp){if(this.optimizer_==null)throw new RuntimeError("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var up=[],cp=0;cp<this.feedOutputShapes.length;++cp){var dp=this.feedOutputShapes[cp];this.feedLossFns[cp]===sparseCategoricalCrossentropy?up.push(dp.slice(0,dp.length-1).concat([1])):up.push(dp)}if(checkArrayLengths(np=standardizeInputData(np,this.feedInputNames,this.feedInputShapes,!1,"input"),ap=standardizeInputData(ap,this.feedOutputNames,up,!1,"target")),checkLossAndTargetCompatibility(ap,this.feedLossFns,this.feedOutputShapes),this.stateful&&lp!=null&&lp>0&&np[0].shape[0]%lp!=0)throw new ValueError("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+lp+". Found: "+np[0].shape[0]+" sample(s).");return[np,ap]},_d.prototype.standardizeUserData=function(np,ap,sp,lp,up,cp){return up===void 0&&(up=!0),__awaiter$8(this,void 0,void 0,function(){var dp,hp,fp,pp,mp,gp,yp,xp;return __generator$8(this,function(_p){switch(_p.label){case 0:if(dp=this.standardizeUserDataXY(np,ap,up,cp),hp=dp[0],fp=dp[1],sp!=null)throw new Error("sample weight is not supported yet.");if(pp=null,lp==null)return[3,4];mp=standardizeClassWeights(lp,this.outputNames),pp=[],gp=0,_p.label=1;case 1:return gp<mp.length?(xp=(yp=pp).push,[4,standardizeWeights(fp[gp],null,mp[gp])]):[3,4];case 2:xp.apply(yp,[_p.sent()]),_p.label=3;case 3:return++gp,[3,1];case 4:return[2,[hp,fp,pp]]}})})},_d.prototype.testLoop=function(np,ap,sp,lp,up){var cp=this;return lp===void 0&&(lp=0),je(function(){var dp=cp.checkNumSamples(ap,sp,up,"steps"),hp=[];if(lp>0)throw new NotImplementedError("Verbose mode is not implemented yet.");if(up!=null)throw new NotImplementedError("steps mode in testLoop() is not implemented yet");for(var fp=makeBatches(dp,sp),pp=Dn(range(0,dp)),mp=0;mp<fp.length;++mp){var gp=fp[mp][0],yp=fp[mp][1],xp=sliceAlongFirstAxis(pp,gp,yp-gp),_p=sliceArraysByIndices(ap,xp),vp=np(_p);if(mp===0)for(var bp=0;bp<vp.length;++bp)hp.push(An(0));for(bp=0;bp<vp.length;++bp){var Ep=vp[bp];hp[bp]=Vs(hp[bp],tc(yp-gp,Ep))}}for(bp=0;bp<hp.length;++bp)hp[bp]=qs(hp[bp],dp);return hp})},_d.prototype.getDedupedMetricsNames=function(){for(var np=this.metricsNames,ap=[],sp=0;sp<np.length;++sp){var lp=np[sp],up=lp;count(np,lp)>1&&(up+="_"+count(np.slice(0,sp),lp)),ap.push(up)}return ap},_d.prototype.makeTrainFunction=function(){var np=this;return function(ap){var sp=[],lp=ap.slice(0,np.inputs.length),up=ap.slice(np.inputs.length,np.inputs.length+np.outputs.length),cp=ap.slice(np.inputs.length+np.outputs.length,np.inputs.length+2*np.outputs.length),dp=[],hp=np.collectedTrainableWeights.map(function(fp){return fp.read()});return[np.optimizer_.minimize(function(){for(var fp=[],pp=0;pp<np.inputs.length;++pp)fp.push({key:np.inputs[pp],value:lp[pp]});var mp,gp=new FeedDict(fp),yp=execute(np.outputs,gp,{training:!0});for(pp=0;pp<np.lossFunctions.length;++pp){var xp=(0,np.lossFunctions[pp])(up[pp],yp[pp]);cp[pp]!=null&&(xp=computeWeightedLoss(xp,cp[pp]));var _p=fl(xp);sp.push(_p),mp=pp===0?xp:Vs(mp,xp)}for(pp=0;pp<np.metricsTensors.length;++pp){var vp=void 0;if(np.outputs.length>1&&pp<np.outputs.length)vp=sp[pp];else{var bp=np.metricsTensors[pp][0],Ep=np.metricsTensors[pp][1];vp=fl(bp(up[Ep],yp[Ep]))}$e(vp),dp.push(vp)}return mp=fl(mp),np.calculateLosses().forEach(function(Sp){mp=Vs(mp,Sp)}),mp},!0,hp)].concat(dp)}},_d.prototype.makeTestFunction=function(){var np=this;this.testFunction=function(ap){return je(function(){for(var sp,lp=[],up=ap.slice(0,np.inputs.length),cp=ap.slice(np.inputs.length,np.inputs.length+np.outputs.length),dp=[],hp=0;hp<np.inputs.length;++hp)dp.push({key:np.inputs[hp],value:up[hp]});var fp=new FeedDict(dp),pp=execute(np.outputs,fp);for(hp=0;hp<np.lossFunctions.length;++hp){var mp=np.lossFunctions[hp],gp=fl(mp(cp[hp],pp[hp]));sp=hp===0?gp:Vs(sp,gp),lp.push(sp)}for(hp=0;hp<np.metricsTensors.length;++hp){var yp=np.metricsTensors[hp][0],xp=np.metricsTensors[hp][1],_p=fl(yp(cp[xp],pp[xp]));lp.push(_p)}return lp})}},_d.prototype.fit=function(np,ap,sp){return sp===void 0&&(sp={}),__awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(lp){return[2,fitTensors(this,np,ap,sp)]})})},_d.prototype.fitDataset=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(sp){return[2,fitDataset(this,np,ap)]})})},_d.prototype.trainOnBatch=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){var sp,lp,up,cp,dp,hp,fp,pp,mp;return __generator$8(this,function(gp){switch(gp.label){case 0:return[4,this.standardizeUserData(np,ap)];case 1:sp=gp.sent(),lp=sp[0],up=sp[1],cp=this.makeTrainFunction(),dp=cp(lp.concat(up)),hp=[],fp=0,pp=dp,gp.label=2;case 2:return fp<pp.length?[4,pp[fp].data()]:[3,5];case 3:mp=gp.sent(),hp.push(mp[0]),gp.label=4;case 4:return fp++,[3,2];case 5:return Xe(dp),[2,singletonOrArray(hp)]}})})},_d.prototype.getNamedWeights=function(np){for(var ap=[],sp=np!=null&&np.trainableOnly,lp=sp?this.trainableWeights:this.weights,up=this.getWeights(sp),cp=0;cp<lp.length;++cp)sp&&!lp[cp].trainable||ap.push({name:lp[cp].originalName,tensor:up[cp]});return ap},Object.defineProperty(_d.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(np){this.stopTraining_=np},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(np){this.optimizer_!==np&&(this.optimizer_=np,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),_d.prototype.dispose=function(){var np=rp.prototype.dispose.call(this);if(np.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var ap=qe().numTensors;this.optimizer_.dispose(),np.numDisposedVariables+=ap-qe().numTensors}return np},_d.prototype.getLossIdentifiers=function(){var np;if(typeof this.loss=="string")np=toSnakeCase(this.loss);else if(Array.isArray(this.loss)){for(var ap=0,sp=this.loss;ap<sp.length;ap++)if(typeof sp[ap]!="string")throw new Error("Serialization of non-string loss is not supported.");np=this.loss.map(function(fp){return toSnakeCase(fp)})}else{var lp=Object.keys(this.loss);np={};for(var up=this.loss,cp=0,dp=lp;cp<dp.length;cp++){var hp=dp[cp];if(typeof up[hp]!="string")throw new Error("Serialization of non-string loss is not supported.");np[hp]=toSnakeCase(up[hp])}}return np},_d.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[toSnakeCase(getLossOrMetricName(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(sp){return toSnakeCase(getLossOrMetricName(sp))});var np={};for(var ap in this.metrics)np[ap]=toSnakeCase(getLossOrMetricName(this.metrics[ap]));return np},_d.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},_d.prototype.loadTrainingConfig=function(np){if(np.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(np.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(np.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var ap,sp,lp=deserialize(convertPythonicToTs(np.optimizer_config));if(typeof np.loss=="string")ap=toCamelCase$1(np.loss);else if(Array.isArray(np.loss))ap=np.loss.map(function(cp){return toCamelCase$1(cp)});else if(np.loss!=null)for(var up in ap={},np.loss)ap[up]=toCamelCase$1(np.loss[up]);if(Array.isArray(np.metrics))sp=np.metrics.map(function(cp){return toCamelCase$1(cp)});else if(np.metrics!=null)for(var up in sp={},np.metrics)sp[up]=toCamelCase$1(np.metrics[up]);this.compile({loss:ap,metrics:sp,optimizer:lp})},_d.prototype.save=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){var sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p,vp;return __generator$8(this,function(bp){switch(bp.label){case 0:if(typeof np=="string"){if((sp=Sf.getSaveHandlers(np)).length===0)throw new ValueError("Cannot find any save handlers for URL '"+np+"'");if(sp.length>1)throw new ValueError("Found more than one ("+sp.length+") save handlers for URL '"+np+"'");np=sp[0]}if(np.save==null)throw new ValueError("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,Sf.encodeWeights(this.getNamedWeights(ap))];case 1:return lp=bp.sent(),up=!1,cp=null,dp=this.toJSON(cp,up),hp={modelTopology:dp,format:LAYERS_MODEL_FORMAT_NAME,generatedBy:"TensorFlow.js tfjs-layers v"+version$9,convertedBy:null},ap!=null&&ap.includeOptimizer&&this.optimizer!=null?(hp.trainingConfig=this.getTrainingConfig(),fp="optimizer",xp=(yp=Sf).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,xp.apply(yp,[bp.sent(),fp])];case 3:pp=bp.sent(),mp=pp.data,gp=pp.specs,(vp=lp.specs).push.apply(vp,gp),lp.data=Sf.concatenateArrayBuffers([lp.data,mp]),bp.label=4;case 4:return this.userDefinedMetadata!=null&&(_p=!0,checkUserDefinedMetadata(this.userDefinedMetadata,this.name,_p),hp.userDefinedMetadata=this.userDefinedMetadata),hp.weightData=lp.data,hp.weightSpecs=lp.specs,[2,np.save(hp)]}})})},_d.prototype.setUserDefinedMetadata=function(np){checkUserDefinedMetadata(np,this.name),this.userDefinedMetadata=np},_d.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},_d.className="Model",_d}(Container);function modelFromJSON(rp,_d){return __awaiter$8(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp,hp;return __generator$8(this,function(fp){switch(fp.label){case 0:return"modelTopology"in rp||(rp={modelTopology:rp}),(np=(rp=rp).modelTopology).model_config!=null&&(np=np.model_config),ap=convertPythonicToTs(np),sp=deserialize(ap,_d),rp.weightsManifest==null?[3,2]:[4,Sf.loadWeights(rp.weightsManifest,rp.pathPrefix,sp.weights.map(function(pp){return pp.originalName}))];case 1:for(lp=fp.sent(),up={},cp=0,dp=sp.weights;cp<dp.length;cp++)hp=dp[cp],up[hp.originalName]=lp[hp.originalName];sp.loadWeights(up),Xe(lp),fp.label=2;case 2:return[2,sp]}})})}function loadLayersModelInternal(rp,_d){return __awaiter$8(this,void 0,void 0,function(){var np;return __generator$8(this,function(ap){if(_d==null&&(_d={}),typeof rp=="string"){if((np=Sf.getLoadHandlers(rp,_d.onProgress)).length===0)np.push(Sf.browserHTTPRequest(rp,_d));else if(np.length>1)throw new ValueError("Found more than one ("+np.length+") load handlers for URL '"+rp+"'");rp=np[0]}return[2,loadLayersModelFromIOHandler(rp,void 0,_d)]})})}function loadLayersModelFromIOHandler(rp,_d,np){return __awaiter$8(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp,fp,pp;return __generator$8(this,function(mp){switch(mp.label){case 0:if(np==null&&(np={}),rp.load==null)throw new ValueError("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,rp.load()];case 1:if(ap=mp.sent(),(sp=ap.modelTopology).model_config!=null&&(sp=sp.model_config),lp=np.strict==null||np.strict,up=ap.weightData!=null&&ap.weightSpecs!=null&&lp,cp=deserialize(convertPythonicToTs(sp),_d,up),(dp=ap.trainingConfig)!=null&&cp.loadTrainingConfig(dp),ap.userDefinedMetadata!=null&&cp.setUserDefinedMetadata(ap.userDefinedMetadata),ap.weightData==null)return[3,4];if(ap.weightSpecs==null)throw new ValueError("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return hp=decodeModelAndOptimizerWeights(ap.weightData,ap.weightSpecs),fp=hp.modelWeights,pp=hp.optimizerWeights,cp.loadWeights(fp,lp),cp.optimizer!=null&&pp.length>0?[4,cp.optimizer.setWeights(pp)]:[3,3];case 2:mp.sent(),mp.label=3;case 3:Xe(fp),Xe(pp.map(function(gp){return gp.tensor})),mp.label=4;case 4:return[2,cp]}})})}function decodeModelAndOptimizerWeights(rp,_d){var np=Sf.decodeWeights(rp,_d),ap={},sp=[];return _d.forEach(function(lp){lp.group==="optimizer"?sp.push({name:lp.name,tensor:np[lp.name]}):ap[lp.name]=np[lp.name]}),{modelWeights:ap,optimizerWeights:sp}}Mf.registerClass(LayersModel);var Sequential=function(rp){function _d(np){var ap=rp.call(this,{inputs:[],outputs:[]})||this;if(np=np||{},ap.trainable=!0,ap.built=!1,ap.name=np.name!=null?np.name:getUid("sequential_"),np.layers!=null)for(var sp=0,lp=np.layers;sp<lp.length;sp++){var up=lp[sp];ap.add(up)}return ap}return __extends$h(_d,rp),_d.prototype.checkShape=function(np){if(np.inboundNodes[0].outputTensors[0].shape.some(function(ap){return ap<0}))throw new ValueError("Negative dimension size caused by adding layer "+np.name+" with input shape ["+np.inboundNodes[0].inputTensors[0].shape+"]")},_d.prototype.add=function(np){var ap,sp=np instanceof _d||np instanceof LayersModel;if(sp){if((ap=np).outputs.length!==1)throw new ValueError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(ap.inputs.length!==1)throw new ValueError("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(np.inboundNodes.length===0){if(np.batchInputShape==null)throw new ValueError("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var lp=Input({batchShape:np.batchInputShape,dtype:np.dtype,name:np.name+"_input"});np.apply(lp)}if(sp)this.outputs=ap.outputs,this.inputs=ap.inputs;else{if(np.inboundNodes.length!==1)throw new ValueError("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+np.name+" which has "+np.inboundNodes.length+" pre-existing inbound connections.");if(np.inboundNodes[0].outputTensors.length!==1)throw new ValueError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(np),this.outputs=[np.inboundNodes[0].outputTensors[0]],this.inputs=getSourceInputs(this.outputs[0])}this.inboundNodes=[],new Node$1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:pyListRepeat(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(cp){return cp.shape}),outputShapes:this.outputs[0].shape})}else{var up=np.apply(this.outputs[0]);if(Array.isArray(up))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(np),this.outputs=[up],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(np),this.built=!1},_d.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var np=this.layers.length-1;this.layers[np].outboundNodes=[],this.outputs=[this.layers[np].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},_d.prototype.call=function(np,ap){return this.model==null&&this.build(),this.model.call(np,ap)},_d.prototype.build=function(np){if(getExactlyOneShape(np),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new LayersModel({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},_d.prototype.countParams=function(){return this.built||this.build(),rp.prototype.countParams.call(this)},_d.prototype.summary=function(np,ap,sp){sp===void 0&&(sp=console.log),this.built||this.build(),rp.prototype.summary.call(this,np,ap,sp)},_d.prototype.setWeights=function(np){this.model==null&&this.build(),this.model.setWeights(np)},_d.prototype.evaluate=function(np,ap,sp){if(sp===void 0&&(sp={}),!this.built)throw new RuntimeError("The model needs to be compiled before being used.");return this.model.evaluate(np,ap,sp)},_d.prototype.evaluateDataset=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(sp){if(!this.built)throw new RuntimeError("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(np,ap)]})})},_d.prototype.predict=function(np,ap){return ap===void 0&&(ap={}),this.model==null&&this.build(),this.model.predict(np,ap)},_d.prototype.predictOnBatch=function(np){return this.model==null&&this.build(),this.model.predictOnBatch(np)},_d.prototype.compile=function(np){this.build(),this.model.compile(np),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(_d.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(np){this.model.optimizer=np},enumerable:!0,configurable:!0}),_d.prototype.fit=function(np,ap,sp){return sp===void 0&&(sp={}),__awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(lp){if(!this.built)throw new RuntimeError("The model needs to be compiled before being used.");return[2,this.model.fit(np,ap,sp)]})})},_d.prototype.fitDataset=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(sp){if(!this.built)throw new RuntimeError("The model needs to be compiled before being used.");return[2,this.model.fitDataset(np,ap)]})})},_d.prototype.trainOnBatch=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(sp){return[2,this.model.trainOnBatch(np,ap)]})})},_d.fromConfig=function(np,ap,sp,lp){var up;lp===void 0&&(lp=!1);var cp={};if(ap instanceof Array){if(ap[0].className==null||ap[0].className==="Merge")throw new ValueError("Legacy serialization format not supported yet.");up=ap}else tt.assert(ap.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),up=ap.layers,delete ap.layers,cp=ap;var dp=new np(cp);if(!(dp instanceof _d))throw new NotImplementedError("Sequential.fromConfig called on non-Sequential input: "+dp);for(var hp=0,fp=up;hp<fp.length;hp++){var pp=deserialize(fp[hp],void 0,lp);lp&&pp.setFastWeightInitDuringBuild(!0),dp.add(pp)}return dp},Object.defineProperty(_d.prototype,"stopTraining",{get:function(){if(this.model==null)throw new ValueError("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(np){if(this.model==null)throw new ValueError("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=np},enumerable:!0,configurable:!0}),_d.prototype.getConfig=function(){for(var np=[],ap=0,sp=this.layers;ap<sp.length;ap++){var lp=sp[ap],up={};up.className=lp.getClassName(),up.config=lp.getConfig(),np.push(up)}return{name:this.name,layers:np}},_d.className="Sequential",_d}(LayersModel);function model(rp){return new LayersModel(rp)}function sequential(rp){return new Sequential(rp)}function loadLayersModel(rp,_d){return _d==null&&(_d={}),loadLayersModelInternal(rp,_d)}function input(rp){return Input(rp)}function registerCallbackConstructor(rp,_d){CallbackConstructorRegistry.registerCallbackConstructor(rp,_d)}Mf.registerClass(Sequential);var Activation=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.getConfig=function(){return{}},_d}(Mf.Serializable),Elu=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){return ap===void 0&&(ap=1),elu$1(np,ap)},_d.className="elu",_d}(Activation);Mf.registerClass(Elu);var Selu=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return Cl(np)},_d.className="selu",_d}(Activation);Mf.registerClass(Selu);var Relu=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return bl(np)},_d.className="relu",_d}(Activation);Mf.registerClass(Relu);var Relu6=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return je(function(){return Ys(6,bl(np))})},_d.className="relu6",_d}(Activation);Mf.registerClass(Relu6);var Linear=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return np},_d.className="linear",_d}(Activation);Mf.registerClass(Linear);var Sigmoid=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return cs(np)},_d.className="sigmoid",_d}(Activation);Mf.registerClass(Sigmoid);var HardSigmoid=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return hardSigmoid(np)},_d.className="hardSigmoid",_d}(Activation);Mf.registerClass(HardSigmoid);var Softplus=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return ms(np)},_d.className="softplus",_d}(Activation);Mf.registerClass(Softplus);var Softsign=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return softsign(np)},_d.className="softsign",_d}(Activation);Mf.registerClass(Softsign);var Tanh=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np){return bs(np)},_d.className="tanh",_d}(Activation);Mf.registerClass(Tanh);var Softmax=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){return ap===void 0&&(ap=-1),io(np,ap)},_d.className="softmax",_d}(Activation);Mf.registerClass(Softmax);var LogSoftmax=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.apply=function(np,ap){return ap===void 0&&(ap=-1),uo(np,ap)},_d.className="logSoftmax",_d}(Activation);function serializeActivation(rp){return rp.getClassName()}function deserializeActivation(rp,_d){return _d===void 0&&(_d={}),deserializeKerasObject(rp,Mf.SerializationMap.getMap().classNameMap,_d,"activation")}function getActivation(rp){var _d;return rp==null?deserializeActivation(_d={className:"linear",config:{}}):typeof rp=="string"?((_d={}).className=rp,_d.config={},deserializeActivation(_d)):rp instanceof Activation?rp:deserializeActivation(rp)}function assertObjectArgs(rp){if(rp!=null&&typeof rp!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+rp)}Mf.registerClass(LogSoftmax);var Regularizer=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d}(Mf.Serializable),L1L2=function(rp){function _d(np){var ap=rp.call(this)||this;return assertObjectArgs(np),ap.l1=np==null||np.l1==null?.01:np.l1,ap.l2=np==null||np.l2==null?.01:np.l2,ap.hasL1=ap.l1!==0,ap.hasL2=ap.l2!==0,ap}return __extends$h(_d,rp),_d.prototype.apply=function(np){var ap=this;return je(function(){var sp=Pn([1]);return ap.hasL1&&(sp=Vs(sp,vl(tc(ap.l1,Vu(np))))),ap.hasL2&&(sp=Vs(sp,vl(tc(ap.l2,square(np))))),sp.asScalar()})},_d.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},_d.fromConfig=function(np,ap){return new np({l1:ap.l1,l2:ap.l2})},_d.className="L1L2",_d}(Regularizer);function l1(rp){return assertObjectArgs(rp),new L1L2({l1:rp!=null?rp.l1:null,l2:0})}function l2(rp){return assertObjectArgs(rp),new L1L2({l2:rp!=null?rp.l2:null,l1:0})}Mf.registerClass(L1L2);var REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={l1l2:"L1L2"};function serializeRegularizer(rp){return serializeKerasObject(rp)}function deserializeRegularizer(rp,_d){return _d===void 0&&(_d={}),deserializeKerasObject(rp,Mf.SerializationMap.getMap().classNameMap,_d,"regularizer")}function getRegularizer(rp){return rp==null?null:typeof rp=="string"?deserializeRegularizer({className:rp in REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP?REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP[rp]:rp,config:{}}):rp instanceof Regularizer?rp:deserializeRegularizer(rp)}var ReLU=function(rp){function _d(np){var ap=rp.call(this,np??{})||this;return ap.supportsMasking=!0,np!=null&&(ap.maxValue=np.maxValue),ap}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){np=getExactlyOneTensor(np);var sp=bl(np);return this.maxValue!=null&&(sp=$u(sp,0,this.maxValue)),sp},_d.prototype.computeOutputShape=function(np){return np},_d.prototype.getConfig=function(){var np={maxValue:this.maxValue},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="ReLU",_d}(Layer);Mf.registerClass(ReLU);var LeakyReLU=function(rp){function _d(np){var ap=rp.call(this,np??{})||this;return ap.DEFAULT_ALPHA=.3,np==null&&(np={}),ap.alpha=np.alpha==null?ap.DEFAULT_ALPHA:np.alpha,ap}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=getExactlyOneTensor(np);return yl(sp,this.alpha)},_d.prototype.computeOutputShape=function(np){return np},_d.prototype.getConfig=function(){var np={alpha:this.alpha},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="LeakyReLU",_d}(Layer);Mf.registerClass(LeakyReLU);var PReLU=function(rp){function _d(np){var ap=rp.call(this,np??{})||this;if(ap.DEFAULT_ALPHA_INITIALIZER="zeros",np==null&&(np={}),ap.supportsMasking=!0,ap.alphaInitializer=getInitializer(np.alphaInitializer||ap.DEFAULT_ALPHA_INITIALIZER),ap.alphaRegularizer=getRegularizer(np.alphaRegularizer),ap.alphaConstraint=getConstraint(np.alphaConstraint),np.sharedAxes==null)ap.sharedAxes=null;else if(Array.isArray(np.sharedAxes))ap.sharedAxes=np.sharedAxes;else{if(typeof np.sharedAxes!="number")throw new ValueError("Expected sharedAxes to be a number or an array of numbers, but got "+np.sharedAxes);ap.sharedAxes=[np.sharedAxes]}return ap}return __extends$h(_d,rp),_d.prototype.build=function(np){var ap=(np=getExactlyOneShape(np)).slice(1);if(this.sharedAxes!=null)for(var sp=0,lp=this.sharedAxes;sp<lp.length;sp++)ap[(cp=lp[sp])-1]=1;this.alpha=this.addWeight("alpha",ap,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var up={};if(this.sharedAxes!=null)for(var cp=1;cp<np.length;++cp)up[cp]=np[cp];this.inputSpec=[new InputSpec({ndim:np.length,axes:up})],this.built=!0},_d.prototype.call=function(np,ap){return np=getExactlyOneTensor(np),xl(np,this.alpha.read())},_d.prototype.getConfig=function(){var np={alphaInitializer:serializeInitializer(this.alphaInitializer),alphaRegularizer:serializeRegularizer(this.alphaRegularizer),alphaConstraint:serializeConstraint(this.alphaConstraint),sharedAxes:this.sharedAxes},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="PReLU",_d}(Layer);Mf.registerClass(PReLU);var ELU=function(rp){function _d(np){var ap=rp.call(this,np??{})||this;if(ap.DEFAULT_ALPHA=1,np==null&&(np={}),np.alpha!=null&&np.alpha!==ap.DEFAULT_ALPHA)throw new NotImplementedError("Non-default alpha value ("+np.alpha+") is not supported by the ELU layer yet.");return ap.alpha=np.alpha==null?ap.DEFAULT_ALPHA:np.alpha,ap}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=getExactlyOneTensor(np);return gl(sp)},_d.prototype.computeOutputShape=function(np){return np},_d.prototype.getConfig=function(){var np={alpha:this.alpha},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="ELU",_d}(Layer);Mf.registerClass(ELU);var ThresholdedReLU=function(rp){function _d(np){var ap=rp.call(this,np??{})||this;return ap.DEFAULT_THETA=1,np==null&&(np={}),ap.theta=np.theta==null?ap.DEFAULT_THETA:np.theta,ap}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=getExactlyOneTensor(np);return sp.mul(cast$1(sp.greater(this.theta),"float32"))},_d.prototype.computeOutputShape=function(np){return np},_d.prototype.getConfig=function(){var np={theta:this.theta},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="ThresholdedReLU",_d}(Layer);Mf.registerClass(ThresholdedReLU);var Softmax$1=function(rp){function _d(np){var ap=rp.call(this,np??{})||this;return ap.DEFAULT_AXIS=1,np==null&&(np={}),ap.softmax=new Softmax().apply,ap.axis=np.axis==null?ap.DEFAULT_AXIS:np.axis,ap}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=getExactlyOneTensor(np);return this.softmax(sp,this.axis)},_d.prototype.computeOutputShape=function(np){return np},_d.prototype.getConfig=function(){var np={axis:this.axis},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="Softmax",_d}(Layer);function normalizeArray(rp,_d,np){if(typeof rp=="number")return pyListRepeat(rp,_d);if(rp.length!==_d)throw new ValueError("The "+np+" argument must be an integer or tuple of "+_d+" integers. Received: "+rp.length+" elements.");for(var ap=0;ap<_d;++ap){var sp=rp[ap];if(!isInteger(sp))throw new ValueError("The "+np+" argument must be an integer or tuple of "+_d+" integers. Received: "+JSON.stringify(rp)+" including a non-integer number "+sp)}return rp}function convOutputLength(rp,_d,np,ap,sp){return sp===void 0&&(sp=1),rp==null?rp:(lp=np==="same"?rp:rp-(_d+(_d-1)*(sp-1))+1,Math.floor((lp+ap-1)/ap));var lp}function deconvLength(rp,_d,np,ap){if(rp==null)return null;if(ap==="valid")rp=rp*_d+max$1([np-_d,0]);else{if(ap!=="same")throw new ValueError("Unsupport padding mode: "+ap+".");rp*=_d}return rp}function preprocessConv2DInput(rp,_d){return je(function(){return checkDataFormat(_d),_d==="channelsFirst"?El(rp,[0,2,3,1]):rp})}function preprocessConv3DInput(rp,_d){return je(function(){return checkDataFormat(_d),_d==="channelsFirst"?El(rp,[0,2,3,4,1]):rp})}function conv1dWithBias(rp,_d,np,ap,sp,lp,up){return ap===void 0&&(ap=1),sp===void 0&&(sp="valid"),up===void 0&&(up=1),je(function(){if(lp==null&&(lp=imageDataFormat()),checkDataFormat(lp),rp.shape.length!==3)throw new ValueError("The input of a conv1dWithBias operation should be 3, but is "+rp.shape.length+" instead.");if(_d.shape.length!==3)throw new ValueError("The kernel for a conv1dWithBias operation should be 3, but is "+_d.shape.length+" instead");if(np!=null&&np.shape.length!==1)throw new ValueError("The bias for a conv1dWithBias operation should be 1, but is "+_d.shape.length+" instead");if(lp==="channelsFirst"&&(rp=El(rp,[0,2,1])),sp==="causal")throw new NotImplementedError("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var cp=Ac(rp,_d,ap,sp==="same"?"same":"valid","NWC",up);return np!=null&&(cp=biasAdd(cp,np)),cp})}function conv2dWithBiasActivation(rp,_d,np,ap,sp,lp,up,cp){return ap===void 0&&(ap=[1,1]),sp===void 0&&(sp="valid"),cp===void 0&&(cp=null),je(function(){if(lp==null&&(lp=imageDataFormat()),checkDataFormat(lp),rp.rank!==3&&rp.rank!==4)throw new ValueError("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+rp.rank+".");if(_d.rank!==3&&_d.rank!==4)throw new ValueError("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+rp.rank+".");var dp=preprocessConv2DInput(rp,lp);if(sp==="causal")throw new NotImplementedError("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return dp=Eh.conv2d({x:dp,filter:_d,strides:ap,pad:sp==="same"?"same":"valid",dilations:up,dataFormat:"NHWC",bias:np,activation:cp}),lp==="channelsFirst"&&(dp=El(dp,[0,3,1,2])),dp})}function conv3dWithBias(rp,_d,np,ap,sp,lp,up){return ap===void 0&&(ap=[1,1,1]),sp===void 0&&(sp="valid"),je(function(){if(lp==null&&(lp=imageDataFormat()),checkDataFormat(lp),rp.rank!==4&&rp.rank!==5)throw new ValueError("conv3dWithBias expects input to be of rank 4 or 5, but received "+rp.rank+".");if(_d.rank!==4&&_d.rank!==5)throw new ValueError("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+rp.rank+".");var cp=preprocessConv3DInput(rp,lp);if(sp==="causal")throw new NotImplementedError("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return cp=Tc(cp,_d,ap,sp==="same"?"same":"valid","NDHWC",up),np!=null&&(cp=biasAdd(cp,np)),lp==="channelsFirst"&&(cp=El(cp,[0,4,1,2,3])),cp})}Mf.registerClass(Softmax$1);var BaseConv=function(rp){function _d(np,ap){var sp=rp.call(this,ap)||this;if(sp.bias=null,sp.DEFAULT_KERNEL_INITIALIZER="glorotNormal",sp.DEFAULT_BIAS_INITIALIZER="zeros",_d.verifyArgs(ap),sp.rank=np,assertPositiveInteger(sp.rank,"rank"),sp.rank!==1&&sp.rank!==2&&sp.rank!==3)throw new NotImplementedError("Convolution layer for rank other than 1, 2, or 3 ("+sp.rank+") is not implemented yet.");if(sp.kernelSize=normalizeArray(ap.kernelSize,np,"kernelSize"),sp.strides=normalizeArray(ap.strides==null?1:ap.strides,np,"strides"),sp.padding=ap.padding==null?"valid":ap.padding,checkPaddingMode(sp.padding),sp.dataFormat=ap.dataFormat==null?"channelsLast":ap.dataFormat,checkDataFormat(sp.dataFormat),sp.activation=getActivation(ap.activation),sp.useBias=ap.useBias==null||ap.useBias,sp.biasInitializer=getInitializer(ap.biasInitializer||sp.DEFAULT_BIAS_INITIALIZER),sp.biasConstraint=getConstraint(ap.biasConstraint),sp.biasRegularizer=getRegularizer(ap.biasRegularizer),sp.activityRegularizer=getRegularizer(ap.activityRegularizer),sp.dilationRate=normalizeArray(ap.dilationRate==null?1:ap.dilationRate,np,"dilationRate"),sp.rank===1&&Array.isArray(sp.dilationRate)&&sp.dilationRate.length!==1)throw new ValueError("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(sp.dilationRate));if(sp.rank===2){if(typeof sp.dilationRate=="number")sp.dilationRate=[sp.dilationRate,sp.dilationRate];else if(sp.dilationRate.length!==2)throw new ValueError("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(sp.dilationRate))}else if(sp.rank===3){if(typeof sp.dilationRate=="number")sp.dilationRate=[sp.dilationRate,sp.dilationRate,sp.dilationRate];else if(sp.dilationRate.length!==3)throw new ValueError("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(sp.dilationRate))}return sp}return __extends$h(_d,rp),_d.verifyArgs=function(np){if(assert("kernelSize"in np,"required key 'kernelSize' not in config"),typeof np.kernelSize!="number"&&!checkArrayTypeAndLength(np.kernelSize,"number",1,3))throw new ValueError("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(np.kernelSize)+".")},_d.prototype.getConfig=function(){var np={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:serializeActivation(this.activation),useBias:this.useBias,biasInitializer:serializeInitializer(this.biasInitializer),biasRegularizer:serializeRegularizer(this.biasRegularizer),activityRegularizer:serializeRegularizer(this.activityRegularizer),biasConstraint:serializeConstraint(this.biasConstraint)},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d}(Layer),Conv=function(rp){function _d(np,ap){var sp=rp.call(this,np,ap)||this;return sp.kernel=null,_d.verifyArgs(ap),sp.filters=ap.filters,assertPositiveInteger(sp.filters,"filters"),sp.kernelInitializer=getInitializer(ap.kernelInitializer||sp.DEFAULT_KERNEL_INITIALIZER),sp.kernelConstraint=getConstraint(ap.kernelConstraint),sp.kernelRegularizer=getRegularizer(ap.kernelRegularizer),sp}return __extends$h(_d,rp),_d.prototype.build=function(np){var ap;np=getExactlyOneShape(np);var sp=this.dataFormat==="channelsFirst"?1:np.length-1;if(np[sp]==null)throw new ValueError("The channel dimension of the input should be defined. Found "+np[sp]);var lp=np[sp],up=this.kernelSize.concat([lp,this.filters]);this.kernel=this.addWeight("kernel",up,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(ap={},ap[sp]=lp,ap)}],this.built=!0},_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp;np=getExactlyOneTensor(np);var up=sp.bias==null?null:sp.bias.read(),cp=mapActivationToFusedKernel(sp.activation.getClassName());if(cp!=null&&sp.rank===2)lp=conv2dWithBiasActivation(np,sp.kernel.read(),up,sp.strides,sp.padding,sp.dataFormat,sp.dilationRate,cp);else{if(sp.rank===1)lp=conv1dWithBias(np,sp.kernel.read(),up,sp.strides[0],sp.padding,sp.dataFormat,sp.dilationRate[0]);else if(sp.rank===2)lp=conv2dWithBiasActivation(np,sp.kernel.read(),up,sp.strides,sp.padding,sp.dataFormat,sp.dilationRate);else{if(sp.rank!==3)throw new NotImplementedError("convolutions greater than 3D are not implemented yet.");lp=conv3dWithBias(np,sp.kernel.read(),up,sp.strides,sp.padding,sp.dataFormat,sp.dilationRate)}sp.activation!=null&&(lp=sp.activation.apply(lp))}return lp})},_d.prototype.computeOutputShape=function(np){np=getExactlyOneShape(np);for(var ap=[],sp=this.dataFormat==="channelsLast"?np.slice(1,np.length-1):np.slice(2),lp=0;lp<sp.length;++lp){var up=convOutputLength(sp[lp],this.kernelSize[lp],this.padding,this.strides[lp],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[lp]);ap.push(up)}var cp=[np[0]];return this.dataFormat==="channelsLast"?(cp=cp.concat(ap)).push(this.filters):(cp.push(this.filters),cp=cp.concat(ap)),cp},_d.prototype.getConfig=function(){var np={filters:this.filters,kernelInitializer:serializeInitializer(this.kernelInitializer),kernelRegularizer:serializeRegularizer(this.kernelRegularizer),kernelConstraint:serializeConstraint(this.kernelConstraint)},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.verifyArgs=function(np){if(!("filters"in np)||typeof np.filters!="number"||np.filters<1)throw new ValueError("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(np.filters))},_d}(BaseConv),Conv2D=function(rp){function _d(np){var ap=rp.call(this,2,np)||this;return _d.verifyArgs(np),ap}return __extends$h(_d,rp),_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this);return delete np.rank,np},_d.verifyArgs=function(np){if(typeof np.kernelSize!="number"&&!checkArrayTypeAndLength(np.kernelSize,"number",1,2))throw new ValueError("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(np.kernelSize)+".")},_d.className="Conv2D",_d}(Conv);Mf.registerClass(Conv2D);var Conv3D=function(rp){function _d(np){var ap=rp.call(this,3,np)||this;return _d.verifyArgs(np),ap}return __extends$h(_d,rp),_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this);return delete np.rank,np},_d.verifyArgs=function(np){if(typeof np.kernelSize!="number"&&(!Array.isArray(np.kernelSize)||np.kernelSize.length!==1&&np.kernelSize.length!==3))throw new ValueError("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(np.kernelSize)+".")},_d.className="Conv3D",_d}(Conv);Mf.registerClass(Conv3D);var Conv2DTranspose=function(rp){function _d(np){var ap=rp.call(this,np)||this;if(ap.inputSpec=[new InputSpec({ndim:4})],ap.padding!=="same"&&ap.padding!=="valid")throw new ValueError("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+ap.padding);return ap}return __extends$h(_d,rp),_d.prototype.build=function(np){var ap;if((np=getExactlyOneShape(np)).length!==4)throw new ValueError("Input should have rank 4; Received input shape: "+JSON.stringify(np));var sp=this.dataFormat==="channelsFirst"?1:np.length-1;if(np[sp]==null)throw new ValueError("The channel dimension of the inputs should be defined. Found `None`.");var lp=np[sp],up=this.kernelSize.concat([this.filters,lp]);this.kernel=this.addWeight("kernel",up,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new InputSpec({ndim:4,axes:(ap={},ap[sp]=lp,ap)})],this.built=!0},_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp=getExactlyOneTensor(np);if(lp.shape.length!==4)throw new ValueError("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+lp.shape.length);var up,cp,dp=lp.shape,hp=dp[0];sp.dataFormat==="channelsFirst"?(up=2,cp=3):(up=1,cp=2);var fp=dp[up],pp=dp[cp],mp=sp.kernelSize[0],gp=sp.kernelSize[1],yp=sp.strides[0],xp=sp.strides[1],_p=[hp,deconvLength(fp,yp,mp,sp.padding),deconvLength(pp,xp,gp,sp.padding),sp.filters];sp.dataFormat!=="channelsLast"&&(lp=El(lp,[0,2,3,1]));var vp=Pc(lp,sp.kernel.read(),_p,sp.strides,sp.padding);return sp.dataFormat!=="channelsLast"&&(vp=El(vp,[0,3,1,2])),sp.bias!=null&&(vp=biasAdd(vp,sp.bias.read(),sp.dataFormat)),sp.activation!=null&&(vp=sp.activation.apply(vp)),vp})},_d.prototype.computeOutputShape=function(np){var ap,sp,lp,up=(np=getExactlyOneShape(np)).slice();this.dataFormat==="channelsFirst"?(ap=1,sp=2,lp=3):(ap=3,sp=1,lp=2);var cp=this.kernelSize[0],dp=this.kernelSize[1],hp=this.strides[0],fp=this.strides[1];return up[ap]=this.filters,up[sp]=deconvLength(up[sp],hp,cp,this.padding),up[lp]=deconvLength(up[lp],fp,dp,this.padding),up},_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this);return delete np.dilationRate,np},_d.className="Conv2DTranspose",_d}(Conv2D);Mf.registerClass(Conv2DTranspose);var SeparableConv=function(rp){function _d(np,ap){var sp=rp.call(this,np,ap)||this;if(sp.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",sp.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",sp.depthwiseKernel=null,sp.pointwiseKernel=null,ap.filters==null)throw new ValueError("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(ap.kernelInitializer!=null||ap.kernelRegularizer!=null||ap.kernelConstraint!=null)throw new ValueError("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(ap.padding!=null&&ap.padding!=="same"&&ap.padding!=="valid")throw new ValueError("SeparableConv"+sp.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(ap.padding));return sp.depthMultiplier=ap.depthMultiplier==null?1:ap.depthMultiplier,sp.depthwiseInitializer=getInitializer(ap.depthwiseInitializer||sp.DEFAULT_DEPTHWISE_INITIALIZER),sp.depthwiseRegularizer=getRegularizer(ap.depthwiseRegularizer),sp.depthwiseConstraint=getConstraint(ap.depthwiseConstraint),sp.pointwiseInitializer=getInitializer(ap.depthwiseInitializer||sp.DEFAULT_POINTWISE_INITIALIZER),sp.pointwiseRegularizer=getRegularizer(ap.pointwiseRegularizer),sp.pointwiseConstraint=getConstraint(ap.pointwiseConstraint),sp}return __extends$h(_d,rp),_d.prototype.build=function(np){var ap;if((np=getExactlyOneShape(np)).length<this.rank+2)throw new ValueError("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(np));var sp=this.dataFormat==="channelsFirst"?1:np.length-1;if(np[sp]==null||np[sp]<0)throw new ValueError("The channel dimension of the inputs should be defined, but found "+JSON.stringify(np[sp]));for(var lp=np[sp],up=this.kernelSize.concat([lp,this.depthMultiplier]),cp=[],dp=0;dp<this.rank;++dp)cp.push(1);cp.push(lp*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",up,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",cp,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new InputSpec({ndim:this.rank+2,axes:(ap={},ap[sp]=lp,ap)})],this.built=!0},_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp;if(np=getExactlyOneTensor(np),sp.rank===1)throw new NotImplementedError("1D separable convolution is not implemented yet.");return sp.rank===2&&(sp.dataFormat==="channelsFirst"&&(np=El(np,[0,2,3,1])),lp=Bc(np,sp.depthwiseKernel.read(),sp.pointwiseKernel.read(),sp.strides,sp.padding,sp.dilationRate,"NHWC")),sp.useBias&&(lp=biasAdd(lp,sp.bias.read(),sp.dataFormat)),sp.activation!=null&&(lp=sp.activation.apply(lp)),sp.dataFormat==="channelsFirst"&&(lp=El(lp,[0,3,1,2])),lp})},_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this);return delete np.rank,delete np.kernelInitializer,delete np.kernelRegularizer,delete np.kernelConstraint,np.depthwiseInitializer=serializeInitializer(this.depthwiseInitializer),np.pointwiseInitializer=serializeInitializer(this.pointwiseInitializer),np.depthwiseRegularizer=serializeRegularizer(this.depthwiseRegularizer),np.pointwiseRegularizer=serializeRegularizer(this.pointwiseRegularizer),np.depthwiseConstraint=serializeConstraint(this.depthwiseConstraint),np.pointwiseConstraint=serializeConstraint(this.pointwiseConstraint),np},_d.className="SeparableConv",_d}(Conv),SeparableConv2D=function(rp){function _d(np){return rp.call(this,2,np)||this}return __extends$h(_d,rp),_d.className="SeparableConv2D",_d}(SeparableConv);Mf.registerClass(SeparableConv2D);var Conv1D=function(rp){function _d(np){var ap=rp.call(this,1,np)||this;return _d.verifyArgs(np),ap.inputSpec=[{ndim:3}],ap}return __extends$h(_d,rp),_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this);return delete np.rank,delete np.dataFormat,np},_d.verifyArgs=function(np){if(typeof np.kernelSize!="number"&&!checkArrayTypeAndLength(np.kernelSize,"number",1,1))throw new ValueError("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(np.kernelSize)+".")},_d.className="Conv1D",_d}(Conv);Mf.registerClass(Conv1D);var Cropping2D=function(rp){function _d(np){var ap=rp.call(this,np)||this;return typeof np.cropping=="number"?ap.cropping=[[np.cropping,np.cropping],[np.cropping,np.cropping]]:typeof np.cropping[0]=="number"?ap.cropping=[[np.cropping[0],np.cropping[0]],[np.cropping[1],np.cropping[1]]]:ap.cropping=np.cropping,ap.dataFormat=np.dataFormat===void 0?"channelsLast":np.dataFormat,ap.inputSpec=[{ndim:4}],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){return this.dataFormat==="channelsFirst"?[np[0],np[1],np[2]-this.cropping[0][0]-this.cropping[0][1],np[3]-this.cropping[1][0]-this.cropping[1][1]]:[np[0],np[1]-this.cropping[0][0]-this.cropping[0][1],np[2]-this.cropping[1][0]-this.cropping[1][1],np[3]]},_d.prototype.call=function(np,ap){var sp=this;return je(function(){return np=getExactlyOneTensor(np),sp.dataFormat==="channelsLast"?sliceAlongAxis(sliceAlongAxis(np,sp.cropping[0][0],np.shape[1]-sp.cropping[0][0]-sp.cropping[0][1],2),sp.cropping[1][0],np.shape[2]-sp.cropping[1][1]-sp.cropping[1][0],3):sliceAlongAxis(sliceAlongAxis(np,sp.cropping[0][0],np.shape[2]-sp.cropping[0][0]-sp.cropping[0][1],3),sp.cropping[1][0],np.shape[3]-sp.cropping[1][1]-sp.cropping[1][0],4)})},_d.prototype.getConfig=function(){var np={cropping:this.cropping,dataFormat:this.dataFormat},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="Cropping2D",_d}(Layer);Mf.registerClass(Cropping2D);var UpSampling2D=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.DEFAULT_SIZE=[2,2],ap.inputSpec=[{ndim:4}],ap.size=np.size==null?ap.DEFAULT_SIZE:np.size,ap.dataFormat=np.dataFormat==null?"channelsLast":np.dataFormat,ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){if(this.dataFormat==="channelsFirst"){var ap=np[2]==null?null:this.size[0]*np[2],sp=np[3]==null?null:this.size[1]*np[3];return[np[0],np[1],ap,sp]}return ap=np[1]==null?null:this.size[0]*np[1],sp=np[2]==null?null:this.size[1]*np[2],[np[0],ap,sp,np[3]]},_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp=getExactlyOneTensor(np),up=lp.shape;if(sp.dataFormat==="channelsFirst"){lp=El(lp,[0,2,3,1]);var cp=sp.size[0]*up[2],dp=sp.size[1]*up[3],hp=lp.resizeNearestNeighbor([cp,dp]);return El(hp,[0,3,1,2])}return cp=sp.size[0]*up[1],dp=sp.size[1]*up[2],lp.resizeNearestNeighbor([cp,dp])})},_d.prototype.getConfig=function(){var np={size:this.size,dataFormat:this.dataFormat},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="UpSampling2D",_d}(Layer);function depthwiseConv2d$1(rp,_d,np,ap,sp,lp){return np===void 0&&(np=[1,1]),ap===void 0&&(ap="valid"),je(function(){sp==null&&(sp=imageDataFormat()),checkDataFormat(sp);var up=preprocessConv2DInput(rp,sp);if(rp.rank!==4)throw new ValueError("Input for depthwiseConv2d is required to be 4-D, but is instead "+rp.rank+"-D");if(_d.rank!==4)throw new ValueError("depthwiseKernel is required to be 4-D, but is instead "+_d.rank+"-D");return up=Oc(up,_d,np,ap==="same"?"same":"valid","NHWC",lp),sp==="channelsFirst"&&(up=El(up,[0,3,1,2])),up})}Mf.registerClass(UpSampling2D);var DepthwiseConv2D=function(rp){function _d(np){var ap=rp.call(this,2,np)||this;return ap.depthwiseKernel=null,ap.depthMultiplier=np.depthMultiplier==null?1:np.depthMultiplier,ap.depthwiseInitializer=getInitializer(np.depthwiseInitializer||ap.DEFAULT_KERNEL_INITIALIZER),ap.depthwiseConstraint=getConstraint(np.depthwiseConstraint),ap.depthwiseRegularizer=getRegularizer(np.depthwiseRegularizer),ap}return __extends$h(_d,rp),_d.prototype.build=function(np){if((np=getExactlyOneShape(np)).length<4)throw new ValueError("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(np)+".");var ap=this.dataFormat==="channelsFirst"?1:3;if(np[ap]==null||np[ap]<0)throw new ValueError("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+np[ap]+").");var sp=np[ap],lp=[this.kernelSize[0],this.kernelSize[1],sp,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",lp,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[sp*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp=depthwiseConv2d$1(np=getExactlyOneTensor(np),sp.depthwiseKernel.read(),sp.strides,sp.padding,sp.dataFormat,null);return sp.useBias&&(lp=biasAdd(lp,sp.bias.read(),sp.dataFormat)),sp.activation!=null&&(lp=sp.activation.apply(lp)),lp})},_d.prototype.computeOutputShape=function(np){np=getExactlyOneShape(np);var ap=this.dataFormat==="channelsFirst"?np[2]:np[1],sp=this.dataFormat==="channelsFirst"?np[3]:np[2],lp=this.dataFormat==="channelsFirst"?np[1]*this.depthMultiplier:np[3]*this.depthMultiplier,up=convOutputLength(ap,this.kernelSize[0],this.padding,this.strides[0]),cp=convOutputLength(sp,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[np[0],lp,up,cp]:[np[0],up,cp,lp]},_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this);return np.depthMultiplier=this.depthMultiplier,np.depthwiseInitializer=serializeInitializer(this.depthwiseInitializer),np.depthwiseRegularizer=serializeRegularizer(this.depthwiseRegularizer),np.depthwiseConstraint=serializeConstraint(this.depthwiseRegularizer),np},_d.className="DepthwiseConv2D",_d}(BaseConv);Mf.registerClass(DepthwiseConv2D);var Dropout=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.rate=Math.max(Math.min(np.rate,1),0),ap.noiseShape=np.noiseShape,ap.seed=np.seed,ap.supportsMasking=!0,ap}return __extends$h(_d,rp),_d.prototype.getNoiseShape=function(np){if(this.noiseShape==null)return this.noiseShape;for(var ap=np.shape,sp=[],lp=0;lp<this.noiseShape.length;++lp)sp.push(this.noiseShape[lp]==null?ap[lp]:this.noiseShape[lp]);return sp},_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.invokeCallHook(np,ap);var lp=getExactlyOneTensor(np);if(0<sp.rate&&sp.rate<1){var up=ap.training!=null&&ap.training,cp=sp.getNoiseShape(lp);return inTrainPhase(function(){return dropout$1(lp,sp.rate,cp,sp.seed)},function(){return lp},up)}return np})},_d.prototype.getConfig=function(){var np={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.prototype.dispose=function(){return rp.prototype.dispose.call(this)},_d.className="Dropout",_d}(Layer);Mf.registerClass(Dropout);var Dense=function(rp){function _d(np){var ap=rp.call(this,np)||this;if(ap.activation=null,ap.useBias=!0,ap.kernel=null,ap.bias=null,ap.DEFAULT_KERNEL_INITIALIZER="glorotNormal",ap.DEFAULT_BIAS_INITIALIZER="zeros",np.batchInputShape==null&&np.inputShape==null&&np.inputDim!=null){var sp=null;np.batchSize!=null&&(sp=np.batchSize),ap.batchInputShape=[sp,np.inputDim]}return ap.units=np.units,assertPositiveInteger(ap.units,"units"),ap.activation=getActivation(np.activation),np.useBias!=null&&(ap.useBias=np.useBias),ap.kernelInitializer=getInitializer(np.kernelInitializer||ap.DEFAULT_KERNEL_INITIALIZER),ap.biasInitializer=getInitializer(np.biasInitializer||ap.DEFAULT_BIAS_INITIALIZER),ap.kernelConstraint=getConstraint(np.kernelConstraint),ap.biasConstraint=getConstraint(np.biasConstraint),ap.kernelRegularizer=getRegularizer(np.kernelRegularizer),ap.biasRegularizer=getRegularizer(np.biasRegularizer),ap.activityRegularizer=getRegularizer(np.activityRegularizer),ap.supportsMasking=!0,ap.inputSpec=[{minNDim:2}],ap}return __extends$h(_d,rp),_d.prototype.build=function(np){var ap,sp=(np=getExactlyOneShape(np))[np.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[sp,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(ap={},ap[-1]=sp,ap)}],this.built=!0},_d.prototype.computeOutputShape=function(np){var ap=(np=getExactlyOneShape(np)).slice();return ap[ap.length-1]=this.units,ap},_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.invokeCallHook(np,ap);var lp,up=getExactlyOneTensor(np),cp=mapActivationToFusedKernel(sp.activation.getClassName());return cp!=null?lp=dot(up,sp.kernel.read(),cp,sp.bias?sp.bias.read():null):(lp=dot(up,sp.kernel.read()),sp.bias!=null&&(lp=biasAdd(lp,sp.bias.read())),sp.activation!=null&&(lp=sp.activation.apply(lp))),lp})},_d.prototype.getConfig=function(){var np={units:this.units,activation:serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:serializeInitializer(this.kernelInitializer),biasInitializer:serializeInitializer(this.biasInitializer),kernelRegularizer:serializeRegularizer(this.kernelRegularizer),biasRegularizer:serializeRegularizer(this.biasRegularizer),activityRegularizer:serializeRegularizer(this.activityRegularizer),kernelConstraint:serializeConstraint(this.kernelConstraint),biasConstraint:serializeConstraint(this.biasConstraint)},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="Dense",_d}(Layer);Mf.registerClass(Dense);var Flatten=function(rp){function _d(np){var ap=rp.call(this,np||{})||this;return ap.inputSpec=[{minNDim:3}],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){for(var ap=0,sp=(np=getExactlyOneShape(np)).slice(1);ap<sp.length;ap++)if(sp[ap]==null)throw new ValueError('The shape of the input to "Flatten" is not fully defined (got '+np.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[np[0],arrayProd(np,1)]},_d.prototype.call=function(np,ap){var sp=this;return je(function(){return sp.invokeCallHook(np,ap),batchFlatten(getExactlyOneTensor(np))})},_d.className="Flatten",_d}(Layer);Mf.registerClass(Flatten);var Activation$1=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.supportsMasking=!0,ap.activation=getActivation(np.activation),ap}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.invokeCallHook(np,ap);var lp=getExactlyOneTensor(np);return sp.activation.apply(lp)})},_d.prototype.getConfig=function(){var np={activation:serializeActivation(this.activation)},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="Activation",_d}(Layer);Mf.registerClass(Activation$1);var RepeatVector=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.n=np.n,ap.inputSpec=[{ndim:2}],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){return[np[0],this.n,np[1]]},_d.prototype.call=function(np,ap){var sp=this;return je(function(){return repeat(np=getExactlyOneTensor(np),sp.n)})},_d.prototype.getConfig=function(){var np={n:this.n},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="RepeatVector",_d}(Layer);Mf.registerClass(RepeatVector);var Reshape=function(rp){function _d(np){var ap=rp.call(this,np)||this;ap.targetShape=np.targetShape;for(var sp=0;sp<ap.targetShape.length;++sp)ap.isUnknown(ap.targetShape[sp])&&(ap.targetShape[sp]=null);return ap}return __extends$h(_d,rp),_d.prototype.isUnknown=function(np){return np<0||np==null},_d.prototype.fixUnknownDimension=function(np,ap){for(var sp="Total size of new array must be unchanged.",lp=ap.slice(),up=1,cp=null,dp=0;dp<lp.length;++dp){var hp=lp[dp];if(this.isUnknown(hp)){if(cp!==null)throw new ValueError("Can only specifiy one unknown dimension.");cp=dp}else up*=hp}var fp=arrayProd(np);if(cp!==null){if(up===0||fp%up!=0)throw new ValueError(sp);lp[cp]=fp/up}else if(fp!==up)throw new ValueError(sp);return lp},_d.prototype.computeOutputShape=function(np){for(var ap=!1,sp=0;sp<np.length;++sp)if(this.isUnknown(np[sp])){ap=!0;break}return ap?np.slice(0,1).concat(this.targetShape):np.slice(0,1).concat(this.fixUnknownDimension(np.slice(1),this.targetShape))},_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.invokeCallHook(np,ap);var lp=getExactlyOneTensor(np),up=lp.shape,cp=up.slice(0,1).concat(sp.fixUnknownDimension(up.slice(1),sp.targetShape));return lp.reshape(cp)})},_d.prototype.getConfig=function(){var np={targetShape:this.targetShape},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="Reshape",_d}(Layer);Mf.registerClass(Reshape);var Permute=function(rp){function _d(np){var ap=rp.call(this,np)||this;if(np.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(np.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+np.dims+" instead.");var sp=range(1,np.dims.length+1);if(!tt.arraysEqual(np.dims.slice().sort(),sp))throw new Error("Invalid permutation `dims`: "+JSON.stringify(np.dims)+" `dims` must contain consecutive integers starting from 1.");return ap.dims=np.dims,ap.dimsIncludingBatch=[0].concat(ap.dims),ap.inputSpec=[new InputSpec({ndim:ap.dims.length+1})],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){var ap=(np=getExactlyOneShape(np)).slice();return this.dims.forEach(function(sp,lp){ap[lp+1]=np[sp]}),ap},_d.prototype.call=function(np,ap){return El(getExactlyOneTensor(np),this.dimsIncludingBatch)},_d.prototype.getConfig=function(){var np={dims:this.dims},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="Permute",_d}(Layer);Mf.registerClass(Permute);var Masking=function(rp){function _d(np){var ap=rp.call(this,np??{})||this;return ap.supportsMasking=!0,ap.maskValue=np!=null?np.maskValue==null?0:np.maskValue:0,ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){return np},_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this),ap={maskValue:this.maskValue};return Object.assign(ap,np),ap},_d.prototype.computeMask=function(np,ap){var sp=getExactlyOneTensor(np);return ul(yc(sp,this.maskValue),-1)},_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.invokeCallHook(np,ap);var lp=getExactlyOneTensor(np),up=ul(yc(lp,sp.maskValue),-1,!0);return lp.mul(up.asType(lp.dtype))})},_d.className="Masking",_d}(Layer);Mf.registerClass(Masking);var Embedding=function(rp){function _d(np){var ap=rp.call(this,np)||this;if(ap.embeddings=null,ap.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",np.batchInputShape==null&&np.inputShape==null){var sp=null;np.batchSize!=null&&(sp=np.batchSize),np.inputLength==null?ap.batchInputShape=[sp,null]:ap.batchInputShape=[sp].concat(toList(np.inputLength))}return ap.inputDim=np.inputDim,assertPositiveInteger(ap.inputDim,"inputDim"),ap.outputDim=np.outputDim,assertPositiveInteger(ap.outputDim,"outputDim"),ap.embeddingsInitializer=getInitializer(np.embeddingsInitializer||ap.DEFAULT_EMBEDDINGS_INITIALIZER),ap.embeddingsRegularizer=getRegularizer(np.embeddingsRegularizer),ap.activityRegularizer=getRegularizer(np.activityRegularizer),ap.embeddingsConstraint=getConstraint(np.embeddingsConstraint),ap.maskZero=np.maskZero,ap.supportsMasking=np.maskZero,ap.inputLength=np.inputLength,ap}return __extends$h(_d,rp),_d.prototype.build=function(np){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},_d.prototype.warnOnIncompatibleInputShape=function(np){},_d.prototype.computeMask=function(np,ap){var sp=this;return je(function(){return sp.maskZero?(np=getExactlyOneTensor(np),yc(np,zn(np))):null})},_d.prototype.computeOutputShape=function(np){if(np=getExactlyOneShape(np),this.inputLength==null)return np.concat([this.outputDim]);var ap=toList(this.inputLength);if(ap.length!==np.length-1)throw new ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+np);for(var sp=0,lp=0;lp<ap.length;++lp){var up=ap[lp],cp=np[lp+1];if(up!=null&&cp!=null&&up!==cp)throw new ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+np);up==null&&(ap[sp]=cp),sp++}return[np[0]].concat(ap,[this.outputDim])},_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.invokeCallHook(np,ap);var lp=getExactlyOneTensor(np);return lp.dtype!=="int32"&&(lp=cast$1(lp,"int32")),gather$1(sp.embeddings.read(),lp.as1D()).reshape(getExactlyOneShape(sp.computeOutputShape(lp.shape)))})},_d.prototype.getConfig=function(){var np={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:serializeInitializer(this.embeddingsInitializer),embeddingsRegularizer:serializeRegularizer(this.embeddingsRegularizer),activityRegularizer:serializeRegularizer(this.activityRegularizer),embeddingsConstraint:serializeConstraint(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="Embedding",_d}(Layer);Mf.registerClass(Embedding);var Merge=function(rp){function _d(np){var ap=rp.call(this,np||{})||this;return ap.supportsMasking=!0,ap}return __extends$h(_d,rp),_d.prototype.mergeFunction=function(np){throw new NotImplementedError},_d.prototype.computeElementwiseOpOutputShape=function(np,ap){if(np==null||ap==null)return null;if(np.length<ap.length)return this.computeElementwiseOpOutputShape(ap,np);if(ap.length===0)return np;for(var sp=np.slice(0,np.length-ap.length),lp=0;lp<ap.length;++lp){var up=np[np.length-ap.length+lp],cp=ap[lp];if(up==null||cp==null||up<0||cp<0)sp.push(null);else if(up===1)sp.push(cp);else if(cp===1)sp.push(up);else{if(up!==cp)throw new ValueError("Operands could not be broadcast together with shapes "+JSON.stringify(np)+" "+JSON.stringify(ap));sp.push(up)}}return sp},_d.prototype.build=function(np){if(Array.isArray(np)&&!Array.isArray(np[0])&&(np=[getExactlyOneShape(np)]),(np=np).length<2)throw new ValueError("A merge layer should be called on an Array of at least 2 inputs. Got "+np.length+" input(s).");for(var ap=[],sp=0,lp=np;sp<lp.length;sp++)(dp=lp[sp])!=null&&dp[0]!==null&&ap.push(dp[0]);if((ap=unique(ap)).length>1)throw new ValueError("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(np)+".");for(var up=np[0]==null?null:np[0].slice(1),cp=1;cp<np.length;++cp){var dp=np[cp]==null?null:np[cp].slice(1);up=this.computeElementwiseOpOutputShape(up,dp)}var hp=np.map(function(fp){return fp.length});np.indexOf(null)===-1&&unique(hp).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},_d.prototype.call=function(np,ap){var sp=this;return je(function(){if(np=np,sp.reshapeRequired){var lp=[],up=np.map(function(Mp){return Mp.rank});if(up.indexOf(null)===-1){for(var cp=max$1(up),dp=0,hp=np;dp<hp.length;dp++){for(var fp=(xp=hp[dp]).rank,pp=0;pp<cp-fp;++pp)xp=expandDims$1(xp,1);lp.push(xp)}return sp.mergeFunction(lp)}for(var mp=!1,gp=0,yp=np;gp<yp.length;gp++){var xp;if((fp=(xp=yp[gp]).rank)==null){var _p=xp.shape,vp=_p[0],bp=_p.slice(1).concat([vp]),Ep=xp.reshape([vp].concat(arrayProd(_p.slice(1))));Ep=(Ep=El(Ep,[1,0])).reshape(bp),lp.push(Ep),mp=!0}else if(fp>1){var Sp=range(1,fp).concat([0]);lp.push(El(xp,Sp)),mp=!0}else lp.push(xp)}var Ap=sp.mergeFunction(lp),Rp=Ap.rank;if(mp)if(Rp==null){var Tp=Ap.shape;bp=[vp=Tp[Tp.length-1]].concat(Tp.slice(0,Tp.length-1)),Ap=El(Ap.reshape([-1,vp]),[1,0]).reshape(bp)}else Rp>1&&(Sp=[Rp-1].concat(range(0,Rp-1)),Ap=El(Ap,Sp));return Ap}return sp.mergeFunction(np)})},_d.prototype.computeOutputShape=function(np){var ap;ap=(np=np)[0]==null?null:np[0].slice(1);for(var sp=1;sp<np.length;++sp){var lp=np[sp]==null?null:np[sp].slice(1);ap=this.computeElementwiseOpOutputShape(ap,lp)}for(var up=[],cp=0,dp=np;cp<dp.length;cp++)(lp=dp[cp])!=null&&lp[0]!==null&&up.push(lp[0]);return ap=(up=unique(up)).length===1?up.concat(ap):[null].concat(ap)},_d.prototype.computeMask=function(np,ap){return je(function(){if(ap==null)return null;if(!Array.isArray(ap))throw new ValueError("`mask` should be an Array");if(!Array.isArray(np))throw new ValueError("`inputs` should be an Array");if(ap.length!==np.length)throw new ValueError("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+np.length+" vs "+ap.length+")");if(ap.every(function(up){return up==null}))return null;for(var sp=(ap=ap.map(function(up){return up==null?up:dr(up,0)}))[0],lp=1;lp<ap.length-1;++lp)sp=Ms(sp,ap[lp]);return sp})},_d}(Layer),Add=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.mergeFunction=function(np){return je(function(){for(var ap=np[0].clone(),sp=1;sp<np.length;++sp)ap=Vs(ap,np[sp]);return ap})},_d.className="Add",_d}(Merge);Mf.registerClass(Add);var Multiply=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.mergeFunction=function(np){return je(function(){for(var ap=np[0].clone(),sp=1;sp<np.length;++sp)ap=tc(ap,np[sp]);return ap})},_d.className="Multiply",_d}(Merge);Mf.registerClass(Multiply);var Average=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.mergeFunction=function(np){return je(function(){for(var ap=np[0].clone(),sp=1;sp<np.length;++sp)ap=Vs(ap,np[sp]);return tc(1/np.length,ap)})},_d.className="Average",_d}(Merge);Mf.registerClass(Average);var Maximum=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.mergeFunction=function(np){return je(function(){for(var ap=np[0],sp=1;sp<np.length;++sp)ap=Xs(ap,np[sp]);return ap})},_d.className="Maximum",_d}(Merge);Mf.registerClass(Maximum);var Minimum=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.mergeFunction=function(np){return je(function(){for(var ap=np[0],sp=1;sp<np.length;++sp)ap=Ys(ap,np[sp]);return ap})},_d.className="Minimum",_d}(Merge);Mf.registerClass(Minimum);var Concatenate=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.DEFAULT_AXIS=-1,np==null&&(np={}),ap.axis=np.axis==null?ap.DEFAULT_AXIS:np.axis,ap.supportsMasking=!0,ap.reshapeRequired=!1,ap}return __extends$h(_d,rp),_d.prototype.build=function(np){if(!Array.isArray(np)||!Array.isArray(np[0])||np.length===1)throw new ValueError("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var ap=!0,sp=0,lp=np=np;sp<lp.length;sp++)if((mp=lp[sp])!=null){ap=!1;break}if(!ap){for(var up=[],cp=0;cp<np.length;++cp){var dp=np[cp].slice();dp.splice(this.axis,1);for(var hp=!1,fp=0,pp=up;fp<pp.length;fp++){var mp=pp[fp];if(tt.arraysEqual(mp,dp)){hp=!0;break}}hp||up.push(dp)}if(up.length>1)throw new ValueError("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(np))}},_d.prototype.mergeFunction=function(np){var ap=this;return je(function(){return concatenate(np,ap.axis)})},_d.prototype.computeOutputShape=function(np){if(!Array.isArray(np)||!Array.isArray(np[0]))throw new ValueError("A `Concatenate` layer should be called on a list of inputs.");for(var ap=np,sp=ap[0].slice(),lp=this.axis<0?sp.length+this.axis:this.axis,up=0,cp=ap.slice(1);up<cp.length;up++){var dp=cp[up];if(sp[lp]==null||dp[lp]==null){sp[lp]=null;break}sp[lp]+=dp[lp]}return sp},_d.prototype.computeMask=function(np,ap){var sp=this;if(ap==null)return null;if(!Array.isArray(ap))throw new ValueError("`mask` should be an array for Concatenate");if(!Array.isArray(np))throw new ValueError("`inputs` should be an array for Concatenate");if(ap.length!==np.length)throw new ValueError("Mismatch in the length of mask ("+ap.length+") and the legnth of inputs ("+np.length+")");return je(function(){var lp=!0;if(ap.forEach(function(hp){hp==null||(lp=!1)}),lp)return null;for(var up=[],cp=0;cp<np.length;++cp)ap[cp]==null?up.push(Vn(np[cp]).asType("bool")):ap[cp].rank<np[cp].rank?up.push(dr(ap[cp],-1)):up.push(ap[cp]);var dp=Gn(up,sp.axis);return il(dp,-1,!1)})},_d.prototype.getConfig=function(){var np={axis:this.axis},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="Concatenate",_d}(Merge);function interpretAxis(rp,_d){for(;rp<0;)rp+=_d;return rp}function batchDot(rp,_d,np){if(rp.shape.length>3||_d.shape.length>3)throw new NotImplementedError("batchDot is not implemented for tensors of 4D or higher rank yet");if(tt.assert(rp.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+rp.shape.length}),tt.assert(rp.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+_d.shape.length}),typeof np=="number"&&(np=[np,np]),rp.dtype==="complex64"||_d.dtype==="complex64")throw new NotImplementedError("batchDot is not implemented for complex64-type Tensors yet.");var ap=rp.shape.length,sp=_d.shape.length;np==null&&(np=[ap-1,sp-2]);var lp=np;return je(function(){var up,cp;if(ap>sp){up=ap-sp;for(var dp=[],hp=0;hp<up;++hp)dp.push(1);_d=_d.reshape(_d.shape.concat(dp))}else if(sp>ap){for(up=sp-ap,dp=[],hp=0;hp<up;++hp)dp.push(1);rp=rp.reshape(rp.shape.concat(dp))}else up=0;if(rp.shape.length===2&&_d.shape.length===2)cp=lp[0]===lp[1]?rp.mulStrict(_d).sum(lp[0]):rp.transpose([1,0]).mulStrict(_d).sum(lp[1]);else{var fp=lp[0]!==rp.shape.length-1,pp=lp[1]===_d.shape.length-1;cp=rp.matMul(_d,fp,pp)}if(up>0){var mp=void 0,gp=[];for(hp=mp=ap>sp?ap+sp-3:ap-1;hp<mp+up;++hp)gp.push(hp);cp=cp.squeeze(gp)}return cp.shape.length===1&&(cp=cp.expandDims(1)),cp})}Mf.registerClass(Concatenate);var Dot=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.axes=np.axes,ap.normalize=np.normalize!=null&&np.normalize,ap.supportsMasking=!0,ap.reshapeRequired=!1,ap}return __extends$h(_d,rp),_d.prototype.build=function(np){tt.assert(Array.isArray(np)&&np.length===2&&Array.isArray(np[0])&&Array.isArray(np[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var ap=np[0],sp=np[1];if(ap.length>3||sp.length>3)throw new NotImplementedError("Dot layer does not support tensors of 4D or higher rank yet.");var lp=this.interpretAxes(ap,sp);if(ap[lp[0]]!==sp[lp[1]])throw new ValueError("Dimension incompatibility: "+ap[lp[0]]+" !== "+sp[lp[1]])},_d.prototype.mergeFunction=function(np){if(np.length!==2)throw new ValueError("A `Dot` layer must be called on exactly 2 inputs, but received "+np.length+" input(s).");var ap,sp=np[0],lp=np[1];return ap=Array.isArray(this.axes)?this.axes.map(function(up,cp){return interpretAxis(up,np[cp].shape.length)}):[interpretAxis(this.axes,sp.shape.length),interpretAxis(this.axes,lp.shape.length)],this.normalize&&(sp=l2Normalize(sp,ap[0]),lp=l2Normalize(lp,ap[1])),batchDot(sp,lp,ap)},_d.prototype.interpretAxes=function(np,ap){return Array.isArray(this.axes)?this.axes:[interpretAxis(this.axes,np.length),interpretAxis(this.axes,ap.length)]},_d.prototype.computeOutputShape=function(np){tt.assert(Array.isArray(np)&&np.length===2&&Array.isArray(np[0])&&Array.isArray(np[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var ap=np[0].slice(),sp=np[1].slice();if(ap.length>3||sp.length>3)throw new NotImplementedError("Dot layer does not support tensors of 4D or higher rank yet.");var lp=this.interpretAxes(ap,sp);ap.splice(lp[0],1),sp.splice(lp[1],1),sp.splice(0,1);var up=ap.concat(sp);return up.length===1&&up.push(1),up},_d.prototype.computeMask=function(np,ap){return null},_d.prototype.getConfig=function(){var np={axes:this.axes,normalize:this.normalize},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="Dot",_d}(Merge);Mf.registerClass(Dot);var GaussianNoise=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.supportsMasking=!0,ap.stddev=np.stddev,ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){return np},_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this),ap={stddev:this.stddev};return Object.assign(ap,np),ap},_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.invokeCallHook(np,ap);var lp=getExactlyOneTensor(np);return inTrainPhase(function(){return randomNormal$1(lp.shape,0,sp.stddev).add(lp)},function(){return lp},ap.training||!1)})},_d.className="GaussianNoise",_d}(Layer);Mf.registerClass(GaussianNoise);var GaussianDropout=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.supportsMasking=!0,ap.rate=np.rate,ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){return np},_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this),ap={rate:this.rate};return Object.assign(ap,np),ap},_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.invokeCallHook(np,ap);var lp=getExactlyOneTensor(np);return sp.rate>0&&sp.rate<1?inTrainPhase(function(){var up=Math.sqrt(sp.rate/(1-sp.rate));return lp.mul(randomNormal$1(lp.shape,1,up))},function(){return lp},ap.training||!1):lp})},_d.className="GaussianDropout",_d}(Layer);Mf.registerClass(GaussianDropout);var AlphaDropout=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.supportsMasking=!0,ap.rate=np.rate,ap.noiseShape=np.noiseShape,ap}return __extends$h(_d,rp),_d.prototype._getNoiseShape=function(np){return this.noiseShape||getExactlyOneTensor(np).shape},_d.prototype.computeOutputShape=function(np){return np},_d.prototype.getConfig=function(){var np=rp.prototype.getConfig.call(this),ap={rate:this.rate};return Object.assign(ap,np),ap},_d.prototype.call=function(np,ap){var sp=this;return je(function(){if(sp.rate<1&&sp.rate>0){var lp=sp._getNoiseShape(np);return inTrainPhase(function(){var up=getExactlyOneTensor(np),cp=-1.7580993408473766,dp=hc(kr(lp),sp.rate);dp=cast$1(dp,"float32");var hp=Math.pow((1-sp.rate)*(1+sp.rate*Math.pow(cp,2)),-.5),fp=-hp*cp*sp.rate;return up.mul(dp).add(dp.add(-1).mul(cp)).mul(hp).add(fp)},function(){return getExactlyOneTensor(np)},ap.training||!1)}return np})},_d.className="AlphaDropout",_d}(Layer);function batchNormalization(rp,_d,np,ap,sp,lp){var up;if(lp===void 0&&(lp=.001),rp.rank===2)up=Fs(rp,_d,np,ap,sp,lp);else if(rp.rank===3)up=Os(rp,_d,np,ap,sp,lp);else{if(rp.rank!==4)throw new NotImplementedError("batchNormalization is not implemented for array of rank "+rp.rank+" yet");up=_s(rp,_d,np,ap,sp,lp)}return up}function regularNormalizeBatchInTraining(rp,_d,np,ap,sp){return sp===void 0&&(sp=.001),je(function(){var lp=dl(rp,ap),up=lp.mean,cp=lp.variance;return[batchNormalization(rp,up,cp,np,_d,sp),up,cp]})}function broadcastNormalizeBatchInTraining(rp,_d,np,ap,sp){return sp===void 0&&(sp=.001),je(function(){for(var lp=dl(rp,ap),up=lp.mean,cp=lp.variance,dp=[],hp=0,fp=range(0,rp.rank);hp<fp.length;hp++){var pp=fp[hp];ap.indexOf(pp)!==-1?dp.push(1):dp.push(rp.shape[pp])}var mp=up.reshape(dp),gp=cp.reshape(dp),yp=_d==null?null:_d.reshape(dp),xp=np==null?null:np.reshape(dp);return[batchNormalization(rp,mp,gp,xp,yp,sp),up,cp]})}function normalizeBatchInTraining(rp,_d,np,ap,sp){return sp===void 0&&(sp=.001),tt.arraysEqual(ap.slice().sort(),range(0,rp.rank-1))?regularNormalizeBatchInTraining(rp,_d,np,ap,sp):broadcastNormalizeBatchInTraining(rp,_d,np,ap,sp)}Mf.registerClass(AlphaDropout);var BatchNormalization=function(rp){function _d(np){var ap=this;return np==null&&(np={}),(ap=rp.call(this,np)||this).supportsMasking=!0,ap.axis=np.axis==null?-1:np.axis,ap.momentum=np.momentum==null?.99:np.momentum,ap.epsilon=np.epsilon==null?.001:np.epsilon,ap.center=np.center==null||np.center,ap.scale=np.scale==null||np.scale,ap.betaInitializer=getInitializer(np.betaInitializer||"zeros"),ap.gammaInitializer=getInitializer(np.gammaInitializer||"ones"),ap.movingMeanInitializer=getInitializer(np.movingMeanInitializer||"zeros"),ap.movingVarianceInitializer=getInitializer(np.movingVarianceInitializer||"ones"),ap.betaConstraint=getConstraint(np.betaConstraint),ap.gammaConstraint=getConstraint(np.gammaConstraint),ap.betaRegularizer=getRegularizer(np.betaRegularizer),ap.gammaRegularizer=getRegularizer(np.gammaRegularizer),ap}return __extends$h(_d,rp),_d.prototype.build=function(np){var ap;np=getExactlyOneShape(np);var sp=this.axis>=0?this.axis:this.axis+np.length,lp=np[sp];if(lp==null)throw new ValueError("Axis "+sp+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(np)+".");this.inputSpec=[new InputSpec({ndim:np.length,axes:(ap={},ap[sp]=lp,ap)})];var up=[lp];this.scale&&(this.gamma=this.addWeight("gamma",up,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",up,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",up,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",up,null,this.movingVarianceInitializer,null,!1),this.built=!0},_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp=ap.training!=null&&ap.training,up=getExactlyOneTensor(np),cp=up.shape,dp=cp.length,hp=range(0,dp),fp=sp.axis>=0?sp.axis:sp.axis+dp;hp.splice(fp,1);var pp=pyListRepeat(1,dp);pp[fp]=cp[fp];var mp=hp.slice();mp.sort();var gp=!tt.arraysEqual(mp,range(0,dp).slice(0,dp-1));if(!lp)return function(){if(gp){var Ep=sp.movingMean.read().reshape(pp),Sp=sp.movingVariance.read().reshape(pp),Ap=sp.center?sp.beta.read().reshape(pp):null,Rp=sp.scale?sp.gamma.read().reshape(pp):null;return batchNormalization(up,Ep,Sp,Ap,Rp,sp.epsilon)}return batchNormalization(up,sp.movingMean.read(),sp.movingVariance.read(),sp.beta==null?null:sp.beta.read(),sp.gamma==null?null:sp.gamma.read(),sp.epsilon)}();var yp=normalizeBatchInTraining(up,sp.gamma.read(),sp.beta.read(),hp,sp.epsilon),xp=yp[0],_p=yp[1],vp=yp[2],bp=function(Ep,Sp,Ap){je(function(){var Rp=1-Ap,Tp=Ep.read(),Mp=Tp.sub(Sp).mul(Rp);Ep.write(Tp.sub(Mp))})};return bp(sp.movingMean,_p,sp.momentum),bp(sp.movingVariance,vp,sp.momentum),xp})},_d.prototype.getConfig=function(){var np={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:serializeInitializer(this.betaInitializer),gammaInitializer:serializeInitializer(this.gammaInitializer),movingMeanInitializer:serializeInitializer(this.movingMeanInitializer),movingVarianceInitializer:serializeInitializer(this.movingVarianceInitializer),betaRegularizer:serializeRegularizer(this.betaRegularizer),gammaRegularizer:serializeRegularizer(this.gammaRegularizer),betaConstraint:serializeConstraint(this.betaConstraint),gammaConstraint:serializeConstraint(this.gammaConstraint)},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="BatchNormalization",_d}(Layer);Mf.registerClass(BatchNormalization);var LayerNormalization=function(rp){function _d(np){var ap=this;if(np==null&&(np={}),(ap=rp.call(this,np)||this).axis=np.axis==null?-1:np.axis,typeof ap.axis=="number"){if(!Number.isInteger(ap.axis))throw new Error("Expected axis to be an integer, but received "+ap.axis)}else{if(!Array.isArray(ap.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(ap.axis));for(var sp=0,lp=ap.axis;sp<lp.length;sp++){var up=lp[sp];if(!Number.isInteger(up))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(ap.axis))}}return ap.epsilon=np.epsilon==null?.001:np.epsilon,ap.center=np.center==null||np.center,ap.scale=np.scale==null||np.scale,ap.betaInitializer=getInitializer(np.betaInitializer||"zeros"),ap.gammaInitializer=getInitializer(np.gammaInitializer||"ones"),ap.betaRegularizer=getRegularizer(np.betaRegularizer),ap.gammaRegularizer=getRegularizer(np.gammaRegularizer),ap.supportsMasking=!0,ap}return __extends$h(_d,rp),_d.prototype.build=function(np){var ap=(np=getExactlyOneShape(np)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var sp=0;sp<this.axis.length;++sp)this.axis[sp]<0&&(this.axis[sp]+=ap);for(var lp=0,up=this.axis;lp<up.length;lp++){var cp=up[lp];if(cp<0||cp>=ap)throw new Error("Invalid axis: "+cp)}if(this.axis.length!==unique(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var dp=this.axis.map(function(hp){return np[hp]});this.scale?this.gamma=this.addWeight("gamma",dp,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",dp,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},_d.prototype.call=function(np,ap){var sp=this,lp=getExactlyOneTensor(np),up=lp.shape,cp=up.length;return je(function(){for(var dp=dl(lp,sp.axis,!0),hp=dp.mean,fp=dp.variance,pp=pyListRepeat(1,cp),mp=0,gp=sp.axis;mp<gp.length;mp++){var yp=gp[mp];pp[yp]=up[yp]}for(var xp=function(Ap){return Ap!=null&&Ap.shape.length!==cp&&sp.axis!==[cp-1]?Ap.reshape(pp):Ap},_p=xp(sp.gamma.read()),vp=xp(sp.beta.read()),bp=[],Ep=[],Sp=0;Sp<cp;++Sp)sp.axis.indexOf(Sp)!==-1?(bp.push(up[Sp]),Ep.push(1)):(bp.push(1),Ep.push(up[Sp]));return hp=hp.tile(bp),fp=fp.tile(bp),_p=_p.tile(Ep),vp=vp.tile(Ep),batchNormalization(lp,hp,fp,vp,_p,sp.epsilon)})},_d.prototype.getConfig=function(){var np={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:serializeInitializer(this.betaInitializer),gammaInitializer:serializeInitializer(this.gammaInitializer),betaRegularizer:serializeRegularizer(this.betaRegularizer),gammaRegularizer:serializeRegularizer(this.gammaRegularizer)},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="LayerNormalization",_d}(Layer);function spatial2dPadding(rp,_d,np){return je(function(){if(rp.rank!==4)throw new ValueError("temporalPadding expects input tensor to be 4-D, but received a "+rp.rank+"-D tensor.");if(_d==null&&(_d=[[1,1],[1,1]]),_d.length!==2||_d[0].length!==2||_d[1].length!==2)throw new ValueError("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(np==null&&(np=imageDataFormat()),np!=="channelsLast"&&np!=="channelsFirst")throw new ValueError("Unknown data format: "+np+". Supported data formats are 'channelsLast' and 'channelsFirst.");var ap;return ap=np==="channelsFirst"?[[0,0],[0,0],_d[0],_d[1]]:[[0,0],_d[0],_d[1],[0,0]],yr(rp,ap)})}Mf.registerClass(LayerNormalization);var ZeroPadding2D=function(rp){function _d(np){var ap=this;if(np==null&&(np={}),(ap=rp.call(this,np)||this).dataFormat=np.dataFormat==null?imageDataFormat():np.dataFormat,np.padding==null)ap.padding=[[1,1],[1,1]];else if(typeof np.padding=="number")ap.padding=[[np.padding,np.padding],[np.padding,np.padding]];else{if(np.padding=np.padding,np.padding.length!==2)throw new ValueError("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+np.padding.length+" array.");var sp=void 0,lp=void 0;if(typeof np.padding[0]=="number")sp=[np.padding[0],np.padding[0]],lp=[np.padding[1],np.padding[1]];else{if(np.padding=np.padding,np.padding[0].length!==2)throw new ValueError("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+np.padding[0].length+" array.");if(sp=np.padding[0],np.padding[1].length!==2)throw new ValueError("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+np.padding[1].length+" array.");lp=np.padding[1]}ap.padding=[sp,lp]}return ap.inputSpec=[new InputSpec({ndim:4})],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){var ap,sp;return np=getExactlyOneShape(np),this.dataFormat==="channelsFirst"?(ap=np[2]!=null&&np[2]>=0?np[2]+this.padding[0][0]+this.padding[0][1]:null,sp=np[3]!=null&&np[3]>=0?np[3]+this.padding[1][0]+this.padding[1][1]:null,[np[0],np[1],ap,sp]):(ap=np[1]!=null&&np[1]>=0?np[1]+this.padding[0][0]+this.padding[0][1]:null,sp=np[2]!=null&&np[2]>=0?np[2]+this.padding[1][0]+this.padding[1][1]:null,[np[0],ap,sp,np[3]])},_d.prototype.call=function(np,ap){var sp=this;return je(function(){return spatial2dPadding(getExactlyOneTensor(np),sp.padding,sp.dataFormat)})},_d.prototype.getConfig=function(){var np={padding:this.padding,dataFormat:this.dataFormat},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="ZeroPadding2D",_d}(Layer);function pool2d(rp,_d,np,ap,sp,lp){return je(function(){var up;checkDataFormat(sp),checkPoolMode(lp),checkPaddingMode(ap),np==null&&(np=[1,1]),ap==null&&(ap="valid"),sp==null&&(sp=imageDataFormat()),lp==null&&(lp="max"),rp=preprocessConv2DInput(rp,sp);var cp=ap==="same"?"same":"valid";return up=lp==="max"?$c(rp,_d,np,cp):Yc(rp,_d,np,cp),sp==="channelsFirst"&&(up=El(up,[0,3,1,2])),up})}function pool3d(rp,_d,np,ap,sp,lp){return je(function(){var up;checkDataFormat(sp),checkPoolMode(lp),checkPaddingMode(ap),np==null&&(np=[1,1,1]),ap==null&&(ap="valid"),sp==null&&(sp=imageDataFormat()),lp==null&&(lp="max"),rp=preprocessConv3DInput(rp,sp);var cp=ap==="same"?"same":"valid";return up=lp==="max"?Jc(rp,_d,np,cp):Zc(rp,_d,np,cp),sp==="channelsFirst"&&(up=El(up,[0,4,1,2,3])),up})}Mf.registerClass(ZeroPadding2D);var Pooling1D=function(rp){function _d(np){var ap=this;if(np.poolSize==null&&(np.poolSize=2),ap=rp.call(this,np)||this,typeof np.poolSize=="number")ap.poolSize=[np.poolSize];else{if(!Array.isArray(np.poolSize)||np.poolSize.length!==1||typeof np.poolSize[0]!="number")throw new ValueError("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(np.poolSize));ap.poolSize=np.poolSize}if(assertPositiveInteger(ap.poolSize,"poolSize"),np.strides==null)ap.strides=ap.poolSize;else if(typeof np.strides=="number")ap.strides=[np.strides];else{if(!Array.isArray(np.strides)||np.strides.length!==1||typeof np.strides[0]!="number")throw new ValueError("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(np.strides));ap.strides=np.strides}return assertPositiveInteger(ap.strides,"strides"),ap.padding=np.padding==null?"valid":np.padding,checkPaddingMode(ap.padding),ap.inputSpec=[new InputSpec({ndim:3})],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){var ap=convOutputLength((np=getExactlyOneShape(np))[1],this.poolSize[0],this.padding,this.strides[0]);return[np[0],ap,np[2]]},_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.invokeCallHook(np,ap),np=expandDims$1(getExactlyOneTensor(np),2);var lp=sp.poolingFunction(getExactlyOneTensor(np),[sp.poolSize[0],1],[sp.strides[0],1],sp.padding,"channelsLast");return Dr(lp,[2])})},_d.prototype.getConfig=function(){var np={poolSize:this.poolSize,padding:this.padding,strides:this.strides},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d}(Layer),MaxPooling1D=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.poolingFunction=function(np,ap,sp,lp,up){return checkDataFormat(up),checkPaddingMode(lp),pool2d(np,ap,sp,lp,up,"max")},_d.className="MaxPooling1D",_d}(Pooling1D);Mf.registerClass(MaxPooling1D);var AveragePooling1D=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.poolingFunction=function(np,ap,sp,lp,up){return checkDataFormat(up),checkPaddingMode(lp),pool2d(np,ap,sp,lp,up,"avg")},_d.className="AveragePooling1D",_d}(Pooling1D);Mf.registerClass(AveragePooling1D);var Pooling2D=function(rp){function _d(np){var ap=this;if(np.poolSize==null&&(np.poolSize=[2,2]),(ap=rp.call(this,np)||this).poolSize=Array.isArray(np.poolSize)?np.poolSize:[np.poolSize,np.poolSize],np.strides==null)ap.strides=ap.poolSize;else if(Array.isArray(np.strides)){if(np.strides.length!==2)throw new ValueError("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+np.strides.length+".");ap.strides=np.strides}else ap.strides=[np.strides,np.strides];return assertPositiveInteger(ap.poolSize,"poolSize"),assertPositiveInteger(ap.strides,"strides"),ap.padding=np.padding==null?"valid":np.padding,ap.dataFormat=np.dataFormat==null?"channelsLast":np.dataFormat,checkDataFormat(ap.dataFormat),checkPaddingMode(ap.padding),ap.inputSpec=[new InputSpec({ndim:4})],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){np=getExactlyOneShape(np);var ap=this.dataFormat==="channelsFirst"?np[2]:np[1],sp=this.dataFormat==="channelsFirst"?np[3]:np[2];return ap=convOutputLength(ap,this.poolSize[0],this.padding,this.strides[0]),sp=convOutputLength(sp,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[np[0],np[1],ap,sp]:[np[0],ap,sp,np[3]]},_d.prototype.call=function(np,ap){var sp=this;return je(function(){return sp.invokeCallHook(np,ap),sp.poolingFunction(getExactlyOneTensor(np),sp.poolSize,sp.strides,sp.padding,sp.dataFormat)})},_d.prototype.getConfig=function(){var np={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d}(Layer),MaxPooling2D=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.poolingFunction=function(np,ap,sp,lp,up){return checkDataFormat(up),checkPaddingMode(lp),pool2d(np,ap,sp,lp,up,"max")},_d.className="MaxPooling2D",_d}(Pooling2D);Mf.registerClass(MaxPooling2D);var AveragePooling2D=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.poolingFunction=function(np,ap,sp,lp,up){return checkDataFormat(up),checkPaddingMode(lp),pool2d(np,ap,sp,lp,up,"avg")},_d.className="AveragePooling2D",_d}(Pooling2D);Mf.registerClass(AveragePooling2D);var Pooling3D=function(rp){function _d(np){var ap=this;if(np.poolSize==null&&(np.poolSize=[2,2,2]),(ap=rp.call(this,np)||this).poolSize=Array.isArray(np.poolSize)?np.poolSize:[np.poolSize,np.poolSize,np.poolSize],np.strides==null)ap.strides=ap.poolSize;else if(Array.isArray(np.strides)){if(np.strides.length!==3)throw new ValueError("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+np.strides.length+".");ap.strides=np.strides}else ap.strides=[np.strides,np.strides,np.strides];return assertPositiveInteger(ap.poolSize,"poolSize"),assertPositiveInteger(ap.strides,"strides"),ap.padding=np.padding==null?"valid":np.padding,ap.dataFormat=np.dataFormat==null?"channelsLast":np.dataFormat,checkDataFormat(ap.dataFormat),checkPaddingMode(ap.padding),ap.inputSpec=[new InputSpec({ndim:5})],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){np=getExactlyOneShape(np);var ap=this.dataFormat==="channelsFirst"?np[2]:np[1],sp=this.dataFormat==="channelsFirst"?np[3]:np[2],lp=this.dataFormat==="channelsFirst"?np[4]:np[3];return ap=convOutputLength(ap,this.poolSize[0],this.padding,this.strides[0]),sp=convOutputLength(sp,this.poolSize[1],this.padding,this.strides[1]),lp=convOutputLength(lp,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[np[0],np[1],ap,sp,lp]:[np[0],ap,sp,lp,np[4]]},_d.prototype.call=function(np,ap){var sp=this;return je(function(){return sp.invokeCallHook(np,ap),sp.poolingFunction(getExactlyOneTensor(np),sp.poolSize,sp.strides,sp.padding,sp.dataFormat)})},_d.prototype.getConfig=function(){var np={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d}(Layer),MaxPooling3D=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.poolingFunction=function(np,ap,sp,lp,up){return checkDataFormat(up),checkPaddingMode(lp),pool3d(np,ap,sp,lp,up,"max")},_d.className="MaxPooling3D",_d}(Pooling3D);Mf.registerClass(MaxPooling3D);var AveragePooling3D=function(rp){function _d(np){return rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.poolingFunction=function(np,ap,sp,lp,up){return checkDataFormat(up),checkPaddingMode(lp),pool3d(np,ap,sp,lp,up,"avg")},_d.className="AveragePooling3D",_d}(Pooling3D);Mf.registerClass(AveragePooling3D);var GlobalPooling1D=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.inputSpec=[new InputSpec({ndim:3})],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){return[np[0],np[2]]},_d.prototype.call=function(np,ap){throw new NotImplementedError},_d}(Layer),GlobalAveragePooling1D=function(rp){function _d(np){return rp.call(this,np||{})||this}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){return je(function(){var sp=getExactlyOneTensor(np);return fl(sp,1)})},_d.className="GlobalAveragePooling1D",_d}(GlobalPooling1D);Mf.registerClass(GlobalAveragePooling1D);var GlobalMaxPooling1D=function(rp){function _d(np){return rp.call(this,np||{})||this}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){return je(function(){var sp=getExactlyOneTensor(np);return hl(sp,1)})},_d.className="GlobalMaxPooling1D",_d}(GlobalPooling1D);Mf.registerClass(GlobalMaxPooling1D);var GlobalPooling2D=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.dataFormat=np.dataFormat==null?"channelsLast":np.dataFormat,checkDataFormat(ap.dataFormat),ap.inputSpec=[new InputSpec({ndim:4})],ap}return __extends$h(_d,rp),_d.prototype.computeOutputShape=function(np){return np=np,this.dataFormat==="channelsLast"?[np[0],np[3]]:[np[0],np[1]]},_d.prototype.call=function(np,ap){throw new NotImplementedError},_d.prototype.getConfig=function(){var np={dataFormat:this.dataFormat},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d}(Layer),GlobalAveragePooling2D=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp=getExactlyOneTensor(np);return sp.dataFormat==="channelsLast"?fl(lp,[1,2]):fl(lp,[2,3])})},_d.className="GlobalAveragePooling2D",_d}(GlobalPooling2D);Mf.registerClass(GlobalAveragePooling2D);var GlobalMaxPooling2D=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp=getExactlyOneTensor(np);return sp.dataFormat==="channelsLast"?hl(lp,[1,2]):hl(lp,[2,3])})},_d.className="GlobalMaxPooling2D",_d}(GlobalPooling2D);function standardizeArgs(rp,_d,np,ap){if(Array.isArray(rp)){if(_d!=null||np!=null)throw new ValueError("When inputs is an array, neither initialState or constants should be provided");ap!=null&&(np=rp.slice(rp.length-ap,rp.length),rp=rp.slice(0,rp.length-ap)),rp.length>1&&(_d=rp.slice(1,rp.length)),rp=rp[0]}function sp(lp){return lp==null||Array.isArray(lp)?lp:[lp]}return{inputs:rp,initialState:_d=sp(_d),constants:np=sp(np)}}function rnn(rp,_d,np,ap,sp,lp,up,cp){return ap===void 0&&(ap=!1),up===void 0&&(up=!1),cp===void 0&&(cp=!1),je(function(){var dp=_d.shape.length;if(dp<3)throw new ValueError("Input should be at least 3D, but is "+dp+"D.");var hp=[1,0].concat(range(2,dp));if(_d=El(_d,hp),lp!=null)throw new NotImplementedError("The rnn() functoin of the deeplearn.js backend does not support constants yet.");up&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),sp!=null&&((sp=sp.asType("bool").asType("float32")).rank===dp-1&&(sp=dr(sp,-1)),sp=El(sp,hp)),ap&&(_d=zc(_d,0),sp!=null&&(sp=zc(sp,0)));var fp,pp,mp=[],gp=np,yp=_d.shape[0],xp=Or(_d);sp!=null&&(pp=Or(sp));for(var _p,vp=function(Ep){var Sp=xp[Ep],Ap=je(function(){return rp(Sp,gp)});if(sp==null)fp=Ap[0],gp=Ap[1];else{var Rp=je(function(){var Tp=pp[Ep],Mp=Vn(Tp).sub(Tp);return{output:Ap[0].mul(Tp).addStrict(gp[0].mul(Mp)),newStates:gp.map(function(Op,Pp){return Ap[1][Pp].mul(Tp).addStrict(Op.mul(Mp))})}});fp=Rp.output,gp=Rp.newStates}cp&&mp.push(fp)},bp=0;bp<yp;++bp)vp(bp);return cp&&(_p=Tr(mp,1)),[fp,_p,gp]})}Mf.registerClass(GlobalMaxPooling2D);var RNN=function(rp){function _d(np){var ap,sp=rp.call(this,np)||this;if(np.cell==null)throw new ValueError("cell property is missing for the constructor of RNN.");if((ap=Array.isArray(np.cell)?new StackedRNNCells({cells:np.cell}):np.cell).stateSize==null)throw new ValueError("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return sp.cell=ap,sp.returnSequences=np.returnSequences!=null&&np.returnSequences,sp.returnState=np.returnState!=null&&np.returnState,sp.goBackwards=np.goBackwards!=null&&np.goBackwards,sp._stateful=np.stateful!=null&&np.stateful,sp.unroll=np.unroll!=null&&np.unroll,sp.supportsMasking=!0,sp.inputSpec=[new InputSpec({ndim:3})],sp.stateSpec=null,sp.states_=null,sp.numConstants=null,sp.keptStates=[],sp}return __extends$h(_d,rp),_d.prototype.getStates=function(){return this.states_==null?range(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(np){return null}):this.states_},_d.prototype.setStates=function(np){this.states_=np},_d.prototype.computeOutputShape=function(np){isArrayOfShapes(np)&&(np=np[0]),np=np;var ap=this.cell.stateSize;Array.isArray(ap)||(ap=[ap]);var sp,lp=ap[0];if(sp=this.returnSequences?[np[0],np[1],lp]:[np[0],lp],this.returnState){for(var up=[],cp=0,dp=ap;cp<dp.length;cp++){var hp=dp[cp];up.push([np[0],hp])}return[sp].concat(up)}return sp},_d.prototype.computeMask=function(np,ap){var sp=this;return je(function(){Array.isArray(ap)&&(ap=ap[0]);var lp=sp.returnSequences?ap:null;if(sp.returnState){var up=sp.states.map(function(cp){return null});return[lp].concat(up)}return lp})},Object.defineProperty(_d.prototype,"states",{get:function(){if(this.states_==null){for(var np=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,ap=[],sp=0;sp<np;++sp)ap.push(null);return ap}return this.states_},set:function(np){this.states_=np},enumerable:!0,configurable:!0}),_d.prototype.build=function(np){if(this.numConstants!=null)throw new NotImplementedError("Constants support is not implemented in RNN yet.");isArrayOfShapes(np)&&(np=np[0]),np=np;var ap=this.stateful?np[0]:null,sp=np[np.length-1];this.inputSpec[0]=new InputSpec({shape:[ap,null,sp]});var lp,up=[np[0]].concat(np.slice(2));if(this.cell.build(up),lp=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!tt.arraysEqual(this.stateSpec.map(function(cp){return cp.shape[cp.shape.length-1]}),lp))throw new ValueError("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=lp.map(function(cp){return new InputSpec({shape:[null,cp]})});this.stateful&&this.resetStates()},_d.prototype.resetStates=function(np,ap){var sp=this;ap===void 0&&(ap=!1),je(function(){if(!sp.stateful)throw new AttributeError("Cannot call resetStates() on an RNN Layer that is not stateful.");var lp=sp.inputSpec[0].shape[0];if(lp==null)throw new ValueError("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(sp.states_==null)Array.isArray(sp.cell.stateSize)?sp.states_=sp.cell.stateSize.map(function(fp){return Pn([lp,fp])}):sp.states_=[Pn([lp,sp.cell.stateSize])];else if(np==null)Xe(sp.states_),sp.keptStates!=null&&(Xe(sp.keptStates),sp.keptStates=[]),Array.isArray(sp.cell.stateSize)?sp.states_=sp.cell.stateSize.map(function(fp){return Pn([lp,fp])}):sp.states_[0]=Pn([lp,sp.cell.stateSize]);else{if(Array.isArray(np)||(np=[np]),np.length!==sp.states_.length)throw new ValueError("Layer "+sp.name+" expects "+sp.states_.length+" state(s), but it received "+np.length+" state value(s). Input received: "+np);ap===!0?sp.keptStates.push(sp.states_.slice()):Xe(sp.states_);for(var up=0;up<sp.states_.length;++up){var cp=np[up],dp=Array.isArray(sp.cell.stateSize)?sp.cell.stateSize[up]:sp.cell.stateSize,hp=[lp,dp];if(!tt.arraysEqual(cp.shape,hp))throw new ValueError("State "+up+" is incompatible with layer "+sp.name+": expected shape="+hp+", received shape="+cp.shape);sp.states_[up]=cp}}sp.states_=sp.states_.map(function(fp){return $e(fp.clone())})})},_d.prototype.apply=function(np,ap){var sp=ap==null?null:ap.initialState,lp=ap==null?null:ap.constants;ap==null&&(ap={});var up=standardizeArgs(np,sp,lp,this.numConstants);np=up.inputs,sp=up.initialState,lp=up.constants;var cp=[],dp=[];if(sp!=null){ap.initialState=sp,cp=cp.concat(sp),this.stateSpec=[];for(var hp=0,fp=sp;hp<fp.length;hp++){var pp=fp[hp];this.stateSpec.push(new InputSpec({shape:pp.shape}))}dp=dp.concat(this.stateSpec)}if(lp!=null&&(ap.constants=lp,cp=cp.concat(lp),this.numConstants=lp.length),cp[0]instanceof SymbolicTensor){var mp=[np].concat(cp),gp=this.inputSpec.concat(dp),yp=this.inputSpec;this.inputSpec=gp;var xp=rp.prototype.apply.call(this,mp,ap);return this.inputSpec=yp,xp}return rp.prototype.apply.call(this,np,ap)},_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp=ap==null?null:ap.mask,up=ap==null?null:ap.training,cp=ap==null?null:ap.initialState;np=getExactlyOneTensor(np),cp==null&&(cp=sp.stateful?sp.states_:sp.getInitialState(np));var dp=Array.isArray(sp.cell.stateSize)?sp.cell.stateSize.length:1;if(cp.length!==dp)throw new ValueError("RNN Layer has "+dp+" state(s) but was passed "+cp.length+" initial state(s).");sp.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var hp={training:up},fp=rnn(function(xp,_p){var vp=sp.cell.call([xp].concat(_p),hp);return[vp[0],vp.slice(1)]},np,cp,sp.goBackwards,lp,null,sp.unroll,sp.returnSequences),pp=fp[0],mp=fp[1],gp=fp[2];sp.stateful&&sp.resetStates(gp,up);var yp=sp.returnSequences?mp:pp;return sp.returnState?[yp].concat(gp):yp})},_d.prototype.getInitialState=function(np){var ap=this;return je(function(){var sp=Pn(np.shape);return sp=expandDims$1(sp=vl(sp,[1,2])),Array.isArray(ap.cell.stateSize)?ap.cell.stateSize.map(function(lp){return lp>1?tile$1(sp,[1,lp]):sp}):ap.cell.stateSize>1?[tile$1(sp,[1,ap.cell.stateSize])]:[sp]})},Object.defineProperty(_d.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),_d.prototype.setFastWeightInitDuringBuild=function(np){rp.prototype.setFastWeightInitDuringBuild.call(this,np),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(np)},_d.prototype.getConfig=function(){var np={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(np.numConstants=this.numConstants);var ap=this.cell.getConfig();np.cell={className:this.cell.getClassName(),config:ap};var sp=rp.prototype.getConfig.call(this);return Object.assign(np,sp),np},_d.fromConfig=function(np,ap,sp){sp===void 0&&(sp={});var lp=deserialize(ap.cell,sp);return new np(Object.assign(ap,{cell:lp}))},_d.className="RNN",_d}(Layer);Mf.registerClass(RNN);var RNNCell=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$h(_d,rp),_d}(Layer),SimpleRNNCell=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.DEFAULT_ACTIVATION="tanh",ap.DEFAULT_KERNEL_INITIALIZER="glorotNormal",ap.DEFAULT_RECURRENT_INITIALIZER="orthogonal",ap.DEFAULT_BIAS_INITIALIZER="zeros",ap.units=np.units,assertPositiveInteger(ap.units,"units"),ap.activation=getActivation(np.activation==null?ap.DEFAULT_ACTIVATION:np.activation),ap.useBias=np.useBias==null||np.useBias,ap.kernelInitializer=getInitializer(np.kernelInitializer||ap.DEFAULT_KERNEL_INITIALIZER),ap.recurrentInitializer=getInitializer(np.recurrentInitializer||ap.DEFAULT_RECURRENT_INITIALIZER),ap.biasInitializer=getInitializer(np.biasInitializer||ap.DEFAULT_BIAS_INITIALIZER),ap.kernelRegularizer=getRegularizer(np.kernelRegularizer),ap.recurrentRegularizer=getRegularizer(np.recurrentRegularizer),ap.biasRegularizer=getRegularizer(np.biasRegularizer),ap.kernelConstraint=getConstraint(np.kernelConstraint),ap.recurrentConstraint=getConstraint(np.recurrentConstraint),ap.biasConstraint=getConstraint(np.biasConstraint),ap.dropout=min$1$1([1,max$1([0,np.dropout==null?0:np.dropout])]),ap.recurrentDropout=min$1$1([1,max$1([0,np.recurrentDropout==null?0:np.recurrentDropout])]),ap.stateSize=ap.units,ap.dropoutMask=null,ap.recurrentDropoutMask=null,ap}return __extends$h(_d,rp),_d.prototype.build=function(np){np=getExactlyOneShape(np),this.kernel=this.addWeight("kernel",[np[np.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},_d.prototype.call=function(np,ap){var sp=this;return je(function(){if((np=np).length!==2)throw new ValueError("SimpleRNNCell expects 2 input Tensors, got "+np.length+".");var lp=np[1];np=np[0];var up,cp=ap.training!=null&&ap.training;0<sp.dropout&&sp.dropout<1&&sp.dropoutMask==null&&(sp.dropoutMask=generateDropoutMask(function(){return Vn(np)},sp.dropout,cp)),0<sp.recurrentDropout&&sp.recurrentDropout<1&&sp.recurrentDropoutMask==null&&(sp.recurrentDropoutMask=generateDropoutMask(function(){return Vn(lp)},sp.recurrentDropout,cp));var dp=sp.dropoutMask,hp=sp.recurrentDropoutMask;up=dot(dp!=null?tc(np,dp):np,sp.kernel.read()),sp.bias!=null&&(up=biasAdd(up,sp.bias.read())),hp!=null&&(lp=tc(lp,hp));var fp=Vs(up,dot(lp,sp.recurrentKernel.read()));return sp.activation!=null&&(fp=sp.activation.apply(fp)),[fp,fp]})},_d.prototype.getConfig=function(){var np={units:this.units,activation:serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:serializeInitializer(this.kernelInitializer),recurrentInitializer:serializeInitializer(this.recurrentInitializer),biasInitializer:serializeInitializer(this.biasInitializer),kernelRegularizer:serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:serializeRegularizer(this.recurrentRegularizer),biasRegularizer:serializeRegularizer(this.biasRegularizer),activityRegularizer:serializeRegularizer(this.activityRegularizer),kernelConstraint:serializeConstraint(this.kernelConstraint),recurrentConstraint:serializeConstraint(this.recurrentConstraint),biasConstraint:serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="SimpleRNNCell",_d}(RNNCell);Mf.registerClass(SimpleRNNCell);var SimpleRNN=function(rp){function _d(np){return np.cell=new SimpleRNNCell(np),rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.cell.dropoutMask!=null&&(Xe(sp.cell.dropoutMask),sp.cell.dropoutMask=null),sp.cell.recurrentDropoutMask!=null&&(Xe(sp.cell.recurrentDropoutMask),sp.cell.recurrentDropoutMask=null);var lp=ap==null?null:ap.mask,up=ap==null?null:ap.training,cp=ap==null?null:ap.initialState;return rp.prototype.call.call(sp,np,{mask:lp,training:up,initialState:cp})})},Object.defineProperty(_d.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),_d.prototype.getConfig=function(){var np={units:this.units,activation:serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:serializeInitializer(this.kernelInitializer),recurrentInitializer:serializeInitializer(this.recurrentInitializer),biasInitializer:serializeInitializer(this.biasInitializer),kernelRegularizer:serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:serializeRegularizer(this.recurrentRegularizer),biasRegularizer:serializeRegularizer(this.biasRegularizer),activityRegularizer:serializeRegularizer(this.activityRegularizer),kernelConstraint:serializeConstraint(this.kernelConstraint),recurrentConstraint:serializeConstraint(this.recurrentConstraint),biasConstraint:serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},ap=rp.prototype.getConfig.call(this);return delete ap.cell,Object.assign(np,ap),np},_d.fromConfig=function(np,ap){return new np(ap)},_d.className="SimpleRNN",_d}(RNN);Mf.registerClass(SimpleRNN);var GRUCell=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.DEFAULT_ACTIVATION="tanh",ap.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",ap.DEFAULT_KERNEL_INITIALIZER="glorotNormal",ap.DEFAULT_RECURRENT_INITIALIZER="orthogonal",ap.DEFAULT_BIAS_INITIALIZER="zeros",ap.units=np.units,assertPositiveInteger(ap.units,"units"),ap.activation=getActivation(np.activation===void 0?ap.DEFAULT_ACTIVATION:np.activation),ap.recurrentActivation=getActivation(np.recurrentActivation===void 0?ap.DEFAULT_RECURRENT_ACTIVATION:np.recurrentActivation),ap.useBias=np.useBias==null||np.useBias,ap.kernelInitializer=getInitializer(np.kernelInitializer||ap.DEFAULT_KERNEL_INITIALIZER),ap.recurrentInitializer=getInitializer(np.recurrentInitializer||ap.DEFAULT_RECURRENT_INITIALIZER),ap.biasInitializer=getInitializer(np.biasInitializer||ap.DEFAULT_BIAS_INITIALIZER),ap.kernelRegularizer=getRegularizer(np.kernelRegularizer),ap.recurrentRegularizer=getRegularizer(np.recurrentRegularizer),ap.biasRegularizer=getRegularizer(np.biasRegularizer),ap.kernelConstraint=getConstraint(np.kernelConstraint),ap.recurrentConstraint=getConstraint(np.recurrentConstraint),ap.biasConstraint=getConstraint(np.biasConstraint),ap.dropout=min$1$1([1,max$1([0,np.dropout==null?0:np.dropout])]),ap.recurrentDropout=min$1$1([1,max$1([0,np.recurrentDropout==null?0:np.recurrentDropout])]),ap.implementation=np.implementation,ap.stateSize=ap.units,ap.dropoutMask=null,ap.recurrentDropoutMask=null,ap}return __extends$h(_d,rp),_d.prototype.build=function(np){var ap=(np=getExactlyOneShape(np))[np.length-1];this.kernel=this.addWeight("kernel",[ap,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},_d.prototype.call=function(np,ap){var sp=this;return je(function(){if((np=np).length!==2)throw new ValueError("GRUCell expects 2 input Tensors (inputs, h, c), got "+np.length+".");var lp=ap.training!=null&&ap.training,up=np[1];np=np[0],0<sp.dropout&&sp.dropout<1&&sp.dropoutMask==null&&(sp.dropoutMask=generateDropoutMask(function(){return Vn(np)},sp.dropout,lp,3)),0<sp.recurrentDropout&&sp.recurrentDropout<1&&sp.recurrentDropoutMask==null&&(sp.recurrentDropoutMask=generateDropoutMask(function(){return Vn(up)},sp.recurrentDropout,lp,3));var cp,dp,hp,fp=sp.dropoutMask,pp=sp.recurrentDropoutMask;0<sp.dropout&&sp.dropout<1&&(np=tc(np,fp[0]));var mp=dot(np,sp.kernel.read());sp.useBias&&(mp=biasAdd(mp,sp.bias.read())),0<sp.recurrentDropout&&sp.recurrentDropout<1&&(up=tc(up,pp[0]));var gp=sp.recurrentKernel.read(),yp=Xn(gp,[2*sp.units,sp.units],gp.rank-1),xp=yp[0],_p=yp[1],vp=dot(up,xp),bp=Xn(mp,3,mp.rank-1),Ep=bp[0],Sp=bp[1],Ap=bp[2],Rp=Xn(vp,2,vp.rank-1),Tp=Rp[0],Mp=Rp[1];cp=sp.recurrentActivation.apply(Vs(Ep,Tp)),dp=sp.recurrentActivation.apply(Vs(Sp,Mp));var Op=dot(tc(dp,up),_p);hp=sp.activation.apply(Vs(Ap,Op));var Pp=Vs(tc(cp,up),tc(Vs(1,as(cp)),hp));return[Pp,Pp]})},_d.prototype.getConfig=function(){var np={units:this.units,activation:serializeActivation(this.activation),recurrentActivation:serializeActivation(this.recurrentActivation),useBias:this.useBias,kernelInitializer:serializeInitializer(this.kernelInitializer),recurrentInitializer:serializeInitializer(this.recurrentInitializer),biasInitializer:serializeInitializer(this.biasInitializer),kernelRegularizer:serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:serializeRegularizer(this.recurrentRegularizer),biasRegularizer:serializeRegularizer(this.biasRegularizer),activityRegularizer:serializeRegularizer(this.activityRegularizer),kernelConstraint:serializeConstraint(this.kernelConstraint),recurrentConstraint:serializeConstraint(this.recurrentConstraint),biasConstraint:serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="GRUCell",_d}(RNNCell);Mf.registerClass(GRUCell);var GRU=function(rp){function _d(np){return np.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),np.cell=new GRUCell(np),rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.cell.dropoutMask!=null&&(Xe(sp.cell.dropoutMask),sp.cell.dropoutMask=null),sp.cell.recurrentDropoutMask!=null&&(Xe(sp.cell.recurrentDropoutMask),sp.cell.recurrentDropoutMask=null);var lp=ap==null?null:ap.mask,up=ap==null?null:ap.training,cp=ap==null?null:ap.initialState;return rp.prototype.call.call(sp,np,{mask:lp,training:up,initialState:cp})})},Object.defineProperty(_d.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),_d.prototype.getConfig=function(){var np={units:this.units,activation:serializeActivation(this.activation),recurrentActivation:serializeActivation(this.recurrentActivation),useBias:this.useBias,kernelInitializer:serializeInitializer(this.kernelInitializer),recurrentInitializer:serializeInitializer(this.recurrentInitializer),biasInitializer:serializeInitializer(this.biasInitializer),kernelRegularizer:serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:serializeRegularizer(this.recurrentRegularizer),biasRegularizer:serializeRegularizer(this.biasRegularizer),activityRegularizer:serializeRegularizer(this.activityRegularizer),kernelConstraint:serializeConstraint(this.kernelConstraint),recurrentConstraint:serializeConstraint(this.recurrentConstraint),biasConstraint:serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},ap=rp.prototype.getConfig.call(this);return delete ap.cell,Object.assign(np,ap),np},_d.fromConfig=function(np,ap){return ap.implmentation===0&&(ap.implementation=1),new np(ap)},_d.className="GRU",_d}(RNN);Mf.registerClass(GRU);var LSTMCell=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.DEFAULT_ACTIVATION="tanh",ap.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",ap.DEFAULT_KERNEL_INITIALIZER="glorotNormal",ap.DEFAULT_RECURRENT_INITIALIZER="orthogonal",ap.DEFAULT_BIAS_INITIALIZER="zeros",ap.units=np.units,assertPositiveInteger(ap.units,"units"),ap.activation=getActivation(np.activation===void 0?ap.DEFAULT_ACTIVATION:np.activation),ap.recurrentActivation=getActivation(np.recurrentActivation===void 0?ap.DEFAULT_RECURRENT_ACTIVATION:np.recurrentActivation),ap.useBias=np.useBias==null||np.useBias,ap.kernelInitializer=getInitializer(np.kernelInitializer||ap.DEFAULT_KERNEL_INITIALIZER),ap.recurrentInitializer=getInitializer(np.recurrentInitializer||ap.DEFAULT_RECURRENT_INITIALIZER),ap.biasInitializer=getInitializer(np.biasInitializer||ap.DEFAULT_BIAS_INITIALIZER),ap.unitForgetBias=np.unitForgetBias,ap.kernelRegularizer=getRegularizer(np.kernelRegularizer),ap.recurrentRegularizer=getRegularizer(np.recurrentRegularizer),ap.biasRegularizer=getRegularizer(np.biasRegularizer),ap.kernelConstraint=getConstraint(np.kernelConstraint),ap.recurrentConstraint=getConstraint(np.recurrentConstraint),ap.biasConstraint=getConstraint(np.biasConstraint),ap.dropout=min$1$1([1,max$1([0,np.dropout==null?0:np.dropout])]),ap.recurrentDropout=min$1$1([1,max$1([0,np.recurrentDropout==null?0:np.recurrentDropout])]),ap.implementation=np.implementation,ap.stateSize=[ap.units,ap.units],ap.dropoutMask=null,ap.recurrentDropoutMask=null,ap}return __extends$h(_d,rp),_d.prototype.build=function(np){var ap,sp,lp=(np=getExactlyOneShape(np))[np.length-1];if(this.kernel=this.addWeight("kernel",[lp,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var up=this.biasInitializer,cp=this.units;sp=new((ap=function(dp){function hp(){return dp!==null&&dp.apply(this,arguments)||this}return __extends$h(hp,dp),hp.prototype.apply=function(fp,pp){var mp=up.apply([cp]),gp=new Ones().apply([cp]),yp=up.apply([2*cp]);return concatAlongFirstAxis(concatAlongFirstAxis(mp,gp),yp)},hp}(Initializer)).className="CustomInit",ap)}else sp=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,sp,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},_d.prototype.call=function(np,ap){var sp=this;return je(function(){var lp=ap.training!=null&&ap.training;if((np=np).length!==3)throw new ValueError("LSTMCell expects 3 input Tensors (inputs, h, c), got "+np.length+".");var up=np[1],cp=np[2];np=np[0],0<sp.dropout&&sp.dropout<1&&sp.dropoutMask==null&&(sp.dropoutMask=generateDropoutMask(function(){return Vn(np)},sp.dropout,lp,4)),0<sp.recurrentDropout&&sp.recurrentDropout<1&&sp.recurrentDropoutMask==null&&(sp.recurrentDropoutMask=generateDropoutMask(function(){return Vn(up)},sp.recurrentDropout,lp,4));var dp,hp,fp,pp,mp=sp.dropoutMask,gp=sp.recurrentDropoutMask;0<sp.dropout&&sp.dropout<1&&(np=tc(np,mp[0]));var yp=dot(np,sp.kernel.read());0<sp.recurrentDropout&&sp.recurrentDropout<1&&(up=tc(up,gp[0])),yp=Vs(yp,dot(up,sp.recurrentKernel.read())),sp.useBias&&(yp=biasAdd(yp,sp.bias.read()));var xp=Xn(yp,4,yp.rank-1),_p=xp[0],vp=xp[1],bp=xp[2],Ep=xp[3];dp=sp.recurrentActivation.apply(_p),hp=sp.recurrentActivation.apply(vp),fp=Vs(tc(hp,cp),tc(dp,sp.activation.apply(bp))),pp=sp.recurrentActivation.apply(Ep);var Sp=tc(pp,sp.activation.apply(fp));return[Sp,Sp,fp]})},_d.prototype.getConfig=function(){var np={units:this.units,activation:serializeActivation(this.activation),recurrentActivation:serializeActivation(this.recurrentActivation),useBias:this.useBias,kernelInitializer:serializeInitializer(this.kernelInitializer),recurrentInitializer:serializeInitializer(this.recurrentInitializer),biasInitializer:serializeInitializer(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:serializeRegularizer(this.recurrentRegularizer),biasRegularizer:serializeRegularizer(this.biasRegularizer),activityRegularizer:serializeRegularizer(this.activityRegularizer),kernelConstraint:serializeConstraint(this.kernelConstraint),recurrentConstraint:serializeConstraint(this.recurrentConstraint),biasConstraint:serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.className="LSTMCell",_d}(RNNCell);Mf.registerClass(LSTMCell);var LSTM=function(rp){function _d(np){return np.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),np.cell=new LSTMCell(np),rp.call(this,np)||this}return __extends$h(_d,rp),_d.prototype.call=function(np,ap){var sp=this;return je(function(){sp.cell.dropoutMask!=null&&(Xe(sp.cell.dropoutMask),sp.cell.dropoutMask=null),sp.cell.recurrentDropoutMask!=null&&(Xe(sp.cell.recurrentDropoutMask),sp.cell.recurrentDropoutMask=null);var lp=ap==null?null:ap.mask,up=ap==null?null:ap.training,cp=ap==null?null:ap.initialState;return rp.prototype.call.call(sp,np,{mask:lp,training:up,initialState:cp})})},Object.defineProperty(_d.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),_d.prototype.getConfig=function(){var np={units:this.units,activation:serializeActivation(this.activation),recurrentActivation:serializeActivation(this.recurrentActivation),useBias:this.useBias,kernelInitializer:serializeInitializer(this.kernelInitializer),recurrentInitializer:serializeInitializer(this.recurrentInitializer),biasInitializer:serializeInitializer(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:serializeRegularizer(this.recurrentRegularizer),biasRegularizer:serializeRegularizer(this.biasRegularizer),activityRegularizer:serializeRegularizer(this.activityRegularizer),kernelConstraint:serializeConstraint(this.kernelConstraint),recurrentConstraint:serializeConstraint(this.recurrentConstraint),biasConstraint:serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},ap=rp.prototype.getConfig.call(this);return delete ap.cell,Object.assign(np,ap),np},_d.fromConfig=function(np,ap){return ap.implmentation===0&&(ap.implementation=1),new np(ap)},_d.className="LSTM",_d}(RNN);Mf.registerClass(LSTM);var StackedRNNCells=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.cells=np.cells,ap}return __extends$h(_d,rp),Object.defineProperty(_d.prototype,"stateSize",{get:function(){for(var np=[],ap=0,sp=this.cells.slice().reverse();ap<sp.length;ap++){var lp=sp[ap];Array.isArray(lp.stateSize)?np.push.apply(np,lp.stateSize):np.push(lp.stateSize)}return np},enumerable:!0,configurable:!0}),_d.prototype.call=function(np,ap){var sp=this;return je(function(){for(var lp=(np=np).slice(1),up=[],cp=0,dp=sp.cells.slice().reverse();cp<dp.length;cp++){var hp=dp[cp];Array.isArray(hp.stateSize)?up.push(lp.splice(0,hp.stateSize.length)):up.push(lp.splice(0,1))}up.reverse();for(var fp,pp=[],mp=0;mp<sp.cells.length;++mp)hp=sp.cells[mp],lp=up[mp],fp=mp===0?[np[0]].concat(lp):[fp[0]].concat(lp),fp=hp.call(fp,ap),pp.push(fp.slice(1));lp=[];for(var gp=0,yp=pp.slice().reverse();gp<yp.length;gp++){var xp=yp[gp];lp.push.apply(lp,xp)}return[fp[0]].concat(lp)})},_d.prototype.build=function(np){var ap;isArrayOfShapes(np)&&(np=np[0]),np=np,this.cells.forEach(function(sp,lp){nameScope("RNNCell_"+lp,function(){sp.build(np),ap=Array.isArray(sp.stateSize)?sp.stateSize[0]:sp.stateSize,np=[np[0],ap]})}),this.built=!0},_d.prototype.getConfig=function(){for(var np=[],ap=0,sp=this.cells;ap<sp.length;ap++){var lp=sp[ap];np.push({className:lp.getClassName(),config:lp.getConfig()})}var up={cells:np},cp=rp.prototype.getConfig.call(this);return Object.assign(up,cp),up},_d.fromConfig=function(np,ap,sp){sp===void 0&&(sp={});for(var lp=[],up=0,cp=ap.cells;up<cp.length;up++){var dp=cp[up];lp.push(deserialize(dp,sp))}return new np({cells:lp})},Object.defineProperty(_d.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var np=[],ap=0,sp=this.cells;ap<sp.length;ap++){var lp=sp[ap];np.push.apply(np,lp.trainableWeights)}return np},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"nonTrainableWeights",{get:function(){for(var np=[],ap=0,sp=this.cells;ap<sp.length;ap++){var lp=sp[ap];np.push.apply(np,lp.nonTrainableWeights)}if(!this.trainable){for(var up=[],cp=0,dp=this.cells;cp<dp.length;cp++)lp=dp[cp],up.push.apply(up,lp.trainableWeights);return up.concat(np)}return np},enumerable:!0,configurable:!0}),_d.prototype.getWeights=function(){for(var np=[],ap=0,sp=this.cells;ap<sp.length;ap++){var lp=sp[ap];np.push.apply(np,lp.weights)}return batchGetValue(np)},_d.prototype.setWeights=function(np){for(var ap=[],sp=0,lp=this.cells;sp<lp.length;sp++)for(var up=lp[sp],cp=up.weights.length,dp=np.splice(cp),hp=0;hp<up.weights.length;++hp)ap.push([up.weights[hp],dp[hp]]);batchSetValue(ap)},_d.className="StackedRNNCells",_d}(RNNCell);function generateDropoutMask(rp,_d,np,ap){function sp(){return dropout$1(rp(),_d)}if(np===void 0&&(np=null),ap===void 0&&(ap=1),ap>1){for(var lp=[],up=0;up<ap;up++)lp.push(inTrainPhase(sp,rp,np));return lp.map(function(cp){return $e(cp.clone())})}return $e(inTrainPhase(sp,rp,np).clone())}Mf.registerClass(StackedRNNCells);var Wrapper=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.layer=np.layer,ap}return __extends$h(_d,rp),_d.prototype.build=function(np){this.built=!0},Object.defineProperty(_d.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(np){this.layer!=null&&(this.layer.trainable=np)},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),_d.prototype.getWeights=function(){return this.layer.getWeights()},_d.prototype.setWeights=function(np){this.layer.setWeights(np)},_d.prototype.getConfig=function(){var np={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.prototype.setFastWeightInitDuringBuild=function(np){rp.prototype.setFastWeightInitDuringBuild.call(this,np),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(np)},_d.fromConfig=function(np,ap,sp){sp===void 0&&(sp={});var lp=deserialize(ap.layer,sp);delete ap.layer;var up={layer:lp};return Object.assign(up,ap),new np(up)},_d}(Layer),TimeDistributed=function(rp){function _d(np){var ap=rp.call(this,np)||this;return ap.supportsMasking=!0,ap}return __extends$h(_d,rp),_d.prototype.build=function(np){if((np=getExactlyOneShape(np)).length<3)throw new ValueError("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(np));this.inputSpec=[{shape:np}];var ap=[np[0]].concat(np.slice(2));this.layer.built||(this.layer.build(ap),this.layer.built=!0),rp.prototype.build.call(this,np)},_d.prototype.computeOutputShape=function(np){var ap=[(np=getExactlyOneShape(np))[0]].concat(np.slice(2)),sp=this.layer.computeOutputShape(ap),lp=np[1];return[sp[0],lp].concat(sp.slice(1))},_d.prototype.call=function(np,ap){var sp=this;return je(function(){return rnn(function(lp,up){return[getExactlyOneTensor(sp.layer.call(lp,ap)),[]]},np=getExactlyOneTensor(np),[],!1,null,null,!1,!0)[1]})},_d.className="TimeDistributed",_d}(Wrapper);function checkBidirectionalMergeMode(rp){checkStringTypeUnionValue(VALID_BIDIRECTIONAL_MERGE_MODES,"BidirectionalMergeMode",rp)}Mf.registerClass(TimeDistributed);var DEFAULT_BIDIRECTIONAL_MERGE_MODE="concat",Bidirectional=function(rp){function _d(np){var ap=rp.call(this,np)||this,sp=np.layer.getConfig(),lp={};lp.className=np.layer.getClassName(),lp.config=sp,ap.forwardLayer=deserialize(lp),sp.goBackwards=sp.goBackwards!==!0;var up={};if(up.className=np.layer.getClassName(),up.config=sp,ap.backwardLayer=deserialize(up),ap.forwardLayer.name="forward_"+ap.forwardLayer.name,ap.backwardLayer.name="backward_"+ap.backwardLayer.name,ap.mergeMode=np.mergeMode===void 0?DEFAULT_BIDIRECTIONAL_MERGE_MODE:np.mergeMode,checkBidirectionalMergeMode(ap.mergeMode),np.weights)throw new NotImplementedError("weights support is not implemented for Bidirectional layer yet.");return ap._stateful=np.layer.stateful,ap.returnSequences=np.layer.returnSequences,ap.returnState=np.layer.returnState,ap.supportsMasking=!0,ap._trainable=!0,ap.inputSpec=np.layer.inputSpec,ap.numConstants=null,ap}return __extends$h(_d,rp),Object.defineProperty(_d.prototype,"trainable",{get:function(){return this._trainable},set:function(np){this._trainable=np,this.forwardLayer!=null&&(this.forwardLayer.trainable=np),this.backwardLayer!=null&&(this.backwardLayer.trainable=np)},enumerable:!0,configurable:!0}),_d.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},_d.prototype.setWeights=function(np){var ap=np.length,sp=Math.floor(ap/2);this.forwardLayer.setWeights(np.slice(0,sp)),this.backwardLayer.setWeights(np.slice(sp))},_d.prototype.computeOutputShape=function(np){var ap,sp,lp,up=this.forwardLayer.computeOutputShape(np);return Array.isArray(up)&&Array.isArray(up[0])||(up=[up]),up=up,this.returnState&&(lp=up.slice(1)),ap=up[0],ap=ap,this.mergeMode==="concat"?(ap[ap.length-1]*=2,sp=[ap]):sp=this.mergeMode==null?[ap,ap.slice()]:[ap],this.returnState?this.mergeMode==null?sp.concat(lp).concat(lp.slice()):[ap].concat(lp).concat(lp.slice()):singletonOrArray(sp)},_d.prototype.apply=function(np,ap){var sp=ap==null?null:ap.initialState,lp=ap==null?null:ap.constants;ap==null&&(ap={});var up=standardizeArgs(np,sp,lp,this.numConstants);if(np=up.inputs,sp=up.initialState,lp=up.constants,Array.isArray(np)&&(sp=np.slice(1),np=np[0]),(sp==null||sp.length===0)&&lp==null)return rp.prototype.apply.call(this,np,ap);var cp=[],dp=[];if(sp!=null){var hp=sp.length;if(hp%2>0)throw new ValueError("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");ap.initialState=sp,cp.push.apply(cp,sp);var fp=sp.map(function(bp){return new InputSpec({shape:bp.shape})});this.forwardLayer.stateSpec=fp.slice(0,hp/2),this.backwardLayer.stateSpec=fp.slice(hp/2),dp.push.apply(dp,fp)}if(lp!=null)throw new NotImplementedError("Support for constants in Bidirectional layers is not implemented yet.");for(var pp=cp[0]instanceof SymbolicTensor,mp=0,gp=cp;mp<gp.length;mp++)if(gp[mp]instanceof SymbolicTensor!==pp)throw new ValueError("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(pp){var yp=[np].concat(cp),xp=this.inputSpec.concat(dp),_p=this.inputSpec;this.inputSpec=xp;var vp=rp.prototype.apply.call(this,yp,ap);return this.inputSpec=_p,vp}return rp.prototype.apply.call(this,np,ap)},_d.prototype.call=function(np,ap){var sp=this;return je(function(){if(ap.mask!=null)throw new NotImplementedError("The support for masking is not implemented for Bidirectional layers yet.");var lp,up,cp,dp,hp=ap.initialState;if(hp==null)lp=sp.forwardLayer.call(np,ap),up=sp.backwardLayer.call(np,ap);else{var fp=hp.slice(0,hp.length/2),pp=hp.slice(hp.length/2);lp=sp.forwardLayer.call(np,Object.assign(ap,{initialState:fp})),up=sp.backwardLayer.call(np,Object.assign(ap,{initialState:pp}))}return sp.returnState&&(Array.isArray(lp)&&(cp=lp.slice(1).concat(up.slice(1))),lp=lp[0],up=up[0]),sp.returnSequences&&(up=zc(up,1)),sp.mergeMode==="concat"?dp=concatenate([lp,up]):sp.mergeMode==="sum"?dp=Vs(lp,up):sp.mergeMode==="ave"?dp=tc(.5,Vs(lp,up)):sp.mergeMode==="mul"?dp=tc(lp,up):sp.mergeMode==null&&(dp=[lp,up]),sp.returnState?sp.mergeMode==null?dp.concat(cp):[dp].concat(cp):dp})},_d.prototype.resetStates=function(np){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},_d.prototype.build=function(np){var ap=this;nameScope(this.forwardLayer.name,function(){ap.forwardLayer.build(np)}),nameScope(this.backwardLayer.name,function(){ap.backwardLayer.build(np)}),this.built=!0},Object.defineProperty(_d.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(_d.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),_d.prototype.setFastWeightInitDuringBuild=function(np){rp.prototype.setFastWeightInitDuringBuild.call(this,np),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(np),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(np)},_d.prototype.getConfig=function(){var np={mergeMode:this.mergeMode},ap=rp.prototype.getConfig.call(this);return Object.assign(np,ap),np},_d.fromConfig=function(np,ap){var sp=deserialize(ap.layer);if(delete ap.layer,ap.numConstants!=null)throw new NotImplementedError("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var lp=ap;return lp.layer=sp,new np(lp)},_d.className="Bidirectional",_d}(Wrapper);function inputLayer(rp){return new InputLayer(rp)}function elu$2(rp){return new ELU(rp)}function reLU(rp){return new ReLU(rp)}function leakyReLU(rp){return new LeakyReLU(rp)}function prelu$1(rp){return new PReLU(rp)}function softmax$1(rp){return new Softmax$1(rp)}function thresholdedReLU(rp){return new ThresholdedReLU(rp)}function conv1d$2(rp){return new Conv1D(rp)}function conv2d$1(rp){return new Conv2D(rp)}function conv2dTranspose$1(rp){return new Conv2DTranspose(rp)}function conv3d$2(rp){return new Conv3D(rp)}function separableConv2d$1(rp){return new SeparableConv2D(rp)}function cropping2D(rp){return new Cropping2D(rp)}function upSampling2d(rp){return new UpSampling2D(rp)}function depthwiseConv2d$2(rp){return new DepthwiseConv2D(rp)}function activation(rp){return new Activation$1(rp)}function dense(rp){return new Dense(rp)}function dropout$2(rp){return new Dropout(rp)}function flatten$1$1(rp){return new Flatten(rp)}function repeatVector(rp){return new RepeatVector(rp)}function reshape(rp){return new Reshape(rp)}function permute(rp){return new Permute(rp)}function embedding(rp){return new Embedding(rp)}function add$2(rp){return new Add(rp)}function average$1(rp){return new Average(rp)}function concatenate$2(rp){return new Concatenate(rp)}function maximum$2(rp){return new Maximum(rp)}function minimum$2(rp){return new Minimum(rp)}function multiply$1(rp){return new Multiply(rp)}function dot$1(rp){return new Dot(rp)}function batchNormalization$1(rp){return new BatchNormalization(rp)}function layerNormalization(rp){return new LayerNormalization(rp)}function zeroPadding2d(rp){return new ZeroPadding2D(rp)}function averagePooling1d(rp){return new AveragePooling1D(rp)}function avgPool1d(rp){return averagePooling1d(rp)}function avgPooling1d(rp){return averagePooling1d(rp)}function averagePooling2d(rp){return new AveragePooling2D(rp)}function avgPool2d(rp){return averagePooling2d(rp)}function avgPooling2d(rp){return averagePooling2d(rp)}function averagePooling3d(rp){return new AveragePooling3D(rp)}function avgPool3d$1(rp){return averagePooling3d(rp)}function avgPooling3d(rp){return averagePooling3d(rp)}function globalAveragePooling1d(rp){return new GlobalAveragePooling1D(rp)}function globalAveragePooling2d(rp){return new GlobalAveragePooling2D(rp)}function globalMaxPooling1d(rp){return new GlobalMaxPooling1D(rp)}function globalMaxPooling2d(rp){return new GlobalMaxPooling2D(rp)}function maxPooling1d(rp){return new MaxPooling1D(rp)}function maxPooling2d(rp){return new MaxPooling2D(rp)}function maxPooling3d(rp){return new MaxPooling3D(rp)}function gru(rp){return new GRU(rp)}function gruCell(rp){return new GRUCell(rp)}function lstm(rp){return new LSTM(rp)}function lstmCell(rp){return new LSTMCell(rp)}function simpleRNN(rp){return new SimpleRNN(rp)}function simpleRNNCell(rp){return new SimpleRNNCell(rp)}function rnn$1(rp){return new RNN(rp)}function stackedRNNCells(rp){return new StackedRNNCells(rp)}function bidirectional(rp){return new Bidirectional(rp)}function timeDistributed(rp){return new TimeDistributed(rp)}Mf.registerClass(Bidirectional);var globalMaxPool1d=globalMaxPooling1d,globalMaxPool2d=globalMaxPooling2d,maxPool1d=maxPooling1d,maxPool2d=maxPooling2d;function gaussianNoise(rp){return new GaussianNoise(rp)}function gaussianDropout(rp){return new GaussianDropout(rp)}function alphaDropout(rp){return new AlphaDropout(rp)}function masking(rp){return new Masking(rp)}var exports_layers=Object.freeze({inputLayer,elu:elu$2,reLU,leakyReLU,prelu:prelu$1,softmax:softmax$1,thresholdedReLU,conv1d:conv1d$2,conv2d:conv2d$1,conv2dTranspose:conv2dTranspose$1,conv3d:conv3d$2,separableConv2d:separableConv2d$1,cropping2D,upSampling2d,depthwiseConv2d:depthwiseConv2d$2,activation,dense,dropout:dropout$2,flatten:flatten$1$1,repeatVector,reshape,permute,embedding,add:add$2,average:average$1,concatenate:concatenate$2,maximum:maximum$2,minimum:minimum$2,multiply:multiply$1,dot:dot$1,batchNormalization:batchNormalization$1,layerNormalization,zeroPadding2d,averagePooling1d,avgPool1d,avgPooling1d,averagePooling2d,avgPool2d,avgPooling2d,averagePooling3d,avgPool3d:avgPool3d$1,avgPooling3d,globalAveragePooling1d,globalAveragePooling2d,globalMaxPooling1d,globalMaxPooling2d,maxPooling1d,maxPooling2d,maxPooling3d,gru,gruCell,lstm,lstmCell,simpleRNN,simpleRNNCell,rnn:rnn$1,stackedRNNCells,bidirectional,timeDistributed,globalMaxPool1d,globalMaxPool2d,maxPool1d,maxPool2d,Layer,RNN,RNNCell,input,gaussianNoise,gaussianDropout,alphaDropout,masking});function binaryAccuracy$1(rp,_d){return binaryAccuracy(rp,_d)}function binaryCrossentropy$2(rp,_d){return binaryCrossentropy$1(rp,_d)}function sparseCategoricalAccuracy$1(rp,_d){return sparseCategoricalAccuracy(rp,_d)}function categoricalAccuracy$1(rp,_d){return categoricalAccuracy(rp,_d)}function categoricalCrossentropy$2(rp,_d){return categoricalCrossentropy$1(rp,_d)}function precision$1(rp,_d){return precision(rp,_d)}function recall$1(rp,_d){return recall(rp,_d)}function cosineProximity$1(rp,_d){return cosineProximity(rp,_d)}function meanAbsoluteError$1(rp,_d){return meanAbsoluteError(rp,_d)}function meanAbsolutePercentageError$1(rp,_d){return meanAbsolutePercentageError(rp,_d)}function MAPE$2(rp,_d){return meanAbsolutePercentageError(rp,_d)}function mape$2(rp,_d){return meanAbsolutePercentageError(rp,_d)}function meanSquaredError$1(rp,_d){return meanSquaredError(rp,_d)}function MSE$2(rp,_d){return meanSquaredError(rp,_d)}function mse$2(rp,_d){return meanSquaredError(rp,_d)}var exports_metrics=Object.freeze({binaryAccuracy:binaryAccuracy$1,binaryCrossentropy:binaryCrossentropy$2,sparseCategoricalAccuracy:sparseCategoricalAccuracy$1,categoricalAccuracy:categoricalAccuracy$1,categoricalCrossentropy:categoricalCrossentropy$2,precision:precision$1,recall:recall$1,cosineProximity:cosineProximity$1,meanAbsoluteError:meanAbsoluteError$1,meanAbsolutePercentageError:meanAbsolutePercentageError$1,MAPE:MAPE$2,mape:mape$2,meanSquaredError:meanSquaredError$1,MSE:MSE$2,mse:mse$2}),exports_models=Object.freeze({modelFromJSON});function l1l2(rp){return new L1L2(rp)}function l1$1(rp){return l1(rp)}function l2$1(rp){return l2(rp)}var exports_regularizers=Object.freeze({l1l2,l1:l1$1,l2:l2$1}),Callback=function(rp){function _d(){var np=rp!==null&&rp.apply(this,arguments)||this;return np.model=null,np}return __extends$h(_d,rp),_d.prototype.setModel=function(np){if(!(np instanceof LayersModel))throw new Error("model must be a LayersModel, not some other Container");this.model=np},_d}(BaseCallback);function less(rp,_d){return rp<_d}function greater$1(rp,_d){return rp>_d}var EarlyStopping=function(rp){function _d(np){var ap=rp.call(this)||this;if(np==null&&(np={}),np.restoreBestWeights)throw new NotImplementedError("restoreBestWeights = True is not implemented in EarlyStopping yet.");return ap.monitor=np.monitor||"val_loss",ap.minDelta=Math.abs(np.minDelta||0),ap.patience=np.patience||0,ap.verbose=np.verbose||0,ap.mode=np.mode||"auto",ap.baseline=np.baseline,["auto","min","max"].indexOf(ap.mode)===-1&&(console.warn("EarlyStopping mode '"+ap.mode+"' is invalid. Falling back to mode 'auto'."),ap.mode="auto"),ap.mode==="min"?ap.monitorFunc=less:ap.mode==="max"||ap.monitor.indexOf("acc")!==-1?ap.monitorFunc=greater$1:ap.monitorFunc=less,ap.monitorFunc===less&&(ap.minDelta*=-1),ap}return __extends$h(_d,rp),_d.prototype.onTrainBegin=function(np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===less?1/0:-1/0,[2]})})},_d.prototype.onEpochEnd=function(np,ap){return __awaiter$8(this,void 0,void 0,function(){var sp;return __generator$8(this,function(lp){switch(lp.label){case 0:return[4,resolveScalarsInLogs(ap)];case 1:return lp.sent(),(sp=this.getMonitorValue(ap))==null?[2]:(this.monitorFunc(sp-this.minDelta,this.best)?(this.best=sp,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=np,this.model.stopTraining=!0)),[2])}})})},_d.prototype.onTrainEnd=function(np){return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(ap){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},_d.prototype.getMonitorValue=function(np){np==null&&(np={});var ap=np[this.monitor];return ap==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(np)),ap},_d}(Callback);function earlyStopping(rp){return new EarlyStopping(rp)}var callbacks={earlyStopping};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var DataType,SaverDef,__assign$1=function(){return(__assign$1=Object.assign||function(rp){for(var _d,np=1,ap=arguments.length;np<ap;np++)for(var sp in _d=arguments[np])Object.prototype.hasOwnProperty.call(_d,sp)&&(rp[sp]=_d[sp]);return rp}).apply(this,arguments)};function __awaiter$7(rp,_d,np,ap){return new(np||(np=Promise))(function(sp,lp){function up(hp){try{dp(ap.next(hp))}catch(fp){lp(fp)}}function cp(hp){try{dp(ap.throw(hp))}catch(fp){lp(fp)}}function dp(hp){hp.done?sp(hp.value):new np(function(fp){fp(hp.value)}).then(up,cp)}dp((ap=ap.apply(rp,_d||[])).next())})}function __generator$7(rp,_d){var np,ap,sp,lp,up={label:0,sent:function(){if(1&sp[0])throw sp[1];return sp[1]},trys:[],ops:[]};return lp={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(lp[Symbol.iterator]=function(){return this}),lp;function cp(dp){return function(hp){return function(fp){if(np)throw new TypeError("Generator is already executing.");for(;up;)try{if(np=1,ap&&(sp=2&fp[0]?ap.return:fp[0]?ap.throw||((sp=ap.return)&&sp.call(ap),0):ap.next)&&!(sp=sp.call(ap,fp[1])).done)return sp;switch(ap=0,sp&&(fp=[2&fp[0],sp.value]),fp[0]){case 0:case 1:sp=fp;break;case 4:return up.label++,{value:fp[1],done:!1};case 5:up.label++,ap=fp[1],fp=[0];continue;case 7:fp=up.ops.pop(),up.trys.pop();continue;default:if(!(sp=(sp=up.trys).length>0&&sp[sp.length-1])&&(fp[0]===6||fp[0]===2)){up=0;continue}if(fp[0]===3&&(!sp||fp[1]>sp[0]&&fp[1]<sp[3])){up.label=fp[1];break}if(fp[0]===6&&up.label<sp[1]){up.label=sp[1],sp=fp;break}if(sp&&up.label<sp[2]){up.label=sp[2],up.ops.push(fp);break}sp[2]&&up.ops.pop(),up.trys.pop();continue}fp=_d.call(rp,up)}catch(pp){fp=[6,pp],ap=0}finally{np=sp=0}if(5&fp[0])throw fp[1];return{value:fp[0]?fp[1]:void 0,done:!0}}([dp,hp])}}}(function(rp){rp[rp.DT_INVALID=0]="DT_INVALID",rp[rp.DT_FLOAT=1]="DT_FLOAT",rp[rp.DT_DOUBLE=2]="DT_DOUBLE",rp[rp.DT_INT32=3]="DT_INT32",rp[rp.DT_UINT8=4]="DT_UINT8",rp[rp.DT_INT16=5]="DT_INT16",rp[rp.DT_INT8=6]="DT_INT8",rp[rp.DT_STRING=7]="DT_STRING",rp[rp.DT_COMPLEX64=8]="DT_COMPLEX64",rp[rp.DT_INT64=9]="DT_INT64",rp[rp.DT_BOOL=10]="DT_BOOL",rp[rp.DT_QINT8=11]="DT_QINT8",rp[rp.DT_QUINT8=12]="DT_QUINT8",rp[rp.DT_QINT32=13]="DT_QINT32",rp[rp.DT_BFLOAT16=14]="DT_BFLOAT16",rp[rp.DT_FLOAT_REF=101]="DT_FLOAT_REF",rp[rp.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",rp[rp.DT_INT32_REF=103]="DT_INT32_REF",rp[rp.DT_UINT8_REF=104]="DT_UINT8_REF",rp[rp.DT_INT16_REF=105]="DT_INT16_REF",rp[rp.DT_INT8_REF=106]="DT_INT8_REF",rp[rp.DT_STRING_REF=107]="DT_STRING_REF",rp[rp.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",rp[rp.DT_INT64_REF=109]="DT_INT64_REF",rp[rp.DT_BOOL_REF=110]="DT_BOOL_REF",rp[rp.DT_QINT8_REF=111]="DT_QINT8_REF",rp[rp.DT_QUINT8_REF=112]="DT_QUINT8_REF",rp[rp.DT_QINT32_REF=113]="DT_QINT32_REF",rp[rp.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(DataType||(DataType={})),function(rp){(function(_d){_d[_d.LEGACY=0]="LEGACY",_d[_d.V1=1]="V1",_d[_d.V2=2]="V2"})(rp.CheckpointFormatVersion||(rp.CheckpointFormatVersion={}))}(SaverDef||(SaverDef={}));var CUSTOM_OPS={};function registerOp(rp,_d){var np={tfOpName:rp,category:"custom",inputs:[],attrs:[],customExecutor:_d};CUSTOM_OPS[rp]=np}function getRegisteredOp(rp){return CUSTOM_OPS[rp]}function deregisterOp(rp){delete CUSTOM_OPS[rp]}function getParamValue(rp,_d,np,ap){var sp=_d.inputParams[rp];if(sp&&sp.inputIndexStart!==void 0){var lp=sp.inputIndexStart,up=sp.inputIndexEnd===0?void 0:sp.inputIndexEnd===void 0?lp+1:sp.inputIndexEnd;if(sp.type==="tensor")return getTensor(_d.inputNames[sp.inputIndexStart],np,ap);if(sp.type==="tensors")return _d.inputNames.slice(lp,up).map(function(hp){return getTensor(hp,np,ap)});var cp=Array.prototype.slice.call(getTensor(_d.inputNames.slice(lp)[0],np,ap).dataSync());return sp.type==="number"?cp[0]:cp}var dp=_d.attrParams[rp];return dp&&dp.value}function getTensor(rp,_d,np){var ap=parseNodeName(rp),sp=ap[0],lp=ap[1],up=np.currentContextIds.find(function(cp){return!!_d[getNodeNameWithContextId(sp,cp)]});return up!==void 0?_d[getNodeNameWithContextId(sp,up)][lp]:void 0}function getTensorsForCurrentContenxt(rp,_d,np){return _d[getNodeNameWithContextId(rp,np.currentContextId)]}function getNodeNameAndIndex(rp,_d){var np=parseNodeName(rp),ap=np[0],sp=np[1];return[getNodeNameWithContextId(ap,_d&&_d.currentContextId),sp]}function getNodeNameWithContextId(rp,_d){return _d?rp+"-"+_d:rp}function parseNodeName(rp){var _d=rp.lastIndexOf(":");return _d===-1?[rp,0]:[rp.substring(0,_d),Number(rp.substring(_d+1))]}function split$1(rp,_d){for(var np=[],ap=0;ap<rp.length;ap+=_d)np.push(rp.slice(ap,ap+_d));return np}var json=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],arithmetic=Object.freeze({json}),json$1=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],basicMath=Object.freeze({json:json$1}),json$2=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],control=Object.freeze({json:json$2}),json$3=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],convolution=Object.freeze({json:json$3}),json$4=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],creation=Object.freeze({json:json$4}),json$5=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],dynamic=Object.freeze({json:json$5}),json$6=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],evaluation=Object.freeze({json:json$6}),json$7=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],graph$3=Object.freeze({json:json$7}),json$8=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],image$1=Object.freeze({json:json$8}),json$9=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],logical=Object.freeze({json:json$9}),json$10=[{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],matrices=Object.freeze({json:json$10}),json$11=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],normalization=Object.freeze({json:json$11}),json$12=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],reduction=Object.freeze({json:json$12}),json$13=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],sliceJoin=Object.freeze({json:json$13}),json$14=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],spectral=Object.freeze({json:json$14}),json$15=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],transformation=Object.freeze({json:json$15}),OperationMapper=function(){function rp(){var _d=[arithmetic,basicMath,control,convolution,creation,dynamic,evaluation,logical,image$1,graph$3,matrices,normalization,reduction,sliceJoin,spectral,transformation],np=[].concat.apply([],_d.map(function(ap){return ap.json}));this.opMappers=np.reduce(function(ap,sp){return ap[sp.tfOpName]=sp,ap},{})}return Object.defineProperty(rp,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),rp.prototype.transformGraph=function(_d){var np=this,ap=[],sp=[],lp=_d.node.reduce(function(hp,fp){return hp[fp.name]=np.mapNode(fp),fp.op==="Placeholder"&&ap.push(hp[fp.name]),fp.op==="Const"&&sp.push(hp[fp.name]),hp},{}),up=[],cp=[],dp=Object.keys(lp);return dp.forEach(function(hp){var fp=lp[hp];fp.inputNames.forEach(function(pp){var mp=getNodeNameAndIndex(pp)[0];fp.inputs.push(lp[mp]),lp[mp].children.push(fp)}),fp.inputs.length===0&&up.push(fp)}),dp.forEach(function(hp){var fp=lp[hp];fp.children.length===0&&cp.push(fp)}),{nodes:lp,inputs:up,outputs:cp,weights:sp,placeholders:ap}},rp.prototype.mapNode=function(_d){var np=getRegisteredOp(_d.op)||this.opMappers[_d.op]||{};_d.attr==null&&(_d.attr={});var ap={name:_d.name,op:_d.op,category:np.category,inputNames:(_d.input||[]).map(function(sp){return sp.startsWith("^")?sp.substr(1):sp}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:_d.attr};return np.inputs!=null&&(ap.inputParams=np.inputs.reduce(function(sp,lp){return sp[lp.name]={type:lp.type,inputIndexStart:lp.start,inputIndexEnd:lp.end},sp},{})),np.attrs!=null&&(ap.attrParams=np.attrs.reduce(function(sp,lp){var up=lp.type,cp=void 0;switch(lp.type){case"string":(cp=getStringParam(_d.attr,lp.tfName,lp.defaultValue))===void 0&&lp.tfDeprecatedName&&(cp=getStringParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"string[]":(cp=getStringArrayParam(_d.attr,lp.tfName,lp.defaultValue))===void 0&&lp.tfDeprecatedName&&(cp=getStringArrayParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"number":(cp=getNumberParam(_d.attr,lp.tfName,lp.defaultValue||0))===void 0&&lp.tfDeprecatedName&&(cp=getNumberParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"number[]":(cp=getNumericArrayParam(_d.attr,lp.tfName,lp.defaultValue))===void 0&&lp.tfDeprecatedName&&(cp=getNumericArrayParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"bool":(cp=getBoolParam(_d.attr,lp.tfName,lp.defaultValue))===void 0&&lp.tfDeprecatedName&&(cp=getBoolParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"bool[]":(cp=getBoolArrayParam(_d.attr,lp.tfName,lp.defaultValue))===void 0&&lp.tfDeprecatedName&&(cp=getBoolArrayParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"shape":(cp=getTensorShapeParam(_d.attr,lp.tfName,lp.defaultValue))===void 0&&lp.tfDeprecatedName&&(cp=getTensorShapeParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"shape[]":(cp=getTensorShapeArrayParam(_d.attr,lp.tfName,lp.defaultValue))===void 0&&lp.tfDeprecatedName&&(cp=getTensorShapeArrayParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"dtype":(cp=getDtypeParam(_d.attr,lp.tfName,lp.defaultValue))===void 0&&lp.tfDeprecatedName&&(cp=getDtypeParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"dtype[]":(cp=getDtypeArrayParam(_d.attr,lp.tfName,lp.defaultValue))===void 0&&lp.tfDeprecatedName&&(cp=getDtypeArrayParam(_d.attr,lp.tfDeprecatedName,lp.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+lp.type+" for op: "+_d.op)}return sp[lp.name]={value:cp,type:up},sp},{})),ap},rp}();function decodeBase64(rp){var _d=a$1().global;if(_d.atob!==void 0)return _d.atob(rp);if(typeof Buffer<"u")return new Buffer(rp,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function parseStringParam(rp,_d){var np=Array.isArray(rp)?String.fromCharCode.apply(null,rp):decodeBase64(rp);return _d?np:np.toLowerCase()}function getStringParam(rp,_d,np,ap){ap===void 0&&(ap=!1);var sp=rp[_d];return sp!=null?parseStringParam(sp.s,ap):np}function getBoolParam(rp,_d,np){var ap=rp[_d];return ap?ap.b:np}function getNumberParam(rp,_d,np){var ap=rp[_d]||{},sp=ap.i!=null?ap.i:ap.f!=null?ap.f:np;return typeof sp=="number"?sp:parseInt(sp,10)}function parseDtypeParam(rp){switch(typeof rp=="string"&&(rp=DataType[rp]),rp){case DataType.DT_FLOAT:return"float32";case DataType.DT_INT32:case DataType.DT_INT64:return"int32";case DataType.DT_BOOL:return"bool";case DataType.DT_DOUBLE:return"float32";case DataType.DT_STRING:return"string";default:return null}}function getDtypeParam(rp,_d,np){var ap=rp[_d];return ap&&ap.type?parseDtypeParam(ap.type):np}function getDtypeArrayParam(rp,_d,np){var ap=rp[_d];return ap&&ap.list&&ap.list.type?ap.list.type.map(function(sp){return parseDtypeParam(sp)}):np}function parseTensorShapeParam(rp){if(!rp.unknownRank)return rp.dim!=null?rp.dim.map(function(_d){return typeof _d.size=="number"?_d.size:parseInt(_d.size,10)}):[]}function getTensorShapeParam(rp,_d,np){var ap=rp[_d];return ap&&ap.shape?parseTensorShapeParam(ap.shape):np}function getNumericArrayParam(rp,_d,np){var ap=rp[_d];return ap?((ap.list.f&&ap.list.f.length?ap.list.f:ap.list.i)||[]).map(function(sp){return typeof sp=="number"?sp:parseInt(sp,10)}):np}function getStringArrayParam(rp,_d,np,ap){ap===void 0&&(ap=!1);var sp=rp[_d];return sp&&sp.list&&sp.list.s?sp.list.s.map(function(lp){return parseStringParam(lp,ap)}):np}function getTensorShapeArrayParam(rp,_d,np){var ap=rp[_d];return ap&&ap.list&&ap.list.shape?ap.list.shape.map(function(sp){return parseTensorShapeParam(sp)}):np}function getBoolArrayParam(rp,_d,np){var ap=rp[_d];return ap&&ap.list&&ap.list.b?ap.list.b:np}var NodeValueImpl=function(){function rp(_d,np,ap){var sp=this;this.node=_d,this.tensorMap=np,this.context=ap,this.inputs=[],this.attrs={},this.inputs=_d.inputNames.map(function(lp){return sp.getInput(lp)}),_d.rawAttrs!=null&&(this.attrs=Object.keys(_d.rawAttrs).reduce(function(lp,up){return lp[up]=sp.getAttr(up),lp},{}))}return rp.prototype.getInput=function(_d){return getTensor(_d,this.tensorMap,this.context)},rp.prototype.getAttr=function(_d,np){var ap=this.node.rawAttrs[_d];if(ap.tensor!=null)return getTensor(_d,this.tensorMap,this.context);if(ap.i!=null||ap.f!=null)return getNumberParam(this.node.rawAttrs,_d,np);if(ap.s!=null)return getStringParam(this.node.rawAttrs,_d,np);if(ap.b!=null)return getBoolParam(this.node.rawAttrs,_d,np);if(ap.shape!=null)return getTensorShapeParam(this.node.rawAttrs,_d,np);if(ap.type!=null)return getDtypeParam(this.node.rawAttrs,_d,np);if(ap.list!=null){if(ap.list.i!=null||ap.list.f!=null)return getNumericArrayParam(this.node.rawAttrs,_d,np);if(ap.list.s!=null)return getStringArrayParam(this.node.rawAttrs,_d,np);if(ap.list.shape!=null)return getTensorShapeArrayParam(this.node.rawAttrs,_d,np);if(ap.list.b!=null)return getBoolArrayParam(this.node.rawAttrs,_d,np);if(ap.list.type!=null)return getDtypeArrayParam(this.node.rawAttrs,_d,np)}return np},rp}(),executeOp=function(rp,_d,np){switch(rp.op){case"BiasAdd":case"AddV2":case"Add":return[Vs(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"AddN":return[zs(getParamValue("tensors",rp,_d,np))];case"FloorMod":case"Mod":return[Js(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"Mul":return[tc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"RealDiv":case"Div":return[qs(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"FloorDiv":return[js(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"Sub":return[ic(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"Minimum":return[Ys(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"Maximum":return[Xs(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"Pow":return[nc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"SquaredDifference":return[oc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$1=function(rp,_d,np){switch(rp.op){case"Abs":case"ComplexAbs":return[Vu(getParamValue("x",rp,_d,np))];case"Acos":return[zu(getParamValue("x",rp,_d,np))];case"Acosh":return[Gu(getParamValue("x",rp,_d,np))];case"Asin":return[Hu(getParamValue("x",rp,_d,np))];case"Asinh":return[qu(getParamValue("x",rp,_d,np))];case"Atan":return[Ku(getParamValue("x",rp,_d,np))];case"Atan2":return[Hs(getParamValue("x",rp,_d,np),getParamValue("y",rp,_d,np))];case"Atanh":return[ju(getParamValue("x",rp,_d,np))];case"Ceil":return[Xu(getParamValue("x",rp,_d,np))];case"Complex":return[En(getParamValue("real",rp,_d,np),getParamValue("imag",rp,_d,np))];case"Cos":return[Yu(getParamValue("x",rp,_d,np))];case"Cosh":return[Qu(getParamValue("x",rp,_d,np))];case"Elu":return[gl(getParamValue("x",rp,_d,np))];case"Erf":return[Ju(getParamValue("x",rp,_d,np))];case"Exp":return[Zu(getParamValue("x",rp,_d,np))];case"Expm1":return[ts(getParamValue("x",rp,_d,np))];case"Floor":return[es(getParamValue("x",rp,_d,np))];case"Log":return[ns(getParamValue("x",rp,_d,np))];case"Log1p":return[rs(getParamValue("x",rp,_d,np))];case"Imag":return[In(getParamValue("x",rp,_d,np))];case"Neg":return[as(getParamValue("x",rp,_d,np))];case"Reciprocal":return[is$1(getParamValue("x",rp,_d,np))];case"Real":return[Rn(getParamValue("x",rp,_d,np))];case"Relu":return[bl(getParamValue("x",rp,_d,np))];case"Round":return[us(getParamValue("x",rp,_d,np))];case"Selu":return[Cl(getParamValue("x",rp,_d,np))];case"Sigmoid":return[cs(getParamValue("x",rp,_d,np))];case"Sin":return[ds(getParamValue("x",rp,_d,np))];case"Sign":return[ls(getParamValue("x",rp,_d,np))];case"Sinh":return[vs(getParamValue("x",rp,_d,np))];case"Softplus":return[ms(getParamValue("x",rp,_d,np))];case"Sqrt":return[gs(getParamValue("x",rp,_d,np))];case"Square":return[Uu(getParamValue("x",rp,_d,np))];case"Tanh":return[bs(getParamValue("x",rp,_d,np))];case"Tan":return[xs(getParamValue("x",rp,_d,np))];case"Relu6":case"ClipByValue":return[$u(getParamValue("x",rp,_d,np),getParamValue("clipValueMin",rp,_d,np),getParamValue("clipValueMax",rp,_d,np))];case"Rsqrt":return[ss(getTensor(rp.inputNames[0],_d,np))];case"Prod":return[ml(getParamValue("x",rp,_d,np),getParamValue("axes",rp,_d,np))];case"LeakyRelu":return[yl(getParamValue("x",rp,_d,np),getParamValue("alpha",rp,_d,np))];default:throw TypeError("Node type "+rp.op+" is not implemented")}},TensorArray=function(){function rp(_d,np,ap,sp,lp,up,cp){this.name=_d,this.dtype=np,this.maxSize=ap,this.elementShape=sp,this.identicalElementShapes=lp,this.dynamicSize=up,this.clearAfterRead=cp,this.tensors=[],this.closed_=!1,this.id=rp.nextId++}return Object.defineProperty(rp.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),rp.prototype.clearAndClose=function(){this.tensors.forEach(function(_d){return _d.tensor.dispose()}),this.tensors=[],this.closed_=!0},rp.prototype.size=function(){return this.tensors.length},rp.prototype.read=function(_d){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(_d<0||_d>=this.tensors.length)throw new Error("Tried to read from index "+_d+", but array size is: "+this.tensors.length);var np=this.tensors[_d];if(np.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+_d+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(np.cleared=!0),np.read=!0,np.tensor},rp.prototype.readMany=function(_d){var np=this;return _d.map(function(ap){return np.read(ap)})},rp.prototype.write=function(_d,np){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(_d<0||!this.dynamicSize&&_d>=this.maxSize)throw new Error("Tried to write to index "+_d+", but array is not resizeable and size is: "+this.maxSize);var ap=this.tensors[_d]||{};if(np.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+_d+`,
          because the value dtype is `+np.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=np.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,np.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+_d+"."),ap&&ap.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+_d+", because it has already been read.");if(ap&&ap.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+_d+", because it has already been written.");ap.tensor=np,ap.written=!0,this.tensors[_d]=ap},rp.prototype.writeMany=function(_d,np){var ap=this;if(_d.length!==np.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+_d.length+" is not the same as tensors size: "+np.length+".");_d.forEach(function(sp,lp){return ap.write(sp,np[lp])})},rp.prototype.gather=function(_d,np){if(np&&np!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+np);if(!_d){_d=[];for(var ap=0;ap<this.size();ap++)_d.push(ap)}if(_d.length===0)return kn([],[0].concat(this.elementShape));var sp=this.readMany(_d);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,sp[0].shape,"TensorArray shape mismatch: "),Tr(sp,0)},rp.prototype.concat=function(_d){if(_d&&_d!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+_d);if(this.size()===0)return kn([],[0].concat(this.elementShape));for(var np=[],ap=0;ap<this.size();ap++)np.push(ap);var sp=this.readMany(np);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,sp[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+sp[0].shape+")"),Gn(sp,0)},rp.prototype.scatter=function(_d,np){if(np.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+np.dtype);if(_d.length!==np.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+_d.length+" vs. "+np.shape[0]);var ap=Math.max.apply(Math,_d);if(!this.dynamicSize&&ap>=this.maxSize)throw new Error("Max index must be < array size ("+ap+"  vs. "+this.maxSize+")");this.writeMany(_d,Or(np,0))},rp.prototype.split=function(_d,np){var ap=this;if(np.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+np.dtype);var sp=0,lp=_d.map(function(fp){return sp+=fp});if(sp!==np.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+sp+", and tensor's shape is: "+np.shape);if(!this.dynamicSize&&_d.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+_d.length+"), and the TensorArray is not marked as dynamically resizeable");var up=sp===0?0:np.size/sp,cp=[];je(function(){np=np.reshape([1,sp,up]);for(var fp=0;fp<_d.length;++fp){var pp=[0,fp===0?0:lp[fp-1],0],mp=[1,_d[fp],up];cp[fp]=tl(np,pp,mp).reshape(ap.elementShape)}return cp});for(var dp=[],hp=0;hp<_d.length;hp++)dp[hp]=hp;this.writeMany(dp,cp)},rp.prototype.assertShapesMatchAllowUndefinedSize=function(_d,np,ap){ap===void 0&&(ap=""),tt.assert(this.shapesEqualAllowUndefinedSize(_d,np),function(){return ap+" Shapes "+_d+" and "+np+" must match"})},rp.prototype.shapesEqualAllowUndefinedSize=function(_d,np){if(_d.length!==np.length)return!1;for(var ap=0;ap<_d.length;ap++)if(_d[ap]!==-1&&np[ap]!==-1&&_d[ap]!==np[ap])return!1;return!0},rp.nextId=0,rp}();function executeOp$2(rp,_d,np){return __awaiter$7(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p,vp,bp,Ep,Sp,Ap,Rp,Tp,Mp,Op,Pp,$p,zp,Dp,Fp,jp,Lp,Bp,Ip,kp,Up,Gp;return __generator$7(this,function(Wp){switch(Wp.label){case 0:switch(rp.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[getParamValue("pred",rp,_d,np).clone()]];case 2:return ap=getParamValue("pred",rp,_d,np),sp=getParamValue("data",rp,_d,np),[4,ap.data()];case 3:return[2,Wp.sent()[0]?[void 0,sp.clone()]:[sp.clone(),void 0]];case 4:return[2,(lp=rp.inputNames.find(function(Qp){return getTensor(Qp,_d,np)!==void 0}))?[getTensor(lp,_d,np).clone()]:void 0];case 5:return up=getParamValue("frameName",rp,_d,np),cp=getParamValue("tensor",rp,_d,np),np.enterFrame(up),[2,[cp.clone()]];case 6:return dp=getParamValue("tensor",rp,_d,np),np.exitFrame(),[2,[dp.clone()]];case 7:return hp=getParamValue("tensor",rp,_d,np),np.nextIteration(),[2,[hp.clone()]];case 8:return fp=getParamValue("size",rp,_d,np),pp=getParamValue("dtype",rp,_d,np),mp=getParamValue("elementShape",rp,_d,np),gp=getParamValue("dynamicSize",rp,_d,np),yp=getParamValue("clearAfterRead",rp,_d,np),xp=getParamValue("identicalElementShapes",rp,_d,np),_p=getParamValue("name",rp,_d,np),vp=new TensorArray(_p,pp,fp,mp,xp,gp,yp),np.addTensorArray(vp),[2,[An(vp.id),An(1)]];case 9:return bp=getParamValue("tensorArrayId",rp,_d,np),Ep=getParamValue("index",rp,_d,np),Sp=getParamValue("tensor",rp,_d,np),np.getTensorArray(bp).write(Ep,Sp),[2,[An(1)]];case 10:return Ap=getParamValue("tensorArrayId",rp,_d,np),Rp=getParamValue("index",rp,_d,np),[2,[np.getTensorArray(Ap).read(Rp)]];case 11:return Tp=getParamValue("tensorArrayId",rp,_d,np),Mp=getParamValue("indices",rp,_d,np),Op=getParamValue("dtype",rp,_d,np),[2,[np.getTensorArray(Tp).gather(Mp,Op)]];case 12:return Pp=getParamValue("tensorArrayId",rp,_d,np),$p=getParamValue("indices",rp,_d,np),zp=getParamValue("tensor",rp,_d,np),np.getTensorArray(Pp).scatter($p,zp),[2,[An(1)]];case 13:return Dp=getParamValue("tensorArrayId",rp,_d,np),Fp=np.getTensorArray(Dp),jp=getParamValue("dtype",rp,_d,np),[2,[Fp.concat(jp)]];case 14:return Lp=getParamValue("tensorArrayId",rp,_d,np),Bp=getParamValue("tensor",rp,_d,np),Ip=getParamValue("lengths",rp,_d,np),np.getTensorArray(Lp).split(Ip,Bp),[2,[An(1)]];case 15:return kp=getParamValue("tensorArrayId",rp,_d,np),Up=np.getTensorArray(kp),[2,[An(Up.size(),"int32")]];case 16:return Gp=getParamValue("tensorArrayId",rp,_d,np),np.getTensorArray(Gp).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+rp.op+" is not implemented")}})})}var executeOp$3=function(rp,_d,np){var ap,sp;switch(rp.op){case"Conv1D":var lp=getParamValue("stride",rp,_d,np),up=getParamValue("pad",rp,_d,np),cp=getParamValue("dataFormat",rp,_d,np).toUpperCase(),dp=getParamValue("dilation",rp,_d,np);return[Ac(getParamValue("x",rp,_d,np),getParamValue("filter",rp,_d,np),lp,up,cp,dp)];case"Conv2D":lp=getParamValue("strides",rp,_d,np),up=getParamValue("pad",rp,_d,np),cp=getParamValue("dataFormat",rp,_d,np).toUpperCase();var hp=getParamValue("dilations",rp,_d,np);return[Dc(getParamValue("x",rp,_d,np),getParamValue("filter",rp,_d,np),[lp[1],lp[2]],up,cp,[hp[1],hp[2]])];case"_FusedConv2D":var fp=(ap=getParamValue("fusedOps",rp,_d,np))[0],pp=ap[1],mp=fp==="biasadd",gp=pp==="prelu",yp=fp==="fusedbatchnorm",xp=getParamValue("numArgs",rp,_d,np);if(mp){if(gp&&xp!==2)throw new Error("Fused Conv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!gp&&xp!==1)throw new Error("Fused Conv2d with BiasAdd must have one extra argument: bias.")}if(yp)throw new Error("Fused Conv2d with FusedBatchNorm is not supported.");lp=getParamValue("strides",rp,_d,np),up=getParamValue("pad",rp,_d,np),cp=getParamValue("dataFormat",rp,_d,np).toUpperCase(),hp=getParamValue("dilations",rp,_d,np);var _p=(sp=getParamValue("args",rp,_d,np))[0],vp=sp[1];return[Eh.conv2d({x:getParamValue("x",rp,_d,np),filter:getParamValue("filter",rp,_d,np),strides:[lp[1],lp[2]],pad:up,dataFormat:cp,dilations:[hp[1],hp[2]],bias:_p,activation:pp,preluActivationWeights:vp})];case"Conv2DBackpropInput":case"Conv2dTranspose":var bp=getParamValue("outputShape",rp,_d,np);return lp=getParamValue("strides",rp,_d,np),up=getParamValue("pad",rp,_d,np),[Pc(getParamValue("x",rp,_d,np),getParamValue("filter",rp,_d,np),bp,[lp[1],lp[2]],up)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return lp=getParamValue("strides",rp,_d,np),up=getParamValue("pad",rp,_d,np),hp=getParamValue("dilations",rp,_d,np),cp=getParamValue("dataFormat",rp,_d,np).toUpperCase(),[Oc(getParamValue("input",rp,_d,np),getParamValue("filter",rp,_d,np),[lp[1],lp[2]],up,cp,[hp[1],hp[2]])];case"Conv3D":return lp=getParamValue("strides",rp,_d,np),up=getParamValue("pad",rp,_d,np),cp=getParamValue("dataFormat",rp,_d,np).toUpperCase(),hp=getParamValue("dilations",rp,_d,np),[Tc(getParamValue("x",rp,_d,np),getParamValue("filter",rp,_d,np),[lp[1],lp[2],lp[3]],up,cp,[hp[1],hp[2],hp[3]])];case"AvgPool":lp=getParamValue("strides",rp,_d,np),up=getParamValue("pad",rp,_d,np);var Ep=getParamValue("kernelSize",rp,_d,np);return[Yc(getParamValue("x",rp,_d,np),[Ep[1],Ep[2]],[lp[1],lp[2]],up)];case"MaxPool":return lp=getParamValue("strides",rp,_d,np),up=getParamValue("pad",rp,_d,np),Ep=getParamValue("kernelSize",rp,_d,np),[$c(getParamValue("x",rp,_d,np),[Ep[1],Ep[2]],[lp[1],lp[2]],up)];case"AvgPool3D":return lp=getParamValue("strides",rp,_d,np),up=getParamValue("pad",rp,_d,np),Ep=getParamValue("kernelSize",rp,_d,np),[Zc(getParamValue("x",rp,_d,np),[Ep[1],Ep[2],Ep[3]],[lp[1],lp[2],lp[3]],up)];case"MaxPool3D":return lp=getParamValue("strides",rp,_d,np),up=getParamValue("pad",rp,_d,np),Ep=getParamValue("kernelSize",rp,_d,np),[Jc(getParamValue("x",rp,_d,np),[Ep[1],Ep[2],Ep[3]],[lp[1],lp[2],lp[3]],up)];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$4=function(rp,_d,np){switch(rp.op){case"Fill":var ap=getParamValue("shape",rp,_d,np),sp=getParamValue("dtype",rp,_d,np),lp=getParamValue("value",rp,_d,np);return[Ln(ap,lp,sp)];case"LinSpace":var up=getParamValue("start",rp,_d,np),cp=getParamValue("stop",rp,_d,np),dp=getParamValue("num",rp,_d,np);return[Wn(up,cp,dp)];case"Multinomial":var hp=getParamValue("logits",rp,_d,np),fp=getParamValue("numSamples",rp,_d,np),pp=getParamValue("seed",rp,_d,np);return[mr(hp,fp,pp)];case"OneHot":var mp=getParamValue("indices",rp,_d,np),gp=getParamValue("depth",rp,_d,np),yp=getParamValue("onValue",rp,_d,np),xp=getParamValue("offValue",rp,_d,np);return[gr(mp,gp,yp,xp)];case"Ones":return[Bn(getParamValue("shape",rp,_d,np),getParamValue("dtype",rp,_d,np))];case"OnesLike":return[Vn(getParamValue("x",rp,_d,np))];case"RandomUniform":return[kr(getParamValue("shape",rp,_d,np),getParamValue("minval",rp,_d,np),getParamValue("maxval",rp,_d,np),getParamValue("dtype",rp,_d,np))];case"Range":up=getParamValue("start",rp,_d,np);var _p=getParamValue("stop",rp,_d,np),vp=getParamValue("step",rp,_d,np);return[Un(up,_p,vp,getParamValue("dtype",rp,_d,np))];case"TruncatedNormal":ap=getParamValue("shape",rp,_d,np);var bp=getParamValue("mean",rp,_d,np),Ep=getParamValue("stdDev",rp,_d,np);return pp=getParamValue("seed",rp,_d,np),[Fr(ap,bp,Ep,getParamValue("dtype",rp,_d,np),pp)];case"Zeros":return[Pn(getParamValue("shape",rp,_d,np),getParamValue("dtype",rp,_d,np))];case"ZerosLike":return[zn(getParamValue("x",rp,_d,np))];default:throw TypeError("Node type "+rp.op+" is not implemented")}};function executeOp$5(rp,_d,np){return __awaiter$7(this,void 0,void 0,function(){var ap,sp,lp,up,cp;return __generator$7(this,function(dp){switch(dp.label){case 0:switch(rp.op){case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,3];case"ListDiff":return[3,5]}return[3,6];case 1:return ap=getParamValue("boxes",rp,_d,np),sp=getParamValue("scores",rp,_d,np),lp=getParamValue("maxOutputSize",rp,_d,np),up=getParamValue("iouThreshold",rp,_d,np),cp=getParamValue("scoreThreshold",rp,_d,np),[4,vh.nonMaxSuppressionAsync(ap,sp,lp,up,cp)];case 2:return[2,[dp.sent()]];case 3:return[4,Us(getParamValue("condition",rp,_d,np).asType("bool"))];case 4:return[2,[dp.sent()]];case 5:return[2,_r(getParamValue("x",rp,_d,np),getParamValue("y",rp,_d,np))];case 6:throw TypeError("Node type "+rp.op+" is not implemented")}})})}var executeOp$6=function(rp,_d,np){switch(rp.op){case"TopKV2":var ap=getParamValue("x",rp,_d,np),sp=getParamValue("k",rp,_d,np),lp=getParamValue("sorted",rp,_d,np),up=Tl(ap,sp,lp);return[up.values,up.indices];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$7=function(rp,_d,np){switch(rp.op){case"Const":return _d[rp.name];case"PlaceholderWithDefault":var ap=getParamValue("default",rp,_d,np);return[getTensor(rp.name,_d,np)||ap];case"Placeholder":return[getTensor(rp.name,_d,np)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[getParamValue("x",rp,_d,np).clone()];case"IdentityN":return getParamValue("x",rp,_d,np).map(function(hp){return hp.clone()});case"Snapshot":return[getParamValue("x",rp,_d,np).clone()];case"Shape":return[Dn(getParamValue("x",rp,_d,np).shape,"int32")];case"ShapeN":return getParamValue("x",rp,_d,np).map(function(hp){return Dn(hp.shape)});case"Size":return[An(getParamValue("x",rp,_d,np).size,"int32")];case"Rank":return[An(getParamValue("x",rp,_d,np).rank,"int32")];case"NoOp":return[];case"Print":var sp=getParamValue("x",rp,_d,np),lp=getParamValue("data",rp,_d,np),up=getParamValue("message",rp,_d,np),cp=getParamValue("summarize",rp,_d,np);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(up);for(var dp=0;dp<lp.length;dp++)console.log(Array.prototype.slice.call(lp[dp].dataSync()).slice(0,cp));return[sp];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$8=function(rp,_d,np){switch(rp.op){case"ResizeBilinear":var ap=getParamValue("images",rp,_d,np),sp=getParamValue("size",rp,_d,np),lp=getParamValue("alignCorners",rp,_d,np);return[vh.resizeBilinear(ap,[sp[0],sp[1]],lp)];case"ResizeNearestNeighbor":return ap=getParamValue("images",rp,_d,np),sp=getParamValue("size",rp,_d,np),lp=getParamValue("alignCorners",rp,_d,np),[vh.resizeNearestNeighbor(ap,[sp[0],sp[1]],lp)];case"CropAndResize":var up=getParamValue("image",rp,_d,np),cp=getParamValue("boxes",rp,_d,np),dp=getParamValue("boxInd",rp,_d,np),hp=getParamValue("cropSize",rp,_d,np),fp=getParamValue("method",rp,_d,np),pp=getParamValue("extrapolationValue",rp,_d,np);return[vh.cropAndResize(up,cp,dp,hp,fp,pp)];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$9=function(rp,_d,np){switch(rp.op){case"Equal":return[sc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"NotEqual":return[yc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"Greater":return[lc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"GreaterEqual":return[hc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"Less":return[dc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"LessEqual":return[vc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"LogicalAnd":return[Ms(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"LogicalNot":return[Bs(getParamValue("a",rp,_d,np))];case"LogicalOr":return[Ps(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];case"Select":return[Ws(getParamValue("condition",rp,_d,np),getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np))];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$10=function(rp,_d,np){switch(rp.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[Wc(getParamValue("a",rp,_d,np),getParamValue("b",rp,_d,np),getParamValue("transposeA",rp,_d,np),getParamValue("transposeB",rp,_d,np))];case"Transpose":return[El(getParamValue("x",rp,_d,np),getParamValue("perm",rp,_d,np))];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$11=function(rp,_d,np){switch(rp.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Ns(getParamValue("x",rp,_d,np),getParamValue("mean",rp,_d,np),getParamValue("variance",rp,_d,np),getParamValue("offset",rp,_d,np),getParamValue("scale",rp,_d,np),getParamValue("epsilon",rp,_d,np))];case"LRN":return[Rl(getParamValue("x",rp,_d,np),getParamValue("radius",rp,_d,np),getParamValue("bias",rp,_d,np),getParamValue("alpha",rp,_d,np),getParamValue("beta",rp,_d,np))];case"Softmax":return[io(getParamValue("x",rp,_d,np))];case"LogSoftmax":return[uo(getParamValue("x",rp,_d,np))];case"SparseToDense":return[Pl(getParamValue("sparseIndices",rp,_d,np),getParamValue("outputShape",rp,_d,np),getParamValue("sparseValues",rp,_d,np),getParamValue("defaultValue",rp,_d,np))];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$12=function(rp,_d,np){switch(rp.op){case"Max":var ap=getParamValue("axis",rp,_d,np),sp=getParamValue("keepDims",rp,_d,np);return[hl(getParamValue("x",rp,_d,np),ap,sp)];case"Mean":return ap=getParamValue("axis",rp,_d,np),sp=getParamValue("keepDims",rp,_d,np),[fl(getParamValue("x",rp,_d,np),ap,sp)];case"Min":return ap=getParamValue("axis",rp,_d,np),sp=getParamValue("keepDims",rp,_d,np),[pl(getParamValue("x",rp,_d,np),ap,sp)];case"Sum":return ap=getParamValue("axis",rp,_d,np),sp=getParamValue("keepDims",rp,_d,np),[vl(getParamValue("x",rp,_d,np),ap,sp)];case"All":return ap=getParamValue("axis",rp,_d,np),sp=getParamValue("keepDims",rp,_d,np),[il(getParamValue("x",rp,_d,np),ap,sp)];case"Any":return ap=getParamValue("axis",rp,_d,np),sp=getParamValue("keepDims",rp,_d,np),[ul(getParamValue("x",rp,_d,np),ap,sp)];case"ArgMax":return ap=getParamValue("axis",rp,_d,np),[sl(getParamValue("x",rp,_d,np),ap)];case"ArgMin":return ap=getParamValue("axis",rp,_d,np),[cl(getParamValue("x",rp,_d,np),ap)];case"Prod":return ap=getParamValue("axis",rp,_d,np),sp=getParamValue("keepDims",rp,_d,np),[ml(getParamValue("x",rp,_d,np),ap,sp)];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$13=function(rp,_d,np){switch(rp.op){case"ConcatV2":case"Concat":var ap=getParamValue("axis",rp,_d,np),sp=getParamValue("tensors",rp,_d,np);return[Gn(sp,ap)];case"GatherV2":case"Gather":ap=getParamValue("axis",rp,_d,np);var lp=getParamValue("x",rp,_d,np),up=getParamValue("indices",rp,_d,np);return[Cc(lp,up.asType("int32"),ap)];case"ReverseV2":case"Reverse":return ap=getParamValue("axis",rp,_d,np),lp=getParamValue("x",rp,_d,np),[zc(lp,ap)];case"Slice":var cp=getParamValue("begin",rp,_d,np),dp=getParamValue("size",rp,_d,np);return[tl(getParamValue("x",rp,_d,np),cp,dp)];case"StridedSlice":cp=getParamValue("begin",rp,_d,np);var hp=getParamValue("end",rp,_d,np),fp=getParamValue("strides",rp,_d,np),pp=getParamValue("beginMask",rp,_d,np),mp=getParamValue("endMask",rp,_d,np),gp=getParamValue("ellipsisMask",rp,_d,np),yp=getParamValue("newAxisMask",rp,_d,np),xp=getParamValue("shrinkAxisMask",rp,_d,np),_p=getParamValue("x",rp,_d,np);if(cp.length===1&&_p.shape.length>1)for(var vp=1;vp<_p.shape.length;vp++)cp.push(0),hp.push(_p.shape[vp]),fp.push(fp[0]);return[Dl(_p,cp,hp,fp,pp,mp,gp,yp,xp)];case"Pack":return je(function(){var Op=getParamValue("axis",rp,_d,np),Pp=getParamValue("tensors",rp,_d,np),$p=Pp[0].shape,zp=Pp[0].squeeze().shape,Dp=Pp.map(function(Fp){var jp=tt.arraysEqual(Fp.shape,$p);if(!jp&&!tt.arraysEqual(Fp.squeeze().shape,zp))throw new Error("the input tensors shape does not match");return jp?Fp:Fp.reshape($p)});return[Tr(Dp,Op)]});case"Unpack":return je(function(){var Op=getParamValue("axis",rp,_d,np),Pp=getParamValue("tensor",rp,_d,np);return Or(Pp,Op)});case"Tile":var bp=getParamValue("reps",rp,_d,np);return[Nr(getParamValue("x",rp,_d,np),bp)];case"Split":case"SplitV":ap=getParamValue("axis",rp,_d,np);var Ep=getParamValue("numOrSizeSplits",rp,_d,np);return Xn(getParamValue("x",rp,_d,np),Ep,ap);case"ScatterNd":up=getParamValue("indices",rp,_d,np);var Sp=getParamValue("values",rp,_d,np),Ap=getParamValue("shape",rp,_d,np);return[Nl(up,Sp,Ap)];case"GatherNd":var Rp=getParamValue("x",rp,_d,np);return up=getParamValue("indices",rp,_d,np),[Ll(Rp,up)];case"SparseToDense":up=getParamValue("sparseIndices",rp,_d,np),Ap=getParamValue("outputShape",rp,_d,np);var Tp=getParamValue("sparseValues",rp,_d,np),Mp=getParamValue("defaultValue",rp,_d,np);return[Pl(up,Tp,Ap,Tp.dtype===Mp.dtype?Mp:Mp.asType(Tp.dtype))];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$14=function(rp,_d,np){switch(rp.op){case"FFT":return[Fl(getParamValue("x",rp,_d,np))];case"IFFT":return[Ol(getParamValue("x",rp,_d,np))];case"RFFT":return[_l(getParamValue("x",rp,_d,np))];case"IRFFT":return[Ml(getParamValue("x",rp,_d,np))];default:throw TypeError("Node type "+rp.op+" is not implemented")}},executeOp$15=function(rp,_d,np){switch(rp.op){case"Cast":return[lr(getParamValue("x",rp,_d,np),getParamValue("dtype",rp,_d,np))];case"ExpandDims":var ap=getParamValue("axis",rp,_d,np);return[dr(getParamValue("x",rp,_d,np),ap)];case"Squeeze":return ap=getParamValue("axis",rp,_d,np),[Dr(getParamValue("x",rp,_d,np),ap)];case"Reshape":return[Sr(getParamValue("x",rp,_d,np),getParamValue("shape",rp,_d,np))];case"PadV2":case"Pad":return[yr(getParamValue("x",rp,_d,np),split$1(getParamValue("padding",rp,_d,np),2),getParamValue("constantValue",rp,_d,np))];case"SpaceToBatchND":var sp=getParamValue("blockShape",rp,_d,np),lp=split$1(getParamValue("paddings",rp,_d,np),2);return[Ar(getParamValue("x",rp,_d,np),sp,lp)];case"BatchToSpaceND":sp=getParamValue("blockShape",rp,_d,np);var up=split$1(getParamValue("crops",rp,_d,np),2);return[cr(getParamValue("x",rp,_d,np),sp,up)];case"DepthToSpace":var cp=getParamValue("blockSize",rp,_d,np),dp=getParamValue("dataFormat",rp,_d,np).toUpperCase();return[pr(getParamValue("x",rp,_d,np),cp,dp)];default:throw TypeError("Node type "+rp.op+" is not implemented")}};function executeOp$16(rp,_d,np){var ap=function(sp,lp,up){switch(sp.category){case"arithmetic":return executeOp(sp,lp,up);case"basic_math":return executeOp$1(sp,lp,up);case"control":return executeOp$2(sp,lp,up);case"convolution":return executeOp$3(sp,lp,up);case"creation":return executeOp$4(sp,lp,up);case"dynamic":return executeOp$5(sp,lp,up);case"evaluation":return executeOp$6(sp,lp,up);case"image":return executeOp$8(sp,lp,up);case"graph":return executeOp$7(sp,lp,up);case"logical":return executeOp$9(sp,lp,up);case"matrices":return executeOp$10(sp,lp,up);case"normalization":return executeOp$11(sp,lp,up);case"reduction":return executeOp$12(sp,lp,up);case"slice_join":return executeOp$13(sp,lp,up);case"spectral":return executeOp$14(sp,lp,up);case"transformation":return executeOp$15(sp,lp,up);case"custom":var cp=getRegisteredOp(sp.op);if(cp&&cp.customExecutor)return cp.customExecutor(new NodeValueImpl(sp,lp,up));throw TypeError("Custom op "+sp.op+" is not registered.");default:throw TypeError("Unknown op '"+sp.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(rp,_d,np);return ap instanceof Promise?ap.then(function(sp){return[].concat(sp)}):[].concat(ap)}var ExecutionContext=function(){function rp(_d,np){this.weightMap=_d,this.tensorArrayMap=np,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return rp.prototype.newFrame=function(_d,np){return{id:_d,frameName:np,iterationId:0}},Object.defineProperty(rp.prototype,"currentContext",{get:function(){return this.contexts},set:function(_d){this.contexts!==_d&&(this.contexts=_d,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),rp.prototype.generateCurrentContextIds=function(){for(var _d=[],np=0;np<this.contexts.length-1;np++){var ap=this.contexts.slice(0,this.contexts.length-np);_d.push(this.contextIdforContexts(ap))}_d.push(""),this._currentContextIds=_d},rp.prototype.contextIdforContexts=function(_d){return _d?_d.map(function(np){return np.id===0&&np.iterationId===0?"":np.frameName+"-"+np.iterationId}).join("/"):""},rp.prototype.enterFrame=function(_d){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,_d)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},rp.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},rp.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var _d=Object.assign({},this.contexts[this.contexts.length-1]);_d.iterationId+=1,_d.id=this.lastId,this.contexts.splice(-1,1,_d),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},rp.prototype.getWeight=function(_d){return this.weightMap[_d]},rp.prototype.addTensorArray=function(_d){this.tensorArrayMap[_d.id]=_d},rp.prototype.getTensorArray=function(_d){return this.tensorArrayMap[_d]},rp}();function getExecutionSubgraph(rp,_d,np){for(var ap=new Set,sp=[],lp=null,up=null,cp=new Set,dp=_d.slice();dp.length>0;){var hp=dp.pop();(isControlFlow(hp)||isDynamicShape(hp))&&lp==null&&(up=(lp=hp).children.map(function(fp){return fp.name}).filter(function(fp){return ap.has(fp)})),ap.add(hp.name),np[hp.name]==null&&rp[hp.name]==null&&(hp.inputs.length!==0?hp.inputs.forEach(function(fp){cp.has(fp.name)||(cp.add(fp.name),dp.push(fp))}):sp.push(hp.name))}return{inputs:rp,outputs:_d,usedNodes:ap,missingInputs:sp,dynamicNode:lp,syncInputs:up}}function getNodesInTopologicalOrder(rp,_d,np){var ap=np.usedNodes,sp=np.inputs,lp=[];Object.keys(sp).map(function(hp){return rp.nodes[hp]}).forEach(function(hp){ap.has(hp.name)&&lp.push(hp)}),rp.weights.forEach(function(hp){ap.has(hp.name)&&lp.push(hp)});for(var up=new Set,cp=[];lp.length>0;){var dp=lp.pop();up.add(dp.name),_d[dp.name]||cp.push(dp),dp.children.forEach(function(hp){!up.has(hp.name)&&ap.has(hp.name)&&hp.inputs.every(function(fp){return up.has(fp.name)})&&lp.push(hp)})}return cp}var CONTROL_FLOW_OPS=["Switch","Merge","Enter","Exit","NextIteration"],DYNAMIC_SHAPE_OPS=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"];function isControlFlow(rp){return CONTROL_FLOW_OPS.indexOf(rp.op)>=0}function isDynamicShape(rp){return DYNAMIC_SHAPE_OPS.indexOf(rp.op)>=0}var GraphExecutor=function(){function rp(_d){this.graph=_d,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=_d.placeholders,this._outputs=_d.outputs}return Object.defineProperty(rp.prototype,"weightMap",{get:function(){return this._weightMap},set:function(_d){var np=Object.keys(_d).map(function(ap){return _d[ap].map(function(sp){return sp.id})});this.weightIds=[].concat.apply([],np),this._weightMap=_d},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"inputs",{get:function(){return this.placeholders.map(function(_d){return{name:_d.name,shape:_d.attrParams.shape?_d.attrParams.shape.value:void 0,dtype:_d.attrParams.dtype?_d.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"outputs",{get:function(){return this._outputs.map(function(_d){return{name:_d.name,shape:_d.attrParams.shape?_d.attrParams.shape.value:void 0,dtype:_d.attrParams.dtype?_d.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"inputNodes",{get:function(){return this.placeholders.map(function(_d){return _d.name})},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"outputNodes",{get:function(){return this.outputs.map(function(_d){return _d.name})},enumerable:!0,configurable:!0}),rp.prototype.getCompilationKey=function(_d,np){var ap=_d.map(function(lp){return lp.name}).sort(),sp=np.map(function(lp){return lp.name}).sort();return ap.join(this.SEPERATOR)+"--"+sp.join(this.SEPERATOR)},rp.prototype.compile=function(_d,np){var ap=getExecutionSubgraph(_d,np,this.weightMap),sp=ap.missingInputs,lp=ap.dynamicNode,up=ap.syncInputs;if(lp!=null)throw new Error("This execution contains the node '"+lp.name+"', which has the dynamic op '"+lp.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+up+"]");if(sp.length>0){var cp=np.map(function(hp){return hp.name}),dp=Object.keys(_d);throw new Error("Cannot compute the outputs ["+cp+"] from the provided inputs ["+dp+"]. Missing the following inputs: ["+sp+"]")}return getNodesInTopologicalOrder(this.graph,this.weightMap,ap)},rp.prototype.execute=function(_d,np){var ap=this,sp=Object.keys(_d).sort();this.checkInputs(_d),this.checkInputShapeAndType(_d),this.checkOutputs(np);var lp=sp.map(function(fp){return ap.graph.nodes[fp]}),up=np.map(function(fp){return ap.graph.nodes[parseNodeName(fp)[0]]}),cp=this.getCompilationKey(lp,up),dp=this.compiledMap.get(cp);dp==null&&(dp=this.compile(_d,up),this.compiledMap.set(cp,dp));var hp={};return je(function(){var fp=new ExecutionContext(ap._weightMap,hp),pp=__assign$1({},ap.weightMap);Object.keys(_d).forEach(function(vp){pp[vp]=[_d[vp]]});for(var mp=ap.getFrozenTensorIds(pp),gp={},yp=0;yp<dp.length;yp++){var xp=dp[yp];if(!pp[xp.name]){var _p=executeOp$16(xp,pp,fp);if(_p instanceof Promise)throw new Error("The execution of the op '"+xp.op+"' returned a promise. Please use model.executeAsync() instead.");pp[xp.name]=_p,ap.checkTensorForDisposal(xp.name,xp,pp,fp,mp,np,gp)}}return np.map(function(vp){return getTensor(vp,pp,fp)})})},rp.prototype.getFrozenTensorIds=function(_d){var np=[].concat.apply([],Object.keys(_d).map(function(ap){return _d[ap]}).map(function(ap){return ap.map(function(sp){return sp.id})}));return new Set(np)},rp.prototype.checkTensorForDisposal=function(_d,np,ap,sp,lp,up,cp){np.category!=="control"&&up.indexOf(_d)===-1&&(ap[_d].forEach(function(dp){dp!=null&&(cp[dp.id]=(cp[dp.id]||0)+np.children.length)}),np.inputs.forEach(function(dp){if(dp.category!=="control"){var hp=getTensorsForCurrentContenxt(dp.name,ap,sp);hp!=null&&hp.forEach(function(fp){if(fp&&!lp.has(fp.id)){var pp=cp[fp.id];pp===1?(fp.dispose(),delete cp[fp.id]):pp!=null&&cp[fp.id]--}})}}))},rp.prototype.executeAsync=function(_d,np){return __awaiter$7(this,void 0,void 0,function(){var ap,sp,lp,up,cp,dp,hp=this;return __generator$7(this,function(fp){switch(fp.label){case 0:return this.checkInputs(_d),this.checkInputShapeAndType(_d),this.checkOutputs(np),ap={},sp=new ExecutionContext(this._weightMap,ap),[4,this.executeWithControlFlow(_d,sp,np)];case 1:return lp=fp.sent(),up=np.map(function(pp){return getTensor(pp,lp,sp)}),cp=new Set(up.map(function(pp){return pp.id})),dp=new Set(Object.keys(_d).map(function(pp){return _d[pp].id})),Object.keys(lp).forEach(function(pp){lp[pp].forEach(function(mp){!mp||mp.isDisposed||cp.has(mp.id)||dp.has(mp.id)||hp.weightIds.indexOf(mp.id)!==-1||mp.dispose()})}),[2,up]}})})},rp.prototype.executeWithControlFlow=function(_d,np,ap){return __awaiter$7(this,void 0,void 0,function(){var sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p,vp,bp,Ep,Sp=this;return __generator$7(this,function(Ap){switch(Ap.label){case 0:sp=Object.keys(_d),lp=sp.map(function(Rp){return Sp.graph.nodes[Rp]}),up=ap.map(function(Rp){return Sp.graph.nodes[parseNodeName(Rp)[0]]}),cp=getExecutionSubgraph(_d,up,this.weightMap),dp=cp.usedNodes,hp=cp.missingInputs,fp=cp.dynamicNode,pp=cp.syncInputs,mp=lp.concat(this.graph.weights).map(function(Rp){return{node:Rp,contexts:np.currentContext}}),gp=__assign$1({},this.weightMap),Object.keys(_d).forEach(function(Rp){gp[Rp]=[_d[Rp]]}),yp={},xp=this.getFrozenTensorIds(gp),_p={},Ap.label=1;case 1:return mp.length>0?(vp=this.processStack(lp,mp,np,gp,_p,xp,ap,yp,dp),[4,Promise.all(vp)]):[3,3];case 2:return Ap.sent(),[3,1];case 3:if(fp==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(bp=up.filter(function(Rp){return!isControlFlow(Rp)&&!getTensor(Rp.name,gp,np)}).map(function(Rp){return Rp.name})).length>0)throw Ep="",fp!=null&&(Ep="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+pp+"]"),new Error("Cannot compute the outputs ["+bp+"] from the provided inputs ["+sp+"]. Consider providing the following inputs: ["+hp+"]. "+Ep);return[2,gp]}})})},rp.prototype.processStack=function(_d,np,ap,sp,lp,up,cp,dp,hp){for(var fp=this,pp=[],mp=function(){var yp=np.pop();ap.currentContext=yp.contexts;var xp="";if(yp.node.op==="Enter"&&getParamValue("isConstant",yp.node,sp,ap)&&(xp=getNodeNameAndIndex(yp.node.name,ap)[0]),_d.indexOf(yp.node)===-1){var _p=executeOp$16(yp.node,sp,ap);xp||(xp=getNodeNameAndIndex(yp.node.name,ap)[0]);var vp=ap.currentContext;_p instanceof Promise?pp.push(_p.then(function(bp){return sp[xp]=bp,ap.currentContext=vp,fp.checkTensorForDisposal(xp,yp.node,sp,ap,up,cp,dp),fp.processChildNodes(yp.node,np,ap,sp,lp,hp),bp})):(sp[xp]=_p,gp.checkTensorForDisposal(xp,yp.node,sp,ap,up,cp,dp),gp.processChildNodes(yp.node,np,ap,sp,lp,hp))}else gp.processChildNodes(yp.node,np,ap,sp,lp,hp)},gp=this;np.length>0;)mp();return pp},rp.prototype.processChildNodes=function(_d,np,ap,sp,lp,up){_d.children.forEach(function(cp){var dp=getNodeNameAndIndex(cp.name,ap)[0];!lp[dp]&&up.has(cp.name)&&(cp.op==="Merge"?cp.inputNames.some(function(hp){return!!getTensor(hp,sp,ap)})&&(lp[dp]=!0,np.push({contexts:ap.currentContext,node:cp})):cp.inputNames.every(function(hp){return!!getTensor(hp,sp,ap)})&&(lp[dp]=!0,np.push({contexts:ap.currentContext,node:cp})))})},rp.prototype.dispose=function(){var _d=this;Object.keys(this.weightMap).forEach(function(np){return _d.weightMap[np].forEach(function(ap){return ap.dispose()})})},rp.prototype.checkInputShapeAndType=function(_d){var np=this;Object.keys(_d).forEach(function(ap){var sp=_d[ap],lp=np.graph.nodes[ap];if(lp.attrParams.shape&&lp.attrParams.shape.value){var up=lp.attrParams.shape.value,cp=up.length===sp.shape.length&&sp.shape.every(function(dp,hp){return up[hp]===-1||up[hp]===dp});tt.assert(cp,function(){return"The shape of dict['"+lp.name+"'] provided in model.execute(dict) must be ["+up+"], but was ["+sp.shape+"]"})}lp.attrParams.dtype&&lp.attrParams.dtype.value&&tt.assert(sp.dtype===lp.attrParams.dtype.value,function(){return"The dtype of dict['"+lp.name+"'] provided in model.execute(dict) must be "+lp.attrParams.dtype.value+", but was "+sp.dtype})})},rp.prototype.checkInputs=function(_d){var np=this,ap=Object.keys(_d).filter(function(sp){return!np.graph.nodes[sp]});if(ap.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+ap+"] that are not part of graph")},rp.prototype.checkOutputs=function(_d){var np=this;_d.forEach(function(ap){var sp=parseNodeName(ap)[0];if(!np.graph.nodes[sp])throw new Error("The output '"+ap+"' is not found in the graph")})},rp}(),TFHUB_SEARCH_PARAM="?tfjs-format=file",DEFAULT_MODEL_NAME="model.json",GraphModel=function(){function rp(_d,np){np===void 0&&(np={}),this.modelUrl=_d,this.loadOptions=np,this.version="n/a",np==null&&(this.loadOptions={})}return Object.defineProperty(rp.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(rp.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),rp.prototype.findIOHandler=function(){var _d=this.modelUrl;if(_d.load!=null)this.handler=_d;else if(this.loadOptions.requestInit!=null)this.handler=Sf.browserHTTPRequest(_d,this.loadOptions);else{var np=Sf.getLoadHandlers(_d,this.loadOptions.onProgress);if(np.length===0)np.push(Sf.browserHTTPRequest(_d,this.loadOptions));else if(np.length>1)throw new Error("Found more than one ("+np.length+") load handlers for URL '"+[_d]+"'");this.handler=np[0]}},rp.prototype.load=function(){return __awaiter$7(this,void 0,void 0,function(){var _d,np,ap;return __generator$7(this,function(sp){switch(sp.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return _d=sp.sent(),np=_d.modelTopology,this.version=np.versions.producer+"."+np.versions.minConsumer,ap=Sf.decodeWeights(_d.weightData,_d.weightSpecs),this.executor=new GraphExecutor(OperationMapper.Instance.transformGraph(np)),this.executor.weightMap=this.convertTensorMapToTensorsMap(ap),[2,!0]}})})},rp.prototype.predict=function(_d,np){return this.execute(_d,this.outputNodes)},rp.prototype.normalizeInputs=function(_d){if(!(_d instanceof dt||Array.isArray(_d)))return _d;if((_d=Array.isArray(_d)?_d:[_d]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+_d.length+" input tensors.");return this.inputNodes.reduce(function(np,ap,sp){return np[ap]=_d[sp],np},{})},rp.prototype.normalizeOutputs=function(_d){return _d=_d||this.outputNodes,Array.isArray(_d)?_d:[_d]},rp.prototype.execute=function(_d,np){_d=this.normalizeInputs(_d),np=this.normalizeOutputs(np);var ap=this.executor.execute(_d,np);return ap.length>1?ap:ap[0]},rp.prototype.executeAsync=function(_d,np){return __awaiter$7(this,void 0,void 0,function(){var ap;return __generator$7(this,function(sp){switch(sp.label){case 0:return _d=this.normalizeInputs(_d),np=this.normalizeOutputs(np),[4,this.executor.executeAsync(_d,np)];case 1:return[2,(ap=sp.sent()).length>1?ap:ap[0]]}})})},rp.prototype.convertTensorMapToTensorsMap=function(_d){return Object.keys(_d).reduce(function(np,ap){return np[ap]=[_d[ap]],np},{})},rp.prototype.dispose=function(){this.executor.dispose()},rp}();function loadGraphModel(rp,_d){return _d===void 0&&(_d={}),__awaiter$7(this,void 0,void 0,function(){var np;return __generator$7(this,function(ap){switch(ap.label){case 0:if(rp==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return _d==null&&(_d={}),_d.fromTFHub&&rp.load==null&&(rp.endsWith("/")||(rp+="/"),rp=""+rp+DEFAULT_MODEL_NAME+TFHUB_SEARCH_PARAM),[4,(np=new GraphModel(rp,_d)).load()];case 1:return ap.sent(),[2,np]}})})}var version$8="1.3.1";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var extendStatics=function(rp,_d){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(np,ap){np.__proto__=ap}||function(np,ap){for(var sp in ap)ap.hasOwnProperty(sp)&&(np[sp]=ap[sp])})(rp,_d)};function __extends$g(rp,_d){function np(){this.constructor=rp}extendStatics(rp,_d),rp.prototype=_d===null?Object.create(_d):(np.prototype=_d.prototype,new np)}function __awaiter$6(rp,_d,np,ap){return new(np||(np=Promise))(function(sp,lp){function up(hp){try{dp(ap.next(hp))}catch(fp){lp(fp)}}function cp(hp){try{dp(ap.throw(hp))}catch(fp){lp(fp)}}function dp(hp){hp.done?sp(hp.value):new np(function(fp){fp(hp.value)}).then(up,cp)}dp((ap=ap.apply(rp,_d||[])).next())})}function __generator$6(rp,_d){var np,ap,sp,lp,up={label:0,sent:function(){if(1&sp[0])throw sp[1];return sp[1]},trys:[],ops:[]};return lp={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(lp[Symbol.iterator]=function(){return this}),lp;function cp(dp){return function(hp){return function(fp){if(np)throw new TypeError("Generator is already executing.");for(;up;)try{if(np=1,ap&&(sp=2&fp[0]?ap.return:fp[0]?ap.throw||((sp=ap.return)&&sp.call(ap),0):ap.next)&&!(sp=sp.call(ap,fp[1])).done)return sp;switch(ap=0,sp&&(fp=[2&fp[0],sp.value]),fp[0]){case 0:case 1:sp=fp;break;case 4:return up.label++,{value:fp[1],done:!1};case 5:up.label++,ap=fp[1],fp=[0];continue;case 7:fp=up.ops.pop(),up.trys.pop();continue;default:if(!(sp=(sp=up.trys).length>0&&sp[sp.length-1])&&(fp[0]===6||fp[0]===2)){up=0;continue}if(fp[0]===3&&(!sp||fp[1]>sp[0]&&fp[1]<sp[3])){up.label=fp[1];break}if(fp[0]===6&&up.label<sp[1]){up.label=sp[1],sp=fp;break}if(sp&&up.label<sp[2]){up.label=sp[2],up.ops.push(fp);break}sp[2]&&up.ops.pop(),up.trys.pop();continue}fp=_d.call(rp,up)}catch(pp){fp=[6,pp],ap=0}finally{np=sp=0}if(5&fp[0])throw fp[1];return{value:fp[0]?fp[1]:void 0,done:!0}}([dp,hp])}}}function createCommonjsModule$1(rp,_d){return rp(_d={exports:{}},_d.exports),_d.exports}var alea$2=createCommonjsModule$1(function(rp){(function(_d,np,ap){function sp(up,cp){return cp.c=up.c,cp.s0=up.s0,cp.s1=up.s1,cp.s2=up.s2,cp}function lp(up,cp){var dp=new function(pp){var mp,gp=this,yp=(mp=4022871197,function(xp){xp=xp.toString();for(var _p=0;_p<xp.length;_p++){var vp=.02519603282416938*(mp+=xp.charCodeAt(_p));vp-=mp=vp>>>0,mp=(vp*=mp)>>>0,mp+=4294967296*(vp-=mp)}return 23283064365386963e-26*(mp>>>0)});gp.next=function(){var xp=2091639*gp.s0+23283064365386963e-26*gp.c;return gp.s0=gp.s1,gp.s1=gp.s2,gp.s2=xp-(gp.c=0|xp)},gp.c=1,gp.s0=yp(" "),gp.s1=yp(" "),gp.s2=yp(" "),gp.s0-=yp(pp),gp.s0<0&&(gp.s0+=1),gp.s1-=yp(pp),gp.s1<0&&(gp.s1+=1),gp.s2-=yp(pp),gp.s2<0&&(gp.s2+=1),yp=null}(up),hp=cp&&cp.state,fp=dp.next;return fp.int32=function(){return 4294967296*dp.next()|0},fp.double=function(){return fp()+11102230246251565e-32*(2097152*fp()|0)},fp.quick=fp,hp&&(typeof hp=="object"&&sp(hp,dp),fp.state=function(){return sp(dp,{})}),fp}np&&np.exports?np.exports=lp:ap&&ap.amd?ap(function(){return lp}):this.alea=lp})(0,rp,!1)}),xor128$2=createCommonjsModule$1(function(rp){(function(_d,np,ap){function sp(up,cp){return cp.x=up.x,cp.y=up.y,cp.z=up.z,cp.w=up.w,cp}function lp(up,cp){var dp=new function(pp){var mp=this,gp="";mp.x=0,mp.y=0,mp.z=0,mp.w=0,mp.next=function(){var xp=mp.x^mp.x<<11;return mp.x=mp.y,mp.y=mp.z,mp.z=mp.w,mp.w^=mp.w>>>19^xp^xp>>>8},pp===(0|pp)?mp.x=pp:gp+=pp;for(var yp=0;yp<gp.length+64;yp++)mp.x^=0|gp.charCodeAt(yp),mp.next()}(up),hp=cp&&cp.state,fp=function(){return(dp.next()>>>0)/4294967296};return fp.double=function(){do var pp=((dp.next()>>>11)+(dp.next()>>>0)/4294967296)/2097152;while(pp===0);return pp},fp.int32=dp.next,fp.quick=fp,hp&&(typeof hp=="object"&&sp(hp,dp),fp.state=function(){return sp(dp,{})}),fp}np&&np.exports?np.exports=lp:ap&&ap.amd?ap(function(){return lp}):this.xor128=lp})(0,rp,!1)}),xorwow$2=createCommonjsModule$1(function(rp){(function(_d,np,ap){function sp(up,cp){return cp.x=up.x,cp.y=up.y,cp.z=up.z,cp.w=up.w,cp.v=up.v,cp.d=up.d,cp}function lp(up,cp){var dp=new function(pp){var mp=this,gp="";mp.next=function(){var xp=mp.x^mp.x>>>2;return mp.x=mp.y,mp.y=mp.z,mp.z=mp.w,mp.w=mp.v,(mp.d=mp.d+362437|0)+(mp.v=mp.v^mp.v<<4^xp^xp<<1)|0},mp.x=0,mp.y=0,mp.z=0,mp.w=0,mp.v=0,pp===(0|pp)?mp.x=pp:gp+=pp;for(var yp=0;yp<gp.length+64;yp++)mp.x^=0|gp.charCodeAt(yp),yp==gp.length&&(mp.d=mp.x<<10^mp.x>>>4),mp.next()}(up),hp=cp&&cp.state,fp=function(){return(dp.next()>>>0)/4294967296};return fp.double=function(){do var pp=((dp.next()>>>11)+(dp.next()>>>0)/4294967296)/2097152;while(pp===0);return pp},fp.int32=dp.next,fp.quick=fp,hp&&(typeof hp=="object"&&sp(hp,dp),fp.state=function(){return sp(dp,{})}),fp}np&&np.exports?np.exports=lp:ap&&ap.amd?ap(function(){return lp}):this.xorwow=lp})(0,rp,!1)}),xorshift7$2=createCommonjsModule$1(function(rp){(function(_d,np,ap){function sp(up,cp){return cp.x=up.x.slice(),cp.i=up.i,cp}function lp(up,cp){up==null&&(up=+new Date);var dp=new function(pp){var mp=this;mp.next=function(){var gp,yp,xp=mp.x,_p=mp.i;return gp=xp[_p],yp=(gp^=gp>>>7)^gp<<24,yp^=(gp=xp[_p+1&7])^gp>>>10,yp^=(gp=xp[_p+3&7])^gp>>>3,yp^=(gp=xp[_p+4&7])^gp<<7,gp=xp[_p+7&7],yp^=(gp^=gp<<13)^gp<<9,xp[_p]=yp,mp.i=_p+1&7,yp},function(gp,yp){var xp,_p=[];if(yp===(0|yp))_p[0]=yp;else for(yp=""+yp,xp=0;xp<yp.length;++xp)_p[7&xp]=_p[7&xp]<<15^yp.charCodeAt(xp)+_p[xp+1&7]<<13;for(;_p.length<8;)_p.push(0);for(xp=0;xp<8&&_p[xp]===0;++xp);for(xp==8?_p[7]=-1:_p[xp],gp.x=_p,gp.i=0,xp=256;xp>0;--xp)gp.next()}(mp,pp)}(up),hp=cp&&cp.state,fp=function(){return(dp.next()>>>0)/4294967296};return fp.double=function(){do var pp=((dp.next()>>>11)+(dp.next()>>>0)/4294967296)/2097152;while(pp===0);return pp},fp.int32=dp.next,fp.quick=fp,hp&&(hp.x&&sp(hp,dp),fp.state=function(){return sp(dp,{})}),fp}np&&np.exports?np.exports=lp:ap&&ap.amd?ap(function(){return lp}):this.xorshift7=lp})(0,rp,!1)}),xor4096$2=createCommonjsModule$1(function(rp){(function(_d,np,ap){function sp(up,cp){return cp.i=up.i,cp.w=up.w,cp.X=up.X.slice(),cp}function lp(up,cp){up==null&&(up=+new Date);var dp=new function(pp){var mp=this;mp.next=function(){var gp,yp,xp=mp.w,_p=mp.X,vp=mp.i;return mp.w=xp=xp+1640531527|0,yp=_p[vp+34&127],gp=_p[vp=vp+1&127],yp^=yp<<13,gp^=gp<<17,yp^=yp>>>15,gp^=gp>>>12,yp=_p[vp]=yp^gp,mp.i=vp,yp+(xp^xp>>>16)|0},function(gp,yp){var xp,_p,vp,bp,Ep,Sp=[],Ap=128;for(yp===(0|yp)?(_p=yp,yp=null):(yp+="\0",_p=0,Ap=Math.max(Ap,yp.length)),vp=0,bp=-32;bp<Ap;++bp)yp&&(_p^=yp.charCodeAt((bp+32)%yp.length)),bp===0&&(Ep=_p),_p^=_p<<10,_p^=_p>>>15,_p^=_p<<4,_p^=_p>>>13,bp>=0&&(Ep=Ep+1640531527|0,vp=(xp=Sp[127&bp]^=_p+Ep)==0?vp+1:0);for(vp>=128&&(Sp[127&(yp&&yp.length||0)]=-1),vp=127,bp=512;bp>0;--bp)_p=Sp[vp+34&127],xp=Sp[vp=vp+1&127],_p^=_p<<13,xp^=xp<<17,_p^=_p>>>15,xp^=xp>>>12,Sp[vp]=_p^xp;gp.w=Ep,gp.X=Sp,gp.i=vp}(mp,pp)}(up),hp=cp&&cp.state,fp=function(){return(dp.next()>>>0)/4294967296};return fp.double=function(){do var pp=((dp.next()>>>11)+(dp.next()>>>0)/4294967296)/2097152;while(pp===0);return pp},fp.int32=dp.next,fp.quick=fp,hp&&(hp.X&&sp(hp,dp),fp.state=function(){return sp(dp,{})}),fp}np&&np.exports?np.exports=lp:ap&&ap.amd?ap(function(){return lp}):this.xor4096=lp})(0,rp,!1)}),tychei$2=createCommonjsModule$1(function(rp){(function(_d,np,ap){function sp(up,cp){return cp.a=up.a,cp.b=up.b,cp.c=up.c,cp.d=up.d,cp}function lp(up,cp){var dp=new function(pp){var mp=this,gp="";mp.next=function(){var xp=mp.b,_p=mp.c,vp=mp.d,bp=mp.a;return xp=xp<<25^xp>>>7^_p,_p=_p-vp|0,vp=vp<<24^vp>>>8^bp,bp=bp-xp|0,mp.b=xp=xp<<20^xp>>>12^_p,mp.c=_p=_p-vp|0,mp.d=vp<<16^_p>>>16^bp,mp.a=bp-xp|0},mp.a=0,mp.b=0,mp.c=-1640531527,mp.d=1367130551,pp===Math.floor(pp)?(mp.a=pp/4294967296|0,mp.b=0|pp):gp+=pp;for(var yp=0;yp<gp.length+20;yp++)mp.b^=0|gp.charCodeAt(yp),mp.next()}(up),hp=cp&&cp.state,fp=function(){return(dp.next()>>>0)/4294967296};return fp.double=function(){do var pp=((dp.next()>>>11)+(dp.next()>>>0)/4294967296)/2097152;while(pp===0);return pp},fp.int32=dp.next,fp.quick=fp,hp&&(typeof hp=="object"&&sp(hp,dp),fp.state=function(){return sp(dp,{})}),fp}np&&np.exports?np.exports=lp:ap&&ap.amd?ap(function(){return lp}):this.tychei=lp})(0,rp,!1)}),seedrandom$3=createCommonjsModule$1(function(rp){(function(_d,np){var ap,sp=this,lp=256,up=6,cp="random",dp=np.pow(lp,up),hp=np.pow(2,52),fp=2*hp,pp=lp-1;function mp(_p,vp,bp){var Ep=[],Sp=yp(function Tp(Mp,Op){var Pp,$p=[],zp=typeof Mp;if(Op&&zp=="object")for(Pp in Mp)try{$p.push(Tp(Mp[Pp],Op-1))}catch{}return $p.length?$p:zp=="string"?Mp:Mp+"\0"}((vp=vp==1?{entropy:!0}:vp||{}).entropy?[_p,xp(_d)]:_p??function(){try{var Tp;return ap&&(Tp=ap.randomBytes)?Tp=Tp(lp):(Tp=new Uint8Array(lp),(sp.crypto||sp.msCrypto).getRandomValues(Tp)),xp(Tp)}catch{var Mp=sp.navigator,Op=Mp&&Mp.plugins;return[+new Date,sp,Op,sp.screen,xp(_d)]}}(),3),Ep),Ap=new function(Tp){var Mp,Op=Tp.length,Pp=this,$p=0,zp=Pp.i=Pp.j=0,Dp=Pp.S=[];for(Op||(Tp=[Op++]);$p<lp;)Dp[$p]=$p++;for($p=0;$p<lp;$p++)Dp[$p]=Dp[zp=pp&zp+Tp[$p%Op]+(Mp=Dp[$p])],Dp[zp]=Mp;(Pp.g=function(Fp){for(var jp,Lp=0,Bp=Pp.i,Ip=Pp.j,kp=Pp.S;Fp--;)jp=kp[Bp=pp&Bp+1],Lp=Lp*lp+kp[pp&(kp[Bp]=kp[Ip=pp&Ip+jp])+(kp[Ip]=jp)];return Pp.i=Bp,Pp.j=Ip,Lp})(lp)}(Ep),Rp=function(){for(var Tp=Ap.g(up),Mp=dp,Op=0;Tp<hp;)Tp=(Tp+Op)*lp,Mp*=lp,Op=Ap.g(1);for(;Tp>=fp;)Tp/=2,Mp/=2,Op>>>=1;return(Tp+Op)/Mp};return Rp.int32=function(){return 0|Ap.g(4)},Rp.quick=function(){return Ap.g(4)/4294967296},Rp.double=Rp,yp(xp(Ap.S),_d),(vp.pass||bp||function(Tp,Mp,Op,Pp){return Pp&&(Pp.S&&gp(Pp,Ap),Tp.state=function(){return gp(Ap,{})}),Op?(np[cp]=Tp,Mp):Tp})(Rp,Sp,"global"in vp?vp.global:this==np,vp.state)}function gp(_p,vp){return vp.i=_p.i,vp.j=_p.j,vp.S=_p.S.slice(),vp}function yp(_p,vp){for(var bp,Ep=_p+"",Sp=0;Sp<Ep.length;)vp[pp&Sp]=pp&(bp^=19*vp[pp&Sp])+Ep.charCodeAt(Sp++);return xp(vp)}function xp(_p){return String.fromCharCode.apply(0,_p)}if(np["seed"+cp]=mp,yp(np.random(),_d),rp.exports){rp.exports=mp;try{ap=require("crypto")}catch{}}})([],Math)});seedrandom$3.alea=alea$2,seedrandom$3.xor128=xor128$2,seedrandom$3.xorwow=xorwow$2,seedrandom$3.xorshift7=xorshift7$2,seedrandom$3.xor4096=xor4096$2,seedrandom$3.tychei=tychei$2;var seedrandom$1$1=seedrandom$3,seedrandom_1=seedrandom$1$1.alea;function deepMap(rp,_d){return deepMapInternal(rp,_d)}function deepMapInternal(rp,_d,np,ap){if(np===void 0&&(np=new Map),ap===void 0&&(ap=new Set),rp==null)return null;if(ap.has(rp))throw new Error("Circular references are not supported.");if(np.has(rp))return np.get(rp);var sp=_d(rp);if(sp.recurse&&sp.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(sp.recurse){if(isIterable(rp)){var lp=Array.isArray(rp)?[]:{};for(var up in ap.add(rp),rp){var cp=deepMapInternal(rp[up],_d,np,ap);lp[up]=cp}return ap.delete(rp),lp}throw new Error("Can't recurse into non-iterable type: "+rp)}return np.set(rp,sp.value),sp.value}function deepZip(rp,_d){return _d===void 0&&(_d=zipToList),deepZipInternal(rp,_d)}function deepZipInternal(rp,_d,np){np===void 0&&(np=new Set);var ap=rp[0];if(np.has(ap))throw new Error("Circular references are not supported.");var sp=_d(rp);if(sp.recurse&&sp.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(sp.recurse){if(isIterable(ap)){var lp=Array.isArray(ap)?[]:{};np.add(ap);var up=function(dp){var hp=deepZipInternal(rp.map(function(fp){return fp[dp]}),_d,np);lp[dp]=hp};for(var cp in ap)up(cp);return np.delete(ap),lp}throw new Error("Can't recurse into non-iterable type: "+ap)}return sp.value}function zipToList(rp){return rp===null?null:isIterable(rp[0])?{value:null,recurse:!0}:{value:rp,recurse:!1}}function deepMapAndAwaitAll(rp,_d){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp;return __generator$6(this,function(dp){switch(dp.label){case 0:np=new Map,deepMapInternal(rp,_d,np),ap=0,sp=Array.from(np.keys()),dp.label=1;case 1:return ap<sp.length?(lp=sp[ap],(up=np.get(lp))instanceof Promise?[4,up]:[3,3]):[3,4];case 2:cp=dp.sent(),np.set(lp,cp),dp.label=3;case 3:return ap++,[3,1];case 4:return[2,deepMapInternal(rp,_d,np)]}})})}function isIterable(rp){return rp!=null&&!ArrayBuffer.isView(rp)&&(Array.isArray(rp)||typeof rp=="object"&&!(rp instanceof dt))}function canTensorify(rp){return rp==null||isPrimitive(rp)||Array.isArray(rp)||typeof rp=="object"&&rp instanceof dt||tt.isTypedArray(rp)}function isPrimitive(rp){return rp===null||typeof rp!="object"&&typeof rp!="function"}function deepClone(rp){return deepMap(rp,cloneIfTensor)}function cloneIfTensor(rp){return rp instanceof dt?{value:rp.clone(),recurse:!1}:isIterable(rp)?{value:null,recurse:!0}:{value:rp,recurse:!1}}var RingBuffer=function(){function rp(_d){if(this.capacity=_d,this.begin=0,this.end=0,_d==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(_d<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(_d),this.doubledCapacity=2*_d}return rp.prototype.wrap=function(_d){for(;_d<0;)_d+=this.doubledCapacity;return _d%this.doubledCapacity},rp.prototype.get=function(_d){if(_d<0)throw new RangeError("Can't get item at a negative index.");return this.data[_d%this.capacity]},rp.prototype.set=function(_d,np){if(_d<0)throw new RangeError("Can't set item at a negative index.");this.data[_d%this.capacity]=np},rp.prototype.length=function(){var _d=this.end-this.begin;return _d<0&&(_d=this.doubledCapacity+_d),_d},rp.prototype.isFull=function(){return this.length()===this.capacity},rp.prototype.isEmpty=function(){return this.length()===0},rp.prototype.push=function(_d){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,_d),this.end=this.wrap(this.end+1)},rp.prototype.pushAll=function(_d){for(var np=0,ap=_d;np<ap.length;np++){var sp=ap[np];this.push(sp)}},rp.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var _d=this.get(this.end);return this.set(this.end,void 0),_d},rp.prototype.unshift=function(_d){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,_d)},rp.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var _d=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),_d},rp.prototype.shuffleExcise=function(_d){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var np=this.wrap(this.begin+_d),ap=this.get(np);return this.set(np,this.pop()),ap},rp}(),GrowingRingBuffer=function(rp){function _d(){return rp.call(this,_d.INITIAL_CAPACITY)||this}return __extends$g(_d,rp),_d.prototype.isFull=function(){return!1},_d.prototype.push=function(np){rp.prototype.isFull.call(this)&&this.expand(),rp.prototype.push.call(this,np)},_d.prototype.unshift=function(np){rp.prototype.isFull.call(this)&&this.expand(),rp.prototype.unshift.call(this,np)},_d.prototype.expand=function(){for(var np=2*this.capacity,ap=new Array(np),sp=this.length(),lp=0;lp<sp;lp++)ap[lp]=this.get(this.wrap(this.begin+lp));this.data=ap,this.capacity=np,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=sp},_d.INITIAL_CAPACITY=32,_d}(RingBuffer);function iteratorFromItems(rp){return new ArrayIterator(rp)}function iteratorFromFunction(rp){return new FunctionCallIterator(rp)}function iteratorFromConcatenated(rp,_d){return new ChainedIterator(rp,_d)}function iteratorFromZipped(rp,_d){return _d===void 0&&(_d=ZipMismatchMode.FAIL),new ZipIterator(rp,_d)}var ZipMismatchMode,LazyIterator=function(){function rp(){}return rp.prototype.toArray=function(){return __awaiter$6(this,void 0,void 0,function(){var _d,np;return __generator$6(this,function(ap){switch(ap.label){case 0:return _d=[],[4,this.next()];case 1:np=ap.sent(),ap.label=2;case 2:return np.done?[3,4]:(_d.push(np.value),[4,this.next()]);case 3:return np=ap.sent(),[3,2];case 4:return[2,_d]}})})},rp.prototype.toArrayForTest=function(){return __awaiter$6(this,void 0,void 0,function(){var _d,np,ap;return __generator$6(this,function(sp){switch(sp.label){case 0:return _d=this.prefetch(100),np=[],[4,_d.next()];case 1:ap=sp.sent(),sp.label=2;case 2:return ap.done?[3,4]:(np.push(ap.value),[4,_d.next()]);case 3:return ap=sp.sent(),[3,2];case 4:return[2,np]}})})},rp.prototype.resolveFully=function(){return __awaiter$6(this,void 0,void 0,function(){var _d;return __generator$6(this,function(np){switch(np.label){case 0:return[4,this.next()];case 1:_d=np.sent(),np.label=2;case 2:return _d.done?[3,4]:[4,this.next()];case 3:return _d=np.sent(),[3,2];case 4:return[2]}})})},rp.prototype.resolveWhile=function(_d){return __awaiter$6(this,void 0,void 0,function(){var np,ap;return __generator$6(this,function(sp){switch(sp.label){case 0:return[4,this.next()];case 1:np=sp.sent(),ap=_d(np.value),sp.label=2;case 2:return np.done||!ap?[3,4]:[4,this.next()];case 3:return np=sp.sent(),ap=_d(np.value),[3,2];case 4:return[2]}})})},rp.prototype.handleErrors=function(_d){return new ErrorHandlingLazyIterator(this,_d)},rp.prototype.filter=function(_d){return new FilterIterator(this,_d)},rp.prototype.map=function(_d){return new MapIterator(this,_d)},rp.prototype.mapAsync=function(_d){return new AsyncMapIterator(this,_d)},rp.prototype.serialMapAsync=function(_d){return new AsyncMapIterator(this,_d).serial()},rp.prototype.flatmap=function(_d){return new FlatmapIterator(this,_d)},rp.prototype.forEachAsync=function(_d){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return[2,this.map(_d).resolveFully()]})})},rp.prototype.serialForEach=function(_d){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return[2,this.serialMapAsync(_d).resolveWhile(function(ap){return ap===!0})]})})},rp.prototype.rowMajorBatch=function(_d,np){return np===void 0&&(np=!0),new RowMajorBatchIterator(this,_d,np)},rp.prototype.columnMajorBatch=function(_d,np,ap){return np===void 0&&(np=!0),ap===void 0&&(ap=zipToList),this.rowMajorBatch(_d,np).map(function(sp){return deepZip(sp,ap)})},rp.prototype.concatenate=function(_d,np){return new ChainedIterator(iteratorFromItems([this,_d]),np)},rp.prototype.take=function(_d){return _d<0||_d==null?this:new TakeIterator(this,_d)},rp.prototype.skip=function(_d){return _d<0||_d==null?this:new SkipIterator(this,_d)},rp.prototype.prefetch=function(_d){return new PrefetchIterator(this,_d)},rp.prototype.shuffle=function(_d,np){return new ShuffleIterator(this,_d,np)},rp.prototype.serial=function(){return new SerialIterator(this)},rp}(),ArrayIterator=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.items=np,ap.trav=0,ap}return __extends$g(_d,rp),_d.prototype.summary=function(){return"Array of "+this.items.length+" items"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np;return __generator$6(this,function(ap){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(np=this.items[this.trav],this.trav++,[2,{value:deepClone(np),done:!1}])})})},_d}(LazyIterator),FunctionCallIterator=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.nextFn=np,ap}return __extends$g(_d,rp),_d.prototype.summary=function(){return"Function call"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){try{return[2,this.nextFn()]}catch(ap){throw ap.message="Error thrown while iterating through a dataset: "+ap.message,ap}return[2]})})},_d}(LazyIterator),SerialIterator=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.upstream=np,ap.lastRead=Promise.resolve({value:null,done:!1}),ap}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np=this;return __generator$6(this,function(ap){return this.lastRead=this.lastRead.then(function(){return np.serialNext()}),[2,this.lastRead]})})},_d.prototype.serialNext=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return[2,this.upstream.next()]})})},_d}(LazyIterator),SkipIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.maxCount=ap,sp.count=0,sp.lastRead=Promise.resolve({value:null,done:!1}),sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np=this;return __generator$6(this,function(ap){return this.lastRead=this.lastRead.then(function(){return np.serialNext()}),[2,this.lastRead]})})},_d.prototype.serialNext=function(){return __awaiter$6(this,void 0,void 0,function(){var np;return __generator$6(this,function(ap){switch(ap.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(np=ap.sent()).done?[2,np]:(Xe(np.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},_d}(LazyIterator),TakeIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.maxCount=ap,sp.count=0,sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> Take"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},_d}(LazyIterator),RowMajorBatchIterator=function(rp){function _d(np,ap,sp){sp===void 0&&(sp=!0);var lp=rp.call(this)||this;return lp.upstream=np,lp.batchSize=ap,lp.enableSmallLastBatch=sp,lp.lastRead=Promise.resolve({value:null,done:!1}),lp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np=this;return __generator$6(this,function(ap){return this.lastRead=this.lastRead.then(function(){return np.serialNext()}),[2,this.lastRead]})})},_d.prototype.serialNext=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap;return __generator$6(this,function(sp){switch(sp.label){case 0:np=[],sp.label=1;case 1:return np.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(ap=sp.sent()).done?this.enableSmallLastBatch&&np.length>0?[2,{value:np,done:!1}]:[2,{value:null,done:!0}]:(np.push(ap.value),[3,1]);case 3:return[2,{value:np,done:!1}]}})})},_d}(LazyIterator),FilterIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.predicate=ap,sp.lastRead=Promise.resolve({value:null,done:!1}),sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np=this;return __generator$6(this,function(ap){return this.lastRead=this.lastRead.then(function(){return np.serialNext()}),[2,this.lastRead]})})},_d.prototype.serialNext=function(){return __awaiter$6(this,void 0,void 0,function(){var np;return __generator$6(this,function(ap){switch(ap.label){case 0:return[4,this.upstream.next()];case 1:return(np=ap.sent()).done||this.predicate(np.value)?[2,np]:(Xe(np.value),[3,0]);case 2:return[2]}})})},_d}(LazyIterator),MapIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.transform=ap,sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> Map"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp;return __generator$6(this,function(hp){switch(hp.label){case 0:return[4,this.upstream.next()];case 1:if((np=hp.sent()).done)return[2,{value:null,done:!0}];for(ap=At.getTensorsInContainer(np.value),sp=this.transform(np.value),lp=At.getTensorsInContainer(sp),up=0,cp=ap;up<cp.length;up++)dp=cp[up],At.isTensorInList(dp,lp)||dp.dispose();return[2,{value:sp,done:!1}]}})})},_d}(LazyIterator),ErrorHandlingLazyIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.handler=ap,sp.count=0,sp.lastRead=Promise.resolve({value:null,done:!1}),sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np=this;return __generator$6(this,function(ap){return this.lastRead=this.lastRead.then(function(){return np.serialNext()}),[2,this.lastRead]})})},_d.prototype.serialNext=function(){return __awaiter$6(this,void 0,void 0,function(){var np;return __generator$6(this,function(ap){switch(ap.label){case 0:ap.label=1;case 1:return ap.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,ap.sent()];case 3:return np=ap.sent(),this.handler(np)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},_d}(LazyIterator),AsyncMapIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.transform=ap,sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp;return __generator$6(this,function(hp){switch(hp.label){case 0:return[4,this.upstream.next()];case 1:return(np=hp.sent()).done?[2,{value:null,done:!0}]:(ap=At.getTensorsInContainer(np.value),[4,this.transform(np.value)]);case 2:for(sp=hp.sent(),lp=At.getTensorsInContainer(sp),up=0,cp=ap;up<cp.length;up++)dp=cp[up],At.isTensorInList(dp,lp)||dp.dispose();return[2,{value:sp,done:!1}]}})})},_d}(LazyIterator),OneToManyIterator=function(rp){function _d(){var np=rp.call(this)||this;return np.outputQueue=new GrowingRingBuffer,np.lastRead=Promise.resolve({value:null,done:!1}),np}return __extends$g(_d,rp),_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np=this;return __generator$6(this,function(ap){return this.lastRead=this.lastRead.then(function(){return np.serialNext()}),[2,this.lastRead]})})},_d.prototype.serialNext=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){switch(np.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return np.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},_d}(LazyIterator),FlatmapIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.transform=ap,sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},_d.prototype.pump=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp;return __generator$6(this,function(hp){switch(hp.label){case 0:return[4,this.upstream.next()];case 1:if((np=hp.sent()).done)return[2,!1];for(ap=At.getTensorsInContainer(np.value),sp=this.transform(np.value),lp=At.getTensorsInContainer(sp),this.outputQueue.pushAll(sp),up=0,cp=ap;up<cp.length;up++)dp=cp[up],At.isTensorInList(dp,lp)||dp.dispose();return[2,!0]}})})},_d}(OneToManyIterator),ChainedIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.baseErrorHandler=ap,sp.lastRead=null,sp.iterator=null,sp.moreIterators=np,sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},_d.prototype.readFromChain=function(np){return __awaiter$6(this,void 0,void 0,function(){var ap,sp;return __generator$6(this,function(lp){switch(lp.label){case 0:return[4,np];case 1:return lp.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((ap=lp.sent()).done)return[2,{value:null,done:!0}];this.iterator=ap.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),lp.label=3;case 3:return[4,this.iterator.next()];case 4:return(sp=lp.sent()).done?(this.iterator=null,[2,this.readFromChain(np)]):[2,sp]}})})},_d}(LazyIterator);(function(rp){rp[rp.FAIL=0]="FAIL",rp[rp.SHORTEST=1]="SHORTEST",rp[rp.LONGEST=2]="LONGEST"})(ZipMismatchMode||(ZipMismatchMode={}));var ZipIterator=function(rp){function _d(np,ap){ap===void 0&&(ap=ZipMismatchMode.FAIL);var sp=rp.call(this)||this;return sp.iterators=np,sp.mismatchMode=ap,sp.count=0,sp.currentPromise=null,sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},_d.prototype.nextState=function(np){return __awaiter$6(this,void 0,void 0,function(){function ap(cp){return cp instanceof LazyIterator?{value:cp.next().then(function(dp){return sp++,dp.done&&lp++,dp.value}),recurse:!1}:{value:null,recurse:!0}}var sp,lp,up;return __generator$6(this,function(cp){switch(cp.label){case 0:return[4,np];case 1:return cp.sent(),sp=0,lp=0,[4,deepMapAndAwaitAll(this.iterators,ap)];case 2:if(up=cp.sent(),sp===lp)return[2,{value:null,done:!0}];if(lp>0)switch(this.mismatchMode){case ZipMismatchMode.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case ZipMismatchMode.SHORTEST:return[2,{value:null,done:!0}];case ZipMismatchMode.LONGEST:}return this.count++,[2,{value:up,done:!1}]}})})},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},_d}(LazyIterator),PrefetchIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.bufferSize=ap,sp.buffer=new RingBuffer(ap),sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},_d.prototype.refill=function(){for(;!this.buffer.isFull();){var np=this.upstream.next();this.buffer.push(np)}},_d.prototype.next=function(){return this.refill(),this.buffer.shift()},_d}(LazyIterator),ShuffleIterator=function(rp){function _d(np,ap,sp){var lp=rp.call(this,np,ap)||this;return lp.upstream=np,lp.windowSize=ap,lp.upstreamExhausted=!1,lp.random=seedrandom_1(sp||tt.now().toString()),lp.lastRead=Promise.resolve({value:null,done:!1}),lp}return __extends$g(_d,rp),_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np=this;return __generator$6(this,function(ap){return this.lastRead=this.lastRead.then(function(){return np.serialNext()}),[2,this.lastRead]})})},_d.prototype.randomInt=function(np){return Math.floor(this.random()*np)},_d.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},_d.prototype.serialNext=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap;return __generator$6(this,function(sp){switch(sp.label){case 0:this.upstreamExhausted||this.refill(),sp.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(np=this.chooseIndex(),[4,this.buffer.shuffleExcise(np)]);case 2:return(ap=sp.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,ap]);case 3:return[2,{value:null,done:!0}]}})})},_d}(PrefetchIterator),Dataset=function(){function rp(){this.size=null}return rp.prototype.batch=function(_d,np){var ap=this;np===void 0&&(np=!0);var sp=this;return tt.assert(_d>0,function(){return`batchSize needs to be positive, but it is
      `+_d}),datasetFromIteratorFn(function(){return __awaiter$6(ap,void 0,void 0,function(){return __generator$6(this,function(lp){switch(lp.label){case 0:return[4,sp.iterator()];case 1:return[2,lp.sent().columnMajorBatch(_d,np,deepBatchConcat)]}})})},this.size===1/0||this.size==null?this.size:np?Math.ceil(this.size/_d):Math.floor(this.size/_d))},rp.prototype.concatenate=function(_d){var np=this,ap=this;return datasetFromIteratorFn(function(){return __awaiter$6(np,void 0,void 0,function(){var sp,lp;return __generator$6(this,function(up){switch(up.label){case 0:return[4,ap.iterator()];case 1:return lp=(sp=up.sent()).concatenate,[4,_d.iterator()];case 2:return[2,lp.apply(sp,[up.sent()])]}})})},this.size===1/0||_d.size===1/0?1/0:this.size!=null&&_d.size!=null?this.size+_d.size:null)},rp.prototype.filter=function(_d){var np=this,ap=this;return datasetFromIteratorFn(function(){return __awaiter$6(np,void 0,void 0,function(){return __generator$6(this,function(sp){switch(sp.label){case 0:return[4,ap.iterator()];case 1:return[2,sp.sent().filter(function(lp){return je(function(){return _d(lp)})})]}})})},this.size===1/0?1/0:null)},rp.prototype.forEachAsync=function(_d){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){switch(np.label){case 0:return[4,this.iterator()];case 1:return[2,np.sent().forEachAsync(_d)]}})})},rp.prototype.forEach=function(_d){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return ze("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(_d)]})})},rp.prototype.map=function(_d){var np=this,ap=this;return datasetFromIteratorFn(function(){return __awaiter$6(np,void 0,void 0,function(){return __generator$6(this,function(sp){switch(sp.label){case 0:return[4,ap.iterator()];case 1:return[2,sp.sent().map(function(lp){return je(function(){return _d(lp)})})]}})})},this.size)},rp.prototype.mapAsync=function(_d){var np=this,ap=this;return datasetFromIteratorFn(function(){return __awaiter$6(np,void 0,void 0,function(){return __generator$6(this,function(sp){switch(sp.label){case 0:return[4,ap.iterator()];case 1:return[2,sp.sent().mapAsync(_d)]}})})},this.size)},rp.prototype.prefetch=function(_d){var np=this;if(_d==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var ap=this;return datasetFromIteratorFn(function(){return __awaiter$6(np,void 0,void 0,function(){return __generator$6(this,function(sp){switch(sp.label){case 0:return[4,ap.iterator()];case 1:return[2,sp.sent().prefetch(_d)]}})})},this.size)},rp.prototype.repeat=function(_d){var np=this,ap=this;return datasetFromIteratorFn(function(){return __awaiter$6(np,void 0,void 0,function(){var sp=this;return __generator$6(this,function(lp){return[2,iteratorFromConcatenated(iteratorFromFunction(function(){return __awaiter$6(sp,void 0,void 0,function(){var up;return __generator$6(this,function(cp){switch(cp.label){case 0:return up={},[4,ap.iterator()];case 1:return[2,(up.value=cp.sent(),up.done=!1,up)]}})})}).take(_d))]})})},this.size!=null&&_d>0?this.size*_d:_d===0?0:this.size!=null&&(_d===void 0||_d<0)?1/0:null)},rp.prototype.skip=function(_d){var np=this,ap=this;return datasetFromIteratorFn(function(){return __awaiter$6(np,void 0,void 0,function(){return __generator$6(this,function(sp){switch(sp.label){case 0:return[4,ap.iterator()];case 1:return[2,sp.sent().skip(_d)]}})})},this.size!=null&&_d>=0&&this.size>=_d?this.size-_d:this.size!=null&&(this.size<_d||_d===void 0||_d<0)?0:null)},rp.prototype.shuffle=function(_d,np,ap){var sp=this;if(ap===void 0&&(ap=!0),_d==null||_d<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var lp=this,up=seedrandom_1(np||tt.now().toString());return datasetFromIteratorFn(function(){return __awaiter$6(sp,void 0,void 0,function(){var cp;return __generator$6(this,function(dp){switch(dp.label){case 0:return cp=up.int32(),ap&&(cp+=up.int32()),[4,lp.iterator()];case 1:return[2,dp.sent().shuffle(_d,cp.toString())]}})})},this.size)},rp.prototype.take=function(_d){var np=this,ap=this;return datasetFromIteratorFn(function(){return __awaiter$6(np,void 0,void 0,function(){return __generator$6(this,function(sp){switch(sp.label){case 0:return[4,ap.iterator()];case 1:return[2,sp.sent().take(_d)]}})})},this.size!=null&&this.size>_d?_d:this.size!=null&&this.size<=_d?this.size:null)},rp.prototype.toArray=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(_d){switch(_d.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,_d.sent().toArray()]}})})},rp.prototype.toArrayForTest=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(_d){switch(_d.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,_d.sent().toArrayForTest()]}})})},rp.MAX_BUFFER_SIZE=1e4,rp}();function datasetFromIteratorFn(rp,_d){return _d===void 0&&(_d=null),new(function(np){function ap(){var sp=np!==null&&np.apply(this,arguments)||this;return sp.size=_d,sp}return __extends$g(ap,np),ap.prototype.iterator=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(sp){return[2,rp()]})})},ap}(Dataset))}function array(rp){var _d=this;return datasetFromIteratorFn(function(){return __awaiter$6(_d,void 0,void 0,function(){return __generator$6(this,function(np){return[2,iteratorFromItems(rp)]})})},rp.length)}function zip(rp){var _d,np=this;if(!isIterable(rp))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(rp))for(var ap=0;ap<rp.length;ap++)_d=_d==null?rp[ap].size:Math.min(_d,rp[ap].size);else if(rp instanceof Object)for(var sp in rp)_d=_d==null?rp[sp].size:Math.min(_d,rp[sp].size);return datasetFromIteratorFn(function(){return __awaiter$6(np,void 0,void 0,function(){return __generator$6(this,function(lp){switch(lp.label){case 0:return[4,deepMapAndAwaitAll(rp,function(up){if(up instanceof Dataset)return{value:up.iterator(),recurse:!1};if(isIterable(up))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})];case 1:return[2,iteratorFromZipped(lp.sent(),ZipMismatchMode.SHORTEST)]}})})},_d)}function deepBatchConcat(rp){return rp===null?null:canTensorify(rp[0])?{value:batchConcat(rp),recurse:!1}:{value:null,recurse:!0}}function batchConcat(rp){if(rp.length===0)throw new Error("Can't make a batch of zero elements.");return rp[0]instanceof dt?Tr(rp):kn(rp)}var TextLineDataset=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.input=np,ap}return __extends$g(_d,rp),_d.prototype.iterator=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap;return __generator$6(this,function(sp){switch(sp.label){case 0:return[4,this.input.iterator()];case 1:return np=sp.sent(),ap=np.decodeUTF8(),[2,ap.split(`
`).map(function(lp){return lp.endsWith("\r")&&(lp=lp.slice(0,-1)),lp})]}})})},_d}(Dataset),CODE_QUOTE='"',STATE_OUT=Symbol("out"),STATE_FIELD=Symbol("field"),STATE_QUOTE=Symbol("quote"),STATE_QUOTE_AFTER_QUOTE=Symbol("quoteafterquote"),STATE_WITHIN_QUOTE_IN_QUOTE=Symbol("quoteinquote"),CSVDataset=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.input=np,sp.hasHeader=!0,sp.fullColumnNames=null,sp.columnNamesValidated=!1,sp.columnConfigs=null,sp.configuredColumnsOnly=!1,sp.delimiter=",",sp.delimWhitespace=!1,sp.base=new TextLineDataset(np),ap||(ap={}),sp.hasHeader=ap.hasHeader!==!1,sp.fullColumnNames=ap.columnNames,sp.columnConfigs=ap.columnConfigs,sp.configuredColumnsOnly=ap.configuredColumnsOnly,ap.delimWhitespace?(tt.assert(ap.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),sp.delimWhitespace=!0,sp.delimiter=" "):sp.delimiter=ap.delimiter?ap.delimiter:",",sp}return __extends$g(_d,rp),_d.prototype.columnNames=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){switch(np.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:np.sent(),np.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},_d.prototype.setColumnNames=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp=this;return __generator$6(this,function(hp){switch(hp.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(np=hp.sent(),!this.fullColumnNames&&!np)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&np&&tt.assert(np.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+dp.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+np.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=np),ap=this.fullColumnNames.reduce(function(fp,pp){return fp[pp]=fp[pp]+1||1,fp},{}),sp=Object.keys(ap).filter(function(fp){return ap[fp]>1}),tt.assert(sp.length===0,function(){return"Duplicate column names found: "+sp.toString()}),this.columnConfigs){for(lp=0,up=Object.keys(this.columnConfigs);lp<up.length;lp++)if(cp=up[lp],this.fullColumnNames.indexOf(cp)===-1)throw new Error('The key "'+cp+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},_d.prototype.maybeReadHeaderLine=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap;return __generator$6(this,function(sp){switch(sp.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,sp.sent().next()];case 2:if((np=sp.sent()).done)throw new Error("No data was found for CSV parsing.");return ap=np.value,[2,this.parseRow(ap,!1)];case 3:return[2,null]}})})},_d.prototype.iterator=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap=this;return __generator$6(this,function(sp){switch(sp.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:sp.sent(),sp.label=2;case 2:return[4,this.base.iterator()];case 3:return np=sp.sent(),this.hasHeader&&(np=np.skip(1)),[2,np.map(function(lp){return ap.makeDataElement(lp)})]}})})},_d.prototype.makeDataElement=function(np){for(var ap=this.parseRow(np),sp={},lp={},up=0;up<this.fullColumnNames.length;up++){var cp=this.fullColumnNames[up],dp=this.columnConfigs?this.columnConfigs[cp]:null;if(!this.configuredColumnsOnly||dp){var hp=ap[up],fp=null;if(hp==="")if(dp&&dp.default!==void 0)fp=dp.default;else{if(dp&&(dp.required||dp.isLabel))throw new Error("Required column "+cp+" is empty in this line: "+np);fp=void 0}else{var pp=Number(hp);if(isNaN(pp))fp=dp&&dp.dtype==="bool"?this.getBoolean(hp):hp;else if(dp&&dp.dtype)switch(dp.dtype){case"float32":fp=pp;break;case"int32":fp=Math.floor(pp);break;case"bool":fp=this.getBoolean(hp);break;default:fp=pp}else fp=pp}dp&&dp.isLabel?lp[cp]=fp:sp[cp]=fp}}return Object.keys(lp).length===0?sp:{xs:sp,ys:lp}},_d.prototype.getBoolean=function(np){return np==="1"||np.toLowerCase()==="true"?1:0},_d.prototype.parseRow=function(np,ap){ap===void 0&&(ap=!0);for(var sp=[],lp=0,up=np.length,cp=STATE_OUT,dp=0;dp<up;dp++)switch(cp){case STATE_OUT:switch(np.charAt(dp)){case CODE_QUOTE:lp=dp+1,cp=STATE_QUOTE;break;case this.delimiter:if(lp=dp+1,this.delimiter===" "&&this.delimWhitespace)break;sp.push(""),cp=STATE_OUT;break;default:cp=STATE_FIELD,lp=dp}break;case STATE_FIELD:switch(np.charAt(dp)){case this.delimiter:sp.push(np.substring(lp,dp)),cp=STATE_OUT,lp=dp+1}break;case STATE_QUOTE:switch(np.charAt(dp)){case CODE_QUOTE:cp=STATE_QUOTE_AFTER_QUOTE}break;case STATE_QUOTE_AFTER_QUOTE:switch(np.charAt(dp)){case this.delimiter:sp.push(np.substring(lp,dp-1)),cp=STATE_OUT,lp=dp+1;break;case CODE_QUOTE:cp=STATE_QUOTE;break;default:cp=STATE_WITHIN_QUOTE_IN_QUOTE}break;case STATE_WITHIN_QUOTE_IN_QUOTE:switch(np.charAt(dp)){case CODE_QUOTE:cp=STATE_QUOTE}}if(cp===STATE_QUOTE_AFTER_QUOTE?sp.push(np.substring(lp,up-1)):sp.push(np.substring(lp)),ap&&sp.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+sp);return sp},_d}(Dataset),MicrophoneIterator=function(rp){function _d(np){var ap=rp.call(this)||this;ap.microphoneConfig=np,ap.isClosed=!1,ap.fftSize=np.fftSize||1024;var sp=Math.log2(ap.fftSize);if(ap.fftSize<0||sp<4||sp>14||!Number.isInteger(sp))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+ap.fftSize);if(ap.numFrames=np.numFramesPerSpectrogram||43,ap.sampleRateHz=np.sampleRateHz,ap.columnTruncateLength=np.columnTruncateLength||ap.fftSize,ap.audioTrackConstraints=np.audioTrackConstraints,ap.smoothingTimeConstant=np.smoothingTimeConstant||0,ap.includeSpectrogram=np.includeSpectrogram!==!1,ap.includeWaveform=np.includeWaveform===!0,!ap.includeSpectrogram&&!ap.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return ap}return __extends$g(_d,rp),_d.prototype.summary=function(){return"microphone"},_d.create=function(np){return np===void 0&&(np={}),__awaiter$6(this,void 0,void 0,function(){var ap;return __generator$6(this,function(sp){switch(sp.label){case 0:if(a$1().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(ap=new _d(np)).start()];case 1:return sp.sent(),[2,ap]}})})},_d.prototype.start=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp;return __generator$6(this,function(up){switch(up.label){case 0:return up.trys.push([0,2,,3]),np=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return np.stream=up.sent(),[3,3];case 2:throw ap=up.sent(),new Error("Error thrown while initializing video stream: "+ap.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(sp=window.AudioContext||window.webkitAudioContext,this.audioContext=new sp,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return lp=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,lp.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp,up;return __generator$6(this,function(cp){switch(cp.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return sp=cp.sent(),this.includeSpectrogram&&(lp=this.flattenQueue(sp.freqDataQueue),np=this.getTensorFromAudioDataArray(lp,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(up=this.flattenQueue(sp.timeDataQueue),ap=this.getTensorFromAudioDataArray(up,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:np,waveform:ap},done:!1}]}})})},_d.prototype.capture=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){switch(np.label){case 0:return[4,this.next()];case 1:return[2,np.sent().value]}})})},_d.prototype.getAudioData=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp=this;return __generator$6(this,function(up){return np=[],ap=[],sp=0,[2,new Promise(function(cp){var dp=setInterval(function(){lp.includeSpectrogram&&(lp.analyser.getFloatFrequencyData(lp.freqData),lp.freqData[0]===-1/0&&cp({freqDataQueue:np,timeDataQueue:ap}),np.push(lp.freqData.slice(0,lp.columnTruncateLength))),lp.includeWaveform&&(lp.analyser.getFloatTimeDomainData(lp.timeData),ap.push(lp.timeData.slice())),++sp===lp.numFrames&&(clearInterval(dp),cp({freqDataQueue:np,timeDataQueue:ap}))},lp.fftSize/lp.sampleRateHz*1e3)})]})})},_d.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},_d.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},_d.prototype.getSampleRate=function(){return this.sampleRateHz},_d.prototype.flattenQueue=function(np){var ap=np[0].length,sp=new Float32Array(np.length*ap);return np.forEach(function(lp,up){return sp.set(lp,up*ap)}),sp},_d.prototype.getTensorFromAudioDataArray=function(np,ap){var sp=new Float32Array(tt.sizeFromShape(ap));return sp.set(np,sp.length-np.length),kn(sp,ap)},_d}(LazyIterator),WebcamIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;if(sp.webcamVideoElement=np,sp.webcamConfig=ap,sp.isClosed=!0,sp.resize=!1,sp.needToResize())if(sp.resize=!0,sp.cropSize=[sp.webcamConfig.resizeHeight,sp.webcamConfig.resizeWidth],sp.cropBoxInd=Dn([0],"int32"),sp.webcamConfig.centerCrop){var lp=1*sp.webcamConfig.resizeWidth/sp.webcamVideoElement.width,up=1*sp.webcamConfig.resizeHeight/sp.webcamVideoElement.height,cp=(1-lp)/2,dp=(1-up)/2,hp=cp+lp,fp=up+dp;sp.cropBox=Tn([dp,cp,fp,hp],[1,4])}else sp.cropBox=Tn([0,0,1,1],[1,4]);return sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return"webcam"},_d.create=function(np,ap){return ap===void 0&&(ap={}),__awaiter$6(this,void 0,void 0,function(){var sp;return __generator$6(this,function(lp){switch(lp.label){case 0:if(a$1().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!np){if(np=document.createElement("video"),!ap.resizeWidth||!ap.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");np.width=ap.resizeWidth,np.height=ap.resizeHeight}return[4,(sp=new _d(np,ap)).start()];case 1:return lp.sent(),[2,sp]}})})},_d.prototype.start=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp=this;return __generator$6(this,function(lp){switch(lp.label){case 0:this.webcamConfig.facingMode&&tt.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+sp.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),lp.label=1;case 1:return lp.trys.push([1,3,,4]),np=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return np.stream=lp.sent(),[3,4];case 3:throw(ap=lp.sent()).message="Error thrown while initializing video stream: "+ap.message,ap;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(up){console.log(up),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(up){sp.webcamVideoElement.onloadedmetadata=function(){up()}})]}})})},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np;return __generator$6(this,function(ap){if(this.isClosed)return[2,{value:null,done:!0}];try{np=Nf.fromPixels(this.webcamVideoElement)}catch(sp){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(sp))}if(!this.resize)return[2,{value:np,done:!1}];try{return[2,{value:this.cropAndResizeFrame(np),done:!1}]}catch(sp){throw new Error("Error thrown cropping the video: "+sp.message)}finally{np.dispose()}return[2]})})},_d.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},_d.prototype.cropAndResizeFrame=function(np){var ap=this;return je(function(){var sp,lp=np.toFloat().expandDims(0),up=(sp=vh.cropAndResize(lp,ap.cropBox,ap.cropBoxInd,ap.cropSize,"bilinear")).shape;return sp.reshape(up.slice(1))})},_d.prototype.capture=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){switch(np.label){case 0:return[4,this.next()];case 1:return[2,np.sent().value]}})})},_d.prototype.stop=function(){this.stream.getTracks().forEach(function(np){return np.stop()});try{this.webcamVideoElement.srcObject=null}catch(np){console.log(np),this.webcamVideoElement.src=null}this.isClosed=!0},_d.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},_d}(LazyIterator),DataSource=function(){return function(){}}(),StringIterator=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$g(_d,rp),_d.prototype.split=function(np){return new SplitIterator(this,np)},_d}(LazyIterator),SplitIterator=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.impl=new SplitIteratorImpl(np,ap),sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.impl.summary()},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return[2,this.impl.next()]})})},_d}(StringIterator),SplitIteratorImpl=function(rp){function _d(np,ap){var sp=rp.call(this)||this;return sp.upstream=np,sp.separator=ap,sp.carryover="",sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},_d.prototype.pump=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp,up;return __generator$6(this,function(cp){switch(cp.label){case 0:return[4,this.upstream.next()];case 1:if((np=cp.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((ap=np.value.split(this.separator))[0]=this.carryover+ap[0],sp=0,lp=ap.slice(0,-1);sp<lp.length;sp++)up=lp[sp],this.outputQueue.push(up);return this.carryover=ap[ap.length-1],[2,!0]}})})},_d}(OneToManyIterator),ByteChunkIterator=function(rp){function _d(){return rp!==null&&rp.apply(this,arguments)||this}return __extends$g(_d,rp),_d.prototype.decodeUTF8=function(){return new Utf8Iterator(this)},_d}(LazyIterator),Utf8Iterator=function(rp){function _d(np){var ap=rp.call(this)||this;return ap.upstream=np,ap.impl=new Utf8IteratorImpl(np),ap}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.impl.summary()},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return[2,this.impl.next()]})})},_d}(StringIterator),Utf8IteratorImpl=function(rp){function _d(np){var ap=rp.call(this)||this;if(ap.upstream=np,a$1().get("IS_BROWSER"))ap.decoder=new TextDecoder("utf-8");else{var sp=require("string_decoder").StringDecoder;ap.decoder=new sp("utf8")}return ap}return __extends$g(_d,rp),_d.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},_d.prototype.pump=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp;return __generator$6(this,function(lp){switch(lp.label){case 0:return[4,this.upstream.next()];case 1:return(np=lp.sent()).done?[2,!1]:(ap=np.value,sp=a$1().get("IS_BROWSER")?this.decoder.decode(ap,{stream:!0}):this.decoder.write(Buffer.from(ap.buffer)),this.outputQueue.push(sp),[2,!0])}})})},_d}(OneToManyIterator),FileChunkIterator=function(rp){function _d(np,ap){ap===void 0&&(ap={});var sp=rp.call(this)||this;return sp.file=np,sp.options=ap,tt.assert(np instanceof Uint8Array||!!a$1().get("IS_BROWSER")&&(np instanceof File||np instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),sp.offset=ap.offset||0,sp.chunkSize=ap.chunkSize||1048576,sp}return __extends$g(_d,rp),_d.prototype.summary=function(){return"FileChunks "+this.file},_d.prototype.next=function(){return __awaiter$6(this,void 0,void 0,function(){var np,ap,sp=this;return __generator$6(this,function(lp){switch(lp.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(np=new Promise(function(up,cp){var dp=sp.offset+sp.chunkSize;if(sp.file instanceof Uint8Array)up(new Uint8Array(sp.file.slice(sp.offset,dp)));else{var hp=new FileReader;hp.onload=function(pp){var mp=hp.result;if(mp instanceof ArrayBuffer&&(mp=new Uint8Array(mp)),!(mp instanceof Uint8Array))return cp(new TypeError("FileReader returned unknown type."));up(mp)},hp.onabort=function(pp){return cp(new Error("Aborted"))},hp.onerror=function(pp){return cp(new Error(pp.type))};var fp=sp.file.slice(sp.offset,dp);hp.readAsArrayBuffer(fp)}sp.offset=dp}),ap={},[4,np]);case 1:return[2,(ap.value=lp.sent(),ap.done=!1,ap)]}})})},_d}(ByteChunkIterator);function urlChunkIterator(rp,_d){return _d===void 0&&(_d={}),__awaiter$6(this,void 0,void 0,function(){var np,ap,sp,lp,up;return __generator$6(this,function(cp){switch(cp.label){case 0:return typeof rp=="string"?np=rp:(np=rp.url,ap=getRequestInitFromRequest(rp)),[4,tt.fetch(np,ap)];case 1:return(sp=cp.sent()).ok?(up=Uint8Array.bind,[4,sp.arrayBuffer()]):[3,3];case 2:return lp=new(up.apply(Uint8Array,[void 0,cp.sent()])),[2,new FileChunkIterator(lp,_d)];case 3:throw new Error(sp.statusText)}})})}var getRequestInitFromRequest=function(rp){return{method:rp.method,headers:rp.headers,body:rp.body,mode:rp.mode,credentials:rp.credentials,cache:rp.cache,redirect:rp.redirect,referrer:rp.referrer,integrity:rp.integrity}};function isLocalPath(rp){return typeof rp=="string"&&rp.substr(0,7)==="file://"}var FileDataSource=function(rp){function _d(np,ap){ap===void 0&&(ap={});var sp=rp.call(this)||this;return sp.input=np,sp.options=ap,sp}return __extends$g(_d,rp),_d.prototype.iterator=function(){return __awaiter$6(this,void 0,void 0,function(){var np;return __generator$6(this,function(ap){return isLocalPath(this.input)&&a$1().get("IS_NODE")&&(np=require("fs"),this.input=np.readFileSync(this.input.substr(7))),[2,new FileChunkIterator(this.input,this.options)]})})},_d}(DataSource),URLDataSource=function(rp){function _d(np,ap){ap===void 0&&(ap={});var sp=rp.call(this)||this;return sp.url=np,sp.fileOptions=ap,sp}return __extends$g(_d,rp),_d.prototype.iterator=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return isLocalPath(this.url)?[2,new FileDataSource(this.url,this.fileOptions).iterator()]:[2,urlChunkIterator(this.url,this.fileOptions)]})})},_d}(DataSource);function csv(rp,_d){return _d===void 0&&(_d={}),new CSVDataset(new URLDataSource(rp),_d)}function func(rp){var _d=this,np=iteratorFromFunction(rp);return datasetFromIteratorFn(function(){return __awaiter$6(_d,void 0,void 0,function(){return __generator$6(this,function(ap){return[2,np]})})})}function generator(rp){var _d=this;return datasetFromIteratorFn(function(){return __awaiter$6(_d,void 0,void 0,function(){var np;return __generator$6(this,function(ap){switch(ap.label){case 0:return[4,rp()];case 1:return np=ap.sent(),[2,iteratorFromFunction(function(){return np.next()})]}})})})}function webcam$1(rp,_d){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(np){return[2,WebcamIterator.create(rp,_d)]})})}function microphone(rp){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(_d){return[2,MicrophoneIterator.create(rp)]})})}var version$7="1.3.1";const tfData_esm=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset,Dataset,FileDataSource,TextLineDataset,URLDataSource,array,csv,func,generator,microphone,version_data:version$7,webcam:webcam$1,zip},Symbol.toStringTag,{value:"Module"}));var version$6="1.3.1",version$1$1={"tfjs-core":zf,"tfjs-data":version$7,"tfjs-layers":version$9,"tfjs-converter":version$8,tfjs:version$6};const tf_esm=Object.freeze(Object.defineProperty({__proto__:null,AdadeltaOptimizer:qf,AdagradOptimizer:Kf,AdamOptimizer:jf,AdamaxOptimizer:Xf,Callback,CallbackList,CustomCallback,DataStorage:so,get ENV(){return i$3},EarlyStopping,Environment:o,GraphModel,History,InputSpec,KernelBackend:co,LayerVariable,LayersModel,MomentumOptimizer:Yf,Optimizer:Hf,RMSPropOptimizer:Qf,RNN,get Rank(){return vt},get Reduction(){return jl},SGDOptimizer:$f,Sequential,SymbolicTensor,Tensor:dt,TensorBuffer:lt,Variable:bt,abs:Vu,acos:zu,acosh:Gu,add:Vs,addN:zs,addStrict:Gs,all:il,any:ul,argMax:sl,argMin:cl,asin:Hu,asinh:qu,atan:Ku,atan2:Hs,atanh:ju,avgPool:Yc,avgPool3d:Zc,backend:on,backend_util:To,basicLSTMCell:kl,batchNorm:Ns,batchNorm2d:Fs,batchNorm3d:Os,batchNorm4d:_s,batchNormalization:Ts,batchNormalization2d:Ss,batchNormalization3d:As,batchNormalization4d:Ds,batchToSpaceND:cr,booleanMaskAsync:Rc,browser:Nf,buffer:ur,callbacks,cast:lr,ceil:Xu,clipByValue:$u,clone:hr,complex:En,concat:Gn,concat1d:Hn,concat2d:qn,concat3d:Kn,concat4d:jn,constraints:exports_constraints,conv1d:Ac,conv2d:Dc,conv2dTranspose:Pc,conv3d:Tc,conv3dTranspose:Lc,cos:Yu,cosh:Qu,cumsum:fr$1,customGrad:oo,data:tfData_esm,deprecationWarn:ze,depthToSpace:pr,depthwiseConv2d:Oc,deregisterOp,diag:Wl,disableDeprecationWarnings:Ve,dispose:Xe,disposeVariables:Ge,div:qs,divStrict:Ks,dot:Uc,dropout:Ul,elu:gl,enableDebugMode:Ue,enableProdMode:We,engine:He,env:a$1,equal:sc,equalStrict:cc,erf:Ju,exp:Zu,expandDims:dr,expm1:ts,eye:vr,fft:Fl,fill:Ln,findBackend:en,findBackendFactory:nn,floor:es,floorDiv:js,frame:Hl,fused:Eh,gather:Cc,gatherND:Ll,getBackend:Ze,getKernel:s,getKernelsForBackend:c$1,grad:Zr,grads:to,greater:lc,greaterEqual:hc,greaterEqualStrict:fc,greaterStrict:pc,hammingWindow:Gl,hannWindow:zl,ifft:Ol,imag:In,image:vh,inTopKAsync:Xl,initializers:exports_initializers,input,io:Sf,irfft:Ml,isFinite:ps,isInf:fs,isNaN:hs,keep:$e,layers:exports_layers,leakyRelu:yl,less:dc,lessEqual:vc,lessEqualStrict:mc,lessStrict:gc,linalg:sh,linspace:Wn,loadGraphModel,loadLayersModel,localResponseNormalization:Rl,log:ns,log1p:rs,logSigmoid:os,logSoftmax:uo,logSumExp:ll,logicalAnd:Ms,logicalNot:Bs,logicalOr:Ps,logicalXor:Ls,losses:oh,matMul:Wc,math:Df,max:hl,maxPool:$c,maxPool3d:Jc,maximum:Xs,maximumStrict:$s,mean:fl,memory:qe,metrics:exports_metrics,min:pl,minimum:Ys,minimumStrict:Qs,mod:Js,modStrict:Zs,model,models:exports_models,moments:dl,movingAverage:Al,mul:tc,mulStrict:ec,multiRNNCell:Sl,multinomial:mr,neg:as,nextFrame:ep,norm:Il,notEqual:yc,notEqualStrict:xc,oneHot:gr,ones:Bn,onesLike:Vn,op:Cn,outerProduct:Vc,pad:yr,pad1d:xr,pad2d:br,pad3d:wr,pad4d:Cr,pool:Qc,pow:nc,powStrict:rc,prelu:xl,print:sr$1,prod:ml,profile:Ke,rand:Er,randomGamma:Ir,randomNormal:Rr,randomUniform:kr,range:Un,ready:Je,real:Rn,reciprocal:is$1,registerBackend:rn,registerCallbackConstructor,registerKernel:l$1,registerOp,regularizers:exports_regularizers,relu:bl,relu6:wl,removeBackend:tn,reshape:Sr,reverse:zc,reverse1d:Gc,reverse2d:Hc,reverse3d:qc,reverse4d:Kc,rfft:_l,round:us,rsqrt:ss,scalar:An,scatterND:Nl,selu:Cl,separableConv2d:Bc,sequential,serialization:Mf,setBackend:Qe,setPlatform:an,setdiff1dAsync:_r,sigmoid:cs,sign:ls,signal:Kl,sin:ds,sinh:vs,slice:tl,slice1d:el,slice2d:nl,slice3d:rl,slice4d:ol,slice_util:Jr,softmax:io,softplus:ms,spaceToBatchND:Ar,sparseToDense:Pl,spectral:Bl,split:Xn,sqrt:gs,square:Uu,squaredDifference:oc,squaredDifferenceStrict:ac,squeeze:Dr,stack:Tr,step:ys,stft:ql,stridedSlice:Dl,sub:ic,subStrict:uc,sum:vl,tan:xs,tanh:bs,tensor:kn,tensor1d:Dn,tensor2d:Tn,tensor3d:Nn,tensor4d:Fn,tensor5d:On,tensor6d:_n,tensor_util:At,test_util:Vf,tidy:je,tile:Nr,time:Ye,topk:Tl,train:Zf,transpose:El,truncatedNormal:Fr,unregisterKernel:h$1,unsortedSegmentSum:Ec,unstack:Or,util:tt,valueAndGrad:eo,valueAndGrads:no,variable:Mn,variableGrads:ro,version:version$1$1,version_converter:version$8,version_core:zf,version_layers:version$9,webgl:Gf,where:Ws,whereAsync:Us,zeros:Pn,zerosLike:zn},Symbol.toStringTag,{value:"Module"})),require$$0$2=getAugmentedNamespace(tf_esm);var tf$2={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(tf$2,"__esModule",{value:!0});tf$2.cropTensor=tf$2.capture=void 0;var tf$1=require$$0$2;function capture(rp,_d){return tf$1.tidy(function(){var np=tf$1.browser.fromPixels(rp),ap=cropTensor(np,_d),sp=ap.expandDims(0);return sp.toFloat().div(tf$1.scalar(127)).sub(tf$1.scalar(1))})}tf$2.capture=capture;function cropTensor(rp,_d,np){var ap=Math.min(rp.shape[0],rp.shape[1]),sp=rp.shape[0]/2,lp=sp-ap/2,up=rp.shape[1]/2,cp=up-ap/2;if(_d&&!np){var dp=rp.slice([lp,cp,0],[ap,ap,3]);dp=dp.reshape([ap*ap,1,3]);var hp=[.2989,.587,.114];return dp=tf$1.mul(dp,hp),dp=dp.reshape([ap,ap,3]),dp=tf$1.sum(dp,-1),dp=tf$1.expandDims(dp,-1),dp}return rp.slice([lp,cp,0],[ap,ap,3])}tf$2.cropTensor=cropTensor;var canvas={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(canvas,"__esModule",{value:!0});canvas.cropTo=canvas.resizeMinTo=canvas.resizeMaxTo=canvas.resize=void 0;var newCanvas=function(){return document.createElement("canvas")};function resize(rp,_d,np){np===void 0&&(np=newCanvas()),np.width=rp.width*_d,np.height=rp.height*_d;var ap=np.getContext("2d");return ap.drawImage(rp,0,0,np.width,np.height),np}canvas.resize=resize;function resizeMaxTo(rp,_d,np){np===void 0&&(np=newCanvas());var ap=Math.max(rp.width,rp.height);return resize(rp,_d/ap,np)}canvas.resizeMaxTo=resizeMaxTo;function resizeMinTo(rp,_d,np){np===void 0&&(np=newCanvas());var ap=Math.min(rp.width,rp.height);return resize(rp,_d/ap,np)}canvas.resizeMinTo=resizeMinTo;function cropTo(rp,_d,np,ap){np===void 0&&(np=!1),ap===void 0&&(ap=newCanvas());var sp=rp.width,lp=rp.height;rp instanceof HTMLVideoElement&&(sp=rp.videoWidth,lp=rp.videoHeight);var up=Math.min(sp,lp),cp=_d/up,dp=Math.ceil(sp*cp),hp=Math.ceil(lp*cp),fp=dp-_d,pp=hp-_d;ap.width=ap.height=_d;var mp=ap.getContext("2d");return mp.drawImage(rp,~~(fp/2)*-1,~~(pp/2)*-1,dp,hp),np&&(mp.scale(-1,1),mp.drawImage(ap,_d*-1,0)),ap}canvas.cropTo=cropTo;var version$5={};/** @license See the LICENSE file. */Object.defineProperty(version$5,"__esModule",{value:!0});version$5.version=void 0;var version$4="0.8.4-alpha2";version$5.version=version$4;(function(rp){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _d=commonjsGlobal&&commonjsGlobal.__awaiter||function(Tp,Mp,Op,Pp){function $p(zp){return zp instanceof Op?zp:new Op(function(Dp){Dp(zp)})}return new(Op||(Op=Promise))(function(zp,Dp){function Fp(Bp){try{Lp(Pp.next(Bp))}catch(Ip){Dp(Ip)}}function jp(Bp){try{Lp(Pp.throw(Bp))}catch(Ip){Dp(Ip)}}function Lp(Bp){Bp.done?zp(Bp.value):$p(Bp.value).then(Fp,jp)}Lp((Pp=Pp.apply(Tp,Mp||[])).next())})},np=commonjsGlobal&&commonjsGlobal.__generator||function(Tp,Mp){var Op={label:0,sent:function(){if(zp[0]&1)throw zp[1];return zp[1]},trys:[],ops:[]},Pp,$p,zp,Dp;return Dp={next:Fp(0),throw:Fp(1),return:Fp(2)},typeof Symbol=="function"&&(Dp[Symbol.iterator]=function(){return this}),Dp;function Fp(Lp){return function(Bp){return jp([Lp,Bp])}}function jp(Lp){if(Pp)throw new TypeError("Generator is already executing.");for(;Op;)try{if(Pp=1,$p&&(zp=Lp[0]&2?$p.return:Lp[0]?$p.throw||((zp=$p.return)&&zp.call($p),0):$p.next)&&!(zp=zp.call($p,Lp[1])).done)return zp;switch($p=0,zp&&(Lp=[Lp[0]&2,zp.value]),Lp[0]){case 0:case 1:zp=Lp;break;case 4:return Op.label++,{value:Lp[1],done:!1};case 5:Op.label++,$p=Lp[1],Lp=[0];continue;case 7:Lp=Op.ops.pop(),Op.trys.pop();continue;default:if(zp=Op.trys,!(zp=zp.length>0&&zp[zp.length-1])&&(Lp[0]===6||Lp[0]===2)){Op=0;continue}if(Lp[0]===3&&(!zp||Lp[1]>zp[0]&&Lp[1]<zp[3])){Op.label=Lp[1];break}if(Lp[0]===6&&Op.label<zp[1]){Op.label=zp[1],zp=Lp;break}if(zp&&Op.label<zp[2]){Op.label=zp[2],Op.ops.push(Lp);break}zp[2]&&Op.ops.pop(),Op.trys.pop();continue}Lp=Mp.call(Tp,Op)}catch(Bp){Lp=[6,Bp],$p=0}finally{Pp=zp=0}if(Lp[0]&5)throw Lp[1];return{value:Lp[0]?Lp[1]:void 0,done:!0}}};Object.defineProperty(rp,"__esModule",{value:!0}),rp.loadFromFiles=rp.load=rp.loadTruncatedMobileNet=rp.CustomMobileNet=rp.getTopKClasses=rp.IMAGE_SIZE=void 0;var ap=require$$0$2,sp=require$$0$2,lp=tf$2,up=canvas,cp=version$5,dp=1,hp="conv_pw_13_relu",fp="out_relu",pp=.25,mp=.35;rp.IMAGE_SIZE=224;var gp=function(Tp){return Tp.packageVersion=Tp.packageVersion||cp.version,Tp.packageName=Tp.packageName||"@teachablemachine/image",Tp.timeStamp=Tp.timeStamp||new Date().toISOString(),Tp.userMetadata=Tp.userMetadata||{},Tp.modelName=Tp.modelName||"untitled",Tp.labels=Tp.labels||[],Tp.imageSize=Tp.imageSize||rp.IMAGE_SIZE,Tp},yp=function(Tp){return!!Tp&&Array.isArray(Tp.labels)},xp=function(Tp,Mp){if(Tp===1){if(Mp!==.25&&Mp!==.5&&Mp!==.75&&Mp!==1)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",pp.toFixed(2)),pp}else if(Mp!==.35&&Mp!==.5&&Mp!==.75&&Mp!==1)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",mp.toFixed(2)),mp;return Mp},_p=function(Tp){if(Tp=Tp||{},Tp.checkpointUrl&&Tp.trainingLayer)return(Tp.alpha||Tp.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[Tp.checkpointUrl,Tp.trainingLayer];if(Tp.version=Tp.version||dp,Tp.version===1){Tp.alpha=Tp.alpha||pp,Tp.alpha=xp(Tp.version,Tp.alpha),console.log("Loading mobilenet "+Tp.version+" and alpha "+Tp.alpha);var Mp=Tp.alpha.toFixed(2);return Mp==="1.00"&&(Mp="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_"+Mp+"_"+rp.IMAGE_SIZE+"/model.json",hp]}else{if(Tp.version===2)return Tp.alpha=Tp.alpha||mp,Tp.alpha=xp(Tp.version,Tp.alpha),console.log("Loading mobilenet "+Tp.version+" and alpha "+Tp.alpha),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_"+Tp.alpha.toFixed(2)+"_"+rp.IMAGE_SIZE+"_no_top/model.json",fp];throw new Error("MobileNet V"+Tp.version+" doesn't exist")}},vp=function(Tp){return _d(void 0,void 0,void 0,function(){var Mp,Op;return np(this,function(Pp){switch(Pp.label){case 0:return typeof Tp!="string"?[3,3]:[4,fetch(Tp)];case 1:return Op=Pp.sent(),[4,Op.json()];case 2:return Mp=Pp.sent(),[3,4];case 3:if(yp(Tp))Mp=Tp;else throw new Error("Invalid Metadata provided");Pp.label=4;case 4:return[2,gp(Mp)]}})})};function bp(Tp,Mp,Op){return Op===void 0&&(Op=3),_d(this,void 0,void 0,function(){var Pp;return np(this,function($p){switch($p.label){case 0:return[4,Mp.data()];case 1:return Pp=$p.sent(),[2,ap.tidy(function(){Op=Math.min(Op,Pp.length);for(var zp=[],Dp=0;Dp<Pp.length;Dp++)zp.push({value:Pp[Dp],index:Dp});zp.sort(function(Bp,Ip){return Ip.value-Bp.value});for(var Fp=new Float32Array(Op),jp=new Int32Array(Op),Dp=0;Dp<Op;Dp++)Fp[Dp]=zp[Dp].value,jp[Dp]=zp[Dp].index;for(var Lp=[],Dp=0;Dp<jp.length;Dp++)Lp.push({className:Tp[jp[Dp]],probability:Fp[Dp]});return Lp})]}})})}rp.getTopKClasses=bp;var Ep=function(){function Tp(Mp,Op){this.model=Mp,this._metadata=gp(Op)}return Object.defineProperty(Tp,"EXPECTED_IMAGE_SIZE",{get:function(){return rp.IMAGE_SIZE},enumerable:!1,configurable:!0}),Tp.prototype.getMetadata=function(){return this._metadata},Tp.prototype.getTotalClasses=function(){var Mp=this.model.output,Op=Mp.shape[1];return Op},Tp.prototype.getClassLabels=function(){return this._metadata.labels},Tp.prototype.predictTopK=function(Mp,Op,Pp){return Op===void 0&&(Op=10),Pp===void 0&&(Pp=!1),_d(this,void 0,void 0,function(){var $p,zp,Dp,Fp=this;return np(this,function(jp){switch(jp.label){case 0:return $p=up.cropTo(Mp,this._metadata.imageSize,Pp),zp=ap.tidy(function(){var Lp=lp.capture($p,Fp._metadata.grayscale);return Fp.model.predict(Lp)}),[4,bp(this._metadata.labels,zp,Op)];case 1:return Dp=jp.sent(),sp.dispose(zp),[2,Dp]}})})},Tp.prototype.predict=function(Mp,Op){return Op===void 0&&(Op=!1),_d(this,void 0,void 0,function(){var Pp,$p,zp,Dp,Fp,jp=this;return np(this,function(Lp){switch(Lp.label){case 0:return Pp=up.cropTo(Mp,this._metadata.imageSize,Op),$p=ap.tidy(function(){var Bp=lp.capture(Pp,jp._metadata.grayscale);return jp.model.predict(Bp)}),[4,$p.data()];case 1:for(zp=Lp.sent(),Dp=[],Fp=0;Fp<zp.length;Fp++)Dp.push({className:this._metadata.labels[Fp],probability:zp[Fp]});return sp.dispose($p),[2,Dp]}})})},Tp.prototype.dispose=function(){this.truncatedModel.dispose()},Tp}();rp.CustomMobileNet=Ep;function Sp(Tp){return _d(this,void 0,void 0,function(){var Mp,Op,Pp,$p,zp,Dp,Fp,zp,Dp,Fp;return np(this,function(jp){switch(jp.label){case 0:return Mp=_p(Tp),Op=Mp[0],Pp=Mp[1],[4,ap.loadLayersModel(Op)];case 1:return $p=jp.sent(),Tp&&Tp.version===1?(zp=$p.getLayer(Pp),Dp=ap.model({inputs:$p.inputs,outputs:zp.output}),Fp=ap.sequential(),Fp.add(Dp),Fp.add(ap.layers.flatten()),[2,Fp]):(zp=$p.getLayer(Pp),Dp=ap.model({inputs:$p.inputs,outputs:zp.output}),Fp=ap.sequential(),Fp.add(Dp),Fp.add(ap.layers.globalAveragePooling2d({})),[2,Fp])}})})}rp.loadTruncatedMobileNet=Sp;function Ap(Tp,Mp){return _d(this,void 0,void 0,function(){var Op,Pp,$p;return np(this,function(zp){switch(zp.label){case 0:return[4,ap.loadLayersModel(Tp)];case 1:return Op=zp.sent(),Mp?[4,vp(Mp)]:[3,3];case 2:return $p=zp.sent(),[3,4];case 3:$p=null,zp.label=4;case 4:return Pp=$p,[2,new Ep(Op,Pp)]}})})}rp.load=Ap;function Rp(Tp,Mp,Op){return _d(this,void 0,void 0,function(){var Pp,$p,zp,Dp;return np(this,function(Fp){switch(Fp.label){case 0:return[4,ap.loadLayersModel(ap.io.browserFiles([Tp,Mp]))];case 1:return Pp=Fp.sent(),[4,new Response(Op).json()];case 2:return $p=Fp.sent(),Op?[4,vp($p)]:[3,4];case 3:return Dp=Fp.sent(),[3,5];case 4:Dp=null,Fp.label=5;case 5:return zp=Dp,[2,new Ep(Pp,zp)]}})})}rp.loadFromFiles=Rp})(customMobilenet);var teachableMobilenet={},alea$1={exports:{}};alea$1.exports;(function(rp){(function(_d,np,ap){function sp(dp){var hp=this,fp=cp();hp.next=function(){var pp=2091639*hp.s0+hp.c*23283064365386963e-26;return hp.s0=hp.s1,hp.s1=hp.s2,hp.s2=pp-(hp.c=pp|0)},hp.c=1,hp.s0=fp(" "),hp.s1=fp(" "),hp.s2=fp(" "),hp.s0-=fp(dp),hp.s0<0&&(hp.s0+=1),hp.s1-=fp(dp),hp.s1<0&&(hp.s1+=1),hp.s2-=fp(dp),hp.s2<0&&(hp.s2+=1),fp=null}function lp(dp,hp){return hp.c=dp.c,hp.s0=dp.s0,hp.s1=dp.s1,hp.s2=dp.s2,hp}function up(dp,hp){var fp=new sp(dp),pp=hp&&hp.state,mp=fp.next;return mp.int32=function(){return fp.next()*4294967296|0},mp.double=function(){return mp()+(mp()*2097152|0)*11102230246251565e-32},mp.quick=mp,pp&&(typeof pp=="object"&&lp(pp,fp),mp.state=function(){return lp(fp,{})}),mp}function cp(){var dp=4022871197,hp=function(fp){fp=fp.toString();for(var pp=0;pp<fp.length;pp++){dp+=fp.charCodeAt(pp);var mp=.02519603282416938*dp;dp=mp>>>0,mp-=dp,mp*=dp,dp=mp>>>0,mp-=dp,dp+=mp*4294967296}return(dp>>>0)*23283064365386963e-26};return hp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.alea=up})(commonjsGlobal,rp,!1)})(alea$1);var aleaExports=alea$1.exports,xor128$1={exports:{}};xor128$1.exports;(function(rp){(function(_d,np,ap){function sp(cp){var dp=this,hp="";dp.x=0,dp.y=0,dp.z=0,dp.w=0,dp.next=function(){var pp=dp.x^dp.x<<11;return dp.x=dp.y,dp.y=dp.z,dp.z=dp.w,dp.w^=dp.w>>>19^pp^pp>>>8},cp===(cp|0)?dp.x=cp:hp+=cp;for(var fp=0;fp<hp.length+64;fp++)dp.x^=hp.charCodeAt(fp)|0,dp.next()}function lp(cp,dp){return dp.x=cp.x,dp.y=cp.y,dp.z=cp.z,dp.w=cp.w,dp}function up(cp,dp){var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=hp.next()>>>11,gp=(hp.next()>>>0)/4294967296,yp=(mp+gp)/(1<<21);while(yp===0);return yp},pp.int32=hp.next,pp.quick=pp,fp&&(typeof fp=="object"&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.xor128=up})(commonjsGlobal,rp,!1)})(xor128$1);var xor128Exports=xor128$1.exports,xorwow$1={exports:{}};xorwow$1.exports;(function(rp){(function(_d,np,ap){function sp(cp){var dp=this,hp="";dp.next=function(){var pp=dp.x^dp.x>>>2;return dp.x=dp.y,dp.y=dp.z,dp.z=dp.w,dp.w=dp.v,(dp.d=dp.d+362437|0)+(dp.v=dp.v^dp.v<<4^(pp^pp<<1))|0},dp.x=0,dp.y=0,dp.z=0,dp.w=0,dp.v=0,cp===(cp|0)?dp.x=cp:hp+=cp;for(var fp=0;fp<hp.length+64;fp++)dp.x^=hp.charCodeAt(fp)|0,fp==hp.length&&(dp.d=dp.x<<10^dp.x>>>4),dp.next()}function lp(cp,dp){return dp.x=cp.x,dp.y=cp.y,dp.z=cp.z,dp.w=cp.w,dp.v=cp.v,dp.d=cp.d,dp}function up(cp,dp){var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=hp.next()>>>11,gp=(hp.next()>>>0)/4294967296,yp=(mp+gp)/(1<<21);while(yp===0);return yp},pp.int32=hp.next,pp.quick=pp,fp&&(typeof fp=="object"&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.xorwow=up})(commonjsGlobal,rp,!1)})(xorwow$1);var xorwowExports=xorwow$1.exports,xorshift7$1={exports:{}};xorshift7$1.exports;(function(rp){(function(_d,np,ap){function sp(cp){var dp=this;dp.next=function(){var fp=dp.x,pp=dp.i,mp,gp;return mp=fp[pp],mp^=mp>>>7,gp=mp^mp<<24,mp=fp[pp+1&7],gp^=mp^mp>>>10,mp=fp[pp+3&7],gp^=mp^mp>>>3,mp=fp[pp+4&7],gp^=mp^mp<<7,mp=fp[pp+7&7],mp=mp^mp<<13,gp^=mp^mp<<9,fp[pp]=gp,dp.i=pp+1&7,gp};function hp(fp,pp){var mp,gp=[];if(pp===(pp|0))gp[0]=pp;else for(pp=""+pp,mp=0;mp<pp.length;++mp)gp[mp&7]=gp[mp&7]<<15^pp.charCodeAt(mp)+gp[mp+1&7]<<13;for(;gp.length<8;)gp.push(0);for(mp=0;mp<8&&gp[mp]===0;++mp);for(mp==8?gp[7]=-1:gp[mp],fp.x=gp,fp.i=0,mp=256;mp>0;--mp)fp.next()}hp(dp,cp)}function lp(cp,dp){return dp.x=cp.x.slice(),dp.i=cp.i,dp}function up(cp,dp){cp==null&&(cp=+new Date);var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=hp.next()>>>11,gp=(hp.next()>>>0)/4294967296,yp=(mp+gp)/(1<<21);while(yp===0);return yp},pp.int32=hp.next,pp.quick=pp,fp&&(fp.x&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.xorshift7=up})(commonjsGlobal,rp,!1)})(xorshift7$1);var xorshift7Exports=xorshift7$1.exports,xor4096$1={exports:{}};xor4096$1.exports;(function(rp){(function(_d,np,ap){function sp(cp){var dp=this;dp.next=function(){var fp=dp.w,pp=dp.X,mp=dp.i,gp,yp;return dp.w=fp=fp+1640531527|0,yp=pp[mp+34&127],gp=pp[mp=mp+1&127],yp^=yp<<13,gp^=gp<<17,yp^=yp>>>15,gp^=gp>>>12,yp=pp[mp]=yp^gp,dp.i=mp,yp+(fp^fp>>>16)|0};function hp(fp,pp){var mp,gp,yp,xp,_p,vp=[],bp=128;for(pp===(pp|0)?(gp=pp,pp=null):(pp=pp+"\0",gp=0,bp=Math.max(bp,pp.length)),yp=0,xp=-32;xp<bp;++xp)pp&&(gp^=pp.charCodeAt((xp+32)%pp.length)),xp===0&&(_p=gp),gp^=gp<<10,gp^=gp>>>15,gp^=gp<<4,gp^=gp>>>13,xp>=0&&(_p=_p+1640531527|0,mp=vp[xp&127]^=gp+_p,yp=mp==0?yp+1:0);for(yp>=128&&(vp[(pp&&pp.length||0)&127]=-1),yp=127,xp=4*128;xp>0;--xp)gp=vp[yp+34&127],mp=vp[yp=yp+1&127],gp^=gp<<13,mp^=mp<<17,gp^=gp>>>15,mp^=mp>>>12,vp[yp]=gp^mp;fp.w=_p,fp.X=vp,fp.i=yp}hp(dp,cp)}function lp(cp,dp){return dp.i=cp.i,dp.w=cp.w,dp.X=cp.X.slice(),dp}function up(cp,dp){cp==null&&(cp=+new Date);var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=hp.next()>>>11,gp=(hp.next()>>>0)/4294967296,yp=(mp+gp)/(1<<21);while(yp===0);return yp},pp.int32=hp.next,pp.quick=pp,fp&&(fp.X&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.xor4096=up})(commonjsGlobal,rp,!1)})(xor4096$1);var xor4096Exports=xor4096$1.exports,tychei$1={exports:{}};tychei$1.exports;(function(rp){(function(_d,np,ap){function sp(cp){var dp=this,hp="";dp.next=function(){var pp=dp.b,mp=dp.c,gp=dp.d,yp=dp.a;return pp=pp<<25^pp>>>7^mp,mp=mp-gp|0,gp=gp<<24^gp>>>8^yp,yp=yp-pp|0,dp.b=pp=pp<<20^pp>>>12^mp,dp.c=mp=mp-gp|0,dp.d=gp<<16^mp>>>16^yp,dp.a=yp-pp|0},dp.a=0,dp.b=0,dp.c=-1640531527,dp.d=1367130551,cp===Math.floor(cp)?(dp.a=cp/4294967296|0,dp.b=cp|0):hp+=cp;for(var fp=0;fp<hp.length+20;fp++)dp.b^=hp.charCodeAt(fp)|0,dp.next()}function lp(cp,dp){return dp.a=cp.a,dp.b=cp.b,dp.c=cp.c,dp.d=cp.d,dp}function up(cp,dp){var hp=new sp(cp),fp=dp&&dp.state,pp=function(){return(hp.next()>>>0)/4294967296};return pp.double=function(){do var mp=hp.next()>>>11,gp=(hp.next()>>>0)/4294967296,yp=(mp+gp)/(1<<21);while(yp===0);return yp},pp.int32=hp.next,pp.quick=pp,fp&&(typeof fp=="object"&&lp(fp,hp),pp.state=function(){return lp(hp,{})}),pp}np&&np.exports?np.exports=up:ap&&ap.amd?ap(function(){return up}):this.tychei=up})(commonjsGlobal,rp,!1)})(tychei$1);var tycheiExports=tychei$1.exports,seedrandom$2={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(__viteBrowserExternal$1);(function(rp){(function(_d,np){var ap=(0,eval)("this"),sp=256,lp=6,up=52,cp="random",dp=np.pow(sp,lp),hp=np.pow(2,up),fp=hp*2,pp=sp-1,mp;function gp(Sp,Ap,Rp){var Tp=[];Ap=Ap==!0?{entropy:!0}:Ap||{};var Mp=vp(_p(Ap.entropy?[Sp,Ep(_d)]:Sp??bp(),3),Tp),Op=new yp(Tp),Pp=function(){for(var $p=Op.g(lp),zp=dp,Dp=0;$p<hp;)$p=($p+Dp)*sp,zp*=sp,Dp=Op.g(1);for(;$p>=fp;)$p/=2,zp/=2,Dp>>>=1;return($p+Dp)/zp};return Pp.int32=function(){return Op.g(4)|0},Pp.quick=function(){return Op.g(4)/4294967296},Pp.double=Pp,vp(Ep(Op.S),_d),(Ap.pass||Rp||function($p,zp,Dp,Fp){return Fp&&(Fp.S&&xp(Fp,Op),$p.state=function(){return xp(Op,{})}),Dp?(np[cp]=$p,zp):$p})(Pp,Mp,"global"in Ap?Ap.global:this==np,Ap.state)}np["seed"+cp]=gp;function yp(Sp){var Ap,Rp=Sp.length,Tp=this,Mp=0,Op=Tp.i=Tp.j=0,Pp=Tp.S=[];for(Rp||(Sp=[Rp++]);Mp<sp;)Pp[Mp]=Mp++;for(Mp=0;Mp<sp;Mp++)Pp[Mp]=Pp[Op=pp&Op+Sp[Mp%Rp]+(Ap=Pp[Mp])],Pp[Op]=Ap;(Tp.g=function($p){for(var zp,Dp=0,Fp=Tp.i,jp=Tp.j,Lp=Tp.S;$p--;)zp=Lp[Fp=pp&Fp+1],Dp=Dp*sp+Lp[pp&(Lp[Fp]=Lp[jp=pp&jp+zp])+(Lp[jp]=zp)];return Tp.i=Fp,Tp.j=jp,Dp})(sp)}function xp(Sp,Ap){return Ap.i=Sp.i,Ap.j=Sp.j,Ap.S=Sp.S.slice(),Ap}function _p(Sp,Ap){var Rp=[],Tp=typeof Sp,Mp;if(Ap&&Tp=="object")for(Mp in Sp)try{Rp.push(_p(Sp[Mp],Ap-1))}catch{}return Rp.length?Rp:Tp=="string"?Sp:Sp+"\0"}function vp(Sp,Ap){for(var Rp=Sp+"",Tp,Mp=0;Mp<Rp.length;)Ap[pp&Mp]=pp&(Tp^=Ap[pp&Mp]*19)+Rp.charCodeAt(Mp++);return Ep(Ap)}function bp(){try{var Sp;return mp&&(Sp=mp.randomBytes)?Sp=Sp(sp):(Sp=new Uint8Array(sp),(ap.crypto||ap.msCrypto).getRandomValues(Sp)),Ep(Sp)}catch{var Ap=ap.navigator,Rp=Ap&&Ap.plugins;return[+new Date,ap,Rp,ap.screen,Ep(_d)]}}function Ep(Sp){return String.fromCharCode.apply(0,Sp)}if(vp(np.random(),_d),rp.exports){rp.exports=gp;try{mp=require$$0$1}catch{}}})([],Math)})(seedrandom$2);var seedrandomExports=seedrandom$2.exports,alea=aleaExports,xor128=xor128Exports,xorwow=xorwowExports,xorshift7=xorshift7Exports,xor4096=xor4096Exports,tychei=tycheiExports,sr=seedrandomExports;sr.alea=alea;sr.xor128=xor128;sr.xorwow=xorwow;sr.xorshift7=xorshift7;sr.xor4096=xor4096;sr.tychei=tychei;var seedrandom$1=sr;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var __extends$f=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)sp.hasOwnProperty(lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}(),__awaiter$5=commonjsGlobal&&commonjsGlobal.__awaiter||function(rp,_d,np,ap){function sp(lp){return lp instanceof np?lp:new np(function(up){up(lp)})}return new(np||(np=Promise))(function(lp,up){function cp(fp){try{hp(ap.next(fp))}catch(pp){up(pp)}}function dp(fp){try{hp(ap.throw(fp))}catch(pp){up(pp)}}function hp(fp){fp.done?lp(fp.value):sp(fp.value).then(cp,dp)}hp((ap=ap.apply(rp,_d||[])).next())})},__generator$5=commonjsGlobal&&commonjsGlobal.__generator||function(rp,_d){var np={label:0,sent:function(){if(lp[0]&1)throw lp[1];return lp[1]},trys:[],ops:[]},ap,sp,lp,up;return up={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(up[Symbol.iterator]=function(){return this}),up;function cp(hp){return function(fp){return dp([hp,fp])}}function dp(hp){if(ap)throw new TypeError("Generator is already executing.");for(;np;)try{if(ap=1,sp&&(lp=hp[0]&2?sp.return:hp[0]?sp.throw||((lp=sp.return)&&lp.call(sp),0):sp.next)&&!(lp=lp.call(sp,hp[1])).done)return lp;switch(sp=0,lp&&(hp=[hp[0]&2,lp.value]),hp[0]){case 0:case 1:lp=hp;break;case 4:return np.label++,{value:hp[1],done:!1};case 5:np.label++,sp=hp[1],hp=[0];continue;case 7:hp=np.ops.pop(),np.trys.pop();continue;default:if(lp=np.trys,!(lp=lp.length>0&&lp[lp.length-1])&&(hp[0]===6||hp[0]===2)){np=0;continue}if(hp[0]===3&&(!lp||hp[1]>lp[0]&&hp[1]<lp[3])){np.label=hp[1];break}if(hp[0]===6&&np.label<lp[1]){np.label=lp[1],lp=hp;break}if(lp&&np.label<lp[2]){np.label=lp[2],np.ops.push(hp);break}lp[2]&&np.ops.pop(),np.trys.pop();continue}hp=_d.call(rp,np)}catch(fp){hp=[6,fp],sp=0}finally{ap=lp=0}if(hp[0]&5)throw hp[1];return{value:hp[0]?hp[1]:void 0,done:!0}}};Object.defineProperty(teachableMobilenet,"__esModule",{value:!0});teachableMobilenet.createTeachable=teachableMobilenet.TeachableMobileNet=void 0;var tf=require$$0$2,tfjs_1=require$$0$2,tf_1=tf$2,custom_mobilenet_1=customMobilenet,seedrandom=seedrandom$1,VALIDATION_FRACTION=.15,isTensor=function(rp){return typeof rp.dataId=="object"&&typeof rp.shape=="object"};function flatOneHot(rp,_d){var np=new Array(_d).fill(0);return np[rp]=1,np}function fisherYates(rp,_d){for(var np,ap=rp.length,sp=rp.slice(),lp=ap-1;lp>0;lp-=1){var up=void 0;_d?up=Math.floor(_d()*(lp+1)):up=Math.floor(Math.random()*(lp+1)),np=[sp[up],sp[lp]],sp[lp]=np[0],sp[up]=np[1]}return sp}var TeachableMobileNet=function(rp){__extends$f(_d,rp);function _d(np,ap){var sp=rp.call(this,tf.sequential(),ap)||this;return sp.totalSamples=0,sp.examples=[],sp.truncatedModel=np,sp}return Object.defineProperty(_d.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(_d.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(_d.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(_d.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),_d.prototype.addExample=function(np,ap){return __awaiter$5(this,void 0,void 0,function(){var sp,lp,up;return __generator$5(this,function(cp){return sp=isTensor(ap)?ap:tf_1.capture(ap,this._metadata.grayscale),lp=this.truncatedModel.predict(sp),up=lp.dataSync(),sp.dispose(),lp.dispose(),this.examples[np].push(up),this.totalSamples++,[2]})})},_d.prototype.predict=function(np,ap){return ap===void 0&&(ap=!1),__awaiter$5(this,void 0,void 0,function(){return __generator$5(this,function(sp){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,rp.prototype.predict.call(this,np,ap)]})})},_d.prototype.predictTopK=function(np,ap,sp){return ap===void 0&&(ap=10),sp===void 0&&(sp=!1),__awaiter$5(this,void 0,void 0,function(){return __generator$5(this,function(lp){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,rp.prototype.predictTopK.call(this,np,ap,sp)]})})},_d.prototype.prepare=function(){for(var np in this.examples)if(np.length===0)throw new Error("Add some examples before training");var ap=this.convertToTfDataset();this.trainDataset=ap.trainDataset,this.validationDataset=ap.validationDataset},_d.prototype.convertToTfDataset=function(){for(var np=0;np<this.examples.length;np++)this.examples[np]=fisherYates(this.examples[np],this.seed);for(var ap=[],sp=[],lp=function(pp){var mp=flatOneHot(pp,up.numClasses),gp=up.examples[pp].length,yp=Math.ceil(VALIDATION_FRACTION*gp),xp=gp-yp,_p=up.examples[pp].slice(0,xp).map(function(bp){return{data:bp,label:mp}}),vp=up.examples[pp].slice(xp).map(function(bp){return{data:bp,label:mp}});ap=ap.concat(_p),sp=sp.concat(vp)},up=this,np=0;np<this.examples.length;np++)lp(np);ap=fisherYates(ap,this.seed),sp=fisherYates(sp,this.seed);var cp=tf.data.array(ap.map(function(pp){return pp.data})),dp=tf.data.array(sp.map(function(pp){return pp.data})),hp=tf.data.array(ap.map(function(pp){return pp.label})),fp=tf.data.array(sp.map(function(pp){return pp.label}));return{trainDataset:tf.data.zip({xs:cp,ys:hp}),validationDataset:tf.data.zip({xs:dp,ys:fp})}},_d.prototype.save=function(np,ap){return __awaiter$5(this,void 0,void 0,function(){return __generator$5(this,function(sp){return[2,this.model.save(np,ap)]})})},_d.prototype.train=function(np,ap){return ap===void 0&&(ap={}),__awaiter$5(this,void 0,void 0,function(){var sp,lp,up,cp,dp,hp,fp,pp,mp,gp=this;return __generator$5(this,function(yp){switch(yp.label){case 0:if(sp=ap.onTrainEnd||function(){},ap.onTrainEnd=function(xp){gp.__stopTrainingResolve&&(gp.__stopTrainingResolve(),gp.__stopTrainingResolve=null),sp(xp)},this.isPrepared||this.prepare(),lp=this.getLabels().length,tfjs_1.util.assert(lp===this.numClasses,function(){return"Can not train, has "+lp+" labels and "+gp.numClasses+" classes"}),up=this.truncatedModel.outputs[0].shape.slice(1),cp=tf.util.sizeFromShape(up),this.seed?dp=tf.initializers.varianceScaling({seed:3.14}):dp=tf.initializers.varianceScaling({}),this.trainingModel=tf.sequential({layers:[tf.layers.dense({inputShape:[cp],units:np.denseUnits,activation:"relu",kernelInitializer:dp,useBias:!0}),tf.layers.dense({kernelInitializer:dp,useBias:!1,activation:"softmax",units:this.numClasses})]}),hp=tf.train.adam(np.learningRate),this.trainingModel.compile({optimizer:hp,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(np.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return fp=this.trainDataset.batch(np.batchSize),pp=this.validationDataset.batch(np.batchSize),[4,this.trainingModel.fitDataset(fp,{epochs:np.epochs,validationData:pp,callbacks:ap})];case 1:return yp.sent(),mp=tf.sequential(),mp.add(this.truncatedModel),mp.add(this.trainingModel),this.model=mp,hp.dispose(),[2,this.model]}})})},_d.prototype.prepareDataset=function(){for(var np=0;np<this.numClasses;np++)this.examples[np]=[]},_d.prototype.setLabel=function(np,ap){this._metadata.labels[np]=ap},_d.prototype.setLabels=function(np){this._metadata.labels=np,this.prepareDataset()},_d.prototype.getLabel=function(np){return this._metadata.labels[np]},_d.prototype.getLabels=function(){return this._metadata.labels},_d.prototype.setName=function(np){this._metadata.modelName=np},_d.prototype.getName=function(){return this._metadata.modelName},_d.prototype.stopTraining=function(){var np=this,ap=new Promise(function(sp,lp){np.trainingModel.stopTraining=!0,np.__stopTrainingResolve=sp});return ap},_d.prototype.dispose=function(){this.trainingModel.dispose(),rp.prototype.dispose.call(this)},_d.prototype.calculateAccuracyPerClass=function(){return __awaiter$5(this,void 0,void 0,function(){var np,ap,sp,lp,up,cp,dp,hp,fp,pp,Ep,mp,gp,yp,xp,_p,vp,bp,Ep,Sp=this;return __generator$5(this,function(Ap){switch(Ap.label){case 0:return np=this.validationDataset.mapAsync(function(Rp){return __awaiter$5(Sp,void 0,void 0,function(){return __generator$5(this,function(Tp){return[2,Rp.xs]})})}),ap=this.validationDataset.mapAsync(function(Rp){return __awaiter$5(Sp,void 0,void 0,function(){return __generator$5(this,function(Tp){return[2,Rp.ys]})})}),sp=Math.min(ap.size,32),lp=Math.ceil(ap.size/sp),up=np.batch(sp),cp=ap.batch(sp),[4,up.iterator()];case 1:return dp=Ap.sent(),[4,cp.iterator()];case 2:hp=Ap.sent(),fp=[],pp=[],Ep=0,Ap.label=3;case 3:return Ep<lp?[4,dp.next()]:[3,7];case 4:return mp=Ap.sent(),gp=this.trainingModel.predict(mp.value),yp=gp.argMax(1),fp.push(yp),[4,hp.next()];case 5:xp=Ap.sent(),_p=xp.value.argMax(1),pp.push(_p),mp.value.dispose(),gp.dispose(),xp.value.dispose(),Ap.label=6;case 6:return Ep++,[3,3];case 7:if(vp=tf.concat(pp),bp=tf.concat(fp),lp!==1)for(Ep=0;Ep<fp.length;Ep++)fp[Ep].dispose(),pp[Ep].dispose();return[2,{reference:vp,predictions:bp}]}})})},_d.prototype.setSeed=function(np){this.seed=seedrandom(np)},_d}(custom_mobilenet_1.CustomMobileNet);teachableMobilenet.TeachableMobileNet=TeachableMobileNet;function createTeachable(rp,_d){return __awaiter$5(this,void 0,void 0,function(){var np;return __generator$5(this,function(ap){switch(ap.label){case 0:return[4,custom_mobilenet_1.loadTruncatedMobileNet(_d)];case 1:return np=ap.sent(),[2,new TeachableMobileNet(np,rp)]}})})}teachableMobilenet.createTeachable=createTeachable;var webcam={};function _typeof$3(rp){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$3=function(np){return typeof np}:_typeof$3=function(np){return np&&typeof Symbol=="function"&&np.constructor===Symbol&&np!==Symbol.prototype?"symbol":typeof np},_typeof$3(rp)}function boundMethod(rp,_d,np){var ap=np.value;if(typeof ap!="function")throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(_typeof$3(ap)));var sp=!1;return{configurable:!0,get:function(){if(sp||this===rp.prototype||this.hasOwnProperty(_d)||typeof ap!="function")return ap;var up=ap.bind(this);return sp=!0,Object.defineProperty(this,_d,{configurable:!0,get:function(){return up},set:function(dp){ap=dp,delete this[_d]}}),sp=!1,up},set:function(up){ap=up}}}function boundClass(rp){var _d;return typeof Reflect<"u"&&typeof Reflect.ownKeys=="function"?_d=Reflect.ownKeys(rp.prototype):(_d=Object.getOwnPropertyNames(rp.prototype),typeof Object.getOwnPropertySymbols=="function"&&(_d=_d.concat(Object.getOwnPropertySymbols(rp.prototype)))),_d.forEach(function(np){if(np!=="constructor"){var ap=Object.getOwnPropertyDescriptor(rp.prototype,np);typeof ap.value=="function"&&Object.defineProperty(rp.prototype,np,boundMethod(rp,np,ap))}}),rp}function autobind(){return arguments.length===1?boundClass.apply(void 0,arguments):boundMethod.apply(void 0,arguments)}const esm=Object.freeze(Object.defineProperty({__proto__:null,boundClass,boundMethod,default:autobind},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(esm);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var __decorate=commonjsGlobal&&commonjsGlobal.__decorate||function(rp,_d,np,ap){var sp=arguments.length,lp=sp<3?_d:ap===null?ap=Object.getOwnPropertyDescriptor(_d,np):ap,up;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")lp=Reflect.decorate(rp,_d,np,ap);else for(var cp=rp.length-1;cp>=0;cp--)(up=rp[cp])&&(lp=(sp<3?up(lp):sp>3?up(_d,np,lp):up(_d,np))||lp);return sp>3&&lp&&Object.defineProperty(_d,np,lp),lp},__awaiter$4=commonjsGlobal&&commonjsGlobal.__awaiter||function(rp,_d,np,ap){function sp(lp){return lp instanceof np?lp:new np(function(up){up(lp)})}return new(np||(np=Promise))(function(lp,up){function cp(fp){try{hp(ap.next(fp))}catch(pp){up(pp)}}function dp(fp){try{hp(ap.throw(fp))}catch(pp){up(pp)}}function hp(fp){fp.done?lp(fp.value):sp(fp.value).then(cp,dp)}hp((ap=ap.apply(rp,_d||[])).next())})},__generator$4=commonjsGlobal&&commonjsGlobal.__generator||function(rp,_d){var np={label:0,sent:function(){if(lp[0]&1)throw lp[1];return lp[1]},trys:[],ops:[]},ap,sp,lp,up;return up={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(up[Symbol.iterator]=function(){return this}),up;function cp(hp){return function(fp){return dp([hp,fp])}}function dp(hp){if(ap)throw new TypeError("Generator is already executing.");for(;np;)try{if(ap=1,sp&&(lp=hp[0]&2?sp.return:hp[0]?sp.throw||((lp=sp.return)&&lp.call(sp),0):sp.next)&&!(lp=lp.call(sp,hp[1])).done)return lp;switch(sp=0,lp&&(hp=[hp[0]&2,lp.value]),hp[0]){case 0:case 1:lp=hp;break;case 4:return np.label++,{value:hp[1],done:!1};case 5:np.label++,sp=hp[1],hp=[0];continue;case 7:hp=np.ops.pop(),np.trys.pop();continue;default:if(lp=np.trys,!(lp=lp.length>0&&lp[lp.length-1])&&(hp[0]===6||hp[0]===2)){np=0;continue}if(hp[0]===3&&(!lp||hp[1]>lp[0]&&hp[1]<lp[3])){np.label=hp[1];break}if(hp[0]===6&&np.label<lp[1]){np.label=lp[1],lp=hp;break}if(lp&&np.label<lp[2]){np.label=lp[2],np.ops.push(hp);break}lp[2]&&np.ops.pop(),np.trys.pop();continue}hp=_d.call(rp,np)}catch(fp){hp=[6,fp],sp=0}finally{ap=lp=0}if(hp[0]&5)throw hp[1];return{value:hp[0]?hp[1]:void 0,done:!0}}};Object.defineProperty(webcam,"__esModule",{value:!0});webcam.Webcam=void 0;var autobind_decorator_1=require$$0,canvas_1=canvas,defaultVideoOptions={facingMode:"user",frameRate:24},fillConstraints=function(rp){return rp.facingMode=rp.facingMode||defaultVideoOptions.facingMode,rp.frameRate=rp.frameRate||defaultVideoOptions.frameRate,rp.aspectRatio=rp.aspectRatio||defaultVideoOptions.aspectRatio,rp},Webcam=function(){function rp(_d,np,ap){_d===void 0&&(_d=400),np===void 0&&(np=400),ap===void 0&&(ap=!1),this.width=_d,this.height=np,this.flip=ap}return rp.prototype.getWebcam=function(_d){if(_d===void 0&&(_d={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");_d.width=640;var np=fillConstraints(_d),ap=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:np}).then(function(sp){return ap.srcObject=sp,ap.addEventListener("loadedmetadata",function(lp){var up=ap.videoWidth,cp=ap.videoHeight;ap.width=up,ap.height=cp}),ap},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},rp.prototype.setup=function(_d){return _d===void 0&&(_d={}),__awaiter$4(this,void 0,void 0,function(){var np;return __generator$4(this,function(ap){switch(ap.label){case 0:return this.webcam?[3,2]:(np=this,[4,this.getWebcam(_d)]);case 1:np.webcam=ap.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),ap.label=2;case 2:return[2]}})})},rp.prototype.play=function(){var _d=this.webcam.play();return _d},rp.prototype.pause=function(){this.webcam.pause()},rp.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},rp.prototype.update=function(){this.renderCameraToCanvas()},rp.prototype.stopStreamedVideo=function(_d){var np=_d.srcObject,ap=np.getTracks();ap.forEach(function(sp){sp.stop()}),_d.srcObject=null},rp.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var _d=this.canvas.getContext("2d");if(this.webcam.videoWidth!==0){var np=canvas_1.cropTo(this.webcam,this.width,this.flip);_d.drawImage(np,0,0)}}},__decorate([autobind_decorator_1.default],rp.prototype,"getWebcam",null),__decorate([autobind_decorator_1.default],rp.prototype,"setup",null),__decorate([autobind_decorator_1.default],rp.prototype,"play",null),__decorate([autobind_decorator_1.default],rp.prototype,"pause",null),__decorate([autobind_decorator_1.default],rp.prototype,"stop",null),__decorate([autobind_decorator_1.default],rp.prototype,"update",null),__decorate([autobind_decorator_1.default],rp.prototype,"stopStreamedVideo",null),__decorate([autobind_decorator_1.default],rp.prototype,"renderCameraToCanvas",null),rp}();webcam.Webcam=Webcam;(function(rp){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(rp,"__esModule",{value:!0});var _d=customMobilenet;Object.defineProperty(rp,"IMAGE_SIZE",{enumerable:!0,get:function(){return _d.IMAGE_SIZE}}),Object.defineProperty(rp,"CustomMobileNet",{enumerable:!0,get:function(){return _d.CustomMobileNet}}),Object.defineProperty(rp,"load",{enumerable:!0,get:function(){return _d.load}}),Object.defineProperty(rp,"loadFromFiles",{enumerable:!0,get:function(){return _d.loadFromFiles}}),Object.defineProperty(rp,"loadTruncatedMobileNet",{enumerable:!0,get:function(){return _d.loadTruncatedMobileNet}});var np=teachableMobilenet;Object.defineProperty(rp,"TeachableMobileNet",{enumerable:!0,get:function(){return np.TeachableMobileNet}}),Object.defineProperty(rp,"createTeachable",{enumerable:!0,get:function(){return np.createTeachable}});var ap=webcam;Object.defineProperty(rp,"Webcam",{enumerable:!0,get:function(){return ap.Webcam}});var sp=version$5;Object.defineProperty(rp,"version",{enumerable:!0,get:function(){return sp.version}})})(dist$1);const back="/assets/backSymbol-A5W0hIK8.svg",Header=reactExports.memo(({centerText:rp,align:_d="start",filter:np="none",prevPath:ap=-1,headerColor:sp="white"})=>{const lp=useNavigate(),up=()=>lp(ap,{state:ap!==-1&&{data:ap}});return jsxRuntimeExports.jsxs("header",{className:"header",style:{background:sp},children:[jsxRuntimeExports.jsx("img",{src:back,alt:"Back Icon",style:{filter:np},onClick:up}),jsxRuntimeExports.jsx("div",{className:"center-text",style:{justifyContent:_d},children:rp}),jsxRuntimeExports.jsx("div",{className:"header-none"})]})});var dist={},_extends={},_global$1={exports:{}},global$5=_global$1.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=global$5);var _globalExports=_global$1.exports,_core={exports:{}},core$4=_core.exports={version:"2.6.12"};typeof __e=="number"&&(__e=core$4);var _coreExports=_core.exports,_aFunction=function(rp){if(typeof rp!="function")throw TypeError(rp+" is not a function!");return rp},aFunction=_aFunction,_ctx=function(rp,_d,np){if(aFunction(rp),_d===void 0)return rp;switch(np){case 1:return function(ap){return rp.call(_d,ap)};case 2:return function(ap,sp){return rp.call(_d,ap,sp)};case 3:return function(ap,sp,lp){return rp.call(_d,ap,sp,lp)}}return function(){return rp.apply(_d,arguments)}},_objectDp={},_isObject=function(rp){return typeof rp=="object"?rp!==null:typeof rp=="function"},isObject$5=_isObject,_anObject=function(rp){if(!isObject$5(rp))throw TypeError(rp+" is not an object!");return rp},_fails=function(rp){try{return!!rp()}catch{return!0}},_descriptors,hasRequired_descriptors;function require_descriptors(){return hasRequired_descriptors||(hasRequired_descriptors=1,_descriptors=!_fails(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})),_descriptors}var _domCreate,hasRequired_domCreate;function require_domCreate(){if(hasRequired_domCreate)return _domCreate;hasRequired_domCreate=1;var rp=_isObject,_d=_globalExports.document,np=rp(_d)&&rp(_d.createElement);return _domCreate=function(ap){return np?_d.createElement(ap):{}},_domCreate}var _ie8DomDefine,hasRequired_ie8DomDefine;function require_ie8DomDefine(){return hasRequired_ie8DomDefine||(hasRequired_ie8DomDefine=1,_ie8DomDefine=!require_descriptors()&&!_fails(function(){return Object.defineProperty(require_domCreate()("div"),"a",{get:function(){return 7}}).a!=7})),_ie8DomDefine}var isObject$4=_isObject,_toPrimitive$1=function(rp,_d){if(!isObject$4(rp))return rp;var np,ap;if(_d&&typeof(np=rp.toString)=="function"&&!isObject$4(ap=np.call(rp))||typeof(np=rp.valueOf)=="function"&&!isObject$4(ap=np.call(rp))||!_d&&typeof(np=rp.toString)=="function"&&!isObject$4(ap=np.call(rp)))return ap;throw TypeError("Can't convert object to primitive value")},hasRequired_objectDp;function require_objectDp(){if(hasRequired_objectDp)return _objectDp;hasRequired_objectDp=1;var rp=_anObject,_d=require_ie8DomDefine(),np=_toPrimitive$1,ap=Object.defineProperty;return _objectDp.f=require_descriptors()?Object.defineProperty:function(lp,up,cp){if(rp(lp),up=np(up,!0),rp(cp),_d)try{return ap(lp,up,cp)}catch{}if("get"in cp||"set"in cp)throw TypeError("Accessors not supported!");return"value"in cp&&(lp[up]=cp.value),lp},_objectDp}var _propertyDesc=function(rp,_d){return{enumerable:!(rp&1),configurable:!(rp&2),writable:!(rp&4),value:_d}},dP$2=require_objectDp(),createDesc$2=_propertyDesc,_hide=require_descriptors()?function(rp,_d,np){return dP$2.f(rp,_d,createDesc$2(1,np))}:function(rp,_d,np){return rp[_d]=np,rp},hasOwnProperty$2={}.hasOwnProperty,_has=function(rp,_d){return hasOwnProperty$2.call(rp,_d)},global$4=_globalExports,core$3=_coreExports,ctx=_ctx,hide$2=_hide,has$6=_has,PROTOTYPE$2="prototype",$export$7=function(rp,_d,np){var ap=rp&$export$7.F,sp=rp&$export$7.G,lp=rp&$export$7.S,up=rp&$export$7.P,cp=rp&$export$7.B,dp=rp&$export$7.W,hp=sp?core$3:core$3[_d]||(core$3[_d]={}),fp=hp[PROTOTYPE$2],pp=sp?global$4:lp?global$4[_d]:(global$4[_d]||{})[PROTOTYPE$2],mp,gp,yp;sp&&(np=_d);for(mp in np)gp=!ap&&pp&&pp[mp]!==void 0,!(gp&&has$6(hp,mp))&&(yp=gp?pp[mp]:np[mp],hp[mp]=sp&&typeof pp[mp]!="function"?np[mp]:cp&&gp?ctx(yp,global$4):dp&&pp[mp]==yp?function(xp){var _p=function(vp,bp,Ep){if(this instanceof xp){switch(arguments.length){case 0:return new xp;case 1:return new xp(vp);case 2:return new xp(vp,bp)}return new xp(vp,bp,Ep)}return xp.apply(this,arguments)};return _p[PROTOTYPE$2]=xp[PROTOTYPE$2],_p}(yp):up&&typeof yp=="function"?ctx(Function.call,yp):yp,up&&((hp.virtual||(hp.virtual={}))[mp]=yp,rp&$export$7.R&&fp&&!fp[mp]&&hide$2(fp,mp,yp)))};$export$7.F=1;$export$7.G=2;$export$7.S=4;$export$7.P=8;$export$7.B=16;$export$7.W=32;$export$7.U=64;$export$7.R=128;var _export=$export$7,toString$2={}.toString,_cof=function(rp){return toString$2.call(rp).slice(8,-1)},_iobject,hasRequired_iobject;function require_iobject(){if(hasRequired_iobject)return _iobject;hasRequired_iobject=1;var rp=_cof;return _iobject=Object("z").propertyIsEnumerable(0)?Object:function(_d){return rp(_d)=="String"?_d.split(""):Object(_d)},_iobject}var _defined=function(rp){if(rp==null)throw TypeError("Can't call method on  "+rp);return rp},IObject=require_iobject(),defined$2=_defined,_toIobject=function(rp){return IObject(defined$2(rp))},ceil=Math.ceil,floor=Math.floor,_toInteger=function(rp){return isNaN(rp=+rp)?0:(rp>0?floor:ceil)(rp)},toInteger$2=_toInteger,min$1=Math.min,_toLength=function(rp){return rp>0?min$1(toInteger$2(rp),9007199254740991):0},toInteger$1=_toInteger,max=Math.max,min=Math.min,_toAbsoluteIndex=function(rp,_d){return rp=toInteger$1(rp),rp<0?max(rp+_d,0):min(rp,_d)},toIObject$5=_toIobject,toLength=_toLength,toAbsoluteIndex=_toAbsoluteIndex,_arrayIncludes=function(rp){return function(_d,np,ap){var sp=toIObject$5(_d),lp=toLength(sp.length),up=toAbsoluteIndex(ap,lp),cp;if(rp&&np!=np){for(;lp>up;)if(cp=sp[up++],cp!=cp)return!0}else for(;lp>up;up++)if((rp||up in sp)&&sp[up]===np)return rp||up||0;return!rp&&-1}},_shared={exports:{}},_library=!0,core$2=_coreExports,global$3=_globalExports,SHARED="__core-js_shared__",store$1=global$3[SHARED]||(global$3[SHARED]={});(_shared.exports=function(rp,_d){return store$1[rp]||(store$1[rp]=_d!==void 0?_d:{})})("versions",[]).push({version:core$2.version,mode:"pure",copyright:" 2020 Denis Pushkarev (zloirock.ru)"});var _sharedExports=_shared.exports,id$1=0,px$1=Math.random(),_uid=function(rp){return"Symbol(".concat(rp===void 0?"":rp,")_",(++id$1+px$1).toString(36))},shared$1=_sharedExports("keys"),uid$2=_uid,_sharedKey=function(rp){return shared$1[rp]||(shared$1[rp]=uid$2(rp))},has$5=_has,toIObject$4=_toIobject,arrayIndexOf=_arrayIncludes(!1),IE_PROTO$2=_sharedKey("IE_PROTO"),_objectKeysInternal=function(rp,_d){var np=toIObject$4(rp),ap=0,sp=[],lp;for(lp in np)lp!=IE_PROTO$2&&has$5(np,lp)&&sp.push(lp);for(;_d.length>ap;)has$5(np,lp=_d[ap++])&&(~arrayIndexOf(sp,lp)||sp.push(lp));return sp},_enumBugKeys="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),$keys$1=_objectKeysInternal,enumBugKeys$1=_enumBugKeys,_objectKeys=Object.keys||function(_d){return $keys$1(_d,enumBugKeys$1)},_objectGops={};_objectGops.f=Object.getOwnPropertySymbols;var _objectPie={},hasRequired_objectPie;function require_objectPie(){return hasRequired_objectPie||(hasRequired_objectPie=1,_objectPie.f={}.propertyIsEnumerable),_objectPie}var defined$1=_defined,_toObject=function(rp){return Object(defined$1(rp))},_objectAssign,hasRequired_objectAssign;function require_objectAssign(){if(hasRequired_objectAssign)return _objectAssign;hasRequired_objectAssign=1;var rp=require_descriptors(),_d=_objectKeys,np=_objectGops,ap=require_objectPie(),sp=_toObject,lp=require_iobject(),up=Object.assign;return _objectAssign=!up||_fails(function(){var cp={},dp={},hp=Symbol(),fp="abcdefghijklmnopqrst";return cp[hp]=7,fp.split("").forEach(function(pp){dp[pp]=pp}),up({},cp)[hp]!=7||Object.keys(up({},dp)).join("")!=fp})?function(dp,hp){for(var fp=sp(dp),pp=arguments.length,mp=1,gp=np.f,yp=ap.f;pp>mp;)for(var xp=lp(arguments[mp++]),_p=gp?_d(xp).concat(gp(xp)):_d(xp),vp=_p.length,bp=0,Ep;vp>bp;)Ep=_p[bp++],(!rp||yp.call(xp,Ep))&&(fp[Ep]=xp[Ep]);return fp}:up,_objectAssign}var $export$6=_export;$export$6($export$6.S+$export$6.F,"Object",{assign:require_objectAssign()});var assign$2=_coreExports.Object.assign,assign$1={default:assign$2,__esModule:!0};_extends.__esModule=!0;var _assign=assign$1,_assign2=_interopRequireDefault$H(_assign);function _interopRequireDefault$H(rp){return rp&&rp.__esModule?rp:{default:rp}}_extends.default=_assign2.default||function(rp){for(var _d=1;_d<arguments.length;_d++){var np=arguments[_d];for(var ap in np)Object.prototype.hasOwnProperty.call(np,ap)&&(rp[ap]=np[ap])}return rp};var has$4=_has,toObject$2=_toObject,IE_PROTO$1=_sharedKey("IE_PROTO"),ObjectProto$1=Object.prototype,_objectGpo=Object.getPrototypeOf||function(rp){return rp=toObject$2(rp),has$4(rp,IE_PROTO$1)?rp[IE_PROTO$1]:typeof rp.constructor=="function"&&rp instanceof rp.constructor?rp.constructor.prototype:rp instanceof Object?ObjectProto$1:null},$export$5=_export,core$1=_coreExports,fails=_fails,_objectSap=function(rp,_d){var np=(core$1.Object||{})[rp]||Object[rp],ap={};ap[rp]=_d(np),$export$5($export$5.S+$export$5.F*fails(function(){np(1)}),"Object",ap)},toObject$1=_toObject,$getPrototypeOf=_objectGpo;_objectSap("getPrototypeOf",function(){return function(_d){return $getPrototypeOf(toObject$1(_d))}});var getPrototypeOf$3=_coreExports.Object.getPrototypeOf,getPrototypeOf$2={default:getPrototypeOf$3,__esModule:!0},classCallCheck={};classCallCheck.__esModule=!0;classCallCheck.default=function(rp,_d){if(!(rp instanceof _d))throw new TypeError("Cannot call a class as a function")};var createClass={},$export$4=_export;$export$4($export$4.S+$export$4.F*!require_descriptors(),"Object",{defineProperty:require_objectDp().f});var $Object$1=_coreExports.Object,defineProperty$2=function(_d,np,ap){return $Object$1.defineProperty(_d,np,ap)},defineProperty$1={default:defineProperty$2,__esModule:!0};createClass.__esModule=!0;var _defineProperty$2=defineProperty$1,_defineProperty2=_interopRequireDefault$G(_defineProperty$2);function _interopRequireDefault$G(rp){return rp&&rp.__esModule?rp:{default:rp}}createClass.default=function(){function rp(_d,np){for(var ap=0;ap<np.length;ap++){var sp=np[ap];sp.enumerable=sp.enumerable||!1,sp.configurable=!0,"value"in sp&&(sp.writable=!0),(0,_defineProperty2.default)(_d,sp.key,sp)}}return function(_d,np,ap){return np&&rp(_d.prototype,np),ap&&rp(_d,ap),_d}}();var possibleConstructorReturn={},_typeof$2={},toInteger=_toInteger,defined=_defined,_stringAt=function(rp){return function(_d,np){var ap=String(defined(_d)),sp=toInteger(np),lp=ap.length,up,cp;return sp<0||sp>=lp?rp?"":void 0:(up=ap.charCodeAt(sp),up<55296||up>56319||sp+1===lp||(cp=ap.charCodeAt(sp+1))<56320||cp>57343?rp?ap.charAt(sp):up:rp?ap.slice(sp,sp+2):(up-55296<<10)+(cp-56320)+65536)}},_redefine=_hide,_iterators={},dP$1=require_objectDp(),anObject$2=_anObject,getKeys$1=_objectKeys,_objectDps=require_descriptors()?Object.defineProperties:function(_d,np){anObject$2(_d);for(var ap=getKeys$1(np),sp=ap.length,lp=0,up;sp>lp;)dP$1.f(_d,up=ap[lp++],np[up]);return _d},_html,hasRequired_html;function require_html(){if(hasRequired_html)return _html;hasRequired_html=1;var rp=_globalExports.document;return _html=rp&&rp.documentElement,_html}var anObject$1=_anObject,dPs=_objectDps,enumBugKeys=_enumBugKeys,IE_PROTO=_sharedKey("IE_PROTO"),Empty=function(){},PROTOTYPE$1="prototype",createDict=function(){var rp=require_domCreate()("iframe"),_d=enumBugKeys.length,np="<",ap=">",sp;for(rp.style.display="none",require_html().appendChild(rp),rp.src="javascript:",sp=rp.contentWindow.document,sp.open(),sp.write(np+"script"+ap+"document.F=Object"+np+"/script"+ap),sp.close(),createDict=sp.F;_d--;)delete createDict[PROTOTYPE$1][enumBugKeys[_d]];return createDict()},_objectCreate=Object.create||function(_d,np){var ap;return _d!==null?(Empty[PROTOTYPE$1]=anObject$1(_d),ap=new Empty,Empty[PROTOTYPE$1]=null,ap[IE_PROTO]=_d):ap=createDict(),np===void 0?ap:dPs(ap,np)},_wks={exports:{}},store=_sharedExports("wks"),uid$1=_uid,Symbol$1=_globalExports.Symbol,USE_SYMBOL=typeof Symbol$1=="function",$exports=_wks.exports=function(rp){return store[rp]||(store[rp]=USE_SYMBOL&&Symbol$1[rp]||(USE_SYMBOL?Symbol$1:uid$1)("Symbol."+rp))};$exports.store=store;var _wksExports=_wks.exports,def=require_objectDp().f,has$3=_has,TAG=_wksExports("toStringTag"),_setToStringTag=function(rp,_d,np){rp&&!has$3(rp=np?rp:rp.prototype,TAG)&&def(rp,TAG,{configurable:!0,value:_d})},create$4=_objectCreate,descriptor=_propertyDesc,setToStringTag$2=_setToStringTag,IteratorPrototype={};_hide(IteratorPrototype,_wksExports("iterator"),function(){return this});var _iterCreate=function(rp,_d,np){rp.prototype=create$4(IteratorPrototype,{next:descriptor(1,np)}),setToStringTag$2(rp,_d+" Iterator")},$export$3=_export,redefine$1=_redefine,hide$1=_hide,Iterators$2=_iterators,$iterCreate=_iterCreate,setToStringTag$1=_setToStringTag,getPrototypeOf$1=_objectGpo,ITERATOR=_wksExports("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values",returnThis=function(){return this},_iterDefine=function(rp,_d,np,ap,sp,lp,up){$iterCreate(np,_d,ap);var cp=function(Ep){if(!BUGGY&&Ep in pp)return pp[Ep];switch(Ep){case KEYS:return function(){return new np(this,Ep)};case VALUES:return function(){return new np(this,Ep)}}return function(){return new np(this,Ep)}},dp=_d+" Iterator",hp=sp==VALUES,fp=!1,pp=rp.prototype,mp=pp[ITERATOR]||pp[FF_ITERATOR]||sp&&pp[sp],gp=mp||cp(sp),yp=sp?hp?cp("entries"):gp:void 0,xp=_d=="Array"&&pp.entries||mp,_p,vp,bp;if(xp&&(bp=getPrototypeOf$1(xp.call(new rp)),bp!==Object.prototype&&bp.next&&setToStringTag$1(bp,dp,!0)),hp&&mp&&mp.name!==VALUES&&(fp=!0,gp=function(){return mp.call(this)}),up&&(BUGGY||fp||!pp[ITERATOR])&&hide$1(pp,ITERATOR,gp),Iterators$2[_d]=gp,Iterators$2[dp]=returnThis,sp)if(_p={values:hp?gp:cp(VALUES),keys:lp?gp:cp(KEYS),entries:yp},up)for(vp in _p)vp in pp||redefine$1(pp,vp,_p[vp]);else $export$3($export$3.P+$export$3.F*(BUGGY||fp),_d,_p);return _p},$at=_stringAt(!0);_iterDefine(String,"String",function(rp){this._t=String(rp),this._i=0},function(){var rp=this._t,_d=this._i,np;return _d>=rp.length?{value:void 0,done:!0}:(np=$at(rp,_d),this._i+=np.length,{value:np,done:!1})});var _iterStep=function(rp,_d){return{value:_d,done:!!rp}},step=_iterStep,Iterators$1=_iterators,toIObject$3=_toIobject;_iterDefine(Array,"Array",function(rp,_d){this._t=toIObject$3(rp),this._i=0,this._k=_d},function(){var rp=this._t,_d=this._k,np=this._i++;return!rp||np>=rp.length?(this._t=void 0,step(1)):_d=="keys"?step(0,np):_d=="values"?step(0,rp[np]):step(0,[np,rp[np]])},"values");Iterators$1.Arguments=Iterators$1.Array;var global$2=_globalExports,hide=_hide,Iterators=_iterators,TO_STRING_TAG=_wksExports("toStringTag"),DOMIterables="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(",");for(var i$2=0;i$2<DOMIterables.length;i$2++){var NAME=DOMIterables[i$2],Collection=global$2[NAME],proto=Collection&&Collection.prototype;proto&&!proto[TO_STRING_TAG]&&hide(proto,TO_STRING_TAG,NAME),Iterators[NAME]=Iterators.Array}var _wksExt={};_wksExt.f=_wksExports;var iterator$1=_wksExt.f("iterator"),iterator={default:iterator$1,__esModule:!0},_meta={exports:{}},META$1=_uid("meta"),isObject$3=_isObject,has$2=_has,setDesc=require_objectDp().f,id=0,isExtensible=Object.isExtensible||function(){return!0},FREEZE=!_fails(function(){return isExtensible(Object.preventExtensions({}))}),setMeta=function(rp){setDesc(rp,META$1,{value:{i:"O"+ ++id,w:{}}})},fastKey=function(rp,_d){if(!isObject$3(rp))return typeof rp=="symbol"?rp:(typeof rp=="string"?"S":"P")+rp;if(!has$2(rp,META$1)){if(!isExtensible(rp))return"F";if(!_d)return"E";setMeta(rp)}return rp[META$1].i},getWeak=function(rp,_d){if(!has$2(rp,META$1)){if(!isExtensible(rp))return!0;if(!_d)return!1;setMeta(rp)}return rp[META$1].w},onFreeze=function(rp){return FREEZE&&meta.NEED&&isExtensible(rp)&&!has$2(rp,META$1)&&setMeta(rp),rp},meta=_meta.exports={KEY:META$1,NEED:!1,fastKey,getWeak,onFreeze},_metaExports=_meta.exports,core=_coreExports,wksExt$1=_wksExt,defineProperty=require_objectDp().f,_wksDefine=function(rp){var _d=core.Symbol||(core.Symbol={});rp.charAt(0)!="_"&&!(rp in _d)&&defineProperty(_d,rp,{value:wksExt$1.f(rp)})},getKeys=_objectKeys,gOPS=_objectGops,pIE$1=require_objectPie(),_enumKeys=function(rp){var _d=getKeys(rp),np=gOPS.f;if(np)for(var ap=np(rp),sp=pIE$1.f,lp=0,up;ap.length>lp;)sp.call(rp,up=ap[lp++])&&_d.push(up);return _d},cof=_cof,_isArray=Array.isArray||function(_d){return cof(_d)=="Array"},_objectGopnExt={},_objectGopn={},hasRequired_objectGopn;function require_objectGopn(){if(hasRequired_objectGopn)return _objectGopn;hasRequired_objectGopn=1;var rp=_objectKeysInternal,_d=_enumBugKeys.concat("length","prototype");return _objectGopn.f=Object.getOwnPropertyNames||function(ap){return rp(ap,_d)},_objectGopn}var toIObject$2=_toIobject,gOPN$1=require_objectGopn().f,toString$1={}.toString,windowNames=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(rp){try{return gOPN$1(rp)}catch{return windowNames.slice()}};_objectGopnExt.f=function(_d){return windowNames&&toString$1.call(_d)=="[object Window]"?getWindowNames(_d):gOPN$1(toIObject$2(_d))};var _objectGopd={},pIE=require_objectPie(),createDesc$1=_propertyDesc,toIObject$1=_toIobject,toPrimitive$1=_toPrimitive$1,has$1=_has,IE8_DOM_DEFINE=require_ie8DomDefine(),gOPD$1=Object.getOwnPropertyDescriptor;_objectGopd.f=require_descriptors()?gOPD$1:function(_d,np){if(_d=toIObject$1(_d),np=toPrimitive$1(np,!0),IE8_DOM_DEFINE)try{return gOPD$1(_d,np)}catch{}if(has$1(_d,np))return createDesc$1(!pIE.f.call(_d,np),_d[np])};var global$1=_globalExports,has=_has,DESCRIPTORS=require_descriptors(),$export$2=_export,redefine=_redefine,META=_metaExports.KEY,$fails=_fails,shared=_sharedExports,setToStringTag=_setToStringTag,uid=_uid,wks=_wksExports,wksExt=_wksExt,wksDefine=_wksDefine,enumKeys=_enumKeys,isArray$1=_isArray,anObject=_anObject,isObject$2=_isObject,toObject=_toObject,toIObject=_toIobject,toPrimitive=_toPrimitive$1,createDesc=_propertyDesc,_create$1=_objectCreate,gOPNExt=_objectGopnExt,$GOPD=_objectGopd,$GOPS=_objectGops,$DP=require_objectDp(),$keys=_objectKeys,gOPD=$GOPD.f,dP=$DP.f,gOPN=gOPNExt.f,$Symbol=global$1.Symbol,$JSON=global$1.JSON,_stringify$3=$JSON&&$JSON.stringify,PROTOTYPE="prototype",HIDDEN=wks("_hidden"),TO_PRIMITIVE=wks("toPrimitive"),isEnum={}.propertyIsEnumerable,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),OPSymbols=shared("op-symbols"),ObjectProto=Object[PROTOTYPE],USE_NATIVE=typeof $Symbol=="function"&&!!$GOPS.f,QObject=global$1.QObject,setter=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild,setSymbolDesc=DESCRIPTORS&&$fails(function(){return _create$1(dP({},"a",{get:function(){return dP(this,"a",{value:7}).a}})).a!=7})?function(rp,_d,np){var ap=gOPD(ObjectProto,_d);ap&&delete ObjectProto[_d],dP(rp,_d,np),ap&&rp!==ObjectProto&&dP(ObjectProto,_d,ap)}:dP,wrap=function(rp){var _d=AllSymbols[rp]=_create$1($Symbol[PROTOTYPE]);return _d._k=rp,_d},isSymbol=USE_NATIVE&&typeof $Symbol.iterator=="symbol"?function(rp){return typeof rp=="symbol"}:function(rp){return rp instanceof $Symbol},$defineProperty=function(_d,np,ap){return _d===ObjectProto&&$defineProperty(OPSymbols,np,ap),anObject(_d),np=toPrimitive(np,!0),anObject(ap),has(AllSymbols,np)?(ap.enumerable?(has(_d,HIDDEN)&&_d[HIDDEN][np]&&(_d[HIDDEN][np]=!1),ap=_create$1(ap,{enumerable:createDesc(0,!1)})):(has(_d,HIDDEN)||dP(_d,HIDDEN,createDesc(1,{})),_d[HIDDEN][np]=!0),setSymbolDesc(_d,np,ap)):dP(_d,np,ap)},$defineProperties=function(_d,np){anObject(_d);for(var ap=enumKeys(np=toIObject(np)),sp=0,lp=ap.length,up;lp>sp;)$defineProperty(_d,up=ap[sp++],np[up]);return _d},$create=function(_d,np){return np===void 0?_create$1(_d):$defineProperties(_create$1(_d),np)},$propertyIsEnumerable=function(_d){var np=isEnum.call(this,_d=toPrimitive(_d,!0));return this===ObjectProto&&has(AllSymbols,_d)&&!has(OPSymbols,_d)?!1:np||!has(this,_d)||!has(AllSymbols,_d)||has(this,HIDDEN)&&this[HIDDEN][_d]?np:!0},$getOwnPropertyDescriptor=function(_d,np){if(_d=toIObject(_d),np=toPrimitive(np,!0),!(_d===ObjectProto&&has(AllSymbols,np)&&!has(OPSymbols,np))){var ap=gOPD(_d,np);return ap&&has(AllSymbols,np)&&!(has(_d,HIDDEN)&&_d[HIDDEN][np])&&(ap.enumerable=!0),ap}},$getOwnPropertyNames=function(_d){for(var np=gOPN(toIObject(_d)),ap=[],sp=0,lp;np.length>sp;)!has(AllSymbols,lp=np[sp++])&&lp!=HIDDEN&&lp!=META&&ap.push(lp);return ap},$getOwnPropertySymbols=function(_d){for(var np=_d===ObjectProto,ap=gOPN(np?OPSymbols:toIObject(_d)),sp=[],lp=0,up;ap.length>lp;)has(AllSymbols,up=ap[lp++])&&(!np||has(ObjectProto,up))&&sp.push(AllSymbols[up]);return sp};USE_NATIVE||($Symbol=function(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var _d=uid(arguments.length>0?arguments[0]:void 0),np=function(ap){this===ObjectProto&&np.call(OPSymbols,ap),has(this,HIDDEN)&&has(this[HIDDEN],_d)&&(this[HIDDEN][_d]=!1),setSymbolDesc(this,_d,createDesc(1,ap))};return DESCRIPTORS&&setter&&setSymbolDesc(ObjectProto,_d,{configurable:!0,set:np}),wrap(_d)},redefine($Symbol[PROTOTYPE],"toString",function(){return this._k}),$GOPD.f=$getOwnPropertyDescriptor,$DP.f=$defineProperty,require_objectGopn().f=gOPNExt.f=$getOwnPropertyNames,require_objectPie().f=$propertyIsEnumerable,$GOPS.f=$getOwnPropertySymbols,DESCRIPTORS&&!_library&&redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable),wksExt.f=function(rp){return wrap(wks(rp))});$export$2($export$2.G+$export$2.W+$export$2.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),j=0;es6Symbols.length>j;)wks(es6Symbols[j++]);for(var wellKnownSymbols=$keys(wks.store),k=0;wellKnownSymbols.length>k;)wksDefine(wellKnownSymbols[k++]);$export$2($export$2.S+$export$2.F*!USE_NATIVE,"Symbol",{for:function(rp){return has(SymbolRegistry,rp+="")?SymbolRegistry[rp]:SymbolRegistry[rp]=$Symbol(rp)},keyFor:function(_d){if(!isSymbol(_d))throw TypeError(_d+" is not a symbol!");for(var np in SymbolRegistry)if(SymbolRegistry[np]===_d)return np},useSetter:function(){setter=!0},useSimple:function(){setter=!1}});$export$2($export$2.S+$export$2.F*!USE_NATIVE,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});var FAILS_ON_PRIMITIVES=$fails(function(){$GOPS.f(1)});$export$2($export$2.S+$export$2.F*FAILS_ON_PRIMITIVES,"Object",{getOwnPropertySymbols:function(_d){return $GOPS.f(toObject(_d))}});$JSON&&$export$2($export$2.S+$export$2.F*(!USE_NATIVE||$fails(function(){var rp=$Symbol();return _stringify$3([rp])!="[null]"||_stringify$3({a:rp})!="{}"||_stringify$3(Object(rp))!="{}"})),"JSON",{stringify:function(_d){for(var np=[_d],ap=1,sp,lp;arguments.length>ap;)np.push(arguments[ap++]);if(lp=sp=np[1],!(!isObject$2(sp)&&_d===void 0||isSymbol(_d)))return isArray$1(sp)||(sp=function(up,cp){if(typeof lp=="function"&&(cp=lp.call(this,up,cp)),!isSymbol(cp))return cp}),np[1]=sp,_stringify$3.apply($JSON,np)}});$Symbol[PROTOTYPE][TO_PRIMITIVE]||_hide($Symbol[PROTOTYPE],TO_PRIMITIVE,$Symbol[PROTOTYPE].valueOf);setToStringTag($Symbol,"Symbol");setToStringTag(Math,"Math",!0);setToStringTag(global$1.JSON,"JSON",!0);_wksDefine("asyncIterator");_wksDefine("observable");var symbol$1=_coreExports.Symbol,symbol={default:symbol$1,__esModule:!0};_typeof$2.__esModule=!0;var _iterator=iterator,_iterator2=_interopRequireDefault$F(_iterator),_symbol=symbol,_symbol2=_interopRequireDefault$F(_symbol),_typeof$1=typeof _symbol2.default=="function"&&typeof _iterator2.default=="symbol"?function(rp){return typeof rp}:function(rp){return rp&&typeof _symbol2.default=="function"&&rp.constructor===_symbol2.default&&rp!==_symbol2.default.prototype?"symbol":typeof rp};function _interopRequireDefault$F(rp){return rp&&rp.__esModule?rp:{default:rp}}_typeof$2.default=typeof _symbol2.default=="function"&&_typeof$1(_iterator2.default)==="symbol"?function(rp){return typeof rp>"u"?"undefined":_typeof$1(rp)}:function(rp){return rp&&typeof _symbol2.default=="function"&&rp.constructor===_symbol2.default&&rp!==_symbol2.default.prototype?"symbol":typeof rp>"u"?"undefined":_typeof$1(rp)};possibleConstructorReturn.__esModule=!0;var _typeof2$1=_typeof$2,_typeof3$1=_interopRequireDefault$E(_typeof2$1);function _interopRequireDefault$E(rp){return rp&&rp.__esModule?rp:{default:rp}}possibleConstructorReturn.default=function(rp,_d){if(!rp)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _d&&((typeof _d>"u"?"undefined":(0,_typeof3$1.default)(_d))==="object"||typeof _d=="function")?_d:rp};var inherits$1={},_setProto,hasRequired_setProto;function require_setProto(){if(hasRequired_setProto)return _setProto;hasRequired_setProto=1;var rp=_isObject,_d=_anObject,np=function(ap,sp){if(_d(ap),!rp(sp)&&sp!==null)throw TypeError(sp+": can't set as prototype!")};return _setProto={set:Object.setPrototypeOf||("__proto__"in{}?function(ap,sp,lp){try{lp=_ctx(Function.call,_objectGopd.f(Object.prototype,"__proto__").set,2),lp(ap,[]),sp=!(ap instanceof Array)}catch{sp=!0}return function(cp,dp){return np(cp,dp),sp?cp.__proto__=dp:lp(cp,dp),cp}}({},!1):void 0),check:np},_setProto}var $export$1=_export;$export$1($export$1.S,"Object",{setPrototypeOf:require_setProto().set});var setPrototypeOf$1=_coreExports.Object.setPrototypeOf,setPrototypeOf={default:setPrototypeOf$1,__esModule:!0},$export=_export;$export($export.S,"Object",{create:_objectCreate});var $Object=_coreExports.Object,create$3=function(_d,np){return $Object.create(_d,np)},create$2={default:create$3,__esModule:!0};inherits$1.__esModule=!0;var _setPrototypeOf=setPrototypeOf,_setPrototypeOf2=_interopRequireDefault$D(_setPrototypeOf),_create=create$2,_create2=_interopRequireDefault$D(_create),_typeof2=_typeof$2,_typeof3=_interopRequireDefault$D(_typeof2);function _interopRequireDefault$D(rp){return rp&&rp.__esModule?rp:{default:rp}}inherits$1.default=function(rp,_d){if(typeof _d!="function"&&_d!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof _d>"u"?"undefined":(0,_typeof3.default)(_d)));rp.prototype=(0,_create2.default)(_d&&_d.prototype,{constructor:{value:rp,enumerable:!1,writable:!0,configurable:!0}}),_d&&(_setPrototypeOf2.default?(0,_setPrototypeOf2.default)(rp,_d):rp.__proto__=_d)};var lottie={exports:{}};(function(module,exports){typeof navigator<"u"&&function(rp,_d){module.exports=_d()}(commonjsGlobal,function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(_d){_useWebWorker=!!_d},getWebWorker=function(){return _useWebWorker},setLocationHref=function(_d){locationHref=_d},getLocationHref=function(){return locationHref};function createTag(rp){return document.createElement(rp)}function extendPrototype(rp,_d){var np,ap=rp.length,sp;for(np=0;np<ap;np+=1){sp=rp[np].prototype;for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(_d.prototype[lp]=sp[lp])}}function getDescriptor(rp,_d){return Object.getOwnPropertyDescriptor(rp,_d)}function createProxyFunction(rp){function _d(){}return _d.prototype=rp,_d}var audioControllerFactory=function(){function rp(_d){this.audios=[],this.audioFactory=_d,this._volume=1,this._isMuted=!1}return rp.prototype={addAudio:function(np){this.audios.push(np)},pause:function(){var np,ap=this.audios.length;for(np=0;np<ap;np+=1)this.audios[np].pause()},resume:function(){var np,ap=this.audios.length;for(np=0;np<ap;np+=1)this.audios[np].resume()},setRate:function(np){var ap,sp=this.audios.length;for(ap=0;ap<sp;ap+=1)this.audios[ap].setRate(np)},createAudio:function(np){return this.audioFactory?this.audioFactory(np):window.Howl?new window.Howl({src:[np]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(np){this.audioFactory=np},setVolume:function(np){this._volume=np,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var np,ap=this.audios.length;for(np=0;np<ap;np+=1)this.audios[np].volume(this._volume*(this._isMuted?0:1))}},function(){return new rp}}(),createTypedArray=function(){function rp(np,ap){var sp=0,lp=[],up;switch(np){case"int16":case"uint8c":up=1;break;default:up=1.1;break}for(sp=0;sp<ap;sp+=1)lp.push(up);return lp}function _d(np,ap){return np==="float32"?new Float32Array(ap):np==="int16"?new Int16Array(ap):np==="uint8c"?new Uint8ClampedArray(ap):rp(np,ap)}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?_d:rp}();function createSizedArray(rp){return Array.apply(null,{length:rp})}function _typeof$6(rp){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$6=function(np){return typeof np}:_typeof$6=function(np){return np&&typeof Symbol=="function"&&np.constructor===Symbol&&np!==Symbol.prototype?"symbol":typeof np},_typeof$6(rp)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var rp=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],_d,np=rp.length;for(_d=0;_d<np;_d+=1)BMMath[rp[_d]]=Math[rp[_d]]})(),BMMath.random=Math.random,BMMath.abs=function(rp){var _d=_typeof$6(rp);if(_d==="object"&&rp.length){var np=createSizedArray(rp.length),ap,sp=rp.length;for(ap=0;ap<sp;ap+=1)np[ap]=Math.abs(rp[ap]);return np}return Math.abs(rp)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(rp){rp.style.position="absolute",rp.style.top=0,rp.style.left=0,rp.style.display="block",rp.style.transformOrigin="0 0",rp.style.webkitTransformOrigin="0 0",rp.style.backfaceVisibility="visible",rp.style.webkitBackfaceVisibility="visible",rp.style.transformStyle="preserve-3d",rp.style.webkitTransformStyle="preserve-3d",rp.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(rp,_d,np,ap){this.type=rp,this.currentTime=_d,this.totalTime=np,this.direction=ap<0?-1:1}function BMCompleteEvent(rp,_d){this.type=rp,this.direction=_d<0?-1:1}function BMCompleteLoopEvent(rp,_d,np,ap){this.type=rp,this.currentLoop=np,this.totalLoops=_d,this.direction=ap<0?-1:1}function BMSegmentStartEvent(rp,_d,np){this.type=rp,this.firstFrame=_d,this.totalFrames=np}function BMDestroyEvent(rp,_d){this.type=rp,this.target=_d}function BMRenderFrameErrorEvent(rp,_d){this.type="renderFrameError",this.nativeError=rp,this.currentTime=_d}function BMConfigErrorEvent(rp){this.type="configError",this.nativeError=rp}var createElementID=function(){var rp=0;return function(){return rp+=1,idPrefix$1+"__lottie_element_"+rp}}();function HSVtoRGB(rp,_d,np){var ap,sp,lp,up,cp,dp,hp,fp;switch(up=Math.floor(rp*6),cp=rp*6-up,dp=np*(1-_d),hp=np*(1-cp*_d),fp=np*(1-(1-cp)*_d),up%6){case 0:ap=np,sp=fp,lp=dp;break;case 1:ap=hp,sp=np,lp=dp;break;case 2:ap=dp,sp=np,lp=fp;break;case 3:ap=dp,sp=hp,lp=np;break;case 4:ap=fp,sp=dp,lp=np;break;case 5:ap=np,sp=dp,lp=hp;break}return[ap,sp,lp]}function RGBtoHSV(rp,_d,np){var ap=Math.max(rp,_d,np),sp=Math.min(rp,_d,np),lp=ap-sp,up,cp=ap===0?0:lp/ap,dp=ap/255;switch(ap){case sp:up=0;break;case rp:up=_d-np+lp*(_d<np?6:0),up/=6*lp;break;case _d:up=np-rp+lp*2,up/=6*lp;break;case np:up=rp-_d+lp*4,up/=6*lp;break}return[up,cp,dp]}function addSaturationToRGB(rp,_d){var np=RGBtoHSV(rp[0]*255,rp[1]*255,rp[2]*255);return np[1]+=_d,np[1]>1?np[1]=1:np[1]<=0&&(np[1]=0),HSVtoRGB(np[0],np[1],np[2])}function addBrightnessToRGB(rp,_d){var np=RGBtoHSV(rp[0]*255,rp[1]*255,rp[2]*255);return np[2]+=_d,np[2]>1?np[2]=1:np[2]<0&&(np[2]=0),HSVtoRGB(np[0],np[1],np[2])}function addHueToRGB(rp,_d){var np=RGBtoHSV(rp[0]*255,rp[1]*255,rp[2]*255);return np[0]+=_d/360,np[0]>1?np[0]-=1:np[0]<0&&(np[0]+=1),HSVtoRGB(np[0],np[1],np[2])}var rgbToHex=function(){var rp=[],_d,np;for(_d=0;_d<256;_d+=1)np=_d.toString(16),rp[_d]=np.length===1?"0"+np:np;return function(ap,sp,lp){return ap<0&&(ap=0),sp<0&&(sp=0),lp<0&&(lp=0),"#"+rp[ap]+rp[sp]+rp[lp]}}(),setSubframeEnabled=function(_d){subframeEnabled=!!_d},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(_d){expressionsPlugin=_d},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(_d){expressionsInterfaces=_d},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(_d){defaultCurveSegments=_d},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(_d){idPrefix$1=_d};function createNS(rp){return document.createElementNS(svgNS,rp)}function _typeof$5(rp){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$5=function(np){return typeof np}:_typeof$5=function(np){return np&&typeof Symbol=="function"&&np.constructor===Symbol&&np!==Symbol.prototype?"symbol":typeof np},_typeof$5(rp)}var dataManager=function(){var rp=1,_d=[],np,ap,sp={onmessage:function(){},postMessage:function(gp){np({data:gp})}},lp={postMessage:function(gp){sp.onmessage({data:gp})}};function up(mp){if(window.Worker&&window.Blob&&getWebWorker()){var gp=new Blob(["var _workerSelf = self; self.onmessage = ",mp.toString()],{type:"text/javascript"}),yp=URL.createObjectURL(gp);return new Worker(yp)}return np=mp,sp}function cp(){ap||(ap=up(function(gp){function yp(){function _p(jp,Lp){var Bp,Ip,kp=jp.length,Up,Gp,Wp,Qp;for(Ip=0;Ip<kp;Ip+=1)if(Bp=jp[Ip],"ks"in Bp&&!Bp.completed){if(Bp.completed=!0,Bp.hasMask){var Xp=Bp.masksProperties;for(Gp=Xp.length,Up=0;Up<Gp;Up+=1)if(Xp[Up].pt.k.i)Ap(Xp[Up].pt.k);else for(Qp=Xp[Up].pt.k.length,Wp=0;Wp<Qp;Wp+=1)Xp[Up].pt.k[Wp].s&&Ap(Xp[Up].pt.k[Wp].s[0]),Xp[Up].pt.k[Wp].e&&Ap(Xp[Up].pt.k[Wp].e[0])}Bp.ty===0?(Bp.layers=Ep(Bp.refId,Lp),_p(Bp.layers,Lp)):Bp.ty===4?Sp(Bp.shapes):Bp.ty===5&&Dp(Bp)}}function vp(jp,Lp){if(jp){var Bp=0,Ip=jp.length;for(Bp=0;Bp<Ip;Bp+=1)jp[Bp].t===1&&(jp[Bp].data.layers=Ep(jp[Bp].data.refId,Lp),_p(jp[Bp].data.layers,Lp))}}function bp(jp,Lp){for(var Bp=0,Ip=Lp.length;Bp<Ip;){if(Lp[Bp].id===jp)return Lp[Bp];Bp+=1}return null}function Ep(jp,Lp){var Bp=bp(jp,Lp);return Bp?Bp.layers.__used?JSON.parse(JSON.stringify(Bp.layers)):(Bp.layers.__used=!0,Bp.layers):null}function Sp(jp){var Lp,Bp=jp.length,Ip,kp;for(Lp=Bp-1;Lp>=0;Lp-=1)if(jp[Lp].ty==="sh")if(jp[Lp].ks.k.i)Ap(jp[Lp].ks.k);else for(kp=jp[Lp].ks.k.length,Ip=0;Ip<kp;Ip+=1)jp[Lp].ks.k[Ip].s&&Ap(jp[Lp].ks.k[Ip].s[0]),jp[Lp].ks.k[Ip].e&&Ap(jp[Lp].ks.k[Ip].e[0]);else jp[Lp].ty==="gr"&&Sp(jp[Lp].it)}function Ap(jp){var Lp,Bp=jp.i.length;for(Lp=0;Lp<Bp;Lp+=1)jp.i[Lp][0]+=jp.v[Lp][0],jp.i[Lp][1]+=jp.v[Lp][1],jp.o[Lp][0]+=jp.v[Lp][0],jp.o[Lp][1]+=jp.v[Lp][1]}function Rp(jp,Lp){var Bp=Lp?Lp.split("."):[100,100,100];return jp[0]>Bp[0]?!0:Bp[0]>jp[0]?!1:jp[1]>Bp[1]?!0:Bp[1]>jp[1]?!1:jp[2]>Bp[2]?!0:Bp[2]>jp[2]?!1:null}var Tp=function(){var jp=[4,4,14];function Lp(Ip){var kp=Ip.t.d;Ip.t.d={k:[{s:kp,t:0}]}}function Bp(Ip){var kp,Up=Ip.length;for(kp=0;kp<Up;kp+=1)Ip[kp].ty===5&&Lp(Ip[kp])}return function(Ip){if(Rp(jp,Ip.v)&&(Bp(Ip.layers),Ip.assets)){var kp,Up=Ip.assets.length;for(kp=0;kp<Up;kp+=1)Ip.assets[kp].layers&&Bp(Ip.assets[kp].layers)}}}(),Mp=function(){var jp=[4,7,99];return function(Lp){if(Lp.chars&&!Rp(jp,Lp.v)){var Bp,Ip=Lp.chars.length;for(Bp=0;Bp<Ip;Bp+=1){var kp=Lp.chars[Bp];kp.data&&kp.data.shapes&&(Sp(kp.data.shapes),kp.data.ip=0,kp.data.op=99999,kp.data.st=0,kp.data.sr=1,kp.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},Lp.chars[Bp].t||(kp.data.shapes.push({ty:"no"}),kp.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),Op=function(){var jp=[5,7,15];function Lp(Ip){var kp=Ip.t.p;typeof kp.a=="number"&&(kp.a={a:0,k:kp.a}),typeof kp.p=="number"&&(kp.p={a:0,k:kp.p}),typeof kp.r=="number"&&(kp.r={a:0,k:kp.r})}function Bp(Ip){var kp,Up=Ip.length;for(kp=0;kp<Up;kp+=1)Ip[kp].ty===5&&Lp(Ip[kp])}return function(Ip){if(Rp(jp,Ip.v)&&(Bp(Ip.layers),Ip.assets)){var kp,Up=Ip.assets.length;for(kp=0;kp<Up;kp+=1)Ip.assets[kp].layers&&Bp(Ip.assets[kp].layers)}}}(),Pp=function(){var jp=[4,1,9];function Lp(Ip){var kp,Up=Ip.length,Gp,Wp;for(kp=0;kp<Up;kp+=1)if(Ip[kp].ty==="gr")Lp(Ip[kp].it);else if(Ip[kp].ty==="fl"||Ip[kp].ty==="st")if(Ip[kp].c.k&&Ip[kp].c.k[0].i)for(Wp=Ip[kp].c.k.length,Gp=0;Gp<Wp;Gp+=1)Ip[kp].c.k[Gp].s&&(Ip[kp].c.k[Gp].s[0]/=255,Ip[kp].c.k[Gp].s[1]/=255,Ip[kp].c.k[Gp].s[2]/=255,Ip[kp].c.k[Gp].s[3]/=255),Ip[kp].c.k[Gp].e&&(Ip[kp].c.k[Gp].e[0]/=255,Ip[kp].c.k[Gp].e[1]/=255,Ip[kp].c.k[Gp].e[2]/=255,Ip[kp].c.k[Gp].e[3]/=255);else Ip[kp].c.k[0]/=255,Ip[kp].c.k[1]/=255,Ip[kp].c.k[2]/=255,Ip[kp].c.k[3]/=255}function Bp(Ip){var kp,Up=Ip.length;for(kp=0;kp<Up;kp+=1)Ip[kp].ty===4&&Lp(Ip[kp].shapes)}return function(Ip){if(Rp(jp,Ip.v)&&(Bp(Ip.layers),Ip.assets)){var kp,Up=Ip.assets.length;for(kp=0;kp<Up;kp+=1)Ip.assets[kp].layers&&Bp(Ip.assets[kp].layers)}}}(),$p=function(){var jp=[4,4,18];function Lp(Ip){var kp,Up=Ip.length,Gp,Wp;for(kp=Up-1;kp>=0;kp-=1)if(Ip[kp].ty==="sh")if(Ip[kp].ks.k.i)Ip[kp].ks.k.c=Ip[kp].closed;else for(Wp=Ip[kp].ks.k.length,Gp=0;Gp<Wp;Gp+=1)Ip[kp].ks.k[Gp].s&&(Ip[kp].ks.k[Gp].s[0].c=Ip[kp].closed),Ip[kp].ks.k[Gp].e&&(Ip[kp].ks.k[Gp].e[0].c=Ip[kp].closed);else Ip[kp].ty==="gr"&&Lp(Ip[kp].it)}function Bp(Ip){var kp,Up,Gp=Ip.length,Wp,Qp,Xp,rm;for(Up=0;Up<Gp;Up+=1){if(kp=Ip[Up],kp.hasMask){var Kp=kp.masksProperties;for(Qp=Kp.length,Wp=0;Wp<Qp;Wp+=1)if(Kp[Wp].pt.k.i)Kp[Wp].pt.k.c=Kp[Wp].cl;else for(rm=Kp[Wp].pt.k.length,Xp=0;Xp<rm;Xp+=1)Kp[Wp].pt.k[Xp].s&&(Kp[Wp].pt.k[Xp].s[0].c=Kp[Wp].cl),Kp[Wp].pt.k[Xp].e&&(Kp[Wp].pt.k[Xp].e[0].c=Kp[Wp].cl)}kp.ty===4&&Lp(kp.shapes)}}return function(Ip){if(Rp(jp,Ip.v)&&(Bp(Ip.layers),Ip.assets)){var kp,Up=Ip.assets.length;for(kp=0;kp<Up;kp+=1)Ip.assets[kp].layers&&Bp(Ip.assets[kp].layers)}}}();function zp(jp){jp.__complete||(Pp(jp),Tp(jp),Mp(jp),Op(jp),$p(jp),_p(jp.layers,jp.assets),vp(jp.chars,jp.assets),jp.__complete=!0)}function Dp(jp){jp.t.a.length===0&&"m"in jp.t.p}var Fp={};return Fp.completeData=zp,Fp.checkColors=Pp,Fp.checkChars=Mp,Fp.checkPathProperties=Op,Fp.checkShapes=$p,Fp.completeLayers=_p,Fp}if(lp.dataManager||(lp.dataManager=yp()),lp.assetLoader||(lp.assetLoader=function(){function _p(bp){var Ep=bp.getResponseHeader("content-type");return Ep&&bp.responseType==="json"&&Ep.indexOf("json")!==-1||bp.response&&_typeof$5(bp.response)==="object"?bp.response:bp.response&&typeof bp.response=="string"?JSON.parse(bp.response):bp.responseText?JSON.parse(bp.responseText):null}function vp(bp,Ep,Sp,Ap){var Rp,Tp=new XMLHttpRequest;try{Tp.responseType="json"}catch{}Tp.onreadystatechange=function(){if(Tp.readyState===4)if(Tp.status===200)Rp=_p(Tp),Sp(Rp);else try{Rp=_p(Tp),Sp(Rp)}catch(Mp){Ap&&Ap(Mp)}};try{Tp.open(["G","E","T"].join(""),bp,!0)}catch{Tp.open(["G","E","T"].join(""),Ep+"/"+bp,!0)}Tp.send()}return{load:vp}}()),gp.data.type==="loadAnimation")lp.assetLoader.load(gp.data.path,gp.data.fullPath,function(_p){lp.dataManager.completeData(_p),lp.postMessage({id:gp.data.id,payload:_p,status:"success"})},function(){lp.postMessage({id:gp.data.id,status:"error"})});else if(gp.data.type==="complete"){var xp=gp.data.animation;lp.dataManager.completeData(xp),lp.postMessage({id:gp.data.id,payload:xp,status:"success"})}else gp.data.type==="loadData"&&lp.assetLoader.load(gp.data.path,gp.data.fullPath,function(_p){lp.postMessage({id:gp.data.id,payload:_p,status:"success"})},function(){lp.postMessage({id:gp.data.id,status:"error"})})}),ap.onmessage=function(mp){var gp=mp.data,yp=gp.id,xp=_d[yp];_d[yp]=null,gp.status==="success"?xp.onComplete(gp.payload):xp.onError&&xp.onError()})}function dp(mp,gp){rp+=1;var yp="processId_"+rp;return _d[yp]={onComplete:mp,onError:gp},yp}function hp(mp,gp,yp){cp();var xp=dp(gp,yp);ap.postMessage({type:"loadAnimation",path:mp,fullPath:window.location.origin+window.location.pathname,id:xp})}function fp(mp,gp,yp){cp();var xp=dp(gp,yp);ap.postMessage({type:"loadData",path:mp,fullPath:window.location.origin+window.location.pathname,id:xp})}function pp(mp,gp,yp){cp();var xp=dp(gp,yp);ap.postMessage({type:"complete",animation:mp,id:xp})}return{loadAnimation:hp,loadData:fp,completeAnimation:pp}}(),ImagePreloader=function(){var rp=function(){var vp=createTag("canvas");vp.width=1,vp.height=1;var bp=vp.getContext("2d");return bp.fillStyle="rgba(0,0,0,0)",bp.fillRect(0,0,1,1),vp}();function _d(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function np(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function ap(vp,bp,Ep){var Sp="";if(vp.e)Sp=vp.p;else if(bp){var Ap=vp.p;Ap.indexOf("images/")!==-1&&(Ap=Ap.split("/")[1]),Sp=bp+Ap}else Sp=Ep,Sp+=vp.u?vp.u:"",Sp+=vp.p;return Sp}function sp(vp){var bp=0,Ep=setInterval((function(){var Sp=vp.getBBox();(Sp.width||bp>500)&&(this._imageLoaded(),clearInterval(Ep)),bp+=1}).bind(this),50)}function lp(vp){var bp=ap(vp,this.assetsPath,this.path),Ep=createNS("image");isSafari?this.testImageLoaded(Ep):Ep.addEventListener("load",this._imageLoaded,!1),Ep.addEventListener("error",(function(){Sp.img=rp,this._imageLoaded()}).bind(this),!1),Ep.setAttributeNS("http://www.w3.org/1999/xlink","href",bp),this._elementHelper.append?this._elementHelper.append(Ep):this._elementHelper.appendChild(Ep);var Sp={img:Ep,assetData:vp};return Sp}function up(vp){var bp=ap(vp,this.assetsPath,this.path),Ep=createTag("img");Ep.crossOrigin="anonymous",Ep.addEventListener("load",this._imageLoaded,!1),Ep.addEventListener("error",(function(){Sp.img=rp,this._imageLoaded()}).bind(this),!1),Ep.src=bp;var Sp={img:Ep,assetData:vp};return Sp}function cp(vp){var bp={assetData:vp},Ep=ap(vp,this.assetsPath,this.path);return dataManager.loadData(Ep,(function(Sp){bp.img=Sp,this._footageLoaded()}).bind(this),(function(){bp.img={},this._footageLoaded()}).bind(this)),bp}function dp(vp,bp){this.imagesLoadedCb=bp;var Ep,Sp=vp.length;for(Ep=0;Ep<Sp;Ep+=1)vp[Ep].layers||(!vp[Ep].t||vp[Ep].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(vp[Ep]))):vp[Ep].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(vp[Ep]))))}function hp(vp){this.path=vp||""}function fp(vp){this.assetsPath=vp||""}function pp(vp){for(var bp=0,Ep=this.images.length;bp<Ep;){if(this.images[bp].assetData===vp)return this.images[bp].img;bp+=1}return null}function mp(){this.imagesLoadedCb=null,this.images.length=0}function gp(){return this.totalImages===this.loadedAssets}function yp(){return this.totalFootages===this.loadedFootagesCount}function xp(vp,bp){vp==="svg"?(this._elementHelper=bp,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function _p(){this._imageLoaded=_d.bind(this),this._footageLoaded=np.bind(this),this.testImageLoaded=sp.bind(this),this.createFootageData=cp.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return _p.prototype={loadAssets:dp,setAssetsPath:fp,setPath:hp,loadedImages:gp,loadedFootages:yp,destroy:mp,getAsset:pp,createImgData:up,createImageData:lp,imageLoaded:_d,footageLoaded:np,setCacheType:xp},_p}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(_d,np){if(this._cbs[_d])for(var ap=this._cbs[_d],sp=0;sp<ap.length;sp+=1)ap[sp](np)},addEventListener:function(_d,np){return this._cbs[_d]||(this._cbs[_d]=[]),this._cbs[_d].push(np),(function(){this.removeEventListener(_d,np)}).bind(this)},removeEventListener:function(_d,np){if(!np)this._cbs[_d]=null;else if(this._cbs[_d]){for(var ap=0,sp=this._cbs[_d].length;ap<sp;)this._cbs[_d][ap]===np&&(this._cbs[_d].splice(ap,1),ap-=1,sp-=1),ap+=1;this._cbs[_d].length||(this._cbs[_d]=null)}}};var markerParser=function(){function rp(_d){for(var np=_d.split(`\r
`),ap={},sp,lp=0,up=0;up<np.length;up+=1)sp=np[up].split(":"),sp.length===2&&(ap[sp[0]]=sp[1].trim(),lp+=1);if(lp===0)throw new Error;return ap}return function(_d){for(var np=[],ap=0;ap<_d.length;ap+=1){var sp=_d[ap],lp={time:sp.tm,duration:sp.dr};try{lp.payload=JSON.parse(_d[ap].cm)}catch{try{lp.payload=rp(_d[ap].cm)}catch{lp.payload={name:_d[ap].cm}}}np.push(lp)}return np}}(),ProjectInterface=function(){function rp(_d){this.compositions.push(_d)}return function(){function _d(np){for(var ap=0,sp=this.compositions.length;ap<sp;){if(this.compositions[ap].data&&this.compositions[ap].data.nm===np)return this.compositions[ap].prepareFrame&&this.compositions[ap].data.xt&&this.compositions[ap].prepareFrame(this.currentFrame),this.compositions[ap].compInterface;ap+=1}return null}return _d.compositions=[],_d.currentFrame=0,_d.registerComposition=rp,_d}}(),renderers={},registerRenderer=function(_d,np){renderers[_d]=np};function getRenderer(rp){return renderers[rp]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var rp in renderers)if(renderers[rp])return rp;return""}function _typeof$4(rp){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$4=function(np){return typeof np}:_typeof$4=function(np){return np&&typeof Symbol=="function"&&np.constructor===Symbol&&np!==Symbol.prototype?"symbol":typeof np},_typeof$4(rp)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(rp){(rp.wrapper||rp.container)&&(this.wrapper=rp.wrapper||rp.container);var _d="svg";rp.animType?_d=rp.animType:rp.renderer&&(_d=rp.renderer);var np=getRenderer(_d);this.renderer=new np(this,rp.rendererSettings),this.imagePreloader.setCacheType(_d,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=_d,rp.loop===""||rp.loop===null||rp.loop===void 0||rp.loop===!0?this.loop=!0:rp.loop===!1?this.loop=!1:this.loop=parseInt(rp.loop,10),this.autoplay="autoplay"in rp?rp.autoplay:!0,this.name=rp.name?rp.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(rp,"autoloadSegments")?rp.autoloadSegments:!0,this.assetsPath=rp.assetsPath,this.initialSegment=rp.initialSegment,rp.audioFactory&&this.audioController.setAudioFactory(rp.audioFactory),rp.animationData?this.setupAnimation(rp.animationData):rp.path&&(rp.path.lastIndexOf("\\")!==-1?this.path=rp.path.substr(0,rp.path.lastIndexOf("\\")+1):this.path=rp.path.substr(0,rp.path.lastIndexOf("/")+1),this.fileName=rp.path.substr(rp.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(rp.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(rp){dataManager.completeAnimation(rp,this.configAnimation)},AnimationItem.prototype.setData=function(rp,_d){_d&&_typeof$4(_d)!=="object"&&(_d=JSON.parse(_d));var np={wrapper:rp,animationData:_d},ap=rp.attributes;np.path=ap.getNamedItem("data-animation-path")?ap.getNamedItem("data-animation-path").value:ap.getNamedItem("data-bm-path")?ap.getNamedItem("data-bm-path").value:ap.getNamedItem("bm-path")?ap.getNamedItem("bm-path").value:"",np.animType=ap.getNamedItem("data-anim-type")?ap.getNamedItem("data-anim-type").value:ap.getNamedItem("data-bm-type")?ap.getNamedItem("data-bm-type").value:ap.getNamedItem("bm-type")?ap.getNamedItem("bm-type").value:ap.getNamedItem("data-bm-renderer")?ap.getNamedItem("data-bm-renderer").value:ap.getNamedItem("bm-renderer")?ap.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var sp=ap.getNamedItem("data-anim-loop")?ap.getNamedItem("data-anim-loop").value:ap.getNamedItem("data-bm-loop")?ap.getNamedItem("data-bm-loop").value:ap.getNamedItem("bm-loop")?ap.getNamedItem("bm-loop").value:"";sp==="false"?np.loop=!1:sp==="true"?np.loop=!0:sp!==""&&(np.loop=parseInt(sp,10));var lp=ap.getNamedItem("data-anim-autoplay")?ap.getNamedItem("data-anim-autoplay").value:ap.getNamedItem("data-bm-autoplay")?ap.getNamedItem("data-bm-autoplay").value:ap.getNamedItem("bm-autoplay")?ap.getNamedItem("bm-autoplay").value:!0;np.autoplay=lp!=="false",np.name=ap.getNamedItem("data-name")?ap.getNamedItem("data-name").value:ap.getNamedItem("data-bm-name")?ap.getNamedItem("data-bm-name").value:ap.getNamedItem("bm-name")?ap.getNamedItem("bm-name").value:"";var up=ap.getNamedItem("data-anim-prerender")?ap.getNamedItem("data-anim-prerender").value:ap.getNamedItem("data-bm-prerender")?ap.getNamedItem("data-bm-prerender").value:ap.getNamedItem("bm-prerender")?ap.getNamedItem("bm-prerender").value:"";up==="false"&&(np.prerender=!1),np.path?this.setParams(np):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(rp){rp.op>this.animationData.op&&(this.animationData.op=rp.op,this.totalFrames=Math.floor(rp.op-this.animationData.ip));var _d=this.animationData.layers,np,ap=_d.length,sp=rp.layers,lp,up=sp.length;for(lp=0;lp<up;lp+=1)for(np=0;np<ap;){if(_d[np].id===sp[lp].id){_d[np]=sp[lp];break}np+=1}if((rp.chars||rp.fonts)&&(this.renderer.globalData.fontManager.addChars(rp.chars),this.renderer.globalData.fontManager.addFonts(rp.fonts,this.renderer.globalData.defs)),rp.assets)for(ap=rp.assets.length,np=0;np<ap;np+=1)this.animationData.assets.push(rp.assets[np]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(rp){this.animationData=rp;var _d=getExpressionsPlugin();_d&&_d.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var rp=this.animationData.segments;if(!rp||rp.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return}var _d=rp.shift();this.timeCompleted=_d.time*this.frameRate;var np=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(np,this.includeLayers.bind(this),(function(){this.trigger("data_failed")}).bind(this))},AnimationItem.prototype.loadSegments=function(){var rp=this.animationData.segments;rp||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(rp){if(this.renderer)try{this.animationData=rp,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(rp),rp.assets||(rp.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(rp.assets),this.markers=markerParser(rp.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(_d){this.triggerConfigError(_d)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var rp=getExpressionsPlugin();rp&&rp.initExpressions(this),this.renderer.initItems(),setTimeout((function(){this.trigger("DOMLoaded")}).bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(rp,_d){var np=typeof rp=="number"?rp:void 0,ap=typeof _d=="number"?_d:void 0;this.renderer.updateContainerSize(np,ap)},AnimationItem.prototype.setSubframe=function(rp){this.isSubframeEnabled=!!rp},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(rp){this.triggerRenderFrameError(rp)}},AnimationItem.prototype.play=function(rp){rp&&this.name!==rp||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(rp){rp&&this.name!==rp||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(rp){rp&&this.name!==rp||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(rp){rp&&this.name!==rp||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(rp){for(var _d,np=0;np<this.markers.length;np+=1)if(_d=this.markers[np],_d.payload&&_d.payload.name===rp)return _d;return null},AnimationItem.prototype.goToAndStop=function(rp,_d,np){if(!(np&&this.name!==np)){var ap=Number(rp);if(isNaN(ap)){var sp=this.getMarkerData(rp);sp&&this.goToAndStop(sp.time,!0)}else _d?this.setCurrentRawFrameValue(rp):this.setCurrentRawFrameValue(rp*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(rp,_d,np){if(!(np&&this.name!==np)){var ap=Number(rp);if(isNaN(ap)){var sp=this.getMarkerData(rp);sp&&(sp.duration?this.playSegments([sp.time,sp.time+sp.duration],!0):this.goToAndStop(sp.time,!0))}else this.goToAndStop(ap,_d,np);this.play()}},AnimationItem.prototype.advanceTime=function(rp){if(!(this.isPaused===!0||this.isLoaded===!1)){var _d=this.currentRawFrame+rp*this.frameModifier,np=!1;_d>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(_d>this.totalFrames?_d%this.totalFrames:0)||(np=!0,_d=this.totalFrames-1):_d>=this.totalFrames?(this.playCount+=1,this.checkSegments(_d%this.totalFrames)||(this.setCurrentRawFrameValue(_d%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(_d):_d<0?this.checkSegments(_d%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+_d%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(np=!0,_d=0)):this.setCurrentRawFrameValue(_d),np&&(this.setCurrentRawFrameValue(_d),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(rp,_d){this.playCount=0,rp[1]<rp[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=rp[0]-rp[1],this.timeCompleted=this.totalFrames,this.firstFrame=rp[1],this.setCurrentRawFrameValue(this.totalFrames-.001-_d)):rp[1]>rp[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=rp[1]-rp[0],this.timeCompleted=this.totalFrames,this.firstFrame=rp[0],this.setCurrentRawFrameValue(.001+_d)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(rp,_d){var np=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<rp?np=rp:this.currentRawFrame+this.firstFrame>_d&&(np=_d-rp)),this.firstFrame=rp,this.totalFrames=_d-rp,this.timeCompleted=this.totalFrames,np!==-1&&this.goToAndStop(np,!0)},AnimationItem.prototype.playSegments=function(rp,_d){if(_d&&(this.segments.length=0),_typeof$4(rp[0])==="object"){var np,ap=rp.length;for(np=0;np<ap;np+=1)this.segments.push(rp[np])}else this.segments.push(rp);this.segments.length&&_d&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(rp){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),rp&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(rp){return this.segments.length?(this.adjustSegment(this.segments.shift(),rp),!0):!1},AnimationItem.prototype.destroy=function(rp){rp&&this.name!==rp||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(rp){this.currentRawFrame=rp,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(rp){this.playSpeed=rp,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(rp){this.playDirection=rp<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(rp){this.loop=rp},AnimationItem.prototype.setVolume=function(rp,_d){_d&&this.name!==_d||this.audioController.setVolume(rp)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(rp){rp&&this.name!==rp||this.audioController.mute()},AnimationItem.prototype.unmute=function(rp){rp&&this.name!==rp||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(rp){var _d="";if(rp.e)_d=rp.p;else if(this.assetsPath){var np=rp.p;np.indexOf("images/")!==-1&&(np=np.split("/")[1]),_d=this.assetsPath+np}else _d=this.path,_d+=rp.u?rp.u:"",_d+=rp.p;return _d},AnimationItem.prototype.getAssetData=function(rp){for(var _d=0,np=this.assets.length;_d<np;){if(rp===this.assets[_d].id)return this.assets[_d];_d+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(rp){return rp?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(rp,_d,np){try{var ap=this.renderer.getElementByPath(rp);ap.updateDocumentData(_d,np)}catch{}},AnimationItem.prototype.trigger=function(rp){if(this._cbs&&this._cbs[rp])switch(rp){case"enterFrame":this.triggerEvent(rp,new BMEnterFrameEvent(rp,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(rp,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(rp,new BMCompleteLoopEvent(rp,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(rp,new BMCompleteEvent(rp,this.frameMult));break;case"segmentStart":this.triggerEvent(rp,new BMSegmentStartEvent(rp,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(rp,new BMDestroyEvent(rp,this));break;default:this.triggerEvent(rp)}rp==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(rp,this.currentFrame,this.totalFrames,this.frameMult)),rp==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(rp,this.loop,this.playCount,this.frameMult)),rp==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(rp,this.frameMult)),rp==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(rp,this.firstFrame,this.totalFrames)),rp==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(rp,this))},AnimationItem.prototype.triggerRenderFrameError=function(rp){var _d=new BMRenderFrameErrorEvent(rp,this.currentFrame);this.triggerEvent("error",_d),this.onError&&this.onError.call(this,_d)},AnimationItem.prototype.triggerConfigError=function(rp){var _d=new BMConfigErrorEvent(rp,this.currentFrame);this.triggerEvent("error",_d),this.onError&&this.onError.call(this,_d)};var animationManager=function(){var rp={},_d=[],np=0,ap=0,sp=0,lp=!0,up=!1;function cp(Lp){for(var Bp=0,Ip=Lp.target;Bp<ap;)_d[Bp].animation===Ip&&(_d.splice(Bp,1),Bp-=1,ap-=1,Ip.isPaused||pp()),Bp+=1}function dp(Lp,Bp){if(!Lp)return null;for(var Ip=0;Ip<ap;){if(_d[Ip].elem===Lp&&_d[Ip].elem!==null)return _d[Ip].animation;Ip+=1}var kp=new AnimationItem;return mp(kp,Lp),kp.setData(Lp,Bp),kp}function hp(){var Lp,Bp=_d.length,Ip=[];for(Lp=0;Lp<Bp;Lp+=1)Ip.push(_d[Lp].animation);return Ip}function fp(){sp+=1,Pp()}function pp(){sp-=1}function mp(Lp,Bp){Lp.addEventListener("destroy",cp),Lp.addEventListener("_active",fp),Lp.addEventListener("_idle",pp),_d.push({elem:Bp,animation:Lp}),ap+=1}function gp(Lp){var Bp=new AnimationItem;return mp(Bp,null),Bp.setParams(Lp),Bp}function yp(Lp,Bp){var Ip;for(Ip=0;Ip<ap;Ip+=1)_d[Ip].animation.setSpeed(Lp,Bp)}function xp(Lp,Bp){var Ip;for(Ip=0;Ip<ap;Ip+=1)_d[Ip].animation.setDirection(Lp,Bp)}function _p(Lp){var Bp;for(Bp=0;Bp<ap;Bp+=1)_d[Bp].animation.play(Lp)}function vp(Lp){var Bp=Lp-np,Ip;for(Ip=0;Ip<ap;Ip+=1)_d[Ip].animation.advanceTime(Bp);np=Lp,sp&&!up?window.requestAnimationFrame(vp):lp=!0}function bp(Lp){np=Lp,window.requestAnimationFrame(vp)}function Ep(Lp){var Bp;for(Bp=0;Bp<ap;Bp+=1)_d[Bp].animation.pause(Lp)}function Sp(Lp,Bp,Ip){var kp;for(kp=0;kp<ap;kp+=1)_d[kp].animation.goToAndStop(Lp,Bp,Ip)}function Ap(Lp){var Bp;for(Bp=0;Bp<ap;Bp+=1)_d[Bp].animation.stop(Lp)}function Rp(Lp){var Bp;for(Bp=0;Bp<ap;Bp+=1)_d[Bp].animation.togglePause(Lp)}function Tp(Lp){var Bp;for(Bp=ap-1;Bp>=0;Bp-=1)_d[Bp].animation.destroy(Lp)}function Mp(Lp,Bp,Ip){var kp=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),Up,Gp=kp.length;for(Up=0;Up<Gp;Up+=1)Ip&&kp[Up].setAttribute("data-bm-type",Ip),dp(kp[Up],Lp);if(Bp&&Gp===0){Ip||(Ip="svg");var Wp=document.getElementsByTagName("body")[0];Wp.innerText="";var Qp=createTag("div");Qp.style.width="100%",Qp.style.height="100%",Qp.setAttribute("data-bm-type",Ip),Wp.appendChild(Qp),dp(Qp,Lp)}}function Op(){var Lp;for(Lp=0;Lp<ap;Lp+=1)_d[Lp].animation.resize()}function Pp(){!up&&sp&&lp&&(window.requestAnimationFrame(bp),lp=!1)}function $p(){up=!0}function zp(){up=!1,Pp()}function Dp(Lp,Bp){var Ip;for(Ip=0;Ip<ap;Ip+=1)_d[Ip].animation.setVolume(Lp,Bp)}function Fp(Lp){var Bp;for(Bp=0;Bp<ap;Bp+=1)_d[Bp].animation.mute(Lp)}function jp(Lp){var Bp;for(Bp=0;Bp<ap;Bp+=1)_d[Bp].animation.unmute(Lp)}return rp.registerAnimation=dp,rp.loadAnimation=gp,rp.setSpeed=yp,rp.setDirection=xp,rp.play=_p,rp.pause=Ep,rp.stop=Ap,rp.togglePause=Rp,rp.searchAnimations=Mp,rp.resize=Op,rp.goToAndStop=Sp,rp.destroy=Tp,rp.freeze=$p,rp.unfreeze=zp,rp.setVolume=Dp,rp.mute=Fp,rp.unmute=jp,rp.getRegisteredAnimations=hp,rp}(),BezierFactory=function(){var rp={};rp.getBezierEasing=np;var _d={};function np(bp,Ep,Sp,Ap,Rp){var Tp=Rp||("bez_"+bp+"_"+Ep+"_"+Sp+"_"+Ap).replace(/\./g,"p");if(_d[Tp])return _d[Tp];var Mp=new vp([bp,Ep,Sp,Ap]);return _d[Tp]=Mp,Mp}var ap=4,sp=.001,lp=1e-7,up=10,cp=11,dp=1/(cp-1),hp=typeof Float32Array=="function";function fp(bp,Ep){return 1-3*Ep+3*bp}function pp(bp,Ep){return 3*Ep-6*bp}function mp(bp){return 3*bp}function gp(bp,Ep,Sp){return((fp(Ep,Sp)*bp+pp(Ep,Sp))*bp+mp(Ep))*bp}function yp(bp,Ep,Sp){return 3*fp(Ep,Sp)*bp*bp+2*pp(Ep,Sp)*bp+mp(Ep)}function xp(bp,Ep,Sp,Ap,Rp){var Tp,Mp,Op=0;do Mp=Ep+(Sp-Ep)/2,Tp=gp(Mp,Ap,Rp)-bp,Tp>0?Sp=Mp:Ep=Mp;while(Math.abs(Tp)>lp&&++Op<up);return Mp}function _p(bp,Ep,Sp,Ap){for(var Rp=0;Rp<ap;++Rp){var Tp=yp(Ep,Sp,Ap);if(Tp===0)return Ep;var Mp=gp(Ep,Sp,Ap)-bp;Ep-=Mp/Tp}return Ep}function vp(bp){this._p=bp,this._mSampleValues=hp?new Float32Array(cp):new Array(cp),this._precomputed=!1,this.get=this.get.bind(this)}return vp.prototype={get:function(Ep){var Sp=this._p[0],Ap=this._p[1],Rp=this._p[2],Tp=this._p[3];return this._precomputed||this._precompute(),Sp===Ap&&Rp===Tp?Ep:Ep===0?0:Ep===1?1:gp(this._getTForX(Ep),Ap,Tp)},_precompute:function(){var Ep=this._p[0],Sp=this._p[1],Ap=this._p[2],Rp=this._p[3];this._precomputed=!0,(Ep!==Sp||Ap!==Rp)&&this._calcSampleValues()},_calcSampleValues:function(){for(var Ep=this._p[0],Sp=this._p[2],Ap=0;Ap<cp;++Ap)this._mSampleValues[Ap]=gp(Ap*dp,Ep,Sp)},_getTForX:function(Ep){for(var Sp=this._p[0],Ap=this._p[2],Rp=this._mSampleValues,Tp=0,Mp=1,Op=cp-1;Mp!==Op&&Rp[Mp]<=Ep;++Mp)Tp+=dp;--Mp;var Pp=(Ep-Rp[Mp])/(Rp[Mp+1]-Rp[Mp]),$p=Tp+Pp*dp,zp=yp($p,Sp,Ap);return zp>=sp?_p(Ep,$p,Sp,Ap):zp===0?$p:xp(Ep,Tp,Tp+dp,Sp,Ap)}},rp}(),pooling=function(){function rp(_d){return _d.concat(createSizedArray(_d.length))}return{double:rp}}(),poolFactory=function(){return function(rp,_d,np){var ap=0,sp=rp,lp=createSizedArray(sp),up={newElement:cp,release:dp};function cp(){var hp;return ap?(ap-=1,hp=lp[ap]):hp=_d(),hp}function dp(hp){ap===sp&&(lp=pooling.double(lp),sp*=2),np&&np(hp),lp[ap]=hp,ap+=1}return up}}(),bezierLengthPool=function(){function rp(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}return poolFactory(8,rp)}(),segmentsLengthPool=function(){function rp(){return{lengths:[],totalLength:0}}function _d(np){var ap,sp=np.lengths.length;for(ap=0;ap<sp;ap+=1)bezierLengthPool.release(np.lengths[ap]);np.lengths.length=0}return poolFactory(8,rp,_d)}();function bezFunction(){var rp=Math;function _d(mp,gp,yp,xp,_p,vp){var bp=mp*xp+gp*_p+yp*vp-_p*xp-vp*mp-yp*gp;return bp>-.001&&bp<.001}function np(mp,gp,yp,xp,_p,vp,bp,Ep,Sp){if(yp===0&&vp===0&&Sp===0)return _d(mp,gp,xp,_p,bp,Ep);var Ap=rp.sqrt(rp.pow(xp-mp,2)+rp.pow(_p-gp,2)+rp.pow(vp-yp,2)),Rp=rp.sqrt(rp.pow(bp-mp,2)+rp.pow(Ep-gp,2)+rp.pow(Sp-yp,2)),Tp=rp.sqrt(rp.pow(bp-xp,2)+rp.pow(Ep-_p,2)+rp.pow(Sp-vp,2)),Mp;return Ap>Rp?Ap>Tp?Mp=Ap-Rp-Tp:Mp=Tp-Rp-Ap:Tp>Rp?Mp=Tp-Rp-Ap:Mp=Rp-Ap-Tp,Mp>-1e-4&&Mp<1e-4}var ap=function(){return function(mp,gp,yp,xp){var _p=getDefaultCurveSegments(),vp,bp,Ep,Sp,Ap,Rp=0,Tp,Mp=[],Op=[],Pp=bezierLengthPool.newElement();for(Ep=yp.length,vp=0;vp<_p;vp+=1){for(Ap=vp/(_p-1),Tp=0,bp=0;bp<Ep;bp+=1)Sp=bmPow(1-Ap,3)*mp[bp]+3*bmPow(1-Ap,2)*Ap*yp[bp]+3*(1-Ap)*bmPow(Ap,2)*xp[bp]+bmPow(Ap,3)*gp[bp],Mp[bp]=Sp,Op[bp]!==null&&(Tp+=bmPow(Mp[bp]-Op[bp],2)),Op[bp]=Mp[bp];Tp&&(Tp=bmSqrt(Tp),Rp+=Tp),Pp.percents[vp]=Ap,Pp.lengths[vp]=Rp}return Pp.addedLength=Rp,Pp}}();function sp(mp){var gp=segmentsLengthPool.newElement(),yp=mp.c,xp=mp.v,_p=mp.o,vp=mp.i,bp,Ep=mp._length,Sp=gp.lengths,Ap=0;for(bp=0;bp<Ep-1;bp+=1)Sp[bp]=ap(xp[bp],xp[bp+1],_p[bp],vp[bp+1]),Ap+=Sp[bp].addedLength;return yp&&Ep&&(Sp[bp]=ap(xp[bp],xp[0],_p[bp],vp[0]),Ap+=Sp[bp].addedLength),gp.totalLength=Ap,gp}function lp(mp){this.segmentLength=0,this.points=new Array(mp)}function up(mp,gp){this.partialLength=mp,this.point=gp}var cp=function(){var mp={};return function(gp,yp,xp,_p){var vp=(gp[0]+"_"+gp[1]+"_"+yp[0]+"_"+yp[1]+"_"+xp[0]+"_"+xp[1]+"_"+_p[0]+"_"+_p[1]).replace(/\./g,"p");if(!mp[vp]){var bp=getDefaultCurveSegments(),Ep,Sp,Ap,Rp,Tp,Mp=0,Op,Pp,$p=null;gp.length===2&&(gp[0]!==yp[0]||gp[1]!==yp[1])&&_d(gp[0],gp[1],yp[0],yp[1],gp[0]+xp[0],gp[1]+xp[1])&&_d(gp[0],gp[1],yp[0],yp[1],yp[0]+_p[0],yp[1]+_p[1])&&(bp=2);var zp=new lp(bp);for(Ap=xp.length,Ep=0;Ep<bp;Ep+=1){for(Pp=createSizedArray(Ap),Tp=Ep/(bp-1),Op=0,Sp=0;Sp<Ap;Sp+=1)Rp=bmPow(1-Tp,3)*gp[Sp]+3*bmPow(1-Tp,2)*Tp*(gp[Sp]+xp[Sp])+3*(1-Tp)*bmPow(Tp,2)*(yp[Sp]+_p[Sp])+bmPow(Tp,3)*yp[Sp],Pp[Sp]=Rp,$p!==null&&(Op+=bmPow(Pp[Sp]-$p[Sp],2));Op=bmSqrt(Op),Mp+=Op,zp.points[Ep]=new up(Op,Pp),$p=Pp}zp.segmentLength=Mp,mp[vp]=zp}return mp[vp]}}();function dp(mp,gp){var yp=gp.percents,xp=gp.lengths,_p=yp.length,vp=bmFloor((_p-1)*mp),bp=mp*gp.addedLength,Ep=0;if(vp===_p-1||vp===0||bp===xp[vp])return yp[vp];for(var Sp=xp[vp]>bp?-1:1,Ap=!0;Ap;)if(xp[vp]<=bp&&xp[vp+1]>bp?(Ep=(bp-xp[vp])/(xp[vp+1]-xp[vp]),Ap=!1):vp+=Sp,vp<0||vp>=_p-1){if(vp===_p-1)return yp[vp];Ap=!1}return yp[vp]+(yp[vp+1]-yp[vp])*Ep}function hp(mp,gp,yp,xp,_p,vp){var bp=dp(_p,vp),Ep=1-bp,Sp=rp.round((Ep*Ep*Ep*mp[0]+(bp*Ep*Ep+Ep*bp*Ep+Ep*Ep*bp)*yp[0]+(bp*bp*Ep+Ep*bp*bp+bp*Ep*bp)*xp[0]+bp*bp*bp*gp[0])*1e3)/1e3,Ap=rp.round((Ep*Ep*Ep*mp[1]+(bp*Ep*Ep+Ep*bp*Ep+Ep*Ep*bp)*yp[1]+(bp*bp*Ep+Ep*bp*bp+bp*Ep*bp)*xp[1]+bp*bp*bp*gp[1])*1e3)/1e3;return[Sp,Ap]}var fp=createTypedArray("float32",8);function pp(mp,gp,yp,xp,_p,vp,bp){_p<0?_p=0:_p>1&&(_p=1);var Ep=dp(_p,bp);vp=vp>1?1:vp;var Sp=dp(vp,bp),Ap,Rp=mp.length,Tp=1-Ep,Mp=1-Sp,Op=Tp*Tp*Tp,Pp=Ep*Tp*Tp*3,$p=Ep*Ep*Tp*3,zp=Ep*Ep*Ep,Dp=Tp*Tp*Mp,Fp=Ep*Tp*Mp+Tp*Ep*Mp+Tp*Tp*Sp,jp=Ep*Ep*Mp+Tp*Ep*Sp+Ep*Tp*Sp,Lp=Ep*Ep*Sp,Bp=Tp*Mp*Mp,Ip=Ep*Mp*Mp+Tp*Sp*Mp+Tp*Mp*Sp,kp=Ep*Sp*Mp+Tp*Sp*Sp+Ep*Mp*Sp,Up=Ep*Sp*Sp,Gp=Mp*Mp*Mp,Wp=Sp*Mp*Mp+Mp*Sp*Mp+Mp*Mp*Sp,Qp=Sp*Sp*Mp+Mp*Sp*Sp+Sp*Mp*Sp,Xp=Sp*Sp*Sp;for(Ap=0;Ap<Rp;Ap+=1)fp[Ap*4]=rp.round((Op*mp[Ap]+Pp*yp[Ap]+$p*xp[Ap]+zp*gp[Ap])*1e3)/1e3,fp[Ap*4+1]=rp.round((Dp*mp[Ap]+Fp*yp[Ap]+jp*xp[Ap]+Lp*gp[Ap])*1e3)/1e3,fp[Ap*4+2]=rp.round((Bp*mp[Ap]+Ip*yp[Ap]+kp*xp[Ap]+Up*gp[Ap])*1e3)/1e3,fp[Ap*4+3]=rp.round((Gp*mp[Ap]+Wp*yp[Ap]+Qp*xp[Ap]+Xp*gp[Ap])*1e3)/1e3;return fp}return{getSegmentsLength:sp,getNewSegment:pp,getPointInSegment:hp,buildBezierData:cp,pointOnLine2D:_d,pointOnLine3D:np}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(rp,_d){var np=this.offsetTime,ap;this.propType==="multidimensional"&&(ap=createTypedArray("float32",this.pv.length));for(var sp=_d.lastIndex,lp=sp,up=this.keyframes.length-1,cp=!0,dp,hp,fp;cp;){if(dp=this.keyframes[lp],hp=this.keyframes[lp+1],lp===up-1&&rp>=hp.t-np){dp.h&&(dp=hp),sp=0;break}if(hp.t-np>rp){sp=lp;break}lp<up-1?lp+=1:(sp=0,cp=!1)}fp=this.keyframesMetadata[lp]||{};var pp,mp,gp,yp,xp,_p,vp=hp.t-np,bp=dp.t-np,Ep;if(dp.to){fp.bezierData||(fp.bezierData=bez.buildBezierData(dp.s,hp.s||dp.e,dp.to,dp.ti));var Sp=fp.bezierData;if(rp>=vp||rp<bp){var Ap=rp>=vp?Sp.points.length-1:0;for(mp=Sp.points[Ap].point.length,pp=0;pp<mp;pp+=1)ap[pp]=Sp.points[Ap].point[pp]}else{fp.__fnct?_p=fp.__fnct:(_p=BezierFactory.getBezierEasing(dp.o.x,dp.o.y,dp.i.x,dp.i.y,dp.n).get,fp.__fnct=_p),gp=_p((rp-bp)/(vp-bp));var Rp=Sp.segmentLength*gp,Tp,Mp=_d.lastFrame<rp&&_d._lastKeyframeIndex===lp?_d._lastAddedLength:0;for(xp=_d.lastFrame<rp&&_d._lastKeyframeIndex===lp?_d._lastPoint:0,cp=!0,yp=Sp.points.length;cp;){if(Mp+=Sp.points[xp].partialLength,Rp===0||gp===0||xp===Sp.points.length-1){for(mp=Sp.points[xp].point.length,pp=0;pp<mp;pp+=1)ap[pp]=Sp.points[xp].point[pp];break}else if(Rp>=Mp&&Rp<Mp+Sp.points[xp+1].partialLength){for(Tp=(Rp-Mp)/Sp.points[xp+1].partialLength,mp=Sp.points[xp].point.length,pp=0;pp<mp;pp+=1)ap[pp]=Sp.points[xp].point[pp]+(Sp.points[xp+1].point[pp]-Sp.points[xp].point[pp])*Tp;break}xp<yp-1?xp+=1:cp=!1}_d._lastPoint=xp,_d._lastAddedLength=Mp-Sp.points[xp].partialLength,_d._lastKeyframeIndex=lp}}else{var Op,Pp,$p,zp,Dp;if(up=dp.s.length,Ep=hp.s||dp.e,this.sh&&dp.h!==1)if(rp>=vp)ap[0]=Ep[0],ap[1]=Ep[1],ap[2]=Ep[2];else if(rp<=bp)ap[0]=dp.s[0],ap[1]=dp.s[1],ap[2]=dp.s[2];else{var Fp=createQuaternion(dp.s),jp=createQuaternion(Ep),Lp=(rp-bp)/(vp-bp);quaternionToEuler(ap,slerp(Fp,jp,Lp))}else for(lp=0;lp<up;lp+=1)dp.h!==1&&(rp>=vp?gp=1:rp<bp?gp=0:(dp.o.x.constructor===Array?(fp.__fnct||(fp.__fnct=[]),fp.__fnct[lp]?_p=fp.__fnct[lp]:(Op=dp.o.x[lp]===void 0?dp.o.x[0]:dp.o.x[lp],Pp=dp.o.y[lp]===void 0?dp.o.y[0]:dp.o.y[lp],$p=dp.i.x[lp]===void 0?dp.i.x[0]:dp.i.x[lp],zp=dp.i.y[lp]===void 0?dp.i.y[0]:dp.i.y[lp],_p=BezierFactory.getBezierEasing(Op,Pp,$p,zp).get,fp.__fnct[lp]=_p)):fp.__fnct?_p=fp.__fnct:(Op=dp.o.x,Pp=dp.o.y,$p=dp.i.x,zp=dp.i.y,_p=BezierFactory.getBezierEasing(Op,Pp,$p,zp).get,dp.keyframeMetadata=_p),gp=_p((rp-bp)/(vp-bp)))),Ep=hp.s||dp.e,Dp=dp.h===1?dp.s[lp]:dp.s[lp]+(Ep[lp]-dp.s[lp])*gp,this.propType==="multidimensional"?ap[lp]=Dp:ap=Dp}return _d.lastIndex=sp,ap}function slerp(rp,_d,np){var ap=[],sp=rp[0],lp=rp[1],up=rp[2],cp=rp[3],dp=_d[0],hp=_d[1],fp=_d[2],pp=_d[3],mp,gp,yp,xp,_p;return gp=sp*dp+lp*hp+up*fp+cp*pp,gp<0&&(gp=-gp,dp=-dp,hp=-hp,fp=-fp,pp=-pp),1-gp>1e-6?(mp=Math.acos(gp),yp=Math.sin(mp),xp=Math.sin((1-np)*mp)/yp,_p=Math.sin(np*mp)/yp):(xp=1-np,_p=np),ap[0]=xp*sp+_p*dp,ap[1]=xp*lp+_p*hp,ap[2]=xp*up+_p*fp,ap[3]=xp*cp+_p*pp,ap}function quaternionToEuler(rp,_d){var np=_d[0],ap=_d[1],sp=_d[2],lp=_d[3],up=Math.atan2(2*ap*lp-2*np*sp,1-2*ap*ap-2*sp*sp),cp=Math.asin(2*np*ap+2*sp*lp),dp=Math.atan2(2*np*lp-2*ap*sp,1-2*np*np-2*sp*sp);rp[0]=up/degToRads,rp[1]=cp/degToRads,rp[2]=dp/degToRads}function createQuaternion(rp){var _d=rp[0]*degToRads,np=rp[1]*degToRads,ap=rp[2]*degToRads,sp=Math.cos(_d/2),lp=Math.cos(np/2),up=Math.cos(ap/2),cp=Math.sin(_d/2),dp=Math.sin(np/2),hp=Math.sin(ap/2),fp=sp*lp*up-cp*dp*hp,pp=cp*dp*up+sp*lp*hp,mp=cp*lp*up+sp*dp*hp,gp=sp*dp*up-cp*lp*hp;return[pp,mp,gp,fp]}function getValueAtCurrentTime(){var rp=this.comp.renderedFrame-this.offsetTime,_d=this.keyframes[0].t-this.offsetTime,np=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(rp===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=np&&rp>=np||this._caching.lastFrame<_d&&rp<_d))){this._caching.lastFrame>=rp&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var ap=this.interpolateValue(rp,this._caching);this.pv=ap}return this._caching.lastFrame=rp,this.pv}function setVValue(rp){var _d;if(this.propType==="unidimensional")_d=rp*this.mult,mathAbs(this.v-_d)>1e-5&&(this.v=_d,this._mdf=!0);else for(var np=0,ap=this.v.length;np<ap;)_d=rp[np]*this.mult,mathAbs(this.v[np]-_d)>1e-5&&(this.v[np]=_d,this._mdf=!0),np+=1}function processEffectsSequence(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=this._isFirstFrame;var rp,_d=this.effectsSequence.length,np=this.kf?this.pv:this.data.k;for(rp=0;rp<_d;rp+=1)np=this.effectsSequence[rp](np);this.setVValue(np),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(rp){this.effectsSequence.push(rp),this.container.addDynamicProperty(this)}function ValueProperty(rp,_d,np,ap){this.propType="unidimensional",this.mult=np||1,this.data=_d,this.v=np?_d.k*np:_d.k,this.pv=_d.k,this._mdf=!1,this.elem=rp,this.container=ap,this.comp=rp.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(rp,_d,np,ap){this.propType="multidimensional",this.mult=np||1,this.data=_d,this._mdf=!1,this.elem=rp,this.container=ap,this.comp=rp.comp,this.k=!1,this.kf=!1,this.frameId=-1;var sp,lp=_d.k.length;for(this.v=createTypedArray("float32",lp),this.pv=createTypedArray("float32",lp),this.vel=createTypedArray("float32",lp),sp=0;sp<lp;sp+=1)this.v[sp]=_d.k[sp]*this.mult,this.pv[sp]=_d.k[sp];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(rp,_d,np,ap){this.propType="unidimensional",this.keyframes=_d.k,this.keyframesMetadata=[],this.offsetTime=rp.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=_d,this.mult=np||1,this.elem=rp,this.container=ap,this.comp=rp.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(rp,_d,np,ap){this.propType="multidimensional";var sp,lp=_d.k.length,up,cp,dp,hp;for(sp=0;sp<lp-1;sp+=1)_d.k[sp].to&&_d.k[sp].s&&_d.k[sp+1]&&_d.k[sp+1].s&&(up=_d.k[sp].s,cp=_d.k[sp+1].s,dp=_d.k[sp].to,hp=_d.k[sp].ti,(up.length===2&&!(up[0]===cp[0]&&up[1]===cp[1])&&bez.pointOnLine2D(up[0],up[1],cp[0],cp[1],up[0]+dp[0],up[1]+dp[1])&&bez.pointOnLine2D(up[0],up[1],cp[0],cp[1],cp[0]+hp[0],cp[1]+hp[1])||up.length===3&&!(up[0]===cp[0]&&up[1]===cp[1]&&up[2]===cp[2])&&bez.pointOnLine3D(up[0],up[1],up[2],cp[0],cp[1],cp[2],up[0]+dp[0],up[1]+dp[1],up[2]+dp[2])&&bez.pointOnLine3D(up[0],up[1],up[2],cp[0],cp[1],cp[2],cp[0]+hp[0],cp[1]+hp[1],cp[2]+hp[2]))&&(_d.k[sp].to=null,_d.k[sp].ti=null),up[0]===cp[0]&&up[1]===cp[1]&&dp[0]===0&&dp[1]===0&&hp[0]===0&&hp[1]===0&&(up.length===2||up[2]===cp[2]&&dp[2]===0&&hp[2]===0)&&(_d.k[sp].to=null,_d.k[sp].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=_d,this.keyframes=_d.k,this.keyframesMetadata=[],this.offsetTime=rp.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=np||1,this.elem=rp,this.container=ap,this.comp=rp.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var fp=_d.k[0].s.length;for(this.v=createTypedArray("float32",fp),this.pv=createTypedArray("float32",fp),sp=0;sp<fp;sp+=1)this.v[sp]=initFrame,this.pv[sp]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",fp)},this.addEffect=addEffect}var PropertyFactory=function(){function rp(np,ap,sp,lp,up){ap.sid&&(ap=np.globalData.slotManager.getProp(ap));var cp;if(!ap.k.length)cp=new ValueProperty(np,ap,lp,up);else if(typeof ap.k[0]=="number")cp=new MultiDimensionalProperty(np,ap,lp,up);else switch(sp){case 0:cp=new KeyframedValueProperty(np,ap,lp,up);break;case 1:cp=new KeyframedMultidimensionalProperty(np,ap,lp,up);break}return cp.effectsSequence.length&&up.addDynamicProperty(cp),cp}var _d={getProp:rp};return _d}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(_d){this.dynamicProperties.indexOf(_d)===-1&&(this.dynamicProperties.push(_d),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var _d,np=this.dynamicProperties.length;for(_d=0;_d<np;_d+=1)this.dynamicProperties[_d].getValue(),this.dynamicProperties[_d]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(_d){this.container=_d,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=function(){function rp(){return createTypedArray("float32",2)}return poolFactory(8,rp)}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(rp,_d){this.c=rp,this.setLength(_d);for(var np=0;np<_d;)this.v[np]=pointPool.newElement(),this.o[np]=pointPool.newElement(),this.i[np]=pointPool.newElement(),np+=1},ShapePath.prototype.setLength=function(rp){for(;this._maxLength<rp;)this.doubleArrayLength();this._length=rp},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(rp,_d,np,ap,sp){var lp;switch(this._length=Math.max(this._length,ap+1),this._length>=this._maxLength&&this.doubleArrayLength(),np){case"v":lp=this.v;break;case"i":lp=this.i;break;case"o":lp=this.o;break;default:lp=[];break}(!lp[ap]||lp[ap]&&!sp)&&(lp[ap]=pointPool.newElement()),lp[ap][0]=rp,lp[ap][1]=_d},ShapePath.prototype.setTripleAt=function(rp,_d,np,ap,sp,lp,up,cp){this.setXYAt(rp,_d,"v",up,cp),this.setXYAt(np,ap,"o",up,cp),this.setXYAt(sp,lp,"i",up,cp)},ShapePath.prototype.reverse=function(){var rp=new ShapePath;rp.setPathData(this.c,this._length);var _d=this.v,np=this.o,ap=this.i,sp=0;this.c&&(rp.setTripleAt(_d[0][0],_d[0][1],ap[0][0],ap[0][1],np[0][0],np[0][1],0,!1),sp=1);var lp=this._length-1,up=this._length,cp;for(cp=sp;cp<up;cp+=1)rp.setTripleAt(_d[lp][0],_d[lp][1],ap[lp][0],ap[lp][1],np[lp][0],np[lp][1],cp,!1),lp-=1;return rp},ShapePath.prototype.length=function(){return this._length};var shapePool=function(){function rp(){return new ShapePath}function _d(sp){var lp=sp._length,up;for(up=0;up<lp;up+=1)pointPool.release(sp.v[up]),pointPool.release(sp.i[up]),pointPool.release(sp.o[up]),sp.v[up]=null,sp.i[up]=null,sp.o[up]=null;sp._length=0,sp.c=!1}function np(sp){var lp=ap.newElement(),up,cp=sp._length===void 0?sp.v.length:sp._length;for(lp.setLength(cp),lp.c=sp.c,up=0;up<cp;up+=1)lp.setTripleAt(sp.v[up][0],sp.v[up][1],sp.o[up][0],sp.o[up][1],sp.i[up][0],sp.i[up][1],up);return lp}var ap=poolFactory(4,rp,_d);return ap.clone=np,ap}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(rp){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=rp,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var rp;for(rp=0;rp<this._length;rp+=1)shapePool.release(this.shapes[rp]);this._length=0};var shapeCollectionPool=function(){var rp={newShapeCollection:sp,release:lp},_d=0,np=4,ap=createSizedArray(np);function sp(){var up;return _d?(_d-=1,up=ap[_d]):up=new ShapeCollection,up}function lp(up){var cp,dp=up._length;for(cp=0;cp<dp;cp+=1)shapePool.release(up.shapes[cp]);up._length=0,_d===np&&(ap=pooling.double(ap),np*=2),ap[_d]=up,_d+=1}return rp}(),ShapePropertyFactory=function(){var rp=-999999;function _d(vp,bp,Ep){var Sp=Ep.lastIndex,Ap,Rp,Tp,Mp,Op,Pp,$p,zp,Dp,Fp=this.keyframes;if(vp<Fp[0].t-this.offsetTime)Ap=Fp[0].s[0],Tp=!0,Sp=0;else if(vp>=Fp[Fp.length-1].t-this.offsetTime)Ap=Fp[Fp.length-1].s?Fp[Fp.length-1].s[0]:Fp[Fp.length-2].e[0],Tp=!0;else{for(var jp=Sp,Lp=Fp.length-1,Bp=!0,Ip,kp,Up;Bp&&(Ip=Fp[jp],kp=Fp[jp+1],!(kp.t-this.offsetTime>vp));)jp<Lp-1?jp+=1:Bp=!1;if(Up=this.keyframesMetadata[jp]||{},Tp=Ip.h===1,Sp=jp,!Tp){if(vp>=kp.t-this.offsetTime)zp=1;else if(vp<Ip.t-this.offsetTime)zp=0;else{var Gp;Up.__fnct?Gp=Up.__fnct:(Gp=BezierFactory.getBezierEasing(Ip.o.x,Ip.o.y,Ip.i.x,Ip.i.y).get,Up.__fnct=Gp),zp=Gp((vp-(Ip.t-this.offsetTime))/(kp.t-this.offsetTime-(Ip.t-this.offsetTime)))}Rp=kp.s?kp.s[0]:Ip.e[0]}Ap=Ip.s[0]}for(Pp=bp._length,$p=Ap.i[0].length,Ep.lastIndex=Sp,Mp=0;Mp<Pp;Mp+=1)for(Op=0;Op<$p;Op+=1)Dp=Tp?Ap.i[Mp][Op]:Ap.i[Mp][Op]+(Rp.i[Mp][Op]-Ap.i[Mp][Op])*zp,bp.i[Mp][Op]=Dp,Dp=Tp?Ap.o[Mp][Op]:Ap.o[Mp][Op]+(Rp.o[Mp][Op]-Ap.o[Mp][Op])*zp,bp.o[Mp][Op]=Dp,Dp=Tp?Ap.v[Mp][Op]:Ap.v[Mp][Op]+(Rp.v[Mp][Op]-Ap.v[Mp][Op])*zp,bp.v[Mp][Op]=Dp}function np(){var vp=this.comp.renderedFrame-this.offsetTime,bp=this.keyframes[0].t-this.offsetTime,Ep=this.keyframes[this.keyframes.length-1].t-this.offsetTime,Sp=this._caching.lastFrame;return Sp!==rp&&(Sp<bp&&vp<bp||Sp>Ep&&vp>Ep)||(this._caching.lastIndex=Sp<vp?this._caching.lastIndex:0,this.interpolateShape(vp,this.pv,this._caching)),this._caching.lastFrame=vp,this.pv}function ap(){this.paths=this.localShapeCollection}function sp(vp,bp){if(vp._length!==bp._length||vp.c!==bp.c)return!1;var Ep,Sp=vp._length;for(Ep=0;Ep<Sp;Ep+=1)if(vp.v[Ep][0]!==bp.v[Ep][0]||vp.v[Ep][1]!==bp.v[Ep][1]||vp.o[Ep][0]!==bp.o[Ep][0]||vp.o[Ep][1]!==bp.o[Ep][1]||vp.i[Ep][0]!==bp.i[Ep][0]||vp.i[Ep][1]!==bp.i[Ep][1])return!1;return!0}function lp(vp){sp(this.v,vp)||(this.v=shapePool.clone(vp),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function up(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return}if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=!1;var vp;this.kf?vp=this.pv:this.data.ks?vp=this.data.ks.k:vp=this.data.pt.k;var bp,Ep=this.effectsSequence.length;for(bp=0;bp<Ep;bp+=1)vp=this.effectsSequence[bp](vp);this.setVValue(vp),this.lock=!1,this.frameId=this.elem.globalData.frameId}}function cp(vp,bp,Ep){this.propType="shape",this.comp=vp.comp,this.container=vp,this.elem=vp,this.data=bp,this.k=!1,this.kf=!1,this._mdf=!1;var Sp=Ep===3?bp.pt.k:bp.ks.k;this.v=shapePool.clone(Sp),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=ap,this.effectsSequence=[]}function dp(vp){this.effectsSequence.push(vp),this.container.addDynamicProperty(this)}cp.prototype.interpolateShape=_d,cp.prototype.getValue=up,cp.prototype.setVValue=lp,cp.prototype.addEffect=dp;function hp(vp,bp,Ep){this.propType="shape",this.comp=vp.comp,this.elem=vp,this.container=vp,this.offsetTime=vp.data.st,this.keyframes=Ep===3?bp.pt.k:bp.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var Sp=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,Sp),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=rp,this.reset=ap,this._caching={lastFrame:rp,lastIndex:0},this.effectsSequence=[np.bind(this)]}hp.prototype.getValue=up,hp.prototype.interpolateShape=_d,hp.prototype.setVValue=lp,hp.prototype.addEffect=dp;var fp=function(){var vp=roundCorner;function bp(Ep,Sp){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=Sp.d,this.elem=Ep,this.comp=Ep.comp,this.frameId=-1,this.initDynamicPropertyContainer(Ep),this.p=PropertyFactory.getProp(Ep,Sp.p,1,0,this),this.s=PropertyFactory.getProp(Ep,Sp.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return bp.prototype={reset:ap,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var Sp=this.p.v[0],Ap=this.p.v[1],Rp=this.s.v[0]/2,Tp=this.s.v[1]/2,Mp=this.d!==3,Op=this.v;Op.v[0][0]=Sp,Op.v[0][1]=Ap-Tp,Op.v[1][0]=Mp?Sp+Rp:Sp-Rp,Op.v[1][1]=Ap,Op.v[2][0]=Sp,Op.v[2][1]=Ap+Tp,Op.v[3][0]=Mp?Sp-Rp:Sp+Rp,Op.v[3][1]=Ap,Op.i[0][0]=Mp?Sp-Rp*vp:Sp+Rp*vp,Op.i[0][1]=Ap-Tp,Op.i[1][0]=Mp?Sp+Rp:Sp-Rp,Op.i[1][1]=Ap-Tp*vp,Op.i[2][0]=Mp?Sp+Rp*vp:Sp-Rp*vp,Op.i[2][1]=Ap+Tp,Op.i[3][0]=Mp?Sp-Rp:Sp+Rp,Op.i[3][1]=Ap+Tp*vp,Op.o[0][0]=Mp?Sp+Rp*vp:Sp-Rp*vp,Op.o[0][1]=Ap-Tp,Op.o[1][0]=Mp?Sp+Rp:Sp-Rp,Op.o[1][1]=Ap+Tp*vp,Op.o[2][0]=Mp?Sp-Rp*vp:Sp+Rp*vp,Op.o[2][1]=Ap+Tp,Op.o[3][0]=Mp?Sp-Rp:Sp+Rp,Op.o[3][1]=Ap-Tp*vp}},extendPrototype([DynamicPropertyContainer],bp),bp}(),pp=function(){function vp(bp,Ep){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=bp,this.comp=bp.comp,this.data=Ep,this.frameId=-1,this.d=Ep.d,this.initDynamicPropertyContainer(bp),Ep.sy===1?(this.ir=PropertyFactory.getProp(bp,Ep.ir,0,0,this),this.is=PropertyFactory.getProp(bp,Ep.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(bp,Ep.pt,0,0,this),this.p=PropertyFactory.getProp(bp,Ep.p,1,0,this),this.r=PropertyFactory.getProp(bp,Ep.r,0,degToRads,this),this.or=PropertyFactory.getProp(bp,Ep.or,0,0,this),this.os=PropertyFactory.getProp(bp,Ep.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return vp.prototype={reset:ap,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var Ep=Math.floor(this.pt.v)*2,Sp=Math.PI*2/Ep,Ap=!0,Rp=this.or.v,Tp=this.ir.v,Mp=this.os.v,Op=this.is.v,Pp=2*Math.PI*Rp/(Ep*2),$p=2*Math.PI*Tp/(Ep*2),zp,Dp,Fp,jp,Lp=-Math.PI/2;Lp+=this.r.v;var Bp=this.data.d===3?-1:1;for(this.v._length=0,zp=0;zp<Ep;zp+=1){Dp=Ap?Rp:Tp,Fp=Ap?Mp:Op,jp=Ap?Pp:$p;var Ip=Dp*Math.cos(Lp),kp=Dp*Math.sin(Lp),Up=Ip===0&&kp===0?0:kp/Math.sqrt(Ip*Ip+kp*kp),Gp=Ip===0&&kp===0?0:-Ip/Math.sqrt(Ip*Ip+kp*kp);Ip+=+this.p.v[0],kp+=+this.p.v[1],this.v.setTripleAt(Ip,kp,Ip-Up*jp*Fp*Bp,kp-Gp*jp*Fp*Bp,Ip+Up*jp*Fp*Bp,kp+Gp*jp*Fp*Bp,zp,!0),Ap=!Ap,Lp+=Sp*Bp}},convertPolygonToPath:function(){var Ep=Math.floor(this.pt.v),Sp=Math.PI*2/Ep,Ap=this.or.v,Rp=this.os.v,Tp=2*Math.PI*Ap/(Ep*4),Mp,Op=-Math.PI*.5,Pp=this.data.d===3?-1:1;for(Op+=this.r.v,this.v._length=0,Mp=0;Mp<Ep;Mp+=1){var $p=Ap*Math.cos(Op),zp=Ap*Math.sin(Op),Dp=$p===0&&zp===0?0:zp/Math.sqrt($p*$p+zp*zp),Fp=$p===0&&zp===0?0:-$p/Math.sqrt($p*$p+zp*zp);$p+=+this.p.v[0],zp+=+this.p.v[1],this.v.setTripleAt($p,zp,$p-Dp*Tp*Rp*Pp,zp-Fp*Tp*Rp*Pp,$p+Dp*Tp*Rp*Pp,zp+Fp*Tp*Rp*Pp,Mp,!0),Op+=Sp*Pp}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],vp),vp}(),mp=function(){function vp(bp,Ep){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=bp,this.comp=bp.comp,this.frameId=-1,this.d=Ep.d,this.initDynamicPropertyContainer(bp),this.p=PropertyFactory.getProp(bp,Ep.p,1,0,this),this.s=PropertyFactory.getProp(bp,Ep.s,1,0,this),this.r=PropertyFactory.getProp(bp,Ep.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return vp.prototype={convertRectToPath:function(){var Ep=this.p.v[0],Sp=this.p.v[1],Ap=this.s.v[0]/2,Rp=this.s.v[1]/2,Tp=bmMin(Ap,Rp,this.r.v),Mp=Tp*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(Ep+Ap,Sp-Rp+Tp,Ep+Ap,Sp-Rp+Tp,Ep+Ap,Sp-Rp+Mp,0,!0),this.v.setTripleAt(Ep+Ap,Sp+Rp-Tp,Ep+Ap,Sp+Rp-Mp,Ep+Ap,Sp+Rp-Tp,1,!0),Tp!==0?(this.v.setTripleAt(Ep+Ap-Tp,Sp+Rp,Ep+Ap-Tp,Sp+Rp,Ep+Ap-Mp,Sp+Rp,2,!0),this.v.setTripleAt(Ep-Ap+Tp,Sp+Rp,Ep-Ap+Mp,Sp+Rp,Ep-Ap+Tp,Sp+Rp,3,!0),this.v.setTripleAt(Ep-Ap,Sp+Rp-Tp,Ep-Ap,Sp+Rp-Tp,Ep-Ap,Sp+Rp-Mp,4,!0),this.v.setTripleAt(Ep-Ap,Sp-Rp+Tp,Ep-Ap,Sp-Rp+Mp,Ep-Ap,Sp-Rp+Tp,5,!0),this.v.setTripleAt(Ep-Ap+Tp,Sp-Rp,Ep-Ap+Tp,Sp-Rp,Ep-Ap+Mp,Sp-Rp,6,!0),this.v.setTripleAt(Ep+Ap-Tp,Sp-Rp,Ep+Ap-Mp,Sp-Rp,Ep+Ap-Tp,Sp-Rp,7,!0)):(this.v.setTripleAt(Ep-Ap,Sp+Rp,Ep-Ap+Mp,Sp+Rp,Ep-Ap,Sp+Rp,2),this.v.setTripleAt(Ep-Ap,Sp-Rp,Ep-Ap,Sp-Rp+Mp,Ep-Ap,Sp-Rp,3))):(this.v.setTripleAt(Ep+Ap,Sp-Rp+Tp,Ep+Ap,Sp-Rp+Mp,Ep+Ap,Sp-Rp+Tp,0,!0),Tp!==0?(this.v.setTripleAt(Ep+Ap-Tp,Sp-Rp,Ep+Ap-Tp,Sp-Rp,Ep+Ap-Mp,Sp-Rp,1,!0),this.v.setTripleAt(Ep-Ap+Tp,Sp-Rp,Ep-Ap+Mp,Sp-Rp,Ep-Ap+Tp,Sp-Rp,2,!0),this.v.setTripleAt(Ep-Ap,Sp-Rp+Tp,Ep-Ap,Sp-Rp+Tp,Ep-Ap,Sp-Rp+Mp,3,!0),this.v.setTripleAt(Ep-Ap,Sp+Rp-Tp,Ep-Ap,Sp+Rp-Mp,Ep-Ap,Sp+Rp-Tp,4,!0),this.v.setTripleAt(Ep-Ap+Tp,Sp+Rp,Ep-Ap+Tp,Sp+Rp,Ep-Ap+Mp,Sp+Rp,5,!0),this.v.setTripleAt(Ep+Ap-Tp,Sp+Rp,Ep+Ap-Mp,Sp+Rp,Ep+Ap-Tp,Sp+Rp,6,!0),this.v.setTripleAt(Ep+Ap,Sp+Rp-Tp,Ep+Ap,Sp+Rp-Tp,Ep+Ap,Sp+Rp-Mp,7,!0)):(this.v.setTripleAt(Ep-Ap,Sp-Rp,Ep-Ap+Mp,Sp-Rp,Ep-Ap,Sp-Rp,1,!0),this.v.setTripleAt(Ep-Ap,Sp+Rp,Ep-Ap,Sp+Rp-Mp,Ep-Ap,Sp+Rp,2,!0),this.v.setTripleAt(Ep+Ap,Sp+Rp,Ep+Ap-Mp,Sp+Rp,Ep+Ap,Sp+Rp,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:ap},extendPrototype([DynamicPropertyContainer],vp),vp}();function gp(vp,bp,Ep){var Sp;if(Ep===3||Ep===4){var Ap=Ep===3?bp.pt:bp.ks,Rp=Ap.k;Rp.length?Sp=new hp(vp,bp,Ep):Sp=new cp(vp,bp,Ep)}else Ep===5?Sp=new mp(vp,bp):Ep===6?Sp=new fp(vp,bp):Ep===7&&(Sp=new pp(vp,bp));return Sp.k&&vp.addDynamicProperty(Sp),Sp}function yp(){return cp}function xp(){return hp}var _p={};return _p.getShapeProp=gp,_p.getConstructorFunction=yp,_p.getKeyframedConstructorFunction=xp,_p}();/*!
 Transformation Matrix v2.0
 (c) Epistemex 2014-2015
 www.epistemex.com
 By Ken Fyrstenberg
 Contributions by leeoniya.
 License: MIT, header required.
 */var Matrix=function(){var rp=Math.cos,_d=Math.sin,np=Math.tan,ap=Math.round;function sp(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function lp(Ip){if(Ip===0)return this;var kp=rp(Ip),Up=_d(Ip);return this._t(kp,-Up,0,0,Up,kp,0,0,0,0,1,0,0,0,0,1)}function up(Ip){if(Ip===0)return this;var kp=rp(Ip),Up=_d(Ip);return this._t(1,0,0,0,0,kp,-Up,0,0,Up,kp,0,0,0,0,1)}function cp(Ip){if(Ip===0)return this;var kp=rp(Ip),Up=_d(Ip);return this._t(kp,0,Up,0,0,1,0,0,-Up,0,kp,0,0,0,0,1)}function dp(Ip){if(Ip===0)return this;var kp=rp(Ip),Up=_d(Ip);return this._t(kp,-Up,0,0,Up,kp,0,0,0,0,1,0,0,0,0,1)}function hp(Ip,kp){return this._t(1,kp,Ip,1,0,0)}function fp(Ip,kp){return this.shear(np(Ip),np(kp))}function pp(Ip,kp){var Up=rp(kp),Gp=_d(kp);return this._t(Up,Gp,0,0,-Gp,Up,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,np(Ip),1,0,0,0,0,1,0,0,0,0,1)._t(Up,-Gp,0,0,Gp,Up,0,0,0,0,1,0,0,0,0,1)}function mp(Ip,kp,Up){return!Up&&Up!==0&&(Up=1),Ip===1&&kp===1&&Up===1?this:this._t(Ip,0,0,0,0,kp,0,0,0,0,Up,0,0,0,0,1)}function gp(Ip,kp,Up,Gp,Wp,Qp,Xp,rm,Kp,lm,cm,gm,Mm,dm,em,sm){return this.props[0]=Ip,this.props[1]=kp,this.props[2]=Up,this.props[3]=Gp,this.props[4]=Wp,this.props[5]=Qp,this.props[6]=Xp,this.props[7]=rm,this.props[8]=Kp,this.props[9]=lm,this.props[10]=cm,this.props[11]=gm,this.props[12]=Mm,this.props[13]=dm,this.props[14]=em,this.props[15]=sm,this}function yp(Ip,kp,Up){return Up=Up||0,Ip!==0||kp!==0||Up!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,Ip,kp,Up,1):this}function xp(Ip,kp,Up,Gp,Wp,Qp,Xp,rm,Kp,lm,cm,gm,Mm,dm,em,sm){var Zp=this.props;if(Ip===1&&kp===0&&Up===0&&Gp===0&&Wp===0&&Qp===1&&Xp===0&&rm===0&&Kp===0&&lm===0&&cm===1&&gm===0)return Zp[12]=Zp[12]*Ip+Zp[15]*Mm,Zp[13]=Zp[13]*Qp+Zp[15]*dm,Zp[14]=Zp[14]*cm+Zp[15]*em,Zp[15]*=sm,this._identityCalculated=!1,this;var mm=Zp[0],fm=Zp[1],_m=Zp[2],zm=Zp[3],tm=Zp[4],Jp=Zp[5],pm=Zp[6],km=Zp[7],ym=Zp[8],Em=Zp[9],Bm=Zp[10],Pm=Zp[11],Im=Zp[12],Dm=Zp[13],jm=Zp[14],Fm=Zp[15];return Zp[0]=mm*Ip+fm*Wp+_m*Kp+zm*Mm,Zp[1]=mm*kp+fm*Qp+_m*lm+zm*dm,Zp[2]=mm*Up+fm*Xp+_m*cm+zm*em,Zp[3]=mm*Gp+fm*rm+_m*gm+zm*sm,Zp[4]=tm*Ip+Jp*Wp+pm*Kp+km*Mm,Zp[5]=tm*kp+Jp*Qp+pm*lm+km*dm,Zp[6]=tm*Up+Jp*Xp+pm*cm+km*em,Zp[7]=tm*Gp+Jp*rm+pm*gm+km*sm,Zp[8]=ym*Ip+Em*Wp+Bm*Kp+Pm*Mm,Zp[9]=ym*kp+Em*Qp+Bm*lm+Pm*dm,Zp[10]=ym*Up+Em*Xp+Bm*cm+Pm*em,Zp[11]=ym*Gp+Em*rm+Bm*gm+Pm*sm,Zp[12]=Im*Ip+Dm*Wp+jm*Kp+Fm*Mm,Zp[13]=Im*kp+Dm*Qp+jm*lm+Fm*dm,Zp[14]=Im*Up+Dm*Xp+jm*cm+Fm*em,Zp[15]=Im*Gp+Dm*rm+jm*gm+Fm*sm,this._identityCalculated=!1,this}function _p(Ip){var kp=Ip.props;return this.transform(kp[0],kp[1],kp[2],kp[3],kp[4],kp[5],kp[6],kp[7],kp[8],kp[9],kp[10],kp[11],kp[12],kp[13],kp[14],kp[15])}function vp(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function bp(Ip){for(var kp=0;kp<16;){if(Ip.props[kp]!==this.props[kp])return!1;kp+=1}return!0}function Ep(Ip){var kp;for(kp=0;kp<16;kp+=1)Ip.props[kp]=this.props[kp];return Ip}function Sp(Ip){var kp;for(kp=0;kp<16;kp+=1)this.props[kp]=Ip[kp]}function Ap(Ip,kp,Up){return{x:Ip*this.props[0]+kp*this.props[4]+Up*this.props[8]+this.props[12],y:Ip*this.props[1]+kp*this.props[5]+Up*this.props[9]+this.props[13],z:Ip*this.props[2]+kp*this.props[6]+Up*this.props[10]+this.props[14]}}function Rp(Ip,kp,Up){return Ip*this.props[0]+kp*this.props[4]+Up*this.props[8]+this.props[12]}function Tp(Ip,kp,Up){return Ip*this.props[1]+kp*this.props[5]+Up*this.props[9]+this.props[13]}function Mp(Ip,kp,Up){return Ip*this.props[2]+kp*this.props[6]+Up*this.props[10]+this.props[14]}function Op(){var Ip=this.props[0]*this.props[5]-this.props[1]*this.props[4],kp=this.props[5]/Ip,Up=-this.props[1]/Ip,Gp=-this.props[4]/Ip,Wp=this.props[0]/Ip,Qp=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/Ip,Xp=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/Ip,rm=new Matrix;return rm.props[0]=kp,rm.props[1]=Up,rm.props[4]=Gp,rm.props[5]=Wp,rm.props[12]=Qp,rm.props[13]=Xp,rm}function Pp(Ip){var kp=this.getInverseMatrix();return kp.applyToPointArray(Ip[0],Ip[1],Ip[2]||0)}function $p(Ip){var kp,Up=Ip.length,Gp=[];for(kp=0;kp<Up;kp+=1)Gp[kp]=Pp(Ip[kp]);return Gp}function zp(Ip,kp,Up){var Gp=createTypedArray("float32",6);if(this.isIdentity())Gp[0]=Ip[0],Gp[1]=Ip[1],Gp[2]=kp[0],Gp[3]=kp[1],Gp[4]=Up[0],Gp[5]=Up[1];else{var Wp=this.props[0],Qp=this.props[1],Xp=this.props[4],rm=this.props[5],Kp=this.props[12],lm=this.props[13];Gp[0]=Ip[0]*Wp+Ip[1]*Xp+Kp,Gp[1]=Ip[0]*Qp+Ip[1]*rm+lm,Gp[2]=kp[0]*Wp+kp[1]*Xp+Kp,Gp[3]=kp[0]*Qp+kp[1]*rm+lm,Gp[4]=Up[0]*Wp+Up[1]*Xp+Kp,Gp[5]=Up[0]*Qp+Up[1]*rm+lm}return Gp}function Dp(Ip,kp,Up){var Gp;return this.isIdentity()?Gp=[Ip,kp,Up]:Gp=[Ip*this.props[0]+kp*this.props[4]+Up*this.props[8]+this.props[12],Ip*this.props[1]+kp*this.props[5]+Up*this.props[9]+this.props[13],Ip*this.props[2]+kp*this.props[6]+Up*this.props[10]+this.props[14]],Gp}function Fp(Ip,kp){if(this.isIdentity())return Ip+","+kp;var Up=this.props;return Math.round((Ip*Up[0]+kp*Up[4]+Up[12])*100)/100+","+Math.round((Ip*Up[1]+kp*Up[5]+Up[13])*100)/100}function jp(){for(var Ip=0,kp=this.props,Up="matrix3d(",Gp=1e4;Ip<16;)Up+=ap(kp[Ip]*Gp)/Gp,Up+=Ip===15?")":",",Ip+=1;return Up}function Lp(Ip){var kp=1e4;return Ip<1e-6&&Ip>0||Ip>-1e-6&&Ip<0?ap(Ip*kp)/kp:Ip}function Bp(){var Ip=this.props,kp=Lp(Ip[0]),Up=Lp(Ip[1]),Gp=Lp(Ip[4]),Wp=Lp(Ip[5]),Qp=Lp(Ip[12]),Xp=Lp(Ip[13]);return"matrix("+kp+","+Up+","+Gp+","+Wp+","+Qp+","+Xp+")"}return function(){this.reset=sp,this.rotate=lp,this.rotateX=up,this.rotateY=cp,this.rotateZ=dp,this.skew=fp,this.skewFromAxis=pp,this.shear=hp,this.scale=mp,this.setTransform=gp,this.translate=yp,this.transform=xp,this.multiply=_p,this.applyToPoint=Ap,this.applyToX=Rp,this.applyToY=Tp,this.applyToZ=Mp,this.applyToPointArray=Dp,this.applyToTriplePoints=zp,this.applyToPointStringified=Fp,this.toCSS=jp,this.to2dCSS=Bp,this.clone=Ep,this.cloneFromProps=Sp,this.equals=bp,this.inversePoints=$p,this.inversePoint=Pp,this.getInverseMatrix=Op,this._t=this.transform,this.isIdentity=vp,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(rp){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$3=function(np){return typeof np}:_typeof$3=function(np){return np&&typeof Symbol=="function"&&np.constructor===Symbol&&np!==Symbol.prototype?"symbol":typeof np},_typeof$3(rp)}var lottie={};function setLocation(rp){setLocationHref(rp)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(rp){setSubframeEnabled(rp)}function setPrefix(rp){setIdPrefix(rp)}function loadAnimation(rp){return animationManager.loadAnimation(rp)}function setQuality(rp){if(typeof rp=="string")switch(rp){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break}else!isNaN(rp)&&rp>1&&setDefaultCurveSegments(rp)}function inBrowser(){return typeof navigator<"u"}function installPlugin(rp,_d){rp==="expressions"&&setExpressionsPlugin(_d)}function getFactory(rp){switch(rp){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.12.2";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(rp){for(var _d=queryString.split("&"),np=0;np<_d.length;np+=1){var ap=_d[np].split("=");if(decodeURIComponent(ap[0])==rp)return decodeURIComponent(ap[1])}return null}var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{_typeof$3(exports)!=="object"&&(window.bodymovin=lottie)}catch(rp){}var ShapeModifiers=function(){var rp={},_d={};rp.registerModifier=np,rp.getModifier=ap;function np(sp,lp){_d[sp]||(_d[sp]=lp)}function ap(sp,lp,up){return new _d[sp](lp,up)}return rp}();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(rp){if(!this.closed){rp.sh.container.addDynamicProperty(rp.sh);var _d={shape:rp.sh,data:rp,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(_d),this.addShapeToModifier(_d),this._isAnimated&&rp.setAsAnimated()}},ShapeModifier.prototype.init=function(rp,_d){this.shapes=[],this.elem=rp,this.initDynamicPropertyContainer(rp),this.initModifierProperties(rp,_d),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(rp,_d){this.s=PropertyFactory.getProp(rp,_d.s,0,.01,this),this.e=PropertyFactory.getProp(rp,_d.e,0,.01,this),this.o=PropertyFactory.getProp(rp,_d.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=_d.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(rp){rp.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(rp,_d,np,ap,sp){var lp=[];_d<=1?lp.push({s:rp,e:_d}):rp>=1?lp.push({s:rp-1,e:_d-1}):(lp.push({s:rp,e:1}),lp.push({s:0,e:_d-1}));var up=[],cp,dp=lp.length,hp;for(cp=0;cp<dp;cp+=1)if(hp=lp[cp],!(hp.e*sp<ap||hp.s*sp>ap+np)){var fp,pp;hp.s*sp<=ap?fp=0:fp=(hp.s*sp-ap)/np,hp.e*sp>=ap+np?pp=1:pp=(hp.e*sp-ap)/np,up.push([fp,pp])}return up.length||up.push([0,0]),up},TrimModifier.prototype.releasePathsData=function(rp){var _d,np=rp.length;for(_d=0;_d<np;_d+=1)segmentsLengthPool.release(rp[_d]);return rp.length=0,rp},TrimModifier.prototype.processShapes=function(rp){var _d,np;if(this._mdf||rp){var ap=this.o.v%360/360;if(ap<0&&(ap+=1),this.s.v>1?_d=1+ap:this.s.v<0?_d=0+ap:_d=this.s.v+ap,this.e.v>1?np=1+ap:this.e.v<0?np=0+ap:np=this.e.v+ap,_d>np){var sp=_d;_d=np,np=sp}_d=Math.round(_d*1e4)*1e-4,np=Math.round(np*1e4)*1e-4,this.sValue=_d,this.eValue=np}else _d=this.sValue,np=this.eValue;var lp,up,cp=this.shapes.length,dp,hp,fp,pp,mp,gp=0;if(np===_d)for(up=0;up<cp;up+=1)this.shapes[up].localShapeCollection.releaseShapes(),this.shapes[up].shape._mdf=!0,this.shapes[up].shape.paths=this.shapes[up].localShapeCollection,this._mdf&&(this.shapes[up].pathsData.length=0);else if(np===1&&_d===0||np===0&&_d===1){if(this._mdf)for(up=0;up<cp;up+=1)this.shapes[up].pathsData.length=0,this.shapes[up].shape._mdf=!0}else{var yp=[],xp,_p;for(up=0;up<cp;up+=1)if(xp=this.shapes[up],!xp.shape._mdf&&!this._mdf&&!rp&&this.m!==2)xp.shape.paths=xp.localShapeCollection;else{if(lp=xp.shape.paths,hp=lp._length,mp=0,!xp.shape._mdf&&xp.pathsData.length)mp=xp.totalShapeLength;else{for(fp=this.releasePathsData(xp.pathsData),dp=0;dp<hp;dp+=1)pp=bez.getSegmentsLength(lp.shapes[dp]),fp.push(pp),mp+=pp.totalLength;xp.totalShapeLength=mp,xp.pathsData=fp}gp+=mp,xp.shape._mdf=!0}var vp=_d,bp=np,Ep=0,Sp;for(up=cp-1;up>=0;up-=1)if(xp=this.shapes[up],xp.shape._mdf){for(_p=xp.localShapeCollection,_p.releaseShapes(),this.m===2&&cp>1?(Sp=this.calculateShapeEdges(_d,np,xp.totalShapeLength,Ep,gp),Ep+=xp.totalShapeLength):Sp=[[vp,bp]],hp=Sp.length,dp=0;dp<hp;dp+=1){vp=Sp[dp][0],bp=Sp[dp][1],yp.length=0,bp<=1?yp.push({s:xp.totalShapeLength*vp,e:xp.totalShapeLength*bp}):vp>=1?yp.push({s:xp.totalShapeLength*(vp-1),e:xp.totalShapeLength*(bp-1)}):(yp.push({s:xp.totalShapeLength*vp,e:xp.totalShapeLength}),yp.push({s:0,e:xp.totalShapeLength*(bp-1)}));var Ap=this.addShapes(xp,yp[0]);if(yp[0].s!==yp[0].e){if(yp.length>1){var Rp=xp.shape.paths.shapes[xp.shape.paths._length-1];if(Rp.c){var Tp=Ap.pop();this.addPaths(Ap,_p),Ap=this.addShapes(xp,yp[1],Tp)}else this.addPaths(Ap,_p),Ap=this.addShapes(xp,yp[1])}this.addPaths(Ap,_p)}}xp.shape.paths=_p}}},TrimModifier.prototype.addPaths=function(rp,_d){var np,ap=rp.length;for(np=0;np<ap;np+=1)_d.addShape(rp[np])},TrimModifier.prototype.addSegment=function(rp,_d,np,ap,sp,lp,up){sp.setXYAt(_d[0],_d[1],"o",lp),sp.setXYAt(np[0],np[1],"i",lp+1),up&&sp.setXYAt(rp[0],rp[1],"v",lp),sp.setXYAt(ap[0],ap[1],"v",lp+1)},TrimModifier.prototype.addSegmentFromArray=function(rp,_d,np,ap){_d.setXYAt(rp[1],rp[5],"o",np),_d.setXYAt(rp[2],rp[6],"i",np+1),ap&&_d.setXYAt(rp[0],rp[4],"v",np),_d.setXYAt(rp[3],rp[7],"v",np+1)},TrimModifier.prototype.addShapes=function(rp,_d,np){var ap=rp.pathsData,sp=rp.shape.paths.shapes,lp,up=rp.shape.paths._length,cp,dp,hp=0,fp,pp,mp,gp,yp=[],xp,_p=!0;for(np?(pp=np._length,xp=np._length):(np=shapePool.newElement(),pp=0,xp=0),yp.push(np),lp=0;lp<up;lp+=1){for(mp=ap[lp].lengths,np.c=sp[lp].c,dp=sp[lp].c?mp.length:mp.length+1,cp=1;cp<dp;cp+=1)if(fp=mp[cp-1],hp+fp.addedLength<_d.s)hp+=fp.addedLength,np.c=!1;else if(hp>_d.e){np.c=!1;break}else _d.s<=hp&&_d.e>=hp+fp.addedLength?(this.addSegment(sp[lp].v[cp-1],sp[lp].o[cp-1],sp[lp].i[cp],sp[lp].v[cp],np,pp,_p),_p=!1):(gp=bez.getNewSegment(sp[lp].v[cp-1],sp[lp].v[cp],sp[lp].o[cp-1],sp[lp].i[cp],(_d.s-hp)/fp.addedLength,(_d.e-hp)/fp.addedLength,mp[cp-1]),this.addSegmentFromArray(gp,np,pp,_p),_p=!1,np.c=!1),hp+=fp.addedLength,pp+=1;if(sp[lp].c&&mp.length){if(fp=mp[cp-1],hp<=_d.e){var vp=mp[cp-1].addedLength;_d.s<=hp&&_d.e>=hp+vp?(this.addSegment(sp[lp].v[cp-1],sp[lp].o[cp-1],sp[lp].i[0],sp[lp].v[0],np,pp,_p),_p=!1):(gp=bez.getNewSegment(sp[lp].v[cp-1],sp[lp].v[0],sp[lp].o[cp-1],sp[lp].i[0],(_d.s-hp)/vp,(_d.e-hp)/vp,mp[cp-1]),this.addSegmentFromArray(gp,np,pp,_p),_p=!1,np.c=!1)}else np.c=!1;hp+=fp.addedLength,pp+=1}if(np._length&&(np.setXYAt(np.v[xp][0],np.v[xp][1],"i",xp),np.setXYAt(np.v[np._length-1][0],np.v[np._length-1][1],"o",np._length-1)),hp>_d.e)break;lp<up-1&&(np=shapePool.newElement(),_p=!0,yp.push(np),pp=0)}return yp};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(rp,_d){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(rp,_d.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(rp,_d){var np=_d/100,ap=[0,0],sp=rp._length,lp=0;for(lp=0;lp<sp;lp+=1)ap[0]+=rp.v[lp][0],ap[1]+=rp.v[lp][1];ap[0]/=sp,ap[1]/=sp;var up=shapePool.newElement();up.c=rp.c;var cp,dp,hp,fp,pp,mp;for(lp=0;lp<sp;lp+=1)cp=rp.v[lp][0]+(ap[0]-rp.v[lp][0])*np,dp=rp.v[lp][1]+(ap[1]-rp.v[lp][1])*np,hp=rp.o[lp][0]+(ap[0]-rp.o[lp][0])*-np,fp=rp.o[lp][1]+(ap[1]-rp.o[lp][1])*-np,pp=rp.i[lp][0]+(ap[0]-rp.i[lp][0])*-np,mp=rp.i[lp][1]+(ap[1]-rp.i[lp][1])*-np,up.setTripleAt(cp,dp,hp,fp,pp,mp,lp);return up},PuckerAndBloatModifier.prototype.processShapes=function(rp){var _d,np,ap=this.shapes.length,sp,lp,up=this.amount.v;if(up!==0){var cp,dp;for(np=0;np<ap;np+=1){if(cp=this.shapes[np],dp=cp.localShapeCollection,!(!cp.shape._mdf&&!this._mdf&&!rp))for(dp.releaseShapes(),cp.shape._mdf=!0,_d=cp.shape.paths.shapes,lp=cp.shape.paths._length,sp=0;sp<lp;sp+=1)dp.addShape(this.processPath(_d[sp],up));cp.shape.paths=cp.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var rp=[0,0];function _d(dp){var hp=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||hp,this.a&&dp.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&dp.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&dp.skewFromAxis(-this.sk.v,this.sa.v),this.r?dp.rotate(-this.r.v):dp.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?dp.translate(this.px.v,this.py.v,-this.pz.v):dp.translate(this.px.v,this.py.v,0):dp.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function np(dp){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||dp){var hp;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var fp,pp;if(hp=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(fp=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/hp,0),pp=this.p.getValueAtTime(this.p.keyframes[0].t/hp,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(fp=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/hp,0),pp=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/hp,0)):(fp=this.p.pv,pp=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/hp,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){fp=[],pp=[];var mp=this.px,gp=this.py;mp._caching.lastFrame+mp.offsetTime<=mp.keyframes[0].t?(fp[0]=mp.getValueAtTime((mp.keyframes[0].t+.01)/hp,0),fp[1]=gp.getValueAtTime((gp.keyframes[0].t+.01)/hp,0),pp[0]=mp.getValueAtTime(mp.keyframes[0].t/hp,0),pp[1]=gp.getValueAtTime(gp.keyframes[0].t/hp,0)):mp._caching.lastFrame+mp.offsetTime>=mp.keyframes[mp.keyframes.length-1].t?(fp[0]=mp.getValueAtTime(mp.keyframes[mp.keyframes.length-1].t/hp,0),fp[1]=gp.getValueAtTime(gp.keyframes[gp.keyframes.length-1].t/hp,0),pp[0]=mp.getValueAtTime((mp.keyframes[mp.keyframes.length-1].t-.01)/hp,0),pp[1]=gp.getValueAtTime((gp.keyframes[gp.keyframes.length-1].t-.01)/hp,0)):(fp=[mp.pv,gp.pv],pp[0]=mp.getValueAtTime((mp._caching.lastFrame+mp.offsetTime-.01)/hp,mp.offsetTime),pp[1]=gp.getValueAtTime((gp._caching.lastFrame+gp.offsetTime-.01)/hp,gp.offsetTime))}else pp=rp,fp=pp;this.v.rotate(-Math.atan2(fp[1]-pp[1],fp[0]-pp[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function ap(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}function sp(){}function lp(dp){this._addDynamicProperty(dp),this.elem.addDynamicProperty(dp),this._isDirty=!0}function up(dp,hp,fp){if(this.elem=dp,this.frameId=-1,this.propType="transform",this.data=hp,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(fp||dp),hp.p&&hp.p.s?(this.px=PropertyFactory.getProp(dp,hp.p.x,0,0,this),this.py=PropertyFactory.getProp(dp,hp.p.y,0,0,this),hp.p.z&&(this.pz=PropertyFactory.getProp(dp,hp.p.z,0,0,this))):this.p=PropertyFactory.getProp(dp,hp.p||{k:[0,0,0]},1,0,this),hp.rx){if(this.rx=PropertyFactory.getProp(dp,hp.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(dp,hp.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(dp,hp.rz,0,degToRads,this),hp.or.k[0].ti){var pp,mp=hp.or.k.length;for(pp=0;pp<mp;pp+=1)hp.or.k[pp].to=null,hp.or.k[pp].ti=null}this.or=PropertyFactory.getProp(dp,hp.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(dp,hp.r||{k:0},0,degToRads,this);hp.sk&&(this.sk=PropertyFactory.getProp(dp,hp.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(dp,hp.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(dp,hp.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(dp,hp.s||{k:[100,100,100]},1,.01,this),hp.o?this.o=PropertyFactory.getProp(dp,hp.o,0,.01,dp):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}up.prototype={applyToMatrix:_d,getValue:np,precalculateMatrix:ap,autoOrient:sp},extendPrototype([DynamicPropertyContainer],up),up.prototype.addDynamicProperty=lp,up.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function cp(dp,hp,fp){return new up(dp,hp,fp)}return{getTransformProperty:cp}}();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(rp,_d){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(rp,_d.c,0,null,this),this.o=PropertyFactory.getProp(rp,_d.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(rp,_d.tr,this),this.so=PropertyFactory.getProp(rp,_d.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(rp,_d.tr.eo,0,.01,this),this.data=_d,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(rp,_d,np,ap,sp,lp){var up=lp?-1:1,cp=ap.s.v[0]+(1-ap.s.v[0])*(1-sp),dp=ap.s.v[1]+(1-ap.s.v[1])*(1-sp);rp.translate(ap.p.v[0]*up*sp,ap.p.v[1]*up*sp,ap.p.v[2]),_d.translate(-ap.a.v[0],-ap.a.v[1],ap.a.v[2]),_d.rotate(-ap.r.v*up*sp),_d.translate(ap.a.v[0],ap.a.v[1],ap.a.v[2]),np.translate(-ap.a.v[0],-ap.a.v[1],ap.a.v[2]),np.scale(lp?1/cp:cp,lp?1/dp:dp),np.translate(ap.a.v[0],ap.a.v[1],ap.a.v[2])},RepeaterModifier.prototype.init=function(rp,_d,np,ap){for(this.elem=rp,this.arr=_d,this.pos=np,this.elemsData=ap,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(rp),this.initModifierProperties(rp,_d[np]);np>0;)np-=1,this._elements.unshift(_d[np]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(rp){var _d,np=rp.length;for(_d=0;_d<np;_d+=1)rp[_d]._processed=!1,rp[_d].ty==="gr"&&this.resetElements(rp[_d].it)},RepeaterModifier.prototype.cloneElements=function(rp){var _d=JSON.parse(JSON.stringify(rp));return this.resetElements(_d),_d},RepeaterModifier.prototype.changeGroupRender=function(rp,_d){var np,ap=rp.length;for(np=0;np<ap;np+=1)rp[np]._render=_d,rp[np].ty==="gr"&&this.changeGroupRender(rp[np].it,_d)},RepeaterModifier.prototype.processShapes=function(rp){var _d,np,ap,sp,lp,up=!1;if(this._mdf||rp){var cp=Math.ceil(this.c.v);if(this._groups.length<cp){for(;this._groups.length<cp;){var dp={it:this.cloneElements(this._elements),ty:"gr"};dp.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,dp),this._groups.splice(0,0,dp),this._currentCopies+=1}this.elem.reloadShapes(),up=!0}lp=0;var hp;for(ap=0;ap<=this._groups.length-1;ap+=1){if(hp=lp<cp,this._groups[ap]._render=hp,this.changeGroupRender(this._groups[ap].it,hp),!hp){var fp=this.elemsData[ap].it,pp=fp[fp.length-1];pp.transform.op.v!==0?(pp.transform.op._mdf=!0,pp.transform.op.v=0):pp.transform.op._mdf=!1}lp+=1}this._currentCopies=cp;var mp=this.o.v,gp=mp%1,yp=mp>0?Math.floor(mp):Math.ceil(mp),xp=this.pMatrix.props,_p=this.rMatrix.props,vp=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var bp=0;if(mp>0){for(;bp<yp;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),bp+=1;gp&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,gp,!1),bp+=gp)}else if(mp<0){for(;bp>yp;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),bp-=1;gp&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-gp,!0),bp-=gp)}ap=this.data.m===1?0:this._currentCopies-1,sp=this.data.m===1?1:-1,lp=this._currentCopies;for(var Ep,Sp;lp;){if(_d=this.elemsData[ap].it,np=_d[_d.length-1].transform.mProps.v.props,Sp=np.length,_d[_d.length-1].transform.mProps._mdf=!0,_d[_d.length-1].transform.op._mdf=!0,_d[_d.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*(ap/(this._currentCopies-1)),bp!==0){for((ap!==0&&sp===1||ap!==this._currentCopies-1&&sp===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(_p[0],_p[1],_p[2],_p[3],_p[4],_p[5],_p[6],_p[7],_p[8],_p[9],_p[10],_p[11],_p[12],_p[13],_p[14],_p[15]),this.matrix.transform(vp[0],vp[1],vp[2],vp[3],vp[4],vp[5],vp[6],vp[7],vp[8],vp[9],vp[10],vp[11],vp[12],vp[13],vp[14],vp[15]),this.matrix.transform(xp[0],xp[1],xp[2],xp[3],xp[4],xp[5],xp[6],xp[7],xp[8],xp[9],xp[10],xp[11],xp[12],xp[13],xp[14],xp[15]),Ep=0;Ep<Sp;Ep+=1)np[Ep]=this.matrix.props[Ep];this.matrix.reset()}else for(this.matrix.reset(),Ep=0;Ep<Sp;Ep+=1)np[Ep]=this.matrix.props[Ep];bp+=1,lp-=1,ap+=sp}}else for(lp=this._currentCopies,ap=0,sp=1;lp;)_d=this.elemsData[ap].it,np=_d[_d.length-1].transform.mProps.v.props,_d[_d.length-1].transform.mProps._mdf=!1,_d[_d.length-1].transform.op._mdf=!1,lp-=1,ap+=sp;return up},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(rp,_d){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(rp,_d.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(rp,_d){var np=shapePool.newElement();np.c=rp.c;var ap,sp=rp._length,lp,up,cp,dp,hp,fp,pp=0,mp,gp,yp,xp,_p,vp;for(ap=0;ap<sp;ap+=1)lp=rp.v[ap],cp=rp.o[ap],up=rp.i[ap],lp[0]===cp[0]&&lp[1]===cp[1]&&lp[0]===up[0]&&lp[1]===up[1]?(ap===0||ap===sp-1)&&!rp.c?(np.setTripleAt(lp[0],lp[1],cp[0],cp[1],up[0],up[1],pp),pp+=1):(ap===0?dp=rp.v[sp-1]:dp=rp.v[ap-1],hp=Math.sqrt(Math.pow(lp[0]-dp[0],2)+Math.pow(lp[1]-dp[1],2)),fp=hp?Math.min(hp/2,_d)/hp:0,_p=lp[0]+(dp[0]-lp[0])*fp,mp=_p,vp=lp[1]-(lp[1]-dp[1])*fp,gp=vp,yp=mp-(mp-lp[0])*roundCorner,xp=gp-(gp-lp[1])*roundCorner,np.setTripleAt(mp,gp,yp,xp,_p,vp,pp),pp+=1,ap===sp-1?dp=rp.v[0]:dp=rp.v[ap+1],hp=Math.sqrt(Math.pow(lp[0]-dp[0],2)+Math.pow(lp[1]-dp[1],2)),fp=hp?Math.min(hp/2,_d)/hp:0,yp=lp[0]+(dp[0]-lp[0])*fp,mp=yp,xp=lp[1]+(dp[1]-lp[1])*fp,gp=xp,_p=mp-(mp-lp[0])*roundCorner,vp=gp-(gp-lp[1])*roundCorner,np.setTripleAt(mp,gp,yp,xp,_p,vp,pp),pp+=1):(np.setTripleAt(rp.v[ap][0],rp.v[ap][1],rp.o[ap][0],rp.o[ap][1],rp.i[ap][0],rp.i[ap][1],pp),pp+=1);return np},RoundCornersModifier.prototype.processShapes=function(rp){var _d,np,ap=this.shapes.length,sp,lp,up=this.rd.v;if(up!==0){var cp,dp;for(np=0;np<ap;np+=1){if(cp=this.shapes[np],dp=cp.localShapeCollection,!(!cp.shape._mdf&&!this._mdf&&!rp))for(dp.releaseShapes(),cp.shape._mdf=!0,_d=cp.shape.paths.shapes,lp=cp.shape.paths._length,sp=0;sp<lp;sp+=1)dp.addShape(this.processPath(_d[sp],up));cp.shape.paths=cp.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function floatEqual(rp,_d){return Math.abs(rp-_d)*1e5<=Math.min(Math.abs(rp),Math.abs(_d))}function floatZero(rp){return Math.abs(rp)<=1e-5}function lerp(rp,_d,np){return rp*(1-np)+_d*np}function lerpPoint(rp,_d,np){return[lerp(rp[0],_d[0],np),lerp(rp[1],_d[1],np)]}function quadRoots(rp,_d,np){if(rp===0)return[];var ap=_d*_d-4*rp*np;if(ap<0)return[];var sp=-_d/(2*rp);if(ap===0)return[sp];var lp=Math.sqrt(ap)/(2*rp);return[sp-lp,sp+lp]}function polynomialCoefficients(rp,_d,np,ap){return[-rp+3*_d-3*np+ap,3*rp-6*_d+3*np,-3*rp+3*_d,rp]}function singlePoint(rp){return new PolynomialBezier(rp,rp,rp,rp,!1)}function PolynomialBezier(rp,_d,np,ap,sp){sp&&pointEqual(rp,_d)&&(_d=lerpPoint(rp,ap,1/3)),sp&&pointEqual(np,ap)&&(np=lerpPoint(rp,ap,2/3));var lp=polynomialCoefficients(rp[0],_d[0],np[0],ap[0]),up=polynomialCoefficients(rp[1],_d[1],np[1],ap[1]);this.a=[lp[0],up[0]],this.b=[lp[1],up[1]],this.c=[lp[2],up[2]],this.d=[lp[3],up[3]],this.points=[rp,_d,np,ap]}PolynomialBezier.prototype.point=function(rp){return[((this.a[0]*rp+this.b[0])*rp+this.c[0])*rp+this.d[0],((this.a[1]*rp+this.b[1])*rp+this.c[1])*rp+this.d[1]]},PolynomialBezier.prototype.derivative=function(rp){return[(3*rp*this.a[0]+2*this.b[0])*rp+this.c[0],(3*rp*this.a[1]+2*this.b[1])*rp+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(rp){var _d=this.derivative(rp);return Math.atan2(_d[1],_d[0])},PolynomialBezier.prototype.normalAngle=function(rp){var _d=this.derivative(rp);return Math.atan2(_d[0],_d[1])},PolynomialBezier.prototype.inflectionPoints=function(){var rp=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(rp))return[];var _d=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/rp,np=_d*_d-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/rp;if(np<0)return[];var ap=Math.sqrt(np);return floatZero(ap)?ap>0&&ap<1?[_d]:[]:[_d-ap,_d+ap].filter(function(sp){return sp>0&&sp<1})},PolynomialBezier.prototype.split=function(rp){if(rp<=0)return[singlePoint(this.points[0]),this];if(rp>=1)return[this,singlePoint(this.points[this.points.length-1])];var _d=lerpPoint(this.points[0],this.points[1],rp),np=lerpPoint(this.points[1],this.points[2],rp),ap=lerpPoint(this.points[2],this.points[3],rp),sp=lerpPoint(_d,np,rp),lp=lerpPoint(np,ap,rp),up=lerpPoint(sp,lp,rp);return[new PolynomialBezier(this.points[0],_d,sp,up,!0),new PolynomialBezier(up,lp,ap,this.points[3],!0)]};function extrema(rp,_d){var np=rp.points[0][_d],ap=rp.points[rp.points.length-1][_d];if(np>ap){var sp=ap;ap=np,np=sp}for(var lp=quadRoots(3*rp.a[_d],2*rp.b[_d],rp.c[_d]),up=0;up<lp.length;up+=1)if(lp[up]>0&&lp[up]<1){var cp=rp.point(lp[up])[_d];cp<np?np=cp:cp>ap&&(ap=cp)}return{min:np,max:ap}}PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var rp=this.bounds();return{left:rp.x.min,right:rp.x.max,top:rp.y.min,bottom:rp.y.max,width:rp.x.max-rp.x.min,height:rp.y.max-rp.y.min,cx:(rp.x.max+rp.x.min)/2,cy:(rp.y.max+rp.y.min)/2}};function intersectData(rp,_d,np){var ap=rp.boundingBox();return{cx:ap.cx,cy:ap.cy,width:ap.width,height:ap.height,bez:rp,t:(_d+np)/2,t1:_d,t2:np}}function splitData(rp){var _d=rp.bez.split(.5);return[intersectData(_d[0],rp.t1,rp.t),intersectData(_d[1],rp.t,rp.t2)]}function boxIntersect(rp,_d){return Math.abs(rp.cx-_d.cx)*2<rp.width+_d.width&&Math.abs(rp.cy-_d.cy)*2<rp.height+_d.height}function intersectsImpl(rp,_d,np,ap,sp,lp){if(boxIntersect(rp,_d)){if(np>=lp||rp.width<=ap&&rp.height<=ap&&_d.width<=ap&&_d.height<=ap){sp.push([rp.t,_d.t]);return}var up=splitData(rp),cp=splitData(_d);intersectsImpl(up[0],cp[0],np+1,ap,sp,lp),intersectsImpl(up[0],cp[1],np+1,ap,sp,lp),intersectsImpl(up[1],cp[0],np+1,ap,sp,lp),intersectsImpl(up[1],cp[1],np+1,ap,sp,lp)}}PolynomialBezier.prototype.intersections=function(rp,_d,np){_d===void 0&&(_d=2),np===void 0&&(np=7);var ap=[];return intersectsImpl(intersectData(this,0,1),intersectData(rp,0,1),0,_d,ap,np),ap},PolynomialBezier.shapeSegment=function(rp,_d){var np=(_d+1)%rp.length();return new PolynomialBezier(rp.v[_d],rp.o[_d],rp.i[np],rp.v[np],!0)},PolynomialBezier.shapeSegmentInverted=function(rp,_d){var np=(_d+1)%rp.length();return new PolynomialBezier(rp.v[np],rp.i[np],rp.o[_d],rp.v[_d],!0)};function crossProduct(rp,_d){return[rp[1]*_d[2]-rp[2]*_d[1],rp[2]*_d[0]-rp[0]*_d[2],rp[0]*_d[1]-rp[1]*_d[0]]}function lineIntersection(rp,_d,np,ap){var sp=[rp[0],rp[1],1],lp=[_d[0],_d[1],1],up=[np[0],np[1],1],cp=[ap[0],ap[1],1],dp=crossProduct(crossProduct(sp,lp),crossProduct(up,cp));return floatZero(dp[2])?null:[dp[0]/dp[2],dp[1]/dp[2]]}function polarOffset(rp,_d,np){return[rp[0]+Math.cos(_d)*np,rp[1]-Math.sin(_d)*np]}function pointDistance(rp,_d){return Math.hypot(rp[0]-_d[0],rp[1]-_d[1])}function pointEqual(rp,_d){return floatEqual(rp[0],_d[0])&&floatEqual(rp[1],_d[1])}function ZigZagModifier(){}extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(rp,_d){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(rp,_d.s,0,null,this),this.frequency=PropertyFactory.getProp(rp,_d.r,0,null,this),this.pointsType=PropertyFactory.getProp(rp,_d.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0};function setPoint(rp,_d,np,ap,sp,lp,up){var cp=np-Math.PI/2,dp=np+Math.PI/2,hp=_d[0]+Math.cos(np)*ap*sp,fp=_d[1]-Math.sin(np)*ap*sp;rp.setTripleAt(hp,fp,hp+Math.cos(cp)*lp,fp-Math.sin(cp)*lp,hp+Math.cos(dp)*up,fp-Math.sin(dp)*up,rp.length())}function getPerpendicularVector(rp,_d){var np=[_d[0]-rp[0],_d[1]-rp[1]],ap=-Math.PI*.5,sp=[Math.cos(ap)*np[0]-Math.sin(ap)*np[1],Math.sin(ap)*np[0]+Math.cos(ap)*np[1]];return sp}function getProjectingAngle(rp,_d){var np=_d===0?rp.length()-1:_d-1,ap=(_d+1)%rp.length(),sp=rp.v[np],lp=rp.v[ap],up=getPerpendicularVector(sp,lp);return Math.atan2(0,1)-Math.atan2(up[1],up[0])}function zigZagCorner(rp,_d,np,ap,sp,lp,up){var cp=getProjectingAngle(_d,np),dp=_d.v[np%_d._length],hp=_d.v[np===0?_d._length-1:np-1],fp=_d.v[(np+1)%_d._length],pp=lp===2?Math.sqrt(Math.pow(dp[0]-hp[0],2)+Math.pow(dp[1]-hp[1],2)):0,mp=lp===2?Math.sqrt(Math.pow(dp[0]-fp[0],2)+Math.pow(dp[1]-fp[1],2)):0;setPoint(rp,_d.v[np%_d._length],cp,up,ap,mp/((sp+1)*2),pp/((sp+1)*2))}function zigZagSegment(rp,_d,np,ap,sp,lp){for(var up=0;up<ap;up+=1){var cp=(up+1)/(ap+1),dp=sp===2?Math.sqrt(Math.pow(_d.points[3][0]-_d.points[0][0],2)+Math.pow(_d.points[3][1]-_d.points[0][1],2)):0,hp=_d.normalAngle(cp),fp=_d.point(cp);setPoint(rp,fp,hp,lp,np,dp/((ap+1)*2),dp/((ap+1)*2)),lp=-lp}return lp}ZigZagModifier.prototype.processPath=function(rp,_d,np,ap){var sp=rp._length,lp=shapePool.newElement();if(lp.c=rp.c,rp.c||(sp-=1),sp===0)return lp;var up=-1,cp=PolynomialBezier.shapeSegment(rp,0);zigZagCorner(lp,rp,0,_d,np,ap,up);for(var dp=0;dp<sp;dp+=1)up=zigZagSegment(lp,cp,_d,np,ap,-up),dp===sp-1&&!rp.c?cp=null:cp=PolynomialBezier.shapeSegment(rp,(dp+1)%sp),zigZagCorner(lp,rp,dp+1,_d,np,ap,up);return lp},ZigZagModifier.prototype.processShapes=function(rp){var _d,np,ap=this.shapes.length,sp,lp,up=this.amplitude.v,cp=Math.max(0,Math.round(this.frequency.v)),dp=this.pointsType.v;if(up!==0){var hp,fp;for(np=0;np<ap;np+=1){if(hp=this.shapes[np],fp=hp.localShapeCollection,!(!hp.shape._mdf&&!this._mdf&&!rp))for(fp.releaseShapes(),hp.shape._mdf=!0,_d=hp.shape.paths.shapes,lp=hp.shape.paths._length,sp=0;sp<lp;sp+=1)fp.addShape(this.processPath(_d[sp],up,cp,dp));hp.shape.paths=hp.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function linearOffset(rp,_d,np){var ap=Math.atan2(_d[0]-rp[0],_d[1]-rp[1]);return[polarOffset(rp,ap,np),polarOffset(_d,ap,np)]}function offsetSegment(rp,_d){var np,ap,sp,lp,up,cp,dp;dp=linearOffset(rp.points[0],rp.points[1],_d),np=dp[0],ap=dp[1],dp=linearOffset(rp.points[1],rp.points[2],_d),sp=dp[0],lp=dp[1],dp=linearOffset(rp.points[2],rp.points[3],_d),up=dp[0],cp=dp[1];var hp=lineIntersection(np,ap,sp,lp);hp===null&&(hp=ap);var fp=lineIntersection(up,cp,sp,lp);return fp===null&&(fp=up),new PolynomialBezier(np,hp,fp,cp)}function joinLines(rp,_d,np,ap,sp){var lp=_d.points[3],up=np.points[0];if(ap===3||pointEqual(lp,up))return lp;if(ap===2){var cp=-_d.tangentAngle(1),dp=-np.tangentAngle(0)+Math.PI,hp=lineIntersection(lp,polarOffset(lp,cp+Math.PI/2,100),up,polarOffset(up,cp+Math.PI/2,100)),fp=hp?pointDistance(hp,lp):pointDistance(lp,up)/2,pp=polarOffset(lp,cp,2*fp*roundCorner);return rp.setXYAt(pp[0],pp[1],"o",rp.length()-1),pp=polarOffset(up,dp,2*fp*roundCorner),rp.setTripleAt(up[0],up[1],up[0],up[1],pp[0],pp[1],rp.length()),up}var mp=pointEqual(lp,_d.points[2])?_d.points[0]:_d.points[2],gp=pointEqual(up,np.points[1])?np.points[3]:np.points[1],yp=lineIntersection(mp,lp,up,gp);return yp&&pointDistance(yp,lp)<sp?(rp.setTripleAt(yp[0],yp[1],yp[0],yp[1],yp[0],yp[1],rp.length()),yp):lp}function getIntersection(rp,_d){var np=rp.intersections(_d);return np.length&&floatEqual(np[0][0],1)&&np.shift(),np.length?np[0]:null}function pruneSegmentIntersection(rp,_d){var np=rp.slice(),ap=_d.slice(),sp=getIntersection(rp[rp.length-1],_d[0]);return sp&&(np[rp.length-1]=rp[rp.length-1].split(sp[0])[0],ap[0]=_d[0].split(sp[1])[1]),rp.length>1&&_d.length>1&&(sp=getIntersection(rp[0],_d[_d.length-1]),sp)?[[rp[0].split(sp[0])[0]],[_d[_d.length-1].split(sp[1])[1]]]:[np,ap]}function pruneIntersections(rp){for(var _d,np=1;np<rp.length;np+=1)_d=pruneSegmentIntersection(rp[np-1],rp[np]),rp[np-1]=_d[0],rp[np]=_d[1];return rp.length>1&&(_d=pruneSegmentIntersection(rp[rp.length-1],rp[0]),rp[rp.length-1]=_d[0],rp[0]=_d[1]),rp}function offsetSegmentSplit(rp,_d){var np=rp.inflectionPoints(),ap,sp,lp,up;if(np.length===0)return[offsetSegment(rp,_d)];if(np.length===1||floatEqual(np[1],1))return lp=rp.split(np[0]),ap=lp[0],sp=lp[1],[offsetSegment(ap,_d),offsetSegment(sp,_d)];lp=rp.split(np[0]),ap=lp[0];var cp=(np[1]-np[0])/(1-np[0]);return lp=lp[1].split(cp),up=lp[0],sp=lp[1],[offsetSegment(ap,_d),offsetSegment(up,_d),offsetSegment(sp,_d)]}function OffsetPathModifier(){}extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(rp,_d){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(rp,_d.a,0,null,this),this.miterLimit=PropertyFactory.getProp(rp,_d.ml,0,null,this),this.lineJoin=_d.lj,this._isAnimated=this.amount.effectsSequence.length!==0},OffsetPathModifier.prototype.processPath=function(rp,_d,np,ap){var sp=shapePool.newElement();sp.c=rp.c;var lp=rp.length();rp.c||(lp-=1);var up,cp,dp,hp=[];for(up=0;up<lp;up+=1)dp=PolynomialBezier.shapeSegment(rp,up),hp.push(offsetSegmentSplit(dp,_d));if(!rp.c)for(up=lp-1;up>=0;up-=1)dp=PolynomialBezier.shapeSegmentInverted(rp,up),hp.push(offsetSegmentSplit(dp,_d));hp=pruneIntersections(hp);var fp=null,pp=null;for(up=0;up<hp.length;up+=1){var mp=hp[up];for(pp&&(fp=joinLines(sp,pp,mp[0],np,ap)),pp=mp[mp.length-1],cp=0;cp<mp.length;cp+=1)dp=mp[cp],fp&&pointEqual(dp.points[0],fp)?sp.setXYAt(dp.points[1][0],dp.points[1][1],"o",sp.length()-1):sp.setTripleAt(dp.points[0][0],dp.points[0][1],dp.points[1][0],dp.points[1][1],dp.points[0][0],dp.points[0][1],sp.length()),sp.setTripleAt(dp.points[3][0],dp.points[3][1],dp.points[3][0],dp.points[3][1],dp.points[2][0],dp.points[2][1],sp.length()),fp=dp.points[3]}return hp.length&&joinLines(sp,pp,hp[0][0],np,ap),sp},OffsetPathModifier.prototype.processShapes=function(rp){var _d,np,ap=this.shapes.length,sp,lp,up=this.amount.v,cp=this.miterLimit.v,dp=this.lineJoin;if(up!==0){var hp,fp;for(np=0;np<ap;np+=1){if(hp=this.shapes[np],fp=hp.localShapeCollection,!(!hp.shape._mdf&&!this._mdf&&!rp))for(fp.releaseShapes(),hp.shape._mdf=!0,_d=hp.shape.paths.shapes,lp=hp.shape.paths._length,sp=0;sp<lp;sp+=1)fp.addShape(this.processPath(_d[sp],up,dp,cp));hp.shape.paths=hp.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function getFontProperties(rp){for(var _d=rp.fStyle?rp.fStyle.split(" "):[],np="normal",ap="normal",sp=_d.length,lp,up=0;up<sp;up+=1)switch(lp=_d[up].toLowerCase(),lp){case"italic":ap="italic";break;case"bold":np="700";break;case"black":np="900";break;case"medium":np="500";break;case"regular":case"normal":np="400";break;case"light":case"thin":np="200";break}return{style:ap,weight:rp.fWeight||np}}var FontManager=function(){var rp=5e3,_d={w:0,size:0,shapes:[],data:{shapes:[]}},np=[];np=np.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var ap=127988,sp=917631,lp=917601,up=917626,cp=65039,dp=8205,hp=127462,fp=127487,pp=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function mp(Lp){var Bp=Lp.split(","),Ip,kp=Bp.length,Up=[];for(Ip=0;Ip<kp;Ip+=1)Bp[Ip]!=="sans-serif"&&Bp[Ip]!=="monospace"&&Up.push(Bp[Ip]);return Up.join(",")}function gp(Lp,Bp){var Ip=createTag("span");Ip.setAttribute("aria-hidden",!0),Ip.style.fontFamily=Bp;var kp=createTag("span");kp.innerText="giItT1WQy@!-/#",Ip.style.position="absolute",Ip.style.left="-10000px",Ip.style.top="-10000px",Ip.style.fontSize="300px",Ip.style.fontVariant="normal",Ip.style.fontStyle="normal",Ip.style.fontWeight="normal",Ip.style.letterSpacing="0",Ip.appendChild(kp),document.body.appendChild(Ip);var Up=kp.offsetWidth;return kp.style.fontFamily=mp(Lp)+", "+Bp,{node:kp,w:Up,parent:Ip}}function yp(){var Lp,Bp=this.fonts.length,Ip,kp,Up=Bp;for(Lp=0;Lp<Bp;Lp+=1)this.fonts[Lp].loaded?Up-=1:this.fonts[Lp].fOrigin==="n"||this.fonts[Lp].origin===0?this.fonts[Lp].loaded=!0:(Ip=this.fonts[Lp].monoCase.node,kp=this.fonts[Lp].monoCase.w,Ip.offsetWidth!==kp?(Up-=1,this.fonts[Lp].loaded=!0):(Ip=this.fonts[Lp].sansCase.node,kp=this.fonts[Lp].sansCase.w,Ip.offsetWidth!==kp&&(Up-=1,this.fonts[Lp].loaded=!0)),this.fonts[Lp].loaded&&(this.fonts[Lp].sansCase.parent.parentNode.removeChild(this.fonts[Lp].sansCase.parent),this.fonts[Lp].monoCase.parent.parentNode.removeChild(this.fonts[Lp].monoCase.parent)));Up!==0&&Date.now()-this.initTime<rp?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function xp(Lp,Bp){var Ip=document.body&&Bp?"svg":"canvas",kp,Up=getFontProperties(Lp);if(Ip==="svg"){var Gp=createNS("text");Gp.style.fontSize="100px",Gp.setAttribute("font-family",Lp.fFamily),Gp.setAttribute("font-style",Up.style),Gp.setAttribute("font-weight",Up.weight),Gp.textContent="1",Lp.fClass?(Gp.style.fontFamily="inherit",Gp.setAttribute("class",Lp.fClass)):Gp.style.fontFamily=Lp.fFamily,Bp.appendChild(Gp),kp=Gp}else{var Wp=new OffscreenCanvas(500,500).getContext("2d");Wp.font=Up.style+" "+Up.weight+" 100px "+Lp.fFamily,kp=Wp}function Qp(Xp){return Ip==="svg"?(kp.textContent=Xp,kp.getComputedTextLength()):kp.measureText(Xp).width}return{measureText:Qp}}function _p(Lp,Bp){if(!Lp){this.isLoaded=!0;return}if(this.chars){this.isLoaded=!0,this.fonts=Lp.list;return}if(!document.body){this.isLoaded=!0,Lp.list.forEach(function(cm){cm.helper=xp(cm),cm.cache={}}),this.fonts=Lp.list;return}var Ip=Lp.list,kp,Up=Ip.length,Gp=Up;for(kp=0;kp<Up;kp+=1){var Wp=!0,Qp,Xp;if(Ip[kp].loaded=!1,Ip[kp].monoCase=gp(Ip[kp].fFamily,"monospace"),Ip[kp].sansCase=gp(Ip[kp].fFamily,"sans-serif"),!Ip[kp].fPath)Ip[kp].loaded=!0,Gp-=1;else if(Ip[kp].fOrigin==="p"||Ip[kp].origin===3){if(Qp=document.querySelectorAll('style[f-forigin="p"][f-family="'+Ip[kp].fFamily+'"], style[f-origin="3"][f-family="'+Ip[kp].fFamily+'"]'),Qp.length>0&&(Wp=!1),Wp){var rm=createTag("style");rm.setAttribute("f-forigin",Ip[kp].fOrigin),rm.setAttribute("f-origin",Ip[kp].origin),rm.setAttribute("f-family",Ip[kp].fFamily),rm.type="text/css",rm.innerText="@font-face {font-family: "+Ip[kp].fFamily+"; font-style: normal; src: url('"+Ip[kp].fPath+"');}",Bp.appendChild(rm)}}else if(Ip[kp].fOrigin==="g"||Ip[kp].origin===1){for(Qp=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),Xp=0;Xp<Qp.length;Xp+=1)Qp[Xp].href.indexOf(Ip[kp].fPath)!==-1&&(Wp=!1);if(Wp){var Kp=createTag("link");Kp.setAttribute("f-forigin",Ip[kp].fOrigin),Kp.setAttribute("f-origin",Ip[kp].origin),Kp.type="text/css",Kp.rel="stylesheet",Kp.href=Ip[kp].fPath,document.body.appendChild(Kp)}}else if(Ip[kp].fOrigin==="t"||Ip[kp].origin===2){for(Qp=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),Xp=0;Xp<Qp.length;Xp+=1)Ip[kp].fPath===Qp[Xp].src&&(Wp=!1);if(Wp){var lm=createTag("link");lm.setAttribute("f-forigin",Ip[kp].fOrigin),lm.setAttribute("f-origin",Ip[kp].origin),lm.setAttribute("rel","stylesheet"),lm.setAttribute("href",Ip[kp].fPath),Bp.appendChild(lm)}}Ip[kp].helper=xp(Ip[kp],Bp),Ip[kp].cache={},this.fonts.push(Ip[kp])}Gp===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}function vp(Lp){if(Lp){this.chars||(this.chars=[]);var Bp,Ip=Lp.length,kp,Up=this.chars.length,Gp;for(Bp=0;Bp<Ip;Bp+=1){for(kp=0,Gp=!1;kp<Up;)this.chars[kp].style===Lp[Bp].style&&this.chars[kp].fFamily===Lp[Bp].fFamily&&this.chars[kp].ch===Lp[Bp].ch&&(Gp=!0),kp+=1;Gp||(this.chars.push(Lp[Bp]),Up+=1)}}}function bp(Lp,Bp,Ip){for(var kp=0,Up=this.chars.length;kp<Up;){if(this.chars[kp].ch===Lp&&this.chars[kp].style===Bp&&this.chars[kp].fFamily===Ip)return this.chars[kp];kp+=1}return(typeof Lp=="string"&&Lp.charCodeAt(0)!==13||!Lp)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",Lp,Bp,Ip)),_d}function Ep(Lp,Bp,Ip){var kp=this.getFontByName(Bp),Up=Lp;if(!kp.cache[Up]){var Gp=kp.helper;if(Lp===" "){var Wp=Gp.measureText("|"+Lp+"|"),Qp=Gp.measureText("||");kp.cache[Up]=(Wp-Qp)/100}else kp.cache[Up]=Gp.measureText(Lp)/100}return kp.cache[Up]*Ip}function Sp(Lp){for(var Bp=0,Ip=this.fonts.length;Bp<Ip;){if(this.fonts[Bp].fName===Lp)return this.fonts[Bp];Bp+=1}return this.fonts[0]}function Ap(Lp){var Bp=0,Ip=Lp.charCodeAt(0);if(Ip>=55296&&Ip<=56319){var kp=Lp.charCodeAt(1);kp>=56320&&kp<=57343&&(Bp=(Ip-55296)*1024+kp-56320+65536)}return Bp}function Rp(Lp,Bp){var Ip=Lp.toString(16)+Bp.toString(16);return pp.indexOf(Ip)!==-1}function Tp(Lp){return Lp===dp}function Mp(Lp){return Lp===cp}function Op(Lp){var Bp=Ap(Lp);return Bp>=hp&&Bp<=fp}function Pp(Lp){return Op(Lp.substr(0,2))&&Op(Lp.substr(2,2))}function $p(Lp){return np.indexOf(Lp)!==-1}function zp(Lp,Bp){var Ip=Ap(Lp.substr(Bp,2));if(Ip!==ap)return!1;var kp=0;for(Bp+=2;kp<5;){if(Ip=Ap(Lp.substr(Bp,2)),Ip<lp||Ip>up)return!1;kp+=1,Bp+=2}return Ap(Lp.substr(Bp,2))===sp}function Dp(){this.isLoaded=!0}var Fp=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};Fp.isModifier=Rp,Fp.isZeroWidthJoiner=Tp,Fp.isFlagEmoji=Pp,Fp.isRegionalCode=Op,Fp.isCombinedCharacter=$p,Fp.isRegionalFlag=zp,Fp.isVariationSelector=Mp,Fp.BLACK_FLAG_CODE_POINT=ap;var jp={addChars:vp,addFonts:_p,getCharData:bp,getFontByName:Sp,measureText:Ep,checkLoadedFonts:yp,setIsLoaded:Dp};return Fp.prototype=jp,Fp}();function SlotManager(rp){this.animationData=rp}SlotManager.prototype.getProp=function(rp){return this.animationData.slots&&this.animationData.slots[rp.sid]?Object.assign(rp,this.animationData.slots[rp.sid].p):rp};function slotFactory(rp){return new SlotManager(rp)}function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(_d){this.renderableComponents.indexOf(_d)===-1&&this.renderableComponents.push(_d)},removeRenderableComponent:function(_d){this.renderableComponents.indexOf(_d)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(_d),1)},prepareRenderableFrame:function(_d){this.checkLayerLimits(_d)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(_d){this.data.ip-this.data.st<=_d&&this.data.op-this.data.st>_d?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var _d,np=this.renderableComponents.length;for(_d=0;_d<np;_d+=1)this.renderableComponents[_d].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=function(){var rp={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(_d){return rp[_d]||""}}();function SliderEffect(rp,_d,np){this.p=PropertyFactory.getProp(_d,rp.v,0,0,np)}function AngleEffect(rp,_d,np){this.p=PropertyFactory.getProp(_d,rp.v,0,0,np)}function ColorEffect(rp,_d,np){this.p=PropertyFactory.getProp(_d,rp.v,1,0,np)}function PointEffect(rp,_d,np){this.p=PropertyFactory.getProp(_d,rp.v,1,0,np)}function LayerIndexEffect(rp,_d,np){this.p=PropertyFactory.getProp(_d,rp.v,0,0,np)}function MaskIndexEffect(rp,_d,np){this.p=PropertyFactory.getProp(_d,rp.v,0,0,np)}function CheckboxEffect(rp,_d,np){this.p=PropertyFactory.getProp(_d,rp.v,0,0,np)}function NoValueEffect(){this.p={}}function EffectsManager(rp,_d){var np=rp.ef||[];this.effectElements=[];var ap,sp=np.length,lp;for(ap=0;ap<sp;ap+=1)lp=new GroupEffect(np[ap],_d),this.effectElements.push(lp)}function GroupEffect(rp,_d){this.init(rp,_d)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(rp,_d){this.data=rp,this.effectElements=[],this.initDynamicPropertyContainer(_d);var np,ap=this.data.ef.length,sp,lp=this.data.ef;for(np=0;np<ap;np+=1){switch(sp=null,lp[np].ty){case 0:sp=new SliderEffect(lp[np],_d,this);break;case 1:sp=new AngleEffect(lp[np],_d,this);break;case 2:sp=new ColorEffect(lp[np],_d,this);break;case 3:sp=new PointEffect(lp[np],_d,this);break;case 4:case 7:sp=new CheckboxEffect(lp[np],_d,this);break;case 10:sp=new LayerIndexEffect(lp[np],_d,this);break;case 11:sp=new MaskIndexEffect(lp[np],_d,this);break;case 5:sp=new EffectsManager(lp[np],_d);break;default:sp=new NoValueEffect(lp[np]);break}sp&&this.effectElements.push(sp)}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var _d=0,np=this.data.masksProperties.length;_d<np;){if(this.data.masksProperties[_d].mode!=="n"&&this.data.masksProperties[_d].cl!==!1)return!0;_d+=1}return!1},initExpressions:function(){var _d=getExpressionInterfaces();if(_d){var np=_d("layer"),ap=_d("effects"),sp=_d("shape"),lp=_d("text"),up=_d("comp");this.layerInterface=np(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var cp=ap.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(cp),this.data.ty===0||this.data.xt?this.compInterface=up(this):this.data.ty===4?(this.layerInterface.shapeInterface=sp(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=lp(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var _d=getBlendMode(this.data.bm),np=this.baseElement||this.layerElement;np.style["mix-blend-mode"]=_d},initBaseData:function(_d,np,ap){this.globalData=np,this.comp=ap,this.data=_d,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(_d,np){var ap,sp=this.dynamicProperties.length;for(ap=0;ap<sp;ap+=1)(np||this._isParent&&this.dynamicProperties[ap].propType==="transform")&&(this.dynamicProperties[ap].getValue(),this.dynamicProperties[ap]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(_d){this.dynamicProperties.indexOf(_d)===-1&&this.dynamicProperties.push(_d)}};function FootageElement(rp,_d,np){this.initFrame(),this.initRenderable(),this.assetData=_d.getAssetData(rp.refId),this.footageData=_d.imageLoader.getAsset(this.assetData),this.initBaseData(rp,_d,np)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var rp=getExpressionInterfaces();if(rp){var _d=rp("footage");this.layerInterface=_d(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData};function AudioElement(rp,_d,np){this.initFrame(),this.initRenderable(),this.assetData=_d.getAssetData(rp.refId),this.initBaseData(rp,_d,np),this._isPlaying=!1,this._canPlay=!1;var ap=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(ap),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=rp.tm?PropertyFactory.getProp(this,rp.tm,0,_d.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,rp.au&&rp.au.lv?rp.au.lv:{k:[100]},1,.01,this)}AudioElement.prototype.prepareFrame=function(rp){if(this.prepareRenderableFrame(rp,!0),this.prepareProperties(rp,!0),this.tm._placeholder)this._currentTime=rp/this.data.sr;else{var _d=this.tm.v;this._currentTime=_d}this._volume=this.lv.v[0];var np=this._volume*this._volumeMultiplier;this._previousVolume!==np&&(this._previousVolume=np,this.audio.volume(np))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(rp){this.audio.rate(rp)},AudioElement.prototype.volume=function(rp){this._volumeMultiplier=rp,this._previousVolume=rp*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(rp){var _d,np=this.layers.length,ap;for(this.completeLayers=!0,_d=np-1;_d>=0;_d-=1)this.elements[_d]||(ap=this.layers[_d],ap.ip-ap.st<=rp-this.layers[_d].st&&ap.op-ap.st>rp-this.layers[_d].st&&this.buildItem(_d)),this.completeLayers=this.elements[_d]?this.completeLayers:!1;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(rp){switch(rp.ty){case 2:return this.createImage(rp);case 0:return this.createComp(rp);case 1:return this.createSolid(rp);case 3:return this.createNull(rp);case 4:return this.createShape(rp);case 5:return this.createText(rp);case 6:return this.createAudio(rp);case 13:return this.createCamera(rp);case 15:return this.createFootage(rp);default:return this.createNull(rp)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(rp){return new AudioElement(rp,this.globalData,this)},BaseRenderer.prototype.createFootage=function(rp){return new FootageElement(rp,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var rp,_d=this.layers.length;for(rp=0;rp<_d;rp+=1)this.buildItem(rp);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(rp){this.completeLayers=!1;var _d,np=rp.length,ap,sp=this.layers.length;for(_d=0;_d<np;_d+=1)for(ap=0;ap<sp;){if(this.layers[ap].id===rp[_d].id){this.layers[ap]=rp[_d];break}ap+=1}},BaseRenderer.prototype.setProjectInterface=function(rp){this.globalData.projectInterface=rp},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(rp,_d,np){for(var ap=this.elements,sp=this.layers,lp=0,up=sp.length;lp<up;)sp[lp].ind==_d&&(!ap[lp]||ap[lp]===!0?(this.buildItem(lp),this.addPendingElement(rp)):(np.push(ap[lp]),ap[lp].setAsParent(),sp[lp].parent!==void 0?this.buildElementParenting(rp,sp[lp].parent,np):rp.setHierarchy(np))),lp+=1},BaseRenderer.prototype.addPendingElement=function(rp){this.pendingElements.push(rp)},BaseRenderer.prototype.searchExtraCompositions=function(rp){var _d,np=rp.length;for(_d=0;_d<np;_d+=1)if(rp[_d].xt){var ap=this.createComp(rp[_d]);ap.initExpressions(),this.globalData.projectInterface.registerComposition(ap)}},BaseRenderer.prototype.getElementById=function(rp){var _d,np=this.elements.length;for(_d=0;_d<np;_d+=1)if(this.elements[_d].data.ind===rp)return this.elements[_d];return null},BaseRenderer.prototype.getElementByPath=function(rp){var _d=rp.shift(),np;if(typeof _d=="number")np=this.elements[_d];else{var ap,sp=this.elements.length;for(ap=0;ap<sp;ap+=1)if(this.elements[ap].data.nm===_d){np=this.elements[ap];break}}return rp.length===0?np:np.getElementByPath(rp)},BaseRenderer.prototype.setupGlobalData=function(rp,_d){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(rp),this.globalData.fontManager.addChars(rp.chars),this.globalData.fontManager.addFonts(rp.fonts,_d),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=rp.fr,this.globalData.nm=rp.nm,this.globalData.compSize={w:rp.w,h:rp.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}TransformElement.prototype={initTransform:function(){var _d=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:_d,localMat:_d,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var _d,np=this.finalTransform.mat,ap=0,sp=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;ap<sp;){if(this.hierarchy[ap].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}ap+=1}if(this.finalTransform._matMdf)for(_d=this.finalTransform.mProp.v.props,np.cloneFromProps(_d),ap=0;ap<sp;ap+=1)np.multiply(this.hierarchy[ap].finalTransform.mProp.v)}this.finalTransform._matMdf&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var _d=0,np=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;_d<np;)this.localTransforms[_d]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[_d]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),_d+=1;if(this.finalTransform._localMatMdf){var ap=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(ap),_d=1;_d<np;_d+=1){var sp=this.localTransforms[_d].matrix;ap.multiply(sp)}ap.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var lp=this.finalTransform.localOpacity;for(_d=0;_d<np;_d+=1)lp*=this.localTransforms[_d].opacity*.01;this.finalTransform.localOpacity=lp}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var _d=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(_d.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;var np=0,ap=_d.length;for(np=0;np<ap;np+=1)this.localTransforms.push(_d[np])}}},globalToLocal:function(_d){var np=[];np.push(this.finalTransform);for(var ap=!0,sp=this.comp;ap;)sp.finalTransform?(sp.data.hasMask&&np.splice(0,0,sp.finalTransform),sp=sp.comp):ap=!1;var lp,up=np.length,cp;for(lp=0;lp<up;lp+=1)cp=np[lp].mat.applyToPointArray(0,0,0),_d=[_d[0]-cp[0],_d[1]-cp[1],0];return _d},mHelper:new Matrix};function MaskElement(rp,_d,np){this.data=rp,this.element=_d,this.globalData=np,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var ap=this.globalData.defs,sp,lp=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(lp),this.solidPath="";var up,cp=this.masksProperties,dp=0,hp=[],fp,pp,mp=createElementID(),gp,yp,xp,_p,vp="clipPath",bp="clip-path";for(sp=0;sp<lp;sp+=1)if((cp[sp].mode!=="a"&&cp[sp].mode!=="n"||cp[sp].inv||cp[sp].o.k!==100||cp[sp].o.x)&&(vp="mask",bp="mask"),(cp[sp].mode==="s"||cp[sp].mode==="i")&&dp===0?(gp=createNS("rect"),gp.setAttribute("fill","#ffffff"),gp.setAttribute("width",this.element.comp.data.w||0),gp.setAttribute("height",this.element.comp.data.h||0),hp.push(gp)):gp=null,up=createNS("path"),cp[sp].mode==="n")this.viewData[sp]={op:PropertyFactory.getProp(this.element,cp[sp].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,cp[sp],3),elem:up,lastPath:""},ap.appendChild(up);else{dp+=1,up.setAttribute("fill",cp[sp].mode==="s"?"#000000":"#ffffff"),up.setAttribute("clip-rule","nonzero");var Ep;if(cp[sp].x.k!==0?(vp="mask",bp="mask",_p=PropertyFactory.getProp(this.element,cp[sp].x,0,null,this.element),Ep=createElementID(),yp=createNS("filter"),yp.setAttribute("id",Ep),xp=createNS("feMorphology"),xp.setAttribute("operator","erode"),xp.setAttribute("in","SourceGraphic"),xp.setAttribute("radius","0"),yp.appendChild(xp),ap.appendChild(yp),up.setAttribute("stroke",cp[sp].mode==="s"?"#000000":"#ffffff")):(xp=null,_p=null),this.storedData[sp]={elem:up,x:_p,expan:xp,lastPath:"",lastOperator:"",filterId:Ep,lastRadius:0},cp[sp].mode==="i"){pp=hp.length;var Sp=createNS("g");for(fp=0;fp<pp;fp+=1)Sp.appendChild(hp[fp]);var Ap=createNS("mask");Ap.setAttribute("mask-type","alpha"),Ap.setAttribute("id",mp+"_"+dp),Ap.appendChild(up),ap.appendChild(Ap),Sp.setAttribute("mask","url("+getLocationHref()+"#"+mp+"_"+dp+")"),hp.length=0,hp.push(Sp)}else hp.push(up);cp[sp].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[sp]={elem:up,lastPath:"",op:PropertyFactory.getProp(this.element,cp[sp].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,cp[sp],3),invRect:gp},this.viewData[sp].prop.k||this.drawPath(cp[sp],this.viewData[sp].prop.v,this.viewData[sp])}for(this.maskElement=createNS(vp),lp=hp.length,sp=0;sp<lp;sp+=1)this.maskElement.appendChild(hp[sp]);dp>0&&(this.maskElement.setAttribute("id",mp),this.element.maskedElement.setAttribute(bp,"url("+getLocationHref()+"#"+mp+")"),ap.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}MaskElement.prototype.getMaskProperty=function(rp){return this.viewData[rp].prop},MaskElement.prototype.renderFrame=function(rp){var _d=this.element.finalTransform.mat,np,ap=this.masksProperties.length;for(np=0;np<ap;np+=1)if((this.viewData[np].prop._mdf||rp)&&this.drawPath(this.masksProperties[np],this.viewData[np].prop.v,this.viewData[np]),(this.viewData[np].op._mdf||rp)&&this.viewData[np].elem.setAttribute("fill-opacity",this.viewData[np].op.v),this.masksProperties[np].mode!=="n"&&(this.viewData[np].invRect&&(this.element.finalTransform.mProp._mdf||rp)&&this.viewData[np].invRect.setAttribute("transform",_d.getInverseMatrix().to2dCSS()),this.storedData[np].x&&(this.storedData[np].x._mdf||rp))){var sp=this.storedData[np].expan;this.storedData[np].x.v<0?(this.storedData[np].lastOperator!=="erode"&&(this.storedData[np].lastOperator="erode",this.storedData[np].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[np].filterId+")")),sp.setAttribute("radius",-this.storedData[np].x.v)):(this.storedData[np].lastOperator!=="dilate"&&(this.storedData[np].lastOperator="dilate",this.storedData[np].elem.setAttribute("filter",null)),this.storedData[np].elem.setAttribute("stroke-width",this.storedData[np].x.v*2))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var rp="M0,0 ";return rp+=" h"+this.globalData.compSize.w,rp+=" v"+this.globalData.compSize.h,rp+=" h-"+this.globalData.compSize.w,rp+=" v-"+this.globalData.compSize.h+" ",rp},MaskElement.prototype.drawPath=function(rp,_d,np){var ap=" M"+_d.v[0][0]+","+_d.v[0][1],sp,lp;for(lp=_d._length,sp=1;sp<lp;sp+=1)ap+=" C"+_d.o[sp-1][0]+","+_d.o[sp-1][1]+" "+_d.i[sp][0]+","+_d.i[sp][1]+" "+_d.v[sp][0]+","+_d.v[sp][1];if(_d.c&&lp>1&&(ap+=" C"+_d.o[sp-1][0]+","+_d.o[sp-1][1]+" "+_d.i[0][0]+","+_d.i[0][1]+" "+_d.v[0][0]+","+_d.v[0][1]),np.lastPath!==ap){var up="";np.elem&&(_d.c&&(up=rp.inv?this.solidPath+ap:ap),np.elem.setAttribute("d",up)),np.lastPath=ap}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var rp={};rp.createFilter=_d,rp.createAlphaToLuminanceFilter=np;function _d(ap,sp){var lp=createNS("filter");return lp.setAttribute("id",ap),sp!==!0&&(lp.setAttribute("filterUnits","objectBoundingBox"),lp.setAttribute("x","0%"),lp.setAttribute("y","0%"),lp.setAttribute("width","100%"),lp.setAttribute("height","100%")),lp}function np(){var ap=createNS("feColorMatrix");return ap.setAttribute("type","matrix"),ap.setAttribute("color-interpolation-filters","sRGB"),ap.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),ap}return rp}(),featureSupport=function(){var rp={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(rp.maskType=!1),/firefox/i.test(navigator.userAgent)&&(rp.svgLumaHidden=!1),rp}(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(rp){var _d,np="SourceGraphic",ap=rp.data.ef?rp.data.ef.length:0,sp=createElementID(),lp=filtersFactory.createFilter(sp,!0),up=0;this.filters=[];var cp;for(_d=0;_d<ap;_d+=1){cp=null;var dp=rp.data.ef[_d].ty;if(registeredEffects$1[dp]){var hp=registeredEffects$1[dp].effect;cp=new hp(lp,rp.effectsManager.effectElements[_d],rp,idPrefix+up,np),np=idPrefix+up,registeredEffects$1[dp].countsAsEffect&&(up+=1)}cp&&this.filters.push(cp)}up&&(rp.globalData.defs.appendChild(lp),rp.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+sp+")")),this.filters.length&&rp.addRenderableComponent(this)}SVGEffects.prototype.renderFrame=function(rp){var _d,np=this.filters.length;for(_d=0;_d<np;_d+=1)this.filters[_d].renderFrame(rp)},SVGEffects.prototype.getEffects=function(rp){var _d,np=this.filters.length,ap=[];for(_d=0;_d<np;_d+=1)this.filters[_d].type===rp&&ap.push(this.filters[_d]);return ap};function registerEffect$1(rp,_d,np){registeredEffects$1[rp]={effect:_d,countsAsEffect:np}}function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var _d=null;if(this.data.td){this.matteMasks={};var np=createNS("g");np.setAttribute("id",this.layerId),np.appendChild(this.layerElement),_d=np,this.globalData.defs.appendChild(np)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),_d=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var ap=createNS("clipPath"),sp=createNS("path");sp.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var lp=createElementID();if(ap.setAttribute("id",lp),ap.appendChild(sp),this.globalData.defs.appendChild(ap),this.checkMasks()){var up=createNS("g");up.setAttribute("clip-path","url("+getLocationHref()+"#"+lp+")"),up.appendChild(this.layerElement),this.transformedElement=up,_d?_d.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+lp+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(_d){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[_d]){var np=this.layerId+"_"+_d,ap,sp,lp,up;if(_d===1||_d===3){var cp=createNS("mask");cp.setAttribute("id",np),cp.setAttribute("mask-type",_d===3?"luminance":"alpha"),lp=createNS("use"),lp.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),cp.appendChild(lp),this.globalData.defs.appendChild(cp),!featureSupport.maskType&&_d===1&&(cp.setAttribute("mask-type","luminance"),ap=createElementID(),sp=filtersFactory.createFilter(ap),this.globalData.defs.appendChild(sp),sp.appendChild(filtersFactory.createAlphaToLuminanceFilter()),up=createNS("g"),up.appendChild(lp),cp.appendChild(up),up.setAttribute("filter","url("+getLocationHref()+"#"+ap+")"))}else if(_d===2){var dp=createNS("mask");dp.setAttribute("id",np),dp.setAttribute("mask-type","alpha");var hp=createNS("g");dp.appendChild(hp),ap=createElementID(),sp=filtersFactory.createFilter(ap);var fp=createNS("feComponentTransfer");fp.setAttribute("in","SourceGraphic"),sp.appendChild(fp);var pp=createNS("feFuncA");pp.setAttribute("type","table"),pp.setAttribute("tableValues","1.0 0.0"),fp.appendChild(pp),this.globalData.defs.appendChild(sp);var mp=createNS("rect");mp.setAttribute("width",this.comp.data.w),mp.setAttribute("height",this.comp.data.h),mp.setAttribute("x","0"),mp.setAttribute("y","0"),mp.setAttribute("fill","#ffffff"),mp.setAttribute("opacity","0"),hp.setAttribute("filter","url("+getLocationHref()+"#"+ap+")"),hp.appendChild(mp),lp=createNS("use"),lp.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),hp.appendChild(lp),featureSupport.maskType||(dp.setAttribute("mask-type","luminance"),sp.appendChild(filtersFactory.createAlphaToLuminanceFilter()),up=createNS("g"),hp.appendChild(mp),up.appendChild(this.layerElement),hp.appendChild(up)),this.globalData.defs.appendChild(dp)}this.matteMasks[_d]=np}return this.matteMasks[_d]},setMatte:function(_d){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+_d+")")}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(_d){this.hierarchy=_d},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}};function RenderableDOMElement(){}(function(){var rp={initElement:function(np,ap,sp){this.initFrame(),this.initBaseData(np,ap,sp),this.initTransform(np,ap,sp),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var np=this.baseElement||this.layerElement;np.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var np=this.baseElement||this.layerElement;np.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(np){this._mdf=!1,this.prepareRenderableFrame(np),this.prepareProperties(np,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(rp)],RenderableDOMElement)})();function IImageElement(rp,_d,np){this.assetData=_d.getAssetData(rp.refId),this.assetData&&this.assetData.sid&&(this.assetData=_d.slotManager.getProp(this.assetData)),this.initElement(rp,_d,np),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var rp=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",rp),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect};function ProcessedElement(rp,_d){this.elem=rp,this.pos=_d}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(_d){var np,ap=this.shapeModifiers.length;for(np=0;np<ap;np+=1)this.shapeModifiers[np].addShape(_d)},isShapeInAnimatedModifiers:function(_d){for(var np=0,ap=this.shapeModifiers.length;np<ap;)if(this.shapeModifiers[np].isAnimatedWithShape(_d))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var _d,np=this.shapes.length;for(_d=0;_d<np;_d+=1)this.shapes[_d].sh.reset();np=this.shapeModifiers.length;var ap;for(_d=np-1;_d>=0&&(ap=this.shapeModifiers[_d].processShapes(this._isFirstFrame),!ap);_d-=1);}},searchProcessedElement:function(_d){for(var np=this.processedElements,ap=0,sp=np.length;ap<sp;){if(np[ap].elem===_d)return np[ap].pos;ap+=1}return 0},addProcessedElement:function(_d,np){for(var ap=this.processedElements,sp=ap.length;sp;)if(sp-=1,ap[sp].elem===_d){ap[sp].pos=np;return}ap.push(new ProcessedElement(_d,np))},prepareFrame:function(_d){this.prepareRenderableFrame(_d),this.prepareProperties(_d,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(rp,_d,np){this.caches=[],this.styles=[],this.transformers=rp,this.lStr="",this.sh=np,this.lvl=_d,this._isAnimated=!!np.k;for(var ap=0,sp=rp.length;ap<sp;){if(rp[ap].mProps.dynamicProperties.length){this._isAnimated=!0;break}ap+=1}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0};function SVGStyleData(rp,_d){this.data=rp,this.type=rp.ty,this.d="",this.lvl=_d,this._mdf=!1,this.closed=rp.hd===!0,this.pElem=createNS("path"),this.msElem=null}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1};function DashProperty(rp,_d,np,ap){this.elem=rp,this.frameId=-1,this.dataProps=createSizedArray(_d.length),this.renderer=np,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",_d.length?_d.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(ap);var sp,lp=_d.length||0,up;for(sp=0;sp<lp;sp+=1)up=PropertyFactory.getProp(rp,_d[sp].v,0,0,this),this.k=up.k||this.k,this.dataProps[sp]={n:_d[sp].n,p:up};this.k||this.getValue(!0),this._isAnimated=this.k}DashProperty.prototype.getValue=function(rp){if(!(this.elem.globalData.frameId===this.frameId&&!rp)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||rp,this._mdf)){var _d=0,np=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),_d=0;_d<np;_d+=1)this.dataProps[_d].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[_d].p.v:this.dashArray[_d]=this.dataProps[_d].p.v:this.dashoffset[0]=this.dataProps[_d].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(rp,_d,np){this.initDynamicPropertyContainer(rp),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(rp,_d.o,0,.01,this),this.w=PropertyFactory.getProp(rp,_d.w,0,null,this),this.d=new DashProperty(rp,_d.d||{},"svg",this),this.c=PropertyFactory.getProp(rp,_d.c,1,255,this),this.style=np,this._isAnimated=!!this._isAnimated}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(rp,_d,np){this.initDynamicPropertyContainer(rp),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(rp,_d.o,0,.01,this),this.c=PropertyFactory.getProp(rp,_d.c,1,255,this),this.style=np}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(rp,_d,np){this.initDynamicPropertyContainer(rp),this.getValue=this.iterateDynamicProperties,this.style=np}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(rp,_d,np){this.data=_d,this.c=createTypedArray("uint8c",_d.p*4);var ap=_d.k.k[0].s?_d.k.k[0].s.length-_d.p*4:_d.k.k.length-_d.p*4;this.o=createTypedArray("float32",ap),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=ap,this.initDynamicPropertyContainer(np),this.prop=PropertyFactory.getProp(rp,_d.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}GradientProperty.prototype.comparePoints=function(rp,_d){for(var np=0,ap=this.o.length/2,sp;np<ap;){if(sp=Math.abs(rp[np*4]-rp[_d*4+np*2]),sp>.01)return!1;np+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var rp=0,_d=this.data.k.k.length;rp<_d;){if(!this.comparePoints(this.data.k.k[rp].s,this.data.p))return!1;rp+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(rp){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||rp){var _d,np=this.data.p*4,ap,sp;for(_d=0;_d<np;_d+=1)ap=_d%4===0?100:255,sp=Math.round(this.prop.v[_d]*ap),this.c[_d]!==sp&&(this.c[_d]=sp,this._cmdf=!rp);if(this.o.length)for(np=this.prop.v.length,_d=this.data.p*4;_d<np;_d+=1)ap=_d%2===0?100:1,sp=_d%2===0?Math.round(this.prop.v[_d]*100):this.prop.v[_d],this.o[_d-this.data.p*4]!==sp&&(this.o[_d-this.data.p*4]=sp,this._omdf=!rp);this._mdf=!rp}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(rp,_d,np){this.initDynamicPropertyContainer(rp),this.getValue=this.iterateDynamicProperties,this.initGradientData(rp,_d,np)}SVGGradientFillStyleData.prototype.initGradientData=function(rp,_d,np){this.o=PropertyFactory.getProp(rp,_d.o,0,.01,this),this.s=PropertyFactory.getProp(rp,_d.s,1,null,this),this.e=PropertyFactory.getProp(rp,_d.e,1,null,this),this.h=PropertyFactory.getProp(rp,_d.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(rp,_d.a||{k:0},0,degToRads,this),this.g=new GradientProperty(rp,_d.g,this),this.style=np,this.stops=[],this.setGradientData(np.pElem,_d),this.setGradientOpacity(_d,np),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(rp,_d){var np=createElementID(),ap=createNS(_d.t===1?"linearGradient":"radialGradient");ap.setAttribute("id",np),ap.setAttribute("spreadMethod","pad"),ap.setAttribute("gradientUnits","userSpaceOnUse");var sp=[],lp,up,cp;for(cp=_d.g.p*4,up=0;up<cp;up+=4)lp=createNS("stop"),ap.appendChild(lp),sp.push(lp);rp.setAttribute(_d.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+np+")"),this.gf=ap,this.cst=sp},SVGGradientFillStyleData.prototype.setGradientOpacity=function(rp,_d){if(this.g._hasOpacity&&!this.g._collapsable){var np,ap,sp,lp=createNS("mask"),up=createNS("path");lp.appendChild(up);var cp=createElementID(),dp=createElementID();lp.setAttribute("id",dp);var hp=createNS(rp.t===1?"linearGradient":"radialGradient");hp.setAttribute("id",cp),hp.setAttribute("spreadMethod","pad"),hp.setAttribute("gradientUnits","userSpaceOnUse"),sp=rp.g.k.k[0].s?rp.g.k.k[0].s.length:rp.g.k.k.length;var fp=this.stops;for(ap=rp.g.p*4;ap<sp;ap+=2)np=createNS("stop"),np.setAttribute("stop-color","rgb(255,255,255)"),hp.appendChild(np),fp.push(np);up.setAttribute(rp.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+cp+")"),rp.ty==="gs"&&(up.setAttribute("stroke-linecap",lineCapEnum[rp.lc||2]),up.setAttribute("stroke-linejoin",lineJoinEnum[rp.lj||2]),rp.lj===1&&up.setAttribute("stroke-miterlimit",rp.ml)),this.of=hp,this.ms=lp,this.ost=fp,this.maskId=dp,_d.msElem=up}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(rp,_d,np){this.initDynamicPropertyContainer(rp),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(rp,_d.w,0,null,this),this.d=new DashProperty(rp,_d.d||{},"svg",this),this.initGradientData(rp,_d,np),this._isAnimated=!!this._isAnimated}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(rp,_d,np){this.transform={mProps:rp,op:_d,container:np},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}var buildShapeString=function(_d,np,ap,sp){if(np===0)return"";var lp=_d.o,up=_d.i,cp=_d.v,dp,hp=" M"+sp.applyToPointStringified(cp[0][0],cp[0][1]);for(dp=1;dp<np;dp+=1)hp+=" C"+sp.applyToPointStringified(lp[dp-1][0],lp[dp-1][1])+" "+sp.applyToPointStringified(up[dp][0],up[dp][1])+" "+sp.applyToPointStringified(cp[dp][0],cp[dp][1]);return ap&&np&&(hp+=" C"+sp.applyToPointStringified(lp[dp-1][0],lp[dp-1][1])+" "+sp.applyToPointStringified(up[0][0],up[0][1])+" "+sp.applyToPointStringified(cp[0][0],cp[0][1]),hp+="z"),hp},SVGElementsRenderer=function(){var rp=new Matrix,_d=new Matrix,np={createRenderFunction:ap};function ap(pp){switch(pp.ty){case"fl":return cp;case"gf":return hp;case"gs":return dp;case"st":return fp;case"sh":case"el":case"rc":case"sr":return up;case"tr":return sp;case"no":return lp;default:return null}}function sp(pp,mp,gp){(gp||mp.transform.op._mdf)&&mp.transform.container.setAttribute("opacity",mp.transform.op.v),(gp||mp.transform.mProps._mdf)&&mp.transform.container.setAttribute("transform",mp.transform.mProps.v.to2dCSS())}function lp(){}function up(pp,mp,gp){var yp,xp,_p,vp,bp,Ep,Sp=mp.styles.length,Ap=mp.lvl,Rp,Tp,Mp,Op;for(Ep=0;Ep<Sp;Ep+=1){if(vp=mp.sh._mdf||gp,mp.styles[Ep].lvl<Ap){for(Tp=_d.reset(),Mp=Ap-mp.styles[Ep].lvl,Op=mp.transformers.length-1;!vp&&Mp>0;)vp=mp.transformers[Op].mProps._mdf||vp,Mp-=1,Op-=1;if(vp)for(Mp=Ap-mp.styles[Ep].lvl,Op=mp.transformers.length-1;Mp>0;)Tp.multiply(mp.transformers[Op].mProps.v),Mp-=1,Op-=1}else Tp=rp;if(Rp=mp.sh.paths,xp=Rp._length,vp){for(_p="",yp=0;yp<xp;yp+=1)bp=Rp.shapes[yp],bp&&bp._length&&(_p+=buildShapeString(bp,bp._length,bp.c,Tp));mp.caches[Ep]=_p}else _p=mp.caches[Ep];mp.styles[Ep].d+=pp.hd===!0?"":_p,mp.styles[Ep]._mdf=vp||mp.styles[Ep]._mdf}}function cp(pp,mp,gp){var yp=mp.style;(mp.c._mdf||gp)&&yp.pElem.setAttribute("fill","rgb("+bmFloor(mp.c.v[0])+","+bmFloor(mp.c.v[1])+","+bmFloor(mp.c.v[2])+")"),(mp.o._mdf||gp)&&yp.pElem.setAttribute("fill-opacity",mp.o.v)}function dp(pp,mp,gp){hp(pp,mp,gp),fp(pp,mp,gp)}function hp(pp,mp,gp){var yp=mp.gf,xp=mp.g._hasOpacity,_p=mp.s.v,vp=mp.e.v;if(mp.o._mdf||gp){var bp=pp.ty==="gf"?"fill-opacity":"stroke-opacity";mp.style.pElem.setAttribute(bp,mp.o.v)}if(mp.s._mdf||gp){var Ep=pp.t===1?"x1":"cx",Sp=Ep==="x1"?"y1":"cy";yp.setAttribute(Ep,_p[0]),yp.setAttribute(Sp,_p[1]),xp&&!mp.g._collapsable&&(mp.of.setAttribute(Ep,_p[0]),mp.of.setAttribute(Sp,_p[1]))}var Ap,Rp,Tp,Mp;if(mp.g._cmdf||gp){Ap=mp.cst;var Op=mp.g.c;for(Tp=Ap.length,Rp=0;Rp<Tp;Rp+=1)Mp=Ap[Rp],Mp.setAttribute("offset",Op[Rp*4]+"%"),Mp.setAttribute("stop-color","rgb("+Op[Rp*4+1]+","+Op[Rp*4+2]+","+Op[Rp*4+3]+")")}if(xp&&(mp.g._omdf||gp)){var Pp=mp.g.o;for(mp.g._collapsable?Ap=mp.cst:Ap=mp.ost,Tp=Ap.length,Rp=0;Rp<Tp;Rp+=1)Mp=Ap[Rp],mp.g._collapsable||Mp.setAttribute("offset",Pp[Rp*2]+"%"),Mp.setAttribute("stop-opacity",Pp[Rp*2+1])}if(pp.t===1)(mp.e._mdf||gp)&&(yp.setAttribute("x2",vp[0]),yp.setAttribute("y2",vp[1]),xp&&!mp.g._collapsable&&(mp.of.setAttribute("x2",vp[0]),mp.of.setAttribute("y2",vp[1])));else{var $p;if((mp.s._mdf||mp.e._mdf||gp)&&($p=Math.sqrt(Math.pow(_p[0]-vp[0],2)+Math.pow(_p[1]-vp[1],2)),yp.setAttribute("r",$p),xp&&!mp.g._collapsable&&mp.of.setAttribute("r",$p)),mp.e._mdf||mp.h._mdf||mp.a._mdf||gp){$p||($p=Math.sqrt(Math.pow(_p[0]-vp[0],2)+Math.pow(_p[1]-vp[1],2)));var zp=Math.atan2(vp[1]-_p[1],vp[0]-_p[0]),Dp=mp.h.v;Dp>=1?Dp=.99:Dp<=-1&&(Dp=-.99);var Fp=$p*Dp,jp=Math.cos(zp+mp.a.v)*Fp+_p[0],Lp=Math.sin(zp+mp.a.v)*Fp+_p[1];yp.setAttribute("fx",jp),yp.setAttribute("fy",Lp),xp&&!mp.g._collapsable&&(mp.of.setAttribute("fx",jp),mp.of.setAttribute("fy",Lp))}}}function fp(pp,mp,gp){var yp=mp.style,xp=mp.d;xp&&(xp._mdf||gp)&&xp.dashStr&&(yp.pElem.setAttribute("stroke-dasharray",xp.dashStr),yp.pElem.setAttribute("stroke-dashoffset",xp.dashoffset[0])),mp.c&&(mp.c._mdf||gp)&&yp.pElem.setAttribute("stroke","rgb("+bmFloor(mp.c.v[0])+","+bmFloor(mp.c.v[1])+","+bmFloor(mp.c.v[2])+")"),(mp.o._mdf||gp)&&yp.pElem.setAttribute("stroke-opacity",mp.o.v),(mp.w._mdf||gp)&&(yp.pElem.setAttribute("stroke-width",mp.w.v),yp.msElem&&yp.msElem.setAttribute("stroke-width",mp.w.v))}return np}();function SVGShapeElement(rp,_d,np){this.shapes=[],this.shapesData=rp.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(rp,_d,np),this.prevViewData=[]}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var rp,_d=this.shapes.length,np,ap,sp=this.stylesList.length,lp,up=[],cp=!1;for(ap=0;ap<sp;ap+=1){for(lp=this.stylesList[ap],cp=!1,up.length=0,rp=0;rp<_d;rp+=1)np=this.shapes[rp],np.styles.indexOf(lp)!==-1&&(up.push(np),cp=np._isAnimated||cp);up.length>1&&cp&&this.setShapesAsAnimated(up)}},SVGShapeElement.prototype.setShapesAsAnimated=function(rp){var _d,np=rp.length;for(_d=0;_d<np;_d+=1)rp[_d].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(rp,_d){var np,ap=new SVGStyleData(rp,_d),sp=ap.pElem;if(rp.ty==="st")np=new SVGStrokeStyleData(this,rp,ap);else if(rp.ty==="fl")np=new SVGFillStyleData(this,rp,ap);else if(rp.ty==="gf"||rp.ty==="gs"){var lp=rp.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;np=new lp(this,rp,ap),this.globalData.defs.appendChild(np.gf),np.maskId&&(this.globalData.defs.appendChild(np.ms),this.globalData.defs.appendChild(np.of),sp.setAttribute("mask","url("+getLocationHref()+"#"+np.maskId+")"))}else rp.ty==="no"&&(np=new SVGNoStyleData(this,rp,ap));return(rp.ty==="st"||rp.ty==="gs")&&(sp.setAttribute("stroke-linecap",lineCapEnum[rp.lc||2]),sp.setAttribute("stroke-linejoin",lineJoinEnum[rp.lj||2]),sp.setAttribute("fill-opacity","0"),rp.lj===1&&sp.setAttribute("stroke-miterlimit",rp.ml)),rp.r===2&&sp.setAttribute("fill-rule","evenodd"),rp.ln&&sp.setAttribute("id",rp.ln),rp.cl&&sp.setAttribute("class",rp.cl),rp.bm&&(sp.style["mix-blend-mode"]=getBlendMode(rp.bm)),this.stylesList.push(ap),this.addToAnimatedContents(rp,np),np},SVGShapeElement.prototype.createGroupElement=function(rp){var _d=new ShapeGroupData;return rp.ln&&_d.gr.setAttribute("id",rp.ln),rp.cl&&_d.gr.setAttribute("class",rp.cl),rp.bm&&(_d.gr.style["mix-blend-mode"]=getBlendMode(rp.bm)),_d},SVGShapeElement.prototype.createTransformElement=function(rp,_d){var np=TransformPropertyFactory.getTransformProperty(this,rp,this),ap=new SVGTransformData(np,np.o,_d);return this.addToAnimatedContents(rp,ap),ap},SVGShapeElement.prototype.createShapeElement=function(rp,_d,np){var ap=4;rp.ty==="rc"?ap=5:rp.ty==="el"?ap=6:rp.ty==="sr"&&(ap=7);var sp=ShapePropertyFactory.getShapeProp(this,rp,ap,this),lp=new SVGShapeData(_d,np,sp);return this.shapes.push(lp),this.addShapeToModifiers(lp),this.addToAnimatedContents(rp,lp),lp},SVGShapeElement.prototype.addToAnimatedContents=function(rp,_d){for(var np=0,ap=this.animatedContents.length;np<ap;){if(this.animatedContents[np].element===_d)return;np+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(rp),element:_d,data:rp})},SVGShapeElement.prototype.setElementStyles=function(rp){var _d=rp.styles,np,ap=this.stylesList.length;for(np=0;np<ap;np+=1)this.stylesList[np].closed||_d.push(this.stylesList[np])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var rp,_d=this.itemsData.length;for(rp=0;rp<_d;rp+=1)this.prevViewData[rp]=this.itemsData[rp];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),_d=this.dynamicProperties.length,rp=0;rp<_d;rp+=1)this.dynamicProperties[rp].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(rp,_d,np,ap,sp,lp,up){var cp=[].concat(lp),dp,hp=rp.length-1,fp,pp,mp=[],gp=[],yp,xp,_p;for(dp=hp;dp>=0;dp-=1){if(_p=this.searchProcessedElement(rp[dp]),_p?_d[dp]=np[_p-1]:rp[dp]._render=up,rp[dp].ty==="fl"||rp[dp].ty==="st"||rp[dp].ty==="gf"||rp[dp].ty==="gs"||rp[dp].ty==="no")_p?_d[dp].style.closed=!1:_d[dp]=this.createStyleElement(rp[dp],sp),rp[dp]._render&&_d[dp].style.pElem.parentNode!==ap&&ap.appendChild(_d[dp].style.pElem),mp.push(_d[dp].style);else if(rp[dp].ty==="gr"){if(!_p)_d[dp]=this.createGroupElement(rp[dp]);else for(pp=_d[dp].it.length,fp=0;fp<pp;fp+=1)_d[dp].prevViewData[fp]=_d[dp].it[fp];this.searchShapes(rp[dp].it,_d[dp].it,_d[dp].prevViewData,_d[dp].gr,sp+1,cp,up),rp[dp]._render&&_d[dp].gr.parentNode!==ap&&ap.appendChild(_d[dp].gr)}else rp[dp].ty==="tr"?(_p||(_d[dp]=this.createTransformElement(rp[dp],ap)),yp=_d[dp].transform,cp.push(yp)):rp[dp].ty==="sh"||rp[dp].ty==="rc"||rp[dp].ty==="el"||rp[dp].ty==="sr"?(_p||(_d[dp]=this.createShapeElement(rp[dp],cp,sp)),this.setElementStyles(_d[dp])):rp[dp].ty==="tm"||rp[dp].ty==="rd"||rp[dp].ty==="ms"||rp[dp].ty==="pb"||rp[dp].ty==="zz"||rp[dp].ty==="op"?(_p?(xp=_d[dp],xp.closed=!1):(xp=ShapeModifiers.getModifier(rp[dp].ty),xp.init(this,rp[dp]),_d[dp]=xp,this.shapeModifiers.push(xp)),gp.push(xp)):rp[dp].ty==="rp"&&(_p?(xp=_d[dp],xp.closed=!0):(xp=ShapeModifiers.getModifier(rp[dp].ty),_d[dp]=xp,xp.init(this,rp,dp,_d),this.shapeModifiers.push(xp),up=!1),gp.push(xp));this.addProcessedElement(rp[dp],dp+1)}for(hp=mp.length,dp=0;dp<hp;dp+=1)mp[dp].closed=!0;for(hp=gp.length,dp=0;dp<hp;dp+=1)gp[dp].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var rp,_d=this.stylesList.length;for(rp=0;rp<_d;rp+=1)this.stylesList[rp].reset();for(this.renderShape(),rp=0;rp<_d;rp+=1)(this.stylesList[rp]._mdf||this._isFirstFrame)&&(this.stylesList[rp].msElem&&(this.stylesList[rp].msElem.setAttribute("d",this.stylesList[rp].d),this.stylesList[rp].d="M0 0"+this.stylesList[rp].d),this.stylesList[rp].pElem.setAttribute("d",this.stylesList[rp].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var rp,_d=this.animatedContents.length,np;for(rp=0;rp<_d;rp+=1)np=this.animatedContents[rp],(this._isFirstFrame||np.element._isAnimated)&&np.data!==!0&&np.fn(np.data,np.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null};function LetterProps(rp,_d,np,ap,sp,lp){this.o=rp,this.sw=_d,this.sc=np,this.fc=ap,this.m=sp,this.p=lp,this._mdf={o:!0,sw:!!_d,sc:!!np,fc:!!ap,m:!0,p:!0}}LetterProps.prototype.update=function(rp,_d,np,ap,sp,lp){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var up=!1;return this.o!==rp&&(this.o=rp,this._mdf.o=!0,up=!0),this.sw!==_d&&(this.sw=_d,this._mdf.sw=!0,up=!0),this.sc!==np&&(this.sc=np,this._mdf.sc=!0,up=!0),this.fc!==ap&&(this.fc=ap,this._mdf.fc=!0,up=!0),this.m!==sp&&(this.m=sp,this._mdf.m=!0,up=!0),lp.length&&(this.p[0]!==lp[0]||this.p[1]!==lp[1]||this.p[4]!==lp[4]||this.p[5]!==lp[5]||this.p[12]!==lp[12]||this.p[13]!==lp[13])&&(this.p=lp,this._mdf.p=!0,up=!0),up};function TextProperty(rp,_d){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,_d.d&&_d.d.sid&&(_d.d=rp.globalData.slotManager.getProp(_d.d)),this.data=_d,this.elem=rp,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(rp,_d){for(var np in _d)Object.prototype.hasOwnProperty.call(_d,np)&&(rp[np]=_d[np]);return rp},TextProperty.prototype.setCurrentData=function(rp){rp.__complete||this.completeTextData(rp),this.currentData=rp,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(rp){this.effectsSequence.push(rp),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(rp){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!rp)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var _d=this.currentData,np=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return}this.lock=!0,this._mdf=!1;var ap,sp=this.effectsSequence.length,lp=rp||this.data.d.k[this.keysIndex].s;for(ap=0;ap<sp;ap+=1)np!==this.keysIndex?lp=this.effectsSequence[ap](lp,lp.t):lp=this.effectsSequence[ap](this.currentData,lp.t);_d!==lp&&this.setCurrentData(lp),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}},TextProperty.prototype.getKeyframeValue=function(){for(var rp=this.data.d.k,_d=this.elem.comp.renderedFrame,np=0,ap=rp.length;np<=ap-1&&!(np===ap-1||rp[np+1].t>_d);)np+=1;return this.keysIndex!==np&&(this.keysIndex=np),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(rp){for(var _d=[],np=0,ap=rp.length,sp,lp,up=!1,cp=!1,dp="";np<ap;)up=cp,cp=!1,sp=rp.charCodeAt(np),dp=rp.charAt(np),FontManager.isCombinedCharacter(sp)?up=!0:sp>=55296&&sp<=56319?FontManager.isRegionalFlag(rp,np)?dp=rp.substr(np,14):(lp=rp.charCodeAt(np+1),lp>=56320&&lp<=57343&&(FontManager.isModifier(sp,lp)?(dp=rp.substr(np,2),up=!0):FontManager.isFlagEmoji(rp.substr(np,4))?dp=rp.substr(np,4):dp=rp.substr(np,2))):sp>56319?(lp=rp.charCodeAt(np+1),FontManager.isVariationSelector(sp)&&(up=!0)):FontManager.isZeroWidthJoiner(sp)&&(up=!0,cp=!0),up?(_d[_d.length-1]+=dp,up=!1):_d.push(dp),np+=dp.length;return _d},TextProperty.prototype.completeTextData=function(rp){rp.__complete=!0;var _d=this.elem.globalData.fontManager,np=this.data,ap=[],sp,lp,up,cp=0,dp,hp=np.m.g,fp=0,pp=0,mp=0,gp=[],yp=0,xp=0,_p,vp,bp=_d.getFontByName(rp.f),Ep,Sp=0,Ap=getFontProperties(bp);rp.fWeight=Ap.weight,rp.fStyle=Ap.style,rp.finalSize=rp.s,rp.finalText=this.buildFinalText(rp.t),lp=rp.finalText.length,rp.finalLineHeight=rp.lh;var Rp=rp.tr/1e3*rp.finalSize,Tp;if(rp.sz)for(var Mp=!0,Op=rp.sz[0],Pp=rp.sz[1],$p,zp;Mp;){zp=this.buildFinalText(rp.t),$p=0,yp=0,lp=zp.length,Rp=rp.tr/1e3*rp.finalSize;var Dp=-1;for(sp=0;sp<lp;sp+=1)Tp=zp[sp].charCodeAt(0),up=!1,zp[sp]===" "?Dp=sp:(Tp===13||Tp===3)&&(yp=0,up=!0,$p+=rp.finalLineHeight||rp.finalSize*1.2),_d.chars?(Ep=_d.getCharData(zp[sp],bp.fStyle,bp.fFamily),Sp=up?0:Ep.w*rp.finalSize/100):Sp=_d.measureText(zp[sp],rp.f,rp.finalSize),yp+Sp>Op&&zp[sp]!==" "?(Dp===-1?lp+=1:sp=Dp,$p+=rp.finalLineHeight||rp.finalSize*1.2,zp.splice(sp,Dp===sp?1:0,"\r"),Dp=-1,yp=0):(yp+=Sp,yp+=Rp);$p+=bp.ascent*rp.finalSize/100,this.canResize&&rp.finalSize>this.minimumFontSize&&Pp<$p?(rp.finalSize-=1,rp.finalLineHeight=rp.finalSize*rp.lh/rp.s):(rp.finalText=zp,lp=rp.finalText.length,Mp=!1)}yp=-Rp,Sp=0;var Fp=0,jp;for(sp=0;sp<lp;sp+=1)if(up=!1,jp=rp.finalText[sp],Tp=jp.charCodeAt(0),Tp===13||Tp===3?(Fp=0,gp.push(yp),xp=yp>xp?yp:xp,yp=-2*Rp,dp="",up=!0,mp+=1):dp=jp,_d.chars?(Ep=_d.getCharData(jp,bp.fStyle,_d.getFontByName(rp.f).fFamily),Sp=up?0:Ep.w*rp.finalSize/100):Sp=_d.measureText(dp,rp.f,rp.finalSize),jp===" "?Fp+=Sp+Rp:(yp+=Sp+Rp+Fp,Fp=0),ap.push({l:Sp,an:Sp,add:fp,n:up,anIndexes:[],val:dp,line:mp,animatorJustifyOffset:0}),hp==2){if(fp+=Sp,dp===""||dp===" "||sp===lp-1){for((dp===""||dp===" ")&&(fp-=Sp);pp<=sp;)ap[pp].an=fp,ap[pp].ind=cp,ap[pp].extra=Sp,pp+=1;cp+=1,fp=0}}else if(hp==3){if(fp+=Sp,dp===""||sp===lp-1){for(dp===""&&(fp-=Sp);pp<=sp;)ap[pp].an=fp,ap[pp].ind=cp,ap[pp].extra=Sp,pp+=1;fp=0,cp+=1}}else ap[cp].ind=cp,ap[cp].extra=0,cp+=1;if(rp.l=ap,xp=yp>xp?yp:xp,gp.push(yp),rp.sz)rp.boxWidth=rp.sz[0],rp.justifyOffset=0;else switch(rp.boxWidth=xp,rp.j){case 1:rp.justifyOffset=-rp.boxWidth;break;case 2:rp.justifyOffset=-rp.boxWidth/2;break;default:rp.justifyOffset=0}rp.lineWidths=gp;var Lp=np.a,Bp,Ip;vp=Lp.length;var kp,Up,Gp=[];for(_p=0;_p<vp;_p+=1){for(Bp=Lp[_p],Bp.a.sc&&(rp.strokeColorAnim=!0),Bp.a.sw&&(rp.strokeWidthAnim=!0),(Bp.a.fc||Bp.a.fh||Bp.a.fs||Bp.a.fb)&&(rp.fillColorAnim=!0),Up=0,kp=Bp.s.b,sp=0;sp<lp;sp+=1)Ip=ap[sp],Ip.anIndexes[_p]=Up,(kp==1&&Ip.val!==""||kp==2&&Ip.val!==""&&Ip.val!==" "||kp==3&&(Ip.n||Ip.val==" "||sp==lp-1)||kp==4&&(Ip.n||sp==lp-1))&&(Bp.s.rn===1&&Gp.push(Up),Up+=1);np.a[_p].s.totalChars=Up;var Wp=-1,Qp;if(Bp.s.rn===1)for(sp=0;sp<lp;sp+=1)Ip=ap[sp],Wp!=Ip.anIndexes[_p]&&(Wp=Ip.anIndexes[_p],Qp=Gp.splice(Math.floor(Math.random()*Gp.length),1)[0]),Ip.anIndexes[_p]=Qp}rp.yOffset=rp.finalLineHeight||rp.finalSize*1.2,rp.ls=rp.ls||0,rp.ascent=bp.ascent*rp.finalSize/100},TextProperty.prototype.updateDocumentData=function(rp,_d){_d=_d===void 0?this.keysIndex:_d;var np=this.copyData({},this.data.d.k[_d].s);np=this.copyData(np,rp),this.data.d.k[_d].s=np,this.recalculate(_d),this.setCurrentData(np),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(rp){var _d=this.data.d.k[rp].s;_d.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(_d)},TextProperty.prototype.canResizeFont=function(rp){this.canResize=rp,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(rp){this.minimumFontSize=Math.floor(rp)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var rp=Math.max,_d=Math.min,np=Math.floor;function ap(lp,up){this._currentTextLength=-1,this.k=!1,this.data=up,this.elem=lp,this.comp=lp.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(lp),this.s=PropertyFactory.getProp(lp,up.s||{k:0},0,0,this),"e"in up?this.e=PropertyFactory.getProp(lp,up.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(lp,up.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(lp,up.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(lp,up.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(lp,up.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(lp,up.a,0,.01,this),this.dynamicProperties.length||this.getValue()}ap.prototype={getMult:function(up){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var cp=0,dp=0,hp=1,fp=1;this.ne.v>0?cp=this.ne.v/100:dp=-this.ne.v/100,this.xe.v>0?hp=1-this.xe.v/100:fp=1+this.xe.v/100;var pp=BezierFactory.getBezierEasing(cp,dp,hp,fp).get,mp=0,gp=this.finalS,yp=this.finalE,xp=this.data.sh;if(xp===2)yp===gp?mp=up>=yp?1:0:mp=rp(0,_d(.5/(yp-gp)+(up-gp)/(yp-gp),1)),mp=pp(mp);else if(xp===3)yp===gp?mp=up>=yp?0:1:mp=1-rp(0,_d(.5/(yp-gp)+(up-gp)/(yp-gp),1)),mp=pp(mp);else if(xp===4)yp===gp?mp=0:(mp=rp(0,_d(.5/(yp-gp)+(up-gp)/(yp-gp),1)),mp<.5?mp*=2:mp=1-2*(mp-.5)),mp=pp(mp);else if(xp===5){if(yp===gp)mp=0;else{var _p=yp-gp;up=_d(rp(0,up+.5-gp),yp-gp);var vp=-_p/2+up,bp=_p/2;mp=Math.sqrt(1-vp*vp/(bp*bp))}mp=pp(mp)}else xp===6?(yp===gp?mp=0:(up=_d(rp(0,up+.5-gp),yp-gp),mp=(1+Math.cos(Math.PI+Math.PI*2*up/(yp-gp)))/2),mp=pp(mp)):(up>=np(gp)&&(up-gp<0?mp=rp(0,_d(_d(yp,1)-(gp-up),1)):mp=rp(0,_d(yp-up,1))),mp=pp(mp));if(this.sm.v!==100){var Ep=this.sm.v*.01;Ep===0&&(Ep=1e-8);var Sp=.5-Ep*.5;mp<Sp?mp=0:(mp=(mp-Sp)/Ep,mp>1&&(mp=1))}return mp*this.a.v},getValue:function(up){this.iterateDynamicProperties(),this._mdf=up||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,up&&this.data.r===2&&(this.e.v=this._currentTextLength);var cp=this.data.r===2?1:100/this.data.totalChars,dp=this.o.v/cp,hp=this.s.v/cp+dp,fp=this.e.v/cp+dp;if(hp>fp){var pp=hp;hp=fp,fp=pp}this.finalS=hp,this.finalE=fp}},extendPrototype([DynamicPropertyContainer],ap);function sp(lp,up,cp){return new ap(lp,up)}return{getTextSelectorProp:sp}}();function TextAnimatorDataProperty(rp,_d,np){var ap={propType:!1},sp=PropertyFactory.getProp,lp=_d.a;this.a={r:lp.r?sp(rp,lp.r,0,degToRads,np):ap,rx:lp.rx?sp(rp,lp.rx,0,degToRads,np):ap,ry:lp.ry?sp(rp,lp.ry,0,degToRads,np):ap,sk:lp.sk?sp(rp,lp.sk,0,degToRads,np):ap,sa:lp.sa?sp(rp,lp.sa,0,degToRads,np):ap,s:lp.s?sp(rp,lp.s,1,.01,np):ap,a:lp.a?sp(rp,lp.a,1,0,np):ap,o:lp.o?sp(rp,lp.o,0,.01,np):ap,p:lp.p?sp(rp,lp.p,1,0,np):ap,sw:lp.sw?sp(rp,lp.sw,0,0,np):ap,sc:lp.sc?sp(rp,lp.sc,1,0,np):ap,fc:lp.fc?sp(rp,lp.fc,1,0,np):ap,fh:lp.fh?sp(rp,lp.fh,0,0,np):ap,fs:lp.fs?sp(rp,lp.fs,0,.01,np):ap,fb:lp.fb?sp(rp,lp.fb,0,.01,np):ap,t:lp.t?sp(rp,lp.t,0,0,np):ap},this.s=TextSelectorProp.getTextSelectorProp(rp,_d.s,np),this.s.t=_d.s.t}function TextAnimatorProperty(rp,_d,np){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=rp,this._renderType=_d,this._elem=np,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(np)}TextAnimatorProperty.prototype.searchProperties=function(){var rp,_d=this._textData.a.length,np,ap=PropertyFactory.getProp;for(rp=0;rp<_d;rp+=1)np=this._textData.a[rp],this._animatorsData[rp]=new TextAnimatorDataProperty(this._elem,np,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:ap(this._elem,this._textData.p.a,0,0,this),f:ap(this._elem,this._textData.p.f,0,0,this),l:ap(this._elem,this._textData.p.l,0,0,this),r:ap(this._elem,this._textData.p.r,0,0,this),p:ap(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=ap(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(rp,_d){if(this.lettersChangedFlag=_d,!(!this._mdf&&!this._isFirstFrame&&!_d&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var np=this._moreOptions.alignment.v,ap=this._animatorsData,sp=this._textData,lp=this.mHelper,up=this._renderType,cp=this.renderedLetters.length,dp,hp,fp,pp,mp=rp.l,gp,yp,xp,_p,vp,bp,Ep,Sp,Ap,Rp,Tp,Mp,Op,Pp,$p;if(this._hasMaskedPath){if($p=this._pathData.m,!this._pathData.n||this._pathData._mdf){var zp=$p.v;this._pathData.r.v&&(zp=zp.reverse()),gp={tLength:0,segments:[]},pp=zp._length-1;var Dp;for(Mp=0,fp=0;fp<pp;fp+=1)Dp=bez.buildBezierData(zp.v[fp],zp.v[fp+1],[zp.o[fp][0]-zp.v[fp][0],zp.o[fp][1]-zp.v[fp][1]],[zp.i[fp+1][0]-zp.v[fp+1][0],zp.i[fp+1][1]-zp.v[fp+1][1]]),gp.tLength+=Dp.segmentLength,gp.segments.push(Dp),Mp+=Dp.segmentLength;fp=pp,$p.v.c&&(Dp=bez.buildBezierData(zp.v[fp],zp.v[0],[zp.o[fp][0]-zp.v[fp][0],zp.o[fp][1]-zp.v[fp][1]],[zp.i[0][0]-zp.v[0][0],zp.i[0][1]-zp.v[0][1]]),gp.tLength+=Dp.segmentLength,gp.segments.push(Dp),Mp+=Dp.segmentLength),this._pathData.pi=gp}if(gp=this._pathData.pi,yp=this._pathData.f.v,Ep=0,bp=1,_p=0,vp=!0,Rp=gp.segments,yp<0&&$p.v.c)for(gp.tLength<Math.abs(yp)&&(yp=-Math.abs(yp)%gp.tLength),Ep=Rp.length-1,Ap=Rp[Ep].points,bp=Ap.length-1;yp<0;)yp+=Ap[bp].partialLength,bp-=1,bp<0&&(Ep-=1,Ap=Rp[Ep].points,bp=Ap.length-1);Ap=Rp[Ep].points,Sp=Ap[bp-1],xp=Ap[bp],Tp=xp.partialLength}pp=mp.length,dp=0,hp=0;var Fp=rp.finalSize*1.2*.714,jp=!0,Lp,Bp,Ip,kp,Up;kp=ap.length;var Gp,Wp=-1,Qp,Xp,rm,Kp=yp,lm=Ep,cm=bp,gm=-1,Mm,dm,em,sm,Zp,mm,fm,_m,zm="",tm=this.defaultPropsArray,Jp;if(rp.j===2||rp.j===1){var pm=0,km=0,ym=rp.j===2?-.5:-1,Em=0,Bm=!0;for(fp=0;fp<pp;fp+=1)if(mp[fp].n){for(pm&&(pm+=km);Em<fp;)mp[Em].animatorJustifyOffset=pm,Em+=1;pm=0,Bm=!0}else{for(Ip=0;Ip<kp;Ip+=1)Lp=ap[Ip].a,Lp.t.propType&&(Bm&&rp.j===2&&(km+=Lp.t.v*ym),Bp=ap[Ip].s,Gp=Bp.getMult(mp[fp].anIndexes[Ip],sp.a[Ip].s.totalChars),Gp.length?pm+=Lp.t.v*Gp[0]*ym:pm+=Lp.t.v*Gp*ym);Bm=!1}for(pm&&(pm+=km);Em<fp;)mp[Em].animatorJustifyOffset=pm,Em+=1}for(fp=0;fp<pp;fp+=1){if(lp.reset(),Mm=1,mp[fp].n)dp=0,hp+=rp.yOffset,hp+=jp?1:0,yp=Kp,jp=!1,this._hasMaskedPath&&(Ep=lm,bp=cm,Ap=Rp[Ep].points,Sp=Ap[bp-1],xp=Ap[bp],Tp=xp.partialLength,_p=0),zm="",_m="",mm="",Jp="",tm=this.defaultPropsArray;else{if(this._hasMaskedPath){if(gm!==mp[fp].line){switch(rp.j){case 1:yp+=Mp-rp.lineWidths[mp[fp].line];break;case 2:yp+=(Mp-rp.lineWidths[mp[fp].line])/2;break}gm=mp[fp].line}Wp!==mp[fp].ind&&(mp[Wp]&&(yp+=mp[Wp].extra),yp+=mp[fp].an/2,Wp=mp[fp].ind),yp+=np[0]*mp[fp].an*.005;var Pm=0;for(Ip=0;Ip<kp;Ip+=1)Lp=ap[Ip].a,Lp.p.propType&&(Bp=ap[Ip].s,Gp=Bp.getMult(mp[fp].anIndexes[Ip],sp.a[Ip].s.totalChars),Gp.length?Pm+=Lp.p.v[0]*Gp[0]:Pm+=Lp.p.v[0]*Gp),Lp.a.propType&&(Bp=ap[Ip].s,Gp=Bp.getMult(mp[fp].anIndexes[Ip],sp.a[Ip].s.totalChars),Gp.length?Pm+=Lp.a.v[0]*Gp[0]:Pm+=Lp.a.v[0]*Gp);for(vp=!0,this._pathData.a.v&&(yp=mp[0].an*.5+(Mp-this._pathData.f.v-mp[0].an*.5-mp[mp.length-1].an*.5)*Wp/(pp-1),yp+=this._pathData.f.v);vp;)_p+Tp>=yp+Pm||!Ap?(Op=(yp+Pm-_p)/xp.partialLength,Xp=Sp.point[0]+(xp.point[0]-Sp.point[0])*Op,rm=Sp.point[1]+(xp.point[1]-Sp.point[1])*Op,lp.translate(-np[0]*mp[fp].an*.005,-(np[1]*Fp)*.01),vp=!1):Ap&&(_p+=xp.partialLength,bp+=1,bp>=Ap.length&&(bp=0,Ep+=1,Rp[Ep]?Ap=Rp[Ep].points:$p.v.c?(bp=0,Ep=0,Ap=Rp[Ep].points):(_p-=xp.partialLength,Ap=null)),Ap&&(Sp=xp,xp=Ap[bp],Tp=xp.partialLength));Qp=mp[fp].an/2-mp[fp].add,lp.translate(-Qp,0,0)}else Qp=mp[fp].an/2-mp[fp].add,lp.translate(-Qp,0,0),lp.translate(-np[0]*mp[fp].an*.005,-np[1]*Fp*.01,0);for(Ip=0;Ip<kp;Ip+=1)Lp=ap[Ip].a,Lp.t.propType&&(Bp=ap[Ip].s,Gp=Bp.getMult(mp[fp].anIndexes[Ip],sp.a[Ip].s.totalChars),(dp!==0||rp.j!==0)&&(this._hasMaskedPath?Gp.length?yp+=Lp.t.v*Gp[0]:yp+=Lp.t.v*Gp:Gp.length?dp+=Lp.t.v*Gp[0]:dp+=Lp.t.v*Gp));for(rp.strokeWidthAnim&&(em=rp.sw||0),rp.strokeColorAnim&&(rp.sc?dm=[rp.sc[0],rp.sc[1],rp.sc[2]]:dm=[0,0,0]),rp.fillColorAnim&&rp.fc&&(sm=[rp.fc[0],rp.fc[1],rp.fc[2]]),Ip=0;Ip<kp;Ip+=1)Lp=ap[Ip].a,Lp.a.propType&&(Bp=ap[Ip].s,Gp=Bp.getMult(mp[fp].anIndexes[Ip],sp.a[Ip].s.totalChars),Gp.length?lp.translate(-Lp.a.v[0]*Gp[0],-Lp.a.v[1]*Gp[1],Lp.a.v[2]*Gp[2]):lp.translate(-Lp.a.v[0]*Gp,-Lp.a.v[1]*Gp,Lp.a.v[2]*Gp));for(Ip=0;Ip<kp;Ip+=1)Lp=ap[Ip].a,Lp.s.propType&&(Bp=ap[Ip].s,Gp=Bp.getMult(mp[fp].anIndexes[Ip],sp.a[Ip].s.totalChars),Gp.length?lp.scale(1+(Lp.s.v[0]-1)*Gp[0],1+(Lp.s.v[1]-1)*Gp[1],1):lp.scale(1+(Lp.s.v[0]-1)*Gp,1+(Lp.s.v[1]-1)*Gp,1));for(Ip=0;Ip<kp;Ip+=1){if(Lp=ap[Ip].a,Bp=ap[Ip].s,Gp=Bp.getMult(mp[fp].anIndexes[Ip],sp.a[Ip].s.totalChars),Lp.sk.propType&&(Gp.length?lp.skewFromAxis(-Lp.sk.v*Gp[0],Lp.sa.v*Gp[1]):lp.skewFromAxis(-Lp.sk.v*Gp,Lp.sa.v*Gp)),Lp.r.propType&&(Gp.length?lp.rotateZ(-Lp.r.v*Gp[2]):lp.rotateZ(-Lp.r.v*Gp)),Lp.ry.propType&&(Gp.length?lp.rotateY(Lp.ry.v*Gp[1]):lp.rotateY(Lp.ry.v*Gp)),Lp.rx.propType&&(Gp.length?lp.rotateX(Lp.rx.v*Gp[0]):lp.rotateX(Lp.rx.v*Gp)),Lp.o.propType&&(Gp.length?Mm+=(Lp.o.v*Gp[0]-Mm)*Gp[0]:Mm+=(Lp.o.v*Gp-Mm)*Gp),rp.strokeWidthAnim&&Lp.sw.propType&&(Gp.length?em+=Lp.sw.v*Gp[0]:em+=Lp.sw.v*Gp),rp.strokeColorAnim&&Lp.sc.propType)for(Zp=0;Zp<3;Zp+=1)Gp.length?dm[Zp]+=(Lp.sc.v[Zp]-dm[Zp])*Gp[0]:dm[Zp]+=(Lp.sc.v[Zp]-dm[Zp])*Gp;if(rp.fillColorAnim&&rp.fc){if(Lp.fc.propType)for(Zp=0;Zp<3;Zp+=1)Gp.length?sm[Zp]+=(Lp.fc.v[Zp]-sm[Zp])*Gp[0]:sm[Zp]+=(Lp.fc.v[Zp]-sm[Zp])*Gp;Lp.fh.propType&&(Gp.length?sm=addHueToRGB(sm,Lp.fh.v*Gp[0]):sm=addHueToRGB(sm,Lp.fh.v*Gp)),Lp.fs.propType&&(Gp.length?sm=addSaturationToRGB(sm,Lp.fs.v*Gp[0]):sm=addSaturationToRGB(sm,Lp.fs.v*Gp)),Lp.fb.propType&&(Gp.length?sm=addBrightnessToRGB(sm,Lp.fb.v*Gp[0]):sm=addBrightnessToRGB(sm,Lp.fb.v*Gp))}}for(Ip=0;Ip<kp;Ip+=1)Lp=ap[Ip].a,Lp.p.propType&&(Bp=ap[Ip].s,Gp=Bp.getMult(mp[fp].anIndexes[Ip],sp.a[Ip].s.totalChars),this._hasMaskedPath?Gp.length?lp.translate(0,Lp.p.v[1]*Gp[0],-Lp.p.v[2]*Gp[1]):lp.translate(0,Lp.p.v[1]*Gp,-Lp.p.v[2]*Gp):Gp.length?lp.translate(Lp.p.v[0]*Gp[0],Lp.p.v[1]*Gp[1],-Lp.p.v[2]*Gp[2]):lp.translate(Lp.p.v[0]*Gp,Lp.p.v[1]*Gp,-Lp.p.v[2]*Gp));if(rp.strokeWidthAnim&&(mm=em<0?0:em),rp.strokeColorAnim&&(fm="rgb("+Math.round(dm[0]*255)+","+Math.round(dm[1]*255)+","+Math.round(dm[2]*255)+")"),rp.fillColorAnim&&rp.fc&&(_m="rgb("+Math.round(sm[0]*255)+","+Math.round(sm[1]*255)+","+Math.round(sm[2]*255)+")"),this._hasMaskedPath){if(lp.translate(0,-rp.ls),lp.translate(0,np[1]*Fp*.01+hp,0),this._pathData.p.v){Pp=(xp.point[1]-Sp.point[1])/(xp.point[0]-Sp.point[0]);var Im=Math.atan(Pp)*180/Math.PI;xp.point[0]<Sp.point[0]&&(Im+=180),lp.rotate(-Im*Math.PI/180)}lp.translate(Xp,rm,0),yp-=np[0]*mp[fp].an*.005,mp[fp+1]&&Wp!==mp[fp+1].ind&&(yp+=mp[fp].an/2,yp+=rp.tr*.001*rp.finalSize)}else{switch(lp.translate(dp,hp,0),rp.ps&&lp.translate(rp.ps[0],rp.ps[1]+rp.ascent,0),rp.j){case 1:lp.translate(mp[fp].animatorJustifyOffset+rp.justifyOffset+(rp.boxWidth-rp.lineWidths[mp[fp].line]),0,0);break;case 2:lp.translate(mp[fp].animatorJustifyOffset+rp.justifyOffset+(rp.boxWidth-rp.lineWidths[mp[fp].line])/2,0,0);break}lp.translate(0,-rp.ls),lp.translate(Qp,0,0),lp.translate(np[0]*mp[fp].an*.005,np[1]*Fp*.01,0),dp+=mp[fp].l+rp.tr*.001*rp.finalSize}up==="html"?zm=lp.toCSS():up==="svg"?zm=lp.to2dCSS():tm=[lp.props[0],lp.props[1],lp.props[2],lp.props[3],lp.props[4],lp.props[5],lp.props[6],lp.props[7],lp.props[8],lp.props[9],lp.props[10],lp.props[11],lp.props[12],lp.props[13],lp.props[14],lp.props[15]],Jp=Mm}cp<=fp?(Up=new LetterProps(Jp,mm,fm,_m,zm,tm),this.renderedLetters.push(Up),cp+=1,this.lettersChangedFlag=!0):(Up=this.renderedLetters[fp],this.lettersChangedFlag=Up.update(Jp,mm,fm,_m,zm,tm)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(rp,_d,np){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(rp,_d,np),this.textProperty=new TextProperty(this,rp.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(rp.t,this.renderType,this),this.initTransform(rp,_d,np),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(rp){this._mdf=!1,this.prepareRenderableFrame(rp),this.prepareProperties(rp,this.isInRange)},ITextElement.prototype.createPathShape=function(rp,_d){var np,ap=_d.length,sp,lp="";for(np=0;np<ap;np+=1)_d[np].ty==="sh"&&(sp=_d[np].ks.k,lp+=buildShapeString(sp,sp.i.length,!0,rp));return lp},ITextElement.prototype.updateDocumentData=function(rp,_d){this.textProperty.updateDocumentData(rp,_d)},ITextElement.prototype.canResizeFont=function(rp){this.textProperty.canResizeFont(rp)},ITextElement.prototype.setMinimumFontSize=function(rp){this.textProperty.setMinimumFontSize(rp)},ITextElement.prototype.applyTextPropertiesToMatrix=function(rp,_d,np,ap,sp){switch(rp.ps&&_d.translate(rp.ps[0],rp.ps[1]+rp.ascent,0),_d.translate(0,-rp.ls,0),rp.j){case 1:_d.translate(rp.justifyOffset+(rp.boxWidth-rp.lineWidths[np]),0,0);break;case 2:_d.translate(rp.justifyOffset+(rp.boxWidth-rp.lineWidths[np])/2,0,0);break}_d.translate(ap,sp,0)},ITextElement.prototype.buildColor=function(rp){return"rgb("+Math.round(rp[0]*255)+","+Math.round(rp[1]*255)+","+Math.round(rp[2]*255)+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(rp,_d,np){this.textSpans=[],this.renderType="svg",this.initElement(rp,_d,np)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(rp){for(var _d=0,np=rp.length,ap=[],sp="";_d<np;)rp[_d]==="\r"||rp[_d]===""?(ap.push(sp),sp=""):sp+=rp[_d],_d+=1;return ap.push(sp),ap},SVGTextLottieElement.prototype.buildShapeData=function(rp,_d){if(rp.shapes&&rp.shapes.length){var np=rp.shapes[0];if(np.it){var ap=np.it[np.it.length-1];ap.s&&(ap.s.k[0]=_d,ap.s.k[1]=_d)}}return rp},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var rp,_d,np=this.textProperty.currentData;this.renderedLetters=createSizedArray(np?np.l.length:0),np.fc?this.layerElement.setAttribute("fill",this.buildColor(np.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),np.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(np.sc)),this.layerElement.setAttribute("stroke-width",np.sw)),this.layerElement.setAttribute("font-size",np.finalSize);var ap=this.globalData.fontManager.getFontByName(np.f);if(ap.fClass)this.layerElement.setAttribute("class",ap.fClass);else{this.layerElement.setAttribute("font-family",ap.fFamily);var sp=np.fWeight,lp=np.fStyle;this.layerElement.setAttribute("font-style",lp),this.layerElement.setAttribute("font-weight",sp)}this.layerElement.setAttribute("aria-label",np.t);var up=np.l||[],cp=!!this.globalData.fontManager.chars;_d=up.length;var dp,hp=this.mHelper,fp="",pp=this.data.singleShape,mp=0,gp=0,yp=!0,xp=np.tr*.001*np.finalSize;if(pp&&!cp&&!np.sz){var _p=this.textContainer,vp="start";switch(np.j){case 1:vp="end";break;case 2:vp="middle";break;default:vp="start";break}_p.setAttribute("text-anchor",vp),_p.setAttribute("letter-spacing",xp);var bp=this.buildTextContents(np.finalText);for(_d=bp.length,gp=np.ps?np.ps[1]+np.ascent:0,rp=0;rp<_d;rp+=1)dp=this.textSpans[rp].span||createNS("tspan"),dp.textContent=bp[rp],dp.setAttribute("x",0),dp.setAttribute("y",gp),dp.style.display="inherit",_p.appendChild(dp),this.textSpans[rp]||(this.textSpans[rp]={span:null,glyph:null}),this.textSpans[rp].span=dp,gp+=np.finalLineHeight;this.layerElement.appendChild(_p)}else{var Ep=this.textSpans.length,Sp;for(rp=0;rp<_d;rp+=1){if(this.textSpans[rp]||(this.textSpans[rp]={span:null,childSpan:null,glyph:null}),!cp||!pp||rp===0){if(dp=Ep>rp?this.textSpans[rp].span:createNS(cp?"g":"text"),Ep<=rp){if(dp.setAttribute("stroke-linecap","butt"),dp.setAttribute("stroke-linejoin","round"),dp.setAttribute("stroke-miterlimit","4"),this.textSpans[rp].span=dp,cp){var Ap=createNS("g");dp.appendChild(Ap),this.textSpans[rp].childSpan=Ap}this.textSpans[rp].span=dp,this.layerElement.appendChild(dp)}dp.style.display="inherit"}if(hp.reset(),pp&&(up[rp].n&&(mp=-xp,gp+=np.yOffset,gp+=yp?1:0,yp=!1),this.applyTextPropertiesToMatrix(np,hp,up[rp].line,mp,gp),mp+=up[rp].l||0,mp+=xp),cp){Sp=this.globalData.fontManager.getCharData(np.finalText[rp],ap.fStyle,this.globalData.fontManager.getFontByName(np.f).fFamily);var Rp;if(Sp.t===1)Rp=new SVGCompElement(Sp.data,this.globalData,this);else{var Tp=emptyShapeData;Sp.data&&Sp.data.shapes&&(Tp=this.buildShapeData(Sp.data,np.finalSize)),Rp=new SVGShapeElement(Tp,this.globalData,this)}if(this.textSpans[rp].glyph){var Mp=this.textSpans[rp].glyph;this.textSpans[rp].childSpan.removeChild(Mp.layerElement),Mp.destroy()}this.textSpans[rp].glyph=Rp,Rp._debug=!0,Rp.prepareFrame(0),Rp.renderFrame(),this.textSpans[rp].childSpan.appendChild(Rp.layerElement),Sp.t===1&&this.textSpans[rp].childSpan.setAttribute("transform","scale("+np.finalSize/100+","+np.finalSize/100+")")}else pp&&dp.setAttribute("transform","translate("+hp.props[12]+","+hp.props[13]+")"),dp.textContent=up[rp].val,dp.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}pp&&dp&&dp.setAttribute("d",fp)}for(;rp<this.textSpans.length;)this.textSpans[rp].span.style.display="none",rp+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var rp=this.layerElement.getBBox();this.bbox={top:rp.y,left:rp.x,width:rp.width,height:rp.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var rp,_d=this.textSpans.length,np;for(this.renderedFrame=this.comp.renderedFrame,rp=0;rp<_d;rp+=1)np=this.textSpans[rp].glyph,np&&(np.prepareFrame(this.comp.renderedFrame-this.data.st),np._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var rp,_d,np=this.textAnimator.renderedLetters,ap=this.textProperty.currentData.l;_d=ap.length;var sp,lp,up;for(rp=0;rp<_d;rp+=1)ap[rp].n||(sp=np[rp],lp=this.textSpans[rp].span,up=this.textSpans[rp].glyph,up&&up.renderFrame(),sp._mdf.m&&lp.setAttribute("transform",sp.m),sp._mdf.o&&lp.setAttribute("opacity",sp.o),sp._mdf.sw&&lp.setAttribute("stroke-width",sp.sw),sp._mdf.sc&&lp.setAttribute("stroke",sp.sc),sp._mdf.fc&&lp.setAttribute("fill",sp.fc))}};function ISolidElement(rp,_d,np){this.initElement(rp,_d,np)}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var rp=createNS("rect");rp.setAttribute("width",this.data.sw),rp.setAttribute("height",this.data.sh),rp.setAttribute("fill",this.data.sc),this.layerElement.appendChild(rp)};function NullElement(rp,_d,np){this.initFrame(),this.initBaseData(rp,_d,np),this.initFrame(),this.initTransform(rp,_d,np),this.initHierarchy()}NullElement.prototype.prepareFrame=function(rp){this.prepareProperties(rp,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(rp){return new NullElement(rp,this.globalData,this)},SVGRendererBase.prototype.createShape=function(rp){return new SVGShapeElement(rp,this.globalData,this)},SVGRendererBase.prototype.createText=function(rp){return new SVGTextLottieElement(rp,this.globalData,this)},SVGRendererBase.prototype.createImage=function(rp){return new IImageElement(rp,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(rp){return new ISolidElement(rp,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(rp){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+rp.w+" "+rp.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",rp.w),this.svgElement.setAttribute("height",rp.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var _d=this.globalData.defs;this.setupGlobalData(rp,_d),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=rp;var np=createNS("clipPath"),ap=createNS("rect");ap.setAttribute("width",rp.w),ap.setAttribute("height",rp.h),ap.setAttribute("x",0),ap.setAttribute("y",0);var sp=createElementID();np.setAttribute("id",sp),np.appendChild(ap),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+sp+")"),_d.appendChild(np),this.layers=rp.layers,this.elements=createSizedArray(rp.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var rp,_d=this.layers?this.layers.length:0;for(rp=0;rp<_d;rp+=1)this.elements[rp]&&this.elements[rp].destroy&&this.elements[rp].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(rp){var _d=0,np=this.layers.length;for(_d=0;_d<np;_d+=1)if(this.layers[_d].ind===rp)return _d;return-1},SVGRendererBase.prototype.buildItem=function(rp){var _d=this.elements;if(!(_d[rp]||this.layers[rp].ty===99)){_d[rp]=!0;var np=this.createItem(this.layers[rp]);if(_d[rp]=np,getExpressionsPlugin()&&(this.layers[rp].ty===0&&this.globalData.projectInterface.registerComposition(np),np.initExpressions()),this.appendElementInPos(np,rp),this.layers[rp].tt){var ap="tp"in this.layers[rp]?this.findIndexByInd(this.layers[rp].tp):rp-1;if(ap===-1)return;if(!this.elements[ap]||this.elements[ap]===!0)this.buildItem(ap),this.addPendingElement(np);else{var sp=_d[ap],lp=sp.getMatte(this.layers[rp].tt);np.setMatte(lp)}}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var rp=this.pendingElements.pop();if(rp.checkParenting(),rp.data.tt)for(var _d=0,np=this.elements.length;_d<np;){if(this.elements[_d]===rp){var ap="tp"in rp.data?this.findIndexByInd(rp.data.tp):_d-1,sp=this.elements[ap],lp=sp.getMatte(this.layers[_d].tt);rp.setMatte(lp);break}_d+=1}}},SVGRendererBase.prototype.renderFrame=function(rp){if(!(this.renderedFrame===rp||this.destroyed)){rp===null?rp=this.renderedFrame:this.renderedFrame=rp,this.globalData.frameNum=rp,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=rp,this.globalData._mdf=!1;var _d,np=this.layers.length;for(this.completeLayers||this.checkLayers(rp),_d=np-1;_d>=0;_d-=1)(this.completeLayers||this.elements[_d])&&this.elements[_d].prepareFrame(rp-this.layers[_d].st);if(this.globalData._mdf)for(_d=0;_d<np;_d+=1)(this.completeLayers||this.elements[_d])&&this.elements[_d].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(rp,_d){var np=rp.getBaseElement();if(np){for(var ap=0,sp;ap<_d;)this.elements[ap]&&this.elements[ap]!==!0&&this.elements[ap].getBaseElement()&&(sp=this.elements[ap].getBaseElement()),ap+=1;sp?this.layerElement.insertBefore(np,sp):this.layerElement.appendChild(np)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(rp,_d,np){this.initFrame(),this.initBaseData(rp,_d,np),this.initTransform(rp,_d,np),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!_d.progressiveLoad)&&this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(rp){if(this._mdf=!1,this.prepareRenderableFrame(rp),this.prepareProperties(rp,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=rp/this.data.sr;else{var _d=this.tm.v;_d===this.data.op&&(_d=this.data.op-1),this.renderedFrame=_d}var np,ap=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),np=ap-1;np>=0;np-=1)(this.completeLayers||this.elements[np])&&(this.elements[np].prepareFrame(this.renderedFrame-this.layers[np].st),this.elements[np]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var rp,_d=this.layers.length;for(rp=0;rp<_d;rp+=1)(this.completeLayers||this.elements[rp])&&this.elements[rp].renderFrame()},ICompElement.prototype.setElements=function(rp){this.elements=rp},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var rp,_d=this.layers.length;for(rp=0;rp<_d;rp+=1)this.elements[rp]&&this.elements[rp].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()};function SVGCompElement(rp,_d,np){this.layers=rp.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(rp,_d,np),this.tm=rp.tm?PropertyFactory.getProp(this,rp.tm,0,_d.frameRate,this):{_placeholder:!0}}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(rp){return new SVGCompElement(rp,this.globalData,this)};function SVGRenderer(rp,_d){this.animationItem=rp,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var np="";if(_d&&_d.title){var ap=createNS("title"),sp=createElementID();ap.setAttribute("id",sp),ap.textContent=_d.title,this.svgElement.appendChild(ap),np+=sp}if(_d&&_d.description){var lp=createNS("desc"),up=createElementID();lp.setAttribute("id",up),lp.textContent=_d.description,this.svgElement.appendChild(lp),np+=" "+up}np&&this.svgElement.setAttribute("aria-labelledby",np);var cp=createNS("defs");this.svgElement.appendChild(cp);var dp=createNS("g");this.svgElement.appendChild(dp),this.layerElement=dp,this.renderConfig={preserveAspectRatio:_d&&_d.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:_d&&_d.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:_d&&_d.contentVisibility||"visible",progressiveLoad:_d&&_d.progressiveLoad||!1,hideOnTransparent:!(_d&&_d.hideOnTransparent===!1),viewBoxOnly:_d&&_d.viewBoxOnly||!1,viewBoxSize:_d&&_d.viewBoxSize||!1,className:_d&&_d.className||"",id:_d&&_d.id||"",focusable:_d&&_d.focusable,filterSize:{width:_d&&_d.filterSize&&_d.filterSize.width||"100%",height:_d&&_d.filterSize&&_d.filterSize.height||"100%",x:_d&&_d.filterSize&&_d.filterSize.x||"0%",y:_d&&_d.filterSize&&_d.filterSize.y||"0%"},width:_d&&_d.width,height:_d&&_d.height,runExpressions:!_d||_d.runExpressions===void 0||_d.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:cp,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(rp){return new SVGCompElement(rp,this.globalData,this)};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}ShapeTransformManager.prototype={addTransformSequence:function(_d){var np,ap=_d.length,sp="_";for(np=0;np<ap;np+=1)sp+=_d[np].transform.key+"_";var lp=this.sequences[sp];return lp||(lp={transforms:[].concat(_d),finalTransform:new Matrix,_mdf:!1},this.sequences[sp]=lp,this.sequenceList.push(lp)),lp},processSequence:function(_d,np){for(var ap=0,sp=_d.transforms.length,lp=np;ap<sp&&!np;){if(_d.transforms[ap].transform.mProps._mdf){lp=!0;break}ap+=1}if(lp)for(_d.finalTransform.reset(),ap=sp-1;ap>=0;ap-=1)_d.finalTransform.multiply(_d.transforms[ap].transform.mProps.v);_d._mdf=lp},processSequences:function(_d){var np,ap=this.sequenceList.length;for(np=0;np<ap;np+=1)this.processSequence(this.sequenceList[np],_d)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var _d="__lottie_element_luma_buffer",np=null,ap=null,sp=null;function lp(){var dp=createNS("svg"),hp=createNS("filter"),fp=createNS("feColorMatrix");return hp.setAttribute("id",_d),fp.setAttribute("type","matrix"),fp.setAttribute("color-interpolation-filters","sRGB"),fp.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),hp.appendChild(fp),dp.appendChild(hp),dp.setAttribute("id",_d+"_svg"),featureSupport.svgLumaHidden&&(dp.style.display="none"),dp}function up(){np||(sp=lp(),document.body.appendChild(sp),np=createTag("canvas"),ap=np.getContext("2d"),ap.filter="url(#"+_d+")",ap.fillStyle="rgba(0,0,0,0)",ap.fillRect(0,0,1,1))}function cp(dp){return np||up(),np.width=dp.width,np.height=dp.height,ap.filter="url(#"+_d+")",np}return{load:up,get:cp}};function createCanvas(rp,_d){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(rp,_d);var np=createTag("canvas");return np.width=rp,np.height=_d,np}var assetLoader=function(){return{loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas}}(),registeredEffects={};function CVEffects(rp){var _d,np=rp.data.ef?rp.data.ef.length:0;this.filters=[];var ap;for(_d=0;_d<np;_d+=1){ap=null;var sp=rp.data.ef[_d].ty;if(registeredEffects[sp]){var lp=registeredEffects[sp].effect;ap=new lp(rp.effectsManager.effectElements[_d],rp)}ap&&this.filters.push(ap)}this.filters.length&&rp.addRenderableComponent(this)}CVEffects.prototype.renderFrame=function(rp){var _d,np=this.filters.length;for(_d=0;_d<np;_d+=1)this.filters[_d].renderFrame(rp)},CVEffects.prototype.getEffects=function(rp){var _d,np=this.filters.length,ap=[];for(_d=0;_d<np;_d+=1)this.filters[_d].type===rp&&ap.push(this.filters[_d]);return ap};function registerEffect(rp,_d){registeredEffects[rp]={effect:_d}}function CVMaskElement(rp,_d){this.data=rp,this.element=_d,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var np,ap=this.masksProperties.length,sp=!1;for(np=0;np<ap;np+=1)this.masksProperties[np].mode!=="n"&&(sp=!0),this.viewData[np]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[np],3);this.hasMasks=sp,sp&&this.element.addRenderableComponent(this)}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var rp=this.element.finalTransform.mat,_d=this.element.canvasContext,np,ap=this.masksProperties.length,sp,lp,up;for(_d.beginPath(),np=0;np<ap;np+=1)if(this.masksProperties[np].mode!=="n"){this.masksProperties[np].inv&&(_d.moveTo(0,0),_d.lineTo(this.element.globalData.compSize.w,0),_d.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),_d.lineTo(0,this.element.globalData.compSize.h),_d.lineTo(0,0)),up=this.viewData[np].v,sp=rp.applyToPointArray(up.v[0][0],up.v[0][1],0),_d.moveTo(sp[0],sp[1]);var cp,dp=up._length;for(cp=1;cp<dp;cp+=1)lp=rp.applyToTriplePoints(up.o[cp-1],up.i[cp],up.v[cp]),_d.bezierCurveTo(lp[0],lp[1],lp[2],lp[3],lp[4],lp[5]);lp=rp.applyToTriplePoints(up.o[cp-1],up.i[0],up.v[0]),_d.bezierCurveTo(lp[0],lp[1],lp[2],lp[3],lp[4],lp[5])}this.element.globalData.renderer.save(!0),_d.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};function CVBaseElement(){}var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var _d=this.globalData.canvasContext,np=assetLoader.createCanvas(_d.canvas.width,_d.canvas.height);this.buffers.push(np);var ap=assetLoader.createCanvas(_d.canvas.width,_d.canvas.height);this.buffers.push(ap),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var _d=this.globalData;if(_d.blendMode!==this.data.bm){_d.blendMode=this.data.bm;var np=getBlendMode(this.data.bm);_d.canvasContext.globalCompositeOperation=np}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(_d){_d.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var _d=this.buffers[0],np=_d.getContext("2d");this.clearCanvas(np),np.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var _d=this.buffers[1],np=_d.getContext("2d");this.clearCanvas(np),np.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);var ap=this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1);if(ap.renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var sp=assetLoader.getLumaCanvas(this.canvasContext.canvas),lp=sp.getContext("2d");lp.drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(sp,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(_d,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(_d){if(!(this.hidden||this.data.hd)&&!(this.data.td===1&&!_d)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var np=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(np),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(np),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(rp,_d,np,ap){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var sp=4;_d.ty==="rc"?sp=5:_d.ty==="el"?sp=6:_d.ty==="sr"&&(sp=7),this.sh=ShapePropertyFactory.getShapeProp(rp,_d,sp,rp);var lp,up=np.length,cp;for(lp=0;lp<up;lp+=1)np[lp].closed||(cp={transforms:ap.addTransformSequence(np[lp].transforms),trNodes:[]},this.styledShapes.push(cp),np[lp].elements.push(cp))}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(rp,_d,np){this.shapes=[],this.shapesData=rp.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(rp,_d,np)}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(rp,_d){var np={data:rp,type:rp.ty,preTransforms:this.transformsManager.addTransformSequence(_d),transforms:[],elements:[],closed:rp.hd===!0},ap={};if(rp.ty==="fl"||rp.ty==="st"?(ap.c=PropertyFactory.getProp(this,rp.c,1,255,this),ap.c.k||(np.co="rgb("+bmFloor(ap.c.v[0])+","+bmFloor(ap.c.v[1])+","+bmFloor(ap.c.v[2])+")")):(rp.ty==="gf"||rp.ty==="gs")&&(ap.s=PropertyFactory.getProp(this,rp.s,1,null,this),ap.e=PropertyFactory.getProp(this,rp.e,1,null,this),ap.h=PropertyFactory.getProp(this,rp.h||{k:0},0,.01,this),ap.a=PropertyFactory.getProp(this,rp.a||{k:0},0,degToRads,this),ap.g=new GradientProperty(this,rp.g,this)),ap.o=PropertyFactory.getProp(this,rp.o,0,.01,this),rp.ty==="st"||rp.ty==="gs"){if(np.lc=lineCapEnum[rp.lc||2],np.lj=lineJoinEnum[rp.lj||2],rp.lj==1&&(np.ml=rp.ml),ap.w=PropertyFactory.getProp(this,rp.w,0,null,this),ap.w.k||(np.wi=ap.w.v),rp.d){var sp=new DashProperty(this,rp.d,"canvas",this);ap.d=sp,ap.d.k||(np.da=ap.d.dashArray,np.do=ap.d.dashoffset[0])}}else np.r=rp.r===2?"evenodd":"nonzero";return this.stylesList.push(np),ap.style=np,ap},CVShapeElement.prototype.createGroupElement=function(){var rp={it:[],prevViewData:[]};return rp},CVShapeElement.prototype.createTransformElement=function(rp){var _d={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,rp.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,rp,this)}};return _d},CVShapeElement.prototype.createShapeElement=function(rp){var _d=new CVShapeData(this,rp,this.stylesList,this.transformsManager);return this.shapes.push(_d),this.addShapeToModifiers(_d),_d},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var rp,_d=this.itemsData.length;for(rp=0;rp<_d;rp+=1)this.prevViewData[rp]=this.itemsData[rp];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),_d=this.dynamicProperties.length,rp=0;rp<_d;rp+=1)this.dynamicProperties[rp].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(rp){var _d,np=this.stylesList.length;for(_d=0;_d<np;_d+=1)this.stylesList[_d].closed||this.stylesList[_d].transforms.push(rp)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var rp,_d=this.stylesList.length;for(rp=0;rp<_d;rp+=1)this.stylesList[rp].closed||this.stylesList[rp].transforms.pop()},CVShapeElement.prototype.closeStyles=function(rp){var _d,np=rp.length;for(_d=0;_d<np;_d+=1)rp[_d].closed=!0},CVShapeElement.prototype.searchShapes=function(rp,_d,np,ap,sp){var lp,up=rp.length-1,cp,dp,hp=[],fp=[],pp,mp,gp,yp=[].concat(sp);for(lp=up;lp>=0;lp-=1){if(pp=this.searchProcessedElement(rp[lp]),pp?_d[lp]=np[pp-1]:rp[lp]._shouldRender=ap,rp[lp].ty==="fl"||rp[lp].ty==="st"||rp[lp].ty==="gf"||rp[lp].ty==="gs")pp?_d[lp].style.closed=!1:_d[lp]=this.createStyleElement(rp[lp],yp),hp.push(_d[lp].style);else if(rp[lp].ty==="gr"){if(!pp)_d[lp]=this.createGroupElement(rp[lp]);else for(dp=_d[lp].it.length,cp=0;cp<dp;cp+=1)_d[lp].prevViewData[cp]=_d[lp].it[cp];this.searchShapes(rp[lp].it,_d[lp].it,_d[lp].prevViewData,ap,yp)}else rp[lp].ty==="tr"?(pp||(gp=this.createTransformElement(rp[lp]),_d[lp]=gp),yp.push(_d[lp]),this.addTransformToStyleList(_d[lp])):rp[lp].ty==="sh"||rp[lp].ty==="rc"||rp[lp].ty==="el"||rp[lp].ty==="sr"?pp||(_d[lp]=this.createShapeElement(rp[lp])):rp[lp].ty==="tm"||rp[lp].ty==="rd"||rp[lp].ty==="pb"||rp[lp].ty==="zz"||rp[lp].ty==="op"?(pp?(mp=_d[lp],mp.closed=!1):(mp=ShapeModifiers.getModifier(rp[lp].ty),mp.init(this,rp[lp]),_d[lp]=mp,this.shapeModifiers.push(mp)),fp.push(mp)):rp[lp].ty==="rp"&&(pp?(mp=_d[lp],mp.closed=!0):(mp=ShapeModifiers.getModifier(rp[lp].ty),_d[lp]=mp,mp.init(this,rp,lp,_d),this.shapeModifiers.push(mp),ap=!1),fp.push(mp));this.addProcessedElement(rp[lp],lp+1)}for(this.removeTransformFromStyleList(),this.closeStyles(hp),up=fp.length,lp=0;lp<up;lp+=1)fp[lp].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(rp,_d){(rp._opMdf||_d.op._mdf||this._isFirstFrame)&&(_d.opacity=rp.opacity,_d.opacity*=_d.op.v,_d._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var rp,_d=this.stylesList.length,np,ap,sp,lp,up,cp,dp=this.globalData.renderer,hp=this.globalData.canvasContext,fp,pp;for(rp=0;rp<_d;rp+=1)if(pp=this.stylesList[rp],fp=pp.type,!((fp==="st"||fp==="gs")&&pp.wi===0||!pp.data._shouldRender||pp.coOp===0||this.globalData.currentGlobalAlpha===0)){for(dp.save(),up=pp.elements,fp==="st"||fp==="gs"?(dp.ctxStrokeStyle(fp==="st"?pp.co:pp.grd),dp.ctxLineWidth(pp.wi),dp.ctxLineCap(pp.lc),dp.ctxLineJoin(pp.lj),dp.ctxMiterLimit(pp.ml||0)):dp.ctxFillStyle(fp==="fl"?pp.co:pp.grd),dp.ctxOpacity(pp.coOp),fp!=="st"&&fp!=="gs"&&hp.beginPath(),dp.ctxTransform(pp.preTransforms.finalTransform.props),ap=up.length,np=0;np<ap;np+=1){for((fp==="st"||fp==="gs")&&(hp.beginPath(),pp.da&&(hp.setLineDash(pp.da),hp.lineDashOffset=pp.do)),cp=up[np].trNodes,lp=cp.length,sp=0;sp<lp;sp+=1)cp[sp].t==="m"?hp.moveTo(cp[sp].p[0],cp[sp].p[1]):cp[sp].t==="c"?hp.bezierCurveTo(cp[sp].pts[0],cp[sp].pts[1],cp[sp].pts[2],cp[sp].pts[3],cp[sp].pts[4],cp[sp].pts[5]):hp.closePath();(fp==="st"||fp==="gs")&&(dp.ctxStroke(),pp.da&&hp.setLineDash(this.dashResetter))}fp!=="st"&&fp!=="gs"&&this.globalData.renderer.ctxFill(pp.r),dp.restore()}},CVShapeElement.prototype.renderShape=function(rp,_d,np,ap){var sp,lp=_d.length-1,up;for(up=rp,sp=lp;sp>=0;sp-=1)_d[sp].ty==="tr"?(up=np[sp].transform,this.renderShapeTransform(rp,up)):_d[sp].ty==="sh"||_d[sp].ty==="el"||_d[sp].ty==="rc"||_d[sp].ty==="sr"?this.renderPath(_d[sp],np[sp]):_d[sp].ty==="fl"?this.renderFill(_d[sp],np[sp],up):_d[sp].ty==="st"?this.renderStroke(_d[sp],np[sp],up):_d[sp].ty==="gf"||_d[sp].ty==="gs"?this.renderGradientFill(_d[sp],np[sp],up):_d[sp].ty==="gr"?this.renderShape(up,_d[sp].it,np[sp].it):_d[sp].ty;ap&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(rp,_d){if(this._isFirstFrame||_d._mdf||rp.transforms._mdf){var np=rp.trNodes,ap=_d.paths,sp,lp,up,cp=ap._length;np.length=0;var dp=rp.transforms.finalTransform;for(up=0;up<cp;up+=1){var hp=ap.shapes[up];if(hp&&hp.v){for(lp=hp._length,sp=1;sp<lp;sp+=1)sp===1&&np.push({t:"m",p:dp.applyToPointArray(hp.v[0][0],hp.v[0][1],0)}),np.push({t:"c",pts:dp.applyToTriplePoints(hp.o[sp-1],hp.i[sp],hp.v[sp])});lp===1&&np.push({t:"m",p:dp.applyToPointArray(hp.v[0][0],hp.v[0][1],0)}),hp.c&&lp&&(np.push({t:"c",pts:dp.applyToTriplePoints(hp.o[sp-1],hp.i[0],hp.v[0])}),np.push({t:"z"}))}}rp.trNodes=np}},CVShapeElement.prototype.renderPath=function(rp,_d){if(rp.hd!==!0&&rp._shouldRender){var np,ap=_d.styledShapes.length;for(np=0;np<ap;np+=1)this.renderStyledShape(_d.styledShapes[np],_d.sh)}},CVShapeElement.prototype.renderFill=function(rp,_d,np){var ap=_d.style;(_d.c._mdf||this._isFirstFrame)&&(ap.co="rgb("+bmFloor(_d.c.v[0])+","+bmFloor(_d.c.v[1])+","+bmFloor(_d.c.v[2])+")"),(_d.o._mdf||np._opMdf||this._isFirstFrame)&&(ap.coOp=_d.o.v*np.opacity)},CVShapeElement.prototype.renderGradientFill=function(rp,_d,np){var ap=_d.style,sp;if(!ap.grd||_d.g._mdf||_d.s._mdf||_d.e._mdf||rp.t!==1&&(_d.h._mdf||_d.a._mdf)){var lp=this.globalData.canvasContext,up=_d.s.v,cp=_d.e.v;if(rp.t===1)sp=lp.createLinearGradient(up[0],up[1],cp[0],cp[1]);else{var dp=Math.sqrt(Math.pow(up[0]-cp[0],2)+Math.pow(up[1]-cp[1],2)),hp=Math.atan2(cp[1]-up[1],cp[0]-up[0]),fp=_d.h.v;fp>=1?fp=.99:fp<=-1&&(fp=-.99);var pp=dp*fp,mp=Math.cos(hp+_d.a.v)*pp+up[0],gp=Math.sin(hp+_d.a.v)*pp+up[1];sp=lp.createRadialGradient(mp,gp,0,up[0],up[1],dp)}var yp,xp=rp.g.p,_p=_d.g.c,vp=1;for(yp=0;yp<xp;yp+=1)_d.g._hasOpacity&&_d.g._collapsable&&(vp=_d.g.o[yp*2+1]),sp.addColorStop(_p[yp*4]/100,"rgba("+_p[yp*4+1]+","+_p[yp*4+2]+","+_p[yp*4+3]+","+vp+")");ap.grd=sp}ap.coOp=_d.o.v*np.opacity},CVShapeElement.prototype.renderStroke=function(rp,_d,np){var ap=_d.style,sp=_d.d;sp&&(sp._mdf||this._isFirstFrame)&&(ap.da=sp.dashArray,ap.do=sp.dashoffset[0]),(_d.c._mdf||this._isFirstFrame)&&(ap.co="rgb("+bmFloor(_d.c.v[0])+","+bmFloor(_d.c.v[1])+","+bmFloor(_d.c.v[2])+")"),(_d.o._mdf||np._opMdf||this._isFirstFrame)&&(ap.coOp=_d.o.v*np.opacity),(_d.w._mdf||this._isFirstFrame)&&(ap.wi=_d.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0};function CVTextElement(rp,_d,np){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(rp,_d,np)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var rp=this.textProperty.currentData;this.renderedLetters=createSizedArray(rp.l?rp.l.length:0);var _d=!1;rp.fc?(_d=!0,this.values.fill=this.buildColor(rp.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=_d;var np=!1;rp.sc&&(np=!0,this.values.stroke=this.buildColor(rp.sc),this.values.sWidth=rp.sw);var ap=this.globalData.fontManager.getFontByName(rp.f),sp,lp,up=rp.l,cp=this.mHelper;this.stroke=np,this.values.fValue=rp.finalSize+"px "+this.globalData.fontManager.getFontByName(rp.f).fFamily,lp=rp.finalText.length;var dp,hp,fp,pp,mp,gp,yp,xp,_p,vp,bp=this.data.singleShape,Ep=rp.tr*.001*rp.finalSize,Sp=0,Ap=0,Rp=!0,Tp=0;for(sp=0;sp<lp;sp+=1){dp=this.globalData.fontManager.getCharData(rp.finalText[sp],ap.fStyle,this.globalData.fontManager.getFontByName(rp.f).fFamily),hp=dp&&dp.data||{},cp.reset(),bp&&up[sp].n&&(Sp=-Ep,Ap+=rp.yOffset,Ap+=Rp?1:0,Rp=!1),mp=hp.shapes?hp.shapes[0].it:[],yp=mp.length,cp.scale(rp.finalSize/100,rp.finalSize/100),bp&&this.applyTextPropertiesToMatrix(rp,cp,up[sp].line,Sp,Ap),_p=createSizedArray(yp-1);var Mp=0;for(gp=0;gp<yp;gp+=1)if(mp[gp].ty==="sh"){for(pp=mp[gp].ks.k.i.length,xp=mp[gp].ks.k,vp=[],fp=1;fp<pp;fp+=1)fp===1&&vp.push(cp.applyToX(xp.v[0][0],xp.v[0][1],0),cp.applyToY(xp.v[0][0],xp.v[0][1],0)),vp.push(cp.applyToX(xp.o[fp-1][0],xp.o[fp-1][1],0),cp.applyToY(xp.o[fp-1][0],xp.o[fp-1][1],0),cp.applyToX(xp.i[fp][0],xp.i[fp][1],0),cp.applyToY(xp.i[fp][0],xp.i[fp][1],0),cp.applyToX(xp.v[fp][0],xp.v[fp][1],0),cp.applyToY(xp.v[fp][0],xp.v[fp][1],0));vp.push(cp.applyToX(xp.o[fp-1][0],xp.o[fp-1][1],0),cp.applyToY(xp.o[fp-1][0],xp.o[fp-1][1],0),cp.applyToX(xp.i[0][0],xp.i[0][1],0),cp.applyToY(xp.i[0][0],xp.i[0][1],0),cp.applyToX(xp.v[0][0],xp.v[0][1],0),cp.applyToY(xp.v[0][0],xp.v[0][1],0)),_p[Mp]=vp,Mp+=1}bp&&(Sp+=up[sp].l,Sp+=Ep),this.textSpans[Tp]?this.textSpans[Tp].elem=_p:this.textSpans[Tp]={elem:_p},Tp+=1}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();var rp=this.canvasContext;rp.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var _d,np,ap,sp,lp,up,cp=this.textAnimator.renderedLetters,dp=this.textProperty.currentData.l;np=dp.length;var hp,fp=null,pp=null,mp=null,gp,yp,xp=this.globalData.renderer;for(_d=0;_d<np;_d+=1)if(!dp[_d].n){if(hp=cp[_d],hp&&(xp.save(),xp.ctxTransform(hp.p),xp.ctxOpacity(hp.o)),this.fill){for(hp&&hp.fc?fp!==hp.fc&&(xp.ctxFillStyle(hp.fc),fp=hp.fc):fp!==this.values.fill&&(fp=this.values.fill,xp.ctxFillStyle(this.values.fill)),gp=this.textSpans[_d].elem,sp=gp.length,this.globalData.canvasContext.beginPath(),ap=0;ap<sp;ap+=1)for(yp=gp[ap],up=yp.length,this.globalData.canvasContext.moveTo(yp[0],yp[1]),lp=2;lp<up;lp+=6)this.globalData.canvasContext.bezierCurveTo(yp[lp],yp[lp+1],yp[lp+2],yp[lp+3],yp[lp+4],yp[lp+5]);this.globalData.canvasContext.closePath(),xp.ctxFill()}if(this.stroke){for(hp&&hp.sw?mp!==hp.sw&&(mp=hp.sw,xp.ctxLineWidth(hp.sw)):mp!==this.values.sWidth&&(mp=this.values.sWidth,xp.ctxLineWidth(this.values.sWidth)),hp&&hp.sc?pp!==hp.sc&&(pp=hp.sc,xp.ctxStrokeStyle(hp.sc)):pp!==this.values.stroke&&(pp=this.values.stroke,xp.ctxStrokeStyle(this.values.stroke)),gp=this.textSpans[_d].elem,sp=gp.length,this.globalData.canvasContext.beginPath(),ap=0;ap<sp;ap+=1)for(yp=gp[ap],up=yp.length,this.globalData.canvasContext.moveTo(yp[0],yp[1]),lp=2;lp<up;lp+=6)this.globalData.canvasContext.bezierCurveTo(yp[lp],yp[lp+1],yp[lp+2],yp[lp+3],yp[lp+4],yp[lp+5]);this.globalData.canvasContext.closePath(),xp.ctxStroke()}hp&&this.globalData.renderer.restore()}};function CVImageElement(rp,_d,np){this.assetData=_d.getAssetData(rp.refId),this.img=_d.imageLoader.getAsset(this.assetData),this.initElement(rp,_d,np)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var rp=createTag("canvas");rp.width=this.assetData.w,rp.height=this.assetData.h;var _d=rp.getContext("2d"),np=this.img.width,ap=this.img.height,sp=np/ap,lp=this.assetData.w/this.assetData.h,up,cp,dp=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;sp>lp&&dp==="xMidYMid slice"||sp<lp&&dp!=="xMidYMid slice"?(cp=ap,up=cp*lp):(up=np,cp=up/lp),_d.drawImage(this.img,(np-up)/2,(ap-cp)/2,up,cp,0,0,this.assetData.w,this.assetData.h),this.img=rp}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null};function CVSolidElement(rp,_d,np){this.initElement(rp,_d,np)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)};function CanvasRendererBase(){}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(rp){return new CVShapeElement(rp,this.globalData,this)},CanvasRendererBase.prototype.createText=function(rp){return new CVTextElement(rp,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(rp){return new CVImageElement(rp,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(rp){return new CVSolidElement(rp,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(rp){rp[0]===1&&rp[1]===0&&rp[4]===0&&rp[5]===1&&rp[12]===0&&rp[13]===0||this.canvasContext.transform(rp[0],rp[1],rp[4],rp[5],rp[12],rp[13])},CanvasRendererBase.prototype.ctxOpacity=function(rp){this.canvasContext.globalAlpha*=rp<0?0:rp},CanvasRendererBase.prototype.ctxFillStyle=function(rp){this.canvasContext.fillStyle=rp},CanvasRendererBase.prototype.ctxStrokeStyle=function(rp){this.canvasContext.strokeStyle=rp},CanvasRendererBase.prototype.ctxLineWidth=function(rp){this.canvasContext.lineWidth=rp},CanvasRendererBase.prototype.ctxLineCap=function(rp){this.canvasContext.lineCap=rp},CanvasRendererBase.prototype.ctxLineJoin=function(rp){this.canvasContext.lineJoin=rp},CanvasRendererBase.prototype.ctxMiterLimit=function(rp){this.canvasContext.miterLimit=rp},CanvasRendererBase.prototype.ctxFill=function(rp){this.canvasContext.fill(rp)},CanvasRendererBase.prototype.ctxFillRect=function(rp,_d,np,ap){this.canvasContext.fillRect(rp,_d,np,ap)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}this.contextData.reset()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(rp){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}rp&&(this.globalData.blendMode="source-over"),this.contextData.restore(rp)},CanvasRendererBase.prototype.configAnimation=function(rp){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var _d=this.animationItem.container.style;_d.width="100%",_d.height="100%";var np="0px 0px 0px";_d.transformOrigin=np,_d.mozTransformOrigin=np,_d.webkitTransformOrigin=np,_d["-webkit-transform"]=np,_d.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=rp,this.layers=rp.layers,this.transformCanvas={w:rp.w,h:rp.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(rp,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(rp.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(rp,_d){this.reset();var np,ap;rp?(np=rp,ap=_d,this.canvasContext.canvas.width=np,this.canvasContext.canvas.height=ap):(this.animationItem.wrapper&&this.animationItem.container?(np=this.animationItem.wrapper.offsetWidth,ap=this.animationItem.wrapper.offsetHeight):(np=this.canvasContext.canvas.width,ap=this.canvasContext.canvas.height),this.canvasContext.canvas.width=np*this.renderConfig.dpr,this.canvasContext.canvas.height=ap*this.renderConfig.dpr);var sp,lp;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var up=this.renderConfig.preserveAspectRatio.split(" "),cp=up[1]||"meet",dp=up[0]||"xMidYMid",hp=dp.substr(0,4),fp=dp.substr(4);sp=np/ap,lp=this.transformCanvas.w/this.transformCanvas.h,lp>sp&&cp==="meet"||lp<sp&&cp==="slice"?(this.transformCanvas.sx=np/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=np/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=ap/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=ap/(this.transformCanvas.h/this.renderConfig.dpr)),hp==="xMid"&&(lp<sp&&cp==="meet"||lp>sp&&cp==="slice")?this.transformCanvas.tx=(np-this.transformCanvas.w*(ap/this.transformCanvas.h))/2*this.renderConfig.dpr:hp==="xMax"&&(lp<sp&&cp==="meet"||lp>sp&&cp==="slice")?this.transformCanvas.tx=(np-this.transformCanvas.w*(ap/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,fp==="YMid"&&(lp>sp&&cp==="meet"||lp<sp&&cp==="slice")?this.transformCanvas.ty=(ap-this.transformCanvas.h*(np/this.transformCanvas.w))/2*this.renderConfig.dpr:fp==="YMax"&&(lp>sp&&cp==="meet"||lp<sp&&cp==="slice")?this.transformCanvas.ty=(ap-this.transformCanvas.h*(np/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=np/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=ap/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var rp,_d=this.layers?this.layers.length:0;for(rp=_d-1;rp>=0;rp-=1)this.elements[rp]&&this.elements[rp].destroy&&this.elements[rp].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(rp,_d){if(!(this.renderedFrame===rp&&this.renderConfig.clearCanvas===!0&&!_d||this.destroyed||rp===-1)){this.renderedFrame=rp,this.globalData.frameNum=rp-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||_d,this.globalData.projectInterface.currentFrame=rp;var np,ap=this.layers.length;for(this.completeLayers||this.checkLayers(rp),np=ap-1;np>=0;np-=1)(this.completeLayers||this.elements[np])&&this.elements[np].prepareFrame(rp-this.layers[np].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),np=ap-1;np>=0;np-=1)(this.completeLayers||this.elements[np])&&this.elements[np].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(rp){var _d=this.elements;if(!(_d[rp]||this.layers[rp].ty===99)){var np=this.createItem(this.layers[rp],this,this.globalData);_d[rp]=np,np.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var rp=this.pendingElements.pop();rp.checkParenting()}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"};function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix;var rp,_d=15;for(rp=0;rp<_d;rp+=1){var np=new CanvasContext;this.stack[rp]=np}this._length=_d,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}CVContextData.prototype.duplicate=function(){var rp=this._length*2,_d=0;for(_d=this._length;_d<rp;_d+=1)this.stack[_d]=new CanvasContext;this._length=rp},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(rp){this.cArrPos-=1;var _d=this.stack[this.cArrPos],np=_d.transform,ap,sp=this.cTr.props;for(ap=0;ap<16;ap+=1)sp[ap]=np[ap];if(rp){this.nativeContext.restore();var lp=this.stack[this.cArrPos+1];this.appliedFillStyle=lp.fillStyle,this.appliedStrokeStyle=lp.strokeStyle,this.appliedLineWidth=lp.lineWidth,this.appliedLineCap=lp.lineCap,this.appliedLineJoin=lp.lineJoin,this.appliedMiterLimit=lp.miterLimit}this.nativeContext.setTransform(np[0],np[1],np[4],np[5],np[12],np[13]),(rp||_d.opacity!==-1&&this.currentOpacity!==_d.opacity)&&(this.nativeContext.globalAlpha=_d.opacity,this.currentOpacity=_d.opacity),this.currentFillStyle=_d.fillStyle,this.currentStrokeStyle=_d.strokeStyle,this.currentLineWidth=_d.lineWidth,this.currentLineCap=_d.lineCap,this.currentLineJoin=_d.lineJoin,this.currentMiterLimit=_d.miterLimit},CVContextData.prototype.save=function(rp){rp&&this.nativeContext.save();var _d=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var np=this.stack[this.cArrPos],ap;for(ap=0;ap<16;ap+=1)np.transform[ap]=_d[ap];this.cArrPos+=1;var sp=this.stack[this.cArrPos];sp.opacity=np.opacity,sp.fillStyle=np.fillStyle,sp.strokeStyle=np.strokeStyle,sp.lineWidth=np.lineWidth,sp.lineCap=np.lineCap,sp.lineJoin=np.lineJoin,sp.miterLimit=np.miterLimit},CVContextData.prototype.setOpacity=function(rp){this.stack[this.cArrPos].opacity=rp},CVContextData.prototype.setContext=function(rp){this.nativeContext=rp},CVContextData.prototype.fillStyle=function(rp){this.stack[this.cArrPos].fillStyle!==rp&&(this.currentFillStyle=rp,this.stack[this.cArrPos].fillStyle=rp)},CVContextData.prototype.strokeStyle=function(rp){this.stack[this.cArrPos].strokeStyle!==rp&&(this.currentStrokeStyle=rp,this.stack[this.cArrPos].strokeStyle=rp)},CVContextData.prototype.lineWidth=function(rp){this.stack[this.cArrPos].lineWidth!==rp&&(this.currentLineWidth=rp,this.stack[this.cArrPos].lineWidth=rp)},CVContextData.prototype.lineCap=function(rp){this.stack[this.cArrPos].lineCap!==rp&&(this.currentLineCap=rp,this.stack[this.cArrPos].lineCap=rp)},CVContextData.prototype.lineJoin=function(rp){this.stack[this.cArrPos].lineJoin!==rp&&(this.currentLineJoin=rp,this.stack[this.cArrPos].lineJoin=rp)},CVContextData.prototype.miterLimit=function(rp){this.stack[this.cArrPos].miterLimit!==rp&&(this.currentMiterLimit=rp,this.stack[this.cArrPos].miterLimit=rp)},CVContextData.prototype.transform=function(rp){this.transformMat.cloneFromProps(rp);var _d=this.cTr;this.transformMat.multiply(_d),_d.cloneFromProps(this.transformMat.props);var np=_d.props;this.nativeContext.setTransform(np[0],np[1],np[4],np[5],np[12],np[13])},CVContextData.prototype.opacity=function(rp){var _d=this.stack[this.cArrPos].opacity;_d*=rp<0?0:rp,this.stack[this.cArrPos].opacity!==_d&&(this.currentOpacity!==rp&&(this.nativeContext.globalAlpha=rp,this.currentOpacity=rp),this.stack[this.cArrPos].opacity=_d)},CVContextData.prototype.fill=function(rp){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(rp)},CVContextData.prototype.fillRect=function(rp,_d,np,ap){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(rp,_d,np,ap)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()};function CVCompElement(rp,_d,np){this.completeLayers=!1,this.layers=rp.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(rp,_d,np),this.tm=rp.tm?PropertyFactory.getProp(this,rp.tm,0,_d.frameRate,this):{_placeholder:!0}}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var rp=this.canvasContext;rp.beginPath(),rp.moveTo(0,0),rp.lineTo(this.data.w,0),rp.lineTo(this.data.w,this.data.h),rp.lineTo(0,this.data.h),rp.lineTo(0,0),rp.clip();var _d,np=this.layers.length;for(_d=np-1;_d>=0;_d-=1)(this.completeLayers||this.elements[_d])&&this.elements[_d].renderFrame()},CVCompElement.prototype.destroy=function(){var rp,_d=this.layers.length;for(rp=_d-1;rp>=0;rp-=1)this.elements[rp]&&this.elements[rp].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(rp){return new CVCompElement(rp,this.globalData,this)};function CanvasRenderer(rp,_d){this.animationItem=rp,this.renderConfig={clearCanvas:_d&&_d.clearCanvas!==void 0?_d.clearCanvas:!0,context:_d&&_d.context||null,progressiveLoad:_d&&_d.progressiveLoad||!1,preserveAspectRatio:_d&&_d.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:_d&&_d.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:_d&&_d.contentVisibility||"visible",className:_d&&_d.className||"",id:_d&&_d.id||"",runExpressions:!_d||_d.runExpressions===void 0||_d.runExpressions},this.renderConfig.dpr=_d&&_d.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=_d&&_d.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(rp){return new CVCompElement(rp,this.globalData,this)};function HBaseElement(){}HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode()},renderElement:function(){var _d=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var np=this.finalTransform.mat.toCSS();_d.transform=np,_d.webkitTransform=np}this.finalTransform._opMdf&&(_d.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting;function HSolidElement(rp,_d,np){this.initElement(rp,_d,np)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var rp;this.data.hasMask?(rp=createNS("rect"),rp.setAttribute("width",this.data.sw),rp.setAttribute("height",this.data.sh),rp.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(rp=createTag("div"),rp.style.width=this.data.sw+"px",rp.style.height=this.data.sh+"px",rp.style.backgroundColor=this.data.sc),this.layerElement.appendChild(rp)};function HShapeElement(rp,_d,np){this.shapes=[],this.shapesData=rp.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(rp,_d,np),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var rp;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),rp=this.svgElement;else{rp=createNS("svg");var _d=this.comp.data?this.comp.data:this.globalData.compSize;rp.setAttribute("width",_d.w),rp.setAttribute("height",_d.h),rp.appendChild(this.shapesContainer),this.layerElement.appendChild(rp)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=rp},HShapeElement.prototype.getTransformedPoint=function(rp,_d){var np,ap=rp.length;for(np=0;np<ap;np+=1)_d=rp[np].mProps.v.applyToPointArray(_d[0],_d[1],0);return _d},HShapeElement.prototype.calculateShapeBoundingBox=function(rp,_d){var np=rp.sh.v,ap=rp.transformers,sp,lp=np._length,up,cp,dp,hp;if(!(lp<=1)){for(sp=0;sp<lp-1;sp+=1)up=this.getTransformedPoint(ap,np.v[sp]),cp=this.getTransformedPoint(ap,np.o[sp]),dp=this.getTransformedPoint(ap,np.i[sp+1]),hp=this.getTransformedPoint(ap,np.v[sp+1]),this.checkBounds(up,cp,dp,hp,_d);np.c&&(up=this.getTransformedPoint(ap,np.v[sp]),cp=this.getTransformedPoint(ap,np.o[sp]),dp=this.getTransformedPoint(ap,np.i[0]),hp=this.getTransformedPoint(ap,np.v[0]),this.checkBounds(up,cp,dp,hp,_d))}},HShapeElement.prototype.checkBounds=function(rp,_d,np,ap,sp){this.getBoundsOfCurve(rp,_d,np,ap);var lp=this.shapeBoundingBox;sp.x=bmMin(lp.left,sp.x),sp.xMax=bmMax(lp.right,sp.xMax),sp.y=bmMin(lp.top,sp.y),sp.yMax=bmMax(lp.bottom,sp.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(rp,_d,np,ap){for(var sp=[[rp[0],ap[0]],[rp[1],ap[1]]],lp,up,cp,dp,hp,fp,pp,mp=0;mp<2;++mp)up=6*rp[mp]-12*_d[mp]+6*np[mp],lp=-3*rp[mp]+9*_d[mp]-9*np[mp]+3*ap[mp],cp=3*_d[mp]-3*rp[mp],up|=0,lp|=0,cp|=0,lp===0&&up===0||(lp===0?(dp=-cp/up,dp>0&&dp<1&&sp[mp].push(this.calculateF(dp,rp,_d,np,ap,mp))):(hp=up*up-4*cp*lp,hp>=0&&(fp=(-up+bmSqrt(hp))/(2*lp),fp>0&&fp<1&&sp[mp].push(this.calculateF(fp,rp,_d,np,ap,mp)),pp=(-up-bmSqrt(hp))/(2*lp),pp>0&&pp<1&&sp[mp].push(this.calculateF(pp,rp,_d,np,ap,mp)))));this.shapeBoundingBox.left=bmMin.apply(null,sp[0]),this.shapeBoundingBox.top=bmMin.apply(null,sp[1]),this.shapeBoundingBox.right=bmMax.apply(null,sp[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,sp[1])},HShapeElement.prototype.calculateF=function(rp,_d,np,ap,sp,lp){return bmPow(1-rp,3)*_d[lp]+3*bmPow(1-rp,2)*rp*np[lp]+3*(1-rp)*bmPow(rp,2)*ap[lp]+bmPow(rp,3)*sp[lp]},HShapeElement.prototype.calculateBoundingBox=function(rp,_d){var np,ap=rp.length;for(np=0;np<ap;np+=1)rp[np]&&rp[np].sh?this.calculateShapeBoundingBox(rp[np],_d):rp[np]&&rp[np].it?this.calculateBoundingBox(rp[np].it,_d):rp[np]&&rp[np].style&&rp[np].w&&this.expandStrokeBoundingBox(rp[np].w,_d)},HShapeElement.prototype.expandStrokeBoundingBox=function(rp,_d){var np=0;if(rp.keyframes){for(var ap=0;ap<rp.keyframes.length;ap+=1){var sp=rp.keyframes[ap].s;sp>np&&(np=sp)}np*=rp.mult}else np=rp.v*rp.mult;_d.x-=np,_d.xMax+=np,_d.y-=np,_d.yMax+=np},HShapeElement.prototype.currentBoxContains=function(rp){return this.currentBBox.x<=rp.x&&this.currentBBox.y<=rp.y&&this.currentBBox.width+this.currentBBox.x>=rp.x+rp.width&&this.currentBBox.height+this.currentBBox.y>=rp.y+rp.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var rp=this.tempBoundingBox,_d=999999;if(rp.x=_d,rp.xMax=-_d,rp.y=_d,rp.yMax=-_d,this.calculateBoundingBox(this.itemsData,rp),rp.width=rp.xMax<rp.x?0:rp.xMax-rp.x,rp.height=rp.yMax<rp.y?0:rp.yMax-rp.y,this.currentBoxContains(rp))return;var np=!1;if(this.currentBBox.w!==rp.width&&(this.currentBBox.w=rp.width,this.shapeCont.setAttribute("width",rp.width),np=!0),this.currentBBox.h!==rp.height&&(this.currentBBox.h=rp.height,this.shapeCont.setAttribute("height",rp.height),np=!0),np||this.currentBBox.x!==rp.x||this.currentBBox.y!==rp.y){this.currentBBox.w=rp.width,this.currentBBox.h=rp.height,this.currentBBox.x=rp.x,this.currentBBox.y=rp.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var ap=this.shapeCont.style,sp="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";ap.transform=sp,ap.webkitTransform=sp}}};function HTextElement(rp,_d,np){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(rp,_d,np)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var rp=createNS("g");this.maskedElement.appendChild(rp),this.innerElem=rp}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var rp=this.textProperty.currentData;this.renderedLetters=createSizedArray(rp.l?rp.l.length:0);var _d=this.innerElem.style,np=rp.fc?this.buildColor(rp.fc):"rgba(0,0,0,0)";_d.fill=np,_d.color=np,rp.sc&&(_d.stroke=this.buildColor(rp.sc),_d.strokeWidth=rp.sw+"px");var ap=this.globalData.fontManager.getFontByName(rp.f);if(!this.globalData.fontManager.chars)if(_d.fontSize=rp.finalSize+"px",_d.lineHeight=rp.finalSize+"px",ap.fClass)this.innerElem.className=ap.fClass;else{_d.fontFamily=ap.fFamily;var sp=rp.fWeight,lp=rp.fStyle;_d.fontStyle=lp,_d.fontWeight=sp}var up,cp,dp=rp.l;cp=dp.length;var hp,fp,pp,mp=this.mHelper,gp,yp="",xp=0;for(up=0;up<cp;up+=1){if(this.globalData.fontManager.chars?(this.textPaths[xp]?hp=this.textPaths[xp]:(hp=createNS("path"),hp.setAttribute("stroke-linecap",lineCapEnum[1]),hp.setAttribute("stroke-linejoin",lineJoinEnum[2]),hp.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[xp]?(fp=this.textSpans[xp],pp=fp.children[0]):(fp=createTag("div"),fp.style.lineHeight=0,pp=createNS("svg"),pp.appendChild(hp),styleDiv(fp)))):this.isMasked?hp=this.textPaths[xp]?this.textPaths[xp]:createNS("text"):this.textSpans[xp]?(fp=this.textSpans[xp],hp=this.textPaths[xp]):(fp=createTag("span"),styleDiv(fp),hp=createTag("span"),styleDiv(hp),fp.appendChild(hp)),this.globalData.fontManager.chars){var _p=this.globalData.fontManager.getCharData(rp.finalText[up],ap.fStyle,this.globalData.fontManager.getFontByName(rp.f).fFamily),vp;if(_p?vp=_p.data:vp=null,mp.reset(),vp&&vp.shapes&&vp.shapes.length&&(gp=vp.shapes[0].it,mp.scale(rp.finalSize/100,rp.finalSize/100),yp=this.createPathShape(mp,gp),hp.setAttribute("d",yp)),this.isMasked)this.innerElem.appendChild(hp);else{if(this.innerElem.appendChild(fp),vp&&vp.shapes){document.body.appendChild(pp);var bp=pp.getBBox();pp.setAttribute("width",bp.width+2),pp.setAttribute("height",bp.height+2),pp.setAttribute("viewBox",bp.x-1+" "+(bp.y-1)+" "+(bp.width+2)+" "+(bp.height+2));var Ep=pp.style,Sp="translate("+(bp.x-1)+"px,"+(bp.y-1)+"px)";Ep.transform=Sp,Ep.webkitTransform=Sp,dp[up].yOffset=bp.y-1}else pp.setAttribute("width",1),pp.setAttribute("height",1);fp.appendChild(pp)}}else if(hp.textContent=dp[up].val,hp.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(hp);else{this.innerElem.appendChild(fp);var Ap=hp.style,Rp="translate3d(0,"+-rp.finalSize/1.2+"px,0)";Ap.transform=Rp,Ap.webkitTransform=Rp}this.isMasked?this.textSpans[xp]=hp:this.textSpans[xp]=fp,this.textSpans[xp].style.display="block",this.textPaths[xp]=hp,xp+=1}for(;xp<this.textSpans.length;)this.textSpans[xp].style.display="none",xp+=1},HTextElement.prototype.renderInnerContent=function(){this.validateText();var rp;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),rp=this.svgElement.style;var _d="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";rp.transform=_d,rp.webkitTransform=_d}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),!(!this.lettersChangedFlag&&!this.textAnimator.lettersChangedFlag)){var np,ap,sp=0,lp=this.textAnimator.renderedLetters,up=this.textProperty.currentData.l;ap=up.length;var cp,dp,hp;for(np=0;np<ap;np+=1)up[np].n?sp+=1:(dp=this.textSpans[np],hp=this.textPaths[np],cp=lp[sp],sp+=1,cp._mdf.m&&(this.isMasked?dp.setAttribute("transform",cp.m):(dp.style.webkitTransform=cp.m,dp.style.transform=cp.m)),dp.style.opacity=cp.o,cp.sw&&cp._mdf.sw&&hp.setAttribute("stroke-width",cp.sw),cp.sc&&cp._mdf.sc&&hp.setAttribute("stroke",cp.sc),cp.fc&&cp._mdf.fc&&(hp.setAttribute("fill",cp.fc),hp.style.color=cp.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var fp=this.innerElem.getBBox();this.currentBBox.w!==fp.width&&(this.currentBBox.w=fp.width,this.svgElement.setAttribute("width",fp.width)),this.currentBBox.h!==fp.height&&(this.currentBBox.h=fp.height,this.svgElement.setAttribute("height",fp.height));var pp=1;if(this.currentBBox.w!==fp.width+pp*2||this.currentBBox.h!==fp.height+pp*2||this.currentBBox.x!==fp.x-pp||this.currentBBox.y!==fp.y-pp){this.currentBBox.w=fp.width+pp*2,this.currentBBox.h=fp.height+pp*2,this.currentBBox.x=fp.x-pp,this.currentBBox.y=fp.y-pp,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),rp=this.svgElement.style;var mp="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";rp.transform=mp,rp.webkitTransform=mp}}}};function HCameraElement(rp,_d,np){this.initFrame(),this.initBaseData(rp,_d,np),this.initHierarchy();var ap=PropertyFactory.getProp;if(this.pe=ap(this,rp.pe,0,0,this),rp.ks.p.s?(this.px=ap(this,rp.ks.p.x,1,0,this),this.py=ap(this,rp.ks.p.y,1,0,this),this.pz=ap(this,rp.ks.p.z,1,0,this)):this.p=ap(this,rp.ks.p,1,0,this),rp.ks.a&&(this.a=ap(this,rp.ks.a,1,0,this)),rp.ks.or.k.length&&rp.ks.or.k[0].to){var sp,lp=rp.ks.or.k.length;for(sp=0;sp<lp;sp+=1)rp.ks.or.k[sp].to=null,rp.ks.or.k[sp].ti=null}this.or=ap(this,rp.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=ap(this,rp.ks.rx,0,degToRads,this),this.ry=ap(this,rp.ks.ry,0,degToRads,this),this.rz=ap(this,rp.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var rp,_d=this.comp.threeDElements.length,np,ap,sp;for(rp=0;rp<_d;rp+=1)if(np=this.comp.threeDElements[rp],np.type==="3d"){ap=np.perspectiveElem.style,sp=np.container.style;var lp=this.pe.v+"px",up="0px 0px 0px",cp="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";ap.perspective=lp,ap.webkitPerspective=lp,sp.transformOrigin=up,sp.mozTransformOrigin=up,sp.webkitTransformOrigin=up,ap.transform=cp,ap.webkitTransform=cp}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var rp=this._isFirstFrame,_d,np;if(this.hierarchy)for(np=this.hierarchy.length,_d=0;_d<np;_d+=1)rp=this.hierarchy[_d].finalTransform.mProp._mdf||rp;if(rp||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(np=this.hierarchy.length-1,_d=np;_d>=0;_d-=1){var ap=this.hierarchy[_d].finalTransform.mProp;this.mat.translate(-ap.p.v[0],-ap.p.v[1],ap.p.v[2]),this.mat.rotateX(-ap.or.v[0]).rotateY(-ap.or.v[1]).rotateZ(ap.or.v[2]),this.mat.rotateX(-ap.rx.v).rotateY(-ap.ry.v).rotateZ(ap.rz.v),this.mat.scale(1/ap.s.v[0],1/ap.s.v[1],1/ap.s.v[2]),this.mat.translate(ap.a.v[0],ap.a.v[1],ap.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var sp;this.p?sp=[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:sp=[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var lp=Math.sqrt(Math.pow(sp[0],2)+Math.pow(sp[1],2)+Math.pow(sp[2],2)),up=[sp[0]/lp,sp[1]/lp,sp[2]/lp],cp=Math.sqrt(up[2]*up[2]+up[0]*up[0]),dp=Math.atan2(up[1],cp),hp=Math.atan2(up[0],-up[2]);this.mat.rotateY(hp).rotateX(-dp)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var fp=!this._prevMat.equals(this.mat);if((fp||this.pe._mdf)&&this.comp.threeDElements){np=this.comp.threeDElements.length;var pp,mp,gp;for(_d=0;_d<np;_d+=1)if(pp=this.comp.threeDElements[_d],pp.type==="3d"){if(fp){var yp=this.mat.toCSS();gp=pp.container.style,gp.transform=yp,gp.webkitTransform=yp}this.pe._mdf&&(mp=pp.perspectiveElem.style,mp.perspective=this.pe.v+"px",mp.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(rp){this.prepareProperties(rp,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null};function HImageElement(rp,_d,np){this.assetData=_d.getAssetData(rp.refId),this.initElement(rp,_d,np)}extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var rp=this.globalData.getAssetsPath(this.assetData),_d=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",rp),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(_d),_d.crossOrigin="anonymous",_d.src=rp,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)};function HybridRendererBase(rp,_d){this.animationItem=rp,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:_d&&_d.className||"",imagePreserveAspectRatio:_d&&_d.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(_d&&_d.hideOnTransparent===!1),filterSize:{width:_d&&_d.filterSize&&_d.filterSize.width||"400%",height:_d&&_d.filterSize&&_d.filterSize.height||"400%",x:_d&&_d.filterSize&&_d.filterSize.x||"-100%",y:_d&&_d.filterSize&&_d.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var rp=this.pendingElements.pop();rp.checkParenting()}},HybridRendererBase.prototype.appendElementInPos=function(rp,_d){var np=rp.getBaseElement();if(np){var ap=this.layers[_d];if(!ap.ddd||!this.supports3d)if(this.threeDElements)this.addTo3dContainer(np,_d);else{for(var sp=0,lp,up,cp;sp<_d;)this.elements[sp]&&this.elements[sp]!==!0&&this.elements[sp].getBaseElement&&(up=this.elements[sp],cp=this.layers[sp].ddd?this.getThreeDContainerByPos(sp):up.getBaseElement(),lp=cp||lp),sp+=1;lp?(!ap.ddd||!this.supports3d)&&this.layerElement.insertBefore(np,lp):(!ap.ddd||!this.supports3d)&&this.layerElement.appendChild(np)}else this.addTo3dContainer(np,_d)}},HybridRendererBase.prototype.createShape=function(rp){return this.supports3d?new HShapeElement(rp,this.globalData,this):new SVGShapeElement(rp,this.globalData,this)},HybridRendererBase.prototype.createText=function(rp){return this.supports3d?new HTextElement(rp,this.globalData,this):new SVGTextLottieElement(rp,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(rp){return this.camera=new HCameraElement(rp,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(rp){return this.supports3d?new HImageElement(rp,this.globalData,this):new IImageElement(rp,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(rp){return this.supports3d?new HSolidElement(rp,this.globalData,this):new ISolidElement(rp,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(rp){for(var _d=0,np=this.threeDElements.length;_d<np;){if(this.threeDElements[_d].startPos<=rp&&this.threeDElements[_d].endPos>=rp)return this.threeDElements[_d].perspectiveElem;_d+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(rp,_d){var np=createTag("div"),ap,sp;styleDiv(np);var lp=createTag("div");if(styleDiv(lp),_d==="3d"){ap=np.style,ap.width=this.globalData.compSize.w+"px",ap.height=this.globalData.compSize.h+"px";var up="50% 50%";ap.webkitTransformOrigin=up,ap.mozTransformOrigin=up,ap.transformOrigin=up,sp=lp.style;var cp="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";sp.transform=cp,sp.webkitTransform=cp}np.appendChild(lp);var dp={container:lp,perspectiveElem:np,startPos:rp,endPos:rp,type:_d};return this.threeDElements.push(dp),dp},HybridRendererBase.prototype.build3dContainers=function(){var rp,_d=this.layers.length,np,ap="";for(rp=0;rp<_d;rp+=1)this.layers[rp].ddd&&this.layers[rp].ty!==3?(ap!=="3d"&&(ap="3d",np=this.createThreeDContainer(rp,"3d")),np.endPos=Math.max(np.endPos,rp)):(ap!=="2d"&&(ap="2d",np=this.createThreeDContainer(rp,"2d")),np.endPos=Math.max(np.endPos,rp));for(_d=this.threeDElements.length,rp=_d-1;rp>=0;rp-=1)this.resizerElem.appendChild(this.threeDElements[rp].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(rp,_d){for(var np=0,ap=this.threeDElements.length;np<ap;){if(_d<=this.threeDElements[np].endPos){for(var sp=this.threeDElements[np].startPos,lp;sp<_d;)this.elements[sp]&&this.elements[sp].getBaseElement&&(lp=this.elements[sp].getBaseElement()),sp+=1;lp?this.threeDElements[np].container.insertBefore(rp,lp):this.threeDElements[np].container.appendChild(rp);break}np+=1}},HybridRendererBase.prototype.configAnimation=function(rp){var _d=createTag("div"),np=this.animationItem.wrapper,ap=_d.style;ap.width=rp.w+"px",ap.height=rp.h+"px",this.resizerElem=_d,styleDiv(_d),ap.transformStyle="flat",ap.mozTransformStyle="flat",ap.webkitTransformStyle="flat",this.renderConfig.className&&_d.setAttribute("class",this.renderConfig.className),np.appendChild(_d),ap.overflow="hidden";var sp=createNS("svg");sp.setAttribute("width","1"),sp.setAttribute("height","1"),styleDiv(sp),this.resizerElem.appendChild(sp);var lp=createNS("defs");sp.appendChild(lp),this.data=rp,this.setupGlobalData(rp,sp),this.globalData.defs=lp,this.layers=rp.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var rp,_d=this.layers?this.layers.length:0;for(rp=0;rp<_d;rp+=1)this.elements[rp]&&this.elements[rp].destroy&&this.elements[rp].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var rp=this.animationItem.wrapper.offsetWidth,_d=this.animationItem.wrapper.offsetHeight,np=rp/_d,ap=this.globalData.compSize.w/this.globalData.compSize.h,sp,lp,up,cp;ap>np?(sp=rp/this.globalData.compSize.w,lp=rp/this.globalData.compSize.w,up=0,cp=(_d-this.globalData.compSize.h*(rp/this.globalData.compSize.w))/2):(sp=_d/this.globalData.compSize.h,lp=_d/this.globalData.compSize.h,up=(rp-this.globalData.compSize.w*(_d/this.globalData.compSize.h))/2,cp=0);var dp=this.resizerElem.style;dp.webkitTransform="matrix3d("+sp+",0,0,0,0,"+lp+",0,0,0,0,1,0,"+up+","+cp+",0,1)",dp.transform=dp.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var rp=this.globalData.compSize.w,_d=this.globalData.compSize.h,np,ap=this.threeDElements.length;for(np=0;np<ap;np+=1){var sp=this.threeDElements[np].perspectiveElem.style;sp.webkitPerspective=Math.sqrt(Math.pow(rp,2)+Math.pow(_d,2))+"px",sp.perspective=sp.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(rp){var _d,np=rp.length,ap=createTag("div");for(_d=0;_d<np;_d+=1)if(rp[_d].xt){var sp=this.createComp(rp[_d],ap,this.globalData.comp,null);sp.initExpressions(),this.globalData.projectInterface.registerComposition(sp)}};function HCompElement(rp,_d,np){this.layers=rp.layers,this.supports3d=!rp.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(rp,_d,np),this.tm=rp.tm?PropertyFactory.getProp(this,rp.tm,0,_d.frameRate,this):{_placeholder:!0}}extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(rp,_d){for(var np=0,ap;np<_d;)this.elements[np]&&this.elements[np].getBaseElement&&(ap=this.elements[np].getBaseElement()),np+=1;ap?this.layerElement.insertBefore(rp,ap):this.layerElement.appendChild(rp)},HCompElement.prototype.createComp=function(rp){return this.supports3d?new HCompElement(rp,this.globalData,this):new SVGCompElement(rp,this.globalData,this)};function HybridRenderer(rp,_d){this.animationItem=rp,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:_d&&_d.className||"",imagePreserveAspectRatio:_d&&_d.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(_d&&_d.hideOnTransparent===!1),filterSize:{width:_d&&_d.filterSize&&_d.filterSize.width||"400%",height:_d&&_d.filterSize&&_d.filterSize.height||"400%",x:_d&&_d.filterSize&&_d.filterSize.x||"-100%",y:_d&&_d.filterSize&&_d.filterSize.y||"-100%"},runExpressions:!_d||_d.runExpressions===void 0||_d.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(rp){return this.supports3d?new HCompElement(rp,this.globalData,this):new SVGCompElement(rp,this.globalData,this)};var CompExpressionInterface=function(){return function(rp){function _d(np){for(var ap=0,sp=rp.layers.length;ap<sp;){if(rp.layers[ap].nm===np||rp.layers[ap].ind===np)return rp.elements[ap].layerInterface;ap+=1}return null}return Object.defineProperty(_d,"_name",{value:rp.data.nm}),_d.layer=_d,_d.pixelAspect=1,_d.height=rp.data.h||rp.globalData.compSize.h,_d.width=rp.data.w||rp.globalData.compSize.w,_d.pixelAspect=1,_d.frameDuration=1/rp.globalData.frameRate,_d.displayStartTime=0,_d.numLayers=rp.layers.length,_d}}();function _typeof$2(rp){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$2=function(np){return typeof np}:_typeof$2=function(np){return np&&typeof Symbol=="function"&&np.constructor===Symbol&&np!==Symbol.prototype?"symbol":typeof np},_typeof$2(rp)}function seedRandom(rp,_d){var np=this,ap=256,sp=6,lp=52,up="random",cp=_d.pow(ap,sp),dp=_d.pow(2,lp),hp=dp*2,fp=ap-1,pp;function mp(Ep,Sp,Ap){var Rp=[];Sp=Sp===!0?{entropy:!0}:Sp||{};var Tp=_p(xp(Sp.entropy?[Ep,bp(rp)]:Ep===null?vp():Ep,3),Rp),Mp=new gp(Rp),Op=function(){for(var $p=Mp.g(sp),zp=cp,Dp=0;$p<dp;)$p=($p+Dp)*ap,zp*=ap,Dp=Mp.g(1);for(;$p>=hp;)$p/=2,zp/=2,Dp>>>=1;return($p+Dp)/zp};return Op.int32=function(){return Mp.g(4)|0},Op.quick=function(){return Mp.g(4)/4294967296},Op.double=Op,_p(bp(Mp.S),rp),(Sp.pass||Ap||function(Pp,$p,zp,Dp){return Dp&&(Dp.S&&yp(Dp,Mp),Pp.state=function(){return yp(Mp,{})}),zp?(_d[up]=Pp,$p):Pp})(Op,Tp,"global"in Sp?Sp.global:this==_d,Sp.state)}_d["seed"+up]=mp;function gp(Ep){var Sp,Ap=Ep.length,Rp=this,Tp=0,Mp=Rp.i=Rp.j=0,Op=Rp.S=[];for(Ap||(Ep=[Ap++]);Tp<ap;)Op[Tp]=Tp++;for(Tp=0;Tp<ap;Tp++)Op[Tp]=Op[Mp=fp&Mp+Ep[Tp%Ap]+(Sp=Op[Tp])],Op[Mp]=Sp;Rp.g=function(Pp){for(var $p,zp=0,Dp=Rp.i,Fp=Rp.j,jp=Rp.S;Pp--;)$p=jp[Dp=fp&Dp+1],zp=zp*ap+jp[fp&(jp[Dp]=jp[Fp=fp&Fp+$p])+(jp[Fp]=$p)];return Rp.i=Dp,Rp.j=Fp,zp}}function yp(Ep,Sp){return Sp.i=Ep.i,Sp.j=Ep.j,Sp.S=Ep.S.slice(),Sp}function xp(Ep,Sp){var Ap=[],Rp=_typeof$2(Ep),Tp;if(Sp&&Rp=="object")for(Tp in Ep)try{Ap.push(xp(Ep[Tp],Sp-1))}catch{}return Ap.length?Ap:Rp=="string"?Ep:Ep+"\0"}function _p(Ep,Sp){for(var Ap=Ep+"",Rp,Tp=0;Tp<Ap.length;)Sp[fp&Tp]=fp&(Rp^=Sp[fp&Tp]*19)+Ap.charCodeAt(Tp++);return bp(Sp)}function vp(){try{var Ep=new Uint8Array(ap);return(np.crypto||np.msCrypto).getRandomValues(Ep),bp(Ep)}catch{var Sp=np.navigator,Ap=Sp&&Sp.plugins;return[+new Date,np,Ap,np.screen,bp(rp)]}}function bp(Ep){return String.fromCharCode.apply(0,Ep)}_p(_d.random(),rp)}function initialize$2(rp){seedRandom([],rp)}var propTypes={SHAPE:"shape"};function _typeof$1(rp){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$1=function(np){return typeof np}:_typeof$1=function(np){return np&&typeof Symbol=="function"&&np.constructor===Symbol&&np!==Symbol.prototype?"symbol":typeof np},_typeof$1(rp)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};initialize$2(BMMath);function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(rp){return rp.constructor===Array||rp.constructor===Float32Array}function isNumerable(rp,_d){return rp==="number"||_d instanceof Number||rp==="boolean"||rp==="string"}function $bm_neg(rp){var _d=_typeof$1(rp);if(_d==="number"||rp instanceof Number||_d==="boolean")return-rp;if($bm_isInstanceOfArray(rp)){var np,ap=rp.length,sp=[];for(np=0;np<ap;np+=1)sp[np]=-rp[np];return sp}return rp.propType?rp.v:-rp}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(rp,_d){var np=_typeof$1(rp),ap=_typeof$1(_d);if(isNumerable(np,rp)&&isNumerable(ap,_d)||np==="string"||ap==="string")return rp+_d;if($bm_isInstanceOfArray(rp)&&isNumerable(ap,_d))return rp=rp.slice(0),rp[0]+=_d,rp;if(isNumerable(np,rp)&&$bm_isInstanceOfArray(_d))return _d=_d.slice(0),_d[0]=rp+_d[0],_d;if($bm_isInstanceOfArray(rp)&&$bm_isInstanceOfArray(_d)){for(var sp=0,lp=rp.length,up=_d.length,cp=[];sp<lp||sp<up;)(typeof rp[sp]=="number"||rp[sp]instanceof Number)&&(typeof _d[sp]=="number"||_d[sp]instanceof Number)?cp[sp]=rp[sp]+_d[sp]:cp[sp]=_d[sp]===void 0?rp[sp]:rp[sp]||_d[sp],sp+=1;return cp}return 0}var add=sum;function sub(rp,_d){var np=_typeof$1(rp),ap=_typeof$1(_d);if(isNumerable(np,rp)&&isNumerable(ap,_d))return np==="string"&&(rp=parseInt(rp,10)),ap==="string"&&(_d=parseInt(_d,10)),rp-_d;if($bm_isInstanceOfArray(rp)&&isNumerable(ap,_d))return rp=rp.slice(0),rp[0]-=_d,rp;if(isNumerable(np,rp)&&$bm_isInstanceOfArray(_d))return _d=_d.slice(0),_d[0]=rp-_d[0],_d;if($bm_isInstanceOfArray(rp)&&$bm_isInstanceOfArray(_d)){for(var sp=0,lp=rp.length,up=_d.length,cp=[];sp<lp||sp<up;)(typeof rp[sp]=="number"||rp[sp]instanceof Number)&&(typeof _d[sp]=="number"||_d[sp]instanceof Number)?cp[sp]=rp[sp]-_d[sp]:cp[sp]=_d[sp]===void 0?rp[sp]:rp[sp]||_d[sp],sp+=1;return cp}return 0}function mul(rp,_d){var np=_typeof$1(rp),ap=_typeof$1(_d),sp;if(isNumerable(np,rp)&&isNumerable(ap,_d))return rp*_d;var lp,up;if($bm_isInstanceOfArray(rp)&&isNumerable(ap,_d)){for(up=rp.length,sp=createTypedArray("float32",up),lp=0;lp<up;lp+=1)sp[lp]=rp[lp]*_d;return sp}if(isNumerable(np,rp)&&$bm_isInstanceOfArray(_d)){for(up=_d.length,sp=createTypedArray("float32",up),lp=0;lp<up;lp+=1)sp[lp]=rp*_d[lp];return sp}return 0}function div(rp,_d){var np=_typeof$1(rp),ap=_typeof$1(_d),sp;if(isNumerable(np,rp)&&isNumerable(ap,_d))return rp/_d;var lp,up;if($bm_isInstanceOfArray(rp)&&isNumerable(ap,_d)){for(up=rp.length,sp=createTypedArray("float32",up),lp=0;lp<up;lp+=1)sp[lp]=rp[lp]/_d;return sp}if(isNumerable(np,rp)&&$bm_isInstanceOfArray(_d)){for(up=_d.length,sp=createTypedArray("float32",up),lp=0;lp<up;lp+=1)sp[lp]=rp/_d[lp];return sp}return 0}function mod(rp,_d){return typeof rp=="string"&&(rp=parseInt(rp,10)),typeof _d=="string"&&(_d=parseInt(_d,10)),rp%_d}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(rp,_d,np){if(_d>np){var ap=np;np=_d,_d=ap}return Math.min(Math.max(rp,_d),np)}function radiansToDegrees(rp){return rp/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(rp){return rp*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(rp,_d){if(typeof rp=="number"||rp instanceof Number)return _d=_d||0,Math.abs(rp-_d);_d||(_d=helperLengthArray);var np,ap=Math.min(rp.length,_d.length),sp=0;for(np=0;np<ap;np+=1)sp+=Math.pow(_d[np]-rp[np],2);return Math.sqrt(sp)}function normalize(rp){return div(rp,length(rp))}function rgbToHsl(rp){var _d=rp[0],np=rp[1],ap=rp[2],sp=Math.max(_d,np,ap),lp=Math.min(_d,np,ap),up,cp,dp=(sp+lp)/2;if(sp===lp)up=0,cp=0;else{var hp=sp-lp;switch(cp=dp>.5?hp/(2-sp-lp):hp/(sp+lp),sp){case _d:up=(np-ap)/hp+(np<ap?6:0);break;case np:up=(ap-_d)/hp+2;break;case ap:up=(_d-np)/hp+4;break}up/=6}return[up,cp,dp,rp[3]]}function hue2rgb(rp,_d,np){return np<0&&(np+=1),np>1&&(np-=1),np<1/6?rp+(_d-rp)*6*np:np<1/2?_d:np<2/3?rp+(_d-rp)*(2/3-np)*6:rp}function hslToRgb(rp){var _d=rp[0],np=rp[1],ap=rp[2],sp,lp,up;if(np===0)sp=ap,up=ap,lp=ap;else{var cp=ap<.5?ap*(1+np):ap+np-ap*np,dp=2*ap-cp;sp=hue2rgb(dp,cp,_d+1/3),lp=hue2rgb(dp,cp,_d),up=hue2rgb(dp,cp,_d-1/3)}return[sp,lp,up,rp[3]]}function linear(rp,_d,np,ap,sp){if((ap===void 0||sp===void 0)&&(ap=_d,sp=np,_d=0,np=1),np<_d){var lp=np;np=_d,_d=lp}if(rp<=_d)return ap;if(rp>=np)return sp;var up=np===_d?0:(rp-_d)/(np-_d);if(!ap.length)return ap+(sp-ap)*up;var cp,dp=ap.length,hp=createTypedArray("float32",dp);for(cp=0;cp<dp;cp+=1)hp[cp]=ap[cp]+(sp[cp]-ap[cp])*up;return hp}function random(rp,_d){if(_d===void 0&&(rp===void 0?(rp=0,_d=1):(_d=rp,rp=void 0)),_d.length){var np,ap=_d.length;rp||(rp=createTypedArray("float32",ap));var sp=createTypedArray("float32",ap),lp=BMMath.random();for(np=0;np<ap;np+=1)sp[np]=rp[np]+lp*(_d[np]-rp[np]);return sp}rp===void 0&&(rp=0);var up=BMMath.random();return rp+up*(_d-rp)}function createPath(rp,_d,np,ap){var sp,lp=rp.length,up=shapePool.newElement();up.setPathData(!!ap,lp);var cp=[0,0],dp,hp;for(sp=0;sp<lp;sp+=1)dp=_d&&_d[sp]?_d[sp]:cp,hp=np&&np[sp]?np[sp]:cp,up.setTripleAt(rp[sp][0],rp[sp][1],hp[0]+rp[sp][0],hp[1]+rp[sp][1],dp[0]+rp[sp][0],dp[1]+rp[sp][1],sp,!0);return up}function initiateExpression(elem,data,property){function noOp(rp){return rp}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=(function rp(_d,np){var ap,sp,lp=this.pv.length?this.pv.length:1,up=createTypedArray("float32",lp);_d=5;var cp=Math.floor(time*_d);for(ap=0,sp=0;ap<cp;){for(sp=0;sp<lp;sp+=1)up[sp]+=-np+np*2*BMMath.random();ap+=1}var dp=time*_d,hp=dp-Math.floor(dp),fp=createTypedArray("float32",lp);if(lp>1){for(sp=0;sp<lp;sp+=1)fp[sp]=this.pv[sp]+up[sp]+(-np+np*2*BMMath.random())*hp;return fp}return this.pv+up[0]+(-np+np*2*BMMath.random())*hp}).bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(rp,_d){return loopIn(rp,_d,!0)}function loopOutDuration(rp,_d){return loopOut(rp,_d,!0)}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(rp,_d){var np=[_d[0]-rp[0],_d[1]-rp[1],_d[2]-rp[2]],ap=Math.atan2(np[0],Math.sqrt(np[1]*np[1]+np[2]*np[2]))/degToRads,sp=-Math.atan2(np[1],np[2])/degToRads;return[sp,ap,0]}function easeOut(rp,_d,np,ap,sp){return applyEase(easeOutBez,rp,_d,np,ap,sp)}function easeIn(rp,_d,np,ap,sp){return applyEase(easeInBez,rp,_d,np,ap,sp)}function ease(rp,_d,np,ap,sp){return applyEase(easeInOutBez,rp,_d,np,ap,sp)}function applyEase(rp,_d,np,ap,sp,lp){sp===void 0?(sp=np,lp=ap):_d=(_d-np)/(ap-np),_d>1?_d=1:_d<0&&(_d=0);var up=rp(_d);if($bm_isInstanceOfArray(sp)){var cp,dp=sp.length,hp=createTypedArray("float32",dp);for(cp=0;cp<dp;cp+=1)hp[cp]=(lp[cp]-sp[cp])*up+sp[cp];return hp}return(lp-sp)*up+sp}function nearestKey(rp){var _d,np=data.k.length,ap,sp;if(!data.k.length||typeof data.k[0]=="number")ap=0,sp=0;else if(ap=-1,rp*=elem.comp.globalData.frameRate,rp<data.k[0].t)ap=1,sp=data.k[0].t;else{for(_d=0;_d<np-1;_d+=1)if(rp===data.k[_d].t){ap=_d+1,sp=data.k[_d].t;break}else if(rp>data.k[_d].t&&rp<data.k[_d+1].t){rp-data.k[_d].t>data.k[_d+1].t-rp?(ap=_d+2,sp=data.k[_d+1].t):(ap=_d+1,sp=data.k[_d].t);break}ap===-1&&(ap=_d+1,sp=data.k[_d].t)}var lp={};return lp.index=ap,lp.time=sp/elem.comp.globalData.frameRate,lp}function key(rp){var _d,np,ap;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+rp);rp-=1,_d={time:data.k[rp].t/elem.comp.globalData.frameRate,value:[]};var sp=Object.prototype.hasOwnProperty.call(data.k[rp],"s")?data.k[rp].s:data.k[rp-1].e;for(ap=sp.length,np=0;np<ap;np+=1)_d[np]=sp[np],_d.value[np]=sp[np];return _d}function framesToTime(rp,_d){return _d||(_d=elem.comp.globalData.frameRate),rp/_d}function timeToFrames(rp,_d){return!rp&&rp!==0&&(rp=time),_d||(_d=elem.comp.globalData.frameRate),rp*_d}function seedRandom(rp){BMMath.seedrandom(randSeed+rp)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(rp,_d){return typeof value=="string"?_d===void 0?value.substring(rp):value.substring(rp,_d):""}function substr(rp,_d){return typeof value=="string"?_d===void 0?value.substr(rp):value.substr(rp,_d):""}function posterizeTime(rp){time=rp===0?0:Math.floor(time*rp)/rp,value=valueAtTime(time)}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(rp){return value=rp,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob}(),Expressions=function(){var rp={};rp.initExpressions=_d,rp.resetFrame=ExpressionManager.resetFrame;function _d(np){var ap=0,sp=[];function lp(){ap+=1}function up(){ap-=1,ap===0&&dp()}function cp(hp){sp.indexOf(hp)===-1&&sp.push(hp)}function dp(){var hp,fp=sp.length;for(hp=0;hp<fp;hp+=1)sp[hp].release();sp.length=0}np.renderer.compInterface=CompExpressionInterface(np.renderer),np.renderer.globalData.projectInterface.registerComposition(np.renderer),np.renderer.globalData.pushExpression=lp,np.renderer.globalData.popExpression=up,np.renderer.globalData.registerExpressionProperty=cp}return rp}(),MaskManagerInterface=function(){function rp(np,ap){this._mask=np,this._data=ap}Object.defineProperty(rp.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(rp.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100}});var _d=function(ap){var sp=createSizedArray(ap.viewData.length),lp,up=ap.viewData.length;for(lp=0;lp<up;lp+=1)sp[lp]=new rp(ap.viewData[lp],ap.masksProperties[lp]);var cp=function(hp){for(lp=0;lp<up;){if(ap.masksProperties[lp].nm===hp)return sp[lp];lp+=1}return null};return cp};return _d}(),ExpressionPropertyInterface=function(){var rp={pv:0,v:0,mult:1},_d={pv:[0,0,0],v:[0,0,0],mult:1};function np(up,cp,dp){Object.defineProperty(up,"velocity",{get:function(){return cp.getVelocityAtTime(cp.comp.currentFrame)}}),up.numKeys=cp.keyframes?cp.keyframes.length:0,up.key=function(hp){if(!up.numKeys)return 0;var fp="";"s"in cp.keyframes[hp-1]?fp=cp.keyframes[hp-1].s:"e"in cp.keyframes[hp-2]?fp=cp.keyframes[hp-2].e:fp=cp.keyframes[hp-2].s;var pp=dp==="unidimensional"?new Number(fp):Object.assign({},fp);return pp.time=cp.keyframes[hp-1].t/cp.elem.comp.globalData.frameRate,pp.value=dp==="unidimensional"?fp[0]:fp,pp},up.valueAtTime=cp.getValueAtTime,up.speedAtTime=cp.getSpeedAtTime,up.velocityAtTime=cp.getVelocityAtTime,up.propertyGroup=cp.propertyGroup}function ap(up){(!up||!("pv"in up))&&(up=rp);var cp=1/up.mult,dp=up.pv*cp,hp=new Number(dp);return hp.value=dp,np(hp,up,"unidimensional"),function(){return up.k&&up.getValue(),dp=up.v*cp,hp.value!==dp&&(hp=new Number(dp),hp.value=dp,np(hp,up,"unidimensional")),hp}}function sp(up){(!up||!("pv"in up))&&(up=_d);var cp=1/up.mult,dp=up.data&&up.data.l||up.pv.length,hp=createTypedArray("float32",dp),fp=createTypedArray("float32",dp);return hp.value=fp,np(hp,up,"multidimensional"),function(){up.k&&up.getValue();for(var pp=0;pp<dp;pp+=1)fp[pp]=up.v[pp]*cp,hp[pp]=fp[pp];return hp}}function lp(){return rp}return function(up){return up?up.propType==="unidimensional"?ap(up):sp(up):lp}}(),TransformExpressionInterface=function(){return function(rp){function _d(up){switch(up){case"scale":case"Scale":case"ADBE Scale":case 6:return _d.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return _d.rotation;case"ADBE Rotate X":return _d.xRotation;case"ADBE Rotate Y":return _d.yRotation;case"position":case"Position":case"ADBE Position":case 2:return _d.position;case"ADBE Position_0":return _d.xPosition;case"ADBE Position_1":return _d.yPosition;case"ADBE Position_2":return _d.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return _d.anchorPoint;case"opacity":case"Opacity":case 11:return _d.opacity;default:return null}}Object.defineProperty(_d,"rotation",{get:ExpressionPropertyInterface(rp.r||rp.rz)}),Object.defineProperty(_d,"zRotation",{get:ExpressionPropertyInterface(rp.rz||rp.r)}),Object.defineProperty(_d,"xRotation",{get:ExpressionPropertyInterface(rp.rx)}),Object.defineProperty(_d,"yRotation",{get:ExpressionPropertyInterface(rp.ry)}),Object.defineProperty(_d,"scale",{get:ExpressionPropertyInterface(rp.s)});var np,ap,sp,lp;return rp.p?lp=ExpressionPropertyInterface(rp.p):(np=ExpressionPropertyInterface(rp.px),ap=ExpressionPropertyInterface(rp.py),rp.pz&&(sp=ExpressionPropertyInterface(rp.pz))),Object.defineProperty(_d,"position",{get:function(){return rp.p?lp():[np(),ap(),sp?sp():0]}}),Object.defineProperty(_d,"xPosition",{get:ExpressionPropertyInterface(rp.px)}),Object.defineProperty(_d,"yPosition",{get:ExpressionPropertyInterface(rp.py)}),Object.defineProperty(_d,"zPosition",{get:ExpressionPropertyInterface(rp.pz)}),Object.defineProperty(_d,"anchorPoint",{get:ExpressionPropertyInterface(rp.a)}),Object.defineProperty(_d,"opacity",{get:ExpressionPropertyInterface(rp.o)}),Object.defineProperty(_d,"skew",{get:ExpressionPropertyInterface(rp.sk)}),Object.defineProperty(_d,"skewAxis",{get:ExpressionPropertyInterface(rp.sa)}),Object.defineProperty(_d,"orientation",{get:ExpressionPropertyInterface(rp.or)}),_d}}(),LayerExpressionInterface=function(){function rp(hp){var fp=new Matrix;if(hp!==void 0){var pp=this._elem.finalTransform.mProp.getValueAtTime(hp);pp.clone(fp)}else{var mp=this._elem.finalTransform.mProp;mp.applyToMatrix(fp)}return fp}function _d(hp,fp){var pp=this.getMatrix(fp);return pp.props[12]=0,pp.props[13]=0,pp.props[14]=0,this.applyPoint(pp,hp)}function np(hp,fp){var pp=this.getMatrix(fp);return this.applyPoint(pp,hp)}function ap(hp,fp){var pp=this.getMatrix(fp);return pp.props[12]=0,pp.props[13]=0,pp.props[14]=0,this.invertPoint(pp,hp)}function sp(hp,fp){var pp=this.getMatrix(fp);return this.invertPoint(pp,hp)}function lp(hp,fp){if(this._elem.hierarchy&&this._elem.hierarchy.length){var pp,mp=this._elem.hierarchy.length;for(pp=0;pp<mp;pp+=1)this._elem.hierarchy[pp].finalTransform.mProp.applyToMatrix(hp)}return hp.applyToPointArray(fp[0],fp[1],fp[2]||0)}function up(hp,fp){if(this._elem.hierarchy&&this._elem.hierarchy.length){var pp,mp=this._elem.hierarchy.length;for(pp=0;pp<mp;pp+=1)this._elem.hierarchy[pp].finalTransform.mProp.applyToMatrix(hp)}return hp.inversePoint(fp)}function cp(hp){var fp=new Matrix;if(fp.reset(),this._elem.finalTransform.mProp.applyToMatrix(fp),this._elem.hierarchy&&this._elem.hierarchy.length){var pp,mp=this._elem.hierarchy.length;for(pp=0;pp<mp;pp+=1)this._elem.hierarchy[pp].finalTransform.mProp.applyToMatrix(fp);return fp.inversePoint(hp)}return fp.inversePoint(hp)}function dp(){return[1,1,1,1]}return function(hp){var fp;function pp(xp){gp.mask=new MaskManagerInterface(xp,hp)}function mp(xp){gp.effect=xp}function gp(xp){switch(xp){case"ADBE Root Vectors Group":case"Contents":case 2:return gp.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return fp;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return gp.effect;case"ADBE Text Properties":return gp.textInterface;default:return null}}gp.getMatrix=rp,gp.invertPoint=up,gp.applyPoint=lp,gp.toWorld=np,gp.toWorldVec=_d,gp.fromWorld=sp,gp.fromWorldVec=ap,gp.toComp=np,gp.fromComp=cp,gp.sampleImage=dp,gp.sourceRectAtTime=hp.sourceRectAtTime.bind(hp),gp._elem=hp,fp=TransformExpressionInterface(hp.finalTransform.mProp);var yp=getDescriptor(fp,"anchorPoint");return Object.defineProperties(gp,{hasParent:{get:function(){return hp.hierarchy.length}},parent:{get:function(){return hp.hierarchy[0].layerInterface}},rotation:getDescriptor(fp,"rotation"),scale:getDescriptor(fp,"scale"),position:getDescriptor(fp,"position"),opacity:getDescriptor(fp,"opacity"),anchorPoint:yp,anchor_point:yp,transform:{get:function(){return fp}},active:{get:function(){return hp.isInRange}}}),gp.startTime=hp.data.st,gp.index=hp.data.ind,gp.source=hp.data.refId,gp.height=hp.data.ty===0?hp.data.h:100,gp.width=hp.data.ty===0?hp.data.w:100,gp.inPoint=hp.data.ip/hp.comp.globalData.frameRate,gp.outPoint=hp.data.op/hp.comp.globalData.frameRate,gp._name=hp.data.nm,gp.registerMaskInterface=pp,gp.registerEffectsInterface=mp,gp}}(),propertyGroupFactory=function(){return function(rp,_d){return function(np){return np=np===void 0?1:np,np<=0?rp:_d(np-1)}}}(),PropertyInterface=function(){return function(rp,_d){var np={_name:rp};function ap(sp){return sp=sp===void 0?1:sp,sp<=0?np:_d(sp-1)}return ap}}(),EffectsExpressionInterface=function(){var rp={createEffectsInterface:_d};function _d(sp,lp){if(sp.effectsManager){var up=[],cp=sp.data.ef,dp,hp=sp.effectsManager.effectElements.length;for(dp=0;dp<hp;dp+=1)up.push(np(cp[dp],sp.effectsManager.effectElements[dp],lp,sp));var fp=sp.data.ef||[],pp=function(gp){for(dp=0,hp=fp.length;dp<hp;){if(gp===fp[dp].nm||gp===fp[dp].mn||gp===fp[dp].ix)return up[dp];dp+=1}return null};return Object.defineProperty(pp,"numProperties",{get:function(){return fp.length}}),pp}return null}function np(sp,lp,up,cp){function dp(gp){for(var yp=sp.ef,xp=0,_p=yp.length;xp<_p;){if(gp===yp[xp].nm||gp===yp[xp].mn||gp===yp[xp].ix)return yp[xp].ty===5?fp[xp]:fp[xp]();xp+=1}throw new Error}var hp=propertyGroupFactory(dp,up),fp=[],pp,mp=sp.ef.length;for(pp=0;pp<mp;pp+=1)sp.ef[pp].ty===5?fp.push(np(sp.ef[pp],lp.effectElements[pp],lp.effectElements[pp].propertyGroup,cp)):fp.push(ap(lp.effectElements[pp],sp.ef[pp].ty,cp,hp));return sp.mn==="ADBE Color Control"&&Object.defineProperty(dp,"color",{get:function(){return fp[0]()}}),Object.defineProperties(dp,{numProperties:{get:function(){return sp.np}},_name:{value:sp.nm},propertyGroup:{value:hp}}),dp.enabled=sp.en!==0,dp.active=dp.enabled,dp}function ap(sp,lp,up,cp){var dp=ExpressionPropertyInterface(sp.p);function hp(){return lp===10?up.comp.compInterface(sp.p.v):dp()}return sp.p.setGroupProperty&&sp.p.setGroupProperty(PropertyInterface("",cp)),hp}return rp}(),ShapePathInterface=function(){return function(_d,np,ap){var sp=np.sh;function lp(cp){return cp==="Shape"||cp==="shape"||cp==="Path"||cp==="path"||cp==="ADBE Vector Shape"||cp===2?lp.path:null}var up=propertyGroupFactory(lp,ap);return sp.setGroupProperty(PropertyInterface("Path",up)),Object.defineProperties(lp,{path:{get:function(){return sp.k&&sp.getValue(),sp}},shape:{get:function(){return sp.k&&sp.getValue(),sp}},_name:{value:_d.nm},ix:{value:_d.ix},propertyIndex:{value:_d.ix},mn:{value:_d.mn},propertyGroup:{value:ap}}),lp}}(),ShapeExpressionInterface=function(){function rp(yp,xp,_p){var vp=[],bp,Ep=yp?yp.length:0;for(bp=0;bp<Ep;bp+=1)yp[bp].ty==="gr"?vp.push(np(yp[bp],xp[bp],_p)):yp[bp].ty==="fl"?vp.push(ap(yp[bp],xp[bp],_p)):yp[bp].ty==="st"?vp.push(up(yp[bp],xp[bp],_p)):yp[bp].ty==="tm"?vp.push(cp(yp[bp],xp[bp],_p)):yp[bp].ty==="tr"||(yp[bp].ty==="el"?vp.push(hp(yp[bp],xp[bp],_p)):yp[bp].ty==="sr"?vp.push(fp(yp[bp],xp[bp],_p)):yp[bp].ty==="sh"?vp.push(ShapePathInterface(yp[bp],xp[bp],_p)):yp[bp].ty==="rc"?vp.push(pp(yp[bp],xp[bp],_p)):yp[bp].ty==="rd"?vp.push(mp(yp[bp],xp[bp],_p)):yp[bp].ty==="rp"?vp.push(gp(yp[bp],xp[bp],_p)):yp[bp].ty==="gf"?vp.push(sp(yp[bp],xp[bp],_p)):vp.push(lp(yp[bp],xp[bp])));return vp}function _d(yp,xp,_p){var vp,bp=function(Ap){for(var Rp=0,Tp=vp.length;Rp<Tp;){if(vp[Rp]._name===Ap||vp[Rp].mn===Ap||vp[Rp].propertyIndex===Ap||vp[Rp].ix===Ap||vp[Rp].ind===Ap)return vp[Rp];Rp+=1}return typeof Ap=="number"?vp[Ap-1]:null};bp.propertyGroup=propertyGroupFactory(bp,_p),vp=rp(yp.it,xp.it,bp.propertyGroup),bp.numProperties=vp.length;var Ep=dp(yp.it[yp.it.length-1],xp.it[xp.it.length-1],bp.propertyGroup);return bp.transform=Ep,bp.propertyIndex=yp.cix,bp._name=yp.nm,bp}function np(yp,xp,_p){var vp=function(Ap){switch(Ap){case"ADBE Vectors Group":case"Contents":case 2:return vp.content;default:return vp.transform}};vp.propertyGroup=propertyGroupFactory(vp,_p);var bp=_d(yp,xp,vp.propertyGroup),Ep=dp(yp.it[yp.it.length-1],xp.it[xp.it.length-1],vp.propertyGroup);return vp.content=bp,vp.transform=Ep,Object.defineProperty(vp,"_name",{get:function(){return yp.nm}}),vp.numProperties=yp.np,vp.propertyIndex=yp.ix,vp.nm=yp.nm,vp.mn=yp.mn,vp}function ap(yp,xp,_p){function vp(bp){return bp==="Color"||bp==="color"?vp.color:bp==="Opacity"||bp==="opacity"?vp.opacity:null}return Object.defineProperties(vp,{color:{get:ExpressionPropertyInterface(xp.c)},opacity:{get:ExpressionPropertyInterface(xp.o)},_name:{value:yp.nm},mn:{value:yp.mn}}),xp.c.setGroupProperty(PropertyInterface("Color",_p)),xp.o.setGroupProperty(PropertyInterface("Opacity",_p)),vp}function sp(yp,xp,_p){function vp(bp){return bp==="Start Point"||bp==="start point"?vp.startPoint:bp==="End Point"||bp==="end point"?vp.endPoint:bp==="Opacity"||bp==="opacity"?vp.opacity:null}return Object.defineProperties(vp,{startPoint:{get:ExpressionPropertyInterface(xp.s)},endPoint:{get:ExpressionPropertyInterface(xp.e)},opacity:{get:ExpressionPropertyInterface(xp.o)},type:{get:function(){return"a"}},_name:{value:yp.nm},mn:{value:yp.mn}}),xp.s.setGroupProperty(PropertyInterface("Start Point",_p)),xp.e.setGroupProperty(PropertyInterface("End Point",_p)),xp.o.setGroupProperty(PropertyInterface("Opacity",_p)),vp}function lp(){function yp(){return null}return yp}function up(yp,xp,_p){var vp=propertyGroupFactory(Tp,_p),bp=propertyGroupFactory(Rp,vp);function Ep(Mp){Object.defineProperty(Rp,yp.d[Mp].nm,{get:ExpressionPropertyInterface(xp.d.dataProps[Mp].p)})}var Sp,Ap=yp.d?yp.d.length:0,Rp={};for(Sp=0;Sp<Ap;Sp+=1)Ep(Sp),xp.d.dataProps[Sp].p.setGroupProperty(bp);function Tp(Mp){return Mp==="Color"||Mp==="color"?Tp.color:Mp==="Opacity"||Mp==="opacity"?Tp.opacity:Mp==="Stroke Width"||Mp==="stroke width"?Tp.strokeWidth:null}return Object.defineProperties(Tp,{color:{get:ExpressionPropertyInterface(xp.c)},opacity:{get:ExpressionPropertyInterface(xp.o)},strokeWidth:{get:ExpressionPropertyInterface(xp.w)},dash:{get:function(){return Rp}},_name:{value:yp.nm},mn:{value:yp.mn}}),xp.c.setGroupProperty(PropertyInterface("Color",vp)),xp.o.setGroupProperty(PropertyInterface("Opacity",vp)),xp.w.setGroupProperty(PropertyInterface("Stroke Width",vp)),Tp}function cp(yp,xp,_p){function vp(Ep){return Ep===yp.e.ix||Ep==="End"||Ep==="end"?vp.end:Ep===yp.s.ix?vp.start:Ep===yp.o.ix?vp.offset:null}var bp=propertyGroupFactory(vp,_p);return vp.propertyIndex=yp.ix,xp.s.setGroupProperty(PropertyInterface("Start",bp)),xp.e.setGroupProperty(PropertyInterface("End",bp)),xp.o.setGroupProperty(PropertyInterface("Offset",bp)),vp.propertyIndex=yp.ix,vp.propertyGroup=_p,Object.defineProperties(vp,{start:{get:ExpressionPropertyInterface(xp.s)},end:{get:ExpressionPropertyInterface(xp.e)},offset:{get:ExpressionPropertyInterface(xp.o)},_name:{value:yp.nm}}),vp.mn=yp.mn,vp}function dp(yp,xp,_p){function vp(Ep){return yp.a.ix===Ep||Ep==="Anchor Point"?vp.anchorPoint:yp.o.ix===Ep||Ep==="Opacity"?vp.opacity:yp.p.ix===Ep||Ep==="Position"?vp.position:yp.r.ix===Ep||Ep==="Rotation"||Ep==="ADBE Vector Rotation"?vp.rotation:yp.s.ix===Ep||Ep==="Scale"?vp.scale:yp.sk&&yp.sk.ix===Ep||Ep==="Skew"?vp.skew:yp.sa&&yp.sa.ix===Ep||Ep==="Skew Axis"?vp.skewAxis:null}var bp=propertyGroupFactory(vp,_p);return xp.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",bp)),xp.transform.mProps.p.setGroupProperty(PropertyInterface("Position",bp)),xp.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",bp)),xp.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",bp)),xp.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",bp)),xp.transform.mProps.sk&&(xp.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",bp)),xp.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",bp))),xp.transform.op.setGroupProperty(PropertyInterface("Opacity",bp)),Object.defineProperties(vp,{opacity:{get:ExpressionPropertyInterface(xp.transform.mProps.o)},position:{get:ExpressionPropertyInterface(xp.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(xp.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(xp.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(xp.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(xp.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(xp.transform.mProps.sa)},_name:{value:yp.nm}}),vp.ty="tr",vp.mn=yp.mn,vp.propertyGroup=_p,vp}function hp(yp,xp,_p){function vp(Sp){return yp.p.ix===Sp?vp.position:yp.s.ix===Sp?vp.size:null}var bp=propertyGroupFactory(vp,_p);vp.propertyIndex=yp.ix;var Ep=xp.sh.ty==="tm"?xp.sh.prop:xp.sh;return Ep.s.setGroupProperty(PropertyInterface("Size",bp)),Ep.p.setGroupProperty(PropertyInterface("Position",bp)),Object.defineProperties(vp,{size:{get:ExpressionPropertyInterface(Ep.s)},position:{get:ExpressionPropertyInterface(Ep.p)},_name:{value:yp.nm}}),vp.mn=yp.mn,vp}function fp(yp,xp,_p){function vp(Sp){return yp.p.ix===Sp?vp.position:yp.r.ix===Sp?vp.rotation:yp.pt.ix===Sp?vp.points:yp.or.ix===Sp||Sp==="ADBE Vector Star Outer Radius"?vp.outerRadius:yp.os.ix===Sp?vp.outerRoundness:yp.ir&&(yp.ir.ix===Sp||Sp==="ADBE Vector Star Inner Radius")?vp.innerRadius:yp.is&&yp.is.ix===Sp?vp.innerRoundness:null}var bp=propertyGroupFactory(vp,_p),Ep=xp.sh.ty==="tm"?xp.sh.prop:xp.sh;return vp.propertyIndex=yp.ix,Ep.or.setGroupProperty(PropertyInterface("Outer Radius",bp)),Ep.os.setGroupProperty(PropertyInterface("Outer Roundness",bp)),Ep.pt.setGroupProperty(PropertyInterface("Points",bp)),Ep.p.setGroupProperty(PropertyInterface("Position",bp)),Ep.r.setGroupProperty(PropertyInterface("Rotation",bp)),yp.ir&&(Ep.ir.setGroupProperty(PropertyInterface("Inner Radius",bp)),Ep.is.setGroupProperty(PropertyInterface("Inner Roundness",bp))),Object.defineProperties(vp,{position:{get:ExpressionPropertyInterface(Ep.p)},rotation:{get:ExpressionPropertyInterface(Ep.r)},points:{get:ExpressionPropertyInterface(Ep.pt)},outerRadius:{get:ExpressionPropertyInterface(Ep.or)},outerRoundness:{get:ExpressionPropertyInterface(Ep.os)},innerRadius:{get:ExpressionPropertyInterface(Ep.ir)},innerRoundness:{get:ExpressionPropertyInterface(Ep.is)},_name:{value:yp.nm}}),vp.mn=yp.mn,vp}function pp(yp,xp,_p){function vp(Sp){return yp.p.ix===Sp?vp.position:yp.r.ix===Sp?vp.roundness:yp.s.ix===Sp||Sp==="Size"||Sp==="ADBE Vector Rect Size"?vp.size:null}var bp=propertyGroupFactory(vp,_p),Ep=xp.sh.ty==="tm"?xp.sh.prop:xp.sh;return vp.propertyIndex=yp.ix,Ep.p.setGroupProperty(PropertyInterface("Position",bp)),Ep.s.setGroupProperty(PropertyInterface("Size",bp)),Ep.r.setGroupProperty(PropertyInterface("Rotation",bp)),Object.defineProperties(vp,{position:{get:ExpressionPropertyInterface(Ep.p)},roundness:{get:ExpressionPropertyInterface(Ep.r)},size:{get:ExpressionPropertyInterface(Ep.s)},_name:{value:yp.nm}}),vp.mn=yp.mn,vp}function mp(yp,xp,_p){function vp(Sp){return yp.r.ix===Sp||Sp==="Round Corners 1"?vp.radius:null}var bp=propertyGroupFactory(vp,_p),Ep=xp;return vp.propertyIndex=yp.ix,Ep.rd.setGroupProperty(PropertyInterface("Radius",bp)),Object.defineProperties(vp,{radius:{get:ExpressionPropertyInterface(Ep.rd)},_name:{value:yp.nm}}),vp.mn=yp.mn,vp}function gp(yp,xp,_p){function vp(Sp){return yp.c.ix===Sp||Sp==="Copies"?vp.copies:yp.o.ix===Sp||Sp==="Offset"?vp.offset:null}var bp=propertyGroupFactory(vp,_p),Ep=xp;return vp.propertyIndex=yp.ix,Ep.c.setGroupProperty(PropertyInterface("Copies",bp)),Ep.o.setGroupProperty(PropertyInterface("Offset",bp)),Object.defineProperties(vp,{copies:{get:ExpressionPropertyInterface(Ep.c)},offset:{get:ExpressionPropertyInterface(Ep.o)},_name:{value:yp.nm}}),vp.mn=yp.mn,vp}return function(yp,xp,_p){var vp;function bp(Sp){if(typeof Sp=="number")return Sp=Sp===void 0?1:Sp,Sp===0?_p:vp[Sp-1];for(var Ap=0,Rp=vp.length;Ap<Rp;){if(vp[Ap]._name===Sp)return vp[Ap];Ap+=1}return null}function Ep(){return _p}return bp.propertyGroup=propertyGroupFactory(bp,Ep),vp=rp(yp,xp,bp.propertyGroup),bp.numProperties=vp.length,bp._name="Contents",bp}}(),TextExpressionInterface=function(){return function(rp){var _d;function np(ap){switch(ap){case"ADBE Text Document":return np.sourceText;default:return null}}return Object.defineProperty(np,"sourceText",{get:function(){rp.textProperty.getValue();var sp=rp.textProperty.currentData.t;return(!_d||sp!==_d.value)&&(_d=new String(sp),_d.value=sp||new String(sp),Object.defineProperty(_d,"style",{get:function(){return{fillColor:rp.textProperty.currentData.fc}}})),_d}}),np}}();function _typeof(rp){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(np){return typeof np}:_typeof=function(np){return np&&typeof Symbol=="function"&&np.constructor===Symbol&&np!==Symbol.prototype?"symbol":typeof np},_typeof(rp)}var FootageInterface=function(){var rp=function(ap){var sp="",lp=ap.getFootageData();function up(){return sp="",lp=ap.getFootageData(),cp}function cp(dp){if(lp[dp])return sp=dp,lp=lp[dp],_typeof(lp)==="object"?cp:lp;var hp=dp.indexOf(sp);if(hp!==-1){var fp=parseInt(dp.substr(hp+sp.length),10);return lp=lp[fp],_typeof(lp)==="object"?cp:lp}return""}return up},_d=function(ap){function sp(lp){return lp==="Outline"?sp.outlineInterface():null}return sp._name="Outline",sp.outlineInterface=rp(ap),sp};return function(np){function ap(sp){return sp==="Data"?ap.dataInterface:null}return ap._name="Data",ap.dataInterface=_d(np),ap}}(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(rp){return interfaces[rp]||null}var expressionHelpers=function(){function rp(up,cp,dp){cp.x&&(dp.k=!0,dp.x=!0,dp.initiateExpression=ExpressionManager.initiateExpression,dp.effectsSequence.push(dp.initiateExpression(up,cp,dp).bind(dp)))}function _d(up){return up*=this.elem.globalData.frameRate,up-=this.offsetTime,up!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<up?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(up,this._cachingAtTime),this._cachingAtTime.lastFrame=up),this._cachingAtTime.value}function np(up){var cp=-.01,dp=this.getValueAtTime(up),hp=this.getValueAtTime(up+cp),fp=0;if(dp.length){var pp;for(pp=0;pp<dp.length;pp+=1)fp+=Math.pow(hp[pp]-dp[pp],2);fp=Math.sqrt(fp)*100}else fp=0;return fp}function ap(up){if(this.vel!==void 0)return this.vel;var cp=-.001,dp=this.getValueAtTime(up),hp=this.getValueAtTime(up+cp),fp;if(dp.length){fp=createTypedArray("float32",dp.length);var pp;for(pp=0;pp<dp.length;pp+=1)fp[pp]=(hp[pp]-dp[pp])/cp}else fp=(hp-dp)/cp;return fp}function sp(){return this.pv}function lp(up){this.propertyGroup=up}return{searchExpressions:rp,getSpeedAtTime:np,getVelocityAtTime:ap,getValueAtTime:_d,getStaticValueAtTime:sp,setGroupProperty:lp}}();function addPropertyDecorator(){function rp(mp,gp,yp){if(!this.k||!this.keyframes)return this.pv;mp=mp?mp.toLowerCase():"";var xp=this.comp.renderedFrame,_p=this.keyframes,vp=_p[_p.length-1].t;if(xp<=vp)return this.pv;var bp,Ep;yp?(gp?bp=Math.abs(vp-this.elem.comp.globalData.frameRate*gp):bp=Math.max(0,vp-this.elem.data.ip),Ep=vp-bp):((!gp||gp>_p.length-1)&&(gp=_p.length-1),Ep=_p[_p.length-1-gp].t,bp=vp-Ep);var Sp,Ap,Rp;if(mp==="pingpong"){var Tp=Math.floor((xp-Ep)/bp);if(Tp%2!==0)return this.getValueAtTime((bp-(xp-Ep)%bp+Ep)/this.comp.globalData.frameRate,0)}else if(mp==="offset"){var Mp=this.getValueAtTime(Ep/this.comp.globalData.frameRate,0),Op=this.getValueAtTime(vp/this.comp.globalData.frameRate,0),Pp=this.getValueAtTime(((xp-Ep)%bp+Ep)/this.comp.globalData.frameRate,0),$p=Math.floor((xp-Ep)/bp);if(this.pv.length){for(Rp=new Array(Mp.length),Ap=Rp.length,Sp=0;Sp<Ap;Sp+=1)Rp[Sp]=(Op[Sp]-Mp[Sp])*$p+Pp[Sp];return Rp}return(Op-Mp)*$p+Pp}else if(mp==="continue"){var zp=this.getValueAtTime(vp/this.comp.globalData.frameRate,0),Dp=this.getValueAtTime((vp-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(Rp=new Array(zp.length),Ap=Rp.length,Sp=0;Sp<Ap;Sp+=1)Rp[Sp]=zp[Sp]+(zp[Sp]-Dp[Sp])*((xp-vp)/this.comp.globalData.frameRate)/5e-4;return Rp}return zp+(zp-Dp)*((xp-vp)/.001)}return this.getValueAtTime(((xp-Ep)%bp+Ep)/this.comp.globalData.frameRate,0)}function _d(mp,gp,yp){if(!this.k)return this.pv;mp=mp?mp.toLowerCase():"";var xp=this.comp.renderedFrame,_p=this.keyframes,vp=_p[0].t;if(xp>=vp)return this.pv;var bp,Ep;yp?(gp?bp=Math.abs(this.elem.comp.globalData.frameRate*gp):bp=Math.max(0,this.elem.data.op-vp),Ep=vp+bp):((!gp||gp>_p.length-1)&&(gp=_p.length-1),Ep=_p[gp].t,bp=Ep-vp);var Sp,Ap,Rp;if(mp==="pingpong"){var Tp=Math.floor((vp-xp)/bp);if(Tp%2===0)return this.getValueAtTime(((vp-xp)%bp+vp)/this.comp.globalData.frameRate,0)}else if(mp==="offset"){var Mp=this.getValueAtTime(vp/this.comp.globalData.frameRate,0),Op=this.getValueAtTime(Ep/this.comp.globalData.frameRate,0),Pp=this.getValueAtTime((bp-(vp-xp)%bp+vp)/this.comp.globalData.frameRate,0),$p=Math.floor((vp-xp)/bp)+1;if(this.pv.length){for(Rp=new Array(Mp.length),Ap=Rp.length,Sp=0;Sp<Ap;Sp+=1)Rp[Sp]=Pp[Sp]-(Op[Sp]-Mp[Sp])*$p;return Rp}return Pp-(Op-Mp)*$p}else if(mp==="continue"){var zp=this.getValueAtTime(vp/this.comp.globalData.frameRate,0),Dp=this.getValueAtTime((vp+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(Rp=new Array(zp.length),Ap=Rp.length,Sp=0;Sp<Ap;Sp+=1)Rp[Sp]=zp[Sp]+(zp[Sp]-Dp[Sp])*(vp-xp)/.001;return Rp}return zp+(zp-Dp)*(vp-xp)/.001}return this.getValueAtTime((bp-((vp-xp)%bp+vp))/this.comp.globalData.frameRate,0)}function np(mp,gp){if(!this.k)return this.pv;if(mp=(mp||.4)*.5,gp=Math.floor(gp||5),gp<=1)return this.pv;var yp=this.comp.renderedFrame/this.comp.globalData.frameRate,xp=yp-mp,_p=yp+mp,vp=gp>1?(_p-xp)/(gp-1):1,bp=0,Ep=0,Sp;this.pv.length?Sp=createTypedArray("float32",this.pv.length):Sp=0;for(var Ap;bp<gp;){if(Ap=this.getValueAtTime(xp+bp*vp),this.pv.length)for(Ep=0;Ep<this.pv.length;Ep+=1)Sp[Ep]+=Ap[Ep];else Sp+=Ap;bp+=1}if(this.pv.length)for(Ep=0;Ep<this.pv.length;Ep+=1)Sp[Ep]/=gp;else Sp/=gp;return Sp}function ap(mp){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var gp=this._transformCachingAtTime.v;if(gp.cloneFromProps(this.pre.props),this.appliedTransformations<1){var yp=this.a.getValueAtTime(mp);gp.translate(-yp[0]*this.a.mult,-yp[1]*this.a.mult,yp[2]*this.a.mult)}if(this.appliedTransformations<2){var xp=this.s.getValueAtTime(mp);gp.scale(xp[0]*this.s.mult,xp[1]*this.s.mult,xp[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var _p=this.sk.getValueAtTime(mp),vp=this.sa.getValueAtTime(mp);gp.skewFromAxis(-_p*this.sk.mult,vp*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var bp=this.r.getValueAtTime(mp);gp.rotate(-bp*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var Ep=this.rz.getValueAtTime(mp),Sp=this.ry.getValueAtTime(mp),Ap=this.rx.getValueAtTime(mp),Rp=this.or.getValueAtTime(mp);gp.rotateZ(-Ep*this.rz.mult).rotateY(Sp*this.ry.mult).rotateX(Ap*this.rx.mult).rotateZ(-Rp[2]*this.or.mult).rotateY(Rp[1]*this.or.mult).rotateX(Rp[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var Tp=this.px.getValueAtTime(mp),Mp=this.py.getValueAtTime(mp);if(this.data.p.z){var Op=this.pz.getValueAtTime(mp);gp.translate(Tp*this.px.mult,Mp*this.py.mult,-Op*this.pz.mult)}else gp.translate(Tp*this.px.mult,Mp*this.py.mult,0)}else{var Pp=this.p.getValueAtTime(mp);gp.translate(Pp[0]*this.p.mult,Pp[1]*this.p.mult,-Pp[2]*this.p.mult)}return gp}function sp(){return this.v.clone(new Matrix)}var lp=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(mp,gp,yp){var xp=lp(mp,gp,yp);return xp.dynamicProperties.length?xp.getValueAtTime=ap.bind(xp):xp.getValueAtTime=sp.bind(xp),xp.setGroupProperty=expressionHelpers.setGroupProperty,xp};var up=PropertyFactory.getProp;PropertyFactory.getProp=function(mp,gp,yp,xp,_p){var vp=up(mp,gp,yp,xp,_p);vp.kf?vp.getValueAtTime=expressionHelpers.getValueAtTime.bind(vp):vp.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(vp),vp.setGroupProperty=expressionHelpers.setGroupProperty,vp.loopOut=rp,vp.loopIn=_d,vp.smooth=np,vp.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(vp),vp.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(vp),vp.numKeys=gp.a===1?gp.k.length:0,vp.propertyIndex=gp.ix;var bp=0;return yp!==0&&(bp=createTypedArray("float32",gp.a===1?gp.k[0].s.length:gp.k.length)),vp._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:bp},expressionHelpers.searchExpressions(mp,gp,vp),vp.k&&_p.addDynamicProperty(vp),vp};function cp(mp){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),mp*=this.elem.globalData.frameRate,mp-=this.offsetTime,mp!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<mp?this._caching.lastIndex:0,this._cachingAtTime.lastTime=mp,this.interpolateShape(mp,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}var dp=ShapePropertyFactory.getConstructorFunction(),hp=ShapePropertyFactory.getKeyframedConstructorFunction();function fp(){}fp.prototype={vertices:function(gp,yp){this.k&&this.getValue();var xp=this.v;yp!==void 0&&(xp=this.getValueAtTime(yp,0));var _p,vp=xp._length,bp=xp[gp],Ep=xp.v,Sp=createSizedArray(vp);for(_p=0;_p<vp;_p+=1)gp==="i"||gp==="o"?Sp[_p]=[bp[_p][0]-Ep[_p][0],bp[_p][1]-Ep[_p][1]]:Sp[_p]=[bp[_p][0],bp[_p][1]];return Sp},points:function(gp){return this.vertices("v",gp)},inTangents:function(gp){return this.vertices("i",gp)},outTangents:function(gp){return this.vertices("o",gp)},isClosed:function(){return this.v.c},pointOnPath:function(gp,yp){var xp=this.v;yp!==void 0&&(xp=this.getValueAtTime(yp,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(xp));for(var _p=this._segmentsLength,vp=_p.lengths,bp=_p.totalLength*gp,Ep=0,Sp=vp.length,Ap=0,Rp;Ep<Sp;){if(Ap+vp[Ep].addedLength>bp){var Tp=Ep,Mp=xp.c&&Ep===Sp-1?0:Ep+1,Op=(bp-Ap)/vp[Ep].addedLength;Rp=bez.getPointInSegment(xp.v[Tp],xp.v[Mp],xp.o[Tp],xp.i[Mp],Op,vp[Ep]);break}else Ap+=vp[Ep].addedLength;Ep+=1}return Rp||(Rp=xp.c?[xp.v[0][0],xp.v[0][1]]:[xp.v[xp._length-1][0],xp.v[xp._length-1][1]]),Rp},vectorOnPath:function(gp,yp,xp){gp==1?gp=this.v.c:gp==0&&(gp=.999);var _p=this.pointOnPath(gp,yp),vp=this.pointOnPath(gp+.001,yp),bp=vp[0]-_p[0],Ep=vp[1]-_p[1],Sp=Math.sqrt(Math.pow(bp,2)+Math.pow(Ep,2));if(Sp===0)return[0,0];var Ap=xp==="tangent"?[bp/Sp,Ep/Sp]:[-Ep/Sp,bp/Sp];return Ap},tangentOnPath:function(gp,yp){return this.vectorOnPath(gp,yp,"tangent")},normalOnPath:function(gp,yp){return this.vectorOnPath(gp,yp,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([fp],dp),extendPrototype([fp],hp),hp.prototype.getValueAtTime=cp,hp.prototype.initiateExpression=ExpressionManager.initiateExpression;var pp=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(mp,gp,yp,xp,_p){var vp=pp(mp,gp,yp,xp,_p);return vp.propertyIndex=gp.ix,vp.lock=!1,yp===3?expressionHelpers.searchExpressions(mp,gp.pt,vp):yp===4&&expressionHelpers.searchExpressions(mp,gp.ks,vp),vp.k&&mp.addDynamicProperty(vp),vp}}function initialize$1(){addPropertyDecorator()}function addDecorator(){function rp(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(_d,np){var ap=this.calculateExpression(np);if(_d.t!==ap){var sp={};return this.copyData(sp,_d),sp.t=ap.toString(),sp.__complete=!1,sp}return _d},TextProperty.prototype.searchProperty=function(){var _d=this.searchKeyframes(),np=this.searchExpressions();return this.kf=_d||np,this.kf},TextProperty.prototype.searchExpressions=rp}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function rp(_d,np){var ap=createNS("feMerge");ap.setAttribute("result",_d);var sp,lp;for(lp=0;lp<np.length;lp+=1)sp=createNS("feMergeNode"),sp.setAttribute("in",np[lp]),ap.appendChild(sp),ap.appendChild(sp);return ap}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(rp,_d,np,ap,sp){this.filterManager=_d;var lp=createNS("feColorMatrix");lp.setAttribute("type","matrix"),lp.setAttribute("color-interpolation-filters","linearRGB"),lp.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=lp,lp.setAttribute("result",ap+"_tint_1"),rp.appendChild(lp),lp=createNS("feColorMatrix"),lp.setAttribute("type","matrix"),lp.setAttribute("color-interpolation-filters","sRGB"),lp.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),lp.setAttribute("result",ap+"_tint_2"),rp.appendChild(lp),this.matrixFilter=lp;var up=this.createMergeNode(ap,[sp,ap+"_tint_1",ap+"_tint_2"]);rp.appendChild(up)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(rp){if(rp||this.filterManager._mdf){var _d=this.filterManager.effectElements[0].p.v,np=this.filterManager.effectElements[1].p.v,ap=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+ap+" 0"),this.matrixFilter.setAttribute("values",np[0]-_d[0]+" 0 0 0 "+_d[0]+" "+(np[1]-_d[1])+" 0 0 0 "+_d[1]+" "+(np[2]-_d[2])+" 0 0 0 "+_d[2]+" 0 0 0 1 0")}};function SVGFillFilter(rp,_d,np,ap){this.filterManager=_d;var sp=createNS("feColorMatrix");sp.setAttribute("type","matrix"),sp.setAttribute("color-interpolation-filters","sRGB"),sp.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),sp.setAttribute("result",ap),rp.appendChild(sp),this.matrixFilter=sp}SVGFillFilter.prototype.renderFrame=function(rp){if(rp||this.filterManager._mdf){var _d=this.filterManager.effectElements[2].p.v,np=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+_d[0]+" 0 0 0 0 "+_d[1]+" 0 0 0 0 "+_d[2]+" 0 0 0 "+np+" 0")}};function SVGStrokeEffect(rp,_d,np){this.initialized=!1,this.filterManager=_d,this.elem=np,this.paths=[]}SVGStrokeEffect.prototype.initialize=function(){var rp=this.elem.layerElement.children||this.elem.layerElement.childNodes,_d,np,ap,sp;for(this.filterManager.effectElements[1].p.v===1?(sp=this.elem.maskManager.masksProperties.length,ap=0):(ap=this.filterManager.effectElements[0].p.v-1,sp=ap+1),np=createNS("g"),np.setAttribute("fill","none"),np.setAttribute("stroke-linecap","round"),np.setAttribute("stroke-dashoffset",1),ap;ap<sp;ap+=1)_d=createNS("path"),np.appendChild(_d),this.paths.push({p:_d,m:ap});if(this.filterManager.effectElements[10].p.v===3){var lp=createNS("mask"),up=createElementID();lp.setAttribute("id",up),lp.setAttribute("mask-type","alpha"),lp.appendChild(np),this.elem.globalData.defs.appendChild(lp);var cp=createNS("g");for(cp.setAttribute("mask","url("+getLocationHref()+"#"+up+")");rp[0];)cp.appendChild(rp[0]);this.elem.layerElement.appendChild(cp),this.masker=lp,np.setAttribute("stroke","#fff")}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(rp=this.elem.layerElement.children||this.elem.layerElement.childNodes;rp.length;)this.elem.layerElement.removeChild(rp[0]);this.elem.layerElement.appendChild(np),this.elem.layerElement.removeAttribute("mask"),np.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=np},SVGStrokeEffect.prototype.renderFrame=function(rp){this.initialized||this.initialize();var _d,np=this.paths.length,ap,sp;for(_d=0;_d<np;_d+=1)if(this.paths[_d].m!==-1&&(ap=this.elem.maskManager.viewData[this.paths[_d].m],sp=this.paths[_d].p,(rp||this.filterManager._mdf||ap.prop._mdf)&&sp.setAttribute("d",ap.lastPath),rp||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||ap.prop._mdf)){var lp;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var up=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,cp=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,dp=sp.getTotalLength();lp="0 0 0 "+dp*up+" ";var hp=dp*(cp-up),fp=1+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01,pp=Math.floor(hp/fp),mp;for(mp=0;mp<pp;mp+=1)lp+="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01+" ";lp+="0 "+dp*10+" 0 0"}else lp="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01;sp.setAttribute("stroke-dasharray",lp)}if((rp||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",this.filterManager.effectElements[4].p.v*2),(rp||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(rp||this.filterManager.effectElements[3].p._mdf)){var gp=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(gp[0]*255)+","+bmFloor(gp[1]*255)+","+bmFloor(gp[2]*255)+")")}};function SVGTritoneFilter(rp,_d,np,ap){this.filterManager=_d;var sp=createNS("feColorMatrix");sp.setAttribute("type","matrix"),sp.setAttribute("color-interpolation-filters","linearRGB"),sp.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),rp.appendChild(sp);var lp=createNS("feComponentTransfer");lp.setAttribute("color-interpolation-filters","sRGB"),lp.setAttribute("result",ap),this.matrixFilter=lp;var up=createNS("feFuncR");up.setAttribute("type","table"),lp.appendChild(up),this.feFuncR=up;var cp=createNS("feFuncG");cp.setAttribute("type","table"),lp.appendChild(cp),this.feFuncG=cp;var dp=createNS("feFuncB");dp.setAttribute("type","table"),lp.appendChild(dp),this.feFuncB=dp,rp.appendChild(lp)}SVGTritoneFilter.prototype.renderFrame=function(rp){if(rp||this.filterManager._mdf){var _d=this.filterManager.effectElements[0].p.v,np=this.filterManager.effectElements[1].p.v,ap=this.filterManager.effectElements[2].p.v,sp=ap[0]+" "+np[0]+" "+_d[0],lp=ap[1]+" "+np[1]+" "+_d[1],up=ap[2]+" "+np[2]+" "+_d[2];this.feFuncR.setAttribute("tableValues",sp),this.feFuncG.setAttribute("tableValues",lp),this.feFuncB.setAttribute("tableValues",up)}};function SVGProLevelsFilter(rp,_d,np,ap){this.filterManager=_d;var sp=this.filterManager.effectElements,lp=createNS("feComponentTransfer");(sp[10].p.k||sp[10].p.v!==0||sp[11].p.k||sp[11].p.v!==1||sp[12].p.k||sp[12].p.v!==1||sp[13].p.k||sp[13].p.v!==0||sp[14].p.k||sp[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",lp)),(sp[17].p.k||sp[17].p.v!==0||sp[18].p.k||sp[18].p.v!==1||sp[19].p.k||sp[19].p.v!==1||sp[20].p.k||sp[20].p.v!==0||sp[21].p.k||sp[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",lp)),(sp[24].p.k||sp[24].p.v!==0||sp[25].p.k||sp[25].p.v!==1||sp[26].p.k||sp[26].p.v!==1||sp[27].p.k||sp[27].p.v!==0||sp[28].p.k||sp[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",lp)),(sp[31].p.k||sp[31].p.v!==0||sp[32].p.k||sp[32].p.v!==1||sp[33].p.k||sp[33].p.v!==1||sp[34].p.k||sp[34].p.v!==0||sp[35].p.k||sp[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",lp)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(lp.setAttribute("color-interpolation-filters","sRGB"),rp.appendChild(lp)),(sp[3].p.k||sp[3].p.v!==0||sp[4].p.k||sp[4].p.v!==1||sp[5].p.k||sp[5].p.v!==1||sp[6].p.k||sp[6].p.v!==0||sp[7].p.k||sp[7].p.v!==1)&&(lp=createNS("feComponentTransfer"),lp.setAttribute("color-interpolation-filters","sRGB"),lp.setAttribute("result",ap),rp.appendChild(lp),this.feFuncRComposed=this.createFeFunc("feFuncR",lp),this.feFuncGComposed=this.createFeFunc("feFuncG",lp),this.feFuncBComposed=this.createFeFunc("feFuncB",lp))}SVGProLevelsFilter.prototype.createFeFunc=function(rp,_d){var np=createNS(rp);return np.setAttribute("type","table"),_d.appendChild(np),np},SVGProLevelsFilter.prototype.getTableValue=function(rp,_d,np,ap,sp){for(var lp=0,up=256,cp,dp=Math.min(rp,_d),hp=Math.max(rp,_d),fp=Array.call(null,{length:up}),pp,mp=0,gp=sp-ap,yp=_d-rp;lp<=256;)cp=lp/256,cp<=dp?pp=yp<0?sp:ap:cp>=hp?pp=yp<0?ap:sp:pp=ap+gp*Math.pow((cp-rp)/yp,1/np),fp[mp]=pp,mp+=1,lp+=256/(up-1);return fp.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(rp){if(rp||this.filterManager._mdf){var _d,np=this.filterManager.effectElements;this.feFuncRComposed&&(rp||np[3].p._mdf||np[4].p._mdf||np[5].p._mdf||np[6].p._mdf||np[7].p._mdf)&&(_d=this.getTableValue(np[3].p.v,np[4].p.v,np[5].p.v,np[6].p.v,np[7].p.v),this.feFuncRComposed.setAttribute("tableValues",_d),this.feFuncGComposed.setAttribute("tableValues",_d),this.feFuncBComposed.setAttribute("tableValues",_d)),this.feFuncR&&(rp||np[10].p._mdf||np[11].p._mdf||np[12].p._mdf||np[13].p._mdf||np[14].p._mdf)&&(_d=this.getTableValue(np[10].p.v,np[11].p.v,np[12].p.v,np[13].p.v,np[14].p.v),this.feFuncR.setAttribute("tableValues",_d)),this.feFuncG&&(rp||np[17].p._mdf||np[18].p._mdf||np[19].p._mdf||np[20].p._mdf||np[21].p._mdf)&&(_d=this.getTableValue(np[17].p.v,np[18].p.v,np[19].p.v,np[20].p.v,np[21].p.v),this.feFuncG.setAttribute("tableValues",_d)),this.feFuncB&&(rp||np[24].p._mdf||np[25].p._mdf||np[26].p._mdf||np[27].p._mdf||np[28].p._mdf)&&(_d=this.getTableValue(np[24].p.v,np[25].p.v,np[26].p.v,np[27].p.v,np[28].p.v),this.feFuncB.setAttribute("tableValues",_d)),this.feFuncA&&(rp||np[31].p._mdf||np[32].p._mdf||np[33].p._mdf||np[34].p._mdf||np[35].p._mdf)&&(_d=this.getTableValue(np[31].p.v,np[32].p.v,np[33].p.v,np[34].p.v,np[35].p.v),this.feFuncA.setAttribute("tableValues",_d))}};function SVGDropShadowEffect(rp,_d,np,ap,sp){var lp=_d.container.globalData.renderConfig.filterSize,up=_d.data.fs||lp;rp.setAttribute("x",up.x||lp.x),rp.setAttribute("y",up.y||lp.y),rp.setAttribute("width",up.width||lp.width),rp.setAttribute("height",up.height||lp.height),this.filterManager=_d;var cp=createNS("feGaussianBlur");cp.setAttribute("in","SourceAlpha"),cp.setAttribute("result",ap+"_drop_shadow_1"),cp.setAttribute("stdDeviation","0"),this.feGaussianBlur=cp,rp.appendChild(cp);var dp=createNS("feOffset");dp.setAttribute("dx","25"),dp.setAttribute("dy","0"),dp.setAttribute("in",ap+"_drop_shadow_1"),dp.setAttribute("result",ap+"_drop_shadow_2"),this.feOffset=dp,rp.appendChild(dp);var hp=createNS("feFlood");hp.setAttribute("flood-color","#00ff00"),hp.setAttribute("flood-opacity","1"),hp.setAttribute("result",ap+"_drop_shadow_3"),this.feFlood=hp,rp.appendChild(hp);var fp=createNS("feComposite");fp.setAttribute("in",ap+"_drop_shadow_3"),fp.setAttribute("in2",ap+"_drop_shadow_2"),fp.setAttribute("operator","in"),fp.setAttribute("result",ap+"_drop_shadow_4"),rp.appendChild(fp);var pp=this.createMergeNode(ap,[ap+"_drop_shadow_4",sp]);rp.appendChild(pp)}extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(rp){if(rp||this.filterManager._mdf){if((rp||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),rp||this.filterManager.effectElements[0].p._mdf){var _d=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(_d[0]*255),Math.round(_d[1]*255),Math.round(_d[2]*255)))}if((rp||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),rp||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var np=this.filterManager.effectElements[3].p.v,ap=(this.filterManager.effectElements[2].p.v-90)*degToRads,sp=np*Math.cos(ap),lp=np*Math.sin(ap);this.feOffset.setAttribute("dx",sp),this.feOffset.setAttribute("dy",lp)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(rp,_d,np){this.initialized=!1,this.filterManager=_d,this.filterElem=rp,this.elem=np,np.matteElement=createNS("g"),np.matteElement.appendChild(np.layerElement),np.matteElement.appendChild(np.transformedElement),np.baseElement=np.matteElement}SVGMatte3Effect.prototype.findSymbol=function(rp){for(var _d=0,np=_svgMatteSymbols.length;_d<np;){if(_svgMatteSymbols[_d]===rp)return _svgMatteSymbols[_d];_d+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(rp,_d){var np=rp.layerElement.parentNode;if(np){for(var ap=np.children,sp=0,lp=ap.length;sp<lp&&ap[sp]!==rp.layerElement;)sp+=1;var up;sp<=lp-2&&(up=ap[sp+1]);var cp=createNS("use");cp.setAttribute("href","#"+_d),up?np.insertBefore(cp,up):np.appendChild(cp)}},SVGMatte3Effect.prototype.setElementAsMask=function(rp,_d){if(!this.findSymbol(_d)){var np=createElementID(),ap=createNS("mask");ap.setAttribute("id",_d.layerId),ap.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(_d);var sp=rp.globalData.defs;sp.appendChild(ap);var lp=createNS("symbol");lp.setAttribute("id",np),this.replaceInParent(_d,np),lp.appendChild(_d.layerElement),sp.appendChild(lp);var up=createNS("use");up.setAttribute("href","#"+np),ap.appendChild(up),_d.data.hd=!1,_d.show()}rp.setMatte(_d.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var rp=this.filterManager.effectElements[0].p.v,_d=this.elem.comp.elements,np=0,ap=_d.length;np<ap;)_d[np]&&_d[np].data.ind===rp&&this.setElementAsMask(this.elem,_d[np]),np+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()};function SVGGaussianBlurEffect(rp,_d,np,ap){rp.setAttribute("x","-100%"),rp.setAttribute("y","-100%"),rp.setAttribute("width","300%"),rp.setAttribute("height","300%"),this.filterManager=_d;var sp=createNS("feGaussianBlur");sp.setAttribute("result",ap),rp.appendChild(sp),this.feGaussianBlur=sp}SVGGaussianBlurEffect.prototype.renderFrame=function(rp){if(rp||this.filterManager._mdf){var _d=.3,np=this.filterManager.effectElements[0].p.v*_d,ap=this.filterManager.effectElements[1].p.v,sp=ap==3?0:np,lp=ap==2?0:np;this.feGaussianBlur.setAttribute("stdDeviation",sp+" "+lp);var up=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",up)}};function TransformEffect(){}TransformEffect.prototype.init=function(rp){this.effectsManager=rp,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(rp){if(this._opMdf=!1,this._mdf=!1,rp||this.effectsManager._mdf){var _d=this.effectsManager.effectElements,np=_d[0].p.v,ap=_d[1].p.v,sp=_d[2].p.v===1,lp=_d[3].p.v,up=sp?lp:_d[4].p.v,cp=_d[5].p.v,dp=_d[6].p.v,hp=_d[7].p.v;this.matrix.reset(),this.matrix.translate(-np[0],-np[1],np[2]),this.matrix.scale(up*.01,lp*.01,1),this.matrix.rotate(-hp*degToRads),this.matrix.skewFromAxis(-cp*degToRads,(dp+90)*degToRads),this.matrix.translate(ap[0],ap[1],0),this._mdf=!0,this.opacity!==_d[8].p.v&&(this.opacity=_d[8].p.v,this._opMdf=!0)}};function SVGTransformEffect(rp,_d){this.init(_d)}extendPrototype([TransformEffect],SVGTransformEffect);function CVTransformEffect(rp){this.init(rp)}return extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie})})(lottie,lottie.exports);var lottieExports=lottie.exports;Object.defineProperty(dist,"__esModule",{value:!0});var _extends2=_extends,_extends3=_interopRequireDefault$C(_extends2),_getPrototypeOf=getPrototypeOf$2,_getPrototypeOf2=_interopRequireDefault$C(_getPrototypeOf),_classCallCheck2=classCallCheck,_classCallCheck3=_interopRequireDefault$C(_classCallCheck2),_createClass2=createClass,_createClass3=_interopRequireDefault$C(_createClass2),_possibleConstructorReturn2=possibleConstructorReturn,_possibleConstructorReturn3=_interopRequireDefault$C(_possibleConstructorReturn2),_inherits2=inherits$1,_inherits3=_interopRequireDefault$C(_inherits2),_react=reactExports,_react2=_interopRequireDefault$C(_react),_propTypes=propTypesExports,_propTypes2=_interopRequireDefault$C(_propTypes),_lottieWeb=lottieExports,_lottieWeb2=_interopRequireDefault$C(_lottieWeb);function _interopRequireDefault$C(rp){return rp&&rp.__esModule?rp:{default:rp}}var Lottie=function(rp){(0,_inherits3.default)(_d,rp);function _d(){var np,ap,sp,lp;(0,_classCallCheck3.default)(this,_d);for(var up=arguments.length,cp=Array(up),dp=0;dp<up;dp++)cp[dp]=arguments[dp];return lp=(ap=(sp=(0,_possibleConstructorReturn3.default)(this,(np=_d.__proto__||(0,_getPrototypeOf2.default)(_d)).call.apply(np,[this].concat(cp))),sp),sp.handleClickToPause=function(){sp.anim.isPaused?sp.anim.play():sp.anim.pause()},ap),(0,_possibleConstructorReturn3.default)(sp,lp)}return(0,_createClass3.default)(_d,[{key:"componentDidMount",value:function(){var ap=this.props,sp=ap.options,lp=ap.eventListeners,up=sp.loop,cp=sp.autoplay,dp=sp.animationData,hp=sp.rendererSettings,fp=sp.segments;this.options={container:this.el,renderer:"svg",loop:up!==!1,autoplay:cp!==!1,segments:fp!==!1,animationData:dp,rendererSettings:hp},this.options=(0,_extends3.default)({},this.options,sp),this.anim=_lottieWeb2.default.loadAnimation(this.options),this.registerEvents(lp)}},{key:"componentWillUpdate",value:function(ap){this.options.animationData!==ap.options.animationData&&(this.deRegisterEvents(this.props.eventListeners),this.destroy(),this.options=(0,_extends3.default)({},this.options,ap.options),this.anim=_lottieWeb2.default.loadAnimation(this.options),this.registerEvents(ap.eventListeners))}},{key:"componentDidUpdate",value:function(){this.props.isStopped?this.stop():this.props.segments?this.playSegments():this.play(),this.pause(),this.setSpeed(),this.setDirection()}},{key:"componentWillUnmount",value:function(){this.deRegisterEvents(this.props.eventListeners),this.destroy(),this.options.animationData=null,this.anim=null}},{key:"setSpeed",value:function(){this.anim.setSpeed(this.props.speed)}},{key:"setDirection",value:function(){this.anim.setDirection(this.props.direction)}},{key:"play",value:function(){this.anim.play()}},{key:"playSegments",value:function(){this.anim.playSegments(this.props.segments)}},{key:"stop",value:function(){this.anim.stop()}},{key:"pause",value:function(){this.props.isPaused&&!this.anim.isPaused?this.anim.pause():!this.props.isPaused&&this.anim.isPaused&&this.anim.pause()}},{key:"destroy",value:function(){this.anim.destroy()}},{key:"registerEvents",value:function(ap){var sp=this;ap.forEach(function(lp){sp.anim.addEventListener(lp.eventName,lp.callback)})}},{key:"deRegisterEvents",value:function(ap){var sp=this;ap.forEach(function(lp){sp.anim.removeEventListener(lp.eventName,lp.callback)})}},{key:"render",value:function(){var ap=this,sp=this.props,lp=sp.width,up=sp.height,cp=sp.ariaRole,dp=sp.ariaLabel,hp=sp.isClickToPauseDisabled,fp=sp.title,pp=function(xp){var _p=void 0;return typeof xp=="number"?_p=xp+"px":_p=xp||"100%",_p},mp=(0,_extends3.default)({width:pp(lp),height:pp(up),overflow:"hidden",margin:"0 auto",outline:"none"},this.props.style),gp=hp?function(){return null}:this.handleClickToPause;return _react2.default.createElement("div",{ref:function(xp){ap.el=xp},style:mp,onClick:gp,title:fp,role:cp,"aria-label":dp,tabIndex:"0"})}}]),_d}(_react2.default.Component),_default$d=dist.default=Lottie;Lottie.propTypes={eventListeners:_propTypes2.default.arrayOf(_propTypes2.default.object),options:_propTypes2.default.object.isRequired,height:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.number]),width:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.number]),isStopped:_propTypes2.default.bool,isPaused:_propTypes2.default.bool,speed:_propTypes2.default.number,segments:_propTypes2.default.arrayOf(_propTypes2.default.number),direction:_propTypes2.default.number,ariaRole:_propTypes2.default.string,ariaLabel:_propTypes2.default.string,isClickToPauseDisabled:_propTypes2.default.bool,title:_propTypes2.default.string,style:_propTypes2.default.string};Lottie.defaultProps={eventListeners:[],isStopped:!1,isPaused:!1,speed:1,ariaRole:"button",ariaLabel:"animation",isClickToPauseDisabled:!1,title:""};const v$1="5.3.0",fr=25,ip=0,op=36,w=420,h=420,nm="bank 3",ddd=0,assets=[],layers=[{ddd:0,ind:1,ty:4,nm:"-color",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:0,s:[0],e:[360]},{t:36}],ix:10},p:{a:0,k:[210,210,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[86,86],ix:2},p:{a:0,k:[0,0],ix:3},nm:" 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"st",c:{a:0,k:[.0588,.8,.8078,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:2,ix:5},lc:1,lj:1,ml:4,ml2:{a:0,k:4,ix:8},nm:" 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"fl",c:{a:0,k:[0,.9833,1,1],ix:4},o:{a:0,k:0,ix:5},r:1,nm:" 1",mn:"ADBE Vector Graphic - Fill",hd:!0},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:""}],nm:" 1",np:3,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:0,k:0,ix:1},e:{a:0,k:55,ix:2},o:{a:0,k:0,ix:3},m:1,ix:2,nm:" 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:0,op:36,st:0,bm:0},{ddd:0,ind:2,ty:4,nm:"-color",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:1,k:[{i:{x:[.255],y:[1]},o:{x:[.692],y:[0]},n:["0p255_1_0p692_0"],t:0,s:[0],e:[360]},{t:36}],ix:10},p:{a:0,k:[210,210,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[100,100],ix:2},p:{a:0,k:[0,0],ix:3},nm:" 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"st",c:{a:0,k:[.02,.9837,1,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:2,ix:5},lc:1,lj:1,ml:4,ml2:{a:0,k:4,ix:8},nm:" 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"fl",c:{a:0,k:[0,.9833,1,1],ix:4},o:{a:0,k:0,ix:5},r:1,nm:" 1",mn:"ADBE Vector Graphic - Fill",hd:!0},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:""}],nm:" 1",np:3,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:0,k:45,ix:1},e:{a:0,k:100,ix:2},o:{a:0,k:0,ix:3},m:1,ix:2,nm:" 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:0,op:36,st:0,bm:0},{ddd:0,ind:3,ty:4,nm:"2",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[210,210,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{d:2,ty:"el",s:{a:0,k:[86,86],ix:2},p:{a:0,k:[0,0],ix:3},nm:" 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"st",c:{a:0,k:[.3565,.973,.9835,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:.5,ix:5},lc:1,lj:1,ml:4,ml2:{a:0,k:4,ix:8},nm:" 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"fl",c:{a:0,k:[0,.9833,1,1],ix:4},o:{a:0,k:0,ix:5},r:1,nm:" 1",mn:"ADBE Vector Graphic - Fill",hd:!0},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:""}],nm:" 1",np:3,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:36,st:0,bm:0},{ddd:0,ind:4,ty:4,nm:" 2",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[210,210,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{d:2,ty:"el",s:{a:0,k:[100,100],ix:2},p:{a:0,k:[0,0],ix:3},nm:" 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"st",c:{a:0,k:[.3565,.973,.9835,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:.5,ix:5},lc:1,lj:1,ml:4,ml2:{a:0,k:4,ix:8},nm:" 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"fl",c:{a:0,k:[0,.9833,1,1],ix:4},o:{a:0,k:0,ix:5},r:1,nm:" 1",mn:"ADBE Vector Graphic - Fill",hd:!0},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:""}],nm:" 1",np:3,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:36,st:0,bm:0},{ddd:0,ind:5,ty:4,nm:"logo",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[208.622,209.988,0],ix:2},a:{a:0,k:[54.174,78.291,0],ix:1},s:{a:0,k:[26.271,26.271,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[-14.167,31.912],[-.335,-.028],[.002,-.191],[-22.44,-3.776],[.004,-.492],[.206,-.138],[1.045,-.419],[1.127,-3.361],[-1.678,-3.055],[-2.479,-2.394],[.212,-.301],[.277,.064]],o:[[.13,-.292],[.353,.029],[-.197,12.159],[0,0],[-.002,.197],[-.634,.39],[-2.681,1.083],[-.815,2.444],[1.727,2.632],[.18,.195],[-.193,.283],[-14.913,-3.405]],v:[[-8.511,-29.885],[-7.899,-30.323],[-7.546,-29.755],[21.818,3.699],[22.675,4.336],[22.23,4.832],[17.159,6.642],[9.628,13.113],[10.821,21.512],[17.125,29.236],[17.344,30.067],[16.57,30.286]],c:!0},ix:2},nm:" 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"fl",c:{a:0,k:[.0588,.8,.8078,1],ix:4},o:{a:0,k:100,ix:5},r:1,nm:" 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[24.88,125.982],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:""}],nm:" 1",np:2,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[.589,.054],[.073,.232],[-31.885,17.507],[-2.506,7.457],[-.305,.078],[-.239,-.156],[-7.832,-2.191],[-3.3,-7.085],[15.975,-9.305],[-.435,-8.576],[.353,-.144],[.275,.094],[.385,8.119],[.396,-.149],[6.401,-32.182]],o:[[-.205,-.005],[-7.433,-37.263],[-3.05,-3.348],[.156,-.201],[.278,-.075],[2.335,2.38],[17.1,-4.919],[3.647,7.812],[-2.4,4.172],[-.049,.3],[-.258,.094],[-2.609,-1.606],[-.402,.157],[-20.463,7.248],[0,0]],v:[[-46.097,54.653],[-46.49,54.188],[-3.872,-37.941],[-7.305,-54.22],[-6.633,-54.632],[-5.849,-54.42],[10.528,-44.17],[50.276,-40.515],[25.174,-9.846],[20.995,9.197],[20.468,9.953],[19.657,9.929],[11.774,-3.43],[10.588,-2.955],[-45.407,53.818]],c:!0},ix:2},nm:" 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"fl",c:{a:0,k:[.2036,.9045,.9164,1],ix:4},o:{a:0,k:100,ix:5},r:1,nm:" 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[54.174,54.957],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:""}],nm:" 2",np:2,cix:2,ix:2,mn:"ADBE Vector Group",hd:!1}],ip:0,op:36,st:0,bm:0}],markers=[],animationData={v:v$1,fr,ip,op,w,h,nm,ddd,assets,layers,markers},Loading=({hidden:rp})=>{const _d={loop:!0,autoplay:!0,animationData,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}};return jsxRuntimeExports.jsx("div",{className:"dot-spinner",style:{display:rp&&"none"},children:jsxRuntimeExports.jsx(_default$d,{options:_d,speed:1.5})})};function bind(rp,_d){return function(){return rp.apply(_d,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(rp=>_d=>{const np=toString.call(_d);return rp[np]||(rp[np]=np.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=rp=>(rp=rp.toLowerCase(),_d=>kindOf(_d)===rp),typeOfTest=rp=>_d=>typeof _d===rp,{isArray}=Array,isUndefined$1=typeOfTest("undefined");function isBuffer(rp){return rp!==null&&!isUndefined$1(rp)&&rp.constructor!==null&&!isUndefined$1(rp.constructor)&&isFunction$2(rp.constructor.isBuffer)&&rp.constructor.isBuffer(rp)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(rp){let _d;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?_d=ArrayBuffer.isView(rp):_d=rp&&rp.buffer&&isArrayBuffer(rp.buffer),_d}const isString=typeOfTest("string"),isFunction$2=typeOfTest("function"),isNumber$1=typeOfTest("number"),isObject$1=rp=>rp!==null&&typeof rp=="object",isBoolean=rp=>rp===!0||rp===!1,isPlainObject$1=rp=>{if(kindOf(rp)!=="object")return!1;const _d=getPrototypeOf(rp);return(_d===null||_d===Object.prototype||Object.getPrototypeOf(_d)===null)&&!(Symbol.toStringTag in rp)&&!(Symbol.iterator in rp)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=rp=>isObject$1(rp)&&isFunction$2(rp.pipe),isFormData=rp=>{let _d;return rp&&(typeof FormData=="function"&&rp instanceof FormData||isFunction$2(rp.append)&&((_d=kindOf(rp))==="formdata"||_d==="object"&&isFunction$2(rp.toString)&&rp.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=rp=>rp.trim?rp.trim():rp.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach$1(rp,_d,{allOwnKeys:np=!1}={}){if(rp===null||typeof rp>"u")return;let ap,sp;if(typeof rp!="object"&&(rp=[rp]),isArray(rp))for(ap=0,sp=rp.length;ap<sp;ap++)_d.call(null,rp[ap],ap,rp);else{const lp=np?Object.getOwnPropertyNames(rp):Object.keys(rp),up=lp.length;let cp;for(ap=0;ap<up;ap++)cp=lp[ap],_d.call(null,rp[cp],cp,rp)}}function findKey(rp,_d){_d=_d.toLowerCase();const np=Object.keys(rp);let ap=np.length,sp;for(;ap-- >0;)if(sp=np[ap],_d===sp.toLowerCase())return sp;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=rp=>!isUndefined$1(rp)&&rp!==_global;function merge(){const{caseless:rp}=isContextDefined(this)&&this||{},_d={},np=(ap,sp)=>{const lp=rp&&findKey(_d,sp)||sp;isPlainObject$1(_d[lp])&&isPlainObject$1(ap)?_d[lp]=merge(_d[lp],ap):isPlainObject$1(ap)?_d[lp]=merge({},ap):isArray(ap)?_d[lp]=ap.slice():_d[lp]=ap};for(let ap=0,sp=arguments.length;ap<sp;ap++)arguments[ap]&&forEach$1(arguments[ap],np);return _d}const extend$1=(rp,_d,np,{allOwnKeys:ap}={})=>(forEach$1(_d,(sp,lp)=>{np&&isFunction$2(sp)?rp[lp]=bind(sp,np):rp[lp]=sp},{allOwnKeys:ap}),rp),stripBOM=rp=>(rp.charCodeAt(0)===65279&&(rp=rp.slice(1)),rp),inherits=(rp,_d,np,ap)=>{rp.prototype=Object.create(_d.prototype,ap),rp.prototype.constructor=rp,Object.defineProperty(rp,"super",{value:_d.prototype}),np&&Object.assign(rp.prototype,np)},toFlatObject=(rp,_d,np,ap)=>{let sp,lp,up;const cp={};if(_d=_d||{},rp==null)return _d;do{for(sp=Object.getOwnPropertyNames(rp),lp=sp.length;lp-- >0;)up=sp[lp],(!ap||ap(up,rp,_d))&&!cp[up]&&(_d[up]=rp[up],cp[up]=!0);rp=np!==!1&&getPrototypeOf(rp)}while(rp&&(!np||np(rp,_d))&&rp!==Object.prototype);return _d},endsWith=(rp,_d,np)=>{rp=String(rp),(np===void 0||np>rp.length)&&(np=rp.length),np-=_d.length;const ap=rp.indexOf(_d,np);return ap!==-1&&ap===np},toArray$1=rp=>{if(!rp)return null;if(isArray(rp))return rp;let _d=rp.length;if(!isNumber$1(_d))return null;const np=new Array(_d);for(;_d-- >0;)np[_d]=rp[_d];return np},isTypedArray$1=(rp=>_d=>rp&&_d instanceof rp)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(rp,_d)=>{const ap=(rp&&rp[Symbol.iterator]).call(rp);let sp;for(;(sp=ap.next())&&!sp.done;){const lp=sp.value;_d.call(rp,lp[0],lp[1])}},matchAll=(rp,_d)=>{let np;const ap=[];for(;(np=rp.exec(_d))!==null;)ap.push(np);return ap},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=rp=>rp.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(np,ap,sp){return ap.toUpperCase()+sp}),hasOwnProperty$1=(({hasOwnProperty:rp})=>(_d,np)=>rp.call(_d,np))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(rp,_d)=>{const np=Object.getOwnPropertyDescriptors(rp),ap={};forEach$1(np,(sp,lp)=>{let up;(up=_d(sp,lp,rp))!==!1&&(ap[lp]=up||sp)}),Object.defineProperties(rp,ap)},freezeMethods=rp=>{reduceDescriptors(rp,(_d,np)=>{if(isFunction$2(rp)&&["arguments","caller","callee"].indexOf(np)!==-1)return!1;const ap=rp[np];if(isFunction$2(ap)){if(_d.enumerable=!1,"writable"in _d){_d.writable=!1;return}_d.set||(_d.set=()=>{throw Error("Can not rewrite read-only method '"+np+"'")})}})},toObjectSet=(rp,_d)=>{const np={},ap=sp=>{sp.forEach(lp=>{np[lp]=!0})};return isArray(rp)?ap(rp):ap(String(rp).split(_d)),np},noop=()=>{},toFiniteNumber=(rp,_d)=>(rp=+rp,Number.isFinite(rp)?rp:_d),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(rp=16,_d=ALPHABET.ALPHA_DIGIT)=>{let np="";const{length:ap}=_d;for(;rp--;)np+=_d[Math.random()*ap|0];return np};function isSpecCompliantForm(rp){return!!(rp&&isFunction$2(rp.append)&&rp[Symbol.toStringTag]==="FormData"&&rp[Symbol.iterator])}const toJSONObject=rp=>{const _d=new Array(10),np=(ap,sp)=>{if(isObject$1(ap)){if(_d.indexOf(ap)>=0)return;if(!("toJSON"in ap)){_d[sp]=ap;const lp=isArray(ap)?[]:{};return forEach$1(ap,(up,cp)=>{const dp=np(up,sp+1);!isUndefined$1(dp)&&(lp[cp]=dp)}),_d[sp]=void 0,lp}}return ap};return np(rp,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=rp=>rp&&(isObject$1(rp)||isFunction$2(rp))&&isFunction$2(rp.then)&&isFunction$2(rp.catch),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber:isNumber$1,isBoolean,isObject:isObject$1,isPlainObject:isPlainObject$1,isUndefined:isUndefined$1,isDate,isFile,isBlob,isRegExp,isFunction:isFunction$2,isStream,isURLSearchParams,isTypedArray:isTypedArray$1,isFileList,forEach:forEach$1,merge,extend:extend$1,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray:toArray$1,forEachEntry,matchAll,isHTMLForm,hasOwnProperty:hasOwnProperty$1,hasOwnProp:hasOwnProperty$1,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(rp,_d,np,ap,sp){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=rp,this.name="AxiosError",_d&&(this.code=_d),np&&(this.config=np),ap&&(this.request=ap),sp&&(this.response=sp)}utils$1.inherits(AxiosError,Error,{toJSON:function rp(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(rp=>{descriptors[rp]={value:rp}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(rp,_d,np,ap,sp,lp)=>{const up=Object.create(prototype$1);return utils$1.toFlatObject(rp,up,function(dp){return dp!==Error.prototype},cp=>cp!=="isAxiosError"),AxiosError.call(up,rp.message,_d,np,ap,sp),up.cause=rp,up.name=rp.name,lp&&Object.assign(up,lp),up};const httpAdapter=null;function isVisitable(rp){return utils$1.isPlainObject(rp)||utils$1.isArray(rp)}function removeBrackets(rp){return utils$1.endsWith(rp,"[]")?rp.slice(0,-2):rp}function renderKey(rp,_d,np){return rp?rp.concat(_d).map(function(sp,lp){return sp=removeBrackets(sp),!np&&lp?"["+sp+"]":sp}).join(np?".":""):_d}function isFlatArray(rp){return utils$1.isArray(rp)&&!rp.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function rp(_d){return/^is[A-Z]/.test(_d)});function toFormData(rp,_d,np){if(!utils$1.isObject(rp))throw new TypeError("target must be an object");_d=_d||new FormData,np=utils$1.toFlatObject(np,{metaTokens:!0,dots:!1,indexes:!1},!1,function(xp,_p){return!utils$1.isUndefined(_p[xp])});const ap=np.metaTokens,sp=np.visitor||fp,lp=np.dots,up=np.indexes,dp=(np.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(_d);if(!utils$1.isFunction(sp))throw new TypeError("visitor must be a function");function hp(yp){if(yp===null)return"";if(utils$1.isDate(yp))return yp.toISOString();if(!dp&&utils$1.isBlob(yp))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(yp)||utils$1.isTypedArray(yp)?dp&&typeof Blob=="function"?new Blob([yp]):Buffer.from(yp):yp}function fp(yp,xp,_p){let vp=yp;if(yp&&!_p&&typeof yp=="object"){if(utils$1.endsWith(xp,"{}"))xp=ap?xp:xp.slice(0,-2),yp=JSON.stringify(yp);else if(utils$1.isArray(yp)&&isFlatArray(yp)||(utils$1.isFileList(yp)||utils$1.endsWith(xp,"[]"))&&(vp=utils$1.toArray(yp)))return xp=removeBrackets(xp),vp.forEach(function(Ep,Sp){!(utils$1.isUndefined(Ep)||Ep===null)&&_d.append(up===!0?renderKey([xp],Sp,lp):up===null?xp:xp+"[]",hp(Ep))}),!1}return isVisitable(yp)?!0:(_d.append(renderKey(_p,xp,lp),hp(yp)),!1)}const pp=[],mp=Object.assign(predicates,{defaultVisitor:fp,convertValue:hp,isVisitable});function gp(yp,xp){if(!utils$1.isUndefined(yp)){if(pp.indexOf(yp)!==-1)throw Error("Circular reference detected in "+xp.join("."));pp.push(yp),utils$1.forEach(yp,function(vp,bp){(!(utils$1.isUndefined(vp)||vp===null)&&sp.call(_d,vp,utils$1.isString(bp)?bp.trim():bp,xp,mp))===!0&&gp(vp,xp?xp.concat(bp):[bp])}),pp.pop()}}if(!utils$1.isObject(rp))throw new TypeError("data must be an object");return gp(rp),_d}function encode$1(rp){const _d={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(rp).replace(/[!'()~]|%20|%00/g,function(ap){return _d[ap]})}function AxiosURLSearchParams(rp,_d){this._pairs=[],rp&&toFormData(rp,this,_d)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function rp(_d,np){this._pairs.push([_d,np])};prototype.toString=function rp(_d){const np=_d?function(ap){return _d.call(this,ap,encode$1)}:encode$1;return this._pairs.map(function(sp){return np(sp[0])+"="+np(sp[1])},"").join("&")};function encode(rp){return encodeURIComponent(rp).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(rp,_d,np){if(!_d)return rp;const ap=np&&np.encode||encode,sp=np&&np.serialize;let lp;if(sp?lp=sp(_d,np):lp=utils$1.isURLSearchParams(_d)?_d.toString():new AxiosURLSearchParams(_d,np).toString(ap),lp){const up=rp.indexOf("#");up!==-1&&(rp=rp.slice(0,up)),rp+=(rp.indexOf("?")===-1?"?":"&")+lp}return rp}class InterceptorManager{constructor(){this.handlers=[]}use(_d,np,ap){return this.handlers.push({fulfilled:_d,rejected:np,synchronous:ap?ap.synchronous:!1,runWhen:ap?ap.runWhen:null}),this.handlers.length-1}eject(_d){this.handlers[_d]&&(this.handlers[_d]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(_d){utils$1.forEach(this.handlers,function(ap){ap!==null&&_d(ap)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$8={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(rp=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(rp)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform$7={...utils,...platform$8};function toURLEncodedForm(rp,_d){return toFormData(rp,new platform$7.classes.URLSearchParams,Object.assign({visitor:function(np,ap,sp,lp){return platform$7.isNode&&utils$1.isBuffer(np)?(this.append(ap,np.toString("base64")),!1):lp.defaultVisitor.apply(this,arguments)}},_d))}function parsePropPath(rp){return utils$1.matchAll(/\w+|\[(\w*)]/g,rp).map(_d=>_d[0]==="[]"?"":_d[1]||_d[0])}function arrayToObject(rp){const _d={},np=Object.keys(rp);let ap;const sp=np.length;let lp;for(ap=0;ap<sp;ap++)lp=np[ap],_d[lp]=rp[lp];return _d}function formDataToJSON(rp){function _d(np,ap,sp,lp){let up=np[lp++];if(up==="__proto__")return!0;const cp=Number.isFinite(+up),dp=lp>=np.length;return up=!up&&utils$1.isArray(sp)?sp.length:up,dp?(utils$1.hasOwnProp(sp,up)?sp[up]=[sp[up],ap]:sp[up]=ap,!cp):((!sp[up]||!utils$1.isObject(sp[up]))&&(sp[up]=[]),_d(np,ap,sp[up],lp)&&utils$1.isArray(sp[up])&&(sp[up]=arrayToObject(sp[up])),!cp)}if(utils$1.isFormData(rp)&&utils$1.isFunction(rp.entries)){const np={};return utils$1.forEachEntry(rp,(ap,sp)=>{_d(parsePropPath(ap),sp,np,0)}),np}return null}function stringifySafely(rp,_d,np){if(utils$1.isString(rp))try{return(_d||JSON.parse)(rp),utils$1.trim(rp)}catch(ap){if(ap.name!=="SyntaxError")throw ap}return(np||JSON.stringify)(rp)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function rp(_d,np){const ap=np.getContentType()||"",sp=ap.indexOf("application/json")>-1,lp=utils$1.isObject(_d);if(lp&&utils$1.isHTMLForm(_d)&&(_d=new FormData(_d)),utils$1.isFormData(_d))return sp?JSON.stringify(formDataToJSON(_d)):_d;if(utils$1.isArrayBuffer(_d)||utils$1.isBuffer(_d)||utils$1.isStream(_d)||utils$1.isFile(_d)||utils$1.isBlob(_d))return _d;if(utils$1.isArrayBufferView(_d))return _d.buffer;if(utils$1.isURLSearchParams(_d))return np.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),_d.toString();let cp;if(lp){if(ap.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(_d,this.formSerializer).toString();if((cp=utils$1.isFileList(_d))||ap.indexOf("multipart/form-data")>-1){const dp=this.env&&this.env.FormData;return toFormData(cp?{"files[]":_d}:_d,dp&&new dp,this.formSerializer)}}return lp||sp?(np.setContentType("application/json",!1),stringifySafely(_d)):_d}],transformResponse:[function rp(_d){const np=this.transitional||defaults.transitional,ap=np&&np.forcedJSONParsing,sp=this.responseType==="json";if(_d&&utils$1.isString(_d)&&(ap&&!this.responseType||sp)){const up=!(np&&np.silentJSONParsing)&&sp;try{return JSON.parse(_d)}catch(cp){if(up)throw cp.name==="SyntaxError"?AxiosError.from(cp,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):cp}}return _d}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform$7.classes.FormData,Blob:platform$7.classes.Blob},validateStatus:function rp(_d){return _d>=200&&_d<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],rp=>{defaults.headers[rp]={}});const defaults$1=defaults,ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=rp=>{const _d={};let np,ap,sp;return rp&&rp.split(`
`).forEach(function(up){sp=up.indexOf(":"),np=up.substring(0,sp).trim().toLowerCase(),ap=up.substring(sp+1).trim(),!(!np||_d[np]&&ignoreDuplicateOf[np])&&(np==="set-cookie"?_d[np]?_d[np].push(ap):_d[np]=[ap]:_d[np]=_d[np]?_d[np]+", "+ap:ap)}),_d},$internals=Symbol("internals");function normalizeHeader(rp){return rp&&String(rp).trim().toLowerCase()}function normalizeValue(rp){return rp===!1||rp==null?rp:utils$1.isArray(rp)?rp.map(normalizeValue):String(rp)}function parseTokens(rp){const _d=Object.create(null),np=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let ap;for(;ap=np.exec(rp);)_d[ap[1]]=ap[2];return _d}const isValidHeaderName=rp=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(rp.trim());function matchHeaderValue(rp,_d,np,ap,sp){if(utils$1.isFunction(ap))return ap.call(this,_d,np);if(sp&&(_d=np),!!utils$1.isString(_d)){if(utils$1.isString(ap))return _d.indexOf(ap)!==-1;if(utils$1.isRegExp(ap))return ap.test(_d)}}function formatHeader(rp){return rp.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(_d,np,ap)=>np.toUpperCase()+ap)}function buildAccessors(rp,_d){const np=utils$1.toCamelCase(" "+_d);["get","set","has"].forEach(ap=>{Object.defineProperty(rp,ap+np,{value:function(sp,lp,up){return this[ap].call(this,_d,sp,lp,up)},configurable:!0})})}class AxiosHeaders{constructor(_d){_d&&this.set(_d)}set(_d,np,ap){const sp=this;function lp(cp,dp,hp){const fp=normalizeHeader(dp);if(!fp)throw new Error("header name must be a non-empty string");const pp=utils$1.findKey(sp,fp);(!pp||sp[pp]===void 0||hp===!0||hp===void 0&&sp[pp]!==!1)&&(sp[pp||dp]=normalizeValue(cp))}const up=(cp,dp)=>utils$1.forEach(cp,(hp,fp)=>lp(hp,fp,dp));return utils$1.isPlainObject(_d)||_d instanceof this.constructor?up(_d,np):utils$1.isString(_d)&&(_d=_d.trim())&&!isValidHeaderName(_d)?up(parseHeaders(_d),np):_d!=null&&lp(np,_d,ap),this}get(_d,np){if(_d=normalizeHeader(_d),_d){const ap=utils$1.findKey(this,_d);if(ap){const sp=this[ap];if(!np)return sp;if(np===!0)return parseTokens(sp);if(utils$1.isFunction(np))return np.call(this,sp,ap);if(utils$1.isRegExp(np))return np.exec(sp);throw new TypeError("parser must be boolean|regexp|function")}}}has(_d,np){if(_d=normalizeHeader(_d),_d){const ap=utils$1.findKey(this,_d);return!!(ap&&this[ap]!==void 0&&(!np||matchHeaderValue(this,this[ap],ap,np)))}return!1}delete(_d,np){const ap=this;let sp=!1;function lp(up){if(up=normalizeHeader(up),up){const cp=utils$1.findKey(ap,up);cp&&(!np||matchHeaderValue(ap,ap[cp],cp,np))&&(delete ap[cp],sp=!0)}}return utils$1.isArray(_d)?_d.forEach(lp):lp(_d),sp}clear(_d){const np=Object.keys(this);let ap=np.length,sp=!1;for(;ap--;){const lp=np[ap];(!_d||matchHeaderValue(this,this[lp],lp,_d,!0))&&(delete this[lp],sp=!0)}return sp}normalize(_d){const np=this,ap={};return utils$1.forEach(this,(sp,lp)=>{const up=utils$1.findKey(ap,lp);if(up){np[up]=normalizeValue(sp),delete np[lp];return}const cp=_d?formatHeader(lp):String(lp).trim();cp!==lp&&delete np[lp],np[cp]=normalizeValue(sp),ap[cp]=!0}),this}concat(..._d){return this.constructor.concat(this,..._d)}toJSON(_d){const np=Object.create(null);return utils$1.forEach(this,(ap,sp)=>{ap!=null&&ap!==!1&&(np[sp]=_d&&utils$1.isArray(ap)?ap.join(", "):ap)}),np}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([_d,np])=>_d+": "+np).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(_d){return _d instanceof this?_d:new this(_d)}static concat(_d,...np){const ap=new this(_d);return np.forEach(sp=>ap.set(sp)),ap}static accessor(_d){const ap=(this[$internals]=this[$internals]={accessors:{}}).accessors,sp=this.prototype;function lp(up){const cp=normalizeHeader(up);ap[cp]||(buildAccessors(sp,up),ap[cp]=!0)}return utils$1.isArray(_d)?_d.forEach(lp):lp(_d),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:rp},_d)=>{let np=_d[0].toUpperCase()+_d.slice(1);return{get:()=>rp,set(ap){this[np]=ap}}});utils$1.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(rp,_d){const np=this||defaults$1,ap=_d||np,sp=AxiosHeaders$1.from(ap.headers);let lp=ap.data;return utils$1.forEach(rp,function(cp){lp=cp.call(np,lp,sp.normalize(),_d?_d.status:void 0)}),sp.normalize(),lp}function isCancel(rp){return!!(rp&&rp.__CANCEL__)}function CanceledError(rp,_d,np){AxiosError.call(this,rp??"canceled",AxiosError.ERR_CANCELED,_d,np),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(rp,_d,np){const ap=np.config.validateStatus;!np.status||!ap||ap(np.status)?rp(np):_d(new AxiosError("Request failed with status code "+np.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(np.status/100)-4],np.config,np.request,np))}const cookies=platform$7.hasStandardBrowserEnv?{write(rp,_d,np,ap,sp,lp){const up=[rp+"="+encodeURIComponent(_d)];utils$1.isNumber(np)&&up.push("expires="+new Date(np).toGMTString()),utils$1.isString(ap)&&up.push("path="+ap),utils$1.isString(sp)&&up.push("domain="+sp),lp===!0&&up.push("secure"),document.cookie=up.join("; ")},read(rp){const _d=document.cookie.match(new RegExp("(^|;\\s*)("+rp+")=([^;]*)"));return _d?decodeURIComponent(_d[3]):null},remove(rp){this.write(rp,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(rp){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(rp)}function combineURLs(rp,_d){return _d?rp.replace(/\/?\/$/,"")+"/"+_d.replace(/^\/+/,""):rp}function buildFullPath(rp,_d){return rp&&!isAbsoluteURL(_d)?combineURLs(rp,_d):_d}const isURLSameOrigin=platform$7.hasStandardBrowserEnv?function rp(){const _d=/(msie|trident)/i.test(navigator.userAgent),np=document.createElement("a");let ap;function sp(lp){let up=lp;return _d&&(np.setAttribute("href",up),up=np.href),np.setAttribute("href",up),{href:np.href,protocol:np.protocol?np.protocol.replace(/:$/,""):"",host:np.host,search:np.search?np.search.replace(/^\?/,""):"",hash:np.hash?np.hash.replace(/^#/,""):"",hostname:np.hostname,port:np.port,pathname:np.pathname.charAt(0)==="/"?np.pathname:"/"+np.pathname}}return ap=sp(window.location.href),function(up){const cp=utils$1.isString(up)?sp(up):up;return cp.protocol===ap.protocol&&cp.host===ap.host}}():function rp(){return function(){return!0}}();function parseProtocol(rp){const _d=/^([-+\w]{1,25})(:?\/\/|:)/.exec(rp);return _d&&_d[1]||""}function speedometer(rp,_d){rp=rp||10;const np=new Array(rp),ap=new Array(rp);let sp=0,lp=0,up;return _d=_d!==void 0?_d:1e3,function(dp){const hp=Date.now(),fp=ap[lp];up||(up=hp),np[sp]=dp,ap[sp]=hp;let pp=lp,mp=0;for(;pp!==sp;)mp+=np[pp++],pp=pp%rp;if(sp=(sp+1)%rp,sp===lp&&(lp=(lp+1)%rp),hp-up<_d)return;const gp=fp&&hp-fp;return gp?Math.round(mp*1e3/gp):void 0}}function progressEventReducer(rp,_d){let np=0;const ap=speedometer(50,250);return sp=>{const lp=sp.loaded,up=sp.lengthComputable?sp.total:void 0,cp=lp-np,dp=ap(cp),hp=lp<=up;np=lp;const fp={loaded:lp,total:up,progress:up?lp/up:void 0,bytes:cp,rate:dp||void 0,estimated:dp&&up&&hp?(up-lp)/dp:void 0,event:sp};fp[_d?"download":"upload"]=!0,rp(fp)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(rp){return new Promise(function(np,ap){let sp=rp.data;const lp=AxiosHeaders$1.from(rp.headers).normalize();let{responseType:up,withXSRFToken:cp}=rp,dp;function hp(){rp.cancelToken&&rp.cancelToken.unsubscribe(dp),rp.signal&&rp.signal.removeEventListener("abort",dp)}let fp;if(utils$1.isFormData(sp)){if(platform$7.hasStandardBrowserEnv||platform$7.hasStandardBrowserWebWorkerEnv)lp.setContentType(!1);else if((fp=lp.getContentType())!==!1){const[xp,..._p]=fp?fp.split(";").map(vp=>vp.trim()).filter(Boolean):[];lp.setContentType([xp||"multipart/form-data",..._p].join("; "))}}let pp=new XMLHttpRequest;if(rp.auth){const xp=rp.auth.username||"",_p=rp.auth.password?unescape(encodeURIComponent(rp.auth.password)):"";lp.set("Authorization","Basic "+btoa(xp+":"+_p))}const mp=buildFullPath(rp.baseURL,rp.url);pp.open(rp.method.toUpperCase(),buildURL(mp,rp.params,rp.paramsSerializer),!0),pp.timeout=rp.timeout;function gp(){if(!pp)return;const xp=AxiosHeaders$1.from("getAllResponseHeaders"in pp&&pp.getAllResponseHeaders()),vp={data:!up||up==="text"||up==="json"?pp.responseText:pp.response,status:pp.status,statusText:pp.statusText,headers:xp,config:rp,request:pp};settle(function(Ep){np(Ep),hp()},function(Ep){ap(Ep),hp()},vp),pp=null}if("onloadend"in pp?pp.onloadend=gp:pp.onreadystatechange=function(){!pp||pp.readyState!==4||pp.status===0&&!(pp.responseURL&&pp.responseURL.indexOf("file:")===0)||setTimeout(gp)},pp.onabort=function(){pp&&(ap(new AxiosError("Request aborted",AxiosError.ECONNABORTED,rp,pp)),pp=null)},pp.onerror=function(){ap(new AxiosError("Network Error",AxiosError.ERR_NETWORK,rp,pp)),pp=null},pp.ontimeout=function(){let _p=rp.timeout?"timeout of "+rp.timeout+"ms exceeded":"timeout exceeded";const vp=rp.transitional||transitionalDefaults;rp.timeoutErrorMessage&&(_p=rp.timeoutErrorMessage),ap(new AxiosError(_p,vp.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,rp,pp)),pp=null},platform$7.hasStandardBrowserEnv&&(cp&&utils$1.isFunction(cp)&&(cp=cp(rp)),cp||cp!==!1&&isURLSameOrigin(mp))){const xp=rp.xsrfHeaderName&&rp.xsrfCookieName&&cookies.read(rp.xsrfCookieName);xp&&lp.set(rp.xsrfHeaderName,xp)}sp===void 0&&lp.setContentType(null),"setRequestHeader"in pp&&utils$1.forEach(lp.toJSON(),function(_p,vp){pp.setRequestHeader(vp,_p)}),utils$1.isUndefined(rp.withCredentials)||(pp.withCredentials=!!rp.withCredentials),up&&up!=="json"&&(pp.responseType=rp.responseType),typeof rp.onDownloadProgress=="function"&&pp.addEventListener("progress",progressEventReducer(rp.onDownloadProgress,!0)),typeof rp.onUploadProgress=="function"&&pp.upload&&pp.upload.addEventListener("progress",progressEventReducer(rp.onUploadProgress)),(rp.cancelToken||rp.signal)&&(dp=xp=>{pp&&(ap(!xp||xp.type?new CanceledError(null,rp,pp):xp),pp.abort(),pp=null)},rp.cancelToken&&rp.cancelToken.subscribe(dp),rp.signal&&(rp.signal.aborted?dp():rp.signal.addEventListener("abort",dp)));const yp=parseProtocol(mp);if(yp&&platform$7.protocols.indexOf(yp)===-1){ap(new AxiosError("Unsupported protocol "+yp+":",AxiosError.ERR_BAD_REQUEST,rp));return}pp.send(sp||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$1.forEach(knownAdapters,(rp,_d)=>{if(rp){try{Object.defineProperty(rp,"name",{value:_d})}catch{}Object.defineProperty(rp,"adapterName",{value:_d})}});const renderReason=rp=>`- ${rp}`,isResolvedHandle=rp=>utils$1.isFunction(rp)||rp===null||rp===!1,adapters={getAdapter:rp=>{rp=utils$1.isArray(rp)?rp:[rp];const{length:_d}=rp;let np,ap;const sp={};for(let lp=0;lp<_d;lp++){np=rp[lp];let up;if(ap=np,!isResolvedHandle(np)&&(ap=knownAdapters[(up=String(np)).toLowerCase()],ap===void 0))throw new AxiosError(`Unknown adapter '${up}'`);if(ap)break;sp[up||"#"+lp]=ap}if(!ap){const lp=Object.entries(sp).map(([cp,dp])=>`adapter ${cp} `+(dp===!1?"is not supported by the environment":"is not available in the build"));let up=_d?lp.length>1?`since :
`+lp.map(renderReason).join(`
`):" "+renderReason(lp[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+up,"ERR_NOT_SUPPORT")}return ap},adapters:knownAdapters};function throwIfCancellationRequested(rp){if(rp.cancelToken&&rp.cancelToken.throwIfRequested(),rp.signal&&rp.signal.aborted)throw new CanceledError(null,rp)}function dispatchRequest(rp){return throwIfCancellationRequested(rp),rp.headers=AxiosHeaders$1.from(rp.headers),rp.data=transformData.call(rp,rp.transformRequest),["post","put","patch"].indexOf(rp.method)!==-1&&rp.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(rp.adapter||defaults$1.adapter)(rp).then(function(ap){return throwIfCancellationRequested(rp),ap.data=transformData.call(rp,rp.transformResponse,ap),ap.headers=AxiosHeaders$1.from(ap.headers),ap},function(ap){return isCancel(ap)||(throwIfCancellationRequested(rp),ap&&ap.response&&(ap.response.data=transformData.call(rp,rp.transformResponse,ap.response),ap.response.headers=AxiosHeaders$1.from(ap.response.headers))),Promise.reject(ap)})}const headersToObject=rp=>rp instanceof AxiosHeaders$1?rp.toJSON():rp;function mergeConfig(rp,_d){_d=_d||{};const np={};function ap(hp,fp,pp){return utils$1.isPlainObject(hp)&&utils$1.isPlainObject(fp)?utils$1.merge.call({caseless:pp},hp,fp):utils$1.isPlainObject(fp)?utils$1.merge({},fp):utils$1.isArray(fp)?fp.slice():fp}function sp(hp,fp,pp){if(utils$1.isUndefined(fp)){if(!utils$1.isUndefined(hp))return ap(void 0,hp,pp)}else return ap(hp,fp,pp)}function lp(hp,fp){if(!utils$1.isUndefined(fp))return ap(void 0,fp)}function up(hp,fp){if(utils$1.isUndefined(fp)){if(!utils$1.isUndefined(hp))return ap(void 0,hp)}else return ap(void 0,fp)}function cp(hp,fp,pp){if(pp in _d)return ap(hp,fp);if(pp in rp)return ap(void 0,hp)}const dp={url:lp,method:lp,data:lp,baseURL:up,transformRequest:up,transformResponse:up,paramsSerializer:up,timeout:up,timeoutMessage:up,withCredentials:up,withXSRFToken:up,adapter:up,responseType:up,xsrfCookieName:up,xsrfHeaderName:up,onUploadProgress:up,onDownloadProgress:up,decompress:up,maxContentLength:up,maxBodyLength:up,beforeRedirect:up,transport:up,httpAgent:up,httpsAgent:up,cancelToken:up,socketPath:up,responseEncoding:up,validateStatus:cp,headers:(hp,fp)=>sp(headersToObject(hp),headersToObject(fp),!0)};return utils$1.forEach(Object.keys(Object.assign({},rp,_d)),function(fp){const pp=dp[fp]||sp,mp=pp(rp[fp],_d[fp],fp);utils$1.isUndefined(mp)&&pp!==cp||(np[fp]=mp)}),np}const VERSION="1.6.7",validators$1={};["object","boolean","number","function","string","symbol"].forEach((rp,_d)=>{validators$1[rp]=function(ap){return typeof ap===rp||"a"+(_d<1?"n ":" ")+rp}});const deprecatedWarnings={};validators$1.transitional=function rp(_d,np,ap){function sp(lp,up){return"[Axios v"+VERSION+"] Transitional option '"+lp+"'"+up+(ap?". "+ap:"")}return(lp,up,cp)=>{if(_d===!1)throw new AxiosError(sp(up," has been removed"+(np?" in "+np:"")),AxiosError.ERR_DEPRECATED);return np&&!deprecatedWarnings[up]&&(deprecatedWarnings[up]=!0,console.warn(sp(up," has been deprecated since v"+np+" and will be removed in the near future"))),_d?_d(lp,up,cp):!0}};function assertOptions(rp,_d,np){if(typeof rp!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const ap=Object.keys(rp);let sp=ap.length;for(;sp-- >0;){const lp=ap[sp],up=_d[lp];if(up){const cp=rp[lp],dp=cp===void 0||up(cp,lp,rp);if(dp!==!0)throw new AxiosError("option "+lp+" must be "+dp,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(np!==!0)throw new AxiosError("Unknown option "+lp,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(_d){this.defaults=_d,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(_d,np){try{return await this._request(_d,np)}catch(ap){if(ap instanceof Error){let sp;Error.captureStackTrace?Error.captureStackTrace(sp={}):sp=new Error;const lp=sp.stack?sp.stack.replace(/^.+\n/,""):"";ap.stack?lp&&!String(ap.stack).endsWith(lp.replace(/^.+\n.+\n/,""))&&(ap.stack+=`
`+lp):ap.stack=lp}throw ap}}_request(_d,np){typeof _d=="string"?(np=np||{},np.url=_d):np=_d||{},np=mergeConfig(this.defaults,np);const{transitional:ap,paramsSerializer:sp,headers:lp}=np;ap!==void 0&&validator.assertOptions(ap,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),sp!=null&&(utils$1.isFunction(sp)?np.paramsSerializer={serialize:sp}:validator.assertOptions(sp,{encode:validators.function,serialize:validators.function},!0)),np.method=(np.method||this.defaults.method||"get").toLowerCase();let up=lp&&utils$1.merge(lp.common,lp[np.method]);lp&&utils$1.forEach(["delete","get","head","post","put","patch","common"],yp=>{delete lp[yp]}),np.headers=AxiosHeaders$1.concat(up,lp);const cp=[];let dp=!0;this.interceptors.request.forEach(function(xp){typeof xp.runWhen=="function"&&xp.runWhen(np)===!1||(dp=dp&&xp.synchronous,cp.unshift(xp.fulfilled,xp.rejected))});const hp=[];this.interceptors.response.forEach(function(xp){hp.push(xp.fulfilled,xp.rejected)});let fp,pp=0,mp;if(!dp){const yp=[dispatchRequest.bind(this),void 0];for(yp.unshift.apply(yp,cp),yp.push.apply(yp,hp),mp=yp.length,fp=Promise.resolve(np);pp<mp;)fp=fp.then(yp[pp++],yp[pp++]);return fp}mp=cp.length;let gp=np;for(pp=0;pp<mp;){const yp=cp[pp++],xp=cp[pp++];try{gp=yp(gp)}catch(_p){xp.call(this,_p);break}}try{fp=dispatchRequest.call(this,gp)}catch(yp){return Promise.reject(yp)}for(pp=0,mp=hp.length;pp<mp;)fp=fp.then(hp[pp++],hp[pp++]);return fp}getUri(_d){_d=mergeConfig(this.defaults,_d);const np=buildFullPath(_d.baseURL,_d.url);return buildURL(np,_d.params,_d.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function rp(_d){Axios.prototype[_d]=function(np,ap){return this.request(mergeConfig(ap||{},{method:_d,url:np,data:(ap||{}).data}))}});utils$1.forEach(["post","put","patch"],function rp(_d){function np(ap){return function(lp,up,cp){return this.request(mergeConfig(cp||{},{method:_d,headers:ap?{"Content-Type":"multipart/form-data"}:{},url:lp,data:up}))}}Axios.prototype[_d]=np(),Axios.prototype[_d+"Form"]=np(!0)});const Axios$1=Axios;class CancelToken{constructor(_d){if(typeof _d!="function")throw new TypeError("executor must be a function.");let np;this.promise=new Promise(function(lp){np=lp});const ap=this;this.promise.then(sp=>{if(!ap._listeners)return;let lp=ap._listeners.length;for(;lp-- >0;)ap._listeners[lp](sp);ap._listeners=null}),this.promise.then=sp=>{let lp;const up=new Promise(cp=>{ap.subscribe(cp),lp=cp}).then(sp);return up.cancel=function(){ap.unsubscribe(lp)},up},_d(function(lp,up,cp){ap.reason||(ap.reason=new CanceledError(lp,up,cp),np(ap.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(_d){if(this.reason){_d(this.reason);return}this._listeners?this._listeners.push(_d):this._listeners=[_d]}unsubscribe(_d){if(!this._listeners)return;const np=this._listeners.indexOf(_d);np!==-1&&this._listeners.splice(np,1)}static source(){let _d;return{token:new CancelToken(function(sp){_d=sp}),cancel:_d}}}const CancelToken$1=CancelToken;function spread(rp){return function(np){return rp.apply(null,np)}}function isAxiosError(rp){return utils$1.isObject(rp)&&rp.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([rp,_d])=>{HttpStatusCode[_d]=rp});const HttpStatusCode$1=HttpStatusCode;function createInstance(rp){const _d=new Axios$1(rp),np=bind(Axios$1.prototype.request,_d);return utils$1.extend(np,Axios$1.prototype,_d,{allOwnKeys:!0}),utils$1.extend(np,_d,null,{allOwnKeys:!0}),np.create=function(sp){return createInstance(mergeConfig(rp,sp))},np}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function rp(_d){return Promise.all(_d)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=rp=>formDataToJSON(utils$1.isHTMLForm(rp)?new FormData(rp):rp);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;var InfoOutlined={},_interopRequireDefault$B=interopRequireDefaultExports;Object.defineProperty(InfoOutlined,"__esModule",{value:!0});var default_1$s=InfoOutlined.default=void 0,_createSvgIcon$s=_interopRequireDefault$B(requireCreateSvgIcon()),_jsxRuntime$s=jsxRuntimeExports;default_1$s=InfoOutlined.default=(0,_createSvgIcon$s.default)((0,_jsxRuntime$s.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined");const URL$2="/my_model/",ImageResultPage=()=>{const rp=useLocation(),_d=useNavigate(),np=rp.state.value,ap=reactExports.useRef(null),sp=reactExports.useRef(null),[lp,up]=reactExports.useState(null),[cp,dp]=reactExports.useState(0),[hp,fp]=reactExports.useState([]);reactExports.useState(!1);const pp=async _p=>{console.log(_p);const vp=localStorage.getItem("jwt"),bp=await axios.get("https://i10c203.p.ssafy.io/api/boards",{params:{categoryId:1,fishBookId:_p},headers:{Authorization:vp}});console.log(bp.data),fp(bp.data.boards)},mp=async()=>{if(console.log(sp.current),console.log(ap.current),sp.current&&ap.current)try{let _p=ap.current;const vp=await sp.current.predict(_p,!1);vp.sort((Sp,Ap)=>parseFloat(Ap.probability)-parseFloat(Sp.probability));const Ep=vp[0].className.split(" ");up(Ep[0]),dp(Ep[1]),pp(Ep[1])}catch(_p){console.error("Prediction error:",_p)}},gp=async()=>{try{const _p=URL$2+"model.json",vp=URL$2+"metadata.json",bp=await dist$1.load(_p,vp);sp.current=bp,await mp()}catch(_p){console.error("Model loading error:",_p)}},yp=()=>{_d(`/fishbook/${cp}`)},xp=_p=>{const vp=new Date,Ep=(new Date(_p)-vp)/(1e3*60*60),Sp=new Intl.RelativeTimeFormat("ko-KR");let Ap;return Math.abs(Ep)<24?Ap=Sp.format(Math.round(Ep),"hour"):Ap=Sp.format(Math.round(Ep/24),"day"),Ap};return reactExports.useEffect(()=>(gp(),()=>{ap.current=null}),[]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"result",style:{display:!lp&&"none"},children:[jsxRuntimeExports.jsx(Header,{centerText:"",align:"center"}),jsxRuntimeExports.jsxs("div",{className:"result-body",children:[jsxRuntimeExports.jsx("div",{className:"result-img",children:jsxRuntimeExports.jsx("img",{className:"ml-result",src:np,ref:ap,alt:""})}),jsxRuntimeExports.jsxs("div",{className:"result-content",children:[jsxRuntimeExports.jsxs("div",{className:"result-fish",onClick:yp,children:[jsxRuntimeExports.jsx("div",{className:"result-name",children:lp}),jsxRuntimeExports.jsx("div",{className:"result-detail",children:" "})]}),jsxRuntimeExports.jsxs("div",{className:"fish-reviews",children:[jsxRuntimeExports.jsxs("h3",{className:"reviews-title",children:[lp," "]}),jsxRuntimeExports.jsx("div",{className:"wrapper",children:hp.length?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"board",children:hp.map(_p=>jsxRuntimeExports.jsxs("div",{className:"review",onClick:()=>_d(`/media/board/${_p.boardId}`),children:[jsxRuntimeExports.jsx("img",{src:_p.boardImageUrl,className:"review-img"}),jsxRuntimeExports.jsxs("div",{className:"review-user",children:[jsxRuntimeExports.jsx("img",{src:_p.profileImageUrl||default_img,alt:""}),jsxRuntimeExports.jsx("div",{children:_p.nickName})]}),jsxRuntimeExports.jsx("div",{className:"review-date",children:xp(_p.createdAt)})]},_p.boardId))})}):jsxRuntimeExports.jsx("div",{className:"none-data",children:"  ."})})]})]})]})]}),jsxRuntimeExports.jsx(Loading,{hidden:lp})]})};var define_process_env_default$1={};function err$1(rp){const _d=new Error(rp);if(_d.stack===void 0)try{throw _d}catch{}return _d}var err_1=err$1,Recoil_err=err_1;function isPromise$1(rp){return!!rp&&typeof rp.then=="function"}var Recoil_isPromise=isPromise$1;function nullthrows(rp,_d){if(rp!=null)return rp;throw Recoil_err(_d??"Got unexpected null or undefined")}var Recoil_nullthrows=nullthrows;function _defineProperty$1(rp,_d,np){return _d in rp?Object.defineProperty(rp,_d,{value:np,enumerable:!0,configurable:!0,writable:!0}):rp[_d]=np,rp}class BaseLoadable{getValue(){throw Recoil_err("BaseLoadable")}toPromise(){throw Recoil_err("BaseLoadable")}valueMaybe(){throw Recoil_err("BaseLoadable")}valueOrThrow(){throw Recoil_err(`Loadable expected value, but in "${this.state}" state`)}promiseMaybe(){throw Recoil_err("BaseLoadable")}promiseOrThrow(){throw Recoil_err(`Loadable expected promise, but in "${this.state}" state`)}errorMaybe(){throw Recoil_err("BaseLoadable")}errorOrThrow(){throw Recoil_err(`Loadable expected error, but in "${this.state}" state`)}is(_d){return _d.state===this.state&&_d.contents===this.contents}map(_d){throw Recoil_err("BaseLoadable")}}class ValueLoadable extends BaseLoadable{constructor(_d){super(),_defineProperty$1(this,"state","hasValue"),_defineProperty$1(this,"contents",void 0),this.contents=_d}getValue(){return this.contents}toPromise(){return Promise.resolve(this.contents)}valueMaybe(){return this.contents}valueOrThrow(){return this.contents}promiseMaybe(){}errorMaybe(){}map(_d){try{const np=_d(this.contents);return Recoil_isPromise(np)?loadableWithPromise(np):isLoadable(np)?np:loadableWithValue(np)}catch(np){return Recoil_isPromise(np)?loadableWithPromise(np.next(()=>this.map(_d))):loadableWithError(np)}}}class ErrorLoadable extends BaseLoadable{constructor(_d){super(),_defineProperty$1(this,"state","hasError"),_defineProperty$1(this,"contents",void 0),this.contents=_d}getValue(){throw this.contents}toPromise(){return Promise.reject(this.contents)}valueMaybe(){}promiseMaybe(){}errorMaybe(){return this.contents}errorOrThrow(){return this.contents}map(_d){return this}}class LoadingLoadable extends BaseLoadable{constructor(_d){super(),_defineProperty$1(this,"state","loading"),_defineProperty$1(this,"contents",void 0),this.contents=_d}getValue(){throw this.contents}toPromise(){return this.contents}valueMaybe(){}promiseMaybe(){return this.contents}promiseOrThrow(){return this.contents}errorMaybe(){}map(_d){return loadableWithPromise(this.contents.then(np=>{const ap=_d(np);if(isLoadable(ap)){const sp=ap;switch(sp.state){case"hasValue":return sp.contents;case"hasError":throw sp.contents;case"loading":return sp.contents}}return ap}).catch(np=>{if(Recoil_isPromise(np))return np.then(()=>this.map(_d).contents);throw np}))}}function loadableWithValue(rp){return Object.freeze(new ValueLoadable(rp))}function loadableWithError(rp){return Object.freeze(new ErrorLoadable(rp))}function loadableWithPromise(rp){return Object.freeze(new LoadingLoadable(rp))}function loadableLoading(){return Object.freeze(new LoadingLoadable(new Promise(()=>{})))}function loadableAllArray(rp){return rp.every(_d=>_d.state==="hasValue")?loadableWithValue(rp.map(_d=>_d.contents)):rp.some(_d=>_d.state==="hasError")?loadableWithError(Recoil_nullthrows(rp.find(_d=>_d.state==="hasError"),"Invalid loadable passed to loadableAll").contents):loadableWithPromise(Promise.all(rp.map(_d=>_d.contents)))}function loadableAll(rp){const np=(Array.isArray(rp)?rp:Object.getOwnPropertyNames(rp).map(sp=>rp[sp])).map(sp=>isLoadable(sp)?sp:Recoil_isPromise(sp)?loadableWithPromise(sp):loadableWithValue(sp)),ap=loadableAllArray(np);return Array.isArray(rp)?ap:ap.map(sp=>Object.getOwnPropertyNames(rp).reduce((lp,up,cp)=>({...lp,[up]:sp[cp]}),{}))}function isLoadable(rp){return rp instanceof BaseLoadable}const LoadableStaticInterface={of:rp=>Recoil_isPromise(rp)?loadableWithPromise(rp):isLoadable(rp)?rp:loadableWithValue(rp),error:rp=>loadableWithError(rp),loading:()=>loadableLoading(),all:loadableAll,isLoadable};var Recoil_Loadable={loadableWithValue,loadableWithError,loadableWithPromise,loadableLoading,loadableAll,isLoadable,RecoilLoadable:LoadableStaticInterface},Recoil_Loadable_1=Recoil_Loadable.loadableWithValue,Recoil_Loadable_2=Recoil_Loadable.loadableWithError,Recoil_Loadable_3=Recoil_Loadable.loadableWithPromise,Recoil_Loadable_4=Recoil_Loadable.loadableLoading,Recoil_Loadable_5=Recoil_Loadable.loadableAll,Recoil_Loadable_6=Recoil_Loadable.isLoadable,Recoil_Loadable_7=Recoil_Loadable.RecoilLoadable,Recoil_Loadable$1=Object.freeze({__proto__:null,loadableWithValue:Recoil_Loadable_1,loadableWithError:Recoil_Loadable_2,loadableWithPromise:Recoil_Loadable_3,loadableLoading:Recoil_Loadable_4,loadableAll:Recoil_Loadable_5,isLoadable:Recoil_Loadable_6,RecoilLoadable:Recoil_Loadable_7});const env={RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED:!0,RECOIL_GKS_ENABLED:new Set(["recoil_hamt_2020","recoil_sync_external_store","recoil_suppress_rerender_in_callback","recoil_memory_managament_2020"])};function readProcessEnvBooleanFlag(rp,_d){var np,ap;const sp=(np=define_process_env_default$1[rp])===null||np===void 0||(ap=np.toLowerCase())===null||ap===void 0?void 0:ap.trim();if(sp==null||sp==="")return;if(!["true","false"].includes(sp))throw Recoil_err(`process.env.${rp} value must be 'true', 'false', or empty: ${sp}`);_d(sp==="true")}function readProcessEnvStringArrayFlag(rp,_d){var np;const ap=(np=define_process_env_default$1[rp])===null||np===void 0?void 0:np.trim();ap==null||ap===""||_d(ap.split(/\s*,\s*|\s+/))}function applyProcessEnvFlagOverrides(){var rp;typeof process>"u"||((rp=process)===null||rp===void 0?void 0:rp.env)!=null&&(readProcessEnvBooleanFlag("RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED",_d=>{env.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED=_d}),readProcessEnvStringArrayFlag("RECOIL_GKS_ENABLED",_d=>{_d.forEach(np=>{env.RECOIL_GKS_ENABLED.add(np)})}))}applyProcessEnvFlagOverrides();var Recoil_RecoilEnv=env;function Recoil_gkx_OSS(rp){return Recoil_RecoilEnv.RECOIL_GKS_ENABLED.has(rp)}Recoil_gkx_OSS.setPass=rp=>{Recoil_RecoilEnv.RECOIL_GKS_ENABLED.add(rp)};Recoil_gkx_OSS.setFail=rp=>{Recoil_RecoilEnv.RECOIL_GKS_ENABLED.delete(rp)};Recoil_gkx_OSS.clear=()=>{Recoil_RecoilEnv.RECOIL_GKS_ENABLED.clear()};var Recoil_gkx=Recoil_gkx_OSS;function recoverableViolation(rp,_d,{error:np}={}){return null}var recoverableViolation_1=recoverableViolation,Recoil_recoverableViolation=recoverableViolation_1,_createMutableSource,_useMutableSource,_useSyncExternalStore;const createMutableSource=(_createMutableSource=React.createMutableSource)!==null&&_createMutableSource!==void 0?_createMutableSource:React.unstable_createMutableSource,useMutableSource=(_useMutableSource=React.useMutableSource)!==null&&_useMutableSource!==void 0?_useMutableSource:React.unstable_useMutableSource,useSyncExternalStore=(_useSyncExternalStore=React.useSyncExternalStore)!==null&&_useSyncExternalStore!==void 0?_useSyncExternalStore:React.unstable_useSyncExternalStore;function currentRendererSupportsUseSyncExternalStore(){var rp;const{ReactCurrentDispatcher:_d,ReactCurrentOwner:np}=React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;return((rp=_d==null?void 0:_d.current)!==null&&rp!==void 0?rp:np.currentDispatcher).useSyncExternalStore!=null}function reactMode(){return Recoil_gkx("recoil_transition_support")?{mode:"TRANSITION_SUPPORT",early:!0,concurrent:!0}:Recoil_gkx("recoil_sync_external_store")&&useSyncExternalStore!=null?{mode:"SYNC_EXTERNAL_STORE",early:!0,concurrent:!1}:Recoil_gkx("recoil_mutable_source")&&useMutableSource!=null&&typeof window<"u"&&!window.$disableRecoilValueMutableSource_TEMP_HACK_DO_NOT_USE?Recoil_gkx("recoil_suppress_rerender_in_callback")?{mode:"MUTABLE_SOURCE",early:!0,concurrent:!0}:{mode:"MUTABLE_SOURCE",early:!1,concurrent:!1}:Recoil_gkx("recoil_suppress_rerender_in_callback")?{mode:"LEGACY",early:!0,concurrent:!1}:{mode:"LEGACY",early:!1,concurrent:!1}}function isFastRefreshEnabled(){return!1}var Recoil_ReactMode={createMutableSource,useMutableSource,useSyncExternalStore,currentRendererSupportsUseSyncExternalStore,reactMode,isFastRefreshEnabled};class AbstractRecoilValue{constructor(_d){_defineProperty$1(this,"key",void 0),this.key=_d}toJSON(){return{key:this.key}}}class RecoilState extends AbstractRecoilValue{}class RecoilValueReadOnly extends AbstractRecoilValue{}function isRecoilValue(rp){return rp instanceof RecoilState||rp instanceof RecoilValueReadOnly}var Recoil_RecoilValue={AbstractRecoilValue,RecoilState,RecoilValueReadOnly,isRecoilValue},Recoil_RecoilValue_1=Recoil_RecoilValue.AbstractRecoilValue,Recoil_RecoilValue_2=Recoil_RecoilValue.RecoilState,Recoil_RecoilValue_3=Recoil_RecoilValue.RecoilValueReadOnly,Recoil_RecoilValue_4=Recoil_RecoilValue.isRecoilValue,Recoil_RecoilValue$1=Object.freeze({__proto__:null,AbstractRecoilValue:Recoil_RecoilValue_1,RecoilState:Recoil_RecoilValue_2,RecoilValueReadOnly:Recoil_RecoilValue_3,isRecoilValue:Recoil_RecoilValue_4});function mapIterable(rp,_d){return function*(){let np=0;for(const ap of rp)yield _d(ap,np++)}()}var Recoil_mapIterable=mapIterable;class DefaultValue{}const DEFAULT_VALUE=new DefaultValue,nodes=new Map,recoilValues=new Map;function recoilValuesForKeys(rp){return Recoil_mapIterable(rp,_d=>Recoil_nullthrows(recoilValues.get(_d)))}function checkForDuplicateAtomKey(rp){if(nodes.has(rp)){const _d=`Duplicate atom key "${rp}". This is a FATAL ERROR in
      production. But it is safe to ignore this warning if it occurred because of
      hot module replacement.`;console.warn(_d)}}function registerNode(rp){Recoil_RecoilEnv.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED&&checkForDuplicateAtomKey(rp.key),nodes.set(rp.key,rp);const _d=rp.set==null?new Recoil_RecoilValue$1.RecoilValueReadOnly(rp.key):new Recoil_RecoilValue$1.RecoilState(rp.key);return recoilValues.set(rp.key,_d),_d}class NodeMissingError extends Error{}function getNode(rp){const _d=nodes.get(rp);if(_d==null)throw new NodeMissingError(`Missing definition for RecoilValue: "${rp}""`);return _d}function getNodeMaybe(rp){return nodes.get(rp)}const configDeletionHandlers=new Map;function deleteNodeConfigIfPossible(rp){var _d;if(!Recoil_gkx("recoil_memory_managament_2020"))return;const np=nodes.get(rp);if(np!=null&&(_d=np.shouldDeleteConfigOnRelease)!==null&&_d!==void 0&&_d.call(np)){var ap;nodes.delete(rp),(ap=getConfigDeletionHandler(rp))===null||ap===void 0||ap(),configDeletionHandlers.delete(rp)}}function setConfigDeletionHandler(rp,_d){Recoil_gkx("recoil_memory_managament_2020")&&(_d===void 0?configDeletionHandlers.delete(rp):configDeletionHandlers.set(rp,_d))}function getConfigDeletionHandler(rp){return configDeletionHandlers.get(rp)}var Recoil_Node={nodes,recoilValues,registerNode,getNode,getNodeMaybe,deleteNodeConfigIfPossible,setConfigDeletionHandler,getConfigDeletionHandler,recoilValuesForKeys,NodeMissingError,DefaultValue,DEFAULT_VALUE};function enqueueExecution(rp,_d){_d()}var Recoil_Queue={enqueueExecution};function createCommonjsModule(rp,_d){return _d={exports:{}},rp(_d,_d.exports),_d.exports}var hamt_1=createCommonjsModule(function(rp){var _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(um){return typeof um}:function(um){return um&&typeof Symbol=="function"&&um.constructor===Symbol&&um!==Symbol.prototype?"symbol":typeof um},np={},ap=5,sp=Math.pow(2,ap),lp=sp-1,up=sp/2,cp=sp/4,dp={},hp=function(Yp){return function(){return Yp}},fp=np.hash=function(um){var Yp=typeof um>"u"?"undefined":_d(um);if(Yp==="number")return um;Yp!=="string"&&(um+="");for(var hm=0,wm=0,Cm=um.length;wm<Cm;++wm){var Vm=um.charCodeAt(wm);hm=(hm<<5)-hm+Vm|0}return hm},pp=function(Yp){return Yp-=Yp>>1&1431655765,Yp=(Yp&858993459)+(Yp>>2&858993459),Yp=Yp+(Yp>>4)&252645135,Yp+=Yp>>8,Yp+=Yp>>16,Yp&127},mp=function(Yp,hm){return hm>>>Yp&lp},gp=function(Yp){return 1<<Yp},yp=function(Yp,hm){return pp(Yp&hm-1)},xp=function(Yp,hm,wm,Cm){var Vm=Cm;if(!Yp){var im=Cm.length;Vm=new Array(im);for(var Am=0;Am<im;++Am)Vm[Am]=Cm[Am]}return Vm[hm]=wm,Vm},_p=function(Yp,hm,wm){var Cm=wm.length-1,Vm=0,im=0,Am=wm;if(Yp)Vm=im=hm;else for(Am=new Array(Cm);Vm<hm;)Am[im++]=wm[Vm++];for(++Vm;Vm<=Cm;)Am[im++]=wm[Vm++];return Yp&&(Am.length=Cm),Am},vp=function(Yp,hm,wm,Cm){var Vm=Cm.length;if(Yp){for(var im=Vm;im>=hm;)Cm[im--]=Cm[im];return Cm[hm]=wm,Cm}for(var Am=0,Lm=0,Um=new Array(Vm+1);Am<hm;)Um[Lm++]=Cm[Am++];for(Um[hm]=wm;Am<Vm;)Um[++Lm]=Cm[Am++];return Um},bp=1,Ep=2,Sp=3,Ap=4,Rp={__hamt_isEmpty:!0},Tp=function(Yp){return Yp===Rp||Yp&&Yp.__hamt_isEmpty},Mp=function(Yp,hm,wm,Cm){return{type:bp,edit:Yp,hash:hm,key:wm,value:Cm,_modify:Ip}},Op=function(Yp,hm,wm){return{type:Ep,edit:Yp,hash:hm,children:wm,_modify:kp}},Pp=function(Yp,hm,wm){return{type:Sp,edit:Yp,mask:hm,children:wm,_modify:Up}},$p=function(Yp,hm,wm){return{type:Ap,edit:Yp,size:hm,children:wm,_modify:Gp}},zp=function(Yp){return Yp===Rp||Yp.type===bp||Yp.type===Ep},Dp=function(Yp,hm,wm,Cm,Vm){for(var im=[],Am=Cm,Lm=0,Um=0;Am;++Um)Am&1&&(im[Um]=Vm[Lm++]),Am>>>=1;return im[hm]=wm,$p(Yp,Lm+1,im)},Fp=function(Yp,hm,wm,Cm){for(var Vm=new Array(hm-1),im=0,Am=0,Lm=0,Um=Cm.length;Lm<Um;++Lm)if(Lm!==wm){var Gm=Cm[Lm];Gm&&!Tp(Gm)&&(Vm[im++]=Gm,Am|=1<<Lm)}return Pp(Yp,Am,Vm)},jp=function um(Yp,hm,wm,Cm,Vm,im){if(wm===Vm)return Op(Yp,wm,[im,Cm]);var Am=mp(hm,wm),Lm=mp(hm,Vm);return Pp(Yp,gp(Am)|gp(Lm),Am===Lm?[um(Yp,hm+ap,wm,Cm,Vm,im)]:Am<Lm?[Cm,im]:[im,Cm])},Lp=function(Yp,hm,wm,Cm,Vm,im,Am,Lm){for(var Um=Vm.length,Gm=0;Gm<Um;++Gm){var ev=Vm[Gm];if(wm(Am,ev.key)){var nv=ev.value,gv=im(nv);return gv===nv?Vm:gv===dp?(--Lm.value,_p(Yp,Gm,Vm)):xp(Yp,Gm,Mp(hm,Cm,Am,gv),Vm)}}var xv=im();return xv===dp?Vm:(++Lm.value,xp(Yp,Um,Mp(hm,Cm,Am,xv),Vm))},Bp=function(Yp,hm){return Yp===hm.edit},Ip=function(Yp,hm,wm,Cm,Vm,im,Am){if(hm(im,this.key)){var Lm=Cm(this.value);return Lm===this.value?this:Lm===dp?(--Am.value,Rp):Bp(Yp,this)?(this.value=Lm,this):Mp(Yp,Vm,im,Lm)}var Um=Cm();return Um===dp?this:(++Am.value,jp(Yp,wm,this.hash,this,Vm,Mp(Yp,Vm,im,Um)))},kp=function(Yp,hm,wm,Cm,Vm,im,Am){if(Vm===this.hash){var Lm=Bp(Yp,this),Um=Lp(Lm,Yp,hm,this.hash,this.children,Cm,im,Am);return Um===this.children?this:Um.length>1?Op(Yp,this.hash,Um):Um[0]}var Gm=Cm();return Gm===dp?this:(++Am.value,jp(Yp,wm,this.hash,this,Vm,Mp(Yp,Vm,im,Gm)))},Up=function(Yp,hm,wm,Cm,Vm,im,Am){var Lm=this.mask,Um=this.children,Gm=mp(wm,Vm),ev=gp(Gm),nv=yp(Lm,ev),gv=Lm&ev,xv=gv?Um[nv]:Rp,pv=xv._modify(Yp,hm,wm+ap,Cm,Vm,im,Am);if(xv===pv)return this;var Iv=Bp(Yp,this),Bv=Lm,xy=void 0;if(gv&&Tp(pv)){if(Bv&=~ev,!Bv)return Rp;if(Um.length<=2&&zp(Um[nv^1]))return Um[nv^1];xy=_p(Iv,nv,Um)}else if(!gv&&!Tp(pv)){if(Um.length>=up)return Dp(Yp,Gm,pv,Lm,Um);Bv|=ev,xy=vp(Iv,nv,pv,Um)}else xy=xp(Iv,nv,pv,Um);return Iv?(this.mask=Bv,this.children=xy,this):Pp(Yp,Bv,xy)},Gp=function(Yp,hm,wm,Cm,Vm,im,Am){var Lm=this.size,Um=this.children,Gm=mp(wm,Vm),ev=Um[Gm],nv=(ev||Rp)._modify(Yp,hm,wm+ap,Cm,Vm,im,Am);if(ev===nv)return this;var gv=Bp(Yp,this),xv=void 0;if(Tp(ev)&&!Tp(nv))++Lm,xv=xp(gv,Gm,nv,Um);else if(!Tp(ev)&&Tp(nv)){if(--Lm,Lm<=cp)return Fp(Yp,Lm,Gm,Um);xv=xp(gv,Gm,Rp,Um)}else xv=xp(gv,Gm,nv,Um);return gv?(this.size=Lm,this.children=xv,this):$p(Yp,Lm,xv)};Rp._modify=function(um,Yp,hm,wm,Cm,Vm,im){var Am=wm();return Am===dp?Rp:(++im.value,Mp(um,Cm,Vm,Am))};function Wp(um,Yp,hm,wm,Cm){this._editable=um,this._edit=Yp,this._config=hm,this._root=wm,this._size=Cm}Wp.prototype.setTree=function(um,Yp){return this._editable?(this._root=um,this._size=Yp,this):um===this._root?this:new Wp(this._editable,this._edit,this._config,um,Yp)};var Qp=np.tryGetHash=function(um,Yp,hm,wm){for(var Cm=wm._root,Vm=0,im=wm._config.keyEq;;)switch(Cm.type){case bp:return im(hm,Cm.key)?Cm.value:um;case Ep:{if(Yp===Cm.hash)for(var Am=Cm.children,Lm=0,Um=Am.length;Lm<Um;++Lm){var Gm=Am[Lm];if(im(hm,Gm.key))return Gm.value}return um}case Sp:{var ev=mp(Vm,Yp),nv=gp(ev);if(Cm.mask&nv){Cm=Cm.children[yp(Cm.mask,nv)],Vm+=ap;break}return um}case Ap:{if(Cm=Cm.children[mp(Vm,Yp)],Cm){Vm+=ap;break}return um}default:return um}};Wp.prototype.tryGetHash=function(um,Yp,hm){return Qp(um,Yp,hm,this)};var Xp=np.tryGet=function(um,Yp,hm){return Qp(um,hm._config.hash(Yp),Yp,hm)};Wp.prototype.tryGet=function(um,Yp){return Xp(um,Yp,this)};var rm=np.getHash=function(um,Yp,hm){return Qp(void 0,um,Yp,hm)};Wp.prototype.getHash=function(um,Yp){return rm(um,Yp,this)},np.get=function(um,Yp){return Qp(void 0,Yp._config.hash(um),um,Yp)},Wp.prototype.get=function(um,Yp){return Xp(Yp,um,this)};var Kp=np.has=function(um,Yp,hm){return Qp(dp,um,Yp,hm)!==dp};Wp.prototype.hasHash=function(um,Yp){return Kp(um,Yp,this)};var lm=np.has=function(um,Yp){return Kp(Yp._config.hash(um),um,Yp)};Wp.prototype.has=function(um){return lm(um,this)};var cm=function(Yp,hm){return Yp===hm};np.make=function(um){return new Wp(0,0,{keyEq:um&&um.keyEq||cm,hash:um&&um.hash||fp},Rp,0)},np.empty=np.make();var gm=np.isEmpty=function(um){return um&&!!Tp(um._root)};Wp.prototype.isEmpty=function(){return gm(this)};var Mm=np.modifyHash=function(um,Yp,hm,wm){var Cm={value:wm._size},Vm=wm._root._modify(wm._editable?wm._edit:NaN,wm._config.keyEq,0,um,Yp,hm,Cm);return wm.setTree(Vm,Cm.value)};Wp.prototype.modifyHash=function(um,Yp,hm){return Mm(hm,um,Yp,this)};var dm=np.modify=function(um,Yp,hm){return Mm(um,hm._config.hash(Yp),Yp,hm)};Wp.prototype.modify=function(um,Yp){return dm(Yp,um,this)};var em=np.setHash=function(um,Yp,hm,wm){return Mm(hp(hm),um,Yp,wm)};Wp.prototype.setHash=function(um,Yp,hm){return em(um,Yp,hm,this)};var sm=np.set=function(um,Yp,hm){return em(hm._config.hash(um),um,Yp,hm)};Wp.prototype.set=function(um,Yp){return sm(um,Yp,this)};var Zp=hp(dp),mm=np.removeHash=function(um,Yp,hm){return Mm(Zp,um,Yp,hm)};Wp.prototype.removeHash=Wp.prototype.deleteHash=function(um,Yp){return mm(um,Yp,this)};var fm=np.remove=function(um,Yp){return mm(Yp._config.hash(um),um,Yp)};Wp.prototype.remove=Wp.prototype.delete=function(um){return fm(um,this)};var _m=np.beginMutation=function(um){return new Wp(um._editable+1,um._edit+1,um._config,um._root,um._size)};Wp.prototype.beginMutation=function(){return _m(this)};var zm=np.endMutation=function(um){return um._editable=um._editable&&um._editable-1,um};Wp.prototype.endMutation=function(){return zm(this)};var tm=np.mutate=function(um,Yp){var hm=_m(Yp);return um(hm),zm(hm)};Wp.prototype.mutate=function(um){return tm(um,this)};var Jp=function(Yp){return Yp&&pm(Yp[0],Yp[1],Yp[2],Yp[3],Yp[4])},pm=function(Yp,hm,wm,Cm,Vm){for(;wm<Yp;){var im=hm[wm++];if(im&&!Tp(im))return km(im,Cm,[Yp,hm,wm,Cm,Vm])}return Jp(Vm)},km=function(Yp,hm,wm){switch(Yp.type){case bp:return{value:hm(Yp),rest:wm};case Ep:case Ap:case Sp:var Cm=Yp.children;return pm(Cm.length,Cm,0,hm,wm);default:return Jp(wm)}},ym={done:!0};function Em(um){this.v=um}Em.prototype.next=function(){if(!this.v)return ym;var um=this.v;return this.v=Jp(um.rest),um},Em.prototype[Symbol.iterator]=function(){return this};var Bm=function(Yp,hm){return new Em(km(Yp._root,hm))},Pm=function(Yp){return[Yp.key,Yp.value]},Im=np.entries=function(um){return Bm(um,Pm)};Wp.prototype.entries=Wp.prototype[Symbol.iterator]=function(){return Im(this)};var Dm=function(Yp){return Yp.key},jm=np.keys=function(um){return Bm(um,Dm)};Wp.prototype.keys=function(){return jm(this)};var Fm=function(Yp){return Yp.value},av=np.values=Wp.prototype.values=function(um){return Bm(um,Fm)};Wp.prototype.values=function(){return av(this)};var lv=np.fold=function(um,Yp,hm){var wm=hm._root;if(wm.type===bp)return um(Yp,wm.value,wm.key);for(var Cm=[wm.children],Vm=void 0;Vm=Cm.pop();)for(var im=0,Am=Vm.length;im<Am;){var Lm=Vm[im++];Lm&&Lm.type&&(Lm.type===bp?Yp=um(Yp,Lm.value,Lm.key):Cm.push(Lm.children))}return Yp};Wp.prototype.fold=function(um,Yp){return lv(um,Yp,this)};var tv=np.forEach=function(um,Yp){return lv(function(hm,wm,Cm){return um(wm,Cm,Yp)},null,Yp)};Wp.prototype.forEach=function(um){return tv(um,this)};var Jm=np.count=function(um){return um._size};Wp.prototype.count=function(){return Jm(this)},Object.defineProperty(Wp.prototype,"size",{get:Wp.prototype.count}),rp.exports?rp.exports=np:(void 0).hamt=np});class BuiltInMap{constructor(_d){_defineProperty$1(this,"_map",void 0),this._map=new Map(_d==null?void 0:_d.entries())}keys(){return this._map.keys()}entries(){return this._map.entries()}get(_d){return this._map.get(_d)}has(_d){return this._map.has(_d)}set(_d,np){return this._map.set(_d,np),this}delete(_d){return this._map.delete(_d),this}clone(){return persistentMap(this)}toMap(){return new Map(this._map)}}class HashArrayMappedTrieMap{constructor(_d){if(_defineProperty$1(this,"_hamt",hamt_1.empty.beginMutation()),_d instanceof HashArrayMappedTrieMap){const np=_d._hamt.endMutation();_d._hamt=np.beginMutation(),this._hamt=np.beginMutation()}else if(_d)for(const[np,ap]of _d.entries())this._hamt.set(np,ap)}keys(){return this._hamt.keys()}entries(){return this._hamt.entries()}get(_d){return this._hamt.get(_d)}has(_d){return this._hamt.has(_d)}set(_d,np){return this._hamt.set(_d,np),this}delete(_d){return this._hamt.delete(_d),this}clone(){return persistentMap(this)}toMap(){return new Map(this._hamt)}}function persistentMap(rp){return Recoil_gkx("recoil_hamt_2020")?new HashArrayMappedTrieMap(rp):new BuiltInMap(rp)}var Recoil_PersistentMap={persistentMap},Recoil_PersistentMap_1=Recoil_PersistentMap.persistentMap,Recoil_PersistentMap$1=Object.freeze({__proto__:null,persistentMap:Recoil_PersistentMap_1});function differenceSets(rp,..._d){const np=new Set;e:for(const ap of rp){for(const sp of _d)if(sp.has(ap))continue e;np.add(ap)}return np}var Recoil_differenceSets=differenceSets;function mapMap(rp,_d){const np=new Map;return rp.forEach((ap,sp)=>{np.set(sp,_d(ap,sp))}),np}var Recoil_mapMap=mapMap;function makeGraph(){return{nodeDeps:new Map,nodeToNodeSubscriptions:new Map}}function cloneGraph(rp){return{nodeDeps:Recoil_mapMap(rp.nodeDeps,_d=>new Set(_d)),nodeToNodeSubscriptions:Recoil_mapMap(rp.nodeToNodeSubscriptions,_d=>new Set(_d))}}function mergeDepsIntoGraph(rp,_d,np,ap){const{nodeDeps:sp,nodeToNodeSubscriptions:lp}=np,up=sp.get(rp);if(up&&ap&&up!==ap.nodeDeps.get(rp))return;sp.set(rp,_d);const cp=up==null?_d:Recoil_differenceSets(_d,up);for(const dp of cp)lp.has(dp)||lp.set(dp,new Set),Recoil_nullthrows(lp.get(dp)).add(rp);if(up){const dp=Recoil_differenceSets(up,_d);for(const hp of dp){if(!lp.has(hp))return;const fp=Recoil_nullthrows(lp.get(hp));fp.delete(rp),fp.size===0&&lp.delete(hp)}}}function saveDepsToStore(rp,_d,np,ap){var sp,lp,up,cp;const dp=np.getState();ap===dp.currentTree.version||ap===((sp=dp.nextTree)===null||sp===void 0?void 0:sp.version)||((lp=dp.previousTree)===null||lp===void 0||lp.version);const hp=np.getGraph(ap);if(mergeDepsIntoGraph(rp,_d,hp),ap===((up=dp.previousTree)===null||up===void 0?void 0:up.version)){const pp=np.getGraph(dp.currentTree.version);mergeDepsIntoGraph(rp,_d,pp,hp)}if(ap===((cp=dp.previousTree)===null||cp===void 0?void 0:cp.version)||ap===dp.currentTree.version){var fp;const pp=(fp=dp.nextTree)===null||fp===void 0?void 0:fp.version;if(pp!==void 0){const mp=np.getGraph(pp);mergeDepsIntoGraph(rp,_d,mp,hp)}}}var Recoil_Graph={cloneGraph,graph:makeGraph,saveDepsToStore};let nextTreeStateVersion=0;const getNextTreeStateVersion=()=>nextTreeStateVersion++;let nextStoreID=0;const getNextStoreID=()=>nextStoreID++;let nextComponentID=0;const getNextComponentID=()=>nextComponentID++;var Recoil_Keys={getNextTreeStateVersion,getNextStoreID,getNextComponentID};const{persistentMap:persistentMap$1}=Recoil_PersistentMap$1,{graph}=Recoil_Graph,{getNextTreeStateVersion:getNextTreeStateVersion$1}=Recoil_Keys;function makeEmptyTreeState(){const rp=getNextTreeStateVersion$1();return{version:rp,stateID:rp,transactionMetadata:{},dirtyAtoms:new Set,atomValues:persistentMap$1(),nonvalidatedAtoms:persistentMap$1()}}function makeEmptyStoreState(){const rp=makeEmptyTreeState();return{currentTree:rp,nextTree:null,previousTree:null,commitDepth:0,knownAtoms:new Set,knownSelectors:new Set,transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(rp.version,graph()),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}}var Recoil_State={makeEmptyTreeState,makeEmptyStoreState,getNextTreeStateVersion:getNextTreeStateVersion$1};class RetentionZone{}function retentionZone(){return new RetentionZone}var Recoil_RetentionZone={RetentionZone,retentionZone};function setByAddingToSet(rp,_d){const np=new Set(rp);return np.add(_d),np}function setByDeletingFromSet(rp,_d){const np=new Set(rp);return np.delete(_d),np}function mapBySettingInMap(rp,_d,np){const ap=new Map(rp);return ap.set(_d,np),ap}function mapByUpdatingInMap(rp,_d,np){const ap=new Map(rp);return ap.set(_d,np(ap.get(_d))),ap}function mapByDeletingFromMap(rp,_d){const np=new Map(rp);return np.delete(_d),np}function mapByDeletingMultipleFromMap(rp,_d){const np=new Map(rp);return _d.forEach(ap=>np.delete(ap)),np}var Recoil_CopyOnWrite={setByAddingToSet,setByDeletingFromSet,mapBySettingInMap,mapByUpdatingInMap,mapByDeletingFromMap,mapByDeletingMultipleFromMap};function*filterIterable(rp,_d){let np=0;for(const ap of rp)_d(ap,np++)&&(yield ap)}var Recoil_filterIterable=filterIterable;function lazyProxy(rp,_d){return new Proxy(rp,{get:(ap,sp)=>(!(sp in ap)&&sp in _d&&(ap[sp]=_d[sp]()),ap[sp]),ownKeys:ap=>Object.keys(ap)})}var Recoil_lazyProxy=lazyProxy;const{getNode:getNode$1,getNodeMaybe:getNodeMaybe$1,recoilValuesForKeys:recoilValuesForKeys$1}=Recoil_Node,{RetentionZone:RetentionZone$1}=Recoil_RetentionZone,{setByAddingToSet:setByAddingToSet$1}=Recoil_CopyOnWrite,emptySet=Object.freeze(new Set);class ReadOnlyRecoilValueError extends Error{}function initializeRetentionForNode(rp,_d,np){if(!Recoil_gkx("recoil_memory_managament_2020"))return()=>{};const{nodesRetainedByZone:ap}=rp.getState().retention;function sp(lp){let up=ap.get(lp);up||ap.set(lp,up=new Set),up.add(_d)}if(np instanceof RetentionZone$1)sp(np);else if(Array.isArray(np))for(const lp of np)sp(lp);return()=>{if(!Recoil_gkx("recoil_memory_managament_2020"))return;const{retention:lp}=rp.getState();function up(cp){const dp=lp.nodesRetainedByZone.get(cp);dp==null||dp.delete(_d),dp&&dp.size===0&&lp.nodesRetainedByZone.delete(cp)}if(np instanceof RetentionZone$1)up(np);else if(Array.isArray(np))for(const cp of np)up(cp)}}function initializeNodeIfNewToStore(rp,_d,np,ap){const sp=rp.getState();if(sp.nodeCleanupFunctions.has(np))return;const lp=getNode$1(np),up=initializeRetentionForNode(rp,np,lp.retainedBy),cp=lp.init(rp,_d,ap);sp.nodeCleanupFunctions.set(np,()=>{cp(),up()})}function initializeNode(rp,_d,np){initializeNodeIfNewToStore(rp,rp.getState().currentTree,_d,np)}function cleanUpNode(rp,_d){var np;const ap=rp.getState();(np=ap.nodeCleanupFunctions.get(_d))===null||np===void 0||np(),ap.nodeCleanupFunctions.delete(_d)}function getNodeLoadable(rp,_d,np){return initializeNodeIfNewToStore(rp,_d,np,"get"),getNode$1(np).get(rp,_d)}function peekNodeLoadable(rp,_d,np){return getNode$1(np).peek(rp,_d)}function setUnvalidatedAtomValue_DEPRECATED(rp,_d,np){var ap;const sp=getNodeMaybe$1(_d);return sp==null||(ap=sp.invalidate)===null||ap===void 0||ap.call(sp,rp),{...rp,atomValues:rp.atomValues.clone().delete(_d),nonvalidatedAtoms:rp.nonvalidatedAtoms.clone().set(_d,np),dirtyAtoms:setByAddingToSet$1(rp.dirtyAtoms,_d)}}function setNodeValue(rp,_d,np,ap){const sp=getNode$1(np);if(sp.set==null)throw new ReadOnlyRecoilValueError(`Attempt to set read-only RecoilValue: ${np}`);const lp=sp.set;return initializeNodeIfNewToStore(rp,_d,np,"set"),lp(rp,_d,ap)}function peekNodeInfo(rp,_d,np){const ap=rp.getState(),sp=rp.getGraph(_d.version),lp=getNode$1(np).nodeType;return Recoil_lazyProxy({type:lp},{loadable:()=>peekNodeLoadable(rp,_d,np),isActive:()=>ap.knownAtoms.has(np)||ap.knownSelectors.has(np),isSet:()=>lp==="selector"?!1:_d.atomValues.has(np),isModified:()=>_d.dirtyAtoms.has(np),deps:()=>{var up;return recoilValuesForKeys$1((up=sp.nodeDeps.get(np))!==null&&up!==void 0?up:[])},subscribers:()=>{var up,cp;return{nodes:recoilValuesForKeys$1(Recoil_filterIterable(getDownstreamNodes(rp,_d,new Set([np])),dp=>dp!==np)),components:Recoil_mapIterable((up=(cp=ap.nodeToComponentSubscriptions.get(np))===null||cp===void 0?void 0:cp.values())!==null&&up!==void 0?up:[],([dp])=>({name:dp}))}}})}function getDownstreamNodes(rp,_d,np){const ap=new Set,sp=Array.from(np),lp=rp.getGraph(_d.version);for(let cp=sp.pop();cp;cp=sp.pop()){var up;ap.add(cp);const dp=(up=lp.nodeToNodeSubscriptions.get(cp))!==null&&up!==void 0?up:emptySet;for(const hp of dp)ap.has(hp)||sp.push(hp)}return ap}var Recoil_FunctionalCore={getNodeLoadable,peekNodeLoadable,setNodeValue,initializeNode,cleanUpNode,setUnvalidatedAtomValue_DEPRECATED,peekNodeInfo,getDownstreamNodes};let _invalidateMemoizedSnapshot=null;function setInvalidateMemoizedSnapshot(rp){_invalidateMemoizedSnapshot=rp}function invalidateMemoizedSnapshot(){var rp;(rp=_invalidateMemoizedSnapshot)===null||rp===void 0||rp()}var Recoil_SnapshotCache={setInvalidateMemoizedSnapshot,invalidateMemoizedSnapshot};const{getDownstreamNodes:getDownstreamNodes$1,getNodeLoadable:getNodeLoadable$1,setNodeValue:setNodeValue$1}=Recoil_FunctionalCore,{getNextComponentID:getNextComponentID$1}=Recoil_Keys,{getNode:getNode$2,getNodeMaybe:getNodeMaybe$2}=Recoil_Node,{DefaultValue:DefaultValue$1}=Recoil_Node,{reactMode:reactMode$1}=Recoil_ReactMode,{AbstractRecoilValue:AbstractRecoilValue$1,RecoilState:RecoilState$1,RecoilValueReadOnly:RecoilValueReadOnly$1,isRecoilValue:isRecoilValue$1}=Recoil_RecoilValue$1,{invalidateMemoizedSnapshot:invalidateMemoizedSnapshot$1}=Recoil_SnapshotCache;function getRecoilValueAsLoadable(rp,{key:_d},np=rp.getState().currentTree){var ap,sp;const lp=rp.getState();np.version===lp.currentTree.version||np.version===((ap=lp.nextTree)===null||ap===void 0?void 0:ap.version)||(np.version,(sp=lp.previousTree)===null||sp===void 0||sp.version);const up=getNodeLoadable$1(rp,np,_d);return up.state==="loading"&&up.contents.catch(()=>{}),up}function applyAtomValueWrites(rp,_d){const np=rp.clone();return _d.forEach((ap,sp)=>{ap.state==="hasValue"&&ap.contents instanceof DefaultValue$1?np.delete(sp):np.set(sp,ap)}),np}function valueFromValueOrUpdater(rp,_d,{key:np},ap){if(typeof ap=="function"){const sp=getNodeLoadable$1(rp,_d,np);if(sp.state==="loading"){const lp=`Tried to set atom or selector "${np}" using an updater function while the current state is pending, this is not currently supported.`;throw Recoil_err(lp)}else if(sp.state==="hasError")throw sp.contents;return ap(sp.contents)}else return ap}function applyAction(rp,_d,np){if(np.type==="set"){const{recoilValue:sp,valueOrUpdater:lp}=np,up=valueFromValueOrUpdater(rp,_d,sp,lp),cp=setNodeValue$1(rp,_d,sp.key,up);for(const[dp,hp]of cp.entries())writeLoadableToTreeState(_d,dp,hp)}else if(np.type==="setLoadable"){const{recoilValue:{key:sp},loadable:lp}=np;writeLoadableToTreeState(_d,sp,lp)}else if(np.type==="markModified"){const{recoilValue:{key:sp}}=np;_d.dirtyAtoms.add(sp)}else if(np.type==="setUnvalidated"){var ap;const{recoilValue:{key:sp},unvalidatedValue:lp}=np,up=getNodeMaybe$2(sp);up==null||(ap=up.invalidate)===null||ap===void 0||ap.call(up,_d),_d.atomValues.delete(sp),_d.nonvalidatedAtoms.set(sp,lp),_d.dirtyAtoms.add(sp)}else Recoil_recoverableViolation(`Unknown action ${np.type}`)}function writeLoadableToTreeState(rp,_d,np){np.state==="hasValue"&&np.contents instanceof DefaultValue$1?rp.atomValues.delete(_d):rp.atomValues.set(_d,np),rp.dirtyAtoms.add(_d),rp.nonvalidatedAtoms.delete(_d)}function applyActionsToStore(rp,_d){rp.replaceState(np=>{const ap=copyTreeState(np);for(const sp of _d)applyAction(rp,ap,sp);return invalidateDownstreams(rp,ap),invalidateMemoizedSnapshot$1(),ap})}function queueOrPerformStateUpdate(rp,_d){if(batchStack.length){const np=batchStack[batchStack.length-1];let ap=np.get(rp);ap||np.set(rp,ap=[]),ap.push(_d)}else applyActionsToStore(rp,[_d])}const batchStack=[];function batchStart(){const rp=new Map;return batchStack.push(rp),()=>{for(const[_d,np]of rp)applyActionsToStore(_d,np);batchStack.pop()}}function copyTreeState(rp){return{...rp,atomValues:rp.atomValues.clone(),nonvalidatedAtoms:rp.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(rp.dirtyAtoms)}}function invalidateDownstreams(rp,_d){const np=getDownstreamNodes$1(rp,_d,_d.dirtyAtoms);for(const lp of np){var ap,sp;(ap=getNodeMaybe$2(lp))===null||ap===void 0||(sp=ap.invalidate)===null||sp===void 0||sp.call(ap,_d)}}function setRecoilValue(rp,_d,np){queueOrPerformStateUpdate(rp,{type:"set",recoilValue:_d,valueOrUpdater:np})}function setRecoilValueLoadable(rp,_d,np){if(np instanceof DefaultValue$1)return setRecoilValue(rp,_d,np);queueOrPerformStateUpdate(rp,{type:"setLoadable",recoilValue:_d,loadable:np})}function markRecoilValueModified(rp,_d){queueOrPerformStateUpdate(rp,{type:"markModified",recoilValue:_d})}function setUnvalidatedRecoilValue(rp,_d,np){queueOrPerformStateUpdate(rp,{type:"setUnvalidated",recoilValue:_d,unvalidatedValue:np})}function subscribeToRecoilValue(rp,{key:_d},np,ap=null){const sp=getNextComponentID$1(),lp=rp.getState();lp.nodeToComponentSubscriptions.has(_d)||lp.nodeToComponentSubscriptions.set(_d,new Map),Recoil_nullthrows(lp.nodeToComponentSubscriptions.get(_d)).set(sp,[ap??"<not captured>",np]);const up=reactMode$1();if(up.early&&(up.mode==="LEGACY"||up.mode==="MUTABLE_SOURCE")){const cp=rp.getState().nextTree;cp&&cp.dirtyAtoms.has(_d)&&np(cp)}return{release:()=>{const cp=rp.getState(),dp=cp.nodeToComponentSubscriptions.get(_d);dp===void 0||!dp.has(sp)||(dp.delete(sp),dp.size===0&&cp.nodeToComponentSubscriptions.delete(_d))}}}function refreshRecoilValue(rp,_d){var np;const{currentTree:ap}=rp.getState(),sp=getNode$2(_d.key);(np=sp.clearCache)===null||np===void 0||np.call(sp,rp,ap)}var Recoil_RecoilValueInterface={RecoilValueReadOnly:RecoilValueReadOnly$1,AbstractRecoilValue:AbstractRecoilValue$1,RecoilState:RecoilState$1,getRecoilValueAsLoadable,setRecoilValue,setRecoilValueLoadable,markRecoilValueModified,setUnvalidatedRecoilValue,subscribeToRecoilValue,isRecoilValue:isRecoilValue$1,applyAtomValueWrites,batchStart,writeLoadableToTreeState,invalidateDownstreams,copyTreeState,refreshRecoilValue};function someSet(rp,_d,np){const ap=rp.entries();let sp=ap.next();for(;!sp.done;){const lp=sp.value;if(_d.call(np,lp[1],lp[0],rp))return!0;sp=ap.next()}return!1}var Recoil_someSet=someSet;const{cleanUpNode:cleanUpNode$1}=Recoil_FunctionalCore,{deleteNodeConfigIfPossible:deleteNodeConfigIfPossible$1,getNode:getNode$3}=Recoil_Node,{RetentionZone:RetentionZone$2}=Recoil_RetentionZone,SUSPENSE_TIMEOUT_MS=12e4,emptySet$1=new Set;function releaseRetainablesNowOnCurrentTree(rp,_d){const np=rp.getState(),ap=np.currentTree;if(np.nextTree)return;const sp=new Set;for(const up of _d)if(up instanceof RetentionZone$2)for(const cp of nodesRetainedByZone(np,up))sp.add(cp);else sp.add(up);const lp=findReleasableNodes(rp,sp);for(const up of lp)releaseNode(rp,ap,up)}function findReleasableNodes(rp,_d){const np=rp.getState(),ap=np.currentTree,sp=rp.getGraph(ap.version),lp=new Set,up=new Set;return cp(_d),lp;function cp(dp){const hp=new Set,fp=getDownstreamNodesInTopologicalOrder(rp,ap,dp,lp,up);for(const yp of fp){var pp;if(getNode$3(yp).retainedBy==="recoilRoot"){up.add(yp);continue}if(((pp=np.retention.referenceCounts.get(yp))!==null&&pp!==void 0?pp:0)>0){up.add(yp);continue}if(zonesThatCouldRetainNode(yp).some(_p=>np.retention.referenceCounts.get(_p))){up.add(yp);continue}const xp=sp.nodeToNodeSubscriptions.get(yp);if(xp&&Recoil_someSet(xp,_p=>up.has(_p))){up.add(yp);continue}lp.add(yp),hp.add(yp)}const mp=new Set;for(const yp of hp)for(const xp of(gp=sp.nodeDeps.get(yp))!==null&&gp!==void 0?gp:emptySet$1){var gp;lp.has(xp)||mp.add(xp)}mp.size&&cp(mp)}}function getDownstreamNodesInTopologicalOrder(rp,_d,np,ap,sp){const lp=rp.getGraph(_d.version),up=[],cp=new Set;for(;np.size>0;)dp(Recoil_nullthrows(np.values().next().value));return up;function dp(hp){if(ap.has(hp)||sp.has(hp)){np.delete(hp);return}if(cp.has(hp))return;const fp=lp.nodeToNodeSubscriptions.get(hp);if(fp)for(const pp of fp)dp(pp);cp.add(hp),np.delete(hp),up.push(hp)}}function releaseNode(rp,_d,np){if(!Recoil_gkx("recoil_memory_managament_2020"))return;cleanUpNode$1(rp,np);const ap=rp.getState();ap.knownAtoms.delete(np),ap.knownSelectors.delete(np),ap.nodeTransactionSubscriptions.delete(np),ap.retention.referenceCounts.delete(np);const sp=zonesThatCouldRetainNode(np);for(const dp of sp){var lp;(lp=ap.retention.nodesRetainedByZone.get(dp))===null||lp===void 0||lp.delete(np)}_d.atomValues.delete(np),_d.dirtyAtoms.delete(np),_d.nonvalidatedAtoms.delete(np);const up=ap.graphsByVersion.get(_d.version);if(up){const dp=up.nodeDeps.get(np);if(dp!==void 0){up.nodeDeps.delete(np);for(const hp of dp){var cp;(cp=up.nodeToNodeSubscriptions.get(hp))===null||cp===void 0||cp.delete(np)}}up.nodeToNodeSubscriptions.delete(np)}deleteNodeConfigIfPossible$1(np)}function nodesRetainedByZone(rp,_d){var np;return(np=rp.retention.nodesRetainedByZone.get(_d))!==null&&np!==void 0?np:emptySet$1}function zonesThatCouldRetainNode(rp){const _d=getNode$3(rp).retainedBy;return _d===void 0||_d==="components"||_d==="recoilRoot"?[]:_d instanceof RetentionZone$2?[_d]:_d}function scheduleOrPerformPossibleReleaseOfRetainable(rp,_d){const np=rp.getState();np.nextTree?np.retention.retainablesToCheckForRelease.add(_d):releaseRetainablesNowOnCurrentTree(rp,new Set([_d]))}function updateRetainCount(rp,_d,np){var ap;if(!Recoil_gkx("recoil_memory_managament_2020"))return;const sp=rp.getState().retention.referenceCounts,lp=((ap=sp.get(_d))!==null&&ap!==void 0?ap:0)+np;lp===0?updateRetainCountToZero(rp,_d):sp.set(_d,lp)}function updateRetainCountToZero(rp,_d){if(!Recoil_gkx("recoil_memory_managament_2020"))return;rp.getState().retention.referenceCounts.delete(_d),scheduleOrPerformPossibleReleaseOfRetainable(rp,_d)}function releaseScheduledRetainablesNow(rp){if(!Recoil_gkx("recoil_memory_managament_2020"))return;const _d=rp.getState();releaseRetainablesNowOnCurrentTree(rp,_d.retention.retainablesToCheckForRelease),_d.retention.retainablesToCheckForRelease.clear()}function retainedByOptionWithDefault(rp){return rp===void 0?"recoilRoot":rp}var Recoil_Retention={SUSPENSE_TIMEOUT_MS,updateRetainCount,updateRetainCountToZero,releaseScheduledRetainablesNow,retainedByOptionWithDefault};const{unstable_batchedUpdates}=ReactDOM;var ReactBatchedUpdates={unstable_batchedUpdates};const{unstable_batchedUpdates:unstable_batchedUpdates$1}=ReactBatchedUpdates;var Recoil_ReactBatchedUpdates={unstable_batchedUpdates:unstable_batchedUpdates$1};const{batchStart:batchStart$1}=Recoil_RecoilValueInterface,{unstable_batchedUpdates:unstable_batchedUpdates$2}=Recoil_ReactBatchedUpdates;let batcher=unstable_batchedUpdates$2||(rp=>rp());const setBatcher=rp=>{batcher=rp},getBatcher=()=>batcher,batchUpdates=rp=>{batcher(()=>{let _d=()=>{};try{_d=batchStart$1(),rp()}finally{_d()}})};var Recoil_Batching={getBatcher,setBatcher,batchUpdates};function*concatIterables(rp){for(const _d of rp)for(const np of _d)yield np}var Recoil_concatIterables=concatIterables;const isSSR$1=typeof Window>"u"||typeof window>"u",isWindow=rp=>!isSSR$1&&(rp===window||rp instanceof Window),isReactNative=typeof navigator<"u"&&navigator.product==="ReactNative";var Recoil_Environment={isSSR:isSSR$1,isReactNative,isWindow};function memoizeWithArgsHash(rp,_d){let np;return(...ap)=>{np||(np={});const sp=_d(...ap);return Object.hasOwnProperty.call(np,sp)||(np[sp]=rp(...ap)),np[sp]}}function memoizeOneWithArgsHash(rp,_d){let np,ap;return(...sp)=>{const lp=_d(...sp);return np===lp||(np=lp,ap=rp(...sp)),ap}}function memoizeOneWithArgsHashAndInvalidation(rp,_d){let np,ap;return[(...up)=>{const cp=_d(...up);return np===cp||(np=cp,ap=rp(...up)),ap},()=>{np=null}]}var Recoil_Memoize={memoizeWithArgsHash,memoizeOneWithArgsHash,memoizeOneWithArgsHashAndInvalidation};const{batchUpdates:batchUpdates$1}=Recoil_Batching,{initializeNode:initializeNode$1,peekNodeInfo:peekNodeInfo$1}=Recoil_FunctionalCore,{graph:graph$1}=Recoil_Graph,{getNextStoreID:getNextStoreID$1}=Recoil_Keys,{DEFAULT_VALUE:DEFAULT_VALUE$1,recoilValues:recoilValues$1,recoilValuesForKeys:recoilValuesForKeys$2}=Recoil_Node,{AbstractRecoilValue:AbstractRecoilValue$2,getRecoilValueAsLoadable:getRecoilValueAsLoadable$1,setRecoilValue:setRecoilValue$1,setUnvalidatedRecoilValue:setUnvalidatedRecoilValue$1}=Recoil_RecoilValueInterface,{updateRetainCount:updateRetainCount$1}=Recoil_Retention,{setInvalidateMemoizedSnapshot:setInvalidateMemoizedSnapshot$1}=Recoil_SnapshotCache,{getNextTreeStateVersion:getNextTreeStateVersion$2,makeEmptyStoreState:makeEmptyStoreState$1}=Recoil_State,{isSSR:isSSR$1$1}=Recoil_Environment,{memoizeOneWithArgsHashAndInvalidation:memoizeOneWithArgsHashAndInvalidation$1}=Recoil_Memoize;class Snapshot{constructor(_d,np){_defineProperty$1(this,"_store",void 0),_defineProperty$1(this,"_refCount",1),_defineProperty$1(this,"getLoadable",ap=>(this.checkRefCount_INTERNAL(),getRecoilValueAsLoadable$1(this._store,ap))),_defineProperty$1(this,"getPromise",ap=>(this.checkRefCount_INTERNAL(),this.getLoadable(ap).toPromise())),_defineProperty$1(this,"getNodes_UNSTABLE",ap=>{if(this.checkRefCount_INTERNAL(),(ap==null?void 0:ap.isModified)===!0){if((ap==null?void 0:ap.isInitialized)===!1)return[];const up=this._store.getState().currentTree;return recoilValuesForKeys$2(up.dirtyAtoms)}const sp=this._store.getState().knownAtoms,lp=this._store.getState().knownSelectors;return(ap==null?void 0:ap.isInitialized)==null?recoilValues$1.values():ap.isInitialized===!0?recoilValuesForKeys$2(Recoil_concatIterables([sp,lp])):Recoil_filterIterable(recoilValues$1.values(),({key:up})=>!sp.has(up)&&!lp.has(up))}),_defineProperty$1(this,"getInfo_UNSTABLE",({key:ap})=>(this.checkRefCount_INTERNAL(),peekNodeInfo$1(this._store,this._store.getState().currentTree,ap))),_defineProperty$1(this,"map",ap=>{this.checkRefCount_INTERNAL();const sp=new MutableSnapshot(this,batchUpdates$1);return ap(sp),sp}),_defineProperty$1(this,"asyncMap",async ap=>{this.checkRefCount_INTERNAL();const sp=new MutableSnapshot(this,batchUpdates$1);return sp.retain(),await ap(sp),sp.autoRelease_INTERNAL(),sp}),this._store={storeID:getNextStoreID$1(),parentStoreID:np,getState:()=>_d,replaceState:ap=>{_d.currentTree=ap(_d.currentTree)},getGraph:ap=>{const sp=_d.graphsByVersion;if(sp.has(ap))return Recoil_nullthrows(sp.get(ap));const lp=graph$1();return sp.set(ap,lp),lp},subscribeToTransactions:()=>({release:()=>{}}),addTransactionMetadata:()=>{throw Recoil_err("Cannot subscribe to Snapshots")}};for(const ap of this._store.getState().knownAtoms)initializeNode$1(this._store,ap,"get"),updateRetainCount$1(this._store,ap,1);this.autoRelease_INTERNAL()}retain(){this._refCount<=0,this._refCount++;let _d=!1;return()=>{_d||(_d=!0,this._release())}}autoRelease_INTERNAL(){isSSR$1$1||window.setTimeout(()=>this._release(),10)}_release(){if(this._refCount--,this._refCount===0){if(this._store.getState().nodeCleanupFunctions.forEach(_d=>_d()),this._store.getState().nodeCleanupFunctions.clear(),!Recoil_gkx("recoil_memory_managament_2020"))return}else this._refCount<0}isRetained(){return this._refCount>0}checkRefCount_INTERNAL(){Recoil_gkx("recoil_memory_managament_2020")&&this._refCount<=0}getStore_INTERNAL(){return this.checkRefCount_INTERNAL(),this._store}getID(){return this.checkRefCount_INTERNAL(),this._store.getState().currentTree.stateID}getStoreID(){return this.checkRefCount_INTERNAL(),this._store.storeID}}function cloneStoreState(rp,_d,np=!1){const ap=rp.getState(),sp=np?getNextTreeStateVersion$2():_d.version;return{currentTree:{version:np?sp:_d.version,stateID:np?sp:_d.stateID,transactionMetadata:{..._d.transactionMetadata},dirtyAtoms:new Set(_d.dirtyAtoms),atomValues:_d.atomValues.clone(),nonvalidatedAtoms:_d.nonvalidatedAtoms.clone()},commitDepth:0,nextTree:null,previousTree:null,knownAtoms:new Set(ap.knownAtoms),knownSelectors:new Set(ap.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(sp,rp.getGraph(_d.version)),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map(Recoil_mapIterable(ap.nodeCleanupFunctions.entries(),([lp])=>[lp,()=>{}]))}}function freshSnapshot(rp){const _d=new Snapshot(makeEmptyStoreState$1());return rp!=null?_d.map(rp):_d}const[memoizedCloneSnapshot,invalidateMemoizedSnapshot$2]=memoizeOneWithArgsHashAndInvalidation$1((rp,_d)=>{var np;const ap=rp.getState(),sp=_d==="latest"?(np=ap.nextTree)!==null&&np!==void 0?np:ap.currentTree:Recoil_nullthrows(ap.previousTree);return new Snapshot(cloneStoreState(rp,sp),rp.storeID)},(rp,_d)=>{var np,ap;return String(_d)+String(rp.storeID)+String((np=rp.getState().nextTree)===null||np===void 0?void 0:np.version)+String(rp.getState().currentTree.version)+String((ap=rp.getState().previousTree)===null||ap===void 0?void 0:ap.version)});setInvalidateMemoizedSnapshot$1(invalidateMemoizedSnapshot$2);function cloneSnapshot(rp,_d="latest"){const np=memoizedCloneSnapshot(rp,_d);return np.isRetained()?np:(invalidateMemoizedSnapshot$2(),memoizedCloneSnapshot(rp,_d))}class MutableSnapshot extends Snapshot{constructor(_d,np){super(cloneStoreState(_d.getStore_INTERNAL(),_d.getStore_INTERNAL().getState().currentTree,!0),_d.getStoreID()),_defineProperty$1(this,"_batch",void 0),_defineProperty$1(this,"set",(ap,sp)=>{this.checkRefCount_INTERNAL();const lp=this.getStore_INTERNAL();this._batch(()=>{updateRetainCount$1(lp,ap.key,1),setRecoilValue$1(this.getStore_INTERNAL(),ap,sp)})}),_defineProperty$1(this,"reset",ap=>{this.checkRefCount_INTERNAL();const sp=this.getStore_INTERNAL();this._batch(()=>{updateRetainCount$1(sp,ap.key,1),setRecoilValue$1(this.getStore_INTERNAL(),ap,DEFAULT_VALUE$1)})}),_defineProperty$1(this,"setUnvalidatedAtomValues_DEPRECATED",ap=>{this.checkRefCount_INTERNAL();const sp=this.getStore_INTERNAL();batchUpdates$1(()=>{for(const[lp,up]of ap.entries())updateRetainCount$1(sp,lp,1),setUnvalidatedRecoilValue$1(sp,new AbstractRecoilValue$2(lp),up)})}),this._batch=np}}var Recoil_Snapshot={Snapshot,MutableSnapshot,freshSnapshot,cloneSnapshot},Recoil_Snapshot_1=Recoil_Snapshot.Snapshot,Recoil_Snapshot_2=Recoil_Snapshot.MutableSnapshot,Recoil_Snapshot_3=Recoil_Snapshot.freshSnapshot,Recoil_Snapshot_4=Recoil_Snapshot.cloneSnapshot,Recoil_Snapshot$1=Object.freeze({__proto__:null,Snapshot:Recoil_Snapshot_1,MutableSnapshot:Recoil_Snapshot_2,freshSnapshot:Recoil_Snapshot_3,cloneSnapshot:Recoil_Snapshot_4});function unionSets(...rp){const _d=new Set;for(const np of rp)for(const ap of np)_d.add(ap);return _d}var Recoil_unionSets=unionSets;const{useRef}=React;function useRefInitOnce(rp){const _d=useRef(rp);return _d.current===rp&&typeof rp=="function"&&(_d.current=rp()),_d}var Recoil_useRefInitOnce=useRefInitOnce;const{getNextTreeStateVersion:getNextTreeStateVersion$3,makeEmptyStoreState:makeEmptyStoreState$2}=Recoil_State,{cleanUpNode:cleanUpNode$2,getDownstreamNodes:getDownstreamNodes$2,initializeNode:initializeNode$2,setNodeValue:setNodeValue$2,setUnvalidatedAtomValue_DEPRECATED:setUnvalidatedAtomValue_DEPRECATED$1}=Recoil_FunctionalCore,{graph:graph$2}=Recoil_Graph,{cloneGraph:cloneGraph$1}=Recoil_Graph,{getNextStoreID:getNextStoreID$2}=Recoil_Keys,{createMutableSource:createMutableSource$1,reactMode:reactMode$2}=Recoil_ReactMode,{applyAtomValueWrites:applyAtomValueWrites$1}=Recoil_RecoilValueInterface,{releaseScheduledRetainablesNow:releaseScheduledRetainablesNow$1}=Recoil_Retention,{freshSnapshot:freshSnapshot$1}=Recoil_Snapshot$1,{useCallback,useContext,useEffect,useMemo,useRef:useRef$1,useState}=React;function notInAContext(){throw Recoil_err("This component must be used inside a <RecoilRoot> component.")}const defaultStore=Object.freeze({storeID:getNextStoreID$2(),getState:notInAContext,replaceState:notInAContext,getGraph:notInAContext,subscribeToTransactions:notInAContext,addTransactionMetadata:notInAContext});let stateReplacerIsBeingExecuted=!1;function startNextTreeIfNeeded(rp){if(stateReplacerIsBeingExecuted)throw Recoil_err("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");const _d=rp.getState();if(_d.nextTree===null){Recoil_gkx("recoil_memory_managament_2020")&&Recoil_gkx("recoil_release_on_cascading_update_killswitch_2021")&&_d.commitDepth>0&&releaseScheduledRetainablesNow$1(rp);const np=_d.currentTree.version,ap=getNextTreeStateVersion$3();_d.nextTree={..._d.currentTree,version:ap,stateID:ap,dirtyAtoms:new Set,transactionMetadata:{}},_d.graphsByVersion.set(ap,cloneGraph$1(Recoil_nullthrows(_d.graphsByVersion.get(np))))}}const AppContext=React.createContext({current:defaultStore}),useStoreRef=()=>useContext(AppContext),MutableSourceContext=React.createContext(null);function useRecoilMutableSource(){return useContext(MutableSourceContext)}function notifyComponents(rp,_d,np){const ap=getDownstreamNodes$2(rp,np,np.dirtyAtoms);for(const sp of ap){const lp=_d.nodeToComponentSubscriptions.get(sp);if(lp)for(const[up,[cp,dp]]of lp)dp(np)}}function sendEndOfBatchNotifications(rp){const _d=rp.getState(),np=_d.currentTree,ap=np.dirtyAtoms;if(ap.size){for(const[sp,lp]of _d.nodeTransactionSubscriptions)if(ap.has(sp))for(const[up,cp]of lp)cp(rp);for(const[sp,lp]of _d.transactionSubscriptions)lp(rp);(!reactMode$2().early||_d.suspendedComponentResolvers.size>0)&&(notifyComponents(rp,_d,np),_d.suspendedComponentResolvers.forEach(sp=>sp()),_d.suspendedComponentResolvers.clear())}_d.queuedComponentCallbacks_DEPRECATED.forEach(sp=>sp(np)),_d.queuedComponentCallbacks_DEPRECATED.splice(0,_d.queuedComponentCallbacks_DEPRECATED.length)}function endBatch(rp){const _d=rp.getState();_d.commitDepth++;try{const{nextTree:np}=_d;if(np==null)return;_d.previousTree=_d.currentTree,_d.currentTree=np,_d.nextTree=null,sendEndOfBatchNotifications(rp),_d.previousTree!=null?_d.graphsByVersion.delete(_d.previousTree.version):Recoil_recoverableViolation("Ended batch with no previous state, which is unexpected","recoil"),_d.previousTree=null,Recoil_gkx("recoil_memory_managament_2020")&&np==null&&releaseScheduledRetainablesNow$1(rp)}finally{_d.commitDepth--}}function Batcher({setNotifyBatcherOfChange:rp}){const _d=useStoreRef(),[,np]=useState([]);return rp(()=>np({})),useEffect(()=>(rp(()=>np({})),()=>{rp(()=>{})}),[rp]),useEffect(()=>{Recoil_Queue.enqueueExecution("Batcher",()=>{endBatch(_d.current)})}),null}function initialStoreState_DEPRECATED(rp,_d){const np=makeEmptyStoreState$2();return _d({set:(ap,sp)=>{const lp=np.currentTree,up=setNodeValue$2(rp,lp,ap.key,sp),cp=new Set(up.keys()),dp=lp.nonvalidatedAtoms.clone();for(const hp of cp)dp.delete(hp);np.currentTree={...lp,dirtyAtoms:Recoil_unionSets(lp.dirtyAtoms,cp),atomValues:applyAtomValueWrites$1(lp.atomValues,up),nonvalidatedAtoms:dp}},setUnvalidatedAtomValues:ap=>{ap.forEach((sp,lp)=>{np.currentTree=setUnvalidatedAtomValue_DEPRECATED$1(np.currentTree,lp,sp)})}}),np}function initialStoreState(rp){const _d=freshSnapshot$1(rp),np=_d.getStore_INTERNAL().getState();return _d.retain(),np.nodeCleanupFunctions.forEach(ap=>ap()),np.nodeCleanupFunctions.clear(),np}let nextID=0;function RecoilRoot_INTERNAL({initializeState_DEPRECATED:rp,initializeState:_d,store_INTERNAL:np,children:ap}){let sp;const lp=gp=>{const yp=sp.current.graphsByVersion;if(yp.has(gp))return Recoil_nullthrows(yp.get(gp));const xp=graph$2();return yp.set(gp,xp),xp},up=(gp,yp)=>{if(yp==null){const{transactionSubscriptions:xp}=pp.current.getState(),_p=nextID++;return xp.set(_p,gp),{release:()=>{xp.delete(_p)}}}else{const{nodeTransactionSubscriptions:xp}=pp.current.getState();xp.has(yp)||xp.set(yp,new Map);const _p=nextID++;return Recoil_nullthrows(xp.get(yp)).set(_p,gp),{release:()=>{const vp=xp.get(yp);vp&&(vp.delete(_p),vp.size===0&&xp.delete(yp))}}}},cp=gp=>{startNextTreeIfNeeded(pp.current);for(const yp of Object.keys(gp))Recoil_nullthrows(pp.current.getState().nextTree).transactionMetadata[yp]=gp[yp]},dp=gp=>{startNextTreeIfNeeded(pp.current);const yp=Recoil_nullthrows(sp.current.nextTree);let xp;try{stateReplacerIsBeingExecuted=!0,xp=gp(yp)}finally{stateReplacerIsBeingExecuted=!1}xp!==yp&&(sp.current.nextTree=xp,reactMode$2().early&&notifyComponents(pp.current,sp.current,xp),Recoil_nullthrows(hp.current)())},hp=useRef$1(null),fp=useCallback(gp=>{hp.current=gp},[hp]),pp=Recoil_useRefInitOnce(()=>np??{storeID:getNextStoreID$2(),getState:()=>sp.current,replaceState:dp,getGraph:lp,subscribeToTransactions:up,addTransactionMetadata:cp});np!=null&&(pp.current=np),sp=Recoil_useRefInitOnce(()=>rp!=null?initialStoreState_DEPRECATED(pp.current,rp):_d!=null?initialStoreState(_d):makeEmptyStoreState$2());const mp=useMemo(()=>createMutableSource$1==null?void 0:createMutableSource$1(sp,()=>sp.current.currentTree.version),[sp]);return useEffect(()=>{const gp=pp.current;for(const yp of new Set(gp.getState().knownAtoms))initializeNode$2(gp,yp,"get");return()=>{for(const yp of gp.getState().knownAtoms)cleanUpNode$2(gp,yp)}},[pp]),React.createElement(AppContext.Provider,{value:pp},React.createElement(MutableSourceContext.Provider,{value:mp},React.createElement(Batcher,{setNotifyBatcherOfChange:fp}),ap))}function RecoilRoot(rp){const{override:_d,...np}=rp,ap=useStoreRef();return _d===!1&&ap.current!==defaultStore?rp.children:React.createElement(RecoilRoot_INTERNAL,np)}function useRecoilStoreID(){return useStoreRef().current.storeID}var Recoil_RecoilRoot={RecoilRoot,useStoreRef,useRecoilMutableSource,useRecoilStoreID,notifyComponents_FOR_TESTING:notifyComponents,sendEndOfBatchNotifications_FOR_TESTING:sendEndOfBatchNotifications};function shallowArrayEqual(rp,_d){if(rp===_d)return!0;if(rp.length!==_d.length)return!1;for(let np=0,ap=rp.length;np<ap;np++)if(rp[np]!==_d[np])return!1;return!0}var Recoil_shallowArrayEqual=shallowArrayEqual;const{useEffect:useEffect$1,useRef:useRef$2}=React;function usePrevious(rp){const _d=useRef$2();return useEffect$1(()=>{_d.current=rp}),_d.current}var Recoil_usePrevious=usePrevious;const{useStoreRef:useStoreRef$1}=Recoil_RecoilRoot,{SUSPENSE_TIMEOUT_MS:SUSPENSE_TIMEOUT_MS$1}=Recoil_Retention,{updateRetainCount:updateRetainCount$2}=Recoil_Retention,{RetentionZone:RetentionZone$3}=Recoil_RetentionZone,{useEffect:useEffect$2,useRef:useRef$3}=React,{isSSR:isSSR$2}=Recoil_Environment;function useRetain(rp){if(Recoil_gkx("recoil_memory_managament_2020"))return useRetain_ACTUAL(rp)}function useRetain_ACTUAL(rp){const np=(Array.isArray(rp)?rp:[rp]).map(up=>up instanceof RetentionZone$3?up:up.key),ap=useStoreRef$1();useEffect$2(()=>{if(!Recoil_gkx("recoil_memory_managament_2020"))return;const up=ap.current;if(sp.current&&!isSSR$2)window.clearTimeout(sp.current),sp.current=null;else for(const cp of np)updateRetainCount$2(up,cp,1);return()=>{for(const cp of np)updateRetainCount$2(up,cp,-1)}},[ap,...np]);const sp=useRef$3(),lp=Recoil_usePrevious(np);if(!isSSR$2&&(lp===void 0||!Recoil_shallowArrayEqual(lp,np))){const up=ap.current;for(const cp of np)updateRetainCount$2(up,cp,1);if(lp)for(const cp of lp)updateRetainCount$2(up,cp,-1);sp.current&&window.clearTimeout(sp.current),sp.current=window.setTimeout(()=>{sp.current=null;for(const cp of np)updateRetainCount$2(up,cp,-1)},SUSPENSE_TIMEOUT_MS$1)}}var Recoil_useRetain=useRetain;function useComponentName(){return"<component name not available>"}var Recoil_useComponentName=useComponentName;const{batchUpdates:batchUpdates$2}=Recoil_Batching,{DEFAULT_VALUE:DEFAULT_VALUE$2}=Recoil_Node,{currentRendererSupportsUseSyncExternalStore:currentRendererSupportsUseSyncExternalStore$1,reactMode:reactMode$3,useMutableSource:useMutableSource$1,useSyncExternalStore:useSyncExternalStore$1}=Recoil_ReactMode,{useRecoilMutableSource:useRecoilMutableSource$1,useStoreRef:useStoreRef$2}=Recoil_RecoilRoot,{AbstractRecoilValue:AbstractRecoilValue$3,getRecoilValueAsLoadable:getRecoilValueAsLoadable$2,setRecoilValue:setRecoilValue$2,setUnvalidatedRecoilValue:setUnvalidatedRecoilValue$2,subscribeToRecoilValue:subscribeToRecoilValue$1}=Recoil_RecoilValueInterface,{useCallback:useCallback$1,useEffect:useEffect$3,useMemo:useMemo$1,useRef:useRef$4,useState:useState$1}=React,{setByAddingToSet:setByAddingToSet$2}=Recoil_CopyOnWrite,{isSSR:isSSR$3}=Recoil_Environment;function handleLoadable(rp,_d,np){if(rp.state==="hasValue")return rp.contents;throw rp.state==="loading"?new Promise(sp=>{const lp=np.current.getState().suspendedComponentResolvers;lp.add(sp),isSSR$3&&Recoil_isPromise(rp.contents)&&rp.contents.finally(()=>{lp.delete(sp)})}):rp.state==="hasError"?rp.contents:Recoil_err(`Invalid value of loadable atom "${_d.key}"`)}function useRecoilInterface_DEPRECATED(){const rp=Recoil_useComponentName(),_d=useStoreRef$2(),[,np]=useState$1([]),ap=useRef$4(new Set);ap.current=new Set;const sp=useRef$4(new Set),lp=useRef$4(new Map),up=useCallback$1(dp=>{const hp=lp.current.get(dp);hp&&(hp.release(),lp.current.delete(dp))},[lp]),cp=useCallback$1((dp,hp)=>{lp.current.has(hp)&&np([])},[]);return useEffect$3(()=>{const dp=_d.current;Recoil_differenceSets(ap.current,sp.current).forEach(hp=>{if(lp.current.has(hp))return;const fp=subscribeToRecoilValue$1(dp,new AbstractRecoilValue$3(hp),mp=>cp(mp,hp),rp);lp.current.set(hp,fp),dp.getState().nextTree?dp.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{cp(dp.getState(),hp)}):cp(dp.getState(),hp)}),Recoil_differenceSets(sp.current,ap.current).forEach(hp=>{up(hp)}),sp.current=ap.current}),useEffect$3(()=>{const dp=lp.current;return Recoil_differenceSets(ap.current,new Set(dp.keys())).forEach(hp=>{const fp=subscribeToRecoilValue$1(_d.current,new AbstractRecoilValue$3(hp),pp=>cp(pp,hp),rp);dp.set(hp,fp)}),()=>dp.forEach((hp,fp)=>up(fp))},[rp,_d,up,cp]),useMemo$1(()=>{function dp(yp){return xp=>{setRecoilValue$2(_d.current,yp,xp)}}function hp(yp){return()=>setRecoilValue$2(_d.current,yp,DEFAULT_VALUE$2)}function fp(yp){var xp;ap.current.has(yp.key)||(ap.current=setByAddingToSet$2(ap.current,yp.key));const _p=_d.current.getState();return getRecoilValueAsLoadable$2(_d.current,yp,reactMode$3().early&&(xp=_p.nextTree)!==null&&xp!==void 0?xp:_p.currentTree)}function pp(yp){const xp=fp(yp);return handleLoadable(xp,yp,_d)}function mp(yp){return[pp(yp),dp(yp)]}function gp(yp){return[fp(yp),dp(yp)]}return{getRecoilValue:pp,getRecoilValueLoadable:fp,getRecoilState:mp,getRecoilStateLoadable:gp,getSetRecoilState:dp,getResetRecoilState:hp}},[ap,_d])}const recoilComponentGetRecoilValueCount_FOR_TESTING={current:0};function useRecoilValueLoadable_SYNC_EXTERNAL_STORE(rp){const _d=useStoreRef$2(),np=Recoil_useComponentName(),ap=useCallback$1(()=>{var cp;const dp=_d.current,hp=dp.getState(),fp=reactMode$3().early&&(cp=hp.nextTree)!==null&&cp!==void 0?cp:hp.currentTree;return{loadable:getRecoilValueAsLoadable$2(dp,rp,fp),key:rp.key}},[_d,rp]),sp=useCallback$1(cp=>{let dp;return()=>{var hp,fp;const pp=cp();return(hp=dp)!==null&&hp!==void 0&&hp.loadable.is(pp.loadable)&&((fp=dp)===null||fp===void 0?void 0:fp.key)===pp.key?dp:(dp=pp,pp)}},[]),lp=useMemo$1(()=>sp(ap),[ap,sp]),up=useCallback$1(cp=>{const dp=_d.current;return subscribeToRecoilValue$1(dp,rp,cp,np).release},[_d,rp,np]);return useSyncExternalStore$1(up,lp,lp).loadable}function useRecoilValueLoadable_MUTABLE_SOURCE(rp){const _d=useStoreRef$2(),np=useCallback$1(()=>{var hp;const fp=_d.current,pp=fp.getState(),mp=reactMode$3().early&&(hp=pp.nextTree)!==null&&hp!==void 0?hp:pp.currentTree;return getRecoilValueAsLoadable$2(fp,rp,mp)},[_d,rp]),ap=useCallback$1(()=>np(),[np]),sp=Recoil_useComponentName(),lp=useCallback$1((hp,fp)=>{const pp=_d.current;return subscribeToRecoilValue$1(pp,rp,()=>{if(!Recoil_gkx("recoil_suppress_rerender_in_callback"))return fp();const gp=np();dp.current.is(gp)||fp(),dp.current=gp},sp).release},[_d,rp,sp,np]),up=useRecoilMutableSource$1();if(up==null)throw Recoil_err("Recoil hooks must be used in components contained within a <RecoilRoot> component.");const cp=useMutableSource$1(up,ap,lp),dp=useRef$4(cp);return useEffect$3(()=>{dp.current=cp}),cp}function useRecoilValueLoadable_TRANSITION_SUPPORT(rp){const _d=useStoreRef$2(),np=Recoil_useComponentName(),ap=useCallback$1(()=>{var dp;const hp=_d.current,fp=hp.getState(),pp=reactMode$3().early&&(dp=fp.nextTree)!==null&&dp!==void 0?dp:fp.currentTree;return getRecoilValueAsLoadable$2(hp,rp,pp)},[_d,rp]),sp=useCallback$1(()=>({loadable:ap(),key:rp.key}),[ap,rp.key]),lp=useCallback$1(dp=>{const hp=sp();return dp.loadable.is(hp.loadable)&&dp.key===hp.key?dp:hp},[sp]);useEffect$3(()=>{const dp=subscribeToRecoilValue$1(_d.current,rp,hp=>{cp(lp)},np);return cp(lp),dp.release},[np,rp,_d,lp]);const[up,cp]=useState$1(sp);return up.key!==rp.key?sp().loadable:up.loadable}function useRecoilValueLoadable_LEGACY(rp){const _d=useStoreRef$2(),[,np]=useState$1([]),ap=Recoil_useComponentName(),sp=useCallback$1(()=>{var cp;const dp=_d.current,hp=dp.getState(),fp=reactMode$3().early&&(cp=hp.nextTree)!==null&&cp!==void 0?cp:hp.currentTree;return getRecoilValueAsLoadable$2(dp,rp,fp)},[_d,rp]),lp=sp(),up=useRef$4(lp);return useEffect$3(()=>{up.current=lp}),useEffect$3(()=>{const cp=_d.current,dp=cp.getState(),hp=subscribeToRecoilValue$1(cp,rp,pp=>{var mp;if(!Recoil_gkx("recoil_suppress_rerender_in_callback"))return np([]);const gp=sp();(mp=up.current)!==null&&mp!==void 0&&mp.is(gp)||np(gp),up.current=gp},ap);if(dp.nextTree)cp.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{up.current=null,np([])});else{var fp;if(!Recoil_gkx("recoil_suppress_rerender_in_callback"))return np([]);const pp=sp();(fp=up.current)!==null&&fp!==void 0&&fp.is(pp)||np(pp),up.current=pp}return hp.release},[ap,sp,rp,_d]),lp}function useRecoilValueLoadable(rp){return Recoil_gkx("recoil_memory_managament_2020")&&Recoil_useRetain(rp),{TRANSITION_SUPPORT:useRecoilValueLoadable_TRANSITION_SUPPORT,SYNC_EXTERNAL_STORE:currentRendererSupportsUseSyncExternalStore$1()?useRecoilValueLoadable_SYNC_EXTERNAL_STORE:useRecoilValueLoadable_TRANSITION_SUPPORT,MUTABLE_SOURCE:useRecoilValueLoadable_MUTABLE_SOURCE,LEGACY:useRecoilValueLoadable_LEGACY}[reactMode$3().mode](rp)}function useRecoilValue(rp){const _d=useStoreRef$2(),np=useRecoilValueLoadable(rp);return handleLoadable(np,rp,_d)}function useSetRecoilState(rp){const _d=useStoreRef$2();return useCallback$1(np=>{setRecoilValue$2(_d.current,rp,np)},[_d,rp])}function useResetRecoilState(rp){const _d=useStoreRef$2();return useCallback$1(()=>{setRecoilValue$2(_d.current,rp,DEFAULT_VALUE$2)},[_d,rp])}function useRecoilState(rp){return[useRecoilValue(rp),useSetRecoilState(rp)]}function useRecoilStateLoadable(rp){return[useRecoilValueLoadable(rp),useSetRecoilState(rp)]}function useSetUnvalidatedAtomValues(){const rp=useStoreRef$2();return(_d,np={})=>{batchUpdates$2(()=>{rp.current.addTransactionMetadata(np),_d.forEach((ap,sp)=>setUnvalidatedRecoilValue$2(rp.current,new AbstractRecoilValue$3(sp),ap))})}}function useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE(rp){return Recoil_gkx("recoil_memory_managament_2020")&&Recoil_useRetain(rp),useRecoilValueLoadable_TRANSITION_SUPPORT(rp)}function useRecoilValue_TRANSITION_SUPPORT_UNSTABLE(rp){const _d=useStoreRef$2(),np=useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE(rp);return handleLoadable(np,rp,_d)}function useRecoilState_TRANSITION_SUPPORT_UNSTABLE(rp){return[useRecoilValue_TRANSITION_SUPPORT_UNSTABLE(rp),useSetRecoilState(rp)]}var Recoil_Hooks={recoilComponentGetRecoilValueCount_FOR_TESTING,useRecoilInterface:useRecoilInterface_DEPRECATED,useRecoilState,useRecoilStateLoadable,useRecoilValue,useRecoilValueLoadable,useResetRecoilState,useSetRecoilState,useSetUnvalidatedAtomValues,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE,useRecoilState_TRANSITION_SUPPORT_UNSTABLE};function filterMap(rp,_d){const np=new Map;for(const[ap,sp]of rp)_d(sp,ap)&&np.set(ap,sp);return np}var Recoil_filterMap=filterMap;function filterSet(rp,_d){const np=new Set;for(const ap of rp)_d(ap)&&np.add(ap);return np}var Recoil_filterSet=filterSet;function mergeMaps(...rp){const _d=new Map;for(let np=0;np<rp.length;np++){const ap=rp[np].keys();let sp;for(;!(sp=ap.next()).done;)_d.set(sp.value,rp[np].get(sp.value))}return _d}var Recoil_mergeMaps=mergeMaps;const{batchUpdates:batchUpdates$3}=Recoil_Batching,{DEFAULT_VALUE:DEFAULT_VALUE$3,getNode:getNode$4,nodes:nodes$1}=Recoil_Node,{useStoreRef:useStoreRef$3}=Recoil_RecoilRoot,{AbstractRecoilValue:AbstractRecoilValue$4,setRecoilValueLoadable:setRecoilValueLoadable$1}=Recoil_RecoilValueInterface,{SUSPENSE_TIMEOUT_MS:SUSPENSE_TIMEOUT_MS$2}=Recoil_Retention,{cloneSnapshot:cloneSnapshot$1}=Recoil_Snapshot$1,{useCallback:useCallback$2,useEffect:useEffect$4,useRef:useRef$5,useState:useState$2}=React,{isSSR:isSSR$4}=Recoil_Environment;function useTransactionSubscription(rp){const _d=useStoreRef$3();useEffect$4(()=>_d.current.subscribeToTransactions(rp).release,[rp,_d])}function externallyVisibleAtomValuesInState(rp){const _d=rp.atomValues.toMap(),np=Recoil_mapMap(Recoil_filterMap(_d,(ap,sp)=>{const up=getNode$4(sp).persistence_UNSTABLE;return up!=null&&up.type!=="none"&&ap.state==="hasValue"}),ap=>ap.contents);return Recoil_mergeMaps(rp.nonvalidatedAtoms.toMap(),np)}function useTransactionObservation_DEPRECATED(rp){useTransactionSubscription(useCallback$2(_d=>{let np=_d.getState().previousTree;const ap=_d.getState().currentTree;np||(np=_d.getState().currentTree);const sp=externallyVisibleAtomValuesInState(ap),lp=externallyVisibleAtomValuesInState(np),up=Recoil_mapMap(nodes$1,dp=>{var hp,fp,pp,mp;return{persistence_UNSTABLE:{type:(hp=(fp=dp.persistence_UNSTABLE)===null||fp===void 0?void 0:fp.type)!==null&&hp!==void 0?hp:"none",backButton:(pp=(mp=dp.persistence_UNSTABLE)===null||mp===void 0?void 0:mp.backButton)!==null&&pp!==void 0?pp:!1}}}),cp=Recoil_filterSet(ap.dirtyAtoms,dp=>sp.has(dp)||lp.has(dp));rp({atomValues:sp,previousAtomValues:lp,atomInfo:up,modifiedAtoms:cp,transactionMetadata:{...ap.transactionMetadata}})},[rp]))}function useRecoilTransactionObserver(rp){useTransactionSubscription(useCallback$2(_d=>{const np=cloneSnapshot$1(_d,"latest"),ap=cloneSnapshot$1(_d,"previous");rp({snapshot:np,previousSnapshot:ap})},[rp]))}function useRecoilSnapshot(){const rp=useStoreRef$3(),[_d,np]=useState$2(()=>cloneSnapshot$1(rp.current)),ap=Recoil_usePrevious(_d),sp=useRef$5(),lp=useRef$5();if(useTransactionSubscription(useCallback$2(cp=>np(cloneSnapshot$1(cp)),[])),useEffect$4(()=>{const cp=_d.retain();if(sp.current&&!isSSR$4){var dp;window.clearTimeout(sp.current),sp.current=null,(dp=lp.current)===null||dp===void 0||dp.call(lp),lp.current=null}return()=>{window.setTimeout(cp,10)}},[_d]),ap!==_d&&!isSSR$4){if(sp.current){var up;window.clearTimeout(sp.current),sp.current=null,(up=lp.current)===null||up===void 0||up.call(lp),lp.current=null}lp.current=_d.retain(),sp.current=window.setTimeout(()=>{var cp;sp.current=null,(cp=lp.current)===null||cp===void 0||cp.call(lp),lp.current=null},SUSPENSE_TIMEOUT_MS$2)}return _d}function gotoSnapshot(rp,_d){var np;const ap=rp.getState(),sp=(np=ap.nextTree)!==null&&np!==void 0?np:ap.currentTree,lp=_d.getStore_INTERNAL().getState().currentTree;batchUpdates$3(()=>{const up=new Set;for(const hp of[sp.atomValues.keys(),lp.atomValues.keys()])for(const fp of hp){var cp,dp;((cp=sp.atomValues.get(fp))===null||cp===void 0?void 0:cp.contents)!==((dp=lp.atomValues.get(fp))===null||dp===void 0?void 0:dp.contents)&&getNode$4(fp).shouldRestoreFromSnapshots&&up.add(fp)}up.forEach(hp=>{setRecoilValueLoadable$1(rp,new AbstractRecoilValue$4(hp),lp.atomValues.has(hp)?Recoil_nullthrows(lp.atomValues.get(hp)):DEFAULT_VALUE$3)}),rp.replaceState(hp=>({...hp,stateID:_d.getID()}))})}function useGotoRecoilSnapshot(){const rp=useStoreRef$3();return useCallback$2(_d=>gotoSnapshot(rp.current,_d),[rp])}var Recoil_SnapshotHooks={useRecoilSnapshot,gotoSnapshot,useGotoRecoilSnapshot,useRecoilTransactionObserver,useTransactionObservation_DEPRECATED,useTransactionSubscription_DEPRECATED:useTransactionSubscription};const{peekNodeInfo:peekNodeInfo$2}=Recoil_FunctionalCore,{useStoreRef:useStoreRef$4}=Recoil_RecoilRoot;function useGetRecoilValueInfo(){const rp=useStoreRef$4();return({key:_d})=>peekNodeInfo$2(rp.current,rp.current.getState().currentTree,_d)}var Recoil_useGetRecoilValueInfo=useGetRecoilValueInfo;const{reactMode:reactMode$4}=Recoil_ReactMode,{RecoilRoot:RecoilRoot$1,useStoreRef:useStoreRef$5}=Recoil_RecoilRoot,{useMemo:useMemo$2}=React;function useRecoilBridgeAcrossReactRoots(){reactMode$4().mode==="MUTABLE_SOURCE"&&console.warn("Warning: There are known issues using useRecoilBridgeAcrossReactRoots() in recoil_mutable_source rendering mode.  Please consider upgrading to recoil_sync_external_store mode.");const rp=useStoreRef$5().current;return useMemo$2(()=>{function _d({children:np}){return React.createElement(RecoilRoot$1,{store_INTERNAL:rp},np)}return _d},[rp])}var Recoil_useRecoilBridgeAcrossReactRoots=useRecoilBridgeAcrossReactRoots;const{loadableWithValue:loadableWithValue$1}=Recoil_Loadable$1,{initializeNode:initializeNode$3}=Recoil_FunctionalCore,{DEFAULT_VALUE:DEFAULT_VALUE$4,getNode:getNode$5}=Recoil_Node,{copyTreeState:copyTreeState$1,getRecoilValueAsLoadable:getRecoilValueAsLoadable$3,invalidateDownstreams:invalidateDownstreams$1,writeLoadableToTreeState:writeLoadableToTreeState$1}=Recoil_RecoilValueInterface;function isAtom(rp){return getNode$5(rp.key).nodeType==="atom"}class TransactionInterfaceImpl{constructor(_d,np){_defineProperty$1(this,"_store",void 0),_defineProperty$1(this,"_treeState",void 0),_defineProperty$1(this,"_changes",void 0),_defineProperty$1(this,"get",ap=>{if(this._changes.has(ap.key))return this._changes.get(ap.key);if(!isAtom(ap))throw Recoil_err("Reading selectors within atomicUpdate is not supported");const sp=getRecoilValueAsLoadable$3(this._store,ap,this._treeState);if(sp.state==="hasValue")return sp.contents;throw sp.state==="hasError"?sp.contents:Recoil_err(`Expected Recoil atom ${ap.key} to have a value, but it is in a loading state.`)}),_defineProperty$1(this,"set",(ap,sp)=>{if(!isAtom(ap))throw Recoil_err("Setting selectors within atomicUpdate is not supported");if(typeof sp=="function"){const lp=this.get(ap);this._changes.set(ap.key,sp(lp))}else initializeNode$3(this._store,ap.key,"set"),this._changes.set(ap.key,sp)}),_defineProperty$1(this,"reset",ap=>{this.set(ap,DEFAULT_VALUE$4)}),this._store=_d,this._treeState=np,this._changes=new Map}newTreeState_INTERNAL(){if(this._changes.size===0)return this._treeState;const _d=copyTreeState$1(this._treeState);for(const[np,ap]of this._changes)writeLoadableToTreeState$1(_d,np,loadableWithValue$1(ap));return invalidateDownstreams$1(this._store,_d),_d}}function atomicUpdater(rp){return _d=>{rp.replaceState(np=>{const ap=new TransactionInterfaceImpl(rp,np);return _d(ap),ap.newTreeState_INTERNAL()})}}var Recoil_AtomicUpdates={atomicUpdater},Recoil_AtomicUpdates_1=Recoil_AtomicUpdates.atomicUpdater,Recoil_AtomicUpdates$1=Object.freeze({__proto__:null,atomicUpdater:Recoil_AtomicUpdates_1});function invariant(rp,_d){if(!rp)throw new Error(_d)}var invariant_1=invariant,Recoil_invariant=invariant_1;const{atomicUpdater:atomicUpdater$1}=Recoil_AtomicUpdates$1,{batchUpdates:batchUpdates$4}=Recoil_Batching,{DEFAULT_VALUE:DEFAULT_VALUE$5}=Recoil_Node,{useStoreRef:useStoreRef$6}=Recoil_RecoilRoot,{refreshRecoilValue:refreshRecoilValue$1,setRecoilValue:setRecoilValue$3}=Recoil_RecoilValueInterface,{cloneSnapshot:cloneSnapshot$2}=Recoil_Snapshot$1,{gotoSnapshot:gotoSnapshot$1}=Recoil_SnapshotHooks,{useCallback:useCallback$3}=React;class Sentinel{}const SENTINEL=new Sentinel;function recoilCallback(rp,_d,np,ap){let sp=SENTINEL,lp;if(batchUpdates$4(()=>{const cp="useRecoilCallback() expects a function that returns a function: it accepts a function of the type (RecoilInterface) => (Args) => ReturnType and returns a callback function (Args) => ReturnType, where RecoilInterface is an object {snapshot, set, ...} and Args and ReturnType are the argument and return types of the callback you want to create.  Please see the docs at recoiljs.org for details.";if(typeof _d!="function")throw Recoil_err(cp);const dp=Recoil_lazyProxy({...ap??{},set:(fp,pp)=>setRecoilValue$3(rp,fp,pp),reset:fp=>setRecoilValue$3(rp,fp,DEFAULT_VALUE$5),refresh:fp=>refreshRecoilValue$1(rp,fp),gotoSnapshot:fp=>gotoSnapshot$1(rp,fp),transact_UNSTABLE:fp=>atomicUpdater$1(rp)(fp)},{snapshot:()=>{const fp=cloneSnapshot$2(rp);return lp=fp.retain(),fp}}),hp=_d(dp);if(typeof hp!="function")throw Recoil_err(cp);sp=hp(...np)}),sp instanceof Sentinel&&Recoil_invariant(!1),Recoil_isPromise(sp))sp=sp.finally(()=>{var cp;(cp=lp)===null||cp===void 0||cp()});else{var up;(up=lp)===null||up===void 0||up()}return sp}function useRecoilCallback(rp,_d){const np=useStoreRef$6();return useCallback$3((...ap)=>recoilCallback(np.current,rp,ap),_d!=null?[..._d,np]:void 0)}var Recoil_useRecoilCallback={recoilCallback,useRecoilCallback};const{useStoreRef:useStoreRef$7}=Recoil_RecoilRoot,{refreshRecoilValue:refreshRecoilValue$2}=Recoil_RecoilValueInterface,{useCallback:useCallback$4}=React;function useRecoilRefresher(rp){const _d=useStoreRef$7();return useCallback$4(()=>{const np=_d.current;refreshRecoilValue$2(np,rp)},[rp,_d])}var Recoil_useRecoilRefresher=useRecoilRefresher;const{atomicUpdater:atomicUpdater$2}=Recoil_AtomicUpdates$1,{useStoreRef:useStoreRef$8}=Recoil_RecoilRoot,{useMemo:useMemo$3}=React;function useRecoilTransaction(rp,_d){const np=useStoreRef$8();return useMemo$3(()=>(...ap)=>{atomicUpdater$2(np.current)(lp=>{rp(lp)(...ap)})},_d!=null?[..._d,np]:void 0)}var Recoil_useRecoilTransaction=useRecoilTransaction;class WrappedValue{constructor(_d){_defineProperty$1(this,"value",void 0),this.value=_d}}var Recoil_Wrapper={WrappedValue},Recoil_Wrapper_1=Recoil_Wrapper.WrappedValue,Recoil_Wrapper$1=Object.freeze({__proto__:null,WrappedValue:Recoil_Wrapper_1});const{isFastRefreshEnabled:isFastRefreshEnabled$2}=Recoil_ReactMode;class ChangedPathError extends Error{}class TreeCache{constructor(_d){var np,ap,sp;_defineProperty$1(this,"_name",void 0),_defineProperty$1(this,"_numLeafs",void 0),_defineProperty$1(this,"_root",void 0),_defineProperty$1(this,"_onHit",void 0),_defineProperty$1(this,"_onSet",void 0),_defineProperty$1(this,"_mapNodeValue",void 0),this._name=_d==null?void 0:_d.name,this._numLeafs=0,this._root=null,this._onHit=(np=_d==null?void 0:_d.onHit)!==null&&np!==void 0?np:()=>{},this._onSet=(ap=_d==null?void 0:_d.onSet)!==null&&ap!==void 0?ap:()=>{},this._mapNodeValue=(sp=_d==null?void 0:_d.mapNodeValue)!==null&&sp!==void 0?sp:lp=>lp}size(){return this._numLeafs}root(){return this._root}get(_d,np){var ap;return(ap=this.getLeafNode(_d,np))===null||ap===void 0?void 0:ap.value}getLeafNode(_d,np){if(this._root==null)return;let ap=this._root;for(;ap;){if(np==null||np.onNodeVisit(ap),ap.type==="leaf")return this._onHit(ap),ap;const sp=this._mapNodeValue(_d(ap.nodeKey));ap=ap.branches.get(sp)}}set(_d,np,ap){const sp=()=>{var lp,up,cp,dp;let hp,fp;for(const[_p,vp]of _d){var pp,mp,gp;const bp=this._root;if((bp==null?void 0:bp.type)==="leaf")throw this.invalidCacheError();const Ep=hp;if(hp=Ep?Ep.branches.get(fp):bp,hp=(pp=hp)!==null&&pp!==void 0?pp:{type:"branch",nodeKey:_p,parent:Ep,branches:new Map,branchKey:fp},hp.type!=="branch"||hp.nodeKey!==_p)throw this.invalidCacheError();Ep==null||Ep.branches.set(fp,hp),ap==null||(mp=ap.onNodeVisit)===null||mp===void 0||mp.call(ap,hp),fp=this._mapNodeValue(vp),this._root=(gp=this._root)!==null&&gp!==void 0?gp:hp}const yp=hp?(lp=hp)===null||lp===void 0?void 0:lp.branches.get(fp):this._root;if(yp!=null&&(yp.type!=="leaf"||yp.branchKey!==fp))throw this.invalidCacheError();const xp={type:"leaf",value:np,parent:hp,branchKey:fp};(up=hp)===null||up===void 0||up.branches.set(fp,xp),this._root=(cp=this._root)!==null&&cp!==void 0?cp:xp,this._numLeafs++,this._onSet(xp),ap==null||(dp=ap.onNodeVisit)===null||dp===void 0||dp.call(ap,xp)};try{sp()}catch(lp){if(lp instanceof ChangedPathError)this.clear(),sp();else throw lp}}delete(_d){const np=this.root();if(!np)return!1;if(_d===np)return this._root=null,this._numLeafs=0,!0;let ap=_d.parent,sp=_d.branchKey;for(;ap;){var lp;if(ap.branches.delete(sp),ap===np)return ap.branches.size===0?(this._root=null,this._numLeafs=0):this._numLeafs--,!0;if(ap.branches.size>0)break;sp=(lp=ap)===null||lp===void 0?void 0:lp.branchKey,ap=ap.parent}for(;ap!==np;ap=ap.parent)if(ap==null)return!1;return this._numLeafs--,!0}clear(){this._numLeafs=0,this._root=null}invalidCacheError(){const _d=isFastRefreshEnabled$2()?"Possible Fast Refresh module reload detected.  This may also be caused by an selector returning inconsistent values. Resetting cache.":"Invalid cache values.  This happens when selectors do not return consistent values for the same input dependency values.  That may also be caused when using Fast Refresh to change a selector implementation.  Resetting cache.";throw Recoil_recoverableViolation(_d+(this._name!=null?` - ${this._name}`:"")),new ChangedPathError}}var Recoil_TreeCache={TreeCache},Recoil_TreeCache_1=Recoil_TreeCache.TreeCache,Recoil_TreeCache$1=Object.freeze({__proto__:null,TreeCache:Recoil_TreeCache_1});class LRUCache{constructor(_d){var np;_defineProperty$1(this,"_maxSize",void 0),_defineProperty$1(this,"_size",void 0),_defineProperty$1(this,"_head",void 0),_defineProperty$1(this,"_tail",void 0),_defineProperty$1(this,"_map",void 0),_defineProperty$1(this,"_keyMapper",void 0),this._maxSize=_d.maxSize,this._size=0,this._head=null,this._tail=null,this._map=new Map,this._keyMapper=(np=_d.mapKey)!==null&&np!==void 0?np:ap=>ap}head(){return this._head}tail(){return this._tail}size(){return this._size}maxSize(){return this._maxSize}has(_d){return this._map.has(this._keyMapper(_d))}get(_d){const np=this._keyMapper(_d),ap=this._map.get(np);if(ap)return this.set(_d,ap.value),ap.value}set(_d,np){const ap=this._keyMapper(_d);this._map.get(ap)&&this.delete(_d);const lp=this.head(),up={key:_d,right:lp,left:null,value:np};lp?lp.left=up:this._tail=up,this._map.set(ap,up),this._head=up,this._size++,this._maybeDeleteLRU()}_maybeDeleteLRU(){this.size()>this.maxSize()&&this.deleteLru()}deleteLru(){const _d=this.tail();_d&&this.delete(_d.key)}delete(_d){const np=this._keyMapper(_d);if(!this._size||!this._map.has(np))return;const ap=Recoil_nullthrows(this._map.get(np)),sp=ap.right,lp=ap.left;sp&&(sp.left=ap.left),lp&&(lp.right=ap.right),ap===this.head()&&(this._head=sp),ap===this.tail()&&(this._tail=lp),this._map.delete(np),this._size--}clear(){this._size=0,this._head=null,this._tail=null,this._map=new Map}}var Recoil_LRUCache={LRUCache},Recoil_LRUCache_1=Recoil_LRUCache.LRUCache,Recoil_LRUCache$1=Object.freeze({__proto__:null,LRUCache:Recoil_LRUCache_1});const{LRUCache:LRUCache$1}=Recoil_LRUCache$1,{TreeCache:TreeCache$1}=Recoil_TreeCache$1;function treeCacheLRU({name:rp,maxSize:_d,mapNodeValue:np=ap=>ap}){const ap=new LRUCache$1({maxSize:_d}),sp=new TreeCache$1({name:rp,mapNodeValue:np,onHit:lp=>{ap.set(lp,!0)},onSet:lp=>{const up=ap.tail();ap.set(lp,!0),up&&sp.size()>_d&&sp.delete(up.key)}});return sp}var Recoil_treeCacheLRU=treeCacheLRU;function stringify$2(rp,_d,np){if(typeof rp=="string"&&!rp.includes('"')&&!rp.includes("\\"))return`"${rp}"`;switch(typeof rp){case"undefined":return"";case"boolean":return rp?"true":"false";case"number":case"symbol":return String(rp);case"string":return JSON.stringify(rp);case"function":if((_d==null?void 0:_d.allowFunctions)!==!0)throw Recoil_err("Attempt to serialize function in a Recoil cache key");return`__FUNCTION(${rp.name})__`}if(rp===null)return"null";if(typeof rp!="object"){var ap;return(ap=JSON.stringify(rp))!==null&&ap!==void 0?ap:""}if(Recoil_isPromise(rp))return"__PROMISE__";if(Array.isArray(rp))return`[${rp.map((sp,lp)=>stringify$2(sp,_d,lp.toString()))}]`;if(typeof rp.toJSON=="function")return stringify$2(rp.toJSON(np),_d,np);if(rp instanceof Map){const sp={};for(const[lp,up]of rp)sp[typeof lp=="string"?lp:stringify$2(lp,_d)]=up;return stringify$2(sp,_d,np)}return rp instanceof Set?stringify$2(Array.from(rp).sort((sp,lp)=>stringify$2(sp,_d).localeCompare(stringify$2(lp,_d))),_d,np):Symbol!==void 0&&rp[Symbol.iterator]!=null&&typeof rp[Symbol.iterator]=="function"?stringify$2(Array.from(rp),_d,np):`{${Object.keys(rp).filter(sp=>rp[sp]!==void 0).sort().map(sp=>`${stringify$2(sp,_d)}:${stringify$2(rp[sp],_d,sp)}`).join(",")}}`}function stableStringify(rp,_d={allowFunctions:!1}){return stringify$2(rp,_d)}var Recoil_stableStringify=stableStringify;const{TreeCache:TreeCache$2}=Recoil_TreeCache$1,defaultPolicy={equality:"reference",eviction:"keep-all",maxSize:1/0};function treeCacheFromPolicy({equality:rp=defaultPolicy.equality,eviction:_d=defaultPolicy.eviction,maxSize:np=defaultPolicy.maxSize}=defaultPolicy,ap){const sp=getValueMapper(rp);return getTreeCache(_d,np,sp,ap)}function getValueMapper(rp){switch(rp){case"reference":return _d=>_d;case"value":return _d=>Recoil_stableStringify(_d)}throw Recoil_err(`Unrecognized equality policy ${rp}`)}function getTreeCache(rp,_d,np,ap){switch(rp){case"keep-all":return new TreeCache$2({name:ap,mapNodeValue:np});case"lru":return Recoil_treeCacheLRU({name:ap,maxSize:Recoil_nullthrows(_d),mapNodeValue:np});case"most-recent":return Recoil_treeCacheLRU({name:ap,maxSize:1,mapNodeValue:np})}throw Recoil_err(`Unrecognized eviction policy ${rp}`)}var Recoil_treeCacheFromPolicy=treeCacheFromPolicy;function startPerfBlock(rp){return()=>null}var Recoil_PerformanceTimings={startPerfBlock};const{isLoadable:isLoadable$1,loadableWithError:loadableWithError$1,loadableWithPromise:loadableWithPromise$1,loadableWithValue:loadableWithValue$2}=Recoil_Loadable$1,{WrappedValue:WrappedValue$1}=Recoil_Wrapper$1,{getNodeLoadable:getNodeLoadable$2,peekNodeLoadable:peekNodeLoadable$1,setNodeValue:setNodeValue$3}=Recoil_FunctionalCore,{saveDepsToStore:saveDepsToStore$1}=Recoil_Graph,{DEFAULT_VALUE:DEFAULT_VALUE$6,getConfigDeletionHandler:getConfigDeletionHandler$1,getNode:getNode$6,registerNode:registerNode$1}=Recoil_Node,{isRecoilValue:isRecoilValue$3}=Recoil_RecoilValue$1,{markRecoilValueModified:markRecoilValueModified$1}=Recoil_RecoilValueInterface,{retainedByOptionWithDefault:retainedByOptionWithDefault$1}=Recoil_Retention,{recoilCallback:recoilCallback$1}=Recoil_useRecoilCallback,{startPerfBlock:startPerfBlock$1}=Recoil_PerformanceTimings;class Canceled{}const CANCELED=new Canceled,dependencyStack=[],waitingStores=new Map,getNewExecutionID=(()=>{let rp=0;return()=>rp++})();function selector(rp){let _d=null;const{key:np,get:ap,cachePolicy_UNSTABLE:sp}=rp,lp=rp.set!=null?rp.set:void 0,up=new Set,cp=Recoil_treeCacheFromPolicy(sp??{equality:"reference",eviction:"keep-all"},np),dp=retainedByOptionWithDefault$1(rp.retainedBy_UNSTABLE),hp=new Map;let fp=0;function pp(){return!Recoil_gkx("recoil_memory_managament_2020")||fp>0}function mp(Wp){return Wp.getState().knownSelectors.add(np),fp++,()=>{fp--}}function gp(){return getConfigDeletionHandler$1(np)!==void 0&&!pp()}function yp(Wp,Qp,Xp,rm,Kp){Lp(Qp,rm,Kp),xp(Wp,Xp)}function xp(Wp,Qp){Fp(Wp,Qp)&&Dp(Wp),vp(Qp,!0)}function _p(Wp,Qp){Fp(Wp,Qp)&&(Recoil_nullthrows(Pp(Wp)).stateVersions.clear(),vp(Qp,!1))}function vp(Wp,Qp){const Xp=waitingStores.get(Wp);if(Xp!=null){for(const rm of Xp)markRecoilValueModified$1(rm,Recoil_nullthrows(_d));Qp&&waitingStores.delete(Wp)}}function bp(Wp,Qp){let Xp=waitingStores.get(Qp);Xp==null&&waitingStores.set(Qp,Xp=new Set),Xp.add(Wp)}function Ep(Wp,Qp,Xp,rm,Kp,lm){return Qp.then(cm=>{if(!pp())throw Dp(Wp),CANCELED;const gm=loadableWithValue$2(cm);return yp(Wp,Xp,Kp,gm,rm),cm}).catch(cm=>{if(!pp())throw Dp(Wp),CANCELED;if(Recoil_isPromise(cm))return Sp(Wp,cm,Xp,rm,Kp,lm);const gm=loadableWithError$1(cm);throw yp(Wp,Xp,Kp,gm,rm),cm})}function Sp(Wp,Qp,Xp,rm,Kp,lm){return Qp.then(cm=>{if(!pp())throw Dp(Wp),CANCELED;lm.loadingDepKey!=null&&lm.loadingDepPromise===Qp?Xp.atomValues.set(lm.loadingDepKey,loadableWithValue$2(cm)):Wp.getState().knownSelectors.forEach(em=>{Xp.atomValues.delete(em)});const gm=Tp(Wp,Xp);if(gm&&gm.state!=="loading"){if((Fp(Wp,Kp)||Pp(Wp)==null)&&xp(Wp,Kp),gm.state==="hasValue")return gm.contents;throw gm.contents}if(!Fp(Wp,Kp)){const em=Op(Wp,Xp);if(em!=null)return em.loadingLoadable.contents}const[Mm,dm]=Rp(Wp,Xp,Kp);if(Mm.state!=="loading"&&yp(Wp,Xp,Kp,Mm,dm),Mm.state==="hasError")throw Mm.contents;return Mm.contents}).catch(cm=>{if(cm instanceof Canceled)throw CANCELED;if(!pp())throw Dp(Wp),CANCELED;const gm=loadableWithError$1(cm);throw yp(Wp,Xp,Kp,gm,rm),cm})}function Ap(Wp,Qp,Xp,rm){var Kp,lm,cm,gm;if(Fp(Wp,rm)||Qp.version===((Kp=Wp.getState())===null||Kp===void 0||(lm=Kp.currentTree)===null||lm===void 0?void 0:lm.version)||Qp.version===((cm=Wp.getState())===null||cm===void 0||(gm=cm.nextTree)===null||gm===void 0?void 0:gm.version)){var Mm,dm,em;saveDepsToStore$1(np,Xp,Wp,(Mm=(dm=Wp.getState())===null||dm===void 0||(em=dm.nextTree)===null||em===void 0?void 0:em.version)!==null&&Mm!==void 0?Mm:Wp.getState().currentTree.version)}for(const sm of Xp)up.add(sm)}function Rp(Wp,Qp,Xp){const rm=startPerfBlock$1(np);let Kp=!0,lm=!0;const cm=()=>{rm(),lm=!1};let gm,Mm=!1,dm;const em={loadingDepKey:null,loadingDepPromise:null},sm=new Map;function Zp({key:fm}){const _m=getNodeLoadable$2(Wp,Qp,fm);switch(sm.set(fm,_m),Kp||(Ap(Wp,Qp,new Set(sm.keys()),Xp),_p(Wp,Xp)),_m.state){case"hasValue":return _m.contents;case"hasError":throw _m.contents;case"loading":throw em.loadingDepKey=fm,em.loadingDepPromise=_m.contents,_m.contents}throw Recoil_err("Invalid Loadable state")}const mm=fm=>(..._m)=>{if(lm)throw Recoil_err("Callbacks from getCallback() should only be called asynchronously after the selector is evalutated.  It can be used for selectors to return objects with callbacks that can work with Recoil state without a subscription.");return _d==null&&Recoil_invariant(!1),recoilCallback$1(Wp,fm,_m,{node:_d})};try{gm=ap({get:Zp,getCallback:mm}),gm=isRecoilValue$3(gm)?Zp(gm):gm,isLoadable$1(gm)&&(gm.state==="hasError"&&(Mm=!0),gm=gm.contents),Recoil_isPromise(gm)?gm=Ep(Wp,gm,Qp,sm,Xp,em).finally(cm):cm(),gm=gm instanceof WrappedValue$1?gm.value:gm}catch(fm){gm=fm,Recoil_isPromise(gm)?gm=Sp(Wp,gm,Qp,sm,Xp,em).finally(cm):(Mm=!0,cm())}return Mm?dm=loadableWithError$1(gm):Recoil_isPromise(gm)?dm=loadableWithPromise$1(gm):dm=loadableWithValue$2(gm),Kp=!1,zp(Wp,Xp,sm),Ap(Wp,Qp,new Set(sm.keys()),Xp),[dm,sm]}function Tp(Wp,Qp){let Xp=Qp.atomValues.get(np);if(Xp!=null)return Xp;const rm=new Set;try{Xp=cp.get(lm=>(typeof lm!="string"&&Recoil_invariant(!1),getNodeLoadable$2(Wp,Qp,lm).contents),{onNodeVisit:lm=>{lm.type==="branch"&&lm.nodeKey!==np&&rm.add(lm.nodeKey)}})}catch(lm){throw Recoil_err(`Problem with cache lookup for selector "${np}": ${lm.message}`)}if(Xp){var Kp;Qp.atomValues.set(np,Xp),Ap(Wp,Qp,rm,(Kp=Pp(Wp))===null||Kp===void 0?void 0:Kp.executionID)}return Xp}function Mp(Wp,Qp){const Xp=Tp(Wp,Qp);if(Xp!=null)return Dp(Wp),Xp;const rm=Op(Wp,Qp);if(rm!=null){var Kp;return((Kp=rm.loadingLoadable)===null||Kp===void 0?void 0:Kp.state)==="loading"&&bp(Wp,rm.executionID),rm.loadingLoadable}const lm=getNewExecutionID(),[cm,gm]=Rp(Wp,Qp,lm);return cm.state==="loading"?($p(Wp,lm,cm,gm,Qp),bp(Wp,lm)):(Dp(Wp),Lp(Qp,cm,gm)),cm}function Op(Wp,Qp){const Xp=Recoil_concatIterables([hp.has(Wp)?[Recoil_nullthrows(hp.get(Wp))]:[],Recoil_mapIterable(Recoil_filterIterable(hp,([Kp])=>Kp!==Wp),([,Kp])=>Kp)]);function rm(Kp){for(const[lm,cm]of Kp)if(!getNodeLoadable$2(Wp,Qp,lm).is(cm))return!0;return!1}for(const Kp of Xp){if(Kp.stateVersions.get(Qp.version)||!rm(Kp.depValuesDiscoveredSoFarDuringAsyncWork))return Kp.stateVersions.set(Qp.version,!0),Kp;Kp.stateVersions.set(Qp.version,!1)}}function Pp(Wp){return hp.get(Wp)}function $p(Wp,Qp,Xp,rm,Kp){hp.set(Wp,{depValuesDiscoveredSoFarDuringAsyncWork:rm,executionID:Qp,loadingLoadable:Xp,stateVersions:new Map([[Kp.version,!0]])})}function zp(Wp,Qp,Xp){if(Fp(Wp,Qp)){const rm=Pp(Wp);rm!=null&&(rm.depValuesDiscoveredSoFarDuringAsyncWork=Xp)}}function Dp(Wp){hp.delete(Wp)}function Fp(Wp,Qp){var Xp;return Qp===((Xp=Pp(Wp))===null||Xp===void 0?void 0:Xp.executionID)}function jp(Wp){return Array.from(Wp.entries()).map(([Qp,Xp])=>[Qp,Xp.contents])}function Lp(Wp,Qp,Xp){Wp.atomValues.set(np,Qp);try{cp.set(jp(Xp),Qp)}catch(rm){throw Recoil_err(`Problem with setting cache for selector "${np}": ${rm.message}`)}}function Bp(Wp){if(dependencyStack.includes(np)){const Qp=`Recoil selector has circular dependencies: ${dependencyStack.slice(dependencyStack.indexOf(np)).join("  ")}`;return loadableWithError$1(Recoil_err(Qp))}dependencyStack.push(np);try{return Wp()}finally{dependencyStack.pop()}}function Ip(Wp,Qp){const Xp=Qp.atomValues.get(np);return Xp??cp.get(rm=>{var Kp;return typeof rm!="string"&&Recoil_invariant(!1),(Kp=peekNodeLoadable$1(Wp,Qp,rm))===null||Kp===void 0?void 0:Kp.contents})}function kp(Wp,Qp){return Bp(()=>Mp(Wp,Qp))}function Up(Wp){Wp.atomValues.delete(np)}function Gp(Wp,Qp){_d==null&&Recoil_invariant(!1);for(const rm of up){var Xp;const Kp=getNode$6(rm);(Xp=Kp.clearCache)===null||Xp===void 0||Xp.call(Kp,Wp,Qp)}up.clear(),Up(Qp),cp.clear(),markRecoilValueModified$1(Wp,_d)}return lp!=null?_d=registerNode$1({key:np,nodeType:"selector",peek:Ip,get:kp,set:(Qp,Xp,rm)=>{let Kp=!1;const lm=new Map;function cm({key:em}){if(Kp)throw Recoil_err("Recoil: Async selector sets are not currently supported.");const sm=getNodeLoadable$2(Qp,Xp,em);if(sm.state==="hasValue")return sm.contents;if(sm.state==="loading"){const Zp=`Getting value of asynchronous atom or selector "${em}" in a pending state while setting selector "${np}" is not yet supported.`;throw Recoil_err(Zp)}else throw sm.contents}function gm(em,sm){if(Kp)throw Recoil_err("Recoil: Async selector sets are not currently supported.");const Zp=typeof sm=="function"?sm(cm(em)):sm;setNodeValue$3(Qp,Xp,em.key,Zp).forEach((fm,_m)=>lm.set(_m,fm))}function Mm(em){gm(em,DEFAULT_VALUE$6)}const dm=lp({set:gm,get:cm,reset:Mm},rm);if(dm!==void 0)throw Recoil_isPromise(dm)?Recoil_err("Recoil: Async selector sets are not currently supported."):Recoil_err("Recoil: selector set should be a void function.");return Kp=!0,lm},init:mp,invalidate:Up,clearCache:Gp,shouldDeleteConfigOnRelease:gp,dangerouslyAllowMutability:rp.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:dp}):_d=registerNode$1({key:np,nodeType:"selector",peek:Ip,get:kp,init:mp,invalidate:Up,clearCache:Gp,shouldDeleteConfigOnRelease:gp,dangerouslyAllowMutability:rp.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:dp})}selector.value=rp=>new WrappedValue$1(rp);var Recoil_selector=selector;const{isLoadable:isLoadable$2,loadableWithError:loadableWithError$2,loadableWithPromise:loadableWithPromise$2,loadableWithValue:loadableWithValue$3}=Recoil_Loadable$1,{WrappedValue:WrappedValue$2}=Recoil_Wrapper$1,{peekNodeInfo:peekNodeInfo$3}=Recoil_FunctionalCore,{DEFAULT_VALUE:DEFAULT_VALUE$7,DefaultValue:DefaultValue$2,getConfigDeletionHandler:getConfigDeletionHandler$2,registerNode:registerNode$2,setConfigDeletionHandler:setConfigDeletionHandler$1}=Recoil_Node,{isRecoilValue:isRecoilValue$4}=Recoil_RecoilValue$1,{getRecoilValueAsLoadable:getRecoilValueAsLoadable$4,markRecoilValueModified:markRecoilValueModified$2,setRecoilValue:setRecoilValue$4,setRecoilValueLoadable:setRecoilValueLoadable$2}=Recoil_RecoilValueInterface,{retainedByOptionWithDefault:retainedByOptionWithDefault$2}=Recoil_Retention,unwrap=rp=>rp instanceof WrappedValue$2?rp.value:rp;function baseAtom(rp){const{key:_d,persistence_UNSTABLE:np}=rp,ap=retainedByOptionWithDefault$2(rp.retainedBy_UNSTABLE);let sp=0;function lp(bp){return loadableWithPromise$2(bp.then(Ep=>(up=loadableWithValue$3(Ep),Ep)).catch(Ep=>{throw up=loadableWithError$2(Ep),Ep}))}let up=Recoil_isPromise(rp.default)?lp(rp.default):isLoadable$2(rp.default)?rp.default.state==="loading"?lp(rp.default.contents):rp.default:loadableWithValue$3(unwrap(rp.default));up.contents;let cp;const dp=new Map;function hp(bp){return bp}function fp(bp,Ep){const Sp=Ep.then(Ap=>{var Rp,Tp;return((Tp=((Rp=bp.getState().nextTree)!==null&&Rp!==void 0?Rp:bp.getState().currentTree).atomValues.get(_d))===null||Tp===void 0?void 0:Tp.contents)===Sp&&setRecoilValue$4(bp,vp,Ap),Ap}).catch(Ap=>{var Rp,Tp;throw((Tp=((Rp=bp.getState().nextTree)!==null&&Rp!==void 0?Rp:bp.getState().currentTree).atomValues.get(_d))===null||Tp===void 0?void 0:Tp.contents)===Sp&&setRecoilValueLoadable$2(bp,vp,loadableWithError$2(Ap)),Ap});return Sp}function pp(bp,Ep,Sp){var Ap;sp++;const Rp=()=>{var Pp;sp--,(Pp=dp.get(bp))===null||Pp===void 0||Pp.forEach($p=>$p()),dp.delete(bp)};if(bp.getState().knownAtoms.add(_d),up.state==="loading"){const Pp=()=>{var $p;(($p=bp.getState().nextTree)!==null&&$p!==void 0?$p:bp.getState().currentTree).atomValues.has(_d)||markRecoilValueModified$2(bp,vp)};up.contents.finally(Pp)}const Tp=(Ap=rp.effects)!==null&&Ap!==void 0?Ap:rp.effects_UNSTABLE;if(Tp!=null){let Pp=function(Up){if(Fp&&Up.key===_d){const Gp=Dp;return Gp instanceof DefaultValue$2?mp(bp,Ep):Recoil_isPromise(Gp)?loadableWithPromise$2(Gp.then(Wp=>Wp instanceof DefaultValue$2?up.toPromise():Wp)):loadableWithValue$3(Gp)}return getRecoilValueAsLoadable$4(bp,Up)},$p=function(Up){return Pp(Up).toPromise()},zp=function(Up){var Gp;const Wp=peekNodeInfo$3(bp,(Gp=bp.getState().nextTree)!==null&&Gp!==void 0?Gp:bp.getState().currentTree,Up.key);return Fp&&Up.key===_d&&!(Dp instanceof DefaultValue$2)?{...Wp,isSet:!0,loadable:Pp(Up)}:Wp},Dp=DEFAULT_VALUE$7,Fp=!0,jp=!1,Lp=null;const Bp=Up=>Gp=>{if(Fp){const Wp=Pp(vp),Qp=Wp.state==="hasValue"?Wp.contents:DEFAULT_VALUE$7;Dp=typeof Gp=="function"?Gp(Qp):Gp,Recoil_isPromise(Dp)&&(Dp=Dp.then(Xp=>(Lp={effect:Up,value:Xp},Xp)))}else{if(Recoil_isPromise(Gp))throw Recoil_err("Setting atoms to async values is not implemented.");typeof Gp!="function"&&(Lp={effect:Up,value:unwrap(Gp)}),setRecoilValue$4(bp,vp,typeof Gp=="function"?Wp=>{const Qp=unwrap(Gp(Wp));return Lp={effect:Up,value:Qp},Qp}:unwrap(Gp))}},Ip=Up=>()=>Bp(Up)(DEFAULT_VALUE$7),kp=Up=>Gp=>{var Wp;const{release:Qp}=bp.subscribeToTransactions(Xp=>{var rm;let{currentTree:Kp,previousTree:lm}=Xp.getState();lm||(lm=Kp);const cm=(rm=Kp.atomValues.get(_d))!==null&&rm!==void 0?rm:up;if(cm.state==="hasValue"){var gm,Mm,dm,em;const sm=cm.contents,Zp=(gm=lm.atomValues.get(_d))!==null&&gm!==void 0?gm:up,mm=Zp.state==="hasValue"?Zp.contents:DEFAULT_VALUE$7;((Mm=Lp)===null||Mm===void 0?void 0:Mm.effect)!==Up||((dm=Lp)===null||dm===void 0?void 0:dm.value)!==sm?Gp(sm,mm,!Kp.atomValues.has(_d)):((em=Lp)===null||em===void 0?void 0:em.effect)===Up&&(Lp=null)}},_d);dp.set(bp,[...(Wp=dp.get(bp))!==null&&Wp!==void 0?Wp:[],Qp])};for(const Up of Tp)try{const Gp=Up({node:vp,storeID:bp.storeID,parentStoreID_UNSTABLE:bp.parentStoreID,trigger:Sp,setSelf:Bp(Up),resetSelf:Ip(Up),onSet:kp(Up),getPromise:$p,getLoadable:Pp,getInfo_UNSTABLE:zp});if(Gp!=null){var Mp;dp.set(bp,[...(Mp=dp.get(bp))!==null&&Mp!==void 0?Mp:[],Gp])}}catch(Gp){Dp=Gp,jp=!0}if(Fp=!1,!(Dp instanceof DefaultValue$2)){var Op;const Up=jp?loadableWithError$2(Dp):Recoil_isPromise(Dp)?loadableWithPromise$2(fp(bp,Dp)):loadableWithValue$3(unwrap(Dp));Up.contents,Ep.atomValues.set(_d,Up),(Op=bp.getState().nextTree)===null||Op===void 0||Op.atomValues.set(_d,Up)}}return Rp}function mp(bp,Ep){var Sp,Ap;return(Sp=(Ap=Ep.atomValues.get(_d))!==null&&Ap!==void 0?Ap:cp)!==null&&Sp!==void 0?Sp:up}function gp(bp,Ep){if(Ep.atomValues.has(_d))return Recoil_nullthrows(Ep.atomValues.get(_d));if(Ep.nonvalidatedAtoms.has(_d)){if(cp!=null)return cp;if(np==null)return up;const Sp=Ep.nonvalidatedAtoms.get(_d),Ap=np.validator(Sp,DEFAULT_VALUE$7);return cp=Ap instanceof DefaultValue$2?up:loadableWithValue$3(Ap),cp}else return up}function yp(){cp=void 0}function xp(bp,Ep,Sp){if(Ep.atomValues.has(_d)){const Ap=Recoil_nullthrows(Ep.atomValues.get(_d));if(Ap.state==="hasValue"&&Sp===Ap.contents)return new Map}else if(!Ep.nonvalidatedAtoms.has(_d)&&Sp instanceof DefaultValue$2)return new Map;return cp=void 0,new Map().set(_d,loadableWithValue$3(Sp))}function _p(){return getConfigDeletionHandler$2(_d)!==void 0&&sp<=0}const vp=registerNode$2({key:_d,nodeType:"atom",peek:mp,get:gp,set:xp,init:pp,invalidate:yp,shouldDeleteConfigOnRelease:_p,dangerouslyAllowMutability:rp.dangerouslyAllowMutability,persistence_UNSTABLE:rp.persistence_UNSTABLE?{type:rp.persistence_UNSTABLE.type,backButton:rp.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0,retainedBy:ap});return vp}function atom(rp){const{..._d}=rp,np="default"in rp?rp.default:new Promise(()=>{});return isRecoilValue$4(np)?atomWithFallback({..._d,default:np}):baseAtom({..._d,default:np})}function atomWithFallback(rp){const _d=atom({...rp,default:DEFAULT_VALUE$7,persistence_UNSTABLE:rp.persistence_UNSTABLE===void 0?void 0:{...rp.persistence_UNSTABLE,validator:ap=>ap instanceof DefaultValue$2?ap:Recoil_nullthrows(rp.persistence_UNSTABLE).validator(ap,DEFAULT_VALUE$7)},effects:rp.effects,effects_UNSTABLE:rp.effects_UNSTABLE}),np=Recoil_selector({key:`${rp.key}__withFallback`,get:({get:ap})=>{const sp=ap(_d);return sp instanceof DefaultValue$2?rp.default:sp},set:({set:ap},sp)=>ap(_d,sp),cachePolicy_UNSTABLE:{eviction:"most-recent"},dangerouslyAllowMutability:rp.dangerouslyAllowMutability});return setConfigDeletionHandler$1(np.key,getConfigDeletionHandler$2(rp.key)),np}atom.value=rp=>new WrappedValue$2(rp);var Recoil_atom=atom;class MapCache{constructor(_d){var np;_defineProperty$1(this,"_map",void 0),_defineProperty$1(this,"_keyMapper",void 0),this._map=new Map,this._keyMapper=(np=_d==null?void 0:_d.mapKey)!==null&&np!==void 0?np:ap=>ap}size(){return this._map.size}has(_d){return this._map.has(this._keyMapper(_d))}get(_d){return this._map.get(this._keyMapper(_d))}set(_d,np){this._map.set(this._keyMapper(_d),np)}delete(_d){this._map.delete(this._keyMapper(_d))}clear(){this._map.clear()}}var Recoil_MapCache={MapCache},Recoil_MapCache_1=Recoil_MapCache.MapCache,Recoil_MapCache$1=Object.freeze({__proto__:null,MapCache:Recoil_MapCache_1});const{LRUCache:LRUCache$2}=Recoil_LRUCache$1,{MapCache:MapCache$1}=Recoil_MapCache$1,defaultPolicy$1={equality:"reference",eviction:"none",maxSize:1/0};function cacheFromPolicy({equality:rp=defaultPolicy$1.equality,eviction:_d=defaultPolicy$1.eviction,maxSize:np=defaultPolicy$1.maxSize}=defaultPolicy$1){const ap=getValueMapper$1(rp);return getCache(_d,np,ap)}function getValueMapper$1(rp){switch(rp){case"reference":return _d=>_d;case"value":return _d=>Recoil_stableStringify(_d)}throw Recoil_err(`Unrecognized equality policy ${rp}`)}function getCache(rp,_d,np){switch(rp){case"keep-all":return new MapCache$1({mapKey:np});case"lru":return new LRUCache$2({mapKey:np,maxSize:Recoil_nullthrows(_d)});case"most-recent":return new LRUCache$2({mapKey:np,maxSize:1})}throw Recoil_err(`Unrecognized eviction policy ${rp}`)}var Recoil_cacheFromPolicy=cacheFromPolicy;const{setConfigDeletionHandler:setConfigDeletionHandler$2}=Recoil_Node;function atomFamily(rp){var _d,np;const ap=Recoil_cacheFromPolicy({equality:(_d=(np=rp.cachePolicyForParams_UNSTABLE)===null||np===void 0?void 0:np.equality)!==null&&_d!==void 0?_d:"value",eviction:"keep-all"});return sp=>{var lp,up;const cp=ap.get(sp);if(cp!=null)return cp;const{cachePolicyForParams_UNSTABLE:dp,...hp}=rp,fp="default"in rp?rp.default:new Promise(()=>{}),pp=Recoil_atom({...hp,key:`${rp.key}__${(lp=Recoil_stableStringify(sp))!==null&&lp!==void 0?lp:"void"}`,default:typeof fp=="function"?fp(sp):fp,retainedBy_UNSTABLE:typeof rp.retainedBy_UNSTABLE=="function"?rp.retainedBy_UNSTABLE(sp):rp.retainedBy_UNSTABLE,effects:typeof rp.effects=="function"?rp.effects(sp):typeof rp.effects_UNSTABLE=="function"?rp.effects_UNSTABLE(sp):(up=rp.effects)!==null&&up!==void 0?up:rp.effects_UNSTABLE});return ap.set(sp,pp),setConfigDeletionHandler$2(pp.key,()=>{ap.delete(sp)}),pp}}var Recoil_atomFamily=atomFamily;const{setConfigDeletionHandler:setConfigDeletionHandler$3}=Recoil_Node;let nextIndex=0;function selectorFamily(rp){var _d,np;const ap=Recoil_cacheFromPolicy({equality:(_d=(np=rp.cachePolicyForParams_UNSTABLE)===null||np===void 0?void 0:np.equality)!==null&&_d!==void 0?_d:"value",eviction:"keep-all"});return sp=>{var lp;let up;try{up=ap.get(sp)}catch(mp){throw Recoil_err(`Problem with cache lookup for selector ${rp.key}: ${mp.message}`)}if(up!=null)return up;const cp=`${rp.key}__selectorFamily/${(lp=Recoil_stableStringify(sp,{allowFunctions:!0}))!==null&&lp!==void 0?lp:"void"}/${nextIndex++}`,dp=mp=>rp.get(sp)(mp),hp=rp.cachePolicy_UNSTABLE,fp=typeof rp.retainedBy_UNSTABLE=="function"?rp.retainedBy_UNSTABLE(sp):rp.retainedBy_UNSTABLE;let pp;if(rp.set!=null){const mp=rp.set;pp=Recoil_selector({key:cp,get:dp,set:(yp,xp)=>mp(sp)(yp,xp),cachePolicy_UNSTABLE:hp,dangerouslyAllowMutability:rp.dangerouslyAllowMutability,retainedBy_UNSTABLE:fp})}else pp=Recoil_selector({key:cp,get:dp,cachePolicy_UNSTABLE:hp,dangerouslyAllowMutability:rp.dangerouslyAllowMutability,retainedBy_UNSTABLE:fp});return ap.set(sp,pp),setConfigDeletionHandler$3(pp.key,()=>{ap.delete(sp)}),pp}}var Recoil_selectorFamily=selectorFamily;const constantSelector=Recoil_selectorFamily({key:"__constant",get:rp=>()=>rp,cachePolicyForParams_UNSTABLE:{equality:"reference"}});function constSelector(rp){return constantSelector(rp)}var Recoil_constSelector=constSelector;const throwingSelector=Recoil_selectorFamily({key:"__error",get:rp=>()=>{throw Recoil_err(rp)},cachePolicyForParams_UNSTABLE:{equality:"reference"}});function errorSelector(rp){return throwingSelector(rp)}var Recoil_errorSelector=errorSelector;function readOnlySelector(rp){return rp}var Recoil_readOnlySelector=readOnlySelector;const{loadableWithError:loadableWithError$3,loadableWithPromise:loadableWithPromise$3,loadableWithValue:loadableWithValue$4}=Recoil_Loadable$1;function concurrentRequests(rp,_d){const np=Array(_d.length).fill(void 0),ap=Array(_d.length).fill(void 0);for(const[sp,lp]of _d.entries())try{np[sp]=rp(lp)}catch(up){ap[sp]=up}return[np,ap]}function isError(rp){return rp!=null&&!Recoil_isPromise(rp)}function unwrapDependencies(rp){return Array.isArray(rp)?rp:Object.getOwnPropertyNames(rp).map(_d=>rp[_d])}function wrapResults(rp,_d){return Array.isArray(rp)?_d:Object.getOwnPropertyNames(rp).reduce((np,ap,sp)=>({...np,[ap]:_d[sp]}),{})}function wrapLoadables(rp,_d,np){const ap=np.map((sp,lp)=>sp==null?loadableWithValue$4(_d[lp]):Recoil_isPromise(sp)?loadableWithPromise$3(sp):loadableWithError$3(sp));return wrapResults(rp,ap)}function combineAsyncResultsWithSyncResults(rp,_d){return _d.map((np,ap)=>np===void 0?rp[ap]:np)}const waitForNone=Recoil_selectorFamily({key:"__waitForNone",get:rp=>({get:_d})=>{const np=unwrapDependencies(rp),[ap,sp]=concurrentRequests(_d,np);return wrapLoadables(rp,ap,sp)},dangerouslyAllowMutability:!0}),waitForAny=Recoil_selectorFamily({key:"__waitForAny",get:rp=>({get:_d})=>{const np=unwrapDependencies(rp),[ap,sp]=concurrentRequests(_d,np);return sp.some(lp=>!Recoil_isPromise(lp))?wrapLoadables(rp,ap,sp):new Promise(lp=>{for(const[up,cp]of sp.entries())Recoil_isPromise(cp)&&cp.then(dp=>{ap[up]=dp,sp[up]=void 0,lp(wrapLoadables(rp,ap,sp))}).catch(dp=>{sp[up]=dp,lp(wrapLoadables(rp,ap,sp))})})},dangerouslyAllowMutability:!0}),waitForAll=Recoil_selectorFamily({key:"__waitForAll",get:rp=>({get:_d})=>{const np=unwrapDependencies(rp),[ap,sp]=concurrentRequests(_d,np);if(sp.every(up=>up==null))return wrapResults(rp,ap);const lp=sp.find(isError);if(lp!=null)throw lp;return Promise.all(sp).then(up=>wrapResults(rp,combineAsyncResultsWithSyncResults(ap,up)))},dangerouslyAllowMutability:!0}),waitForAllSettled=Recoil_selectorFamily({key:"__waitForAllSettled",get:rp=>({get:_d})=>{const np=unwrapDependencies(rp),[ap,sp]=concurrentRequests(_d,np);return sp.every(lp=>!Recoil_isPromise(lp))?wrapLoadables(rp,ap,sp):Promise.all(sp.map((lp,up)=>Recoil_isPromise(lp)?lp.then(cp=>{ap[up]=cp,sp[up]=void 0}).catch(cp=>{ap[up]=void 0,sp[up]=cp}):null)).then(()=>wrapLoadables(rp,ap,sp))},dangerouslyAllowMutability:!0}),noWait=Recoil_selectorFamily({key:"__noWait",get:rp=>({get:_d})=>{try{return Recoil_selector.value(loadableWithValue$4(_d(rp)))}catch(np){return Recoil_selector.value(Recoil_isPromise(np)?loadableWithPromise$3(np):loadableWithError$3(np))}},dangerouslyAllowMutability:!0});var Recoil_WaitFor={waitForNone,waitForAny,waitForAll,waitForAllSettled,noWait};const{RecoilLoadable}=Recoil_Loadable$1,{DefaultValue:DefaultValue$3}=Recoil_Node,{RecoilRoot:RecoilRoot$2,useRecoilStoreID:useRecoilStoreID$1}=Recoil_RecoilRoot,{isRecoilValue:isRecoilValue$5}=Recoil_RecoilValue$1,{retentionZone:retentionZone$1}=Recoil_RetentionZone,{freshSnapshot:freshSnapshot$2}=Recoil_Snapshot$1,{useRecoilState:useRecoilState$1,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:useRecoilState_TRANSITION_SUPPORT_UNSTABLE$1,useRecoilStateLoadable:useRecoilStateLoadable$1,useRecoilValue:useRecoilValue$1,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:useRecoilValue_TRANSITION_SUPPORT_UNSTABLE$1,useRecoilValueLoadable:useRecoilValueLoadable$1,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE$1,useResetRecoilState:useResetRecoilState$1,useSetRecoilState:useSetRecoilState$1}=Recoil_Hooks,{useGotoRecoilSnapshot:useGotoRecoilSnapshot$1,useRecoilSnapshot:useRecoilSnapshot$1,useRecoilTransactionObserver:useRecoilTransactionObserver$1}=Recoil_SnapshotHooks,{useRecoilCallback:useRecoilCallback$1}=Recoil_useRecoilCallback,{noWait:noWait$1,waitForAll:waitForAll$1,waitForAllSettled:waitForAllSettled$1,waitForAny:waitForAny$1,waitForNone:waitForNone$1}=Recoil_WaitFor;var Recoil_index={DefaultValue:DefaultValue$3,isRecoilValue:isRecoilValue$5,RecoilLoadable,RecoilEnv:Recoil_RecoilEnv,RecoilRoot:RecoilRoot$2,useRecoilStoreID:useRecoilStoreID$1,useRecoilBridgeAcrossReactRoots_UNSTABLE:Recoil_useRecoilBridgeAcrossReactRoots,atom:Recoil_atom,selector:Recoil_selector,atomFamily:Recoil_atomFamily,selectorFamily:Recoil_selectorFamily,constSelector:Recoil_constSelector,errorSelector:Recoil_errorSelector,readOnlySelector:Recoil_readOnlySelector,noWait:noWait$1,waitForNone:waitForNone$1,waitForAny:waitForAny$1,waitForAll:waitForAll$1,waitForAllSettled:waitForAllSettled$1,useRecoilValue:useRecoilValue$1,useRecoilValueLoadable:useRecoilValueLoadable$1,useRecoilState:useRecoilState$1,useRecoilStateLoadable:useRecoilStateLoadable$1,useSetRecoilState:useSetRecoilState$1,useResetRecoilState:useResetRecoilState$1,useGetRecoilValueInfo_UNSTABLE:Recoil_useGetRecoilValueInfo,useRecoilRefresher_UNSTABLE:Recoil_useRecoilRefresher,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE$1,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:useRecoilValue_TRANSITION_SUPPORT_UNSTABLE$1,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:useRecoilState_TRANSITION_SUPPORT_UNSTABLE$1,useRecoilCallback:useRecoilCallback$1,useRecoilTransaction_UNSTABLE:Recoil_useRecoilTransaction,useGotoRecoilSnapshot:useGotoRecoilSnapshot$1,useRecoilSnapshot:useRecoilSnapshot$1,useRecoilTransactionObserver_UNSTABLE:useRecoilTransactionObserver$1,snapshot_UNSTABLE:freshSnapshot$2,useRetain:Recoil_useRetain,retentionZone:retentionZone$1},Recoil_index_5=Recoil_index.RecoilRoot,Recoil_index_8=Recoil_index.atom,Recoil_index_20=Recoil_index.useRecoilValue,Recoil_index_22=Recoil_index.useRecoilState,Recoil_index_24=Recoil_index.useSetRecoilState;const fishSpotListAtom=Recoil_index_8({key:"fishSpotListAtom",default:[]}),prevPathAtom=Recoil_index_8({key:"prevPathAtom",default:""}),activeMarkerAtom=Recoil_index_8({key:"activeMarkerAtom",default:null}),searchTermAtom=Recoil_index_8({key:"searchTermAtom",default:""}),centerChangeAtom=Recoil_index_8({key:"centerChangeAtom",default:!1}),searchModeAtom=Recoil_index_8({key:"searchModeAtom",default:"location"}),filterModeAtom=Recoil_index_8({key:"filterModeAtom",default:"dist"}),mapLevelAtom=Recoil_index_8({key:"mapLevelAtom",default:9}),mapCenterAtom=Recoil_index_8({key:"mapCenterAtom",default:{lat:0,lng:0}}),myCenterAtom=Recoil_index_8({key:"myCenterAtom",default:{center:{lat:0,lng:0},errMsg:null,isLoading:!1}});var CloseOutlined={},_interopRequireDefault$A=interopRequireDefaultExports;Object.defineProperty(CloseOutlined,"__esModule",{value:!0});var default_1$r=CloseOutlined.default=void 0,_createSvgIcon$r=_interopRequireDefault$A(requireCreateSvgIcon()),_jsxRuntime$r=jsxRuntimeExports;default_1$r=CloseOutlined.default=(0,_createSvgIcon$r.default)((0,_jsxRuntime$r.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"CloseOutlined");var FilterAltOutlined={},_interopRequireDefault$z=interopRequireDefaultExports;Object.defineProperty(FilterAltOutlined,"__esModule",{value:!0});var default_1$q=FilterAltOutlined.default=void 0,_createSvgIcon$q=_interopRequireDefault$z(requireCreateSvgIcon()),_jsxRuntime$q=jsxRuntimeExports;default_1$q=FilterAltOutlined.default=(0,_createSvgIcon$q.default)((0,_jsxRuntime$q.jsx)("path",{d:"M7 6h10l-5.01 6.3zm-2.75-.39C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAltOutlined");const fetchRegion=async()=>{try{return(await axios.get("https://grpc-proxy-server-mkvo6j4wsq-du.a.run.app/v1/regcodes?regcode_pattern=*00000000")).data.regcodes.filter(_d=>_d.name!=="")}catch(rp){console.log(rp)}},FishMapHeader=({hashTags:rp,mapRef:_d,getDistance:np})=>{const[ap,sp]=reactExports.useState([]),[lp,up]=reactExports.useState(!1),[cp,dp]=Recoil_index_22(searchModeAtom),[hp,fp]=Recoil_index_22(searchTermAtom),pp=Recoil_index_24(mapLevelAtom),mp=Recoil_index_24(centerChangeAtom),gp=Recoil_index_24(fishSpotListAtom),yp=Recoil_index_24(activeMarkerAtom),xp=Recoil_index_20(myCenterAtom),_p=Rp=>{const Tp=_d.current;Tp&&(Tp.setLevel(13),Tp.setCenter(new kakao.maps.LatLng(36.172823447489336,127.8675122717897)),pp(13),mp(!1),yp(null))},vp=async Rp=>{try{const Mp=(await axios.get("https://i10c203.p.ssafy.io/api/spots",{params:Rp})).data.spots.map(Op=>{const Pp=np(xp.center.lat,xp.center.lng,Op==null?void 0:Op.latitude,Op==null?void 0:Op.longitude);return{...Op,dist:Pp}});gp(Mp),_p()}catch(Tp){console.log(Tp)}},bp=Rp=>{Rp.preventDefault();let Tp={};cp==="location"||cp==="hash"?Tp.keyword=Rp.type==="submit"?cp==="location"?hp:`#${hp}`:`#${Rp.target.value}`:Tp.sido=Rp.target.value,vp(Tp)},Ep=Rp=>{dp(Rp.target.value),up(!1),fp("")},Sp=async()=>{try{const Rp=await fetchRegion();sp(Rp)}catch{console.log(err)}},Ap=reactExports.useMemo(()=>rp.map((Rp,Tp)=>jsxRuntimeExports.jsxs("div",{className:"input-container",children:[jsxRuntimeExports.jsx("input",{id:`${Rp}`,className:"radio-button",type:"radio",name:"radio",checked:hp===Rp.substring(1),value:Rp.substring(1),onChange:Mp=>{fp(Mp.target.value),bp(Mp)}}),jsxRuntimeExports.jsx("div",{className:"radio-tile",children:jsxRuntimeExports.jsx("label",{htmlFor:`${Rp}`,className:"radio-tile-label",children:Rp})})]},Tp)),[rp,hp]);return reactExports.useEffect(()=>{Sp()},[]),jsxRuntimeExports.jsxs("div",{className:`FishMapHeader ${cp==="hash"&&"expand"}`,children:[jsxRuntimeExports.jsxs("div",{className:`wrapper ${cp==="hash"&&"expand"}`,children:[jsxRuntimeExports.jsxs("div",{className:"wrapper1",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",id:"toogle",className:"hidden-trigger",checked:lp,onChange:()=>up(!lp)}),jsxRuntimeExports.jsx("label",{htmlFor:"toogle",className:"circle",children:jsxRuntimeExports.jsx(default_1$q,{})}),jsxRuntimeExports.jsxs("div",{className:"subs",children:[jsxRuntimeExports.jsxs("button",{className:"sub-circle",children:[jsxRuntimeExports.jsx("input",{value:"location",name:"sub-circle",type:"radio",id:"sub1",className:"hidden-sub-trigger",onClick:Ep}),jsxRuntimeExports.jsx("label",{htmlFor:"sub1",children:""})]}),jsxRuntimeExports.jsxs("button",{className:"sub-circle",children:[jsxRuntimeExports.jsx("input",{value:"region",name:"sub-circle",type:"radio",id:"sub2",className:"hidden-sub-trigger",onClick:Ep}),jsxRuntimeExports.jsx("label",{htmlFor:"sub2",children:""})]}),jsxRuntimeExports.jsxs("button",{className:"sub-circle",children:[jsxRuntimeExports.jsx("input",{value:"hash",name:"sub-circle",type:"radio",id:"sub3",className:"hidden-sub-trigger",onClick:Ep}),jsxRuntimeExports.jsx("label",{htmlFor:"sub3",children:""})]})]})]}),cp==="region"?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("select",{value:hp,onChange:Rp=>{bp(Rp),fp(Rp.target.value)},children:[jsxRuntimeExports.jsx("option",{value:"",disabled:!0,children:""}),ap.map(Rp=>jsxRuntimeExports.jsx("option",{value:Rp.name,children:Rp.name},Rp.code))]})}):jsxRuntimeExports.jsx("form",{onSubmit:bp,children:jsxRuntimeExports.jsx("input",{type:"text",placeholder:cp==="location"?" ":" ",value:hp,onChange:Rp=>fp(Rp.target.value)})}),jsxRuntimeExports.jsx("div",{className:"search",onClick:()=>fp(""),children:hp&&jsxRuntimeExports.jsx(default_1$r,{})})]}),cp&&jsxRuntimeExports.jsx("div",{className:"hashTags",children:Ap})]})},useIsomorphicLayoutEffect$2=typeof window<"u"&&typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect,useKakaoEvent=(rp,_d,np)=>{useIsomorphicLayoutEffect$2(()=>{if(!rp||!np)return;const ap=function(){for(var sp=arguments.length,lp=new Array(sp),up=0;up<sp;up++)lp[up]=arguments[up];return lp===void 0?np(rp):np(rp,...lp)};return kakao.maps.event.addListener(rp,_d,ap),()=>{kakao.maps.event.removeListener(rp,_d,ap)}},[rp,_d,np])},SIGNATURE="__react-kakao-maps-sdk__";let LoaderStatus=function(rp){return rp[rp.INITIALIZED=0]="INITIALIZED",rp[rp.LOADING=1]="LOADING",rp[rp.SUCCESS=2]="SUCCESS",rp[rp.FAILURE=3]="FAILURE",rp}({});const DEFAULT_ID=`${SIGNATURE}_Loader`;var Cv;let Loader$1=(Cv=class{constructor(_d){Zv(this,"callbacks",[]);Zv(this,"done",!1);Zv(this,"loading",!1);Zv(this,"errors",[]);let{appkey:np,id:ap=DEFAULT_ID,libraries:sp=[],nonce:lp,retries:up=3,url:cp="//dapi.kakao.com/v2/maps/sdk.js"}=_d;if(this.id=ap,this.appkey=np,this.libraries=sp,this.nonce=lp,this.retries=up,this.url=cp,Cv.instance&&!Cv.equalOptions(this.options,Cv.instance.options)&&!Cv.equalOptions(this.options,Cv.instance.options))switch(Cv.instance.status){case LoaderStatus.FAILURE:throw new Error(`Loader must not be called again with different options. 
${JSON.stringify(this.options,null,2)}
!==
${JSON.stringify(Cv.instance.options,null,2)}`);default:Cv.instance.reset(),Cv.instance=this;break}return Cv.instance||(Cv.instance=this),Cv.instance}get options(){return{appkey:this.appkey,id:this.id,libraries:this.libraries,nonce:this.nonce,retries:this.retries,url:this.url}}static addLoadEventLisnter(_d){return window.kakao&&window.kakao.maps&&window.kakao.maps.load(_d),Cv.loadEventCallback.add(_d),_d}static removeLoadEventLisnter(_d){return Cv.loadEventCallback.delete(_d)}load(){return new Promise((_d,np)=>{this.loadCallback(ap=>{ap?np(ap):_d(window.kakao)})})}get status(){return this.onEvent?LoaderStatus.FAILURE:this.done?LoaderStatus.SUCCESS:this.loading?LoaderStatus.LOADING:LoaderStatus.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}loadCallback(_d){this.callbacks.push(_d),this.execute()}resetIfRetryingFailed(){this.failed&&this.reset()}reset(){this.deleteScript(),this.done=!0,this.loading=!1,this.errors=[],this.onEvent=void 0}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.kakao&&window.kakao.maps){console.warn("Kakao Maps      .      ,       ."),window.kakao.maps.load(this.callback);return}this.loading||(this.loading=!0,this.setScript())}}setScript(){document.getElementById(this.id)&&this.callback();const _d=this.createUrl(),np=document.createElement("script");np.id=this.id,np.type="text/javascript",np.src=_d,np.onerror=this.loadErrorCallback.bind(this),np.onload=this.callback.bind(this),np.defer=!0,np.async=!0,this.nonce&&(np.nonce=this.nonce),document.head.appendChild(np)}loadErrorCallback(_d){if(this.errors.push(_d),this.errors.length<=this.retries){const np=this.errors.length*2**this.errors.length;console.log(`Failed to load Kakao Maps script, retrying in ${np} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},np)}else this.done=!0,this.loading=!1,this.onEvent=this.errors[this.errors.length-1],this.callbacks.forEach(np=>{np(this.onEvent)}),this.callbacks=[],Cv.loadEventCallback.forEach(np=>{np(this.onEvent)})}createUrl(){let _d=this.url;return _d+=`?appkey=${this.appkey}`,this.libraries.length&&(_d+=`&libraries=${this.libraries.join(",")}`),_d+="&autoload=false",_d}deleteScript(){const _d=document.getElementById(this.id);_d&&_d.remove()}callback(){kakao.maps.load(()=>{Cv.instance.done=!0,Cv.instance.loading=!1,Cv.instance.callbacks.forEach(_d=>{_d(Cv.instance.onEvent)}),Cv.instance.callbacks=[],Cv.loadEventCallback.forEach(_d=>{_d(Cv.instance.onEvent)})})}static equalOptions(_d,np){if(_d.appkey!==np.appkey||_d.id!==np.id||_d.libraries.length!==np.libraries.length)return!1;for(let ap=0;ap<_d.libraries.length;++ap)if(_d.libraries[ap]!==np.libraries[ap])return!1;return!(_d.nonce!==np.nonce||_d.retries!==np.retries||_d.url!==np.url)}},Zv(Cv,"loadEventCallback",new Set),Cv);const useKakaoMapsSetEffect=function(rp,_d){for(var np=arguments.length,ap=new Array(np>2?np-2:0),sp=2;sp<np;sp++)ap[sp-2]=arguments[sp];useIsomorphicLayoutEffect$2(()=>{!rp||ap.every(lp=>typeof lp>"u")||rp[_d].call(rp,...ap)},[rp,_d,...ap])},KakaoMapContext=React.createContext(void 0),Map$1=React.forwardRef(function rp(_d,np){let{id:ap,as:sp,children:lp,center:up,isPanto:cp=!1,padding:dp=32,disableDoubleClick:hp,disableDoubleClickZoom:fp,draggable:pp,zoomable:mp,keyboardShortcuts:gp,level:yp,maxLevel:xp,minLevel:_p,mapTypeId:vp,projectionId:bp,scrollwheel:Ep,tileAnimation:Sp,onBoundsChanged:Ap,onCenterChanged:Rp,onClick:Tp,onDoubleClick:Mp,onDrag:Op,onDragEnd:Pp,onDragStart:$p,onIdle:zp,onMaptypeidChanged:Dp,onMouseMove:Fp,onRightClick:jp,onTileLoaded:Lp,onZoomChanged:Bp,onZoomStart:Ip,onCreate:kp,...Up}=_d;const Gp=sp||"div",[Wp,Qp]=reactExports.useState(!1),[Xp,rm]=reactExports.useState(),Kp=reactExports.useRef(null);return useIsomorphicLayoutEffect$2(()=>{const lm=Loader$1.addLoadEventLisnter(cm=>Qp(!cm));return()=>{Loader$1.removeLoadEventLisnter(lm)}},[]),useIsomorphicLayoutEffect$2(()=>{if(!Wp)return;const lm=Kp.current;if(!lm)return;const cm="lat"in up?new kakao.maps.LatLng(up.lat,up.lng):new kakao.maps.Coords(up.x,up.y),gm=new kakao.maps.Map(lm,{center:cm,disableDoubleClick:hp,disableDoubleClickZoom:fp,draggable:pp,keyboardShortcuts:gp,level:yp,mapTypeId:typeof vp=="string"?kakao.maps.MapTypeId[vp]:vp,projectionId:bp,scrollwheel:Ep,tileAnimation:Sp});return rm(gm),()=>{lm.innerHTML=""}},[Wp,hp,fp,Sp]),reactExports.useImperativeHandle(np,()=>Xp,[Xp]),useIsomorphicLayoutEffect$2(()=>{!Xp||!kp||kp(Xp)},[Xp,kp]),useIsomorphicLayoutEffect$2(()=>{if(!Xp)return;let lm=Xp.getCenter();lm instanceof kakao.maps.Coords&&(lm=lm.toLatLng());const cm="lat"in up?new kakao.maps.LatLng(up.lat,up.lng):new kakao.maps.Coords(up.x,up.y);cm instanceof kakao.maps.LatLng&&cm.equals(lm)||cm instanceof kakao.maps.Coords&&cm.toLatLng().equals(lm)||(cp?Xp.panTo(cm,dp):Xp.setCenter(cm))},[Xp,up.lat,up.lng,up.x,up.y]),useKakaoMapsSetEffect(Xp,"setDraggable",pp),useKakaoMapsSetEffect(Xp,"setZoomable",mp),useKakaoMapsSetEffect(Xp,"setKeyboardShortcuts",gp),useKakaoMapsSetEffect(Xp,"setLevel",yp),useKakaoMapsSetEffect(Xp,"setMapTypeId",Wp?typeof vp=="string"?kakao.maps.MapTypeId[vp]:vp:void 0),useKakaoMapsSetEffect(Xp,"setProjectionId",bp),useKakaoMapsSetEffect(Xp,"setMinLevel",xp),useKakaoMapsSetEffect(Xp,"setMaxLevel",_p),useKakaoEvent(Xp,"bounds_changed",Ap),useKakaoEvent(Xp,"center_changed",Rp),useKakaoEvent(Xp,"click",Tp),useKakaoEvent(Xp,"dblclick",Mp),useKakaoEvent(Xp,"drag",Op),useKakaoEvent(Xp,"dragstart",$p),useKakaoEvent(Xp,"dragend",Pp),useKakaoEvent(Xp,"idle",zp),useKakaoEvent(Xp,"maptypeid_changed",Dp),useKakaoEvent(Xp,"mousemove",Fp),useKakaoEvent(Xp,"rightclick",jp),useKakaoEvent(Xp,"tilesloaded",Lp),useKakaoEvent(Xp,"zoom_changed",Bp),useKakaoEvent(Xp,"zoom_start",Ip),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Gp,{id:ap||`${SIGNATURE}_Map`,...Up,ref:Kp}),Xp&&jsxRuntimeExports.jsx(KakaoMapContext.Provider,{value:Xp,children:lp})]})}),useMap=rp=>{const _d=reactExports.useContext(KakaoMapContext);if(!_d)throw new Error(`${rp?rp+" Component":"useMap"} must exist inside Map Component!`);return _d},InfoWindow=React.forwardRef(function rp(_d,np){let{map:ap,position:sp,marker:lp,children:up,altitude:cp,disableAutoPan:dp,range:hp,removable:fp,zIndex:pp,onCreate:mp}=_d;const gp=reactExports.useRef(document.createElement("div")),yp=reactExports.useMemo(()=>{const xp=new kakao.maps.InfoWindow({altitude:cp,disableAutoPan:dp,range:hp,removable:fp,zIndex:pp,content:gp.current,position:sp});return gp.current.style.display="none",xp},[dp,fp]);return reactExports.useImperativeHandle(np,()=>yp,[yp]),reactExports.useLayoutEffect(()=>(yp.open(ap,lp),()=>{yp.close()}),[ap,lp]),reactExports.useLayoutEffect(()=>{mp&&mp(yp)},[yp,mp]),useKakaoMapsSetEffect(yp,"setPosition",sp),useKakaoMapsSetEffect(yp,"setAltitude",cp),useKakaoMapsSetEffect(yp,"setRange",hp),useKakaoMapsSetEffect(yp,"setZIndex",pp),gp.current.parentElement&&ReactDOM.createPortal(up,gp.current.parentElement)}),KakaoMapMarkerClustererContext=React.createContext(void 0),MarkerClusterer=React.forwardRef(function rp(_d,np){let{onClusterclick:ap,onClusterdblclick:sp,onClustered:lp,onClusterout:up,onClusterover:cp,onClusterrightclick:dp,onCreate:hp,...fp}=_d;const{children:pp,averageCenter:mp,calculator:gp,clickable:yp,disableClickZoom:xp,gridSize:_p,hoverable:vp,minClusterSize:bp,minLevel:Ep,styles:Sp,texts:Ap}=fp,Rp=useMap("MarkerClusterer"),Tp=reactExports.useMemo(()=>{if(!window.kakao.maps.MarkerClusterer){console.warn("clusterer      . `https://apis.map.kakao.com/web/guide/#loadlibrary`");return}return new kakao.maps.MarkerClusterer({averageCenter:mp,calculator:gp,clickable:yp,disableClickZoom:xp,gridSize:_p,hoverable:vp,minClusterSize:bp,minLevel:Ep,styles:Sp,texts:Ap})},[]);return reactExports.useImperativeHandle(np,()=>Tp,[Tp]),reactExports.useLayoutEffect(()=>{if(Tp)return Tp.setMap(Rp),()=>{Tp.setMap(null)}},[Rp,Tp]),reactExports.useLayoutEffect(()=>{Tp&&hp&&hp(Tp)},[Tp,hp]),useKakaoMapsSetEffect(Tp,"setGridSize",_p),useKakaoMapsSetEffect(Tp,"setMinClusterSize",bp),useKakaoMapsSetEffect(Tp,"setAverageCenter",mp),useKakaoMapsSetEffect(Tp,"setAverageCenter",mp),useKakaoMapsSetEffect(Tp,"setMinLevel",Ep),useKakaoMapsSetEffect(Tp,"setTexts",Ap),useKakaoMapsSetEffect(Tp,"setCalculator",gp),useKakaoMapsSetEffect(Tp,"setStyles",Sp),useKakaoEvent(Tp,"clustered",lp),useKakaoEvent(Tp,"clusterclick",ap),useKakaoEvent(Tp,"clusterover",cp),useKakaoEvent(Tp,"clusterout",up),useKakaoEvent(Tp,"clusterdblclick",sp),useKakaoEvent(Tp,"clusterrightclick",dp),Tp?jsxRuntimeExports.jsxs(KakaoMapMarkerClustererContext.Provider,{value:Tp,children:[pp,jsxRuntimeExports.jsx(MarkerClustererRedraw,{...fp})]}):null}),MarkerClustererRedraw=()=>{const rp=reactExports.useContext(KakaoMapMarkerClustererContext);return useIsomorphicLayoutEffect$2(()=>{rp.redraw()}),null},Marker=React.forwardRef(function rp(_d,np){let{map:ap,position:sp,children:lp,altitude:up,clickable:cp,draggable:dp,image:hp,infoWindowOptions:fp,onCreate:pp,onClick:mp,onDragEnd:gp,onDragStart:yp,onMouseOut:xp,onMouseOver:_p,opacity:vp,range:bp,title:Ep,zIndex:Sp}=_d;const Ap=reactExports.useContext(KakaoMapMarkerClustererContext),Rp=reactExports.useMemo(()=>{var Mp,Op,Pp,$p,zp,Dp,Fp,jp,Lp,Bp,Ip,kp;return hp&&new kakao.maps.MarkerImage(hp.src,new kakao.maps.Size(hp.size.width,hp.size.height),{alt:(Mp=hp.options)==null?void 0:Mp.alt,coords:(Op=hp.options)==null?void 0:Op.coords,offset:((Pp=hp.options)==null?void 0:Pp.offset)&&new kakao.maps.Point(($p=hp.options)==null?void 0:$p.offset.x,(zp=hp.options)==null?void 0:zp.offset.y),shape:(Dp=hp.options)==null?void 0:Dp.shape,spriteOrigin:((Fp=hp.options)==null?void 0:Fp.spriteOrigin)&&new kakao.maps.Point((jp=hp.options)==null?void 0:jp.spriteOrigin.x,(Lp=hp.options)==null?void 0:Lp.spriteOrigin.y),spriteSize:((Bp=hp.options)==null?void 0:Bp.spriteSize)&&new kakao.maps.Size((Ip=hp.options)==null?void 0:Ip.spriteSize.width,(kp=hp.options)==null?void 0:kp.spriteSize.height)})},[JSON.stringify(hp)]),Tp=reactExports.useMemo(()=>new kakao.maps.Marker({altitude:up,clickable:cp,draggable:dp,image:Rp,opacity:vp,range:bp,title:Ep,zIndex:Sp,position:sp}),[]);return reactExports.useImperativeHandle(np,()=>Tp,[Tp]),reactExports.useLayoutEffect(()=>Ap?(Ap.addMarker(Tp,!0),()=>Ap.removeMarker(Tp,!0)):(Tp.setMap(ap),()=>Tp.setMap(null)),[ap,Ap,Tp]),reactExports.useLayoutEffect(()=>{pp&&pp(Tp)},[Tp,pp]),useKakaoMapsSetEffect(Tp,"setPosition",sp),useKakaoMapsSetEffect(Tp,"setImage",Rp),useKakaoMapsSetEffect(Tp,"setAltitude",up),useKakaoMapsSetEffect(Tp,"setClickable",cp),useKakaoMapsSetEffect(Tp,"setDraggable",dp),useKakaoMapsSetEffect(Tp,"setOpacity",vp),useKakaoMapsSetEffect(Tp,"setRange",bp),useKakaoMapsSetEffect(Tp,"setRange",bp),useKakaoMapsSetEffect(Tp,"setTitle",Ep),useKakaoMapsSetEffect(Tp,"setTitle",Ep),useKakaoMapsSetEffect(Tp,"setZIndex",Sp),useKakaoEvent(Tp,"click",mp),useKakaoEvent(Tp,"dragstart",yp),useKakaoEvent(Tp,"dragend",gp),useKakaoEvent(Tp,"mouseout",xp),useKakaoEvent(Tp,"mouseover",_p),lp?jsxRuntimeExports.jsx(InfoWindow,{position:sp,map:ap,marker:Tp,altitude:fp==null?void 0:fp.altitude,disableAutoPan:fp==null?void 0:fp.disableAutoPan,range:fp==null?void 0:fp.range,removable:fp==null?void 0:fp.removable,zIndex:fp==null?void 0:fp.zIndex,children:lp}):null}),MapMarker=React.forwardRef(function rp(_d,np){let{position:ap,...sp}=_d;const lp=useMap("MapMarker"),up=reactExports.useMemo(()=>"lat"in ap?new kakao.maps.LatLng(ap.lat,ap.lng):new kakao.maps.Coords(ap.x,ap.y).toLatLng(),[ap.lat,ap.lng,ap.x,ap.y]);return jsxRuntimeExports.jsx(Marker,{map:lp,position:up,...sp,ref:np})}),MarkerOff="data:image/webp;base64,UklGRtgCAABXRUJQVlA4WAoAAAAQAAAAHwAAKwAAQUxQSBMBAAABgJttk+LmT8yYbWROVYCZ7UjVmNmOmU4tmB0qMkXcgTLdVSBbTDPBSbszHUTEBMCyYTH2nkj/J95jiw0QNLE/tkzFjEvTQZod0wdNVuaDBT+MRSRgUT9SxwQsHJgajR8s/tEYOmDFAwAmrZE2gMeqHhpSOqmGRVZe9LS8d633hFYirZXOamV9LT+uFd/QWh8k0iAaxDOrPgNjTHLEYwBuWPEGALqTcsnuEMYrJEOVcdReYpIgXkL9LSY34i3Y7jG5EO/B/pqdr+HYHbgE3S6YIbIhmoH7GVufQbDNt/HbJBBlqkUchewT132C8FCJQlQakoLHNT2Im0woY+RwGDqEYk+ZqNyjgVvmW6gOMw/r4PcXrgBWUDggngEAALALAJ0BKiAALAA+USSORSOiIRVUADgFBLYATpzQvwD8ANMB+AH7AcYF2zw2L5L9wFuAb4B1gHoAeTd+wHwAfsp6WKeA91FqasMUcmuvOKM1uRwhib+1zQp4M67tIA8agRdlYrOUAAD+8NougUKFk/jo3j6yzB8n/zkVSvKxZhwKAGU4Ojbc6noGBrPGTW6XJ0Vxwe3apum1rhvGVhE949vQdd08lOLpUdMhPcrvwEyBxWviIYHaEZ0f1VttULL6LjRjrGTpJuQd54esVvv4OKcuB+KkWOSYk8Lt54kxmHh23O9kacVfj/2t0IQ2rL4+0/MscPVB0aQ3R1JbPHsbMST0QsPwBmdLw1x3pseJ4aKlgXFb18N2R3p3/xHwqaZ7wI7X6v5GK7SmL40A2SQ0sn0Bfp8Gsdy3IaXFMRzEsBR323ClqAC/9lrOpGHpa41SCXZYMPIYP7giGLHGI3eCvqGYAZGYOfyhdwV7eBIT80Uf5OLZ/8upxFsZRRreo/wMm+v3Fswi3F4821BsGSXf84k12V26kgi0f3ABccoAAA==",MarkerOn="data:image/webp;base64,UklGRgAGAABXRUJQVlA4WAoAAAAQAAAAOwAAUwAAQUxQSCkCAAABkHPbtqq1a9qBb2Bl5PuIdLTUcU+wOlZRu1daUQfqOP4H4u7ulXvSMlzfJ2dHntx3TkRMAByXVHQPP/k+6XmT358Md1eUQG+y/b7HiN799qSO3RcypEQRMnNhd3x7H5BCp0I+2BtP6QQpdC7kRGkMNdMUxiqcrnHWmaPCXKebgiGKBuFQgYO1jyhUKXy0NlLBIyp+VBBliKqHInRSNAk7Q1VnhaolWx2idJrqp0uDJmhwImAPRZ9wj999mrzvs5tiQbjrv/M0eh5AMiM2JJME2mi2Dbhn5x5KPLEiXkkFDVd0WeoasjT02NLj75a+T1qa9Cx5i5YWf1r6+dLSywuWzvdZ6ttraW9xWqxIuhgXafYicMTOYaBwyspUIYABK8cBILUkFmQp9R8GaXIQvqk5C3MpP3RY6EBg/lt9b/ODsDUruiS7FWH7qbwfoRNPdT1NhEPZtKbpMkStyIoWyVYgejNFh7AZLk9QNAhPwGniNlXeTrjB6i8avqyG6/KF+BbK4f4YJR7hMcQ5QIlDOIBYE3cY651EPEj+juN3EnFv9sSVeJsRfw+d90BhwXtX7ws0YB/FhXAfdI7R6RiUpqZdTKe0oJESRdgItXkvGPlFnh7URKuB5ldRXkP1oSiHdK16F+5dni7UhquF8sS3MN8S2lAfph7qS+bET+ZK9OEMA8/A4M6gnRbwye8TTPb49djYlBNScpts4BpJXoPRPTkyt8cK6j9+rEOsAFZQOCCwAwAAsBYAnQEqPABUAD5NHotEIqGhGAqvVCgExLYAY5a2fwD8gO2WwL2D8mfyA7DrXTujjAXup+Y+3ftAeYB+jfSA/h/oA/ZT9dPeA9AHoAfy3/XerT6gHoAeVx+zvwMfuh+3PtTZhz2wN4AGhSZav6yp5C2nEjWxvN95W9yK3ZIr1HwbRuW+SegOIB+MPJCQ2fflkImIz3qyQzt4Ko/2EU6LezLngrqDItvWS+h6Rk2RvMzU/dgtpy4WoINO41IvgAD+/HoC1FerDpEk4b6/CO8qCBVoL/+/NA3DMTmjRYOWyCPg191bfRwyIoAMNz0UpkDIvoB/X8f/9Q4kf/7H4XEL2ncvPuu8cfarpb+0ArX/a8/VeRK4CHNMVoVDtD5RW3IBoVKaeSnsKXCLAQCIgsB9MuUOFw14iSVnxn3KXD/vrXoCVYDfraMXinG3JN+b8LwNRQFZLrlmOWONoqiTrNRYtqejvt0LqVys7cB82p1uHwuP7CRvADQBZlVpN37ASZIqdvPFb0Q44B79X9pBJP2hil5XFH0/KczP67ba8YV3vr+DqDlWZ1BB3lAV1xs3Dj4O/+HMS7Yd/Enpd5a/u/OwHkmRHyjMBuJlniI/c+rUrYXSSJC3MMfsvOVLX9ZNNKnH+urp1j2wm3N8Z6P5hn3GGizXXXfAkvkl/nFh1cDZxu30PUBqA6Z4br0a/B3Arp3DUYpobh+ataiaeSsTOANY6YOqlYae6U/uMemcor8OgpHrEwx0ovl2jvClnWrPO0g+xV9kCaCsYz2B8jfHIXkr5Y8mNOVTPXaAnzB1CqNT8yDo75RlB9N7/x7bbTZplxjt+Z6xFZ8f/mpPD1XWNOXv7j8qO321LBByCqBF6RZ/d5IMWziwxF31n4QBC6BnG/wTpjmGUoVHvW8g33w9ME/1TmJ4KaFxkrwqhAkyIovVM2m0tx1sPArqMnxc6wDVt9h1qfdLUYYDlDOQUBHg2X0dYS6UeSpnVTxKYKfZMrNxolGB8vX+WPo2xnkD+5RdQW69Iv/Aiy/9IBOOTG5pwXEx7J/y/h80useO1hsu1/TYruljS6ObIMUPwOZL1dizmYv8qH6cAf6/AU6Lgelo7PfzjO3/KZIJgEl6rTnDGWocT30eyhyn1utH5PM/D8i5juUewib1/5DehomuHE7X1krndPNnNmXrEG14fYIKd+khUWebxrL/vjFs9wD7pqXCOzdVeWFjhnsgA04rfUMJwREmcWiLcDObxBFzHbG/6IVAAAA=";function FaCheck(rp){return GenIcon({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(rp)}function FaShareSquare(rp){return GenIcon({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M568.482 177.448L424.479 313.433C409.3 327.768 384 317.14 384 295.985v-71.963c-144.575.97-205.566 35.113-164.775 171.353 4.483 14.973-12.846 26.567-25.006 17.33C155.252 383.105 120 326.488 120 269.339c0-143.937 117.599-172.5 264-173.312V24.012c0-21.174 25.317-31.768 40.479-17.448l144.003 135.988c10.02 9.463 10.028 25.425 0 34.896zM384 379.128V448H64V128h50.916a11.99 11.99 0 0 0 8.648-3.693c14.953-15.568 32.237-27.89 51.014-37.676C185.708 80.83 181.584 64 169.033 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48v-88.806c0-8.288-8.197-14.066-16.011-11.302a71.83 71.83 0 0 1-34.189 3.377c-7.27-1.046-13.8 4.514-13.8 11.859z"},child:[]}]})(rp)}var Call={},_interopRequireDefault$y=interopRequireDefaultExports;Object.defineProperty(Call,"__esModule",{value:!0});var default_1$p=Call.default=void 0,_createSvgIcon$p=_interopRequireDefault$y(requireCreateSvgIcon()),_jsxRuntime$p=jsxRuntimeExports;default_1$p=Call.default=(0,_createSvgIcon$p.default)((0,_jsxRuntime$p.jsx)("path",{d:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99"}),"Call");const EventMarker=({value:rp,isActive:_d,onClick:np,getDistance:ap})=>{const sp=Recoil_index_20(myCenterAtom),lp=Recoil_index_24(mapCenterAtom),up=Recoil_index_24(mapLevelAtom),cp=useMap(),dp=useNavigate(),hp=mp=>{cp.panTo(mp.getPosition()),np()},fp=reactExports.useMemo(()=>ap(sp.center.lat,sp.center.lng,rp.latitude,rp.longitude),[sp,rp]),pp=()=>{const mp=cp.getCenter();lp({lat:mp.getLat(),lng:mp.getLng()}),up(cp.getLevel()),dp(`/fish/map/${rp.spotId}`)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(MapMarker,{position:{lat:rp.latitude,lng:rp.longitude},onClick:hp,image:_d?{src:MarkerOn,size:{width:28,height:40}}:{src:MarkerOff,size:{width:18,height:25}}}),_d&&jsxRuntimeExports.jsxs("div",{className:"info",children:[jsxRuntimeExports.jsxs("div",{className:"info_header",children:[jsxRuntimeExports.jsx("div",{className:"info_name",onClick:pp,children:rp.name}),jsxRuntimeExports.jsx("div",{className:"info_type",children:rp.spotType})]}),jsxRuntimeExports.jsxs("div",{className:"info_body",children:[jsxRuntimeExports.jsx("div",{className:"info_distance",children:fp>=1?`${fp.toFixed(1)}km`:`${(fp/1e3).toFixed()}`}),jsxRuntimeExports.jsx("div",{className:"info_addr",children:rp.streetAddress})]}),jsxRuntimeExports.jsxs("div",{className:"info_footer",children:[jsxRuntimeExports.jsx("hr",{}),jsxRuntimeExports.jsxs("div",{className:"info_icons",children:[rp.spotPhone&&jsxRuntimeExports.jsx("a",{href:`tel:${rp.spotPhone}`,children:jsxRuntimeExports.jsx(default_1$p,{})}),jsxRuntimeExports.jsx(FaShareSquare,{})]})]})]})]})};var GpsFixed={},_interopRequireDefault$x=interopRequireDefaultExports;Object.defineProperty(GpsFixed,"__esModule",{value:!0});var default_1$o=GpsFixed.default=void 0,_createSvgIcon$o=_interopRequireDefault$x(requireCreateSvgIcon()),_jsxRuntime$o=jsxRuntimeExports;default_1$o=GpsFixed.default=(0,_createSvgIcon$o.default)((0,_jsxRuntime$o.jsx)("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"GpsFixed");var RefreshOutlined={},_interopRequireDefault$w=interopRequireDefaultExports;Object.defineProperty(RefreshOutlined,"__esModule",{value:!0});var default_1$n=RefreshOutlined.default=void 0,_createSvgIcon$n=_interopRequireDefault$w(requireCreateSvgIcon()),_jsxRuntime$n=jsxRuntimeExports;default_1$n=RefreshOutlined.default=(0,_createSvgIcon$n.default)((0,_jsxRuntime$n.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"RefreshOutlined");const FishMapBody=({mapRef:rp,getDistance:_d,openList:np})=>{const[ap,sp]=Recoil_index_22(centerChangeAtom),[lp,up]=Recoil_index_22(activeMarkerAtom),[cp,dp]=Recoil_index_22(myCenterAtom),[hp,fp]=Recoil_index_22(mapCenterAtom),[pp,mp]=Recoil_index_22(fishSpotListAtom),gp=Recoil_index_20(mapLevelAtom),yp=Recoil_index_24(filterModeAtom),xp=async()=>{const vp=rp.current;if(!vp)return;const bp=vp.getCenter();try{const Sp=(await axios.get("https://i10c203.p.ssafy.io/api/spots",{params:{latitude:bp.getLat(),longitude:bp.getLng()}})).data.spots.map(Ap=>{const Rp=_d(bp.getLat(),bp.getLng(),Ap==null?void 0:Ap.latitude,Ap==null?void 0:Ap.longitude);return Rp<=20?{...Ap,dist:Rp}:null}).filter(Boolean);mp(Sp),vp.setCenter(bp),sp(!1),up(null),yp("dist"),fp({lat:bp.getLat(),lng:bp.getLng()})}catch(Ep){console.log(Ep)}},_p=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(vp=>{const bp=vp.coords.latitude,Ep=vp.coords.longitude,Sp=new kakao.maps.LatLng(bp,Ep);rp.current.setCenter(Sp),sp(!1),dp(Ap=>({...Ap,center:{lat:bp,lng:Ep},isLoading:!0}))}):window.alert("  Geolocation  .")};return jsxRuntimeExports.jsxs("div",{className:"FishMapBody",children:[ap&&!np&&jsxRuntimeExports.jsxs("div",{className:"reSearch",onClick:xp,children:[jsxRuntimeExports.jsx(default_1$n,{}),"  "]}),jsxRuntimeExports.jsxs(Map$1,{center:hp,ref:rp,level:gp,onClick:()=>up(null),onCenterChanged:()=>sp(!0),children:[jsxRuntimeExports.jsx(MarkerClusterer,{minLevel:11,averageCenter:!0,children:pp.map((vp,bp)=>jsxRuntimeExports.jsx(EventMarker,{value:vp,isActive:lp===vp.spotId,onClick:()=>up(vp.spotId),getDistance:_d},vp.spotId))}),cp.isLoading&&jsxRuntimeExports.jsx(MapMarker,{position:cp.center,clickable:!0,image:{src:"https://cdn4.iconfinder.com/data/icons/small-n-flat/24/map-marker-512.png",size:{width:25,height:25}}}),!np&&jsxRuntimeExports.jsx("button",{style:{bottom:lp!==null?"19vh":"3vh"},className:"FishMap_btn bg-blue",onClick:_p,children:jsxRuntimeExports.jsx(default_1$o,{})})]})]})};var FormatListBulleted={},_interopRequireDefault$v=interopRequireDefaultExports;Object.defineProperty(FormatListBulleted,"__esModule",{value:!0});var default_1$m=FormatListBulleted.default=void 0,_createSvgIcon$m=_interopRequireDefault$v(requireCreateSvgIcon()),_jsxRuntime$m=jsxRuntimeExports;default_1$m=FormatListBulleted.default=(0,_createSvgIcon$m.default)((0,_jsxRuntime$m.jsx)("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5m0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5m0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5M7 19h14v-2H7zm0-6h14v-2H7zm0-8v2h14V5z"}),"FormatListBulleted");var MapOutlined={},_interopRequireDefault$u=interopRequireDefaultExports;Object.defineProperty(MapOutlined,"__esModule",{value:!0});var default_1$l=MapOutlined.default=void 0,_createSvgIcon$l=_interopRequireDefault$u(requireCreateSvgIcon()),_jsxRuntime$l=jsxRuntimeExports;default_1$l=MapOutlined.default=(0,_createSvgIcon$l.default)((0,_jsxRuntime$l.jsx)("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M10 5.47l4 1.4v11.66l-4-1.4zm-5 .99 3-1.01v11.7l-3 1.16zm14 11.08-3 1.01V6.86l3-1.16z"}),"MapOutlined");var ArrowDropDownOutlined={},_interopRequireDefault$t=interopRequireDefaultExports;Object.defineProperty(ArrowDropDownOutlined,"__esModule",{value:!0});var default_1$k=ArrowDropDownOutlined.default=void 0,_createSvgIcon$k=_interopRequireDefault$t(requireCreateSvgIcon()),_jsxRuntime$k=jsxRuntimeExports;default_1$k=ArrowDropDownOutlined.default=(0,_createSvgIcon$k.default)((0,_jsxRuntime$k.jsx)("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDownOutlined");var CheckOutlined={},_interopRequireDefault$s=interopRequireDefaultExports;Object.defineProperty(CheckOutlined,"__esModule",{value:!0});var default_1$j=CheckOutlined.default=void 0,_createSvgIcon$j=_interopRequireDefault$s(requireCreateSvgIcon()),_jsxRuntime$j=jsxRuntimeExports;default_1$j=CheckOutlined.default=(0,_createSvgIcon$j.default)((0,_jsxRuntime$j.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"CheckOutlined");const FishMapItem=({item:rp,idx:_d,mapRef:np,getDistance:ap,setOpenList:sp})=>{const lp=Recoil_index_20(myCenterAtom),up=Recoil_index_24(activeMarkerAtom),cp=Recoil_index_24(centerChangeAtom),dp=reactExports.useMemo(()=>ap(lp.center.lat,lp.center.lng,rp.latitude,rp.longitude),[]),hp=()=>{sp(!1),console.log(rp),up(rp.spotId);const fp=new kakao.maps.LatLng(rp.latitude,rp.longitude);np.current.setLevel(4),np.current.setCenter(fp),cp(!1)};return jsxRuntimeExports.jsxs("div",{className:"item",children:[jsxRuntimeExports.jsxs("div",{className:"item-head",children:[jsxRuntimeExports.jsx("div",{className:"fishing-name",onClick:hp,children:rp.name}),jsxRuntimeExports.jsx("div",{className:"fishing-type",children:rp.spotType})]}),jsxRuntimeExports.jsxs("div",{className:"item-body",children:[jsxRuntimeExports.jsx("div",{className:"fishing-dist",children:dp>=1?`${dp.toFixed(1)}km`:`${(dp/1e3).toFixed()}m`}),jsxRuntimeExports.jsx("div",{className:"fishing-addr",children:rp.streetAddress||rp.localAddress})]}),jsxRuntimeExports.jsxs("div",{className:"fishing-exp",children:[rp.charge,""]})]})},FishMapFooter=({mapRef:rp,getDistance:_d,openList:np,setOpenList:ap})=>{const[sp,lp]=reactExports.useState(!1),[up,cp]=Recoil_index_22(filterModeAtom),dp=Recoil_index_20(fishSpotListAtom),hp=Recoil_index_20(searchModeAtom),fp=mp=>{lp(!1),cp(mp)},pp=reactExports.useMemo(()=>dp.toSorted((mp,gp)=>up==="dist"?mp.dist-gp.dist:mp.charge-gp.charge),[up,dp]);return jsxRuntimeExports.jsxs("div",{className:`FishMapFooter ${np&&"expand"}`,children:[jsxRuntimeExports.jsxs("div",{className:`fishing-content ${np&&"expand"}`,style:{height:np&&hp==="hash"&&"74.5vh"},children:[jsxRuntimeExports.jsxs("button",{className:"filter",onClick:()=>lp(!0),children:[up==="dist"?"":"",jsxRuntimeExports.jsx(default_1$k,{})]}),sp&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"filter-open",onClick:()=>lp(!1)}),jsxRuntimeExports.jsxs("div",{className:"filter-content",children:[jsxRuntimeExports.jsx("h2",{children:" "}),jsxRuntimeExports.jsx("div",{className:"filter-b",children:jsxRuntimeExports.jsxs("button",{className:`${up==="dist"?"pick":""}`,onClick:()=>fp("dist"),children:[""," ",jsxRuntimeExports.jsx("div",{children:up==="dist"&&jsxRuntimeExports.jsx(default_1$j,{})})]})}),jsxRuntimeExports.jsx("div",{className:"filter-b",children:jsxRuntimeExports.jsxs("button",{className:`${up==="money"?"pick":""}`,onClick:()=>fp("money"),children:["",jsxRuntimeExports.jsx("div",{children:up==="money"&&jsxRuntimeExports.jsx(default_1$j,{})})]})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("button",{className:"cancel",onClick:()=>lp(!1),children:""})})]})]}),jsxRuntimeExports.jsx("div",{className:"fishing-list",children:dp.length?pp.map((mp,gp)=>jsxRuntimeExports.jsx(FishMapItem,{item:mp,idx:gp,mapRef:rp,setOpenList:ap,getDistance:_d},mp.spotId)):jsxRuntimeExports.jsxs("div",{className:"noneData",children:[jsxRuntimeExports.jsx(default_1$s,{}),jsxRuntimeExports.jsx("div",{children:"   ."})]})})]}),jsxRuntimeExports.jsx("div",{className:"mode",onClick:()=>ap(mp=>!mp),children:np?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(default_1$l,{}),jsxRuntimeExports.jsx("div",{children:""})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(default_1$m,{}),jsxRuntimeExports.jsx("div",{children:""})]})})]})},hashTags=["#","#","#","#","#"],FishMapPage=()=>{const rp=Recoil_index_24(searchTermAtom),_d=Recoil_index_24(filterModeAtom),np=Recoil_index_24(centerChangeAtom),ap=Recoil_index_24(myCenterAtom),sp=Recoil_index_24(fishSpotListAtom),lp=Recoil_index_24(searchModeAtom),up=Recoil_index_24(mapLevelAtom),[cp,dp]=Recoil_index_22(mapCenterAtom),[hp,fp]=Recoil_index_22(activeMarkerAtom),[pp,mp]=reactExports.useState(!1),gp="https://i10c203.p.ssafy.io";localStorage.getItem("jwt");const yp=useLocation(),xp=reactExports.useRef(null),_p=(Sp,Ap)=>{dp({lat:Sp,lng:Ap}),fp(null),rp(""),_d("dist"),lp("location"),up(9)},vp=(Sp,Ap,Rp,Tp)=>{const Mp=jp=>jp*(Math.PI/180),Pp=Mp(Rp-Sp),$p=Mp(Tp-Ap),zp=Math.sin(Pp/2)*Math.sin(Pp/2)+Math.cos(Mp(Sp))*Math.cos(Mp(Rp))*Math.sin($p/2)*Math.sin($p/2);return 6371*(2*Math.atan2(Math.sqrt(zp),Math.sqrt(1-zp)))},bp=async(Sp,Ap)=>{try{const Tp=(await axios.get(`${gp}/api/spots`,{params:{latitude:Sp,longitude:Ap}},{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}})).data.spots.map(Mp=>{const Op=vp(Sp,Ap,Mp==null?void 0:Mp.latitude,Mp==null?void 0:Mp.longitude);return Op<=20?{...Mp,dist:Op}:null}).filter(Boolean);console.log(Tp),sp(Tp)}catch(Rp){console.log(Rp)}},Ep=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(Sp=>{var Tp;const{latitude:Ap,longitude:Rp}=Sp.coords;ap(Mp=>({...Mp,center:{lat:Ap,lng:Rp},isLoading:!0})),np(!1),(!cp.lat&&!cp.lng||!((Tp=yp.state)!=null&&Tp.data))&&(bp(Ap,Rp),_p(Ap,Rp))},Sp=>{console.log(Sp),ap(Ap=>({...Ap,errMsg:Sp.message,isLoading:!1}))}):ap(Sp=>({...Sp,errMsg:"geolocation  ..",isLoading:!1}))};return reactExports.useEffect(()=>{Ep()},[]),jsxRuntimeExports.jsxs("div",{className:"FishMap",children:[jsxRuntimeExports.jsx(FishMapHeader,{hashTags,mapRef:xp,getDistance:vp}),jsxRuntimeExports.jsx(FishMapBody,{openList:pp,mapRef:xp,getDistance:vp}),hp===null&&jsxRuntimeExports.jsx(FishMapFooter,{openList:pp,setOpenList:mp,mapRef:xp,getDistance:vp})]})};var Navigation={},_interopRequireDefault$r=interopRequireDefaultExports;Object.defineProperty(Navigation,"__esModule",{value:!0});var default_1$i=Navigation.default=void 0,_createSvgIcon$i=_interopRequireDefault$r(requireCreateSvgIcon()),_jsxRuntime$i=jsxRuntimeExports;default_1$i=Navigation.default=(0,_createSvgIcon$i.default)((0,_jsxRuntime$i.jsx)("path",{d:"M12 2 4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"}),"Navigation");const WEEKDAY=["","","","","","",""],FishSpot=({weatherData:rp,sunrise:_d,sunset:np})=>{const ap=new Date,sp=(ap.getMonth()+1).toString().padStart(2,"0"),lp=ap.getDate().toString().padStart(2,"0"),up=dp=>dp.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1}),cp=dp=>dp<12?`${dp||12}`:`${dp===12?dp:dp-12}`;return jsxRuntimeExports.jsxs("div",{className:"MapDetailWeather",children:[jsxRuntimeExports.jsx("div",{className:"todays-date",children:`${sp}.${lp} ${WEEKDAY[ap.getDay()]}`}),jsxRuntimeExports.jsxs("div",{className:"sun-rs",children:[` ${up(_d)}`,jsxRuntimeExports.jsx("span",{children:""}),` ${up(np)}`]}),jsxRuntimeExports.jsxs("div",{className:"weather-data",children:[jsxRuntimeExports.jsxs("div",{className:"weather-info",children:[jsxRuntimeExports.jsx("div",{className:"weather-time",children:""}),jsxRuntimeExports.jsx("div",{className:"weather",children:""}),jsxRuntimeExports.jsx("div",{className:"temper",children:""}),jsxRuntimeExports.jsx("div",{className:"precipitation",children:""}),jsxRuntimeExports.jsx("div",{className:"wind-speed",children:""}),jsxRuntimeExports.jsx("div",{className:"wind-direction",children:""})]}),jsxRuntimeExports.jsx("div",{className:"weather-totals",children:rp.map((dp,hp)=>jsxRuntimeExports.jsxs("div",{className:"weather-total",children:[jsxRuntimeExports.jsx("div",{className:"weather-time",children:cp(new Date(dp.dt_txt).getHours())}),jsxRuntimeExports.jsx("img",{className:"weather-icon",src:`http://openweathermap.org/img/wn/${dp.weather[0].icon}@2x.png`,alt:" "}),jsxRuntimeExports.jsxs("div",{children:[dp.main.temp.toFixed(0),""]}),jsxRuntimeExports.jsx("div",{children:`${(dp.pop*100).toFixed()}%`}),jsxRuntimeExports.jsxs("div",{children:[dp.wind.speed.toFixed(1),"m/s"]}),jsxRuntimeExports.jsx("div",{className:"navigation",style:{transform:`rotate(${dp.wind.deg}deg)`},children:jsxRuntimeExports.jsx(default_1$i,{})})]},hp))})]})]})},profile="/assets/default_profile-hUbMlwUN.webp",OPEN_WEATHER_API_KEY="87246d75e1ce26e1392a087b3d1d88c5",FishMapDetailPage=()=>{const rp=useLocation(),_d=useParams(),np=useNavigate(),[ap,sp]=reactExports.useState({}),[lp,up]=reactExports.useState([]),[cp,dp]=reactExports.useState(""),[hp,fp]=reactExports.useState(""),pp=Recoil_index_24(prevPathAtom),mp=async(xp,_p)=>{try{const vp=await axios.get(`https://api.openweathermap.org/data/2.5/forecast?lat=${xp}&lon=${_p}&appid=${OPEN_WEATHER_API_KEY}&units=metric&lang=kr`);console.log(vp.data),dp(new Date(vp.data.city.sunrise*1e3)),fp(new Date(vp.data.city.sunset*1e3)),up(vp.data.list)}catch(vp){console.log(vp)}finally{pp(rp.pathname)}},gp=async()=>{try{const xp=await axios.get(`https://i10c203.p.ssafy.io/api/spots/${_d.idx}`,{headers:{Authorization:localStorage.getItem("jwt")}});console.log(xp.data),sp(xp.data),await mp(xp.data.latitude,xp.data.longitude)}catch(xp){console.log(xp)}},yp=xp=>{const _p=new Date,bp=(new Date(xp)-_p)/(1e3*60*60),Ep=new Intl.RelativeTimeFormat("ko-KR");let Sp;return Math.abs(bp)<24?Sp=Ep.format(Math.round(bp),"hour"):Sp=Ep.format(Math.round(bp/24),"day"),Sp};return reactExports.useEffect(()=>{gp()},[]),lp.length?jsxRuntimeExports.jsxs("div",{className:"FishMapDetailPage",children:[jsxRuntimeExports.jsx(Header,{prevPath:"/fish/map"}),jsxRuntimeExports.jsxs("div",{className:"body",children:[jsxRuntimeExports.jsxs("div",{className:"fishing-info",children:[jsxRuntimeExports.jsxs("div",{className:"fishing-name",children:[jsxRuntimeExports.jsx("h2",{children:ap.name}),jsxRuntimeExports.jsx("div",{children:ap.spotType})]}),jsxRuntimeExports.jsx("div",{children:ap.streetAddress})]}),jsxRuntimeExports.jsx(FishSpot,{weatherData:lp,sunrise:cp,sunset:hp}),jsxRuntimeExports.jsxs("div",{className:"fish-species",children:[jsxRuntimeExports.jsxs("h3",{className:"name",children:[ap.name," "]}),jsxRuntimeExports.jsx("div",{className:"wrapper",children:ap.fishes.length?ap.fishes.map(xp=>jsxRuntimeExports.jsxs("div",{onClick:()=>np(`/fishbook/${xp.id}`),children:[jsxRuntimeExports.jsx("img",{src:xp.imageUrl,className:"blue-bd"}),jsxRuntimeExports.jsx("div",{children:xp.name})]},xp.name)):jsxRuntimeExports.jsx("div",{className:"none-data",children:"  ."})})]}),jsxRuntimeExports.jsxs("div",{className:"fishing-reviews",children:[jsxRuntimeExports.jsxs("h3",{className:"name",children:[ap.name," "]}),jsxRuntimeExports.jsx("div",{className:"wrapper",children:ap.boards.length?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"board",children:ap.boards.map(xp=>jsxRuntimeExports.jsxs("div",{className:"review",onClick:()=>np(`/media/board/${xp.boardId}`),children:[jsxRuntimeExports.jsx("img",{src:xp.boardImageUrl,className:"review-img"}),jsxRuntimeExports.jsxs("div",{className:"review-user",children:[jsxRuntimeExports.jsx("img",{src:xp.profileImageUrl||profile,alt:""}),jsxRuntimeExports.jsx("div",{children:xp.nickName})]}),jsxRuntimeExports.jsx("div",{className:"review-date",children:yp(xp.createdAt)})]},xp.boardId))})}):jsxRuntimeExports.jsx("div",{className:"none-data",children:"  ."})})]})]})]}):jsxRuntimeExports.jsx(Loading,{})};/*!
 * Cropper.js v1.6.1
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-09-17T03:44:19.860Z
 */function ownKeys(rp,_d){var np=Object.keys(rp);if(Object.getOwnPropertySymbols){var ap=Object.getOwnPropertySymbols(rp);_d&&(ap=ap.filter(function(sp){return Object.getOwnPropertyDescriptor(rp,sp).enumerable})),np.push.apply(np,ap)}return np}function _objectSpread2(rp){for(var _d=1;_d<arguments.length;_d++){var np=arguments[_d]!=null?arguments[_d]:{};_d%2?ownKeys(Object(np),!0).forEach(function(ap){_defineProperty(rp,ap,np[ap])}):Object.getOwnPropertyDescriptors?Object.defineProperties(rp,Object.getOwnPropertyDescriptors(np)):ownKeys(Object(np)).forEach(function(ap){Object.defineProperty(rp,ap,Object.getOwnPropertyDescriptor(np,ap))})}return rp}function _typeof(rp){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_d){return typeof _d}:function(_d){return _d&&typeof Symbol=="function"&&_d.constructor===Symbol&&_d!==Symbol.prototype?"symbol":typeof _d},_typeof(rp)}function _classCallCheck(rp,_d){if(!(rp instanceof _d))throw new TypeError("Cannot call a class as a function")}function _defineProperties(rp,_d){for(var np=0;np<_d.length;np++){var ap=_d[np];ap.enumerable=ap.enumerable||!1,ap.configurable=!0,"value"in ap&&(ap.writable=!0),Object.defineProperty(rp,_toPropertyKey(ap.key),ap)}}function _createClass(rp,_d,np){return _d&&_defineProperties(rp.prototype,_d),np&&_defineProperties(rp,np),Object.defineProperty(rp,"prototype",{writable:!1}),rp}function _defineProperty(rp,_d,np){return _d=_toPropertyKey(_d),_d in rp?Object.defineProperty(rp,_d,{value:np,enumerable:!0,configurable:!0,writable:!0}):rp[_d]=np,rp}function _toConsumableArray(rp){return _arrayWithoutHoles(rp)||_iterableToArray(rp)||_unsupportedIterableToArray(rp)||_nonIterableSpread()}function _arrayWithoutHoles(rp){if(Array.isArray(rp))return _arrayLikeToArray(rp)}function _iterableToArray(rp){if(typeof Symbol<"u"&&rp[Symbol.iterator]!=null||rp["@@iterator"]!=null)return Array.from(rp)}function _unsupportedIterableToArray(rp,_d){if(rp){if(typeof rp=="string")return _arrayLikeToArray(rp,_d);var np=Object.prototype.toString.call(rp).slice(8,-1);if(np==="Object"&&rp.constructor&&(np=rp.constructor.name),np==="Map"||np==="Set")return Array.from(rp);if(np==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(np))return _arrayLikeToArray(rp,_d)}}function _arrayLikeToArray(rp,_d){(_d==null||_d>rp.length)&&(_d=rp.length);for(var np=0,ap=new Array(_d);np<_d;np++)ap[np]=rp[np];return ap}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toPrimitive(rp,_d){if(typeof rp!="object"||rp===null)return rp;var np=rp[Symbol.toPrimitive];if(np!==void 0){var ap=np.call(rp,_d||"default");if(typeof ap!="object")return ap;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_d==="string"?String:Number)(rp)}function _toPropertyKey(rp){var _d=_toPrimitive(rp,"string");return typeof _d=="symbol"?_d:String(_d)}var IS_BROWSER=typeof window<"u"&&typeof window.document<"u",WINDOW=IS_BROWSER?window:{},IS_TOUCH_DEVICE=IS_BROWSER&&WINDOW.document.documentElement?"ontouchstart"in WINDOW.document.documentElement:!1,HAS_POINTER_EVENT=IS_BROWSER?"PointerEvent"in WINDOW:!1,NAMESPACE="cropper",ACTION_ALL="all",ACTION_CROP="crop",ACTION_MOVE="move",ACTION_ZOOM="zoom",ACTION_EAST="e",ACTION_WEST="w",ACTION_SOUTH="s",ACTION_NORTH="n",ACTION_NORTH_EAST="ne",ACTION_NORTH_WEST="nw",ACTION_SOUTH_EAST="se",ACTION_SOUTH_WEST="sw",CLASS_CROP="".concat(NAMESPACE,"-crop"),CLASS_DISABLED="".concat(NAMESPACE,"-disabled"),CLASS_HIDDEN="".concat(NAMESPACE,"-hidden"),CLASS_HIDE="".concat(NAMESPACE,"-hide"),CLASS_INVISIBLE="".concat(NAMESPACE,"-invisible"),CLASS_MODAL="".concat(NAMESPACE,"-modal"),CLASS_MOVE="".concat(NAMESPACE,"-move"),DATA_ACTION="".concat(NAMESPACE,"Action"),DATA_PREVIEW="".concat(NAMESPACE,"Preview"),DRAG_MODE_CROP="crop",DRAG_MODE_MOVE="move",DRAG_MODE_NONE="none",EVENT_CROP="crop",EVENT_CROP_END="cropend",EVENT_CROP_MOVE="cropmove",EVENT_CROP_START="cropstart",EVENT_DBLCLICK="dblclick",EVENT_TOUCH_START=IS_TOUCH_DEVICE?"touchstart":"mousedown",EVENT_TOUCH_MOVE=IS_TOUCH_DEVICE?"touchmove":"mousemove",EVENT_TOUCH_END=IS_TOUCH_DEVICE?"touchend touchcancel":"mouseup",EVENT_POINTER_DOWN=HAS_POINTER_EVENT?"pointerdown":EVENT_TOUCH_START,EVENT_POINTER_MOVE=HAS_POINTER_EVENT?"pointermove":EVENT_TOUCH_MOVE,EVENT_POINTER_UP=HAS_POINTER_EVENT?"pointerup pointercancel":EVENT_TOUCH_END,EVENT_READY="ready",EVENT_RESIZE="resize",EVENT_WHEEL="wheel",EVENT_ZOOM="zoom",MIME_TYPE_JPEG="image/jpeg",REGEXP_ACTIONS=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,REGEXP_DATA_URL=/^data:/,REGEXP_DATA_URL_JPEG=/^data:image\/jpeg;base64,/,REGEXP_TAG_NAME=/^img|canvas$/i,MIN_CONTAINER_WIDTH=200,MIN_CONTAINER_HEIGHT=100,DEFAULTS$1={viewMode:0,dragMode:DRAG_MODE_CROP,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:MIN_CONTAINER_WIDTH,minContainerHeight:MIN_CONTAINER_HEIGHT,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},TEMPLATE='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',isNaN$1=Number.isNaN||WINDOW.isNaN;function isNumber(rp){return typeof rp=="number"&&!isNaN$1(rp)}var isPositiveNumber=function rp(_d){return _d>0&&_d<1/0};function isUndefined(rp){return typeof rp>"u"}function isObject(rp){return _typeof(rp)==="object"&&rp!==null}var hasOwnProperty=Object.prototype.hasOwnProperty;function isPlainObject(rp){if(!isObject(rp))return!1;try{var _d=rp.constructor,np=_d.prototype;return _d&&np&&hasOwnProperty.call(np,"isPrototypeOf")}catch{return!1}}function isFunction$1(rp){return typeof rp=="function"}var slice=Array.prototype.slice;function toArray(rp){return Array.from?Array.from(rp):slice.call(rp)}function forEach(rp,_d){return rp&&isFunction$1(_d)&&(Array.isArray(rp)||isNumber(rp.length)?toArray(rp).forEach(function(np,ap){_d.call(rp,np,ap,rp)}):isObject(rp)&&Object.keys(rp).forEach(function(np){_d.call(rp,rp[np],np,rp)})),rp}var assign=Object.assign||function rp(_d){for(var np=arguments.length,ap=new Array(np>1?np-1:0),sp=1;sp<np;sp++)ap[sp-1]=arguments[sp];return isObject(_d)&&ap.length>0&&ap.forEach(function(lp){isObject(lp)&&Object.keys(lp).forEach(function(up){_d[up]=lp[up]})}),_d},REGEXP_DECIMALS=/\.\d*(?:0|9){12}\d*$/;function normalizeDecimalNumber(rp){var _d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return REGEXP_DECIMALS.test(rp)?Math.round(rp*_d)/_d:rp}var REGEXP_SUFFIX=/^width|height|left|top|marginLeft|marginTop$/;function setStyle(rp,_d){var np=rp.style;forEach(_d,function(ap,sp){REGEXP_SUFFIX.test(sp)&&isNumber(ap)&&(ap="".concat(ap,"px")),np[sp]=ap})}function hasClass(rp,_d){return rp.classList?rp.classList.contains(_d):rp.className.indexOf(_d)>-1}function addClass(rp,_d){if(_d){if(isNumber(rp.length)){forEach(rp,function(ap){addClass(ap,_d)});return}if(rp.classList){rp.classList.add(_d);return}var np=rp.className.trim();np?np.indexOf(_d)<0&&(rp.className="".concat(np," ").concat(_d)):rp.className=_d}}function removeClass(rp,_d){if(_d){if(isNumber(rp.length)){forEach(rp,function(np){removeClass(np,_d)});return}if(rp.classList){rp.classList.remove(_d);return}rp.className.indexOf(_d)>=0&&(rp.className=rp.className.replace(_d,""))}}function toggleClass(rp,_d,np){if(_d){if(isNumber(rp.length)){forEach(rp,function(ap){toggleClass(ap,_d,np)});return}np?addClass(rp,_d):removeClass(rp,_d)}}var REGEXP_CAMEL_CASE=/([a-z\d])([A-Z])/g;function toParamCase(rp){return rp.replace(REGEXP_CAMEL_CASE,"$1-$2").toLowerCase()}function getData(rp,_d){return isObject(rp[_d])?rp[_d]:rp.dataset?rp.dataset[_d]:rp.getAttribute("data-".concat(toParamCase(_d)))}function setData(rp,_d,np){isObject(np)?rp[_d]=np:rp.dataset?rp.dataset[_d]=np:rp.setAttribute("data-".concat(toParamCase(_d)),np)}function removeData(rp,_d){if(isObject(rp[_d]))try{delete rp[_d]}catch{rp[_d]=void 0}else if(rp.dataset)try{delete rp.dataset[_d]}catch{rp.dataset[_d]=void 0}else rp.removeAttribute("data-".concat(toParamCase(_d)))}var REGEXP_SPACES=/\s\s*/,onceSupported=function(){var rp=!1;if(IS_BROWSER){var _d=!1,np=function(){},ap=Object.defineProperty({},"once",{get:function(){return rp=!0,_d},set:function(lp){_d=lp}});WINDOW.addEventListener("test",np,ap),WINDOW.removeEventListener("test",np,ap)}return rp}();function removeListener(rp,_d,np){var ap=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},sp=np;_d.trim().split(REGEXP_SPACES).forEach(function(lp){if(!onceSupported){var up=rp.listeners;up&&up[lp]&&up[lp][np]&&(sp=up[lp][np],delete up[lp][np],Object.keys(up[lp]).length===0&&delete up[lp],Object.keys(up).length===0&&delete rp.listeners)}rp.removeEventListener(lp,sp,ap)})}function addListener(rp,_d,np){var ap=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},sp=np;_d.trim().split(REGEXP_SPACES).forEach(function(lp){if(ap.once&&!onceSupported){var up=rp.listeners,cp=up===void 0?{}:up;sp=function(){delete cp[lp][np],rp.removeEventListener(lp,sp,ap);for(var hp=arguments.length,fp=new Array(hp),pp=0;pp<hp;pp++)fp[pp]=arguments[pp];np.apply(rp,fp)},cp[lp]||(cp[lp]={}),cp[lp][np]&&rp.removeEventListener(lp,cp[lp][np],ap),cp[lp][np]=sp,rp.listeners=cp}rp.addEventListener(lp,sp,ap)})}function dispatchEvent(rp,_d,np){var ap;return isFunction$1(Event)&&isFunction$1(CustomEvent)?ap=new CustomEvent(_d,{detail:np,bubbles:!0,cancelable:!0}):(ap=document.createEvent("CustomEvent"),ap.initCustomEvent(_d,!0,!0,np)),rp.dispatchEvent(ap)}function getOffset(rp){var _d=rp.getBoundingClientRect();return{left:_d.left+(window.pageXOffset-document.documentElement.clientLeft),top:_d.top+(window.pageYOffset-document.documentElement.clientTop)}}var location=WINDOW.location,REGEXP_ORIGINS=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function isCrossOriginURL(rp){var _d=rp.match(REGEXP_ORIGINS);return _d!==null&&(_d[1]!==location.protocol||_d[2]!==location.hostname||_d[3]!==location.port)}function addTimestamp(rp){var _d="timestamp=".concat(new Date().getTime());return rp+(rp.indexOf("?")===-1?"?":"&")+_d}function getTransforms(rp){var _d=rp.rotate,np=rp.scaleX,ap=rp.scaleY,sp=rp.translateX,lp=rp.translateY,up=[];isNumber(sp)&&sp!==0&&up.push("translateX(".concat(sp,"px)")),isNumber(lp)&&lp!==0&&up.push("translateY(".concat(lp,"px)")),isNumber(_d)&&_d!==0&&up.push("rotate(".concat(_d,"deg)")),isNumber(np)&&np!==1&&up.push("scaleX(".concat(np,")")),isNumber(ap)&&ap!==1&&up.push("scaleY(".concat(ap,")"));var cp=up.length?up.join(" "):"none";return{WebkitTransform:cp,msTransform:cp,transform:cp}}function getMaxZoomRatio(rp){var _d=_objectSpread2({},rp),np=0;return forEach(rp,function(ap,sp){delete _d[sp],forEach(_d,function(lp){var up=Math.abs(ap.startX-lp.startX),cp=Math.abs(ap.startY-lp.startY),dp=Math.abs(ap.endX-lp.endX),hp=Math.abs(ap.endY-lp.endY),fp=Math.sqrt(up*up+cp*cp),pp=Math.sqrt(dp*dp+hp*hp),mp=(pp-fp)/fp;Math.abs(mp)>Math.abs(np)&&(np=mp)})}),np}function getPointer(rp,_d){var np=rp.pageX,ap=rp.pageY,sp={endX:np,endY:ap};return _d?sp:_objectSpread2({startX:np,startY:ap},sp)}function getPointersCenter(rp){var _d=0,np=0,ap=0;return forEach(rp,function(sp){var lp=sp.startX,up=sp.startY;_d+=lp,np+=up,ap+=1}),_d/=ap,np/=ap,{pageX:_d,pageY:np}}function getAdjustedSizes(rp){var _d=rp.aspectRatio,np=rp.height,ap=rp.width,sp=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",lp=isPositiveNumber(ap),up=isPositiveNumber(np);if(lp&&up){var cp=np*_d;sp==="contain"&&cp>ap||sp==="cover"&&cp<ap?np=ap/_d:ap=np*_d}else lp?np=ap/_d:up&&(ap=np*_d);return{width:ap,height:np}}function getRotatedSizes(rp){var _d=rp.width,np=rp.height,ap=rp.degree;if(ap=Math.abs(ap)%180,ap===90)return{width:np,height:_d};var sp=ap%90*Math.PI/180,lp=Math.sin(sp),up=Math.cos(sp),cp=_d*up+np*lp,dp=_d*lp+np*up;return ap>90?{width:dp,height:cp}:{width:cp,height:dp}}function getSourceCanvas(rp,_d,np,ap){var sp=_d.aspectRatio,lp=_d.naturalWidth,up=_d.naturalHeight,cp=_d.rotate,dp=cp===void 0?0:cp,hp=_d.scaleX,fp=hp===void 0?1:hp,pp=_d.scaleY,mp=pp===void 0?1:pp,gp=np.aspectRatio,yp=np.naturalWidth,xp=np.naturalHeight,_p=ap.fillColor,vp=_p===void 0?"transparent":_p,bp=ap.imageSmoothingEnabled,Ep=bp===void 0?!0:bp,Sp=ap.imageSmoothingQuality,Ap=Sp===void 0?"low":Sp,Rp=ap.maxWidth,Tp=Rp===void 0?1/0:Rp,Mp=ap.maxHeight,Op=Mp===void 0?1/0:Mp,Pp=ap.minWidth,$p=Pp===void 0?0:Pp,zp=ap.minHeight,Dp=zp===void 0?0:zp,Fp=document.createElement("canvas"),jp=Fp.getContext("2d"),Lp=getAdjustedSizes({aspectRatio:gp,width:Tp,height:Op}),Bp=getAdjustedSizes({aspectRatio:gp,width:$p,height:Dp},"cover"),Ip=Math.min(Lp.width,Math.max(Bp.width,yp)),kp=Math.min(Lp.height,Math.max(Bp.height,xp)),Up=getAdjustedSizes({aspectRatio:sp,width:Tp,height:Op}),Gp=getAdjustedSizes({aspectRatio:sp,width:$p,height:Dp},"cover"),Wp=Math.min(Up.width,Math.max(Gp.width,lp)),Qp=Math.min(Up.height,Math.max(Gp.height,up)),Xp=[-Wp/2,-Qp/2,Wp,Qp];return Fp.width=normalizeDecimalNumber(Ip),Fp.height=normalizeDecimalNumber(kp),jp.fillStyle=vp,jp.fillRect(0,0,Ip,kp),jp.save(),jp.translate(Ip/2,kp/2),jp.rotate(dp*Math.PI/180),jp.scale(fp,mp),jp.imageSmoothingEnabled=Ep,jp.imageSmoothingQuality=Ap,jp.drawImage.apply(jp,[rp].concat(_toConsumableArray(Xp.map(function(rm){return Math.floor(normalizeDecimalNumber(rm))})))),jp.restore(),Fp}var fromCharCode=String.fromCharCode;function getStringFromCharCode(rp,_d,np){var ap="";np+=_d;for(var sp=_d;sp<np;sp+=1)ap+=fromCharCode(rp.getUint8(sp));return ap}var REGEXP_DATA_URL_HEAD=/^data:.*,/;function dataURLToArrayBuffer(rp){var _d=rp.replace(REGEXP_DATA_URL_HEAD,""),np=atob(_d),ap=new ArrayBuffer(np.length),sp=new Uint8Array(ap);return forEach(sp,function(lp,up){sp[up]=np.charCodeAt(up)}),ap}function arrayBufferToDataURL(rp,_d){for(var np=[],ap=8192,sp=new Uint8Array(rp);sp.length>0;)np.push(fromCharCode.apply(null,toArray(sp.subarray(0,ap)))),sp=sp.subarray(ap);return"data:".concat(_d,";base64,").concat(btoa(np.join("")))}function resetAndGetOrientation(rp){var _d=new DataView(rp),np;try{var ap,sp,lp;if(_d.getUint8(0)===255&&_d.getUint8(1)===216)for(var up=_d.byteLength,cp=2;cp+1<up;){if(_d.getUint8(cp)===255&&_d.getUint8(cp+1)===225){sp=cp;break}cp+=1}if(sp){var dp=sp+4,hp=sp+10;if(getStringFromCharCode(_d,dp,4)==="Exif"){var fp=_d.getUint16(hp);if(ap=fp===18761,(ap||fp===19789)&&_d.getUint16(hp+2,ap)===42){var pp=_d.getUint32(hp+4,ap);pp>=8&&(lp=hp+pp)}}}if(lp){var mp=_d.getUint16(lp,ap),gp,yp;for(yp=0;yp<mp;yp+=1)if(gp=lp+yp*12+2,_d.getUint16(gp,ap)===274){gp+=8,np=_d.getUint16(gp,ap),_d.setUint16(gp,1,ap);break}}}catch{np=1}return np}function parseOrientation(rp){var _d=0,np=1,ap=1;switch(rp){case 2:np=-1;break;case 3:_d=-180;break;case 4:ap=-1;break;case 5:_d=90,ap=-1;break;case 6:_d=90;break;case 7:_d=90,np=-1;break;case 8:_d=-90;break}return{rotate:_d,scaleX:np,scaleY:ap}}var render={render:function rp(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function rp(){var _d=this.element,np=this.options,ap=this.container,sp=this.cropper,lp=Number(np.minContainerWidth),up=Number(np.minContainerHeight);addClass(sp,CLASS_HIDDEN),removeClass(_d,CLASS_HIDDEN);var cp={width:Math.max(ap.offsetWidth,lp>=0?lp:MIN_CONTAINER_WIDTH),height:Math.max(ap.offsetHeight,up>=0?up:MIN_CONTAINER_HEIGHT)};this.containerData=cp,setStyle(sp,{width:cp.width,height:cp.height}),addClass(_d,CLASS_HIDDEN),removeClass(sp,CLASS_HIDDEN)},initCanvas:function rp(){var _d=this.containerData,np=this.imageData,ap=this.options.viewMode,sp=Math.abs(np.rotate)%180===90,lp=sp?np.naturalHeight:np.naturalWidth,up=sp?np.naturalWidth:np.naturalHeight,cp=lp/up,dp=_d.width,hp=_d.height;_d.height*cp>_d.width?ap===3?dp=_d.height*cp:hp=_d.width/cp:ap===3?hp=_d.width/cp:dp=_d.height*cp;var fp={aspectRatio:cp,naturalWidth:lp,naturalHeight:up,width:dp,height:hp};this.canvasData=fp,this.limited=ap===1||ap===2,this.limitCanvas(!0,!0),fp.width=Math.min(Math.max(fp.width,fp.minWidth),fp.maxWidth),fp.height=Math.min(Math.max(fp.height,fp.minHeight),fp.maxHeight),fp.left=(_d.width-fp.width)/2,fp.top=(_d.height-fp.height)/2,fp.oldLeft=fp.left,fp.oldTop=fp.top,this.initialCanvasData=assign({},fp)},limitCanvas:function rp(_d,np){var ap=this.options,sp=this.containerData,lp=this.canvasData,up=this.cropBoxData,cp=ap.viewMode,dp=lp.aspectRatio,hp=this.cropped&&up;if(_d){var fp=Number(ap.minCanvasWidth)||0,pp=Number(ap.minCanvasHeight)||0;cp>1?(fp=Math.max(fp,sp.width),pp=Math.max(pp,sp.height),cp===3&&(pp*dp>fp?fp=pp*dp:pp=fp/dp)):cp>0&&(fp?fp=Math.max(fp,hp?up.width:0):pp?pp=Math.max(pp,hp?up.height:0):hp&&(fp=up.width,pp=up.height,pp*dp>fp?fp=pp*dp:pp=fp/dp));var mp=getAdjustedSizes({aspectRatio:dp,width:fp,height:pp});fp=mp.width,pp=mp.height,lp.minWidth=fp,lp.minHeight=pp,lp.maxWidth=1/0,lp.maxHeight=1/0}if(np)if(cp>(hp?0:1)){var gp=sp.width-lp.width,yp=sp.height-lp.height;lp.minLeft=Math.min(0,gp),lp.minTop=Math.min(0,yp),lp.maxLeft=Math.max(0,gp),lp.maxTop=Math.max(0,yp),hp&&this.limited&&(lp.minLeft=Math.min(up.left,up.left+(up.width-lp.width)),lp.minTop=Math.min(up.top,up.top+(up.height-lp.height)),lp.maxLeft=up.left,lp.maxTop=up.top,cp===2&&(lp.width>=sp.width&&(lp.minLeft=Math.min(0,gp),lp.maxLeft=Math.max(0,gp)),lp.height>=sp.height&&(lp.minTop=Math.min(0,yp),lp.maxTop=Math.max(0,yp))))}else lp.minLeft=-lp.width,lp.minTop=-lp.height,lp.maxLeft=sp.width,lp.maxTop=sp.height},renderCanvas:function rp(_d,np){var ap=this.canvasData,sp=this.imageData;if(np){var lp=getRotatedSizes({width:sp.naturalWidth*Math.abs(sp.scaleX||1),height:sp.naturalHeight*Math.abs(sp.scaleY||1),degree:sp.rotate||0}),up=lp.width,cp=lp.height,dp=ap.width*(up/ap.naturalWidth),hp=ap.height*(cp/ap.naturalHeight);ap.left-=(dp-ap.width)/2,ap.top-=(hp-ap.height)/2,ap.width=dp,ap.height=hp,ap.aspectRatio=up/cp,ap.naturalWidth=up,ap.naturalHeight=cp,this.limitCanvas(!0,!1)}(ap.width>ap.maxWidth||ap.width<ap.minWidth)&&(ap.left=ap.oldLeft),(ap.height>ap.maxHeight||ap.height<ap.minHeight)&&(ap.top=ap.oldTop),ap.width=Math.min(Math.max(ap.width,ap.minWidth),ap.maxWidth),ap.height=Math.min(Math.max(ap.height,ap.minHeight),ap.maxHeight),this.limitCanvas(!1,!0),ap.left=Math.min(Math.max(ap.left,ap.minLeft),ap.maxLeft),ap.top=Math.min(Math.max(ap.top,ap.minTop),ap.maxTop),ap.oldLeft=ap.left,ap.oldTop=ap.top,setStyle(this.canvas,assign({width:ap.width,height:ap.height},getTransforms({translateX:ap.left,translateY:ap.top}))),this.renderImage(_d),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function rp(_d){var np=this.canvasData,ap=this.imageData,sp=ap.naturalWidth*(np.width/np.naturalWidth),lp=ap.naturalHeight*(np.height/np.naturalHeight);assign(ap,{width:sp,height:lp,left:(np.width-sp)/2,top:(np.height-lp)/2}),setStyle(this.image,assign({width:ap.width,height:ap.height},getTransforms(assign({translateX:ap.left,translateY:ap.top},ap)))),_d&&this.output()},initCropBox:function rp(){var _d=this.options,np=this.canvasData,ap=_d.aspectRatio||_d.initialAspectRatio,sp=Number(_d.autoCropArea)||.8,lp={width:np.width,height:np.height};ap&&(np.height*ap>np.width?lp.height=lp.width/ap:lp.width=lp.height*ap),this.cropBoxData=lp,this.limitCropBox(!0,!0),lp.width=Math.min(Math.max(lp.width,lp.minWidth),lp.maxWidth),lp.height=Math.min(Math.max(lp.height,lp.minHeight),lp.maxHeight),lp.width=Math.max(lp.minWidth,lp.width*sp),lp.height=Math.max(lp.minHeight,lp.height*sp),lp.left=np.left+(np.width-lp.width)/2,lp.top=np.top+(np.height-lp.height)/2,lp.oldLeft=lp.left,lp.oldTop=lp.top,this.initialCropBoxData=assign({},lp)},limitCropBox:function rp(_d,np){var ap=this.options,sp=this.containerData,lp=this.canvasData,up=this.cropBoxData,cp=this.limited,dp=ap.aspectRatio;if(_d){var hp=Number(ap.minCropBoxWidth)||0,fp=Number(ap.minCropBoxHeight)||0,pp=cp?Math.min(sp.width,lp.width,lp.width+lp.left,sp.width-lp.left):sp.width,mp=cp?Math.min(sp.height,lp.height,lp.height+lp.top,sp.height-lp.top):sp.height;hp=Math.min(hp,sp.width),fp=Math.min(fp,sp.height),dp&&(hp&&fp?fp*dp>hp?fp=hp/dp:hp=fp*dp:hp?fp=hp/dp:fp&&(hp=fp*dp),mp*dp>pp?mp=pp/dp:pp=mp*dp),up.minWidth=Math.min(hp,pp),up.minHeight=Math.min(fp,mp),up.maxWidth=pp,up.maxHeight=mp}np&&(cp?(up.minLeft=Math.max(0,lp.left),up.minTop=Math.max(0,lp.top),up.maxLeft=Math.min(sp.width,lp.left+lp.width)-up.width,up.maxTop=Math.min(sp.height,lp.top+lp.height)-up.height):(up.minLeft=0,up.minTop=0,up.maxLeft=sp.width-up.width,up.maxTop=sp.height-up.height))},renderCropBox:function rp(){var _d=this.options,np=this.containerData,ap=this.cropBoxData;(ap.width>ap.maxWidth||ap.width<ap.minWidth)&&(ap.left=ap.oldLeft),(ap.height>ap.maxHeight||ap.height<ap.minHeight)&&(ap.top=ap.oldTop),ap.width=Math.min(Math.max(ap.width,ap.minWidth),ap.maxWidth),ap.height=Math.min(Math.max(ap.height,ap.minHeight),ap.maxHeight),this.limitCropBox(!1,!0),ap.left=Math.min(Math.max(ap.left,ap.minLeft),ap.maxLeft),ap.top=Math.min(Math.max(ap.top,ap.minTop),ap.maxTop),ap.oldLeft=ap.left,ap.oldTop=ap.top,_d.movable&&_d.cropBoxMovable&&setData(this.face,DATA_ACTION,ap.width>=np.width&&ap.height>=np.height?ACTION_MOVE:ACTION_ALL),setStyle(this.cropBox,assign({width:ap.width,height:ap.height},getTransforms({translateX:ap.left,translateY:ap.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function rp(){this.preview(),dispatchEvent(this.element,EVENT_CROP,this.getData())}},preview={initPreview:function rp(){var _d=this.element,np=this.crossOrigin,ap=this.options.preview,sp=np?this.crossOriginUrl:this.url,lp=_d.alt||"The image to preview",up=document.createElement("img");if(np&&(up.crossOrigin=np),up.src=sp,up.alt=lp,this.viewBox.appendChild(up),this.viewBoxImage=up,!!ap){var cp=ap;typeof ap=="string"?cp=_d.ownerDocument.querySelectorAll(ap):ap.querySelector&&(cp=[ap]),this.previews=cp,forEach(cp,function(dp){var hp=document.createElement("img");setData(dp,DATA_PREVIEW,{width:dp.offsetWidth,height:dp.offsetHeight,html:dp.innerHTML}),np&&(hp.crossOrigin=np),hp.src=sp,hp.alt=lp,hp.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',dp.innerHTML="",dp.appendChild(hp)})}},resetPreview:function rp(){forEach(this.previews,function(_d){var np=getData(_d,DATA_PREVIEW);setStyle(_d,{width:np.width,height:np.height}),_d.innerHTML=np.html,removeData(_d,DATA_PREVIEW)})},preview:function rp(){var _d=this.imageData,np=this.canvasData,ap=this.cropBoxData,sp=ap.width,lp=ap.height,up=_d.width,cp=_d.height,dp=ap.left-np.left-_d.left,hp=ap.top-np.top-_d.top;!this.cropped||this.disabled||(setStyle(this.viewBoxImage,assign({width:up,height:cp},getTransforms(assign({translateX:-dp,translateY:-hp},_d)))),forEach(this.previews,function(fp){var pp=getData(fp,DATA_PREVIEW),mp=pp.width,gp=pp.height,yp=mp,xp=gp,_p=1;sp&&(_p=mp/sp,xp=lp*_p),lp&&xp>gp&&(_p=gp/lp,yp=sp*_p,xp=gp),setStyle(fp,{width:yp,height:xp}),setStyle(fp.getElementsByTagName("img")[0],assign({width:up*_p,height:cp*_p},getTransforms(assign({translateX:-dp*_p,translateY:-hp*_p},_d))))}))}},events$1={bind:function rp(){var _d=this.element,np=this.options,ap=this.cropper;isFunction$1(np.cropstart)&&addListener(_d,EVENT_CROP_START,np.cropstart),isFunction$1(np.cropmove)&&addListener(_d,EVENT_CROP_MOVE,np.cropmove),isFunction$1(np.cropend)&&addListener(_d,EVENT_CROP_END,np.cropend),isFunction$1(np.crop)&&addListener(_d,EVENT_CROP,np.crop),isFunction$1(np.zoom)&&addListener(_d,EVENT_ZOOM,np.zoom),addListener(ap,EVENT_POINTER_DOWN,this.onCropStart=this.cropStart.bind(this)),np.zoomable&&np.zoomOnWheel&&addListener(ap,EVENT_WHEEL,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),np.toggleDragModeOnDblclick&&addListener(ap,EVENT_DBLCLICK,this.onDblclick=this.dblclick.bind(this)),addListener(_d.ownerDocument,EVENT_POINTER_MOVE,this.onCropMove=this.cropMove.bind(this)),addListener(_d.ownerDocument,EVENT_POINTER_UP,this.onCropEnd=this.cropEnd.bind(this)),np.responsive&&addListener(window,EVENT_RESIZE,this.onResize=this.resize.bind(this))},unbind:function rp(){var _d=this.element,np=this.options,ap=this.cropper;isFunction$1(np.cropstart)&&removeListener(_d,EVENT_CROP_START,np.cropstart),isFunction$1(np.cropmove)&&removeListener(_d,EVENT_CROP_MOVE,np.cropmove),isFunction$1(np.cropend)&&removeListener(_d,EVENT_CROP_END,np.cropend),isFunction$1(np.crop)&&removeListener(_d,EVENT_CROP,np.crop),isFunction$1(np.zoom)&&removeListener(_d,EVENT_ZOOM,np.zoom),removeListener(ap,EVENT_POINTER_DOWN,this.onCropStart),np.zoomable&&np.zoomOnWheel&&removeListener(ap,EVENT_WHEEL,this.onWheel,{passive:!1,capture:!0}),np.toggleDragModeOnDblclick&&removeListener(ap,EVENT_DBLCLICK,this.onDblclick),removeListener(_d.ownerDocument,EVENT_POINTER_MOVE,this.onCropMove),removeListener(_d.ownerDocument,EVENT_POINTER_UP,this.onCropEnd),np.responsive&&removeListener(window,EVENT_RESIZE,this.onResize)}},handlers={resize:function rp(){if(!this.disabled){var _d=this.options,np=this.container,ap=this.containerData,sp=np.offsetWidth/ap.width,lp=np.offsetHeight/ap.height,up=Math.abs(sp-1)>Math.abs(lp-1)?sp:lp;if(up!==1){var cp,dp;_d.restore&&(cp=this.getCanvasData(),dp=this.getCropBoxData()),this.render(),_d.restore&&(this.setCanvasData(forEach(cp,function(hp,fp){cp[fp]=hp*up})),this.setCropBoxData(forEach(dp,function(hp,fp){dp[fp]=hp*up})))}}},dblclick:function rp(){this.disabled||this.options.dragMode===DRAG_MODE_NONE||this.setDragMode(hasClass(this.dragBox,CLASS_CROP)?DRAG_MODE_MOVE:DRAG_MODE_CROP)},wheel:function rp(_d){var np=this,ap=Number(this.options.wheelZoomRatio)||.1,sp=1;this.disabled||(_d.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){np.wheeling=!1},50),_d.deltaY?sp=_d.deltaY>0?1:-1:_d.wheelDelta?sp=-_d.wheelDelta/120:_d.detail&&(sp=_d.detail>0?1:-1),this.zoom(-sp*ap,_d)))},cropStart:function rp(_d){var np=_d.buttons,ap=_d.button;if(!(this.disabled||(_d.type==="mousedown"||_d.type==="pointerdown"&&_d.pointerType==="mouse")&&(isNumber(np)&&np!==1||isNumber(ap)&&ap!==0||_d.ctrlKey))){var sp=this.options,lp=this.pointers,up;_d.changedTouches?forEach(_d.changedTouches,function(cp){lp[cp.identifier]=getPointer(cp)}):lp[_d.pointerId||0]=getPointer(_d),Object.keys(lp).length>1&&sp.zoomable&&sp.zoomOnTouch?up=ACTION_ZOOM:up=getData(_d.target,DATA_ACTION),REGEXP_ACTIONS.test(up)&&dispatchEvent(this.element,EVENT_CROP_START,{originalEvent:_d,action:up})!==!1&&(_d.preventDefault(),this.action=up,this.cropping=!1,up===ACTION_CROP&&(this.cropping=!0,addClass(this.dragBox,CLASS_MODAL)))}},cropMove:function rp(_d){var np=this.action;if(!(this.disabled||!np)){var ap=this.pointers;_d.preventDefault(),dispatchEvent(this.element,EVENT_CROP_MOVE,{originalEvent:_d,action:np})!==!1&&(_d.changedTouches?forEach(_d.changedTouches,function(sp){assign(ap[sp.identifier]||{},getPointer(sp,!0))}):assign(ap[_d.pointerId||0]||{},getPointer(_d,!0)),this.change(_d))}},cropEnd:function rp(_d){if(!this.disabled){var np=this.action,ap=this.pointers;_d.changedTouches?forEach(_d.changedTouches,function(sp){delete ap[sp.identifier]}):delete ap[_d.pointerId||0],np&&(_d.preventDefault(),Object.keys(ap).length||(this.action=""),this.cropping&&(this.cropping=!1,toggleClass(this.dragBox,CLASS_MODAL,this.cropped&&this.options.modal)),dispatchEvent(this.element,EVENT_CROP_END,{originalEvent:_d,action:np}))}}},change={change:function rp(_d){var np=this.options,ap=this.canvasData,sp=this.containerData,lp=this.cropBoxData,up=this.pointers,cp=this.action,dp=np.aspectRatio,hp=lp.left,fp=lp.top,pp=lp.width,mp=lp.height,gp=hp+pp,yp=fp+mp,xp=0,_p=0,vp=sp.width,bp=sp.height,Ep=!0,Sp;!dp&&_d.shiftKey&&(dp=pp&&mp?pp/mp:1),this.limited&&(xp=lp.minLeft,_p=lp.minTop,vp=xp+Math.min(sp.width,ap.width,ap.left+ap.width),bp=_p+Math.min(sp.height,ap.height,ap.top+ap.height));var Ap=up[Object.keys(up)[0]],Rp={x:Ap.endX-Ap.startX,y:Ap.endY-Ap.startY},Tp=function(Op){switch(Op){case ACTION_EAST:gp+Rp.x>vp&&(Rp.x=vp-gp);break;case ACTION_WEST:hp+Rp.x<xp&&(Rp.x=xp-hp);break;case ACTION_NORTH:fp+Rp.y<_p&&(Rp.y=_p-fp);break;case ACTION_SOUTH:yp+Rp.y>bp&&(Rp.y=bp-yp);break}};switch(cp){case ACTION_ALL:hp+=Rp.x,fp+=Rp.y;break;case ACTION_EAST:if(Rp.x>=0&&(gp>=vp||dp&&(fp<=_p||yp>=bp))){Ep=!1;break}Tp(ACTION_EAST),pp+=Rp.x,pp<0&&(cp=ACTION_WEST,pp=-pp,hp-=pp),dp&&(mp=pp/dp,fp+=(lp.height-mp)/2);break;case ACTION_NORTH:if(Rp.y<=0&&(fp<=_p||dp&&(hp<=xp||gp>=vp))){Ep=!1;break}Tp(ACTION_NORTH),mp-=Rp.y,fp+=Rp.y,mp<0&&(cp=ACTION_SOUTH,mp=-mp,fp-=mp),dp&&(pp=mp*dp,hp+=(lp.width-pp)/2);break;case ACTION_WEST:if(Rp.x<=0&&(hp<=xp||dp&&(fp<=_p||yp>=bp))){Ep=!1;break}Tp(ACTION_WEST),pp-=Rp.x,hp+=Rp.x,pp<0&&(cp=ACTION_EAST,pp=-pp,hp-=pp),dp&&(mp=pp/dp,fp+=(lp.height-mp)/2);break;case ACTION_SOUTH:if(Rp.y>=0&&(yp>=bp||dp&&(hp<=xp||gp>=vp))){Ep=!1;break}Tp(ACTION_SOUTH),mp+=Rp.y,mp<0&&(cp=ACTION_NORTH,mp=-mp,fp-=mp),dp&&(pp=mp*dp,hp+=(lp.width-pp)/2);break;case ACTION_NORTH_EAST:if(dp){if(Rp.y<=0&&(fp<=_p||gp>=vp)){Ep=!1;break}Tp(ACTION_NORTH),mp-=Rp.y,fp+=Rp.y,pp=mp*dp}else Tp(ACTION_NORTH),Tp(ACTION_EAST),Rp.x>=0?gp<vp?pp+=Rp.x:Rp.y<=0&&fp<=_p&&(Ep=!1):pp+=Rp.x,Rp.y<=0?fp>_p&&(mp-=Rp.y,fp+=Rp.y):(mp-=Rp.y,fp+=Rp.y);pp<0&&mp<0?(cp=ACTION_SOUTH_WEST,mp=-mp,pp=-pp,fp-=mp,hp-=pp):pp<0?(cp=ACTION_NORTH_WEST,pp=-pp,hp-=pp):mp<0&&(cp=ACTION_SOUTH_EAST,mp=-mp,fp-=mp);break;case ACTION_NORTH_WEST:if(dp){if(Rp.y<=0&&(fp<=_p||hp<=xp)){Ep=!1;break}Tp(ACTION_NORTH),mp-=Rp.y,fp+=Rp.y,pp=mp*dp,hp+=lp.width-pp}else Tp(ACTION_NORTH),Tp(ACTION_WEST),Rp.x<=0?hp>xp?(pp-=Rp.x,hp+=Rp.x):Rp.y<=0&&fp<=_p&&(Ep=!1):(pp-=Rp.x,hp+=Rp.x),Rp.y<=0?fp>_p&&(mp-=Rp.y,fp+=Rp.y):(mp-=Rp.y,fp+=Rp.y);pp<0&&mp<0?(cp=ACTION_SOUTH_EAST,mp=-mp,pp=-pp,fp-=mp,hp-=pp):pp<0?(cp=ACTION_NORTH_EAST,pp=-pp,hp-=pp):mp<0&&(cp=ACTION_SOUTH_WEST,mp=-mp,fp-=mp);break;case ACTION_SOUTH_WEST:if(dp){if(Rp.x<=0&&(hp<=xp||yp>=bp)){Ep=!1;break}Tp(ACTION_WEST),pp-=Rp.x,hp+=Rp.x,mp=pp/dp}else Tp(ACTION_SOUTH),Tp(ACTION_WEST),Rp.x<=0?hp>xp?(pp-=Rp.x,hp+=Rp.x):Rp.y>=0&&yp>=bp&&(Ep=!1):(pp-=Rp.x,hp+=Rp.x),Rp.y>=0?yp<bp&&(mp+=Rp.y):mp+=Rp.y;pp<0&&mp<0?(cp=ACTION_NORTH_EAST,mp=-mp,pp=-pp,fp-=mp,hp-=pp):pp<0?(cp=ACTION_SOUTH_EAST,pp=-pp,hp-=pp):mp<0&&(cp=ACTION_NORTH_WEST,mp=-mp,fp-=mp);break;case ACTION_SOUTH_EAST:if(dp){if(Rp.x>=0&&(gp>=vp||yp>=bp)){Ep=!1;break}Tp(ACTION_EAST),pp+=Rp.x,mp=pp/dp}else Tp(ACTION_SOUTH),Tp(ACTION_EAST),Rp.x>=0?gp<vp?pp+=Rp.x:Rp.y>=0&&yp>=bp&&(Ep=!1):pp+=Rp.x,Rp.y>=0?yp<bp&&(mp+=Rp.y):mp+=Rp.y;pp<0&&mp<0?(cp=ACTION_NORTH_WEST,mp=-mp,pp=-pp,fp-=mp,hp-=pp):pp<0?(cp=ACTION_SOUTH_WEST,pp=-pp,hp-=pp):mp<0&&(cp=ACTION_NORTH_EAST,mp=-mp,fp-=mp);break;case ACTION_MOVE:this.move(Rp.x,Rp.y),Ep=!1;break;case ACTION_ZOOM:this.zoom(getMaxZoomRatio(up),_d),Ep=!1;break;case ACTION_CROP:if(!Rp.x||!Rp.y){Ep=!1;break}Sp=getOffset(this.cropper),hp=Ap.startX-Sp.left,fp=Ap.startY-Sp.top,pp=lp.minWidth,mp=lp.minHeight,Rp.x>0?cp=Rp.y>0?ACTION_SOUTH_EAST:ACTION_NORTH_EAST:Rp.x<0&&(hp-=pp,cp=Rp.y>0?ACTION_SOUTH_WEST:ACTION_NORTH_WEST),Rp.y<0&&(fp-=mp),this.cropped||(removeClass(this.cropBox,CLASS_HIDDEN),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}Ep&&(lp.width=pp,lp.height=mp,lp.left=hp,lp.top=fp,this.action=cp,this.renderCropBox()),forEach(up,function(Mp){Mp.startX=Mp.endX,Mp.startY=Mp.endY})}},methods={crop:function rp(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&addClass(this.dragBox,CLASS_MODAL),removeClass(this.cropBox,CLASS_HIDDEN),this.setCropBoxData(this.initialCropBoxData)),this},reset:function rp(){return this.ready&&!this.disabled&&(this.imageData=assign({},this.initialImageData),this.canvasData=assign({},this.initialCanvasData),this.cropBoxData=assign({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function rp(){return this.cropped&&!this.disabled&&(assign(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),removeClass(this.dragBox,CLASS_MODAL),addClass(this.cropBox,CLASS_HIDDEN)),this},replace:function rp(_d){var np=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&_d&&(this.isImg&&(this.element.src=_d),np?(this.url=_d,this.image.src=_d,this.ready&&(this.viewBoxImage.src=_d,forEach(this.previews,function(ap){ap.getElementsByTagName("img")[0].src=_d}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(_d))),this},enable:function rp(){return this.ready&&this.disabled&&(this.disabled=!1,removeClass(this.cropper,CLASS_DISABLED)),this},disable:function rp(){return this.ready&&!this.disabled&&(this.disabled=!0,addClass(this.cropper,CLASS_DISABLED)),this},destroy:function rp(){var _d=this.element;return _d[NAMESPACE]?(_d[NAMESPACE]=void 0,this.isImg&&this.replaced&&(_d.src=this.originalUrl),this.uncreate(),this):this},move:function rp(_d){var np=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_d,ap=this.canvasData,sp=ap.left,lp=ap.top;return this.moveTo(isUndefined(_d)?_d:sp+Number(_d),isUndefined(np)?np:lp+Number(np))},moveTo:function rp(_d){var np=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_d,ap=this.canvasData,sp=!1;return _d=Number(_d),np=Number(np),this.ready&&!this.disabled&&this.options.movable&&(isNumber(_d)&&(ap.left=_d,sp=!0),isNumber(np)&&(ap.top=np,sp=!0),sp&&this.renderCanvas(!0)),this},zoom:function rp(_d,np){var ap=this.canvasData;return _d=Number(_d),_d<0?_d=1/(1-_d):_d=1+_d,this.zoomTo(ap.width*_d/ap.naturalWidth,null,np)},zoomTo:function rp(_d,np,ap){var sp=this.options,lp=this.canvasData,up=lp.width,cp=lp.height,dp=lp.naturalWidth,hp=lp.naturalHeight;if(_d=Number(_d),_d>=0&&this.ready&&!this.disabled&&sp.zoomable){var fp=dp*_d,pp=hp*_d;if(dispatchEvent(this.element,EVENT_ZOOM,{ratio:_d,oldRatio:up/dp,originalEvent:ap})===!1)return this;if(ap){var mp=this.pointers,gp=getOffset(this.cropper),yp=mp&&Object.keys(mp).length?getPointersCenter(mp):{pageX:ap.pageX,pageY:ap.pageY};lp.left-=(fp-up)*((yp.pageX-gp.left-lp.left)/up),lp.top-=(pp-cp)*((yp.pageY-gp.top-lp.top)/cp)}else isPlainObject(np)&&isNumber(np.x)&&isNumber(np.y)?(lp.left-=(fp-up)*((np.x-lp.left)/up),lp.top-=(pp-cp)*((np.y-lp.top)/cp)):(lp.left-=(fp-up)/2,lp.top-=(pp-cp)/2);lp.width=fp,lp.height=pp,this.renderCanvas(!0)}return this},rotate:function rp(_d){return this.rotateTo((this.imageData.rotate||0)+Number(_d))},rotateTo:function rp(_d){return _d=Number(_d),isNumber(_d)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=_d%360,this.renderCanvas(!0,!0)),this},scaleX:function rp(_d){var np=this.imageData.scaleY;return this.scale(_d,isNumber(np)?np:1)},scaleY:function rp(_d){var np=this.imageData.scaleX;return this.scale(isNumber(np)?np:1,_d)},scale:function rp(_d){var np=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_d,ap=this.imageData,sp=!1;return _d=Number(_d),np=Number(np),this.ready&&!this.disabled&&this.options.scalable&&(isNumber(_d)&&(ap.scaleX=_d,sp=!0),isNumber(np)&&(ap.scaleY=np,sp=!0),sp&&this.renderCanvas(!0,!0)),this},getData:function rp(){var _d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,np=this.options,ap=this.imageData,sp=this.canvasData,lp=this.cropBoxData,up;if(this.ready&&this.cropped){up={x:lp.left-sp.left,y:lp.top-sp.top,width:lp.width,height:lp.height};var cp=ap.width/ap.naturalWidth;if(forEach(up,function(fp,pp){up[pp]=fp/cp}),_d){var dp=Math.round(up.y+up.height),hp=Math.round(up.x+up.width);up.x=Math.round(up.x),up.y=Math.round(up.y),up.width=hp-up.x,up.height=dp-up.y}}else up={x:0,y:0,width:0,height:0};return np.rotatable&&(up.rotate=ap.rotate||0),np.scalable&&(up.scaleX=ap.scaleX||1,up.scaleY=ap.scaleY||1),up},setData:function rp(_d){var np=this.options,ap=this.imageData,sp=this.canvasData,lp={};if(this.ready&&!this.disabled&&isPlainObject(_d)){var up=!1;np.rotatable&&isNumber(_d.rotate)&&_d.rotate!==ap.rotate&&(ap.rotate=_d.rotate,up=!0),np.scalable&&(isNumber(_d.scaleX)&&_d.scaleX!==ap.scaleX&&(ap.scaleX=_d.scaleX,up=!0),isNumber(_d.scaleY)&&_d.scaleY!==ap.scaleY&&(ap.scaleY=_d.scaleY,up=!0)),up&&this.renderCanvas(!0,!0);var cp=ap.width/ap.naturalWidth;isNumber(_d.x)&&(lp.left=_d.x*cp+sp.left),isNumber(_d.y)&&(lp.top=_d.y*cp+sp.top),isNumber(_d.width)&&(lp.width=_d.width*cp),isNumber(_d.height)&&(lp.height=_d.height*cp),this.setCropBoxData(lp)}return this},getContainerData:function rp(){return this.ready?assign({},this.containerData):{}},getImageData:function rp(){return this.sized?assign({},this.imageData):{}},getCanvasData:function rp(){var _d=this.canvasData,np={};return this.ready&&forEach(["left","top","width","height","naturalWidth","naturalHeight"],function(ap){np[ap]=_d[ap]}),np},setCanvasData:function rp(_d){var np=this.canvasData,ap=np.aspectRatio;return this.ready&&!this.disabled&&isPlainObject(_d)&&(isNumber(_d.left)&&(np.left=_d.left),isNumber(_d.top)&&(np.top=_d.top),isNumber(_d.width)?(np.width=_d.width,np.height=_d.width/ap):isNumber(_d.height)&&(np.height=_d.height,np.width=_d.height*ap),this.renderCanvas(!0)),this},getCropBoxData:function rp(){var _d=this.cropBoxData,np;return this.ready&&this.cropped&&(np={left:_d.left,top:_d.top,width:_d.width,height:_d.height}),np||{}},setCropBoxData:function rp(_d){var np=this.cropBoxData,ap=this.options.aspectRatio,sp,lp;return this.ready&&this.cropped&&!this.disabled&&isPlainObject(_d)&&(isNumber(_d.left)&&(np.left=_d.left),isNumber(_d.top)&&(np.top=_d.top),isNumber(_d.width)&&_d.width!==np.width&&(sp=!0,np.width=_d.width),isNumber(_d.height)&&_d.height!==np.height&&(lp=!0,np.height=_d.height),ap&&(sp?np.height=np.width/ap:lp&&(np.width=np.height*ap)),this.renderCropBox()),this},getCroppedCanvas:function rp(){var _d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var np=this.canvasData,ap=getSourceCanvas(this.image,this.imageData,np,_d);if(!this.cropped)return ap;var sp=this.getData(_d.rounded),lp=sp.x,up=sp.y,cp=sp.width,dp=sp.height,hp=ap.width/Math.floor(np.naturalWidth);hp!==1&&(lp*=hp,up*=hp,cp*=hp,dp*=hp);var fp=cp/dp,pp=getAdjustedSizes({aspectRatio:fp,width:_d.maxWidth||1/0,height:_d.maxHeight||1/0}),mp=getAdjustedSizes({aspectRatio:fp,width:_d.minWidth||0,height:_d.minHeight||0},"cover"),gp=getAdjustedSizes({aspectRatio:fp,width:_d.width||(hp!==1?ap.width:cp),height:_d.height||(hp!==1?ap.height:dp)}),yp=gp.width,xp=gp.height;yp=Math.min(pp.width,Math.max(mp.width,yp)),xp=Math.min(pp.height,Math.max(mp.height,xp));var _p=document.createElement("canvas"),vp=_p.getContext("2d");_p.width=normalizeDecimalNumber(yp),_p.height=normalizeDecimalNumber(xp),vp.fillStyle=_d.fillColor||"transparent",vp.fillRect(0,0,yp,xp);var bp=_d.imageSmoothingEnabled,Ep=bp===void 0?!0:bp,Sp=_d.imageSmoothingQuality;vp.imageSmoothingEnabled=Ep,Sp&&(vp.imageSmoothingQuality=Sp);var Ap=ap.width,Rp=ap.height,Tp=lp,Mp=up,Op,Pp,$p,zp,Dp,Fp;Tp<=-cp||Tp>Ap?(Tp=0,Op=0,$p=0,Dp=0):Tp<=0?($p=-Tp,Tp=0,Op=Math.min(Ap,cp+Tp),Dp=Op):Tp<=Ap&&($p=0,Op=Math.min(cp,Ap-Tp),Dp=Op),Op<=0||Mp<=-dp||Mp>Rp?(Mp=0,Pp=0,zp=0,Fp=0):Mp<=0?(zp=-Mp,Mp=0,Pp=Math.min(Rp,dp+Mp),Fp=Pp):Mp<=Rp&&(zp=0,Pp=Math.min(dp,Rp-Mp),Fp=Pp);var jp=[Tp,Mp,Op,Pp];if(Dp>0&&Fp>0){var Lp=yp/cp;jp.push($p*Lp,zp*Lp,Dp*Lp,Fp*Lp)}return vp.drawImage.apply(vp,[ap].concat(_toConsumableArray(jp.map(function(Bp){return Math.floor(normalizeDecimalNumber(Bp))})))),_p},setAspectRatio:function rp(_d){var np=this.options;return!this.disabled&&!isUndefined(_d)&&(np.aspectRatio=Math.max(0,_d)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function rp(_d){var np=this.options,ap=this.dragBox,sp=this.face;if(this.ready&&!this.disabled){var lp=_d===DRAG_MODE_CROP,up=np.movable&&_d===DRAG_MODE_MOVE;_d=lp||up?_d:DRAG_MODE_NONE,np.dragMode=_d,setData(ap,DATA_ACTION,_d),toggleClass(ap,CLASS_CROP,lp),toggleClass(ap,CLASS_MOVE,up),np.cropBoxMovable||(setData(sp,DATA_ACTION,_d),toggleClass(sp,CLASS_CROP,lp),toggleClass(sp,CLASS_MOVE,up))}return this}},AnotherCropper=WINDOW.Cropper,Cropper=function(){function rp(_d){var np=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(_classCallCheck(this,rp),!_d||!REGEXP_TAG_NAME.test(_d.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=_d,this.options=assign({},DEFAULTS$1,isPlainObject(np)&&np),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return _createClass(rp,[{key:"init",value:function(){var np=this.element,ap=np.tagName.toLowerCase(),sp;if(!np[NAMESPACE]){if(np[NAMESPACE]=this,ap==="img"){if(this.isImg=!0,sp=np.getAttribute("src")||"",this.originalUrl=sp,!sp)return;sp=np.src}else ap==="canvas"&&window.HTMLCanvasElement&&(sp=np.toDataURL());this.load(sp)}}},{key:"load",value:function(np){var ap=this;if(np){this.url=np,this.imageData={};var sp=this.element,lp=this.options;if(!lp.rotatable&&!lp.scalable&&(lp.checkOrientation=!1),!lp.checkOrientation||!window.ArrayBuffer){this.clone();return}if(REGEXP_DATA_URL.test(np)){REGEXP_DATA_URL_JPEG.test(np)?this.read(dataURLToArrayBuffer(np)):this.clone();return}var up=new XMLHttpRequest,cp=this.clone.bind(this);this.reloading=!0,this.xhr=up,up.onabort=cp,up.onerror=cp,up.ontimeout=cp,up.onprogress=function(){up.getResponseHeader("content-type")!==MIME_TYPE_JPEG&&up.abort()},up.onload=function(){ap.read(up.response)},up.onloadend=function(){ap.reloading=!1,ap.xhr=null},lp.checkCrossOrigin&&isCrossOriginURL(np)&&sp.crossOrigin&&(np=addTimestamp(np)),up.open("GET",np,!0),up.responseType="arraybuffer",up.withCredentials=sp.crossOrigin==="use-credentials",up.send()}}},{key:"read",value:function(np){var ap=this.options,sp=this.imageData,lp=resetAndGetOrientation(np),up=0,cp=1,dp=1;if(lp>1){this.url=arrayBufferToDataURL(np,MIME_TYPE_JPEG);var hp=parseOrientation(lp);up=hp.rotate,cp=hp.scaleX,dp=hp.scaleY}ap.rotatable&&(sp.rotate=up),ap.scalable&&(sp.scaleX=cp,sp.scaleY=dp),this.clone()}},{key:"clone",value:function(){var np=this.element,ap=this.url,sp=np.crossOrigin,lp=ap;this.options.checkCrossOrigin&&isCrossOriginURL(ap)&&(sp||(sp="anonymous"),lp=addTimestamp(ap)),this.crossOrigin=sp,this.crossOriginUrl=lp;var up=document.createElement("img");sp&&(up.crossOrigin=sp),up.src=lp||ap,up.alt=np.alt||"The image to crop",this.image=up,up.onload=this.start.bind(this),up.onerror=this.stop.bind(this),addClass(up,CLASS_HIDE),np.parentNode.insertBefore(up,np.nextSibling)}},{key:"start",value:function(){var np=this,ap=this.image;ap.onload=null,ap.onerror=null,this.sizing=!0;var sp=WINDOW.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(WINDOW.navigator.userAgent),lp=function(hp,fp){assign(np.imageData,{naturalWidth:hp,naturalHeight:fp,aspectRatio:hp/fp}),np.initialImageData=assign({},np.imageData),np.sizing=!1,np.sized=!0,np.build()};if(ap.naturalWidth&&!sp){lp(ap.naturalWidth,ap.naturalHeight);return}var up=document.createElement("img"),cp=document.body||document.documentElement;this.sizingImage=up,up.onload=function(){lp(up.width,up.height),sp||cp.removeChild(up)},up.src=ap.src,sp||(up.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",cp.appendChild(up))}},{key:"stop",value:function(){var np=this.image;np.onload=null,np.onerror=null,np.parentNode.removeChild(np),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var np=this.element,ap=this.options,sp=this.image,lp=np.parentNode,up=document.createElement("div");up.innerHTML=TEMPLATE;var cp=up.querySelector(".".concat(NAMESPACE,"-container")),dp=cp.querySelector(".".concat(NAMESPACE,"-canvas")),hp=cp.querySelector(".".concat(NAMESPACE,"-drag-box")),fp=cp.querySelector(".".concat(NAMESPACE,"-crop-box")),pp=fp.querySelector(".".concat(NAMESPACE,"-face"));this.container=lp,this.cropper=cp,this.canvas=dp,this.dragBox=hp,this.cropBox=fp,this.viewBox=cp.querySelector(".".concat(NAMESPACE,"-view-box")),this.face=pp,dp.appendChild(sp),addClass(np,CLASS_HIDDEN),lp.insertBefore(cp,np.nextSibling),removeClass(sp,CLASS_HIDE),this.initPreview(),this.bind(),ap.initialAspectRatio=Math.max(0,ap.initialAspectRatio)||NaN,ap.aspectRatio=Math.max(0,ap.aspectRatio)||NaN,ap.viewMode=Math.max(0,Math.min(3,Math.round(ap.viewMode)))||0,addClass(fp,CLASS_HIDDEN),ap.guides||addClass(fp.getElementsByClassName("".concat(NAMESPACE,"-dashed")),CLASS_HIDDEN),ap.center||addClass(fp.getElementsByClassName("".concat(NAMESPACE,"-center")),CLASS_HIDDEN),ap.background&&addClass(cp,"".concat(NAMESPACE,"-bg")),ap.highlight||addClass(pp,CLASS_INVISIBLE),ap.cropBoxMovable&&(addClass(pp,CLASS_MOVE),setData(pp,DATA_ACTION,ACTION_ALL)),ap.cropBoxResizable||(addClass(fp.getElementsByClassName("".concat(NAMESPACE,"-line")),CLASS_HIDDEN),addClass(fp.getElementsByClassName("".concat(NAMESPACE,"-point")),CLASS_HIDDEN)),this.render(),this.ready=!0,this.setDragMode(ap.dragMode),ap.autoCrop&&this.crop(),this.setData(ap.data),isFunction$1(ap.ready)&&addListener(np,EVENT_READY,ap.ready,{once:!0}),dispatchEvent(np,EVENT_READY)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var np=this.cropper.parentNode;np&&np.removeChild(this.cropper),removeClass(this.element,CLASS_HIDDEN)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=AnotherCropper,rp}},{key:"setDefaults",value:function(np){assign(DEFAULTS$1,isPlainObject(np)&&np)}}]),rp}();assign(Cropper.prototype,render,preview,events$1,handlers,change,methods);var n=function(){return n=Object.assign||function(rp){for(var _d,np=1,ap=arguments.length;np<ap;np++)for(var sp in _d=arguments[np])Object.prototype.hasOwnProperty.call(_d,sp)&&(rp[sp]=_d[sp]);return rp},n.apply(this,arguments)};function a(rp,_d){var np={};for(var ap in rp)Object.prototype.hasOwnProperty.call(rp,ap)&&_d.indexOf(ap)<0&&(np[ap]=rp[ap]);if(rp!=null&&typeof Object.getOwnPropertySymbols=="function"){var sp=0;for(ap=Object.getOwnPropertySymbols(rp);sp<ap.length;sp++)_d.indexOf(ap[sp])<0&&Object.prototype.propertyIsEnumerable.call(rp,ap[sp])&&(np[ap[sp]]=rp[ap[sp]])}return np}var c=["aspectRatio","autoCrop","autoCropArea","background","center","checkCrossOrigin","checkOrientation","cropBoxMovable","cropBoxResizable","data","dragMode","guides","highlight","initialAspectRatio","minCanvasHeight","minCanvasWidth","minContainerHeight","minContainerWidth","minCropBoxHeight","minCropBoxWidth","modal","movable","preview","responsive","restore","rotatable","scalable","toggleDragModeOnDblclick","viewMode","wheelZoomRatio","zoomOnTouch","zoomOnWheel","zoomable","cropstart","cropmove","cropend","crop","zoom","ready"],i$1={opacity:0,maxWidth:"100%"},l=React.forwardRef(function(rp,_d){var np=a(rp,[]),ap=np.dragMode,sp=ap===void 0?"crop":ap,lp=np.src,up=np.style,cp=np.className,dp=np.crossOrigin,hp=np.scaleX,fp=np.scaleY,pp=np.enable,mp=np.zoomTo,gp=np.rotateTo,yp=np.alt,xp=yp===void 0?"picture":yp,_p=np.ready,vp=np.onInitialized,bp=a(np,["dragMode","src","style","className","crossOrigin","scaleX","scaleY","enable","zoomTo","rotateTo","alt","ready","onInitialized"]),Ep={scaleY:fp,scaleX:hp,enable:pp,zoomTo:mp,rotateTo:gp},Sp=function(){for(var Rp=[],Tp=0;Tp<arguments.length;Tp++)Rp[Tp]=arguments[Tp];var Mp=reactExports.useRef(null);return React.useEffect(function(){Rp.forEach(function(Op){Op&&(typeof Op=="function"?Op(Mp.current):Op.current=Mp.current)})},[Rp]),Mp}(_d,reactExports.useRef(null));reactExports.useEffect(function(){var Rp;!((Rp=Sp.current)===null||Rp===void 0)&&Rp.cropper&&typeof mp=="number"&&Sp.current.cropper.zoomTo(mp)},[np.zoomTo]),reactExports.useEffect(function(){var Rp;!((Rp=Sp.current)===null||Rp===void 0)&&Rp.cropper&&lp!==void 0&&Sp.current.cropper.reset().clear().replace(lp)},[lp]),reactExports.useEffect(function(){if(Sp.current!==null){var Rp=new Cropper(Sp.current,n(n({dragMode:sp},bp),{ready:function(Tp){Tp.currentTarget!==null&&function(Mp,Op){Op===void 0&&(Op={});var Pp=Op.enable,$p=Pp===void 0||Pp,zp=Op.scaleX,Dp=zp===void 0?1:zp,Fp=Op.scaleY,jp=Fp===void 0?1:Fp,Lp=Op.zoomTo,Bp=Lp===void 0?0:Lp,Ip=Op.rotateTo;$p?Mp.enable():Mp.disable(),Mp.scaleX(Dp),Mp.scaleY(jp),Ip!==void 0&&Mp.rotateTo(Ip),Bp>0&&Mp.zoomTo(Bp)}(Tp.currentTarget.cropper,Ep),_p&&_p(Tp)}}));vp&&vp(Rp)}return function(){var Tp,Mp;(Mp=(Tp=Sp.current)===null||Tp===void 0?void 0:Tp.cropper)===null||Mp===void 0||Mp.destroy()}},[Sp]);var Ap=function(Rp){return c.reduce(function(Tp,Mp){var Op=Tp,Pp=Mp;return Op[Pp],a(Op,[typeof Pp=="symbol"?Pp:Pp+""])},Rp)}(n(n({},bp),{crossOrigin:dp,src:lp,alt:xp}));return React.createElement("div",{style:up,className:cp},React.createElement("img",n({},Ap,{style:i$1,ref:Sp})))});const Aspect=({cropperRef:rp})=>{const[_d,np]=reactExports.useState(1);return jsxRuntimeExports.jsxs("div",{className:"Aspect",children:[jsxRuntimeExports.jsxs("div",{className:"Aspect_header",children:[jsxRuntimeExports.jsx("div",{className:`Aspect_length ${_d&&"active"}`,onClick:()=>np(1),children:jsxRuntimeExports.jsx(FaCheck,{style:{color:"#191919"}})}),jsxRuntimeExports.jsx("div",{className:`Aspect_width ${!_d&&"active"}`,onClick:()=>np(0),children:jsxRuntimeExports.jsx(FaCheck,{style:{color:"#191919"}})})]}),jsxRuntimeExports.jsxs("div",{className:"Aspect_body",children:[jsxRuntimeExports.jsx("button",{onClick:()=>rp.current.cropper.setAspectRatio(NaN),children:""}),jsxRuntimeExports.jsx("button",{onClick:()=>rp.current.cropper.setAspectRatio(1),children:"1:1"}),_d?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>rp.current.cropper.setAspectRatio(3/4),children:"3:4"}),jsxRuntimeExports.jsx("button",{onClick:()=>rp.current.cropper.setAspectRatio(9/16),children:"9:16"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>rp.current.cropper.setAspectRatio(4/3),children:"4:3"}),jsxRuntimeExports.jsx("button",{onClick:()=>rp.current.cropper.setAspectRatio(16/9),children:"16:9"})]})]})]})};function ImageEditPage(){const rp=useLocation(),_d=useNavigate(),np=rp.state.value,ap=reactExports.useRef(null),sp=()=>{var lp;_d("/fish/image/result",{replace:!0,state:{value:(lp=ap.current)==null?void 0:lp.cropper.getCroppedCanvas().toDataURL()}})};return jsxRuntimeExports.jsxs("div",{className:"Demo",children:[jsxRuntimeExports.jsx(Header,{filter:"invert(1)",headerColor:"transparent"}),jsxRuntimeExports.jsx("div",{className:"crop",onClick:sp,children:""}),jsxRuntimeExports.jsx("div",{className:"Demo_body",children:jsxRuntimeExports.jsx(l,{ref:ap,style:{height:"100%",width:"100%"},dragMode:"none",viewMode:1,highlight:!1,background:!1,autoCropArea:1,minCropBoxWidth:150,minCropBoxHeight:150,src:np})}),jsxRuntimeExports.jsx("div",{className:"Demo_footer",children:jsxRuntimeExports.jsx(Aspect,{cropperRef:ap})})]})}const FishBookList=({fishdata:rp,type:_d})=>{console.log(rp);const[np,ap]=reactExports.useState([_d]);reactExports.useState(!1);const sp=lp=>{const up=lp+"";if(up.substring(0,4)==="9999")return 0;const dp=up.substring(5,7),hp=up.substring(8,11);return dp+"/"+hp};return reactExports.useEffect(()=>{if(_d==0)ap(rp);else if(_d==1){const lp=rp.filter(up=>up.fishType==="FRESH_WATER");ap(lp)}else if(_d==2){const lp=rp.filter(up=>up.fishType==="SEA");ap(lp)}},[_d]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("ul",{className:"fish-list",children:np&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:np.map((lp,up)=>jsxRuntimeExports.jsx(Link,{to:`/fishbook/${lp.id}`,children:jsxRuntimeExports.jsxs("li",{className:"fish-item view-two blue-bd shadow",children:[jsxRuntimeExports.jsx("div",{className:"fish-profile"}),jsxRuntimeExports.jsx("div",{className:"fish-profile-type blue-fc",children:lp.fishType}),jsxRuntimeExports.jsx("div",{className:"fish-profile-name",children:lp.name}),jsxRuntimeExports.jsx("div",{className:"fish-profile-size",children:lp.minimumSize}),sp(lp.tabooStartAt)!=0&&jsxRuntimeExports.jsx("div",{className:"fish-date",children:jsxRuntimeExports.jsxs("div",{children:[sp(lp.tabooStartAt),"~",sp(lp.tabooEndAt)]})}),lp.mininumSize!=0&&jsxRuntimeExports.jsx("div",{className:"bansize",children:lp.mininumSize}),jsxRuntimeExports.jsx("div",{className:"fish-detail-btn bg-blue",children:"VIEW"})]})},up))})})})},BASE_URL="https://i10c203.p.ssafy.io";localStorage.getItem("jwt");const axiosApi=()=>{const rp=axios.create({baseURL:`${BASE_URL}`}),_d=localStorage.getItem("jwt");return rp.defaults.headers.common.Authorization=_d,rp.defaults.headers.post["Content-Type"]="application/json",rp.defaults.headers.put["Content-Type"]="application/json",rp.defaults.headers.delete["Content-Type"]="application/json",rp},api$3=axiosApi(),url$1="/fishbooks";async function getFishList(){try{const{data:rp}=await api$3.get(`${url$1}`);return console.log(rp),rp}catch(rp){console.log(rp)}}async function getFishDetail(rp){try{console.log("dddd");const{data:_d}=await api$3.get(`${url$1}/${rp}`);return console.log(_d),_d}catch(_d){console.log(_d)}}const FishBook=()=>{const[rp,_d]=reactExports.useState([]),[np,ap]=reactExports.useState(0),sp=async()=>{await getFishList().then(lp=>_d(lp)),console.log("ddddddddddd"),console.log(rp)};return reactExports.useEffect(()=>{sp()},[]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Header,{filter:"invert(1)",headerColor:"inherit"}),jsxRuntimeExports.jsx("div",{className:"fishbook-header bg-blue"}),jsxRuntimeExports.jsx("div",{className:"fishbook-title",children:"FishUniverse"}),jsxRuntimeExports.jsxs("div",{className:"fishbook-category shadow",children:[jsxRuntimeExports.jsxs("div",{className:`fishbook-category-header ${np==0?"blue-fc":""}`,onClick:()=>ap(0),children:[jsxRuntimeExports.jsx("div",{children:""}),jsxRuntimeExports.jsx("div",{children:"46"})]}),jsxRuntimeExports.jsxs("div",{className:`fishbook-category-header ${np==1?"blue-fc":""}`,onClick:()=>ap(1),children:[jsxRuntimeExports.jsx("div",{children:""}),jsxRuntimeExports.jsx("div",{children:"14"})]}),jsxRuntimeExports.jsxs("div",{className:`fishbook-category-header ${np==2?"blue-fc":""}`,onClick:()=>ap(2),children:[jsxRuntimeExports.jsx("div",{children:""}),jsxRuntimeExports.jsx("div",{children:"32"})]})]}),jsxRuntimeExports.jsx("div",{className:"fishbook-list",children:rp.fishBooks&&jsxRuntimeExports.jsx(FishBookList,{fishdata:rp.fishBooks,type:np})})]})};var KeyboardArrowRight={},_interopRequireDefault$q=interopRequireDefaultExports;Object.defineProperty(KeyboardArrowRight,"__esModule",{value:!0});var default_1$h=KeyboardArrowRight.default=void 0,_createSvgIcon$h=_interopRequireDefault$q(requireCreateSvgIcon()),_jsxRuntime$h=jsxRuntimeExports;default_1$h=KeyboardArrowRight.default=(0,_createSvgIcon$h.default)((0,_jsxRuntime$h.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight");const FishBookDetail=({fish:rp})=>{const[_d,np]=reactExports.useState(!1),[ap,sp]=reactExports.useState([]),lp=()=>{np(!_d);const up=JSON.parse(rp.interview);sp(up),console.log(ap),console.log(rp.interview),console.log(typeof rp.interview),console.log(up),console.log(typeof up)};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:_d?"card-rotate":"back-rotate",onClick:lp,children:[jsxRuntimeExports.jsxs("div",{className:"front",children:[jsxRuntimeExports.jsx("img",{src:back,alt:"",className:"back-fish-lish",onClick:()=>history.back()}),jsxRuntimeExports.jsx("div",{className:"detail-title",children:"Mulgogi"}),jsxRuntimeExports.jsxs("div",{className:"size",children:["size",jsxRuntimeExports.jsx("div",{style:{whiteSpace:"pre-line"},children:rp.size})]}),jsxRuntimeExports.jsx("div",{className:"fish-img",children:jsxRuntimeExports.jsx("img",{src:rp.imageUrl})}),jsxRuntimeExports.jsx("div",{className:"sub-one",children:"the fish"}),jsxRuntimeExports.jsx("div",{className:"sub-two",children:"we love"}),jsxRuntimeExports.jsx("div",{className:"fish-name",children:rp.name}),jsxRuntimeExports.jsxs("div",{className:"science-name",children:["",jsxRuntimeExports.jsx("div",{style:{whiteSpace:"pre-line"},children:rp.scientificName})]}),jsxRuntimeExports.jsxs("div",{className:"food",children:["Food",jsxRuntimeExports.jsx("div",{style:{whiteSpace:"pre-line"},children:rp.bait})]}),jsxRuntimeExports.jsxs("div",{className:"live",children:["Where",jsxRuntimeExports.jsx("br",{}),"you live"]}),jsxRuntimeExports.jsx("div",{className:"habitat",style:{whiteSpace:"pre-line"},children:rp.habitat}),jsxRuntimeExports.jsx("div",{className:"arrow",children:jsxRuntimeExports.jsx(default_1$h,{})})]}),jsxRuntimeExports.jsxs("div",{className:"back",children:[jsxRuntimeExports.jsxs("div",{className:"question",children:["Q. ",ap.first_question,jsxRuntimeExports.jsx("div",{style:{whiteSpace:"pre-line"},children:ap.first_answer})]}),jsxRuntimeExports.jsxs("div",{className:"question",children:["Q. ",ap.second_question,jsxRuntimeExports.jsx("div",{style:{whiteSpace:"pre-line"},children:ap.second_answer})]}),ap.third_question&&jsxRuntimeExports.jsxs("div",{className:"question",children:["Q. ",ap.third_question,jsxRuntimeExports.jsx("div",{style:{whiteSpace:"pre-line"},children:ap.third_answer})]})]})]})})},FishBookDetailPage=()=>{const{id:rp}=useParams(),[_d,np]=reactExports.useState([]);reactExports.useEffect(()=>{ap()},[]);const ap=async()=>{await getFishDetail(rp).then(sp=>np(sp)),console.log(_d)};return jsxRuntimeExports.jsx(FishBookDetail,{fish:_d})},naver_logo="/assets/naver_logo-AO9luVSE.webp",SocialNaver=()=>{const ap="https://nid.naver.com/oauth2.0/authorize?client_id=w88WA5fuXobhPaQEmw1p&response_type=code&redirect_uri=https://i10c203.p.ssafy.io/login/naver&state=niwXgvCl5E",sp=()=>{window.location.href=ap};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("img",{src:naver_logo,alt:"",onClick:sp})})},kakao_logo="/assets/kakao_logo-gTeKQ0qg.webp",SocialKakao=()=>{const np="https://kauth.kakao.com/oauth/authorize?client_id=db5b74e6c640443403b9705680d9dbac&redirect_uri=https://i10c203.p.ssafy.io/login/kakao&response_type=code",ap=()=>{window.location.href=np};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("img",{src:kakao_logo,alt:"",onClick:ap})})},google_logo="data:image/webp;base64,UklGRmoDAABXRUJQVlA4TF0DAAAvY8AYEO/CqI0kR7Wsj9uhml/P5rwU2DaSpKiPzMs/v3v0mZtx2zaSBNjOzOz1Sv9tbTEXEEKylUUNIZQQQnsG/0UQgaQNC3BfA/BffKBAgQAFChR4QIAAASo1rkizr0ixf5Diiv1Fv0hzRQrQ2QIdA991T6iPMu3qtGlLlHlXpw3lv6Udqy3R1lKXaGs8TTVsk0JrISeHa+fQUmw1bFJoNSwptBo248QVBBTStW1P20Yqczuu7ZDZY5TDDGVmOv/zyBzp0/cpwz8R/Xfgtm0kSc2c3Tl3k+4X2P9Wo8B181kLrhvGBu5z85Zau+BFBhEWbQusU4qNIPEcS9O8T7/k2haCDvGCZ1tI5kPC95+zEC0lRLgWrg7JxjhnoesRdLMtAovY+BaNuWQKwir+hiOchojsKYhE8/fo5DPa1Kco6ewrhYkkMwRFWxVmdCoC6mCQp4rEAS/F0GRNk1hc9DzrUkRsA7cmet9+/PRYpMjjkYsdq+uvIPjMMJc4f2F8sBnO+da2qnYbF8v8pxuv5YMQZhzzGfj6S9kQNDaONT7pM9nQwMB1iZtvsr95Zh4LMnj2x+MbyCyX+9zM+SpXubXtGsiKEr4RA3m8RvIRmFzUzDIg9ydI3gB7qlkk5hrGnJplYs6RWDERroYRc0YNln8fYB1oKlimPtBU5LBzrFxsIitc7aqBuXhVybvPTdS6dQ6oKSg1/u03UWaYXqi5ZwgdP/wQQrQxAaw86Y+5+CcxFnV2CziW/tjx3VeRtYUHYM+l7hiYv/8uJkj7avB+R3e6A9SPQmaVbH7ypPef5N1nIbeBww0gLvT+W73/JqRiHfDhBMCtzhA181PBbw+nAE6fmIZfBMgWRkA+rUM/hbX6QO/ooDh5ZFo2YYhyF85g5/gENtdjUBZA630g7bIYHcHmmnYF2HoP8BxaZTF2eKDmimnbEHDLje5A9gxaNTHpHugoupsqQstyNWNZKBwdq9IXgr1UEDg8BKQW/T4k7kuKyRPDsU3Tdo+znR4YM7mNjiZKu9lteJDJwaY3sScLpIOlFKRdhm2/gk+5xwhsYlMbMBK7qBvTDiOzlYIAlzZCB03Vgl7FIV1olbWPM14ywW5dp3utPWDG2GtWIVQanQEzzV6n2axO2Gx2euy/qgwA",SocialGoogle=()=>{const np="https://accounts.google.com/o/oauth2/v2/auth?scope=email%20openid&response_type=code&redirect_uri=https://i10c203.p.ssafy.io/login/google&client_id=68067767440-hri2501h11p1d08asfsfaf6t2705u9cr.apps.googleusercontent.com",ap=()=>{window.location.href=np};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("img",{src:google_logo,alt:"",onClick:ap})})},LoginPage=()=>{var ap;const rp=useNavigate(),np=(ap=useLocation().state)==null?void 0:ap.path;return reactExports.useEffect(()=>{localStorage.setItem("jwt","eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQiOiIzMjgxMDc5MDMwIiwic3ViIjoiIiwiaWF0IjoxNzA3ODI1NDQxLCJleHAiOjE3MTA0MTc0NDF9.XiP53pnAryUN9F4ISM3JiZQGst_UsUNQWZgEQOHqcvE"),localStorage.setItem("user",JSON.stringify({imageUrl:null,nickname:""})),localStorage.getItem("jwt")&&rp("/")},[]),jsxRuntimeExports.jsxs("div",{className:"LoginPage",children:[jsxRuntimeExports.jsx(Header,{prevPath:np}),jsxRuntimeExports.jsx("div",{className:"LoginPage_body",children:jsxRuntimeExports.jsx("img",{src:defaultImg,alt:""})}),jsxRuntimeExports.jsxs("div",{className:"LoginPage_footer",children:[jsxRuntimeExports.jsx(SocialNaver,{}),jsxRuntimeExports.jsx(SocialKakao,{}),jsxRuntimeExports.jsx(SocialGoogle,{})]})]})};var CellTowerOutlined={},_interopRequireDefault$p=interopRequireDefaultExports;Object.defineProperty(CellTowerOutlined,"__esModule",{value:!0});var default_1$g=CellTowerOutlined.default=void 0,_createSvgIcon$g=_interopRequireDefault$p(requireCreateSvgIcon()),_jsxRuntime$g=jsxRuntimeExports;default_1$g=CellTowerOutlined.default=(0,_createSvgIcon$g.default)([(0,_jsxRuntime$g.jsx)("path",{d:"m7.3 14.7 1.2-1.2c-1-1-1.5-2.3-1.5-3.5 0-1.3.5-2.6 1.5-3.5L7.3 5.3c-1.3 1.3-2 3-2 4.7s.7 3.4 2 4.7M19.1 2.9l-1.2 1.2c1.6 1.6 2.4 3.8 2.4 5.9 0 2.1-.8 4.3-2.4 5.9l1.2 1.2c2-2 2.9-4.5 2.9-7.1 0-2.6-1-5.1-2.9-7.1"},"0"),(0,_jsxRuntime$g.jsx)("path",{d:"M6.1 4.1 4.9 2.9C3 4.9 2 7.4 2 10c0 2.6 1 5.1 2.9 7.1l1.2-1.2c-1.6-1.6-2.4-3.8-2.4-5.9 0-2.1.8-4.3 2.4-5.9m10.6 10.6c1.3-1.3 2-3 2-4.7-.1-1.7-.7-3.4-2-4.7l-1.2 1.2c1 1 1.5 2.3 1.5 3.5 0 1.3-.5 2.6-1.5 3.5zM14.5 10c0-1.38-1.12-2.5-2.5-2.5S9.5 8.62 9.5 10c0 .76.34 1.42.87 1.88L7 22h2l.67-2h4.67l.66 2h2l-3.37-10.12c.53-.46.87-1.12.87-1.88m-4.17 8L12 13l1.67 5z"},"1")],"CellTowerOutlined");var Cached={},_interopRequireDefault$o=interopRequireDefaultExports;Object.defineProperty(Cached,"__esModule",{value:!0});var default_1$f=Cached.default=void 0,_createSvgIcon$f=_interopRequireDefault$o(requireCreateSvgIcon()),_jsxRuntime$f=jsxRuntimeExports;default_1$f=Cached.default=(0,_createSvgIcon$f.default)((0,_jsxRuntime$f.jsx)("path",{d:"m19 8-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4z"}),"Cached");function RoomList(){const rp=useNavigate(),[_d,np]=reactExports.useState([]),[ap,sp]=reactExports.useState(!0),lp=!1,up="https://i10c203.p.ssafy.io",cp=JSON.parse(localStorage.getItem("user")),dp="wearegitaehasam";reactExports.useEffect(()=>{hp()},[]);const hp=()=>{sp(!0),axios.get(up+"/api/lives").then(pp=>{axios.get(up+"/openvidu/api/sessions",{headers:{Authorization:"Basic "+btoa("OPENVIDUAPP:"+dp),"Content-Type":"application/json"}}).then(mp=>{np(pp.data),sp(!1)})}).catch(pp=>{console.log(pp)})},fp=pp=>{const mp=pp.liveRoomId,gp=pp.sessionId;rp(`/live/${pp.sessionId}`,{state:{isHost:lp,roomId:mp,subscriberSession:gp,nickname:cp.nickname,userImg:cp.imageUrl}})};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ap?jsxRuntimeExports.jsx(Loading,{}):jsxRuntimeExports.jsxs("div",{className:"room-list",children:[jsxRuntimeExports.jsx(Header,{centerText:" "}),jsxRuntimeExports.jsx("div",{className:"roomList-filter",children:jsxRuntimeExports.jsx(default_1$f,{className:"room-list-reload-btn",onClick:hp})}),_d.liveRooms&&_d.liveRooms.length>0?null:jsxRuntimeExports.jsxs("div",{className:"no-live",children:[jsxRuntimeExports.jsx(default_1$g,{}),jsxRuntimeExports.jsx("span",{children:"  ."})]}),jsxRuntimeExports.jsxs("div",{className:"roomlist-wrapper",children:[_d.liveRooms&&_d.liveRooms.map((pp,mp)=>jsxRuntimeExports.jsxs("div",{className:"roomList-info",onClick:()=>fp(pp),children:[jsxRuntimeExports.jsx("img",{src:pp.imageUrl?pp.imageUrl:defaultImg,alt:"room thumbnail",className:"thumbnail"}),jsxRuntimeExports.jsxs("div",{className:"roomList-info-header",children:[jsxRuntimeExports.jsx("p",{children:pp.name}),jsxRuntimeExports.jsx("div",{className:"roomList-info-body",children:jsxRuntimeExports.jsx("span",{children:pp.nickName})})]})]},mp)),jsxRuntimeExports.jsx(NavLink,{to:"/media/roomList/create",className:"nav-item createLive-btn bg-blue",children:jsxRuntimeExports.jsx("span",{children:" "})})]})]})})}var AddOutlined={},_interopRequireDefault$n=interopRequireDefaultExports;Object.defineProperty(AddOutlined,"__esModule",{value:!0});var default_1$e=AddOutlined.default=void 0,_createSvgIcon$e=_interopRequireDefault$n(requireCreateSvgIcon()),_jsxRuntime$e=jsxRuntimeExports;default_1$e=AddOutlined.default=(0,_createSvgIcon$e.default)((0,_jsxRuntime$e.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"AddOutlined");function CreateRoom(){const rp=useNavigate(),_d=!0,np="https://i10c203.p.ssafy.io",ap=JSON.parse(localStorage.getItem("user")),sp=localStorage.getItem("jwt"),[lp,up]=reactExports.useState(""),[cp,dp]=reactExports.useState(""),[hp,fp]=reactExports.useState(null),[pp,mp]=reactExports.useState(null),gp=reactExports.useRef(),yp=Ep=>{up(Ep.target.value)},xp=Ep=>{Ep.preventDefault(),gp.current.click()};reactExports.useEffect(()=>{cp&&fp(jsxRuntimeExports.jsx("img",{className:"room-create-upload-img",src:cp}))},[cp]);const _p=Ep=>{Ep.preventDefault();const Sp=Ep.target.files[0],Ap=new FileReader;Ap.onloadend=()=>{dp(Ap.result)},Sp&&(Ap.readAsDataURL(Sp),vp(Sp))},vp=Ep=>{const Sp=new FormData;Sp.append("images",Ep),Sp.append("type","LIVEROOM"),axios.post(np+"/api/images",Sp,{headers:{Authorization:sp,"Content-Type":"multipart/form-data"}}).then(Ap=>{mp(Ap.data.imageNames[0])}).catch(Ap=>console.log(Ap))},bp=Ep=>{const Sp=Math.floor(Math.random()*1e6);rp(`/live/Gitaehasam${Sp}`,{state:{isHost:_d,roomId:Sp,imageUrl:pp||null,name:lp,nickname:ap.nickname,userImg:ap.imageUrl}})};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Header,{centerText:" "}),jsxRuntimeExports.jsx("form",{className:"room-create-form",children:jsxRuntimeExports.jsxs("div",{className:"create-room-wrapper",children:[jsxRuntimeExports.jsxs("div",{className:"room-create-header",children:[jsxRuntimeExports.jsx("div",{className:"room-create-thumbnail-title",children:"   "}),jsxRuntimeExports.jsxs("div",{className:"room-create-thumbnail",children:[hp,jsxRuntimeExports.jsxs("div",{className:`shadow ${cp?"reupload-btn blue-bd":"upload-btn bg-blue"}`,onClick:xp,children:[!cp&&jsxRuntimeExports.jsx(default_1$e,{}),cp&&"  "]})]}),jsxRuntimeExports.jsx("input",{ref:gp,hidden:!0,type:"file",onChange:_p})]}),jsxRuntimeExports.jsxs("div",{className:"room-create-header",children:[jsxRuntimeExports.jsx("div",{className:"room-create-thumbnail-title",children:""}),jsxRuntimeExports.jsx("input",{className:"room-create-title",type:"text",maxLength:15,value:lp,onChange:yp,placeholder:"  .",required:!0})]}),jsxRuntimeExports.jsx("div",{className:"room-create-btn bg-blue",onClick:bp,children:jsxRuntimeExports.jsx("button",{type:"submit",children:" "})})]})})]})}var lib={},jsnlog={};(function(rp){var _d=commonjsGlobal&&commonjsGlobal.__extends||function(){var ap=function(sp,lp){return ap=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(up,cp){up.__proto__=cp}||function(up,cp){for(var dp in cp)Object.prototype.hasOwnProperty.call(cp,dp)&&(up[dp]=cp[dp])},ap(sp,lp)};return function(sp,lp){ap(sp,lp);function up(){this.constructor=sp}sp.prototype=lp===null?Object.create(lp):(up.prototype=lp.prototype,new up)}}();function np(ap){if(!ap)return np.__;Array.prototype.reduce||(Array.prototype.reduce=function(up,cp){for(var dp=cp,hp=0;hp<this.length;hp++)dp=up(dp,this[hp],hp,this);return dp});var sp="",lp=("."+ap).split(".").reduce(function(up,cp,dp,hp){sp?sp+="."+cp:sp=cp;var fp=up["__"+sp];return fp===void 0&&(np.Logger.prototype=up,fp=new np.Logger(sp),up["__"+sp]=fp),fp},np.__);return lp}(function(ap){ap.requestId="",ap.entryId=0,ap._createXMLHttpRequest=function(){return new XMLHttpRequest},ap._getTime=function(){return new Date().getTime()},ap._console=console,ap._appenderNames=[];function sp(Lp,Bp,Ip){if(Bp[Lp]!==void 0){if(Bp[Lp]===null){delete Ip[Lp];return}Ip[Lp]=Bp[Lp]}}function lp(Lp){if(ap.enabled!=null&&!ap.enabled)return!1;try{if(Lp.userAgentRegex&&!new RegExp(Lp.userAgentRegex).test(navigator.userAgent))return!1}catch{}try{if(Lp.ipRegex&&ap.clientIP&&!new RegExp(Lp.ipRegex).test(ap.clientIP))return!1}catch{}return!0}function up(Lp,Bp){try{if(Lp.disallow&&new RegExp(Lp.disallow).test(Bp))return!1}catch{}return!0}function cp(Lp){return typeof Lp=="function"?Lp instanceof RegExp?Lp.toString():Lp():Lp}var dp=function(){function Lp(Bp,Ip,kp){this.msg=Bp,this.meta=Ip,this.finalString=kp}return Lp}();function hp(Lp){var Bp=cp(Lp),Ip;switch(typeof Bp){case"string":return new dp(Bp,null,Bp);case"number":return Ip=Bp.toString(),new dp(Ip,null,Ip);case"boolean":return Ip=Bp.toString(),new dp(Ip,null,Ip);case"undefined":return new dp("undefined",null,"undefined");case"object":return Bp instanceof RegExp||Bp instanceof String||Bp instanceof Number||Bp instanceof Boolean?(Ip=Bp.toString(),new dp(Ip,null,Ip)):(typeof ap.serialize=="function"?Ip=ap.serialize.call(this,Bp):Ip=JSON.stringify(Bp),new dp("",Bp,Ip));default:return new dp("unknown",null,"unknown")}}function fp(Lp){return sp("enabled",Lp,this),sp("maxMessages",Lp,this),sp("defaultAjaxUrl",Lp,this),sp("clientIP",Lp,this),sp("requestId",Lp,this),sp("defaultBeforeSend",Lp,this),sp("serialize",Lp,this),this}ap.setOptions=fp;function pp(){return-2147483648}ap.getAllLevel=pp;function mp(){return 1e3}ap.getTraceLevel=mp;function gp(){return 2e3}ap.getDebugLevel=gp;function yp(){return 3e3}ap.getInfoLevel=yp;function xp(){return 4e3}ap.getWarnLevel=xp;function _p(){return 5e3}ap.getErrorLevel=_p;function vp(){return 6e3}ap.getFatalLevel=vp;function bp(){return 2147483647}ap.getOffLevel=bp;function Ep(Lp){return Lp<=1e3?"trace":Lp<=2e3?"debug":Lp<=3e3?"info":Lp<=4e3?"warn":Lp<=5e3?"error":"fatal"}var Sp=function(){function Lp(Bp,Ip){this.inner=Ip,this.name="JL.Exception",this.message=hp(Bp).finalString}return Lp}();ap.Exception=Sp,Sp.prototype=new Error;var Ap=function(){function Lp(Bp,Ip,kp,Up,Gp){this.l=Bp,this.m=Ip,this.n=kp,this.t=Up,this.u=Gp}return Lp}();ap.LogItem=Ap;function Rp(Lp,Bp,Ip){return ap.entryId++,new Ap(Lp,Bp,Ip,ap._getTime(),ap.entryId)}function Tp(Lp){Lp.id&&(clearTimeout(Lp.id),Lp.id=null)}function Mp(Lp,Bp,Ip){var kp=this;Lp.id||(Lp.id=setTimeout(function(){Ip.call(kp)},Bp))}var Op=function(){function Lp(Bp,Ip){this.appenderName=Bp,this.sendLogItems=Ip,this.level=ap.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var kp="Trying to create an appender without a name or with an empty name";if(Bp==null)throw kp;if(ap._appenderNames.indexOf(Bp)!=-1)throw Bp?"Multiple appenders use the same name "+Bp:kp;ap._appenderNames.push(Bp)}return Lp.prototype.addLogItemsToBuffer=function(Bp){if(this.batchBuffer.length>=this.maxBatchSize){this.nbrLogItemsSkipped+=Bp.length;return}if(ap.maxMessages!=null){if(ap.maxMessages<1)return;ap.maxMessages-=Bp.length}this.batchBuffer=this.batchBuffer.concat(Bp);var Ip=this;Mp(this.batchTimeoutTimer,this.batchTimeout,function(){Ip.sendBatch.call(Ip)})},Lp.prototype.batchBufferHasOverdueMessages=function(){for(var Bp=0;Bp<this.batchBuffer.length;Bp++){var Ip=ap._getTime()-this.batchBuffer[Bp].t;if(Ip>this.batchTimeout)return!0}return!1},Lp.prototype.batchBufferHasStrandedMessage=function(){return ap.maxMessages!=null&&ap.maxMessages<1&&this.batchBuffer.length>0},Lp.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},Lp.prototype.onSendingEnded=function(){Tp(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},Lp.prototype.setOptions=function(Bp){if(sp("level",Bp,this),sp("ipRegex",Bp,this),sp("userAgentRegex",Bp,this),sp("disallow",Bp,this),sp("sendWithBufferLevel",Bp,this),sp("storeInBufferLevel",Bp,this),sp("bufferSize",Bp,this),sp("batchSize",Bp,this),sp("maxBatchSize",Bp,this),sp("batchTimeout",Bp,this),sp("sendTimeout",Bp,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new ap.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},Lp.prototype.log=function(Bp,Ip,kp,Up,Gp,Wp,Qp){var Xp;if(lp(this)&&up(this,Wp)&&!(Gp<this.storeInBufferLevel)){if(Xp=Rp(Gp,Wp,Qp),Gp<this.level){this.bufferSize>0&&(this.buffer.push(Xp),this.buffer.length>this.bufferSize&&this.buffer.shift());return}this.addLogItemsToBuffer([Xp]),Gp>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete()}},Lp.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(Tp(this.batchTimeoutTimer),this.batchBuffer.length!=0)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var Bp=this;Mp(this.sendTimeoutTimer,this.sendTimeout,function(){Bp.onSendingEnded.call(Bp)}),this.sendLogItems(this.batchBuffer,function(){Bp.batchBuffer.splice(0,Bp.nbrLogItemsBeingSent),Bp.nbrLogItemsSkipped>0&&(Bp.batchBuffer.push(Rp(xp(),"Lost "+Bp.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",Bp.appenderName)),Bp.nbrLogItemsSkipped=0),Bp.onSendingEnded.call(Bp)})}},Lp}();ap.Appender=Op;var Pp=function(Lp){_d(Bp,Lp);function Bp(Ip){return Lp.call(this,Ip,Bp.prototype.sendLogItemsAjax)||this}return Bp.prototype.setOptions=function(Ip){return sp("url",Ip,this),sp("beforeSend",Ip,this),Lp.prototype.setOptions.call(this,Ip),this},Bp.prototype.sendLogItemsAjax=function(Ip,kp){try{if(!lp(this))return;this.xhr&&this.xhr.readyState!=0&&this.xhr.readyState!=4&&this.xhr.abort(),this.xhr=ap._createXMLHttpRequest();var Up="/jsnlog.logger";ap.defaultAjaxUrl!=null&&(Up=ap.defaultAjaxUrl),this.url&&(Up=this.url),this.xhr.open("POST",Up),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",ap.requestId);var Gp=this;this.xhr.onreadystatechange=function(){Gp.xhr.readyState==4&&Gp.xhr.status>=200&&Gp.xhr.status<300&&kp()};var Wp={r:ap.requestId,lg:Ip};typeof this.beforeSend=="function"?this.beforeSend.call(this,this.xhr,Wp):typeof ap.defaultBeforeSend=="function"&&ap.defaultBeforeSend.call(this,this.xhr,Wp);var Qp=JSON.stringify(Wp);this.xhr.send(Qp)}catch{}},Bp}(Op);ap.AjaxAppender=Pp;var $p=function(Lp){_d(Bp,Lp);function Bp(Ip){return Lp.call(this,Ip,Bp.prototype.sendLogItemsConsole)||this}return Bp.prototype.clog=function(Ip){ap._console.log(Ip)},Bp.prototype.cerror=function(Ip){ap._console.error?ap._console.error(Ip):this.clog(Ip)},Bp.prototype.cwarn=function(Ip){ap._console.warn?ap._console.warn(Ip):this.clog(Ip)},Bp.prototype.cinfo=function(Ip){ap._console.info?ap._console.info(Ip):this.clog(Ip)},Bp.prototype.cdebug=function(Ip){ap._console.debug?ap._console.debug(Ip):this.cinfo(Ip)},Bp.prototype.sendLogItemsConsole=function(Ip,kp){try{if(!lp(this)||!ap._console)return;var Up;for(Up=0;Up<Ip.length;++Up){var Gp=Ip[Up],Wp=Gp.n+": "+Gp.m;typeof window>"u"&&(Wp=new Date(Gp.t)+" | "+Wp),Gp.l<=ap.getDebugLevel()?this.cdebug(Wp):Gp.l<=ap.getInfoLevel()?this.cinfo(Wp):Gp.l<=ap.getWarnLevel()?this.cwarn(Wp):this.cerror(Wp)}}catch{}kp()},Bp}(Op);ap.ConsoleAppender=$p;var zp=function(){function Lp(Bp){this.loggerName=Bp,this.seenRegexes=[]}return Lp.prototype.setOptions=function(Bp){return sp("level",Bp,this),sp("userAgentRegex",Bp,this),sp("disallow",Bp,this),sp("ipRegex",Bp,this),sp("appenders",Bp,this),sp("onceOnly",Bp,this),this.seenRegexes=[],this},Lp.prototype.buildExceptionObject=function(Bp){var Ip={};return Bp.stack?Ip.stack=Bp.stack:Ip.e=Bp,Bp.message&&(Ip.message=Bp.message),Bp.name&&(Ip.name=Bp.name),Bp.data&&(Ip.data=Bp.data),Bp.inner&&(Ip.inner=this.buildExceptionObject(Bp.inner)),Ip},Lp.prototype.log=function(Bp,Ip,kp){var Up=0,Gp,Wp;if(!this.appenders)return this;if(Bp>=this.level&&lp(this)&&(kp?(Wp=this.buildExceptionObject(kp),Wp.logData=cp(Ip)):Wp=Ip,Gp=hp(Wp),up(this,Gp.finalString))){if(this.onceOnly)for(Up=this.onceOnly.length-1;Up>=0;){if(new RegExp(this.onceOnly[Up]).test(Gp.finalString)){if(this.seenRegexes[Up])return this;this.seenRegexes[Up]=!0}Up--}for(Gp.meta=Gp.meta||{},Up=this.appenders.length-1;Up>=0;)this.appenders[Up].log(Ep(Bp),Gp.msg,Gp.meta,function(){},Bp,Gp.finalString,this.loggerName),Up--}return this},Lp.prototype.trace=function(Bp){return this.log(mp(),Bp)},Lp.prototype.debug=function(Bp){return this.log(gp(),Bp)},Lp.prototype.info=function(Bp){return this.log(yp(),Bp)},Lp.prototype.warn=function(Bp){return this.log(xp(),Bp)},Lp.prototype.error=function(Bp){return this.log(_p(),Bp)},Lp.prototype.fatal=function(Bp){return this.log(vp(),Bp)},Lp.prototype.fatalException=function(Bp,Ip){return this.log(vp(),Bp,Ip)},Lp}();ap.Logger=zp;function Dp(Lp){return new Pp(Lp)}ap.createAjaxAppender=Dp;function Fp(Lp){return new $p(Lp)}ap.createConsoleAppender=Fp;var jp;typeof window<"u"?jp=new Pp(""):jp=new $p(""),ap.__=new ap.Logger(""),ap.__.setOptions({level:ap.getDebugLevel(),appenders:[jp]})})(np||(np={})),rp.__esModule=!0,rp.JL=np,typeof __jsnlog_configure=="function"&&__jsnlog_configure(np),typeof window<"u"&&!window.onerror&&(window.onerror=function(ap,sp,lp,up,cp){return np("onerrorLogger").fatalException({msg:"Uncaught Exception",errorMsg:ap?ap.message||ap:"",url:sp,"line number":lp,column:up},cp),!1}),typeof window<"u"&&!window.onunhandledrejection&&(window.onunhandledrejection=function(ap){np("onerrorLogger").fatalException({msg:"unhandledrejection",errorMsg:ap.reason?ap.reason.message:ap.message||null},ap.reason)})})(jsnlog);var OpenVidu$1={},LocalRecorder$1={},LocalRecorderState={};(function(rp){Object.defineProperty(rp,"__esModule",{value:!0}),rp.LocalRecorderState=void 0,function(_d){_d.READY="READY",_d.RECORDING="RECORDING",_d.PAUSED="PAUSED",_d.FINISHED="FINISHED"}(rp.LocalRecorderState||(rp.LocalRecorderState={}))})(LocalRecorderState);var OpenViduLogger$1={},ConsoleLogger$1={};Object.defineProperty(ConsoleLogger$1,"__esModule",{value:!0});ConsoleLogger$1.ConsoleLogger=void 0;var ConsoleLogger=function(){function rp(_d){this.logger=_d,this.log=_d.log,this.info=_d.info,this.debug=_d.debug,this.warn=_d.warn,this.error=_d.error}return rp}();ConsoleLogger$1.ConsoleLogger=ConsoleLogger;var OpenViduLoggerConfiguration={};(function(rp){Object.defineProperty(rp,"__esModule",{value:!0}),rp.OpenViduLoggerConfiguration=void 0,function(_d){_d.disabled="disabled",_d.debug="debug",_d.debug_app="debug_app"}(rp.OpenViduLoggerConfiguration||(rp.OpenViduLoggerConfiguration={}))})(OpenViduLoggerConfiguration);Object.defineProperty(OpenViduLogger$1,"__esModule",{value:!0});OpenViduLogger$1.OpenViduLogger=void 0;var jsnlog_1=jsnlog,ConsoleLogger_1=ConsoleLogger$1,OpenViduLoggerConfiguration_1$1=OpenViduLoggerConfiguration,OpenViduLogger=function(){function rp(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new ConsoleLogger_1.ConsoleLogger(globalThis.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return rp.configureJSNLog=function(_d,np){var ap=this;try{if(globalThis.LOG_JSNLOG_RESULTS||this.instance&&_d.isAtLeastPro&&this.instance.isOpenViduBrowserLogsDebugActive(_d)&&this.instance.canConfigureJSNLog(_d,this.instance)){_d.sendBrowserLogs===OpenViduLoggerConfiguration_1$1.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var sp=_d.finalUserId,lp=_d.session.sessionId,up=function(dp){var hp=dp.onreadystatechange;dp.onreadystatechange=function(){ap.isInvalidResponse(dp)&&(Object.defineProperty(dp,"readyState",{value:4}),Object.defineProperty(dp,"status",{value:200}),ap.instance.disableLogger()),hp()},dp.setRequestHeader("Authorization","Basic "+btoa("".concat(sp,"%/%").concat(lp)+":"+np)),dp.setRequestHeader("X-Requested-With","XMLHttpRequest"),dp.setRequestHeader("OV-Final-User-Id",sp),dp.setRequestHeader("OV-Session-Id",lp),dp.setRequestHeader("OV-Token",np)};this.instance.currentAppender=jsnlog_1.JL.createAjaxAppender("appender-".concat(sp,"-").concat(lp)),this.instance.currentAppender.setOptions({beforeSend:up,maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES});var cp=function(dp){var hp=function(){var pp=new WeakSet;return function(mp,gp){if(typeof gp=="object"&&gp!=null){if(pp.has(gp)||globalThis.HTMLElement&&gp instanceof HTMLElement)return;pp.add(gp)}return gp}},fp=JSON.stringify(dp,hp());return fp.length>ap.instance.MAX_LENGTH_STRING_JSON&&(fp="".concat(fp.substring(0,ap.instance.MAX_LENGTH_STRING_JSON),"...")),globalThis.LOG_JSNLOG_RESULTS&&console.log(fp),fp};jsnlog_1.JL.setOptions({defaultAjaxUrl:_d.httpUri+this.instance.JSNLOG_URL,serialize:cp,enabled:!0}),(0,jsnlog_1.JL)().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=lp,this.instance.info("JSNLog configured.")}}catch(dp){console.error("Error configuring JSNLog: "),console.error(dp),this.instance.disableLogger()}},rp.getInstance=function(){return rp.instance||(rp.instance=new rp),rp.instance},rp.isInvalidResponse=function(_d){return _d.status==401||_d.status==403||_d.status==404||_d.status==0},rp.prototype.canConfigureJSNLog=function(_d,np){return _d.session.sessionId!=np.loggingSessionId},rp.prototype.isOpenViduBrowserLogsDebugActive=function(_d){return _d.sendBrowserLogs===OpenViduLoggerConfiguration_1$1.OpenViduLoggerConfiguration.debug||_d.sendBrowserLogs===OpenViduLoggerConfiguration_1$1.OpenViduLoggerConfiguration.debug_app},rp.prototype.getConsoleWithJSNLog=function(){return function(_d){return{log:function(){_d.defaultConsoleLogger.log.apply(_d.defaultConsoleLogger.logger,arguments),_d.isJSNLogSetup&&(0,jsnlog_1.JL)().info(arguments)},info:function(){_d.defaultConsoleLogger.info.apply(_d.defaultConsoleLogger.logger,arguments),_d.isJSNLogSetup&&(0,jsnlog_1.JL)().info(arguments)},debug:function(){_d.defaultConsoleLogger.debug.apply(_d.defaultConsoleLogger.logger,arguments)},warn:function(){_d.defaultConsoleLogger.warn.apply(_d.defaultConsoleLogger.logger,arguments),_d.isJSNLogSetup&&(0,jsnlog_1.JL)().warn(arguments)},error:function(){_d.defaultConsoleLogger.error.apply(_d.defaultConsoleLogger.logger,arguments),_d.isJSNLogSetup&&(0,jsnlog_1.JL)().error(arguments)}}}(this)},rp.prototype.replaceWindowConsole=function(){globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.getConsoleWithJSNLog().log,globalThis.console.info=this.getConsoleWithJSNLog().info,globalThis.console.debug=this.getConsoleWithJSNLog().debug,globalThis.console.warn=this.getConsoleWithJSNLog().warn,globalThis.console.error=this.getConsoleWithJSNLog().error},rp.prototype.disableLogger=function(){jsnlog_1.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.defaultConsoleLogger.log,globalThis.console.info=this.defaultConsoleLogger.info,globalThis.console.debug=this.defaultConsoleLogger.debug,globalThis.console.warn=this.defaultConsoleLogger.warn,globalThis.console.error=this.defaultConsoleLogger.error},rp.prototype.log=function(){this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,jsnlog_1.JL)().info(arguments)},rp.prototype.debug=function(){this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},rp.prototype.info=function(){this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,jsnlog_1.JL)().info(arguments)},rp.prototype.warn=function(){this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,jsnlog_1.JL)().warn(arguments)},rp.prototype.error=function(){this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,jsnlog_1.JL)().error(arguments)},rp.prototype.flush=function(){this.isJSNLogSetup&&this.currentAppender!=null&&this.currentAppender.sendBatch()},rp.prototype.enableProdMode=function(){this.isProdMode=!0},rp}();OpenViduLogger$1.OpenViduLogger=OpenViduLogger;var Platform={},platform$6={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */platform$6.exports;(function(rp,_d){(function(){var np={function:!0,object:!0},ap=np[typeof window]&&window||this,sp=_d,lp=rp&&!rp.nodeType&&rp,up=sp&&lp&&typeof commonjsGlobal=="object"&&commonjsGlobal;up&&(up.global===up||up.window===up||up.self===up)&&(ap=up);var cp=Math.pow(2,53)-1,dp=/\bOpera/,hp=Object.prototype,fp=hp.hasOwnProperty,pp=hp.toString;function mp(Mp){return Mp=String(Mp),Mp.charAt(0).toUpperCase()+Mp.slice(1)}function gp(Mp,Op,Pp){var $p={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Op&&Pp&&/^Win/i.test(Mp)&&!/^Windows Phone /i.test(Mp)&&($p=$p[/[\d.]+$/.exec(Mp)])&&(Mp="Windows "+$p),Mp=String(Mp),Op&&Pp&&(Mp=Mp.replace(RegExp(Op,"i"),Pp)),Mp=xp(Mp.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),Mp}function yp(Mp,Op){var Pp=-1,$p=Mp?Mp.length:0;if(typeof $p=="number"&&$p>-1&&$p<=cp)for(;++Pp<$p;)Op(Mp[Pp],Pp,Mp);else _p(Mp,Op)}function xp(Mp){return Mp=Ap(Mp),/^(?:webOS|i(?:OS|P))/.test(Mp)?Mp:mp(Mp)}function _p(Mp,Op){for(var Pp in Mp)fp.call(Mp,Pp)&&Op(Mp[Pp],Pp,Mp)}function vp(Mp){return Mp==null?mp(Mp):pp.call(Mp).slice(8,-1)}function bp(Mp,Op){var Pp=Mp!=null?typeof Mp[Op]:"number";return!/^(?:boolean|number|string|undefined)$/.test(Pp)&&(Pp=="object"?!!Mp[Op]:!0)}function Ep(Mp){return String(Mp).replace(/([ -])(?!$)/g,"$1?")}function Sp(Mp,Op){var Pp=null;return yp(Mp,function($p,zp){Pp=Op(Pp,$p,zp,Mp)}),Pp}function Ap(Mp){return String(Mp).replace(/^ +| +$/g,"")}function Rp(Mp){var Op=ap,Pp=Mp&&typeof Mp=="object"&&vp(Mp)!="String";Pp&&(Op=Mp,Mp=null);var $p=Op.navigator||{},zp=$p.userAgent||"";Mp||(Mp=zp);var Dp=Pp?!!$p.likeChrome:/\bChrome\b/.test(Mp)&&!/internal|\n/i.test(pp.toString()),Fp="Object",jp=Pp?Fp:"ScriptBridgingProxyObject",Lp=Pp?Fp:"Environment",Bp=Pp&&Op.java?"JavaPackage":vp(Op.java),Ip=Pp?Fp:"RuntimeObject",kp=/\bJava/.test(Bp)&&Op.java,Up=kp&&vp(Op.environment)==Lp,Gp=kp?"a":"",Wp=kp?"b":"",Qp=Op.document||{},Xp=Op.operamini||Op.opera,rm=dp.test(rm=Pp&&Xp?Xp["[[Class]]"]:vp(Xp))?rm:Xp=null,Kp,lm=Mp,cm=[],gm=null,Mm=Mp==zp,dm=Mm&&Xp&&typeof Xp.version=="function"&&Xp.version(),em,sm=zm([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Zp=Jp(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),mm=km([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),fm=tm({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),_m=pm(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function zm(Pm){return Sp(Pm,function(Im,Dm){return Im||RegExp("\\b"+(Dm.pattern||Ep(Dm))+"\\b","i").exec(Mp)&&(Dm.label||Dm)})}function tm(Pm){return Sp(Pm,function(Im,Dm,jm){return Im||(Dm[mm]||Dm[/^[a-z]+(?: +[a-z]+\b)*/i.exec(mm)]||RegExp("\\b"+Ep(jm)+"(?:\\b|\\w*\\d)","i").exec(Mp))&&jm})}function Jp(Pm){return Sp(Pm,function(Im,Dm){return Im||RegExp("\\b"+(Dm.pattern||Ep(Dm))+"\\b","i").exec(Mp)&&(Dm.label||Dm)})}function pm(Pm){return Sp(Pm,function(Im,Dm){var jm=Dm.pattern||Ep(Dm);return!Im&&(Im=RegExp("\\b"+jm+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Mp))&&(Im=gp(Im,jm,Dm.label||Dm)),Im})}function km(Pm){return Sp(Pm,function(Im,Dm){var jm=Dm.pattern||Ep(Dm);return!Im&&(Im=RegExp("\\b"+jm+" *\\d+[.\\w_]*","i").exec(Mp)||RegExp("\\b"+jm+" *\\w+-[\\w]*","i").exec(Mp)||RegExp("\\b"+jm+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Mp))&&((Im=String(Dm.label&&!RegExp(jm,"i").test(Dm.label)?Dm.label:Im).split("/"))[1]&&!/[\d.]+/.test(Im[0])&&(Im[0]+=" "+Im[1]),Dm=Dm.label||Dm,Im=xp(Im[0].replace(RegExp(jm,"i"),Dm).replace(RegExp("; *(?:"+Dm+"[_-])?","i")," ").replace(RegExp("("+Dm+")[-_.]?(\\w)","i"),"$1 $2"))),Im})}function ym(Pm){return Sp(Pm,function(Im,Dm){return Im||(RegExp(Dm+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Mp)||0)[1]||null})}function Em(){return this.description||""}if(sm&&(sm=[sm]),/\bAndroid\b/.test(_m)&&!mm&&(Kp=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(Mp))&&(mm=Ap(Kp[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),fm&&!mm?mm=km([fm]):fm&&mm&&(mm=mm.replace(RegExp("^("+Ep(fm)+")[-_.\\s]","i"),fm+" ").replace(RegExp("^("+Ep(fm)+")[-_.]?(\\w)","i"),fm+" $2")),(Kp=/\bGoogle TV\b/.exec(mm))&&(mm=Kp[0]),/\bSimulator\b/i.test(Mp)&&(mm=(mm?mm+" ":"")+"Simulator"),Zp=="Opera Mini"&&/\bOPiOS\b/.test(Mp)&&cm.push("running in Turbo/Uncompressed mode"),Zp=="IE"&&/\blike iPhone OS\b/.test(Mp)?(Kp=Rp(Mp.replace(/like iPhone OS/,"")),fm=Kp.manufacturer,mm=Kp.product):/^iP/.test(mm)?(Zp||(Zp="Safari"),_m="iOS"+((Kp=/ OS ([\d_]+)/i.exec(Mp))?" "+Kp[1].replace(/_/g,"."):"")):Zp=="Konqueror"&&/^Linux\b/i.test(_m)?_m="Kubuntu":fm&&fm!="Google"&&(/Chrome/.test(Zp)&&!/\bMobile Safari\b/i.test(Mp)||/\bVita\b/.test(mm))||/\bAndroid\b/.test(_m)&&/^Chrome/.test(Zp)&&/\bVersion\//i.test(Mp)?(Zp="Android Browser",_m=/\bAndroid\b/.test(_m)?_m:"Android"):Zp=="Silk"?(/\bMobi/i.test(Mp)||(_m="Android",cm.unshift("desktop mode")),/Accelerated *= *true/i.test(Mp)&&cm.unshift("accelerated")):Zp=="UC Browser"&&/\bUCWEB\b/.test(Mp)?cm.push("speed mode"):Zp=="PaleMoon"&&(Kp=/\bFirefox\/([\d.]+)\b/.exec(Mp))?cm.push("identifying as Firefox "+Kp[1]):Zp=="Firefox"&&(Kp=/\b(Mobile|Tablet|TV)\b/i.exec(Mp))?(_m||(_m="Firefox OS"),mm||(mm=Kp[1])):!Zp||(Kp=!/\bMinefield\b/i.test(Mp)&&/\b(?:Firefox|Safari)\b/.exec(Zp))?(Zp&&!mm&&/[\/,]|^[^(]+?\)/.test(Mp.slice(Mp.indexOf(Kp+"/")+8))&&(Zp=null),(Kp=mm||fm||_m)&&(mm||fm||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(_m))&&(Zp=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(_m)?_m:Kp)+" Browser")):Zp=="Electron"&&(Kp=(/\bChrome\/([\d.]+)\b/.exec(Mp)||0)[1])&&cm.push("Chromium "+Kp),dm||(dm=ym(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Ep(Zp),"(?:Firefox|Minefield|NetFront)"])),(Kp=sm=="iCab"&&parseFloat(dm)>3&&"WebKit"||/\bOpera\b/.test(Zp)&&(/\bOPR\b/.test(Mp)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(Mp)&&!/^(?:Trident|EdgeHTML)$/.test(sm)&&"WebKit"||!sm&&/\bMSIE\b/i.test(Mp)&&(_m=="Mac OS"?"Tasman":"Trident")||sm=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Zp)&&"NetFront")&&(sm=[Kp]),Zp=="IE"&&(Kp=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Mp)||0)[1])?(Zp+=" Mobile",_m="Windows Phone "+(/\+$/.test(Kp)?Kp:Kp+".x"),cm.unshift("desktop mode")):/\bWPDesktop\b/i.test(Mp)?(Zp="IE Mobile",_m="Windows Phone 8.x",cm.unshift("desktop mode"),dm||(dm=(/\brv:([\d.]+)/.exec(Mp)||0)[1])):Zp!="IE"&&sm=="Trident"&&(Kp=/\brv:([\d.]+)/.exec(Mp))&&(Zp&&cm.push("identifying as "+Zp+(dm?" "+dm:"")),Zp="IE",dm=Kp[1]),Mm){if(bp(Op,"global"))if(kp&&(Kp=kp.lang.System,lm=Kp.getProperty("os.arch"),_m=_m||Kp.getProperty("os.name")+" "+Kp.getProperty("os.version")),Up){try{dm=Op.require("ringo/engine").version.join("."),Zp="RingoJS"}catch{(Kp=Op.system)&&Kp.global.system==Op.system&&(Zp="Narwhal",_m||(_m=Kp[0].os||null))}Zp||(Zp="Rhino")}else typeof Op.process=="object"&&!Op.process.browser&&(Kp=Op.process)&&(typeof Kp.versions=="object"&&(typeof Kp.versions.electron=="string"?(cm.push("Node "+Kp.versions.node),Zp="Electron",dm=Kp.versions.electron):typeof Kp.versions.nw=="string"&&(cm.push("Chromium "+dm,"Node "+Kp.versions.node),Zp="NW.js",dm=Kp.versions.nw)),Zp||(Zp="Node.js",lm=Kp.arch,_m=Kp.platform,dm=/[\d.]+/.exec(Kp.version),dm=dm?dm[0]:null));else vp(Kp=Op.runtime)==jp?(Zp="Adobe AIR",_m=Kp.flash.system.Capabilities.os):vp(Kp=Op.phantom)==Ip?(Zp="PhantomJS",dm=(Kp=Kp.version||null)&&Kp.major+"."+Kp.minor+"."+Kp.patch):typeof Qp.documentMode=="number"&&(Kp=/\bTrident\/(\d+)/i.exec(Mp))?(dm=[dm,Qp.documentMode],(Kp=+Kp[1]+4)!=dm[1]&&(cm.push("IE "+dm[1]+" mode"),sm&&(sm[1]=""),dm[1]=Kp),dm=Zp=="IE"?String(dm[1].toFixed(1)):dm[0]):typeof Qp.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Zp)&&(cm.push("masking as "+Zp+" "+dm),Zp="IE",dm="11.0",sm=["Trident"],_m="Windows");_m=_m&&xp(_m)}if(dm&&(Kp=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(dm)||/(?:alpha|beta)(?: ?\d)?/i.exec(Mp+";"+(Mm&&$p.appMinorVersion))||/\bMinefield\b/i.test(Mp)&&"a")&&(gm=/b/i.test(Kp)?"beta":"alpha",dm=dm.replace(RegExp(Kp+"\\+?$"),"")+(gm=="beta"?Wp:Gp)+(/\d+\+?/.exec(Kp)||"")),Zp=="Fennec"||Zp=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(_m))Zp="Firefox Mobile";else if(Zp=="Maxthon"&&dm)dm=dm.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(mm))mm=="Xbox 360"&&(_m=null),mm=="Xbox 360"&&/\bIEMobile\b/.test(Mp)&&cm.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(Zp)||Zp&&!mm&&!/Browser|Mobi/.test(Zp))&&(_m=="Windows CE"||/Mobi/i.test(Mp)))Zp+=" Mobile";else if(Zp=="IE"&&Mm)try{Op.external===null&&cm.unshift("platform preview")}catch{cm.unshift("embedded")}else(/\bBlackBerry\b/.test(mm)||/\bBB10\b/.test(Mp))&&(Kp=(RegExp(mm.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Mp)||0)[1]||dm)?(Kp=[Kp,/BB10/.test(Mp)],_m=(Kp[1]?(mm=null,fm="BlackBerry"):"Device Software")+" "+Kp[0],dm=null):this!=_p&&mm!="Wii"&&(Mm&&Xp||/Opera/.test(Zp)&&/\b(?:MSIE|Firefox)\b/i.test(Mp)||Zp=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(_m)||Zp=="IE"&&(_m&&!/^Win/.test(_m)&&dm>5.5||/\bWindows XP\b/.test(_m)&&dm>8||dm==8&&!/\bTrident\b/.test(Mp)))&&!dp.test(Kp=Rp.call(_p,Mp.replace(dp,"")+";"))&&Kp.name&&(Kp="ing as "+Kp.name+((Kp=Kp.version)?" "+Kp:""),dp.test(Zp)?(/\bIE\b/.test(Kp)&&_m=="Mac OS"&&(_m=null),Kp="identify"+Kp):(Kp="mask"+Kp,rm?Zp=xp(rm.replace(/([a-z])([A-Z])/g,"$1 $2")):Zp="Opera",/\bIE\b/.test(Kp)&&(_m=null),Mm||(dm=null)),sm=["Presto"],cm.push(Kp));(Kp=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Mp)||0)[1])&&(Kp=[parseFloat(Kp.replace(/\.(\d)$/,".0$1")),Kp],Zp=="Safari"&&Kp[1].slice(-1)=="+"?(Zp="WebKit Nightly",gm="alpha",dm=Kp[1].slice(0,-1)):(dm==Kp[1]||dm==(Kp[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Mp)||0)[1]))&&(dm=null),Kp[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Mp)||0)[1],Kp[0]==537.36&&Kp[2]==537.36&&parseFloat(Kp[1])>=28&&sm=="WebKit"&&(sm=["Blink"]),!Mm||!Dp&&!Kp[1]?(sm&&(sm[1]="like Safari"),Kp=(Kp=Kp[0],Kp<400?1:Kp<500?2:Kp<526?3:Kp<533?4:Kp<534?"4+":Kp<535?5:Kp<537?6:Kp<538?7:Kp<601?8:Kp<602?9:Kp<604?10:Kp<606?11:Kp<608?12:"12")):(sm&&(sm[1]="like Chrome"),Kp=Kp[1]||(Kp=Kp[0],Kp<530?1:Kp<532?2:Kp<532.05?3:Kp<533?4:Kp<534.03?5:Kp<534.07?6:Kp<534.1?7:Kp<534.13?8:Kp<534.16?9:Kp<534.24?10:Kp<534.3?11:Kp<535.01?12:Kp<535.02?"13+":Kp<535.07?15:Kp<535.11?16:Kp<535.19?17:Kp<536.05?18:Kp<536.1?19:Kp<537.01?20:Kp<537.11?"21+":Kp<537.13?23:Kp<537.18?24:Kp<537.24?25:Kp<537.36?26:sm!="Blink"?"27":"28")),sm&&(sm[1]+=" "+(Kp+=typeof Kp=="number"?".x":/[.+]/.test(Kp)?"":"+")),Zp=="Safari"&&(!dm||parseInt(dm)>45)?dm=Kp:Zp=="Chrome"&&/\bHeadlessChrome/i.test(Mp)&&cm.unshift("headless")),Zp=="Opera"&&(Kp=/\bzbov|zvav$/.exec(_m))?(Zp+=" ",cm.unshift("desktop mode"),Kp=="zvav"?(Zp+="Mini",dm=null):Zp+="Mobile",_m=_m.replace(RegExp(" *"+Kp+"$"),"")):Zp=="Safari"&&/\bChrome\b/.exec(sm&&sm[1])?(cm.unshift("desktop mode"),Zp="Chrome Mobile",dm=null,/\bOS X\b/.test(_m)?(fm="Apple",_m="iOS 4.3+"):_m=null):/\bSRWare Iron\b/.test(Zp)&&!dm&&(dm=ym("Chrome")),dm&&dm.indexOf(Kp=/[\d.]+$/.exec(_m))==0&&Mp.indexOf("/"+Kp+"-")>-1&&(_m=Ap(_m.replace(Kp,""))),_m&&_m.indexOf(Zp)!=-1&&!RegExp(Zp+" OS").test(_m)&&(_m=_m.replace(RegExp(" *"+Ep(Zp)+" *"),"")),sm&&!/\b(?:Avant|Nook)\b/.test(Zp)&&(/Browser|Lunascape|Maxthon/.test(Zp)||Zp!="Safari"&&/^iOS/.test(_m)&&/\bSafari\b/.test(sm[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Zp)&&sm[1])&&(Kp=sm[sm.length-1])&&cm.push(Kp),cm.length&&(cm=["("+cm.join("; ")+")"]),fm&&mm&&mm.indexOf(fm)<0&&cm.push("on "+fm),mm&&cm.push((/^on /.test(cm[cm.length-1])?"":"on ")+mm),_m&&(Kp=/ ([\d.+]+)$/.exec(_m),em=Kp&&_m.charAt(_m.length-Kp[0].length-1)=="/",_m={architecture:32,family:Kp&&!em?_m.replace(Kp[0],""):_m,version:Kp?Kp[1]:null,toString:function(){var Pm=this.version;return this.family+(Pm&&!em?" "+Pm:"")+(this.architecture==64?" 64-bit":"")}}),(Kp=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(lm))&&!/\bi686\b/i.test(lm)?(_m&&(_m.architecture=64,_m.family=_m.family.replace(RegExp(" *"+Kp),"")),Zp&&(/\bWOW64\b/i.test(Mp)||Mm&&/\w(?:86|32)$/.test($p.cpuClass||$p.platform)&&!/\bWin64; x64\b/i.test(Mp))&&cm.unshift("32-bit")):_m&&/^OS X/.test(_m.family)&&Zp=="Chrome"&&parseFloat(dm)>=39&&(_m.architecture=64),Mp||(Mp=null);var Bm={};return Bm.description=Mp,Bm.layout=sm&&sm[0],Bm.manufacturer=fm,Bm.name=Zp,Bm.prerelease=gm,Bm.product=mm,Bm.ua=Mp,Bm.version=Zp&&dm,Bm.os=_m||{architecture:null,family:null,version:null,toString:function(){return"null"}},Bm.parse=Rp,Bm.toString=Em,Bm.version&&cm.unshift(dm),Bm.name&&cm.unshift(Zp),_m&&Zp&&!(_m==String(_m).split(" ")[0]&&(_m==Zp.split(" ")[0]||mm))&&cm.push(mm?"("+_m+")":"on "+_m),cm.length&&(Bm.description=cm.join(" ")),Bm}var Tp=Rp();sp&&lp?_p(Tp,function(Mp,Op){sp[Op]=Mp}):ap.platform=Tp}).call(commonjsGlobal)})(platform$6,platform$6.exports);var platformExports=platform$6.exports;Object.defineProperty(Platform,"__esModule",{value:!0});Platform.PlatformUtils=void 0;var platform$5=platformExports,PlatformUtils=function(){function rp(){}return rp.getInstance=function(){return this.instance||(this.instance=new rp),rp.instance},rp.prototype.isChromeBrowser=function(){return platform$5.name==="Chrome"},rp.prototype.isSafariBrowser=function(){return platform$5.name==="Safari"},rp.prototype.isChromeMobileBrowser=function(){return platform$5.name==="Chrome Mobile"},rp.prototype.isFirefoxBrowser=function(){return platform$5.name==="Firefox"},rp.prototype.isFirefoxMobileBrowser=function(){return platform$5.name==="Firefox Mobile"||platform$5.name==="Firefox for iOS"},rp.prototype.isOperaBrowser=function(){return platform$5.name==="Opera"},rp.prototype.isOperaMobileBrowser=function(){return platform$5.name==="Opera Mobile"},rp.prototype.isEdgeBrowser=function(){var _d=platform$5!=null&&platform$5.version?parseFloat(platform$5.version):-1;return platform$5.name==="Microsoft Edge"&&_d>=80},rp.prototype.isEdgeMobileBrowser=function(){var _d,np,ap=platform$5!=null&&platform$5.version?parseFloat(platform$5.version):-1;return platform$5.name==="Microsoft Edge"&&(((_d=platform$5.os)===null||_d===void 0?void 0:_d.family)==="Android"||((np=platform$5.os)===null||np===void 0?void 0:np.family)==="iOS")&&ap>45},rp.prototype.isAndroidBrowser=function(){return platform$5.name==="Android Browser"},rp.prototype.isElectron=function(){return platform$5.name==="Electron"},rp.prototype.isNodeJs=function(){return platform$5.name==="Node.js"},rp.prototype.isSamsungBrowser=function(){return platform$5.name==="Samsung Internet Mobile"||platform$5.name==="Samsung Internet"},rp.prototype.isMotorolaEdgeDevice=function(){var _d;return((_d=platform$5.product)===null||_d===void 0?void 0:_d.toLowerCase().includes("motorola edge"))||!1},rp.prototype.isIPhoneOrIPad=function(){var _d=platform$5.ua?platform$5.ua:navigator.userAgent,np="ontouchend"in document,ap=/\b(\w*Macintosh\w*)\b/.test(_d)&&np,sp=/\b(\w*iPhone\w*)\b/.test(_d)&&/\b(\w*Mobile\w*)\b/.test(_d)&&np;return ap||sp},rp.prototype.isIOSWithSafari=function(){var _d=platform$5.ua?platform$5.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(_d)&&!/\b(\w*CriOS\w*)\b/.test(_d)&&!/\b(\w*FxiOS\w*)\b/.test(_d)},rp.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&platform$5.ua.indexOf("Safari")===-1},rp.prototype.isIonicAndroid=function(){return platform$5.os.family==="Android"&&platform$5.name=="Android Browser"},rp.prototype.isMobileDevice=function(){return platform$5.os.family==="iOS"||platform$5.os.family==="Android"},rp.prototype.isReactNative=function(){return!1},rp.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()||this.isMotorolaEdgeDevice()},rp.prototype.canScreenShare=function(){var _d=platform$5!=null&&platform$5.version?parseFloat(platform$5.version):-1;return this.isMobileDevice()?!1:this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&_d>=13},rp.prototype.getName=function(){return platform$5.name||""},rp.prototype.getVersion=function(){return platform$5.version||""},rp.prototype.getFamily=function(){return platform$5.os.family||""},rp.prototype.getDescription=function(){return platform$5.description||""},rp}();Platform.PlatformUtils=PlatformUtils;function Mime$2(){this._types=Object.create(null),this._extensions=Object.create(null);for(let rp=0;rp<arguments.length;rp++)this.define(arguments[rp]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Mime$2.prototype.define=function(rp,_d){for(let np in rp){let ap=rp[np].map(function(sp){return sp.toLowerCase()});np=np.toLowerCase();for(let sp=0;sp<ap.length;sp++){const lp=ap[sp];if(lp[0]!=="*"){if(!_d&&lp in this._types)throw new Error('Attempt to change mapping for "'+lp+'" extension from "'+this._types[lp]+'" to "'+np+'". Pass `force=true` to allow this, otherwise remove "'+lp+'" from the list of extensions for "'+np+'".');this._types[lp]=np}}if(_d||!this._extensions[np]){const sp=ap[0];this._extensions[np]=sp[0]!=="*"?sp:sp.substr(1)}}};Mime$2.prototype.getType=function(rp){rp=String(rp);let _d=rp.replace(/^.*[/\\]/,"").toLowerCase(),np=_d.replace(/^.*\./,"").toLowerCase(),ap=_d.length<rp.length;return(np.length<_d.length-1||!ap)&&this._types[np]||null};Mime$2.prototype.getExtension=function(rp){return rp=/^\s*([^;\s]*)/.test(rp)&&RegExp.$1,rp&&this._extensions[rp.toLowerCase()]||null};var Mime_1=Mime$2,standard={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};let Mime$1=Mime_1;var lite=new Mime$1(standard);Object.defineProperty(LocalRecorder$1,"__esModule",{value:!0});LocalRecorder$1.LocalRecorder=void 0;var LocalRecorderState_1=LocalRecorderState,OpenViduLogger_1$a=OpenViduLogger$1,Platform_1$5=Platform,Mime=lite,logger$a=OpenViduLogger_1$a.OpenViduLogger.getInstance(),platform$4,LocalRecorder=function(){function rp(_d){this.stream=_d,this.chunks=[],platform$4=Platform_1$5.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=LocalRecorderState_1.LocalRecorderState.READY}return rp.prototype.record=function(_d){var np=this;return new Promise(function(ap,sp){try{if(typeof _d=="string"||_d instanceof String)return sp(`When calling LocalRecorder.record(options) parameter 'options' cannot be a string. Must be an object like { mimeType: "`.concat(_d,'" }'));if(typeof MediaRecorder>"u")throw logger$a.error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder");if(np.state!==LocalRecorderState_1.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+np.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");logger$a.log("Starting local recording of stream '"+np.stream.streamId+"' of connection '"+np.connectionId+"'"),_d?_d.mimeType||(_d.mimeType="video/webm"):_d={mimeType:"video/webm"},np.mediaRecorder=new MediaRecorder(np.stream.getMediaStream(),_d),np.mediaRecorder.start()}catch(lp){return sp(lp)}return np.mediaRecorder.ondataavailable=function(lp){lp.data.size>0&&np.chunks.push(lp.data)},np.mediaRecorder.onerror=function(lp){logger$a.error("MediaRecorder error: ",lp)},np.mediaRecorder.onstart=function(){logger$a.log("MediaRecorder started (state="+np.mediaRecorder.state+")")},np.mediaRecorder.onstop=function(){np.onStopDefault()},np.mediaRecorder.onpause=function(){logger$a.log("MediaRecorder paused (state="+np.mediaRecorder.state+")")},np.mediaRecorder.onresume=function(){logger$a.log("MediaRecorder resumed (state="+np.mediaRecorder.state+")")},np.state=LocalRecorderState_1.LocalRecorderState.RECORDING,ap()})},rp.prototype.stop=function(){var _d=this;return new Promise(function(np,ap){try{if(_d.state===LocalRecorderState_1.LocalRecorderState.READY||_d.state===LocalRecorderState_1.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+_d.state+"'). Call 'LocalRecorder.start()' before");_d.mediaRecorder.onstop=function(){return _d.onStopDefault(),np()},_d.mediaRecorder.stop()}catch(sp){return ap(sp)}})},rp.prototype.pause=function(){var _d=this;return new Promise(function(np,ap){try{return _d.state!==LocalRecorderState_1.LocalRecorderState.RECORDING?ap(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+_d.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before")):(_d.mediaRecorder.pause(),_d.state=LocalRecorderState_1.LocalRecorderState.PAUSED,np())}catch(sp){return ap(sp)}})},rp.prototype.resume=function(){var _d=this;return new Promise(function(np,ap){try{if(_d.state!==LocalRecorderState_1.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+_d.state+"'). Call 'LocalRecorder.pause()' before");return _d.mediaRecorder.resume(),_d.state=LocalRecorderState_1.LocalRecorderState.RECORDING,np()}catch(sp){return ap(sp)}})},rp.prototype.preview=function(_d){if(this.state!==LocalRecorderState_1.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,platform$4.isSafariBrowser()&&(this.videoPreview.playsInline=!0),typeof _d=="string"){var np=document.getElementById(_d);np&&(this.videoPreview=np.appendChild(this.videoPreview))}else this.videoPreview=_d.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},rp.prototype.clean=function(){var _d=this,np=function(){delete _d.blob,_d.chunks=[],_d.state=LocalRecorderState_1.LocalRecorderState.READY};this.state===LocalRecorderState_1.LocalRecorderState.RECORDING||this.state===LocalRecorderState_1.LocalRecorderState.PAUSED?this.stop().then(function(){return np()}).catch(function(){return np()}):np()},rp.prototype.download=function(){if(this.state!==LocalRecorderState_1.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var _d=document.createElement("a");_d.style.display="none",document.body.appendChild(_d);var np=globalThis.URL.createObjectURL(this.blob);_d.href=np,_d.download=this.id+"."+Mime.getExtension(this.blob.type),_d.click(),globalThis.URL.revokeObjectURL(np),document.body.removeChild(_d)},rp.prototype.getBlob=function(){if(this.state!==LocalRecorderState_1.LocalRecorderState.FINISHED)throw Error("Call 'LocalRecord.stop()' before getting Blob file");return this.blob},rp.prototype.uploadAsBinary=function(_d,np){var ap=this;return new Promise(function(sp,lp){if(ap.state!==LocalRecorderState_1.LocalRecorderState.FINISHED)return lp(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+ap.state+"'). Call 'LocalRecorder.stop()' before"));var up=new XMLHttpRequest;if(up.open("POST",_d,!0),typeof np=="object")for(var cp=0,dp=Object.keys(np);cp<dp.length;cp++){var hp=dp[cp];up.setRequestHeader(hp,np[hp])}up.onreadystatechange=function(){if(up.readyState===4)return up.status.toString().charAt(0)==="2"?sp(up.responseText):lp(up.status)},up.send(ap.blob)})},rp.prototype.uploadAsMultipartfile=function(_d,np){var ap=this;return new Promise(function(sp,lp){if(ap.state!==LocalRecorderState_1.LocalRecorderState.FINISHED)return lp(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+ap.state+"'). Call 'LocalRecorder.stop()' before"));var up=new XMLHttpRequest;if(up.open("POST",_d,!0),typeof np=="object")for(var cp=0,dp=Object.keys(np);cp<dp.length;cp++){var hp=dp[cp];up.setRequestHeader(hp,np[hp])}var fp=new FormData;fp.append("file",ap.blob,ap.id+"."+Mime.getExtension(ap.blob.type)),up.onreadystatechange=function(){if(up.readyState===4)return up.status.toString().charAt(0)==="2"?sp(up.responseText):lp(up.status)},up.send(fp)})},rp.prototype.onStopDefault=function(){logger$a.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:this.mediaRecorder.mimeType}),this.chunks=[],this.videoPreviewSrc=globalThis.URL.createObjectURL(this.blob),this.state=LocalRecorderState_1.LocalRecorderState.FINISHED},rp}();LocalRecorder$1.LocalRecorder=LocalRecorder;var Publisher={},Session={},Connection$1={},Stream$1={},Filter$1={},StreamPropertyChangedEvent$1={},Event$2={};Object.defineProperty(Event$2,"__esModule",{value:!0});Event$2.Event=void 0;var Event$1=function(){function rp(_d,np,ap){this.hasBeenPrevented=!1,this.cancelable=_d,this.target=np,this.type=ap}return rp.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},rp.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},rp}();Event$2.Event=Event$1;var __extends$e=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(StreamPropertyChangedEvent$1,"__esModule",{value:!0});StreamPropertyChangedEvent$1.StreamPropertyChangedEvent=void 0;var Event_1$b=Event$2,StreamPropertyChangedEvent=function(rp){__extends$e(_d,rp);function _d(np,ap,sp,lp,up,cp){var dp=rp.call(this,!1,np,"streamPropertyChanged")||this;return dp.stream=ap,dp.changedProperty=sp,dp.newValue=lp,dp.oldValue=up,dp.reason=cp,dp}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$b.Event);StreamPropertyChangedEvent$1.StreamPropertyChangedEvent=StreamPropertyChangedEvent;var OpenViduError={};(function(rp){Object.defineProperty(rp,"__esModule",{value:!0}),rp.OpenViduError=rp.OpenViduErrorName=void 0,function(np){np.BROWSER_NOT_SUPPORTED="BROWSER_NOT_SUPPORTED",np.DEVICE_ACCESS_DENIED="DEVICE_ACCESS_DENIED",np.DEVICE_ALREADY_IN_USE="DEVICE_ALREADY_IN_USE",np.SCREEN_CAPTURE_DENIED="SCREEN_CAPTURE_DENIED",np.SCREEN_SHARING_NOT_SUPPORTED="SCREEN_SHARING_NOT_SUPPORTED",np.SCREEN_EXTENSION_NOT_INSTALLED="SCREEN_EXTENSION_NOT_INSTALLED",np.SCREEN_EXTENSION_DISABLED="SCREEN_EXTENSION_DISABLED",np.INPUT_VIDEO_DEVICE_NOT_FOUND="INPUT_VIDEO_DEVICE_NOT_FOUND",np.INPUT_AUDIO_DEVICE_NOT_FOUND="INPUT_AUDIO_DEVICE_NOT_FOUND",np.INPUT_AUDIO_DEVICE_GENERIC_ERROR="INPUT_AUDIO_DEVICE_GENERIC_ERROR",np.NO_INPUT_SOURCE_SET="NO_INPUT_SOURCE_SET",np.PUBLISHER_PROPERTIES_ERROR="PUBLISHER_PROPERTIES_ERROR",np.OPENVIDU_PERMISSION_DENIED="OPENVIDU_PERMISSION_DENIED",np.OPENVIDU_NOT_CONNECTED="OPENVIDU_NOT_CONNECTED",np.VIRTUAL_BACKGROUND_ERROR="VIRTUAL_BACKGROUND_ERROR",np.GENERIC_ERROR="GENERIC_ERROR"}(rp.OpenViduErrorName||(rp.OpenViduErrorName={}));var _d=function(){function np(ap,sp){this.name=ap,this.message=sp}return np}();rp.OpenViduError=_d})(OpenViduError);Object.defineProperty(Filter$1,"__esModule",{value:!0});Filter$1.Filter=void 0;var StreamPropertyChangedEvent_1$2=StreamPropertyChangedEvent$1,OpenViduError_1$2=OpenViduError,OpenViduLogger_1$9=OpenViduLogger$1,logger$9=OpenViduLogger_1$9.OpenViduLogger.getInstance(),Filter=function(){function rp(_d,np){this.handlers=new Map,this.type=_d,this.options=np}return rp.prototype.execMethod=function(_d,np){var ap=this;return new Promise(function(sp,lp){var up;logger$9.info("Executing filter method to stream "+ap.stream.streamId);var cp,dp=function(pp){logger$9.info("Filter method successfully executed on Stream "+ap.stream.streamId);var mp=Object.assign({},ap.stream.filter);return ap.stream.filter.lastExecMethod={method:_d,params:cp},pp&&(ap.stream.session.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1$2.StreamPropertyChangedEvent(ap.stream.session,ap.stream,"filter",ap.stream.filter,mp,"execFilterMethod")]),ap.stream.streamManager.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1$2.StreamPropertyChangedEvent(ap.stream.streamManager,ap.stream,"filter",ap.stream.filter,mp,"execFilterMethod")])),sp()};if(ap.type.startsWith("VB:")){if(typeof np=="string")try{np=JSON.parse(np)}catch(pp){return lp(new OpenViduError_1$2.OpenViduError(OpenViduError_1$2.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Wrong params syntax: "+pp))}if(cp=np,_d==="update")if(!((up=ap.stream.virtualBackgroundSinkElements)===null||up===void 0)&&up.VB)ap.stream.virtualBackgroundSinkElements.VB.updateValues(np).then(function(){return dp(!1)}).catch(function(pp){return pp.name===OpenViduError_1$2.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?lp(new OpenViduError_1$2.OpenViduError(pp.name,pp.message)):lp(new OpenViduError_1$2.OpenViduError(OpenViduError_1$2.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Error updating values on Virtual Background filter: "+pp))});else return lp(new OpenViduError_1$2.OpenViduError(OpenViduError_1$2.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"There is no Virtual Background filter applied"));else return lp(new OpenViduError_1$2.OpenViduError(OpenViduError_1$2.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Unknown Virtual Background method "'.concat(_d,'"')))}else{var hp=void 0;if(typeof np!="string")try{hp=JSON.stringify(np)}catch{var fp="'params' property must be a JSON formatted object";return logger$9.error(fp),lp(fp)}else hp=np;cp=hp,ap.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:ap.stream.streamId,method:_d,params:hp},function(pp,mp){return pp?(logger$9.error("Error executing filter method for Stream "+ap.stream.streamId,pp),pp.code===401?lp(new OpenViduError_1$2.OpenViduError(OpenViduError_1$2.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):lp(pp)):dp(!0)})}})},rp.prototype.addEventListener=function(_d,np){var ap=this;return new Promise(function(sp,lp){logger$9.info("Adding filter event listener to event "+_d+" to stream "+ap.stream.streamId),ap.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:ap.stream.streamId,eventType:_d},function(up,cp){return up?(logger$9.error("Error adding filter event listener to event "+_d+"for Stream "+ap.stream.streamId,up),up.code===401?lp(new OpenViduError_1$2.OpenViduError(OpenViduError_1$2.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):lp(up)):(ap.handlers.set(_d,np),logger$9.info("Filter event listener to event "+_d+" successfully applied on Stream "+ap.stream.streamId),sp())})})},rp.prototype.removeEventListener=function(_d){var np=this;return new Promise(function(ap,sp){logger$9.info("Removing filter event listener to event "+_d+" to stream "+np.stream.streamId),np.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:np.stream.streamId,eventType:_d},function(lp,up){return lp?(logger$9.error("Error removing filter event listener to event "+_d+"for Stream "+np.stream.streamId,lp),lp.code===401?sp(new OpenViduError_1$2.OpenViduError(OpenViduError_1$2.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):sp(lp)):(np.handlers.delete(_d),logger$9.info("Filter event listener to event "+_d+" successfully removed on Stream "+np.stream.streamId),ap())})})},rp}();Filter$1.Filter=Filter;var Subscriber$1={},StreamManager$1={},EventDispatcher$2={},EventEmitter$4={exports:{}};/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(rp){(function(_d){function np(){}var ap=np.prototype,sp=_d.EventEmitter;function lp(dp,hp){for(var fp=dp.length;fp--;)if(dp[fp].listener===hp)return fp;return-1}function up(dp){return function(){return this[dp].apply(this,arguments)}}ap.getListeners=function(hp){var fp=this._getEvents(),pp,mp;if(hp instanceof RegExp){pp={};for(mp in fp)fp.hasOwnProperty(mp)&&hp.test(mp)&&(pp[mp]=fp[mp])}else pp=fp[hp]||(fp[hp]=[]);return pp},ap.flattenListeners=function(hp){var fp=[],pp;for(pp=0;pp<hp.length;pp+=1)fp.push(hp[pp].listener);return fp},ap.getListenersAsObject=function(hp){var fp=this.getListeners(hp),pp;return fp instanceof Array&&(pp={},pp[hp]=fp),pp||fp};function cp(dp){return typeof dp=="function"||dp instanceof RegExp?!0:dp&&typeof dp=="object"?cp(dp.listener):!1}ap.addListener=function(hp,fp){if(!cp(fp))throw new TypeError("listener must be a function");var pp=this.getListenersAsObject(hp),mp=typeof fp=="object",gp;for(gp in pp)pp.hasOwnProperty(gp)&&lp(pp[gp],fp)===-1&&pp[gp].push(mp?fp:{listener:fp,once:!1});return this},ap.on=up("addListener"),ap.addOnceListener=function(hp,fp){return this.addListener(hp,{listener:fp,once:!0})},ap.once=up("addOnceListener"),ap.defineEvent=function(hp){return this.getListeners(hp),this},ap.defineEvents=function(hp){for(var fp=0;fp<hp.length;fp+=1)this.defineEvent(hp[fp]);return this},ap.removeListener=function(hp,fp){var pp=this.getListenersAsObject(hp),mp,gp;for(gp in pp)pp.hasOwnProperty(gp)&&(mp=lp(pp[gp],fp),mp!==-1&&pp[gp].splice(mp,1));return this},ap.off=up("removeListener"),ap.addListeners=function(hp,fp){return this.manipulateListeners(!1,hp,fp)},ap.removeListeners=function(hp,fp){return this.manipulateListeners(!0,hp,fp)},ap.manipulateListeners=function(hp,fp,pp){var mp,gp,yp=hp?this.removeListener:this.addListener,xp=hp?this.removeListeners:this.addListeners;if(typeof fp=="object"&&!(fp instanceof RegExp))for(mp in fp)fp.hasOwnProperty(mp)&&(gp=fp[mp])&&(typeof gp=="function"?yp.call(this,mp,gp):xp.call(this,mp,gp));else for(mp=pp.length;mp--;)yp.call(this,fp,pp[mp]);return this},ap.removeEvent=function(hp){var fp=typeof hp,pp=this._getEvents(),mp;if(fp==="string")delete pp[hp];else if(hp instanceof RegExp)for(mp in pp)pp.hasOwnProperty(mp)&&hp.test(mp)&&delete pp[mp];else delete this._events;return this},ap.removeAllListeners=up("removeEvent"),ap.emitEvent=function(hp,fp){var pp=this.getListenersAsObject(hp),mp,gp,yp,xp,_p;for(xp in pp)if(pp.hasOwnProperty(xp))for(mp=pp[xp].slice(0),yp=0;yp<mp.length;yp++)gp=mp[yp],gp.once===!0&&this.removeListener(hp,gp.listener),_p=gp.listener.apply(this,fp||[]),_p===this._getOnceReturnValue()&&this.removeListener(hp,gp.listener);return this},ap.trigger=up("emitEvent"),ap.emit=function(hp){var fp=Array.prototype.slice.call(arguments,1);return this.emitEvent(hp,fp)},ap.setOnceReturnValue=function(hp){return this._onceReturnValue=hp,this},ap._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},ap._getEvents=function(){return this._events||(this._events={})},np.noConflict=function(){return _d.EventEmitter=sp,np},rp.exports?rp.exports=np:_d.EventEmitter=np})(typeof window<"u"?window:commonjsGlobal||{})})(EventEmitter$4);var EventEmitterExports=EventEmitter$4.exports;Object.defineProperty(EventDispatcher$2,"__esModule",{value:!0});EventDispatcher$2.EventDispatcher=void 0;var OpenViduLogger_1$8=OpenViduLogger$1,EventEmitter$3=EventEmitterExports,logger$8=OpenViduLogger_1$8.OpenViduLogger.getInstance(),EventDispatcher$1=function(){function rp(){this.userHandlerArrowHandler=new WeakMap,this.ee=new EventEmitter$3}return rp.prototype.onAux=function(_d,np,ap){var sp=function(lp){lp?logger$8.debug(np,lp):logger$8.debug(np),ap(lp)};return this.userHandlerArrowHandler.set(ap,sp),this.ee.on(_d,sp),this},rp.prototype.onceAux=function(_d,np,ap){var sp=this,lp=function(up){up?logger$8.debug(np,up):logger$8.debug(np),ap(up),sp.userHandlerArrowHandler.delete(ap)};return this.userHandlerArrowHandler.set(ap,lp),this.ee.once(_d,lp),this},rp.prototype.offAux=function(_d,np){if(!np)this.ee.removeAllListeners(_d);else{var ap=this.userHandlerArrowHandler.get(np);ap&&this.ee.off(_d,ap),this.userHandlerArrowHandler.delete(np)}return this},rp}();EventDispatcher$2.EventDispatcher=EventDispatcher$1;var StreamManagerEvent$1={},__extends$d=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(StreamManagerEvent$1,"__esModule",{value:!0});StreamManagerEvent$1.StreamManagerEvent=void 0;var Event_1$a=Event$2,StreamManagerEvent=function(rp){__extends$d(_d,rp);function _d(np,ap,sp){var lp=rp.call(this,!1,np,ap)||this;return lp.value=sp,lp}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$a.Event);StreamManagerEvent$1.StreamManagerEvent=StreamManagerEvent;var VideoElementEvent$1={},__extends$c=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(VideoElementEvent$1,"__esModule",{value:!0});VideoElementEvent$1.VideoElementEvent=void 0;var Event_1$9=Event$2,VideoElementEvent=function(rp){__extends$c(_d,rp);function _d(np,ap,sp){var lp=rp.call(this,!1,ap,sp)||this;return lp.element=np,lp}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$9.Event);VideoElementEvent$1.VideoElementEvent=VideoElementEvent;var ExceptionEvent={};(function(rp){var _d=commonjsGlobal&&commonjsGlobal.__extends||function(){var sp=function(lp,up){return sp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(cp,dp){cp.__proto__=dp}||function(cp,dp){for(var hp in dp)Object.prototype.hasOwnProperty.call(dp,hp)&&(cp[hp]=dp[hp])},sp(lp,up)};return function(lp,up){if(typeof up!="function"&&up!==null)throw new TypeError("Class extends value "+String(up)+" is not a constructor or null");sp(lp,up);function cp(){this.constructor=lp}lp.prototype=up===null?Object.create(up):(cp.prototype=up.prototype,new cp)}}();Object.defineProperty(rp,"__esModule",{value:!0}),rp.ExceptionEvent=rp.ExceptionEventName=void 0;var np=Event$2;(function(sp){sp.ICE_CANDIDATE_ERROR="ICE_CANDIDATE_ERROR",sp.ICE_CONNECTION_FAILED="ICE_CONNECTION_FAILED",sp.ICE_CONNECTION_DISCONNECTED="ICE_CONNECTION_DISCONNECTED",sp.NO_STREAM_PLAYING_EVENT="NO_STREAM_PLAYING_EVENT",sp.SPEECH_TO_TEXT_DISCONNECTED="SPEECH_TO_TEXT_DISCONNECTED"})(rp.ExceptionEventName||(rp.ExceptionEventName={}));var ap=function(sp){_d(lp,sp);function lp(up,cp,dp,hp,fp){var pp=sp.call(this,!1,up,"exception")||this;return pp.name=cp,pp.origin=dp,pp.message=hp,pp.data=fp,pp}return lp.prototype.callDefaultBehavior=function(){},lp}(np.Event);rp.ExceptionEvent=ap})(ExceptionEvent);var VideoInsertMode={};(function(rp){Object.defineProperty(rp,"__esModule",{value:!0}),rp.VideoInsertMode=void 0,function(_d){_d.AFTER="AFTER",_d.APPEND="APPEND",_d.BEFORE="BEFORE",_d.PREPEND="PREPEND",_d.REPLACE="REPLACE"}(rp.VideoInsertMode||(rp.VideoInsertMode={}))})(VideoInsertMode);var __extends$b=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(StreamManager$1,"__esModule",{value:!0});StreamManager$1.StreamManager=void 0;var EventDispatcher_1=EventDispatcher$2,StreamManagerEvent_1$1=StreamManagerEvent$1,VideoElementEvent_1=VideoElementEvent$1,ExceptionEvent_1$3=ExceptionEvent,VideoInsertMode_1$1=VideoInsertMode,OpenViduLogger_1$7=OpenViduLogger$1,Platform_1$4=Platform,logger$7=OpenViduLogger_1$7.OpenViduLogger.getInstance(),platform$3,StreamManager=function(rp){__extends$b(_d,rp);function _d(np,ap){var sp=rp.call(this)||this;if(sp.videos=[],sp.lazyLaunchVideoElementCreatedEvent=!1,platform$3=Platform_1$4.PlatformUtils.getInstance(),sp.stream=np,sp.stream.streamManager=sp,sp.remote=!sp.stream.isLocal(),ap){var lp=void 0;typeof ap=="string"?lp=document.getElementById(ap):ap instanceof HTMLElement&&(lp=ap),lp&&(sp.firstVideoElement={targetElement:lp,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(platform$3.isSafariBrowser()||platform$3.isIPhoneOrIPad()&&(platform$3.isChromeMobileBrowser()||platform$3.isEdgeMobileBrowser()||platform$3.isOperaMobileBrowser()||platform$3.isFirefoxMobileBrowser()))&&(sp.firstVideoElement.video.playsInline=!0),sp.targetElement=lp,sp.element=lp)}return sp.canPlayListener=function(){sp.deactivateStreamPlayingEventExceptionTimeout(),sp.ee.emitEvent("streamPlaying",[new StreamManagerEvent_1$1.StreamManagerEvent(sp,"streamPlaying",void 0)])},sp}return _d.prototype.on=function(np,ap){return rp.prototype.onAux.call(this,np,"Event '"+np+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",ap),np==="videoElementCreated"&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new VideoElementEvent_1.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),np==="streamPlaying"&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&this.ee.emitEvent("streamPlaying",[new StreamManagerEvent_1$1.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&(np==="publisherStartSpeaking"&&this.stream.enableHarkSpeakingEvent(),np==="publisherStopSpeaking"&&this.stream.enableHarkStoppedSpeakingEvent(),np==="streamAudioVolumeChange"&&this.stream.enableHarkVolumeChangeEvent(!1)),this},_d.prototype.once=function(np,ap){return rp.prototype.onceAux.call(this,np,"Event '"+np+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",ap),np==="videoElementCreated"&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new VideoElementEvent_1.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),np==="streamPlaying"&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&this.ee.emitEvent("streamPlaying",[new StreamManagerEvent_1$1.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&(np==="publisherStartSpeaking"&&this.stream.enableOnceHarkSpeakingEvent(),np==="publisherStopSpeaking"&&this.stream.enableOnceHarkStoppedSpeakingEvent(),np==="streamAudioVolumeChange"&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},_d.prototype.off=function(np,ap){if(rp.prototype.offAux.call(this,np,ap),np==="publisherStartSpeaking"){var sp=this.ee.getListeners(np).length+this.stream.session.ee.getListeners(np).length;sp===0&&this.stream.disableHarkSpeakingEvent(!1)}if(np==="publisherStopSpeaking"){var lp=this.ee.getListeners(np).length+this.stream.session.ee.getListeners(np).length;lp===0&&this.stream.disableHarkStoppedSpeakingEvent(!1)}if(np==="streamAudioVolumeChange"){var up=this.ee.getListeners(np).length;up===0&&this.stream.disableHarkVolumeChangeEvent(!1)}return this},_d.prototype.addVideoElement=function(np){this.initializeVideoProperties(np),!this.remote&&this.stream.displayMyRemote()&&np.srcObject!==this.stream.getMediaStream()&&(np.srcObject=this.stream.getMediaStream());for(var ap=0,sp=this.videos;ap<sp.length;ap++){var lp=sp[ap];if(lp.video===np)return 0}for(var up=1,cp=0,dp=this.stream.session.streamManagers;cp<dp.length;cp++){var hp=dp[cp];if(hp.disassociateVideo(np)){up=-1;break}}return this.stream.session.streamManagers.forEach(function(fp){fp.disassociateVideo(np)}),this.pushNewStreamManagerVideo({video:np,id:np.id,canplayListenerAdded:!1}),logger$7.info("New video element associated to ",this),up},_d.prototype.createVideoElement=function(np,ap){var sp;if(typeof np=="string"){if(sp=document.getElementById(np),!sp)throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+np)}else if(np instanceof HTMLElement)sp=np;else throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+np);var lp=this.createVideo();this.initializeVideoProperties(lp);var up=ap||VideoInsertMode_1$1.VideoInsertMode.APPEND;switch(up){case VideoInsertMode_1$1.VideoInsertMode.AFTER:sp.parentNode.insertBefore(lp,sp.nextSibling);break;case VideoInsertMode_1$1.VideoInsertMode.APPEND:sp.appendChild(lp);break;case VideoInsertMode_1$1.VideoInsertMode.BEFORE:sp.parentNode.insertBefore(lp,sp);break;case VideoInsertMode_1$1.VideoInsertMode.PREPEND:sp.insertBefore(lp,sp.childNodes[0]);break;case VideoInsertMode_1$1.VideoInsertMode.REPLACE:sp.parentNode.replaceChild(lp,sp);break;default:up=VideoInsertMode_1$1.VideoInsertMode.APPEND,sp.appendChild(lp);break}var cp={targetElement:sp,video:lp,insertMode:up,id:lp.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(cp),this.ee.emitEvent("videoElementCreated",[new VideoElementEvent_1.VideoElementEvent(cp.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,lp},_d.prototype.updatePublisherSpeakingEventsOptions=function(np){var ap=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},sp=typeof np.interval=="number"?np.interval:typeof ap.interval=="number"?ap.interval:100,lp=typeof np.threshold=="number"?np.threshold:typeof ap.threshold=="number"?ap.threshold:-50;this.stream.harkOptions={interval:sp,threshold:lp},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(sp),this.stream.speechEvent.setThreshold(lp))},_d.prototype.initializeVideoProperties=function(np){!this.remote&&this.stream.displayMyRemote()||np.srcObject!==this.stream.getMediaStream()&&(np.srcObject=this.stream.getMediaStream()),np.autoplay=!0,np.controls=!1,(platform$3.isSafariBrowser()||platform$3.isIPhoneOrIPad()&&(platform$3.isChromeMobileBrowser()||platform$3.isEdgeMobileBrowser()||platform$3.isOperaMobileBrowser()||platform$3.isFirefoxMobileBrowser()))&&(np.playsInline=!0),np.id||(np.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,!this.id&&this.targetElement&&(this.id=np.id)),this.remote&&this.isMirroredVideo(np)?this.removeMirrorVideo(np):!this.remote&&!this.stream.displayMyRemote()&&(np.muted=!0,this.isMirroredVideo(np)&&!this.stream.outboundStreamOpts.publisherProperties.mirror?this.removeMirrorVideo(np):this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(np))},_d.prototype.removeAllVideos=function(){for(var np=this,ap=this.stream.session.streamManagers.length-1;ap>=0;--ap)this.stream.session.streamManagers[ap]===this&&this.stream.session.streamManagers.splice(ap,1);this.videos.forEach(function(sp){sp.video&&sp.video.removeEventListener&&sp.video.removeEventListener("canplay",np.canPlayListener),sp.canplayListenerAdded=!1,sp.targetElement&&(sp.video.parentNode.removeChild(sp.video),np.ee.emitEvent("videoElementDestroyed",[new VideoElementEvent_1.VideoElementEvent(sp.video,np,"videoElementDestroyed")])),np.removeSrcObject(sp),np.videos.filter(function(lp){return!lp.targetElement})})},_d.prototype.disassociateVideo=function(np){for(var ap=!1,sp=0;sp<this.videos.length;sp++)if(this.videos[sp].video===np){this.videos[sp].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(sp,1),ap=!0,logger$7.info("Video element disassociated from ",this);break}return ap},_d.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},_d.prototype.updateMediaStream=function(np){this.videos.forEach(function(ap){if(ap.video.srcObject=np,platform$3.isIonicIos()){var sp=ap.video.parentElement,lp=ap.video;sp.replaceChild(lp,ap.video),ap.video=lp}})},_d.prototype.emitEvent=function(np,ap){this.ee.emitEvent(np,ap)},_d.prototype.createVideo=function(){return document.createElement("video")},_d.prototype.removeSrcObject=function(np){np.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},_d.prototype.pushNewStreamManagerVideo=function(np){this.videos.push(np),this.addPlayEventToFirstVideo(),this.stream.session.streamManagers.indexOf(this)===-1&&this.stream.session.streamManagers.push(this)},_d.prototype.mirrorVideo=function(np){platform$3.isIonicIos()||(np.style.transform="rotateY(180deg)",np.style.webkitTransform="rotateY(180deg)")},_d.prototype.removeMirrorVideo=function(np){np.style.transform="unset",np.style.webkitTransform="unset"},_d.prototype.isMirroredVideo=function(np){return np.style.transform==="rotateY(180deg)"||np.style.webkitTransform==="rotateY(180deg)"},_d.prototype.activateStreamPlayingEventExceptionTimeout=function(){var np=this;if(this.remote&&this.streamPlayingEventExceptionTimeout==null){var ap=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout(function(){var sp="StreamManager of Stream "+np.stream.streamId+" ("+(np.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+ap+" ms";logger$7.warn(sp),np.stream.session.emitEvent("exception",[new ExceptionEvent_1$3.ExceptionEvent(np.stream.session,ExceptionEvent_1$3.ExceptionEventName.NO_STREAM_PLAYING_EVENT,np,sp)]),delete np.streamPlayingEventExceptionTimeout},ap)}},_d.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},_d}(EventDispatcher_1.EventDispatcher);StreamManager$1.StreamManager=StreamManager;var __extends$a=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(Subscriber$1,"__esModule",{value:!0});Subscriber$1.Subscriber=void 0;var StreamManager_1=StreamManager$1,OpenViduLogger_1$6=OpenViduLogger$1,logger$6=OpenViduLogger_1$6.OpenViduLogger.getInstance(),Subscriber=function(rp){__extends$a(_d,rp);function _d(np,ap,sp){var lp=rp.call(this,np,ap)||this;return lp.element=lp.targetElement,lp.stream=np,lp.properties=sp,lp}return _d.prototype.subscribeToAudio=function(np){return this.stream.getMediaStream().getAudioTracks().forEach(function(ap){ap.enabled=np}),this.stream.audioActive=np,logger$6.info("'Subscriber' has "+(np?"subscribed to":"unsubscribed from")+" its audio stream"),this},_d.prototype.subscribeToVideo=function(np){return this.stream.getMediaStream().getVideoTracks().forEach(function(ap){ap.enabled=np}),this.stream.videoActive=np,logger$6.info("'Subscriber' has "+(np?"subscribed to":"unsubscribed from")+" its video stream"),this},_d.prototype.replaceTrackInMediaStream=function(np,ap){var sp=this.stream.getMediaStream(),lp;np.kind==="video"?(lp=sp.getVideoTracks()[0],ap&&(this.stream.lastVideoTrackConstraints=np.getConstraints())):lp=sp.getAudioTracks()[0],sp.removeTrack(lp),lp.stop(),sp.addTrack(np)},_d}(StreamManager_1.StreamManager);Subscriber$1.Subscriber=Subscriber;var WebRtcPeer$1={},protocols=["stun:","turn:"],normalice$1=function(rp){var _d=(rp||{}).url||rp,np,ap,sp={};return typeof _d!="string"&&!(_d instanceof String)||(_d=_d.trim(),np=protocols[protocols.indexOf(_d.slice(0,5))],!np)?rp:(_d=_d.slice(5),ap=_d.split("@"),sp.username=rp.username,sp.credential=rp.credential,ap.length>1&&(_d=ap[1],ap=ap[0].split(":"),sp.username=ap[0],sp.credential=(rp||{}).credential||ap[1]||""),sp.url=np+_d,sp.urls=[sp.url],sp)};const require$$1=["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"],require$$2=[];var normalice=normalice$1,freeice$1=function(rp){var _d={stun:(rp||{}).stun||require$$1,turn:(rp||{}).turn||require$$2},np=(rp||{}).stunCount||2,ap=(rp||{}).turnCount||0,sp;function lp(up,cp){for(var dp=[],hp=[].concat(_d[up]),fp;hp.length&&dp.length<cp;)fp=Math.random()*hp.length|0,dp=dp.concat(hp.splice(fp,1));return dp.map(function(pp){return typeof pp!="string"&&!(pp instanceof String)?pp:normalice(up+":"+pp)})}return sp=[].concat(lp("stun",np)),ap&&(sp=sp.concat(lp("turn",ap))),sp},freeice_1=freeice$1,commonjsBrowser={},v1$1={},rng$1={};Object.defineProperty(rng$1,"__esModule",{value:!0});rng$1.default=rng;let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var stringify$1={},validate$1={},regex={};Object.defineProperty(regex,"__esModule",{value:!0});regex.default=void 0;var _default$c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;regex.default=_default$c;Object.defineProperty(validate$1,"__esModule",{value:!0});validate$1.default=void 0;var _regex=_interopRequireDefault$m(regex);function _interopRequireDefault$m(rp){return rp&&rp.__esModule?rp:{default:rp}}function validate(rp){return typeof rp=="string"&&_regex.default.test(rp)}var _default$b=validate;validate$1.default=_default$b;Object.defineProperty(stringify$1,"__esModule",{value:!0});stringify$1.default=void 0;stringify$1.unsafeStringify=unsafeStringify;var _validate$2=_interopRequireDefault$l(validate$1);function _interopRequireDefault$l(rp){return rp&&rp.__esModule?rp:{default:rp}}const byteToHex=[];for(let rp=0;rp<256;++rp)byteToHex.push((rp+256).toString(16).slice(1));function unsafeStringify(rp,_d=0){return(byteToHex[rp[_d+0]]+byteToHex[rp[_d+1]]+byteToHex[rp[_d+2]]+byteToHex[rp[_d+3]]+"-"+byteToHex[rp[_d+4]]+byteToHex[rp[_d+5]]+"-"+byteToHex[rp[_d+6]]+byteToHex[rp[_d+7]]+"-"+byteToHex[rp[_d+8]]+byteToHex[rp[_d+9]]+"-"+byteToHex[rp[_d+10]]+byteToHex[rp[_d+11]]+byteToHex[rp[_d+12]]+byteToHex[rp[_d+13]]+byteToHex[rp[_d+14]]+byteToHex[rp[_d+15]]).toLowerCase()}function stringify(rp,_d=0){const np=unsafeStringify(rp,_d);if(!(0,_validate$2.default)(np))throw TypeError("Stringified UUID is invalid");return np}var _default$a=stringify;stringify$1.default=_default$a;Object.defineProperty(v1$1,"__esModule",{value:!0});v1$1.default=void 0;var _rng$1=_interopRequireDefault$k(rng$1),_stringify$2=stringify$1;function _interopRequireDefault$k(rp){return rp&&rp.__esModule?rp:{default:rp}}let _nodeId,_clockseq,_lastMSecs=0,_lastNSecs=0;function v1(rp,_d,np){let ap=_d&&np||0;const sp=_d||new Array(16);rp=rp||{};let lp=rp.node||_nodeId,up=rp.clockseq!==void 0?rp.clockseq:_clockseq;if(lp==null||up==null){const mp=rp.random||(rp.rng||_rng$1.default)();lp==null&&(lp=_nodeId=[mp[0]|1,mp[1],mp[2],mp[3],mp[4],mp[5]]),up==null&&(up=_clockseq=(mp[6]<<8|mp[7])&16383)}let cp=rp.msecs!==void 0?rp.msecs:Date.now(),dp=rp.nsecs!==void 0?rp.nsecs:_lastNSecs+1;const hp=cp-_lastMSecs+(dp-_lastNSecs)/1e4;if(hp<0&&rp.clockseq===void 0&&(up=up+1&16383),(hp<0||cp>_lastMSecs)&&rp.nsecs===void 0&&(dp=0),dp>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=cp,_lastNSecs=dp,_clockseq=up,cp+=122192928e5;const fp=((cp&268435455)*1e4+dp)%4294967296;sp[ap++]=fp>>>24&255,sp[ap++]=fp>>>16&255,sp[ap++]=fp>>>8&255,sp[ap++]=fp&255;const pp=cp/4294967296*1e4&268435455;sp[ap++]=pp>>>8&255,sp[ap++]=pp&255,sp[ap++]=pp>>>24&15|16,sp[ap++]=pp>>>16&255,sp[ap++]=up>>>8|128,sp[ap++]=up&255;for(let mp=0;mp<6;++mp)sp[ap+mp]=lp[mp];return _d||(0,_stringify$2.unsafeStringify)(sp)}var _default$9=v1;v1$1.default=_default$9;var v3$1={},v35$1={},parse$1={};Object.defineProperty(parse$1,"__esModule",{value:!0});parse$1.default=void 0;var _validate$1=_interopRequireDefault$j(validate$1);function _interopRequireDefault$j(rp){return rp&&rp.__esModule?rp:{default:rp}}function parse(rp){if(!(0,_validate$1.default)(rp))throw TypeError("Invalid UUID");let _d;const np=new Uint8Array(16);return np[0]=(_d=parseInt(rp.slice(0,8),16))>>>24,np[1]=_d>>>16&255,np[2]=_d>>>8&255,np[3]=_d&255,np[4]=(_d=parseInt(rp.slice(9,13),16))>>>8,np[5]=_d&255,np[6]=(_d=parseInt(rp.slice(14,18),16))>>>8,np[7]=_d&255,np[8]=(_d=parseInt(rp.slice(19,23),16))>>>8,np[9]=_d&255,np[10]=(_d=parseInt(rp.slice(24,36),16))/1099511627776&255,np[11]=_d/4294967296&255,np[12]=_d>>>24&255,np[13]=_d>>>16&255,np[14]=_d>>>8&255,np[15]=_d&255,np}var _default$8=parse;parse$1.default=_default$8;Object.defineProperty(v35$1,"__esModule",{value:!0});v35$1.URL=v35$1.DNS=void 0;v35$1.default=v35;var _stringify$1=stringify$1,_parse=_interopRequireDefault$i(parse$1);function _interopRequireDefault$i(rp){return rp&&rp.__esModule?rp:{default:rp}}function stringToBytes(rp){rp=unescape(encodeURIComponent(rp));const _d=[];for(let np=0;np<rp.length;++np)_d.push(rp.charCodeAt(np));return _d}const DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";v35$1.DNS=DNS;const URL$1="6ba7b811-9dad-11d1-80b4-00c04fd430c8";v35$1.URL=URL$1;function v35(rp,_d,np){function ap(sp,lp,up,cp){var dp;if(typeof sp=="string"&&(sp=stringToBytes(sp)),typeof lp=="string"&&(lp=(0,_parse.default)(lp)),((dp=lp)===null||dp===void 0?void 0:dp.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let hp=new Uint8Array(16+sp.length);if(hp.set(lp),hp.set(sp,lp.length),hp=np(hp),hp[6]=hp[6]&15|_d,hp[8]=hp[8]&63|128,up){cp=cp||0;for(let fp=0;fp<16;++fp)up[cp+fp]=hp[fp];return up}return(0,_stringify$1.unsafeStringify)(hp)}try{ap.name=rp}catch{}return ap.DNS=DNS,ap.URL=URL$1,ap}var md5$1={};Object.defineProperty(md5$1,"__esModule",{value:!0});md5$1.default=void 0;function md5(rp){if(typeof rp=="string"){const _d=unescape(encodeURIComponent(rp));rp=new Uint8Array(_d.length);for(let np=0;np<_d.length;++np)rp[np]=_d.charCodeAt(np)}return md5ToHexEncodedArray(wordsToMd5(bytesToWords(rp),rp.length*8))}function md5ToHexEncodedArray(rp){const _d=[],np=rp.length*32,ap="0123456789abcdef";for(let sp=0;sp<np;sp+=8){const lp=rp[sp>>5]>>>sp%32&255,up=parseInt(ap.charAt(lp>>>4&15)+ap.charAt(lp&15),16);_d.push(up)}return _d}function getOutputLength(rp){return(rp+64>>>9<<4)+14+1}function wordsToMd5(rp,_d){rp[_d>>5]|=128<<_d%32,rp[getOutputLength(_d)-1]=_d;let np=1732584193,ap=-271733879,sp=-1732584194,lp=271733878;for(let up=0;up<rp.length;up+=16){const cp=np,dp=ap,hp=sp,fp=lp;np=md5ff(np,ap,sp,lp,rp[up],7,-680876936),lp=md5ff(lp,np,ap,sp,rp[up+1],12,-389564586),sp=md5ff(sp,lp,np,ap,rp[up+2],17,606105819),ap=md5ff(ap,sp,lp,np,rp[up+3],22,-1044525330),np=md5ff(np,ap,sp,lp,rp[up+4],7,-176418897),lp=md5ff(lp,np,ap,sp,rp[up+5],12,1200080426),sp=md5ff(sp,lp,np,ap,rp[up+6],17,-1473231341),ap=md5ff(ap,sp,lp,np,rp[up+7],22,-45705983),np=md5ff(np,ap,sp,lp,rp[up+8],7,1770035416),lp=md5ff(lp,np,ap,sp,rp[up+9],12,-1958414417),sp=md5ff(sp,lp,np,ap,rp[up+10],17,-42063),ap=md5ff(ap,sp,lp,np,rp[up+11],22,-1990404162),np=md5ff(np,ap,sp,lp,rp[up+12],7,1804603682),lp=md5ff(lp,np,ap,sp,rp[up+13],12,-40341101),sp=md5ff(sp,lp,np,ap,rp[up+14],17,-1502002290),ap=md5ff(ap,sp,lp,np,rp[up+15],22,1236535329),np=md5gg(np,ap,sp,lp,rp[up+1],5,-165796510),lp=md5gg(lp,np,ap,sp,rp[up+6],9,-1069501632),sp=md5gg(sp,lp,np,ap,rp[up+11],14,643717713),ap=md5gg(ap,sp,lp,np,rp[up],20,-373897302),np=md5gg(np,ap,sp,lp,rp[up+5],5,-701558691),lp=md5gg(lp,np,ap,sp,rp[up+10],9,38016083),sp=md5gg(sp,lp,np,ap,rp[up+15],14,-660478335),ap=md5gg(ap,sp,lp,np,rp[up+4],20,-405537848),np=md5gg(np,ap,sp,lp,rp[up+9],5,568446438),lp=md5gg(lp,np,ap,sp,rp[up+14],9,-1019803690),sp=md5gg(sp,lp,np,ap,rp[up+3],14,-187363961),ap=md5gg(ap,sp,lp,np,rp[up+8],20,1163531501),np=md5gg(np,ap,sp,lp,rp[up+13],5,-1444681467),lp=md5gg(lp,np,ap,sp,rp[up+2],9,-51403784),sp=md5gg(sp,lp,np,ap,rp[up+7],14,1735328473),ap=md5gg(ap,sp,lp,np,rp[up+12],20,-1926607734),np=md5hh(np,ap,sp,lp,rp[up+5],4,-378558),lp=md5hh(lp,np,ap,sp,rp[up+8],11,-2022574463),sp=md5hh(sp,lp,np,ap,rp[up+11],16,1839030562),ap=md5hh(ap,sp,lp,np,rp[up+14],23,-35309556),np=md5hh(np,ap,sp,lp,rp[up+1],4,-1530992060),lp=md5hh(lp,np,ap,sp,rp[up+4],11,1272893353),sp=md5hh(sp,lp,np,ap,rp[up+7],16,-155497632),ap=md5hh(ap,sp,lp,np,rp[up+10],23,-1094730640),np=md5hh(np,ap,sp,lp,rp[up+13],4,681279174),lp=md5hh(lp,np,ap,sp,rp[up],11,-358537222),sp=md5hh(sp,lp,np,ap,rp[up+3],16,-722521979),ap=md5hh(ap,sp,lp,np,rp[up+6],23,76029189),np=md5hh(np,ap,sp,lp,rp[up+9],4,-640364487),lp=md5hh(lp,np,ap,sp,rp[up+12],11,-421815835),sp=md5hh(sp,lp,np,ap,rp[up+15],16,530742520),ap=md5hh(ap,sp,lp,np,rp[up+2],23,-995338651),np=md5ii(np,ap,sp,lp,rp[up],6,-198630844),lp=md5ii(lp,np,ap,sp,rp[up+7],10,1126891415),sp=md5ii(sp,lp,np,ap,rp[up+14],15,-1416354905),ap=md5ii(ap,sp,lp,np,rp[up+5],21,-57434055),np=md5ii(np,ap,sp,lp,rp[up+12],6,1700485571),lp=md5ii(lp,np,ap,sp,rp[up+3],10,-1894986606),sp=md5ii(sp,lp,np,ap,rp[up+10],15,-1051523),ap=md5ii(ap,sp,lp,np,rp[up+1],21,-2054922799),np=md5ii(np,ap,sp,lp,rp[up+8],6,1873313359),lp=md5ii(lp,np,ap,sp,rp[up+15],10,-30611744),sp=md5ii(sp,lp,np,ap,rp[up+6],15,-1560198380),ap=md5ii(ap,sp,lp,np,rp[up+13],21,1309151649),np=md5ii(np,ap,sp,lp,rp[up+4],6,-145523070),lp=md5ii(lp,np,ap,sp,rp[up+11],10,-1120210379),sp=md5ii(sp,lp,np,ap,rp[up+2],15,718787259),ap=md5ii(ap,sp,lp,np,rp[up+9],21,-343485551),np=safeAdd(np,cp),ap=safeAdd(ap,dp),sp=safeAdd(sp,hp),lp=safeAdd(lp,fp)}return[np,ap,sp,lp]}function bytesToWords(rp){if(rp.length===0)return[];const _d=rp.length*8,np=new Uint32Array(getOutputLength(_d));for(let ap=0;ap<_d;ap+=8)np[ap>>5]|=(rp[ap/8]&255)<<ap%32;return np}function safeAdd(rp,_d){const np=(rp&65535)+(_d&65535);return(rp>>16)+(_d>>16)+(np>>16)<<16|np&65535}function bitRotateLeft(rp,_d){return rp<<_d|rp>>>32-_d}function md5cmn(rp,_d,np,ap,sp,lp){return safeAdd(bitRotateLeft(safeAdd(safeAdd(_d,rp),safeAdd(ap,lp)),sp),np)}function md5ff(rp,_d,np,ap,sp,lp,up){return md5cmn(_d&np|~_d&ap,rp,_d,sp,lp,up)}function md5gg(rp,_d,np,ap,sp,lp,up){return md5cmn(_d&ap|np&~ap,rp,_d,sp,lp,up)}function md5hh(rp,_d,np,ap,sp,lp,up){return md5cmn(_d^np^ap,rp,_d,sp,lp,up)}function md5ii(rp,_d,np,ap,sp,lp,up){return md5cmn(np^(_d|~ap),rp,_d,sp,lp,up)}var _default$7=md5;md5$1.default=_default$7;Object.defineProperty(v3$1,"__esModule",{value:!0});v3$1.default=void 0;var _v$1=_interopRequireDefault$h(v35$1),_md=_interopRequireDefault$h(md5$1);function _interopRequireDefault$h(rp){return rp&&rp.__esModule?rp:{default:rp}}const v3=(0,_v$1.default)("v3",48,_md.default);var _default$6=v3;v3$1.default=_default$6;var v4$1={},native={};Object.defineProperty(native,"__esModule",{value:!0});native.default=void 0;const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var _default$5={randomUUID};native.default=_default$5;Object.defineProperty(v4$1,"__esModule",{value:!0});v4$1.default=void 0;var _native=_interopRequireDefault$g(native),_rng=_interopRequireDefault$g(rng$1),_stringify=stringify$1;function _interopRequireDefault$g(rp){return rp&&rp.__esModule?rp:{default:rp}}function v4(rp,_d,np){if(_native.default.randomUUID&&!_d&&!rp)return _native.default.randomUUID();rp=rp||{};const ap=rp.random||(rp.rng||_rng.default)();if(ap[6]=ap[6]&15|64,ap[8]=ap[8]&63|128,_d){np=np||0;for(let sp=0;sp<16;++sp)_d[np+sp]=ap[sp];return _d}return(0,_stringify.unsafeStringify)(ap)}var _default$4=v4;v4$1.default=_default$4;var v5$1={},sha1$1={};Object.defineProperty(sha1$1,"__esModule",{value:!0});sha1$1.default=void 0;function f(rp,_d,np,ap){switch(rp){case 0:return _d&np^~_d&ap;case 1:return _d^np^ap;case 2:return _d&np^_d&ap^np&ap;case 3:return _d^np^ap}}function ROTL(rp,_d){return rp<<_d|rp>>>32-_d}function sha1(rp){const _d=[1518500249,1859775393,2400959708,3395469782],np=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof rp=="string"){const up=unescape(encodeURIComponent(rp));rp=[];for(let cp=0;cp<up.length;++cp)rp.push(up.charCodeAt(cp))}else Array.isArray(rp)||(rp=Array.prototype.slice.call(rp));rp.push(128);const ap=rp.length/4+2,sp=Math.ceil(ap/16),lp=new Array(sp);for(let up=0;up<sp;++up){const cp=new Uint32Array(16);for(let dp=0;dp<16;++dp)cp[dp]=rp[up*64+dp*4]<<24|rp[up*64+dp*4+1]<<16|rp[up*64+dp*4+2]<<8|rp[up*64+dp*4+3];lp[up]=cp}lp[sp-1][14]=(rp.length-1)*8/Math.pow(2,32),lp[sp-1][14]=Math.floor(lp[sp-1][14]),lp[sp-1][15]=(rp.length-1)*8&4294967295;for(let up=0;up<sp;++up){const cp=new Uint32Array(80);for(let gp=0;gp<16;++gp)cp[gp]=lp[up][gp];for(let gp=16;gp<80;++gp)cp[gp]=ROTL(cp[gp-3]^cp[gp-8]^cp[gp-14]^cp[gp-16],1);let dp=np[0],hp=np[1],fp=np[2],pp=np[3],mp=np[4];for(let gp=0;gp<80;++gp){const yp=Math.floor(gp/20),xp=ROTL(dp,5)+f(yp,hp,fp,pp)+mp+_d[yp]+cp[gp]>>>0;mp=pp,pp=fp,fp=ROTL(hp,30)>>>0,hp=dp,dp=xp}np[0]=np[0]+dp>>>0,np[1]=np[1]+hp>>>0,np[2]=np[2]+fp>>>0,np[3]=np[3]+pp>>>0,np[4]=np[4]+mp>>>0}return[np[0]>>24&255,np[0]>>16&255,np[0]>>8&255,np[0]&255,np[1]>>24&255,np[1]>>16&255,np[1]>>8&255,np[1]&255,np[2]>>24&255,np[2]>>16&255,np[2]>>8&255,np[2]&255,np[3]>>24&255,np[3]>>16&255,np[3]>>8&255,np[3]&255,np[4]>>24&255,np[4]>>16&255,np[4]>>8&255,np[4]&255]}var _default$3=sha1;sha1$1.default=_default$3;Object.defineProperty(v5$1,"__esModule",{value:!0});v5$1.default=void 0;var _v=_interopRequireDefault$f(v35$1),_sha=_interopRequireDefault$f(sha1$1);function _interopRequireDefault$f(rp){return rp&&rp.__esModule?rp:{default:rp}}const v5=(0,_v.default)("v5",80,_sha.default);var _default$2=v5;v5$1.default=_default$2;var nil={};Object.defineProperty(nil,"__esModule",{value:!0});nil.default=void 0;var _default$1="00000000-0000-0000-0000-000000000000";nil.default=_default$1;var version$3={};Object.defineProperty(version$3,"__esModule",{value:!0});version$3.default=void 0;var _validate=_interopRequireDefault$e(validate$1);function _interopRequireDefault$e(rp){return rp&&rp.__esModule?rp:{default:rp}}function version$2(rp){if(!(0,_validate.default)(rp))throw TypeError("Invalid UUID");return parseInt(rp.slice(14,15),16)}var _default=version$2;version$3.default=_default;(function(rp){Object.defineProperty(rp,"__esModule",{value:!0}),Object.defineProperty(rp,"NIL",{enumerable:!0,get:function(){return lp.default}}),Object.defineProperty(rp,"parse",{enumerable:!0,get:function(){return hp.default}}),Object.defineProperty(rp,"stringify",{enumerable:!0,get:function(){return dp.default}}),Object.defineProperty(rp,"v1",{enumerable:!0,get:function(){return _d.default}}),Object.defineProperty(rp,"v3",{enumerable:!0,get:function(){return np.default}}),Object.defineProperty(rp,"v4",{enumerable:!0,get:function(){return ap.default}}),Object.defineProperty(rp,"v5",{enumerable:!0,get:function(){return sp.default}}),Object.defineProperty(rp,"validate",{enumerable:!0,get:function(){return cp.default}}),Object.defineProperty(rp,"version",{enumerable:!0,get:function(){return up.default}});var _d=fp(v1$1),np=fp(v3$1),ap=fp(v4$1),sp=fp(v5$1),lp=fp(nil),up=fp(version$3),cp=fp(validate$1),dp=fp(stringify$1),hp=fp(parse$1);function fp(pp){return pp&&pp.__esModule?pp:{default:pp}}})(commonjsBrowser);var __extends$9=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}(),__assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign=Object.assign||function(rp){for(var _d,np=1,ap=arguments.length;np<ap;np++){_d=arguments[np];for(var sp in _d)Object.prototype.hasOwnProperty.call(_d,sp)&&(rp[sp]=_d[sp])}return rp},__assign.apply(this,arguments)},__awaiter$3=commonjsGlobal&&commonjsGlobal.__awaiter||function(rp,_d,np,ap){function sp(lp){return lp instanceof np?lp:new np(function(up){up(lp)})}return new(np||(np=Promise))(function(lp,up){function cp(fp){try{hp(ap.next(fp))}catch(pp){up(pp)}}function dp(fp){try{hp(ap.throw(fp))}catch(pp){up(pp)}}function hp(fp){fp.done?lp(fp.value):sp(fp.value).then(cp,dp)}hp((ap=ap.apply(rp,_d||[])).next())})},__generator$3=commonjsGlobal&&commonjsGlobal.__generator||function(rp,_d){var np={label:0,sent:function(){if(lp[0]&1)throw lp[1];return lp[1]},trys:[],ops:[]},ap,sp,lp,up;return up={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(up[Symbol.iterator]=function(){return this}),up;function cp(hp){return function(fp){return dp([hp,fp])}}function dp(hp){if(ap)throw new TypeError("Generator is already executing.");for(;up&&(up=0,hp[0]&&(np=0)),np;)try{if(ap=1,sp&&(lp=hp[0]&2?sp.return:hp[0]?sp.throw||((lp=sp.return)&&lp.call(sp),0):sp.next)&&!(lp=lp.call(sp,hp[1])).done)return lp;switch(sp=0,lp&&(hp=[hp[0]&2,lp.value]),hp[0]){case 0:case 1:lp=hp;break;case 4:return np.label++,{value:hp[1],done:!1};case 5:np.label++,sp=hp[1],hp=[0];continue;case 7:hp=np.ops.pop(),np.trys.pop();continue;default:if(lp=np.trys,!(lp=lp.length>0&&lp[lp.length-1])&&(hp[0]===6||hp[0]===2)){np=0;continue}if(hp[0]===3&&(!lp||hp[1]>lp[0]&&hp[1]<lp[3])){np.label=hp[1];break}if(hp[0]===6&&np.label<lp[1]){np.label=lp[1],lp=hp;break}if(lp&&np.label<lp[2]){np.label=lp[2],np.ops.push(hp);break}lp[2]&&np.ops.pop(),np.trys.pop();continue}hp=_d.call(rp,np)}catch(fp){hp=[6,fp],sp=0}finally{ap=lp=0}if(hp[0]&5)throw hp[1];return{value:hp[0]?hp[1]:void 0,done:!0}}};Object.defineProperty(WebRtcPeer$1,"__esModule",{value:!0});WebRtcPeer$1.WebRtcPeerSendrecv=WebRtcPeer$1.WebRtcPeerSendonly=WebRtcPeer$1.WebRtcPeerRecvonly=WebRtcPeer$1.WebRtcPeer=void 0;var freeice=freeice_1,uuid_1$1=commonjsBrowser,ExceptionEvent_1$2=ExceptionEvent,OpenViduLogger_1$5=OpenViduLogger$1,Platform_1$3=Platform,logger$5=OpenViduLogger_1$5.OpenViduLogger.getInstance(),WebRtcPeer=function(){function rp(_d){var np=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],Platform_1$3.PlatformUtils.getInstance(),this.configuration=__assign(__assign({},_d),{iceServers:_d.iceServers&&_d.iceServers.length>0?_d.iceServers:freeice(),mediaStream:_d.mediaStream!==void 0?_d.mediaStream:null,mode:_d.mode?_d.mode:"sendrecv",id:_d.id?_d.id:this.generateUniqueId()}),logger$5.debug(`[WebRtcPeer] configuration:
`.concat(JSON.stringify(this.configuration,null,2))),this.pc=new RTCPeerConnection({iceServers:this.configuration.iceServers}),this.pc.addEventListener("icecandidate",function(ap){if(ap.candidate!==null){var sp=ap.candidate,lp=new RTCIceCandidate(sp);np.configuration.onIceCandidate(lp),lp.candidate!==""&&np.localCandidatesQueue.push(lp)}}),this.pc.addEventListener("signalingstatechange",function(){return __awaiter$3(np,void 0,void 0,function(){var ap,sp;return __generator$3(this,function(lp){switch(lp.label){case 0:if(this.pc.signalingState!=="stable")return[3,6];lp.label=1;case 1:if(!(this.iceCandidateList.length>0))return[3,6];ap=this.iceCandidateList.shift(),lp.label=2;case 2:return lp.trys.push([2,4,,5]),[4,this.pc.addIceCandidate(ap)];case 3:return lp.sent(),[3,5];case 4:return sp=lp.sent(),logger$5.error("Error when calling RTCPeerConnection#addIceCandidate for RTCPeerConnection "+this.getId(),sp),[3,5];case 5:return[3,1];case 6:return[2]}})})})}return rp.prototype.getId=function(){return this.configuration.id},rp.prototype.dispose=function(){if(logger$5.debug("Disposing WebRtcPeer"),this.pc){if(this.pc.signalingState==="closed")return;this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[]}},rp.prototype.createOfferLegacy=function(){this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi();var _d=this.configuration.mediaConstraints.audio,np=this.configuration.mediaConstraints.video,ap={offerToReceiveAudio:this.configuration.mode!=="sendonly"&&_d,offerToReceiveVideo:this.configuration.mode!=="sendonly"&&np};return logger$5.debug("[createOfferLegacy] RTCPeerConnection.createOffer() options:",JSON.stringify(ap)),this.pc.createOffer(ap)},rp.prototype.createOffer=function(){var _d,np,ap,sp,lp,up,cp,dp;return __awaiter$3(this,void 0,void 0,function(){var hp,fp,pp,mp,gp,yp,xp,_p,vp,bp,Ep,Sp,Ap,Rp,Tp,Mp,Op,jp,Pp,$p,zp,Dp,Fp,jp;return __generator$3(this,function(Lp){switch(Lp.label){case 0:if("addTransceiver"in this.pc)logger$5.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it");else return logger$5.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),[2,this.createOfferLegacy()];if(this.configuration.mode==="recvonly")return[3,7];if(!this.configuration.mediaStream)throw new Error("[WebRtcPeer.createOffer] Direction is '".concat(this.configuration.mode,"', but no stream was configured to be sent"));hp=0,fp=this.configuration.mediaStream.getTracks(),Lp.label=1;case 1:if(!(hp<fp.length))return[3,6];if(pp=fp[hp],mp={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},pp.kind==="video"&&this.configuration.simulcast)for(gp=pp.getSettings(),yp=pp.getConstraints(),xp=(ap=(np=(_d=gp.width)!==null&&_d!==void 0?_d:yp.width.ideal)!==null&&np!==void 0?np:yp.width)!==null&&ap!==void 0?ap:0,_p=(up=(lp=(sp=gp.height)!==null&&sp!==void 0?sp:yp.height.ideal)!==null&&lp!==void 0?lp:yp.height)!==null&&up!==void 0?up:0,logger$5.info("[createOffer] Video track dimensions: ".concat(xp,"x").concat(_p)),vp=xp*_p,bp=0,vp>=960*540?bp=3:vp>=480*270?bp=2:bp=1,mp.sendEncodings=[],Ep=0;Ep<bp;Ep++)Sp=Math.pow(2,bp-Ep-1),Ap={rid:"rdiv"+Sp.toString(),scalabilityMode:"L1T1"},["detail","text"].includes(pp.contentHint)?(Ap.scaleResolutionDownBy=1,Ap.maxFramerate=Math.floor(30/Sp)):Ap.scaleResolutionDownBy=Sp,mp.sendEncodings.push(Ap);if(Rp=this.pc.addTransceiver(pp,mp),pp.kind!=="video")return[3,5];if(Tp=Rp.sender.getParameters(),Mp=!1,!((cp=Tp.degradationPreference)===null||cp===void 0)&&cp.length||(["detail","text"].includes(pp.contentHint)?Tp.degradationPreference="maintain-resolution":Tp.degradationPreference="balanced",logger$5.info("[createOffer] Video sender Degradation Preference set: ".concat(Tp.degradationPreference)),Mp=!0),this.configuration.simulcast&&((dp=Tp.encodings)===null||dp===void 0?void 0:dp.length)!==mp.sendEncodings.length&&(Tp.encodings=mp.sendEncodings,Mp=!0),!Mp)return[3,5];logger$5.debug("[createOffer] Setting new RTCRtpSendParameters to video sender"),Lp.label=2;case 2:return Lp.trys.push([2,4,,5]),[4,Rp.sender.setParameters(Tp)];case 3:return Lp.sent(),[3,5];case 4:throw Op=Lp.sent(),jp="[WebRtcPeer.createOffer] Cannot set RTCRtpSendParameters to video sender",Op instanceof Error&&(jp+=": ".concat(Op.message)),new Error(jp);case 5:return hp++,[3,1];case 6:return[3,8];case 7:for(Pp=0,$p=["audio","video"];Pp<$p.length;Pp++)zp=$p[Pp],this.configuration.mediaConstraints[zp]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(zp,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));Lp.label=8;case 8:return Lp.trys.push([8,10,,11]),[4,this.pc.createOffer()];case 9:return Dp=Lp.sent(),[3,11];case 10:throw Fp=Lp.sent(),jp="[WebRtcPeer.createOffer] Browser failed creating an SDP Offer",Fp instanceof Error&&(jp+=": ".concat(Fp.message)),new Error(jp);case 11:return[2,Dp]}})})},rp.prototype.deprecatedPeerConnectionTrackApi=function(){for(var _d=0,np=this.configuration.mediaStream.getTracks();_d<np.length;_d++){var ap=np[_d];this.pc.addTrack(ap,this.configuration.mediaStream)}},rp.prototype.createAnswer=function(){var _d=this;return new Promise(function(np,ap){if("getTransceivers"in _d.pc){logger$5.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var sp=function(mp){if(!_d.configuration.mediaConstraints[mp])return"continue";var gp=_d.pc.getTransceivers().find(function(yp){return yp.receiver.track.kind===mp});if(gp)gp.direction=_d.configuration.mode;else return{value:ap(new Error("".concat(mp," requested, but no transceiver was created from remote description")))}},lp=0,up=["audio","video"];lp<up.length;lp++){var cp=up[lp],dp=sp(cp);if(typeof dp=="object")return dp.value}_d.pc.createAnswer().then(function(mp){return np(mp)}).catch(function(mp){return ap(mp)})}else{var hp=void 0,fp=!0;if(_d.configuration.mediaConstraints){hp=typeof _d.configuration.mediaConstraints.audio=="boolean"?_d.configuration.mediaConstraints.audio:!0,fp=typeof _d.configuration.mediaConstraints.video=="boolean"?_d.configuration.mediaConstraints.video:!0;var pp={offerToReceiveAudio:hp,offerToReceiveVideo:fp};_d.pc.createAnswer(pp).then(function(mp){return np(mp)}).catch(function(mp){return ap(mp)})}}})},rp.prototype.processLocalOffer=function(_d){var np=this;return new Promise(function(ap,sp){np.pc.setLocalDescription(_d).then(function(){var lp=np.pc.localDescription;return lp?(logger$5.debug("Local description set",lp.sdp),ap()):sp("Local description is not defined")}).catch(function(lp){return sp(lp)})})},rp.prototype.processRemoteOffer=function(_d){var np=this;return new Promise(function(ap,sp){var lp={type:"offer",sdp:_d};if(logger$5.debug("SDP offer received, setting remote description",lp),np.pc.signalingState==="closed")return sp("RTCPeerConnection is closed when trying to set remote description");np.setRemoteDescription(lp).then(function(){return ap()}).catch(function(up){return sp(up)})})},rp.prototype.processLocalAnswer=function(_d){var np=this;return new Promise(function(ap,sp){if(logger$5.debug("SDP answer created, setting local description"),np.pc.signalingState==="closed")return sp("RTCPeerConnection is closed when trying to set local description");np.pc.setLocalDescription(_d).then(function(){return ap()}).catch(function(lp){return sp(lp)})})},rp.prototype.processRemoteAnswer=function(_d){var np=this;return new Promise(function(ap,sp){var lp={type:"answer",sdp:_d};if(logger$5.debug("SDP answer received, setting remote description"),np.pc.signalingState==="closed")return sp("RTCPeerConnection is closed when trying to set remote description");np.setRemoteDescription(lp).then(function(){ap()}).catch(function(up){return sp(up)})})},rp.prototype.setRemoteDescription=function(_d){return __awaiter$3(this,void 0,void 0,function(){return __generator$3(this,function(np){return[2,this.pc.setRemoteDescription(_d)]})})},rp.prototype.addIceCandidate=function(_d){var np=this;return new Promise(function(ap,sp){switch(logger$5.debug("Remote ICE candidate received",_d),np.remoteCandidatesQueue.push(_d),np.pc.signalingState){case"closed":sp(new Error("PeerConnection object is closed"));break;case"stable":np.pc.remoteDescription?np.pc.addIceCandidate(_d).then(function(){return ap()}).catch(function(lp){return sp(lp)}):(np.iceCandidateList.push(_d),ap());break;default:np.iceCandidateList.push(_d),ap()}})},rp.prototype.addIceConnectionStateChangeListener=function(_d){var np=this;this.pc.addEventListener("iceconnectionstatechange",function(){var ap=np.pc.iceConnectionState;switch(ap){case"disconnected":var sp="IceConnectionState of RTCPeerConnection "+np.configuration.id+" ("+_d+') change to "disconnected". Possible network disconnection';logger$5.warn(sp),np.configuration.onIceConnectionStateException(ExceptionEvent_1$2.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,sp);break;case"failed":var lp="IceConnectionState of RTCPeerConnection "+np.configuration.id+" ("+_d+') to "failed"';logger$5.error(lp),np.configuration.onIceConnectionStateException(ExceptionEvent_1$2.ExceptionEventName.ICE_CONNECTION_FAILED,lp);break;case"closed":logger$5.log("IceConnectionState of RTCPeerConnection "+np.configuration.id+" ("+_d+') change to "closed"');break;case"new":logger$5.log("IceConnectionState of RTCPeerConnection "+np.configuration.id+" ("+_d+') change to "new"');break;case"checking":logger$5.log("IceConnectionState of RTCPeerConnection "+np.configuration.id+" ("+_d+') change to "checking"');break;case"connected":logger$5.log("IceConnectionState of RTCPeerConnection "+np.configuration.id+" ("+_d+') change to "connected"');break;case"completed":logger$5.log("IceConnectionState of RTCPeerConnection "+np.configuration.id+" ("+_d+') change to "completed"');break}})},rp.prototype.generateUniqueId=function(){return(0,uuid_1$1.v4)()},rp}();WebRtcPeer$1.WebRtcPeer=WebRtcPeer;var WebRtcPeerRecvonly=function(rp){__extends$9(_d,rp);function _d(np){return np.mode="recvonly",rp.call(this,np)||this}return _d}(WebRtcPeer);WebRtcPeer$1.WebRtcPeerRecvonly=WebRtcPeerRecvonly;var WebRtcPeerSendonly=function(rp){__extends$9(_d,rp);function _d(np){return np.mode="sendonly",rp.call(this,np)||this}return _d}(WebRtcPeer);WebRtcPeer$1.WebRtcPeerSendonly=WebRtcPeerSendonly;var WebRtcPeerSendrecv=function(rp){__extends$9(_d,rp);function _d(np){return np.mode="sendrecv",rp.call(this,np)||this}return _d}(WebRtcPeer);WebRtcPeer$1.WebRtcPeerSendrecv=WebRtcPeerSendrecv;var WebRtcStats$1={},__awaiter$2=commonjsGlobal&&commonjsGlobal.__awaiter||function(rp,_d,np,ap){function sp(lp){return lp instanceof np?lp:new np(function(up){up(lp)})}return new(np||(np=Promise))(function(lp,up){function cp(fp){try{hp(ap.next(fp))}catch(pp){up(pp)}}function dp(fp){try{hp(ap.throw(fp))}catch(pp){up(pp)}}function hp(fp){fp.done?lp(fp.value):sp(fp.value).then(cp,dp)}hp((ap=ap.apply(rp,_d||[])).next())})},__generator$2=commonjsGlobal&&commonjsGlobal.__generator||function(rp,_d){var np={label:0,sent:function(){if(lp[0]&1)throw lp[1];return lp[1]},trys:[],ops:[]},ap,sp,lp,up;return up={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(up[Symbol.iterator]=function(){return this}),up;function cp(hp){return function(fp){return dp([hp,fp])}}function dp(hp){if(ap)throw new TypeError("Generator is already executing.");for(;up&&(up=0,hp[0]&&(np=0)),np;)try{if(ap=1,sp&&(lp=hp[0]&2?sp.return:hp[0]?sp.throw||((lp=sp.return)&&lp.call(sp),0):sp.next)&&!(lp=lp.call(sp,hp[1])).done)return lp;switch(sp=0,lp&&(hp=[hp[0]&2,lp.value]),hp[0]){case 0:case 1:lp=hp;break;case 4:return np.label++,{value:hp[1],done:!1};case 5:np.label++,sp=hp[1],hp=[0];continue;case 7:hp=np.ops.pop(),np.trys.pop();continue;default:if(lp=np.trys,!(lp=lp.length>0&&lp[lp.length-1])&&(hp[0]===6||hp[0]===2)){np=0;continue}if(hp[0]===3&&(!lp||hp[1]>lp[0]&&hp[1]<lp[3])){np.label=hp[1];break}if(hp[0]===6&&np.label<lp[1]){np.label=lp[1],lp=hp;break}if(lp&&np.label<lp[2]){np.label=lp[2],np.ops.push(hp);break}lp[2]&&np.ops.pop(),np.trys.pop();continue}hp=_d.call(rp,np)}catch(fp){hp=[6,fp],sp=0}finally{ap=lp=0}if(hp[0]&5)throw hp[1];return{value:hp[0]?hp[1]:void 0,done:!0}}};Object.defineProperty(WebRtcStats$1,"__esModule",{value:!0});WebRtcStats$1.WebRtcStats=void 0;var OpenViduLogger_1$4=OpenViduLogger$1,Platform_1$2=Platform,logger$4=OpenViduLogger_1$4.OpenViduLogger.getInstance(),platform$2,WebRtcStats=function(){function rp(_d){this.stream=_d,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,platform$2=Platform_1$2.PlatformUtils.getInstance()}return rp.prototype.isEnabled=function(){return this.webRtcStatsEnabled},rp.prototype.initWebRtcStats=function(){var _d=this,np;try{np=localStorage.getItem(this.STATS_ITEM_NAME)}catch{}if(np){this.webRtcStatsEnabled=!0;var ap=JSON.parse(np);logger$4.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),logger$4.warn("localStorage item: "+JSON.stringify(ap)),this.POST_URL=ap.httpEndpoint,this.statsInterval=ap.interval,this.webRtcStatsIntervalId=setInterval(function(){return __awaiter$2(_d,void 0,void 0,function(){return __generator$2(this,function(sp){switch(sp.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return sp.sent(),[2]}})})},this.statsInterval*1e3)}else logger$4.debug("WebRtc stats not enabled")},rp.prototype.getSelectedIceCandidateInfo=function(){var _d=this;return new Promise(function(np,ap){return __awaiter$2(_d,void 0,void 0,function(){var sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p,vp,Ap,Rp,bp,Ep,Op,Sp,Ap,Rp,Tp,Mp,Op;return __generator$2(this,function(Pp){switch(Pp.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(sp=Pp.sent(),up=new Map,cp=new Map,dp=new Map,sp.forEach(function($p){switch($p.type==="transport"&&(platform$2.isChromium()||platform$2.isSafariBrowser()||platform$2.isReactNative())&&(lp=$p),$p.type){case"candidate-pair":up.set($p.id,$p);break;case"local-candidate":cp.set($p.id,$p);break;case"remote-candidate":dp.set($p.id,$p);break}}),lp!=null)fp=lp.selectedCandidatePairId,hp=up.get(fp);else for(pp=up.size,mp=up.values(),gp=0;gp<pp;gp++)if(yp=mp.next().value,yp.selected){hp=yp;break}if(xp=hp.localCandidateId,_p=hp.remoteCandidateId,vp=cp.get(xp),vp)for(Ap=this.stream.getLocalIceCandidateList(),Rp=Ap.filter(function($p){return!!$p.candidate&&($p.candidate.indexOf(vp.ip)>=0||$p.candidate.indexOf(vp.address)>=0)&&$p.candidate.indexOf(vp.port)>=0}),vp.raw=[],bp=0,Ep=Rp;bp<Ep.length;bp++)Op=Ep[bp],vp.raw.push(Op.candidate);else vp="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(Sp=dp.get(_p),Sp)for(Ap=this.stream.getRemoteIceCandidateList(),Rp=Ap.filter(function($p){return!!$p.candidate&&($p.candidate.indexOf(Sp.ip)>=0||$p.candidate.indexOf(Sp.address)>=0)&&$p.candidate.indexOf(Sp.port)>=0}),Sp.raw=[],Tp=0,Mp=Rp;Tp<Mp.length;Tp++)Op=Mp[Tp],Sp.raw.push(Op.candidate);else Sp="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return[2,np({localCandidate:vp,remoteCandidate:Sp})]}})})})},rp.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),logger$4.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},rp.prototype.sendStats=function(_d,np){return __awaiter$2(this,void 0,void 0,function(){var ap,sp;return __generator$2(this,function(lp){switch(lp.label){case 0:return lp.trys.push([0,2,,3]),ap={headers:{"Content-type":"application/json"},body:JSON.stringify(np),method:"POST"},[4,fetch(_d,ap)];case 1:return lp.sent(),[3,3];case 2:return sp=lp.sent(),logger$4.error("sendStats error: ".concat(JSON.stringify(sp))),[3,3];case 3:return[2]}})})},rp.prototype.sendStatsToHttpEndpoint=function(){return __awaiter$2(this,void 0,void 0,function(){var _d,np,ap;return __generator$2(this,function(sp){switch(sp.label){case 0:return sp.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return _d=sp.sent(),np=this.generateJSONStatsResponse(_d),[4,this.sendStats(this.POST_URL,np)];case 2:return sp.sent(),[3,4];case 3:return ap=sp.sent(),logger$4.log(ap),[3,4];case 4:return[2]}})})},rp.prototype.getCommonStats=function(){return __awaiter$2(this,void 0,void 0,function(){var _d=this;return __generator$2(this,function(np){return[2,new Promise(function(ap,sp){return __awaiter$2(_d,void 0,void 0,function(){var lp,up,cp,dp,hp,fp=this;return __generator$2(this,function(pp){switch(pp.label){case 0:return pp.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return lp=pp.sent(),up=this.getWebRtcStatsResponseOutline(),cp=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],dp=["availableOutgoingBitrate","currentRoundTripTime"],lp.forEach(function(mp){var gp=mp.mediaType!=null?mp.mediaType:mp.kind,yp=function(xp,_p){mp[_p]!=null&&up[xp]!=null&&(!gp&&cp.indexOf(_p)>-1&&(gp="video"),xp!=null&&gp!=null&&_p!=null&&up[xp][gp]!=null?up[xp][gp][_p]=Number(mp[_p]):xp!=null&&_p!=null&&dp.includes(_p)&&(up[xp][_p]=Number(mp[_p])))};switch(mp.type){case"outbound-rtp":yp("outbound","bytesSent"),yp("outbound","packetsSent"),yp("outbound","framesEncoded"),yp("outbound","nackCount"),yp("outbound","firCount"),yp("outbound","pliCount"),yp("outbound","qpSum");break;case"inbound-rtp":yp("inbound","bytesReceived"),yp("inbound","packetsReceived"),yp("inbound","packetsLost"),yp("inbound","jitter"),yp("inbound","framesDecoded"),yp("inbound","nackCount"),yp("inbound","firCount"),yp("inbound","pliCount");break;case"track":yp("inbound","jitterBufferDelay"),yp("inbound","framesReceived"),yp("outbound","framesDropped"),yp("outbound","framesSent"),yp(fp.stream.isLocal()?"outbound":"inbound","frameHeight"),yp(fp.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":yp("candidatepair","currentRoundTripTime"),yp("candidatepair","availableOutgoingBitrate");break}}),(!(up!=null&&up.candidatepair)||Object.keys(up.candidatepair).length===0)&&delete up.candidatepair,[2,ap(up)];case 2:return hp=pp.sent(),logger$4.error("Error getting common stats: ",hp),[2,sp(hp)];case 3:return[2]}})})})]})})},rp.prototype.generateJSONStatsResponse=function(_d){return{"@timestamp":new Date().toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:platform$2.getName(),platform_description:platform$2.getDescription(),stream:"webRTC",webrtc_stats:_d}},rp.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},rp}();WebRtcStats$1.WebRtcStats=WebRtcStats;var PublisherSpeakingEvent$1={},__extends$8=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(PublisherSpeakingEvent$1,"__esModule",{value:!0});PublisherSpeakingEvent$1.PublisherSpeakingEvent=void 0;var Event_1$8=Event$2,PublisherSpeakingEvent=function(rp){__extends$8(_d,rp);function _d(np,ap,sp,lp){var up=rp.call(this,!1,np,ap)||this;return up.type=ap,up.connection=sp,up.streamId=lp,up}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$8.Event);PublisherSpeakingEvent$1.PublisherSpeakingEvent=PublisherSpeakingEvent;var TypeOfVideo={};(function(rp){Object.defineProperty(rp,"__esModule",{value:!0}),rp.TypeOfVideo=void 0,function(_d){_d.CAMERA="CAMERA",_d.SCREEN="SCREEN",_d.CUSTOM="CUSTOM",_d.IPCAM="IPCAM"}(rp.TypeOfVideo||(rp.TypeOfVideo={}))})(TypeOfVideo);var wildemitter=WildEmitter$1;function WildEmitter$1(){}WildEmitter$1.mixin=function(rp){var _d=rp.prototype||rp;_d.isWildEmitter=!0,_d.on=function(np,ap,sp){this.callbacks=this.callbacks||{};var lp=arguments.length===3,up=lp?arguments[1]:void 0,cp=lp?arguments[2]:arguments[1];return cp._groupName=up,(this.callbacks[np]=this.callbacks[np]||[]).push(cp),this},_d.once=function(np,ap,sp){var lp=this,up=arguments.length===3,cp=up?arguments[1]:void 0,dp=up?arguments[2]:arguments[1];function hp(){lp.off(np,hp),dp.apply(this,arguments)}return this.on(np,cp,hp),this},_d.releaseGroup=function(np){this.callbacks=this.callbacks||{};var ap,sp,lp,up;for(ap in this.callbacks)for(up=this.callbacks[ap],sp=0,lp=up.length;sp<lp;sp++)up[sp]._groupName===np&&(up.splice(sp,1),sp--,lp--);return this},_d.off=function(np,ap){this.callbacks=this.callbacks||{};var sp=this.callbacks[np],lp;return sp?arguments.length===1?(delete this.callbacks[np],this):(lp=sp.indexOf(ap),lp!==-1&&(sp.splice(lp,1),sp.length===0&&delete this.callbacks[np]),this):this},_d.emit=function(np){this.callbacks=this.callbacks||{};var ap=[].slice.call(arguments,1),sp=this.callbacks[np],lp=this.getWildcardCallbacks(np),up,cp,dp;if(sp)for(dp=sp.slice(),up=0,cp=dp.length;up<cp&&dp[up];++up)dp[up].apply(this,ap);if(lp)for(cp=lp.length,dp=lp.slice(),up=0,cp=dp.length;up<cp&&dp[up];++up)dp[up].apply(this,[np].concat(ap));return this},_d.getWildcardCallbacks=function(np){this.callbacks=this.callbacks||{};var ap,sp,lp=[];for(ap in this.callbacks)sp=ap.split("*"),(ap==="*"||sp.length===2&&np.slice(0,sp[0].length)===sp[0])&&(lp=lp.concat(this.callbacks[ap]));return lp}};WildEmitter$1.mixin(WildEmitter$1);var WildEmitter=wildemitter;function getMaxVolume(rp,_d){var np=-1/0;rp.getFloatFrequencyData(_d);for(var ap=4,sp=_d.length;ap<sp;ap++)_d[ap]>np&&_d[ap]<0&&(np=_d[ap]);return np}var audioContextType;typeof window<"u"&&(audioContextType=window.AudioContext||window.webkitAudioContext);var audioContext=null,hark$1=function(rp,ap){var np=new WildEmitter;if(!audioContextType)return np;var ap=ap||{},sp=ap.smoothing||.1,lp=ap.interval||50,up=ap.threshold,cp=ap.play,dp=ap.history||10,hp=!0;audioContext=ap.audioContext||audioContext||new audioContextType;var fp,pp,mp;mp=audioContext.createAnalyser(),mp.fftSize=512,mp.smoothingTimeConstant=sp,pp=new Float32Array(mp.frequencyBinCount),rp.jquery&&(rp=rp[0]),rp instanceof HTMLAudioElement||rp instanceof HTMLVideoElement?(fp=audioContext.createMediaElementSource(rp),typeof cp>"u"&&(cp=!0),up=up||-50):(fp=audioContext.createMediaStreamSource(rp),up=up||-50),fp.connect(mp),cp&&mp.connect(audioContext.destination),np.speaking=!1,np.suspend=function(){return audioContext.suspend()},np.resume=function(){return audioContext.resume()},Object.defineProperty(np,"state",{get:function(){return audioContext.state}}),audioContext.onstatechange=function(){np.emit("state_change",audioContext.state)},np.setThreshold=function(xp){up=xp},np.setInterval=function(xp){lp=xp},np.stop=function(){hp=!1,np.emit("volume_change",-100,up),np.speaking&&(np.speaking=!1,np.emit("stopped_speaking")),mp.disconnect(),fp.disconnect()},np.speakingHistory=[];for(var gp=0;gp<dp;gp++)np.speakingHistory.push(0);var yp=function(){setTimeout(function(){if(hp){var xp=getMaxVolume(mp,pp);np.emit("volume_change",xp,up);var _p=0;if(xp>up&&!np.speaking){for(var vp=np.speakingHistory.length-3;vp<np.speakingHistory.length;vp++)_p+=np.speakingHistory[vp];_p>=2&&(np.speaking=!0,np.emit("speaking"))}else if(xp<up&&np.speaking){for(var vp=0;vp<np.speakingHistory.length;vp++)_p+=np.speakingHistory[vp];_p==0&&(np.speaking=!1,np.emit("stopped_speaking"))}np.speakingHistory.shift(),np.speakingHistory.push(0+(xp>up)),yp()}},lp)};return yp(),np},__awaiter$1=commonjsGlobal&&commonjsGlobal.__awaiter||function(rp,_d,np,ap){function sp(lp){return lp instanceof np?lp:new np(function(up){up(lp)})}return new(np||(np=Promise))(function(lp,up){function cp(fp){try{hp(ap.next(fp))}catch(pp){up(pp)}}function dp(fp){try{hp(ap.throw(fp))}catch(pp){up(pp)}}function hp(fp){fp.done?lp(fp.value):sp(fp.value).then(cp,dp)}hp((ap=ap.apply(rp,_d||[])).next())})},__generator$1=commonjsGlobal&&commonjsGlobal.__generator||function(rp,_d){var np={label:0,sent:function(){if(lp[0]&1)throw lp[1];return lp[1]},trys:[],ops:[]},ap,sp,lp,up;return up={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(up[Symbol.iterator]=function(){return this}),up;function cp(hp){return function(fp){return dp([hp,fp])}}function dp(hp){if(ap)throw new TypeError("Generator is already executing.");for(;up&&(up=0,hp[0]&&(np=0)),np;)try{if(ap=1,sp&&(lp=hp[0]&2?sp.return:hp[0]?sp.throw||((lp=sp.return)&&lp.call(sp),0):sp.next)&&!(lp=lp.call(sp,hp[1])).done)return lp;switch(sp=0,lp&&(hp=[hp[0]&2,lp.value]),hp[0]){case 0:case 1:lp=hp;break;case 4:return np.label++,{value:hp[1],done:!1};case 5:np.label++,sp=hp[1],hp=[0];continue;case 7:hp=np.ops.pop(),np.trys.pop();continue;default:if(lp=np.trys,!(lp=lp.length>0&&lp[lp.length-1])&&(hp[0]===6||hp[0]===2)){np=0;continue}if(hp[0]===3&&(!lp||hp[1]>lp[0]&&hp[1]<lp[3])){np.label=hp[1];break}if(hp[0]===6&&np.label<lp[1]){np.label=lp[1],lp=hp;break}if(lp&&np.label<lp[2]){np.label=lp[2],np.ops.push(hp);break}lp[2]&&np.ops.pop(),np.trys.pop();continue}hp=_d.call(rp,np)}catch(fp){hp=[6,fp],sp=0}finally{ap=lp=0}if(hp[0]&5)throw hp[1];return{value:hp[0]?hp[1]:void 0,done:!0}}};Object.defineProperty(Stream$1,"__esModule",{value:!0});Stream$1.Stream=void 0;var Filter_1=Filter$1,Subscriber_1=Subscriber$1,WebRtcPeer_1=WebRtcPeer$1,WebRtcStats_1=WebRtcStats$1,ExceptionEvent_1$1=ExceptionEvent,PublisherSpeakingEvent_1=PublisherSpeakingEvent$1,StreamManagerEvent_1=StreamManagerEvent$1,StreamPropertyChangedEvent_1$1=StreamPropertyChangedEvent$1,OpenViduError_1$1=OpenViduError,TypeOfVideo_1=TypeOfVideo,OpenViduLogger_1$3=OpenViduLogger$1,Platform_1$1=Platform,uuid_1=commonjsBrowser,hark=hark$1,EventEmitter$2=EventEmitterExports,logger$3=OpenViduLogger_1$3.OpenViduLogger.getInstance(),platform$1,Stream=function(){function rp(_d,np){var ap=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new EventEmitter$2,platform$1=Platform_1$1.PlatformUtils.getInstance(),this.session=_d,np.hasOwnProperty("id")?(this.inboundStreamOpts=np,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=this.inboundStreamOpts.frameRate===-1?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length===0&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=np,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,typeof MediaStreamTrack<"u"&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo=TypeOfVideo_1.TypeOfVideo.CUSTOM:this.typeOfVideo=this.isSendScreen()?TypeOfVideo_1.TypeOfVideo.SCREEN:TypeOfVideo_1.TypeOfVideo.CAMERA),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",function(){var sp;ap.streamManager.updateMediaStream(ap.mediaStream),logger$3.debug("Video srcObject ["+((sp=ap.mediaStream)===null||sp===void 0?void 0:sp.id)+"] updated in stream ["+ap.streamId+"]")})}return rp.prototype.reconnect=function(){return this.reconnectStream("API")},rp.prototype.applyFilter=function(_d,np){var ap=this;return new Promise(function(sp,lp){return __awaiter$1(ap,void 0,void 0,function(){var up,cp,dp,hp,fp,pp,mp=this;return __generator$1(this,function(gp){if(this.filter)return[2,lp(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.GENERIC_ERROR,"There is already a filter applied to Stream "+this.streamId))];if(up=function(yp,xp){if(yp)return logger$3.error("Error applying filter for Stream "+mp.streamId,yp),yp.code===401?lp(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):lp(yp);logger$3.info("Filter successfully applied on Stream "+mp.streamId);var _p=mp.filter;return mp.filter=new Filter_1.Filter(_d,np),mp.filter.stream=mp,xp&&(mp.session.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1$1.StreamPropertyChangedEvent(mp.session,mp,"filter",mp.filter,_p,"applyFilter")]),mp.streamManager.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1$1.StreamPropertyChangedEvent(mp.streamManager,mp,"filter",mp.filter,_p,"applyFilter")])),sp(mp.filter)},_d.startsWith("VB:")){if(!this.hasVideo)return[2,lp(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The Virtual Background filter requires a video track to be applied"))];if(!this.mediaStream||this.streamManager.videos.length===0)return[2,lp(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The StreamManager requires some video element to be attached to it in order to apply a Virtual Background filter"))];if(this.session.token?cp=this.session.token:cp=np.token,!cp)return[2,lp(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Virtual Background requires the client to be connected to a Session or to have a "token" property available in "options" parameter with a valid OpenVidu token'))];if(dp=this.session.getTokenParams(cp),dp.edition!=="pro"&&dp.edition!=="enterprise")return[2,lp(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"OpenVidu Virtual Background API is available from OpenVidu Pro edition onwards"))];cp=encodeURIComponent(btoa(cp)),logger$3.info("Applying Virtual Background to stream "+this.streamId),hp=function(){return __awaiter$1(mp,void 0,void 0,function(){var yp,xp,_p,vp,bp,Ep,Sp;return __generator$1(this,function(Ap){switch(Ap.label){case 0:return Ap.trys.push([0,8,,9]),yp=this.streamId+"_"+(0,uuid_1.v4)(),xp=this.mediaStream.clone(),_p=this.streamManager.videos[0].video.cloneNode(!1),_p.id=VirtualBackground.VirtualBackground.SOURCE_VIDEO_PREFIX+yp,_p.srcObject=xp,_p.muted=!0,this.virtualBackgroundSourceElements={videoClone:_p,mediaStreamClone:xp},VirtualBackground.VirtualBackground.hideHtmlElement(_p,!1),VirtualBackground.VirtualBackground.appendHtmlElementToHiddenContainer(_p,yp),[4,_p.play()];case 1:switch(Ap.sent(),vp=new VirtualBackground.VirtualBackground({id:yp,openviduServerUrl:new URL(dp.httpUri),openviduToken:cp,inputVideo:_p,inputResolution:"160x96",outputFramerate:24}),bp=void 0,Ep=_d,Ep){case"VB:blur":return[3,2];case"VB:image":return[3,4]}return[3,6];case 2:return[4,vp.backgroundBlur(np)];case 3:return bp=Ap.sent(),[3,7];case 4:return[4,vp.backgroundImage(np)];case 5:return bp=Ap.sent(),[3,7];case 6:throw new Error("Unknown Virtual Background filter: "+_d);case 7:return this.virtualBackgroundSinkElements={VB:vp,video:bp},_p.style.display="none",this.streamManager.remote?this.streamManager.replaceTrackInMediaStream(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1):this.streamManager.replaceTrackAux(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1),up(void 0,!1),[3,9];case 8:return Sp=Ap.sent(),Sp.name===OpenViduError_1$1.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?up(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,Sp.message),!1):up(Sp,!1),[3,9];case 9:return[2]}})})},typeof VirtualBackground>"u"?(fp=document.createElement("script"),fp.type="text/javascript",fp.src=dp.httpUri+"/openvidu/virtual-background/openvidu-virtual-background.js?token="+cp,fp.onload=function(){return __awaiter$1(mp,void 0,void 0,function(){var yp;return __generator$1(this,function(xp){switch(xp.label){case 0:return xp.trys.push([0,2,,3]),[4,hp()];case 1:return xp.sent(),sp(new Filter_1.Filter(_d,np)),[3,3];case 2:return yp=xp.sent(),lp(yp),[3,3];case 3:return[2]}})})},document.body.appendChild(fp)):hp().then(function(){return sp(new Filter_1.Filter(_d,np))}).catch(function(yp){return lp(yp)})}else{if(!this.session.sessionConnected())return[2,lp(this.session.notConnectedError())];logger$3.info("Applying server filter to stream "+this.streamId),np=np??{},pp=np,typeof pp!="string"&&(pp=JSON.stringify(pp)),this.session.openvidu.sendRequest("applyFilter",{streamId:this.streamId,type:_d,options:pp},function(yp,xp){up(yp,!0)})}return[2]})})})},rp.prototype.removeFilter=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(_d){switch(_d.label){case 0:return[4,this.removeFilterAux(!1)];case 1:return[2,_d.sent()]}})})},rp.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},rp.prototype.getMediaStream=function(){return this.mediaStream},rp.prototype.removeFilterAux=function(_d){var np=this;return new Promise(function(ap,sp){return __awaiter$1(np,void 0,void 0,function(){var lp,up,cp,dp=this,hp;return __generator$1(this,function(fp){switch(fp.label){case 0:if(lp=function(pp,mp){if(pp)return delete dp.filter,logger$3.error("Error removing filter for Stream "+dp.streamId,pp),pp.code===401?sp(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):sp(pp);logger$3.info("Filter successfully removed from Stream "+dp.streamId);var gp=dp.filter;return delete dp.filter,mp&&(dp.session.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1$1.StreamPropertyChangedEvent(dp.session,dp,"filter",dp.filter,gp,"applyFilter")]),dp.streamManager.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1$1.StreamPropertyChangedEvent(dp.streamManager,dp,"filter",dp.filter,gp,"applyFilter")])),ap()},!this.filter)return[3,11];if(!(!((hp=this.filter)===null||hp===void 0)&&hp.type.startsWith("VB:")))return[3,9];fp.label=1;case 1:return fp.trys.push([1,7,,8]),up=this.virtualBackgroundSourceElements.mediaStreamClone,_d?[3,5]:this.streamManager.remote?(this.streamManager.replaceTrackInMediaStream(up.getVideoTracks()[0],!1),[3,4]):[3,2];case 2:return[4,this.streamManager.replaceTrackAux(up.getVideoTracks()[0],!1)];case 3:fp.sent(),fp.label=4;case 4:return[3,6];case 5:up.getTracks().forEach(function(pp){return pp.stop()}),fp.label=6;case 6:return this.virtualBackgroundSinkElements.VB.cleanUp(),delete this.virtualBackgroundSinkElements,delete this.virtualBackgroundSourceElements,[2,lp(void 0,!1)];case 7:return cp=fp.sent(),[2,lp(cp,!1)];case 8:return[3,10];case 9:if(!this.session.sessionConnected())return[2,sp(this.session.notConnectedError())];logger$3.info("Removing filter of stream "+this.streamId),this.session.openvidu.sendRequest("removeFilter",{streamId:this.streamId},function(pp,mp){return lp(pp,!0)}),fp.label=10;case 10:return[3,12];case 11:return[2,sp(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.GENERIC_ERROR,"Stream "+this.streamId+" has no filter applied"))];case 12:return[2]}})})})},rp.prototype.setMediaStream=function(_d){this.mediaStream=_d},rp.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},rp.prototype.getWebRtcPeer=function(){return this.webRtcPeer},rp.prototype.subscribeToMyRemote=function(_d){this.isSubscribeToRemote=_d},rp.prototype.setOutboundStreamOptions=function(_d){this.outboundStreamOpts=_d},rp.prototype.subscribe=function(){var _d=this;return new Promise(function(np,ap){_d.initWebRtcPeerReceive(!1).then(function(){return np()}).catch(function(sp){return ap(sp)})})},rp.prototype.publish=function(){var _d=this;return new Promise(function(np,ap){_d.isLocalStreamReadyToPublish?_d.initWebRtcPeerSend(!1).then(function(){return np()}).catch(function(sp){return ap(sp)}):_d.ee.once("stream-ready-to-publish",function(){_d.publish().then(function(){return np()}).catch(function(sp){return ap(sp)})})})},rp.prototype.disposeWebRtcPeer=function(){var _d;this.webRtcPeer&&(this.webRtcPeer.dispose(),_d=this.webRtcPeer.getId()),this.stopWebRtcStats(),logger$3.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+_d+"] from 'Stream' with id ["+this.streamId+"] is now closed")},rp.prototype.disposeMediaStream=function(){return __awaiter$1(this,void 0,void 0,function(){var _d;return __generator$1(this,function(np){switch(np.label){case 0:if(!(this.filter&&this.filter.type.startsWith("VB:")))return[3,4];np.label=1;case 1:return np.trys.push([1,3,,4]),[4,this.removeFilterAux(!0)];case 2:return np.sent(),console.debug("Success removing Virtual Background filter for stream ".concat(this.streamId)),[3,4];case 3:return _d=np.sent(),console.error("Error removing Virtual Background filter for stream ".concat(this.streamId),_d),[3,4];case 4:return this.mediaStream&&(this.mediaStream.getAudioTracks().forEach(function(ap){ap.stop()}),this.mediaStream.getVideoTracks().forEach(function(ap){ap.stop()}),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach(function(ap){ap.stop()}),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach(function(ap){ap.stop()}),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),logger$3.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed"),[2]}})})},rp.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},rp.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&this.outboundStreamOpts.publisherProperties.audioSource!==null&&this.outboundStreamOpts.publisherProperties.audioSource!==!1},rp.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&this.outboundStreamOpts.publisherProperties.videoSource!==null&&this.outboundStreamOpts.publisherProperties.videoSource!==!1},rp.prototype.isSendScreen=function(){var _d=!1;if(typeof MediaStreamTrack<"u"&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack){var np=this.outboundStreamOpts.publisherProperties.videoSource.getSettings();np.displaySurface&&(_d=["monitor","window","browser"].includes(np.displaySurface))}return!_d&&platform$1.isElectron()&&(_d=typeof this.outboundStreamOpts.publisherProperties.videoSource=="string"&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),_d||(_d=this.outboundStreamOpts.publisherProperties.videoSource==="screen"),!!this.outboundStreamOpts&&_d},rp.prototype.enableHarkSpeakingEvent=function(){var _d=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabled&&this.speechEvent&&(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",function(){_d.session.emitEvent("publisherStartSpeaking",[new PublisherSpeakingEvent_1.PublisherSpeakingEvent(_d.session,"publisherStartSpeaking",_d.connection,_d.streamId)]),_d.streamManager.emitEvent("publisherStartSpeaking",[new PublisherSpeakingEvent_1.PublisherSpeakingEvent(_d.streamManager,"publisherStartSpeaking",_d.connection,_d.streamId)]),_d.harkSpeakingEnabledOnce=!1}))},rp.prototype.enableOnceHarkSpeakingEvent=function(){var _d=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabledOnce&&this.speechEvent&&(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",function(){_d.harkSpeakingEnabledOnce&&(_d.session.emitEvent("publisherStartSpeaking",[new PublisherSpeakingEvent_1.PublisherSpeakingEvent(_d.session,"publisherStartSpeaking",_d.connection,_d.streamId)]),_d.streamManager.emitEvent("publisherStartSpeaking",[new PublisherSpeakingEvent_1.PublisherSpeakingEvent(_d.streamManager,"publisherStartSpeaking",_d.connection,_d.streamId)])),_d.disableHarkSpeakingEvent(!0)}))},rp.prototype.disableHarkSpeakingEvent=function(_d){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,_d){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},rp.prototype.enableHarkStoppedSpeakingEvent=function(){var _d=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabled&&this.speechEvent&&(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",function(){_d.session.emitEvent("publisherStopSpeaking",[new PublisherSpeakingEvent_1.PublisherSpeakingEvent(_d.session,"publisherStopSpeaking",_d.connection,_d.streamId)]),_d.streamManager.emitEvent("publisherStopSpeaking",[new PublisherSpeakingEvent_1.PublisherSpeakingEvent(_d.streamManager,"publisherStopSpeaking",_d.connection,_d.streamId)]),_d.harkStoppedSpeakingEnabledOnce=!1}))},rp.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var _d=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabledOnce&&this.speechEvent&&(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",function(){_d.harkStoppedSpeakingEnabledOnce&&(_d.session.emitEvent("publisherStopSpeaking",[new PublisherSpeakingEvent_1.PublisherSpeakingEvent(_d.session,"publisherStopSpeaking",_d.connection,_d.streamId)]),_d.streamManager.emitEvent("publisherStopSpeaking",[new PublisherSpeakingEvent_1.PublisherSpeakingEvent(_d.streamManager,"publisherStopSpeaking",_d.connection,_d.streamId)])),_d.disableHarkStoppedSpeakingEvent(!0)}))},rp.prototype.disableHarkStoppedSpeakingEvent=function(_d){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,_d){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},rp.prototype.enableHarkVolumeChangeEvent=function(_d){var np=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabled||_d)&&(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",function(ap){var sp=np.speechEvent.oldVolumeValue,lp={newValue:ap,oldValue:sp};np.speechEvent.oldVolumeValue=ap,np.streamManager.emitEvent("streamAudioVolumeChange",[new StreamManagerEvent_1.StreamManagerEvent(np.streamManager,"streamAudioVolumeChange",lp)])})):this.harkVolumeChangeEnabled=!0},rp.prototype.enableOnceHarkVolumeChangeEvent=function(_d){var np=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabledOnce||_d)&&(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",function(ap){var sp=np.speechEvent.oldVolumeValue,lp={newValue:ap,oldValue:sp};np.speechEvent.oldVolumeValue=ap,np.disableHarkVolumeChangeEvent(!0),np.streamManager.emitEvent("streamAudioVolumeChange",[new StreamManagerEvent_1.StreamManagerEvent(np.streamManager,"streamAudioVolumeChange",lp)])})):this.harkVolumeChangeEnabledOnce=!0},rp.prototype.disableHarkVolumeChangeEvent=function(_d){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,_d){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},rp.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},rp.prototype.getSelectedIceCandidate=function(){var _d=this;return new Promise(function(np,ap){_d.webRtcStats.getSelectedIceCandidateInfo().then(function(sp){return np(sp)}).catch(function(sp){return ap(sp)})})},rp.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},rp.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},rp.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return logger$3.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '.concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") will force a reconnection")),!0;var _d=this.getRTCPeerConnection().iceConnectionState;return _d!=="connected"&&_d!=="completed"},rp.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var _d=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};_d.interval=typeof _d.interval=="number"?_d.interval:100,_d.threshold=typeof _d.threshold=="number"?_d.threshold:-50,this.speechEvent=hark(this.mediaStream,_d)}return!0}return!1},rp.prototype.setupReconnectionEventEmitter=function(_d,np){return this.reconnectionEventEmitter==null?(this.reconnectionEventEmitter=new EventEmitter$2,!1):(console.warn("Trying to reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but an ongoing reconnection process is active. Waiting for response...")),this.reconnectionEventEmitter.once("success",function(){return _d()}),this.reconnectionEventEmitter.once("error",function(ap){return np(ap)}),!0)},rp.prototype.initWebRtcPeerSend=function(_d){var np=this;return new Promise(function(ap,sp){var lp;if(_d){if(np.setupReconnectionEventEmitter(ap,sp))return}else np.initHarkEvents();var up=function(){var fp;return _d&&((fp=np.reconnectionEventEmitter)===null||fp===void 0||fp.emitEvent("success"),delete np.reconnectionEventEmitter),ap()},cp=function(fp){var pp;return _d&&((pp=np.reconnectionEventEmitter)===null||pp===void 0||pp.emitEvent("error",[fp]),delete np.reconnectionEventEmitter),sp(fp)},dp=function(fp){logger$3.debug("Sending SDP offer to publish as "+np.streamId,fp);var pp=_d?"reconnectStream":"publishVideo",mp;if(_d)mp={stream:np.streamId,sdpString:fp};else{var gp=void 0;np.isSendVideo()&&(gp=typeof MediaStreamTrack<"u"&&np.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?TypeOfVideo_1.TypeOfVideo.CUSTOM:np.isSendScreen()?TypeOfVideo_1.TypeOfVideo.SCREEN:TypeOfVideo_1.TypeOfVideo.CAMERA),mp={doLoopback:np.displayMyRemote()||!1,hasAudio:np.isSendAudio(),hasVideo:np.isSendVideo(),audioActive:np.audioActive,videoActive:np.videoActive,typeOfVideo:gp,frameRate:np.frameRate?np.frameRate:-1,videoDimensions:JSON.stringify(np.videoDimensions),filter:np.outboundStreamOpts.publisherProperties.filter,sdpOffer:fp}}np.session.openvidu.sendRequest(pp,mp,function(yp,xp){yp?yp.code===401?cp(new OpenViduError_1$1.OpenViduError(OpenViduError_1$1.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):cp("Error on publishVideo: "+JSON.stringify(yp)):np.webRtcPeer.processRemoteAnswer(xp.sdpAnswer).then(function(){np.streamId=xp.id,np.creationTime=xp.createdAt,np.isLocalStreamPublished=!0,np.publishedOnce=!0,np.displayMyRemote()&&(np.localMediaStreamWhenSubscribedToRemote=np.mediaStream,np.remotePeerSuccessfullyEstablished(_d)),_d?np.ee.emitEvent("stream-reconnected-by-publisher",[]):np.ee.emitEvent("stream-created-by-publisher",[]),np.initWebRtcStats(),logger$3.info("'Publisher' ("+np.streamId+") successfully "+(_d?"reconnected":"published")+" to session"),up()}).catch(function(_p){cp(_p)})})},hp={mediaConstraints:{audio:np.hasAudio,video:np.hasVideo},simulcast:(lp=np.outboundStreamOpts.publisherProperties.videoSimulcast)!==null&&lp!==void 0?lp:np.session.openvidu.videoSimulcast,onIceCandidate:np.connection.sendIceCandidate.bind(np.connection),onIceConnectionStateException:np.onIceConnectionStateExceptionHandler.bind(np),iceServers:np.getIceServersConf(),mediaStream:np.mediaStream,mediaServer:np.session.openvidu.mediaServer,typeOfVideo:np.typeOfVideo?TypeOfVideo_1.TypeOfVideo[np.typeOfVideo]:void 0};np.session.openvidu.mediaServer!=="mediasoup"&&(hp.simulcast=!1),_d&&np.disposeWebRtcPeer(),np.displayMyRemote()?np.webRtcPeer=new WebRtcPeer_1.WebRtcPeerSendrecv(hp):np.webRtcPeer=new WebRtcPeer_1.WebRtcPeerSendonly(hp),np.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+np.connection.connectionId),np.webRtcPeer.createOffer().then(function(fp){np.webRtcPeer.processLocalOffer(fp).then(function(){dp(fp.sdp)}).catch(function(pp){cp(new Error("(publish) SDP process local offer error: "+JSON.stringify(pp)))})}).catch(function(fp){cp(new Error("(publish) SDP create offer error: "+JSON.stringify(fp)))})})},rp.prototype.finalResolveForSubscription=function(_d,np){var ap;return logger$3.info("'Subscriber' ("+this.streamId+") successfully "+(_d?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(_d),this.initWebRtcStats(),_d&&((ap=this.reconnectionEventEmitter)===null||ap===void 0||ap.emitEvent("success"),delete this.reconnectionEventEmitter),np()},rp.prototype.finalRejectForSubscription=function(_d,np,ap){var sp;return logger$3.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(_d?"reconnect":"subscribe")+": "+np.toString()),_d&&((sp=this.reconnectionEventEmitter)===null||sp===void 0||sp.emitEvent("error",[np]),delete this.reconnectionEventEmitter),ap(np)},rp.prototype.initWebRtcPeerReceive=function(_d){var np=this;return new Promise(function(ap,sp){_d&&np.setupReconnectionEventEmitter(ap,sp)||(np.session.openvidu.mediaServer==="mediasoup"?np.initWebRtcPeerReceiveFromServer(_d).then(function(){return np.finalResolveForSubscription(_d,ap)}).catch(function(lp){return np.finalRejectForSubscription(_d,lp,sp)}):np.initWebRtcPeerReceiveFromClient(_d).then(function(){return np.finalResolveForSubscription(_d,ap)}).catch(function(lp){return np.finalRejectForSubscription(_d,lp,sp)}))})},rp.prototype.initWebRtcPeerReceiveFromClient=function(_d){var np=this;return new Promise(function(ap,sp){np.completeWebRtcPeerReceive(_d,!1).then(function(lp){np.webRtcPeer.processRemoteAnswer(lp.sdpAnswer).then(function(){return ap()}).catch(function(up){return sp(up)})}).catch(function(lp){return sp(lp)})})},rp.prototype.initWebRtcPeerReceiveFromServer=function(_d){var np=this;return new Promise(function(ap,sp){np.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:np.streamId,reconnect:_d},function(lp,up){if(lp)return sp(new Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(lp)));np.completeWebRtcPeerReceive(_d,!1,up.sdpOffer).then(function(){return ap()}).catch(function(cp){return sp(cp)})})})},rp.prototype.completeWebRtcPeerReceive=function(_d,np,ap){var sp=this;return new Promise(function(lp,up){logger$3.debug("'Session.subscribe(Stream)' called");var cp=function(hp){logger$3.debug("Sending local SDP ".concat(ap?"answer":"offer"," to subscribe to ").concat(sp.streamId),hp);var fp=_d?"reconnectStream":"receiveVideoFrom",pp={};pp[_d?"stream":"sender"]=sp.streamId,ap?pp[_d?"sdpString":"sdpAnswer"]=hp:pp.sdpOffer=hp,_d&&(pp.forciblyReconnect=np),sp.session.openvidu.sendRequest(fp,pp,function(mp,gp){return mp?up(new Error("Error on "+fp+" : "+JSON.stringify(mp))):lp(gp)})},dp={mediaConstraints:{audio:sp.hasAudio,video:sp.hasVideo},simulcast:!1,onIceCandidate:sp.connection.sendIceCandidate.bind(sp.connection),onIceConnectionStateException:sp.onIceConnectionStateExceptionHandler.bind(sp),iceServers:sp.getIceServersConf(),mediaServer:sp.session.openvidu.mediaServer,typeOfVideo:sp.typeOfVideo?TypeOfVideo_1.TypeOfVideo[sp.typeOfVideo]:void 0};_d&&sp.disposeWebRtcPeer(),sp.webRtcPeer=new WebRtcPeer_1.WebRtcPeerRecvonly(dp),sp.webRtcPeer.addIceConnectionStateChangeListener(sp.streamId),ap?sp.webRtcPeer.processRemoteOffer(ap).then(function(){sp.webRtcPeer.createAnswer().then(function(hp){sp.webRtcPeer.processLocalAnswer(hp).then(function(){cp(hp.sdp)}).catch(function(fp){return up(new Error("(subscribe) SDP process local answer error: "+JSON.stringify(fp)))})}).catch(function(hp){return up(new Error("(subscribe) SDP create answer error: "+JSON.stringify(hp)))})}).catch(function(hp){return up(new Error("(subscribe) SDP process remote offer error: "+JSON.stringify(hp)))}):sp.webRtcPeer.createOffer().then(function(hp){sp.webRtcPeer.processLocalOffer(hp).then(function(){cp(hp.sdp)}).catch(function(fp){return up(new Error("(subscribe) SDP process local offer error: "+JSON.stringify(fp)))})}).catch(function(hp){return up(new Error("(subscribe) SDP create offer error: "+JSON.stringify(hp)))})})},rp.prototype.remotePeerSuccessfullyEstablished=function(_d){_d&&this.mediaStream!=null&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var np,ap=0,sp=this.webRtcPeer.pc.getReceivers();ap<sp.length;ap++)np=sp[ap],np.track&&this.mediaStream.addTrack(np.track);if(logger$3.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof Subscriber_1.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var lp=_d?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=lp}if(this.mediaStream.getVideoTracks()[0]){var lp=_d?this.videoActive:!!this.videoActive&&!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=lp}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},rp.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},rp.prototype.onIceConnectionStateExceptionHandler=function(_d,np,ap){switch(_d){case ExceptionEvent_1$1.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case ExceptionEvent_1$1.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected();break}this.session.emitEvent("exception",[new ExceptionEvent_1$1.ExceptionEvent(this.session,_d,this,np,ap)])},rp.prototype.onIceConnectionFailed=function(){logger$3.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",")")),this.reconnectStreamAndLogResultingIceConnectionState(ExceptionEvent_1$1.ExceptionEventName.ICE_CONNECTION_FAILED)},rp.prototype.onIceConnectionDisconnected=function(){var _d=this;logger$3.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") if not possible"));var np=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(np).then(function(ap){switch(ap){case"failed":logger$3.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(_d.streamId," (").concat(_d.isLocal()?"Publisher":"Subscriber",") is now failed after ICE_CONNECTION_DISCONNECTED"));break;case"connected":case"completed":logger$3.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(_d.streamId," (").concat(_d.isLocal()?"Publisher":"Subscriber",") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: ").concat(ap));break;case"closed":case"checking":case"new":case"disconnected":logger$3.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(_d.streamId," (").concat(_d.isLocal()?"Publisher":"Subscriber",") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after ").concat(np," ms: ").concat(ap)),_d.reconnectStreamAndLogResultingIceConnectionState(ExceptionEvent_1$1.ExceptionEventName.ICE_CONNECTION_DISCONNECTED);break}})},rp.prototype.reconnectStreamAndLogResultingIceConnectionState=function(_d){return __awaiter$1(this,void 0,void 0,function(){var np,ap;return __generator$1(this,function(sp){switch(sp.label){case 0:return sp.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(_d)];case 1:switch(np=sp.sent(),np){case"connected":case"completed":logger$3.log("[".concat(_d,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") successfully reconnected after ").concat(_d,". Current ICE connection state: ").concat(np));break;default:logger$3.error("[".concat(_d,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") failed to reconnect after ").concat(_d,". Current ICE connection state: ").concat(np));break}return[3,3];case 2:return ap=sp.sent(),logger$3.error("[".concat(_d,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after ").concat(_d,": ").concat(ap)),[3,3];case 3:return[2]}})})},rp.prototype.reconnectStreamAndReturnIceConnectionState=function(_d){return __awaiter$1(this,void 0,void 0,function(){var np,ap;return __generator$1(this,function(sp){switch(sp.label){case 0:logger$3.log("[".concat(_d,"] Reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after event ").concat(_d)),sp.label=1;case 1:return sp.trys.push([1,3,,4]),[4,this.reconnectStream(_d)];case 2:return sp.sent(),np=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(np)];case 3:return ap=sp.sent(),logger$3.warn("[".concat(_d,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber","). Reason: ").concat(ap)),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}})})},rp.prototype.awaitWebRtcPeerConnectionState=function(_d){return __awaiter$1(this,void 0,void 0,function(){var np,ap,sp,lp;return __generator$1(this,function(up){switch(up.label){case 0:np=this.getRTCPeerConnection().iceConnectionState,ap=150,sp=Math.ceil(_d/ap),lp=0,up.label=1;case 1:return lp<sp?(np=this.getRTCPeerConnection().iceConnectionState,np==="connected"||np==="completed"?[3,4]:[4,new Promise(function(cp){return setTimeout(cp,ap)})]):[3,4];case 2:up.sent(),up.label=3;case 3:return lp++,[3,1];case 4:return[2,np]}})})},rp.prototype.reconnectStream=function(_d){return __awaiter$1(this,void 0,void 0,function(){var np,ap;return __generator$1(this,function(sp){switch(sp.label){case 0:return[4,this.isWebsocketConnected(_d,3e3)];case 1:if(np=sp.sent(),np)return logger$3.log("[".concat(_d,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") and the websocket is opened")),this.isLocal()?[2,this.initWebRtcPeerSend(!0)]:[2,this.initWebRtcPeerReceive(!0)];throw ap="[".concat(_d,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but the websocket wasn't opened"),logger$3.error(ap),Error(ap)}})})},rp.prototype.isWebsocketConnected=function(_d,np){var ap=this;return new Promise(function(sp,lp){var up=ap.session.openvidu.getWsReadyState();if(up===1){var cp=setTimeout(function(){return console.warn("[".concat(_d,"] Websocket timeout of ").concat(np,"ms")),sp(!1)},np);ap.session.openvidu.sendRequest("echo",{},function(dp,hp){return clearTimeout(cp),dp?(console.warn("[".concat(_d,"] Websocket 'echo' returned error: ").concat(dp)),sp(!1)):sp(!0)})}else return console.warn("[".concat(_d,"] Websocket readyState is ").concat(up)),sp(!1)})},rp.prototype.initWebRtcStats=function(){this.webRtcStats=new WebRtcStats_1.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},rp.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},rp.prototype.getIceServersConf=function(){var _d;return this.session.openvidu.advancedConfiguration.iceServers?_d=this.session.openvidu.advancedConfiguration.iceServers==="freeice"?void 0:this.session.openvidu.advancedConfiguration.iceServers:this.session.openvidu.iceServers?_d=this.session.openvidu.iceServers:_d=void 0,_d},rp.prototype.gatherStatsForPeer=function(){var _d=this;return new Promise(function(np,ap){_d.isLocal()?_d.getRTCPeerConnection().getSenders().forEach(function(sp){return sp.getStats().then(function(lp){lp.forEach(function(up){if(_d.isReportWanted(up)){var cp={};cp.type=up.type,cp.timestamp=up.timestamp,cp.id=up.id,up.type==="outbound-rtp"&&(cp.ssrc=up.ssrc,cp.firCount=up.firCount,cp.pliCount=up.pliCount,cp.nackCount=up.nackCount,cp.qpSum=up.qpSum,up.kind?cp.mediaType=up.kind:up.mediaType?cp.mediaType=up.mediaType:cp.mediaType=up.id.indexOf("VideoStream")!==-1?"video":"audio",cp.mediaType==="video"&&(cp.framesEncoded=up.framesEncoded),cp.packetsSent=up.packetsSent,cp.bytesSent=up.bytesSent),up.type==="candidate-pair"&&up.totalRoundTripTime!==void 0&&(cp.availableOutgoingBitrate=up.availableOutgoingBitrate,cp.rtt=up.currentRoundTripTime,cp.averageRtt=up.totalRoundTripTime/up.responsesReceived),up.type==="remote-inbound-rtp"||up.type,logger$3.log(cp)}})})}):_d.getRTCPeerConnection().getReceivers().forEach(function(sp){return sp.getStats().then(function(lp){lp.forEach(function(up){if(_d.isReportWanted(up)){var cp={};cp.type=up.type,cp.timestamp=up.timestamp,cp.id=up.id,up.type==="inbound-rtp"&&(cp.ssrc=up.ssrc,cp.firCount=up.firCount,cp.pliCount=up.pliCount,cp.nackCount=up.nackCount,cp.qpSum=up.qpSum,up.kind?cp.mediaType=up.kind:up.mediaType?cp.mediaType=up.mediaType:cp.mediaType=up.id.indexOf("VideoStream")!==-1?"video":"audio",cp.mediaType==="video"&&(cp.framesDecoded=up.framesDecoded),cp.packetsReceived=up.packetsReceived,cp.packetsLost=up.packetsLost,cp.jitter=up.jitter,cp.bytesReceived=up.bytesReceived),up.type==="candidate-pair"&&up.totalRoundTripTime!==void 0&&(cp.availableIncomingBitrate=up.availableIncomingBitrate,cp.rtt=up.currentRoundTripTime,cp.averageRtt=up.totalRoundTripTime/up.responsesReceived),up.type==="remote-inbound-rtp"||up.type,logger$3.log(cp)}})})})})},rp.prototype.isReportWanted=function(_d){return _d.type==="inbound-rtp"&&!this.isLocal()||_d.type==="outbound-rtp"&&this.isLocal()||_d.type==="candidate-pair"&&_d.nominated&&_d.bytesSent>0},rp}();Stream$1.Stream=Stream;Object.defineProperty(Connection$1,"__esModule",{value:!0});Connection$1.Connection=void 0;var Stream_1=Stream$1,OpenViduLogger_1$2=OpenViduLogger$1,ExceptionEvent_1=ExceptionEvent,logger$2=OpenViduLogger_1$2.OpenViduLogger.getInstance(),Connection=function(){function rp(_d,np){this.session=_d,this.disposed=!1;var ap="'Connection' created ";np.role?(this.localOptions=np,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,ap+="(local)"):(this.remoteOptions=np,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),ap+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),logger$2.info(ap)}return rp.prototype.sendIceCandidate=function(_d){var np=this;this.disposed?logger$2.warn("Connection ".concat(this.connectionId," disposed when trying to send an ICE candidate. ICE candidate not sent")):(logger$2.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,_d),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:_d.candidate,sdpMid:_d.sdpMid,sdpMLineIndex:_d.sdpMLineIndex},function(ap,sp){ap&&(logger$2.error("Error sending ICE candidate: "+JSON.stringify(ap)),np.session.emitEvent("exception",[new ExceptionEvent_1.ExceptionEvent(np.session,ExceptionEvent_1.ExceptionEventName.ICE_CANDIDATE_ERROR,np.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",ap)]))}))},rp.prototype.initRemoteStreams=function(_d){var np=this;_d.forEach(function(ap){var sp={id:ap.id,createdAt:ap.createdAt,connection:np,hasAudio:ap.hasAudio,hasVideo:ap.hasVideo,audioActive:ap.audioActive,videoActive:ap.videoActive,typeOfVideo:ap.typeOfVideo,frameRate:ap.frameRate,videoDimensions:ap.videoDimensions?JSON.parse(ap.videoDimensions):void 0,filter:ap.filter?ap.filter:void 0},lp=new Stream_1.Stream(np.session,sp);np.addStream(lp)}),logger$2.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},rp.prototype.addStream=function(_d){_d.connection=this,this.stream=_d},rp.prototype.removeStream=function(){delete this.stream},rp.prototype.dispose=function(){this.disposed=!0,this.removeStream()},rp}();Connection$1.Connection=Connection;var ConnectionEvent$1={},__extends$7=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(ConnectionEvent$1,"__esModule",{value:!0});ConnectionEvent$1.ConnectionEvent=void 0;var Event_1$7=Event$2,ConnectionEvent=function(rp){__extends$7(_d,rp);function _d(np,ap,sp,lp,up){var cp=rp.call(this,np,ap,sp)||this;return cp.connection=lp,cp.reason=up,cp}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$7.Event);ConnectionEvent$1.ConnectionEvent=ConnectionEvent;var FilterEvent$1={},__extends$6=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(FilterEvent$1,"__esModule",{value:!0});FilterEvent$1.FilterEvent=void 0;var Event_1$6=Event$2,FilterEvent=function(rp){__extends$6(_d,rp);function _d(np,ap,sp){var lp=rp.call(this,!1,np,ap)||this;return lp.data=sp,lp}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$6.Event);FilterEvent$1.FilterEvent=FilterEvent;var RecordingEvent$1={},__extends$5=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(RecordingEvent$1,"__esModule",{value:!0});RecordingEvent$1.RecordingEvent=void 0;var Event_1$5=Event$2,RecordingEvent=function(rp){__extends$5(_d,rp);function _d(np,ap,sp,lp,up){var cp=rp.call(this,!1,np,ap)||this;return cp.id=sp,lp!==sp&&(cp.name=lp),cp.reason=up,cp}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$5.Event);RecordingEvent$1.RecordingEvent=RecordingEvent;var SessionDisconnectedEvent$1={},__extends$4=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(SessionDisconnectedEvent$1,"__esModule",{value:!0});SessionDisconnectedEvent$1.SessionDisconnectedEvent=void 0;var Event_1$4=Event$2,OpenViduLogger_1$1=OpenViduLogger$1,logger$1=OpenViduLogger_1$1.OpenViduLogger.getInstance(),SessionDisconnectedEvent=function(rp){__extends$4(_d,rp);function _d(np,ap){var sp=rp.call(this,!0,np,"sessionDisconnected")||this;return sp.reason=ap,sp}return _d.prototype.callDefaultBehavior=function(){logger$1.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var np=this.target;np.remoteConnections.forEach(function(ap){var sp,lp,up,cp,dp,hp,fp,pp,mp=ap.connectionId;if(!((sp=np.remoteConnections.get(mp))===null||sp===void 0)&&sp.stream){(lp=np.remoteConnections.get(mp))===null||lp===void 0||lp.stream.disposeWebRtcPeer(),(up=np.remoteConnections.get(mp))===null||up===void 0||up.stream.disposeMediaStream(),!((cp=np.remoteConnections.get(mp))===null||cp===void 0)&&cp.stream.streamManager&&((dp=np.remoteConnections.get(mp))===null||dp===void 0||dp.stream.streamManager.removeAllVideos());var gp=(fp=(hp=np.remoteConnections.get(mp))===null||hp===void 0?void 0:hp.stream)===null||fp===void 0?void 0:fp.streamId;gp&&np.remoteStreamsCreated.delete(gp),(pp=np.remoteConnections.get(mp))===null||pp===void 0||pp.dispose()}np.remoteConnections.delete(mp)})},_d}(Event_1$4.Event);SessionDisconnectedEvent$1.SessionDisconnectedEvent=SessionDisconnectedEvent;var SignalEvent$1={},__extends$3=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(SignalEvent$1,"__esModule",{value:!0});SignalEvent$1.SignalEvent=void 0;var Event_1$3=Event$2,SignalEvent=function(rp){__extends$3(_d,rp);function _d(np,ap,sp,lp){var up=rp.call(this,!1,np,"signal")||this;return ap&&(up.type="signal:"+ap),up.data=sp,up.from=lp,up}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$3.Event);SignalEvent$1.SignalEvent=SignalEvent;var SpeechToTextEvent$1={},__extends$2=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(SpeechToTextEvent$1,"__esModule",{value:!0});SpeechToTextEvent$1.SpeechToTextEvent=void 0;var Event_1$2=Event$2,SpeechToTextEvent=function(rp){__extends$2(_d,rp);function _d(np,ap,sp,lp,up,cp){var dp=rp.call(this,!1,np,"speechToTextMessage")||this;return dp.connection=ap,dp.text=sp,dp.reason=lp,dp.raw=up,dp.lang=cp,dp}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$2.Event);SpeechToTextEvent$1.SpeechToTextEvent=SpeechToTextEvent;var StreamEvent={},hasRequiredStreamEvent;function requireStreamEvent(){if(hasRequiredStreamEvent)return StreamEvent;hasRequiredStreamEvent=1;var rp=commonjsGlobal&&commonjsGlobal.__extends||function(){var cp=function(dp,hp){return cp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(fp,pp){fp.__proto__=pp}||function(fp,pp){for(var mp in pp)Object.prototype.hasOwnProperty.call(pp,mp)&&(fp[mp]=pp[mp])},cp(dp,hp)};return function(dp,hp){if(typeof hp!="function"&&hp!==null)throw new TypeError("Class extends value "+String(hp)+" is not a constructor or null");cp(dp,hp);function fp(){this.constructor=dp}dp.prototype=hp===null?Object.create(hp):(fp.prototype=hp.prototype,new fp)}}();Object.defineProperty(StreamEvent,"__esModule",{value:!0}),StreamEvent.StreamEvent=void 0;var _d=Event$2,np=requirePublisher(),ap=requireSession(),sp=OpenViduLogger$1,lp=sp.OpenViduLogger.getInstance(),up=function(cp){rp(dp,cp);function dp(hp,fp,pp,mp,gp){var yp=cp.call(this,hp,fp,pp)||this;return yp.stream=mp,yp.reason=gp,yp}return dp.prototype.callDefaultBehavior=function(){if(this.type==="streamDestroyed"){if(this.target instanceof ap.Session)lp.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof np.Publisher){lp.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var hp=this.target.openvidu.publishers,fp=0;fp<hp.length;fp++)if(hp[fp]===this.target){hp.splice(fp,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var pp=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(pp&&pp.remoteOptions)for(var mp=pp.remoteOptions.streams,fp=mp.length-1;fp>=0;--fp)mp[fp].id===this.stream.streamId&&mp.splice(fp,1)}},dp}(_d.Event);return StreamEvent.StreamEvent=up,StreamEvent}var ConnectionPropertyChangedEvent$1={},__extends$1=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(ConnectionPropertyChangedEvent$1,"__esModule",{value:!0});ConnectionPropertyChangedEvent$1.ConnectionPropertyChangedEvent=void 0;var Event_1$1=Event$2,ConnectionPropertyChangedEvent=function(rp){__extends$1(_d,rp);function _d(np,ap,sp,lp,up){var cp=rp.call(this,!1,np,"connectionPropertyChanged")||this;return cp.connection=ap,cp.changedProperty=sp,cp.newValue=lp,cp.oldValue=up,cp}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1$1.Event);ConnectionPropertyChangedEvent$1.ConnectionPropertyChangedEvent=ConnectionPropertyChangedEvent;var NetworkQualityLevelChangedEvent$1={},__extends=commonjsGlobal&&commonjsGlobal.__extends||function(){var rp=function(_d,np){return rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ap,sp){ap.__proto__=sp}||function(ap,sp){for(var lp in sp)Object.prototype.hasOwnProperty.call(sp,lp)&&(ap[lp]=sp[lp])},rp(_d,np)};return function(_d,np){if(typeof np!="function"&&np!==null)throw new TypeError("Class extends value "+String(np)+" is not a constructor or null");rp(_d,np);function ap(){this.constructor=_d}_d.prototype=np===null?Object.create(np):(ap.prototype=np.prototype,new ap)}}();Object.defineProperty(NetworkQualityLevelChangedEvent$1,"__esModule",{value:!0});NetworkQualityLevelChangedEvent$1.NetworkQualityLevelChangedEvent=void 0;var Event_1=Event$2,NetworkQualityLevelChangedEvent=function(rp){__extends(_d,rp);function _d(np,ap,sp,lp){var up=rp.call(this,!1,np,"networkQualityLevelChanged")||this;return up.newValue=ap,up.oldValue=sp,up.connection=lp,up}return _d.prototype.callDefaultBehavior=function(){},_d}(Event_1.Event);NetworkQualityLevelChangedEvent$1.NetworkQualityLevelChangedEvent=NetworkQualityLevelChangedEvent;var define_process_env_default={};const debug$1=typeof process=="object"&&define_process_env_default&&define_process_env_default.NODE_DEBUG&&/\bsemver\b/i.test(define_process_env_default.NODE_DEBUG)?(...rp)=>console.error("SEMVER",...rp):()=>{};var debug_1=debug$1;const SEMVER_SPEC_VERSION="2.0.0",MAX_LENGTH$1=256,MAX_SAFE_INTEGER$1=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16;var constants$1={SEMVER_SPEC_VERSION,MAX_LENGTH:MAX_LENGTH$1,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER$1,MAX_SAFE_COMPONENT_LENGTH},re$1={exports:{}};(function(rp,_d){const{MAX_SAFE_COMPONENT_LENGTH:np}=constants$1,ap=debug_1;_d=rp.exports={};const sp=_d.re=[],lp=_d.src=[],up=_d.t={};let cp=0;const dp=(hp,fp,pp)=>{const mp=cp++;ap(hp,mp,fp),up[hp]=mp,lp[mp]=fp,sp[mp]=new RegExp(fp,pp?"g":void 0)};dp("NUMERICIDENTIFIER","0|[1-9]\\d*"),dp("NUMERICIDENTIFIERLOOSE","[0-9]+"),dp("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),dp("MAINVERSION",`(${lp[up.NUMERICIDENTIFIER]})\\.(${lp[up.NUMERICIDENTIFIER]})\\.(${lp[up.NUMERICIDENTIFIER]})`),dp("MAINVERSIONLOOSE",`(${lp[up.NUMERICIDENTIFIERLOOSE]})\\.(${lp[up.NUMERICIDENTIFIERLOOSE]})\\.(${lp[up.NUMERICIDENTIFIERLOOSE]})`),dp("PRERELEASEIDENTIFIER",`(?:${lp[up.NUMERICIDENTIFIER]}|${lp[up.NONNUMERICIDENTIFIER]})`),dp("PRERELEASEIDENTIFIERLOOSE",`(?:${lp[up.NUMERICIDENTIFIERLOOSE]}|${lp[up.NONNUMERICIDENTIFIER]})`),dp("PRERELEASE",`(?:-(${lp[up.PRERELEASEIDENTIFIER]}(?:\\.${lp[up.PRERELEASEIDENTIFIER]})*))`),dp("PRERELEASELOOSE",`(?:-?(${lp[up.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${lp[up.PRERELEASEIDENTIFIERLOOSE]})*))`),dp("BUILDIDENTIFIER","[0-9A-Za-z-]+"),dp("BUILD",`(?:\\+(${lp[up.BUILDIDENTIFIER]}(?:\\.${lp[up.BUILDIDENTIFIER]})*))`),dp("FULLPLAIN",`v?${lp[up.MAINVERSION]}${lp[up.PRERELEASE]}?${lp[up.BUILD]}?`),dp("FULL",`^${lp[up.FULLPLAIN]}$`),dp("LOOSEPLAIN",`[v=\\s]*${lp[up.MAINVERSIONLOOSE]}${lp[up.PRERELEASELOOSE]}?${lp[up.BUILD]}?`),dp("LOOSE",`^${lp[up.LOOSEPLAIN]}$`),dp("GTLT","((?:<|>)?=?)"),dp("XRANGEIDENTIFIERLOOSE",`${lp[up.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),dp("XRANGEIDENTIFIER",`${lp[up.NUMERICIDENTIFIER]}|x|X|\\*`),dp("XRANGEPLAIN",`[v=\\s]*(${lp[up.XRANGEIDENTIFIER]})(?:\\.(${lp[up.XRANGEIDENTIFIER]})(?:\\.(${lp[up.XRANGEIDENTIFIER]})(?:${lp[up.PRERELEASE]})?${lp[up.BUILD]}?)?)?`),dp("XRANGEPLAINLOOSE",`[v=\\s]*(${lp[up.XRANGEIDENTIFIERLOOSE]})(?:\\.(${lp[up.XRANGEIDENTIFIERLOOSE]})(?:\\.(${lp[up.XRANGEIDENTIFIERLOOSE]})(?:${lp[up.PRERELEASELOOSE]})?${lp[up.BUILD]}?)?)?`),dp("XRANGE",`^${lp[up.GTLT]}\\s*${lp[up.XRANGEPLAIN]}$`),dp("XRANGELOOSE",`^${lp[up.GTLT]}\\s*${lp[up.XRANGEPLAINLOOSE]}$`),dp("COERCE",`(^|[^\\d])(\\d{1,${np}})(?:\\.(\\d{1,${np}}))?(?:\\.(\\d{1,${np}}))?(?:$|[^\\d])`),dp("COERCERTL",lp[up.COERCE],!0),dp("LONETILDE","(?:~>?)"),dp("TILDETRIM",`(\\s*)${lp[up.LONETILDE]}\\s+`,!0),_d.tildeTrimReplace="$1~",dp("TILDE",`^${lp[up.LONETILDE]}${lp[up.XRANGEPLAIN]}$`),dp("TILDELOOSE",`^${lp[up.LONETILDE]}${lp[up.XRANGEPLAINLOOSE]}$`),dp("LONECARET","(?:\\^)"),dp("CARETTRIM",`(\\s*)${lp[up.LONECARET]}\\s+`,!0),_d.caretTrimReplace="$1^",dp("CARET",`^${lp[up.LONECARET]}${lp[up.XRANGEPLAIN]}$`),dp("CARETLOOSE",`^${lp[up.LONECARET]}${lp[up.XRANGEPLAINLOOSE]}$`),dp("COMPARATORLOOSE",`^${lp[up.GTLT]}\\s*(${lp[up.LOOSEPLAIN]})$|^$`),dp("COMPARATOR",`^${lp[up.GTLT]}\\s*(${lp[up.FULLPLAIN]})$|^$`),dp("COMPARATORTRIM",`(\\s*)${lp[up.GTLT]}\\s*(${lp[up.LOOSEPLAIN]}|${lp[up.XRANGEPLAIN]})`,!0),_d.comparatorTrimReplace="$1$2$3",dp("HYPHENRANGE",`^\\s*(${lp[up.XRANGEPLAIN]})\\s+-\\s+(${lp[up.XRANGEPLAIN]})\\s*$`),dp("HYPHENRANGELOOSE",`^\\s*(${lp[up.XRANGEPLAINLOOSE]})\\s+-\\s+(${lp[up.XRANGEPLAINLOOSE]})\\s*$`),dp("STAR","(<|>)?=?\\s*\\*"),dp("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),dp("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(re$1,re$1.exports);var reExports=re$1.exports;const opts=["includePrerelease","loose","rtl"],parseOptions$1=rp=>rp?typeof rp!="object"?{loose:!0}:opts.filter(_d=>rp[_d]).reduce((_d,np)=>(_d[np]=!0,_d),{}):{};var parseOptions_1=parseOptions$1;const numeric=/^[0-9]+$/,compareIdentifiers$1=(rp,_d)=>{const np=numeric.test(rp),ap=numeric.test(_d);return np&&ap&&(rp=+rp,_d=+_d),rp===_d?0:np&&!ap?-1:ap&&!np?1:rp<_d?-1:1},rcompareIdentifiers=(rp,_d)=>compareIdentifiers$1(_d,rp);var identifiers={compareIdentifiers:compareIdentifiers$1,rcompareIdentifiers};const debug=debug_1,{MAX_LENGTH,MAX_SAFE_INTEGER}=constants$1,{re,t}=reExports,parseOptions=parseOptions_1,{compareIdentifiers}=identifiers;let SemVer$2=class Ny{constructor(_d,np){if(np=parseOptions(np),_d instanceof Ny){if(_d.loose===!!np.loose&&_d.includePrerelease===!!np.includePrerelease)return _d;_d=_d.version}else if(typeof _d!="string")throw new TypeError(`Invalid Version: ${_d}`);if(_d.length>MAX_LENGTH)throw new TypeError(`version is longer than ${MAX_LENGTH} characters`);debug("SemVer",_d,np),this.options=np,this.loose=!!np.loose,this.includePrerelease=!!np.includePrerelease;const ap=_d.trim().match(np.loose?re[t.LOOSE]:re[t.FULL]);if(!ap)throw new TypeError(`Invalid Version: ${_d}`);if(this.raw=_d,this.major=+ap[1],this.minor=+ap[2],this.patch=+ap[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError("Invalid major version");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError("Invalid patch version");ap[4]?this.prerelease=ap[4].split(".").map(sp=>{if(/^[0-9]+$/.test(sp)){const lp=+sp;if(lp>=0&&lp<MAX_SAFE_INTEGER)return lp}return sp}):this.prerelease=[],this.build=ap[5]?ap[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(_d){if(debug("SemVer.compare",this.version,this.options,_d),!(_d instanceof Ny)){if(typeof _d=="string"&&_d===this.version)return 0;_d=new Ny(_d,this.options)}return _d.version===this.version?0:this.compareMain(_d)||this.comparePre(_d)}compareMain(_d){return _d instanceof Ny||(_d=new Ny(_d,this.options)),compareIdentifiers(this.major,_d.major)||compareIdentifiers(this.minor,_d.minor)||compareIdentifiers(this.patch,_d.patch)}comparePre(_d){if(_d instanceof Ny||(_d=new Ny(_d,this.options)),this.prerelease.length&&!_d.prerelease.length)return-1;if(!this.prerelease.length&&_d.prerelease.length)return 1;if(!this.prerelease.length&&!_d.prerelease.length)return 0;let np=0;do{const ap=this.prerelease[np],sp=_d.prerelease[np];if(debug("prerelease compare",np,ap,sp),ap===void 0&&sp===void 0)return 0;if(sp===void 0)return 1;if(ap===void 0)return-1;if(ap===sp)continue;return compareIdentifiers(ap,sp)}while(++np)}compareBuild(_d){_d instanceof Ny||(_d=new Ny(_d,this.options));let np=0;do{const ap=this.build[np],sp=_d.build[np];if(debug("prerelease compare",np,ap,sp),ap===void 0&&sp===void 0)return 0;if(sp===void 0)return 1;if(ap===void 0)return-1;if(ap===sp)continue;return compareIdentifiers(ap,sp)}while(++np)}inc(_d,np){switch(_d){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",np);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",np);break;case"prepatch":this.prerelease.length=0,this.inc("patch",np),this.inc("pre",np);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",np),this.inc("pre",np);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let ap=this.prerelease.length;for(;--ap>=0;)typeof this.prerelease[ap]=="number"&&(this.prerelease[ap]++,ap=-2);ap===-1&&this.prerelease.push(0)}np&&(compareIdentifiers(this.prerelease[0],np)===0?isNaN(this.prerelease[1])&&(this.prerelease=[np,0]):this.prerelease=[np,0]);break;default:throw new Error(`invalid increment argument: ${_d}`)}return this.format(),this.raw=this.version,this}};var semver=SemVer$2;const SemVer$1=semver,major=(rp,_d)=>new SemVer$1(rp,_d).major;var major_1=major;const SemVer=semver,minor=(rp,_d)=>new SemVer(rp,_d).minor;var minor_1=minor,hasRequiredSession;function requireSession(){if(hasRequiredSession)return Session;hasRequiredSession=1;var rp=commonjsGlobal&&commonjsGlobal.__extends||function(){var $p=function(zp,Dp){return $p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Fp,jp){Fp.__proto__=jp}||function(Fp,jp){for(var Lp in jp)Object.prototype.hasOwnProperty.call(jp,Lp)&&(Fp[Lp]=jp[Lp])},$p(zp,Dp)};return function(zp,Dp){if(typeof Dp!="function"&&Dp!==null)throw new TypeError("Class extends value "+String(Dp)+" is not a constructor or null");$p(zp,Dp);function Fp(){this.constructor=zp}zp.prototype=Dp===null?Object.create(Dp):(Fp.prototype=Dp.prototype,new Fp)}}(),_d=commonjsGlobal&&commonjsGlobal.__awaiter||function($p,zp,Dp,Fp){function jp(Lp){return Lp instanceof Dp?Lp:new Dp(function(Bp){Bp(Lp)})}return new(Dp||(Dp=Promise))(function(Lp,Bp){function Ip(Gp){try{Up(Fp.next(Gp))}catch(Wp){Bp(Wp)}}function kp(Gp){try{Up(Fp.throw(Gp))}catch(Wp){Bp(Wp)}}function Up(Gp){Gp.done?Lp(Gp.value):jp(Gp.value).then(Ip,kp)}Up((Fp=Fp.apply($p,zp||[])).next())})},np=commonjsGlobal&&commonjsGlobal.__generator||function($p,zp){var Dp={label:0,sent:function(){if(Lp[0]&1)throw Lp[1];return Lp[1]},trys:[],ops:[]},Fp,jp,Lp,Bp;return Bp={next:Ip(0),throw:Ip(1),return:Ip(2)},typeof Symbol=="function"&&(Bp[Symbol.iterator]=function(){return this}),Bp;function Ip(Up){return function(Gp){return kp([Up,Gp])}}function kp(Up){if(Fp)throw new TypeError("Generator is already executing.");for(;Bp&&(Bp=0,Up[0]&&(Dp=0)),Dp;)try{if(Fp=1,jp&&(Lp=Up[0]&2?jp.return:Up[0]?jp.throw||((Lp=jp.return)&&Lp.call(jp),0):jp.next)&&!(Lp=Lp.call(jp,Up[1])).done)return Lp;switch(jp=0,Lp&&(Up=[Up[0]&2,Lp.value]),Up[0]){case 0:case 1:Lp=Up;break;case 4:return Dp.label++,{value:Up[1],done:!1};case 5:Dp.label++,jp=Up[1],Up=[0];continue;case 7:Up=Dp.ops.pop(),Dp.trys.pop();continue;default:if(Lp=Dp.trys,!(Lp=Lp.length>0&&Lp[Lp.length-1])&&(Up[0]===6||Up[0]===2)){Dp=0;continue}if(Up[0]===3&&(!Lp||Up[1]>Lp[0]&&Up[1]<Lp[3])){Dp.label=Up[1];break}if(Up[0]===6&&Dp.label<Lp[1]){Dp.label=Lp[1],Lp=Up;break}if(Lp&&Dp.label<Lp[2]){Dp.label=Lp[2],Dp.ops.push(Up);break}Lp[2]&&Dp.ops.pop(),Dp.trys.pop();continue}Up=zp.call($p,Dp)}catch(Gp){Up=[6,Gp],jp=0}finally{Fp=Lp=0}if(Up[0]&5)throw Up[1];return{value:Up[0]?Up[1]:void 0,done:!0}}};Object.defineProperty(Session,"__esModule",{value:!0}),Session.Session=void 0;var ap=Connection$1,sp=Filter$1,lp=Subscriber$1,up=EventDispatcher$2,cp=ConnectionEvent$1,dp=FilterEvent$1,hp=RecordingEvent$1,fp=SessionDisconnectedEvent$1,pp=SignalEvent$1,mp=SpeechToTextEvent$1,gp=requireStreamEvent(),yp=StreamPropertyChangedEvent$1,xp=ConnectionPropertyChangedEvent$1,_p=NetworkQualityLevelChangedEvent$1,vp=OpenViduError,bp=VideoInsertMode,Ep=OpenViduLogger$1,Sp=Platform,Ap=major_1,Rp=minor_1,Tp=ExceptionEvent,Mp=Ep.OpenViduLogger.getInstance(),Op,Pp=function($p){rp(zp,$p);function zp(Dp){var Fp=$p.call(this)||this;return Fp.streamManagers=[],Fp.remoteStreamsCreated=new Map,Fp.remoteConnections=new Map,Op=Sp.PlatformUtils.getInstance(),Fp.openvidu=Dp,Fp}return zp.prototype.connect=function(Dp,Fp){var jp=this;return new Promise(function(Lp,Bp){if(jp.processToken(Dp),jp.openvidu.checkSystemRequirements())jp.options={sessionId:jp.sessionId,participantId:Dp,metadata:Fp?jp.stringClientMetadata(Fp):""},jp.connectAux(Dp).then(function(){return Lp()}).catch(function(Ip){return Bp(Ip)});else return Bp(new vp.OpenViduError(vp.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+Op.getName()+" (version "+Op.getVersion()+") for "+Op.getFamily()+" is not supported in OpenVidu"))})},zp.prototype.disconnect=function(){this.leave(!1,"disconnect")},zp.prototype.subscribe=function(Dp,Fp,jp,Lp){var Bp={};jp&&typeof jp!="function"?Bp={insertMode:typeof jp.insertMode<"u"?typeof jp.insertMode=="string"?bp.VideoInsertMode[jp.insertMode]:Bp.insertMode:bp.VideoInsertMode.APPEND,subscribeToAudio:typeof jp.subscribeToAudio<"u"?jp.subscribeToAudio:!0,subscribeToVideo:typeof jp.subscribeToVideo<"u"?jp.subscribeToVideo:!0}:Bp={insertMode:bp.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var Ip=void 0;if(jp&&typeof jp=="function"?Ip=jp:Lp&&(Ip=Lp),!this.sessionConnected())throw Ip!==void 0&&Ip(this.notConnectedError()),this.notConnectedError();Mp.info("Subscribing to "+Dp.connection.connectionId),Dp.subscribe().then(function(){Mp.info("Subscribed correctly to "+Dp.connection.connectionId),Ip!==void 0&&Ip(void 0)}).catch(function(Up){Ip!==void 0&&Ip(Up)});var kp=new lp.Subscriber(Dp,Fp,Bp);return kp.targetElement&&Dp.streamManager.createVideoElement(kp.targetElement,Bp.insertMode),kp},zp.prototype.subscribeAsync=function(Dp,Fp,jp){var Lp=this;return new Promise(function(Bp,Ip){if(!Lp.sessionConnected())return Ip(Lp.notConnectedError());var kp,Up=function(Gp){return Gp?Ip(Gp):Bp(kp)};jp?kp=Lp.subscribe(Dp,Fp,jp,Up):kp=Lp.subscribe(Dp,Fp,Up)})},zp.prototype.unsubscribe=function(Dp){var Fp=this;return new Promise(function(jp,Lp){if(Fp.sessionConnected()){var Bp=Dp.stream.connection.connectionId;Mp.info("Unsubscribing from "+Bp),Fp.openvidu.sendRequest("unsubscribeFromVideo",{sender:Dp.stream.connection.connectionId},function(Ip,kp){return Ip?(Mp.error("Error unsubscribing from "+Bp),Lp(Ip)):(Mp.info("Unsubscribed correctly from "+Bp),Dp.stream.streamManager.removeAllVideos(),Dp.stream.disposeWebRtcPeer(),Dp.stream.disposeMediaStream(),jp())})}else return Lp(Fp.notConnectedError())})},zp.prototype.publish=function(Dp){var Fp=this;return new Promise(function(jp,Lp){if(!Fp.sessionConnected())return Lp(Fp.notConnectedError());Dp.session=Fp,Dp.stream.session=Fp,Dp.stream.publishedOnce?Dp.initialize().then(function(){Fp.connection.addStream(Dp.stream),Dp.reestablishStreamPlayingEvent(),Dp.stream.publish().then(function(){return Fp.sendVideoData(Dp,8,!0,5),jp()}).catch(function(Bp){return Lp(Bp)})}).catch(function(Bp){return Lp(Bp)}):(Fp.connection.addStream(Dp.stream),Dp.stream.publish().then(function(){return Fp.sendVideoData(Dp,8,!0,5),jp()}).catch(function(Bp){return Lp(Bp)}))})},zp.prototype.unpublish=function(Dp){var Fp=this;return new Promise(function(jp,Lp){if(!Fp.sessionConnected())throw Fp.notConnectedError();var Bp=Dp.stream;if(Bp.connection){if(Bp.connection!==Fp.connection)return Lp(new Error("The associated Connection object of this Publisher is not your local Connection.  Only moderators can force unpublish on remote Streams via 'forceUnpublish' method"));Mp.info("Unpublishing local media ("+Bp.connection.connectionId+")"),Fp.openvidu.sendRequest("unpublishVideo",function(Ip,kp){if(Ip)return Lp(Ip);Mp.info("Media unpublished correctly"),Bp.disposeWebRtcPeer(),Bp.connection.stream==Bp&&delete Bp.connection.stream;var Up=new gp.StreamEvent(!0,Dp,"streamDestroyed",Dp.stream,"unpublish");return Dp.emitEvent("streamDestroyed",[Up]),Up.callDefaultBehavior(),jp()})}else return Lp(new Error("The associated Connection object of this Publisher is null"))})},zp.prototype.forceDisconnect=function(Dp){var Fp=this;return new Promise(function(jp,Lp){if(!Fp.sessionConnected())return Lp(Fp.notConnectedError());Mp.info("Forcing disconnect for connection "+Dp.connectionId),Fp.openvidu.sendRequest("forceDisconnect",{connectionId:Dp.connectionId},function(Bp,Ip){return Bp?(Mp.error("Error forcing disconnect for Connection "+Dp.connectionId,Bp),Bp.code===401?Lp(new vp.OpenViduError(vp.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):Lp(Bp)):(Mp.info("Forcing disconnect correctly for Connection "+Dp.connectionId),jp())})})},zp.prototype.forceUnpublish=function(Dp){var Fp=this;return new Promise(function(jp,Lp){if(!Fp.sessionConnected())return Lp(Fp.notConnectedError());Mp.info("Forcing unpublish for stream "+Dp.streamId),Fp.openvidu.sendRequest("forceUnpublish",{streamId:Dp.streamId},function(Bp,Ip){return Bp?(Mp.error("Error forcing unpublish for Stream "+Dp.streamId,Bp),Bp.code===401?Lp(new vp.OpenViduError(vp.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):Lp(Bp)):(Mp.info("Forcing unpublish correctly for Stream "+Dp.streamId),jp())})})},zp.prototype.signal=function(Dp){var Fp=this;return new Promise(function(jp,Lp){if(!Fp.sessionConnected())return Lp(Fp.notConnectedError());var Bp={};if(Dp.to&&Dp.to.length>0){var Ip=[];Dp.to.forEach(function(Up){Up.connectionId&&Ip.push(Up.connectionId)}),Bp.to=Ip}else Bp.to=[];Bp.data=Dp.data?Dp.data:"";var kp=Dp.type?Dp.type:"signal";kp&&kp.substring(0,7)!=="signal:"&&(kp="signal:"+kp),Bp.type=kp,Fp.openvidu.sendRequest("sendMessage",{message:JSON.stringify(Bp)},function(Up,Gp){return Up?Lp(Up):jp()})})},zp.prototype.subscribeToSpeechToText=function(Dp,Fp){var jp=this;return new Promise(function(Lp,Bp){jp.openvidu.sendRequest("subscribeToSpeechToText",{connectionId:Dp.connection.connectionId,lang:Fp},function(Ip,kp){return Ip?Bp(Ip):Lp()})})},zp.prototype.unsubscribeFromSpeechToText=function(Dp){var Fp=this;return new Promise(function(jp,Lp){Fp.openvidu.sendRequest("unsubscribeFromSpeechToText",{connectionId:Dp.connection.connectionId},function(Bp,Ip){return Bp?Lp(Bp):jp()})})},zp.prototype.on=function(Dp,Fp){var jp,Lp,Bp,Ip;return $p.prototype.onAux.call(this,Dp,"Event '"+Dp+"' triggered by 'Session'",Fp),Dp==="publisherStartSpeaking"&&(this.remoteConnections.forEach(function(kp){var Up;!((Up=kp.stream)===null||Up===void 0)&&Up.hasAudio&&kp.stream.enableHarkSpeakingEvent()}),!((Lp=(jp=this.connection)===null||jp===void 0?void 0:jp.stream)===null||Lp===void 0)&&Lp.hasAudio&&this.connection.stream.enableHarkSpeakingEvent()),Dp==="publisherStopSpeaking"&&(this.remoteConnections.forEach(function(kp){var Up;!((Up=kp.stream)===null||Up===void 0)&&Up.hasAudio&&kp.stream.enableHarkStoppedSpeakingEvent()}),!((Ip=(Bp=this.connection)===null||Bp===void 0?void 0:Bp.stream)===null||Ip===void 0)&&Ip.hasAudio&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},zp.prototype.once=function(Dp,Fp){var jp,Lp,Bp,Ip;return $p.prototype.onceAux.call(this,Dp,"Event '"+Dp+"' triggered once by 'Session'",Fp),Dp==="publisherStartSpeaking"&&(this.remoteConnections.forEach(function(kp){var Up;!((Up=kp.stream)===null||Up===void 0)&&Up.hasAudio&&kp.stream.enableOnceHarkSpeakingEvent()}),!((Lp=(jp=this.connection)===null||jp===void 0?void 0:jp.stream)===null||Lp===void 0)&&Lp.hasAudio&&this.connection.stream.enableOnceHarkSpeakingEvent()),Dp==="publisherStopSpeaking"&&(this.remoteConnections.forEach(function(kp){var Up;!((Up=kp.stream)===null||Up===void 0)&&Up.hasAudio&&kp.stream.enableOnceHarkStoppedSpeakingEvent()}),!((Ip=(Bp=this.connection)===null||Bp===void 0?void 0:Bp.stream)===null||Ip===void 0)&&Ip.hasAudio&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},zp.prototype.off=function(Dp,Fp){var jp=this,Lp,Bp,Ip,kp;return $p.prototype.offAux.call(this,Dp,Fp),Dp==="publisherStartSpeaking"&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)||(this.remoteConnections.forEach(function(Up){var Gp;!((Gp=Up.stream)===null||Gp===void 0)&&Gp.streamManager&&(jp.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,Up.stream.streamManager)||Up.stream.disableHarkSpeakingEvent(!1))}),!((Bp=(Lp=this.connection)===null||Lp===void 0?void 0:Lp.stream)===null||Bp===void 0)&&Bp.streamManager&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkSpeakingEvent(!1)))),Dp==="publisherStopSpeaking"&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)||(this.remoteConnections.forEach(function(Up){var Gp;!((Gp=Up.stream)===null||Gp===void 0)&&Gp.streamManager&&(jp.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,Up.stream.streamManager)||Up.stream.disableHarkStoppedSpeakingEvent(!1))}),!((kp=(Ip=this.connection)===null||Ip===void 0?void 0:Ip.stream)===null||kp===void 0)&&kp.streamManager&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkStoppedSpeakingEvent(!1)))),this},zp.prototype.onParticipantJoined=function(Dp){var Fp=this;this.getConnection(Dp.id,"").then(function(jp){Mp.warn("Connection "+jp.connectionId+" already exists in connections list")}).catch(function(jp){var Lp=new ap.Connection(Fp,Dp);Fp.remoteConnections.set(Dp.id,Lp),Fp.ee.emitEvent("connectionCreated",[new cp.ConnectionEvent(!1,Fp,"connectionCreated",Lp,"")])})},zp.prototype.onParticipantLeft=function(Dp){var Fp=this;this.getRemoteConnection(Dp.connectionId,"onParticipantLeft").then(function(jp){if(jp.stream){var Lp=jp.stream,Bp=new gp.StreamEvent(!0,Fp,"streamDestroyed",Lp,Dp.reason);Fp.ee.emitEvent("streamDestroyed",[Bp]),Bp.callDefaultBehavior(),Fp.remoteStreamsCreated.delete(Lp.streamId)}jp.dispose(),Fp.remoteConnections.delete(jp.connectionId),Fp.ee.emitEvent("connectionDestroyed",[new cp.ConnectionEvent(!1,Fp,"connectionDestroyed",jp,Dp.reason)])}).catch(function(jp){Mp.error(jp)})},zp.prototype.onParticipantPublished=function(Dp){var Fp=this,jp=function(Bp){Fp.remoteConnections.set(Bp.connectionId,Bp),Fp.remoteStreamsCreated.get(Bp.stream.streamId)||Fp.ee.emitEvent("streamCreated",[new gp.StreamEvent(!1,Fp,"streamCreated",Bp.stream,"")]),Fp.remoteStreamsCreated.set(Bp.stream.streamId,!0)},Lp;this.getRemoteConnection(Dp.id,"onParticipantPublished").then(function(Bp){Lp=Bp,Dp.metadata=Bp.data,Lp.remoteOptions=Dp,Lp.initRemoteStreams(Dp.streams),jp(Lp)}).catch(function(Bp){Lp=new ap.Connection(Fp,Dp),jp(Lp)})},zp.prototype.onParticipantUnpublished=function(Dp){var Fp=this;Dp.connectionId===this.connection.connectionId?this.stopPublisherStream(Dp.reason):this.getRemoteConnection(Dp.connectionId,"onParticipantUnpublished").then(function(jp){var Lp=new gp.StreamEvent(!0,Fp,"streamDestroyed",jp.stream,Dp.reason);if(Fp.ee.emitEvent("streamDestroyed",[Lp]),Lp.callDefaultBehavior(),jp.stream!=null){var Bp=jp.stream.streamId;Fp.remoteStreamsCreated.delete(Bp),jp.removeStream()}}).catch(function(jp){Mp.error(jp)})},zp.prototype.onParticipantEvicted=function(Dp){Dp.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,Dp.reason)},zp.prototype.onNewMessage=function(Dp){var Fp=this;Mp.info("New signal: "+JSON.stringify(Dp));var jp=Dp.type?Dp.type.replace(/^(signal:)/,""):void 0;Dp.from?this.getConnection(Dp.from,"Connection '"+Dp.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then(function(Lp){Fp.ee.emitEvent("signal",[new pp.SignalEvent(Fp,jp,Dp.data,Lp)]),Dp.type&&Dp.type!=="signal"&&Fp.ee.emitEvent(Dp.type,[new pp.SignalEvent(Fp,jp,Dp.data,Lp)])}).catch(function(Lp){Mp.error(Lp)}):(this.ee.emitEvent("signal",[new pp.SignalEvent(this,jp,Dp.data,void 0)]),Dp.type&&Dp.type!=="signal"&&this.ee.emitEvent(Dp.type,[new pp.SignalEvent(this,jp,Dp.data,void 0)]))},zp.prototype.onStreamPropertyChanged=function(Dp){var Fp=this,jp=function(Lp){var Bp,Ip;if(Lp.stream&&Lp.stream.streamId===Dp.streamId){var kp=Lp.stream,Up=void 0;switch(Dp.property){case"audioActive":Up=kp.audioActive,Dp.newValue=Dp.newValue==="true",kp.audioActive=Dp.newValue;break;case"videoActive":Up=kp.videoActive,Dp.newValue=Dp.newValue==="true",kp.videoActive=Dp.newValue;var Gp=(Ip=(Bp=kp==null?void 0:kp.getMediaStream())===null||Bp===void 0?void 0:Bp.getVideoTracks())===null||Ip===void 0?void 0:Ip[0];Gp&&!Gp.enabled&&kp.videoActive&&(Gp.enabled=!0);break;case"videoTrack":Dp.newValue=JSON.parse(Dp.newValue);break;case"audioTrack":Dp.newValue=JSON.parse(Dp.newValue);break;case"videoDimensions":Up=kp.videoDimensions,Dp.newValue=JSON.parse(JSON.parse(Dp.newValue)),kp.videoDimensions=Dp.newValue;break;case"filter":Up=kp.filter,Dp.newValue=Object.keys(Dp.newValue).length>0?Dp.newValue:void 0,Dp.newValue!==void 0?(kp.filter=new sp.Filter(Dp.newValue.type,Dp.newValue.options),kp.filter.stream=kp,Dp.newValue.lastExecMethod&&(kp.filter.lastExecMethod=Dp.newValue.lastExecMethod)):delete kp.filter,Dp.newValue=kp.filter;break}Fp.ee.emitEvent("streamPropertyChanged",[new yp.StreamPropertyChangedEvent(Fp,kp,Dp.property,Dp.newValue,Up,Dp.reason)]),kp.streamManager&&kp.streamManager.emitEvent("streamPropertyChanged",[new yp.StreamPropertyChangedEvent(kp.streamManager,kp,Dp.property,Dp.newValue,Up,Dp.reason)])}else Mp.error("No stream with streamId '"+Dp.streamId+"' found for connection '"+Dp.connectionId+"' on 'streamPropertyChanged' event")};Dp.connectionId===this.connection.connectionId?jp(this.connection):this.getRemoteConnection(Dp.connectionId,"onStreamPropertyChanged").then(function(Lp){jp(Lp)}).catch(function(Lp){Mp.error(Lp)})},zp.prototype.onConnectionPropertyChanged=function(Dp){var Fp;switch(Dp.property){case"role":Fp=this.connection.role.slice(),this.connection.role=Dp.newValue,this.connection.localOptions.role=Dp.newValue;break;case"record":Fp=this.connection.record,Dp.newValue=Dp.newValue==="true",this.connection.record=Dp.newValue,this.connection.localOptions.record=Dp.newValue;break}this.ee.emitEvent("connectionPropertyChanged",[new xp.ConnectionPropertyChangedEvent(this,this.connection,Dp.property,Dp.newValue,Fp)])},zp.prototype.onNetworkQualityLevelChangedChanged=function(Dp){var Fp=this;Dp.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new _p.NetworkQualityLevelChangedEvent(this,Dp.newValue,Dp.oldValue,this.connection)]):this.getConnection(Dp.connectionId,"Connection not found for connectionId "+Dp.connectionId).then(function(jp){Fp.ee.emitEvent("networkQualityLevelChanged",[new _p.NetworkQualityLevelChangedEvent(Fp,Dp.newValue,Dp.oldValue,jp)])}).catch(function(jp){Mp.error(jp)})},zp.prototype.recvIceCandidate=function(Dp){var Fp={candidate:Dp.candidate,sdpMLineIndex:Dp.sdpMLineIndex,sdpMid:Dp.sdpMid},jp=new RTCIceCandidate(Fp);this.getConnection(Dp.senderConnectionId,"Connection not found for connectionId "+Dp.senderConnectionId+" owning endpoint "+Dp.endpointName+". Ice candidate will be ignored: "+jp).then(function(Lp){var Bp=Lp.stream;Bp.getWebRtcPeer().addIceCandidate(jp).catch(function(Ip){Mp.error("Error adding candidate for "+Bp.streamId+" stream of endpoint "+Dp.endpointName+": "+Ip)})}).catch(function(Lp){Mp.error(Lp)})},zp.prototype.onSessionClosed=function(Dp){Mp.info("Session closed: "+JSON.stringify(Dp));var Fp=Dp.sessionId;Fp!==void 0?this.ee.emitEvent("session-closed",[{session:Fp}]):Mp.warn("Session undefined on session closed",Dp)},zp.prototype.onLostConnection=function(Dp){Mp.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,Dp)},zp.prototype.onRecoveredConnection=function(){Mp.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},zp.prototype.onMediaError=function(Dp){Mp.error("Media error: "+JSON.stringify(Dp));var Fp=Dp.error;Fp?this.ee.emitEvent("error-media",[{error:Fp}]):Mp.warn("Received undefined media error:",Dp)},zp.prototype.onRecordingStarted=function(Dp){this.ee.emitEvent("recordingStarted",[new hp.RecordingEvent(this,"recordingStarted",Dp.id,Dp.name)])},zp.prototype.onRecordingStopped=function(Dp){this.ee.emitEvent("recordingStopped",[new hp.RecordingEvent(this,"recordingStopped",Dp.id,Dp.name,Dp.reason)])},zp.prototype.onBroadcastStarted=function(){this.ee.emitEvent("broadcastStarted",[])},zp.prototype.onBroadcastStopped=function(){this.ee.emitEvent("broadcastStopped",[])},zp.prototype.onFilterEventDispatched=function(Dp){var Fp=this,jp=Dp.connectionId;this.getConnection(jp,"No connection found for connectionId "+jp).then(function(Lp){Mp.info('Filter event of type "'.concat(Dp.eventType,'" dispatched'));var Bp=Lp.stream;if(!Bp||!Bp.filter)return Mp.error('Filter event of type "'.concat(Dp.eventType,'" dispatched for stream ').concat(Bp.streamId," but there is no ").concat(Bp?"filter":"stream"," defined"));var Ip=Bp.filter.handlers.get(Dp.eventType);if(!Ip||typeof Ip!="function"){var kp=Array.from(Bp.filter.handlers.keys());return Mp.error('Filter event of type "'.concat(Dp.eventType,'" not handled or not a function! Active filter events: ').concat(kp.join(",")))}else Ip.call(Fp,new dp.FilterEvent(Bp.filter,Dp.eventType,Dp.data))})},zp.prototype.onForciblyReconnectSubscriber=function(Dp){var Fp=this;return new Promise(function(jp,Lp){Fp.getRemoteConnection(Dp.connectionId,"onForciblyReconnectSubscriber").then(function(Bp){if(Bp.stream&&Bp.stream.streamId===Dp.streamId){var Ip=Bp.stream;if(Ip.setupReconnectionEventEmitter(jp,Lp)){if(Ip.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent!=null)return Ip.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=Dp,Lp("Ongoing forced subscriber reconnection");Ip.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=Dp;var kp=function(){var Gp=Ip.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent;delete Ip.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent,Fp.onForciblyReconnectSubscriber(Gp)};Ip.reconnectionEventEmitter.once("success",function(){kp()}),Ip.reconnectionEventEmitter.once("error",function(){kp()});return}Ip.completeWebRtcPeerReceive(!0,!0,Dp.sdpOffer).then(function(){return Ip.finalResolveForSubscription(!0,jp)}).catch(function(Gp){return Ip.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream ".concat(Dp.streamId,": ").concat(Gp.toString()),Lp)})}else{var Up="No stream with streamId '"+Dp.streamId+"' found for connection '"+Dp.connectionId+"' on 'streamPropertyChanged' event";return Mp.error(Up),Lp(Up)}}).catch(function(Bp){return Mp.error(Bp),Lp(Bp)})})},zp.prototype.reconnectBrokenStreams=function(){Mp.info("Re-establishing media connections...");var Dp=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(Mp.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),Dp=!0),this.remoteConnections.forEach(function(Fp){Fp.stream&&Fp.stream.streamIceConnectionStateBroken()&&(Mp.warn("Re-establishing Subscriber "+Fp.stream.streamId),Fp.stream.initWebRtcPeerReceive(!0),Dp=!0)}),Dp||Mp.info("There were no media streams in need of a reconnection")},zp.prototype.onSpeechToTextMessage=function(Dp){return _d(this,void 0,void 0,function(){var Fp,jp;return np(this,function(Lp){switch(Lp.label){case 0:return[4,this.getConnection(Dp.connectionId,"No connection found for connectionId "+Dp.connectionId)];case 1:return Fp=Lp.sent(),jp=new mp.SpeechToTextEvent(this,Fp,Dp.text,Dp.reason.toLowerCase(),Dp.raw,Dp.lang),this.ee.emitEvent("speechToTextMessage",[jp]),[2]}})})},zp.prototype.onSpeechToTextDisconnected=function(Dp){return _d(this,void 0,void 0,function(){return np(this,function(Fp){return this.emitEvent("exception",[new Tp.ExceptionEvent(this,Tp.ExceptionEventName.SPEECH_TO_TEXT_DISCONNECTED,this,Dp.message)]),[2]})})},zp.prototype.emitEvent=function(Dp,Fp){this.ee.emitEvent(Dp,Fp)},zp.prototype.leave=function(Dp,Fp){var jp=this;if(Dp=!!Dp,Mp.info("Leaving Session (forced="+Dp+")"),this.stopVideoDataIntervals(),this.connection){if(!this.connection.disposed&&!Dp?this.openvidu.sendRequest("leaveRoom",function(Bp,Ip){Bp&&Mp.error("leaveRoom error: ".concat(JSON.stringify(Bp))),jp.openvidu.closeWs()}):this.openvidu.closeWs(),this.stopPublisherStream(Fp),!this.connection.disposed){var Lp=new fp.SessionDisconnectedEvent(this,Fp);this.ee.emitEvent("sessionDisconnected",[Lp]),Lp.callDefaultBehavior()}}else Mp.warn("You were not connected to the session "+this.sessionId);Mp.flush()},zp.prototype.initializeParams=function(Dp){var Fp={token:Dp||"",session:this.sessionId,platform:Op.getDescription()?Op.getDescription():"unknown",sdkVersion:this.openvidu.libraryVersion,metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder(),stt:this.openvidu.getStt()};return Fp},zp.prototype.sendVideoData=function(Dp,Fp,jp,Lp){var Bp=this,Ip,kp;if(Fp===void 0&&(Fp=1),jp===void 0&&(jp=!1),Lp===void 0&&(Lp=1),Op.isChromeBrowser()||Op.isChromeMobileBrowser()||Op.isOperaBrowser()||Op.isOperaMobileBrowser()||Op.isEdgeBrowser()||Op.isEdgeMobileBrowser()||Op.isElectron()||Op.isSafariBrowser()&&!Op.isIonicIos()||Op.isAndroidBrowser()||Op.isSamsungBrowser()||Op.isIonicAndroid()||Op.isIOSWithSafari()){var Up=function(){return _d(Bp,void 0,void 0,function(){var Wp,Qp,Xp;return np(this,function(rm){switch(rm.label){case 0:return Wp=Dp.stream.getRTCPeerConnection(),Wp.connectionState!=="connected"?[3,2]:[4,Wp.getStats()];case 1:Qp=rm.sent(),Xp=[],Qp.forEach(function(Kp){"frameWidth"in Kp&&"frameHeight"in Kp&&Xp.length===0&&Xp.push(Kp)}),Xp.length>0&&this.openvidu.sendRequest("videoData",{height:Xp[0].frameHeight,width:Xp[0].frameWidth,videoActive:Dp.stream.videoActive!=null?Dp.stream.videoActive:!1,audioActive:Dp.stream.audioActive!=null?Dp.stream.audioActive:!1},function(Kp,lm){Kp&&Mp.error("Error sending 'videoData' event",Kp)}),rm.label=2;case 2:return[2]}})})};if(jp){var Gp=1;this.videoDataInterval=setInterval(function(){Gp<Lp?(Gp++,Up()):clearInterval(Bp.videoDataInterval)},Fp*1e3)}else this.videoDataTimeout=setTimeout(Up,Fp*1e3)}else Op.isFirefoxBrowser()||Op.isFirefoxMobileBrowser()||Op.isIonicIos()||Op.isReactNative()?this.openvidu.sendRequest("videoData",{height:((Ip=Dp.stream.videoDimensions)===null||Ip===void 0?void 0:Ip.height)||0,width:((kp=Dp.stream.videoDimensions)===null||kp===void 0?void 0:kp.width)||0,videoActive:Dp.stream.videoActive!=null?Dp.stream.videoActive:!1,audioActive:Dp.stream.audioActive!=null?Dp.stream.audioActive:!1},function(Wp,Qp){Wp&&Mp.error("Error sending 'videoData' event",Wp)}):Mp.error("Browser "+Op.getName()+" (version "+Op.getVersion()+") for "+Op.getFamily()+" is not supported in OpenVidu for Network Quality")},zp.prototype.sessionConnected=function(){return this.connection!=null},zp.prototype.notConnectedError=function(){return new vp.OpenViduError(vp.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},zp.prototype.anySpeechEventListenerEnabled=function(Dp,Fp,jp){var Lp=this.ee.getListeners(Dp);Fp&&(Lp=Lp.filter(function(Up){return Up.once}));var Bp=Lp.length;if(Bp>0)return!0;var Ip=0;if(jp){var kp=jp.ee.getListeners(Dp);Fp&&(kp=kp.filter(function(Up){return Up.once})),Ip=kp.length}return Ip>0},zp.prototype.getTokenParams=function(Dp){var Fp=Dp.match(/^(wss?)\:\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(Fp){var jp={protocol:Fp[1],host:Fp[2],hostname:Fp[3],port:Fp[4],pathname:Fp[5],search:Fp[6],hash:Fp[7]},Lp=Dp.split("?"),Bp=decodeURI(Lp[1]).split("&").map(function(Ip){return Ip.split("=")}).reduce(function(Ip,kp){var Up=kp[0],Gp=kp[1];return Ip[Up]=Gp,Ip},{});return{sessionId:Bp.sessionId,secret:Bp.secret,recorder:Bp.recorder,stt:Bp.stt,webrtcStatsInterval:Bp.webrtcStatsInterval,sendBrowserLogs:Bp.sendBrowserLogs,edition:Bp.edition,wsUri:jp.protocol+"://"+jp.host+"/openvidu",httpUri:"https://"+jp.host}}else throw new Error('Token not valid: "'.concat(Dp,'"'))},zp.prototype.connectAux=function(Dp){var Fp=this;return new Promise(function(jp,Lp){Fp.openvidu.startWs(function(Bp){if(Bp)return Lp(Bp);var Ip=Fp.initializeParams(Dp);Fp.openvidu.sendRequest("joinRoom",Ip,function(kp,Up){if(kp)return Lp(kp);Fp.processJoinRoomResponse(Up,Dp),Fp.connection=new ap.Connection(Fp,Up);var Gp={connections:new Array,streams:new Array},Wp=Up.value;return Wp.forEach(function(Qp){var Xp=new ap.Connection(Fp,Qp);Fp.remoteConnections.set(Xp.connectionId,Xp),Gp.connections.push(Xp),Xp.stream&&(Fp.remoteStreamsCreated.set(Xp.stream.streamId,!0),Gp.streams.push(Xp.stream))}),Fp.ee.emitEvent("connectionCreated",[new cp.ConnectionEvent(!1,Fp,"connectionCreated",Fp.connection,"")]),Gp.connections.forEach(function(Qp){Fp.ee.emitEvent("connectionCreated",[new cp.ConnectionEvent(!1,Fp,"connectionCreated",Qp,"")])}),Gp.streams.forEach(function(Qp){Fp.ee.emitEvent("streamCreated",[new gp.StreamEvent(!1,Fp,"streamCreated",Qp,"")])}),Up.recordingId&&Up.recordingName&&Fp.ee.emitEvent("recordingStarted",[new hp.RecordingEvent(Fp,"recordingStarted",Up.recordingId,Up.recordingName)]),jp()})})})},zp.prototype.stopPublisherStream=function(Dp){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[Dp]))},zp.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},zp.prototype.stringClientMetadata=function(Dp){return typeof Dp!="string"?JSON.stringify(Dp):Dp},zp.prototype.getConnection=function(Dp,Fp){var jp=this;return new Promise(function(Lp,Bp){var Ip=jp.remoteConnections.get(Dp);return Ip?Lp(Ip):jp.connection.connectionId===Dp?Lp(jp.connection):Bp(new vp.OpenViduError(vp.OpenViduErrorName.GENERIC_ERROR,Fp))})},zp.prototype.getRemoteConnection=function(Dp,Fp){var jp=this;return new Promise(function(Lp,Bp){var Ip=jp.remoteConnections.get(Dp);if(Ip)return Lp(Ip);var kp="Remote connection "+Dp+" unknown when '"+Fp+"'. Existing remote connections: "+JSON.stringify(jp.remoteConnections.keys());return Bp(new vp.OpenViduError(vp.OpenViduErrorName.GENERIC_ERROR,kp))})},zp.prototype.processToken=function(Dp){var Fp=this.getTokenParams(Dp);this.sessionId=Fp.sessionId,Fp.secret&&(this.openvidu.secret=Fp.secret),Fp.recorder&&(this.openvidu.recorder=!0),Fp.stt&&(this.openvidu.stt=!0),Fp.webrtcStatsInterval&&(this.openvidu.webrtcStatsInterval=Fp.webrtcStatsInterval),Fp.sendBrowserLogs&&(this.openvidu.sendBrowserLogs=Fp.sendBrowserLogs),this.openvidu.isAtLeastPro=Fp.edition==="pro"||Fp.edition==="enterprise",this.openvidu.isEnterprise=Fp.edition==="enterprise",this.openvidu.wsUri=Fp.wsUri,this.openvidu.httpUri=Fp.httpUri},zp.prototype.processJoinRoomResponse=function(Dp,Fp){if(this.sessionId=Dp.session,Dp.customIceServers!=null&&Dp.customIceServers.length>0){this.openvidu.iceServers=[];for(var jp=0,Lp=Dp.customIceServers;jp<Lp.length;jp++){var Bp=Lp[jp],Ip={urls:[Bp.url]};Mp.log("STUN/TURN server IP: "+Bp.url),Bp.username!=null&&Bp.credential!=null&&(Ip.username=Bp.username,Ip.credential=Bp.credential,Mp.log("TURN credentials ["+Bp.username+":"+Bp.credential+"]")),this.openvidu.iceServers.push(Ip)}}this.openvidu.role=Dp.role,this.openvidu.finalUserId=Dp.finalUserId,this.openvidu.mediaServer=Dp.mediaServer,this.openvidu.videoSimulcast=Dp.videoSimulcast,this.capabilities={subscribe:!0,publish:this.openvidu.role!=="SUBSCRIBER",forceUnpublish:this.openvidu.role==="MODERATOR",forceDisconnect:this.openvidu.role==="MODERATOR"},Mp.info("openvidu-server version: "+Dp.version),Dp.life!=null&&(this.openvidu.life=Dp.life);var kp=Rp(Dp.version)-Rp(this.openvidu.libraryVersion);Ap(Dp.version)!==Ap(this.openvidu.libraryVersion)||!(kp==0||kp==1)?Mp.error("openvidu-browser (".concat(this.openvidu.libraryVersion,") and openvidu-server (").concat(Dp.version,") versions are incompatible. ")+"Errors are likely to occur. openvidu-browser SDK is only compatible with the same version or the immediately following minor version of an OpenVidu deployment"):kp==1&&Mp.warn("openvidu-browser version ".concat(this.openvidu.libraryVersion," does not match openvidu-server version ").concat(Dp.version,". ")+"These versions are still compatible with each other, but openvidu-browser version must be updated as soon as possible to ".concat(Ap(Dp.version),".").concat(Rp(Dp.version),".x. ")+"This client using openvidu-browser ".concat(this.openvidu.libraryVersion," will become incompatible with the next release of openvidu-server")),Ep.OpenViduLogger.configureJSNLog(this.openvidu,Fp),this.token=Fp},zp}(up.EventDispatcher);return Session.Session=Pp,Session}var hasRequiredPublisher;function requirePublisher(){if(hasRequiredPublisher)return Publisher;hasRequiredPublisher=1;var rp=commonjsGlobal&&commonjsGlobal.__extends||function(){var xp=function(_p,vp){return xp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(bp,Ep){bp.__proto__=Ep}||function(bp,Ep){for(var Sp in Ep)Object.prototype.hasOwnProperty.call(Ep,Sp)&&(bp[Sp]=Ep[Sp])},xp(_p,vp)};return function(_p,vp){if(typeof vp!="function"&&vp!==null)throw new TypeError("Class extends value "+String(vp)+" is not a constructor or null");xp(_p,vp);function bp(){this.constructor=_p}_p.prototype=vp===null?Object.create(vp):(bp.prototype=vp.prototype,new bp)}}(),_d=commonjsGlobal&&commonjsGlobal.__awaiter||function(xp,_p,vp,bp){function Ep(Sp){return Sp instanceof vp?Sp:new vp(function(Ap){Ap(Sp)})}return new(vp||(vp=Promise))(function(Sp,Ap){function Rp(Op){try{Mp(bp.next(Op))}catch(Pp){Ap(Pp)}}function Tp(Op){try{Mp(bp.throw(Op))}catch(Pp){Ap(Pp)}}function Mp(Op){Op.done?Sp(Op.value):Ep(Op.value).then(Rp,Tp)}Mp((bp=bp.apply(xp,_p||[])).next())})},np=commonjsGlobal&&commonjsGlobal.__generator||function(xp,_p){var vp={label:0,sent:function(){if(Sp[0]&1)throw Sp[1];return Sp[1]},trys:[],ops:[]},bp,Ep,Sp,Ap;return Ap={next:Rp(0),throw:Rp(1),return:Rp(2)},typeof Symbol=="function"&&(Ap[Symbol.iterator]=function(){return this}),Ap;function Rp(Mp){return function(Op){return Tp([Mp,Op])}}function Tp(Mp){if(bp)throw new TypeError("Generator is already executing.");for(;Ap&&(Ap=0,Mp[0]&&(vp=0)),vp;)try{if(bp=1,Ep&&(Sp=Mp[0]&2?Ep.return:Mp[0]?Ep.throw||((Sp=Ep.return)&&Sp.call(Ep),0):Ep.next)&&!(Sp=Sp.call(Ep,Mp[1])).done)return Sp;switch(Ep=0,Sp&&(Mp=[Mp[0]&2,Sp.value]),Mp[0]){case 0:case 1:Sp=Mp;break;case 4:return vp.label++,{value:Mp[1],done:!1};case 5:vp.label++,Ep=Mp[1],Mp=[0];continue;case 7:Mp=vp.ops.pop(),vp.trys.pop();continue;default:if(Sp=vp.trys,!(Sp=Sp.length>0&&Sp[Sp.length-1])&&(Mp[0]===6||Mp[0]===2)){vp=0;continue}if(Mp[0]===3&&(!Sp||Mp[1]>Sp[0]&&Mp[1]<Sp[3])){vp.label=Mp[1];break}if(Mp[0]===6&&vp.label<Sp[1]){vp.label=Sp[1],Sp=Mp;break}if(Sp&&vp.label<Sp[2]){vp.label=Sp[2],vp.ops.push(Mp);break}Sp[2]&&vp.ops.pop(),vp.trys.pop();continue}Mp=_p.call(xp,vp)}catch(Op){Mp=[6,Op],Ep=0}finally{bp=Sp=0}if(Mp[0]&5)throw Mp[1];return{value:Mp[0]?Mp[1]:void 0,done:!0}}};Object.defineProperty(Publisher,"__esModule",{value:!0}),Publisher.Publisher=void 0;var ap=requireSession(),sp=Stream$1,lp=StreamManager$1,up=requireStreamEvent(),cp=StreamPropertyChangedEvent$1,dp=OpenViduError,hp=OpenViduLogger$1,fp=Platform,pp=TypeOfVideo,mp=hp.OpenViduLogger.getInstance(),gp,yp=function(xp){rp(_p,xp);function _p(vp,bp,Ep){var Sp=xp.call(this,new sp.Stream(Ep.session?Ep.session:new ap.Session(Ep),{publisherProperties:bp,mediaConstraints:{}}),vp)||this;return Sp.accessAllowed=!1,Sp.isSubscribedToRemote=!1,Sp.accessDenied=!1,gp=fp.PlatformUtils.getInstance(),Sp.properties=bp,Sp.openvidu=Ep,Sp.stream.ee.on("local-stream-destroyed",function(Ap){Sp.stream.isLocalStreamPublished=!1;var Rp=new up.StreamEvent(!0,Sp,"streamDestroyed",Sp.stream,Ap);Sp.emitEvent("streamDestroyed",[Rp]),Rp.callDefaultBehavior()}),Sp}return _p.prototype.publishAudio=function(vp){var bp=this;if(this.stream.audioActive!==vp){var Ep=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();Ep.getAudioTracks().forEach(function(Sp){Sp.enabled=vp}),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:vp,reason:"publishAudio"},function(Sp,Ap){Sp?mp.error("Error sending 'streamPropertyChanged' event",Sp):(bp.session.emitEvent("streamPropertyChanged",[new cp.StreamPropertyChangedEvent(bp.session,bp.stream,"audioActive",vp,!vp,"publishAudio")]),bp.emitEvent("streamPropertyChanged",[new cp.StreamPropertyChangedEvent(bp,bp.stream,"audioActive",vp,!vp,"publishAudio")]),bp.session.sendVideoData(bp.stream.streamManager))}),this.stream.audioActive=vp,mp.info("'Publisher' has "+(vp?"published":"unpublished")+" its audio stream")}},_p.prototype.publishVideo=function(vp,bp){var Ep=this;return new Promise(function(Sp,Ap){return _d(Ep,void 0,void 0,function(){var Rp,Tp,Mp,Op,Pp,$p,zp=this;return np(this,function(Dp){switch(Dp.label){case 0:return this.stream.videoActive===vp?[3,9]:(Rp=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),Tp=!1,Rp.getVideoTracks().forEach(function(Fp){Fp.enabled=vp,!vp&&bp===!0?Fp.stop():vp&&Fp.readyState==="ended"&&(Tp=!0)}),!vp&&bp===!0&&this.stream.filter&&this.stream.filter.type.startsWith("VB:")?(this.stream.lastVBFilter=this.stream.filter,[4,this.stream.removeFilterAux(!0)]):[3,2]);case 1:Dp.sent(),Dp.label=2;case 2:return Tp?(Mp=Rp.getVideoTracks()[0],Rp.removeTrack(Mp),Op=function(Fp){return _d(zp,void 0,void 0,function(){var jp=this;return np(this,function(Lp){switch(Lp.label){case 0:return Rp.addTrack(Fp),this.stream.isLocalStreamPublished?[4,this.replaceTrackInRtcRtpSender(Fp)]:[3,2];case 1:Lp.sent(),Lp.label=2;case 2:return this.stream.lastVBFilter&&setTimeout(function(){return _d(jp,void 0,void 0,function(){var Bp,Ip;return np(this,function(kp){switch(kp.label){case 0:return Bp=this.stream.lastVBFilter.options,Ip=this.stream.lastVBFilter.lastExecMethod,Ip&&Ip.method==="update"&&(Bp=Object.assign({},Bp,Ip.params)),[4,this.stream.applyFilter(this.stream.lastVBFilter.type,Bp)];case 1:return kp.sent(),delete this.stream.lastVBFilter,[2]}})})},1),[2]}})})},bp&&bp instanceof MediaStreamTrack?[4,Op(bp)]:[3,4]):[3,8];case 3:return Dp.sent(),[3,8];case 4:return Dp.trys.push([4,7,,8]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:this.stream.lastVideoTrackConstraints})];case 5:return Pp=Dp.sent(),[4,Op(Pp.getVideoTracks()[0])];case 6:return Dp.sent(),[3,8];case 7:return $p=Dp.sent(),[2,Ap($p)];case 8:return this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:vp,reason:"publishVideo"},function(Fp,jp){Fp?mp.error("Error sending 'streamPropertyChanged' event",Fp):(zp.session.emitEvent("streamPropertyChanged",[new cp.StreamPropertyChangedEvent(zp.session,zp.stream,"videoActive",vp,!vp,"publishVideo")]),zp.emitEvent("streamPropertyChanged",[new cp.StreamPropertyChangedEvent(zp,zp.stream,"videoActive",vp,!vp,"publishVideo")]),zp.session.sendVideoData(zp.stream.streamManager))}),this.stream.videoActive=vp,mp.info("'Publisher' has "+(vp?"published":"unpublished")+" its video stream"),[2,Sp()];case 9:return[2]}})})})},_p.prototype.subscribeToRemote=function(vp){vp=vp!==void 0?vp:!0,this.isSubscribedToRemote=vp,this.stream.subscribeToMyRemote(vp)},_p.prototype.on=function(vp,bp){var Ep=this;return xp.prototype.on.call(this,vp,bp),vp==="streamCreated"&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new up.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",function(){Ep.emitEvent("streamCreated",[new up.StreamEvent(!1,Ep,"streamCreated",Ep.stream,"")])})),vp==="accessAllowed"&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),vp==="accessDenied"&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},_p.prototype.once=function(vp,bp){var Ep=this;return xp.prototype.once.call(this,vp,bp),vp==="streamCreated"&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new up.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",function(){Ep.emitEvent("streamCreated",[new up.StreamEvent(!1,Ep,"streamCreated",Ep.stream,"")])})),vp==="accessAllowed"&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),vp==="accessDenied"&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},_p.prototype.off=function(vp,bp){return xp.prototype.off.call(this,vp,bp),this},_p.prototype.replaceTrack=function(vp){return _d(this,void 0,void 0,function(){return np(this,function(bp){return[2,this.replaceTrackAux(vp,!0)]})})},_p.prototype.initialize=function(){var vp=this;return new Promise(function(bp,Ep){return _d(vp,void 0,void 0,function(){var Sp,Ap,Rp,Tp,Mp,Op,Pp,$p,zp,Dp,Fp,jp,jp,Lp,Bp,Ip=this,kp,Up;return np(this,function(Gp){switch(Gp.label){case 0:Sp={},Ap={},Rp=2e3,Mp=function(Wp){return Ip.accessDenied=!0,Ip.accessAllowed=!1,mp.error("Publisher initialization failed. ".concat(Wp.name,": ").concat(Wp.message)),Ep(Wp)},Op=function(Wp){var Qp,Xp;if(Ip.accessAllowed=!0,Ip.accessDenied=!1,typeof MediaStreamTrack<"u"&&Ip.properties.audioSource instanceof MediaStreamTrack&&(Wp.removeTrack(Wp.getAudioTracks()[0]),Wp.addTrack(Ip.properties.audioSource)),typeof MediaStreamTrack<"u"&&Ip.properties.videoSource instanceof MediaStreamTrack&&(Wp.removeTrack(Wp.getVideoTracks()[0]),Wp.addTrack(Ip.properties.videoSource)),Wp.getAudioTracks()[0]){var rm=Ip.stream.audioActive!==void 0&&Ip.stream.audioActive!==null?Ip.stream.audioActive:!!Ip.stream.outboundStreamOpts.publisherProperties.publishAudio;Wp.getAudioTracks()[0].enabled=rm}if(Wp.getVideoTracks()[0]){var rm=Ip.stream.videoActive!==void 0&&Ip.stream.videoActive!==null?Ip.stream.videoActive:!!Ip.stream.outboundStreamOpts.publisherProperties.publishVideo;Wp.getVideoTracks()[0].enabled=rm}for(var Kp=0,lm=Wp.getAudioTracks();Kp<lm.length;Kp++){var cm=lm[Kp];!((Qp=cm.contentHint)===null||Qp===void 0)&&Qp.length||(cm.contentHint="",mp.info("Audio track Content Hint set: '".concat(cm.contentHint,"'")))}for(var gm=0,Mm=Wp.getVideoTracks();gm<Mm.length;gm++){var cm=Mm[gm];if(!(!((Xp=cm.contentHint)===null||Xp===void 0)&&Xp.length)){switch(Ip.stream.typeOfVideo){case pp.TypeOfVideo.SCREEN:cm.contentHint="detail";break;case pp.TypeOfVideo.CUSTOM:mp.warn("CUSTOM type video track was provided without Content Hint!"),cm.contentHint="motion";break;case pp.TypeOfVideo.CAMERA:case pp.TypeOfVideo.IPCAM:default:cm.contentHint="motion";break}mp.info("Video track Content Hint set: '".concat(cm.contentHint,"'"))}}return Ip.initializeVideoReference(Wp),Ip.stream.displayMyRemote()||Ip.stream.updateMediaStreamInVideos(),delete Ip.firstVideoElement,Ip.stream.isSendVideo()?Ip.getVideoDimensions().then(function(dm){Ip.stream.videoDimensions={width:dm.width,height:dm.height},Ip.stream.isSendScreen()&&(Ip.stream.isSendAudio()&&Wp.getAudioTracks().length===0&&(Ip.stream.audioActive=!1,Ip.stream.hasAudio=!1,Ip.stream.outboundStreamOpts.publisherProperties.publishAudio=!1,Ip.stream.outboundStreamOpts.publisherProperties.audioSource=!1),Ip.screenShareResizeInterval=setInterval(function(){var em=Wp.getVideoTracks()[0].getSettings(),sm=em.width,Zp=em.height,mm=sm!=null&&sm!==Ip.stream.videoDimensions.width,fm=Zp!=null&&Zp!==Ip.stream.videoDimensions.height;Ip.stream.isLocalStreamPublished&&(mm||fm)&&Ip.openvidu.sendVideoDimensionsChangedEvent(Ip,"screenResized",Ip.stream.videoDimensions.width,Ip.stream.videoDimensions.height,sm||0,Zp||0)},650)),Ip.stream.isLocalStreamReadyToPublish=!0,Ip.stream.ee.emitEvent("stream-ready-to-publish",[])}):(Ip.stream.isLocalStreamReadyToPublish=!0,Ip.stream.ee.emitEvent("stream-ready-to-publish",[])),bp()},Pp=function(Wp,Qp){return _d(Ip,void 0,void 0,function(){var Xp,rm;return np(this,function(Kp){switch(Kp.label){case 0:if(this.clearPermissionDialogTimer(Tp,Rp),!(this.stream.isSendScreen()&&this.properties.audioSource!=="screen"&&this.stream.isSendAudio()))return[3,5];Ap.audio=Qp,Ap.video=!1,Tp=Date.now(),this.setPermissionDialogTimer(Rp),Kp.label=1;case 1:return Kp.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(Ap)];case 2:return Xp=Kp.sent(),this.clearPermissionDialogTimer(Tp,Rp),Wp.addTrack(Xp.getAudioTracks()[0]),Op(Wp),[3,4];case 3:return rm=Kp.sent(),this.clearPermissionDialogTimer(Tp,Rp),Wp.getAudioTracks().forEach(function(lm){lm.stop()}),Wp.getVideoTracks().forEach(function(lm){lm.stop()}),Mp(this.openvidu.generateAudioDeviceError(rm,Sp)),[2];case 4:return[3,6];case 5:Op(Wp),Kp.label=6;case 6:return[2]}})})},$p=function(Wp){return _d(Ip,void 0,void 0,function(){var Qp,Xp,rm,lm,Kp,lm,cm;return np(this,function(gm){switch(gm.label){case 0:switch(mp.error("getMediaError: ".concat(Wp.toString())),this.clearPermissionDialogTimer(Tp,Rp),Wp.name==="Error"&&(Wp.name=Wp.constructor.name),rm=Wp.name.toLowerCase(),rm){case"notfounderror":return[3,1];case"notallowederror":return[3,5];case"overconstrainederror":return[3,6];case"aborterror":return[3,10];case"notreadableerror":return[3,10]}return[3,11];case 1:return gm.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:Sp.video})];case 2:return lm=gm.sent(),lm.getVideoTracks().forEach(function(Mm){Mm.stop()}),Qp=dp.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,Xp=Wp.toString(),Mp(new dp.OpenViduError(Qp,Xp)),[3,4];case 3:return Kp=gm.sent(),Qp=dp.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,Xp=Kp.toString(),Mp(new dp.OpenViduError(Qp,Xp)),[3,4];case 4:return[3,12];case 5:return Qp=this.stream.isSendScreen()?dp.OpenViduErrorName.SCREEN_CAPTURE_DENIED:dp.OpenViduErrorName.DEVICE_ACCESS_DENIED,Xp=Wp.toString(),Mp(new dp.OpenViduError(Qp,Xp)),[3,12];case 6:return gm.trys.push([6,8,,9]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:Sp.video})];case 7:return lm=gm.sent(),lm.getVideoTracks().forEach(function(Mm){Mm.stop()}),Wp.constraint.toLowerCase()==="deviceid"?(Qp=dp.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,Xp="Audio input device with deviceId '"+Sp.audio.deviceId.exact+"' not found"):(Qp=dp.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,Xp="Audio input device doesn't support the value passed for constraint '"+Wp.constraint+"'"),Mp(new dp.OpenViduError(Qp,Xp)),[3,9];case 8:return cm=gm.sent(),cm.constraint.toLowerCase()==="deviceid"?(Qp=dp.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,Xp="Video input device with deviceId '"+Sp.video.deviceId.exact+"' not found"):(Qp=dp.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,Xp="Video input device doesn't support the value passed for constraint '"+cm.constraint+"'"),Mp(new dp.OpenViduError(Qp,Xp)),[3,9];case 9:return[3,12];case 10:return Qp=dp.OpenViduErrorName.DEVICE_ALREADY_IN_USE,Xp=Wp.toString(),Mp(new dp.OpenViduError(Qp,Xp)),[3,12];case 11:return Qp=dp.OpenViduErrorName.GENERIC_ERROR,Xp=Wp.toString(),Mp(new dp.OpenViduError(Qp,Xp)),[3,12];case 12:return[2]}})})},Gp.label=1;case 1:return Gp.trys.push([1,14,,15]),[4,this.openvidu.generateMediaConstraints(this.properties)];case 2:return zp=Gp.sent(),zp.videoTrack&&zp.audioTrack||zp.audioTrack&&((kp=zp.constraints)===null||kp===void 0?void 0:kp.video)===!1||zp.videoTrack&&((Up=zp.constraints)===null||Up===void 0?void 0:Up.audio)===!1?(Op(this.openvidu.addAlreadyProvidedTracks(zp,new MediaStream,this.stream)),[3,13]):[3,3];case 3:Sp=zp.constraints,Dp={mediaConstraints:Sp,publisherProperties:this.properties},this.stream.setOutboundStreamOptions(Dp),Fp=Sp.audio===void 0?!0:Sp.audio,Ap.audio=this.stream.isSendScreen()?!1:Fp,Ap.video=Sp.video,Tp=Date.now(),this.setPermissionDialogTimer(Rp),Gp.label=4;case 4:return Gp.trys.push([4,11,,13]),this.stream.isSendScreen()&&navigator.mediaDevices.getDisplayMedia&&!gp.isElectron()?[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:this.properties.audioSource==="screen"})]:[3,7];case 5:return jp=Gp.sent(),this.openvidu.addAlreadyProvidedTracks(zp,jp),[4,Pp(jp,Fp)];case 6:return Gp.sent(),[3,10];case 7:return this.stream.lastVideoTrackConstraints=Ap.video,[4,navigator.mediaDevices.getUserMedia(Ap)];case 8:return jp=Gp.sent(),this.openvidu.addAlreadyProvidedTracks(zp,jp,this.stream),[4,Pp(jp,Fp)];case 9:Gp.sent(),Gp.label=10;case 10:return[3,13];case 11:return Lp=Gp.sent(),[4,$p(Lp)];case 12:return Gp.sent(),[3,13];case 13:return[3,15];case 14:return Bp=Gp.sent(),Mp(Bp),[3,15];case 15:return[2]}})})})},_p.prototype.replaceTrackAux=function(vp,bp){return _d(this,void 0,void 0,function(){var Ep,Sp;return np(this,function(Ap){switch(Ap.label){case 0:Ep=vp.enabled,vp.kind==="video"?vp.enabled=this.stream.videoActive:vp.kind==="audio"&&(vp.enabled=this.stream.audioActive),Ap.label=1;case 1:return Ap.trys.push([1,5,,6]),this.stream.isLocalStreamPublished?(this.replaceTrackInMediaStream(vp,bp),[4,this.replaceTrackInRtcRtpSender(vp)]):[3,3];case 2:return[2,Ap.sent()];case 3:return[2,this.replaceTrackInMediaStream(vp,bp)];case 4:return[3,6];case 5:throw Sp=Ap.sent(),vp.enabled=Ep,Sp;case 6:return[2]}})})},_p.prototype.getVideoDimensions=function(){var vp=this;return new Promise(function(bp,Ep){var Sp=(gp.isIonicIos()||gp.isIOSWithSafari())&&vp.videoReference.readyState<1,Ap,Rp=function(){var Tp,Mp;if(typeof vp.stream.getMediaStream().getVideoTracks()[0].getSettings=="function"){var Op=vp.stream.getMediaStream().getVideoTracks()[0].getSettings();Tp=Op.width||vp.videoReference.videoWidth,Mp=Op.height||vp.videoReference.videoHeight}else mp.warn("MediaStreamTrack does not have getSettings method on "+gp.getDescription()),Tp=vp.videoReference.videoWidth,Mp=vp.videoReference.videoHeight;return Ap!=null&&vp.videoReference.removeEventListener("loadedmetadata",Ap),Sp&&document.body.removeChild(vp.videoReference),bp({width:Tp,height:Mp})};vp.videoReference.readyState>=1?Rp():(Ap=function(){if(vp.videoReference.videoWidth)Rp();else var Tp=setInterval(function(){vp.videoReference.videoWidth&&(clearInterval(Tp),Rp())},40)},vp.videoReference.addEventListener("loadedmetadata",Ap),Sp&&document.body.appendChild(vp.videoReference))})},_p.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},_p.prototype.initializeVideoReference=function(vp){this.videoReference=document.createElement("video"),this.videoReference.style.display="none",this.videoReference.muted=!0,this.videoReference.autoplay=!0,this.videoReference.controls=!1,(gp.isSafariBrowser()||gp.isIPhoneOrIPad()&&(gp.isChromeMobileBrowser()||gp.isEdgeMobileBrowser()||gp.isOperaMobileBrowser()||gp.isFirefoxMobileBrowser()))&&(this.videoReference.playsInline=!0),this.stream.setMediaStream(vp),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=this.stream.getMediaStream()},_p.prototype.replaceTrackInMediaStream=function(vp,bp){var Ep=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),Sp;vp.kind==="video"?(Sp=Ep.getVideoTracks()[0],bp&&(this.stream.lastVideoTrackConstraints=vp.getConstraints())):Sp=Ep.getAudioTracks()[0],Sp.enabled=!1,Sp.stop(),Ep.removeTrack(Sp),Ep.addTrack(vp);var Ap={oldLabel:(Sp==null?void 0:Sp.label)||"",newLabel:(vp==null?void 0:vp.label)||""};vp.kind==="video"&&bp?(this.openvidu.sendNewVideoDimensionsIfRequired(this,"trackReplaced",50,30),this.openvidu.sendTrackChangedEvent(this,Ap.oldLabel,Ap.newLabel,"videoTrack"),this.stream.isLocalStreamPublished&&this.session.sendVideoData(this.stream.streamManager,5,!0,5)):vp.kind==="audio"&&bp&&this.openvidu.sendTrackChangedEvent(this,Ap.oldLabel,Ap.newLabel,"audioTrack"),vp.kind==="audio"&&(this.stream.disableHarkSpeakingEvent(!1),this.stream.disableHarkStoppedSpeakingEvent(!1),this.stream.disableHarkVolumeChangeEvent(!1),this.stream.initHarkEvents())},_p.prototype.setPermissionDialogTimer=function(vp){var bp=this;this.permissionDialogTimeout=setTimeout(function(){bp.emitEvent("accessDialogOpened",[])},vp)},_p.prototype.clearPermissionDialogTimer=function(vp,bp){clearTimeout(this.permissionDialogTimeout),Date.now()-vp>bp&&this.emitEvent("accessDialogClosed",[])},_p.prototype.replaceTrackInRtcRtpSender=function(vp){return _d(this,void 0,void 0,function(){var bp,Ep;return np(this,function(Sp){switch(Sp.label){case 0:if(bp=this.stream.getRTCPeerConnection().getSenders(),vp.kind==="video"){if(Ep=bp.find(function(Ap){return!!Ap.track&&Ap.track.kind==="video"}),!Ep)throw new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else if(vp.kind==="audio"){if(Ep=bp.find(function(Ap){return!!Ap.track&&Ap.track.kind==="audio"}),!Ep)throw new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else throw new Error("Unknown track kind "+vp.kind);return[4,Ep.replaceTrack(vp)];case 1:return Sp.sent(),[2]}})})},_p}(lp.StreamManager);return Publisher.Publisher=yp,Publisher}var ScreenCapturingAuto={};globalThis.getScreenId=function(rp,_d,np){if(navigator.userAgent.indexOf("Edge")!==-1&&(navigator.msSaveOrOpenBlob||navigator.msSaveBlob)){_d({video:!0});return}if(navigator.mozGetUserMedia){_d(null,"firefox",{video:{mozMediaSource:rp,mediaSource:rp}});return}globalThis.addEventListener("message",ap);function ap(sp){sp.data&&(sp.data.chromeMediaSourceId&&(sp.data.chromeMediaSourceId==="PermissionDeniedError"?_d("permission-denied"):_d(null,sp.data.chromeMediaSourceId,getScreenConstraints$1(null,sp.data.chromeMediaSourceId,sp.data.canRequestAudioTrack)),globalThis.removeEventListener("message",ap)),sp.data.chromeExtensionStatus&&(_d(sp.data.chromeExtensionStatus,null,getScreenConstraints$1(sp.data.chromeExtensionStatus)),globalThis.removeEventListener("message",ap)))}setTimeout(np?function(){postGetSourceIdMessage(np)}:postGetSourceIdMessage,100)};function getScreenConstraints$1(rp,_d,np){var ap={audio:!1,video:{mandatory:{chromeMediaSource:rp?"screen":"desktop",maxWidth:globalThis.screen.width>1920?globalThis.screen.width:1920,maxHeight:globalThis.screen.height>1080?globalThis.screen.height:1080},optional:[]}};return np&&(ap.audio={mandatory:{chromeMediaSource:rp?"screen":"desktop"},optional:[]}),_d&&(ap.video.mandatory.chromeMediaSourceId=_d,ap.audio&&ap.audio.mandatory&&(ap.audio.mandatory.chromeMediaSourceId=_d)),ap}function postGetSourceIdMessage(rp){if(!iframe){loadIFrame(function(){postGetSourceIdMessage(rp)});return}if(!iframe.isLoaded){setTimeout(function(){postGetSourceIdMessage(rp)},100);return}rp?rp.forEach?iframe.contentWindow.postMessage({captureCustomSourceId:rp},"*"):iframe.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):iframe.contentWindow.postMessage({captureSourceId:!0},"*")}var iframe;globalThis.getScreenConstraints=function(rp){loadIFrame(function(){getScreenId(function(_d,np,ap){ap||(ap={video:!0}),rp(_d,ap.video)})})};function loadIFrame(rp){if(iframe){rp();return}iframe=document.createElement("iframe"),iframe.onload=function(){iframe.isLoaded=!0,rp()},iframe.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",iframe.style.display="none",(document.body||document.documentElement).appendChild(iframe)}globalThis.getChromeExtensionStatus=function(rp){if(navigator.mozGetUserMedia){rp("installed-enabled");return}globalThis.addEventListener("message",_d);function _d(np){np.data&&np.data.chromeExtensionStatus&&(rp(np.data.chromeExtensionStatus),globalThis.removeEventListener("message",_d))}setTimeout(postGetChromeExtensionStatusMessage,100)};function postGetChromeExtensionStatusMessage(){if(!iframe){loadIFrame(postGetChromeExtensionStatusMessage);return}if(!iframe.isLoaded){setTimeout(postGetChromeExtensionStatusMessage,100);return}iframe.contentWindow.postMessage({getChromeExtensionStatus:!0},"*")}ScreenCapturingAuto.getScreenId=globalThis.getScreenId;var ScreenCapturing={},chromeMediaSource="screen",sourceId,screenCallback;if(typeof window<"u"&&typeof navigator<"u"&&typeof navigator.userAgent<"u"){var isFirefox=typeof window.InstallTrigger<"u";window.opera||navigator.userAgent.indexOf(" OPR/")>=0,window.addEventListener("message",function(rp){rp.origin==window.location.origin&&onMessageCallback(rp.data)})}function onMessageCallback(rp){if(rp=="PermissionDeniedError"){if(screenCallback)return screenCallback("PermissionDeniedError");throw new Error("PermissionDeniedError")}rp=="rtcmulticonnection-extension-loaded"&&(chromeMediaSource="desktop"),rp.sourceId&&screenCallback&&screenCallback(sourceId=rp.sourceId,rp.canRequestAudioTrack===!0)}function isChromeExtensionAvailable(rp){if(rp){if(chromeMediaSource=="desktop")return rp(!0);window.postMessage("are-you-there","*"),setTimeout(function(){chromeMediaSource=="screen"?rp(!1):rp(!0)},2e3)}}function getSourceId(rp){if(!rp)throw'"callback" parameter is mandatory.';if(sourceId)return rp(sourceId);screenCallback=rp,window.postMessage("get-sourceId","*")}function getSourceIdWithAudio(rp){if(!rp)throw'"callback" parameter is mandatory.';if(sourceId)return rp(sourceId);screenCallback=rp,window.postMessage("audio-plus-tab","*")}function getChromeExtensionStatus(rp,_d){if(isFirefox)return _d("not-chrome");arguments.length!=2&&(_d=rp,rp="lfcgfepafnobdloecchnfaclibenjold");var np=document.createElement("img");np.src="chrome-extension://"+rp+"/icon.png",np.onload=function(){chromeMediaSource="screen",window.postMessage("are-you-there","*"),setTimeout(function(){chromeMediaSource=="screen"?_d("installed-disabled"):_d("installed-enabled")},2e3)},np.onerror=function(){_d("not-installed")}}function getScreenConstraintsWithAudio(rp){getScreenConstraints(rp,!0)}function getScreenConstraints(rp,_d){sourceId="";var np={mozMediaSource:"window",mediaSource:"window"};if(isFirefox)return rp(null,np);var ap={mandatory:{chromeMediaSource,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};if(chromeMediaSource=="desktop"&&!sourceId){_d?getSourceIdWithAudio(function(sp,lp){ap.mandatory.chromeMediaSourceId=sp,lp&&(ap.canRequestAudioTrack=!0),rp(sp=="PermissionDeniedError"?sp:null,ap)}):getSourceId(function(sp){ap.mandatory.chromeMediaSourceId=sp,rp(sp=="PermissionDeniedError"?sp:null,ap)});return}chromeMediaSource=="desktop"&&(ap.mandatory.chromeMediaSourceId=sourceId),rp(null,ap)}ScreenCapturing.getScreenConstraints=getScreenConstraints;ScreenCapturing.getScreenConstraintsWithAudio=getScreenConstraintsWithAudio;ScreenCapturing.isChromeExtensionAvailable=isChromeExtensionAvailable;ScreenCapturing.getChromeExtensionStatus=getChromeExtensionStatus;ScreenCapturing.getSourceId=getSourceId;var events={exports:{}},R=typeof Reflect=="object"?Reflect:null,ReflectApply=R&&typeof R.apply=="function"?R.apply:function rp(_d,np,ap){return Function.prototype.apply.call(_d,np,ap)},ReflectOwnKeys;R&&typeof R.ownKeys=="function"?ReflectOwnKeys=R.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(_d){return Object.getOwnPropertyNames(_d).concat(Object.getOwnPropertySymbols(_d))}:ReflectOwnKeys=function(_d){return Object.getOwnPropertyNames(_d)};function ProcessEmitWarning(rp){console&&console.warn&&console.warn(rp)}var NumberIsNaN=Number.isNaN||function rp(_d){return _d!==_d};function EventEmitter$1(){EventEmitter$1.init.call(this)}events.exports=EventEmitter$1;events.exports.once=once;EventEmitter$1.EventEmitter=EventEmitter$1;EventEmitter$1.prototype._events=void 0;EventEmitter$1.prototype._eventsCount=0;EventEmitter$1.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(rp){if(typeof rp!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof rp)}Object.defineProperty(EventEmitter$1,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(rp){if(typeof rp!="number"||rp<0||NumberIsNaN(rp))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+rp+".");defaultMaxListeners=rp}});EventEmitter$1.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter$1.prototype.setMaxListeners=function rp(_d){if(typeof _d!="number"||_d<0||NumberIsNaN(_d))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+_d+".");return this._maxListeners=_d,this};function _getMaxListeners(rp){return rp._maxListeners===void 0?EventEmitter$1.defaultMaxListeners:rp._maxListeners}EventEmitter$1.prototype.getMaxListeners=function rp(){return _getMaxListeners(this)};EventEmitter$1.prototype.emit=function rp(_d){for(var np=[],ap=1;ap<arguments.length;ap++)np.push(arguments[ap]);var sp=_d==="error",lp=this._events;if(lp!==void 0)sp=sp&&lp.error===void 0;else if(!sp)return!1;if(sp){var up;if(np.length>0&&(up=np[0]),up instanceof Error)throw up;var cp=new Error("Unhandled error."+(up?" ("+up.message+")":""));throw cp.context=up,cp}var dp=lp[_d];if(dp===void 0)return!1;if(typeof dp=="function")ReflectApply(dp,this,np);else for(var hp=dp.length,fp=arrayClone(dp,hp),ap=0;ap<hp;++ap)ReflectApply(fp[ap],this,np);return!0};function _addListener(rp,_d,np,ap){var sp,lp,up;if(checkListener(np),lp=rp._events,lp===void 0?(lp=rp._events=Object.create(null),rp._eventsCount=0):(lp.newListener!==void 0&&(rp.emit("newListener",_d,np.listener?np.listener:np),lp=rp._events),up=lp[_d]),up===void 0)up=lp[_d]=np,++rp._eventsCount;else if(typeof up=="function"?up=lp[_d]=ap?[np,up]:[up,np]:ap?up.unshift(np):up.push(np),sp=_getMaxListeners(rp),sp>0&&up.length>sp&&!up.warned){up.warned=!0;var cp=new Error("Possible EventEmitter memory leak detected. "+up.length+" "+String(_d)+" listeners added. Use emitter.setMaxListeners() to increase limit");cp.name="MaxListenersExceededWarning",cp.emitter=rp,cp.type=_d,cp.count=up.length,ProcessEmitWarning(cp)}return rp}EventEmitter$1.prototype.addListener=function rp(_d,np){return _addListener(this,_d,np,!1)};EventEmitter$1.prototype.on=EventEmitter$1.prototype.addListener;EventEmitter$1.prototype.prependListener=function rp(_d,np){return _addListener(this,_d,np,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(rp,_d,np){var ap={fired:!1,wrapFn:void 0,target:rp,type:_d,listener:np},sp=onceWrapper.bind(ap);return sp.listener=np,ap.wrapFn=sp,sp}EventEmitter$1.prototype.once=function rp(_d,np){return checkListener(np),this.on(_d,_onceWrap(this,_d,np)),this};EventEmitter$1.prototype.prependOnceListener=function rp(_d,np){return checkListener(np),this.prependListener(_d,_onceWrap(this,_d,np)),this};EventEmitter$1.prototype.removeListener=function rp(_d,np){var ap,sp,lp,up,cp;if(checkListener(np),sp=this._events,sp===void 0)return this;if(ap=sp[_d],ap===void 0)return this;if(ap===np||ap.listener===np)--this._eventsCount===0?this._events=Object.create(null):(delete sp[_d],sp.removeListener&&this.emit("removeListener",_d,ap.listener||np));else if(typeof ap!="function"){for(lp=-1,up=ap.length-1;up>=0;up--)if(ap[up]===np||ap[up].listener===np){cp=ap[up].listener,lp=up;break}if(lp<0)return this;lp===0?ap.shift():spliceOne(ap,lp),ap.length===1&&(sp[_d]=ap[0]),sp.removeListener!==void 0&&this.emit("removeListener",_d,cp||np)}return this};EventEmitter$1.prototype.off=EventEmitter$1.prototype.removeListener;EventEmitter$1.prototype.removeAllListeners=function rp(_d){var np,ap,sp;if(ap=this._events,ap===void 0)return this;if(ap.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):ap[_d]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete ap[_d]),this;if(arguments.length===0){var lp=Object.keys(ap),up;for(sp=0;sp<lp.length;++sp)up=lp[sp],up!=="removeListener"&&this.removeAllListeners(up);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(np=ap[_d],typeof np=="function")this.removeListener(_d,np);else if(np!==void 0)for(sp=np.length-1;sp>=0;sp--)this.removeListener(_d,np[sp]);return this};function _listeners(rp,_d,np){var ap=rp._events;if(ap===void 0)return[];var sp=ap[_d];return sp===void 0?[]:typeof sp=="function"?np?[sp.listener||sp]:[sp]:np?unwrapListeners(sp):arrayClone(sp,sp.length)}EventEmitter$1.prototype.listeners=function rp(_d){return _listeners(this,_d,!0)};EventEmitter$1.prototype.rawListeners=function rp(_d){return _listeners(this,_d,!1)};EventEmitter$1.listenerCount=function(rp,_d){return typeof rp.listenerCount=="function"?rp.listenerCount(_d):listenerCount.call(rp,_d)};EventEmitter$1.prototype.listenerCount=listenerCount;function listenerCount(rp){var _d=this._events;if(_d!==void 0){var np=_d[rp];if(typeof np=="function")return 1;if(np!==void 0)return np.length}return 0}EventEmitter$1.prototype.eventNames=function rp(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(rp,_d){for(var np=new Array(_d),ap=0;ap<_d;++ap)np[ap]=rp[ap];return np}function spliceOne(rp,_d){for(;_d+1<rp.length;_d++)rp[_d]=rp[_d+1];rp.pop()}function unwrapListeners(rp){for(var _d=new Array(rp.length),np=0;np<_d.length;++np)_d[np]=rp[np].listener||rp[np];return _d}function once(rp,_d){return new Promise(function(np,ap){function sp(up){rp.removeListener(_d,lp),ap(up)}function lp(){typeof rp.removeListener=="function"&&rp.removeListener("error",sp),np([].slice.call(arguments))}eventTargetAgnosticAddListener(rp,_d,lp,{once:!0}),_d!=="error"&&addErrorHandlerIfEventEmitter(rp,sp,{once:!0})})}function addErrorHandlerIfEventEmitter(rp,_d,np){typeof rp.on=="function"&&eventTargetAgnosticAddListener(rp,"error",_d,np)}function eventTargetAgnosticAddListener(rp,_d,np,ap){if(typeof rp.on=="function")ap.once?rp.once(_d,np):rp.on(_d,np);else if(typeof rp.addEventListener=="function")rp.addEventListener(_d,function sp(lp){ap.once&&rp.removeEventListener(_d,sp),np(lp)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof rp)}var eventsExports=events.exports,inherits_browser={exports:{}};typeof Object.create=="function"?inherits_browser.exports=function(_d,np){np&&(_d.super_=np,_d.prototype=Object.create(np.prototype,{constructor:{value:_d,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(_d,np){if(np){_d.super_=np;var ap=function(){};ap.prototype=np.prototype,_d.prototype=new ap,_d.prototype.constructor=_d}};var inherits_browserExports=inherits_browser.exports,packers={},JsonRPC$1={};function pack$1(rp,_d){var np={jsonrpc:"2.0"};if(rp.method)np.method=rp.method,rp.params&&(np.params=rp.params),_d!=null&&(np.id=_d);else if(_d!=null){if(rp.error){if(rp.result!==void 0)throw new TypeError("Both result and error are defined");np.error=rp.error}else if(rp.result!==void 0)np.result=rp.result;else throw new TypeError("No result or error is defined");np.id=_d}return JSON.stringify(np)}function unpack$1(rp){var _d=rp;(typeof rp=="string"||rp instanceof String)&&(_d=JSON.parse(rp));var np=_d.jsonrpc;if(np!=="2.0")throw new TypeError("Invalid JsonRPC version '"+np+"': "+rp);if(_d.method==null){if(_d.id==null)throw new TypeError("Invalid message: "+rp);var ap=_d.result!==void 0,sp=_d.error!==void 0;if(ap&&sp)throw new TypeError("Both result and error are defined: "+rp);if(!ap&&!sp)throw new TypeError("No result or error is defined: "+rp);_d.ack=_d.id,delete _d.id}return _d}JsonRPC$1.pack=pack$1;JsonRPC$1.unpack=unpack$1;var XmlRPC$1={};function pack(rp){throw new TypeError("Not yet implemented")}function unpack(rp){throw new TypeError("Not yet implemented")}XmlRPC$1.pack=pack;XmlRPC$1.unpack=unpack;var JsonRPC=JsonRPC$1,XmlRPC=XmlRPC$1;packers.JsonRPC=JsonRPC;packers.XmlRPC=XmlRPC;function Mapper(){var rp={};this.forEach=function(_d){for(var np in rp){var ap=rp[np];for(var sp in ap)_d(ap[sp])}},this.get=function(_d,np){var ap=rp[np];if(ap!=null)return ap[_d]},this.remove=function(_d,np){var ap=rp[np];if(ap!=null){delete ap[_d];for(var sp in ap)return!1;delete rp[np]}},this.set=function(_d,np,ap){if(_d==null)return this.remove(np,ap);var sp=rp[ap];sp==null&&(rp[ap]=sp={}),sp[np]=_d}}Mapper.prototype.pop=function(rp,_d){var np=this.get(rp,_d);if(np!=null)return this.remove(rp,_d),np};var Mapper_1=Mapper,clients={},webSocketWithReconnection,hasRequiredWebSocketWithReconnection;function requireWebSocketWithReconnection(){if(hasRequiredWebSocketWithReconnection)return webSocketWithReconnection;hasRequiredWebSocketWithReconnection=1;var rp=OpenViduLogger$1.OpenViduLogger,_d=rp.getInstance(),np=2e3,ap=3e3,sp=3;function lp(up){var cp=!1,dp,hp=up.uri,fp=!1,pp=new WebSocket(hp);pp.onopen=function(){_d.debug("WebSocket connected to "+hp),up.onconnected&&up.onconnected()},pp.onerror=function(_p){_d.error("Could not connect to "+hp+" (invoking onerror if defined)",_p),up.onerror&&up.onerror(_p)};var mp=function(){pp.readyState===sp?cp?_d.debug("Connection closed by user"):up.ismasternodecrashed()?_d.error("Master Node has crashed. Stopping reconnection process"):(_d.debug("Connection closed unexpectedly. Reconnecting..."),gp(np,1)):_d.debug("Close callback from previous websocket. Ignoring it")};pp.onclose=mp;function gp(_p,vp){if(_d.debug("reconnect (attempt #"+vp+", max="+_p+")"),vp===1){if(fp){_d.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");return}else fp=!0;up.onreconnecting&&up.onreconnecting()}xp(_p,vp)}function yp(_p){var vp=new URLSearchParams(new URL(_p).search);return vp.has("reconnect")||(_p=Array.from(vp).length>0?_p+"&reconnect=true":_p+"?reconnect=true"),_p}function xp(_p,vp){_d.debug("Reconnection attempt #"+vp),pp.close(4104,"Connection closed for reconnection"),hp=yp(hp),pp=new WebSocket(hp),pp.onopen=function(){_d.debug("Reconnected to "+hp+" after "+vp+" attempts..."),fp=!1,dp(),up.onreconnected&&up.onreconnected(),pp.onclose=mp},pp.onerror=function(bp){_d.warn("Reconnection error: ",bp),vp===_p?up.ondisconnect&&up.ondisconnect():setTimeout(function(){gp(_p,vp+1)},ap)}}this.close=function(_p,vp){cp=!0,pp.close(_p,vp)},this.reconnectWs=function(){_d.debug("reconnectWs"),gp(np,1)},this.send=function(_p){pp.send(_p)},this.addEventListener=function(_p,vp){dp=function(){pp.addEventListener(_p,vp)},dp()},this.getReadyState=function(){return pp.readyState}}return webSocketWithReconnection=lp,webSocketWithReconnection}var jsonrpcclient,hasRequiredJsonrpcclient;function requireJsonrpcclient(){if(hasRequiredJsonrpcclient)return jsonrpcclient;hasRequiredJsonrpcclient=1;var rp=requireKurentoJsonrpc(),_d=requireWebSocketWithReconnection(),np=OpenViduLogger$1.OpenViduLogger;Date.now=Date.now||function(){return+new Date};var ap=5e3,sp="RECONNECTING",lp="CONNECTED",up="DISCONNECTED",cp=np.getInstance();function dp(hp){var fp=this,pp=hp.ws,mp=-1,gp=0,yp=!0,xp=!1,_p,vp=up,bp=pp.onreconnecting,Ep=pp.onreconnected,Sp=pp.onconnected,Ap=pp.onerror;hp.rpc.pull=function(Dp,Fp){Fp.reply(null,"push")},pp.onreconnecting=function(){if(cp.debug("--------- ONRECONNECTING -----------"),vp===sp){cp.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it");return}zp(),vp=sp,bp&&bp()},pp.onreconnected=function(){if(cp.debug("--------- ONRECONNECTED -----------"),vp===lp){cp.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it");return}vp=lp,Op(),Ep&&Ep()},pp.onconnected=function(){if(cp.debug("--------- ONCONNECTED -----------"),vp===lp){cp.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it");return}vp=lp,yp=!0,$p(),Sp&&Sp()},pp.onerror=function(Dp){cp.debug("--------- ONERROR -----------"),vp=up,zp(),Ap&&Ap(Dp)};var Rp=new _d(pp);cp.debug("Connecting websocket to URI: "+pp.uri);var Tp={request_timeout:hp.rpc.requestTimeout,ping_request_timeout:hp.rpc.heartbeatRequestTimeout},Mp=new rp(rp.packers.JsonRPC,Tp,Rp,function(Dp){cp.debug("Received request: "+JSON.stringify(Dp));try{var Fp=hp.rpc[Dp.method];Fp===void 0?cp.error("Method "+Dp.method+" not registered in client"):Fp(Dp.params,Dp)}catch(jp){cp.error("Exception processing request: "+JSON.stringify(Dp)),cp.error(jp)}});this.send=function(Dp,Fp,jp){var Lp=Date.now();Mp.encode(Dp,Fp,function(Bp,Ip){if(Bp){try{cp.error("ERROR:"+Bp.message+" in Request: method:"+Dp+" params:"+JSON.stringify(Fp)+" request:"+Bp.request),Bp.data&&cp.error("ERROR DATA:"+JSON.stringify(Bp.data))}catch{}Bp.requestTime=Lp}jp&&(Ip!=null&&Ip.value!=="pong"&&cp.debug("Response: "+JSON.stringify(Ip)),jp(Bp,Ip))})};function Op(){cp.debug("notReconnectIfNumLessThan = "+gp+" (old="+mp+")"),mp=gp}function Pp(){if(yp){var Dp=null;(gp==0||gp==mp)&&(Dp={interval:hp.heartbeat||ap}),gp++,fp.send("ping",Dp,function(Fp){return function(jp,Lp){jp&&(cp.debug("Error in ping request #"+Fp+" ("+jp.message+")"),Fp>mp&&(yp=!1,Op(),cp.debug("Server did not respond to ping message #"+Fp+". Reconnecting... "),Rp.reconnectWs()))}}(gp))}else cp.debug("Trying to send ping, but ping is not enabled")}function $p(){xp||(cp.debug("Starting ping (if configured)"),xp=!0,hp.heartbeat!=null&&(_p=setInterval(Pp,hp.heartbeat),Pp()))}function zp(){clearInterval(_p),xp=!1,yp=!1,gp=-1,Mp.cancel()}this.close=function(Dp,Fp){cp.debug("Closing  with code: "+Dp+" because: "+Fp),_p!=null&&(cp.debug("Clearing ping interval"),clearInterval(_p)),xp=!1,yp=!1,Rp.close(Dp,Fp)},this.reconnect=function(){Rp.reconnectWs()},this.resetPing=function(){yp=!0,gp=0,$p()},this.getReadyState=function(){return Rp.getReadyState()}}return jsonrpcclient=dp,jsonrpcclient}var hasRequiredClients;function requireClients(){if(hasRequiredClients)return clients;hasRequiredClients=1;var rp=requireJsonrpcclient();return clients.JsonRpcClient=rp,clients}var transports={},hasRequiredTransports;function requireTransports(){if(hasRequiredTransports)return transports;hasRequiredTransports=1;var rp=requireWebSocketWithReconnection();return transports.WebSocketWithReconnection=rp,transports}var kurentoJsonrpc,hasRequiredKurentoJsonrpc;function requireKurentoJsonrpc(){if(hasRequiredKurentoJsonrpc)return kurentoJsonrpc;hasRequiredKurentoJsonrpc=1;var rp=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch{rp=!0}Function.prototype.bind||(Function.prototype.bind=function(mp){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var gp=Array.prototype.slice.call(arguments,1),yp=this,xp=function(){},_p=function(){return yp.apply(this instanceof xp&&mp?this:mp,gp.concat(Array.prototype.slice.call(arguments)))};return xp.prototype=this.prototype,_p.prototype=new xp,_p});var _d=eventsExports.EventEmitter,np=inherits_browserExports,ap=packers,sp=Mapper_1,lp=5e3;function up(mp){if(!mp)return{};for(var gp in mp){var yp=mp[gp];typeof yp=="string"&&(mp[gp]={response:yp})}return mp}function cp(mp){if(mp){if(mp instanceof Function)return{send:mp};if(mp.send instanceof Function)return mp;if(mp.postMessage instanceof Function)return mp.send=mp.postMessage,mp;if(mp.write instanceof Function)return mp.send=mp.write,mp;if(mp.onmessage===void 0&&!(mp.pause instanceof Function))throw new SyntaxError("Transport is not a function nor a valid object")}}function dp(mp,gp){rp?(this.method=mp,this.params=gp):(Object.defineProperty(this,"method",{value:mp,enumerable:!0}),Object.defineProperty(this,"params",{value:gp,enumerable:!0}))}function hp(mp,gp,yp,xp){var _p=this;if(!mp)throw new SyntaxError("Packer is not defined");if(!mp.pack||!mp.unpack)throw new SyntaxError("Packer is invalid");var vp=up(mp.responseMethods);if(gp instanceof Function){if(yp!=null)throw new SyntaxError("There can't be parameters after onRequest");xp=gp,yp=void 0,gp=void 0}if(gp&&gp.send instanceof Function){if(yp&&!(yp instanceof Function))throw new SyntaxError("Only a function can be after transport");xp=yp,yp=gp,gp=void 0}if(yp instanceof Function){if(xp!=null)throw new SyntaxError("There can't be parameters after onRequest");xp=yp,yp=void 0}if(yp&&yp.send instanceof Function&&xp&&!(xp instanceof Function))throw new SyntaxError("Only a function can be after transport");gp=gp||{},_d.call(this),xp&&this.on("request",xp),rp?this.peerID=gp.peerID:Object.defineProperty(this,"peerID",{value:gp.peerID});var bp=gp.max_retries||0;function Ep(Bp){_p.decode(Bp.data||Bp)}this.getTransport=function(){return yp},this.setTransport=function(Bp){yp&&(yp.removeEventListener?yp.removeEventListener("message",Ep):yp.removeListener&&yp.removeListener("data",Ep)),Bp&&(Bp.addEventListener?Bp.addEventListener("message",Ep):Bp.addListener&&Bp.addListener("data",Ep)),yp=cp(Bp)},rp||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(yp);var Sp=gp.request_timeout||lp,Ap=gp.ping_request_timeout||Sp,Rp=gp.response_timeout||lp,Tp=gp.duplicates_timeout||lp,Mp=0,Op=new sp,Pp=new sp,$p=new sp,zp={};function Dp(Bp,Ip,kp){var Up={message:Bp,timeout:setTimeout(function(){Pp.remove(Ip,kp)},Rp)};Pp.set(Up,Ip,kp)}function Fp(Bp,Ip){var kp=setTimeout(function(){$p.remove(Bp,Ip)},Tp);$p.set(kp,Bp,Ip)}function jp(Bp,Ip,kp,Up,Gp){dp.call(this,Bp,Ip),this.getTransport=function(){return Gp},this.setTransport=function(Xp){Gp=cp(Xp)},rp||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var Wp=Pp.get(kp,Up);Gp||_p.getTransport()||(rp?this.duplicated=!!Wp:Object.defineProperty(this,"duplicated",{value:!!Wp}));var Qp=vp[Bp];this.pack=mp.pack.bind(mp,this,kp),this.reply=function(Xp,rm,Kp){if(Xp instanceof Function||Xp&&Xp.send instanceof Function){if(rm!=null)throw new SyntaxError("There can't be parameters after callback");Kp=Xp,rm=null,Xp=void 0}else if(rm instanceof Function||rm&&rm.send instanceof Function){if(Kp!=null)throw new SyntaxError("There can't be parameters after callback");Kp=rm,rm=null}Kp=cp(Kp),Wp&&clearTimeout(Wp.timeout),Up!=null&&(Xp&&(Xp.dest=Up),rm&&(rm.dest=Up));var lm;if(Xp||rm!=null){if(_p.peerID!=null&&(Xp?Xp.from=_p.peerID:rm.from=_p.peerID),Qp)if(Qp.error==null&&Xp)lm={error:Xp};else{var cm=Xp?Qp.error:Qp.response;lm={method:cm,params:Xp||rm}}else lm={error:Xp,result:rm};lm=mp.pack(lm,kp)}else Wp?lm=Wp.message:lm=mp.pack({result:null},kp);return Dp(lm,kp,Up),Kp=Kp||this.getTransport()||_p.getTransport(),Kp?Kp.send(lm):lm}}np(jp,dp);function Lp(Bp){var Ip=zp[Bp];if(Ip){delete zp[Bp];var kp=Op.pop(Ip.id,Ip.dest);kp&&(clearTimeout(kp.timeout),Fp(Ip.id,Ip.dest))}}this.cancel=function(Bp){if(Bp)return Lp(Bp);for(var Bp in zp)Lp(Bp)},this.close=function(){var Bp=this.getTransport();Bp&&Bp.close&&Bp.close(4003,"Cancel request"),this.cancel(),$p.forEach(clearTimeout),Pp.forEach(function(Ip){clearTimeout(Ip.timeout)})},this.encode=function(Bp,Ip,kp,Up,Gp){if(Ip instanceof Function){if(kp!=null)throw new SyntaxError("There can't be parameters after callback");Gp=Ip,Up=void 0,kp=void 0,Ip=void 0}else if(kp instanceof Function){if(Up!=null)throw new SyntaxError("There can't be parameters after callback");Gp=kp,Up=void 0,kp=void 0}else if(Up instanceof Function){if(Gp!=null)throw new SyntaxError("There can't be parameters after callback");Gp=Up,Up=void 0}_p.peerID!=null&&(Ip=Ip||{},Ip.from=_p.peerID),kp!=null&&(Ip=Ip||{},Ip.dest=kp);var Wp={method:Bp,params:Ip};if(Gp){let dm=function(mm,fm){_p.cancel(Wp),Gp(mm,fm)},em=function(mm){var fm=Bp==="ping"?Ap:Sp;return rm.timeout=setTimeout(Zp,fm*Math.pow(2,Xp++)),zp[Wp]={id:Qp,dest:kp},Op.set(rm,Qp,kp),mm=mm||Kp||_p.getTransport(),mm?mm.send(Wp):Wp},sm=function(mm){mm=cp(mm),console.warn(Xp+" retry for request message:",Wp);var fm=$p.pop(Qp,kp);return clearTimeout(fm),em(mm)},Zp=function(){if(Xp<bp)return sm(Up);var mm=new Error("Request has timed out");mm.request=Wp,mm.retry=sm,dm(mm)};var lm=dm,cm=em,gm=sm,Mm=Zp,Qp=Mp++,Xp=0;Wp=mp.pack(Wp,Qp);var rm={message:Wp,callback:dm,responseMethods:vp[Bp]||{}},Kp=cp(Up);return em(Up)}return Wp=mp.pack(Wp),Up=Up||this.getTransport(),Up?Up.send(Wp):Wp},this.decode=function(Bp,Ip){if(!Bp)throw new TypeError("Message is not defined");try{Bp=mp.unpack(Bp)}catch(Zp){return console.debug(Zp,Bp)}var kp=Bp.id,Up=Bp.ack,Gp=Bp.method,Wp=Bp.params||{},Qp=Wp.from,Xp=Wp.dest;if(_p.peerID!=null&&Qp==_p.peerID)return;if(kp==null&&Up==null){var rm=new dp(Gp,Wp);return _p.emit("request",rm)?void 0:rm}function Kp(){if(Ip=cp(Ip)||_p.getTransport(),Ip){var Zp=Pp.get(kp,Qp);if(Zp)return Ip.send(Zp.message)}var mm=kp??Up,fm=new jp(Gp,Wp,mm,Qp,Ip);if(!_p.emit("request",fm))return fm}function lm(Zp,mm,fm){Zp.callback(mm,fm)}function cm(Zp){console.warn("Response already processed",Bp),clearTimeout(Zp),Fp(Up,Qp)}if(Gp){if(Xp==null||Xp==_p.peerID){var sm=Op.get(Up,Qp);if(sm){var gm=sm.responseMethods;return Gp==gm.error?lm(sm,Wp):Gp==gm.response?lm(sm,null,Wp):Kp()}var Mm=$p.get(Up,Qp);if(Mm)return cm(Mm)}return Kp()}var dm=Bp.error,em=Bp.result;if(!(dm&&dm.dest&&dm.dest!=_p.peerID)&&!(em&&em.dest&&em.dest!=_p.peerID)){var sm=Op.get(Up,Qp);if(!sm){var Mm=$p.get(Up,Qp);return Mm?cm(Mm):console.warn("No callback was defined for this message",Bp)}lm(sm,dm,em)}}}np(hp,_d),hp.RpcNotification=dp,kurentoJsonrpc=hp;var fp=requireClients(),pp=requireTransports();return hp.clients=fp,hp.clients.transports=pp,hp.packers=ap,kurentoJsonrpc}const author="OpenVidu",dependencies={freeice:"2.2.2",hark:"1.2.3",jsnlog:"2.30.0",mime:"3.0.0",platform:"1.3.6",semver:"7.3.8",uuid:"9.0.0","wolfy87-eventemitter":"5.2.9",events:"3.3.0",inherits:"2.0.4"},description="OpenVidu Browser",devDependencies={"@types/node":"18.11.9","@types/platform":"1.3.4",browserify:"17.0.0",grunt:"1.5.3","grunt-cli":"1.4.3","grunt-contrib-copy":"1.0.0","grunt-contrib-sass":"2.0.0","grunt-contrib-uglify":"5.2.2","grunt-contrib-watch":"1.1.0","grunt-postcss":"0.9.0","grunt-string-replace":"1.3.3","grunt-ts":"6.0.0-beta.22",terser:"5.15.1",tsify:"5.0.4",tslint:"6.1.3",typedoc:"0.23.21",typescript:"4.9.3"},license="Apache-2.0",main="lib/index.js",name="openvidu-browser",repository={type:"git",url:"git://github.com/OpenVidu/openvidu"},scripts={browserify:"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js",build:"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost && rm -rf ./ts4.4 && mkdir -p ./ts4.4/lib && cp -r ./lib ./ts4.4 && find ./ts4.4/lib -type f ! -iname '*.d.ts' -delete && ./config/replace_for_ts44.sh",docs:"./generate-docs.sh"},types="lib/index.d.ts",typesVersions={"<4.4":{"*":["ts4.4/*"]}},version$1="2.29.1",require$$14={author,dependencies,description,devDependencies,license,main,name,repository,scripts,types,typesVersions,version:version$1};var __awaiter=commonjsGlobal&&commonjsGlobal.__awaiter||function(rp,_d,np,ap){function sp(lp){return lp instanceof np?lp:new np(function(up){up(lp)})}return new(np||(np=Promise))(function(lp,up){function cp(fp){try{hp(ap.next(fp))}catch(pp){up(pp)}}function dp(fp){try{hp(ap.throw(fp))}catch(pp){up(pp)}}function hp(fp){fp.done?lp(fp.value):sp(fp.value).then(cp,dp)}hp((ap=ap.apply(rp,_d||[])).next())})},__generator=commonjsGlobal&&commonjsGlobal.__generator||function(rp,_d){var np={label:0,sent:function(){if(lp[0]&1)throw lp[1];return lp[1]},trys:[],ops:[]},ap,sp,lp,up;return up={next:cp(0),throw:cp(1),return:cp(2)},typeof Symbol=="function"&&(up[Symbol.iterator]=function(){return this}),up;function cp(hp){return function(fp){return dp([hp,fp])}}function dp(hp){if(ap)throw new TypeError("Generator is already executing.");for(;up&&(up=0,hp[0]&&(np=0)),np;)try{if(ap=1,sp&&(lp=hp[0]&2?sp.return:hp[0]?sp.throw||((lp=sp.return)&&lp.call(sp),0):sp.next)&&!(lp=lp.call(sp,hp[1])).done)return lp;switch(sp=0,lp&&(hp=[hp[0]&2,lp.value]),hp[0]){case 0:case 1:lp=hp;break;case 4:return np.label++,{value:hp[1],done:!1};case 5:np.label++,sp=hp[1],hp=[0];continue;case 7:hp=np.ops.pop(),np.trys.pop();continue;default:if(lp=np.trys,!(lp=lp.length>0&&lp[lp.length-1])&&(hp[0]===6||hp[0]===2)){np=0;continue}if(hp[0]===3&&(!lp||hp[1]>lp[0]&&hp[1]<lp[3])){np.label=hp[1];break}if(hp[0]===6&&np.label<lp[1]){np.label=lp[1],lp=hp;break}if(lp&&np.label<lp[2]){np.label=lp[2],np.ops.push(hp);break}lp[2]&&np.ops.pop(),np.trys.pop();continue}hp=_d.call(rp,np)}catch(fp){hp=[6,fp],sp=0}finally{ap=lp=0}if(hp[0]&5)throw hp[1];return{value:hp[0]?hp[1]:void 0,done:!0}}};Object.defineProperty(OpenVidu$1,"__esModule",{value:!0});OpenVidu$1.OpenVidu=void 0;var LocalRecorder_1=LocalRecorder$1,Publisher_1=requirePublisher(),Session_1=requireSession(),SessionDisconnectedEvent_1=SessionDisconnectedEvent$1,StreamPropertyChangedEvent_1=StreamPropertyChangedEvent$1,OpenViduError_1=OpenViduError,VideoInsertMode_1=VideoInsertMode,OpenViduLogger_1=OpenViduLogger$1,Platform_1=Platform,screenSharingAuto=ScreenCapturingAuto,screenSharing=ScreenCapturing,OpenViduLoggerConfiguration_1=OpenViduLoggerConfiguration,EventEmitter=EventEmitterExports,RpcBuilder=requireKurentoJsonrpc(),packageJson=require$$14,logger=OpenViduLogger_1.OpenViduLogger.getInstance(),platform,OpenVidu=function(){function rp(){var _d=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.stt=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=OpenViduLoggerConfiguration_1.OpenViduLoggerConfiguration.disabled,this.isAtLeastPro=!1,this.isEnterprise=!1,this.ee=new EventEmitter,platform=Platform_1.PlatformUtils.getInstance(),this.libraryVersion=packageJson.version,logger.info("OpenVidu initialized"),logger.info("Platform detected: "+platform.getDescription()),logger.info("openvidu-browser version: "+this.libraryVersion),(platform.isMobileDevice()||platform.isReactNative())&&this.onOrientationChanged(function(){_d.publishers.forEach(function(np){np.stream.isLocalStreamPublished&&np.stream&&np.stream.hasVideo&&_d.sendNewVideoDimensionsIfRequired(np,"deviceRotated",75,10)})})}return rp.prototype.initSession=function(){return this.session=new Session_1.Session(this),this.session},rp.prototype.initPublisher=function(_d,np,ap){var sp;np&&typeof np!="function"?(sp=np,sp={audioSource:typeof sp.audioSource<"u"?sp.audioSource:void 0,frameRate:typeof MediaStreamTrack<"u"&&sp.videoSource instanceof MediaStreamTrack?void 0:typeof sp.frameRate<"u"?sp.frameRate:void 0,insertMode:typeof sp.insertMode<"u"?typeof sp.insertMode=="string"?VideoInsertMode_1.VideoInsertMode[sp.insertMode]:sp.insertMode:VideoInsertMode_1.VideoInsertMode.APPEND,mirror:typeof sp.mirror<"u"?sp.mirror:!0,publishAudio:typeof sp.publishAudio<"u"?sp.publishAudio:!0,publishVideo:typeof sp.publishVideo<"u"?sp.publishVideo:!0,resolution:typeof MediaStreamTrack<"u"&&sp.videoSource instanceof MediaStreamTrack?void 0:typeof sp.resolution<"u"?sp.resolution:"640x480",videoSource:typeof sp.videoSource<"u"?sp.videoSource:void 0,videoSimulcast:sp.videoSimulcast,filter:sp.filter}):sp={insertMode:VideoInsertMode_1.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var lp=new Publisher_1.Publisher(_d,sp,this),up;return np&&typeof np=="function"?up=np:ap&&(up=ap),lp.initialize().then(function(){up!==void 0&&up(void 0),lp.emitEvent("accessAllowed",[])}).catch(function(cp){up!==void 0&&up(cp),lp.emitEvent("accessDenied",[cp])}),this.publishers.push(lp),lp},rp.prototype.initPublisherAsync=function(_d,np){var ap=this;return new Promise(function(sp,lp){var up,cp=function(dp){return dp?lp(dp):sp(up)};np?up=ap.initPublisher(_d,np,cp):up=ap.initPublisher(_d,cp)})},rp.prototype.initLocalRecorder=function(_d){return new LocalRecorder_1.LocalRecorder(_d)},rp.prototype.checkSystemRequirements=function(){return platform.isIPhoneOrIPad()?platform.isIOSWithSafari()||platform.isChromeMobileBrowser()||platform.isFirefoxMobileBrowser()||platform.isOperaMobileBrowser()||platform.isEdgeMobileBrowser()||platform.isIonicIos():platform.isChromeBrowser()||platform.isChromeMobileBrowser()||platform.isFirefoxBrowser()||platform.isFirefoxMobileBrowser()||platform.isOperaBrowser()||platform.isOperaMobileBrowser()||platform.isEdgeBrowser()||platform.isEdgeMobileBrowser()||platform.isSamsungBrowser()||platform.isSafariBrowser()||platform.isAndroidBrowser()||platform.isElectron()||platform.isNodeJs()||platform.isMotorolaEdgeDevice()},rp.prototype.checkScreenSharingCapabilities=function(){return platform.canScreenShare()},rp.prototype.getDevices=function(){return new Promise(function(_d,np){navigator.mediaDevices.enumerateDevices().then(function(ap){var sp,lp=[];if(platform.isIonicAndroid()&&typeof cordova<"u"&&(!((sp=cordova==null?void 0:cordova.plugins)===null||sp===void 0)&&sp.EnumerateDevicesPlugin))cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then(function(up){var cp=[],dp=[],hp=[];return cp=up.filter(function(fp){return fp.kind==="audioinput"}),dp=ap.filter(function(fp){return fp.kind==="videoinput"}),hp=ap.filter(function(fp){return fp.kind==="audioinput"}),dp.forEach(function(fp,pp){if(fp.label)lp.push({kind:fp.kind,deviceId:fp.deviceId,label:fp.label});else{var mp="";pp===0?mp="Front Camera":pp===1?mp="Back Camera":mp="Unknown Camera",lp.push({kind:fp.kind,deviceId:fp.deviceId,label:mp})}}),hp.forEach(function(fp,pp){if(fp.label)lp.push({kind:fp.kind,deviceId:fp.deviceId,label:fp.label});else{var mp="";switch(pp){case 0:mp="Default";break;case 1:var gp=cp.filter(function(_p){return _p.label.includes("Built")})[0];mp=gp?gp.label:"Built-in Microphone";break;case 2:var yp=cp.filter(function(_p){return _p.label.includes("Wired")})[0];yp?mp=yp.label:mp="Headset earpiece";break;case 3:var xp=cp.filter(function(_p){return _p.label.includes("Bluetooth")})[0];mp=xp?xp.label:"Wireless";break;default:mp="Unknown Microphone";break}lp.push({kind:fp.kind,deviceId:fp.deviceId,label:mp})}}),_d(lp)});else return ap.forEach(function(up){(up.kind==="audioinput"||up.kind==="videoinput")&&lp.push({kind:up.kind,deviceId:up.deviceId,label:up.label})}),_d(lp)}).catch(function(ap){return logger.error("Error getting devices",ap),np(ap)})})},rp.prototype.getUserMedia=function(_d){var np,ap;return __awaiter(this,void 0,void 0,function(){var sp,lp,up,hp,cp,pp,mp,dp,hp,fp,pp,mp,gp,yp=this;return __generator(this,function(xp){switch(xp.label){case 0:sp=function(_p,vp){return __awaiter(yp,void 0,void 0,function(){var bp,Ep,Sp,Ap;return __generator(this,function(Rp){switch(Rp.label){case 0:bp=vp.audio===void 0?!0:vp.audio,Ep={audio:bp,video:!1},Rp.label=1;case 1:return Rp.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(Ep)];case 2:return Sp=Rp.sent(),_p.addTrack(Sp.getAudioTracks()[0]),[2,_p];case 3:throw Ap=Rp.sent(),_p.getAudioTracks().forEach(function(Tp){Tp.stop()}),_p.getVideoTracks().forEach(function(Tp){Tp.stop()}),this.generateAudioDeviceError(Ap,Ep);case 4:return[2]}})})},xp.label=1;case 1:return xp.trys.push([1,20,,21]),[4,this.generateMediaConstraints(_d)];case 2:return lp=xp.sent(),lp.videoTrack&&lp.audioTrack||lp.audioTrack&&((np=lp.constraints)===null||np===void 0?void 0:np.video)===!1||lp.videoTrack&&((ap=lp.constraints)===null||ap===void 0?void 0:ap.audio)===!1?[2,this.addAlreadyProvidedTracks(lp,new MediaStream)]:[3,3];case 3:if(lp.videoTrack&&delete lp.constraints.video,lp.audioTrack&&delete lp.constraints.audio,up=!1,typeof _d.videoSource!="string")return[3,12];if(!(_d.videoSource==="screen"||_d.videoSource==="window"||platform.isElectron()&&_d.videoSource.startsWith("screen:")))return[3,12];if(up=!lp.audioTrack&&_d.audioSource!==null&&_d.audioSource!==!1,!(navigator.mediaDevices.getDisplayMedia&&!platform.isElectron()))return[3,11];xp.label=4;case 4:return xp.trys.push([4,9,,10]),[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:_d.audioSource==="screen"})];case 5:return hp=xp.sent(),this.addAlreadyProvidedTracks(lp,hp),up?[4,sp(hp,lp.constraints)]:[3,7];case 6:return[2,xp.sent()];case 7:return[2,hp];case 8:return[3,10];case 9:throw cp=xp.sent(),pp=OpenViduError_1.OpenViduErrorName.SCREEN_CAPTURE_DENIED,mp=cp.toString(),new OpenViduError_1.OpenViduError(pp,mp);case 10:return[3,11];case 11:return[3,12];case 12:dp=up?{video:lp.constraints.video}:lp.constraints,xp.label=13;case 13:return xp.trys.push([13,18,,19]),[4,navigator.mediaDevices.getUserMedia(dp)];case 14:return hp=xp.sent(),this.addAlreadyProvidedTracks(lp,hp),up?[4,sp(hp,lp.constraints)]:[3,16];case 15:return[2,xp.sent()];case 16:return[2,hp];case 17:return[3,19];case 18:throw fp=xp.sent(),pp=void 0,mp=fp.toString(),_d.videoSource!=="screen"?pp=OpenViduError_1.OpenViduErrorName.DEVICE_ACCESS_DENIED:pp=OpenViduError_1.OpenViduErrorName.SCREEN_CAPTURE_DENIED,new OpenViduError_1.OpenViduError(pp,mp);case 19:return[3,21];case 20:throw gp=xp.sent(),gp;case 21:return[2]}})})},rp.prototype.enableProdMode=function(){logger.enableProdMode()},rp.prototype.setAdvancedConfiguration=function(_d){this.advancedConfiguration=_d},rp.prototype.onOrientationChanged=function(_d){globalThis.addEventListener("orientationchange",_d)},rp.prototype.sendNewVideoDimensionsIfRequired=function(_d,np,ap,sp){var lp=this,up,cp,dp,hp,fp=0,pp=((cp=(up=_d==null?void 0:_d.stream)===null||up===void 0?void 0:up.videoDimensions)===null||cp===void 0?void 0:cp.width)||0,mp=((hp=(dp=_d==null?void 0:_d.stream)===null||dp===void 0?void 0:dp.videoDimensions)===null||hp===void 0?void 0:hp.height)||0,gp=setInterval(function(){fp++,fp>sp&&clearTimeout(gp),_d.getVideoDimensions().then(function(yp){(yp.width!==pp||yp.height!==mp)&&(clearTimeout(gp),lp.sendVideoDimensionsChangedEvent(_d,np,pp,mp,yp.width,yp.height))})},ap)},rp.prototype.sendVideoDimensionsChangedEvent=function(_d,np,ap,sp,lp,up){var cp=this;_d.stream.videoDimensions={width:lp||0,height:up||0},this.sendRequest("streamPropertyChanged",{streamId:_d.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(_d.stream.videoDimensions),reason:np},function(dp,hp){dp?logger.error("Error sending 'streamPropertyChanged' event",dp):(cp.session.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1.StreamPropertyChangedEvent(cp.session,_d.stream,"videoDimensions",_d.stream.videoDimensions,{width:ap,height:sp},np)]),_d.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1.StreamPropertyChangedEvent(_d,_d.stream,"videoDimensions",_d.stream.videoDimensions,{width:ap,height:sp},np)]),cp.session.sendVideoData(_d))})},rp.prototype.sendTrackChangedEvent=function(_d,np,ap,sp){var lp=this,up={label:np},cp={label:ap},dp="trackReplaced";_d.stream.isLocalStreamPublished?this.sendRequest("streamPropertyChanged",{streamId:_d.stream.streamId,property:sp,newValue:cp,reason:dp},function(hp,fp){hp?logger.error("Error sending 'streamPropertyChanged' event",hp):(lp.session.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1.StreamPropertyChangedEvent(lp.session,_d.stream,sp,cp,up,dp)]),_d.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1.StreamPropertyChangedEvent(_d,_d.stream,sp,cp,up,dp)]))}):(this.session.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1.StreamPropertyChangedEvent(this.session,_d.stream,sp,cp,up,dp)]),_d.emitEvent("streamPropertyChanged",[new StreamPropertyChangedEvent_1.StreamPropertyChangedEvent(_d,_d.stream,sp,cp,up,dp)]))},rp.prototype.generateMediaConstraints=function(_d){var np=this;return new Promise(function(ap,sp){var lp={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},up=_d.audioSource,cp=_d.videoSource;if((up===null||up===!1)&&(lp.constraints.audio=!1),(cp===null||cp===!1)&&(lp.constraints.video=!1),lp.constraints.audio===!1&&lp.constraints.video===!1)return sp(new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time"));if(typeof MediaStreamTrack<"u"&&up instanceof MediaStreamTrack&&(lp.audioTrack=up),typeof MediaStreamTrack<"u"&&cp instanceof MediaStreamTrack&&(lp.videoTrack=cp),up===void 0&&(lp.constraints.audio=!0),cp===void 0&&(lp.constraints.video={width:{ideal:640},height:{ideal:480}}),cp!==null&&cp!==!1){if(_d.resolution){var dp=_d.resolution.toLowerCase().split("x"),hp=Number(dp[0]),fp=Number(dp[1]);lp.constraints.video={width:{ideal:hp},height:{ideal:fp}}}_d.frameRate&&(lp.constraints.video.frameRate={ideal:_d.frameRate})}return np.configureDeviceIdOrScreensharing(lp,_d,ap,sp),ap(lp)})},rp.prototype.startWs=function(_d){var np={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:_d,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,heartbeatRequestTimeout:5e3,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),broadcastStarted:this.session.onBroadcastStarted.bind(this.session),broadcastStopped:this.session.onBroadcastStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session),speechToTextMessage:this.session.onSpeechToTextMessage.bind(this.session),speechToTextDisconnected:this.session.onSpeechToTextDisconnected.bind(this.session)}};this.jsonRpcClient=new RpcBuilder.clients.JsonRpcClient(np)},rp.prototype.onMasterNodeCrashedNotification=function(_d){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},rp.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},rp.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},rp.prototype.sendRequest=function(_d,np,ap){var sp;np&&np instanceof Function&&(ap=np,np={}),logger.debug('Sending request: {method:"'+_d+'", params: '+JSON.stringify(np)+"}"),(sp=this.jsonRpcClient)===null||sp===void 0||sp.send(_d,np,ap)},rp.prototype.getWsUri=function(){return this.wsUri},rp.prototype.getSecret=function(){return this.secret},rp.prototype.getRecorder=function(){return this.recorder},rp.prototype.getStt=function(){return this.stt},rp.prototype.generateAudioDeviceError=function(_d,np){_d.name==="Error"&&(_d.name=_d.constructor.name);var ap,sp;switch(_d.name.toLowerCase()){case"notfounderror":return ap=OpenViduError_1.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,sp=_d.toString(),new OpenViduError_1.OpenViduError(ap,sp);case"notallowederror":return ap=OpenViduError_1.OpenViduErrorName.DEVICE_ACCESS_DENIED,sp=_d.toString(),new OpenViduError_1.OpenViduError(ap,sp);case"overconstrainederror":return _d.constraint.toLowerCase()==="deviceid"?(ap=OpenViduError_1.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,sp="Audio input device with deviceId '"+np.audio.deviceId.exact+"' not found"):(ap=OpenViduError_1.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,sp="Audio input device doesn't support the value passed for constraint '"+_d.constraint+"'"),new OpenViduError_1.OpenViduError(ap,sp);case"notreadableerror":return ap=OpenViduError_1.OpenViduErrorName.DEVICE_ALREADY_IN_USE,sp=_d.toString(),new OpenViduError_1.OpenViduError(ap,sp);default:return new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,_d.toString())}},rp.prototype.addAlreadyProvidedTracks=function(_d,np,ap){return _d.videoTrack&&(np.addTrack(_d.videoTrack),ap&&(_d.constraints.video?ap.lastVideoTrackConstraints=_d.constraints.video:ap.lastVideoTrackConstraints=_d.videoTrack.getConstraints())),_d.audioTrack&&np.addTrack(_d.audioTrack),np},rp.prototype.configureDeviceIdOrScreensharing=function(_d,np,ap,sp){var lp=this,up=np.audioSource,cp=np.videoSource;if(typeof up=="string"&&up!=="screen"&&(_d.constraints.audio={deviceId:{exact:up}}),typeof cp=="string")if(!this.isScreenShare(cp))this.setVideoSource(_d,cp),up==="screen"&&(logger.warn('Parameter "audioSource" is set to "screen", which means rquesting audio from screen sharing source. But "videoSource" is not set to "screen". No audio source will be requested'),_d.constraints.audio=!1);else if(this.checkScreenSharingCapabilities())if(platform.isElectron()){var hp="screen:",fp=cp,pp=fp.substr(fp.indexOf(hp)+hp.length);return _d.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:pp}},ap(_d)}else if(this.advancedConfiguration.screenShareChromeExtension&&!(platform.isFirefoxBrowser()||platform.isFirefoxMobileBrowser())&&!navigator.mediaDevices.getDisplayMedia){screenSharing.getScreenConstraints(function(gp,yp){if(gp||yp.mandatory&&yp.mandatory.chromeMediaSource==="screen")if(gp==="permission-denied"||gp==="PermissionDeniedError"){var xp=new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return logger.error(xp),sp(xp)}else{var _p=lp.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();screenSharing.getChromeExtensionStatus(_p,function(vp){if(vp==="installed-disabled"){var bp=new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return logger.error(bp),sp(bp)}if(vp==="not-installed"){var Ep=new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,lp.advancedConfiguration.screenShareChromeExtension);return logger.error(Ep),sp(Ep)}});return}else return _d.constraints.video=yp,ap(_d)});return}else{if(navigator.mediaDevices.getDisplayMedia)return ap(_d);var mp=platform.isFirefoxBrowser()||platform.isFirefoxMobileBrowser()?np.videoSource:void 0;screenSharingAuto.getScreenId(mp,function(gp,yp,xp){if(gp)if(gp==="not-installed"){var _p=lp.advancedConfiguration.screenShareChromeExtension?lp.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",vp=new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,_p);return logger.error(vp),sp(vp)}else if(gp==="installed-disabled"){var vp=new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return logger.error(vp),sp(vp)}else if(gp==="permission-denied"){var vp=new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return logger.error(vp),sp(vp)}else{var vp=new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");return logger.error(vp),logger.error(gp),sp(vp)}else return _d.constraints.video=xp.video,ap(_d)});return}else{var dp=new OpenViduError_1.OpenViduError(OpenViduError_1.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+platform.getName()+" "+platform.getVersion());return logger.error(dp),sp(dp)}},rp.prototype.setVideoSource=function(_d,np){_d.constraints.video||(_d.constraints.video={}),_d.constraints.video.deviceId={exact:np}},rp.prototype.disconnectCallback=function(){logger.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},rp.prototype.reconnectingCallback=function(){logger.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},rp.prototype.reconnectWebsocketThroughRpcConnectMethod=function(_d){var np=this;this.sendRequest("connect",{sessionId:_d,reconnect:!0},function(ap,sp){if(ap)if(np.isMasterNodeCrashed())logger.warn("Master Node has crashed!");else{logger.error(ap);var lp=function(cp,dp){logger.warn(dp),np.session.onLostConnection(cp),np.jsonRpcClient.close(4101,"Reconnection fault: "+dp)},up=function(){np.life===-1?lp("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):np.sendRequest("sessionStatus",{sessionId:np.session.sessionId},function(cp,dp){cp!=null?console.error("Error checking session status",cp):np.life===dp.life?lp("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):lp("nodeCrashed","WS successfully reconnected to OpenVidu Server but your Master Node crashed")})};ap.code===40007&&ap.message==="reconnection error"&&console.error("Invalid RPC sessionId. Client network disconnection or Master Node crash"),up()}else np.jsonRpcClient.resetPing(),np.session.onRecoveredConnection()})},rp.prototype.reconnectedCallback=function(){if(logger.warn("Websocket reconnected"),this.isRoomAvailable())if(this.session.connection)this.reconnectWebsocketThroughRpcConnectMethod(this.session.connection.rpcSessionId);else{logger.warn("There was no previous connection when running reconnection callback");var _d=new SessionDisconnectedEvent_1.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[_d]),_d.callDefaultBehavior()}else alert("Connection error. Please reload page.")},rp.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},rp.prototype.isRoomAvailable=function(){return this.session!==void 0&&this.session instanceof Session_1.Session?!0:(logger.warn("Session instance not found"),!1)},rp.prototype.isScreenShare=function(_d){return _d==="screen"||_d==="window"||platform.isElectron()&&_d.startsWith("screen:")},rp}();OpenVidu$1.OpenVidu=OpenVidu;var Types={};Object.defineProperty(Types,"__esModule",{value:!0});(function(rp){var _d=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(Bp,Ip,kp,Up){Up===void 0&&(Up=kp);var Gp=Object.getOwnPropertyDescriptor(Ip,kp);(!Gp||("get"in Gp?!Ip.__esModule:Gp.writable||Gp.configurable))&&(Gp={enumerable:!0,get:function(){return Ip[kp]}}),Object.defineProperty(Bp,Up,Gp)}:function(Bp,Ip,kp,Up){Up===void 0&&(Up=kp),Bp[Up]=Ip[kp]}),np=commonjsGlobal&&commonjsGlobal.__exportStar||function(Bp,Ip){for(var kp in Bp)kp!=="default"&&!Object.prototype.hasOwnProperty.call(Ip,kp)&&_d(Ip,Bp,kp)};Object.defineProperty(rp,"__esModule",{value:!0}),rp.EventDispatcher=rp.ExceptionEventName=rp.ExceptionEvent=rp.SpeechToTextEvent=rp.NetworkQualityLevelChangedEvent=rp.FilterEvent=rp.ConnectionPropertyChangedEvent=rp.StreamPropertyChangedEvent=rp.VideoElementEvent=rp.StreamManagerEvent=rp.StreamEvent=rp.SignalEvent=rp.SessionDisconnectedEvent=rp.RecordingEvent=rp.PublisherSpeakingEvent=rp.ConnectionEvent=rp.Event=rp.VideoInsertMode=rp.TypeOfVideo=rp.OpenViduErrorName=rp.OpenViduError=rp.LocalRecorderState=rp.Filter=rp.LocalRecorder=rp.Connection=rp.Stream=rp.StreamManager=rp.Subscriber=rp.Publisher=rp.Session=rp.OpenVidu=void 0;var ap=jsnlog,sp=OpenVidu$1;Object.defineProperty(rp,"OpenVidu",{enumerable:!0,get:function(){return sp.OpenVidu}});var lp=requireSession();Object.defineProperty(rp,"Session",{enumerable:!0,get:function(){return lp.Session}});var up=requirePublisher();Object.defineProperty(rp,"Publisher",{enumerable:!0,get:function(){return up.Publisher}});var cp=Subscriber$1;Object.defineProperty(rp,"Subscriber",{enumerable:!0,get:function(){return cp.Subscriber}});var dp=StreamManager$1;Object.defineProperty(rp,"StreamManager",{enumerable:!0,get:function(){return dp.StreamManager}});var hp=Stream$1;Object.defineProperty(rp,"Stream",{enumerable:!0,get:function(){return hp.Stream}});var fp=Connection$1;Object.defineProperty(rp,"Connection",{enumerable:!0,get:function(){return fp.Connection}});var pp=LocalRecorder$1;Object.defineProperty(rp,"LocalRecorder",{enumerable:!0,get:function(){return pp.LocalRecorder}});var mp=Filter$1;Object.defineProperty(rp,"Filter",{enumerable:!0,get:function(){return mp.Filter}});var gp=LocalRecorderState;Object.defineProperty(rp,"LocalRecorderState",{enumerable:!0,get:function(){return gp.LocalRecorderState}});var yp=OpenViduError;Object.defineProperty(rp,"OpenViduError",{enumerable:!0,get:function(){return yp.OpenViduError}}),Object.defineProperty(rp,"OpenViduErrorName",{enumerable:!0,get:function(){return yp.OpenViduErrorName}});var xp=TypeOfVideo;Object.defineProperty(rp,"TypeOfVideo",{enumerable:!0,get:function(){return xp.TypeOfVideo}});var _p=VideoInsertMode;Object.defineProperty(rp,"VideoInsertMode",{enumerable:!0,get:function(){return _p.VideoInsertMode}});var vp=Event$2;Object.defineProperty(rp,"Event",{enumerable:!0,get:function(){return vp.Event}});var bp=ConnectionEvent$1;Object.defineProperty(rp,"ConnectionEvent",{enumerable:!0,get:function(){return bp.ConnectionEvent}});var Ep=PublisherSpeakingEvent$1;Object.defineProperty(rp,"PublisherSpeakingEvent",{enumerable:!0,get:function(){return Ep.PublisherSpeakingEvent}});var Sp=RecordingEvent$1;Object.defineProperty(rp,"RecordingEvent",{enumerable:!0,get:function(){return Sp.RecordingEvent}});var Ap=SessionDisconnectedEvent$1;Object.defineProperty(rp,"SessionDisconnectedEvent",{enumerable:!0,get:function(){return Ap.SessionDisconnectedEvent}});var Rp=SignalEvent$1;Object.defineProperty(rp,"SignalEvent",{enumerable:!0,get:function(){return Rp.SignalEvent}});var Tp=requireStreamEvent();Object.defineProperty(rp,"StreamEvent",{enumerable:!0,get:function(){return Tp.StreamEvent}});var Mp=StreamManagerEvent$1;Object.defineProperty(rp,"StreamManagerEvent",{enumerable:!0,get:function(){return Mp.StreamManagerEvent}});var Op=VideoElementEvent$1;Object.defineProperty(rp,"VideoElementEvent",{enumerable:!0,get:function(){return Op.VideoElementEvent}});var Pp=StreamPropertyChangedEvent$1;Object.defineProperty(rp,"StreamPropertyChangedEvent",{enumerable:!0,get:function(){return Pp.StreamPropertyChangedEvent}});var $p=ConnectionPropertyChangedEvent$1;Object.defineProperty(rp,"ConnectionPropertyChangedEvent",{enumerable:!0,get:function(){return $p.ConnectionPropertyChangedEvent}});var zp=FilterEvent$1;Object.defineProperty(rp,"FilterEvent",{enumerable:!0,get:function(){return zp.FilterEvent}});var Dp=NetworkQualityLevelChangedEvent$1;Object.defineProperty(rp,"NetworkQualityLevelChangedEvent",{enumerable:!0,get:function(){return Dp.NetworkQualityLevelChangedEvent}});var Fp=SpeechToTextEvent$1;Object.defineProperty(rp,"SpeechToTextEvent",{enumerable:!0,get:function(){return Fp.SpeechToTextEvent}});var jp=ExceptionEvent;Object.defineProperty(rp,"ExceptionEvent",{enumerable:!0,get:function(){return jp.ExceptionEvent}}),Object.defineProperty(rp,"ExceptionEventName",{enumerable:!0,get:function(){return jp.ExceptionEventName}});var Lp=EventDispatcher$2;Object.defineProperty(rp,"EventDispatcher",{enumerable:!0,get:function(){return Lp.EventDispatcher}}),np(Types,rp),ap.JL.setOptions({enabled:!1})})(lib);class UserModel{constructor(){Zv(this,"connectionId");Zv(this,"audioActive");Zv(this,"videoActive");Zv(this,"screenShareActive");Zv(this,"nickname");Zv(this,"streamManager");Zv(this,"type");this.connectionId="",this.audioActive=!0,this.videoActive=!0,this.screenShareActive=!1,this.nickname="",this.streamManager=null,this.type="local"}isAudioActive(){return this.audioActive}isVideoActive(){return this.videoActive}isScreenShareActive(){return this.screenShareActive}getConnectionId(){return this.connectionId}getNickname(){return this.nickname}getStreamManager(){return this.streamManager}isLocal(){return this.type==="local"}isRemote(){return!this.isLocal()}setAudioActive(_d){this.audioActive=_d}setVideoActive(_d){this.videoActive=_d}setScreenShareActive(_d){this.screenShareActive=_d}setStreamManager(_d){this.streamManager=_d}setConnectionId(_d){this.connectionId=_d}setNickname(_d){this.nickname=_d}setType(_d){_d==="local"|_d==="remote"&&(this.type=_d)}}class OpenViduLayout{constructor(){Zv(this,"layoutContainer");Zv(this,"opts")}fixAspectRatio(_d,np){const ap=_d.querySelector(".OT_root");if(ap){const sp=ap.style.width;ap.style.width=np+"px",ap.style.width=sp||""}}positionElement(_d,np,ap,sp,lp,up){const cp={left:np+"px",top:ap+"px",width:sp+"px",height:lp+"px"};this.fixAspectRatio(_d,sp),up&&$?($(_d).stop(),$(_d).animate(cp,up.duration||200,up.easing||"swing",()=>{this.fixAspectRatio(_d,sp),up.complete&&up.complete.call(this)})):$(_d).css(cp),this.fixAspectRatio(_d,sp)}getVideoRatio(_d){if(!_d)return 3/4;const np=_d.querySelector("video");return np&&np.videoHeight&&np.videoWidth?np.videoHeight/np.videoWidth:_d.videoHeight&&_d.videoWidth?_d.videoHeight/_d.videoWidth:3/4}getCSSNumber(_d,np){const ap=$(_d).css(np);return ap?parseInt(ap,10):0}cheapUUID(){return(Math.random()*1e8).toFixed(0)}getHeight(_d){const np=$(_d).css("height");return np?parseInt(np,10):0}getWidth(_d){const np=$(_d).css("width");return np?parseInt(np,10):0}getBestDimensions(_d,np,ap,sp,lp,up){let cp,dp,hp,fp,pp,mp,gp;for(let yp=1;yp<=ap;yp++){const xp=yp,_p=Math.ceil(ap/xp);mp=Math.floor(lp/_p),pp=Math.floor(sp/xp),gp=mp/pp,gp>np?(gp=np,mp=pp*gp):gp<_d&&(gp=_d,pp=mp/gp);const vp=pp*mp*ap;(cp===void 0||vp>cp)&&(cp=vp,up=mp,fp=pp,dp=xp,hp=_p)}return{maxArea:cp,targetCols:dp,targetRows:hp,targetHeight:up,targetWidth:fp,ratio:up/fp}}arrange(_d,np,ap,sp,lp,up,cp,dp,hp){let fp;const pp=_d.length;let mp;if(!up)mp=this.getBestDimensions(cp,dp,pp,np,ap,fp);else{const Ep=this.getVideoRatio(_d.length>0?_d[0]:null);mp=this.getBestDimensions(Ep,Ep,pp,np,ap,fp)}let gp=0,yp=0;const xp=[];let _p;for(let Ep=0;Ep<_d.length;Ep++){Ep%mp.targetCols===0&&(_p={children:[],width:0,height:0},xp.push(_p));const Sp=_d[Ep];_p.children.push(Sp);let Ap=mp.targetWidth;fp=mp.targetHeight,up&&(Ap=fp/this.getVideoRatio(Sp)),_p.width+=Ap,_p.height=fp}let vp=0,bp=0;for(let Ep=0;Ep<xp.length;Ep++)_p=xp[Ep],_p.width>np?(_p.height=Math.floor(_p.height*(np/_p.width)),_p.width=np):_p.width<np&&(bp+=1),vp+=_p.height;if(vp<ap&&bp>0){let Ep=ap-vp;vp=0;for(let Sp=0;Sp<xp.length;Sp++){if(_p=xp[Sp],_p.width<np){let Ap=Ep/bp;Ap/_p.height>(np-_p.width)/_p.width&&(Ap=Math.floor((np-_p.width)/_p.width*_p.height)),_p.width+=Math.floor(Ap/_p.height*_p.width),_p.height+=Ap,Ep-=Ap,bp-=1}vp+=_p.height}}yp=(ap-vp)/2;for(let Ep=0;Ep<xp.length;Ep++){_p=xp[Ep],gp=(np-_p.width)/2;for(let Ap=0;Ap<_p.children.length;Ap++){const Rp=_p.children[Ap];let Tp=mp.targetWidth;fp=_p.height,up&&(Tp=Math.floor(fp/this.getVideoRatio(Rp))),Rp.style.position="absolute";const Mp=Tp-this.getCSSNumber(Rp,"paddingLeft")-this.getCSSNumber(Rp,"paddingRight")-this.getCSSNumber(Rp,"marginLeft")-this.getCSSNumber(Rp,"marginRight")-this.getCSSNumber(Rp,"borderLeft")-this.getCSSNumber(Rp,"borderRight"),Op=fp-this.getCSSNumber(Rp,"paddingTop")-this.getCSSNumber(Rp,"paddingBottom")-this.getCSSNumber(Rp,"marginTop")-this.getCSSNumber(Rp,"marginBottom")-this.getCSSNumber(Rp,"borderTop")-this.getCSSNumber(Rp,"borderBottom");this.positionElement(Rp,gp+sp,yp+lp,Mp,Op,hp),gp+=Tp}yp+=fp}}filterDisplayNone(_d){return _d.style.display!=="none"}updateLayout(){if(this.layoutContainer.style.display==="none")return;let _d=this.layoutContainer.id;_d||(_d="OT_"+this.cheapUUID(),this.layoutContainer.id=_d);const np=this.getHeight(this.layoutContainer)-this.getCSSNumber(this.layoutContainer,"borderTop")-this.getCSSNumber(this.layoutContainer,"borderBottom"),ap=this.getWidth(this.layoutContainer)-this.getCSSNumber(this.layoutContainer,"borderLeft")-this.getCSSNumber(this.layoutContainer,"borderRight"),sp=np/ap;let lp=0,up=0,cp=0,dp=0;const hp=Array.prototype.filter.call(this.layoutContainer.querySelectorAll("#"+_d+">."+this.opts.bigClass),this.filterDisplayNone),fp=Array.prototype.filter.call(this.layoutContainer.querySelectorAll("#"+_d+">*:not(."+this.opts.bigClass+")"),this.filterDisplayNone);if(hp.length>0&&fp.length>0){let pp,mp;sp>this.getVideoRatio(hp[0])?(pp=ap,mp=Math.floor(np*this.opts.bigPercentage),up=mp,cp=np-up):(mp=np,pp=Math.floor(ap*this.opts.bigPercentage),lp=pp,dp=ap-lp),this.opts.bigFirst?(this.arrange(hp,pp,mp,0,0,this.opts.bigFixedRatio,this.opts.bigMinRatio,this.opts.bigMaxRatio,this.opts.animate),this.arrange(fp,ap-lp,np-up,lp,up,this.opts.fixedRatio,this.opts.minRatio,this.opts.maxRatio,this.opts.animate)):(this.arrange(fp,ap-lp,np-up,0,0,this.opts.fixedRatio,this.opts.minRatio,this.opts.maxRatio,this.opts.animate),this.arrange(hp,pp,mp,dp,cp,this.opts.bigFixedRatio,this.opts.bigMinRatio,this.opts.bigMaxRatio,this.opts.animate))}else hp.length>0&&fp.length===0?this.arrange(hp,ap,np,0,0,this.opts.bigFixedRatio,this.opts.bigMinRatio,this.opts.bigMaxRatio,this.opts.animate):this.arrange(fp,ap-lp,np-up,lp,up,this.opts.fixedRatio,this.opts.minRatio,this.opts.maxRatio,this.opts.animate)}initLayoutContainer(_d,np){this.opts={maxRatio:np.maxRatio!=null?np.maxRatio:3/2,minRatio:np.minRatio!=null?np.minRatio:9/16,fixedRatio:np.fixedRatio!=null?np.fixedRatio:!1,animate:np.animate!=null?np.animate:!1,bigClass:np.bigClass!=null?np.bigClass:"OT_big",bigPercentage:np.bigPercentage!=null?np.bigPercentage:.8,bigFixedRatio:np.bigFixedRatio!=null?np.bigFixedRatio:!1,bigMaxRatio:np.bigMaxRatio!=null?np.bigMaxRatio:3/2,bigMinRatio:np.bigMinRatio!=null?np.bigMinRatio:9/16,bigFirst:np.bigFirst!=null?np.bigFirst:!0},this.layoutContainer=typeof _d=="string"?$(_d):_d}setLayoutOptions(_d){this.opts=_d}}class OvVideoComponent extends reactExports.Component{constructor(_d){super(_d),this.videoRef=React.createRef()}componentDidUpdate(_d){_d&&this.videoRef&&this.props.streamManager.addVideoElement(this.videoRef.current)}componentDidMount(){this.props&&this.videoRef&&this.props.streamManager.addVideoElement(this.videoRef.current)}render(){return jsxRuntimeExports.jsx("video",{autoPlay:!0,ref:this.videoRef})}}class UserVideoComponent extends reactExports.Component{constructor(_d){super(_d),console.log(_d)}render(){return jsxRuntimeExports.jsx("div",{children:this.props.streamManager!==void 0?jsxRuntimeExports.jsx("div",{className:"streamcomponent",children:jsxRuntimeExports.jsx(OvVideoComponent,{streamManager:this.props.streamManager})}):jsxRuntimeExports.jsx("span",{children:" ."})})}}var MicNoneOutlined={},_interopRequireDefault$d=interopRequireDefaultExports;Object.defineProperty(MicNoneOutlined,"__esModule",{value:!0});var default_1$d=MicNoneOutlined.default=void 0,_createSvgIcon$d=_interopRequireDefault$d(requireCreateSvgIcon()),_jsxRuntime$d=jsxRuntimeExports;default_1$d=MicNoneOutlined.default=(0,_createSvgIcon$d.default)((0,_jsxRuntime$d.jsx)("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1zm6 6c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92z"}),"MicNoneOutlined");var MicOffOutlined={},_interopRequireDefault$c=interopRequireDefaultExports;Object.defineProperty(MicOffOutlined,"__esModule",{value:!0});var default_1$c=MicOffOutlined.default=void 0,_createSvgIcon$c=_interopRequireDefault$c(requireCreateSvgIcon()),_jsxRuntime$c=jsxRuntimeExports;default_1$c=MicOffOutlined.default=(0,_createSvgIcon$c.default)((0,_jsxRuntime$c.jsx)("path",{d:"M10.8 4.9c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2l-.01 3.91L15 10.6V5c0-1.66-1.34-3-3-3-1.54 0-2.79 1.16-2.96 2.65l1.76 1.76zM19 11h-1.7c0 .58-.1 1.13-.27 1.64l1.27 1.27c.44-.88.7-1.87.7-2.91M4.41 2.86 3 4.27l6 6V11c0 1.66 1.34 3 3 3 .23 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.55-.9l4.2 4.2 1.41-1.41z"}),"MicOffOutlined");var VideocamOutlined={},_interopRequireDefault$b=interopRequireDefaultExports;Object.defineProperty(VideocamOutlined,"__esModule",{value:!0});var default_1$b=VideocamOutlined.default=void 0,_createSvgIcon$b=_interopRequireDefault$b(requireCreateSvgIcon()),_jsxRuntime$b=jsxRuntimeExports;default_1$b=VideocamOutlined.default=(0,_createSvgIcon$b.default)((0,_jsxRuntime$b.jsx)("path",{d:"M15 8v8H5V8zm1-2H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4V7c0-.55-.45-1-1-1"}),"VideocamOutlined");var VideocamOffOutlined={},_interopRequireDefault$a=interopRequireDefaultExports;Object.defineProperty(VideocamOffOutlined,"__esModule",{value:!0});var default_1$a=VideocamOffOutlined.default=void 0,_createSvgIcon$a=_interopRequireDefault$a(requireCreateSvgIcon()),_jsxRuntime$a=jsxRuntimeExports;default_1$a=VideocamOffOutlined.default=(0,_createSvgIcon$a.default)((0,_jsxRuntime$a.jsx)("path",{d:"m9.56 8-2-2-4.15-4.14L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.55-.18L19.73 21l1.41-1.41-8.86-8.86zM5 16V8h1.73l8 8zm10-8v2.61l6 6V6.5l-4 4V7c0-.55-.45-1-1-1h-5.61l2 2z"}),"VideocamOffOutlined");const group="/assets/Group-cDp7Suxl.svg",ToolbarComponent=({user:rp,isHost:_d,micStatusChanged:np,camStatusChanged:ap,hostNickname:sp,hostProfileImg:lp,setLeaveModal:up,totalUsers:cp})=>{const[dp,hp]=reactExports.useState(!0),[fp,pp]=reactExports.useState(!0);return reactExports.useEffect(()=>{hp(rp.stream.audioActive)},[rp.stream.audioActive]),reactExports.useEffect(()=>{pp(rp.stream.videoActive)},[rp.stream.videoActive]),jsxRuntimeExports.jsxs("div",{className:"toolbar-container",children:[jsxRuntimeExports.jsxs("div",{className:"toolbar-host-info",children:[jsxRuntimeExports.jsx("img",{src:lp,alt:"toolbar-Host profile"}),jsxRuntimeExports.jsx("span",{children:sp})]}),jsxRuntimeExports.jsxs("div",{className:"toolbar-count-subscribers",children:[jsxRuntimeExports.jsx("img",{src:group,alt:""}),cp]}),jsxRuntimeExports.jsxs("div",{className:"toolbar-option-btn",children:[jsxRuntimeExports.jsx(default_1$r,{onClick:()=>up(!0),className:"toolbar-option-icon"}),_d&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[dp?jsxRuntimeExports.jsx(default_1$d,{onClick:np,className:"toolbar-option-icon"}):jsxRuntimeExports.jsx(default_1$c,{onClick:np,className:"toolbar-option-icon"}),fp?jsxRuntimeExports.jsx(default_1$b,{onClick:ap,className:"toolbar-option-icon"}):jsxRuntimeExports.jsx(default_1$a,{onClick:ap,className:"toolbar-option-icon"})]})]})]})},ChattingList=rp=>{const _d=reactExports.useRef(),np=reactExports.useRef(null),ap=reactExports.useRef(null),[sp,lp]=reactExports.useState(!0),up=()=>{ap.current&&clearTimeout(ap.current),ap.current=setTimeout(()=>{const dp=np.current.scrollTop,hp=np.current.clientHeight,fp=np.current.scrollHeight;lp(dp+hp>=fp-100)},100)},cp=reactExports.useCallback(()=>{up()},[]);return reactExports.useEffect(()=>{sp&&_d.current.scrollIntoView({behavior:"smooth"})},[rp.messageList]),reactExports.useEffect(()=>(np.current.addEventListener("scroll",cp),()=>{ap.current&&clearTimeout(ap.current),np.current&&np.current.removeEventListener("scroll",cp)}),[cp]),jsxRuntimeExports.jsxs("div",{className:"chatContainer",ref:np,children:[jsxRuntimeExports.jsx("div",{children:rp.messageList.map((dp,hp)=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("div",{className:"chat-box",children:[jsxRuntimeExports.jsx("img",{src:dp.split("|")[1],alt:"",className:"user-img"}),jsxRuntimeExports.jsxs("div",{className:"msg-detail",children:[jsxRuntimeExports.jsx("div",{className:"msg-info",children:jsxRuntimeExports.jsx("p",{children:dp.split("|")[0]})}),jsxRuntimeExports.jsxs("div",{className:"msg-content",children:[jsxRuntimeExports.jsx("span",{className:"triangle"}),jsxRuntimeExports.jsx("p",{className:"text",children:dp.split("|")[2]})]})]})]})},hp))}),jsxRuntimeExports.jsx("div",{ref:_d})]})};var Send={},_interopRequireDefault$9=interopRequireDefaultExports;Object.defineProperty(Send,"__esModule",{value:!0});var default_1$9=Send.default=void 0,_createSvgIcon$9=_interopRequireDefault$9(requireCreateSvgIcon()),_jsxRuntime$9=jsxRuntimeExports;default_1$9=Send.default=(0,_createSvgIcon$9.default)((0,_jsxRuntime$9.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");const ChattingForm=rp=>{const[_d,np]=reactExports.useState(""),ap=up=>{up.preventDefault(),_d.trim()!==""&&rp.onMessage(`${rp.myUserName}|${rp.myUserImg}|`+_d.trim(),rp.currentSession),np("")},sp=up=>{np(up.target.value)},lp=up=>{up.key==="Enter"&&(up.preventDefault(),ap(up))};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{id:"messageInput",children:[jsxRuntimeExports.jsx("input",{placeholder:" ",id:"chatInput",value:_d,onChange:sp,onKeyPress:lp,onpaste:"return false;"}),_d.trim()!==""&&jsxRuntimeExports.jsx("div",{className:"send-reply",onClick:ap,children:jsxRuntimeExports.jsx(default_1$9,{})})]})})};function LeaveModal({state:rp,leaveSession:_d}){const np=reactExports.useRef();reactExports.useEffect(()=>{np.current.showModal()});const ap=up=>{const dp=up.target.getBoundingClientRect();(dp.left>up.clientX||dp.right<up.clientX||dp.top>up.clientY||dp.bottom<up.clientY)&&(np.current.close(),rp(!rp))},sp=up=>{np.current.close(),rp(!rp)},lp=up=>{rp(!rp),_d()};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("dialog",{ref:np,onClick:ap,className:"leave-modal",children:[jsxRuntimeExports.jsx("header",{className:"leave-modal-header",children:jsxRuntimeExports.jsx("h3",{children:" ?"})}),jsxRuntimeExports.jsxs("div",{className:"leave-modal-body",children:[jsxRuntimeExports.jsx("div",{onClick:sp,children:""}),jsxRuntimeExports.jsx("div",{onClick:lp,children:""})]})]})})}function LuFish(rp){return GenIcon({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z"},child:[]},{tag:"path",attr:{d:"M18 12v.5"},child:[]},{tag:"path",attr:{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86"},child:[]},{tag:"path",attr:{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33"},child:[]},{tag:"path",attr:{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4"},child:[]},{tag:"path",attr:{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98"},child:[]}]})(rp)}let idCounter=0;const HeartButton=({session:rp,myUserName:_d,myUserImg:np,favIcons:ap,setFavIcons:sp})=>{const lp=["","","","","","","","","","","","","","",""],up=()=>{const cp=lp[Math.floor(Math.random()*lp.length)];sp(dp=>[...dp,{id:idCounter++,y:100,icon:cp}]),rp.signal({data:`${_d}|${np}|${cp}`,type:"heart"}).catch(dp=>console.error("Error sending heart signal:",dp))};return reactExports.useEffect(()=>{const cp=setInterval(()=>{sp(dp=>dp.filter(hp=>hp.y>50))},2e3);return()=>clearInterval(cp)},[]),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(LuFish,{onClick:up}),jsxRuntimeExports.jsx("div",{children:ap.map(cp=>jsxRuntimeExports.jsx("div",{className:"heart-icon",children:cp.icon},cp.id))})]})};var localUser=new UserModel;const baseURL="https://i10c203.p.ssafy.io",OPENVIDU_SERVER_SECRET="wearegitaehasam",VideoRoomComponent=rp=>{const _d=useNavigate(),np=useLocation(),ap=np.state.roomId,sp=np.state.isHost,lp=np.state.imageUrl?np.state.imageUrl:null,up=np.state.name?np.state.name:null,cp=np.state.nickname,dp=np.state.userImg,hp=np.state.subscriberSession?np.state.subscriberSession:null,[fp,pp]=reactExports.useState(null),[mp,gp]=reactExports.useState("Gitaehasam"),[yp,xp]=reactExports.useState(""),[_p,vp]=reactExports.useState(""),[bp,Ep]=reactExports.useState(void 0),[Sp,Ap]=reactExports.useState(void 0),[Rp,Tp]=reactExports.useState([]),[Mp,Op]=reactExports.useState(void 0),[Pp,$p]=reactExports.useState([]),[zp,Dp]=reactExports.useState(0),[Fp,jp]=reactExports.useState(!0),[Lp,Bp]=reactExports.useState(!0),[Ip,kp]=reactExports.useState(!0),[Up,Gp]=reactExports.useState(!1),[Wp,Qp]=reactExports.useState(""),[Xp,rm]=reactExports.useState(""),[Kp,lm]=reactExports.useState(!1),[cm,gm]=reactExports.useState([]),[Mm,dm]=reactExports.useState(!0);let em;reactExports.useEffect(()=>{bp&&Sp&&dm(!1)},[bp,Sp]);const sm=reactExports.useCallback(()=>sp?Zp(mp).then(ym=>mm(ym)):mm(hp),[mp,sp]),Zp=ym=>sp?new Promise((Em,Bm)=>{let Pm=JSON.stringify({customSessionId:ym});axios.post(baseURL+"/openvidu/api/sessions",Pm,{headers:{Authorization:"Basic "+btoa("OPENVIDUAPP:"+OPENVIDU_SERVER_SECRET),"Content-Type":"application/json"}}).then(Im=>{axios.post(baseURL+"/api/lives",{imageUrl:lp,name:up,sessionId:Im.data.sessionId},{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}}).then(Dm=>{pp(Dm.data.id),Em(Im.data.id)}).catch(Dm=>{console.log("Error on /lives request:",Dm)})}).catch(Im=>{var jm;var Dm=Object.assign({},Im);((jm=Dm==null?void 0:Dm.response)==null?void 0:jm.status)===409?Em(ym):console.log(Dm)})}):Promise.resolve(hp),mm=ym=>{let Em=sp?"PUBLISHER":"SUBSCRIBER";return new Promise((Bm,Pm)=>{const Im={role:Em,sessionId:ym};axios.post(baseURL+"/openvidu/api/sessions/"+ym+"/connection",Im,{headers:{Authorization:"Basic "+btoa("OPENVIDUAPP:"+OPENVIDU_SERVER_SECRET),"Content-Type":"application/json"}}).then(Dm=>{Bm(Dm.data.token)}).catch(Dm=>{console.error(Dm),Dm.response&&Dm.response.status===404?(alert("  ."),_d("/media/roomList")):Pm(Dm)})})};let fm;reactExports.useEffect(()=>{gp(`Gitaehasam${ap}`),Qp(cp),rm(dp)},[ap]),reactExports.useEffect(()=>{fm=new OpenViduLayout;const ym={maxRatio:1,minRatio:1,fixedRatio:!0,bigClass:"OV_big",bigPercentage:1,bigFixedRatio:!1,bigMaxRatio:1,bigMinRatio:1,bigFirst:!0,animate:!0};fm.initLayoutContainer(document.getElementById("layout"),ym),fm.setLayoutOptions(ym),window.addEventListener("beforeunload",onbeforeunload),mp!=="Gitaehasam"&&_m()},[mp]);const _m=async()=>{em=new lib.OpenVidu,(await em.getDevices()).filter(Im=>Im.kind==="videoinput");let Em=em.initSession();Ep(Em);let Bm;try{Bm=await sm()}catch(Im){console.log(Im);return}const Pm=em.initPublisher(void 0,{audioSource:void 0,videoSource:void 0,publishAudio:Ip,publishVideo:Lp,resolution:"640x480",frameRate:30,insertMode:"APPEND",mirror:!1});Em.connect(Bm,{clientData:yp}).then(()=>{Em.publish(Pm).then(()=>{localUser.setNickname(yp),localUser.setConnectionId(Em.connection.connectionId),localUser.setStreamManager(Pm)}),Op(Pm),Ap(Pm)}),Em.on("streamCreated",Im=>{const Dm=Em.subscribe(Im.stream,"publisher");$p(Dm)}),Em.on("exception",Im=>{console.warn(Im)}),Em.on("connectionCreated",({stream:Im})=>{Dp(Dm=>Dm+1)}),Em.on("sessionDisconnected",({stream:Im})=>{alert(" ."),_d("/media/roomList",{replace:!0})}),Em.on("connectionDestroyed",({stream:Im})=>{Dp(Dm=>Dm-1)}),Em.on("signal:heart",Im=>{const[,,Dm]=Im.data.split("|");gm(jm=>[...jm,{id:Date.now(),y:100,icon:Dm}])}),Em.on("signal:chat",Im=>{Tp(Dm=>[...Dm,Im.data])})},zm=()=>{Mp.publishVideo(!Mp.stream.videoActive),Bp(!Lp),Op(Mp)},tm=()=>{Mp.publishAudio(!Mp.stream.audioActive),kp(!Ip),Op(Mp)},Jp=async()=>{const ym=bp;ym&&(sp?await pm():(ym.disconnect(),_d("/media/roomList",{replace:!0})))},pm=async()=>{try{await axios.delete(baseURL+`/api/lives/${fp}`,{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}}),await axios.delete(baseURL+`/openvidu/api/sessions/${mp}`,{headers:{Authorization:"Basic "+btoa("OPENVIDUAPP:"+OPENVIDU_SERVER_SECRET),"Content-Type":"application/json"}})}catch(ym){console.error(ym)}finally{_d("/media/roomList",{replace:!0})}};reactExports.useEffect(()=>{xp(cp),vp(dp)},[]),reactExports.useEffect(()=>{const ym=Em=>{Jp()};return window.addEventListener("beforeunload",ym),()=>{window.removeEventListener("beforeunload",ym)}},[Jp]),reactExports.useEffect(()=>{if(bp){const ym=()=>{lm(!0)};return bp.on("sessionDisconnected",ym),()=>{bp.off("sessionDisconnected",ym)}}},[bp]);const km=(ym,Em)=>{Em.signal({data:ym,to:[],type:"chat"}).then(()=>{}).catch(Bm=>{console.error(Bm)})};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Mm?jsxRuntimeExports.jsx(Loading,{}):jsxRuntimeExports.jsxs("div",{className:"bounds",children:[bp!==void 0&&Sp!==void 0?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(ToolbarComponent,{user:Mp,isHost:sp,micStatusChanged:tm,camStatusChanged:zm,setLeaveModal:Gp,hostNickname:Wp,hostProfileImg:Xp,totalUsers:zp}),sp&&jsxRuntimeExports.jsx(UserVideoComponent,{streamManager:Mp}),!sp&&jsxRuntimeExports.jsx(UserVideoComponent,{streamManager:Pp}),Fp&&jsxRuntimeExports.jsxs("div",{className:"chatting",children:[jsxRuntimeExports.jsx(ChattingList,{messageList:Rp}),jsxRuntimeExports.jsxs("div",{className:"chat-input-area",children:[jsxRuntimeExports.jsx(ChattingForm,{myUserName:yp,myUserImg:_p,onMessage:km,currentSession:bp}),jsxRuntimeExports.jsx("div",{className:"heart-button-wrapper",children:jsxRuntimeExports.jsx(HeartButton,{session:bp,myUserName:yp,myUserImg:_p,favIcons:cm,setFavIcons:gm})})]})]})]}):jsxRuntimeExports.jsxs("div",{className:"noneData",children:[jsxRuntimeExports.jsx(default_1$s,{}),jsxRuntimeExports.jsx("div",{children:"  ."}),jsxRuntimeExports.jsx("button",{onClick:()=>_d("/media/roomList"),children:""})]}),Up?jsxRuntimeExports.jsx(LeaveModal,{state:Gp,leaveSession:Jp}):null]})})},MediaPage=()=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsxs("div",{className:"choose-list",children:[jsxRuntimeExports.jsx(Link,{to:"/media/roomlist",children:jsxRuntimeExports.jsx("div",{className:"choose-item choose-live",children:jsxRuntimeExports.jsxs("div",{className:"liveroom",children:[jsxRuntimeExports.jsx("div",{className:"category-live",children:"Live"}),jsxRuntimeExports.jsx("div",{className:"triangle-bd",children:jsxRuntimeExports.jsx("div",{className:"triangle"})})]})})}),jsxRuntimeExports.jsx(Link,{to:"/media/board",children:jsxRuntimeExports.jsx("div",{className:"choose-item choose-photo",children:jsxRuntimeExports.jsx("div",{className:"photo",children:"Photo"})})})]})]}),filter="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAA3CAYAAACo29JGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAOLSURBVHgB7ZpbiE1RGMf/jpmQwRAaGZkYklt5kCmXEimX8ICUB8QrXnjgAS/S4MmLJFJK8iAveBAPRG5D7iGZzCCkxv0wxvj+rXNqn7XWsfc5s885a53Or/6n9m3t7ztrr29969sbAJpED0R/Rd1lIPrxSbS+l/zcFU1D+dGRkJ9hKE9q6dw3lCfdVVDPZ5Bzov3wjwWiHYHtJJ17LZoZ2DlIdE30B36xSNt+xceyRds5HspBn2AnzdL2PeHPVFEnMkPpUvjFKNEXZE4JG3mgv6hVO3AGfsGxFrSfQbIhfbBZO8ienAA/6Cd6g0z7L4mq0ydMgtmt7L3ecJ9tMLOUNfpJJ2D23jy4zUSoqSxo933RYP3ERtEP7cQ20Ti4yUDRZZh5ZdZguB1mF98UjYBbcJydgmnrFVEi20U1okeWi25BhVsXoI0nYa5iGFQawy7mCW0wHXwhmoLSMhwq0Om2fRctj9rIXNF7SyPtKF2QaYAaIrpNSagJu1cujdHBr5bG3olW5NpYD+F6s8Viy0/R1nxtYaPPYf+3NqHw8yCNni/6YLGhQ7QWPfyTx0AFFL1xrhp2iQagMNDoZTCTC+otYhwe9aILsA/kw1D5aZzwidical+/5zPRHMQMHTgu6rLc8KJoKOKhj2hflvtcF41GgWAyylV60nJjJqs9TbY5hx2BvaLF9oegwHCMMVlNWgy4IRqL/KiDPetgDx4V1aKIMFJ1wJ6u5ToGmTIdQ+aimfot2oMiO5aGSepLmA4eQG4wKurpFJP4vOewOOA/PhtmusZ5aXLENviY34Hp2AY4AstqnPeCBjZHvHad5drdUFHTGc4i08DHCI9uCct1rVBLGqdYCDPvawq5ZqToqXbdTsREAvHBdeDnwHZfqNTtf9SlFOQqYiJO55gqtWv7wkI4p4wabV8bYiJO5xjKO7V91Qi/f1Vgu9vSRt7E6ZxzVJzzlYpzvlJxzlcqzvlKxbkCwZwycn0/H6pQfFg2mCE6KJquHetKKRaK7Rw/AWFNchXsK4bzoo9wEBp7D5kLzy2pY1wdsPz9EGYxKV3lOgT1ispJsjnHsbUX9jdGFL9gWokSVrmiYHPutOg2sn/Lyeq1s70VxOacTXSUJYnF8IgozrGEx3cBXvRWkDDn+EJ+NcJLD05C5/hJse7UL6hIWAePYSVL/9KAkXAJHI+EUeE7dH6exPol37jWo4T8A7CzoWgJ7WGLAAAAAElFTkSuQmCC";var Window$1={},_interopRequireDefault$8=interopRequireDefaultExports;Object.defineProperty(Window$1,"__esModule",{value:!0});var default_1$8=Window$1.default=void 0,_createSvgIcon$8=_interopRequireDefault$8(requireCreateSvgIcon()),_jsxRuntime$8=jsxRuntimeExports;default_1$8=Window$1.default=(0,_createSvgIcon$8.default)((0,_jsxRuntime$8.jsx)("path",{d:"M11 11V3H5c-1.1 0-2 .9-2 2v6zm2 0h8V5c0-1.1-.9-2-2-2h-6zm-2 2H3v6c0 1.1.9 2 2 2h6zm2 0v8h6c1.1 0 2-.9 2-2v-6z"}),"Window");var Favorite={},_interopRequireDefault$7=interopRequireDefaultExports;Object.defineProperty(Favorite,"__esModule",{value:!0});var default_1$7=Favorite.default=void 0,_createSvgIcon$7=_interopRequireDefault$7(requireCreateSvgIcon()),_jsxRuntime$7=jsxRuntimeExports;default_1$7=Favorite.default=(0,_createSvgIcon$7.default)((0,_jsxRuntime$7.jsx)("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"}),"Favorite");var FavoriteBorder={},_interopRequireDefault$6=interopRequireDefaultExports;Object.defineProperty(FavoriteBorder,"__esModule",{value:!0});var default_1$6=FavoriteBorder.default=void 0,_createSvgIcon$6=_interopRequireDefault$6(requireCreateSvgIcon()),_jsxRuntime$6=jsxRuntimeExports;default_1$6=FavoriteBorder.default=(0,_createSvgIcon$6.default)((0,_jsxRuntime$6.jsx)("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3m-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05"}),"FavoriteBorder");var ChatBubbleOutline={},_interopRequireDefault$5=interopRequireDefaultExports;Object.defineProperty(ChatBubbleOutline,"__esModule",{value:!0});var default_1$5=ChatBubbleOutline.default=void 0,_createSvgIcon$5=_interopRequireDefault$5(requireCreateSvgIcon()),_jsxRuntime$5=jsxRuntimeExports;default_1$5=ChatBubbleOutline.default=(0,_createSvgIcon$5.default)((0,_jsxRuntime$5.jsx)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 14H6l-2 2V4h16z"}),"ChatBubbleOutline");const api$2=axiosApi(),url="/api/boards";async function getBoardList(rp,_d,np,ap){try{console.log(rp);const{data:sp}=await api$2.get(`${url}?categoryId=${rp}&fishBookId=${_d}&hashTagId=${np}&sortType=${ap}`);return console.log(sp),sp}catch(sp){console.log(sp)}}async function getBoardDetail(rp){try{console.log(rp);const{data:_d}=await api$2.get(`${url}/${rp}`);return console.log(_d),_d}catch(_d){console.log(_d)}}async function deleteBoardPost(rp){try{await api$2.delete(`${url}/${rp}`)}catch(_d){console.log(_d)}}async function createBoardPost(rp){console.log(JSON.stringify(rp));try{await api$2.post(`${url}`,JSON.stringify(rp))}catch(_d){console.log(_d)}}async function modifyBoardPut(rp,_d){console.log("pageId : ",_d),console.log(JSON.stringify(rp));try{await api$2.put(`${url}/${_d}`,JSON.stringify(rp))}catch(np){console.log(np)}}async function sendBoardReply(rp,_d){try{await api$2.post(`${url}/${rp}/comments`,{content:_d})}catch(np){console.log(np)}}async function deleteBoardReply(rp,_d){try{await api$2.delete(`${url}/${rp}/comments/${_d}`)}catch(np){console.log(np)}}async function putPostLike(rp){try{await api$2.put(`${url}/${rp}/likes`)}catch(_d){console.log(_d)}}async function deletePostLike(rp){try{await api$2.delete(`${url}/${rp}/likes`)}catch(_d){console.log(_d)}}async function getSearchFish(rp){try{if(console.log("dd"),rp==""||rp==" ")return;const{data:_d}=await api$2.get(`${url}/search/fishBook?searchWord=${rp}`);return _d}catch(_d){console.log(_d)}}async function getFilterFish(){try{const{data:rp}=await api$2.get(`${url}/filters`);return rp}catch(rp){console.log(rp)}}async function getFilterHash(){try{const{data:rp}=await api$2.get(`${url}/hashtags`);return rp}catch(rp){console.log(rp)}}const BoardItem=({data:rp,category:_d})=>{const np=useNavigate(),ap=pp=>{const mp=new Date(pp),yp=Math.floor((new Date().getTime()-mp.getTime())/1e3);if(yp<60)return" ";const xp=yp/60;if(xp<60)return`${Math.floor(xp)} `;const _p=xp/60;if(_p<24)return`${Math.floor(_p)} `;const vp=_p/24;return vp<7?`${Math.floor(vp)} `:`${mp.toLocaleDateString()}`},sp=pp=>{np(`/media/board/${pp}`,{state:{categoryId:_d}})},[lp,up]=reactExports.useState(),[cp,dp]=reactExports.useState(),hp=async pp=>{await deletePostLike(pp).then(mp=>{up(!1),dp(gp=>gp-1)})},fp=async pp=>{await putPostLike(pp).then(mp=>{up(!0),dp(gp=>gp+1)})};return reactExports.useEffect(()=>{rp.isLiked?(up(!0),dp(rp.likeCnt)):(up(!1),dp(rp.likeCnt))},[]),jsxRuntimeExports.jsxs("li",{className:"shadow board-contents",children:[jsxRuntimeExports.jsxs("div",{className:"board-title-area",children:[jsxRuntimeExports.jsx("img",{className:"board-profile",src:rp.profileImageUrl,alt:""}),jsxRuntimeExports.jsx("div",{className:"nick",children:rp.nickName})]}),jsxRuntimeExports.jsx("img",{className:"main-img",src:rp.boardImageUrl,alt:"",onClick:()=>sp(rp.boardId)}),jsxRuntimeExports.jsxs("div",{className:"content",children:[jsxRuntimeExports.jsx("div",{className:"post-text",children:rp.content}),jsxRuntimeExports.jsxs("div",{className:"hashtag-list",children:[rp.fishName&&jsxRuntimeExports.jsx("div",{className:"hashtag blue-bd",children:jsxRuntimeExports.jsxs("span",{className:"blue-fc",children:["#",rp.fishName]})}),rp.hashtag&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:rp.hashtags.map((pp,mp)=>jsxRuntimeExports.jsx("div",{className:"hashtag  blue-bd",children:jsxRuntimeExports.jsxs("span",{className:"blue-fc",children:["#",pp]})},mp))})]}),jsxRuntimeExports.jsx("div",{className:"post-bottom",children:jsxRuntimeExports.jsx("div",{className:"time",children:ap(rp.createdAt)})}),jsxRuntimeExports.jsxs("div",{className:"post-info",children:[jsxRuntimeExports.jsx("div",{className:"post-icon",children:jsxRuntimeExports.jsx(default_1$5,{})}),jsxRuntimeExports.jsx("div",{className:"comment",children:rp.commentCnt}),lp&&jsxRuntimeExports.jsx("div",{className:"post-icon post-like",children:jsxRuntimeExports.jsx(default_1$7,{onClick:()=>hp(rp.boardId)})}),!lp&&jsxRuntimeExports.jsx("div",{className:"post-icon",children:jsxRuntimeExports.jsx(default_1$6,{onClick:()=>fp(rp.boardId)})}),jsxRuntimeExports.jsx("div",{className:"like",children:cp})]})]})]})},BoardList=({category:rp,viewType:_d,fishType:np,hashType:ap,sortType:sp})=>{const[lp,up]=reactExports.useState([]),cp=async(dp,hp,fp,pp)=>{await getBoardList(dp,hp,fp,pp).then(mp=>up(mp)),console.log(lp)};return reactExports.useEffect(()=>{cp(rp,np,ap,sp)},[rp,np,ap,sp]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("ul",{className:`${_d==0?"full-size":"mini-size"}`,children:lp.boards&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:lp.boards.map(dp=>jsxRuntimeExports.jsx(BoardItem,{data:dp,category:rp},dp.boardId))})})})},BoardFilter=({category:rp,closeCheck:_d,filterBoard:np})=>{const[ap,sp]=reactExports.useState(),[lp,up]=reactExports.useState(),[cp,dp]=reactExports.useState(),[hp,fp]=reactExports.useState([]),[pp,mp]=reactExports.useState([]),[gp,yp]=reactExports.useState([]),[xp,_p]=reactExports.useState(!1),[vp,bp]=reactExports.useState(!1);reactExports.useEffect(()=>{Ep(rp)},[rp]);const Ep=Tp=>{Tp==1?getFilterFish().then(Mp=>{fp(Mp.sea),mp(Mp.freshWater)}):Tp==2&&getFilterHash().then(Mp=>{console.log(Mp),yp(Mp)})},Sp=Tp=>{Tp==1?_p(Mp=>!Mp):Tp==2&&bp(Mp=>!Mp)},Ap=()=>{np(ap,lp,cp),sp(),up(),dp(),_d()},Rp=()=>{sp(""),up("")};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"board-filter-area",children:[jsxRuntimeExports.jsx("img",{src:back,alt:"",className:"back-fish-lish",onClick:()=>_d()}),jsxRuntimeExports.jsx("div",{className:"reset",onClick:()=>Rp(),children:""}),jsxRuntimeExports.jsx("div",{className:"filter-sub",children:""}),jsxRuntimeExports.jsxs("div",{className:"sort-area",children:[jsxRuntimeExports.jsxs("label",{className:`sort-label ${ap==="comments"?"blue-bd":""}`,children:[jsxRuntimeExports.jsx("div",{children:""}),jsxRuntimeExports.jsx("input",{type:"radio",className:"sort-type",value:"comment",checked:ap==="comments",onChange:()=>sp("comments")})]}),jsxRuntimeExports.jsxs("label",{className:`sort-label ${ap==="createdAt"?"blue-bd":""}`,children:[jsxRuntimeExports.jsx("div",{children:""}),jsxRuntimeExports.jsx("input",{type:"radio",className:"sort-type",value:"createdAt",checked:ap==="createdAt",onChange:()=>sp("createdAt")})]}),jsxRuntimeExports.jsxs("label",{className:`sort-label ${ap==="likes"?"blue-bd":""}`,children:[jsxRuntimeExports.jsx("div",{children:""}),jsxRuntimeExports.jsx("input",{type:"radio",className:"sort-type",value:"likes",checked:ap==="likes",onChange:()=>sp("likes")})]})]}),rp==1&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"filter-sub",children:" "}),jsxRuntimeExports.jsxs("div",{className:`filter-fish ${xp?"view":""}`,children:[jsxRuntimeExports.jsx("div",{className:"morefish",onClick:()=>Sp(1),children:""}),hp.map(Tp=>jsxRuntimeExports.jsxs("label",{className:`filter-fish-list ${lp==Tp.id?"blue-bd":""}`,children:[jsxRuntimeExports.jsx("div",{children:Tp.name}),jsxRuntimeExports.jsx("input",{type:"radio",className:"sort-type",value:Tp.id,checked:lp==Tp.id,onChange:()=>{up(Tp.id),console.log(lp)}})]},Tp.id))]}),jsxRuntimeExports.jsx("div",{className:"filter-sub",children:" "}),jsxRuntimeExports.jsxs("div",{className:`filter-fish ${vp?"view":""}`,children:[jsxRuntimeExports.jsx("div",{className:"morefish",onClick:()=>Sp(2),children:""}),pp.map(Tp=>jsxRuntimeExports.jsxs("label",{className:`filter-fish-list ${lp===Tp.id?"blue-bd":""}`,children:[jsxRuntimeExports.jsx("div",{children:Tp.name}),jsxRuntimeExports.jsx("input",{type:"radio",className:"sort-type",value:Tp.id,checked:lp===Tp.id,onChange:()=>{up(Tp.id),console.log(lp)}})]},Tp.id))]})]}),rp==2&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"filter-sub",children:""}),jsxRuntimeExports.jsx("div",{className:"filter-fish",children:gp.map(Tp=>jsxRuntimeExports.jsxs("label",{className:`filter-fish-list ${cp===Tp.id?"blue-bd":""}`,children:[jsxRuntimeExports.jsx("div",{children:Tp.name}),jsxRuntimeExports.jsx("input",{type:"radio",className:"sort-type",value:Tp.id,checked:cp===Tp.id,onChange:()=>{dp(Tp.id)}})]},Tp.id))})]}),jsxRuntimeExports.jsx("div",{className:"filter-button bg-blue shadow",onClick:()=>Ap(),children:""})]})})};var EditNote={},_interopRequireDefault$4=interopRequireDefaultExports;Object.defineProperty(EditNote,"__esModule",{value:!0});var default_1$4=EditNote.default=void 0,_createSvgIcon$4=_interopRequireDefault$4(requireCreateSvgIcon()),_jsxRuntime$4=jsxRuntimeExports;default_1$4=EditNote.default=(0,_createSvgIcon$4.default)((0,_jsxRuntime$4.jsx)("path",{d:"M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z"}),"EditNote");const BoardPage=()=>{const[rp,_d]=reactExports.useState(1),[np,ap]=reactExports.useState(0),[sp,lp]=reactExports.useState(!1),[up,cp]=reactExports.useState(""),[dp,hp]=reactExports.useState(""),[fp,pp]=reactExports.useState(""),mp=()=>{lp(!1)},gp=bp=>{_d(bp),cp(""),hp(""),pp("")},yp=bp=>{ap(bp)},xp=useNavigate(),_p=()=>{xp("/media/board/create",{state:{categoryId:rp}})},vp=(bp,Ep,Sp)=>{console.log(bp),bp&&cp(bp),Ep&&hp(Ep),Sp&&pp(Sp)};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"category-boardpage ",children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsxs("div",{className:"category-header blue-bd",style:{borderWidth:"1px 0"},children:[jsxRuntimeExports.jsxs("div",{className:`category-title ${rp==1?"blue-fc":""}`,onClick:()=>gp(1),children:[jsxRuntimeExports.jsx("div",{className:`underbar ${rp==1?"bg-blue":"none"}`}),""]}),jsxRuntimeExports.jsxs("div",{className:`category-title ${rp==2?"blue-fc":""}`,onClick:()=>gp(2),children:[jsxRuntimeExports.jsx("div",{className:`underbar ${rp==2?"bg-blue":"none"}`}),""]})]}),jsxRuntimeExports.jsxs("div",{className:"type-select",children:[jsxRuntimeExports.jsx("div",{className:`full ${np==0&&"bg-blue"}`,onClick:()=>yp(0)}),jsxRuntimeExports.jsx("div",{className:`divide ${np==1&&"active"}`,onClick:()=>yp(1),children:jsxRuntimeExports.jsx(default_1$8,{})}),jsxRuntimeExports.jsx("input",{type:"checkbox",id:"check",checked:sp,onChange:()=>lp(bp=>!bp)}),jsxRuntimeExports.jsx("label",{htmlFor:"check",className:"filter",children:jsxRuntimeExports.jsx("img",{src:filter,alt:""})}),jsxRuntimeExports.jsx("div",{className:"board-filter",children:jsxRuntimeExports.jsx(BoardFilter,{category:rp,closeCheck:mp,filterBoard:vp})})]}),jsxRuntimeExports.jsx(BoardList,{category:rp,viewType:np,sortType:up,fishType:dp,hashType:fp}),jsxRuntimeExports.jsx("div",{className:"create-post-btn bg-blue",onClick:()=>_p(),children:jsxRuntimeExports.jsx(default_1$4,{})})]})})};var TagOutlined={},_interopRequireDefault$3=interopRequireDefaultExports;Object.defineProperty(TagOutlined,"__esModule",{value:!0});var default_1$3=TagOutlined.default=void 0,_createSvgIcon$3=_interopRequireDefault$3(requireCreateSvgIcon()),_jsxRuntime$3=jsxRuntimeExports;default_1$3=TagOutlined.default=(0,_createSvgIcon$3.default)((0,_jsxRuntime$3.jsx)("path",{d:"M20 10V8h-4V4h-2v4h-4V4H8v4H4v2h4v4H4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4zm-6 4h-4v-4h4z"}),"TagOutlined");const BoardCreateMap=({fishSpot:rp,setFishSpot:_d})=>{const[np,ap]=reactExports.useState({lat:36.172823447489336,lng:127.8675122717897}),[sp,lp]=reactExports.useState(""),[up,cp]=reactExports.useState(13),[dp,hp]=reactExports.useState([]),[fp,pp]=reactExports.useState(null),mp=reactExports.useRef(),gp=reactExports.useRef(),yp=async vp=>{vp.preventDefault();try{const bp=await axios.get("https://i10c203.p.ssafy.io/api/spots",{params:{keyword:sp},headers:{Authorization:localStorage.getItem("jwt")}});console.log(bp.data.spots),hp(bp.data.spots),mp.current.setLevel(13),mp.current.setCenter(new kakao.maps.LatLng(36.172823447489336,127.8675122717897)),gp.current.blur()}catch(bp){console.log(bp)}},xp=()=>{pp(null),_d({}),gp.current.blur()},_p=(vp,bp)=>{pp(vp),_d(bp)};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Map$1,{center:np,ref:mp,level:up,onClick:xp,children:jsxRuntimeExports.jsx(MarkerClusterer,{minLevel:11,averageCenter:!0,children:dp.map((vp,bp)=>jsxRuntimeExports.jsx(MapMarker,{position:{lat:vp.latitude,lng:vp.longitude},onClick:()=>_p(bp,vp),image:fp===bp?{src:MarkerOn,size:{width:28,height:40}}:{src:MarkerOff,size:{width:18,height:25}}},vp.spotId))})}),jsxRuntimeExports.jsx("form",{onSubmit:yp,children:jsxRuntimeExports.jsx("input",{type:"text",ref:gp,value:sp,onChange:vp=>lp(vp.target.value)})}),rp&&jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{children:rp.name})})]})},BoardFormItem=({type:rp,categoryId:_d,boardData:np})=>{const ap="https://i10c203.p.ssafy.io",sp=localStorage.getItem("jwt"),lp=useParams().id,[up,cp]=reactExports.useState(""),[dp,hp]=reactExports.useState(""),fp=reactExports.useRef(),[pp,mp]=reactExports.useState(""),[gp,yp]=reactExports.useState([]),[xp,_p]=reactExports.useState(""),[vp,bp]=reactExports.useState([]),[Ep,Sp]=reactExports.useState({}),[Ap,Rp]=reactExports.useState(""),[Tp,Mp]=reactExports.useState("");reactExports.useEffect(()=>{np&&(_p(np.content),yp(np.hashtags),cp("0"),hp(np.boardImageUrl),console.log(xp),console.log(gp),console.log(up),console.log(dp))},[np]);const Op=Ip=>{console.log("2w"),Ip.preventDefault();let kp=Ip.target.files[0],Up=new FileReader;Up.onloadend=Gp=>{cp(kp),hp(Up.result)},kp&&Up.readAsDataURL(kp),Pp(kp)},Pp=Ip=>{const kp=new FormData;kp.append("images",Ip),kp.append("type","LIVEROOM"),axios.post(ap+"/api/images",kp,{headers:{Authorization:sp,"Content-Type":"multipart/form-data"}}).then(Up=>{Mp(Up.data.imageNames[0])}).catch(Up=>console.log(Up))},$p=Ip=>{console.log("cleick"),Ip.preventDefault(),fp.current.click()},zp=async Ip=>{Ip==="create"&&await createBoardPost({categoryId:_d,content:xp,fishBookId:Ap,hashTags:gp,fishingSpotId:Ep.spotId,imageUrl:Tp,latitude:Ep.latitude,longitude:Ep.longitude}).then(kp=>{console.log(kp)}),Ip==="modify"&&await modifyBoardPut({categoryId:_d,content:xp,fishBookId:Ap,hashTags:gp,fishingSpotId:Ep.spotId,imageUrl:dp,latitude:Ep.latitude,longitude:Ep.longitude},lp).then(kp=>{console.log(kp)})},Dp=async Ip=>{await getSearchFish(Ip.trim()).then(kp=>{bp(kp)})},Fp=()=>{},jp=Ip=>{Rp(Ip)},Lp=(Ip,kp)=>{if(!(Ip.key==="Enter"&&kp==1)){if(Ip.key==="Enter"&&kp==2){if(gp.length==5){alert("5 ."),mp(""),bp([]);return}const Up=[...gp,pp];yp(Up)}}},Bp=Ip=>{console.log(Ip);const kp=gp.filter(Up=>Up!==Ip);yp(kp)};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"post-area",children:[jsxRuntimeExports.jsxs("div",{className:"post-item",children:[jsxRuntimeExports.jsxs("div",{className:"post-sub",children:[_d==1&&jsxRuntimeExports.jsx("div",{children:"   "}),_d==2&&jsxRuntimeExports.jsx("div",{children:"  ."})]}),jsxRuntimeExports.jsxs("div",{className:"post-image-upload",children:[dp&&jsxRuntimeExports.jsx("img",{className:"img_preview",src:dp}),jsxRuntimeExports.jsx("input",{ref:fp,hidden:!0,id:"file",type:"file",onChange:Op}),jsxRuntimeExports.jsxs("div",{className:`shadow ${up?"reupload-btn blue-bd":"upload-btn bg-blue"}`,onClick:$p,children:[!up&&jsxRuntimeExports.jsx(default_1$e,{}),up&&"  "]})]})]}),jsxRuntimeExports.jsxs("div",{className:"post-item",children:[jsxRuntimeExports.jsx("div",{className:"post-sub",children:""}),jsxRuntimeExports.jsx("div",{className:"position",children:jsxRuntimeExports.jsx(BoardCreateMap,{fishSpot:Ep,setFishSpot:Sp})})]}),jsxRuntimeExports.jsxs("div",{className:"post-item",children:[jsxRuntimeExports.jsxs("div",{className:"post-sub",children:[_d==1&&jsxRuntimeExports.jsx("div",{children:""}),_d==2&&jsxRuntimeExports.jsx("div",{children:""})]}),jsxRuntimeExports.jsxs("div",{className:"hashtag-add",children:[jsxRuntimeExports.jsx("div",{className:"hashtag-icon shadow bg-blue",children:jsxRuntimeExports.jsx(default_1$3,{})}),_d==1&&jsxRuntimeExports.jsx("input",{className:"hashtag-search",type:"text",value:pp,onKeyUp:Ip=>Dp(Ip.target.value),onChange:Ip=>mp(Ip.target.value),onKeyDown:Ip=>Lp(Ip,_d),placeholder:""}),_d==2&&jsxRuntimeExports.jsx("input",{className:"hashtag-search",type:"text",value:pp,onKeyUp:Ip=>Fp(Ip.target.value),onChange:Ip=>mp(Ip.target.value),onKeyDown:Ip=>Lp(Ip,_d),placeholder:" 5   "})]}),jsxRuntimeExports.jsx("ul",{className:`auto-area ${vp&&vp.length!=0?"":"none"}`,children:vp&&vp.length!=0&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:vp.map(Ip=>jsxRuntimeExports.jsx("li",{className:"blue-bd",onClick:kp=>jp(Ip.id),children:Ip.name},Ip.id))})}),jsxRuntimeExports.jsx("ul",{className:"hashtag-add-area",children:gp&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:gp.map((Ip,kp)=>jsxRuntimeExports.jsx("li",{className:"blue-bd",onClick:Up=>Bp(Ip),children:Ip},kp))})})]}),jsxRuntimeExports.jsxs("div",{className:"post-item",children:[jsxRuntimeExports.jsx("div",{className:"post-sub",children:" "}),jsxRuntimeExports.jsx("textarea",{value:xp,onChange:Ip=>_p(Ip.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"post-add-btn bg-blue",onClick:Ip=>zp(rp),children:[rp==="create"&&jsxRuntimeExports.jsx("div",{children:""}),rp==="modify"&&jsxRuntimeExports.jsx("div",{children:""})]})]})})},BoardDetailMap=({lat:rp,lng:_d})=>jsxRuntimeExports.jsx(Map$1,{center:{lat:rp,lng:_d},draggable:!1,zoomable:!1,level:10,children:jsxRuntimeExports.jsx(MapMarker,{position:{lat:rp,lng:_d},image:{src:MarkerOn,size:{width:28,height:40}}})}),BoardDetail=()=>{var Rp;const rp=useLocation(),[_d,np]=reactExports.useState((Rp=rp.state)==null?void 0:Rp.categoryId),ap=useNavigate(),{id:sp}=useParams(),[lp,up]=reactExports.useState({}),cp=2462171811,[dp,hp]=reactExports.useState([]);JSON.parse(localStorage.getItem("user"));const[fp,pp]=reactExports.useState(),[mp,gp]=reactExports.useState();reactExports.useEffect(()=>{yp()},[]);const yp=async()=>{await getBoardDetail(sp).then(Tp=>{up(Tp),Tp.isLiked?(pp(!0),gp(Tp.likeCnt)):(pp(!1),gp(Tp.likeCnt))})},xp=async()=>{window.confirm(" ?")&&await deleteBoardPost(sp).then(Tp=>{console.log(Tp),alert("."),ap("/media/board")})},_p=async()=>{console.log(rp.state),window.confirm(" ?")&&ap(`/media/board/modify/${sp}`,{state:{categoryId:_d}})},vp=Tp=>{const Mp=Tp+"",Op=Mp.substring(0,10),Pp=Mp.substring(11,16);return console.log(Op),Op+" "+Pp},bp=async Tp=>{Tp.key==="Enter"&&(await sendBoardReply(sp,dp).then(Mp=>{yp()}),hp(""))},Ep=async Tp=>{await deleteBoardReply(sp,Tp).then(Mp=>{yp()})},Sp=async Tp=>{await deletePostLike(Tp).then(Mp=>{pp(!1),gp(Op=>Op-1)})},Ap=async Tp=>{await putPostLike(Tp).then(Mp=>{pp(!0),gp(Op=>Op+1)})};return Object.keys(lp).length?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Header,{}),lp&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"board-detail-area",children:[jsxRuntimeExports.jsxs("div",{className:"board-detail-item",children:[jsxRuntimeExports.jsxs("div",{className:"board-title",children:[jsxRuntimeExports.jsx("img",{className:"board-detail-profile",src:lp.profileImageUrl,alt:""}),jsxRuntimeExports.jsx("div",{className:"board-nickname",children:lp.nickName}),jsxRuntimeExports.jsxs("div",{className:"like-area",children:[fp&&jsxRuntimeExports.jsx("div",{className:"post-icon post-like",children:jsxRuntimeExports.jsx(default_1$7,{onClick:()=>Sp(lp.boardId)})}),!fp&&jsxRuntimeExports.jsx("div",{className:"post-icon",children:jsxRuntimeExports.jsx(default_1$6,{onClick:()=>Ap(lp.boardId)})}),jsxRuntimeExports.jsx("div",{className:"like",children:mp})]})]}),jsxRuntimeExports.jsx("img",{className:"board-content-img",src:lp.boardImageUrl,alt:""}),jsxRuntimeExports.jsx("div",{className:"board-text",children:lp.content}),jsxRuntimeExports.jsxs("div",{className:"board-hashtag-area",children:[lp.fishName&&jsxRuntimeExports.jsx("div",{className:"blue-bd",children:jsxRuntimeExports.jsxs("div",{className:"blue-fc",children:["# ",lp.fishName]})}),lp.hashtags&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:lp.hashtags.map((Tp,Mp)=>jsxRuntimeExports.jsx("div",{className:"blue-bd",children:jsxRuntimeExports.jsxs("div",{className:"blue-fc ",children:["# ",Tp]})},Mp))})]}),lp.socialId==cp&&jsxRuntimeExports.jsxs("div",{className:"btn-area",children:[jsxRuntimeExports.jsx("div",{className:"btn-modify bg-blue",onClick:()=>_p(),children:""}),jsxRuntimeExports.jsx("div",{className:"btn-delete bg-blue",onClick:()=>xp(),children:""})]})]}),jsxRuntimeExports.jsx("div",{className:"line bg-blue"}),jsxRuntimeExports.jsxs("div",{className:"board-detail-item",children:[jsxRuntimeExports.jsx("div",{className:"board-place",children:"Place Info"}),jsxRuntimeExports.jsx("div",{className:"board-map",children:jsxRuntimeExports.jsx(BoardDetailMap,{lat:lp.latitude,lng:lp.longitude})})]}),jsxRuntimeExports.jsx("div",{className:"line bg-blue"}),jsxRuntimeExports.jsxs("div",{className:"reply-area",children:[jsxRuntimeExports.jsxs("div",{className:"reply-title",children:[jsxRuntimeExports.jsx("div",{children:""}),jsxRuntimeExports.jsx("div",{className:"blue-fc",children:lp.commentCnt})]}),jsxRuntimeExports.jsx("div",{className:"reply-line bg-blue"}),jsxRuntimeExports.jsx("div",{className:"reply-list",children:lp.comments&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:lp.comments.map((Tp,Mp)=>jsxRuntimeExports.jsxs("div",{className:"reply",children:[jsxRuntimeExports.jsx("img",{src:Tp.profileImageUrl,alt:""}),jsxRuntimeExports.jsx("div",{children:Tp.nickName}),jsxRuntimeExports.jsx("div",{children:vp(Tp.createdAt)}),jsxRuntimeExports.jsx("div",{children:Tp.content}),Tp.socialId==cp&&jsxRuntimeExports.jsx("span",{className:"delete-reply blue-fc",onClick:()=>Ep(Tp.id),children:"x"})]},Mp))})})]})]}),jsxRuntimeExports.jsxs("div",{className:"reply-add",children:[jsxRuntimeExports.jsx("div",{className:"reply-line bg-blue"}),jsxRuntimeExports.jsxs("div",{className:"reply-add-area",children:[jsxRuntimeExports.jsx("input",{type:"text",value:dp,onChange:Tp=>hp(Tp.target.value),onKeyDown:Tp=>bp(Tp),placeholder:""}),jsxRuntimeExports.jsx("div",{className:"send-reply bg-blue",children:jsxRuntimeExports.jsx(default_1$9,{})})]})]})]})]}):(console.log(1),jsxRuntimeExports.jsx(Loading,{}))},BoardCreate=()=>{var ap;const rp=useLocation(),[_d,np]=reactExports.useState((ap=rp.state)==null?void 0:ap.categoryId);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Header,{centerText:""}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(BoardFormItem,{type:"create",categoryId:_d})})]})},BoardModify=()=>{var cp;const{id:rp}=useParams(),[_d,np]=reactExports.useState([]),ap=useLocation(),[sp,lp]=reactExports.useState((cp=ap.state)==null?void 0:cp.categoryId);reactExports.useEffect(()=>{up()},[]);const up=async()=>{await getBoardDetail(rp).then(dp=>np(dp))};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Header,{centerText:""}),jsxRuntimeExports.jsx("div",{children:_d&&jsxRuntimeExports.jsx(BoardFormItem,{type:"modify",categoryId:sp,boardData:_d})})]})},AuthPage=()=>{const{social:rp}=useParams(),np=new URL(document.URL).searchParams.get("code"),ap="https://i10c203.p.ssafy.io",sp=useNavigate();np||sp("/");const lp=async()=>{try{const up=await axios.post(`${ap}/api/login/${rp}`,{code:np}),cp=up.data.accessToken,dp=await axios.get(`${ap}/api/users`,{headers:{Authorization:cp}});localStorage.setItem("jwt",cp),localStorage.setItem("user",JSON.stringify({socialId:up.data.socialId,imageUrl:dp.data.imageUrl,nickname:dp.data.nickname})),sp("/",{replace:!0})}catch(up){console.log(up)}};return reactExports.useEffect(()=>{lp()},[]),jsxRuntimeExports.jsx(Loading,{})};var ArrowForwardIosOutlined={},_interopRequireDefault$2=interopRequireDefaultExports;Object.defineProperty(ArrowForwardIosOutlined,"__esModule",{value:!0});var default_1$2=ArrowForwardIosOutlined.default=void 0,_createSvgIcon$2=_interopRequireDefault$2(requireCreateSvgIcon()),_jsxRuntime$2=jsxRuntimeExports;default_1$2=ArrowForwardIosOutlined.default=(0,_createSvgIcon$2.default)((0,_jsxRuntime$2.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIosOutlined");var SettingsOutlined={},_interopRequireDefault$1=interopRequireDefaultExports;Object.defineProperty(SettingsOutlined,"__esModule",{value:!0});var default_1$1=SettingsOutlined.default=void 0,_createSvgIcon$1=_interopRequireDefault$1(requireCreateSvgIcon()),_jsxRuntime$1=jsxRuntimeExports;default_1$1=SettingsOutlined.default=(0,_createSvgIcon$1.default)((0,_jsxRuntime$1.jsx)("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98 0-.34-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.09-.16-.26-.25-.44-.25-.06 0-.12.01-.17.03l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.06-.02-.12-.03-.18-.03-.17 0-.34.09-.43.25l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98 0 .33.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.09.16.26.25.44.25.06 0 .12-.01.17-.03l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.06.02.12.03.18.03.17 0 .34-.09.43-.25l2-3.46c.12-.22.07-.49-.12-.64zm-1.98-1.71c.04.31.05.52.05.73 0 .21-.02.43-.05.73l-.14 1.13.89.7 1.08.84-.7 1.21-1.27-.51-1.04-.42-.9.68c-.43.32-.84.56-1.25.73l-1.06.43-.16 1.13-.2 1.35h-1.4l-.19-1.35-.16-1.13-1.06-.43c-.43-.18-.83-.41-1.23-.71l-.91-.7-1.06.43-1.27.51-.7-1.21 1.08-.84.89-.7-.14-1.13c-.03-.31-.05-.54-.05-.74s.02-.43.05-.73l.14-1.13-.89-.7-1.08-.84.7-1.21 1.27.51 1.04.42.9-.68c.43-.32.84-.56 1.25-.73l1.06-.43.16-1.13.2-1.35h1.39l.19 1.35.16 1.13 1.06.43c.43.18.83.41 1.23.71l.91.7 1.06-.43 1.27-.51.7 1.21-1.07.85-.89.7zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"}),"SettingsOutlined");const MyPage=()=>{const rp=useNavigate(),_d=JSON.parse(localStorage.getItem("user")),np=()=>{rp("edit")};return reactExports.useEffect(()=>{_d||rp("/login",{replace:!0})}),jsxRuntimeExports.jsxs("div",{className:"mypage",children:[jsxRuntimeExports.jsx(Header,{centerText:"My ",align:"center"}),jsxRuntimeExports.jsx(default_1$1,{onClick:np,className:"edit"}),jsxRuntimeExports.jsxs("div",{className:"wrapper",children:[jsxRuntimeExports.jsx("img",{className:"profile",src:(_d==null?void 0:_d.imageUrl)||profile,alt:""}),jsxRuntimeExports.jsx("div",{className:"user-nick",children:_d==null?void 0:_d.nickname})]}),jsxRuntimeExports.jsxs("div",{className:"user-content",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>rp("fish"),children:[" ",jsxRuntimeExports.jsx(default_1$2,{})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>rp("location"),children:[" ",jsxRuntimeExports.jsx(default_1$2,{})]}),jsxRuntimeExports.jsxs("button",{className:"later",children:[jsxRuntimeExports.jsx("div",{className:"title",children:"  "}),jsxRuntimeExports.jsx("div",{className:"open-none bg-blue",children:" "})]})]})]})},baiting="/assets/baiting-LoaQEyrC.webp",fishing_casting="/assets/fishing_casting-ZEshX4zU.webp",fishing_tools="/assets/fishing_tools-bexuG7-j.webp",good_day="/assets/good_day-d3FqGdjm.webp",ipzil="/assets/ipzil-P46PeDdC.webp",needle_floor="/assets/needle_floor-xaty35lX.webp",remove_needle="/assets/remove_needle-ZmkMGki8.webp",tying_reel="/assets/tying_reel-9sEdY9Gw.webp",TutorialPage=()=>{const rp=reactExports.useRef([]),_d=reactExports.useRef([]),np=useNavigate(),[ap,sp]=reactExports.useState(0),[lp,up]=reactExports.useState(0),[cp,dp]=reactExports.useState(0),[hp,fp]=reactExports.useState(!1),[pp,mp]=reactExports.useState([{title:"   ",num:1,imageSrc:good_day},{title:"",num:2,imageSrc:fishing_tools},{title:" ",num:3,imageSrc:fishing_casting},{title:" ",num:4,imageSrc:tying_reel},{title:" ",num:5,imageSrc:baiting},{title:"  & ",num:6,imageSrc:ipzil},{title:" ",num:7,imageSrc:remove_needle},{title:"  ",num:8,imageSrc:needle_floor}]),gp=.02,yp=-.1;reactExports.useEffect(()=>{const _p=rp.current,vp=_d.current,bp=(Mp,Op,Pp)=>{const $p=xp([..._p],Pp)[Op];Mp.style.setProperty("--zIndex",$p),Mp.style.setProperty("--active",(Op-Pp)/_p.length)},Ep=()=>{const Mp=Math.max(0,Math.min(ap,100)),Op=Math.floor(Mp/100*(_p.length-1));dp(Op),_p.forEach((Pp,$p)=>bp(Pp,$p,Op))};Ep();const Sp=Mp=>{const Op=Mp.deltaY*gp;sp(Pp=>Pp+Op),Ep()},Ap=Mp=>{if(Mp.type==="mousemove"&&vp.forEach($p=>{$p.style.transform=`translate(${Mp.clientX}px, ${Mp.clientY}px)`}),!hp)return;const Op=Mp.clientX||Mp.touches&&Mp.touches[0].clientX||0,Pp=(Op-lp)*yp;sp($p=>$p+Pp),up(Op),Ep()},Rp=Mp=>{fp(!0);const Op=Mp.clientX||Mp.touches&&Mp.touches[0].clientX||0;up(Op)},Tp=()=>{fp(!1)};return document.addEventListener("mousewheel",Sp),document.addEventListener("mousedown",Rp),document.addEventListener("mousemove",Ap),document.addEventListener("mouseup",Tp),document.addEventListener("touchstart",Rp),document.addEventListener("touchmove",Ap),document.addEventListener("touchend",Tp),()=>{document.removeEventListener("mousewheel",Sp),document.removeEventListener("mousedown",Rp),document.removeEventListener("mousemove",Ap),document.removeEventListener("mouseup",Tp),document.removeEventListener("touchstart",Rp),document.removeEventListener("touchmove",Ap),document.removeEventListener("touchend",Tp)}},[ap,hp,lp]);const xp=(_p,vp)=>_p.map((bp,Ep)=>vp===Ep?_p.length:_p.length-Math.abs(vp-Ep));return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Header,{centerText:"",prevPath:"/"}),jsxRuntimeExports.jsx("div",{className:"carousel-body"}),jsxRuntimeExports.jsx("div",{className:"carousel",children:pp.map((_p,vp)=>jsxRuntimeExports.jsx("div",{ref:bp=>rp.current[vp]=bp,className:"carousel-item",children:jsxRuntimeExports.jsxs("div",{className:"carousel-box",onClick:()=>np(`/tutorial/${_p.num}`,{state:{title:_p.title}}),children:[jsxRuntimeExports.jsx("div",{className:"title",children:_p.title}),jsxRuntimeExports.jsx("div",{className:"num",children:_p.num}),jsxRuntimeExports.jsx("img",{src:_p.imageSrc,alt:_p.title})]})},vp))})]})},fishKing="/assets/fish_king-dNUI1omU.png";function ChatBotChattingForm({onChat:rp,loadingState:_d,setLoadingState:np}){const[ap,sp]=reactExports.useState(""),lp=JSON.parse(localStorage.getItem("user")),up=hp=>{sp(hp.target.value)},cp=hp=>{hp.key==="Enter"&&hp.target.value.trim()!==""&&(hp.preventDefault(),dp(hp))},dp=hp=>{hp.preventDefault(),rp(ap),sp(""),np(!_d)};return reactExports.useEffect(()=>{sp(_d?" ":"")},[_d]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("div",{className:"reply-add",children:[jsxRuntimeExports.jsx("div",{className:"reply-line bg-blue"}),jsxRuntimeExports.jsx("img",{src:lp.imageUrl,alt:""}),jsxRuntimeExports.jsxs("div",{className:"reply-add-area",children:[jsxRuntimeExports.jsx("input",{className:"chatbot-input",value:ap,type:"text",placeholder:" ...",onChange:up,onKeyPress:cp,readOnly:_d}),ap.trim()!==""&&jsxRuntimeExports.jsx("div",{className:"send-reply bg-blue",onClick:dp,children:jsxRuntimeExports.jsx(default_1$9,{})})]})]})})})}function ChatBotLoading(){return jsxRuntimeExports.jsxs("div",{className:"chatBotLoading",children:[jsxRuntimeExports.jsx("div",{className:"chatBotLoading-bounce1"}),jsxRuntimeExports.jsx("div",{className:"chatBotLoading-bounce2"}),jsxRuntimeExports.jsx("div",{className:"chatBotLoading-bounce3"})]})}function ChatBotChattingList(rp){const _d=useNavigate(),np=reactExports.useRef(),ap=reactExports.useRef(null),sp=reactExports.useRef(null),[lp,up]=reactExports.useState(!1),[cp,dp]=reactExports.useState(!0),hp=rp.chattingList,fp=[{tutorial:""},{"fish/map":""},{fishbook:""},{"media/roomList":""},{"media/board":""}],pp=()=>{sp.current&&clearTimeout(sp.current),sp.current=setTimeout(()=>{const gp=ap.current.scrollTop,yp=ap.current.clientHeight,xp=ap.current.scrollHeight;dp(gp+yp>=xp-100)},100)},mp=reactExports.useCallback(()=>{pp()},[]);return reactExports.useEffect(()=>{up(!0),cp&&np.current.scrollIntoView({behavior:"smooth"}),up(!1)},[hp,cp]),reactExports.useEffect(()=>(ap.current.addEventListener("scroll",mp),()=>{sp.current&&clearTimeout(sp.current),ap.current&&ap.current.removeEventListener("scroll",mp)}),[mp]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{ref:ap,className:"message-box",children:[hp.map((gp,yp)=>jsxRuntimeExports.jsxs("div",{className:gp.user==="bot"?"message-bot blue-bd":"message-user",children:[gp.user==="bot"&&gp.imgURL&&jsxRuntimeExports.jsx("div",{className:"message-bot-content",children:jsxRuntimeExports.jsx("img",{className:"message-bot-img",src:gp.imgURL,alt:""})}),gp.chat==="loading"?jsxRuntimeExports.jsx(ChatBotLoading,{}):jsxRuntimeExports.jsx("div",{className:"message-content",children:gp.chat}),gp.user==="bot"&&gp.move&&jsxRuntimeExports.jsxs("div",{onClick:()=>_d(`/${gp.move}`),className:"message-bot-move",children:[jsxRuntimeExports.jsx("span",{children:fp.find(xp=>xp[gp.move])[gp.move]})," "]})]},yp)),jsxRuntimeExports.jsx("div",{ref:np}),lp&&jsxRuntimeExports.jsx(Loading,{})]})})}const api$1=axiosApi();async function postSendChat(rp){try{const{data:_d}=await api$1.post("/api/chatbot",{inputText:rp});return _d}catch(_d){console.log(_d)}}function ChatBot(){const rp=useNavigate(),[_d,np]=reactExports.useState([]),ap=JSON.parse(localStorage.getItem("user")),[sp,lp]=reactExports.useState(!1),up=["  ","  ","  "," "," "," ?"],cp=async hp=>{np(fp=>[...fp,{user:"user",chat:hp,imgURL:null,move:null}]),np(fp=>[...fp,{user:"bot",chat:"loading",imgURL:null,move:null}]),lp(!0),await postSendChat(hp).then(fp=>{lp(!1),np(pp=>{let mp=[...pp];return mp[mp.length-1]={user:"bot",chat:fp.text,imgURL:fp.imageUrl,move:fp.move},mp})})},dp=hp=>{cp(hp.target.textContent)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"chatbot-sticky",children:[jsxRuntimeExports.jsx(Header,{onClick:()=>rp("/")}),jsxRuntimeExports.jsxs("div",{className:"chatbot-header",children:[jsxRuntimeExports.jsx("img",{src:fishKing,className:"chatbot-fishking"}),jsxRuntimeExports.jsx("span",{children:""})]})]}),jsxRuntimeExports.jsxs("div",{className:"chatbot-body",children:[jsxRuntimeExports.jsx("div",{className:"chatbot-chat-container",children:jsxRuntimeExports.jsx("div",{className:"chatbot-start-ment",children:jsxRuntimeExports.jsxs("div",{className:"chatbot-startChat blue-bd",children:[jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{children:ap.nickname})," , ."]}),jsxRuntimeExports.jsx("p",{children:"."}),jsxRuntimeExports.jsx("p",{children:"  ?"})]})})}),jsxRuntimeExports.jsx("div",{className:"chatbot-chat-container",children:jsxRuntimeExports.jsxs("div",{className:"chatbot-recommend-div",children:[jsxRuntimeExports.jsx("div",{className:"recomend-title",children:jsxRuntimeExports.jsx("span",{children:"  "})}),jsxRuntimeExports.jsx("div",{className:"recommend-ment",children:" ,  !"}),up.map((hp,fp)=>jsxRuntimeExports.jsx("div",{className:"chatbot-recommend",onClick:dp,children:hp},fp))]})}),jsxRuntimeExports.jsx(ChatBotChattingList,{chattingList:_d})]}),jsxRuntimeExports.jsx(ChatBotChattingForm,{onChat:cp,loadingState:sp,setLoadingState:lp})]})}var CameraAlt={},_interopRequireDefault=interopRequireDefaultExports;Object.defineProperty(CameraAlt,"__esModule",{value:!0});var default_1=CameraAlt.default=void 0,_createSvgIcon=_interopRequireDefault(requireCreateSvgIcon()),_jsxRuntime=jsxRuntimeExports;default_1=CameraAlt.default=(0,_createSvgIcon.default)([(0,_jsxRuntime.jsx)("circle",{cx:"12",cy:"12",r:"3.2"},"0"),(0,_jsxRuntime.jsx)("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt");const MyPageEdit=()=>{const rp="https://i10c203.p.ssafy.io",_d=JSON.parse(localStorage.getItem("user")),[np,ap]=reactExports.useState(_d==null?void 0:_d.nickname),[sp,lp]=reactExports.useState(!1),[up,cp]=reactExports.useState(_d==null?void 0:_d.imageUrl),[dp,hp]=reactExports.useState(_d==null?void 0:_d.imageUrl),fp=useNavigate(),pp=()=>{localStorage.removeItem("jwt"),localStorage.removeItem("user"),fp("/login",{replace:!0})},mp=async()=>{try{await axios.delete(`${rp}/api/log-out`,{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}}),pp()}catch(bp){console.log(bp)}},gp=async()=>{try{await axios.delete(`${rp}/api/users`,{headers:{Authorization:localStorage.getItem("jwt")}}),pp()}catch(bp){console.log(bp)}},yp=bp=>{ap(bp.target.value)},xp=()=>{lp(!0)},_p=bp=>{const Ep=bp.target.files[0],Sp=new FileReader;Sp.readAsDataURL(Ep),Sp.onloadend=()=>{hp(Sp.result),cp(Ep)}},vp=async()=>{try{let bp;if(_d.imageUrl!==up){const Sp=new FormData;Sp.append("images",up),Sp.append("type","PROFILE"),bp=await axios.post(`${rp}/api/images`,Sp,{headers:{Authorization:localStorage.getItem("jwt")}})}const Ep=await axios.put(`${rp}/api/users`,{imageUrl:bp?bp.data.imageNames[0]:up,nickname:np},{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}});localStorage.setItem("user",Ep.config.data),fp("/user/mypage")}catch(bp){console.log(bp)}};return reactExports.useEffect(()=>{_d||fp("/login")},[]),jsxRuntimeExports.jsxs("div",{className:"mypage-edit",children:[jsxRuntimeExports.jsx(Header,{centerText:"My ",align:"center"}),jsxRuntimeExports.jsx("div",{className:"complete",onClick:vp,children:""}),jsxRuntimeExports.jsx("div",{className:"profile",children:jsxRuntimeExports.jsxs("label",{htmlFor:"profile-img",children:[jsxRuntimeExports.jsx("img",{src:dp||profile,alt:"",className:"profile-img"}),jsxRuntimeExports.jsx("input",{type:"file",accept:"image/*",id:"profile-img",onChange:_p}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(default_1,{})})]})}),jsxRuntimeExports.jsxs("div",{className:"user-info",children:[jsxRuntimeExports.jsx("div",{className:"info-title",children:""}),jsxRuntimeExports.jsx("input",{className:"info-nick",type:"text",value:np,onChange:yp})]}),jsxRuntimeExports.jsxs("div",{className:"user-change",children:[jsxRuntimeExports.jsx("button",{className:"logout",onClick:mp,children:""}),jsxRuntimeExports.jsx("button",{className:"resign",onClick:xp,children:""})]}),sp&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"filter-open",onClick:()=>lp(!1)}),jsxRuntimeExports.jsxs("div",{className:"filter-content",children:[jsxRuntimeExports.jsx("h2",{children:" "}),jsxRuntimeExports.jsxs("div",{className:"leave-content",children:[jsxRuntimeExports.jsx("div",{children:"       "}),jsxRuntimeExports.jsx("div",{children:" ?"})]}),jsxRuntimeExports.jsxs("div",{className:"btn",children:[jsxRuntimeExports.jsx("button",{className:"cancel",onClick:()=>lp(!1),children:" "}),jsxRuntimeExports.jsx("button",{className:"leave",onClick:gp,children:""})]})]})]})]})},api=axiosApi();async function getTutorialInfo(rp){const _d=localStorage.getItem("jwt");try{api.defaults.headers.Authorization=_d;const{data:np}=await api.get(`/api/tutorials/${rp}`);return np}catch(np){console.log(np)}}function TutorialDetailPage(rp){const np=useLocation().state.title,[ap,sp]=reactExports.useState(0),[lp,up]=reactExports.useState([]),cp=useParams(),dp=hp=>{sp(hp.realIndex)};return reactExports.useEffect(()=>{getTutorialInfo(cp.id).then(hp=>{up(hp.tutorialInfo)})},[]),reactExports.useEffect(()=>{lp.forEach(hp=>{const fp=new Image;fp.src=hp.imageUrl})},[lp]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Header,{centerText:np,prevPath:"/tutorial"}),jsxRuntimeExports.jsxs("div",{className:"tutorial-slider",children:[jsxRuntimeExports.jsx(Swiper,{pagination:{type:"progressbar"},modules:[EffectCoverflow,Pagination,EffectCards],effect:"coverflow",onSlideChange:dp,centeredSlides:!0,mousewheel:{invert:!1},spaceBetween:-100,slideToClickedSlide:!0,children:lp.map((hp,fp)=>jsxRuntimeExports.jsx(SwiperSlide,{children:jsxRuntimeExports.jsx("div",{className:"slide-content",children:jsxRuntimeExports.jsx("img",{src:hp.imageUrl})})},fp))}),jsxRuntimeExports.jsx("div",{className:"tutorial-description",children:jsxRuntimeExports.jsx("h2",{className:"tutorial-fishking-answer",children:lp.length>0&&jsxRuntimeExports.jsx("div",{children:lp[ap].description})})})]})]})}const MyFishPage=()=>{const[rp,_d]=reactExports.useState([]),np=useNavigate(),ap=()=>{np("/media/board/create",{state:{categoryId:1}})},sp=async()=>{const lp=localStorage.getItem("jwt"),up=await axios.get("https://i10c203.p.ssafy.io/api/users/boards",{params:{categoryId:1},headers:{Authorization:lp}});console.log(up.data.myBoardResponses),_d(up.data.myBoardResponses)};return reactExports.useEffect(()=>{sp()},[]),jsxRuntimeExports.jsxs("div",{className:"my-fish-page",children:[jsxRuntimeExports.jsx(Header,{centerText:" ",align:"center"}),rp.length?jsxRuntimeExports.jsx("div",{className:"wrapper",children:rp.map(lp=>jsxRuntimeExports.jsxs("div",{className:"board-info",children:[jsxRuntimeExports.jsx("div",{children:lp.boardId}),jsxRuntimeExports.jsx("div",{children:lp.content}),jsxRuntimeExports.jsx("img",{src:lp.imageUrl,alt:""})]},lp.id))}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"none-data",children:"  ."}),jsxRuntimeExports.jsx("div",{className:"go-create bg-blue",onClick:ap,children:jsxRuntimeExports.jsx(default_1$4,{})})]})]})},MyLocationPage=()=>{const[rp,_d]=reactExports.useState([]),np=useNavigate(),ap=()=>{np("/media/board/create",{state:{categoryId:2}})},sp=async()=>{const lp=localStorage.getItem("jwt"),up=await axios.get("https://i10c203.p.ssafy.io/api/users/boards",{params:{categoryId:2},headers:{Authorization:lp}});console.log(up.data.myBoardResponses),_d(up.data.myBoardResponses)};return reactExports.useEffect(()=>{sp()},[]),jsxRuntimeExports.jsxs("div",{className:"my-location-page",children:[jsxRuntimeExports.jsx(Header,{centerText:" ",align:"center"}),rp.length?jsxRuntimeExports.jsx("div",{className:"wrapper",children:rp.map(lp=>jsxRuntimeExports.jsxs("div",{className:"board-info",children:[jsxRuntimeExports.jsx("div",{children:lp.boardId}),jsxRuntimeExports.jsx("div",{children:lp.content}),jsxRuntimeExports.jsx("img",{src:lp.imageUrl,alt:""})]},lp.id))}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"none-data",children:"  ."}),jsxRuntimeExports.jsx("div",{className:"go-create bg-blue",onClick:ap,children:jsxRuntimeExports.jsx(default_1$4,{})})]})]})},dol="/assets/-o5m9-Nd0.webp",dongal="/assets/-HBHoW3ir.webp",chamdom="/assets/-sMpDGkaJ.webp",gam="/assets/-UM9HBWfr.webp",Controls=({clownExist:rp,setClownExist:_d,clownCatch:np,stoneExist:ap,setStoneExist:sp,stoneCatch:lp,breamExist:up,setBreamExist:cp,breamCatch:dp,blackExist:hp,setBlackExist:fp,blackCatch:pp})=>{const[mp,gp]=reactExports.useState(!1);return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("div",{className:`controls ${mp?"":"closed"}`,children:[jsxRuntimeExports.jsx("button",{onClick:()=>gp(!mp),className:"toggleButton",type:"button"}),jsxRuntimeExports.jsxs("div",{className:"fish-aqualist",children:[jsxRuntimeExports.jsxs("div",{className:`fish-aquaitem ${np?"":"disabled"} ${rp?"checked":""}`,children:[jsxRuntimeExports.jsxs("div",{className:"fish-aquaprofile",children:[jsxRuntimeExports.jsx("img",{src:dongal,alt:""}),jsxRuntimeExports.jsx("div",{className:"fish-aquaname",children:""})]}),jsxRuntimeExports.jsx("label",{children:jsxRuntimeExports.jsx("input",{role:"switch",type:"checkbox",onClick:()=>{_d(yp=>!yp)}})})]}),jsxRuntimeExports.jsxs("div",{className:`fish-aquaitem ${lp?"":"disabled"} ${ap?"checked":""}`,children:[jsxRuntimeExports.jsxs("div",{className:"fish-aquaprofile",children:[jsxRuntimeExports.jsx("img",{src:dol,alt:""}),jsxRuntimeExports.jsx("div",{className:"fish-aquaname",children:""})]}),jsxRuntimeExports.jsx("label",{children:jsxRuntimeExports.jsx("input",{role:"switch",type:"checkbox",onClick:()=>{sp(yp=>!yp)}})})]}),jsxRuntimeExports.jsxs("div",{className:`fish-aquaitem ${dp?"":"disabled"} ${up?"checked":""}`,children:[jsxRuntimeExports.jsxs("div",{className:"fish-aquaprofile",children:[jsxRuntimeExports.jsx("img",{src:chamdom,alt:""}),jsxRuntimeExports.jsx("div",{className:"fish-aquaname",children:""})]}),jsxRuntimeExports.jsx("label",{children:jsxRuntimeExports.jsx("input",{role:"switch",type:"checkbox",onClick:()=>{cp(yp=>!yp)}})})]}),jsxRuntimeExports.jsxs("div",{className:`fish-aquaitem ${pp?"":"disabled"} ${hp?"checked":""}`,children:[jsxRuntimeExports.jsxs("div",{className:"fish-aquaprofile",children:[jsxRuntimeExports.jsx("img",{src:gam,alt:""}),jsxRuntimeExports.jsx("div",{className:"fish-aquaname",children:""})]}),jsxRuntimeExports.jsx("label",{children:jsxRuntimeExports.jsx("input",{role:"switch",type:"checkbox",onClick:()=>{fp(yp=>!yp)}})})]})]})]})})};/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="161",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,ConstantColorFactor=211,OneMinusConstantColorFactor=212,ConstantAlphaFactor=213,OneMinusConstantAlphaFactor=214,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,AgXToneMapping=6,AttachedBindMode="attached",DetachedBindMode="detached",UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,AlphaFormat=1021,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RGB_BPTC_SIGNED_Format=36494,RGB_BPTC_UNSIGNED_Format=36495,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,LinearEncoding=3e3,sRGBEncoding=3001,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace$1="",SRGBColorSpace$1="srgb",LinearSRGBColorSpace$1="srgb-linear",DisplayP3ColorSpace="display-p3",LinearDisplayP3ColorSpace="display-p3-linear",LinearTransfer="linear",SRGBTransfer="srgb",Rec709Primaries="rec709",P3Primaries="p3",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",_SRGBAFormat=1035,WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(_d,np){this._listeners===void 0&&(this._listeners={});const ap=this._listeners;ap[_d]===void 0&&(ap[_d]=[]),ap[_d].indexOf(np)===-1&&ap[_d].push(np)}hasEventListener(_d,np){if(this._listeners===void 0)return!1;const ap=this._listeners;return ap[_d]!==void 0&&ap[_d].indexOf(np)!==-1}removeEventListener(_d,np){if(this._listeners===void 0)return;const sp=this._listeners[_d];if(sp!==void 0){const lp=sp.indexOf(np);lp!==-1&&sp.splice(lp,1)}}dispatchEvent(_d){if(this._listeners===void 0)return;const ap=this._listeners[_d.type];if(ap!==void 0){_d.target=this;const sp=ap.slice(0);for(let lp=0,up=sp.length;lp<up;lp++)sp[lp].call(this,_d);_d.target=null}}}const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const rp=Math.random()*4294967295|0,_d=Math.random()*4294967295|0,np=Math.random()*4294967295|0,ap=Math.random()*4294967295|0;return(_lut[rp&255]+_lut[rp>>8&255]+_lut[rp>>16&255]+_lut[rp>>24&255]+"-"+_lut[_d&255]+_lut[_d>>8&255]+"-"+_lut[_d>>16&15|64]+_lut[_d>>24&255]+"-"+_lut[np&63|128]+_lut[np>>8&255]+"-"+_lut[np>>16&255]+_lut[np>>24&255]+_lut[ap&255]+_lut[ap>>8&255]+_lut[ap>>16&255]+_lut[ap>>24&255]).toLowerCase()}function clamp(rp,_d,np){return Math.max(_d,Math.min(np,rp))}function euclideanModulo(rp,_d){return(rp%_d+_d)%_d}function mapLinear(rp,_d,np,ap,sp){return ap+(rp-_d)*(sp-ap)/(np-_d)}function inverseLerp(rp,_d,np){return rp!==_d?(np-rp)/(_d-rp):0}function lerp$1(rp,_d,np){return(1-np)*rp+np*_d}function damp(rp,_d,np,ap){return lerp$1(rp,_d,1-Math.exp(-np*ap))}function pingpong(rp,_d=1){return _d-Math.abs(euclideanModulo(rp,_d*2)-_d)}function smoothstep(rp,_d,np){return rp<=_d?0:rp>=np?1:(rp=(rp-_d)/(np-_d),rp*rp*(3-2*rp))}function smootherstep(rp,_d,np){return rp<=_d?0:rp>=np?1:(rp=(rp-_d)/(np-_d),rp*rp*rp*(rp*(rp*6-15)+10))}function randInt(rp,_d){return rp+Math.floor(Math.random()*(_d-rp+1))}function randFloat(rp,_d){return rp+Math.random()*(_d-rp)}function randFloatSpread(rp){return rp*(.5-Math.random())}function seededRandom(rp){rp!==void 0&&(_seed=rp);let _d=_seed+=1831565813;return _d=Math.imul(_d^_d>>>15,_d|1),_d^=_d+Math.imul(_d^_d>>>7,_d|61),((_d^_d>>>14)>>>0)/4294967296}function degToRad(rp){return rp*DEG2RAD}function radToDeg(rp){return rp*RAD2DEG}function isPowerOfTwo(rp){return(rp&rp-1)===0&&rp!==0}function ceilPowerOfTwo(rp){return Math.pow(2,Math.ceil(Math.log(rp)/Math.LN2))}function floorPowerOfTwo(rp){return Math.pow(2,Math.floor(Math.log(rp)/Math.LN2))}function setQuaternionFromProperEuler(rp,_d,np,ap,sp){const lp=Math.cos,up=Math.sin,cp=lp(np/2),dp=up(np/2),hp=lp((_d+ap)/2),fp=up((_d+ap)/2),pp=lp((_d-ap)/2),mp=up((_d-ap)/2),gp=lp((ap-_d)/2),yp=up((ap-_d)/2);switch(sp){case"XYX":rp.set(cp*fp,dp*pp,dp*mp,cp*hp);break;case"YZY":rp.set(dp*mp,cp*fp,dp*pp,cp*hp);break;case"ZXZ":rp.set(dp*pp,dp*mp,cp*fp,cp*hp);break;case"XZX":rp.set(cp*fp,dp*yp,dp*gp,cp*hp);break;case"YXY":rp.set(dp*gp,cp*fp,dp*yp,cp*hp);break;case"ZYZ":rp.set(dp*yp,dp*gp,cp*fp,cp*hp);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+sp)}}function denormalize(rp,_d){switch(_d.constructor){case Float32Array:return rp;case Uint32Array:return rp/4294967295;case Uint16Array:return rp/65535;case Uint8Array:return rp/255;case Int32Array:return Math.max(rp/2147483647,-1);case Int16Array:return Math.max(rp/32767,-1);case Int8Array:return Math.max(rp/127,-1);default:throw new Error("Invalid component type.")}}function normalize(rp,_d){switch(_d.constructor){case Float32Array:return rp;case Uint32Array:return Math.round(rp*4294967295);case Uint16Array:return Math.round(rp*65535);case Uint8Array:return Math.round(rp*255);case Int32Array:return Math.round(rp*2147483647);case Int16Array:return Math.round(rp*32767);case Int8Array:return Math.round(rp*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID,clamp,euclideanModulo,mapLinear,inverseLerp,lerp:lerp$1,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize,denormalize};class Vector2{constructor(_d=0,np=0){Vector2.prototype.isVector2=!0,this.x=_d,this.y=np}get width(){return this.x}set width(_d){this.x=_d}get height(){return this.y}set height(_d){this.y=_d}set(_d,np){return this.x=_d,this.y=np,this}setScalar(_d){return this.x=_d,this.y=_d,this}setX(_d){return this.x=_d,this}setY(_d){return this.y=_d,this}setComponent(_d,np){switch(_d){case 0:this.x=np;break;case 1:this.y=np;break;default:throw new Error("index is out of range: "+_d)}return this}getComponent(_d){switch(_d){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_d)}}clone(){return new this.constructor(this.x,this.y)}copy(_d){return this.x=_d.x,this.y=_d.y,this}add(_d){return this.x+=_d.x,this.y+=_d.y,this}addScalar(_d){return this.x+=_d,this.y+=_d,this}addVectors(_d,np){return this.x=_d.x+np.x,this.y=_d.y+np.y,this}addScaledVector(_d,np){return this.x+=_d.x*np,this.y+=_d.y*np,this}sub(_d){return this.x-=_d.x,this.y-=_d.y,this}subScalar(_d){return this.x-=_d,this.y-=_d,this}subVectors(_d,np){return this.x=_d.x-np.x,this.y=_d.y-np.y,this}multiply(_d){return this.x*=_d.x,this.y*=_d.y,this}multiplyScalar(_d){return this.x*=_d,this.y*=_d,this}divide(_d){return this.x/=_d.x,this.y/=_d.y,this}divideScalar(_d){return this.multiplyScalar(1/_d)}applyMatrix3(_d){const np=this.x,ap=this.y,sp=_d.elements;return this.x=sp[0]*np+sp[3]*ap+sp[6],this.y=sp[1]*np+sp[4]*ap+sp[7],this}min(_d){return this.x=Math.min(this.x,_d.x),this.y=Math.min(this.y,_d.y),this}max(_d){return this.x=Math.max(this.x,_d.x),this.y=Math.max(this.y,_d.y),this}clamp(_d,np){return this.x=Math.max(_d.x,Math.min(np.x,this.x)),this.y=Math.max(_d.y,Math.min(np.y,this.y)),this}clampScalar(_d,np){return this.x=Math.max(_d,Math.min(np,this.x)),this.y=Math.max(_d,Math.min(np,this.y)),this}clampLength(_d,np){const ap=this.length();return this.divideScalar(ap||1).multiplyScalar(Math.max(_d,Math.min(np,ap)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_d){return this.x*_d.x+this.y*_d.y}cross(_d){return this.x*_d.y-this.y*_d.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_d){const np=Math.sqrt(this.lengthSq()*_d.lengthSq());if(np===0)return Math.PI/2;const ap=this.dot(_d)/np;return Math.acos(clamp(ap,-1,1))}distanceTo(_d){return Math.sqrt(this.distanceToSquared(_d))}distanceToSquared(_d){const np=this.x-_d.x,ap=this.y-_d.y;return np*np+ap*ap}manhattanDistanceTo(_d){return Math.abs(this.x-_d.x)+Math.abs(this.y-_d.y)}setLength(_d){return this.normalize().multiplyScalar(_d)}lerp(_d,np){return this.x+=(_d.x-this.x)*np,this.y+=(_d.y-this.y)*np,this}lerpVectors(_d,np,ap){return this.x=_d.x+(np.x-_d.x)*ap,this.y=_d.y+(np.y-_d.y)*ap,this}equals(_d){return _d.x===this.x&&_d.y===this.y}fromArray(_d,np=0){return this.x=_d[np],this.y=_d[np+1],this}toArray(_d=[],np=0){return _d[np]=this.x,_d[np+1]=this.y,_d}fromBufferAttribute(_d,np){return this.x=_d.getX(np),this.y=_d.getY(np),this}rotateAround(_d,np){const ap=Math.cos(np),sp=Math.sin(np),lp=this.x-_d.x,up=this.y-_d.y;return this.x=lp*ap-up*sp+_d.x,this.y=lp*sp+up*ap+_d.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(_d,np,ap,sp,lp,up,cp,dp,hp){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_d!==void 0&&this.set(_d,np,ap,sp,lp,up,cp,dp,hp)}set(_d,np,ap,sp,lp,up,cp,dp,hp){const fp=this.elements;return fp[0]=_d,fp[1]=sp,fp[2]=cp,fp[3]=np,fp[4]=lp,fp[5]=dp,fp[6]=ap,fp[7]=up,fp[8]=hp,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_d){const np=this.elements,ap=_d.elements;return np[0]=ap[0],np[1]=ap[1],np[2]=ap[2],np[3]=ap[3],np[4]=ap[4],np[5]=ap[5],np[6]=ap[6],np[7]=ap[7],np[8]=ap[8],this}extractBasis(_d,np,ap){return _d.setFromMatrix3Column(this,0),np.setFromMatrix3Column(this,1),ap.setFromMatrix3Column(this,2),this}setFromMatrix4(_d){const np=_d.elements;return this.set(np[0],np[4],np[8],np[1],np[5],np[9],np[2],np[6],np[10]),this}multiply(_d){return this.multiplyMatrices(this,_d)}premultiply(_d){return this.multiplyMatrices(_d,this)}multiplyMatrices(_d,np){const ap=_d.elements,sp=np.elements,lp=this.elements,up=ap[0],cp=ap[3],dp=ap[6],hp=ap[1],fp=ap[4],pp=ap[7],mp=ap[2],gp=ap[5],yp=ap[8],xp=sp[0],_p=sp[3],vp=sp[6],bp=sp[1],Ep=sp[4],Sp=sp[7],Ap=sp[2],Rp=sp[5],Tp=sp[8];return lp[0]=up*xp+cp*bp+dp*Ap,lp[3]=up*_p+cp*Ep+dp*Rp,lp[6]=up*vp+cp*Sp+dp*Tp,lp[1]=hp*xp+fp*bp+pp*Ap,lp[4]=hp*_p+fp*Ep+pp*Rp,lp[7]=hp*vp+fp*Sp+pp*Tp,lp[2]=mp*xp+gp*bp+yp*Ap,lp[5]=mp*_p+gp*Ep+yp*Rp,lp[8]=mp*vp+gp*Sp+yp*Tp,this}multiplyScalar(_d){const np=this.elements;return np[0]*=_d,np[3]*=_d,np[6]*=_d,np[1]*=_d,np[4]*=_d,np[7]*=_d,np[2]*=_d,np[5]*=_d,np[8]*=_d,this}determinant(){const _d=this.elements,np=_d[0],ap=_d[1],sp=_d[2],lp=_d[3],up=_d[4],cp=_d[5],dp=_d[6],hp=_d[7],fp=_d[8];return np*up*fp-np*cp*hp-ap*lp*fp+ap*cp*dp+sp*lp*hp-sp*up*dp}invert(){const _d=this.elements,np=_d[0],ap=_d[1],sp=_d[2],lp=_d[3],up=_d[4],cp=_d[5],dp=_d[6],hp=_d[7],fp=_d[8],pp=fp*up-cp*hp,mp=cp*dp-fp*lp,gp=hp*lp-up*dp,yp=np*pp+ap*mp+sp*gp;if(yp===0)return this.set(0,0,0,0,0,0,0,0,0);const xp=1/yp;return _d[0]=pp*xp,_d[1]=(sp*hp-fp*ap)*xp,_d[2]=(cp*ap-sp*up)*xp,_d[3]=mp*xp,_d[4]=(fp*np-sp*dp)*xp,_d[5]=(sp*lp-cp*np)*xp,_d[6]=gp*xp,_d[7]=(ap*dp-hp*np)*xp,_d[8]=(up*np-ap*lp)*xp,this}transpose(){let _d;const np=this.elements;return _d=np[1],np[1]=np[3],np[3]=_d,_d=np[2],np[2]=np[6],np[6]=_d,_d=np[5],np[5]=np[7],np[7]=_d,this}getNormalMatrix(_d){return this.setFromMatrix4(_d).invert().transpose()}transposeIntoArray(_d){const np=this.elements;return _d[0]=np[0],_d[1]=np[3],_d[2]=np[6],_d[3]=np[1],_d[4]=np[4],_d[5]=np[7],_d[6]=np[2],_d[7]=np[5],_d[8]=np[8],this}setUvTransform(_d,np,ap,sp,lp,up,cp){const dp=Math.cos(lp),hp=Math.sin(lp);return this.set(ap*dp,ap*hp,-ap*(dp*up+hp*cp)+up+_d,-sp*hp,sp*dp,-sp*(-hp*up+dp*cp)+cp+np,0,0,1),this}scale(_d,np){return this.premultiply(_m3.makeScale(_d,np)),this}rotate(_d){return this.premultiply(_m3.makeRotation(-_d)),this}translate(_d,np){return this.premultiply(_m3.makeTranslation(_d,np)),this}makeTranslation(_d,np){return _d.isVector2?this.set(1,0,_d.x,0,1,_d.y,0,0,1):this.set(1,0,_d,0,1,np,0,0,1),this}makeRotation(_d){const np=Math.cos(_d),ap=Math.sin(_d);return this.set(np,-ap,0,ap,np,0,0,0,1),this}makeScale(_d,np){return this.set(_d,0,0,0,np,0,0,0,1),this}equals(_d){const np=this.elements,ap=_d.elements;for(let sp=0;sp<9;sp++)if(np[sp]!==ap[sp])return!1;return!0}fromArray(_d,np=0){for(let ap=0;ap<9;ap++)this.elements[ap]=_d[ap+np];return this}toArray(_d=[],np=0){const ap=this.elements;return _d[np]=ap[0],_d[np+1]=ap[1],_d[np+2]=ap[2],_d[np+3]=ap[3],_d[np+4]=ap[4],_d[np+5]=ap[5],_d[np+6]=ap[6],_d[np+7]=ap[7],_d[np+8]=ap[8],_d}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(rp){for(let _d=rp.length-1;_d>=0;--_d)if(rp[_d]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(rp,_d){return new TYPED_ARRAYS[rp](_d)}function createElementNS(rp){return document.createElementNS("http://www.w3.org/1999/xhtml",rp)}function createCanvasElement(){const rp=createElementNS("canvas");return rp.style.display="block",rp}const _cache={};function warnOnce(rp){rp in _cache||(_cache[rp]=!0,console.warn(rp))}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES={[LinearSRGBColorSpace$1]:{transfer:LinearTransfer,primaries:Rec709Primaries,toReference:rp=>rp,fromReference:rp=>rp},[SRGBColorSpace$1]:{transfer:SRGBTransfer,primaries:Rec709Primaries,toReference:rp=>rp.convertSRGBToLinear(),fromReference:rp=>rp.convertLinearToSRGB()},[LinearDisplayP3ColorSpace]:{transfer:LinearTransfer,primaries:P3Primaries,toReference:rp=>rp.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:rp=>rp.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3)},[DisplayP3ColorSpace]:{transfer:SRGBTransfer,primaries:P3Primaries,toReference:rp=>rp.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:rp=>rp.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES=new Set([LinearSRGBColorSpace$1,LinearDisplayP3ColorSpace]),ColorManagement={enabled:!0,_workingColorSpace:LinearSRGBColorSpace$1,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(rp){if(!SUPPORTED_WORKING_COLOR_SPACES.has(rp))throw new Error(`Unsupported working color space, "${rp}".`);this._workingColorSpace=rp},convert:function(rp,_d,np){if(this.enabled===!1||_d===np||!_d||!np)return rp;const ap=COLOR_SPACES[_d].toReference,sp=COLOR_SPACES[np].fromReference;return sp(ap(rp))},fromWorkingColorSpace:function(rp,_d){return this.convert(rp,this._workingColorSpace,_d)},toWorkingColorSpace:function(rp,_d){return this.convert(rp,_d,this._workingColorSpace)},getPrimaries:function(rp){return COLOR_SPACES[rp].primaries},getTransfer:function(rp){return rp===NoColorSpace$1?LinearTransfer:COLOR_SPACES[rp].transfer}};function SRGBToLinear(rp){return rp<.04045?rp*.0773993808:Math.pow(rp*.9478672986+.0521327014,2.4)}function LinearToSRGB(rp){return rp<.0031308?rp*12.92:1.055*Math.pow(rp,.41666)-.055}let _canvas;class ImageUtils{static getDataURL(_d){if(/^data:/i.test(_d.src)||typeof HTMLCanvasElement>"u")return _d.src;let np;if(_d instanceof HTMLCanvasElement)np=_d;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=_d.width,_canvas.height=_d.height;const ap=_canvas.getContext("2d");_d instanceof ImageData?ap.putImageData(_d,0,0):ap.drawImage(_d,0,0,_d.width,_d.height),np=_canvas}return np.width>2048||np.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_d),np.toDataURL("image/jpeg",.6)):np.toDataURL("image/png")}static sRGBToLinear(_d){if(typeof HTMLImageElement<"u"&&_d instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_d instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_d instanceof ImageBitmap){const np=createElementNS("canvas");np.width=_d.width,np.height=_d.height;const ap=np.getContext("2d");ap.drawImage(_d,0,0,_d.width,_d.height);const sp=ap.getImageData(0,0,_d.width,_d.height),lp=sp.data;for(let up=0;up<lp.length;up++)lp[up]=SRGBToLinear(lp[up]/255)*255;return ap.putImageData(sp,0,0),np}else if(_d.data){const np=_d.data.slice(0);for(let ap=0;ap<np.length;ap++)np instanceof Uint8Array||np instanceof Uint8ClampedArray?np[ap]=Math.floor(SRGBToLinear(np[ap]/255)*255):np[ap]=SRGBToLinear(np[ap]);return{data:np,width:_d.width,height:_d.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_d}}let _sourceId=0;class Source{constructor(_d=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID(),this.data=_d,this.dataReady=!0,this.version=0}set needsUpdate(_d){_d===!0&&this.version++}toJSON(_d){const np=_d===void 0||typeof _d=="string";if(!np&&_d.images[this.uuid]!==void 0)return _d.images[this.uuid];const ap={uuid:this.uuid,url:""},sp=this.data;if(sp!==null){let lp;if(Array.isArray(sp)){lp=[];for(let up=0,cp=sp.length;up<cp;up++)sp[up].isDataTexture?lp.push(serializeImage(sp[up].image)):lp.push(serializeImage(sp[up]))}else lp=serializeImage(sp);ap.url=lp}return np||(_d.images[this.uuid]=ap),ap}}function serializeImage(rp){return typeof HTMLImageElement<"u"&&rp instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&rp instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&rp instanceof ImageBitmap?ImageUtils.getDataURL(rp):rp.data?{data:Array.from(rp.data),width:rp.width,height:rp.height,type:rp.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0;class Texture extends EventDispatcher{constructor(_d=Texture.DEFAULT_IMAGE,np=Texture.DEFAULT_MAPPING,ap=ClampToEdgeWrapping,sp=ClampToEdgeWrapping,lp=LinearFilter,up=LinearMipmapLinearFilter,cp=RGBAFormat,dp=UnsignedByteType,hp=Texture.DEFAULT_ANISOTROPY,fp=NoColorSpace$1){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(_d),this.mipmaps=[],this.mapping=np,this.channel=0,this.wrapS=ap,this.wrapT=sp,this.magFilter=lp,this.minFilter=up,this.anisotropy=hp,this.format=cp,this.internalFormat=null,this.type=dp,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof fp=="string"?this.colorSpace=fp:(warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=fp===sRGBEncoding?SRGBColorSpace$1:NoColorSpace$1),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(_d=null){this.source.data=_d}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_d){return this.name=_d.name,this.source=_d.source,this.mipmaps=_d.mipmaps.slice(0),this.mapping=_d.mapping,this.channel=_d.channel,this.wrapS=_d.wrapS,this.wrapT=_d.wrapT,this.magFilter=_d.magFilter,this.minFilter=_d.minFilter,this.anisotropy=_d.anisotropy,this.format=_d.format,this.internalFormat=_d.internalFormat,this.type=_d.type,this.offset.copy(_d.offset),this.repeat.copy(_d.repeat),this.center.copy(_d.center),this.rotation=_d.rotation,this.matrixAutoUpdate=_d.matrixAutoUpdate,this.matrix.copy(_d.matrix),this.generateMipmaps=_d.generateMipmaps,this.premultiplyAlpha=_d.premultiplyAlpha,this.flipY=_d.flipY,this.unpackAlignment=_d.unpackAlignment,this.colorSpace=_d.colorSpace,this.userData=JSON.parse(JSON.stringify(_d.userData)),this.needsUpdate=!0,this}toJSON(_d){const np=_d===void 0||typeof _d=="string";if(!np&&_d.textures[this.uuid]!==void 0)return _d.textures[this.uuid];const ap={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_d).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(ap.userData=this.userData),np||(_d.textures[this.uuid]=ap),ap}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_d){if(this.mapping!==UVMapping)return _d;if(_d.applyMatrix3(this.matrix),_d.x<0||_d.x>1)switch(this.wrapS){case RepeatWrapping:_d.x=_d.x-Math.floor(_d.x);break;case ClampToEdgeWrapping:_d.x=_d.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_d.x)%2)===1?_d.x=Math.ceil(_d.x)-_d.x:_d.x=_d.x-Math.floor(_d.x);break}if(_d.y<0||_d.y>1)switch(this.wrapT){case RepeatWrapping:_d.y=_d.y-Math.floor(_d.y);break;case ClampToEdgeWrapping:_d.y=_d.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_d.y)%2)===1?_d.y=Math.ceil(_d.y)-_d.y:_d.y=_d.y-Math.floor(_d.y);break}return this.flipY&&(_d.y=1-_d.y),_d}set needsUpdate(_d){_d===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===SRGBColorSpace$1?sRGBEncoding:LinearEncoding}set encoding(_d){warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=_d===sRGBEncoding?SRGBColorSpace$1:NoColorSpace$1}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(_d=0,np=0,ap=0,sp=1){Vector4.prototype.isVector4=!0,this.x=_d,this.y=np,this.z=ap,this.w=sp}get width(){return this.z}set width(_d){this.z=_d}get height(){return this.w}set height(_d){this.w=_d}set(_d,np,ap,sp){return this.x=_d,this.y=np,this.z=ap,this.w=sp,this}setScalar(_d){return this.x=_d,this.y=_d,this.z=_d,this.w=_d,this}setX(_d){return this.x=_d,this}setY(_d){return this.y=_d,this}setZ(_d){return this.z=_d,this}setW(_d){return this.w=_d,this}setComponent(_d,np){switch(_d){case 0:this.x=np;break;case 1:this.y=np;break;case 2:this.z=np;break;case 3:this.w=np;break;default:throw new Error("index is out of range: "+_d)}return this}getComponent(_d){switch(_d){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_d)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_d){return this.x=_d.x,this.y=_d.y,this.z=_d.z,this.w=_d.w!==void 0?_d.w:1,this}add(_d){return this.x+=_d.x,this.y+=_d.y,this.z+=_d.z,this.w+=_d.w,this}addScalar(_d){return this.x+=_d,this.y+=_d,this.z+=_d,this.w+=_d,this}addVectors(_d,np){return this.x=_d.x+np.x,this.y=_d.y+np.y,this.z=_d.z+np.z,this.w=_d.w+np.w,this}addScaledVector(_d,np){return this.x+=_d.x*np,this.y+=_d.y*np,this.z+=_d.z*np,this.w+=_d.w*np,this}sub(_d){return this.x-=_d.x,this.y-=_d.y,this.z-=_d.z,this.w-=_d.w,this}subScalar(_d){return this.x-=_d,this.y-=_d,this.z-=_d,this.w-=_d,this}subVectors(_d,np){return this.x=_d.x-np.x,this.y=_d.y-np.y,this.z=_d.z-np.z,this.w=_d.w-np.w,this}multiply(_d){return this.x*=_d.x,this.y*=_d.y,this.z*=_d.z,this.w*=_d.w,this}multiplyScalar(_d){return this.x*=_d,this.y*=_d,this.z*=_d,this.w*=_d,this}applyMatrix4(_d){const np=this.x,ap=this.y,sp=this.z,lp=this.w,up=_d.elements;return this.x=up[0]*np+up[4]*ap+up[8]*sp+up[12]*lp,this.y=up[1]*np+up[5]*ap+up[9]*sp+up[13]*lp,this.z=up[2]*np+up[6]*ap+up[10]*sp+up[14]*lp,this.w=up[3]*np+up[7]*ap+up[11]*sp+up[15]*lp,this}divideScalar(_d){return this.multiplyScalar(1/_d)}setAxisAngleFromQuaternion(_d){this.w=2*Math.acos(_d.w);const np=Math.sqrt(1-_d.w*_d.w);return np<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_d.x/np,this.y=_d.y/np,this.z=_d.z/np),this}setAxisAngleFromRotationMatrix(_d){let np,ap,sp,lp;const dp=_d.elements,hp=dp[0],fp=dp[4],pp=dp[8],mp=dp[1],gp=dp[5],yp=dp[9],xp=dp[2],_p=dp[6],vp=dp[10];if(Math.abs(fp-mp)<.01&&Math.abs(pp-xp)<.01&&Math.abs(yp-_p)<.01){if(Math.abs(fp+mp)<.1&&Math.abs(pp+xp)<.1&&Math.abs(yp+_p)<.1&&Math.abs(hp+gp+vp-3)<.1)return this.set(1,0,0,0),this;np=Math.PI;const Ep=(hp+1)/2,Sp=(gp+1)/2,Ap=(vp+1)/2,Rp=(fp+mp)/4,Tp=(pp+xp)/4,Mp=(yp+_p)/4;return Ep>Sp&&Ep>Ap?Ep<.01?(ap=0,sp=.707106781,lp=.707106781):(ap=Math.sqrt(Ep),sp=Rp/ap,lp=Tp/ap):Sp>Ap?Sp<.01?(ap=.707106781,sp=0,lp=.707106781):(sp=Math.sqrt(Sp),ap=Rp/sp,lp=Mp/sp):Ap<.01?(ap=.707106781,sp=.707106781,lp=0):(lp=Math.sqrt(Ap),ap=Tp/lp,sp=Mp/lp),this.set(ap,sp,lp,np),this}let bp=Math.sqrt((_p-yp)*(_p-yp)+(pp-xp)*(pp-xp)+(mp-fp)*(mp-fp));return Math.abs(bp)<.001&&(bp=1),this.x=(_p-yp)/bp,this.y=(pp-xp)/bp,this.z=(mp-fp)/bp,this.w=Math.acos((hp+gp+vp-1)/2),this}min(_d){return this.x=Math.min(this.x,_d.x),this.y=Math.min(this.y,_d.y),this.z=Math.min(this.z,_d.z),this.w=Math.min(this.w,_d.w),this}max(_d){return this.x=Math.max(this.x,_d.x),this.y=Math.max(this.y,_d.y),this.z=Math.max(this.z,_d.z),this.w=Math.max(this.w,_d.w),this}clamp(_d,np){return this.x=Math.max(_d.x,Math.min(np.x,this.x)),this.y=Math.max(_d.y,Math.min(np.y,this.y)),this.z=Math.max(_d.z,Math.min(np.z,this.z)),this.w=Math.max(_d.w,Math.min(np.w,this.w)),this}clampScalar(_d,np){return this.x=Math.max(_d,Math.min(np,this.x)),this.y=Math.max(_d,Math.min(np,this.y)),this.z=Math.max(_d,Math.min(np,this.z)),this.w=Math.max(_d,Math.min(np,this.w)),this}clampLength(_d,np){const ap=this.length();return this.divideScalar(ap||1).multiplyScalar(Math.max(_d,Math.min(np,ap)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_d){return this.x*_d.x+this.y*_d.y+this.z*_d.z+this.w*_d.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_d){return this.normalize().multiplyScalar(_d)}lerp(_d,np){return this.x+=(_d.x-this.x)*np,this.y+=(_d.y-this.y)*np,this.z+=(_d.z-this.z)*np,this.w+=(_d.w-this.w)*np,this}lerpVectors(_d,np,ap){return this.x=_d.x+(np.x-_d.x)*ap,this.y=_d.y+(np.y-_d.y)*ap,this.z=_d.z+(np.z-_d.z)*ap,this.w=_d.w+(np.w-_d.w)*ap,this}equals(_d){return _d.x===this.x&&_d.y===this.y&&_d.z===this.z&&_d.w===this.w}fromArray(_d,np=0){return this.x=_d[np],this.y=_d[np+1],this.z=_d[np+2],this.w=_d[np+3],this}toArray(_d=[],np=0){return _d[np]=this.x,_d[np+1]=this.y,_d[np+2]=this.z,_d[np+3]=this.w,_d}fromBufferAttribute(_d,np){return this.x=_d.getX(np),this.y=_d.getY(np),this.z=_d.getZ(np),this.w=_d.getW(np),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class RenderTarget extends EventDispatcher{constructor(_d=1,np=1,ap={}){super(),this.isRenderTarget=!0,this.width=_d,this.height=np,this.depth=1,this.scissor=new Vector4(0,0,_d,np),this.scissorTest=!1,this.viewport=new Vector4(0,0,_d,np);const sp={width:_d,height:np,depth:1};ap.encoding!==void 0&&(warnOnce("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),ap.colorSpace=ap.encoding===sRGBEncoding?SRGBColorSpace$1:NoColorSpace$1),ap=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},ap),this.texture=new Texture(sp,ap.mapping,ap.wrapS,ap.wrapT,ap.magFilter,ap.minFilter,ap.format,ap.type,ap.anisotropy,ap.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=ap.generateMipmaps,this.texture.internalFormat=ap.internalFormat,this.depthBuffer=ap.depthBuffer,this.stencilBuffer=ap.stencilBuffer,this.depthTexture=ap.depthTexture,this.samples=ap.samples}setSize(_d,np,ap=1){(this.width!==_d||this.height!==np||this.depth!==ap)&&(this.width=_d,this.height=np,this.depth=ap,this.texture.image.width=_d,this.texture.image.height=np,this.texture.image.depth=ap,this.dispose()),this.viewport.set(0,0,_d,np),this.scissor.set(0,0,_d,np)}clone(){return new this.constructor().copy(this)}copy(_d){this.width=_d.width,this.height=_d.height,this.depth=_d.depth,this.scissor.copy(_d.scissor),this.scissorTest=_d.scissorTest,this.viewport.copy(_d.viewport),this.texture=_d.texture.clone(),this.texture.isRenderTargetTexture=!0;const np=Object.assign({},_d.texture.image);return this.texture.source=new Source(np),this.depthBuffer=_d.depthBuffer,this.stencilBuffer=_d.stencilBuffer,_d.depthTexture!==null&&(this.depthTexture=_d.depthTexture.clone()),this.samples=_d.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(_d=1,np=1,ap={}){super(_d,np,ap),this.isWebGLRenderTarget=!0}}class DataArrayTexture extends Texture{constructor(_d=null,np=1,ap=1,sp=1){super(null),this.isDataArrayTexture=!0,this.image={data:_d,width:np,height:ap,depth:sp},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(_d=1,np=1,ap=1,sp={}){super(_d,np,sp),this.isWebGLArrayRenderTarget=!0,this.depth=ap,this.texture=new DataArrayTexture(null,_d,np,ap),this.texture.isRenderTargetTexture=!0}}class Data3DTexture extends Texture{constructor(_d=null,np=1,ap=1,sp=1){super(null),this.isData3DTexture=!0,this.image={data:_d,width:np,height:ap,depth:sp},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(_d=1,np=1,ap=1,sp={}){super(_d,np,sp),this.isWebGL3DRenderTarget=!0,this.depth=ap,this.texture=new Data3DTexture(null,_d,np,ap),this.texture.isRenderTargetTexture=!0}}class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(_d=1,np=1,ap=1,sp={}){super(_d,np,sp),this.isWebGLMultipleRenderTargets=!0;const lp=this.texture;this.texture=[];for(let up=0;up<ap;up++)this.texture[up]=lp.clone(),this.texture[up].isRenderTargetTexture=!0}setSize(_d,np,ap=1){if(this.width!==_d||this.height!==np||this.depth!==ap){this.width=_d,this.height=np,this.depth=ap;for(let sp=0,lp=this.texture.length;sp<lp;sp++)this.texture[sp].image.width=_d,this.texture[sp].image.height=np,this.texture[sp].image.depth=ap;this.dispose()}this.viewport.set(0,0,_d,np),this.scissor.set(0,0,_d,np)}copy(_d){this.dispose(),this.width=_d.width,this.height=_d.height,this.depth=_d.depth,this.scissor.copy(_d.scissor),this.scissorTest=_d.scissorTest,this.viewport.copy(_d.viewport),this.depthBuffer=_d.depthBuffer,this.stencilBuffer=_d.stencilBuffer,_d.depthTexture!==null&&(this.depthTexture=_d.depthTexture.clone()),this.texture.length=0;for(let np=0,ap=_d.texture.length;np<ap;np++)this.texture[np]=_d.texture[np].clone(),this.texture[np].isRenderTargetTexture=!0;return this}}class Quaternion{constructor(_d=0,np=0,ap=0,sp=1){this.isQuaternion=!0,this._x=_d,this._y=np,this._z=ap,this._w=sp}static slerpFlat(_d,np,ap,sp,lp,up,cp){let dp=ap[sp+0],hp=ap[sp+1],fp=ap[sp+2],pp=ap[sp+3];const mp=lp[up+0],gp=lp[up+1],yp=lp[up+2],xp=lp[up+3];if(cp===0){_d[np+0]=dp,_d[np+1]=hp,_d[np+2]=fp,_d[np+3]=pp;return}if(cp===1){_d[np+0]=mp,_d[np+1]=gp,_d[np+2]=yp,_d[np+3]=xp;return}if(pp!==xp||dp!==mp||hp!==gp||fp!==yp){let _p=1-cp;const vp=dp*mp+hp*gp+fp*yp+pp*xp,bp=vp>=0?1:-1,Ep=1-vp*vp;if(Ep>Number.EPSILON){const Ap=Math.sqrt(Ep),Rp=Math.atan2(Ap,vp*bp);_p=Math.sin(_p*Rp)/Ap,cp=Math.sin(cp*Rp)/Ap}const Sp=cp*bp;if(dp=dp*_p+mp*Sp,hp=hp*_p+gp*Sp,fp=fp*_p+yp*Sp,pp=pp*_p+xp*Sp,_p===1-cp){const Ap=1/Math.sqrt(dp*dp+hp*hp+fp*fp+pp*pp);dp*=Ap,hp*=Ap,fp*=Ap,pp*=Ap}}_d[np]=dp,_d[np+1]=hp,_d[np+2]=fp,_d[np+3]=pp}static multiplyQuaternionsFlat(_d,np,ap,sp,lp,up){const cp=ap[sp],dp=ap[sp+1],hp=ap[sp+2],fp=ap[sp+3],pp=lp[up],mp=lp[up+1],gp=lp[up+2],yp=lp[up+3];return _d[np]=cp*yp+fp*pp+dp*gp-hp*mp,_d[np+1]=dp*yp+fp*mp+hp*pp-cp*gp,_d[np+2]=hp*yp+fp*gp+cp*mp-dp*pp,_d[np+3]=fp*yp-cp*pp-dp*mp-hp*gp,_d}get x(){return this._x}set x(_d){this._x=_d,this._onChangeCallback()}get y(){return this._y}set y(_d){this._y=_d,this._onChangeCallback()}get z(){return this._z}set z(_d){this._z=_d,this._onChangeCallback()}get w(){return this._w}set w(_d){this._w=_d,this._onChangeCallback()}set(_d,np,ap,sp){return this._x=_d,this._y=np,this._z=ap,this._w=sp,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_d){return this._x=_d.x,this._y=_d.y,this._z=_d.z,this._w=_d.w,this._onChangeCallback(),this}setFromEuler(_d,np=!0){const ap=_d._x,sp=_d._y,lp=_d._z,up=_d._order,cp=Math.cos,dp=Math.sin,hp=cp(ap/2),fp=cp(sp/2),pp=cp(lp/2),mp=dp(ap/2),gp=dp(sp/2),yp=dp(lp/2);switch(up){case"XYZ":this._x=mp*fp*pp+hp*gp*yp,this._y=hp*gp*pp-mp*fp*yp,this._z=hp*fp*yp+mp*gp*pp,this._w=hp*fp*pp-mp*gp*yp;break;case"YXZ":this._x=mp*fp*pp+hp*gp*yp,this._y=hp*gp*pp-mp*fp*yp,this._z=hp*fp*yp-mp*gp*pp,this._w=hp*fp*pp+mp*gp*yp;break;case"ZXY":this._x=mp*fp*pp-hp*gp*yp,this._y=hp*gp*pp+mp*fp*yp,this._z=hp*fp*yp+mp*gp*pp,this._w=hp*fp*pp-mp*gp*yp;break;case"ZYX":this._x=mp*fp*pp-hp*gp*yp,this._y=hp*gp*pp+mp*fp*yp,this._z=hp*fp*yp-mp*gp*pp,this._w=hp*fp*pp+mp*gp*yp;break;case"YZX":this._x=mp*fp*pp+hp*gp*yp,this._y=hp*gp*pp+mp*fp*yp,this._z=hp*fp*yp-mp*gp*pp,this._w=hp*fp*pp-mp*gp*yp;break;case"XZY":this._x=mp*fp*pp-hp*gp*yp,this._y=hp*gp*pp-mp*fp*yp,this._z=hp*fp*yp+mp*gp*pp,this._w=hp*fp*pp+mp*gp*yp;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+up)}return np===!0&&this._onChangeCallback(),this}setFromAxisAngle(_d,np){const ap=np/2,sp=Math.sin(ap);return this._x=_d.x*sp,this._y=_d.y*sp,this._z=_d.z*sp,this._w=Math.cos(ap),this._onChangeCallback(),this}setFromRotationMatrix(_d){const np=_d.elements,ap=np[0],sp=np[4],lp=np[8],up=np[1],cp=np[5],dp=np[9],hp=np[2],fp=np[6],pp=np[10],mp=ap+cp+pp;if(mp>0){const gp=.5/Math.sqrt(mp+1);this._w=.25/gp,this._x=(fp-dp)*gp,this._y=(lp-hp)*gp,this._z=(up-sp)*gp}else if(ap>cp&&ap>pp){const gp=2*Math.sqrt(1+ap-cp-pp);this._w=(fp-dp)/gp,this._x=.25*gp,this._y=(sp+up)/gp,this._z=(lp+hp)/gp}else if(cp>pp){const gp=2*Math.sqrt(1+cp-ap-pp);this._w=(lp-hp)/gp,this._x=(sp+up)/gp,this._y=.25*gp,this._z=(dp+fp)/gp}else{const gp=2*Math.sqrt(1+pp-ap-cp);this._w=(up-sp)/gp,this._x=(lp+hp)/gp,this._y=(dp+fp)/gp,this._z=.25*gp}return this._onChangeCallback(),this}setFromUnitVectors(_d,np){let ap=_d.dot(np)+1;return ap<Number.EPSILON?(ap=0,Math.abs(_d.x)>Math.abs(_d.z)?(this._x=-_d.y,this._y=_d.x,this._z=0,this._w=ap):(this._x=0,this._y=-_d.z,this._z=_d.y,this._w=ap)):(this._x=_d.y*np.z-_d.z*np.y,this._y=_d.z*np.x-_d.x*np.z,this._z=_d.x*np.y-_d.y*np.x,this._w=ap),this.normalize()}angleTo(_d){return 2*Math.acos(Math.abs(clamp(this.dot(_d),-1,1)))}rotateTowards(_d,np){const ap=this.angleTo(_d);if(ap===0)return this;const sp=Math.min(1,np/ap);return this.slerp(_d,sp),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_d){return this._x*_d._x+this._y*_d._y+this._z*_d._z+this._w*_d._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _d=this.length();return _d===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_d=1/_d,this._x=this._x*_d,this._y=this._y*_d,this._z=this._z*_d,this._w=this._w*_d),this._onChangeCallback(),this}multiply(_d){return this.multiplyQuaternions(this,_d)}premultiply(_d){return this.multiplyQuaternions(_d,this)}multiplyQuaternions(_d,np){const ap=_d._x,sp=_d._y,lp=_d._z,up=_d._w,cp=np._x,dp=np._y,hp=np._z,fp=np._w;return this._x=ap*fp+up*cp+sp*hp-lp*dp,this._y=sp*fp+up*dp+lp*cp-ap*hp,this._z=lp*fp+up*hp+ap*dp-sp*cp,this._w=up*fp-ap*cp-sp*dp-lp*hp,this._onChangeCallback(),this}slerp(_d,np){if(np===0)return this;if(np===1)return this.copy(_d);const ap=this._x,sp=this._y,lp=this._z,up=this._w;let cp=up*_d._w+ap*_d._x+sp*_d._y+lp*_d._z;if(cp<0?(this._w=-_d._w,this._x=-_d._x,this._y=-_d._y,this._z=-_d._z,cp=-cp):this.copy(_d),cp>=1)return this._w=up,this._x=ap,this._y=sp,this._z=lp,this;const dp=1-cp*cp;if(dp<=Number.EPSILON){const gp=1-np;return this._w=gp*up+np*this._w,this._x=gp*ap+np*this._x,this._y=gp*sp+np*this._y,this._z=gp*lp+np*this._z,this.normalize(),this}const hp=Math.sqrt(dp),fp=Math.atan2(hp,cp),pp=Math.sin((1-np)*fp)/hp,mp=Math.sin(np*fp)/hp;return this._w=up*pp+this._w*mp,this._x=ap*pp+this._x*mp,this._y=sp*pp+this._y*mp,this._z=lp*pp+this._z*mp,this._onChangeCallback(),this}slerpQuaternions(_d,np,ap){return this.copy(_d).slerp(np,ap)}random(){const _d=Math.random(),np=Math.sqrt(1-_d),ap=Math.sqrt(_d),sp=2*Math.PI*Math.random(),lp=2*Math.PI*Math.random();return this.set(np*Math.cos(sp),ap*Math.sin(lp),ap*Math.cos(lp),np*Math.sin(sp))}equals(_d){return _d._x===this._x&&_d._y===this._y&&_d._z===this._z&&_d._w===this._w}fromArray(_d,np=0){return this._x=_d[np],this._y=_d[np+1],this._z=_d[np+2],this._w=_d[np+3],this._onChangeCallback(),this}toArray(_d=[],np=0){return _d[np]=this._x,_d[np+1]=this._y,_d[np+2]=this._z,_d[np+3]=this._w,_d}fromBufferAttribute(_d,np){return this._x=_d.getX(np),this._y=_d.getY(np),this._z=_d.getZ(np),this._w=_d.getW(np),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(_d){return this._onChangeCallback=_d,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(_d=0,np=0,ap=0){Vector3.prototype.isVector3=!0,this.x=_d,this.y=np,this.z=ap}set(_d,np,ap){return ap===void 0&&(ap=this.z),this.x=_d,this.y=np,this.z=ap,this}setScalar(_d){return this.x=_d,this.y=_d,this.z=_d,this}setX(_d){return this.x=_d,this}setY(_d){return this.y=_d,this}setZ(_d){return this.z=_d,this}setComponent(_d,np){switch(_d){case 0:this.x=np;break;case 1:this.y=np;break;case 2:this.z=np;break;default:throw new Error("index is out of range: "+_d)}return this}getComponent(_d){switch(_d){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_d)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_d){return this.x=_d.x,this.y=_d.y,this.z=_d.z,this}add(_d){return this.x+=_d.x,this.y+=_d.y,this.z+=_d.z,this}addScalar(_d){return this.x+=_d,this.y+=_d,this.z+=_d,this}addVectors(_d,np){return this.x=_d.x+np.x,this.y=_d.y+np.y,this.z=_d.z+np.z,this}addScaledVector(_d,np){return this.x+=_d.x*np,this.y+=_d.y*np,this.z+=_d.z*np,this}sub(_d){return this.x-=_d.x,this.y-=_d.y,this.z-=_d.z,this}subScalar(_d){return this.x-=_d,this.y-=_d,this.z-=_d,this}subVectors(_d,np){return this.x=_d.x-np.x,this.y=_d.y-np.y,this.z=_d.z-np.z,this}multiply(_d){return this.x*=_d.x,this.y*=_d.y,this.z*=_d.z,this}multiplyScalar(_d){return this.x*=_d,this.y*=_d,this.z*=_d,this}multiplyVectors(_d,np){return this.x=_d.x*np.x,this.y=_d.y*np.y,this.z=_d.z*np.z,this}applyEuler(_d){return this.applyQuaternion(_quaternion$4.setFromEuler(_d))}applyAxisAngle(_d,np){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(_d,np))}applyMatrix3(_d){const np=this.x,ap=this.y,sp=this.z,lp=_d.elements;return this.x=lp[0]*np+lp[3]*ap+lp[6]*sp,this.y=lp[1]*np+lp[4]*ap+lp[7]*sp,this.z=lp[2]*np+lp[5]*ap+lp[8]*sp,this}applyNormalMatrix(_d){return this.applyMatrix3(_d).normalize()}applyMatrix4(_d){const np=this.x,ap=this.y,sp=this.z,lp=_d.elements,up=1/(lp[3]*np+lp[7]*ap+lp[11]*sp+lp[15]);return this.x=(lp[0]*np+lp[4]*ap+lp[8]*sp+lp[12])*up,this.y=(lp[1]*np+lp[5]*ap+lp[9]*sp+lp[13])*up,this.z=(lp[2]*np+lp[6]*ap+lp[10]*sp+lp[14])*up,this}applyQuaternion(_d){const np=this.x,ap=this.y,sp=this.z,lp=_d.x,up=_d.y,cp=_d.z,dp=_d.w,hp=2*(up*sp-cp*ap),fp=2*(cp*np-lp*sp),pp=2*(lp*ap-up*np);return this.x=np+dp*hp+up*pp-cp*fp,this.y=ap+dp*fp+cp*hp-lp*pp,this.z=sp+dp*pp+lp*fp-up*hp,this}project(_d){return this.applyMatrix4(_d.matrixWorldInverse).applyMatrix4(_d.projectionMatrix)}unproject(_d){return this.applyMatrix4(_d.projectionMatrixInverse).applyMatrix4(_d.matrixWorld)}transformDirection(_d){const np=this.x,ap=this.y,sp=this.z,lp=_d.elements;return this.x=lp[0]*np+lp[4]*ap+lp[8]*sp,this.y=lp[1]*np+lp[5]*ap+lp[9]*sp,this.z=lp[2]*np+lp[6]*ap+lp[10]*sp,this.normalize()}divide(_d){return this.x/=_d.x,this.y/=_d.y,this.z/=_d.z,this}divideScalar(_d){return this.multiplyScalar(1/_d)}min(_d){return this.x=Math.min(this.x,_d.x),this.y=Math.min(this.y,_d.y),this.z=Math.min(this.z,_d.z),this}max(_d){return this.x=Math.max(this.x,_d.x),this.y=Math.max(this.y,_d.y),this.z=Math.max(this.z,_d.z),this}clamp(_d,np){return this.x=Math.max(_d.x,Math.min(np.x,this.x)),this.y=Math.max(_d.y,Math.min(np.y,this.y)),this.z=Math.max(_d.z,Math.min(np.z,this.z)),this}clampScalar(_d,np){return this.x=Math.max(_d,Math.min(np,this.x)),this.y=Math.max(_d,Math.min(np,this.y)),this.z=Math.max(_d,Math.min(np,this.z)),this}clampLength(_d,np){const ap=this.length();return this.divideScalar(ap||1).multiplyScalar(Math.max(_d,Math.min(np,ap)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_d){return this.x*_d.x+this.y*_d.y+this.z*_d.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_d){return this.normalize().multiplyScalar(_d)}lerp(_d,np){return this.x+=(_d.x-this.x)*np,this.y+=(_d.y-this.y)*np,this.z+=(_d.z-this.z)*np,this}lerpVectors(_d,np,ap){return this.x=_d.x+(np.x-_d.x)*ap,this.y=_d.y+(np.y-_d.y)*ap,this.z=_d.z+(np.z-_d.z)*ap,this}cross(_d){return this.crossVectors(this,_d)}crossVectors(_d,np){const ap=_d.x,sp=_d.y,lp=_d.z,up=np.x,cp=np.y,dp=np.z;return this.x=sp*dp-lp*cp,this.y=lp*up-ap*dp,this.z=ap*cp-sp*up,this}projectOnVector(_d){const np=_d.lengthSq();if(np===0)return this.set(0,0,0);const ap=_d.dot(this)/np;return this.copy(_d).multiplyScalar(ap)}projectOnPlane(_d){return _vector$c.copy(this).projectOnVector(_d),this.sub(_vector$c)}reflect(_d){return this.sub(_vector$c.copy(_d).multiplyScalar(2*this.dot(_d)))}angleTo(_d){const np=Math.sqrt(this.lengthSq()*_d.lengthSq());if(np===0)return Math.PI/2;const ap=this.dot(_d)/np;return Math.acos(clamp(ap,-1,1))}distanceTo(_d){return Math.sqrt(this.distanceToSquared(_d))}distanceToSquared(_d){const np=this.x-_d.x,ap=this.y-_d.y,sp=this.z-_d.z;return np*np+ap*ap+sp*sp}manhattanDistanceTo(_d){return Math.abs(this.x-_d.x)+Math.abs(this.y-_d.y)+Math.abs(this.z-_d.z)}setFromSpherical(_d){return this.setFromSphericalCoords(_d.radius,_d.phi,_d.theta)}setFromSphericalCoords(_d,np,ap){const sp=Math.sin(np)*_d;return this.x=sp*Math.sin(ap),this.y=Math.cos(np)*_d,this.z=sp*Math.cos(ap),this}setFromCylindrical(_d){return this.setFromCylindricalCoords(_d.radius,_d.theta,_d.y)}setFromCylindricalCoords(_d,np,ap){return this.x=_d*Math.sin(np),this.y=ap,this.z=_d*Math.cos(np),this}setFromMatrixPosition(_d){const np=_d.elements;return this.x=np[12],this.y=np[13],this.z=np[14],this}setFromMatrixScale(_d){const np=this.setFromMatrixColumn(_d,0).length(),ap=this.setFromMatrixColumn(_d,1).length(),sp=this.setFromMatrixColumn(_d,2).length();return this.x=np,this.y=ap,this.z=sp,this}setFromMatrixColumn(_d,np){return this.fromArray(_d.elements,np*4)}setFromMatrix3Column(_d,np){return this.fromArray(_d.elements,np*3)}setFromEuler(_d){return this.x=_d._x,this.y=_d._y,this.z=_d._z,this}setFromColor(_d){return this.x=_d.r,this.y=_d.g,this.z=_d.b,this}equals(_d){return _d.x===this.x&&_d.y===this.y&&_d.z===this.z}fromArray(_d,np=0){return this.x=_d[np],this.y=_d[np+1],this.z=_d[np+2],this}toArray(_d=[],np=0){return _d[np]=this.x,_d[np+1]=this.y,_d[np+2]=this.z,_d}fromBufferAttribute(_d,np){return this.x=_d.getX(np),this.y=_d.getY(np),this.z=_d.getZ(np),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _d=(Math.random()-.5)*2,np=Math.random()*Math.PI*2,ap=Math.sqrt(1-_d**2);return this.x=ap*Math.cos(np),this.y=ap*Math.sin(np),this.z=_d,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(_d=new Vector3(1/0,1/0,1/0),np=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_d,this.max=np}set(_d,np){return this.min.copy(_d),this.max.copy(np),this}setFromArray(_d){this.makeEmpty();for(let np=0,ap=_d.length;np<ap;np+=3)this.expandByPoint(_vector$b.fromArray(_d,np));return this}setFromBufferAttribute(_d){this.makeEmpty();for(let np=0,ap=_d.count;np<ap;np++)this.expandByPoint(_vector$b.fromBufferAttribute(_d,np));return this}setFromPoints(_d){this.makeEmpty();for(let np=0,ap=_d.length;np<ap;np++)this.expandByPoint(_d[np]);return this}setFromCenterAndSize(_d,np){const ap=_vector$b.copy(np).multiplyScalar(.5);return this.min.copy(_d).sub(ap),this.max.copy(_d).add(ap),this}setFromObject(_d,np=!1){return this.makeEmpty(),this.expandByObject(_d,np)}clone(){return new this.constructor().copy(this)}copy(_d){return this.min.copy(_d.min),this.max.copy(_d.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_d){return this.isEmpty()?_d.set(0,0,0):_d.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_d){return this.isEmpty()?_d.set(0,0,0):_d.subVectors(this.max,this.min)}expandByPoint(_d){return this.min.min(_d),this.max.max(_d),this}expandByVector(_d){return this.min.sub(_d),this.max.add(_d),this}expandByScalar(_d){return this.min.addScalar(-_d),this.max.addScalar(_d),this}expandByObject(_d,np=!1){_d.updateWorldMatrix(!1,!1);const ap=_d.geometry;if(ap!==void 0){const lp=ap.getAttribute("position");if(np===!0&&lp!==void 0&&_d.isInstancedMesh!==!0)for(let up=0,cp=lp.count;up<cp;up++)_d.isMesh===!0?_d.getVertexPosition(up,_vector$b):_vector$b.fromBufferAttribute(lp,up),_vector$b.applyMatrix4(_d.matrixWorld),this.expandByPoint(_vector$b);else _d.boundingBox!==void 0?(_d.boundingBox===null&&_d.computeBoundingBox(),_box$4.copy(_d.boundingBox)):(ap.boundingBox===null&&ap.computeBoundingBox(),_box$4.copy(ap.boundingBox)),_box$4.applyMatrix4(_d.matrixWorld),this.union(_box$4)}const sp=_d.children;for(let lp=0,up=sp.length;lp<up;lp++)this.expandByObject(sp[lp],np);return this}containsPoint(_d){return!(_d.x<this.min.x||_d.x>this.max.x||_d.y<this.min.y||_d.y>this.max.y||_d.z<this.min.z||_d.z>this.max.z)}containsBox(_d){return this.min.x<=_d.min.x&&_d.max.x<=this.max.x&&this.min.y<=_d.min.y&&_d.max.y<=this.max.y&&this.min.z<=_d.min.z&&_d.max.z<=this.max.z}getParameter(_d,np){return np.set((_d.x-this.min.x)/(this.max.x-this.min.x),(_d.y-this.min.y)/(this.max.y-this.min.y),(_d.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_d){return!(_d.max.x<this.min.x||_d.min.x>this.max.x||_d.max.y<this.min.y||_d.min.y>this.max.y||_d.max.z<this.min.z||_d.min.z>this.max.z)}intersectsSphere(_d){return this.clampPoint(_d.center,_vector$b),_vector$b.distanceToSquared(_d.center)<=_d.radius*_d.radius}intersectsPlane(_d){let np,ap;return _d.normal.x>0?(np=_d.normal.x*this.min.x,ap=_d.normal.x*this.max.x):(np=_d.normal.x*this.max.x,ap=_d.normal.x*this.min.x),_d.normal.y>0?(np+=_d.normal.y*this.min.y,ap+=_d.normal.y*this.max.y):(np+=_d.normal.y*this.max.y,ap+=_d.normal.y*this.min.y),_d.normal.z>0?(np+=_d.normal.z*this.min.z,ap+=_d.normal.z*this.max.z):(np+=_d.normal.z*this.max.z,ap+=_d.normal.z*this.min.z),np<=-_d.constant&&ap>=-_d.constant}intersectsTriangle(_d){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(_d.a,_center),_v1$7.subVectors(_d.b,_center),_v2$4.subVectors(_d.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let np=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(np,_v0$2,_v1$7,_v2$4,_extents)||(np=[1,0,0,0,1,0,0,0,1],!satForAxes(np,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),np=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(np,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(_d,np){return np.copy(_d).clamp(this.min,this.max)}distanceToPoint(_d){return this.clampPoint(_d,_vector$b).distanceTo(_d)}getBoundingSphere(_d){return this.isEmpty()?_d.makeEmpty():(this.getCenter(_d.center),_d.radius=this.getSize(_vector$b).length()*.5),_d}intersect(_d){return this.min.max(_d.min),this.max.min(_d.max),this.isEmpty()&&this.makeEmpty(),this}union(_d){return this.min.min(_d.min),this.max.max(_d.max),this}applyMatrix4(_d){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_d),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_d),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_d),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_d),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_d),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_d),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_d),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_d),this.setFromPoints(_points),this)}translate(_d){return this.min.add(_d),this.max.add(_d),this}equals(_d){return _d.min.equals(this.min)&&_d.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(rp,_d,np,ap,sp){for(let lp=0,up=rp.length-3;lp<=up;lp+=3){_testAxis.fromArray(rp,lp);const cp=sp.x*Math.abs(_testAxis.x)+sp.y*Math.abs(_testAxis.y)+sp.z*Math.abs(_testAxis.z),dp=_d.dot(_testAxis),hp=np.dot(_testAxis),fp=ap.dot(_testAxis);if(Math.max(-Math.max(dp,hp,fp),Math.min(dp,hp,fp))>cp)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(_d=new Vector3,np=-1){this.isSphere=!0,this.center=_d,this.radius=np}set(_d,np){return this.center.copy(_d),this.radius=np,this}setFromPoints(_d,np){const ap=this.center;np!==void 0?ap.copy(np):_box$3.setFromPoints(_d).getCenter(ap);let sp=0;for(let lp=0,up=_d.length;lp<up;lp++)sp=Math.max(sp,ap.distanceToSquared(_d[lp]));return this.radius=Math.sqrt(sp),this}copy(_d){return this.center.copy(_d.center),this.radius=_d.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_d){return _d.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_d){return _d.distanceTo(this.center)-this.radius}intersectsSphere(_d){const np=this.radius+_d.radius;return _d.center.distanceToSquared(this.center)<=np*np}intersectsBox(_d){return _d.intersectsSphere(this)}intersectsPlane(_d){return Math.abs(_d.distanceToPoint(this.center))<=this.radius}clampPoint(_d,np){const ap=this.center.distanceToSquared(_d);return np.copy(_d),ap>this.radius*this.radius&&(np.sub(this.center).normalize(),np.multiplyScalar(this.radius).add(this.center)),np}getBoundingBox(_d){return this.isEmpty()?(_d.makeEmpty(),_d):(_d.set(this.center,this.center),_d.expandByScalar(this.radius),_d)}applyMatrix4(_d){return this.center.applyMatrix4(_d),this.radius=this.radius*_d.getMaxScaleOnAxis(),this}translate(_d){return this.center.add(_d),this}expandByPoint(_d){if(this.isEmpty())return this.center.copy(_d),this.radius=0,this;_v1$6.subVectors(_d,this.center);const np=_v1$6.lengthSq();if(np>this.radius*this.radius){const ap=Math.sqrt(np),sp=(ap-this.radius)*.5;this.center.addScaledVector(_v1$6,sp/ap),this.radius+=sp}return this}union(_d){return _d.isEmpty()?this:this.isEmpty()?(this.copy(_d),this):(this.center.equals(_d.center)===!0?this.radius=Math.max(this.radius,_d.radius):(_v2$3.subVectors(_d.center,this.center).setLength(_d.radius),this.expandByPoint(_v1$6.copy(_d.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(_d.center).sub(_v2$3))),this)}equals(_d){return _d.center.equals(this.center)&&_d.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(_d=new Vector3,np=new Vector3(0,0,-1)){this.origin=_d,this.direction=np}set(_d,np){return this.origin.copy(_d),this.direction.copy(np),this}copy(_d){return this.origin.copy(_d.origin),this.direction.copy(_d.direction),this}at(_d,np){return np.copy(this.origin).addScaledVector(this.direction,_d)}lookAt(_d){return this.direction.copy(_d).sub(this.origin).normalize(),this}recast(_d){return this.origin.copy(this.at(_d,_vector$a)),this}closestPointToPoint(_d,np){np.subVectors(_d,this.origin);const ap=np.dot(this.direction);return ap<0?np.copy(this.origin):np.copy(this.origin).addScaledVector(this.direction,ap)}distanceToPoint(_d){return Math.sqrt(this.distanceSqToPoint(_d))}distanceSqToPoint(_d){const np=_vector$a.subVectors(_d,this.origin).dot(this.direction);return np<0?this.origin.distanceToSquared(_d):(_vector$a.copy(this.origin).addScaledVector(this.direction,np),_vector$a.distanceToSquared(_d))}distanceSqToSegment(_d,np,ap,sp){_segCenter.copy(_d).add(np).multiplyScalar(.5),_segDir.copy(np).sub(_d).normalize(),_diff.copy(this.origin).sub(_segCenter);const lp=_d.distanceTo(np)*.5,up=-this.direction.dot(_segDir),cp=_diff.dot(this.direction),dp=-_diff.dot(_segDir),hp=_diff.lengthSq(),fp=Math.abs(1-up*up);let pp,mp,gp,yp;if(fp>0)if(pp=up*dp-cp,mp=up*cp-dp,yp=lp*fp,pp>=0)if(mp>=-yp)if(mp<=yp){const xp=1/fp;pp*=xp,mp*=xp,gp=pp*(pp+up*mp+2*cp)+mp*(up*pp+mp+2*dp)+hp}else mp=lp,pp=Math.max(0,-(up*mp+cp)),gp=-pp*pp+mp*(mp+2*dp)+hp;else mp=-lp,pp=Math.max(0,-(up*mp+cp)),gp=-pp*pp+mp*(mp+2*dp)+hp;else mp<=-yp?(pp=Math.max(0,-(-up*lp+cp)),mp=pp>0?-lp:Math.min(Math.max(-lp,-dp),lp),gp=-pp*pp+mp*(mp+2*dp)+hp):mp<=yp?(pp=0,mp=Math.min(Math.max(-lp,-dp),lp),gp=mp*(mp+2*dp)+hp):(pp=Math.max(0,-(up*lp+cp)),mp=pp>0?lp:Math.min(Math.max(-lp,-dp),lp),gp=-pp*pp+mp*(mp+2*dp)+hp);else mp=up>0?-lp:lp,pp=Math.max(0,-(up*mp+cp)),gp=-pp*pp+mp*(mp+2*dp)+hp;return ap&&ap.copy(this.origin).addScaledVector(this.direction,pp),sp&&sp.copy(_segCenter).addScaledVector(_segDir,mp),gp}intersectSphere(_d,np){_vector$a.subVectors(_d.center,this.origin);const ap=_vector$a.dot(this.direction),sp=_vector$a.dot(_vector$a)-ap*ap,lp=_d.radius*_d.radius;if(sp>lp)return null;const up=Math.sqrt(lp-sp),cp=ap-up,dp=ap+up;return dp<0?null:cp<0?this.at(dp,np):this.at(cp,np)}intersectsSphere(_d){return this.distanceSqToPoint(_d.center)<=_d.radius*_d.radius}distanceToPlane(_d){const np=_d.normal.dot(this.direction);if(np===0)return _d.distanceToPoint(this.origin)===0?0:null;const ap=-(this.origin.dot(_d.normal)+_d.constant)/np;return ap>=0?ap:null}intersectPlane(_d,np){const ap=this.distanceToPlane(_d);return ap===null?null:this.at(ap,np)}intersectsPlane(_d){const np=_d.distanceToPoint(this.origin);return np===0||_d.normal.dot(this.direction)*np<0}intersectBox(_d,np){let ap,sp,lp,up,cp,dp;const hp=1/this.direction.x,fp=1/this.direction.y,pp=1/this.direction.z,mp=this.origin;return hp>=0?(ap=(_d.min.x-mp.x)*hp,sp=(_d.max.x-mp.x)*hp):(ap=(_d.max.x-mp.x)*hp,sp=(_d.min.x-mp.x)*hp),fp>=0?(lp=(_d.min.y-mp.y)*fp,up=(_d.max.y-mp.y)*fp):(lp=(_d.max.y-mp.y)*fp,up=(_d.min.y-mp.y)*fp),ap>up||lp>sp||((lp>ap||isNaN(ap))&&(ap=lp),(up<sp||isNaN(sp))&&(sp=up),pp>=0?(cp=(_d.min.z-mp.z)*pp,dp=(_d.max.z-mp.z)*pp):(cp=(_d.max.z-mp.z)*pp,dp=(_d.min.z-mp.z)*pp),ap>dp||cp>sp)||((cp>ap||ap!==ap)&&(ap=cp),(dp<sp||sp!==sp)&&(sp=dp),sp<0)?null:this.at(ap>=0?ap:sp,np)}intersectsBox(_d){return this.intersectBox(_d,_vector$a)!==null}intersectTriangle(_d,np,ap,sp,lp){_edge1.subVectors(np,_d),_edge2.subVectors(ap,_d),_normal$1.crossVectors(_edge1,_edge2);let up=this.direction.dot(_normal$1),cp;if(up>0){if(sp)return null;cp=1}else if(up<0)cp=-1,up=-up;else return null;_diff.subVectors(this.origin,_d);const dp=cp*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(dp<0)return null;const hp=cp*this.direction.dot(_edge1.cross(_diff));if(hp<0||dp+hp>up)return null;const fp=-cp*_diff.dot(_normal$1);return fp<0?null:this.at(fp/up,lp)}applyMatrix4(_d){return this.origin.applyMatrix4(_d),this.direction.transformDirection(_d),this}equals(_d){return _d.origin.equals(this.origin)&&_d.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(_d,np,ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_d!==void 0&&this.set(_d,np,ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p)}set(_d,np,ap,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,xp,_p){const vp=this.elements;return vp[0]=_d,vp[4]=np,vp[8]=ap,vp[12]=sp,vp[1]=lp,vp[5]=up,vp[9]=cp,vp[13]=dp,vp[2]=hp,vp[6]=fp,vp[10]=pp,vp[14]=mp,vp[3]=gp,vp[7]=yp,vp[11]=xp,vp[15]=_p,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(_d){const np=this.elements,ap=_d.elements;return np[0]=ap[0],np[1]=ap[1],np[2]=ap[2],np[3]=ap[3],np[4]=ap[4],np[5]=ap[5],np[6]=ap[6],np[7]=ap[7],np[8]=ap[8],np[9]=ap[9],np[10]=ap[10],np[11]=ap[11],np[12]=ap[12],np[13]=ap[13],np[14]=ap[14],np[15]=ap[15],this}copyPosition(_d){const np=this.elements,ap=_d.elements;return np[12]=ap[12],np[13]=ap[13],np[14]=ap[14],this}setFromMatrix3(_d){const np=_d.elements;return this.set(np[0],np[3],np[6],0,np[1],np[4],np[7],0,np[2],np[5],np[8],0,0,0,0,1),this}extractBasis(_d,np,ap){return _d.setFromMatrixColumn(this,0),np.setFromMatrixColumn(this,1),ap.setFromMatrixColumn(this,2),this}makeBasis(_d,np,ap){return this.set(_d.x,np.x,ap.x,0,_d.y,np.y,ap.y,0,_d.z,np.z,ap.z,0,0,0,0,1),this}extractRotation(_d){const np=this.elements,ap=_d.elements,sp=1/_v1$5.setFromMatrixColumn(_d,0).length(),lp=1/_v1$5.setFromMatrixColumn(_d,1).length(),up=1/_v1$5.setFromMatrixColumn(_d,2).length();return np[0]=ap[0]*sp,np[1]=ap[1]*sp,np[2]=ap[2]*sp,np[3]=0,np[4]=ap[4]*lp,np[5]=ap[5]*lp,np[6]=ap[6]*lp,np[7]=0,np[8]=ap[8]*up,np[9]=ap[9]*up,np[10]=ap[10]*up,np[11]=0,np[12]=0,np[13]=0,np[14]=0,np[15]=1,this}makeRotationFromEuler(_d){const np=this.elements,ap=_d.x,sp=_d.y,lp=_d.z,up=Math.cos(ap),cp=Math.sin(ap),dp=Math.cos(sp),hp=Math.sin(sp),fp=Math.cos(lp),pp=Math.sin(lp);if(_d.order==="XYZ"){const mp=up*fp,gp=up*pp,yp=cp*fp,xp=cp*pp;np[0]=dp*fp,np[4]=-dp*pp,np[8]=hp,np[1]=gp+yp*hp,np[5]=mp-xp*hp,np[9]=-cp*dp,np[2]=xp-mp*hp,np[6]=yp+gp*hp,np[10]=up*dp}else if(_d.order==="YXZ"){const mp=dp*fp,gp=dp*pp,yp=hp*fp,xp=hp*pp;np[0]=mp+xp*cp,np[4]=yp*cp-gp,np[8]=up*hp,np[1]=up*pp,np[5]=up*fp,np[9]=-cp,np[2]=gp*cp-yp,np[6]=xp+mp*cp,np[10]=up*dp}else if(_d.order==="ZXY"){const mp=dp*fp,gp=dp*pp,yp=hp*fp,xp=hp*pp;np[0]=mp-xp*cp,np[4]=-up*pp,np[8]=yp+gp*cp,np[1]=gp+yp*cp,np[5]=up*fp,np[9]=xp-mp*cp,np[2]=-up*hp,np[6]=cp,np[10]=up*dp}else if(_d.order==="ZYX"){const mp=up*fp,gp=up*pp,yp=cp*fp,xp=cp*pp;np[0]=dp*fp,np[4]=yp*hp-gp,np[8]=mp*hp+xp,np[1]=dp*pp,np[5]=xp*hp+mp,np[9]=gp*hp-yp,np[2]=-hp,np[6]=cp*dp,np[10]=up*dp}else if(_d.order==="YZX"){const mp=up*dp,gp=up*hp,yp=cp*dp,xp=cp*hp;np[0]=dp*fp,np[4]=xp-mp*pp,np[8]=yp*pp+gp,np[1]=pp,np[5]=up*fp,np[9]=-cp*fp,np[2]=-hp*fp,np[6]=gp*pp+yp,np[10]=mp-xp*pp}else if(_d.order==="XZY"){const mp=up*dp,gp=up*hp,yp=cp*dp,xp=cp*hp;np[0]=dp*fp,np[4]=-pp,np[8]=hp*fp,np[1]=mp*pp+xp,np[5]=up*fp,np[9]=gp*pp-yp,np[2]=yp*pp-gp,np[6]=cp*fp,np[10]=xp*pp+mp}return np[3]=0,np[7]=0,np[11]=0,np[12]=0,np[13]=0,np[14]=0,np[15]=1,this}makeRotationFromQuaternion(_d){return this.compose(_zero,_d,_one)}lookAt(_d,np,ap){const sp=this.elements;return _z.subVectors(_d,np),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(ap,_z),_x.lengthSq()===0&&(Math.abs(ap.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(ap,_z)),_x.normalize(),_y.crossVectors(_z,_x),sp[0]=_x.x,sp[4]=_y.x,sp[8]=_z.x,sp[1]=_x.y,sp[5]=_y.y,sp[9]=_z.y,sp[2]=_x.z,sp[6]=_y.z,sp[10]=_z.z,this}multiply(_d){return this.multiplyMatrices(this,_d)}premultiply(_d){return this.multiplyMatrices(_d,this)}multiplyMatrices(_d,np){const ap=_d.elements,sp=np.elements,lp=this.elements,up=ap[0],cp=ap[4],dp=ap[8],hp=ap[12],fp=ap[1],pp=ap[5],mp=ap[9],gp=ap[13],yp=ap[2],xp=ap[6],_p=ap[10],vp=ap[14],bp=ap[3],Ep=ap[7],Sp=ap[11],Ap=ap[15],Rp=sp[0],Tp=sp[4],Mp=sp[8],Op=sp[12],Pp=sp[1],$p=sp[5],zp=sp[9],Dp=sp[13],Fp=sp[2],jp=sp[6],Lp=sp[10],Bp=sp[14],Ip=sp[3],kp=sp[7],Up=sp[11],Gp=sp[15];return lp[0]=up*Rp+cp*Pp+dp*Fp+hp*Ip,lp[4]=up*Tp+cp*$p+dp*jp+hp*kp,lp[8]=up*Mp+cp*zp+dp*Lp+hp*Up,lp[12]=up*Op+cp*Dp+dp*Bp+hp*Gp,lp[1]=fp*Rp+pp*Pp+mp*Fp+gp*Ip,lp[5]=fp*Tp+pp*$p+mp*jp+gp*kp,lp[9]=fp*Mp+pp*zp+mp*Lp+gp*Up,lp[13]=fp*Op+pp*Dp+mp*Bp+gp*Gp,lp[2]=yp*Rp+xp*Pp+_p*Fp+vp*Ip,lp[6]=yp*Tp+xp*$p+_p*jp+vp*kp,lp[10]=yp*Mp+xp*zp+_p*Lp+vp*Up,lp[14]=yp*Op+xp*Dp+_p*Bp+vp*Gp,lp[3]=bp*Rp+Ep*Pp+Sp*Fp+Ap*Ip,lp[7]=bp*Tp+Ep*$p+Sp*jp+Ap*kp,lp[11]=bp*Mp+Ep*zp+Sp*Lp+Ap*Up,lp[15]=bp*Op+Ep*Dp+Sp*Bp+Ap*Gp,this}multiplyScalar(_d){const np=this.elements;return np[0]*=_d,np[4]*=_d,np[8]*=_d,np[12]*=_d,np[1]*=_d,np[5]*=_d,np[9]*=_d,np[13]*=_d,np[2]*=_d,np[6]*=_d,np[10]*=_d,np[14]*=_d,np[3]*=_d,np[7]*=_d,np[11]*=_d,np[15]*=_d,this}determinant(){const _d=this.elements,np=_d[0],ap=_d[4],sp=_d[8],lp=_d[12],up=_d[1],cp=_d[5],dp=_d[9],hp=_d[13],fp=_d[2],pp=_d[6],mp=_d[10],gp=_d[14],yp=_d[3],xp=_d[7],_p=_d[11],vp=_d[15];return yp*(+lp*dp*pp-sp*hp*pp-lp*cp*mp+ap*hp*mp+sp*cp*gp-ap*dp*gp)+xp*(+np*dp*gp-np*hp*mp+lp*up*mp-sp*up*gp+sp*hp*fp-lp*dp*fp)+_p*(+np*hp*pp-np*cp*gp-lp*up*pp+ap*up*gp+lp*cp*fp-ap*hp*fp)+vp*(-sp*cp*fp-np*dp*pp+np*cp*mp+sp*up*pp-ap*up*mp+ap*dp*fp)}transpose(){const _d=this.elements;let np;return np=_d[1],_d[1]=_d[4],_d[4]=np,np=_d[2],_d[2]=_d[8],_d[8]=np,np=_d[6],_d[6]=_d[9],_d[9]=np,np=_d[3],_d[3]=_d[12],_d[12]=np,np=_d[7],_d[7]=_d[13],_d[13]=np,np=_d[11],_d[11]=_d[14],_d[14]=np,this}setPosition(_d,np,ap){const sp=this.elements;return _d.isVector3?(sp[12]=_d.x,sp[13]=_d.y,sp[14]=_d.z):(sp[12]=_d,sp[13]=np,sp[14]=ap),this}invert(){const _d=this.elements,np=_d[0],ap=_d[1],sp=_d[2],lp=_d[3],up=_d[4],cp=_d[5],dp=_d[6],hp=_d[7],fp=_d[8],pp=_d[9],mp=_d[10],gp=_d[11],yp=_d[12],xp=_d[13],_p=_d[14],vp=_d[15],bp=pp*_p*hp-xp*mp*hp+xp*dp*gp-cp*_p*gp-pp*dp*vp+cp*mp*vp,Ep=yp*mp*hp-fp*_p*hp-yp*dp*gp+up*_p*gp+fp*dp*vp-up*mp*vp,Sp=fp*xp*hp-yp*pp*hp+yp*cp*gp-up*xp*gp-fp*cp*vp+up*pp*vp,Ap=yp*pp*dp-fp*xp*dp-yp*cp*mp+up*xp*mp+fp*cp*_p-up*pp*_p,Rp=np*bp+ap*Ep+sp*Sp+lp*Ap;if(Rp===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Tp=1/Rp;return _d[0]=bp*Tp,_d[1]=(xp*mp*lp-pp*_p*lp-xp*sp*gp+ap*_p*gp+pp*sp*vp-ap*mp*vp)*Tp,_d[2]=(cp*_p*lp-xp*dp*lp+xp*sp*hp-ap*_p*hp-cp*sp*vp+ap*dp*vp)*Tp,_d[3]=(pp*dp*lp-cp*mp*lp-pp*sp*hp+ap*mp*hp+cp*sp*gp-ap*dp*gp)*Tp,_d[4]=Ep*Tp,_d[5]=(fp*_p*lp-yp*mp*lp+yp*sp*gp-np*_p*gp-fp*sp*vp+np*mp*vp)*Tp,_d[6]=(yp*dp*lp-up*_p*lp-yp*sp*hp+np*_p*hp+up*sp*vp-np*dp*vp)*Tp,_d[7]=(up*mp*lp-fp*dp*lp+fp*sp*hp-np*mp*hp-up*sp*gp+np*dp*gp)*Tp,_d[8]=Sp*Tp,_d[9]=(yp*pp*lp-fp*xp*lp-yp*ap*gp+np*xp*gp+fp*ap*vp-np*pp*vp)*Tp,_d[10]=(up*xp*lp-yp*cp*lp+yp*ap*hp-np*xp*hp-up*ap*vp+np*cp*vp)*Tp,_d[11]=(fp*cp*lp-up*pp*lp-fp*ap*hp+np*pp*hp+up*ap*gp-np*cp*gp)*Tp,_d[12]=Ap*Tp,_d[13]=(fp*xp*sp-yp*pp*sp+yp*ap*mp-np*xp*mp-fp*ap*_p+np*pp*_p)*Tp,_d[14]=(yp*cp*sp-up*xp*sp-yp*ap*dp+np*xp*dp+up*ap*_p-np*cp*_p)*Tp,_d[15]=(up*pp*sp-fp*cp*sp+fp*ap*dp-np*pp*dp-up*ap*mp+np*cp*mp)*Tp,this}scale(_d){const np=this.elements,ap=_d.x,sp=_d.y,lp=_d.z;return np[0]*=ap,np[4]*=sp,np[8]*=lp,np[1]*=ap,np[5]*=sp,np[9]*=lp,np[2]*=ap,np[6]*=sp,np[10]*=lp,np[3]*=ap,np[7]*=sp,np[11]*=lp,this}getMaxScaleOnAxis(){const _d=this.elements,np=_d[0]*_d[0]+_d[1]*_d[1]+_d[2]*_d[2],ap=_d[4]*_d[4]+_d[5]*_d[5]+_d[6]*_d[6],sp=_d[8]*_d[8]+_d[9]*_d[9]+_d[10]*_d[10];return Math.sqrt(Math.max(np,ap,sp))}makeTranslation(_d,np,ap){return _d.isVector3?this.set(1,0,0,_d.x,0,1,0,_d.y,0,0,1,_d.z,0,0,0,1):this.set(1,0,0,_d,0,1,0,np,0,0,1,ap,0,0,0,1),this}makeRotationX(_d){const np=Math.cos(_d),ap=Math.sin(_d);return this.set(1,0,0,0,0,np,-ap,0,0,ap,np,0,0,0,0,1),this}makeRotationY(_d){const np=Math.cos(_d),ap=Math.sin(_d);return this.set(np,0,ap,0,0,1,0,0,-ap,0,np,0,0,0,0,1),this}makeRotationZ(_d){const np=Math.cos(_d),ap=Math.sin(_d);return this.set(np,-ap,0,0,ap,np,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_d,np){const ap=Math.cos(np),sp=Math.sin(np),lp=1-ap,up=_d.x,cp=_d.y,dp=_d.z,hp=lp*up,fp=lp*cp;return this.set(hp*up+ap,hp*cp-sp*dp,hp*dp+sp*cp,0,hp*cp+sp*dp,fp*cp+ap,fp*dp-sp*up,0,hp*dp-sp*cp,fp*dp+sp*up,lp*dp*dp+ap,0,0,0,0,1),this}makeScale(_d,np,ap){return this.set(_d,0,0,0,0,np,0,0,0,0,ap,0,0,0,0,1),this}makeShear(_d,np,ap,sp,lp,up){return this.set(1,ap,lp,0,_d,1,up,0,np,sp,1,0,0,0,0,1),this}compose(_d,np,ap){const sp=this.elements,lp=np._x,up=np._y,cp=np._z,dp=np._w,hp=lp+lp,fp=up+up,pp=cp+cp,mp=lp*hp,gp=lp*fp,yp=lp*pp,xp=up*fp,_p=up*pp,vp=cp*pp,bp=dp*hp,Ep=dp*fp,Sp=dp*pp,Ap=ap.x,Rp=ap.y,Tp=ap.z;return sp[0]=(1-(xp+vp))*Ap,sp[1]=(gp+Sp)*Ap,sp[2]=(yp-Ep)*Ap,sp[3]=0,sp[4]=(gp-Sp)*Rp,sp[5]=(1-(mp+vp))*Rp,sp[6]=(_p+bp)*Rp,sp[7]=0,sp[8]=(yp+Ep)*Tp,sp[9]=(_p-bp)*Tp,sp[10]=(1-(mp+xp))*Tp,sp[11]=0,sp[12]=_d.x,sp[13]=_d.y,sp[14]=_d.z,sp[15]=1,this}decompose(_d,np,ap){const sp=this.elements;let lp=_v1$5.set(sp[0],sp[1],sp[2]).length();const up=_v1$5.set(sp[4],sp[5],sp[6]).length(),cp=_v1$5.set(sp[8],sp[9],sp[10]).length();this.determinant()<0&&(lp=-lp),_d.x=sp[12],_d.y=sp[13],_d.z=sp[14],_m1$2.copy(this);const hp=1/lp,fp=1/up,pp=1/cp;return _m1$2.elements[0]*=hp,_m1$2.elements[1]*=hp,_m1$2.elements[2]*=hp,_m1$2.elements[4]*=fp,_m1$2.elements[5]*=fp,_m1$2.elements[6]*=fp,_m1$2.elements[8]*=pp,_m1$2.elements[9]*=pp,_m1$2.elements[10]*=pp,np.setFromRotationMatrix(_m1$2),ap.x=lp,ap.y=up,ap.z=cp,this}makePerspective(_d,np,ap,sp,lp,up,cp=WebGLCoordinateSystem){const dp=this.elements,hp=2*lp/(np-_d),fp=2*lp/(ap-sp),pp=(np+_d)/(np-_d),mp=(ap+sp)/(ap-sp);let gp,yp;if(cp===WebGLCoordinateSystem)gp=-(up+lp)/(up-lp),yp=-2*up*lp/(up-lp);else if(cp===WebGPUCoordinateSystem)gp=-up/(up-lp),yp=-up*lp/(up-lp);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+cp);return dp[0]=hp,dp[4]=0,dp[8]=pp,dp[12]=0,dp[1]=0,dp[5]=fp,dp[9]=mp,dp[13]=0,dp[2]=0,dp[6]=0,dp[10]=gp,dp[14]=yp,dp[3]=0,dp[7]=0,dp[11]=-1,dp[15]=0,this}makeOrthographic(_d,np,ap,sp,lp,up,cp=WebGLCoordinateSystem){const dp=this.elements,hp=1/(np-_d),fp=1/(ap-sp),pp=1/(up-lp),mp=(np+_d)*hp,gp=(ap+sp)*fp;let yp,xp;if(cp===WebGLCoordinateSystem)yp=(up+lp)*pp,xp=-2*pp;else if(cp===WebGPUCoordinateSystem)yp=lp*pp,xp=-1*pp;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+cp);return dp[0]=2*hp,dp[4]=0,dp[8]=0,dp[12]=-mp,dp[1]=0,dp[5]=2*fp,dp[9]=0,dp[13]=-gp,dp[2]=0,dp[6]=0,dp[10]=xp,dp[14]=-yp,dp[3]=0,dp[7]=0,dp[11]=0,dp[15]=1,this}equals(_d){const np=this.elements,ap=_d.elements;for(let sp=0;sp<16;sp++)if(np[sp]!==ap[sp])return!1;return!0}fromArray(_d,np=0){for(let ap=0;ap<16;ap++)this.elements[ap]=_d[ap+np];return this}toArray(_d=[],np=0){const ap=this.elements;return _d[np]=ap[0],_d[np+1]=ap[1],_d[np+2]=ap[2],_d[np+3]=ap[3],_d[np+4]=ap[4],_d[np+5]=ap[5],_d[np+6]=ap[6],_d[np+7]=ap[7],_d[np+8]=ap[8],_d[np+9]=ap[9],_d[np+10]=ap[10],_d[np+11]=ap[11],_d[np+12]=ap[12],_d[np+13]=ap[13],_d[np+14]=ap[14],_d[np+15]=ap[15],_d}}const _v1$5=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$1=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(_d=0,np=0,ap=0,sp=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=_d,this._y=np,this._z=ap,this._order=sp}get x(){return this._x}set x(_d){this._x=_d,this._onChangeCallback()}get y(){return this._y}set y(_d){this._y=_d,this._onChangeCallback()}get z(){return this._z}set z(_d){this._z=_d,this._onChangeCallback()}get order(){return this._order}set order(_d){this._order=_d,this._onChangeCallback()}set(_d,np,ap,sp=this._order){return this._x=_d,this._y=np,this._z=ap,this._order=sp,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_d){return this._x=_d._x,this._y=_d._y,this._z=_d._z,this._order=_d._order,this._onChangeCallback(),this}setFromRotationMatrix(_d,np=this._order,ap=!0){const sp=_d.elements,lp=sp[0],up=sp[4],cp=sp[8],dp=sp[1],hp=sp[5],fp=sp[9],pp=sp[2],mp=sp[6],gp=sp[10];switch(np){case"XYZ":this._y=Math.asin(clamp(cp,-1,1)),Math.abs(cp)<.9999999?(this._x=Math.atan2(-fp,gp),this._z=Math.atan2(-up,lp)):(this._x=Math.atan2(mp,hp),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp(fp,-1,1)),Math.abs(fp)<.9999999?(this._y=Math.atan2(cp,gp),this._z=Math.atan2(dp,hp)):(this._y=Math.atan2(-pp,lp),this._z=0);break;case"ZXY":this._x=Math.asin(clamp(mp,-1,1)),Math.abs(mp)<.9999999?(this._y=Math.atan2(-pp,gp),this._z=Math.atan2(-up,hp)):(this._y=0,this._z=Math.atan2(dp,lp));break;case"ZYX":this._y=Math.asin(-clamp(pp,-1,1)),Math.abs(pp)<.9999999?(this._x=Math.atan2(mp,gp),this._z=Math.atan2(dp,lp)):(this._x=0,this._z=Math.atan2(-up,hp));break;case"YZX":this._z=Math.asin(clamp(dp,-1,1)),Math.abs(dp)<.9999999?(this._x=Math.atan2(-fp,hp),this._y=Math.atan2(-pp,lp)):(this._x=0,this._y=Math.atan2(cp,gp));break;case"XZY":this._z=Math.asin(-clamp(up,-1,1)),Math.abs(up)<.9999999?(this._x=Math.atan2(mp,hp),this._y=Math.atan2(cp,lp)):(this._x=Math.atan2(-fp,gp),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+np)}return this._order=np,ap===!0&&this._onChangeCallback(),this}setFromQuaternion(_d,np,ap){return _matrix$1.makeRotationFromQuaternion(_d),this.setFromRotationMatrix(_matrix$1,np,ap)}setFromVector3(_d,np=this._order){return this.set(_d.x,_d.y,_d.z,np)}reorder(_d){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,_d)}equals(_d){return _d._x===this._x&&_d._y===this._y&&_d._z===this._z&&_d._order===this._order}fromArray(_d){return this._x=_d[0],this._y=_d[1],this._z=_d[2],_d[3]!==void 0&&(this._order=_d[3]),this._onChangeCallback(),this}toArray(_d=[],np=0){return _d[np]=this._x,_d[np+1]=this._y,_d[np+2]=this._z,_d[np+3]=this._order,_d}_onChange(_d){return this._onChangeCallback=_d,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(_d){this.mask=(1<<_d|0)>>>0}enable(_d){this.mask|=1<<_d|0}enableAll(){this.mask=-1}toggle(_d){this.mask^=1<<_d|0}disable(_d){this.mask&=~(1<<_d|0)}disableAll(){this.mask=0}test(_d){return(this.mask&_d.mask)!==0}isEnabled(_d){return(this.mask&(1<<_d|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const _d=new Vector3,np=new Euler,ap=new Quaternion,sp=new Vector3(1,1,1);function lp(){ap.setFromEuler(np,!1)}function up(){np.setFromQuaternion(ap,void 0,!1)}np._onChange(lp),ap._onChange(up),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_d},rotation:{configurable:!0,enumerable:!0,value:np},quaternion:{configurable:!0,enumerable:!0,value:ap},scale:{configurable:!0,enumerable:!0,value:sp},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(_d){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_d),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_d){return this.quaternion.premultiply(_d),this}setRotationFromAxisAngle(_d,np){this.quaternion.setFromAxisAngle(_d,np)}setRotationFromEuler(_d){this.quaternion.setFromEuler(_d,!0)}setRotationFromMatrix(_d){this.quaternion.setFromRotationMatrix(_d)}setRotationFromQuaternion(_d){this.quaternion.copy(_d)}rotateOnAxis(_d,np){return _q1.setFromAxisAngle(_d,np),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(_d,np){return _q1.setFromAxisAngle(_d,np),this.quaternion.premultiply(_q1),this}rotateX(_d){return this.rotateOnAxis(_xAxis,_d)}rotateY(_d){return this.rotateOnAxis(_yAxis,_d)}rotateZ(_d){return this.rotateOnAxis(_zAxis,_d)}translateOnAxis(_d,np){return _v1$4.copy(_d).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(np)),this}translateX(_d){return this.translateOnAxis(_xAxis,_d)}translateY(_d){return this.translateOnAxis(_yAxis,_d)}translateZ(_d){return this.translateOnAxis(_zAxis,_d)}localToWorld(_d){return this.updateWorldMatrix(!0,!1),_d.applyMatrix4(this.matrixWorld)}worldToLocal(_d){return this.updateWorldMatrix(!0,!1),_d.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())}lookAt(_d,np,ap){_d.isVector3?_target.copy(_d):_target.set(_d,np,ap);const sp=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position$3,_target,this.up):_m1$1.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1),sp&&(_m1$1.extractRotation(sp.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.invert()))}add(_d){if(arguments.length>1){for(let np=0;np<arguments.length;np++)this.add(arguments[np]);return this}return _d===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_d),this):(_d&&_d.isObject3D?(_d.parent!==null&&_d.parent.remove(_d),_d.parent=this,this.children.push(_d),_d.dispatchEvent(_addedEvent)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_d),this)}remove(_d){if(arguments.length>1){for(let ap=0;ap<arguments.length;ap++)this.remove(arguments[ap]);return this}const np=this.children.indexOf(_d);return np!==-1&&(_d.parent=null,this.children.splice(np,1),_d.dispatchEvent(_removedEvent)),this}removeFromParent(){const _d=this.parent;return _d!==null&&_d.remove(this),this}clear(){return this.remove(...this.children)}attach(_d){return this.updateWorldMatrix(!0,!1),_m1$1.copy(this.matrixWorld).invert(),_d.parent!==null&&(_d.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(_d.parent.matrixWorld)),_d.applyMatrix4(_m1$1),this.add(_d),_d.updateWorldMatrix(!1,!0),this}getObjectById(_d){return this.getObjectByProperty("id",_d)}getObjectByName(_d){return this.getObjectByProperty("name",_d)}getObjectByProperty(_d,np){if(this[_d]===np)return this;for(let ap=0,sp=this.children.length;ap<sp;ap++){const up=this.children[ap].getObjectByProperty(_d,np);if(up!==void 0)return up}}getObjectsByProperty(_d,np,ap=[]){this[_d]===np&&ap.push(this);const sp=this.children;for(let lp=0,up=sp.length;lp<up;lp++)sp[lp].getObjectsByProperty(_d,np,ap);return ap}getWorldPosition(_d){return this.updateWorldMatrix(!0,!1),_d.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_d){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_d,_scale$2),_d}getWorldScale(_d){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,_d),_d}getWorldDirection(_d){this.updateWorldMatrix(!0,!1);const np=this.matrixWorld.elements;return _d.set(np[8],np[9],np[10]).normalize()}raycast(){}traverse(_d){_d(this);const np=this.children;for(let ap=0,sp=np.length;ap<sp;ap++)np[ap].traverse(_d)}traverseVisible(_d){if(this.visible===!1)return;_d(this);const np=this.children;for(let ap=0,sp=np.length;ap<sp;ap++)np[ap].traverseVisible(_d)}traverseAncestors(_d){const np=this.parent;np!==null&&(_d(np),np.traverseAncestors(_d))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_d){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_d)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,_d=!0);const np=this.children;for(let ap=0,sp=np.length;ap<sp;ap++){const lp=np[ap];(lp.matrixWorldAutoUpdate===!0||_d===!0)&&lp.updateMatrixWorld(_d)}}updateWorldMatrix(_d,np){const ap=this.parent;if(_d===!0&&ap!==null&&ap.matrixWorldAutoUpdate===!0&&ap.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),np===!0){const sp=this.children;for(let lp=0,up=sp.length;lp<up;lp++){const cp=sp[lp];cp.matrixWorldAutoUpdate===!0&&cp.updateWorldMatrix(!1,!0)}}}toJSON(_d){const np=_d===void 0||typeof _d=="string",ap={};np&&(_d={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},ap.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const sp={};sp.uuid=this.uuid,sp.type=this.type,this.name!==""&&(sp.name=this.name),this.castShadow===!0&&(sp.castShadow=!0),this.receiveShadow===!0&&(sp.receiveShadow=!0),this.visible===!1&&(sp.visible=!1),this.frustumCulled===!1&&(sp.frustumCulled=!1),this.renderOrder!==0&&(sp.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(sp.userData=this.userData),sp.layers=this.layers.mask,sp.matrix=this.matrix.toArray(),sp.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(sp.matrixAutoUpdate=!1),this.isInstancedMesh&&(sp.type="InstancedMesh",sp.count=this.count,sp.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(sp.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(sp.type="BatchedMesh",sp.perObjectFrustumCulled=this.perObjectFrustumCulled,sp.sortObjects=this.sortObjects,sp.drawRanges=this._drawRanges,sp.reservedRanges=this._reservedRanges,sp.visibility=this._visibility,sp.active=this._active,sp.bounds=this._bounds.map(cp=>({boxInitialized:cp.boxInitialized,boxMin:cp.box.min.toArray(),boxMax:cp.box.max.toArray(),sphereInitialized:cp.sphereInitialized,sphereRadius:cp.sphere.radius,sphereCenter:cp.sphere.center.toArray()})),sp.maxGeometryCount=this._maxGeometryCount,sp.maxVertexCount=this._maxVertexCount,sp.maxIndexCount=this._maxIndexCount,sp.geometryInitialized=this._geometryInitialized,sp.geometryCount=this._geometryCount,sp.matricesTexture=this._matricesTexture.toJSON(_d),this.boundingSphere!==null&&(sp.boundingSphere={center:sp.boundingSphere.center.toArray(),radius:sp.boundingSphere.radius}),this.boundingBox!==null&&(sp.boundingBox={min:sp.boundingBox.min.toArray(),max:sp.boundingBox.max.toArray()}));function lp(cp,dp){return cp[dp.uuid]===void 0&&(cp[dp.uuid]=dp.toJSON(_d)),dp.uuid}if(this.isScene)this.background&&(this.background.isColor?sp.background=this.background.toJSON():this.background.isTexture&&(sp.background=this.background.toJSON(_d).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(sp.environment=this.environment.toJSON(_d).uuid);else if(this.isMesh||this.isLine||this.isPoints){sp.geometry=lp(_d.geometries,this.geometry);const cp=this.geometry.parameters;if(cp!==void 0&&cp.shapes!==void 0){const dp=cp.shapes;if(Array.isArray(dp))for(let hp=0,fp=dp.length;hp<fp;hp++){const pp=dp[hp];lp(_d.shapes,pp)}else lp(_d.shapes,dp)}}if(this.isSkinnedMesh&&(sp.bindMode=this.bindMode,sp.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(lp(_d.skeletons,this.skeleton),sp.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const cp=[];for(let dp=0,hp=this.material.length;dp<hp;dp++)cp.push(lp(_d.materials,this.material[dp]));sp.material=cp}else sp.material=lp(_d.materials,this.material);if(this.children.length>0){sp.children=[];for(let cp=0;cp<this.children.length;cp++)sp.children.push(this.children[cp].toJSON(_d).object)}if(this.animations.length>0){sp.animations=[];for(let cp=0;cp<this.animations.length;cp++){const dp=this.animations[cp];sp.animations.push(lp(_d.animations,dp))}}if(np){const cp=up(_d.geometries),dp=up(_d.materials),hp=up(_d.textures),fp=up(_d.images),pp=up(_d.shapes),mp=up(_d.skeletons),gp=up(_d.animations),yp=up(_d.nodes);cp.length>0&&(ap.geometries=cp),dp.length>0&&(ap.materials=dp),hp.length>0&&(ap.textures=hp),fp.length>0&&(ap.images=fp),pp.length>0&&(ap.shapes=pp),mp.length>0&&(ap.skeletons=mp),gp.length>0&&(ap.animations=gp),yp.length>0&&(ap.nodes=yp)}return ap.object=sp,ap;function up(cp){const dp=[];for(const hp in cp){const fp=cp[hp];delete fp.metadata,dp.push(fp)}return dp}}clone(_d){return new this.constructor().copy(this,_d)}copy(_d,np=!0){if(this.name=_d.name,this.up.copy(_d.up),this.position.copy(_d.position),this.rotation.order=_d.rotation.order,this.quaternion.copy(_d.quaternion),this.scale.copy(_d.scale),this.matrix.copy(_d.matrix),this.matrixWorld.copy(_d.matrixWorld),this.matrixAutoUpdate=_d.matrixAutoUpdate,this.matrixWorldAutoUpdate=_d.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=_d.matrixWorldNeedsUpdate,this.layers.mask=_d.layers.mask,this.visible=_d.visible,this.castShadow=_d.castShadow,this.receiveShadow=_d.receiveShadow,this.frustumCulled=_d.frustumCulled,this.renderOrder=_d.renderOrder,this.animations=_d.animations.slice(),this.userData=JSON.parse(JSON.stringify(_d.userData)),np===!0)for(let ap=0;ap<_d.children.length;ap++){const sp=_d.children[ap];this.add(sp.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$2=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;class Triangle{constructor(_d=new Vector3,np=new Vector3,ap=new Vector3){this.a=_d,this.b=np,this.c=ap}static getNormal(_d,np,ap,sp){sp.subVectors(ap,np),_v0$1.subVectors(_d,np),sp.cross(_v0$1);const lp=sp.lengthSq();return lp>0?sp.multiplyScalar(1/Math.sqrt(lp)):sp.set(0,0,0)}static getBarycoord(_d,np,ap,sp,lp){_v0$1.subVectors(sp,np),_v1$3.subVectors(ap,np),_v2$2.subVectors(_d,np);const up=_v0$1.dot(_v0$1),cp=_v0$1.dot(_v1$3),dp=_v0$1.dot(_v2$2),hp=_v1$3.dot(_v1$3),fp=_v1$3.dot(_v2$2),pp=up*hp-cp*cp;if(pp===0)return lp.set(0,0,0),null;const mp=1/pp,gp=(hp*dp-cp*fp)*mp,yp=(up*fp-cp*dp)*mp;return lp.set(1-gp-yp,yp,gp)}static containsPoint(_d,np,ap,sp){return this.getBarycoord(_d,np,ap,sp,_v3$2)===null?!1:_v3$2.x>=0&&_v3$2.y>=0&&_v3$2.x+_v3$2.y<=1}static getInterpolation(_d,np,ap,sp,lp,up,cp,dp){return this.getBarycoord(_d,np,ap,sp,_v3$2)===null?(dp.x=0,dp.y=0,"z"in dp&&(dp.z=0),"w"in dp&&(dp.w=0),null):(dp.setScalar(0),dp.addScaledVector(lp,_v3$2.x),dp.addScaledVector(up,_v3$2.y),dp.addScaledVector(cp,_v3$2.z),dp)}static isFrontFacing(_d,np,ap,sp){return _v0$1.subVectors(ap,np),_v1$3.subVectors(_d,np),_v0$1.cross(_v1$3).dot(sp)<0}set(_d,np,ap){return this.a.copy(_d),this.b.copy(np),this.c.copy(ap),this}setFromPointsAndIndices(_d,np,ap,sp){return this.a.copy(_d[np]),this.b.copy(_d[ap]),this.c.copy(_d[sp]),this}setFromAttributeAndIndices(_d,np,ap,sp){return this.a.fromBufferAttribute(_d,np),this.b.fromBufferAttribute(_d,ap),this.c.fromBufferAttribute(_d,sp),this}clone(){return new this.constructor().copy(this)}copy(_d){return this.a.copy(_d.a),this.b.copy(_d.b),this.c.copy(_d.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(_d){return _d.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_d){return Triangle.getNormal(this.a,this.b,this.c,_d)}getPlane(_d){return _d.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_d,np){return Triangle.getBarycoord(_d,this.a,this.b,this.c,np)}getInterpolation(_d,np,ap,sp,lp){return Triangle.getInterpolation(_d,this.a,this.b,this.c,np,ap,sp,lp)}containsPoint(_d){return Triangle.containsPoint(_d,this.a,this.b,this.c)}isFrontFacing(_d){return Triangle.isFrontFacing(this.a,this.b,this.c,_d)}intersectsBox(_d){return _d.intersectsTriangle(this)}closestPointToPoint(_d,np){const ap=this.a,sp=this.b,lp=this.c;let up,cp;_vab.subVectors(sp,ap),_vac.subVectors(lp,ap),_vap.subVectors(_d,ap);const dp=_vab.dot(_vap),hp=_vac.dot(_vap);if(dp<=0&&hp<=0)return np.copy(ap);_vbp.subVectors(_d,sp);const fp=_vab.dot(_vbp),pp=_vac.dot(_vbp);if(fp>=0&&pp<=fp)return np.copy(sp);const mp=dp*pp-fp*hp;if(mp<=0&&dp>=0&&fp<=0)return up=dp/(dp-fp),np.copy(ap).addScaledVector(_vab,up);_vcp.subVectors(_d,lp);const gp=_vab.dot(_vcp),yp=_vac.dot(_vcp);if(yp>=0&&gp<=yp)return np.copy(lp);const xp=gp*hp-dp*yp;if(xp<=0&&hp>=0&&yp<=0)return cp=hp/(hp-yp),np.copy(ap).addScaledVector(_vac,cp);const _p=fp*yp-gp*pp;if(_p<=0&&pp-fp>=0&&gp-yp>=0)return _vbc.subVectors(lp,sp),cp=(pp-fp)/(pp-fp+(gp-yp)),np.copy(sp).addScaledVector(_vbc,cp);const vp=1/(_p+xp+mp);return up=xp*vp,cp=mp*vp,np.copy(ap).addScaledVector(_vab,up).addScaledVector(_vac,cp)}equals(_d){return _d.a.equals(this.a)&&_d.b.equals(this.b)&&_d.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(rp,_d,np){return np<0&&(np+=1),np>1&&(np-=1),np<1/6?rp+(_d-rp)*6*np:np<1/2?_d:np<2/3?rp+(_d-rp)*6*(2/3-np):rp}class Color{constructor(_d,np,ap){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_d,np,ap)}set(_d,np,ap){if(np===void 0&&ap===void 0){const sp=_d;sp&&sp.isColor?this.copy(sp):typeof sp=="number"?this.setHex(sp):typeof sp=="string"&&this.setStyle(sp)}else this.setRGB(_d,np,ap);return this}setScalar(_d){return this.r=_d,this.g=_d,this.b=_d,this}setHex(_d,np=SRGBColorSpace$1){return _d=Math.floor(_d),this.r=(_d>>16&255)/255,this.g=(_d>>8&255)/255,this.b=(_d&255)/255,ColorManagement.toWorkingColorSpace(this,np),this}setRGB(_d,np,ap,sp=ColorManagement.workingColorSpace){return this.r=_d,this.g=np,this.b=ap,ColorManagement.toWorkingColorSpace(this,sp),this}setHSL(_d,np,ap,sp=ColorManagement.workingColorSpace){if(_d=euclideanModulo(_d,1),np=clamp(np,0,1),ap=clamp(ap,0,1),np===0)this.r=this.g=this.b=ap;else{const lp=ap<=.5?ap*(1+np):ap+np-ap*np,up=2*ap-lp;this.r=hue2rgb(up,lp,_d+1/3),this.g=hue2rgb(up,lp,_d),this.b=hue2rgb(up,lp,_d-1/3)}return ColorManagement.toWorkingColorSpace(this,sp),this}setStyle(_d,np=SRGBColorSpace$1){function ap(lp){lp!==void 0&&parseFloat(lp)<1&&console.warn("THREE.Color: Alpha component of "+_d+" will be ignored.")}let sp;if(sp=/^(\w+)\(([^\)]*)\)/.exec(_d)){let lp;const up=sp[1],cp=sp[2];switch(up){case"rgb":case"rgba":if(lp=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(cp))return ap(lp[4]),this.setRGB(Math.min(255,parseInt(lp[1],10))/255,Math.min(255,parseInt(lp[2],10))/255,Math.min(255,parseInt(lp[3],10))/255,np);if(lp=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(cp))return ap(lp[4]),this.setRGB(Math.min(100,parseInt(lp[1],10))/100,Math.min(100,parseInt(lp[2],10))/100,Math.min(100,parseInt(lp[3],10))/100,np);break;case"hsl":case"hsla":if(lp=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(cp))return ap(lp[4]),this.setHSL(parseFloat(lp[1])/360,parseFloat(lp[2])/100,parseFloat(lp[3])/100,np);break;default:console.warn("THREE.Color: Unknown color model "+_d)}}else if(sp=/^\#([A-Fa-f\d]+)$/.exec(_d)){const lp=sp[1],up=lp.length;if(up===3)return this.setRGB(parseInt(lp.charAt(0),16)/15,parseInt(lp.charAt(1),16)/15,parseInt(lp.charAt(2),16)/15,np);if(up===6)return this.setHex(parseInt(lp,16),np);console.warn("THREE.Color: Invalid hex color "+_d)}else if(_d&&_d.length>0)return this.setColorName(_d,np);return this}setColorName(_d,np=SRGBColorSpace$1){const ap=_colorKeywords[_d.toLowerCase()];return ap!==void 0?this.setHex(ap,np):console.warn("THREE.Color: Unknown color "+_d),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_d){return this.r=_d.r,this.g=_d.g,this.b=_d.b,this}copySRGBToLinear(_d){return this.r=SRGBToLinear(_d.r),this.g=SRGBToLinear(_d.g),this.b=SRGBToLinear(_d.b),this}copyLinearToSRGB(_d){return this.r=LinearToSRGB(_d.r),this.g=LinearToSRGB(_d.g),this.b=LinearToSRGB(_d.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_d=SRGBColorSpace$1){return ColorManagement.fromWorkingColorSpace(_color.copy(this),_d),Math.round(clamp(_color.r*255,0,255))*65536+Math.round(clamp(_color.g*255,0,255))*256+Math.round(clamp(_color.b*255,0,255))}getHexString(_d=SRGBColorSpace$1){return("000000"+this.getHex(_d).toString(16)).slice(-6)}getHSL(_d,np=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),np);const ap=_color.r,sp=_color.g,lp=_color.b,up=Math.max(ap,sp,lp),cp=Math.min(ap,sp,lp);let dp,hp;const fp=(cp+up)/2;if(cp===up)dp=0,hp=0;else{const pp=up-cp;switch(hp=fp<=.5?pp/(up+cp):pp/(2-up-cp),up){case ap:dp=(sp-lp)/pp+(sp<lp?6:0);break;case sp:dp=(lp-ap)/pp+2;break;case lp:dp=(ap-sp)/pp+4;break}dp/=6}return _d.h=dp,_d.s=hp,_d.l=fp,_d}getRGB(_d,np=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),np),_d.r=_color.r,_d.g=_color.g,_d.b=_color.b,_d}getStyle(_d=SRGBColorSpace$1){ColorManagement.fromWorkingColorSpace(_color.copy(this),_d);const np=_color.r,ap=_color.g,sp=_color.b;return _d!==SRGBColorSpace$1?`color(${_d} ${np.toFixed(3)} ${ap.toFixed(3)} ${sp.toFixed(3)})`:`rgb(${Math.round(np*255)},${Math.round(ap*255)},${Math.round(sp*255)})`}offsetHSL(_d,np,ap){return this.getHSL(_hslA),this.setHSL(_hslA.h+_d,_hslA.s+np,_hslA.l+ap)}add(_d){return this.r+=_d.r,this.g+=_d.g,this.b+=_d.b,this}addColors(_d,np){return this.r=_d.r+np.r,this.g=_d.g+np.g,this.b=_d.b+np.b,this}addScalar(_d){return this.r+=_d,this.g+=_d,this.b+=_d,this}sub(_d){return this.r=Math.max(0,this.r-_d.r),this.g=Math.max(0,this.g-_d.g),this.b=Math.max(0,this.b-_d.b),this}multiply(_d){return this.r*=_d.r,this.g*=_d.g,this.b*=_d.b,this}multiplyScalar(_d){return this.r*=_d,this.g*=_d,this.b*=_d,this}lerp(_d,np){return this.r+=(_d.r-this.r)*np,this.g+=(_d.g-this.g)*np,this.b+=(_d.b-this.b)*np,this}lerpColors(_d,np,ap){return this.r=_d.r+(np.r-_d.r)*ap,this.g=_d.g+(np.g-_d.g)*ap,this.b=_d.b+(np.b-_d.b)*ap,this}lerpHSL(_d,np){this.getHSL(_hslA),_d.getHSL(_hslB);const ap=lerp$1(_hslA.h,_hslB.h,np),sp=lerp$1(_hslA.s,_hslB.s,np),lp=lerp$1(_hslA.l,_hslB.l,np);return this.setHSL(ap,sp,lp),this}setFromVector3(_d){return this.r=_d.x,this.g=_d.y,this.b=_d.z,this}applyMatrix3(_d){const np=this.r,ap=this.g,sp=this.b,lp=_d.elements;return this.r=lp[0]*np+lp[3]*ap+lp[6]*sp,this.g=lp[1]*np+lp[4]*ap+lp[7]*sp,this.b=lp[2]*np+lp[5]*ap+lp[8]*sp,this}equals(_d){return _d.r===this.r&&_d.g===this.g&&_d.b===this.b}fromArray(_d,np=0){return this.r=_d[np],this.g=_d[np+1],this.b=_d[np+2],this}toArray(_d=[],np=0){return _d[np]=this.r,_d[np+1]=this.g,_d[np+2]=this.b,_d}fromBufferAttribute(_d,np){return this.r=_d.getX(np),this.g=_d.getY(np),this.b=_d.getZ(np),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color=new Color;Color.NAMES=_colorKeywords;let _materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_d){this._alphaTest>0!=_d>0&&this.version++,this._alphaTest=_d}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_d){if(_d!==void 0)for(const np in _d){const ap=_d[np];if(ap===void 0){console.warn(`THREE.Material: parameter '${np}' has value of undefined.`);continue}const sp=this[np];if(sp===void 0){console.warn(`THREE.Material: '${np}' is not a property of THREE.${this.type}.`);continue}sp&&sp.isColor?sp.set(ap):sp&&sp.isVector3&&ap&&ap.isVector3?sp.copy(ap):this[np]=ap}}toJSON(_d){const np=_d===void 0||typeof _d=="string";np&&(_d={textures:{},images:{}});const ap={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};ap.uuid=this.uuid,ap.type=this.type,this.name!==""&&(ap.name=this.name),this.color&&this.color.isColor&&(ap.color=this.color.getHex()),this.roughness!==void 0&&(ap.roughness=this.roughness),this.metalness!==void 0&&(ap.metalness=this.metalness),this.sheen!==void 0&&(ap.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(ap.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(ap.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(ap.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(ap.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(ap.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(ap.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(ap.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(ap.shininess=this.shininess),this.clearcoat!==void 0&&(ap.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(ap.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(ap.clearcoatMap=this.clearcoatMap.toJSON(_d).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(ap.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_d).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(ap.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_d).uuid,ap.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(ap.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(ap.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(ap.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(ap.iridescenceMap=this.iridescenceMap.toJSON(_d).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(ap.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_d).uuid),this.anisotropy!==void 0&&(ap.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(ap.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(ap.anisotropyMap=this.anisotropyMap.toJSON(_d).uuid),this.map&&this.map.isTexture&&(ap.map=this.map.toJSON(_d).uuid),this.matcap&&this.matcap.isTexture&&(ap.matcap=this.matcap.toJSON(_d).uuid),this.alphaMap&&this.alphaMap.isTexture&&(ap.alphaMap=this.alphaMap.toJSON(_d).uuid),this.lightMap&&this.lightMap.isTexture&&(ap.lightMap=this.lightMap.toJSON(_d).uuid,ap.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(ap.aoMap=this.aoMap.toJSON(_d).uuid,ap.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(ap.bumpMap=this.bumpMap.toJSON(_d).uuid,ap.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(ap.normalMap=this.normalMap.toJSON(_d).uuid,ap.normalMapType=this.normalMapType,ap.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(ap.displacementMap=this.displacementMap.toJSON(_d).uuid,ap.displacementScale=this.displacementScale,ap.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(ap.roughnessMap=this.roughnessMap.toJSON(_d).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(ap.metalnessMap=this.metalnessMap.toJSON(_d).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(ap.emissiveMap=this.emissiveMap.toJSON(_d).uuid),this.specularMap&&this.specularMap.isTexture&&(ap.specularMap=this.specularMap.toJSON(_d).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(ap.specularIntensityMap=this.specularIntensityMap.toJSON(_d).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(ap.specularColorMap=this.specularColorMap.toJSON(_d).uuid),this.envMap&&this.envMap.isTexture&&(ap.envMap=this.envMap.toJSON(_d).uuid,this.combine!==void 0&&(ap.combine=this.combine)),this.envMapIntensity!==void 0&&(ap.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(ap.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(ap.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(ap.gradientMap=this.gradientMap.toJSON(_d).uuid),this.transmission!==void 0&&(ap.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(ap.transmissionMap=this.transmissionMap.toJSON(_d).uuid),this.thickness!==void 0&&(ap.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(ap.thicknessMap=this.thicknessMap.toJSON(_d).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(ap.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(ap.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(ap.size=this.size),this.shadowSide!==null&&(ap.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(ap.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(ap.blending=this.blending),this.side!==FrontSide&&(ap.side=this.side),this.vertexColors===!0&&(ap.vertexColors=!0),this.opacity<1&&(ap.opacity=this.opacity),this.transparent===!0&&(ap.transparent=!0),this.blendSrc!==SrcAlphaFactor&&(ap.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&(ap.blendDst=this.blendDst),this.blendEquation!==AddEquation&&(ap.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(ap.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(ap.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(ap.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(ap.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(ap.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&(ap.depthFunc=this.depthFunc),this.depthTest===!1&&(ap.depthTest=this.depthTest),this.depthWrite===!1&&(ap.depthWrite=this.depthWrite),this.colorWrite===!1&&(ap.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(ap.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&(ap.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(ap.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(ap.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&(ap.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&(ap.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&(ap.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(ap.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(ap.rotation=this.rotation),this.polygonOffset===!0&&(ap.polygonOffset=!0),this.polygonOffsetFactor!==0&&(ap.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(ap.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(ap.linewidth=this.linewidth),this.dashSize!==void 0&&(ap.dashSize=this.dashSize),this.gapSize!==void 0&&(ap.gapSize=this.gapSize),this.scale!==void 0&&(ap.scale=this.scale),this.dithering===!0&&(ap.dithering=!0),this.alphaTest>0&&(ap.alphaTest=this.alphaTest),this.alphaHash===!0&&(ap.alphaHash=!0),this.alphaToCoverage===!0&&(ap.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(ap.premultipliedAlpha=!0),this.forceSinglePass===!0&&(ap.forceSinglePass=!0),this.wireframe===!0&&(ap.wireframe=!0),this.wireframeLinewidth>1&&(ap.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(ap.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(ap.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(ap.flatShading=!0),this.visible===!1&&(ap.visible=!1),this.toneMapped===!1&&(ap.toneMapped=!1),this.fog===!1&&(ap.fog=!1),Object.keys(this.userData).length>0&&(ap.userData=this.userData);function sp(lp){const up=[];for(const cp in lp){const dp=lp[cp];delete dp.metadata,up.push(dp)}return up}if(np){const lp=sp(_d.textures),up=sp(_d.images);lp.length>0&&(ap.textures=lp),up.length>0&&(ap.images=up)}return ap}clone(){return new this.constructor().copy(this)}copy(_d){this.name=_d.name,this.blending=_d.blending,this.side=_d.side,this.vertexColors=_d.vertexColors,this.opacity=_d.opacity,this.transparent=_d.transparent,this.blendSrc=_d.blendSrc,this.blendDst=_d.blendDst,this.blendEquation=_d.blendEquation,this.blendSrcAlpha=_d.blendSrcAlpha,this.blendDstAlpha=_d.blendDstAlpha,this.blendEquationAlpha=_d.blendEquationAlpha,this.blendColor.copy(_d.blendColor),this.blendAlpha=_d.blendAlpha,this.depthFunc=_d.depthFunc,this.depthTest=_d.depthTest,this.depthWrite=_d.depthWrite,this.stencilWriteMask=_d.stencilWriteMask,this.stencilFunc=_d.stencilFunc,this.stencilRef=_d.stencilRef,this.stencilFuncMask=_d.stencilFuncMask,this.stencilFail=_d.stencilFail,this.stencilZFail=_d.stencilZFail,this.stencilZPass=_d.stencilZPass,this.stencilWrite=_d.stencilWrite;const np=_d.clippingPlanes;let ap=null;if(np!==null){const sp=np.length;ap=new Array(sp);for(let lp=0;lp!==sp;++lp)ap[lp]=np[lp].clone()}return this.clippingPlanes=ap,this.clipIntersection=_d.clipIntersection,this.clipShadows=_d.clipShadows,this.shadowSide=_d.shadowSide,this.colorWrite=_d.colorWrite,this.precision=_d.precision,this.polygonOffset=_d.polygonOffset,this.polygonOffsetFactor=_d.polygonOffsetFactor,this.polygonOffsetUnits=_d.polygonOffsetUnits,this.dithering=_d.dithering,this.alphaTest=_d.alphaTest,this.alphaHash=_d.alphaHash,this.alphaToCoverage=_d.alphaToCoverage,this.premultipliedAlpha=_d.premultipliedAlpha,this.forceSinglePass=_d.forceSinglePass,this.visible=_d.visible,this.toneMapped=_d.toneMapped,this.userData=JSON.parse(JSON.stringify(_d.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_d){_d===!0&&this.version++}}class MeshBasicMaterial extends Material{constructor(_d){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.color.copy(_d.color),this.map=_d.map,this.lightMap=_d.lightMap,this.lightMapIntensity=_d.lightMapIntensity,this.aoMap=_d.aoMap,this.aoMapIntensity=_d.aoMapIntensity,this.specularMap=_d.specularMap,this.alphaMap=_d.alphaMap,this.envMap=_d.envMap,this.combine=_d.combine,this.reflectivity=_d.reflectivity,this.refractionRatio=_d.refractionRatio,this.wireframe=_d.wireframe,this.wireframeLinewidth=_d.wireframeLinewidth,this.wireframeLinecap=_d.wireframeLinecap,this.wireframeLinejoin=_d.wireframeLinejoin,this.fog=_d.fog,this}}const _tables=_generateTables();function _generateTables(){const rp=new ArrayBuffer(4),_d=new Float32Array(rp),np=new Uint32Array(rp),ap=new Uint32Array(512),sp=new Uint32Array(512);for(let dp=0;dp<256;++dp){const hp=dp-127;hp<-27?(ap[dp]=0,ap[dp|256]=32768,sp[dp]=24,sp[dp|256]=24):hp<-14?(ap[dp]=1024>>-hp-14,ap[dp|256]=1024>>-hp-14|32768,sp[dp]=-hp-1,sp[dp|256]=-hp-1):hp<=15?(ap[dp]=hp+15<<10,ap[dp|256]=hp+15<<10|32768,sp[dp]=13,sp[dp|256]=13):hp<128?(ap[dp]=31744,ap[dp|256]=64512,sp[dp]=24,sp[dp|256]=24):(ap[dp]=31744,ap[dp|256]=64512,sp[dp]=13,sp[dp|256]=13)}const lp=new Uint32Array(2048),up=new Uint32Array(64),cp=new Uint32Array(64);for(let dp=1;dp<1024;++dp){let hp=dp<<13,fp=0;for(;!(hp&8388608);)hp<<=1,fp-=8388608;hp&=-8388609,fp+=947912704,lp[dp]=hp|fp}for(let dp=1024;dp<2048;++dp)lp[dp]=939524096+(dp-1024<<13);for(let dp=1;dp<31;++dp)up[dp]=dp<<23;up[31]=1199570944,up[32]=2147483648;for(let dp=33;dp<63;++dp)up[dp]=2147483648+(dp-32<<23);up[63]=3347054592;for(let dp=1;dp<64;++dp)dp!==32&&(cp[dp]=1024);return{floatView:_d,uint32View:np,baseTable:ap,shiftTable:sp,mantissaTable:lp,exponentTable:up,offsetTable:cp}}function toHalfFloat(rp){Math.abs(rp)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),rp=clamp(rp,-65504,65504),_tables.floatView[0]=rp;const _d=_tables.uint32View[0],np=_d>>23&511;return _tables.baseTable[np]+((_d&8388607)>>_tables.shiftTable[np])}function fromHalfFloat(rp){const _d=rp>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[_d]+(rp&1023)]+_tables.exponentTable[_d],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat},_vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(_d,np,ap=!1){if(Array.isArray(_d))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_d,this.itemSize=np,this.count=_d!==void 0?_d.length/np:0,this.normalized=ap,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(_d){_d===!0&&this.version++}get updateRange(){return warnOnce("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(_d){return this.usage=_d,this}addUpdateRange(_d,np){this.updateRanges.push({start:_d,count:np})}clearUpdateRanges(){this.updateRanges.length=0}copy(_d){return this.name=_d.name,this.array=new _d.array.constructor(_d.array),this.itemSize=_d.itemSize,this.count=_d.count,this.normalized=_d.normalized,this.usage=_d.usage,this.gpuType=_d.gpuType,this}copyAt(_d,np,ap){_d*=this.itemSize,ap*=np.itemSize;for(let sp=0,lp=this.itemSize;sp<lp;sp++)this.array[_d+sp]=np.array[ap+sp];return this}copyArray(_d){return this.array.set(_d),this}applyMatrix3(_d){if(this.itemSize===2)for(let np=0,ap=this.count;np<ap;np++)_vector2$1.fromBufferAttribute(this,np),_vector2$1.applyMatrix3(_d),this.setXY(np,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let np=0,ap=this.count;np<ap;np++)_vector$9.fromBufferAttribute(this,np),_vector$9.applyMatrix3(_d),this.setXYZ(np,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(_d){for(let np=0,ap=this.count;np<ap;np++)_vector$9.fromBufferAttribute(this,np),_vector$9.applyMatrix4(_d),this.setXYZ(np,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(_d){for(let np=0,ap=this.count;np<ap;np++)_vector$9.fromBufferAttribute(this,np),_vector$9.applyNormalMatrix(_d),this.setXYZ(np,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(_d){for(let np=0,ap=this.count;np<ap;np++)_vector$9.fromBufferAttribute(this,np),_vector$9.transformDirection(_d),this.setXYZ(np,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(_d,np=0){return this.array.set(_d,np),this}getComponent(_d,np){let ap=this.array[_d*this.itemSize+np];return this.normalized&&(ap=denormalize(ap,this.array)),ap}setComponent(_d,np,ap){return this.normalized&&(ap=normalize(ap,this.array)),this.array[_d*this.itemSize+np]=ap,this}getX(_d){let np=this.array[_d*this.itemSize];return this.normalized&&(np=denormalize(np,this.array)),np}setX(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.array[_d*this.itemSize]=np,this}getY(_d){let np=this.array[_d*this.itemSize+1];return this.normalized&&(np=denormalize(np,this.array)),np}setY(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.array[_d*this.itemSize+1]=np,this}getZ(_d){let np=this.array[_d*this.itemSize+2];return this.normalized&&(np=denormalize(np,this.array)),np}setZ(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.array[_d*this.itemSize+2]=np,this}getW(_d){let np=this.array[_d*this.itemSize+3];return this.normalized&&(np=denormalize(np,this.array)),np}setW(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.array[_d*this.itemSize+3]=np,this}setXY(_d,np,ap){return _d*=this.itemSize,this.normalized&&(np=normalize(np,this.array),ap=normalize(ap,this.array)),this.array[_d+0]=np,this.array[_d+1]=ap,this}setXYZ(_d,np,ap,sp){return _d*=this.itemSize,this.normalized&&(np=normalize(np,this.array),ap=normalize(ap,this.array),sp=normalize(sp,this.array)),this.array[_d+0]=np,this.array[_d+1]=ap,this.array[_d+2]=sp,this}setXYZW(_d,np,ap,sp,lp){return _d*=this.itemSize,this.normalized&&(np=normalize(np,this.array),ap=normalize(ap,this.array),sp=normalize(sp,this.array),lp=normalize(lp,this.array)),this.array[_d+0]=np,this.array[_d+1]=ap,this.array[_d+2]=sp,this.array[_d+3]=lp,this}onUpload(_d){return this.onUploadCallback=_d,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _d={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_d.name=this.name),this.usage!==StaticDrawUsage&&(_d.usage=this.usage),_d}}class Int8BufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Int8Array(_d),np,ap)}}class Uint8BufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Uint8Array(_d),np,ap)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Uint8ClampedArray(_d),np,ap)}}class Int16BufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Int16Array(_d),np,ap)}}class Uint16BufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Uint16Array(_d),np,ap)}}class Int32BufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Int32Array(_d),np,ap)}}class Uint32BufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Uint32Array(_d),np,ap)}}class Float16BufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Uint16Array(_d),np,ap),this.isFloat16BufferAttribute=!0}getX(_d){let np=fromHalfFloat(this.array[_d*this.itemSize]);return this.normalized&&(np=denormalize(np,this.array)),np}setX(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.array[_d*this.itemSize]=toHalfFloat(np),this}getY(_d){let np=fromHalfFloat(this.array[_d*this.itemSize+1]);return this.normalized&&(np=denormalize(np,this.array)),np}setY(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.array[_d*this.itemSize+1]=toHalfFloat(np),this}getZ(_d){let np=fromHalfFloat(this.array[_d*this.itemSize+2]);return this.normalized&&(np=denormalize(np,this.array)),np}setZ(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.array[_d*this.itemSize+2]=toHalfFloat(np),this}getW(_d){let np=fromHalfFloat(this.array[_d*this.itemSize+3]);return this.normalized&&(np=denormalize(np,this.array)),np}setW(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.array[_d*this.itemSize+3]=toHalfFloat(np),this}setXY(_d,np,ap){return _d*=this.itemSize,this.normalized&&(np=normalize(np,this.array),ap=normalize(ap,this.array)),this.array[_d+0]=toHalfFloat(np),this.array[_d+1]=toHalfFloat(ap),this}setXYZ(_d,np,ap,sp){return _d*=this.itemSize,this.normalized&&(np=normalize(np,this.array),ap=normalize(ap,this.array),sp=normalize(sp,this.array)),this.array[_d+0]=toHalfFloat(np),this.array[_d+1]=toHalfFloat(ap),this.array[_d+2]=toHalfFloat(sp),this}setXYZW(_d,np,ap,sp,lp){return _d*=this.itemSize,this.normalized&&(np=normalize(np,this.array),ap=normalize(ap,this.array),sp=normalize(sp,this.array),lp=normalize(lp,this.array)),this.array[_d+0]=toHalfFloat(np),this.array[_d+1]=toHalfFloat(ap),this.array[_d+2]=toHalfFloat(sp),this.array[_d+3]=toHalfFloat(lp),this}}class Float32BufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Float32Array(_d),np,ap)}}class Float64BufferAttribute extends BufferAttribute{constructor(_d,np,ap){super(new Float64Array(_d),np,ap)}}let _id$2=0;const _m1=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$2++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_d){return Array.isArray(_d)?this.index=new(arrayNeedsUint32(_d)?Uint32BufferAttribute:Uint16BufferAttribute)(_d,1):this.index=_d,this}getAttribute(_d){return this.attributes[_d]}setAttribute(_d,np){return this.attributes[_d]=np,this}deleteAttribute(_d){return delete this.attributes[_d],this}hasAttribute(_d){return this.attributes[_d]!==void 0}addGroup(_d,np,ap=0){this.groups.push({start:_d,count:np,materialIndex:ap})}clearGroups(){this.groups=[]}setDrawRange(_d,np){this.drawRange.start=_d,this.drawRange.count=np}applyMatrix4(_d){const np=this.attributes.position;np!==void 0&&(np.applyMatrix4(_d),np.needsUpdate=!0);const ap=this.attributes.normal;if(ap!==void 0){const lp=new Matrix3().getNormalMatrix(_d);ap.applyNormalMatrix(lp),ap.needsUpdate=!0}const sp=this.attributes.tangent;return sp!==void 0&&(sp.transformDirection(_d),sp.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_d){return _m1.makeRotationFromQuaternion(_d),this.applyMatrix4(_m1),this}rotateX(_d){return _m1.makeRotationX(_d),this.applyMatrix4(_m1),this}rotateY(_d){return _m1.makeRotationY(_d),this.applyMatrix4(_m1),this}rotateZ(_d){return _m1.makeRotationZ(_d),this.applyMatrix4(_m1),this}translate(_d,np,ap){return _m1.makeTranslation(_d,np,ap),this.applyMatrix4(_m1),this}scale(_d,np,ap){return _m1.makeScale(_d,np,ap),this.applyMatrix4(_m1),this}lookAt(_d){return _obj.lookAt(_d),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(_d){const np=[];for(let ap=0,sp=_d.length;ap<sp;ap++){const lp=_d[ap];np.push(lp.x,lp.y,lp.z||0)}return this.setAttribute("position",new Float32BufferAttribute(np,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _d=this.attributes.position,np=this.morphAttributes.position;if(_d&&_d.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(_d!==void 0){if(this.boundingBox.setFromBufferAttribute(_d),np)for(let ap=0,sp=np.length;ap<sp;ap++){const lp=np[ap];_box$2.setFromBufferAttribute(lp),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _d=this.attributes.position,np=this.morphAttributes.position;if(_d&&_d.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Vector3,1/0);return}if(_d){const ap=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(_d),np)for(let lp=0,up=np.length;lp<up;lp++){const cp=np[lp];_boxMorphTargets.setFromBufferAttribute(cp),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(ap);let sp=0;for(let lp=0,up=_d.count;lp<up;lp++)_vector$8.fromBufferAttribute(_d,lp),sp=Math.max(sp,ap.distanceToSquared(_vector$8));if(np)for(let lp=0,up=np.length;lp<up;lp++){const cp=np[lp],dp=this.morphTargetsRelative;for(let hp=0,fp=cp.count;hp<fp;hp++)_vector$8.fromBufferAttribute(cp,hp),dp&&(_offset.fromBufferAttribute(_d,hp),_vector$8.add(_offset)),sp=Math.max(sp,ap.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(sp),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _d=this.index,np=this.attributes;if(_d===null||np.position===void 0||np.normal===void 0||np.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const ap=_d.array,sp=np.position.array,lp=np.normal.array,up=np.uv.array,cp=sp.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*cp),4));const dp=this.getAttribute("tangent").array,hp=[],fp=[];for(let Pp=0;Pp<cp;Pp++)hp[Pp]=new Vector3,fp[Pp]=new Vector3;const pp=new Vector3,mp=new Vector3,gp=new Vector3,yp=new Vector2,xp=new Vector2,_p=new Vector2,vp=new Vector3,bp=new Vector3;function Ep(Pp,$p,zp){pp.fromArray(sp,Pp*3),mp.fromArray(sp,$p*3),gp.fromArray(sp,zp*3),yp.fromArray(up,Pp*2),xp.fromArray(up,$p*2),_p.fromArray(up,zp*2),mp.sub(pp),gp.sub(pp),xp.sub(yp),_p.sub(yp);const Dp=1/(xp.x*_p.y-_p.x*xp.y);isFinite(Dp)&&(vp.copy(mp).multiplyScalar(_p.y).addScaledVector(gp,-xp.y).multiplyScalar(Dp),bp.copy(gp).multiplyScalar(xp.x).addScaledVector(mp,-_p.x).multiplyScalar(Dp),hp[Pp].add(vp),hp[$p].add(vp),hp[zp].add(vp),fp[Pp].add(bp),fp[$p].add(bp),fp[zp].add(bp))}let Sp=this.groups;Sp.length===0&&(Sp=[{start:0,count:ap.length}]);for(let Pp=0,$p=Sp.length;Pp<$p;++Pp){const zp=Sp[Pp],Dp=zp.start,Fp=zp.count;for(let jp=Dp,Lp=Dp+Fp;jp<Lp;jp+=3)Ep(ap[jp+0],ap[jp+1],ap[jp+2])}const Ap=new Vector3,Rp=new Vector3,Tp=new Vector3,Mp=new Vector3;function Op(Pp){Tp.fromArray(lp,Pp*3),Mp.copy(Tp);const $p=hp[Pp];Ap.copy($p),Ap.sub(Tp.multiplyScalar(Tp.dot($p))).normalize(),Rp.crossVectors(Mp,$p);const Dp=Rp.dot(fp[Pp])<0?-1:1;dp[Pp*4]=Ap.x,dp[Pp*4+1]=Ap.y,dp[Pp*4+2]=Ap.z,dp[Pp*4+3]=Dp}for(let Pp=0,$p=Sp.length;Pp<$p;++Pp){const zp=Sp[Pp],Dp=zp.start,Fp=zp.count;for(let jp=Dp,Lp=Dp+Fp;jp<Lp;jp+=3)Op(ap[jp+0]),Op(ap[jp+1]),Op(ap[jp+2])}}computeVertexNormals(){const _d=this.index,np=this.getAttribute("position");if(np!==void 0){let ap=this.getAttribute("normal");if(ap===void 0)ap=new BufferAttribute(new Float32Array(np.count*3),3),this.setAttribute("normal",ap);else for(let mp=0,gp=ap.count;mp<gp;mp++)ap.setXYZ(mp,0,0,0);const sp=new Vector3,lp=new Vector3,up=new Vector3,cp=new Vector3,dp=new Vector3,hp=new Vector3,fp=new Vector3,pp=new Vector3;if(_d)for(let mp=0,gp=_d.count;mp<gp;mp+=3){const yp=_d.getX(mp+0),xp=_d.getX(mp+1),_p=_d.getX(mp+2);sp.fromBufferAttribute(np,yp),lp.fromBufferAttribute(np,xp),up.fromBufferAttribute(np,_p),fp.subVectors(up,lp),pp.subVectors(sp,lp),fp.cross(pp),cp.fromBufferAttribute(ap,yp),dp.fromBufferAttribute(ap,xp),hp.fromBufferAttribute(ap,_p),cp.add(fp),dp.add(fp),hp.add(fp),ap.setXYZ(yp,cp.x,cp.y,cp.z),ap.setXYZ(xp,dp.x,dp.y,dp.z),ap.setXYZ(_p,hp.x,hp.y,hp.z)}else for(let mp=0,gp=np.count;mp<gp;mp+=3)sp.fromBufferAttribute(np,mp+0),lp.fromBufferAttribute(np,mp+1),up.fromBufferAttribute(np,mp+2),fp.subVectors(up,lp),pp.subVectors(sp,lp),fp.cross(pp),ap.setXYZ(mp+0,fp.x,fp.y,fp.z),ap.setXYZ(mp+1,fp.x,fp.y,fp.z),ap.setXYZ(mp+2,fp.x,fp.y,fp.z);this.normalizeNormals(),ap.needsUpdate=!0}}normalizeNormals(){const _d=this.attributes.normal;for(let np=0,ap=_d.count;np<ap;np++)_vector$8.fromBufferAttribute(_d,np),_vector$8.normalize(),_d.setXYZ(np,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function _d(cp,dp){const hp=cp.array,fp=cp.itemSize,pp=cp.normalized,mp=new hp.constructor(dp.length*fp);let gp=0,yp=0;for(let xp=0,_p=dp.length;xp<_p;xp++){cp.isInterleavedBufferAttribute?gp=dp[xp]*cp.data.stride+cp.offset:gp=dp[xp]*fp;for(let vp=0;vp<fp;vp++)mp[yp++]=hp[gp++]}return new BufferAttribute(mp,fp,pp)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const np=new BufferGeometry,ap=this.index.array,sp=this.attributes;for(const cp in sp){const dp=sp[cp],hp=_d(dp,ap);np.setAttribute(cp,hp)}const lp=this.morphAttributes;for(const cp in lp){const dp=[],hp=lp[cp];for(let fp=0,pp=hp.length;fp<pp;fp++){const mp=hp[fp],gp=_d(mp,ap);dp.push(gp)}np.morphAttributes[cp]=dp}np.morphTargetsRelative=this.morphTargetsRelative;const up=this.groups;for(let cp=0,dp=up.length;cp<dp;cp++){const hp=up[cp];np.addGroup(hp.start,hp.count,hp.materialIndex)}return np}toJSON(){const _d={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_d.uuid=this.uuid,_d.type=this.type,this.name!==""&&(_d.name=this.name),Object.keys(this.userData).length>0&&(_d.userData=this.userData),this.parameters!==void 0){const dp=this.parameters;for(const hp in dp)dp[hp]!==void 0&&(_d[hp]=dp[hp]);return _d}_d.data={attributes:{}};const np=this.index;np!==null&&(_d.data.index={type:np.array.constructor.name,array:Array.prototype.slice.call(np.array)});const ap=this.attributes;for(const dp in ap){const hp=ap[dp];_d.data.attributes[dp]=hp.toJSON(_d.data)}const sp={};let lp=!1;for(const dp in this.morphAttributes){const hp=this.morphAttributes[dp],fp=[];for(let pp=0,mp=hp.length;pp<mp;pp++){const gp=hp[pp];fp.push(gp.toJSON(_d.data))}fp.length>0&&(sp[dp]=fp,lp=!0)}lp&&(_d.data.morphAttributes=sp,_d.data.morphTargetsRelative=this.morphTargetsRelative);const up=this.groups;up.length>0&&(_d.data.groups=JSON.parse(JSON.stringify(up)));const cp=this.boundingSphere;return cp!==null&&(_d.data.boundingSphere={center:cp.center.toArray(),radius:cp.radius}),_d}clone(){return new this.constructor().copy(this)}copy(_d){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const np={};this.name=_d.name;const ap=_d.index;ap!==null&&this.setIndex(ap.clone(np));const sp=_d.attributes;for(const hp in sp){const fp=sp[hp];this.setAttribute(hp,fp.clone(np))}const lp=_d.morphAttributes;for(const hp in lp){const fp=[],pp=lp[hp];for(let mp=0,gp=pp.length;mp<gp;mp++)fp.push(pp[mp].clone(np));this.morphAttributes[hp]=fp}this.morphTargetsRelative=_d.morphTargetsRelative;const up=_d.groups;for(let hp=0,fp=up.length;hp<fp;hp++){const pp=up[hp];this.addGroup(pp.start,pp.count,pp.materialIndex)}const cp=_d.boundingBox;cp!==null&&(this.boundingBox=cp.clone());const dp=_d.boundingSphere;return dp!==null&&(this.boundingSphere=dp.clone()),this.drawRange.start=_d.drawRange.start,this.drawRange.count=_d.drawRange.count,this.userData=_d.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(_d=new BufferGeometry,np=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_d,this.material=np,this.updateMorphTargets()}copy(_d,np){return super.copy(_d,np),_d.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_d.morphTargetInfluences.slice()),_d.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_d.morphTargetDictionary)),this.material=Array.isArray(_d.material)?_d.material.slice():_d.material,this.geometry=_d.geometry,this}updateMorphTargets(){const np=this.geometry.morphAttributes,ap=Object.keys(np);if(ap.length>0){const sp=np[ap[0]];if(sp!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let lp=0,up=sp.length;lp<up;lp++){const cp=sp[lp].name||String(lp);this.morphTargetInfluences.push(0),this.morphTargetDictionary[cp]=lp}}}}getVertexPosition(_d,np){const ap=this.geometry,sp=ap.attributes.position,lp=ap.morphAttributes.position,up=ap.morphTargetsRelative;np.fromBufferAttribute(sp,_d);const cp=this.morphTargetInfluences;if(lp&&cp){_morphA.set(0,0,0);for(let dp=0,hp=lp.length;dp<hp;dp++){const fp=cp[dp],pp=lp[dp];fp!==0&&(_tempA.fromBufferAttribute(pp,_d),up?_morphA.addScaledVector(_tempA,fp):_morphA.addScaledVector(_tempA.sub(np),fp))}np.add(_morphA)}return np}raycast(_d,np){const ap=this.geometry,sp=this.material,lp=this.matrixWorld;sp!==void 0&&(ap.boundingSphere===null&&ap.computeBoundingSphere(),_sphere$6.copy(ap.boundingSphere),_sphere$6.applyMatrix4(lp),_ray$3.copy(_d.ray).recast(_d.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(_d.far-_d.near)**2))&&(_inverseMatrix$3.copy(lp).invert(),_ray$3.copy(_d.ray).applyMatrix4(_inverseMatrix$3),!(ap.boundingBox!==null&&_ray$3.intersectsBox(ap.boundingBox)===!1)&&this._computeIntersections(_d,np,_ray$3)))}_computeIntersections(_d,np,ap){let sp;const lp=this.geometry,up=this.material,cp=lp.index,dp=lp.attributes.position,hp=lp.attributes.uv,fp=lp.attributes.uv1,pp=lp.attributes.normal,mp=lp.groups,gp=lp.drawRange;if(cp!==null)if(Array.isArray(up))for(let yp=0,xp=mp.length;yp<xp;yp++){const _p=mp[yp],vp=up[_p.materialIndex],bp=Math.max(_p.start,gp.start),Ep=Math.min(cp.count,Math.min(_p.start+_p.count,gp.start+gp.count));for(let Sp=bp,Ap=Ep;Sp<Ap;Sp+=3){const Rp=cp.getX(Sp),Tp=cp.getX(Sp+1),Mp=cp.getX(Sp+2);sp=checkGeometryIntersection(this,vp,_d,ap,hp,fp,pp,Rp,Tp,Mp),sp&&(sp.faceIndex=Math.floor(Sp/3),sp.face.materialIndex=_p.materialIndex,np.push(sp))}}else{const yp=Math.max(0,gp.start),xp=Math.min(cp.count,gp.start+gp.count);for(let _p=yp,vp=xp;_p<vp;_p+=3){const bp=cp.getX(_p),Ep=cp.getX(_p+1),Sp=cp.getX(_p+2);sp=checkGeometryIntersection(this,up,_d,ap,hp,fp,pp,bp,Ep,Sp),sp&&(sp.faceIndex=Math.floor(_p/3),np.push(sp))}}else if(dp!==void 0)if(Array.isArray(up))for(let yp=0,xp=mp.length;yp<xp;yp++){const _p=mp[yp],vp=up[_p.materialIndex],bp=Math.max(_p.start,gp.start),Ep=Math.min(dp.count,Math.min(_p.start+_p.count,gp.start+gp.count));for(let Sp=bp,Ap=Ep;Sp<Ap;Sp+=3){const Rp=Sp,Tp=Sp+1,Mp=Sp+2;sp=checkGeometryIntersection(this,vp,_d,ap,hp,fp,pp,Rp,Tp,Mp),sp&&(sp.faceIndex=Math.floor(Sp/3),sp.face.materialIndex=_p.materialIndex,np.push(sp))}}else{const yp=Math.max(0,gp.start),xp=Math.min(dp.count,gp.start+gp.count);for(let _p=yp,vp=xp;_p<vp;_p+=3){const bp=_p,Ep=_p+1,Sp=_p+2;sp=checkGeometryIntersection(this,up,_d,ap,hp,fp,pp,bp,Ep,Sp),sp&&(sp.faceIndex=Math.floor(_p/3),np.push(sp))}}}}function checkIntersection(rp,_d,np,ap,sp,lp,up,cp){let dp;if(_d.side===BackSide?dp=ap.intersectTriangle(up,lp,sp,!0,cp):dp=ap.intersectTriangle(sp,lp,up,_d.side===FrontSide,cp),dp===null)return null;_intersectionPointWorld.copy(cp),_intersectionPointWorld.applyMatrix4(rp.matrixWorld);const hp=np.ray.origin.distanceTo(_intersectionPointWorld);return hp<np.near||hp>np.far?null:{distance:hp,point:_intersectionPointWorld.clone(),object:rp}}function checkGeometryIntersection(rp,_d,np,ap,sp,lp,up,cp,dp,hp){rp.getVertexPosition(cp,_vA$1),rp.getVertexPosition(dp,_vB$1),rp.getVertexPosition(hp,_vC$1);const fp=checkIntersection(rp,_d,np,ap,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(fp){sp&&(_uvA$1.fromBufferAttribute(sp,cp),_uvB$1.fromBufferAttribute(sp,dp),_uvC$1.fromBufferAttribute(sp,hp),fp.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),lp&&(_uvA$1.fromBufferAttribute(lp,cp),_uvB$1.fromBufferAttribute(lp,dp),_uvC$1.fromBufferAttribute(lp,hp),fp.uv1=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2),fp.uv2=fp.uv1),up&&(_normalA.fromBufferAttribute(up,cp),_normalB.fromBufferAttribute(up,dp),_normalC.fromBufferAttribute(up,hp),fp.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),fp.normal.dot(ap.direction)>0&&fp.normal.multiplyScalar(-1));const pp={a:cp,b:dp,c:hp,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,pp.normal),fp.face=pp}return fp}class BoxGeometry extends BufferGeometry{constructor(_d=1,np=1,ap=1,sp=1,lp=1,up=1){super(),this.type="BoxGeometry",this.parameters={width:_d,height:np,depth:ap,widthSegments:sp,heightSegments:lp,depthSegments:up};const cp=this;sp=Math.floor(sp),lp=Math.floor(lp),up=Math.floor(up);const dp=[],hp=[],fp=[],pp=[];let mp=0,gp=0;yp("z","y","x",-1,-1,ap,np,_d,up,lp,0),yp("z","y","x",1,-1,ap,np,-_d,up,lp,1),yp("x","z","y",1,1,_d,ap,np,sp,up,2),yp("x","z","y",1,-1,_d,ap,-np,sp,up,3),yp("x","y","z",1,-1,_d,np,ap,sp,lp,4),yp("x","y","z",-1,-1,_d,np,-ap,sp,lp,5),this.setIndex(dp),this.setAttribute("position",new Float32BufferAttribute(hp,3)),this.setAttribute("normal",new Float32BufferAttribute(fp,3)),this.setAttribute("uv",new Float32BufferAttribute(pp,2));function yp(xp,_p,vp,bp,Ep,Sp,Ap,Rp,Tp,Mp,Op){const Pp=Sp/Tp,$p=Ap/Mp,zp=Sp/2,Dp=Ap/2,Fp=Rp/2,jp=Tp+1,Lp=Mp+1;let Bp=0,Ip=0;const kp=new Vector3;for(let Up=0;Up<Lp;Up++){const Gp=Up*$p-Dp;for(let Wp=0;Wp<jp;Wp++){const Qp=Wp*Pp-zp;kp[xp]=Qp*bp,kp[_p]=Gp*Ep,kp[vp]=Fp,hp.push(kp.x,kp.y,kp.z),kp[xp]=0,kp[_p]=0,kp[vp]=Rp>0?1:-1,fp.push(kp.x,kp.y,kp.z),pp.push(Wp/Tp),pp.push(1-Up/Mp),Bp+=1}}for(let Up=0;Up<Mp;Up++)for(let Gp=0;Gp<Tp;Gp++){const Wp=mp+Gp+jp*Up,Qp=mp+Gp+jp*(Up+1),Xp=mp+(Gp+1)+jp*(Up+1),rm=mp+(Gp+1)+jp*Up;dp.push(Wp,Qp,rm),dp.push(Qp,Xp,rm),Ip+=6}cp.addGroup(gp,Ip,Op),gp+=Ip,mp+=Bp}}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new BoxGeometry(_d.width,_d.height,_d.depth,_d.widthSegments,_d.heightSegments,_d.depthSegments)}}function cloneUniforms(rp){const _d={};for(const np in rp){_d[np]={};for(const ap in rp[np]){const sp=rp[np][ap];sp&&(sp.isColor||sp.isMatrix3||sp.isMatrix4||sp.isVector2||sp.isVector3||sp.isVector4||sp.isTexture||sp.isQuaternion)?sp.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),_d[np][ap]=null):_d[np][ap]=sp.clone():Array.isArray(sp)?_d[np][ap]=sp.slice():_d[np][ap]=sp}}return _d}function mergeUniforms(rp){const _d={};for(let np=0;np<rp.length;np++){const ap=cloneUniforms(rp[np]);for(const sp in ap)_d[sp]=ap[sp]}return _d}function cloneUniformsGroups(rp){const _d=[];for(let np=0;np<rp.length;np++)_d.push(rp[np].clone());return _d}function getUnlitUniformColorSpace(rp){return rp.getRenderTarget()===null?rp.outputColorSpace:ColorManagement.workingColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(_d){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_d!==void 0&&this.setValues(_d)}copy(_d){return super.copy(_d),this.fragmentShader=_d.fragmentShader,this.vertexShader=_d.vertexShader,this.uniforms=cloneUniforms(_d.uniforms),this.uniformsGroups=cloneUniformsGroups(_d.uniformsGroups),this.defines=Object.assign({},_d.defines),this.wireframe=_d.wireframe,this.wireframeLinewidth=_d.wireframeLinewidth,this.fog=_d.fog,this.lights=_d.lights,this.clipping=_d.clipping,this.extensions=Object.assign({},_d.extensions),this.glslVersion=_d.glslVersion,this}toJSON(_d){const np=super.toJSON(_d);np.glslVersion=this.glslVersion,np.uniforms={};for(const sp in this.uniforms){const up=this.uniforms[sp].value;up&&up.isTexture?np.uniforms[sp]={type:"t",value:up.toJSON(_d).uuid}:up&&up.isColor?np.uniforms[sp]={type:"c",value:up.getHex()}:up&&up.isVector2?np.uniforms[sp]={type:"v2",value:up.toArray()}:up&&up.isVector3?np.uniforms[sp]={type:"v3",value:up.toArray()}:up&&up.isVector4?np.uniforms[sp]={type:"v4",value:up.toArray()}:up&&up.isMatrix3?np.uniforms[sp]={type:"m3",value:up.toArray()}:up&&up.isMatrix4?np.uniforms[sp]={type:"m4",value:up.toArray()}:np.uniforms[sp]={value:up}}Object.keys(this.defines).length>0&&(np.defines=this.defines),np.vertexShader=this.vertexShader,np.fragmentShader=this.fragmentShader,np.lights=this.lights,np.clipping=this.clipping;const ap={};for(const sp in this.extensions)this.extensions[sp]===!0&&(ap[sp]=!0);return Object.keys(ap).length>0&&(np.extensions=ap),np}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(_d,np){return super.copy(_d,np),this.matrixWorldInverse.copy(_d.matrixWorldInverse),this.projectionMatrix.copy(_d.projectionMatrix),this.projectionMatrixInverse.copy(_d.projectionMatrixInverse),this.coordinateSystem=_d.coordinateSystem,this}getWorldDirection(_d){return super.getWorldDirection(_d).negate()}updateMatrixWorld(_d){super.updateMatrixWorld(_d),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_d,np){super.updateWorldMatrix(_d,np),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const _v3$1=new Vector3,_minTarget=new Vector2,_maxTarget=new Vector2;let PerspectiveCamera$1=class extends Camera{constructor(_d=50,np=1,ap=.1,sp=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_d,this.zoom=1,this.near=ap,this.far=sp,this.focus=10,this.aspect=np,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_d,np){return super.copy(_d,np),this.fov=_d.fov,this.zoom=_d.zoom,this.near=_d.near,this.far=_d.far,this.focus=_d.focus,this.aspect=_d.aspect,this.view=_d.view===null?null:Object.assign({},_d.view),this.filmGauge=_d.filmGauge,this.filmOffset=_d.filmOffset,this}setFocalLength(_d){const np=.5*this.getFilmHeight()/_d;this.fov=RAD2DEG*2*Math.atan(np),this.updateProjectionMatrix()}getFocalLength(){const _d=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/_d}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(_d,np,ap){_v3$1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),np.set(_v3$1.x,_v3$1.y).multiplyScalar(-_d/_v3$1.z),_v3$1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),ap.set(_v3$1.x,_v3$1.y).multiplyScalar(-_d/_v3$1.z)}getViewSize(_d,np){return this.getViewBounds(_d,_minTarget,_maxTarget),np.subVectors(_maxTarget,_minTarget)}setViewOffset(_d,np,ap,sp,lp,up){this.aspect=_d/np,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_d,this.view.fullHeight=np,this.view.offsetX=ap,this.view.offsetY=sp,this.view.width=lp,this.view.height=up,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _d=this.near;let np=_d*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,ap=2*np,sp=this.aspect*ap,lp=-.5*sp;const up=this.view;if(this.view!==null&&this.view.enabled){const dp=up.fullWidth,hp=up.fullHeight;lp+=up.offsetX*sp/dp,np-=up.offsetY*ap/hp,sp*=up.width/dp,ap*=up.height/hp}const cp=this.filmOffset;cp!==0&&(lp+=_d*cp/this.getFilmWidth()),this.projectionMatrix.makePerspective(lp,lp+sp,np,np-ap,_d,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_d){const np=super.toJSON(_d);return np.object.fov=this.fov,np.object.zoom=this.zoom,np.object.near=this.near,np.object.far=this.far,np.object.focus=this.focus,np.object.aspect=this.aspect,this.view!==null&&(np.object.view=Object.assign({},this.view)),np.object.filmGauge=this.filmGauge,np.object.filmOffset=this.filmOffset,np}};const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(_d,np,ap){super(),this.type="CubeCamera",this.renderTarget=ap,this.coordinateSystem=null,this.activeMipmapLevel=0;const sp=new PerspectiveCamera$1(fov,aspect,_d,np);sp.layers=this.layers,this.add(sp);const lp=new PerspectiveCamera$1(fov,aspect,_d,np);lp.layers=this.layers,this.add(lp);const up=new PerspectiveCamera$1(fov,aspect,_d,np);up.layers=this.layers,this.add(up);const cp=new PerspectiveCamera$1(fov,aspect,_d,np);cp.layers=this.layers,this.add(cp);const dp=new PerspectiveCamera$1(fov,aspect,_d,np);dp.layers=this.layers,this.add(dp);const hp=new PerspectiveCamera$1(fov,aspect,_d,np);hp.layers=this.layers,this.add(hp)}updateCoordinateSystem(){const _d=this.coordinateSystem,np=this.children.concat(),[ap,sp,lp,up,cp,dp]=np;for(const hp of np)this.remove(hp);if(_d===WebGLCoordinateSystem)ap.up.set(0,1,0),ap.lookAt(1,0,0),sp.up.set(0,1,0),sp.lookAt(-1,0,0),lp.up.set(0,0,-1),lp.lookAt(0,1,0),up.up.set(0,0,1),up.lookAt(0,-1,0),cp.up.set(0,1,0),cp.lookAt(0,0,1),dp.up.set(0,1,0),dp.lookAt(0,0,-1);else if(_d===WebGPUCoordinateSystem)ap.up.set(0,-1,0),ap.lookAt(-1,0,0),sp.up.set(0,-1,0),sp.lookAt(1,0,0),lp.up.set(0,0,1),lp.lookAt(0,1,0),up.up.set(0,0,-1),up.lookAt(0,-1,0),cp.up.set(0,-1,0),cp.lookAt(0,0,1),dp.up.set(0,-1,0),dp.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+_d);for(const hp of np)this.add(hp),hp.updateMatrixWorld()}update(_d,np){this.parent===null&&this.updateMatrixWorld();const{renderTarget:ap,activeMipmapLevel:sp}=this;this.coordinateSystem!==_d.coordinateSystem&&(this.coordinateSystem=_d.coordinateSystem,this.updateCoordinateSystem());const[lp,up,cp,dp,hp,fp]=this.children,pp=_d.getRenderTarget(),mp=_d.getActiveCubeFace(),gp=_d.getActiveMipmapLevel(),yp=_d.xr.enabled;_d.xr.enabled=!1;const xp=ap.texture.generateMipmaps;ap.texture.generateMipmaps=!1,_d.setRenderTarget(ap,0,sp),_d.render(np,lp),_d.setRenderTarget(ap,1,sp),_d.render(np,up),_d.setRenderTarget(ap,2,sp),_d.render(np,cp),_d.setRenderTarget(ap,3,sp),_d.render(np,dp),_d.setRenderTarget(ap,4,sp),_d.render(np,hp),ap.texture.generateMipmaps=xp,_d.setRenderTarget(ap,5,sp),_d.render(np,fp),_d.setRenderTarget(pp,mp,gp),_d.xr.enabled=yp,ap.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(_d,np,ap,sp,lp,up,cp,dp,hp,fp){_d=_d!==void 0?_d:[],np=np!==void 0?np:CubeReflectionMapping,super(_d,np,ap,sp,lp,up,cp,dp,hp,fp),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_d){this.image=_d}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(_d=1,np={}){super(_d,_d,np),this.isWebGLCubeRenderTarget=!0;const ap={width:_d,height:_d,depth:1},sp=[ap,ap,ap,ap,ap,ap];np.encoding!==void 0&&(warnOnce("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),np.colorSpace=np.encoding===sRGBEncoding?SRGBColorSpace$1:NoColorSpace$1),this.texture=new CubeTexture(sp,np.mapping,np.wrapS,np.wrapT,np.magFilter,np.minFilter,np.format,np.type,np.anisotropy,np.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=np.generateMipmaps!==void 0?np.generateMipmaps:!1,this.texture.minFilter=np.minFilter!==void 0?np.minFilter:LinearFilter}fromEquirectangularTexture(_d,np){this.texture.type=np.type,this.texture.colorSpace=np.colorSpace,this.texture.generateMipmaps=np.generateMipmaps,this.texture.minFilter=np.minFilter,this.texture.magFilter=np.magFilter;const ap={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},sp=new BoxGeometry(5,5,5),lp=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(ap.uniforms),vertexShader:ap.vertexShader,fragmentShader:ap.fragmentShader,side:BackSide,blending:NoBlending});lp.uniforms.tEquirect.value=np;const up=new Mesh(sp,lp),cp=np.minFilter;return np.minFilter===LinearMipmapLinearFilter&&(np.minFilter=LinearFilter),new CubeCamera(1,10,this).update(_d,up),np.minFilter=cp,up.geometry.dispose(),up.material.dispose(),this}clear(_d,np,ap,sp){const lp=_d.getRenderTarget();for(let up=0;up<6;up++)_d.setRenderTarget(this,up),_d.clear(np,ap,sp);_d.setRenderTarget(lp)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(_d=new Vector3(1,0,0),np=0){this.isPlane=!0,this.normal=_d,this.constant=np}set(_d,np){return this.normal.copy(_d),this.constant=np,this}setComponents(_d,np,ap,sp){return this.normal.set(_d,np,ap),this.constant=sp,this}setFromNormalAndCoplanarPoint(_d,np){return this.normal.copy(_d),this.constant=-np.dot(this.normal),this}setFromCoplanarPoints(_d,np,ap){const sp=_vector1.subVectors(ap,np).cross(_vector2.subVectors(_d,np)).normalize();return this.setFromNormalAndCoplanarPoint(sp,_d),this}copy(_d){return this.normal.copy(_d.normal),this.constant=_d.constant,this}normalize(){const _d=1/this.normal.length();return this.normal.multiplyScalar(_d),this.constant*=_d,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_d){return this.normal.dot(_d)+this.constant}distanceToSphere(_d){return this.distanceToPoint(_d.center)-_d.radius}projectPoint(_d,np){return np.copy(_d).addScaledVector(this.normal,-this.distanceToPoint(_d))}intersectLine(_d,np){const ap=_d.delta(_vector1),sp=this.normal.dot(ap);if(sp===0)return this.distanceToPoint(_d.start)===0?np.copy(_d.start):null;const lp=-(_d.start.dot(this.normal)+this.constant)/sp;return lp<0||lp>1?null:np.copy(_d.start).addScaledVector(ap,lp)}intersectsLine(_d){const np=this.distanceToPoint(_d.start),ap=this.distanceToPoint(_d.end);return np<0&&ap>0||ap<0&&np>0}intersectsBox(_d){return _d.intersectsPlane(this)}intersectsSphere(_d){return _d.intersectsPlane(this)}coplanarPoint(_d){return _d.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_d,np){const ap=np||_normalMatrix.getNormalMatrix(_d),sp=this.coplanarPoint(_vector1).applyMatrix4(_d),lp=this.normal.applyMatrix3(ap).normalize();return this.constant=-sp.dot(lp),this}translate(_d){return this.constant-=_d.dot(this.normal),this}equals(_d){return _d.normal.equals(this.normal)&&_d.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$5=new Sphere,_vector$7=new Vector3;class Frustum{constructor(_d=new Plane,np=new Plane,ap=new Plane,sp=new Plane,lp=new Plane,up=new Plane){this.planes=[_d,np,ap,sp,lp,up]}set(_d,np,ap,sp,lp,up){const cp=this.planes;return cp[0].copy(_d),cp[1].copy(np),cp[2].copy(ap),cp[3].copy(sp),cp[4].copy(lp),cp[5].copy(up),this}copy(_d){const np=this.planes;for(let ap=0;ap<6;ap++)np[ap].copy(_d.planes[ap]);return this}setFromProjectionMatrix(_d,np=WebGLCoordinateSystem){const ap=this.planes,sp=_d.elements,lp=sp[0],up=sp[1],cp=sp[2],dp=sp[3],hp=sp[4],fp=sp[5],pp=sp[6],mp=sp[7],gp=sp[8],yp=sp[9],xp=sp[10],_p=sp[11],vp=sp[12],bp=sp[13],Ep=sp[14],Sp=sp[15];if(ap[0].setComponents(dp-lp,mp-hp,_p-gp,Sp-vp).normalize(),ap[1].setComponents(dp+lp,mp+hp,_p+gp,Sp+vp).normalize(),ap[2].setComponents(dp+up,mp+fp,_p+yp,Sp+bp).normalize(),ap[3].setComponents(dp-up,mp-fp,_p-yp,Sp-bp).normalize(),ap[4].setComponents(dp-cp,mp-pp,_p-xp,Sp-Ep).normalize(),np===WebGLCoordinateSystem)ap[5].setComponents(dp+cp,mp+pp,_p+xp,Sp+Ep).normalize();else if(np===WebGPUCoordinateSystem)ap[5].setComponents(cp,pp,xp,Ep).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+np);return this}intersectsObject(_d){if(_d.boundingSphere!==void 0)_d.boundingSphere===null&&_d.computeBoundingSphere(),_sphere$5.copy(_d.boundingSphere).applyMatrix4(_d.matrixWorld);else{const np=_d.geometry;np.boundingSphere===null&&np.computeBoundingSphere(),_sphere$5.copy(np.boundingSphere).applyMatrix4(_d.matrixWorld)}return this.intersectsSphere(_sphere$5)}intersectsSprite(_d){return _sphere$5.center.set(0,0,0),_sphere$5.radius=.7071067811865476,_sphere$5.applyMatrix4(_d.matrixWorld),this.intersectsSphere(_sphere$5)}intersectsSphere(_d){const np=this.planes,ap=_d.center,sp=-_d.radius;for(let lp=0;lp<6;lp++)if(np[lp].distanceToPoint(ap)<sp)return!1;return!0}intersectsBox(_d){const np=this.planes;for(let ap=0;ap<6;ap++){const sp=np[ap];if(_vector$7.x=sp.normal.x>0?_d.max.x:_d.min.x,_vector$7.y=sp.normal.y>0?_d.max.y:_d.min.y,_vector$7.z=sp.normal.z>0?_d.max.z:_d.min.z,sp.distanceToPoint(_vector$7)<0)return!1}return!0}containsPoint(_d){const np=this.planes;for(let ap=0;ap<6;ap++)if(np[ap].distanceToPoint(_d)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let rp=null,_d=!1,np=null,ap=null;function sp(lp,up){np(lp,up),ap=rp.requestAnimationFrame(sp)}return{start:function(){_d!==!0&&np!==null&&(ap=rp.requestAnimationFrame(sp),_d=!0)},stop:function(){rp.cancelAnimationFrame(ap),_d=!1},setAnimationLoop:function(lp){np=lp},setContext:function(lp){rp=lp}}}function WebGLAttributes(rp,_d){const np=_d.isWebGL2,ap=new WeakMap;function sp(hp,fp){const pp=hp.array,mp=hp.usage,gp=pp.byteLength,yp=rp.createBuffer();rp.bindBuffer(fp,yp),rp.bufferData(fp,pp,mp),hp.onUploadCallback();let xp;if(pp instanceof Float32Array)xp=rp.FLOAT;else if(pp instanceof Uint16Array)if(hp.isFloat16BufferAttribute)if(np)xp=rp.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else xp=rp.UNSIGNED_SHORT;else if(pp instanceof Int16Array)xp=rp.SHORT;else if(pp instanceof Uint32Array)xp=rp.UNSIGNED_INT;else if(pp instanceof Int32Array)xp=rp.INT;else if(pp instanceof Int8Array)xp=rp.BYTE;else if(pp instanceof Uint8Array)xp=rp.UNSIGNED_BYTE;else if(pp instanceof Uint8ClampedArray)xp=rp.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+pp);return{buffer:yp,type:xp,bytesPerElement:pp.BYTES_PER_ELEMENT,version:hp.version,size:gp}}function lp(hp,fp,pp){const mp=fp.array,gp=fp._updateRange,yp=fp.updateRanges;if(rp.bindBuffer(pp,hp),gp.count===-1&&yp.length===0&&rp.bufferSubData(pp,0,mp),yp.length!==0){for(let xp=0,_p=yp.length;xp<_p;xp++){const vp=yp[xp];np?rp.bufferSubData(pp,vp.start*mp.BYTES_PER_ELEMENT,mp,vp.start,vp.count):rp.bufferSubData(pp,vp.start*mp.BYTES_PER_ELEMENT,mp.subarray(vp.start,vp.start+vp.count))}fp.clearUpdateRanges()}gp.count!==-1&&(np?rp.bufferSubData(pp,gp.offset*mp.BYTES_PER_ELEMENT,mp,gp.offset,gp.count):rp.bufferSubData(pp,gp.offset*mp.BYTES_PER_ELEMENT,mp.subarray(gp.offset,gp.offset+gp.count)),gp.count=-1),fp.onUploadCallback()}function up(hp){return hp.isInterleavedBufferAttribute&&(hp=hp.data),ap.get(hp)}function cp(hp){hp.isInterleavedBufferAttribute&&(hp=hp.data);const fp=ap.get(hp);fp&&(rp.deleteBuffer(fp.buffer),ap.delete(hp))}function dp(hp,fp){if(hp.isGLBufferAttribute){const mp=ap.get(hp);(!mp||mp.version<hp.version)&&ap.set(hp,{buffer:hp.buffer,type:hp.type,bytesPerElement:hp.elementSize,version:hp.version});return}hp.isInterleavedBufferAttribute&&(hp=hp.data);const pp=ap.get(hp);if(pp===void 0)ap.set(hp,sp(hp,fp));else if(pp.version<hp.version){if(pp.size!==hp.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");lp(pp.buffer,hp,fp),pp.version=hp.version}}return{get:up,remove:cp,update:dp}}class PlaneGeometry extends BufferGeometry{constructor(_d=1,np=1,ap=1,sp=1){super(),this.type="PlaneGeometry",this.parameters={width:_d,height:np,widthSegments:ap,heightSegments:sp};const lp=_d/2,up=np/2,cp=Math.floor(ap),dp=Math.floor(sp),hp=cp+1,fp=dp+1,pp=_d/cp,mp=np/dp,gp=[],yp=[],xp=[],_p=[];for(let vp=0;vp<fp;vp++){const bp=vp*mp-up;for(let Ep=0;Ep<hp;Ep++){const Sp=Ep*pp-lp;yp.push(Sp,-bp,0),xp.push(0,0,1),_p.push(Ep/cp),_p.push(1-vp/dp)}}for(let vp=0;vp<dp;vp++)for(let bp=0;bp<cp;bp++){const Ep=bp+hp*vp,Sp=bp+hp*(vp+1),Ap=bp+1+hp*(vp+1),Rp=bp+1+hp*vp;gp.push(Ep,Sp,Rp),gp.push(Sp,Ap,Rp)}this.setIndex(gp),this.setAttribute("position",new Float32BufferAttribute(yp,3)),this.setAttribute("normal",new Float32BufferAttribute(xp,3)),this.setAttribute("uv",new Float32BufferAttribute(_p,2))}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new PlaneGeometry(_d.width,_d.height,_d.widthSegments,_d.heightSegments)}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,batching_pars_vertex=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,batching_vertex=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_fragment=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,batching_pars_vertex,batching_vertex,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color(0)},specularColor:{value:new Color(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0};function WebGLBackground(rp,_d,np,ap,sp,lp,up){const cp=new Color(0);let dp=lp===!0?0:1,hp,fp,pp=null,mp=0,gp=null;function yp(_p,vp){let bp=!1,Ep=vp.isScene===!0?vp.background:null;Ep&&Ep.isTexture&&(Ep=(vp.backgroundBlurriness>0?np:_d).get(Ep)),Ep===null?xp(cp,dp):Ep&&Ep.isColor&&(xp(Ep,1),bp=!0);const Sp=rp.xr.getEnvironmentBlendMode();Sp==="additive"?ap.buffers.color.setClear(0,0,0,1,up):Sp==="alpha-blend"&&ap.buffers.color.setClear(0,0,0,0,up),(rp.autoClear||bp)&&rp.clear(rp.autoClearColor,rp.autoClearDepth,rp.autoClearStencil),Ep&&(Ep.isCubeTexture||Ep.mapping===CubeUVReflectionMapping)?(fp===void 0&&(fp=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),fp.geometry.deleteAttribute("normal"),fp.geometry.deleteAttribute("uv"),fp.onBeforeRender=function(Ap,Rp,Tp){this.matrixWorld.copyPosition(Tp.matrixWorld)},Object.defineProperty(fp.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),sp.update(fp)),fp.material.uniforms.envMap.value=Ep,fp.material.uniforms.flipEnvMap.value=Ep.isCubeTexture&&Ep.isRenderTargetTexture===!1?-1:1,fp.material.uniforms.backgroundBlurriness.value=vp.backgroundBlurriness,fp.material.uniforms.backgroundIntensity.value=vp.backgroundIntensity,fp.material.toneMapped=ColorManagement.getTransfer(Ep.colorSpace)!==SRGBTransfer,(pp!==Ep||mp!==Ep.version||gp!==rp.toneMapping)&&(fp.material.needsUpdate=!0,pp=Ep,mp=Ep.version,gp=rp.toneMapping),fp.layers.enableAll(),_p.unshift(fp,fp.geometry,fp.material,0,0,null)):Ep&&Ep.isTexture&&(hp===void 0&&(hp=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),hp.geometry.deleteAttribute("normal"),Object.defineProperty(hp.material,"map",{get:function(){return this.uniforms.t2D.value}}),sp.update(hp)),hp.material.uniforms.t2D.value=Ep,hp.material.uniforms.backgroundIntensity.value=vp.backgroundIntensity,hp.material.toneMapped=ColorManagement.getTransfer(Ep.colorSpace)!==SRGBTransfer,Ep.matrixAutoUpdate===!0&&Ep.updateMatrix(),hp.material.uniforms.uvTransform.value.copy(Ep.matrix),(pp!==Ep||mp!==Ep.version||gp!==rp.toneMapping)&&(hp.material.needsUpdate=!0,pp=Ep,mp=Ep.version,gp=rp.toneMapping),hp.layers.enableAll(),_p.unshift(hp,hp.geometry,hp.material,0,0,null))}function xp(_p,vp){_p.getRGB(_rgb,getUnlitUniformColorSpace(rp)),ap.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,vp,up)}return{getClearColor:function(){return cp},setClearColor:function(_p,vp=1){cp.set(_p),dp=vp,xp(cp,dp)},getClearAlpha:function(){return dp},setClearAlpha:function(_p){dp=_p,xp(cp,dp)},render:yp}}function WebGLBindingStates(rp,_d,np,ap){const sp=rp.getParameter(rp.MAX_VERTEX_ATTRIBS),lp=ap.isWebGL2?null:_d.get("OES_vertex_array_object"),up=ap.isWebGL2||lp!==null,cp={},dp=_p(null);let hp=dp,fp=!1;function pp(Fp,jp,Lp,Bp,Ip){let kp=!1;if(up){const Up=xp(Bp,Lp,jp);hp!==Up&&(hp=Up,gp(hp.object)),kp=vp(Fp,Bp,Lp,Ip),kp&&bp(Fp,Bp,Lp,Ip)}else{const Up=jp.wireframe===!0;(hp.geometry!==Bp.id||hp.program!==Lp.id||hp.wireframe!==Up)&&(hp.geometry=Bp.id,hp.program=Lp.id,hp.wireframe=Up,kp=!0)}Ip!==null&&np.update(Ip,rp.ELEMENT_ARRAY_BUFFER),(kp||fp)&&(fp=!1,Mp(Fp,jp,Lp,Bp),Ip!==null&&rp.bindBuffer(rp.ELEMENT_ARRAY_BUFFER,np.get(Ip).buffer))}function mp(){return ap.isWebGL2?rp.createVertexArray():lp.createVertexArrayOES()}function gp(Fp){return ap.isWebGL2?rp.bindVertexArray(Fp):lp.bindVertexArrayOES(Fp)}function yp(Fp){return ap.isWebGL2?rp.deleteVertexArray(Fp):lp.deleteVertexArrayOES(Fp)}function xp(Fp,jp,Lp){const Bp=Lp.wireframe===!0;let Ip=cp[Fp.id];Ip===void 0&&(Ip={},cp[Fp.id]=Ip);let kp=Ip[jp.id];kp===void 0&&(kp={},Ip[jp.id]=kp);let Up=kp[Bp];return Up===void 0&&(Up=_p(mp()),kp[Bp]=Up),Up}function _p(Fp){const jp=[],Lp=[],Bp=[];for(let Ip=0;Ip<sp;Ip++)jp[Ip]=0,Lp[Ip]=0,Bp[Ip]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:jp,enabledAttributes:Lp,attributeDivisors:Bp,object:Fp,attributes:{},index:null}}function vp(Fp,jp,Lp,Bp){const Ip=hp.attributes,kp=jp.attributes;let Up=0;const Gp=Lp.getAttributes();for(const Wp in Gp)if(Gp[Wp].location>=0){const Xp=Ip[Wp];let rm=kp[Wp];if(rm===void 0&&(Wp==="instanceMatrix"&&Fp.instanceMatrix&&(rm=Fp.instanceMatrix),Wp==="instanceColor"&&Fp.instanceColor&&(rm=Fp.instanceColor)),Xp===void 0||Xp.attribute!==rm||rm&&Xp.data!==rm.data)return!0;Up++}return hp.attributesNum!==Up||hp.index!==Bp}function bp(Fp,jp,Lp,Bp){const Ip={},kp=jp.attributes;let Up=0;const Gp=Lp.getAttributes();for(const Wp in Gp)if(Gp[Wp].location>=0){let Xp=kp[Wp];Xp===void 0&&(Wp==="instanceMatrix"&&Fp.instanceMatrix&&(Xp=Fp.instanceMatrix),Wp==="instanceColor"&&Fp.instanceColor&&(Xp=Fp.instanceColor));const rm={};rm.attribute=Xp,Xp&&Xp.data&&(rm.data=Xp.data),Ip[Wp]=rm,Up++}hp.attributes=Ip,hp.attributesNum=Up,hp.index=Bp}function Ep(){const Fp=hp.newAttributes;for(let jp=0,Lp=Fp.length;jp<Lp;jp++)Fp[jp]=0}function Sp(Fp){Ap(Fp,0)}function Ap(Fp,jp){const Lp=hp.newAttributes,Bp=hp.enabledAttributes,Ip=hp.attributeDivisors;Lp[Fp]=1,Bp[Fp]===0&&(rp.enableVertexAttribArray(Fp),Bp[Fp]=1),Ip[Fp]!==jp&&((ap.isWebGL2?rp:_d.get("ANGLE_instanced_arrays"))[ap.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Fp,jp),Ip[Fp]=jp)}function Rp(){const Fp=hp.newAttributes,jp=hp.enabledAttributes;for(let Lp=0,Bp=jp.length;Lp<Bp;Lp++)jp[Lp]!==Fp[Lp]&&(rp.disableVertexAttribArray(Lp),jp[Lp]=0)}function Tp(Fp,jp,Lp,Bp,Ip,kp,Up){Up===!0?rp.vertexAttribIPointer(Fp,jp,Lp,Ip,kp):rp.vertexAttribPointer(Fp,jp,Lp,Bp,Ip,kp)}function Mp(Fp,jp,Lp,Bp){if(ap.isWebGL2===!1&&(Fp.isInstancedMesh||Bp.isInstancedBufferGeometry)&&_d.get("ANGLE_instanced_arrays")===null)return;Ep();const Ip=Bp.attributes,kp=Lp.getAttributes(),Up=jp.defaultAttributeValues;for(const Gp in kp){const Wp=kp[Gp];if(Wp.location>=0){let Qp=Ip[Gp];if(Qp===void 0&&(Gp==="instanceMatrix"&&Fp.instanceMatrix&&(Qp=Fp.instanceMatrix),Gp==="instanceColor"&&Fp.instanceColor&&(Qp=Fp.instanceColor)),Qp!==void 0){const Xp=Qp.normalized,rm=Qp.itemSize,Kp=np.get(Qp);if(Kp===void 0)continue;const lm=Kp.buffer,cm=Kp.type,gm=Kp.bytesPerElement,Mm=ap.isWebGL2===!0&&(cm===rp.INT||cm===rp.UNSIGNED_INT||Qp.gpuType===IntType);if(Qp.isInterleavedBufferAttribute){const dm=Qp.data,em=dm.stride,sm=Qp.offset;if(dm.isInstancedInterleavedBuffer){for(let Zp=0;Zp<Wp.locationSize;Zp++)Ap(Wp.location+Zp,dm.meshPerAttribute);Fp.isInstancedMesh!==!0&&Bp._maxInstanceCount===void 0&&(Bp._maxInstanceCount=dm.meshPerAttribute*dm.count)}else for(let Zp=0;Zp<Wp.locationSize;Zp++)Sp(Wp.location+Zp);rp.bindBuffer(rp.ARRAY_BUFFER,lm);for(let Zp=0;Zp<Wp.locationSize;Zp++)Tp(Wp.location+Zp,rm/Wp.locationSize,cm,Xp,em*gm,(sm+rm/Wp.locationSize*Zp)*gm,Mm)}else{if(Qp.isInstancedBufferAttribute){for(let dm=0;dm<Wp.locationSize;dm++)Ap(Wp.location+dm,Qp.meshPerAttribute);Fp.isInstancedMesh!==!0&&Bp._maxInstanceCount===void 0&&(Bp._maxInstanceCount=Qp.meshPerAttribute*Qp.count)}else for(let dm=0;dm<Wp.locationSize;dm++)Sp(Wp.location+dm);rp.bindBuffer(rp.ARRAY_BUFFER,lm);for(let dm=0;dm<Wp.locationSize;dm++)Tp(Wp.location+dm,rm/Wp.locationSize,cm,Xp,rm*gm,rm/Wp.locationSize*dm*gm,Mm)}}else if(Up!==void 0){const Xp=Up[Gp];if(Xp!==void 0)switch(Xp.length){case 2:rp.vertexAttrib2fv(Wp.location,Xp);break;case 3:rp.vertexAttrib3fv(Wp.location,Xp);break;case 4:rp.vertexAttrib4fv(Wp.location,Xp);break;default:rp.vertexAttrib1fv(Wp.location,Xp)}}}}Rp()}function Op(){zp();for(const Fp in cp){const jp=cp[Fp];for(const Lp in jp){const Bp=jp[Lp];for(const Ip in Bp)yp(Bp[Ip].object),delete Bp[Ip];delete jp[Lp]}delete cp[Fp]}}function Pp(Fp){if(cp[Fp.id]===void 0)return;const jp=cp[Fp.id];for(const Lp in jp){const Bp=jp[Lp];for(const Ip in Bp)yp(Bp[Ip].object),delete Bp[Ip];delete jp[Lp]}delete cp[Fp.id]}function $p(Fp){for(const jp in cp){const Lp=cp[jp];if(Lp[Fp.id]===void 0)continue;const Bp=Lp[Fp.id];for(const Ip in Bp)yp(Bp[Ip].object),delete Bp[Ip];delete Lp[Fp.id]}}function zp(){Dp(),fp=!0,hp!==dp&&(hp=dp,gp(hp.object))}function Dp(){dp.geometry=null,dp.program=null,dp.wireframe=!1}return{setup:pp,reset:zp,resetDefaultState:Dp,dispose:Op,releaseStatesOfGeometry:Pp,releaseStatesOfProgram:$p,initAttributes:Ep,enableAttribute:Sp,disableUnusedAttributes:Rp}}function WebGLBufferRenderer(rp,_d,np,ap){const sp=ap.isWebGL2;let lp;function up(fp){lp=fp}function cp(fp,pp){rp.drawArrays(lp,fp,pp),np.update(pp,lp,1)}function dp(fp,pp,mp){if(mp===0)return;let gp,yp;if(sp)gp=rp,yp="drawArraysInstanced";else if(gp=_d.get("ANGLE_instanced_arrays"),yp="drawArraysInstancedANGLE",gp===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}gp[yp](lp,fp,pp,mp),np.update(pp,lp,mp)}function hp(fp,pp,mp){if(mp===0)return;const gp=_d.get("WEBGL_multi_draw");if(gp===null)for(let yp=0;yp<mp;yp++)this.render(fp[yp],pp[yp]);else{gp.multiDrawArraysWEBGL(lp,fp,0,pp,0,mp);let yp=0;for(let xp=0;xp<mp;xp++)yp+=pp[xp];np.update(yp,lp,1)}}this.setMode=up,this.render=cp,this.renderInstances=dp,this.renderMultiDraw=hp}function WebGLCapabilities(rp,_d,np){let ap;function sp(){if(ap!==void 0)return ap;if(_d.has("EXT_texture_filter_anisotropic")===!0){const Tp=_d.get("EXT_texture_filter_anisotropic");ap=rp.getParameter(Tp.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else ap=0;return ap}function lp(Tp){if(Tp==="highp"){if(rp.getShaderPrecisionFormat(rp.VERTEX_SHADER,rp.HIGH_FLOAT).precision>0&&rp.getShaderPrecisionFormat(rp.FRAGMENT_SHADER,rp.HIGH_FLOAT).precision>0)return"highp";Tp="mediump"}return Tp==="mediump"&&rp.getShaderPrecisionFormat(rp.VERTEX_SHADER,rp.MEDIUM_FLOAT).precision>0&&rp.getShaderPrecisionFormat(rp.FRAGMENT_SHADER,rp.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const up=typeof WebGL2RenderingContext<"u"&&rp.constructor.name==="WebGL2RenderingContext";let cp=np.precision!==void 0?np.precision:"highp";const dp=lp(cp);dp!==cp&&(console.warn("THREE.WebGLRenderer:",cp,"not supported, using",dp,"instead."),cp=dp);const hp=up||_d.has("WEBGL_draw_buffers"),fp=np.logarithmicDepthBuffer===!0,pp=rp.getParameter(rp.MAX_TEXTURE_IMAGE_UNITS),mp=rp.getParameter(rp.MAX_VERTEX_TEXTURE_IMAGE_UNITS),gp=rp.getParameter(rp.MAX_TEXTURE_SIZE),yp=rp.getParameter(rp.MAX_CUBE_MAP_TEXTURE_SIZE),xp=rp.getParameter(rp.MAX_VERTEX_ATTRIBS),_p=rp.getParameter(rp.MAX_VERTEX_UNIFORM_VECTORS),vp=rp.getParameter(rp.MAX_VARYING_VECTORS),bp=rp.getParameter(rp.MAX_FRAGMENT_UNIFORM_VECTORS),Ep=mp>0,Sp=up||_d.has("OES_texture_float"),Ap=Ep&&Sp,Rp=up?rp.getParameter(rp.MAX_SAMPLES):0;return{isWebGL2:up,drawBuffers:hp,getMaxAnisotropy:sp,getMaxPrecision:lp,precision:cp,logarithmicDepthBuffer:fp,maxTextures:pp,maxVertexTextures:mp,maxTextureSize:gp,maxCubemapSize:yp,maxAttributes:xp,maxVertexUniforms:_p,maxVaryings:vp,maxFragmentUniforms:bp,vertexTextures:Ep,floatFragmentTextures:Sp,floatVertexTextures:Ap,maxSamples:Rp}}function WebGLClipping(rp){const _d=this;let np=null,ap=0,sp=!1,lp=!1;const up=new Plane,cp=new Matrix3,dp={value:null,needsUpdate:!1};this.uniform=dp,this.numPlanes=0,this.numIntersection=0,this.init=function(pp,mp){const gp=pp.length!==0||mp||ap!==0||sp;return sp=mp,ap=pp.length,gp},this.beginShadows=function(){lp=!0,fp(null)},this.endShadows=function(){lp=!1},this.setGlobalState=function(pp,mp){np=fp(pp,mp,0)},this.setState=function(pp,mp,gp){const yp=pp.clippingPlanes,xp=pp.clipIntersection,_p=pp.clipShadows,vp=rp.get(pp);if(!sp||yp===null||yp.length===0||lp&&!_p)lp?fp(null):hp();else{const bp=lp?0:ap,Ep=bp*4;let Sp=vp.clippingState||null;dp.value=Sp,Sp=fp(yp,mp,Ep,gp);for(let Ap=0;Ap!==Ep;++Ap)Sp[Ap]=np[Ap];vp.clippingState=Sp,this.numIntersection=xp?this.numPlanes:0,this.numPlanes+=bp}};function hp(){dp.value!==np&&(dp.value=np,dp.needsUpdate=ap>0),_d.numPlanes=ap,_d.numIntersection=0}function fp(pp,mp,gp,yp){const xp=pp!==null?pp.length:0;let _p=null;if(xp!==0){if(_p=dp.value,yp!==!0||_p===null){const vp=gp+xp*4,bp=mp.matrixWorldInverse;cp.getNormalMatrix(bp),(_p===null||_p.length<vp)&&(_p=new Float32Array(vp));for(let Ep=0,Sp=gp;Ep!==xp;++Ep,Sp+=4)up.copy(pp[Ep]).applyMatrix4(bp,cp),up.normal.toArray(_p,Sp),_p[Sp+3]=up.constant}dp.value=_p,dp.needsUpdate=!0}return _d.numPlanes=xp,_d.numIntersection=0,_p}}function WebGLCubeMaps(rp){let _d=new WeakMap;function np(up,cp){return cp===EquirectangularReflectionMapping?up.mapping=CubeReflectionMapping:cp===EquirectangularRefractionMapping&&(up.mapping=CubeRefractionMapping),up}function ap(up){if(up&&up.isTexture){const cp=up.mapping;if(cp===EquirectangularReflectionMapping||cp===EquirectangularRefractionMapping)if(_d.has(up)){const dp=_d.get(up).texture;return np(dp,up.mapping)}else{const dp=up.image;if(dp&&dp.height>0){const hp=new WebGLCubeRenderTarget(dp.height);return hp.fromEquirectangularTexture(rp,up),_d.set(up,hp),up.addEventListener("dispose",sp),np(hp.texture,up.mapping)}else return null}}return up}function sp(up){const cp=up.target;cp.removeEventListener("dispose",sp);const dp=_d.get(cp);dp!==void 0&&(_d.delete(cp),dp.dispose())}function lp(){_d=new WeakMap}return{get:ap,dispose:lp}}class OrthographicCamera extends Camera{constructor(_d=-1,np=1,ap=1,sp=-1,lp=.1,up=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_d,this.right=np,this.top=ap,this.bottom=sp,this.near=lp,this.far=up,this.updateProjectionMatrix()}copy(_d,np){return super.copy(_d,np),this.left=_d.left,this.right=_d.right,this.top=_d.top,this.bottom=_d.bottom,this.near=_d.near,this.far=_d.far,this.zoom=_d.zoom,this.view=_d.view===null?null:Object.assign({},_d.view),this}setViewOffset(_d,np,ap,sp,lp,up){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_d,this.view.fullHeight=np,this.view.offsetX=ap,this.view.offsetY=sp,this.view.width=lp,this.view.height=up,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _d=(this.right-this.left)/(2*this.zoom),np=(this.top-this.bottom)/(2*this.zoom),ap=(this.right+this.left)/2,sp=(this.top+this.bottom)/2;let lp=ap-_d,up=ap+_d,cp=sp+np,dp=sp-np;if(this.view!==null&&this.view.enabled){const hp=(this.right-this.left)/this.view.fullWidth/this.zoom,fp=(this.top-this.bottom)/this.view.fullHeight/this.zoom;lp+=hp*this.view.offsetX,up=lp+hp*this.view.width,cp-=fp*this.view.offsetY,dp=cp-fp*this.view.height}this.projectionMatrix.makeOrthographic(lp,up,cp,dp,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_d){const np=super.toJSON(_d);return np.object.zoom=this.zoom,np.object.left=this.left,np.object.right=this.right,np.object.top=this.top,np.object.bottom=this.bottom,np.object.near=this.near,np.object.far=this.far,this.view!==null&&(np.object.view=Object.assign({},this.view)),np}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera,_clearColor=new Color;let _oldTarget=null,_oldActiveCubeFace=0,_oldActiveMipmapLevel=0;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)];class PMREMGenerator{constructor(_d){this._renderer=_d,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_d,np=0,ap=.1,sp=100){_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),this._setSize(256);const lp=this._allocateTargets();return lp.depthBuffer=!0,this._sceneToCubeUV(_d,ap,sp,lp),np>0&&this._blur(lp,0,0,np),this._applyPMREM(lp),this._cleanup(lp),lp}fromEquirectangular(_d,np=null){return this._fromTexture(_d,np)}fromCubemap(_d,np=null){return this._fromTexture(_d,np)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_d){this._lodMax=Math.floor(Math.log2(_d)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _d=0;_d<this._lodPlanes.length;_d++)this._lodPlanes[_d].dispose()}_cleanup(_d){this._renderer.setRenderTarget(_oldTarget,_oldActiveCubeFace,_oldActiveMipmapLevel),_d.scissorTest=!1,_setViewport(_d,0,0,_d.width,_d.height)}_fromTexture(_d,np){_d.mapping===CubeReflectionMapping||_d.mapping===CubeRefractionMapping?this._setSize(_d.image.length===0?16:_d.image[0].width||_d.image[0].image.width):this._setSize(_d.image.width/4),_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel();const ap=np||this._allocateTargets();return this._textureToCubeUV(_d,ap),this._applyPMREM(ap),this._cleanup(ap),ap}_allocateTargets(){const _d=3*Math.max(this._cubeSize,112),np=4*this._cubeSize,ap={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace$1,depthBuffer:!1},sp=_createRenderTarget(_d,np,ap);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_d||this._pingPongRenderTarget.height!==np){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(_d,np,ap);const{_lodMax:lp}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(lp)),this._blurMaterial=_getBlurShader(lp,_d,np)}return sp}_compileMaterial(_d){const np=new Mesh(this._lodPlanes[0],_d);this._renderer.compile(np,_flatCamera)}_sceneToCubeUV(_d,np,ap,sp){const cp=new PerspectiveCamera$1(90,1,np,ap),dp=[1,-1,1,1,1,1],hp=[1,1,1,-1,-1,-1],fp=this._renderer,pp=fp.autoClear,mp=fp.toneMapping;fp.getClearColor(_clearColor),fp.toneMapping=NoToneMapping,fp.autoClear=!1;const gp=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),yp=new Mesh(new BoxGeometry,gp);let xp=!1;const _p=_d.background;_p?_p.isColor&&(gp.color.copy(_p),_d.background=null,xp=!0):(gp.color.copy(_clearColor),xp=!0);for(let vp=0;vp<6;vp++){const bp=vp%3;bp===0?(cp.up.set(0,dp[vp],0),cp.lookAt(hp[vp],0,0)):bp===1?(cp.up.set(0,0,dp[vp]),cp.lookAt(0,hp[vp],0)):(cp.up.set(0,dp[vp],0),cp.lookAt(0,0,hp[vp]));const Ep=this._cubeSize;_setViewport(sp,bp*Ep,vp>2?Ep:0,Ep,Ep),fp.setRenderTarget(sp),xp&&fp.render(yp,cp),fp.render(_d,cp)}yp.geometry.dispose(),yp.material.dispose(),fp.toneMapping=mp,fp.autoClear=pp,_d.background=_p}_textureToCubeUV(_d,np){const ap=this._renderer,sp=_d.mapping===CubeReflectionMapping||_d.mapping===CubeRefractionMapping;sp?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=_d.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const lp=sp?this._cubemapMaterial:this._equirectMaterial,up=new Mesh(this._lodPlanes[0],lp),cp=lp.uniforms;cp.envMap.value=_d;const dp=this._cubeSize;_setViewport(np,0,0,3*dp,2*dp),ap.setRenderTarget(np),ap.render(up,_flatCamera)}_applyPMREM(_d){const np=this._renderer,ap=np.autoClear;np.autoClear=!1;for(let sp=1;sp<this._lodPlanes.length;sp++){const lp=Math.sqrt(this._sigmas[sp]*this._sigmas[sp]-this._sigmas[sp-1]*this._sigmas[sp-1]),up=_axisDirections[(sp-1)%_axisDirections.length];this._blur(_d,sp-1,sp,lp,up)}np.autoClear=ap}_blur(_d,np,ap,sp,lp){const up=this._pingPongRenderTarget;this._halfBlur(_d,up,np,ap,sp,"latitudinal",lp),this._halfBlur(up,_d,ap,ap,sp,"longitudinal",lp)}_halfBlur(_d,np,ap,sp,lp,up,cp){const dp=this._renderer,hp=this._blurMaterial;up!=="latitudinal"&&up!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const fp=3,pp=new Mesh(this._lodPlanes[sp],hp),mp=hp.uniforms,gp=this._sizeLods[ap]-1,yp=isFinite(lp)?Math.PI/(2*gp):2*Math.PI/(2*MAX_SAMPLES-1),xp=lp/yp,_p=isFinite(lp)?1+Math.floor(fp*xp):MAX_SAMPLES;_p>MAX_SAMPLES&&console.warn(`sigmaRadians, ${lp}, is too large and will clip, as it requested ${_p} samples when the maximum is set to ${MAX_SAMPLES}`);const vp=[];let bp=0;for(let Tp=0;Tp<MAX_SAMPLES;++Tp){const Mp=Tp/xp,Op=Math.exp(-Mp*Mp/2);vp.push(Op),Tp===0?bp+=Op:Tp<_p&&(bp+=2*Op)}for(let Tp=0;Tp<vp.length;Tp++)vp[Tp]=vp[Tp]/bp;mp.envMap.value=_d.texture,mp.samples.value=_p,mp.weights.value=vp,mp.latitudinal.value=up==="latitudinal",cp&&(mp.poleAxis.value=cp);const{_lodMax:Ep}=this;mp.dTheta.value=yp,mp.mipInt.value=Ep-ap;const Sp=this._sizeLods[sp],Ap=3*Sp*(sp>Ep-LOD_MIN?sp-Ep+LOD_MIN:0),Rp=4*(this._cubeSize-Sp);_setViewport(np,Ap,Rp,3*Sp,2*Sp),dp.setRenderTarget(np),dp.render(pp,_flatCamera)}}function _createPlanes(rp){const _d=[],np=[],ap=[];let sp=rp;const lp=rp-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let up=0;up<lp;up++){const cp=Math.pow(2,sp);np.push(cp);let dp=1/cp;up>rp-LOD_MIN?dp=EXTRA_LOD_SIGMA[up-rp+LOD_MIN-1]:up===0&&(dp=0),ap.push(dp);const hp=1/(cp-2),fp=-hp,pp=1+hp,mp=[fp,fp,pp,fp,pp,pp,fp,fp,pp,pp,fp,pp],gp=6,yp=6,xp=3,_p=2,vp=1,bp=new Float32Array(xp*yp*gp),Ep=new Float32Array(_p*yp*gp),Sp=new Float32Array(vp*yp*gp);for(let Rp=0;Rp<gp;Rp++){const Tp=Rp%3*2/3-1,Mp=Rp>2?0:-1,Op=[Tp,Mp,0,Tp+2/3,Mp,0,Tp+2/3,Mp+1,0,Tp,Mp,0,Tp+2/3,Mp+1,0,Tp,Mp+1,0];bp.set(Op,xp*yp*Rp),Ep.set(mp,_p*yp*Rp);const Pp=[Rp,Rp,Rp,Rp,Rp,Rp];Sp.set(Pp,vp*yp*Rp)}const Ap=new BufferGeometry;Ap.setAttribute("position",new BufferAttribute(bp,xp)),Ap.setAttribute("uv",new BufferAttribute(Ep,_p)),Ap.setAttribute("faceIndex",new BufferAttribute(Sp,vp)),_d.push(Ap),sp>LOD_MIN&&sp--}return{lodPlanes:_d,sizeLods:np,sigmas:ap}}function _createRenderTarget(rp,_d,np){const ap=new WebGLRenderTarget(rp,_d,np);return ap.texture.mapping=CubeUVReflectionMapping,ap.texture.name="PMREM.cubeUv",ap.scissorTest=!0,ap}function _setViewport(rp,_d,np,ap,sp){rp.viewport.set(_d,np,ap,sp),rp.scissor.set(_d,np,ap,sp)}function _getBlurShader(rp,_d,np){const ap=new Float32Array(MAX_SAMPLES),sp=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/_d,CUBEUV_TEXEL_HEIGHT:1/np,CUBEUV_MAX_MIP:`${rp}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:ap},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:sp}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(rp){let _d=new WeakMap,np=null;function ap(cp){if(cp&&cp.isTexture){const dp=cp.mapping,hp=dp===EquirectangularReflectionMapping||dp===EquirectangularRefractionMapping,fp=dp===CubeReflectionMapping||dp===CubeRefractionMapping;if(hp||fp)if(cp.isRenderTargetTexture&&cp.needsPMREMUpdate===!0){cp.needsPMREMUpdate=!1;let pp=_d.get(cp);return np===null&&(np=new PMREMGenerator(rp)),pp=hp?np.fromEquirectangular(cp,pp):np.fromCubemap(cp,pp),_d.set(cp,pp),pp.texture}else{if(_d.has(cp))return _d.get(cp).texture;{const pp=cp.image;if(hp&&pp&&pp.height>0||fp&&pp&&sp(pp)){np===null&&(np=new PMREMGenerator(rp));const mp=hp?np.fromEquirectangular(cp):np.fromCubemap(cp);return _d.set(cp,mp),cp.addEventListener("dispose",lp),mp.texture}else return null}}}return cp}function sp(cp){let dp=0;const hp=6;for(let fp=0;fp<hp;fp++)cp[fp]!==void 0&&dp++;return dp===hp}function lp(cp){const dp=cp.target;dp.removeEventListener("dispose",lp);const hp=_d.get(dp);hp!==void 0&&(_d.delete(dp),hp.dispose())}function up(){_d=new WeakMap,np!==null&&(np.dispose(),np=null)}return{get:ap,dispose:up}}function WebGLExtensions(rp){const _d={};function np(ap){if(_d[ap]!==void 0)return _d[ap];let sp;switch(ap){case"WEBGL_depth_texture":sp=rp.getExtension("WEBGL_depth_texture")||rp.getExtension("MOZ_WEBGL_depth_texture")||rp.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":sp=rp.getExtension("EXT_texture_filter_anisotropic")||rp.getExtension("MOZ_EXT_texture_filter_anisotropic")||rp.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":sp=rp.getExtension("WEBGL_compressed_texture_s3tc")||rp.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||rp.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":sp=rp.getExtension("WEBGL_compressed_texture_pvrtc")||rp.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:sp=rp.getExtension(ap)}return _d[ap]=sp,sp}return{has:function(ap){return np(ap)!==null},init:function(ap){ap.isWebGL2?(np("EXT_color_buffer_float"),np("WEBGL_clip_cull_distance")):(np("WEBGL_depth_texture"),np("OES_texture_float"),np("OES_texture_half_float"),np("OES_texture_half_float_linear"),np("OES_standard_derivatives"),np("OES_element_index_uint"),np("OES_vertex_array_object"),np("ANGLE_instanced_arrays")),np("OES_texture_float_linear"),np("EXT_color_buffer_half_float"),np("WEBGL_multisampled_render_to_texture")},get:function(ap){const sp=np(ap);return sp===null&&console.warn("THREE.WebGLRenderer: "+ap+" extension not supported."),sp}}}function WebGLGeometries(rp,_d,np,ap){const sp={},lp=new WeakMap;function up(pp){const mp=pp.target;mp.index!==null&&_d.remove(mp.index);for(const yp in mp.attributes)_d.remove(mp.attributes[yp]);for(const yp in mp.morphAttributes){const xp=mp.morphAttributes[yp];for(let _p=0,vp=xp.length;_p<vp;_p++)_d.remove(xp[_p])}mp.removeEventListener("dispose",up),delete sp[mp.id];const gp=lp.get(mp);gp&&(_d.remove(gp),lp.delete(mp)),ap.releaseStatesOfGeometry(mp),mp.isInstancedBufferGeometry===!0&&delete mp._maxInstanceCount,np.memory.geometries--}function cp(pp,mp){return sp[mp.id]===!0||(mp.addEventListener("dispose",up),sp[mp.id]=!0,np.memory.geometries++),mp}function dp(pp){const mp=pp.attributes;for(const yp in mp)_d.update(mp[yp],rp.ARRAY_BUFFER);const gp=pp.morphAttributes;for(const yp in gp){const xp=gp[yp];for(let _p=0,vp=xp.length;_p<vp;_p++)_d.update(xp[_p],rp.ARRAY_BUFFER)}}function hp(pp){const mp=[],gp=pp.index,yp=pp.attributes.position;let xp=0;if(gp!==null){const bp=gp.array;xp=gp.version;for(let Ep=0,Sp=bp.length;Ep<Sp;Ep+=3){const Ap=bp[Ep+0],Rp=bp[Ep+1],Tp=bp[Ep+2];mp.push(Ap,Rp,Rp,Tp,Tp,Ap)}}else if(yp!==void 0){const bp=yp.array;xp=yp.version;for(let Ep=0,Sp=bp.length/3-1;Ep<Sp;Ep+=3){const Ap=Ep+0,Rp=Ep+1,Tp=Ep+2;mp.push(Ap,Rp,Rp,Tp,Tp,Ap)}}else return;const _p=new(arrayNeedsUint32(mp)?Uint32BufferAttribute:Uint16BufferAttribute)(mp,1);_p.version=xp;const vp=lp.get(pp);vp&&_d.remove(vp),lp.set(pp,_p)}function fp(pp){const mp=lp.get(pp);if(mp){const gp=pp.index;gp!==null&&mp.version<gp.version&&hp(pp)}else hp(pp);return lp.get(pp)}return{get:cp,update:dp,getWireframeAttribute:fp}}function WebGLIndexedBufferRenderer(rp,_d,np,ap){const sp=ap.isWebGL2;let lp;function up(gp){lp=gp}let cp,dp;function hp(gp){cp=gp.type,dp=gp.bytesPerElement}function fp(gp,yp){rp.drawElements(lp,yp,cp,gp*dp),np.update(yp,lp,1)}function pp(gp,yp,xp){if(xp===0)return;let _p,vp;if(sp)_p=rp,vp="drawElementsInstanced";else if(_p=_d.get("ANGLE_instanced_arrays"),vp="drawElementsInstancedANGLE",_p===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_p[vp](lp,yp,cp,gp*dp,xp),np.update(yp,lp,xp)}function mp(gp,yp,xp){if(xp===0)return;const _p=_d.get("WEBGL_multi_draw");if(_p===null)for(let vp=0;vp<xp;vp++)this.render(gp[vp]/dp,yp[vp]);else{_p.multiDrawElementsWEBGL(lp,yp,0,cp,gp,0,xp);let vp=0;for(let bp=0;bp<xp;bp++)vp+=yp[bp];np.update(vp,lp,1)}}this.setMode=up,this.setIndex=hp,this.render=fp,this.renderInstances=pp,this.renderMultiDraw=mp}function WebGLInfo(rp){const _d={geometries:0,textures:0},np={frame:0,calls:0,triangles:0,points:0,lines:0};function ap(lp,up,cp){switch(np.calls++,up){case rp.TRIANGLES:np.triangles+=cp*(lp/3);break;case rp.LINES:np.lines+=cp*(lp/2);break;case rp.LINE_STRIP:np.lines+=cp*(lp-1);break;case rp.LINE_LOOP:np.lines+=cp*lp;break;case rp.POINTS:np.points+=cp*lp;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",up);break}}function sp(){np.calls=0,np.triangles=0,np.points=0,np.lines=0}return{memory:_d,render:np,programs:null,autoReset:!0,reset:sp,update:ap}}function numericalSort(rp,_d){return rp[0]-_d[0]}function absNumericalSort(rp,_d){return Math.abs(_d[1])-Math.abs(rp[1])}function WebGLMorphtargets(rp,_d,np){const ap={},sp=new Float32Array(8),lp=new WeakMap,up=new Vector4,cp=[];for(let hp=0;hp<8;hp++)cp[hp]=[hp,0];function dp(hp,fp,pp){const mp=hp.morphTargetInfluences;if(_d.isWebGL2===!0){const yp=fp.morphAttributes.position||fp.morphAttributes.normal||fp.morphAttributes.color,xp=yp!==void 0?yp.length:0;let _p=lp.get(fp);if(_p===void 0||_p.count!==xp){let jp=function(){Dp.dispose(),lp.delete(fp),fp.removeEventListener("dispose",jp)};var gp=jp;_p!==void 0&&_p.texture.dispose();const Ep=fp.morphAttributes.position!==void 0,Sp=fp.morphAttributes.normal!==void 0,Ap=fp.morphAttributes.color!==void 0,Rp=fp.morphAttributes.position||[],Tp=fp.morphAttributes.normal||[],Mp=fp.morphAttributes.color||[];let Op=0;Ep===!0&&(Op=1),Sp===!0&&(Op=2),Ap===!0&&(Op=3);let Pp=fp.attributes.position.count*Op,$p=1;Pp>_d.maxTextureSize&&($p=Math.ceil(Pp/_d.maxTextureSize),Pp=_d.maxTextureSize);const zp=new Float32Array(Pp*$p*4*xp),Dp=new DataArrayTexture(zp,Pp,$p,xp);Dp.type=FloatType,Dp.needsUpdate=!0;const Fp=Op*4;for(let Lp=0;Lp<xp;Lp++){const Bp=Rp[Lp],Ip=Tp[Lp],kp=Mp[Lp],Up=Pp*$p*4*Lp;for(let Gp=0;Gp<Bp.count;Gp++){const Wp=Gp*Fp;Ep===!0&&(up.fromBufferAttribute(Bp,Gp),zp[Up+Wp+0]=up.x,zp[Up+Wp+1]=up.y,zp[Up+Wp+2]=up.z,zp[Up+Wp+3]=0),Sp===!0&&(up.fromBufferAttribute(Ip,Gp),zp[Up+Wp+4]=up.x,zp[Up+Wp+5]=up.y,zp[Up+Wp+6]=up.z,zp[Up+Wp+7]=0),Ap===!0&&(up.fromBufferAttribute(kp,Gp),zp[Up+Wp+8]=up.x,zp[Up+Wp+9]=up.y,zp[Up+Wp+10]=up.z,zp[Up+Wp+11]=kp.itemSize===4?up.w:1)}}_p={count:xp,texture:Dp,size:new Vector2(Pp,$p)},lp.set(fp,_p),fp.addEventListener("dispose",jp)}let vp=0;for(let Ep=0;Ep<mp.length;Ep++)vp+=mp[Ep];const bp=fp.morphTargetsRelative?1:1-vp;pp.getUniforms().setValue(rp,"morphTargetBaseInfluence",bp),pp.getUniforms().setValue(rp,"morphTargetInfluences",mp),pp.getUniforms().setValue(rp,"morphTargetsTexture",_p.texture,np),pp.getUniforms().setValue(rp,"morphTargetsTextureSize",_p.size)}else{const yp=mp===void 0?0:mp.length;let xp=ap[fp.id];if(xp===void 0||xp.length!==yp){xp=[];for(let Sp=0;Sp<yp;Sp++)xp[Sp]=[Sp,0];ap[fp.id]=xp}for(let Sp=0;Sp<yp;Sp++){const Ap=xp[Sp];Ap[0]=Sp,Ap[1]=mp[Sp]}xp.sort(absNumericalSort);for(let Sp=0;Sp<8;Sp++)Sp<yp&&xp[Sp][1]?(cp[Sp][0]=xp[Sp][0],cp[Sp][1]=xp[Sp][1]):(cp[Sp][0]=Number.MAX_SAFE_INTEGER,cp[Sp][1]=0);cp.sort(numericalSort);const _p=fp.morphAttributes.position,vp=fp.morphAttributes.normal;let bp=0;for(let Sp=0;Sp<8;Sp++){const Ap=cp[Sp],Rp=Ap[0],Tp=Ap[1];Rp!==Number.MAX_SAFE_INTEGER&&Tp?(_p&&fp.getAttribute("morphTarget"+Sp)!==_p[Rp]&&fp.setAttribute("morphTarget"+Sp,_p[Rp]),vp&&fp.getAttribute("morphNormal"+Sp)!==vp[Rp]&&fp.setAttribute("morphNormal"+Sp,vp[Rp]),sp[Sp]=Tp,bp+=Tp):(_p&&fp.hasAttribute("morphTarget"+Sp)===!0&&fp.deleteAttribute("morphTarget"+Sp),vp&&fp.hasAttribute("morphNormal"+Sp)===!0&&fp.deleteAttribute("morphNormal"+Sp),sp[Sp]=0)}const Ep=fp.morphTargetsRelative?1:1-bp;pp.getUniforms().setValue(rp,"morphTargetBaseInfluence",Ep),pp.getUniforms().setValue(rp,"morphTargetInfluences",sp)}}return{update:dp}}function WebGLObjects(rp,_d,np,ap){let sp=new WeakMap;function lp(dp){const hp=ap.render.frame,fp=dp.geometry,pp=_d.get(dp,fp);if(sp.get(pp)!==hp&&(_d.update(pp),sp.set(pp,hp)),dp.isInstancedMesh&&(dp.hasEventListener("dispose",cp)===!1&&dp.addEventListener("dispose",cp),sp.get(dp)!==hp&&(np.update(dp.instanceMatrix,rp.ARRAY_BUFFER),dp.instanceColor!==null&&np.update(dp.instanceColor,rp.ARRAY_BUFFER),sp.set(dp,hp))),dp.isSkinnedMesh){const mp=dp.skeleton;sp.get(mp)!==hp&&(mp.update(),sp.set(mp,hp))}return pp}function up(){sp=new WeakMap}function cp(dp){const hp=dp.target;hp.removeEventListener("dispose",cp),np.remove(hp.instanceMatrix),hp.instanceColor!==null&&np.remove(hp.instanceColor)}return{update:lp,dispose:up}}class DepthTexture extends Texture{constructor(_d,np,ap,sp,lp,up,cp,dp,hp,fp){if(fp=fp!==void 0?fp:DepthFormat,fp!==DepthFormat&&fp!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");ap===void 0&&fp===DepthFormat&&(ap=UnsignedIntType),ap===void 0&&fp===DepthStencilFormat&&(ap=UnsignedInt248Type),super(null,sp,lp,up,cp,dp,fp,ap,hp),this.isDepthTexture=!0,this.image={width:_d,height:np},this.magFilter=cp!==void 0?cp:NearestFilter,this.minFilter=dp!==void 0?dp:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(_d){return super.copy(_d),this.compareFunction=_d.compareFunction,this}toJSON(_d){const np=super.toJSON(_d);return this.compareFunction!==null&&(np.compareFunction=this.compareFunction),np}}const emptyTexture=new Texture,emptyShadowTexture=new DepthTexture(1,1);emptyShadowTexture.compareFunction=LessEqualCompare;const emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(rp,_d,np){const ap=rp[0];if(ap<=0||ap>0)return rp;const sp=_d*np;let lp=arrayCacheF32[sp];if(lp===void 0&&(lp=new Float32Array(sp),arrayCacheF32[sp]=lp),_d!==0){ap.toArray(lp,0);for(let up=1,cp=0;up!==_d;++up)cp+=np,rp[up].toArray(lp,cp)}return lp}function arraysEqual(rp,_d){if(rp.length!==_d.length)return!1;for(let np=0,ap=rp.length;np<ap;np++)if(rp[np]!==_d[np])return!1;return!0}function copyArray(rp,_d){for(let np=0,ap=_d.length;np<ap;np++)rp[np]=_d[np]}function allocTexUnits(rp,_d){let np=arrayCacheI32[_d];np===void 0&&(np=new Int32Array(_d),arrayCacheI32[_d]=np);for(let ap=0;ap!==_d;++ap)np[ap]=rp.allocateTextureUnit();return np}function setValueV1f(rp,_d){const np=this.cache;np[0]!==_d&&(rp.uniform1f(this.addr,_d),np[0]=_d)}function setValueV2f(rp,_d){const np=this.cache;if(_d.x!==void 0)(np[0]!==_d.x||np[1]!==_d.y)&&(rp.uniform2f(this.addr,_d.x,_d.y),np[0]=_d.x,np[1]=_d.y);else{if(arraysEqual(np,_d))return;rp.uniform2fv(this.addr,_d),copyArray(np,_d)}}function setValueV3f(rp,_d){const np=this.cache;if(_d.x!==void 0)(np[0]!==_d.x||np[1]!==_d.y||np[2]!==_d.z)&&(rp.uniform3f(this.addr,_d.x,_d.y,_d.z),np[0]=_d.x,np[1]=_d.y,np[2]=_d.z);else if(_d.r!==void 0)(np[0]!==_d.r||np[1]!==_d.g||np[2]!==_d.b)&&(rp.uniform3f(this.addr,_d.r,_d.g,_d.b),np[0]=_d.r,np[1]=_d.g,np[2]=_d.b);else{if(arraysEqual(np,_d))return;rp.uniform3fv(this.addr,_d),copyArray(np,_d)}}function setValueV4f(rp,_d){const np=this.cache;if(_d.x!==void 0)(np[0]!==_d.x||np[1]!==_d.y||np[2]!==_d.z||np[3]!==_d.w)&&(rp.uniform4f(this.addr,_d.x,_d.y,_d.z,_d.w),np[0]=_d.x,np[1]=_d.y,np[2]=_d.z,np[3]=_d.w);else{if(arraysEqual(np,_d))return;rp.uniform4fv(this.addr,_d),copyArray(np,_d)}}function setValueM2(rp,_d){const np=this.cache,ap=_d.elements;if(ap===void 0){if(arraysEqual(np,_d))return;rp.uniformMatrix2fv(this.addr,!1,_d),copyArray(np,_d)}else{if(arraysEqual(np,ap))return;mat2array.set(ap),rp.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(np,ap)}}function setValueM3(rp,_d){const np=this.cache,ap=_d.elements;if(ap===void 0){if(arraysEqual(np,_d))return;rp.uniformMatrix3fv(this.addr,!1,_d),copyArray(np,_d)}else{if(arraysEqual(np,ap))return;mat3array.set(ap),rp.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(np,ap)}}function setValueM4(rp,_d){const np=this.cache,ap=_d.elements;if(ap===void 0){if(arraysEqual(np,_d))return;rp.uniformMatrix4fv(this.addr,!1,_d),copyArray(np,_d)}else{if(arraysEqual(np,ap))return;mat4array.set(ap),rp.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(np,ap)}}function setValueV1i(rp,_d){const np=this.cache;np[0]!==_d&&(rp.uniform1i(this.addr,_d),np[0]=_d)}function setValueV2i(rp,_d){const np=this.cache;if(_d.x!==void 0)(np[0]!==_d.x||np[1]!==_d.y)&&(rp.uniform2i(this.addr,_d.x,_d.y),np[0]=_d.x,np[1]=_d.y);else{if(arraysEqual(np,_d))return;rp.uniform2iv(this.addr,_d),copyArray(np,_d)}}function setValueV3i(rp,_d){const np=this.cache;if(_d.x!==void 0)(np[0]!==_d.x||np[1]!==_d.y||np[2]!==_d.z)&&(rp.uniform3i(this.addr,_d.x,_d.y,_d.z),np[0]=_d.x,np[1]=_d.y,np[2]=_d.z);else{if(arraysEqual(np,_d))return;rp.uniform3iv(this.addr,_d),copyArray(np,_d)}}function setValueV4i(rp,_d){const np=this.cache;if(_d.x!==void 0)(np[0]!==_d.x||np[1]!==_d.y||np[2]!==_d.z||np[3]!==_d.w)&&(rp.uniform4i(this.addr,_d.x,_d.y,_d.z,_d.w),np[0]=_d.x,np[1]=_d.y,np[2]=_d.z,np[3]=_d.w);else{if(arraysEqual(np,_d))return;rp.uniform4iv(this.addr,_d),copyArray(np,_d)}}function setValueV1ui(rp,_d){const np=this.cache;np[0]!==_d&&(rp.uniform1ui(this.addr,_d),np[0]=_d)}function setValueV2ui(rp,_d){const np=this.cache;if(_d.x!==void 0)(np[0]!==_d.x||np[1]!==_d.y)&&(rp.uniform2ui(this.addr,_d.x,_d.y),np[0]=_d.x,np[1]=_d.y);else{if(arraysEqual(np,_d))return;rp.uniform2uiv(this.addr,_d),copyArray(np,_d)}}function setValueV3ui(rp,_d){const np=this.cache;if(_d.x!==void 0)(np[0]!==_d.x||np[1]!==_d.y||np[2]!==_d.z)&&(rp.uniform3ui(this.addr,_d.x,_d.y,_d.z),np[0]=_d.x,np[1]=_d.y,np[2]=_d.z);else{if(arraysEqual(np,_d))return;rp.uniform3uiv(this.addr,_d),copyArray(np,_d)}}function setValueV4ui(rp,_d){const np=this.cache;if(_d.x!==void 0)(np[0]!==_d.x||np[1]!==_d.y||np[2]!==_d.z||np[3]!==_d.w)&&(rp.uniform4ui(this.addr,_d.x,_d.y,_d.z,_d.w),np[0]=_d.x,np[1]=_d.y,np[2]=_d.z,np[3]=_d.w);else{if(arraysEqual(np,_d))return;rp.uniform4uiv(this.addr,_d),copyArray(np,_d)}}function setValueT1(rp,_d,np){const ap=this.cache,sp=np.allocateTextureUnit();ap[0]!==sp&&(rp.uniform1i(this.addr,sp),ap[0]=sp);const lp=this.type===rp.SAMPLER_2D_SHADOW?emptyShadowTexture:emptyTexture;np.setTexture2D(_d||lp,sp)}function setValueT3D1(rp,_d,np){const ap=this.cache,sp=np.allocateTextureUnit();ap[0]!==sp&&(rp.uniform1i(this.addr,sp),ap[0]=sp),np.setTexture3D(_d||empty3dTexture,sp)}function setValueT6(rp,_d,np){const ap=this.cache,sp=np.allocateTextureUnit();ap[0]!==sp&&(rp.uniform1i(this.addr,sp),ap[0]=sp),np.setTextureCube(_d||emptyCubeTexture,sp)}function setValueT2DArray1(rp,_d,np){const ap=this.cache,sp=np.allocateTextureUnit();ap[0]!==sp&&(rp.uniform1i(this.addr,sp),ap[0]=sp),np.setTexture2DArray(_d||emptyArrayTexture,sp)}function getSingularSetter(rp){switch(rp){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(rp,_d){rp.uniform1fv(this.addr,_d)}function setValueV2fArray(rp,_d){const np=flatten(_d,this.size,2);rp.uniform2fv(this.addr,np)}function setValueV3fArray(rp,_d){const np=flatten(_d,this.size,3);rp.uniform3fv(this.addr,np)}function setValueV4fArray(rp,_d){const np=flatten(_d,this.size,4);rp.uniform4fv(this.addr,np)}function setValueM2Array(rp,_d){const np=flatten(_d,this.size,4);rp.uniformMatrix2fv(this.addr,!1,np)}function setValueM3Array(rp,_d){const np=flatten(_d,this.size,9);rp.uniformMatrix3fv(this.addr,!1,np)}function setValueM4Array(rp,_d){const np=flatten(_d,this.size,16);rp.uniformMatrix4fv(this.addr,!1,np)}function setValueV1iArray(rp,_d){rp.uniform1iv(this.addr,_d)}function setValueV2iArray(rp,_d){rp.uniform2iv(this.addr,_d)}function setValueV3iArray(rp,_d){rp.uniform3iv(this.addr,_d)}function setValueV4iArray(rp,_d){rp.uniform4iv(this.addr,_d)}function setValueV1uiArray(rp,_d){rp.uniform1uiv(this.addr,_d)}function setValueV2uiArray(rp,_d){rp.uniform2uiv(this.addr,_d)}function setValueV3uiArray(rp,_d){rp.uniform3uiv(this.addr,_d)}function setValueV4uiArray(rp,_d){rp.uniform4uiv(this.addr,_d)}function setValueT1Array(rp,_d,np){const ap=this.cache,sp=_d.length,lp=allocTexUnits(np,sp);arraysEqual(ap,lp)||(rp.uniform1iv(this.addr,lp),copyArray(ap,lp));for(let up=0;up!==sp;++up)np.setTexture2D(_d[up]||emptyTexture,lp[up])}function setValueT3DArray(rp,_d,np){const ap=this.cache,sp=_d.length,lp=allocTexUnits(np,sp);arraysEqual(ap,lp)||(rp.uniform1iv(this.addr,lp),copyArray(ap,lp));for(let up=0;up!==sp;++up)np.setTexture3D(_d[up]||empty3dTexture,lp[up])}function setValueT6Array(rp,_d,np){const ap=this.cache,sp=_d.length,lp=allocTexUnits(np,sp);arraysEqual(ap,lp)||(rp.uniform1iv(this.addr,lp),copyArray(ap,lp));for(let up=0;up!==sp;++up)np.setTextureCube(_d[up]||emptyCubeTexture,lp[up])}function setValueT2DArrayArray(rp,_d,np){const ap=this.cache,sp=_d.length,lp=allocTexUnits(np,sp);arraysEqual(ap,lp)||(rp.uniform1iv(this.addr,lp),copyArray(ap,lp));for(let up=0;up!==sp;++up)np.setTexture2DArray(_d[up]||emptyArrayTexture,lp[up])}function getPureArraySetter(rp){switch(rp){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(_d,np,ap){this.id=_d,this.addr=ap,this.cache=[],this.type=np.type,this.setValue=getSingularSetter(np.type)}}class PureArrayUniform{constructor(_d,np,ap){this.id=_d,this.addr=ap,this.cache=[],this.type=np.type,this.size=np.size,this.setValue=getPureArraySetter(np.type)}}class StructuredUniform{constructor(_d){this.id=_d,this.seq=[],this.map={}}setValue(_d,np,ap){const sp=this.seq;for(let lp=0,up=sp.length;lp!==up;++lp){const cp=sp[lp];cp.setValue(_d,np[cp.id],ap)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(rp,_d){rp.seq.push(_d),rp.map[_d.id]=_d}function parseUniform(rp,_d,np){const ap=rp.name,sp=ap.length;for(RePathPart.lastIndex=0;;){const lp=RePathPart.exec(ap),up=RePathPart.lastIndex;let cp=lp[1];const dp=lp[2]==="]",hp=lp[3];if(dp&&(cp=cp|0),hp===void 0||hp==="["&&up+2===sp){addUniform(np,hp===void 0?new SingleUniform(cp,rp,_d):new PureArrayUniform(cp,rp,_d));break}else{let pp=np.map[cp];pp===void 0&&(pp=new StructuredUniform(cp),addUniform(np,pp)),np=pp}}}class WebGLUniforms{constructor(_d,np){this.seq=[],this.map={};const ap=_d.getProgramParameter(np,_d.ACTIVE_UNIFORMS);for(let sp=0;sp<ap;++sp){const lp=_d.getActiveUniform(np,sp),up=_d.getUniformLocation(np,lp.name);parseUniform(lp,up,this)}}setValue(_d,np,ap,sp){const lp=this.map[np];lp!==void 0&&lp.setValue(_d,ap,sp)}setOptional(_d,np,ap){const sp=np[ap];sp!==void 0&&this.setValue(_d,ap,sp)}static upload(_d,np,ap,sp){for(let lp=0,up=np.length;lp!==up;++lp){const cp=np[lp],dp=ap[cp.id];dp.needsUpdate!==!1&&cp.setValue(_d,dp.value,sp)}}static seqWithValue(_d,np){const ap=[];for(let sp=0,lp=_d.length;sp!==lp;++sp){const up=_d[sp];up.id in np&&ap.push(up)}return ap}}function WebGLShader(rp,_d,np){const ap=rp.createShader(_d);return rp.shaderSource(ap,np),rp.compileShader(ap),ap}const COMPLETION_STATUS_KHR=37297;let programIdCount=0;function handleSource(rp,_d){const np=rp.split(`
`),ap=[],sp=Math.max(_d-6,0),lp=Math.min(_d+6,np.length);for(let up=sp;up<lp;up++){const cp=up+1;ap.push(`${cp===_d?">":" "} ${cp}: ${np[up]}`)}return ap.join(`
`)}function getEncodingComponents(rp){const _d=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),np=ColorManagement.getPrimaries(rp);let ap;switch(_d===np?ap="":_d===P3Primaries&&np===Rec709Primaries?ap="LinearDisplayP3ToLinearSRGB":_d===Rec709Primaries&&np===P3Primaries&&(ap="LinearSRGBToLinearDisplayP3"),rp){case LinearSRGBColorSpace$1:case LinearDisplayP3ColorSpace:return[ap,"LinearTransferOETF"];case SRGBColorSpace$1:case DisplayP3ColorSpace:return[ap,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",rp),[ap,"LinearTransferOETF"]}}function getShaderErrors(rp,_d,np){const ap=rp.getShaderParameter(_d,rp.COMPILE_STATUS),sp=rp.getShaderInfoLog(_d).trim();if(ap&&sp==="")return"";const lp=/ERROR: 0:(\d+)/.exec(sp);if(lp){const up=parseInt(lp[1]);return np.toUpperCase()+`

`+sp+`

`+handleSource(rp.getShaderSource(_d),up)}else return sp}function getTexelEncodingFunction(rp,_d){const np=getEncodingComponents(_d);return`vec4 ${rp}( vec4 value ) { return ${np[0]}( ${np[1]}( value ) ); }`}function getToneMappingFunction(rp,_d){let np;switch(_d){case LinearToneMapping:np="Linear";break;case ReinhardToneMapping:np="Reinhard";break;case CineonToneMapping:np="OptimizedCineon";break;case ACESFilmicToneMapping:np="ACESFilmic";break;case AgXToneMapping:np="AgX";break;case CustomToneMapping:np="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_d),np="Linear"}return"vec3 "+rp+"( vec3 color ) { return "+np+"ToneMapping( color ); }"}function generateExtensions(rp){return[rp.extensionDerivatives||rp.envMapCubeUVHeight||rp.bumpMap||rp.normalMapTangentSpace||rp.clearcoatNormalMap||rp.flatShading||rp.alphaToCoverage||rp.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(rp.extensionFragDepth||rp.logarithmicDepthBuffer)&&rp.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",rp.extensionDrawBuffers&&rp.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(rp.extensionShaderTextureLOD||rp.envMap||rp.transmission)&&rp.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join(`
`)}function generateVertexExtensions(rp){return[rp.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",rp.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(filterEmptyLine).join(`
`)}function generateDefines(rp){const _d=[];for(const np in rp){const ap=rp[np];ap!==!1&&_d.push("#define "+np+" "+ap)}return _d.join(`
`)}function fetchAttributeLocations(rp,_d){const np={},ap=rp.getProgramParameter(_d,rp.ACTIVE_ATTRIBUTES);for(let sp=0;sp<ap;sp++){const lp=rp.getActiveAttrib(_d,sp),up=lp.name;let cp=1;lp.type===rp.FLOAT_MAT2&&(cp=2),lp.type===rp.FLOAT_MAT3&&(cp=3),lp.type===rp.FLOAT_MAT4&&(cp=4),np[up]={type:lp.type,location:rp.getAttribLocation(_d,up),locationSize:cp}}return np}function filterEmptyLine(rp){return rp!==""}function replaceLightNums(rp,_d){const np=_d.numSpotLightShadows+_d.numSpotLightMaps-_d.numSpotLightShadowsWithMaps;return rp.replace(/NUM_DIR_LIGHTS/g,_d.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_d.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_d.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,np).replace(/NUM_RECT_AREA_LIGHTS/g,_d.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_d.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_d.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_d.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_d.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_d.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_d.numPointLightShadows)}function replaceClippingPlaneNums(rp,_d){return rp.replace(/NUM_CLIPPING_PLANES/g,_d.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_d.numClippingPlanes-_d.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(rp){return rp.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function includeReplacer(rp,_d){let np=ShaderChunk[_d];if(np===void 0){const ap=shaderChunkMap.get(_d);if(ap!==void 0)np=ShaderChunk[ap],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',_d,ap);else throw new Error("Can not resolve #include <"+_d+">")}return resolveIncludes(np)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(rp){return rp.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(rp,_d,np,ap){let sp="";for(let lp=parseInt(_d);lp<parseInt(np);lp++)sp+=ap.replace(/\[\s*i\s*\]/g,"[ "+lp+" ]").replace(/UNROLLED_LOOP_INDEX/g,lp);return sp}function generatePrecision(rp){let _d=`precision ${rp.precision} float;
	precision ${rp.precision} int;
	precision ${rp.precision} sampler2D;
	precision ${rp.precision} samplerCube;
	`;return rp.isWebGL2&&(_d+=`precision ${rp.precision} sampler3D;
		precision ${rp.precision} sampler2DArray;
		precision ${rp.precision} sampler2DShadow;
		precision ${rp.precision} samplerCubeShadow;
		precision ${rp.precision} sampler2DArrayShadow;
		precision ${rp.precision} isampler2D;
		precision ${rp.precision} isampler3D;
		precision ${rp.precision} isamplerCube;
		precision ${rp.precision} isampler2DArray;
		precision ${rp.precision} usampler2D;
		precision ${rp.precision} usampler3D;
		precision ${rp.precision} usamplerCube;
		precision ${rp.precision} usampler2DArray;
		`),rp.precision==="highp"?_d+=`
#define HIGH_PRECISION`:rp.precision==="mediump"?_d+=`
#define MEDIUM_PRECISION`:rp.precision==="lowp"&&(_d+=`
#define LOW_PRECISION`),_d}function generateShadowMapTypeDefine(rp){let _d="SHADOWMAP_TYPE_BASIC";return rp.shadowMapType===PCFShadowMap?_d="SHADOWMAP_TYPE_PCF":rp.shadowMapType===PCFSoftShadowMap?_d="SHADOWMAP_TYPE_PCF_SOFT":rp.shadowMapType===VSMShadowMap&&(_d="SHADOWMAP_TYPE_VSM"),_d}function generateEnvMapTypeDefine(rp){let _d="ENVMAP_TYPE_CUBE";if(rp.envMap)switch(rp.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:_d="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:_d="ENVMAP_TYPE_CUBE_UV";break}return _d}function generateEnvMapModeDefine(rp){let _d="ENVMAP_MODE_REFLECTION";if(rp.envMap)switch(rp.envMapMode){case CubeRefractionMapping:_d="ENVMAP_MODE_REFRACTION";break}return _d}function generateEnvMapBlendingDefine(rp){let _d="ENVMAP_BLENDING_NONE";if(rp.envMap)switch(rp.combine){case MultiplyOperation:_d="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:_d="ENVMAP_BLENDING_MIX";break;case AddOperation:_d="ENVMAP_BLENDING_ADD";break}return _d}function generateCubeUVSize(rp){const _d=rp.envMapCubeUVHeight;if(_d===null)return null;const np=Math.log2(_d)-2,ap=1/_d;return{texelWidth:1/(3*Math.max(Math.pow(2,np),7*16)),texelHeight:ap,maxMip:np}}function WebGLProgram(rp,_d,np,ap){const sp=rp.getContext(),lp=np.defines;let up=np.vertexShader,cp=np.fragmentShader;const dp=generateShadowMapTypeDefine(np),hp=generateEnvMapTypeDefine(np),fp=generateEnvMapModeDefine(np),pp=generateEnvMapBlendingDefine(np),mp=generateCubeUVSize(np),gp=np.isWebGL2?"":generateExtensions(np),yp=generateVertexExtensions(np),xp=generateDefines(lp),_p=sp.createProgram();let vp,bp,Ep=np.glslVersion?"#version "+np.glslVersion+`
`:"";np.isRawShaderMaterial?(vp=["#define SHADER_TYPE "+np.shaderType,"#define SHADER_NAME "+np.shaderName,xp].filter(filterEmptyLine).join(`
`),vp.length>0&&(vp+=`
`),bp=[gp,"#define SHADER_TYPE "+np.shaderType,"#define SHADER_NAME "+np.shaderName,xp].filter(filterEmptyLine).join(`
`),bp.length>0&&(bp+=`
`)):(vp=[generatePrecision(np),"#define SHADER_TYPE "+np.shaderType,"#define SHADER_NAME "+np.shaderName,xp,np.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",np.batching?"#define USE_BATCHING":"",np.instancing?"#define USE_INSTANCING":"",np.instancingColor?"#define USE_INSTANCING_COLOR":"",np.useFog&&np.fog?"#define USE_FOG":"",np.useFog&&np.fogExp2?"#define FOG_EXP2":"",np.map?"#define USE_MAP":"",np.envMap?"#define USE_ENVMAP":"",np.envMap?"#define "+fp:"",np.lightMap?"#define USE_LIGHTMAP":"",np.aoMap?"#define USE_AOMAP":"",np.bumpMap?"#define USE_BUMPMAP":"",np.normalMap?"#define USE_NORMALMAP":"",np.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",np.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",np.displacementMap?"#define USE_DISPLACEMENTMAP":"",np.emissiveMap?"#define USE_EMISSIVEMAP":"",np.anisotropy?"#define USE_ANISOTROPY":"",np.anisotropyMap?"#define USE_ANISOTROPYMAP":"",np.clearcoatMap?"#define USE_CLEARCOATMAP":"",np.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",np.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",np.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",np.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",np.specularMap?"#define USE_SPECULARMAP":"",np.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",np.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",np.roughnessMap?"#define USE_ROUGHNESSMAP":"",np.metalnessMap?"#define USE_METALNESSMAP":"",np.alphaMap?"#define USE_ALPHAMAP":"",np.alphaHash?"#define USE_ALPHAHASH":"",np.transmission?"#define USE_TRANSMISSION":"",np.transmissionMap?"#define USE_TRANSMISSIONMAP":"",np.thicknessMap?"#define USE_THICKNESSMAP":"",np.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",np.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",np.mapUv?"#define MAP_UV "+np.mapUv:"",np.alphaMapUv?"#define ALPHAMAP_UV "+np.alphaMapUv:"",np.lightMapUv?"#define LIGHTMAP_UV "+np.lightMapUv:"",np.aoMapUv?"#define AOMAP_UV "+np.aoMapUv:"",np.emissiveMapUv?"#define EMISSIVEMAP_UV "+np.emissiveMapUv:"",np.bumpMapUv?"#define BUMPMAP_UV "+np.bumpMapUv:"",np.normalMapUv?"#define NORMALMAP_UV "+np.normalMapUv:"",np.displacementMapUv?"#define DISPLACEMENTMAP_UV "+np.displacementMapUv:"",np.metalnessMapUv?"#define METALNESSMAP_UV "+np.metalnessMapUv:"",np.roughnessMapUv?"#define ROUGHNESSMAP_UV "+np.roughnessMapUv:"",np.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+np.anisotropyMapUv:"",np.clearcoatMapUv?"#define CLEARCOATMAP_UV "+np.clearcoatMapUv:"",np.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+np.clearcoatNormalMapUv:"",np.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+np.clearcoatRoughnessMapUv:"",np.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+np.iridescenceMapUv:"",np.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+np.iridescenceThicknessMapUv:"",np.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+np.sheenColorMapUv:"",np.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+np.sheenRoughnessMapUv:"",np.specularMapUv?"#define SPECULARMAP_UV "+np.specularMapUv:"",np.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+np.specularColorMapUv:"",np.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+np.specularIntensityMapUv:"",np.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+np.transmissionMapUv:"",np.thicknessMapUv?"#define THICKNESSMAP_UV "+np.thicknessMapUv:"",np.vertexTangents&&np.flatShading===!1?"#define USE_TANGENT":"",np.vertexColors?"#define USE_COLOR":"",np.vertexAlphas?"#define USE_COLOR_ALPHA":"",np.vertexUv1s?"#define USE_UV1":"",np.vertexUv2s?"#define USE_UV2":"",np.vertexUv3s?"#define USE_UV3":"",np.pointsUvs?"#define USE_POINTS_UV":"",np.flatShading?"#define FLAT_SHADED":"",np.skinning?"#define USE_SKINNING":"",np.morphTargets?"#define USE_MORPHTARGETS":"",np.morphNormals&&np.flatShading===!1?"#define USE_MORPHNORMALS":"",np.morphColors&&np.isWebGL2?"#define USE_MORPHCOLORS":"",np.morphTargetsCount>0&&np.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",np.morphTargetsCount>0&&np.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+np.morphTextureStride:"",np.morphTargetsCount>0&&np.isWebGL2?"#define MORPHTARGETS_COUNT "+np.morphTargetsCount:"",np.doubleSided?"#define DOUBLE_SIDED":"",np.flipSided?"#define FLIP_SIDED":"",np.shadowMapEnabled?"#define USE_SHADOWMAP":"",np.shadowMapEnabled?"#define "+dp:"",np.sizeAttenuation?"#define USE_SIZEATTENUATION":"",np.numLightProbes>0?"#define USE_LIGHT_PROBES":"",np.useLegacyLights?"#define LEGACY_LIGHTS":"",np.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",np.logarithmicDepthBuffer&&np.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),bp=[gp,generatePrecision(np),"#define SHADER_TYPE "+np.shaderType,"#define SHADER_NAME "+np.shaderName,xp,np.useFog&&np.fog?"#define USE_FOG":"",np.useFog&&np.fogExp2?"#define FOG_EXP2":"",np.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",np.map?"#define USE_MAP":"",np.matcap?"#define USE_MATCAP":"",np.envMap?"#define USE_ENVMAP":"",np.envMap?"#define "+hp:"",np.envMap?"#define "+fp:"",np.envMap?"#define "+pp:"",mp?"#define CUBEUV_TEXEL_WIDTH "+mp.texelWidth:"",mp?"#define CUBEUV_TEXEL_HEIGHT "+mp.texelHeight:"",mp?"#define CUBEUV_MAX_MIP "+mp.maxMip+".0":"",np.lightMap?"#define USE_LIGHTMAP":"",np.aoMap?"#define USE_AOMAP":"",np.bumpMap?"#define USE_BUMPMAP":"",np.normalMap?"#define USE_NORMALMAP":"",np.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",np.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",np.emissiveMap?"#define USE_EMISSIVEMAP":"",np.anisotropy?"#define USE_ANISOTROPY":"",np.anisotropyMap?"#define USE_ANISOTROPYMAP":"",np.clearcoat?"#define USE_CLEARCOAT":"",np.clearcoatMap?"#define USE_CLEARCOATMAP":"",np.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",np.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",np.iridescence?"#define USE_IRIDESCENCE":"",np.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",np.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",np.specularMap?"#define USE_SPECULARMAP":"",np.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",np.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",np.roughnessMap?"#define USE_ROUGHNESSMAP":"",np.metalnessMap?"#define USE_METALNESSMAP":"",np.alphaMap?"#define USE_ALPHAMAP":"",np.alphaTest?"#define USE_ALPHATEST":"",np.alphaHash?"#define USE_ALPHAHASH":"",np.sheen?"#define USE_SHEEN":"",np.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",np.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",np.transmission?"#define USE_TRANSMISSION":"",np.transmissionMap?"#define USE_TRANSMISSIONMAP":"",np.thicknessMap?"#define USE_THICKNESSMAP":"",np.vertexTangents&&np.flatShading===!1?"#define USE_TANGENT":"",np.vertexColors||np.instancingColor?"#define USE_COLOR":"",np.vertexAlphas?"#define USE_COLOR_ALPHA":"",np.vertexUv1s?"#define USE_UV1":"",np.vertexUv2s?"#define USE_UV2":"",np.vertexUv3s?"#define USE_UV3":"",np.pointsUvs?"#define USE_POINTS_UV":"",np.gradientMap?"#define USE_GRADIENTMAP":"",np.flatShading?"#define FLAT_SHADED":"",np.doubleSided?"#define DOUBLE_SIDED":"",np.flipSided?"#define FLIP_SIDED":"",np.shadowMapEnabled?"#define USE_SHADOWMAP":"",np.shadowMapEnabled?"#define "+dp:"",np.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",np.numLightProbes>0?"#define USE_LIGHT_PROBES":"",np.useLegacyLights?"#define LEGACY_LIGHTS":"",np.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",np.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",np.logarithmicDepthBuffer&&np.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",np.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",np.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",np.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",np.toneMapping):"",np.dithering?"#define DITHERING":"",np.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",np.outputColorSpace),np.useDepthPacking?"#define DEPTH_PACKING "+np.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),up=resolveIncludes(up),up=replaceLightNums(up,np),up=replaceClippingPlaneNums(up,np),cp=resolveIncludes(cp),cp=replaceLightNums(cp,np),cp=replaceClippingPlaneNums(cp,np),up=unrollLoops(up),cp=unrollLoops(cp),np.isWebGL2&&np.isRawShaderMaterial!==!0&&(Ep=`#version 300 es
`,vp=[yp,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+vp,bp=["precision mediump sampler2DArray;","#define varying in",np.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",np.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+bp);const Sp=Ep+vp+up,Ap=Ep+bp+cp,Rp=WebGLShader(sp,sp.VERTEX_SHADER,Sp),Tp=WebGLShader(sp,sp.FRAGMENT_SHADER,Ap);sp.attachShader(_p,Rp),sp.attachShader(_p,Tp),np.index0AttributeName!==void 0?sp.bindAttribLocation(_p,0,np.index0AttributeName):np.morphTargets===!0&&sp.bindAttribLocation(_p,0,"position"),sp.linkProgram(_p);function Mp(zp){if(rp.debug.checkShaderErrors){const Dp=sp.getProgramInfoLog(_p).trim(),Fp=sp.getShaderInfoLog(Rp).trim(),jp=sp.getShaderInfoLog(Tp).trim();let Lp=!0,Bp=!0;if(sp.getProgramParameter(_p,sp.LINK_STATUS)===!1)if(Lp=!1,typeof rp.debug.onShaderError=="function")rp.debug.onShaderError(sp,_p,Rp,Tp);else{const Ip=getShaderErrors(sp,Rp,"vertex"),kp=getShaderErrors(sp,Tp,"fragment");console.error("THREE.WebGLProgram: Shader Error "+sp.getError()+" - VALIDATE_STATUS "+sp.getProgramParameter(_p,sp.VALIDATE_STATUS)+`

Material Name: `+zp.name+`
Material Type: `+zp.type+`

Program Info Log: `+Dp+`
`+Ip+`
`+kp)}else Dp!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Dp):(Fp===""||jp==="")&&(Bp=!1);Bp&&(zp.diagnostics={runnable:Lp,programLog:Dp,vertexShader:{log:Fp,prefix:vp},fragmentShader:{log:jp,prefix:bp}})}sp.deleteShader(Rp),sp.deleteShader(Tp),Op=new WebGLUniforms(sp,_p),Pp=fetchAttributeLocations(sp,_p)}let Op;this.getUniforms=function(){return Op===void 0&&Mp(this),Op};let Pp;this.getAttributes=function(){return Pp===void 0&&Mp(this),Pp};let $p=np.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return $p===!1&&($p=sp.getProgramParameter(_p,COMPLETION_STATUS_KHR)),$p},this.destroy=function(){ap.releaseStatesOfProgram(this),sp.deleteProgram(_p),this.program=void 0},this.type=np.shaderType,this.name=np.shaderName,this.id=programIdCount++,this.cacheKey=_d,this.usedTimes=1,this.program=_p,this.vertexShader=Rp,this.fragmentShader=Tp,this}let _id$1=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_d){const np=_d.vertexShader,ap=_d.fragmentShader,sp=this._getShaderStage(np),lp=this._getShaderStage(ap),up=this._getShaderCacheForMaterial(_d);return up.has(sp)===!1&&(up.add(sp),sp.usedTimes++),up.has(lp)===!1&&(up.add(lp),lp.usedTimes++),this}remove(_d){const np=this.materialCache.get(_d);for(const ap of np)ap.usedTimes--,ap.usedTimes===0&&this.shaderCache.delete(ap.code);return this.materialCache.delete(_d),this}getVertexShaderID(_d){return this._getShaderStage(_d.vertexShader).id}getFragmentShaderID(_d){return this._getShaderStage(_d.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_d){const np=this.materialCache;let ap=np.get(_d);return ap===void 0&&(ap=new Set,np.set(_d,ap)),ap}_getShaderStage(_d){const np=this.shaderCache;let ap=np.get(_d);return ap===void 0&&(ap=new WebGLShaderStage(_d),np.set(_d,ap)),ap}}class WebGLShaderStage{constructor(_d){this.id=_id$1++,this.code=_d,this.usedTimes=0}}function WebGLPrograms(rp,_d,np,ap,sp,lp,up){const cp=new Layers,dp=new WebGLShaderCache,hp=new Set,fp=[],pp=sp.isWebGL2,mp=sp.logarithmicDepthBuffer,gp=sp.vertexTextures;let yp=sp.precision;const xp={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _p(Pp){return hp.add(Pp),Pp===0?"uv":`uv${Pp}`}function vp(Pp,$p,zp,Dp,Fp){const jp=Dp.fog,Lp=Fp.geometry,Bp=Pp.isMeshStandardMaterial?Dp.environment:null,Ip=(Pp.isMeshStandardMaterial?np:_d).get(Pp.envMap||Bp),kp=Ip&&Ip.mapping===CubeUVReflectionMapping?Ip.image.height:null,Up=xp[Pp.type];Pp.precision!==null&&(yp=sp.getMaxPrecision(Pp.precision),yp!==Pp.precision&&console.warn("THREE.WebGLProgram.getParameters:",Pp.precision,"not supported, using",yp,"instead."));const Gp=Lp.morphAttributes.position||Lp.morphAttributes.normal||Lp.morphAttributes.color,Wp=Gp!==void 0?Gp.length:0;let Qp=0;Lp.morphAttributes.position!==void 0&&(Qp=1),Lp.morphAttributes.normal!==void 0&&(Qp=2),Lp.morphAttributes.color!==void 0&&(Qp=3);let Xp,rm,Kp,lm;if(Up){const nv=ShaderLib[Up];Xp=nv.vertexShader,rm=nv.fragmentShader}else Xp=Pp.vertexShader,rm=Pp.fragmentShader,dp.update(Pp),Kp=dp.getVertexShaderID(Pp),lm=dp.getFragmentShaderID(Pp);const cm=rp.getRenderTarget(),gm=Fp.isInstancedMesh===!0,Mm=Fp.isBatchedMesh===!0,dm=!!Pp.map,em=!!Pp.matcap,sm=!!Ip,Zp=!!Pp.aoMap,mm=!!Pp.lightMap,fm=!!Pp.bumpMap,_m=!!Pp.normalMap,zm=!!Pp.displacementMap,tm=!!Pp.emissiveMap,Jp=!!Pp.metalnessMap,pm=!!Pp.roughnessMap,km=Pp.anisotropy>0,ym=Pp.clearcoat>0,Em=Pp.iridescence>0,Bm=Pp.sheen>0,Pm=Pp.transmission>0,Im=km&&!!Pp.anisotropyMap,Dm=ym&&!!Pp.clearcoatMap,jm=ym&&!!Pp.clearcoatNormalMap,Fm=ym&&!!Pp.clearcoatRoughnessMap,av=Em&&!!Pp.iridescenceMap,lv=Em&&!!Pp.iridescenceThicknessMap,tv=Bm&&!!Pp.sheenColorMap,Jm=Bm&&!!Pp.sheenRoughnessMap,um=!!Pp.specularMap,Yp=!!Pp.specularColorMap,hm=!!Pp.specularIntensityMap,wm=Pm&&!!Pp.transmissionMap,Cm=Pm&&!!Pp.thicknessMap,Vm=!!Pp.gradientMap,im=!!Pp.alphaMap,Am=Pp.alphaTest>0,Lm=!!Pp.alphaHash,Um=!!Pp.extensions;let Gm=NoToneMapping;Pp.toneMapped&&(cm===null||cm.isXRRenderTarget===!0)&&(Gm=rp.toneMapping);const ev={isWebGL2:pp,shaderID:Up,shaderType:Pp.type,shaderName:Pp.name,vertexShader:Xp,fragmentShader:rm,defines:Pp.defines,customVertexShaderID:Kp,customFragmentShaderID:lm,isRawShaderMaterial:Pp.isRawShaderMaterial===!0,glslVersion:Pp.glslVersion,precision:yp,batching:Mm,instancing:gm,instancingColor:gm&&Fp.instanceColor!==null,supportsVertexTextures:gp,outputColorSpace:cm===null?rp.outputColorSpace:cm.isXRRenderTarget===!0?cm.texture.colorSpace:LinearSRGBColorSpace$1,alphaToCoverage:!!Pp.alphaToCoverage,map:dm,matcap:em,envMap:sm,envMapMode:sm&&Ip.mapping,envMapCubeUVHeight:kp,aoMap:Zp,lightMap:mm,bumpMap:fm,normalMap:_m,displacementMap:gp&&zm,emissiveMap:tm,normalMapObjectSpace:_m&&Pp.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:_m&&Pp.normalMapType===TangentSpaceNormalMap,metalnessMap:Jp,roughnessMap:pm,anisotropy:km,anisotropyMap:Im,clearcoat:ym,clearcoatMap:Dm,clearcoatNormalMap:jm,clearcoatRoughnessMap:Fm,iridescence:Em,iridescenceMap:av,iridescenceThicknessMap:lv,sheen:Bm,sheenColorMap:tv,sheenRoughnessMap:Jm,specularMap:um,specularColorMap:Yp,specularIntensityMap:hm,transmission:Pm,transmissionMap:wm,thicknessMap:Cm,gradientMap:Vm,opaque:Pp.transparent===!1&&Pp.blending===NormalBlending&&Pp.alphaToCoverage===!1,alphaMap:im,alphaTest:Am,alphaHash:Lm,combine:Pp.combine,mapUv:dm&&_p(Pp.map.channel),aoMapUv:Zp&&_p(Pp.aoMap.channel),lightMapUv:mm&&_p(Pp.lightMap.channel),bumpMapUv:fm&&_p(Pp.bumpMap.channel),normalMapUv:_m&&_p(Pp.normalMap.channel),displacementMapUv:zm&&_p(Pp.displacementMap.channel),emissiveMapUv:tm&&_p(Pp.emissiveMap.channel),metalnessMapUv:Jp&&_p(Pp.metalnessMap.channel),roughnessMapUv:pm&&_p(Pp.roughnessMap.channel),anisotropyMapUv:Im&&_p(Pp.anisotropyMap.channel),clearcoatMapUv:Dm&&_p(Pp.clearcoatMap.channel),clearcoatNormalMapUv:jm&&_p(Pp.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Fm&&_p(Pp.clearcoatRoughnessMap.channel),iridescenceMapUv:av&&_p(Pp.iridescenceMap.channel),iridescenceThicknessMapUv:lv&&_p(Pp.iridescenceThicknessMap.channel),sheenColorMapUv:tv&&_p(Pp.sheenColorMap.channel),sheenRoughnessMapUv:Jm&&_p(Pp.sheenRoughnessMap.channel),specularMapUv:um&&_p(Pp.specularMap.channel),specularColorMapUv:Yp&&_p(Pp.specularColorMap.channel),specularIntensityMapUv:hm&&_p(Pp.specularIntensityMap.channel),transmissionMapUv:wm&&_p(Pp.transmissionMap.channel),thicknessMapUv:Cm&&_p(Pp.thicknessMap.channel),alphaMapUv:im&&_p(Pp.alphaMap.channel),vertexTangents:!!Lp.attributes.tangent&&(_m||km),vertexColors:Pp.vertexColors,vertexAlphas:Pp.vertexColors===!0&&!!Lp.attributes.color&&Lp.attributes.color.itemSize===4,pointsUvs:Fp.isPoints===!0&&!!Lp.attributes.uv&&(dm||im),fog:!!jp,useFog:Pp.fog===!0,fogExp2:!!jp&&jp.isFogExp2,flatShading:Pp.flatShading===!0,sizeAttenuation:Pp.sizeAttenuation===!0,logarithmicDepthBuffer:mp,skinning:Fp.isSkinnedMesh===!0,morphTargets:Lp.morphAttributes.position!==void 0,morphNormals:Lp.morphAttributes.normal!==void 0,morphColors:Lp.morphAttributes.color!==void 0,morphTargetsCount:Wp,morphTextureStride:Qp,numDirLights:$p.directional.length,numPointLights:$p.point.length,numSpotLights:$p.spot.length,numSpotLightMaps:$p.spotLightMap.length,numRectAreaLights:$p.rectArea.length,numHemiLights:$p.hemi.length,numDirLightShadows:$p.directionalShadowMap.length,numPointLightShadows:$p.pointShadowMap.length,numSpotLightShadows:$p.spotShadowMap.length,numSpotLightShadowsWithMaps:$p.numSpotLightShadowsWithMaps,numLightProbes:$p.numLightProbes,numClippingPlanes:up.numPlanes,numClipIntersection:up.numIntersection,dithering:Pp.dithering,shadowMapEnabled:rp.shadowMap.enabled&&zp.length>0,shadowMapType:rp.shadowMap.type,toneMapping:Gm,useLegacyLights:rp._useLegacyLights,decodeVideoTexture:dm&&Pp.map.isVideoTexture===!0&&ColorManagement.getTransfer(Pp.map.colorSpace)===SRGBTransfer,premultipliedAlpha:Pp.premultipliedAlpha,doubleSided:Pp.side===DoubleSide,flipSided:Pp.side===BackSide,useDepthPacking:Pp.depthPacking>=0,depthPacking:Pp.depthPacking||0,index0AttributeName:Pp.index0AttributeName,extensionDerivatives:Um&&Pp.extensions.derivatives===!0,extensionFragDepth:Um&&Pp.extensions.fragDepth===!0,extensionDrawBuffers:Um&&Pp.extensions.drawBuffers===!0,extensionShaderTextureLOD:Um&&Pp.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Um&&Pp.extensions.clipCullDistance===!0&&ap.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Um&&Pp.extensions.multiDraw===!0&&ap.has("WEBGL_multi_draw"),rendererExtensionFragDepth:pp||ap.has("EXT_frag_depth"),rendererExtensionDrawBuffers:pp||ap.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:pp||ap.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:ap.has("KHR_parallel_shader_compile"),customProgramCacheKey:Pp.customProgramCacheKey()};return ev.vertexUv1s=hp.has(1),ev.vertexUv2s=hp.has(2),ev.vertexUv3s=hp.has(3),hp.clear(),ev}function bp(Pp){const $p=[];if(Pp.shaderID?$p.push(Pp.shaderID):($p.push(Pp.customVertexShaderID),$p.push(Pp.customFragmentShaderID)),Pp.defines!==void 0)for(const zp in Pp.defines)$p.push(zp),$p.push(Pp.defines[zp]);return Pp.isRawShaderMaterial===!1&&(Ep($p,Pp),Sp($p,Pp),$p.push(rp.outputColorSpace)),$p.push(Pp.customProgramCacheKey),$p.join()}function Ep(Pp,$p){Pp.push($p.precision),Pp.push($p.outputColorSpace),Pp.push($p.envMapMode),Pp.push($p.envMapCubeUVHeight),Pp.push($p.mapUv),Pp.push($p.alphaMapUv),Pp.push($p.lightMapUv),Pp.push($p.aoMapUv),Pp.push($p.bumpMapUv),Pp.push($p.normalMapUv),Pp.push($p.displacementMapUv),Pp.push($p.emissiveMapUv),Pp.push($p.metalnessMapUv),Pp.push($p.roughnessMapUv),Pp.push($p.anisotropyMapUv),Pp.push($p.clearcoatMapUv),Pp.push($p.clearcoatNormalMapUv),Pp.push($p.clearcoatRoughnessMapUv),Pp.push($p.iridescenceMapUv),Pp.push($p.iridescenceThicknessMapUv),Pp.push($p.sheenColorMapUv),Pp.push($p.sheenRoughnessMapUv),Pp.push($p.specularMapUv),Pp.push($p.specularColorMapUv),Pp.push($p.specularIntensityMapUv),Pp.push($p.transmissionMapUv),Pp.push($p.thicknessMapUv),Pp.push($p.combine),Pp.push($p.fogExp2),Pp.push($p.sizeAttenuation),Pp.push($p.morphTargetsCount),Pp.push($p.morphAttributeCount),Pp.push($p.numDirLights),Pp.push($p.numPointLights),Pp.push($p.numSpotLights),Pp.push($p.numSpotLightMaps),Pp.push($p.numHemiLights),Pp.push($p.numRectAreaLights),Pp.push($p.numDirLightShadows),Pp.push($p.numPointLightShadows),Pp.push($p.numSpotLightShadows),Pp.push($p.numSpotLightShadowsWithMaps),Pp.push($p.numLightProbes),Pp.push($p.shadowMapType),Pp.push($p.toneMapping),Pp.push($p.numClippingPlanes),Pp.push($p.numClipIntersection),Pp.push($p.depthPacking)}function Sp(Pp,$p){cp.disableAll(),$p.isWebGL2&&cp.enable(0),$p.supportsVertexTextures&&cp.enable(1),$p.instancing&&cp.enable(2),$p.instancingColor&&cp.enable(3),$p.matcap&&cp.enable(4),$p.envMap&&cp.enable(5),$p.normalMapObjectSpace&&cp.enable(6),$p.normalMapTangentSpace&&cp.enable(7),$p.clearcoat&&cp.enable(8),$p.iridescence&&cp.enable(9),$p.alphaTest&&cp.enable(10),$p.vertexColors&&cp.enable(11),$p.vertexAlphas&&cp.enable(12),$p.vertexUv1s&&cp.enable(13),$p.vertexUv2s&&cp.enable(14),$p.vertexUv3s&&cp.enable(15),$p.vertexTangents&&cp.enable(16),$p.anisotropy&&cp.enable(17),$p.alphaHash&&cp.enable(18),$p.batching&&cp.enable(19),Pp.push(cp.mask),cp.disableAll(),$p.fog&&cp.enable(0),$p.useFog&&cp.enable(1),$p.flatShading&&cp.enable(2),$p.logarithmicDepthBuffer&&cp.enable(3),$p.skinning&&cp.enable(4),$p.morphTargets&&cp.enable(5),$p.morphNormals&&cp.enable(6),$p.morphColors&&cp.enable(7),$p.premultipliedAlpha&&cp.enable(8),$p.shadowMapEnabled&&cp.enable(9),$p.useLegacyLights&&cp.enable(10),$p.doubleSided&&cp.enable(11),$p.flipSided&&cp.enable(12),$p.useDepthPacking&&cp.enable(13),$p.dithering&&cp.enable(14),$p.transmission&&cp.enable(15),$p.sheen&&cp.enable(16),$p.opaque&&cp.enable(17),$p.pointsUvs&&cp.enable(18),$p.decodeVideoTexture&&cp.enable(19),$p.alphaToCoverage&&cp.enable(20),Pp.push(cp.mask)}function Ap(Pp){const $p=xp[Pp.type];let zp;if($p){const Dp=ShaderLib[$p];zp=UniformsUtils.clone(Dp.uniforms)}else zp=Pp.uniforms;return zp}function Rp(Pp,$p){let zp;for(let Dp=0,Fp=fp.length;Dp<Fp;Dp++){const jp=fp[Dp];if(jp.cacheKey===$p){zp=jp,++zp.usedTimes;break}}return zp===void 0&&(zp=new WebGLProgram(rp,$p,Pp,lp),fp.push(zp)),zp}function Tp(Pp){if(--Pp.usedTimes===0){const $p=fp.indexOf(Pp);fp[$p]=fp[fp.length-1],fp.pop(),Pp.destroy()}}function Mp(Pp){dp.remove(Pp)}function Op(){dp.dispose()}return{getParameters:vp,getProgramCacheKey:bp,getUniforms:Ap,acquireProgram:Rp,releaseProgram:Tp,releaseShaderCache:Mp,programs:fp,dispose:Op}}function WebGLProperties(){let rp=new WeakMap;function _d(lp){let up=rp.get(lp);return up===void 0&&(up={},rp.set(lp,up)),up}function np(lp){rp.delete(lp)}function ap(lp,up,cp){rp.get(lp)[up]=cp}function sp(){rp=new WeakMap}return{get:_d,remove:np,update:ap,dispose:sp}}function painterSortStable(rp,_d){return rp.groupOrder!==_d.groupOrder?rp.groupOrder-_d.groupOrder:rp.renderOrder!==_d.renderOrder?rp.renderOrder-_d.renderOrder:rp.material.id!==_d.material.id?rp.material.id-_d.material.id:rp.z!==_d.z?rp.z-_d.z:rp.id-_d.id}function reversePainterSortStable(rp,_d){return rp.groupOrder!==_d.groupOrder?rp.groupOrder-_d.groupOrder:rp.renderOrder!==_d.renderOrder?rp.renderOrder-_d.renderOrder:rp.z!==_d.z?_d.z-rp.z:rp.id-_d.id}function WebGLRenderList(){const rp=[];let _d=0;const np=[],ap=[],sp=[];function lp(){_d=0,np.length=0,ap.length=0,sp.length=0}function up(pp,mp,gp,yp,xp,_p){let vp=rp[_d];return vp===void 0?(vp={id:pp.id,object:pp,geometry:mp,material:gp,groupOrder:yp,renderOrder:pp.renderOrder,z:xp,group:_p},rp[_d]=vp):(vp.id=pp.id,vp.object=pp,vp.geometry=mp,vp.material=gp,vp.groupOrder=yp,vp.renderOrder=pp.renderOrder,vp.z=xp,vp.group=_p),_d++,vp}function cp(pp,mp,gp,yp,xp,_p){const vp=up(pp,mp,gp,yp,xp,_p);gp.transmission>0?ap.push(vp):gp.transparent===!0?sp.push(vp):np.push(vp)}function dp(pp,mp,gp,yp,xp,_p){const vp=up(pp,mp,gp,yp,xp,_p);gp.transmission>0?ap.unshift(vp):gp.transparent===!0?sp.unshift(vp):np.unshift(vp)}function hp(pp,mp){np.length>1&&np.sort(pp||painterSortStable),ap.length>1&&ap.sort(mp||reversePainterSortStable),sp.length>1&&sp.sort(mp||reversePainterSortStable)}function fp(){for(let pp=_d,mp=rp.length;pp<mp;pp++){const gp=rp[pp];if(gp.id===null)break;gp.id=null,gp.object=null,gp.geometry=null,gp.material=null,gp.group=null}}return{opaque:np,transmissive:ap,transparent:sp,init:lp,push:cp,unshift:dp,finish:fp,sort:hp}}function WebGLRenderLists(){let rp=new WeakMap;function _d(ap,sp){const lp=rp.get(ap);let up;return lp===void 0?(up=new WebGLRenderList,rp.set(ap,[up])):sp>=lp.length?(up=new WebGLRenderList,lp.push(up)):up=lp[sp],up}function np(){rp=new WeakMap}return{get:_d,dispose:np}}function UniformsCache(){const rp={};return{get:function(_d){if(rp[_d.id]!==void 0)return rp[_d.id];let np;switch(_d.type){case"DirectionalLight":np={direction:new Vector3,color:new Color};break;case"SpotLight":np={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":np={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":np={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":np={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return rp[_d.id]=np,np}}}function ShadowUniformsCache(){const rp={};return{get:function(_d){if(rp[_d.id]!==void 0)return rp[_d.id];let np;switch(_d.type){case"DirectionalLight":np={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":np={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":np={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return rp[_d.id]=np,np}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(rp,_d){return(_d.castShadow?2:0)-(rp.castShadow?2:0)+(_d.map?1:0)-(rp.map?1:0)}function WebGLLights(rp,_d){const np=new UniformsCache,ap=ShadowUniformsCache(),sp={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let fp=0;fp<9;fp++)sp.probe.push(new Vector3);const lp=new Vector3,up=new Matrix4,cp=new Matrix4;function dp(fp,pp){let mp=0,gp=0,yp=0;for(let zp=0;zp<9;zp++)sp.probe[zp].set(0,0,0);let xp=0,_p=0,vp=0,bp=0,Ep=0,Sp=0,Ap=0,Rp=0,Tp=0,Mp=0,Op=0;fp.sort(shadowCastingAndTexturingLightsFirst);const Pp=pp===!0?Math.PI:1;for(let zp=0,Dp=fp.length;zp<Dp;zp++){const Fp=fp[zp],jp=Fp.color,Lp=Fp.intensity,Bp=Fp.distance,Ip=Fp.shadow&&Fp.shadow.map?Fp.shadow.map.texture:null;if(Fp.isAmbientLight)mp+=jp.r*Lp*Pp,gp+=jp.g*Lp*Pp,yp+=jp.b*Lp*Pp;else if(Fp.isLightProbe){for(let kp=0;kp<9;kp++)sp.probe[kp].addScaledVector(Fp.sh.coefficients[kp],Lp);Op++}else if(Fp.isDirectionalLight){const kp=np.get(Fp);if(kp.color.copy(Fp.color).multiplyScalar(Fp.intensity*Pp),Fp.castShadow){const Up=Fp.shadow,Gp=ap.get(Fp);Gp.shadowBias=Up.bias,Gp.shadowNormalBias=Up.normalBias,Gp.shadowRadius=Up.radius,Gp.shadowMapSize=Up.mapSize,sp.directionalShadow[xp]=Gp,sp.directionalShadowMap[xp]=Ip,sp.directionalShadowMatrix[xp]=Fp.shadow.matrix,Sp++}sp.directional[xp]=kp,xp++}else if(Fp.isSpotLight){const kp=np.get(Fp);kp.position.setFromMatrixPosition(Fp.matrixWorld),kp.color.copy(jp).multiplyScalar(Lp*Pp),kp.distance=Bp,kp.coneCos=Math.cos(Fp.angle),kp.penumbraCos=Math.cos(Fp.angle*(1-Fp.penumbra)),kp.decay=Fp.decay,sp.spot[vp]=kp;const Up=Fp.shadow;if(Fp.map&&(sp.spotLightMap[Tp]=Fp.map,Tp++,Up.updateMatrices(Fp),Fp.castShadow&&Mp++),sp.spotLightMatrix[vp]=Up.matrix,Fp.castShadow){const Gp=ap.get(Fp);Gp.shadowBias=Up.bias,Gp.shadowNormalBias=Up.normalBias,Gp.shadowRadius=Up.radius,Gp.shadowMapSize=Up.mapSize,sp.spotShadow[vp]=Gp,sp.spotShadowMap[vp]=Ip,Rp++}vp++}else if(Fp.isRectAreaLight){const kp=np.get(Fp);kp.color.copy(jp).multiplyScalar(Lp),kp.halfWidth.set(Fp.width*.5,0,0),kp.halfHeight.set(0,Fp.height*.5,0),sp.rectArea[bp]=kp,bp++}else if(Fp.isPointLight){const kp=np.get(Fp);if(kp.color.copy(Fp.color).multiplyScalar(Fp.intensity*Pp),kp.distance=Fp.distance,kp.decay=Fp.decay,Fp.castShadow){const Up=Fp.shadow,Gp=ap.get(Fp);Gp.shadowBias=Up.bias,Gp.shadowNormalBias=Up.normalBias,Gp.shadowRadius=Up.radius,Gp.shadowMapSize=Up.mapSize,Gp.shadowCameraNear=Up.camera.near,Gp.shadowCameraFar=Up.camera.far,sp.pointShadow[_p]=Gp,sp.pointShadowMap[_p]=Ip,sp.pointShadowMatrix[_p]=Fp.shadow.matrix,Ap++}sp.point[_p]=kp,_p++}else if(Fp.isHemisphereLight){const kp=np.get(Fp);kp.skyColor.copy(Fp.color).multiplyScalar(Lp*Pp),kp.groundColor.copy(Fp.groundColor).multiplyScalar(Lp*Pp),sp.hemi[Ep]=kp,Ep++}}bp>0&&(_d.isWebGL2?rp.has("OES_texture_float_linear")===!0?(sp.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,sp.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):(sp.rectAreaLTC1=UniformsLib.LTC_HALF_1,sp.rectAreaLTC2=UniformsLib.LTC_HALF_2):rp.has("OES_texture_float_linear")===!0?(sp.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,sp.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):rp.has("OES_texture_half_float_linear")===!0?(sp.rectAreaLTC1=UniformsLib.LTC_HALF_1,sp.rectAreaLTC2=UniformsLib.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),sp.ambient[0]=mp,sp.ambient[1]=gp,sp.ambient[2]=yp;const $p=sp.hash;($p.directionalLength!==xp||$p.pointLength!==_p||$p.spotLength!==vp||$p.rectAreaLength!==bp||$p.hemiLength!==Ep||$p.numDirectionalShadows!==Sp||$p.numPointShadows!==Ap||$p.numSpotShadows!==Rp||$p.numSpotMaps!==Tp||$p.numLightProbes!==Op)&&(sp.directional.length=xp,sp.spot.length=vp,sp.rectArea.length=bp,sp.point.length=_p,sp.hemi.length=Ep,sp.directionalShadow.length=Sp,sp.directionalShadowMap.length=Sp,sp.pointShadow.length=Ap,sp.pointShadowMap.length=Ap,sp.spotShadow.length=Rp,sp.spotShadowMap.length=Rp,sp.directionalShadowMatrix.length=Sp,sp.pointShadowMatrix.length=Ap,sp.spotLightMatrix.length=Rp+Tp-Mp,sp.spotLightMap.length=Tp,sp.numSpotLightShadowsWithMaps=Mp,sp.numLightProbes=Op,$p.directionalLength=xp,$p.pointLength=_p,$p.spotLength=vp,$p.rectAreaLength=bp,$p.hemiLength=Ep,$p.numDirectionalShadows=Sp,$p.numPointShadows=Ap,$p.numSpotShadows=Rp,$p.numSpotMaps=Tp,$p.numLightProbes=Op,sp.version=nextVersion++)}function hp(fp,pp){let mp=0,gp=0,yp=0,xp=0,_p=0;const vp=pp.matrixWorldInverse;for(let bp=0,Ep=fp.length;bp<Ep;bp++){const Sp=fp[bp];if(Sp.isDirectionalLight){const Ap=sp.directional[mp];Ap.direction.setFromMatrixPosition(Sp.matrixWorld),lp.setFromMatrixPosition(Sp.target.matrixWorld),Ap.direction.sub(lp),Ap.direction.transformDirection(vp),mp++}else if(Sp.isSpotLight){const Ap=sp.spot[yp];Ap.position.setFromMatrixPosition(Sp.matrixWorld),Ap.position.applyMatrix4(vp),Ap.direction.setFromMatrixPosition(Sp.matrixWorld),lp.setFromMatrixPosition(Sp.target.matrixWorld),Ap.direction.sub(lp),Ap.direction.transformDirection(vp),yp++}else if(Sp.isRectAreaLight){const Ap=sp.rectArea[xp];Ap.position.setFromMatrixPosition(Sp.matrixWorld),Ap.position.applyMatrix4(vp),cp.identity(),up.copy(Sp.matrixWorld),up.premultiply(vp),cp.extractRotation(up),Ap.halfWidth.set(Sp.width*.5,0,0),Ap.halfHeight.set(0,Sp.height*.5,0),Ap.halfWidth.applyMatrix4(cp),Ap.halfHeight.applyMatrix4(cp),xp++}else if(Sp.isPointLight){const Ap=sp.point[gp];Ap.position.setFromMatrixPosition(Sp.matrixWorld),Ap.position.applyMatrix4(vp),gp++}else if(Sp.isHemisphereLight){const Ap=sp.hemi[_p];Ap.direction.setFromMatrixPosition(Sp.matrixWorld),Ap.direction.transformDirection(vp),_p++}}}return{setup:dp,setupView:hp,state:sp}}function WebGLRenderState(rp,_d){const np=new WebGLLights(rp,_d),ap=[],sp=[];function lp(){ap.length=0,sp.length=0}function up(pp){ap.push(pp)}function cp(pp){sp.push(pp)}function dp(pp){np.setup(ap,pp)}function hp(pp){np.setupView(ap,pp)}return{init:lp,state:{lightsArray:ap,shadowsArray:sp,lights:np},setupLights:dp,setupLightsView:hp,pushLight:up,pushShadow:cp}}function WebGLRenderStates(rp,_d){let np=new WeakMap;function ap(lp,up=0){const cp=np.get(lp);let dp;return cp===void 0?(dp=new WebGLRenderState(rp,_d),np.set(lp,[dp])):up>=cp.length?(dp=new WebGLRenderState(rp,_d),cp.push(dp)):dp=cp[up],dp}function sp(){np=new WeakMap}return{get:ap,dispose:sp}}class MeshDepthMaterial extends Material{constructor(_d){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_d)}copy(_d){return super.copy(_d),this.depthPacking=_d.depthPacking,this.map=_d.map,this.alphaMap=_d.alphaMap,this.displacementMap=_d.displacementMap,this.displacementScale=_d.displacementScale,this.displacementBias=_d.displacementBias,this.wireframe=_d.wireframe,this.wireframeLinewidth=_d.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(_d){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_d)}copy(_d){return super.copy(_d),this.map=_d.map,this.alphaMap=_d.alphaMap,this.displacementMap=_d.displacementMap,this.displacementScale=_d.displacementScale,this.displacementBias=_d.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(rp,_d,np){let ap=new Frustum;const sp=new Vector2,lp=new Vector2,up=new Vector4,cp=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),dp=new MeshDistanceMaterial,hp={},fp=np.maxTextureSize,pp={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},mp=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),gp=mp.clone();gp.defines.HORIZONTAL_PASS=1;const yp=new BufferGeometry;yp.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const xp=new Mesh(yp,mp),_p=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let vp=this.type;this.render=function(Rp,Tp,Mp){if(_p.enabled===!1||_p.autoUpdate===!1&&_p.needsUpdate===!1||Rp.length===0)return;const Op=rp.getRenderTarget(),Pp=rp.getActiveCubeFace(),$p=rp.getActiveMipmapLevel(),zp=rp.state;zp.setBlending(NoBlending),zp.buffers.color.setClear(1,1,1,1),zp.buffers.depth.setTest(!0),zp.setScissorTest(!1);const Dp=vp!==VSMShadowMap&&this.type===VSMShadowMap,Fp=vp===VSMShadowMap&&this.type!==VSMShadowMap;for(let jp=0,Lp=Rp.length;jp<Lp;jp++){const Bp=Rp[jp],Ip=Bp.shadow;if(Ip===void 0){console.warn("THREE.WebGLShadowMap:",Bp,"has no shadow.");continue}if(Ip.autoUpdate===!1&&Ip.needsUpdate===!1)continue;sp.copy(Ip.mapSize);const kp=Ip.getFrameExtents();if(sp.multiply(kp),lp.copy(Ip.mapSize),(sp.x>fp||sp.y>fp)&&(sp.x>fp&&(lp.x=Math.floor(fp/kp.x),sp.x=lp.x*kp.x,Ip.mapSize.x=lp.x),sp.y>fp&&(lp.y=Math.floor(fp/kp.y),sp.y=lp.y*kp.y,Ip.mapSize.y=lp.y)),Ip.map===null||Dp===!0||Fp===!0){const Gp=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};Ip.map!==null&&Ip.map.dispose(),Ip.map=new WebGLRenderTarget(sp.x,sp.y,Gp),Ip.map.texture.name=Bp.name+".shadowMap",Ip.camera.updateProjectionMatrix()}rp.setRenderTarget(Ip.map),rp.clear();const Up=Ip.getViewportCount();for(let Gp=0;Gp<Up;Gp++){const Wp=Ip.getViewport(Gp);up.set(lp.x*Wp.x,lp.y*Wp.y,lp.x*Wp.z,lp.y*Wp.w),zp.viewport(up),Ip.updateMatrices(Bp,Gp),ap=Ip.getFrustum(),Sp(Tp,Mp,Ip.camera,Bp,this.type)}Ip.isPointLightShadow!==!0&&this.type===VSMShadowMap&&bp(Ip,Mp),Ip.needsUpdate=!1}vp=this.type,_p.needsUpdate=!1,rp.setRenderTarget(Op,Pp,$p)};function bp(Rp,Tp){const Mp=_d.update(xp);mp.defines.VSM_SAMPLES!==Rp.blurSamples&&(mp.defines.VSM_SAMPLES=Rp.blurSamples,gp.defines.VSM_SAMPLES=Rp.blurSamples,mp.needsUpdate=!0,gp.needsUpdate=!0),Rp.mapPass===null&&(Rp.mapPass=new WebGLRenderTarget(sp.x,sp.y)),mp.uniforms.shadow_pass.value=Rp.map.texture,mp.uniforms.resolution.value=Rp.mapSize,mp.uniforms.radius.value=Rp.radius,rp.setRenderTarget(Rp.mapPass),rp.clear(),rp.renderBufferDirect(Tp,null,Mp,mp,xp,null),gp.uniforms.shadow_pass.value=Rp.mapPass.texture,gp.uniforms.resolution.value=Rp.mapSize,gp.uniforms.radius.value=Rp.radius,rp.setRenderTarget(Rp.map),rp.clear(),rp.renderBufferDirect(Tp,null,Mp,gp,xp,null)}function Ep(Rp,Tp,Mp,Op){let Pp=null;const $p=Mp.isPointLight===!0?Rp.customDistanceMaterial:Rp.customDepthMaterial;if($p!==void 0)Pp=$p;else if(Pp=Mp.isPointLight===!0?dp:cp,rp.localClippingEnabled&&Tp.clipShadows===!0&&Array.isArray(Tp.clippingPlanes)&&Tp.clippingPlanes.length!==0||Tp.displacementMap&&Tp.displacementScale!==0||Tp.alphaMap&&Tp.alphaTest>0||Tp.map&&Tp.alphaTest>0){const zp=Pp.uuid,Dp=Tp.uuid;let Fp=hp[zp];Fp===void 0&&(Fp={},hp[zp]=Fp);let jp=Fp[Dp];jp===void 0&&(jp=Pp.clone(),Fp[Dp]=jp,Tp.addEventListener("dispose",Ap)),Pp=jp}if(Pp.visible=Tp.visible,Pp.wireframe=Tp.wireframe,Op===VSMShadowMap?Pp.side=Tp.shadowSide!==null?Tp.shadowSide:Tp.side:Pp.side=Tp.shadowSide!==null?Tp.shadowSide:pp[Tp.side],Pp.alphaMap=Tp.alphaMap,Pp.alphaTest=Tp.alphaTest,Pp.map=Tp.map,Pp.clipShadows=Tp.clipShadows,Pp.clippingPlanes=Tp.clippingPlanes,Pp.clipIntersection=Tp.clipIntersection,Pp.displacementMap=Tp.displacementMap,Pp.displacementScale=Tp.displacementScale,Pp.displacementBias=Tp.displacementBias,Pp.wireframeLinewidth=Tp.wireframeLinewidth,Pp.linewidth=Tp.linewidth,Mp.isPointLight===!0&&Pp.isMeshDistanceMaterial===!0){const zp=rp.properties.get(Pp);zp.light=Mp}return Pp}function Sp(Rp,Tp,Mp,Op,Pp){if(Rp.visible===!1)return;if(Rp.layers.test(Tp.layers)&&(Rp.isMesh||Rp.isLine||Rp.isPoints)&&(Rp.castShadow||Rp.receiveShadow&&Pp===VSMShadowMap)&&(!Rp.frustumCulled||ap.intersectsObject(Rp))){Rp.modelViewMatrix.multiplyMatrices(Mp.matrixWorldInverse,Rp.matrixWorld);const Dp=_d.update(Rp),Fp=Rp.material;if(Array.isArray(Fp)){const jp=Dp.groups;for(let Lp=0,Bp=jp.length;Lp<Bp;Lp++){const Ip=jp[Lp],kp=Fp[Ip.materialIndex];if(kp&&kp.visible){const Up=Ep(Rp,kp,Op,Pp);Rp.onBeforeShadow(rp,Rp,Tp,Mp,Dp,Up,Ip),rp.renderBufferDirect(Mp,null,Dp,Up,Rp,Ip),Rp.onAfterShadow(rp,Rp,Tp,Mp,Dp,Up,Ip)}}}else if(Fp.visible){const jp=Ep(Rp,Fp,Op,Pp);Rp.onBeforeShadow(rp,Rp,Tp,Mp,Dp,jp,null),rp.renderBufferDirect(Mp,null,Dp,jp,Rp,null),Rp.onAfterShadow(rp,Rp,Tp,Mp,Dp,jp,null)}}const zp=Rp.children;for(let Dp=0,Fp=zp.length;Dp<Fp;Dp++)Sp(zp[Dp],Tp,Mp,Op,Pp)}function Ap(Rp){Rp.target.removeEventListener("dispose",Ap);for(const Mp in hp){const Op=hp[Mp],Pp=Rp.target.uuid;Pp in Op&&(Op[Pp].dispose(),delete Op[Pp])}}}function WebGLState(rp,_d,np){const ap=np.isWebGL2;function sp(){let im=!1;const Am=new Vector4;let Lm=null;const Um=new Vector4(0,0,0,0);return{setMask:function(Gm){Lm!==Gm&&!im&&(rp.colorMask(Gm,Gm,Gm,Gm),Lm=Gm)},setLocked:function(Gm){im=Gm},setClear:function(Gm,ev,nv,gv,xv){xv===!0&&(Gm*=gv,ev*=gv,nv*=gv),Am.set(Gm,ev,nv,gv),Um.equals(Am)===!1&&(rp.clearColor(Gm,ev,nv,gv),Um.copy(Am))},reset:function(){im=!1,Lm=null,Um.set(-1,0,0,0)}}}function lp(){let im=!1,Am=null,Lm=null,Um=null;return{setTest:function(Gm){Gm?gm(rp.DEPTH_TEST):Mm(rp.DEPTH_TEST)},setMask:function(Gm){Am!==Gm&&!im&&(rp.depthMask(Gm),Am=Gm)},setFunc:function(Gm){if(Lm!==Gm){switch(Gm){case NeverDepth:rp.depthFunc(rp.NEVER);break;case AlwaysDepth:rp.depthFunc(rp.ALWAYS);break;case LessDepth:rp.depthFunc(rp.LESS);break;case LessEqualDepth:rp.depthFunc(rp.LEQUAL);break;case EqualDepth:rp.depthFunc(rp.EQUAL);break;case GreaterEqualDepth:rp.depthFunc(rp.GEQUAL);break;case GreaterDepth:rp.depthFunc(rp.GREATER);break;case NotEqualDepth:rp.depthFunc(rp.NOTEQUAL);break;default:rp.depthFunc(rp.LEQUAL)}Lm=Gm}},setLocked:function(Gm){im=Gm},setClear:function(Gm){Um!==Gm&&(rp.clearDepth(Gm),Um=Gm)},reset:function(){im=!1,Am=null,Lm=null,Um=null}}}function up(){let im=!1,Am=null,Lm=null,Um=null,Gm=null,ev=null,nv=null,gv=null,xv=null;return{setTest:function(pv){im||(pv?gm(rp.STENCIL_TEST):Mm(rp.STENCIL_TEST))},setMask:function(pv){Am!==pv&&!im&&(rp.stencilMask(pv),Am=pv)},setFunc:function(pv,Iv,Bv){(Lm!==pv||Um!==Iv||Gm!==Bv)&&(rp.stencilFunc(pv,Iv,Bv),Lm=pv,Um=Iv,Gm=Bv)},setOp:function(pv,Iv,Bv){(ev!==pv||nv!==Iv||gv!==Bv)&&(rp.stencilOp(pv,Iv,Bv),ev=pv,nv=Iv,gv=Bv)},setLocked:function(pv){im=pv},setClear:function(pv){xv!==pv&&(rp.clearStencil(pv),xv=pv)},reset:function(){im=!1,Am=null,Lm=null,Um=null,Gm=null,ev=null,nv=null,gv=null,xv=null}}}const cp=new sp,dp=new lp,hp=new up,fp=new WeakMap,pp=new WeakMap;let mp={},gp={},yp=new WeakMap,xp=[],_p=null,vp=!1,bp=null,Ep=null,Sp=null,Ap=null,Rp=null,Tp=null,Mp=null,Op=new Color(0,0,0),Pp=0,$p=!1,zp=null,Dp=null,Fp=null,jp=null,Lp=null;const Bp=rp.getParameter(rp.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Ip=!1,kp=0;const Up=rp.getParameter(rp.VERSION);Up.indexOf("WebGL")!==-1?(kp=parseFloat(/^WebGL (\d)/.exec(Up)[1]),Ip=kp>=1):Up.indexOf("OpenGL ES")!==-1&&(kp=parseFloat(/^OpenGL ES (\d)/.exec(Up)[1]),Ip=kp>=2);let Gp=null,Wp={};const Qp=rp.getParameter(rp.SCISSOR_BOX),Xp=rp.getParameter(rp.VIEWPORT),rm=new Vector4().fromArray(Qp),Kp=new Vector4().fromArray(Xp);function lm(im,Am,Lm,Um){const Gm=new Uint8Array(4),ev=rp.createTexture();rp.bindTexture(im,ev),rp.texParameteri(im,rp.TEXTURE_MIN_FILTER,rp.NEAREST),rp.texParameteri(im,rp.TEXTURE_MAG_FILTER,rp.NEAREST);for(let nv=0;nv<Lm;nv++)ap&&(im===rp.TEXTURE_3D||im===rp.TEXTURE_2D_ARRAY)?rp.texImage3D(Am,0,rp.RGBA,1,1,Um,0,rp.RGBA,rp.UNSIGNED_BYTE,Gm):rp.texImage2D(Am+nv,0,rp.RGBA,1,1,0,rp.RGBA,rp.UNSIGNED_BYTE,Gm);return ev}const cm={};cm[rp.TEXTURE_2D]=lm(rp.TEXTURE_2D,rp.TEXTURE_2D,1),cm[rp.TEXTURE_CUBE_MAP]=lm(rp.TEXTURE_CUBE_MAP,rp.TEXTURE_CUBE_MAP_POSITIVE_X,6),ap&&(cm[rp.TEXTURE_2D_ARRAY]=lm(rp.TEXTURE_2D_ARRAY,rp.TEXTURE_2D_ARRAY,1,1),cm[rp.TEXTURE_3D]=lm(rp.TEXTURE_3D,rp.TEXTURE_3D,1,1)),cp.setClear(0,0,0,1),dp.setClear(1),hp.setClear(0),gm(rp.DEPTH_TEST),dp.setFunc(LessEqualDepth),zm(!1),tm(CullFaceBack),gm(rp.CULL_FACE),fm(NoBlending);function gm(im){mp[im]!==!0&&(rp.enable(im),mp[im]=!0)}function Mm(im){mp[im]!==!1&&(rp.disable(im),mp[im]=!1)}function dm(im,Am){return gp[im]!==Am?(rp.bindFramebuffer(im,Am),gp[im]=Am,ap&&(im===rp.DRAW_FRAMEBUFFER&&(gp[rp.FRAMEBUFFER]=Am),im===rp.FRAMEBUFFER&&(gp[rp.DRAW_FRAMEBUFFER]=Am)),!0):!1}function em(im,Am){let Lm=xp,Um=!1;if(im)if(Lm=yp.get(Am),Lm===void 0&&(Lm=[],yp.set(Am,Lm)),im.isWebGLMultipleRenderTargets){const Gm=im.texture;if(Lm.length!==Gm.length||Lm[0]!==rp.COLOR_ATTACHMENT0){for(let ev=0,nv=Gm.length;ev<nv;ev++)Lm[ev]=rp.COLOR_ATTACHMENT0+ev;Lm.length=Gm.length,Um=!0}}else Lm[0]!==rp.COLOR_ATTACHMENT0&&(Lm[0]=rp.COLOR_ATTACHMENT0,Um=!0);else Lm[0]!==rp.BACK&&(Lm[0]=rp.BACK,Um=!0);Um&&(np.isWebGL2?rp.drawBuffers(Lm):_d.get("WEBGL_draw_buffers").drawBuffersWEBGL(Lm))}function sm(im){return _p!==im?(rp.useProgram(im),_p=im,!0):!1}const Zp={[AddEquation]:rp.FUNC_ADD,[SubtractEquation]:rp.FUNC_SUBTRACT,[ReverseSubtractEquation]:rp.FUNC_REVERSE_SUBTRACT};if(ap)Zp[MinEquation]=rp.MIN,Zp[MaxEquation]=rp.MAX;else{const im=_d.get("EXT_blend_minmax");im!==null&&(Zp[MinEquation]=im.MIN_EXT,Zp[MaxEquation]=im.MAX_EXT)}const mm={[ZeroFactor]:rp.ZERO,[OneFactor]:rp.ONE,[SrcColorFactor]:rp.SRC_COLOR,[SrcAlphaFactor]:rp.SRC_ALPHA,[SrcAlphaSaturateFactor]:rp.SRC_ALPHA_SATURATE,[DstColorFactor]:rp.DST_COLOR,[DstAlphaFactor]:rp.DST_ALPHA,[OneMinusSrcColorFactor]:rp.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:rp.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:rp.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:rp.ONE_MINUS_DST_ALPHA,[ConstantColorFactor]:rp.CONSTANT_COLOR,[OneMinusConstantColorFactor]:rp.ONE_MINUS_CONSTANT_COLOR,[ConstantAlphaFactor]:rp.CONSTANT_ALPHA,[OneMinusConstantAlphaFactor]:rp.ONE_MINUS_CONSTANT_ALPHA};function fm(im,Am,Lm,Um,Gm,ev,nv,gv,xv,pv){if(im===NoBlending){vp===!0&&(Mm(rp.BLEND),vp=!1);return}if(vp===!1&&(gm(rp.BLEND),vp=!0),im!==CustomBlending){if(im!==bp||pv!==$p){if((Ep!==AddEquation||Rp!==AddEquation)&&(rp.blendEquation(rp.FUNC_ADD),Ep=AddEquation,Rp=AddEquation),pv)switch(im){case NormalBlending:rp.blendFuncSeparate(rp.ONE,rp.ONE_MINUS_SRC_ALPHA,rp.ONE,rp.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:rp.blendFunc(rp.ONE,rp.ONE);break;case SubtractiveBlending:rp.blendFuncSeparate(rp.ZERO,rp.ONE_MINUS_SRC_COLOR,rp.ZERO,rp.ONE);break;case MultiplyBlending:rp.blendFuncSeparate(rp.ZERO,rp.SRC_COLOR,rp.ZERO,rp.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",im);break}else switch(im){case NormalBlending:rp.blendFuncSeparate(rp.SRC_ALPHA,rp.ONE_MINUS_SRC_ALPHA,rp.ONE,rp.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:rp.blendFunc(rp.SRC_ALPHA,rp.ONE);break;case SubtractiveBlending:rp.blendFuncSeparate(rp.ZERO,rp.ONE_MINUS_SRC_COLOR,rp.ZERO,rp.ONE);break;case MultiplyBlending:rp.blendFunc(rp.ZERO,rp.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",im);break}Sp=null,Ap=null,Tp=null,Mp=null,Op.set(0,0,0),Pp=0,bp=im,$p=pv}return}Gm=Gm||Am,ev=ev||Lm,nv=nv||Um,(Am!==Ep||Gm!==Rp)&&(rp.blendEquationSeparate(Zp[Am],Zp[Gm]),Ep=Am,Rp=Gm),(Lm!==Sp||Um!==Ap||ev!==Tp||nv!==Mp)&&(rp.blendFuncSeparate(mm[Lm],mm[Um],mm[ev],mm[nv]),Sp=Lm,Ap=Um,Tp=ev,Mp=nv),(gv.equals(Op)===!1||xv!==Pp)&&(rp.blendColor(gv.r,gv.g,gv.b,xv),Op.copy(gv),Pp=xv),bp=im,$p=!1}function _m(im,Am){im.side===DoubleSide?Mm(rp.CULL_FACE):gm(rp.CULL_FACE);let Lm=im.side===BackSide;Am&&(Lm=!Lm),zm(Lm),im.blending===NormalBlending&&im.transparent===!1?fm(NoBlending):fm(im.blending,im.blendEquation,im.blendSrc,im.blendDst,im.blendEquationAlpha,im.blendSrcAlpha,im.blendDstAlpha,im.blendColor,im.blendAlpha,im.premultipliedAlpha),dp.setFunc(im.depthFunc),dp.setTest(im.depthTest),dp.setMask(im.depthWrite),cp.setMask(im.colorWrite);const Um=im.stencilWrite;hp.setTest(Um),Um&&(hp.setMask(im.stencilWriteMask),hp.setFunc(im.stencilFunc,im.stencilRef,im.stencilFuncMask),hp.setOp(im.stencilFail,im.stencilZFail,im.stencilZPass)),pm(im.polygonOffset,im.polygonOffsetFactor,im.polygonOffsetUnits),im.alphaToCoverage===!0?gm(rp.SAMPLE_ALPHA_TO_COVERAGE):Mm(rp.SAMPLE_ALPHA_TO_COVERAGE)}function zm(im){zp!==im&&(im?rp.frontFace(rp.CW):rp.frontFace(rp.CCW),zp=im)}function tm(im){im!==CullFaceNone?(gm(rp.CULL_FACE),im!==Dp&&(im===CullFaceBack?rp.cullFace(rp.BACK):im===CullFaceFront?rp.cullFace(rp.FRONT):rp.cullFace(rp.FRONT_AND_BACK))):Mm(rp.CULL_FACE),Dp=im}function Jp(im){im!==Fp&&(Ip&&rp.lineWidth(im),Fp=im)}function pm(im,Am,Lm){im?(gm(rp.POLYGON_OFFSET_FILL),(jp!==Am||Lp!==Lm)&&(rp.polygonOffset(Am,Lm),jp=Am,Lp=Lm)):Mm(rp.POLYGON_OFFSET_FILL)}function km(im){im?gm(rp.SCISSOR_TEST):Mm(rp.SCISSOR_TEST)}function ym(im){im===void 0&&(im=rp.TEXTURE0+Bp-1),Gp!==im&&(rp.activeTexture(im),Gp=im)}function Em(im,Am,Lm){Lm===void 0&&(Gp===null?Lm=rp.TEXTURE0+Bp-1:Lm=Gp);let Um=Wp[Lm];Um===void 0&&(Um={type:void 0,texture:void 0},Wp[Lm]=Um),(Um.type!==im||Um.texture!==Am)&&(Gp!==Lm&&(rp.activeTexture(Lm),Gp=Lm),rp.bindTexture(im,Am||cm[im]),Um.type=im,Um.texture=Am)}function Bm(){const im=Wp[Gp];im!==void 0&&im.type!==void 0&&(rp.bindTexture(im.type,null),im.type=void 0,im.texture=void 0)}function Pm(){try{rp.compressedTexImage2D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function Im(){try{rp.compressedTexImage3D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function Dm(){try{rp.texSubImage2D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function jm(){try{rp.texSubImage3D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function Fm(){try{rp.compressedTexSubImage2D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function av(){try{rp.compressedTexSubImage3D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function lv(){try{rp.texStorage2D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function tv(){try{rp.texStorage3D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function Jm(){try{rp.texImage2D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function um(){try{rp.texImage3D.apply(rp,arguments)}catch(im){console.error("THREE.WebGLState:",im)}}function Yp(im){rm.equals(im)===!1&&(rp.scissor(im.x,im.y,im.z,im.w),rm.copy(im))}function hm(im){Kp.equals(im)===!1&&(rp.viewport(im.x,im.y,im.z,im.w),Kp.copy(im))}function wm(im,Am){let Lm=pp.get(Am);Lm===void 0&&(Lm=new WeakMap,pp.set(Am,Lm));let Um=Lm.get(im);Um===void 0&&(Um=rp.getUniformBlockIndex(Am,im.name),Lm.set(im,Um))}function Cm(im,Am){const Um=pp.get(Am).get(im);fp.get(Am)!==Um&&(rp.uniformBlockBinding(Am,Um,im.__bindingPointIndex),fp.set(Am,Um))}function Vm(){rp.disable(rp.BLEND),rp.disable(rp.CULL_FACE),rp.disable(rp.DEPTH_TEST),rp.disable(rp.POLYGON_OFFSET_FILL),rp.disable(rp.SCISSOR_TEST),rp.disable(rp.STENCIL_TEST),rp.disable(rp.SAMPLE_ALPHA_TO_COVERAGE),rp.blendEquation(rp.FUNC_ADD),rp.blendFunc(rp.ONE,rp.ZERO),rp.blendFuncSeparate(rp.ONE,rp.ZERO,rp.ONE,rp.ZERO),rp.blendColor(0,0,0,0),rp.colorMask(!0,!0,!0,!0),rp.clearColor(0,0,0,0),rp.depthMask(!0),rp.depthFunc(rp.LESS),rp.clearDepth(1),rp.stencilMask(4294967295),rp.stencilFunc(rp.ALWAYS,0,4294967295),rp.stencilOp(rp.KEEP,rp.KEEP,rp.KEEP),rp.clearStencil(0),rp.cullFace(rp.BACK),rp.frontFace(rp.CCW),rp.polygonOffset(0,0),rp.activeTexture(rp.TEXTURE0),rp.bindFramebuffer(rp.FRAMEBUFFER,null),ap===!0&&(rp.bindFramebuffer(rp.DRAW_FRAMEBUFFER,null),rp.bindFramebuffer(rp.READ_FRAMEBUFFER,null)),rp.useProgram(null),rp.lineWidth(1),rp.scissor(0,0,rp.canvas.width,rp.canvas.height),rp.viewport(0,0,rp.canvas.width,rp.canvas.height),mp={},Gp=null,Wp={},gp={},yp=new WeakMap,xp=[],_p=null,vp=!1,bp=null,Ep=null,Sp=null,Ap=null,Rp=null,Tp=null,Mp=null,Op=new Color(0,0,0),Pp=0,$p=!1,zp=null,Dp=null,Fp=null,jp=null,Lp=null,rm.set(0,0,rp.canvas.width,rp.canvas.height),Kp.set(0,0,rp.canvas.width,rp.canvas.height),cp.reset(),dp.reset(),hp.reset()}return{buffers:{color:cp,depth:dp,stencil:hp},enable:gm,disable:Mm,bindFramebuffer:dm,drawBuffers:em,useProgram:sm,setBlending:fm,setMaterial:_m,setFlipSided:zm,setCullFace:tm,setLineWidth:Jp,setPolygonOffset:pm,setScissorTest:km,activeTexture:ym,bindTexture:Em,unbindTexture:Bm,compressedTexImage2D:Pm,compressedTexImage3D:Im,texImage2D:Jm,texImage3D:um,updateUBOMapping:wm,uniformBlockBinding:Cm,texStorage2D:lv,texStorage3D:tv,texSubImage2D:Dm,texSubImage3D:jm,compressedTexSubImage2D:Fm,compressedTexSubImage3D:av,scissor:Yp,viewport:hm,reset:Vm}}function WebGLTextures(rp,_d,np,ap,sp,lp,up){const cp=sp.isWebGL2,dp=_d.has("WEBGL_multisampled_render_to_texture")?_d.get("WEBGL_multisampled_render_to_texture"):null,hp=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),fp=new WeakMap;let pp;const mp=new WeakMap;let gp=!1;try{gp=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function yp(tm,Jp){return gp?new OffscreenCanvas(tm,Jp):createElementNS("canvas")}function xp(tm,Jp,pm,km){let ym=1;if((tm.width>km||tm.height>km)&&(ym=km/Math.max(tm.width,tm.height)),ym<1||Jp===!0)if(typeof HTMLImageElement<"u"&&tm instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&tm instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&tm instanceof ImageBitmap){const Em=Jp?floorPowerOfTwo:Math.floor,Bm=Em(ym*tm.width),Pm=Em(ym*tm.height);pp===void 0&&(pp=yp(Bm,Pm));const Im=pm?yp(Bm,Pm):pp;return Im.width=Bm,Im.height=Pm,Im.getContext("2d").drawImage(tm,0,0,Bm,Pm),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+tm.width+"x"+tm.height+") to ("+Bm+"x"+Pm+")."),Im}else return"data"in tm&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+tm.width+"x"+tm.height+")."),tm;return tm}function _p(tm){return isPowerOfTwo(tm.width)&&isPowerOfTwo(tm.height)}function vp(tm){return cp?!1:tm.wrapS!==ClampToEdgeWrapping||tm.wrapT!==ClampToEdgeWrapping||tm.minFilter!==NearestFilter&&tm.minFilter!==LinearFilter}function bp(tm,Jp){return tm.generateMipmaps&&Jp&&tm.minFilter!==NearestFilter&&tm.minFilter!==LinearFilter}function Ep(tm){rp.generateMipmap(tm)}function Sp(tm,Jp,pm,km,ym=!1){if(cp===!1)return Jp;if(tm!==null){if(rp[tm]!==void 0)return rp[tm];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+tm+"'")}let Em=Jp;if(Jp===rp.RED&&(pm===rp.FLOAT&&(Em=rp.R32F),pm===rp.HALF_FLOAT&&(Em=rp.R16F),pm===rp.UNSIGNED_BYTE&&(Em=rp.R8)),Jp===rp.RED_INTEGER&&(pm===rp.UNSIGNED_BYTE&&(Em=rp.R8UI),pm===rp.UNSIGNED_SHORT&&(Em=rp.R16UI),pm===rp.UNSIGNED_INT&&(Em=rp.R32UI),pm===rp.BYTE&&(Em=rp.R8I),pm===rp.SHORT&&(Em=rp.R16I),pm===rp.INT&&(Em=rp.R32I)),Jp===rp.RG&&(pm===rp.FLOAT&&(Em=rp.RG32F),pm===rp.HALF_FLOAT&&(Em=rp.RG16F),pm===rp.UNSIGNED_BYTE&&(Em=rp.RG8)),Jp===rp.RGBA){const Bm=ym?LinearTransfer:ColorManagement.getTransfer(km);pm===rp.FLOAT&&(Em=rp.RGBA32F),pm===rp.HALF_FLOAT&&(Em=rp.RGBA16F),pm===rp.UNSIGNED_BYTE&&(Em=Bm===SRGBTransfer?rp.SRGB8_ALPHA8:rp.RGBA8),pm===rp.UNSIGNED_SHORT_4_4_4_4&&(Em=rp.RGBA4),pm===rp.UNSIGNED_SHORT_5_5_5_1&&(Em=rp.RGB5_A1)}return(Em===rp.R16F||Em===rp.R32F||Em===rp.RG16F||Em===rp.RG32F||Em===rp.RGBA16F||Em===rp.RGBA32F)&&_d.get("EXT_color_buffer_float"),Em}function Ap(tm,Jp,pm){return bp(tm,pm)===!0||tm.isFramebufferTexture&&tm.minFilter!==NearestFilter&&tm.minFilter!==LinearFilter?Math.log2(Math.max(Jp.width,Jp.height))+1:tm.mipmaps!==void 0&&tm.mipmaps.length>0?tm.mipmaps.length:tm.isCompressedTexture&&Array.isArray(tm.image)?Jp.mipmaps.length:1}function Rp(tm){return tm===NearestFilter||tm===NearestMipmapNearestFilter||tm===NearestMipmapLinearFilter?rp.NEAREST:rp.LINEAR}function Tp(tm){const Jp=tm.target;Jp.removeEventListener("dispose",Tp),Op(Jp),Jp.isVideoTexture&&fp.delete(Jp)}function Mp(tm){const Jp=tm.target;Jp.removeEventListener("dispose",Mp),$p(Jp)}function Op(tm){const Jp=ap.get(tm);if(Jp.__webglInit===void 0)return;const pm=tm.source,km=mp.get(pm);if(km){const ym=km[Jp.__cacheKey];ym.usedTimes--,ym.usedTimes===0&&Pp(tm),Object.keys(km).length===0&&mp.delete(pm)}ap.remove(tm)}function Pp(tm){const Jp=ap.get(tm);rp.deleteTexture(Jp.__webglTexture);const pm=tm.source,km=mp.get(pm);delete km[Jp.__cacheKey],up.memory.textures--}function $p(tm){const Jp=tm.texture,pm=ap.get(tm),km=ap.get(Jp);if(km.__webglTexture!==void 0&&(rp.deleteTexture(km.__webglTexture),up.memory.textures--),tm.depthTexture&&tm.depthTexture.dispose(),tm.isWebGLCubeRenderTarget)for(let ym=0;ym<6;ym++){if(Array.isArray(pm.__webglFramebuffer[ym]))for(let Em=0;Em<pm.__webglFramebuffer[ym].length;Em++)rp.deleteFramebuffer(pm.__webglFramebuffer[ym][Em]);else rp.deleteFramebuffer(pm.__webglFramebuffer[ym]);pm.__webglDepthbuffer&&rp.deleteRenderbuffer(pm.__webglDepthbuffer[ym])}else{if(Array.isArray(pm.__webglFramebuffer))for(let ym=0;ym<pm.__webglFramebuffer.length;ym++)rp.deleteFramebuffer(pm.__webglFramebuffer[ym]);else rp.deleteFramebuffer(pm.__webglFramebuffer);if(pm.__webglDepthbuffer&&rp.deleteRenderbuffer(pm.__webglDepthbuffer),pm.__webglMultisampledFramebuffer&&rp.deleteFramebuffer(pm.__webglMultisampledFramebuffer),pm.__webglColorRenderbuffer)for(let ym=0;ym<pm.__webglColorRenderbuffer.length;ym++)pm.__webglColorRenderbuffer[ym]&&rp.deleteRenderbuffer(pm.__webglColorRenderbuffer[ym]);pm.__webglDepthRenderbuffer&&rp.deleteRenderbuffer(pm.__webglDepthRenderbuffer)}if(tm.isWebGLMultipleRenderTargets)for(let ym=0,Em=Jp.length;ym<Em;ym++){const Bm=ap.get(Jp[ym]);Bm.__webglTexture&&(rp.deleteTexture(Bm.__webglTexture),up.memory.textures--),ap.remove(Jp[ym])}ap.remove(Jp),ap.remove(tm)}let zp=0;function Dp(){zp=0}function Fp(){const tm=zp;return tm>=sp.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+tm+" texture units while this GPU supports only "+sp.maxTextures),zp+=1,tm}function jp(tm){const Jp=[];return Jp.push(tm.wrapS),Jp.push(tm.wrapT),Jp.push(tm.wrapR||0),Jp.push(tm.magFilter),Jp.push(tm.minFilter),Jp.push(tm.anisotropy),Jp.push(tm.internalFormat),Jp.push(tm.format),Jp.push(tm.type),Jp.push(tm.generateMipmaps),Jp.push(tm.premultiplyAlpha),Jp.push(tm.flipY),Jp.push(tm.unpackAlignment),Jp.push(tm.colorSpace),Jp.join()}function Lp(tm,Jp){const pm=ap.get(tm);if(tm.isVideoTexture&&_m(tm),tm.isRenderTargetTexture===!1&&tm.version>0&&pm.__version!==tm.version){const km=tm.image;if(km===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(km.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{rm(pm,tm,Jp);return}}np.bindTexture(rp.TEXTURE_2D,pm.__webglTexture,rp.TEXTURE0+Jp)}function Bp(tm,Jp){const pm=ap.get(tm);if(tm.version>0&&pm.__version!==tm.version){rm(pm,tm,Jp);return}np.bindTexture(rp.TEXTURE_2D_ARRAY,pm.__webglTexture,rp.TEXTURE0+Jp)}function Ip(tm,Jp){const pm=ap.get(tm);if(tm.version>0&&pm.__version!==tm.version){rm(pm,tm,Jp);return}np.bindTexture(rp.TEXTURE_3D,pm.__webglTexture,rp.TEXTURE0+Jp)}function kp(tm,Jp){const pm=ap.get(tm);if(tm.version>0&&pm.__version!==tm.version){Kp(pm,tm,Jp);return}np.bindTexture(rp.TEXTURE_CUBE_MAP,pm.__webglTexture,rp.TEXTURE0+Jp)}const Up={[RepeatWrapping]:rp.REPEAT,[ClampToEdgeWrapping]:rp.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:rp.MIRRORED_REPEAT},Gp={[NearestFilter]:rp.NEAREST,[NearestMipmapNearestFilter]:rp.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:rp.NEAREST_MIPMAP_LINEAR,[LinearFilter]:rp.LINEAR,[LinearMipmapNearestFilter]:rp.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:rp.LINEAR_MIPMAP_LINEAR},Wp={[NeverCompare]:rp.NEVER,[AlwaysCompare]:rp.ALWAYS,[LessCompare]:rp.LESS,[LessEqualCompare]:rp.LEQUAL,[EqualCompare]:rp.EQUAL,[GreaterEqualCompare]:rp.GEQUAL,[GreaterCompare]:rp.GREATER,[NotEqualCompare]:rp.NOTEQUAL};function Qp(tm,Jp,pm){if(Jp.type===FloatType&&_d.has("OES_texture_float_linear")===!1&&(Jp.magFilter===LinearFilter||Jp.magFilter===LinearMipmapNearestFilter||Jp.magFilter===NearestMipmapLinearFilter||Jp.magFilter===LinearMipmapLinearFilter||Jp.minFilter===LinearFilter||Jp.minFilter===LinearMipmapNearestFilter||Jp.minFilter===NearestMipmapLinearFilter||Jp.minFilter===LinearMipmapLinearFilter)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),pm?(rp.texParameteri(tm,rp.TEXTURE_WRAP_S,Up[Jp.wrapS]),rp.texParameteri(tm,rp.TEXTURE_WRAP_T,Up[Jp.wrapT]),(tm===rp.TEXTURE_3D||tm===rp.TEXTURE_2D_ARRAY)&&rp.texParameteri(tm,rp.TEXTURE_WRAP_R,Up[Jp.wrapR]),rp.texParameteri(tm,rp.TEXTURE_MAG_FILTER,Gp[Jp.magFilter]),rp.texParameteri(tm,rp.TEXTURE_MIN_FILTER,Gp[Jp.minFilter])):(rp.texParameteri(tm,rp.TEXTURE_WRAP_S,rp.CLAMP_TO_EDGE),rp.texParameteri(tm,rp.TEXTURE_WRAP_T,rp.CLAMP_TO_EDGE),(tm===rp.TEXTURE_3D||tm===rp.TEXTURE_2D_ARRAY)&&rp.texParameteri(tm,rp.TEXTURE_WRAP_R,rp.CLAMP_TO_EDGE),(Jp.wrapS!==ClampToEdgeWrapping||Jp.wrapT!==ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),rp.texParameteri(tm,rp.TEXTURE_MAG_FILTER,Rp(Jp.magFilter)),rp.texParameteri(tm,rp.TEXTURE_MIN_FILTER,Rp(Jp.minFilter)),Jp.minFilter!==NearestFilter&&Jp.minFilter!==LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),Jp.compareFunction&&(rp.texParameteri(tm,rp.TEXTURE_COMPARE_MODE,rp.COMPARE_REF_TO_TEXTURE),rp.texParameteri(tm,rp.TEXTURE_COMPARE_FUNC,Wp[Jp.compareFunction])),_d.has("EXT_texture_filter_anisotropic")===!0){const km=_d.get("EXT_texture_filter_anisotropic");if(Jp.magFilter===NearestFilter||Jp.minFilter!==NearestMipmapLinearFilter&&Jp.minFilter!==LinearMipmapLinearFilter||Jp.type===FloatType&&_d.has("OES_texture_float_linear")===!1||cp===!1&&Jp.type===HalfFloatType&&_d.has("OES_texture_half_float_linear")===!1)return;(Jp.anisotropy>1||ap.get(Jp).__currentAnisotropy)&&(rp.texParameterf(tm,km.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Jp.anisotropy,sp.getMaxAnisotropy())),ap.get(Jp).__currentAnisotropy=Jp.anisotropy)}}function Xp(tm,Jp){let pm=!1;tm.__webglInit===void 0&&(tm.__webglInit=!0,Jp.addEventListener("dispose",Tp));const km=Jp.source;let ym=mp.get(km);ym===void 0&&(ym={},mp.set(km,ym));const Em=jp(Jp);if(Em!==tm.__cacheKey){ym[Em]===void 0&&(ym[Em]={texture:rp.createTexture(),usedTimes:0},up.memory.textures++,pm=!0),ym[Em].usedTimes++;const Bm=ym[tm.__cacheKey];Bm!==void 0&&(ym[tm.__cacheKey].usedTimes--,Bm.usedTimes===0&&Pp(Jp)),tm.__cacheKey=Em,tm.__webglTexture=ym[Em].texture}return pm}function rm(tm,Jp,pm){let km=rp.TEXTURE_2D;(Jp.isDataArrayTexture||Jp.isCompressedArrayTexture)&&(km=rp.TEXTURE_2D_ARRAY),Jp.isData3DTexture&&(km=rp.TEXTURE_3D);const ym=Xp(tm,Jp),Em=Jp.source;np.bindTexture(km,tm.__webglTexture,rp.TEXTURE0+pm);const Bm=ap.get(Em);if(Em.version!==Bm.__version||ym===!0){np.activeTexture(rp.TEXTURE0+pm);const Pm=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),Im=Jp.colorSpace===NoColorSpace$1?null:ColorManagement.getPrimaries(Jp.colorSpace),Dm=Jp.colorSpace===NoColorSpace$1||Pm===Im?rp.NONE:rp.BROWSER_DEFAULT_WEBGL;rp.pixelStorei(rp.UNPACK_FLIP_Y_WEBGL,Jp.flipY),rp.pixelStorei(rp.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Jp.premultiplyAlpha),rp.pixelStorei(rp.UNPACK_ALIGNMENT,Jp.unpackAlignment),rp.pixelStorei(rp.UNPACK_COLORSPACE_CONVERSION_WEBGL,Dm);const jm=vp(Jp)&&_p(Jp.image)===!1;let Fm=xp(Jp.image,jm,!1,sp.maxTextureSize);Fm=zm(Jp,Fm);const av=_p(Fm)||cp,lv=lp.convert(Jp.format,Jp.colorSpace);let tv=lp.convert(Jp.type),Jm=Sp(Jp.internalFormat,lv,tv,Jp.colorSpace,Jp.isVideoTexture);Qp(km,Jp,av);let um;const Yp=Jp.mipmaps,hm=cp&&Jp.isVideoTexture!==!0&&Jm!==RGB_ETC1_Format,wm=Bm.__version===void 0||ym===!0,Cm=Em.dataReady,Vm=Ap(Jp,Fm,av);if(Jp.isDepthTexture)Jm=rp.DEPTH_COMPONENT,cp?Jp.type===FloatType?Jm=rp.DEPTH_COMPONENT32F:Jp.type===UnsignedIntType?Jm=rp.DEPTH_COMPONENT24:Jp.type===UnsignedInt248Type?Jm=rp.DEPTH24_STENCIL8:Jm=rp.DEPTH_COMPONENT16:Jp.type===FloatType&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Jp.format===DepthFormat&&Jm===rp.DEPTH_COMPONENT&&Jp.type!==UnsignedShortType&&Jp.type!==UnsignedIntType&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Jp.type=UnsignedIntType,tv=lp.convert(Jp.type)),Jp.format===DepthStencilFormat&&Jm===rp.DEPTH_COMPONENT&&(Jm=rp.DEPTH_STENCIL,Jp.type!==UnsignedInt248Type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Jp.type=UnsignedInt248Type,tv=lp.convert(Jp.type))),wm&&(hm?np.texStorage2D(rp.TEXTURE_2D,1,Jm,Fm.width,Fm.height):np.texImage2D(rp.TEXTURE_2D,0,Jm,Fm.width,Fm.height,0,lv,tv,null));else if(Jp.isDataTexture)if(Yp.length>0&&av){hm&&wm&&np.texStorage2D(rp.TEXTURE_2D,Vm,Jm,Yp[0].width,Yp[0].height);for(let im=0,Am=Yp.length;im<Am;im++)um=Yp[im],hm?Cm&&np.texSubImage2D(rp.TEXTURE_2D,im,0,0,um.width,um.height,lv,tv,um.data):np.texImage2D(rp.TEXTURE_2D,im,Jm,um.width,um.height,0,lv,tv,um.data);Jp.generateMipmaps=!1}else hm?(wm&&np.texStorage2D(rp.TEXTURE_2D,Vm,Jm,Fm.width,Fm.height),Cm&&np.texSubImage2D(rp.TEXTURE_2D,0,0,0,Fm.width,Fm.height,lv,tv,Fm.data)):np.texImage2D(rp.TEXTURE_2D,0,Jm,Fm.width,Fm.height,0,lv,tv,Fm.data);else if(Jp.isCompressedTexture)if(Jp.isCompressedArrayTexture){hm&&wm&&np.texStorage3D(rp.TEXTURE_2D_ARRAY,Vm,Jm,Yp[0].width,Yp[0].height,Fm.depth);for(let im=0,Am=Yp.length;im<Am;im++)um=Yp[im],Jp.format!==RGBAFormat?lv!==null?hm?Cm&&np.compressedTexSubImage3D(rp.TEXTURE_2D_ARRAY,im,0,0,0,um.width,um.height,Fm.depth,lv,um.data,0,0):np.compressedTexImage3D(rp.TEXTURE_2D_ARRAY,im,Jm,um.width,um.height,Fm.depth,0,um.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):hm?Cm&&np.texSubImage3D(rp.TEXTURE_2D_ARRAY,im,0,0,0,um.width,um.height,Fm.depth,lv,tv,um.data):np.texImage3D(rp.TEXTURE_2D_ARRAY,im,Jm,um.width,um.height,Fm.depth,0,lv,tv,um.data)}else{hm&&wm&&np.texStorage2D(rp.TEXTURE_2D,Vm,Jm,Yp[0].width,Yp[0].height);for(let im=0,Am=Yp.length;im<Am;im++)um=Yp[im],Jp.format!==RGBAFormat?lv!==null?hm?Cm&&np.compressedTexSubImage2D(rp.TEXTURE_2D,im,0,0,um.width,um.height,lv,um.data):np.compressedTexImage2D(rp.TEXTURE_2D,im,Jm,um.width,um.height,0,um.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):hm?Cm&&np.texSubImage2D(rp.TEXTURE_2D,im,0,0,um.width,um.height,lv,tv,um.data):np.texImage2D(rp.TEXTURE_2D,im,Jm,um.width,um.height,0,lv,tv,um.data)}else if(Jp.isDataArrayTexture)hm?(wm&&np.texStorage3D(rp.TEXTURE_2D_ARRAY,Vm,Jm,Fm.width,Fm.height,Fm.depth),Cm&&np.texSubImage3D(rp.TEXTURE_2D_ARRAY,0,0,0,0,Fm.width,Fm.height,Fm.depth,lv,tv,Fm.data)):np.texImage3D(rp.TEXTURE_2D_ARRAY,0,Jm,Fm.width,Fm.height,Fm.depth,0,lv,tv,Fm.data);else if(Jp.isData3DTexture)hm?(wm&&np.texStorage3D(rp.TEXTURE_3D,Vm,Jm,Fm.width,Fm.height,Fm.depth),Cm&&np.texSubImage3D(rp.TEXTURE_3D,0,0,0,0,Fm.width,Fm.height,Fm.depth,lv,tv,Fm.data)):np.texImage3D(rp.TEXTURE_3D,0,Jm,Fm.width,Fm.height,Fm.depth,0,lv,tv,Fm.data);else if(Jp.isFramebufferTexture){if(wm)if(hm)np.texStorage2D(rp.TEXTURE_2D,Vm,Jm,Fm.width,Fm.height);else{let im=Fm.width,Am=Fm.height;for(let Lm=0;Lm<Vm;Lm++)np.texImage2D(rp.TEXTURE_2D,Lm,Jm,im,Am,0,lv,tv,null),im>>=1,Am>>=1}}else if(Yp.length>0&&av){hm&&wm&&np.texStorage2D(rp.TEXTURE_2D,Vm,Jm,Yp[0].width,Yp[0].height);for(let im=0,Am=Yp.length;im<Am;im++)um=Yp[im],hm?Cm&&np.texSubImage2D(rp.TEXTURE_2D,im,0,0,lv,tv,um):np.texImage2D(rp.TEXTURE_2D,im,Jm,lv,tv,um);Jp.generateMipmaps=!1}else hm?(wm&&np.texStorage2D(rp.TEXTURE_2D,Vm,Jm,Fm.width,Fm.height),Cm&&np.texSubImage2D(rp.TEXTURE_2D,0,0,0,lv,tv,Fm)):np.texImage2D(rp.TEXTURE_2D,0,Jm,lv,tv,Fm);bp(Jp,av)&&Ep(km),Bm.__version=Em.version,Jp.onUpdate&&Jp.onUpdate(Jp)}tm.__version=Jp.version}function Kp(tm,Jp,pm){if(Jp.image.length!==6)return;const km=Xp(tm,Jp),ym=Jp.source;np.bindTexture(rp.TEXTURE_CUBE_MAP,tm.__webglTexture,rp.TEXTURE0+pm);const Em=ap.get(ym);if(ym.version!==Em.__version||km===!0){np.activeTexture(rp.TEXTURE0+pm);const Bm=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),Pm=Jp.colorSpace===NoColorSpace$1?null:ColorManagement.getPrimaries(Jp.colorSpace),Im=Jp.colorSpace===NoColorSpace$1||Bm===Pm?rp.NONE:rp.BROWSER_DEFAULT_WEBGL;rp.pixelStorei(rp.UNPACK_FLIP_Y_WEBGL,Jp.flipY),rp.pixelStorei(rp.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Jp.premultiplyAlpha),rp.pixelStorei(rp.UNPACK_ALIGNMENT,Jp.unpackAlignment),rp.pixelStorei(rp.UNPACK_COLORSPACE_CONVERSION_WEBGL,Im);const Dm=Jp.isCompressedTexture||Jp.image[0].isCompressedTexture,jm=Jp.image[0]&&Jp.image[0].isDataTexture,Fm=[];for(let im=0;im<6;im++)!Dm&&!jm?Fm[im]=xp(Jp.image[im],!1,!0,sp.maxCubemapSize):Fm[im]=jm?Jp.image[im].image:Jp.image[im],Fm[im]=zm(Jp,Fm[im]);const av=Fm[0],lv=_p(av)||cp,tv=lp.convert(Jp.format,Jp.colorSpace),Jm=lp.convert(Jp.type),um=Sp(Jp.internalFormat,tv,Jm,Jp.colorSpace),Yp=cp&&Jp.isVideoTexture!==!0,hm=Em.__version===void 0||km===!0,wm=ym.dataReady;let Cm=Ap(Jp,av,lv);Qp(rp.TEXTURE_CUBE_MAP,Jp,lv);let Vm;if(Dm){Yp&&hm&&np.texStorage2D(rp.TEXTURE_CUBE_MAP,Cm,um,av.width,av.height);for(let im=0;im<6;im++){Vm=Fm[im].mipmaps;for(let Am=0;Am<Vm.length;Am++){const Lm=Vm[Am];Jp.format!==RGBAFormat?tv!==null?Yp?wm&&np.compressedTexSubImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,Am,0,0,Lm.width,Lm.height,tv,Lm.data):np.compressedTexImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,Am,um,Lm.width,Lm.height,0,Lm.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Yp?wm&&np.texSubImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,Am,0,0,Lm.width,Lm.height,tv,Jm,Lm.data):np.texImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,Am,um,Lm.width,Lm.height,0,tv,Jm,Lm.data)}}}else{Vm=Jp.mipmaps,Yp&&hm&&(Vm.length>0&&Cm++,np.texStorage2D(rp.TEXTURE_CUBE_MAP,Cm,um,Fm[0].width,Fm[0].height));for(let im=0;im<6;im++)if(jm){Yp?wm&&np.texSubImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,0,0,0,Fm[im].width,Fm[im].height,tv,Jm,Fm[im].data):np.texImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,0,um,Fm[im].width,Fm[im].height,0,tv,Jm,Fm[im].data);for(let Am=0;Am<Vm.length;Am++){const Um=Vm[Am].image[im].image;Yp?wm&&np.texSubImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,Am+1,0,0,Um.width,Um.height,tv,Jm,Um.data):np.texImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,Am+1,um,Um.width,Um.height,0,tv,Jm,Um.data)}}else{Yp?wm&&np.texSubImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,0,0,0,tv,Jm,Fm[im]):np.texImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,0,um,tv,Jm,Fm[im]);for(let Am=0;Am<Vm.length;Am++){const Lm=Vm[Am];Yp?wm&&np.texSubImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,Am+1,0,0,tv,Jm,Lm.image[im]):np.texImage2D(rp.TEXTURE_CUBE_MAP_POSITIVE_X+im,Am+1,um,tv,Jm,Lm.image[im])}}}bp(Jp,lv)&&Ep(rp.TEXTURE_CUBE_MAP),Em.__version=ym.version,Jp.onUpdate&&Jp.onUpdate(Jp)}tm.__version=Jp.version}function lm(tm,Jp,pm,km,ym,Em){const Bm=lp.convert(pm.format,pm.colorSpace),Pm=lp.convert(pm.type),Im=Sp(pm.internalFormat,Bm,Pm,pm.colorSpace);if(!ap.get(Jp).__hasExternalTextures){const jm=Math.max(1,Jp.width>>Em),Fm=Math.max(1,Jp.height>>Em);ym===rp.TEXTURE_3D||ym===rp.TEXTURE_2D_ARRAY?np.texImage3D(ym,Em,Im,jm,Fm,Jp.depth,0,Bm,Pm,null):np.texImage2D(ym,Em,Im,jm,Fm,0,Bm,Pm,null)}np.bindFramebuffer(rp.FRAMEBUFFER,tm),fm(Jp)?dp.framebufferTexture2DMultisampleEXT(rp.FRAMEBUFFER,km,ym,ap.get(pm).__webglTexture,0,mm(Jp)):(ym===rp.TEXTURE_2D||ym>=rp.TEXTURE_CUBE_MAP_POSITIVE_X&&ym<=rp.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&rp.framebufferTexture2D(rp.FRAMEBUFFER,km,ym,ap.get(pm).__webglTexture,Em),np.bindFramebuffer(rp.FRAMEBUFFER,null)}function cm(tm,Jp,pm){if(rp.bindRenderbuffer(rp.RENDERBUFFER,tm),Jp.depthBuffer&&!Jp.stencilBuffer){let km=cp===!0?rp.DEPTH_COMPONENT24:rp.DEPTH_COMPONENT16;if(pm||fm(Jp)){const ym=Jp.depthTexture;ym&&ym.isDepthTexture&&(ym.type===FloatType?km=rp.DEPTH_COMPONENT32F:ym.type===UnsignedIntType&&(km=rp.DEPTH_COMPONENT24));const Em=mm(Jp);fm(Jp)?dp.renderbufferStorageMultisampleEXT(rp.RENDERBUFFER,Em,km,Jp.width,Jp.height):rp.renderbufferStorageMultisample(rp.RENDERBUFFER,Em,km,Jp.width,Jp.height)}else rp.renderbufferStorage(rp.RENDERBUFFER,km,Jp.width,Jp.height);rp.framebufferRenderbuffer(rp.FRAMEBUFFER,rp.DEPTH_ATTACHMENT,rp.RENDERBUFFER,tm)}else if(Jp.depthBuffer&&Jp.stencilBuffer){const km=mm(Jp);pm&&fm(Jp)===!1?rp.renderbufferStorageMultisample(rp.RENDERBUFFER,km,rp.DEPTH24_STENCIL8,Jp.width,Jp.height):fm(Jp)?dp.renderbufferStorageMultisampleEXT(rp.RENDERBUFFER,km,rp.DEPTH24_STENCIL8,Jp.width,Jp.height):rp.renderbufferStorage(rp.RENDERBUFFER,rp.DEPTH_STENCIL,Jp.width,Jp.height),rp.framebufferRenderbuffer(rp.FRAMEBUFFER,rp.DEPTH_STENCIL_ATTACHMENT,rp.RENDERBUFFER,tm)}else{const km=Jp.isWebGLMultipleRenderTargets===!0?Jp.texture:[Jp.texture];for(let ym=0;ym<km.length;ym++){const Em=km[ym],Bm=lp.convert(Em.format,Em.colorSpace),Pm=lp.convert(Em.type),Im=Sp(Em.internalFormat,Bm,Pm,Em.colorSpace),Dm=mm(Jp);pm&&fm(Jp)===!1?rp.renderbufferStorageMultisample(rp.RENDERBUFFER,Dm,Im,Jp.width,Jp.height):fm(Jp)?dp.renderbufferStorageMultisampleEXT(rp.RENDERBUFFER,Dm,Im,Jp.width,Jp.height):rp.renderbufferStorage(rp.RENDERBUFFER,Im,Jp.width,Jp.height)}}rp.bindRenderbuffer(rp.RENDERBUFFER,null)}function gm(tm,Jp){if(Jp&&Jp.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(np.bindFramebuffer(rp.FRAMEBUFFER,tm),!(Jp.depthTexture&&Jp.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!ap.get(Jp.depthTexture).__webglTexture||Jp.depthTexture.image.width!==Jp.width||Jp.depthTexture.image.height!==Jp.height)&&(Jp.depthTexture.image.width=Jp.width,Jp.depthTexture.image.height=Jp.height,Jp.depthTexture.needsUpdate=!0),Lp(Jp.depthTexture,0);const km=ap.get(Jp.depthTexture).__webglTexture,ym=mm(Jp);if(Jp.depthTexture.format===DepthFormat)fm(Jp)?dp.framebufferTexture2DMultisampleEXT(rp.FRAMEBUFFER,rp.DEPTH_ATTACHMENT,rp.TEXTURE_2D,km,0,ym):rp.framebufferTexture2D(rp.FRAMEBUFFER,rp.DEPTH_ATTACHMENT,rp.TEXTURE_2D,km,0);else if(Jp.depthTexture.format===DepthStencilFormat)fm(Jp)?dp.framebufferTexture2DMultisampleEXT(rp.FRAMEBUFFER,rp.DEPTH_STENCIL_ATTACHMENT,rp.TEXTURE_2D,km,0,ym):rp.framebufferTexture2D(rp.FRAMEBUFFER,rp.DEPTH_STENCIL_ATTACHMENT,rp.TEXTURE_2D,km,0);else throw new Error("Unknown depthTexture format")}function Mm(tm){const Jp=ap.get(tm),pm=tm.isWebGLCubeRenderTarget===!0;if(tm.depthTexture&&!Jp.__autoAllocateDepthBuffer){if(pm)throw new Error("target.depthTexture not supported in Cube render targets");gm(Jp.__webglFramebuffer,tm)}else if(pm){Jp.__webglDepthbuffer=[];for(let km=0;km<6;km++)np.bindFramebuffer(rp.FRAMEBUFFER,Jp.__webglFramebuffer[km]),Jp.__webglDepthbuffer[km]=rp.createRenderbuffer(),cm(Jp.__webglDepthbuffer[km],tm,!1)}else np.bindFramebuffer(rp.FRAMEBUFFER,Jp.__webglFramebuffer),Jp.__webglDepthbuffer=rp.createRenderbuffer(),cm(Jp.__webglDepthbuffer,tm,!1);np.bindFramebuffer(rp.FRAMEBUFFER,null)}function dm(tm,Jp,pm){const km=ap.get(tm);Jp!==void 0&&lm(km.__webglFramebuffer,tm,tm.texture,rp.COLOR_ATTACHMENT0,rp.TEXTURE_2D,0),pm!==void 0&&Mm(tm)}function em(tm){const Jp=tm.texture,pm=ap.get(tm),km=ap.get(Jp);tm.addEventListener("dispose",Mp),tm.isWebGLMultipleRenderTargets!==!0&&(km.__webglTexture===void 0&&(km.__webglTexture=rp.createTexture()),km.__version=Jp.version,up.memory.textures++);const ym=tm.isWebGLCubeRenderTarget===!0,Em=tm.isWebGLMultipleRenderTargets===!0,Bm=_p(tm)||cp;if(ym){pm.__webglFramebuffer=[];for(let Pm=0;Pm<6;Pm++)if(cp&&Jp.mipmaps&&Jp.mipmaps.length>0){pm.__webglFramebuffer[Pm]=[];for(let Im=0;Im<Jp.mipmaps.length;Im++)pm.__webglFramebuffer[Pm][Im]=rp.createFramebuffer()}else pm.__webglFramebuffer[Pm]=rp.createFramebuffer()}else{if(cp&&Jp.mipmaps&&Jp.mipmaps.length>0){pm.__webglFramebuffer=[];for(let Pm=0;Pm<Jp.mipmaps.length;Pm++)pm.__webglFramebuffer[Pm]=rp.createFramebuffer()}else pm.__webglFramebuffer=rp.createFramebuffer();if(Em)if(sp.drawBuffers){const Pm=tm.texture;for(let Im=0,Dm=Pm.length;Im<Dm;Im++){const jm=ap.get(Pm[Im]);jm.__webglTexture===void 0&&(jm.__webglTexture=rp.createTexture(),up.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(cp&&tm.samples>0&&fm(tm)===!1){const Pm=Em?Jp:[Jp];pm.__webglMultisampledFramebuffer=rp.createFramebuffer(),pm.__webglColorRenderbuffer=[],np.bindFramebuffer(rp.FRAMEBUFFER,pm.__webglMultisampledFramebuffer);for(let Im=0;Im<Pm.length;Im++){const Dm=Pm[Im];pm.__webglColorRenderbuffer[Im]=rp.createRenderbuffer(),rp.bindRenderbuffer(rp.RENDERBUFFER,pm.__webglColorRenderbuffer[Im]);const jm=lp.convert(Dm.format,Dm.colorSpace),Fm=lp.convert(Dm.type),av=Sp(Dm.internalFormat,jm,Fm,Dm.colorSpace,tm.isXRRenderTarget===!0),lv=mm(tm);rp.renderbufferStorageMultisample(rp.RENDERBUFFER,lv,av,tm.width,tm.height),rp.framebufferRenderbuffer(rp.FRAMEBUFFER,rp.COLOR_ATTACHMENT0+Im,rp.RENDERBUFFER,pm.__webglColorRenderbuffer[Im])}rp.bindRenderbuffer(rp.RENDERBUFFER,null),tm.depthBuffer&&(pm.__webglDepthRenderbuffer=rp.createRenderbuffer(),cm(pm.__webglDepthRenderbuffer,tm,!0)),np.bindFramebuffer(rp.FRAMEBUFFER,null)}}if(ym){np.bindTexture(rp.TEXTURE_CUBE_MAP,km.__webglTexture),Qp(rp.TEXTURE_CUBE_MAP,Jp,Bm);for(let Pm=0;Pm<6;Pm++)if(cp&&Jp.mipmaps&&Jp.mipmaps.length>0)for(let Im=0;Im<Jp.mipmaps.length;Im++)lm(pm.__webglFramebuffer[Pm][Im],tm,Jp,rp.COLOR_ATTACHMENT0,rp.TEXTURE_CUBE_MAP_POSITIVE_X+Pm,Im);else lm(pm.__webglFramebuffer[Pm],tm,Jp,rp.COLOR_ATTACHMENT0,rp.TEXTURE_CUBE_MAP_POSITIVE_X+Pm,0);bp(Jp,Bm)&&Ep(rp.TEXTURE_CUBE_MAP),np.unbindTexture()}else if(Em){const Pm=tm.texture;for(let Im=0,Dm=Pm.length;Im<Dm;Im++){const jm=Pm[Im],Fm=ap.get(jm);np.bindTexture(rp.TEXTURE_2D,Fm.__webglTexture),Qp(rp.TEXTURE_2D,jm,Bm),lm(pm.__webglFramebuffer,tm,jm,rp.COLOR_ATTACHMENT0+Im,rp.TEXTURE_2D,0),bp(jm,Bm)&&Ep(rp.TEXTURE_2D)}np.unbindTexture()}else{let Pm=rp.TEXTURE_2D;if((tm.isWebGL3DRenderTarget||tm.isWebGLArrayRenderTarget)&&(cp?Pm=tm.isWebGL3DRenderTarget?rp.TEXTURE_3D:rp.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),np.bindTexture(Pm,km.__webglTexture),Qp(Pm,Jp,Bm),cp&&Jp.mipmaps&&Jp.mipmaps.length>0)for(let Im=0;Im<Jp.mipmaps.length;Im++)lm(pm.__webglFramebuffer[Im],tm,Jp,rp.COLOR_ATTACHMENT0,Pm,Im);else lm(pm.__webglFramebuffer,tm,Jp,rp.COLOR_ATTACHMENT0,Pm,0);bp(Jp,Bm)&&Ep(Pm),np.unbindTexture()}tm.depthBuffer&&Mm(tm)}function sm(tm){const Jp=_p(tm)||cp,pm=tm.isWebGLMultipleRenderTargets===!0?tm.texture:[tm.texture];for(let km=0,ym=pm.length;km<ym;km++){const Em=pm[km];if(bp(Em,Jp)){const Bm=tm.isWebGLCubeRenderTarget?rp.TEXTURE_CUBE_MAP:rp.TEXTURE_2D,Pm=ap.get(Em).__webglTexture;np.bindTexture(Bm,Pm),Ep(Bm),np.unbindTexture()}}}function Zp(tm){if(cp&&tm.samples>0&&fm(tm)===!1){const Jp=tm.isWebGLMultipleRenderTargets?tm.texture:[tm.texture],pm=tm.width,km=tm.height;let ym=rp.COLOR_BUFFER_BIT;const Em=[],Bm=tm.stencilBuffer?rp.DEPTH_STENCIL_ATTACHMENT:rp.DEPTH_ATTACHMENT,Pm=ap.get(tm),Im=tm.isWebGLMultipleRenderTargets===!0;if(Im)for(let Dm=0;Dm<Jp.length;Dm++)np.bindFramebuffer(rp.FRAMEBUFFER,Pm.__webglMultisampledFramebuffer),rp.framebufferRenderbuffer(rp.FRAMEBUFFER,rp.COLOR_ATTACHMENT0+Dm,rp.RENDERBUFFER,null),np.bindFramebuffer(rp.FRAMEBUFFER,Pm.__webglFramebuffer),rp.framebufferTexture2D(rp.DRAW_FRAMEBUFFER,rp.COLOR_ATTACHMENT0+Dm,rp.TEXTURE_2D,null,0);np.bindFramebuffer(rp.READ_FRAMEBUFFER,Pm.__webglMultisampledFramebuffer),np.bindFramebuffer(rp.DRAW_FRAMEBUFFER,Pm.__webglFramebuffer);for(let Dm=0;Dm<Jp.length;Dm++){Em.push(rp.COLOR_ATTACHMENT0+Dm),tm.depthBuffer&&Em.push(Bm);const jm=Pm.__ignoreDepthValues!==void 0?Pm.__ignoreDepthValues:!1;if(jm===!1&&(tm.depthBuffer&&(ym|=rp.DEPTH_BUFFER_BIT),tm.stencilBuffer&&(ym|=rp.STENCIL_BUFFER_BIT)),Im&&rp.framebufferRenderbuffer(rp.READ_FRAMEBUFFER,rp.COLOR_ATTACHMENT0,rp.RENDERBUFFER,Pm.__webglColorRenderbuffer[Dm]),jm===!0&&(rp.invalidateFramebuffer(rp.READ_FRAMEBUFFER,[Bm]),rp.invalidateFramebuffer(rp.DRAW_FRAMEBUFFER,[Bm])),Im){const Fm=ap.get(Jp[Dm]).__webglTexture;rp.framebufferTexture2D(rp.DRAW_FRAMEBUFFER,rp.COLOR_ATTACHMENT0,rp.TEXTURE_2D,Fm,0)}rp.blitFramebuffer(0,0,pm,km,0,0,pm,km,ym,rp.NEAREST),hp&&rp.invalidateFramebuffer(rp.READ_FRAMEBUFFER,Em)}if(np.bindFramebuffer(rp.READ_FRAMEBUFFER,null),np.bindFramebuffer(rp.DRAW_FRAMEBUFFER,null),Im)for(let Dm=0;Dm<Jp.length;Dm++){np.bindFramebuffer(rp.FRAMEBUFFER,Pm.__webglMultisampledFramebuffer),rp.framebufferRenderbuffer(rp.FRAMEBUFFER,rp.COLOR_ATTACHMENT0+Dm,rp.RENDERBUFFER,Pm.__webglColorRenderbuffer[Dm]);const jm=ap.get(Jp[Dm]).__webglTexture;np.bindFramebuffer(rp.FRAMEBUFFER,Pm.__webglFramebuffer),rp.framebufferTexture2D(rp.DRAW_FRAMEBUFFER,rp.COLOR_ATTACHMENT0+Dm,rp.TEXTURE_2D,jm,0)}np.bindFramebuffer(rp.DRAW_FRAMEBUFFER,Pm.__webglMultisampledFramebuffer)}}function mm(tm){return Math.min(sp.maxSamples,tm.samples)}function fm(tm){const Jp=ap.get(tm);return cp&&tm.samples>0&&_d.has("WEBGL_multisampled_render_to_texture")===!0&&Jp.__useRenderToTexture!==!1}function _m(tm){const Jp=up.render.frame;fp.get(tm)!==Jp&&(fp.set(tm,Jp),tm.update())}function zm(tm,Jp){const pm=tm.colorSpace,km=tm.format,ym=tm.type;return tm.isCompressedTexture===!0||tm.isVideoTexture===!0||tm.format===_SRGBAFormat||pm!==LinearSRGBColorSpace$1&&pm!==NoColorSpace$1&&(ColorManagement.getTransfer(pm)===SRGBTransfer?cp===!1?_d.has("EXT_sRGB")===!0&&km===RGBAFormat?(tm.format=_SRGBAFormat,tm.minFilter=LinearFilter,tm.generateMipmaps=!1):Jp=ImageUtils.sRGBToLinear(Jp):(km!==RGBAFormat||ym!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",pm)),Jp}this.allocateTextureUnit=Fp,this.resetTextureUnits=Dp,this.setTexture2D=Lp,this.setTexture2DArray=Bp,this.setTexture3D=Ip,this.setTextureCube=kp,this.rebindTextures=dm,this.setupRenderTarget=em,this.updateRenderTargetMipmap=sm,this.updateMultisampleRenderTarget=Zp,this.setupDepthRenderbuffer=Mm,this.setupFrameBufferTexture=lm,this.useMultisampledRTT=fm}function WebGLUtils(rp,_d,np){const ap=np.isWebGL2;function sp(lp,up=NoColorSpace$1){let cp;const dp=ColorManagement.getTransfer(up);if(lp===UnsignedByteType)return rp.UNSIGNED_BYTE;if(lp===UnsignedShort4444Type)return rp.UNSIGNED_SHORT_4_4_4_4;if(lp===UnsignedShort5551Type)return rp.UNSIGNED_SHORT_5_5_5_1;if(lp===ByteType)return rp.BYTE;if(lp===ShortType)return rp.SHORT;if(lp===UnsignedShortType)return rp.UNSIGNED_SHORT;if(lp===IntType)return rp.INT;if(lp===UnsignedIntType)return rp.UNSIGNED_INT;if(lp===FloatType)return rp.FLOAT;if(lp===HalfFloatType)return ap?rp.HALF_FLOAT:(cp=_d.get("OES_texture_half_float"),cp!==null?cp.HALF_FLOAT_OES:null);if(lp===AlphaFormat)return rp.ALPHA;if(lp===RGBAFormat)return rp.RGBA;if(lp===LuminanceFormat)return rp.LUMINANCE;if(lp===LuminanceAlphaFormat)return rp.LUMINANCE_ALPHA;if(lp===DepthFormat)return rp.DEPTH_COMPONENT;if(lp===DepthStencilFormat)return rp.DEPTH_STENCIL;if(lp===_SRGBAFormat)return cp=_d.get("EXT_sRGB"),cp!==null?cp.SRGB_ALPHA_EXT:null;if(lp===RedFormat)return rp.RED;if(lp===RedIntegerFormat)return rp.RED_INTEGER;if(lp===RGFormat)return rp.RG;if(lp===RGIntegerFormat)return rp.RG_INTEGER;if(lp===RGBAIntegerFormat)return rp.RGBA_INTEGER;if(lp===RGB_S3TC_DXT1_Format||lp===RGBA_S3TC_DXT1_Format||lp===RGBA_S3TC_DXT3_Format||lp===RGBA_S3TC_DXT5_Format)if(dp===SRGBTransfer)if(cp=_d.get("WEBGL_compressed_texture_s3tc_srgb"),cp!==null){if(lp===RGB_S3TC_DXT1_Format)return cp.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(lp===RGBA_S3TC_DXT1_Format)return cp.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(lp===RGBA_S3TC_DXT3_Format)return cp.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(lp===RGBA_S3TC_DXT5_Format)return cp.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(cp=_d.get("WEBGL_compressed_texture_s3tc"),cp!==null){if(lp===RGB_S3TC_DXT1_Format)return cp.COMPRESSED_RGB_S3TC_DXT1_EXT;if(lp===RGBA_S3TC_DXT1_Format)return cp.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(lp===RGBA_S3TC_DXT3_Format)return cp.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(lp===RGBA_S3TC_DXT5_Format)return cp.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(lp===RGB_PVRTC_4BPPV1_Format||lp===RGB_PVRTC_2BPPV1_Format||lp===RGBA_PVRTC_4BPPV1_Format||lp===RGBA_PVRTC_2BPPV1_Format)if(cp=_d.get("WEBGL_compressed_texture_pvrtc"),cp!==null){if(lp===RGB_PVRTC_4BPPV1_Format)return cp.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(lp===RGB_PVRTC_2BPPV1_Format)return cp.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(lp===RGBA_PVRTC_4BPPV1_Format)return cp.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(lp===RGBA_PVRTC_2BPPV1_Format)return cp.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(lp===RGB_ETC1_Format)return cp=_d.get("WEBGL_compressed_texture_etc1"),cp!==null?cp.COMPRESSED_RGB_ETC1_WEBGL:null;if(lp===RGB_ETC2_Format||lp===RGBA_ETC2_EAC_Format)if(cp=_d.get("WEBGL_compressed_texture_etc"),cp!==null){if(lp===RGB_ETC2_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ETC2:cp.COMPRESSED_RGB8_ETC2;if(lp===RGBA_ETC2_EAC_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:cp.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(lp===RGBA_ASTC_4x4_Format||lp===RGBA_ASTC_5x4_Format||lp===RGBA_ASTC_5x5_Format||lp===RGBA_ASTC_6x5_Format||lp===RGBA_ASTC_6x6_Format||lp===RGBA_ASTC_8x5_Format||lp===RGBA_ASTC_8x6_Format||lp===RGBA_ASTC_8x8_Format||lp===RGBA_ASTC_10x5_Format||lp===RGBA_ASTC_10x6_Format||lp===RGBA_ASTC_10x8_Format||lp===RGBA_ASTC_10x10_Format||lp===RGBA_ASTC_12x10_Format||lp===RGBA_ASTC_12x12_Format)if(cp=_d.get("WEBGL_compressed_texture_astc"),cp!==null){if(lp===RGBA_ASTC_4x4_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:cp.COMPRESSED_RGBA_ASTC_4x4_KHR;if(lp===RGBA_ASTC_5x4_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:cp.COMPRESSED_RGBA_ASTC_5x4_KHR;if(lp===RGBA_ASTC_5x5_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:cp.COMPRESSED_RGBA_ASTC_5x5_KHR;if(lp===RGBA_ASTC_6x5_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:cp.COMPRESSED_RGBA_ASTC_6x5_KHR;if(lp===RGBA_ASTC_6x6_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:cp.COMPRESSED_RGBA_ASTC_6x6_KHR;if(lp===RGBA_ASTC_8x5_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:cp.COMPRESSED_RGBA_ASTC_8x5_KHR;if(lp===RGBA_ASTC_8x6_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:cp.COMPRESSED_RGBA_ASTC_8x6_KHR;if(lp===RGBA_ASTC_8x8_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:cp.COMPRESSED_RGBA_ASTC_8x8_KHR;if(lp===RGBA_ASTC_10x5_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:cp.COMPRESSED_RGBA_ASTC_10x5_KHR;if(lp===RGBA_ASTC_10x6_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:cp.COMPRESSED_RGBA_ASTC_10x6_KHR;if(lp===RGBA_ASTC_10x8_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:cp.COMPRESSED_RGBA_ASTC_10x8_KHR;if(lp===RGBA_ASTC_10x10_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:cp.COMPRESSED_RGBA_ASTC_10x10_KHR;if(lp===RGBA_ASTC_12x10_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:cp.COMPRESSED_RGBA_ASTC_12x10_KHR;if(lp===RGBA_ASTC_12x12_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:cp.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(lp===RGBA_BPTC_Format||lp===RGB_BPTC_SIGNED_Format||lp===RGB_BPTC_UNSIGNED_Format)if(cp=_d.get("EXT_texture_compression_bptc"),cp!==null){if(lp===RGBA_BPTC_Format)return dp===SRGBTransfer?cp.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:cp.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(lp===RGB_BPTC_SIGNED_Format)return cp.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(lp===RGB_BPTC_UNSIGNED_Format)return cp.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(lp===RED_RGTC1_Format||lp===SIGNED_RED_RGTC1_Format||lp===RED_GREEN_RGTC2_Format||lp===SIGNED_RED_GREEN_RGTC2_Format)if(cp=_d.get("EXT_texture_compression_rgtc"),cp!==null){if(lp===RGBA_BPTC_Format)return cp.COMPRESSED_RED_RGTC1_EXT;if(lp===SIGNED_RED_RGTC1_Format)return cp.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(lp===RED_GREEN_RGTC2_Format)return cp.COMPRESSED_RED_GREEN_RGTC2_EXT;if(lp===SIGNED_RED_GREEN_RGTC2_Format)return cp.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return lp===UnsignedInt248Type?ap?rp.UNSIGNED_INT_24_8:(cp=_d.get("WEBGL_depth_texture"),cp!==null?cp.UNSIGNED_INT_24_8_WEBGL:null):rp[lp]!==void 0?rp[lp]:null}return{convert:sp}}class ArrayCamera extends PerspectiveCamera$1{constructor(_d=[]){super(),this.isArrayCamera=!0,this.cameras=_d}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(_d){return this._targetRay!==null&&this._targetRay.dispatchEvent(_d),this._grip!==null&&this._grip.dispatchEvent(_d),this._hand!==null&&this._hand.dispatchEvent(_d),this}connect(_d){if(_d&&_d.hand){const np=this._hand;if(np)for(const ap of _d.hand.values())this._getHandJoint(np,ap)}return this.dispatchEvent({type:"connected",data:_d}),this}disconnect(_d){return this.dispatchEvent({type:"disconnected",data:_d}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_d,np,ap){let sp=null,lp=null,up=null;const cp=this._targetRay,dp=this._grip,hp=this._hand;if(_d&&np.session.visibilityState!=="visible-blurred"){if(hp&&_d.hand){up=!0;for(const xp of _d.hand.values()){const _p=np.getJointPose(xp,ap),vp=this._getHandJoint(hp,xp);_p!==null&&(vp.matrix.fromArray(_p.transform.matrix),vp.matrix.decompose(vp.position,vp.rotation,vp.scale),vp.matrixWorldNeedsUpdate=!0,vp.jointRadius=_p.radius),vp.visible=_p!==null}const fp=hp.joints["index-finger-tip"],pp=hp.joints["thumb-tip"],mp=fp.position.distanceTo(pp.position),gp=.02,yp=.005;hp.inputState.pinching&&mp>gp+yp?(hp.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_d.handedness,target:this})):!hp.inputState.pinching&&mp<=gp-yp&&(hp.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_d.handedness,target:this}))}else dp!==null&&_d.gripSpace&&(lp=np.getPose(_d.gripSpace,ap),lp!==null&&(dp.matrix.fromArray(lp.transform.matrix),dp.matrix.decompose(dp.position,dp.rotation,dp.scale),dp.matrixWorldNeedsUpdate=!0,lp.linearVelocity?(dp.hasLinearVelocity=!0,dp.linearVelocity.copy(lp.linearVelocity)):dp.hasLinearVelocity=!1,lp.angularVelocity?(dp.hasAngularVelocity=!0,dp.angularVelocity.copy(lp.angularVelocity)):dp.hasAngularVelocity=!1));cp!==null&&(sp=np.getPose(_d.targetRaySpace,ap),sp===null&&lp!==null&&(sp=lp),sp!==null&&(cp.matrix.fromArray(sp.transform.matrix),cp.matrix.decompose(cp.position,cp.rotation,cp.scale),cp.matrixWorldNeedsUpdate=!0,sp.linearVelocity?(cp.hasLinearVelocity=!0,cp.linearVelocity.copy(sp.linearVelocity)):cp.hasLinearVelocity=!1,sp.angularVelocity?(cp.hasAngularVelocity=!0,cp.angularVelocity.copy(sp.angularVelocity)):cp.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return cp!==null&&(cp.visible=sp!==null),dp!==null&&(dp.visible=lp!==null),hp!==null&&(hp.visible=up!==null),this}_getHandJoint(_d,np){if(_d.joints[np.jointName]===void 0){const ap=new Group;ap.matrixAutoUpdate=!1,ap.visible=!1,_d.joints[np.jointName]=ap,_d.add(ap)}return _d.joints[np.jointName]}}const _occlusion_vertex=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_occlusion_fragment=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class WebXRDepthSensing{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(_d,np,ap){if(this.texture===null){const sp=new Texture,lp=_d.properties.get(sp);lp.__webglTexture=np.texture,(np.depthNear!=ap.depthNear||np.depthFar!=ap.depthFar)&&(this.depthNear=np.depthNear,this.depthFar=np.depthFar),this.texture=sp}}render(_d,np){if(this.texture!==null){if(this.mesh===null){const ap=np.cameras[0].viewport,sp=new ShaderMaterial({extensions:{fragDepth:!0},vertexShader:_occlusion_vertex,fragmentShader:_occlusion_fragment,uniforms:{depthColor:{value:this.texture},depthWidth:{value:ap.z},depthHeight:{value:ap.w}}});this.mesh=new Mesh(new PlaneGeometry(20,20),sp)}_d.render(this.mesh,np)}}reset(){this.texture=null,this.mesh=null}}class WebXRManager extends EventDispatcher{constructor(_d,np){super();const ap=this;let sp=null,lp=1,up=null,cp="local-floor",dp=1,hp=null,fp=null,pp=null,mp=null,gp=null,yp=null;const xp=new WebXRDepthSensing,_p=np.getContextAttributes();let vp=null,bp=null;const Ep=[],Sp=[],Ap=new Vector2;let Rp=null;const Tp=new PerspectiveCamera$1;Tp.layers.enable(1),Tp.viewport=new Vector4;const Mp=new PerspectiveCamera$1;Mp.layers.enable(2),Mp.viewport=new Vector4;const Op=[Tp,Mp],Pp=new ArrayCamera;Pp.layers.enable(1),Pp.layers.enable(2);let $p=null,zp=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Xp){let rm=Ep[Xp];return rm===void 0&&(rm=new WebXRController,Ep[Xp]=rm),rm.getTargetRaySpace()},this.getControllerGrip=function(Xp){let rm=Ep[Xp];return rm===void 0&&(rm=new WebXRController,Ep[Xp]=rm),rm.getGripSpace()},this.getHand=function(Xp){let rm=Ep[Xp];return rm===void 0&&(rm=new WebXRController,Ep[Xp]=rm),rm.getHandSpace()};function Dp(Xp){const rm=Sp.indexOf(Xp.inputSource);if(rm===-1)return;const Kp=Ep[rm];Kp!==void 0&&(Kp.update(Xp.inputSource,Xp.frame,hp||up),Kp.dispatchEvent({type:Xp.type,data:Xp.inputSource}))}function Fp(){sp.removeEventListener("select",Dp),sp.removeEventListener("selectstart",Dp),sp.removeEventListener("selectend",Dp),sp.removeEventListener("squeeze",Dp),sp.removeEventListener("squeezestart",Dp),sp.removeEventListener("squeezeend",Dp),sp.removeEventListener("end",Fp),sp.removeEventListener("inputsourceschange",jp);for(let Xp=0;Xp<Ep.length;Xp++){const rm=Sp[Xp];rm!==null&&(Sp[Xp]=null,Ep[Xp].disconnect(rm))}$p=null,zp=null,xp.reset(),_d.setRenderTarget(vp),gp=null,mp=null,pp=null,sp=null,bp=null,Qp.stop(),ap.isPresenting=!1,_d.setPixelRatio(Rp),_d.setSize(Ap.width,Ap.height,!1),ap.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Xp){lp=Xp,ap.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Xp){cp=Xp,ap.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return hp||up},this.setReferenceSpace=function(Xp){hp=Xp},this.getBaseLayer=function(){return mp!==null?mp:gp},this.getBinding=function(){return pp},this.getFrame=function(){return yp},this.getSession=function(){return sp},this.setSession=async function(Xp){if(sp=Xp,sp!==null){if(vp=_d.getRenderTarget(),sp.addEventListener("select",Dp),sp.addEventListener("selectstart",Dp),sp.addEventListener("selectend",Dp),sp.addEventListener("squeeze",Dp),sp.addEventListener("squeezestart",Dp),sp.addEventListener("squeezeend",Dp),sp.addEventListener("end",Fp),sp.addEventListener("inputsourceschange",jp),_p.xrCompatible!==!0&&await np.makeXRCompatible(),Rp=_d.getPixelRatio(),_d.getSize(Ap),sp.renderState.layers===void 0||_d.capabilities.isWebGL2===!1){const rm={antialias:sp.renderState.layers===void 0?_p.antialias:!0,alpha:!0,depth:_p.depth,stencil:_p.stencil,framebufferScaleFactor:lp};gp=new XRWebGLLayer(sp,np,rm),sp.updateRenderState({baseLayer:gp}),_d.setPixelRatio(1),_d.setSize(gp.framebufferWidth,gp.framebufferHeight,!1),bp=new WebGLRenderTarget(gp.framebufferWidth,gp.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:_d.outputColorSpace,stencilBuffer:_p.stencil})}else{let rm=null,Kp=null,lm=null;_p.depth&&(lm=_p.stencil?np.DEPTH24_STENCIL8:np.DEPTH_COMPONENT24,rm=_p.stencil?DepthStencilFormat:DepthFormat,Kp=_p.stencil?UnsignedInt248Type:UnsignedIntType);const cm={colorFormat:np.RGBA8,depthFormat:lm,scaleFactor:lp};pp=new XRWebGLBinding(sp,np),mp=pp.createProjectionLayer(cm),sp.updateRenderState({layers:[mp]}),_d.setPixelRatio(1),_d.setSize(mp.textureWidth,mp.textureHeight,!1),bp=new WebGLRenderTarget(mp.textureWidth,mp.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(mp.textureWidth,mp.textureHeight,Kp,void 0,void 0,void 0,void 0,void 0,void 0,rm),stencilBuffer:_p.stencil,colorSpace:_d.outputColorSpace,samples:_p.antialias?4:0});const gm=_d.properties.get(bp);gm.__ignoreDepthValues=mp.ignoreDepthValues}bp.isXRRenderTarget=!0,this.setFoveation(dp),hp=null,up=await sp.requestReferenceSpace(cp),Qp.setContext(sp),Qp.start(),ap.isPresenting=!0,ap.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(sp!==null)return sp.environmentBlendMode};function jp(Xp){for(let rm=0;rm<Xp.removed.length;rm++){const Kp=Xp.removed[rm],lm=Sp.indexOf(Kp);lm>=0&&(Sp[lm]=null,Ep[lm].disconnect(Kp))}for(let rm=0;rm<Xp.added.length;rm++){const Kp=Xp.added[rm];let lm=Sp.indexOf(Kp);if(lm===-1){for(let gm=0;gm<Ep.length;gm++)if(gm>=Sp.length){Sp.push(Kp),lm=gm;break}else if(Sp[gm]===null){Sp[gm]=Kp,lm=gm;break}if(lm===-1)break}const cm=Ep[lm];cm&&cm.connect(Kp)}}const Lp=new Vector3,Bp=new Vector3;function Ip(Xp,rm,Kp){Lp.setFromMatrixPosition(rm.matrixWorld),Bp.setFromMatrixPosition(Kp.matrixWorld);const lm=Lp.distanceTo(Bp),cm=rm.projectionMatrix.elements,gm=Kp.projectionMatrix.elements,Mm=cm[14]/(cm[10]-1),dm=cm[14]/(cm[10]+1),em=(cm[9]+1)/cm[5],sm=(cm[9]-1)/cm[5],Zp=(cm[8]-1)/cm[0],mm=(gm[8]+1)/gm[0],fm=Mm*Zp,_m=Mm*mm,zm=lm/(-Zp+mm),tm=zm*-Zp;rm.matrixWorld.decompose(Xp.position,Xp.quaternion,Xp.scale),Xp.translateX(tm),Xp.translateZ(zm),Xp.matrixWorld.compose(Xp.position,Xp.quaternion,Xp.scale),Xp.matrixWorldInverse.copy(Xp.matrixWorld).invert();const Jp=Mm+zm,pm=dm+zm,km=fm-tm,ym=_m+(lm-tm),Em=em*dm/pm*Jp,Bm=sm*dm/pm*Jp;Xp.projectionMatrix.makePerspective(km,ym,Em,Bm,Jp,pm),Xp.projectionMatrixInverse.copy(Xp.projectionMatrix).invert()}function kp(Xp,rm){rm===null?Xp.matrixWorld.copy(Xp.matrix):Xp.matrixWorld.multiplyMatrices(rm.matrixWorld,Xp.matrix),Xp.matrixWorldInverse.copy(Xp.matrixWorld).invert()}this.updateCamera=function(Xp){if(sp===null)return;xp.texture!==null&&(Xp.near=xp.depthNear,Xp.far=xp.depthFar),Pp.near=Mp.near=Tp.near=Xp.near,Pp.far=Mp.far=Tp.far=Xp.far,($p!==Pp.near||zp!==Pp.far)&&(sp.updateRenderState({depthNear:Pp.near,depthFar:Pp.far}),$p=Pp.near,zp=Pp.far,Tp.near=$p,Tp.far=zp,Mp.near=$p,Mp.far=zp,Tp.updateProjectionMatrix(),Mp.updateProjectionMatrix(),Xp.updateProjectionMatrix());const rm=Xp.parent,Kp=Pp.cameras;kp(Pp,rm);for(let lm=0;lm<Kp.length;lm++)kp(Kp[lm],rm);Kp.length===2?Ip(Pp,Tp,Mp):Pp.projectionMatrix.copy(Tp.projectionMatrix),Up(Xp,Pp,rm)};function Up(Xp,rm,Kp){Kp===null?Xp.matrix.copy(rm.matrixWorld):(Xp.matrix.copy(Kp.matrixWorld),Xp.matrix.invert(),Xp.matrix.multiply(rm.matrixWorld)),Xp.matrix.decompose(Xp.position,Xp.quaternion,Xp.scale),Xp.updateMatrixWorld(!0),Xp.projectionMatrix.copy(rm.projectionMatrix),Xp.projectionMatrixInverse.copy(rm.projectionMatrixInverse),Xp.isPerspectiveCamera&&(Xp.fov=RAD2DEG*2*Math.atan(1/Xp.projectionMatrix.elements[5]),Xp.zoom=1)}this.getCamera=function(){return Pp},this.getFoveation=function(){if(!(mp===null&&gp===null))return dp},this.setFoveation=function(Xp){dp=Xp,mp!==null&&(mp.fixedFoveation=Xp),gp!==null&&gp.fixedFoveation!==void 0&&(gp.fixedFoveation=Xp)},this.hasDepthSensing=function(){return xp.texture!==null};let Gp=null;function Wp(Xp,rm){if(fp=rm.getViewerPose(hp||up),yp=rm,fp!==null){const Kp=fp.views;gp!==null&&(_d.setRenderTargetFramebuffer(bp,gp.framebuffer),_d.setRenderTarget(bp));let lm=!1;Kp.length!==Pp.cameras.length&&(Pp.cameras.length=0,lm=!0);for(let gm=0;gm<Kp.length;gm++){const Mm=Kp[gm];let dm=null;if(gp!==null)dm=gp.getViewport(Mm);else{const sm=pp.getViewSubImage(mp,Mm);dm=sm.viewport,gm===0&&(_d.setRenderTargetTextures(bp,sm.colorTexture,mp.ignoreDepthValues?void 0:sm.depthStencilTexture),_d.setRenderTarget(bp))}let em=Op[gm];em===void 0&&(em=new PerspectiveCamera$1,em.layers.enable(gm),em.viewport=new Vector4,Op[gm]=em),em.matrix.fromArray(Mm.transform.matrix),em.matrix.decompose(em.position,em.quaternion,em.scale),em.projectionMatrix.fromArray(Mm.projectionMatrix),em.projectionMatrixInverse.copy(em.projectionMatrix).invert(),em.viewport.set(dm.x,dm.y,dm.width,dm.height),gm===0&&(Pp.matrix.copy(em.matrix),Pp.matrix.decompose(Pp.position,Pp.quaternion,Pp.scale)),lm===!0&&Pp.cameras.push(em)}const cm=sp.enabledFeatures;if(cm&&cm.includes("depth-sensing")){const gm=pp.getDepthInformation(Kp[0]);gm&&gm.isValid&&gm.texture&&xp.init(_d,gm,sp.renderState)}}for(let Kp=0;Kp<Ep.length;Kp++){const lm=Sp[Kp],cm=Ep[Kp];lm!==null&&cm!==void 0&&cm.update(lm,rm,hp||up)}xp.render(_d,Pp),Gp&&Gp(Xp,rm),rm.detectedPlanes&&ap.dispatchEvent({type:"planesdetected",data:rm}),yp=null}const Qp=new WebGLAnimation;Qp.setAnimationLoop(Wp),this.setAnimationLoop=function(Xp){Gp=Xp},this.dispose=function(){}}}function WebGLMaterials(rp,_d){function np(_p,vp){_p.matrixAutoUpdate===!0&&_p.updateMatrix(),vp.value.copy(_p.matrix)}function ap(_p,vp){vp.color.getRGB(_p.fogColor.value,getUnlitUniformColorSpace(rp)),vp.isFog?(_p.fogNear.value=vp.near,_p.fogFar.value=vp.far):vp.isFogExp2&&(_p.fogDensity.value=vp.density)}function sp(_p,vp,bp,Ep,Sp){vp.isMeshBasicMaterial||vp.isMeshLambertMaterial?lp(_p,vp):vp.isMeshToonMaterial?(lp(_p,vp),pp(_p,vp)):vp.isMeshPhongMaterial?(lp(_p,vp),fp(_p,vp)):vp.isMeshStandardMaterial?(lp(_p,vp),mp(_p,vp),vp.isMeshPhysicalMaterial&&gp(_p,vp,Sp)):vp.isMeshMatcapMaterial?(lp(_p,vp),yp(_p,vp)):vp.isMeshDepthMaterial?lp(_p,vp):vp.isMeshDistanceMaterial?(lp(_p,vp),xp(_p,vp)):vp.isMeshNormalMaterial?lp(_p,vp):vp.isLineBasicMaterial?(up(_p,vp),vp.isLineDashedMaterial&&cp(_p,vp)):vp.isPointsMaterial?dp(_p,vp,bp,Ep):vp.isSpriteMaterial?hp(_p,vp):vp.isShadowMaterial?(_p.color.value.copy(vp.color),_p.opacity.value=vp.opacity):vp.isShaderMaterial&&(vp.uniformsNeedUpdate=!1)}function lp(_p,vp){_p.opacity.value=vp.opacity,vp.color&&_p.diffuse.value.copy(vp.color),vp.emissive&&_p.emissive.value.copy(vp.emissive).multiplyScalar(vp.emissiveIntensity),vp.map&&(_p.map.value=vp.map,np(vp.map,_p.mapTransform)),vp.alphaMap&&(_p.alphaMap.value=vp.alphaMap,np(vp.alphaMap,_p.alphaMapTransform)),vp.bumpMap&&(_p.bumpMap.value=vp.bumpMap,np(vp.bumpMap,_p.bumpMapTransform),_p.bumpScale.value=vp.bumpScale,vp.side===BackSide&&(_p.bumpScale.value*=-1)),vp.normalMap&&(_p.normalMap.value=vp.normalMap,np(vp.normalMap,_p.normalMapTransform),_p.normalScale.value.copy(vp.normalScale),vp.side===BackSide&&_p.normalScale.value.negate()),vp.displacementMap&&(_p.displacementMap.value=vp.displacementMap,np(vp.displacementMap,_p.displacementMapTransform),_p.displacementScale.value=vp.displacementScale,_p.displacementBias.value=vp.displacementBias),vp.emissiveMap&&(_p.emissiveMap.value=vp.emissiveMap,np(vp.emissiveMap,_p.emissiveMapTransform)),vp.specularMap&&(_p.specularMap.value=vp.specularMap,np(vp.specularMap,_p.specularMapTransform)),vp.alphaTest>0&&(_p.alphaTest.value=vp.alphaTest);const bp=_d.get(vp).envMap;if(bp&&(_p.envMap.value=bp,_p.flipEnvMap.value=bp.isCubeTexture&&bp.isRenderTargetTexture===!1?-1:1,_p.reflectivity.value=vp.reflectivity,_p.ior.value=vp.ior,_p.refractionRatio.value=vp.refractionRatio),vp.lightMap){_p.lightMap.value=vp.lightMap;const Ep=rp._useLegacyLights===!0?Math.PI:1;_p.lightMapIntensity.value=vp.lightMapIntensity*Ep,np(vp.lightMap,_p.lightMapTransform)}vp.aoMap&&(_p.aoMap.value=vp.aoMap,_p.aoMapIntensity.value=vp.aoMapIntensity,np(vp.aoMap,_p.aoMapTransform))}function up(_p,vp){_p.diffuse.value.copy(vp.color),_p.opacity.value=vp.opacity,vp.map&&(_p.map.value=vp.map,np(vp.map,_p.mapTransform))}function cp(_p,vp){_p.dashSize.value=vp.dashSize,_p.totalSize.value=vp.dashSize+vp.gapSize,_p.scale.value=vp.scale}function dp(_p,vp,bp,Ep){_p.diffuse.value.copy(vp.color),_p.opacity.value=vp.opacity,_p.size.value=vp.size*bp,_p.scale.value=Ep*.5,vp.map&&(_p.map.value=vp.map,np(vp.map,_p.uvTransform)),vp.alphaMap&&(_p.alphaMap.value=vp.alphaMap,np(vp.alphaMap,_p.alphaMapTransform)),vp.alphaTest>0&&(_p.alphaTest.value=vp.alphaTest)}function hp(_p,vp){_p.diffuse.value.copy(vp.color),_p.opacity.value=vp.opacity,_p.rotation.value=vp.rotation,vp.map&&(_p.map.value=vp.map,np(vp.map,_p.mapTransform)),vp.alphaMap&&(_p.alphaMap.value=vp.alphaMap,np(vp.alphaMap,_p.alphaMapTransform)),vp.alphaTest>0&&(_p.alphaTest.value=vp.alphaTest)}function fp(_p,vp){_p.specular.value.copy(vp.specular),_p.shininess.value=Math.max(vp.shininess,1e-4)}function pp(_p,vp){vp.gradientMap&&(_p.gradientMap.value=vp.gradientMap)}function mp(_p,vp){_p.metalness.value=vp.metalness,vp.metalnessMap&&(_p.metalnessMap.value=vp.metalnessMap,np(vp.metalnessMap,_p.metalnessMapTransform)),_p.roughness.value=vp.roughness,vp.roughnessMap&&(_p.roughnessMap.value=vp.roughnessMap,np(vp.roughnessMap,_p.roughnessMapTransform)),_d.get(vp).envMap&&(_p.envMapIntensity.value=vp.envMapIntensity)}function gp(_p,vp,bp){_p.ior.value=vp.ior,vp.sheen>0&&(_p.sheenColor.value.copy(vp.sheenColor).multiplyScalar(vp.sheen),_p.sheenRoughness.value=vp.sheenRoughness,vp.sheenColorMap&&(_p.sheenColorMap.value=vp.sheenColorMap,np(vp.sheenColorMap,_p.sheenColorMapTransform)),vp.sheenRoughnessMap&&(_p.sheenRoughnessMap.value=vp.sheenRoughnessMap,np(vp.sheenRoughnessMap,_p.sheenRoughnessMapTransform))),vp.clearcoat>0&&(_p.clearcoat.value=vp.clearcoat,_p.clearcoatRoughness.value=vp.clearcoatRoughness,vp.clearcoatMap&&(_p.clearcoatMap.value=vp.clearcoatMap,np(vp.clearcoatMap,_p.clearcoatMapTransform)),vp.clearcoatRoughnessMap&&(_p.clearcoatRoughnessMap.value=vp.clearcoatRoughnessMap,np(vp.clearcoatRoughnessMap,_p.clearcoatRoughnessMapTransform)),vp.clearcoatNormalMap&&(_p.clearcoatNormalMap.value=vp.clearcoatNormalMap,np(vp.clearcoatNormalMap,_p.clearcoatNormalMapTransform),_p.clearcoatNormalScale.value.copy(vp.clearcoatNormalScale),vp.side===BackSide&&_p.clearcoatNormalScale.value.negate())),vp.iridescence>0&&(_p.iridescence.value=vp.iridescence,_p.iridescenceIOR.value=vp.iridescenceIOR,_p.iridescenceThicknessMinimum.value=vp.iridescenceThicknessRange[0],_p.iridescenceThicknessMaximum.value=vp.iridescenceThicknessRange[1],vp.iridescenceMap&&(_p.iridescenceMap.value=vp.iridescenceMap,np(vp.iridescenceMap,_p.iridescenceMapTransform)),vp.iridescenceThicknessMap&&(_p.iridescenceThicknessMap.value=vp.iridescenceThicknessMap,np(vp.iridescenceThicknessMap,_p.iridescenceThicknessMapTransform))),vp.transmission>0&&(_p.transmission.value=vp.transmission,_p.transmissionSamplerMap.value=bp.texture,_p.transmissionSamplerSize.value.set(bp.width,bp.height),vp.transmissionMap&&(_p.transmissionMap.value=vp.transmissionMap,np(vp.transmissionMap,_p.transmissionMapTransform)),_p.thickness.value=vp.thickness,vp.thicknessMap&&(_p.thicknessMap.value=vp.thicknessMap,np(vp.thicknessMap,_p.thicknessMapTransform)),_p.attenuationDistance.value=vp.attenuationDistance,_p.attenuationColor.value.copy(vp.attenuationColor)),vp.anisotropy>0&&(_p.anisotropyVector.value.set(vp.anisotropy*Math.cos(vp.anisotropyRotation),vp.anisotropy*Math.sin(vp.anisotropyRotation)),vp.anisotropyMap&&(_p.anisotropyMap.value=vp.anisotropyMap,np(vp.anisotropyMap,_p.anisotropyMapTransform))),_p.specularIntensity.value=vp.specularIntensity,_p.specularColor.value.copy(vp.specularColor),vp.specularColorMap&&(_p.specularColorMap.value=vp.specularColorMap,np(vp.specularColorMap,_p.specularColorMapTransform)),vp.specularIntensityMap&&(_p.specularIntensityMap.value=vp.specularIntensityMap,np(vp.specularIntensityMap,_p.specularIntensityMapTransform))}function yp(_p,vp){vp.matcap&&(_p.matcap.value=vp.matcap)}function xp(_p,vp){const bp=_d.get(vp).light;_p.referencePosition.value.setFromMatrixPosition(bp.matrixWorld),_p.nearDistance.value=bp.shadow.camera.near,_p.farDistance.value=bp.shadow.camera.far}return{refreshFogUniforms:ap,refreshMaterialUniforms:sp}}function WebGLUniformsGroups(rp,_d,np,ap){let sp={},lp={},up=[];const cp=np.isWebGL2?rp.getParameter(rp.MAX_UNIFORM_BUFFER_BINDINGS):0;function dp(bp,Ep){const Sp=Ep.program;ap.uniformBlockBinding(bp,Sp)}function hp(bp,Ep){let Sp=sp[bp.id];Sp===void 0&&(yp(bp),Sp=fp(bp),sp[bp.id]=Sp,bp.addEventListener("dispose",_p));const Ap=Ep.program;ap.updateUBOMapping(bp,Ap);const Rp=_d.render.frame;lp[bp.id]!==Rp&&(mp(bp),lp[bp.id]=Rp)}function fp(bp){const Ep=pp();bp.__bindingPointIndex=Ep;const Sp=rp.createBuffer(),Ap=bp.__size,Rp=bp.usage;return rp.bindBuffer(rp.UNIFORM_BUFFER,Sp),rp.bufferData(rp.UNIFORM_BUFFER,Ap,Rp),rp.bindBuffer(rp.UNIFORM_BUFFER,null),rp.bindBufferBase(rp.UNIFORM_BUFFER,Ep,Sp),Sp}function pp(){for(let bp=0;bp<cp;bp++)if(up.indexOf(bp)===-1)return up.push(bp),bp;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function mp(bp){const Ep=sp[bp.id],Sp=bp.uniforms,Ap=bp.__cache;rp.bindBuffer(rp.UNIFORM_BUFFER,Ep);for(let Rp=0,Tp=Sp.length;Rp<Tp;Rp++){const Mp=Array.isArray(Sp[Rp])?Sp[Rp]:[Sp[Rp]];for(let Op=0,Pp=Mp.length;Op<Pp;Op++){const $p=Mp[Op];if(gp($p,Rp,Op,Ap)===!0){const zp=$p.__offset,Dp=Array.isArray($p.value)?$p.value:[$p.value];let Fp=0;for(let jp=0;jp<Dp.length;jp++){const Lp=Dp[jp],Bp=xp(Lp);typeof Lp=="number"||typeof Lp=="boolean"?($p.__data[0]=Lp,rp.bufferSubData(rp.UNIFORM_BUFFER,zp+Fp,$p.__data)):Lp.isMatrix3?($p.__data[0]=Lp.elements[0],$p.__data[1]=Lp.elements[1],$p.__data[2]=Lp.elements[2],$p.__data[3]=0,$p.__data[4]=Lp.elements[3],$p.__data[5]=Lp.elements[4],$p.__data[6]=Lp.elements[5],$p.__data[7]=0,$p.__data[8]=Lp.elements[6],$p.__data[9]=Lp.elements[7],$p.__data[10]=Lp.elements[8],$p.__data[11]=0):(Lp.toArray($p.__data,Fp),Fp+=Bp.storage/Float32Array.BYTES_PER_ELEMENT)}rp.bufferSubData(rp.UNIFORM_BUFFER,zp,$p.__data)}}}rp.bindBuffer(rp.UNIFORM_BUFFER,null)}function gp(bp,Ep,Sp,Ap){const Rp=bp.value,Tp=Ep+"_"+Sp;if(Ap[Tp]===void 0)return typeof Rp=="number"||typeof Rp=="boolean"?Ap[Tp]=Rp:Ap[Tp]=Rp.clone(),!0;{const Mp=Ap[Tp];if(typeof Rp=="number"||typeof Rp=="boolean"){if(Mp!==Rp)return Ap[Tp]=Rp,!0}else if(Mp.equals(Rp)===!1)return Mp.copy(Rp),!0}return!1}function yp(bp){const Ep=bp.uniforms;let Sp=0;const Ap=16;for(let Tp=0,Mp=Ep.length;Tp<Mp;Tp++){const Op=Array.isArray(Ep[Tp])?Ep[Tp]:[Ep[Tp]];for(let Pp=0,$p=Op.length;Pp<$p;Pp++){const zp=Op[Pp],Dp=Array.isArray(zp.value)?zp.value:[zp.value];for(let Fp=0,jp=Dp.length;Fp<jp;Fp++){const Lp=Dp[Fp],Bp=xp(Lp),Ip=Sp%Ap;Ip!==0&&Ap-Ip<Bp.boundary&&(Sp+=Ap-Ip),zp.__data=new Float32Array(Bp.storage/Float32Array.BYTES_PER_ELEMENT),zp.__offset=Sp,Sp+=Bp.storage}}}const Rp=Sp%Ap;return Rp>0&&(Sp+=Ap-Rp),bp.__size=Sp,bp.__cache={},this}function xp(bp){const Ep={boundary:0,storage:0};return typeof bp=="number"||typeof bp=="boolean"?(Ep.boundary=4,Ep.storage=4):bp.isVector2?(Ep.boundary=8,Ep.storage=8):bp.isVector3||bp.isColor?(Ep.boundary=16,Ep.storage=12):bp.isVector4?(Ep.boundary=16,Ep.storage=16):bp.isMatrix3?(Ep.boundary=48,Ep.storage=48):bp.isMatrix4?(Ep.boundary=64,Ep.storage=64):bp.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",bp),Ep}function _p(bp){const Ep=bp.target;Ep.removeEventListener("dispose",_p);const Sp=up.indexOf(Ep.__bindingPointIndex);up.splice(Sp,1),rp.deleteBuffer(sp[Ep.id]),delete sp[Ep.id],delete lp[Ep.id]}function vp(){for(const bp in sp)rp.deleteBuffer(sp[bp]);up=[],sp={},lp={}}return{bind:dp,update:hp,dispose:vp}}class WebGLRenderer{constructor(_d={}){const{canvas:np=createCanvasElement(),context:ap=null,depth:sp=!0,stencil:lp=!0,alpha:up=!1,antialias:cp=!1,premultipliedAlpha:dp=!0,preserveDrawingBuffer:hp=!1,powerPreference:fp="default",failIfMajorPerformanceCaveat:pp=!1}=_d;this.isWebGLRenderer=!0;let mp;ap!==null?mp=ap.getContextAttributes().alpha:mp=up;const gp=new Uint32Array(4),yp=new Int32Array(4);let xp=null,_p=null;const vp=[],bp=[];this.domElement=np,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=SRGBColorSpace$1,this._useLegacyLights=!1,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const Ep=this;let Sp=!1,Ap=0,Rp=0,Tp=null,Mp=-1,Op=null;const Pp=new Vector4,$p=new Vector4;let zp=null;const Dp=new Color(0);let Fp=0,jp=np.width,Lp=np.height,Bp=1,Ip=null,kp=null;const Up=new Vector4(0,0,jp,Lp),Gp=new Vector4(0,0,jp,Lp);let Wp=!1;const Qp=new Frustum;let Xp=!1,rm=!1,Kp=null;const lm=new Matrix4,cm=new Vector2,gm=new Vector3,Mm={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function dm(){return Tp===null?Bp:1}let em=ap;function sm(am,bm){for(let Tm=0;Tm<am.length;Tm++){const Nm=am[Tm],Rm=np.getContext(Nm,bm);if(Rm!==null)return Rm}return null}try{const am={alpha:!0,depth:sp,stencil:lp,antialias:cp,premultipliedAlpha:dp,preserveDrawingBuffer:hp,powerPreference:fp,failIfMajorPerformanceCaveat:pp};if("setAttribute"in np&&np.setAttribute("data-engine",`three.js r${REVISION}`),np.addEventListener("webglcontextlost",Vm,!1),np.addEventListener("webglcontextrestored",im,!1),np.addEventListener("webglcontextcreationerror",Am,!1),em===null){const bm=["webgl2","webgl","experimental-webgl"];if(Ep.isWebGL1Renderer===!0&&bm.shift(),em=sm(bm,am),em===null)throw sm(bm)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&em instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),em.getShaderPrecisionFormat===void 0&&(em.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(am){throw console.error("THREE.WebGLRenderer: "+am.message),am}let Zp,mm,fm,_m,zm,tm,Jp,pm,km,ym,Em,Bm,Pm,Im,Dm,jm,Fm,av,lv,tv,Jm,um,Yp,hm;function wm(){Zp=new WebGLExtensions(em),mm=new WebGLCapabilities(em,Zp,_d),Zp.init(mm),um=new WebGLUtils(em,Zp,mm),fm=new WebGLState(em,Zp,mm),_m=new WebGLInfo(em),zm=new WebGLProperties,tm=new WebGLTextures(em,Zp,fm,zm,mm,um,_m),Jp=new WebGLCubeMaps(Ep),pm=new WebGLCubeUVMaps(Ep),km=new WebGLAttributes(em,mm),Yp=new WebGLBindingStates(em,Zp,km,mm),ym=new WebGLGeometries(em,km,_m,Yp),Em=new WebGLObjects(em,ym,km,_m),lv=new WebGLMorphtargets(em,mm,tm),jm=new WebGLClipping(zm),Bm=new WebGLPrograms(Ep,Jp,pm,Zp,mm,Yp,jm),Pm=new WebGLMaterials(Ep,zm),Im=new WebGLRenderLists,Dm=new WebGLRenderStates(Zp,mm),av=new WebGLBackground(Ep,Jp,pm,fm,Em,mp,dp),Fm=new WebGLShadowMap(Ep,Em,mm),hm=new WebGLUniformsGroups(em,_m,mm,fm),tv=new WebGLBufferRenderer(em,Zp,_m,mm),Jm=new WebGLIndexedBufferRenderer(em,Zp,_m,mm),_m.programs=Bm.programs,Ep.capabilities=mm,Ep.extensions=Zp,Ep.properties=zm,Ep.renderLists=Im,Ep.shadowMap=Fm,Ep.state=fm,Ep.info=_m}wm();const Cm=new WebXRManager(Ep,em);this.xr=Cm,this.getContext=function(){return em},this.getContextAttributes=function(){return em.getContextAttributes()},this.forceContextLoss=function(){const am=Zp.get("WEBGL_lose_context");am&&am.loseContext()},this.forceContextRestore=function(){const am=Zp.get("WEBGL_lose_context");am&&am.restoreContext()},this.getPixelRatio=function(){return Bp},this.setPixelRatio=function(am){am!==void 0&&(Bp=am,this.setSize(jp,Lp,!1))},this.getSize=function(am){return am.set(jp,Lp)},this.setSize=function(am,bm,Tm=!0){if(Cm.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}jp=am,Lp=bm,np.width=Math.floor(am*Bp),np.height=Math.floor(bm*Bp),Tm===!0&&(np.style.width=am+"px",np.style.height=bm+"px"),this.setViewport(0,0,am,bm)},this.getDrawingBufferSize=function(am){return am.set(jp*Bp,Lp*Bp).floor()},this.setDrawingBufferSize=function(am,bm,Tm){jp=am,Lp=bm,Bp=Tm,np.width=Math.floor(am*Tm),np.height=Math.floor(bm*Tm),this.setViewport(0,0,am,bm)},this.getCurrentViewport=function(am){return am.copy(Pp)},this.getViewport=function(am){return am.copy(Up)},this.setViewport=function(am,bm,Tm,Nm){am.isVector4?Up.set(am.x,am.y,am.z,am.w):Up.set(am,bm,Tm,Nm),fm.viewport(Pp.copy(Up).multiplyScalar(Bp).floor())},this.getScissor=function(am){return am.copy(Gp)},this.setScissor=function(am,bm,Tm,Nm){am.isVector4?Gp.set(am.x,am.y,am.z,am.w):Gp.set(am,bm,Tm,Nm),fm.scissor($p.copy(Gp).multiplyScalar(Bp).floor())},this.getScissorTest=function(){return Wp},this.setScissorTest=function(am){fm.setScissorTest(Wp=am)},this.setOpaqueSort=function(am){Ip=am},this.setTransparentSort=function(am){kp=am},this.getClearColor=function(am){return am.copy(av.getClearColor())},this.setClearColor=function(){av.setClearColor.apply(av,arguments)},this.getClearAlpha=function(){return av.getClearAlpha()},this.setClearAlpha=function(){av.setClearAlpha.apply(av,arguments)},this.clear=function(am=!0,bm=!0,Tm=!0){let Nm=0;if(am){let Rm=!1;if(Tp!==null){const Xm=Tp.texture.format;Rm=Xm===RGBAIntegerFormat||Xm===RGIntegerFormat||Xm===RedIntegerFormat}if(Rm){const Xm=Tp.texture.type,Zm=Xm===UnsignedByteType||Xm===UnsignedIntType||Xm===UnsignedShortType||Xm===UnsignedInt248Type||Xm===UnsignedShort4444Type||Xm===UnsignedShort5551Type,iv=av.getClearColor(),ov=av.getClearAlpha(),cv=iv.r,uv=iv.g,dv=iv.b;Zm?(gp[0]=cv,gp[1]=uv,gp[2]=dv,gp[3]=ov,em.clearBufferuiv(em.COLOR,0,gp)):(yp[0]=cv,yp[1]=uv,yp[2]=dv,yp[3]=ov,em.clearBufferiv(em.COLOR,0,yp))}else Nm|=em.COLOR_BUFFER_BIT}bm&&(Nm|=em.DEPTH_BUFFER_BIT),Tm&&(Nm|=em.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),em.clear(Nm)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){np.removeEventListener("webglcontextlost",Vm,!1),np.removeEventListener("webglcontextrestored",im,!1),np.removeEventListener("webglcontextcreationerror",Am,!1),Im.dispose(),Dm.dispose(),zm.dispose(),Jp.dispose(),pm.dispose(),Em.dispose(),Yp.dispose(),hm.dispose(),Bm.dispose(),Cm.dispose(),Cm.removeEventListener("sessionstart",xv),Cm.removeEventListener("sessionend",pv),Kp&&(Kp.dispose(),Kp=null),Iv.stop()};function Vm(am){am.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Sp=!0}function im(){console.log("THREE.WebGLRenderer: Context Restored."),Sp=!1;const am=_m.autoReset,bm=Fm.enabled,Tm=Fm.autoUpdate,Nm=Fm.needsUpdate,Rm=Fm.type;wm(),_m.autoReset=am,Fm.enabled=bm,Fm.autoUpdate=Tm,Fm.needsUpdate=Nm,Fm.type=Rm}function Am(am){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",am.statusMessage)}function Lm(am){const bm=am.target;bm.removeEventListener("dispose",Lm),Um(bm)}function Um(am){Gm(am),zm.remove(am)}function Gm(am){const bm=zm.get(am).programs;bm!==void 0&&(bm.forEach(function(Tm){Bm.releaseProgram(Tm)}),am.isShaderMaterial&&Bm.releaseShaderCache(am))}this.renderBufferDirect=function(am,bm,Tm,Nm,Rm,Xm){bm===null&&(bm=Mm);const Zm=Rm.isMesh&&Rm.matrixWorld.determinant()<0,iv=$1(am,bm,Tm,Nm,Rm);fm.setMaterial(Nm,Zm);let ov=Tm.index,cv=1;if(Nm.wireframe===!0){if(ov=ym.getWireframeAttribute(Tm),ov===void 0)return;cv=2}const uv=Tm.drawRange,dv=Tm.attributes.position;let Tv=uv.start*cv,Gv=(uv.start+uv.count)*cv;Xm!==null&&(Tv=Math.max(Tv,Xm.start*cv),Gv=Math.min(Gv,(Xm.start+Xm.count)*cv)),ov!==null?(Tv=Math.max(Tv,0),Gv=Math.min(Gv,ov.count)):dv!=null&&(Tv=Math.max(Tv,0),Gv=Math.min(Gv,dv.count));const Av=Gv-Tv;if(Av<0||Av===1/0)return;Yp.setup(Rm,Nm,iv,Tm,ov);let Fv,sv=tv;if(ov!==null&&(Fv=km.get(ov),sv=Jm,sv.setIndex(Fv)),Rm.isMesh)Nm.wireframe===!0?(fm.setLineWidth(Nm.wireframeLinewidth*dm()),sv.setMode(em.LINES)):sv.setMode(em.TRIANGLES);else if(Rm.isLine){let Km=Nm.linewidth;Km===void 0&&(Km=1),fm.setLineWidth(Km*dm()),Rm.isLineSegments?sv.setMode(em.LINES):Rm.isLineLoop?sv.setMode(em.LINE_LOOP):sv.setMode(em.LINE_STRIP)}else Rm.isPoints?sv.setMode(em.POINTS):Rm.isSprite&&sv.setMode(em.TRIANGLES);if(Rm.isBatchedMesh)sv.renderMultiDraw(Rm._multiDrawStarts,Rm._multiDrawCounts,Rm._multiDrawCount);else if(Rm.isInstancedMesh)sv.renderInstances(Tv,Av,Rm.count);else if(Tm.isInstancedBufferGeometry){const Km=Tm._maxInstanceCount!==void 0?Tm._maxInstanceCount:1/0,ly=Math.min(Tm.instanceCount,Km);sv.renderInstances(Tv,Av,ly)}else sv.render(Tv,Av)};function ev(am,bm,Tm){am.transparent===!0&&am.side===DoubleSide&&am.forceSinglePass===!1?(am.side=BackSide,am.needsUpdate=!0,a0(am,bm,Tm),am.side=FrontSide,am.needsUpdate=!0,a0(am,bm,Tm),am.side=DoubleSide):a0(am,bm,Tm)}this.compile=function(am,bm,Tm=null){Tm===null&&(Tm=am),_p=Dm.get(Tm),_p.init(),bp.push(_p),Tm.traverseVisible(function(Rm){Rm.isLight&&Rm.layers.test(bm.layers)&&(_p.pushLight(Rm),Rm.castShadow&&_p.pushShadow(Rm))}),am!==Tm&&am.traverseVisible(function(Rm){Rm.isLight&&Rm.layers.test(bm.layers)&&(_p.pushLight(Rm),Rm.castShadow&&_p.pushShadow(Rm))}),_p.setupLights(Ep._useLegacyLights);const Nm=new Set;return am.traverse(function(Rm){const Xm=Rm.material;if(Xm)if(Array.isArray(Xm))for(let Zm=0;Zm<Xm.length;Zm++){const iv=Xm[Zm];ev(iv,Tm,Rm),Nm.add(iv)}else ev(Xm,Tm,Rm),Nm.add(Xm)}),bp.pop(),_p=null,Nm},this.compileAsync=function(am,bm,Tm=null){const Nm=this.compile(am,bm,Tm);return new Promise(Rm=>{function Xm(){if(Nm.forEach(function(Zm){zm.get(Zm).currentProgram.isReady()&&Nm.delete(Zm)}),Nm.size===0){Rm(am);return}setTimeout(Xm,10)}Zp.get("KHR_parallel_shader_compile")!==null?Xm():setTimeout(Xm,10)})};let nv=null;function gv(am){nv&&nv(am)}function xv(){Iv.stop()}function pv(){Iv.start()}const Iv=new WebGLAnimation;Iv.setAnimationLoop(gv),typeof self<"u"&&Iv.setContext(self),this.setAnimationLoop=function(am){nv=am,Cm.setAnimationLoop(am),am===null?Iv.stop():Iv.start()},Cm.addEventListener("sessionstart",xv),Cm.addEventListener("sessionend",pv),this.render=function(am,bm){if(bm!==void 0&&bm.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Sp===!0)return;am.matrixWorldAutoUpdate===!0&&am.updateMatrixWorld(),bm.parent===null&&bm.matrixWorldAutoUpdate===!0&&bm.updateMatrixWorld(),Cm.enabled===!0&&Cm.isPresenting===!0&&(Cm.cameraAutoUpdate===!0&&Cm.updateCamera(bm),bm=Cm.getCamera()),am.isScene===!0&&am.onBeforeRender(Ep,am,bm,Tp),_p=Dm.get(am,bp.length),_p.init(),bp.push(_p),lm.multiplyMatrices(bm.projectionMatrix,bm.matrixWorldInverse),Qp.setFromProjectionMatrix(lm),rm=this.localClippingEnabled,Xp=jm.init(this.clippingPlanes,rm),xp=Im.get(am,vp.length),xp.init(),vp.push(xp),Bv(am,bm,0,Ep.sortObjects),xp.finish(),Ep.sortObjects===!0&&xp.sort(Ip,kp),this.info.render.frame++,Xp===!0&&jm.beginShadows();const Tm=_p.state.shadowsArray;if(Fm.render(Tm,am,bm),Xp===!0&&jm.endShadows(),this.info.autoReset===!0&&this.info.reset(),(Cm.enabled===!1||Cm.isPresenting===!1||Cm.hasDepthSensing()===!1)&&av.render(xp,am),_p.setupLights(Ep._useLegacyLights),bm.isArrayCamera){const Nm=bm.cameras;for(let Rm=0,Xm=Nm.length;Rm<Xm;Rm++){const Zm=Nm[Rm];xy(xp,am,Zm,Zm.viewport)}}else xy(xp,am,bm);Tp!==null&&(tm.updateMultisampleRenderTarget(Tp),tm.updateRenderTargetMipmap(Tp)),am.isScene===!0&&am.onAfterRender(Ep,am,bm),Yp.resetDefaultState(),Mp=-1,Op=null,bp.pop(),bp.length>0?_p=bp[bp.length-1]:_p=null,vp.pop(),vp.length>0?xp=vp[vp.length-1]:xp=null};function Bv(am,bm,Tm,Nm){if(am.visible===!1)return;if(am.layers.test(bm.layers)){if(am.isGroup)Tm=am.renderOrder;else if(am.isLOD)am.autoUpdate===!0&&am.update(bm);else if(am.isLight)_p.pushLight(am),am.castShadow&&_p.pushShadow(am);else if(am.isSprite){if(!am.frustumCulled||Qp.intersectsSprite(am)){Nm&&gm.setFromMatrixPosition(am.matrixWorld).applyMatrix4(lm);const Zm=Em.update(am),iv=am.material;iv.visible&&xp.push(am,Zm,iv,Tm,gm.z,null)}}else if((am.isMesh||am.isLine||am.isPoints)&&(!am.frustumCulled||Qp.intersectsObject(am))){const Zm=Em.update(am),iv=am.material;if(Nm&&(am.boundingSphere!==void 0?(am.boundingSphere===null&&am.computeBoundingSphere(),gm.copy(am.boundingSphere.center)):(Zm.boundingSphere===null&&Zm.computeBoundingSphere(),gm.copy(Zm.boundingSphere.center)),gm.applyMatrix4(am.matrixWorld).applyMatrix4(lm)),Array.isArray(iv)){const ov=Zm.groups;for(let cv=0,uv=ov.length;cv<uv;cv++){const dv=ov[cv],Tv=iv[dv.materialIndex];Tv&&Tv.visible&&xp.push(am,Zm,Tv,Tm,gm.z,dv)}}else iv.visible&&xp.push(am,Zm,iv,Tm,gm.z,null)}}const Xm=am.children;for(let Zm=0,iv=Xm.length;Zm<iv;Zm++)Bv(Xm[Zm],bm,Tm,Nm)}function xy(am,bm,Tm,Nm){const Rm=am.opaque,Xm=am.transmissive,Zm=am.transparent;_p.setupLightsView(Tm),Xp===!0&&jm.setGlobalState(Ep.clippingPlanes,Tm),Xm.length>0&&_0(Rm,Xm,bm,Tm),Nm&&fm.viewport(Pp.copy(Nm)),Rm.length>0&&i0(Rm,bm,Tm),Xm.length>0&&i0(Xm,bm,Tm),Zm.length>0&&i0(Zm,bm,Tm),fm.buffers.depth.setTest(!0),fm.buffers.depth.setMask(!0),fm.buffers.color.setMask(!0),fm.setPolygonOffset(!1)}function _0(am,bm,Tm,Nm){if((Tm.isScene===!0?Tm.overrideMaterial:null)!==null)return;const Xm=mm.isWebGL2;Kp===null&&(Kp=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:Zp.has("EXT_color_buffer_half_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:Xm?4:0})),Ep.getDrawingBufferSize(cm),Xm?Kp.setSize(cm.x,cm.y):Kp.setSize(floorPowerOfTwo(cm.x),floorPowerOfTwo(cm.y));const Zm=Ep.getRenderTarget();Ep.setRenderTarget(Kp),Ep.getClearColor(Dp),Fp=Ep.getClearAlpha(),Fp<1&&Ep.setClearColor(16777215,.5),Ep.clear();const iv=Ep.toneMapping;Ep.toneMapping=NoToneMapping,i0(am,Tm,Nm),tm.updateMultisampleRenderTarget(Kp),tm.updateRenderTargetMipmap(Kp);let ov=!1;for(let cv=0,uv=bm.length;cv<uv;cv++){const dv=bm[cv],Tv=dv.object,Gv=dv.geometry,Av=dv.material,Fv=dv.group;if(Av.side===DoubleSide&&Tv.layers.test(Nm.layers)){const sv=Av.side;Av.side=BackSide,Av.needsUpdate=!0,Vy(Tv,Tm,Nm,Gv,Av,Fv),Av.side=sv,Av.needsUpdate=!0,ov=!0}}ov===!0&&(tm.updateMultisampleRenderTarget(Kp),tm.updateRenderTargetMipmap(Kp)),Ep.setRenderTarget(Zm),Ep.setClearColor(Dp,Fp),Ep.toneMapping=iv}function i0(am,bm,Tm){const Nm=bm.isScene===!0?bm.overrideMaterial:null;for(let Rm=0,Xm=am.length;Rm<Xm;Rm++){const Zm=am[Rm],iv=Zm.object,ov=Zm.geometry,cv=Nm===null?Zm.material:Nm,uv=Zm.group;iv.layers.test(Tm.layers)&&Vy(iv,bm,Tm,ov,cv,uv)}}function Vy(am,bm,Tm,Nm,Rm,Xm){am.onBeforeRender(Ep,bm,Tm,Nm,Rm,Xm),am.modelViewMatrix.multiplyMatrices(Tm.matrixWorldInverse,am.matrixWorld),am.normalMatrix.getNormalMatrix(am.modelViewMatrix),Rm.onBeforeRender(Ep,bm,Tm,Nm,am,Xm),Rm.transparent===!0&&Rm.side===DoubleSide&&Rm.forceSinglePass===!1?(Rm.side=BackSide,Rm.needsUpdate=!0,Ep.renderBufferDirect(Tm,bm,Nm,Rm,am,Xm),Rm.side=FrontSide,Rm.needsUpdate=!0,Ep.renderBufferDirect(Tm,bm,Nm,Rm,am,Xm),Rm.side=DoubleSide):Ep.renderBufferDirect(Tm,bm,Nm,Rm,am,Xm),am.onAfterRender(Ep,bm,Tm,Nm,Rm,Xm)}function a0(am,bm,Tm){bm.isScene!==!0&&(bm=Mm);const Nm=zm.get(am),Rm=_p.state.lights,Xm=_p.state.shadowsArray,Zm=Rm.state.version,iv=Bm.getParameters(am,Rm.state,Xm,bm,Tm),ov=Bm.getProgramCacheKey(iv);let cv=Nm.programs;Nm.environment=am.isMeshStandardMaterial?bm.environment:null,Nm.fog=bm.fog,Nm.envMap=(am.isMeshStandardMaterial?pm:Jp).get(am.envMap||Nm.environment),cv===void 0&&(am.addEventListener("dispose",Lm),cv=new Map,Nm.programs=cv);let uv=cv.get(ov);if(uv!==void 0){if(Nm.currentProgram===uv&&Nm.lightsStateVersion===Zm)return z0(am,iv),uv}else iv.uniforms=Bm.getUniforms(am),am.onBuild(Tm,iv,Ep),am.onBeforeCompile(iv,Ep),uv=Bm.acquireProgram(iv,ov),cv.set(ov,uv),Nm.uniforms=iv.uniforms;const dv=Nm.uniforms;return(!am.isShaderMaterial&&!am.isRawShaderMaterial||am.clipping===!0)&&(dv.clippingPlanes=jm.uniform),z0(am,iv),Nm.needsLights=F1(am),Nm.lightsStateVersion=Zm,Nm.needsLights&&(dv.ambientLightColor.value=Rm.state.ambient,dv.lightProbe.value=Rm.state.probe,dv.directionalLights.value=Rm.state.directional,dv.directionalLightShadows.value=Rm.state.directionalShadow,dv.spotLights.value=Rm.state.spot,dv.spotLightShadows.value=Rm.state.spotShadow,dv.rectAreaLights.value=Rm.state.rectArea,dv.ltc_1.value=Rm.state.rectAreaLTC1,dv.ltc_2.value=Rm.state.rectAreaLTC2,dv.pointLights.value=Rm.state.point,dv.pointLightShadows.value=Rm.state.pointShadow,dv.hemisphereLights.value=Rm.state.hemi,dv.directionalShadowMap.value=Rm.state.directionalShadowMap,dv.directionalShadowMatrix.value=Rm.state.directionalShadowMatrix,dv.spotShadowMap.value=Rm.state.spotShadowMap,dv.spotLightMatrix.value=Rm.state.spotLightMatrix,dv.spotLightMap.value=Rm.state.spotLightMap,dv.pointShadowMap.value=Rm.state.pointShadowMap,dv.pointShadowMatrix.value=Rm.state.pointShadowMatrix),Nm.currentProgram=uv,Nm.uniformsList=null,uv}function V0(am){if(am.uniformsList===null){const bm=am.currentProgram.getUniforms();am.uniformsList=WebGLUniforms.seqWithValue(bm.seq,am.uniforms)}return am.uniformsList}function z0(am,bm){const Tm=zm.get(am);Tm.outputColorSpace=bm.outputColorSpace,Tm.batching=bm.batching,Tm.instancing=bm.instancing,Tm.instancingColor=bm.instancingColor,Tm.skinning=bm.skinning,Tm.morphTargets=bm.morphTargets,Tm.morphNormals=bm.morphNormals,Tm.morphColors=bm.morphColors,Tm.morphTargetsCount=bm.morphTargetsCount,Tm.numClippingPlanes=bm.numClippingPlanes,Tm.numIntersection=bm.numClipIntersection,Tm.vertexAlphas=bm.vertexAlphas,Tm.vertexTangents=bm.vertexTangents,Tm.toneMapping=bm.toneMapping}function $1(am,bm,Tm,Nm,Rm){bm.isScene!==!0&&(bm=Mm),tm.resetTextureUnits();const Xm=bm.fog,Zm=Nm.isMeshStandardMaterial?bm.environment:null,iv=Tp===null?Ep.outputColorSpace:Tp.isXRRenderTarget===!0?Tp.texture.colorSpace:LinearSRGBColorSpace$1,ov=(Nm.isMeshStandardMaterial?pm:Jp).get(Nm.envMap||Zm),cv=Nm.vertexColors===!0&&!!Tm.attributes.color&&Tm.attributes.color.itemSize===4,uv=!!Tm.attributes.tangent&&(!!Nm.normalMap||Nm.anisotropy>0),dv=!!Tm.morphAttributes.position,Tv=!!Tm.morphAttributes.normal,Gv=!!Tm.morphAttributes.color;let Av=NoToneMapping;Nm.toneMapped&&(Tp===null||Tp.isXRRenderTarget===!0)&&(Av=Ep.toneMapping);const Fv=Tm.morphAttributes.position||Tm.morphAttributes.normal||Tm.morphAttributes.color,sv=Fv!==void 0?Fv.length:0,Km=zm.get(Nm),ly=_p.state.lights;if(Xp===!0&&(rm===!0||am!==Op)){const Hv=am===Op&&Nm.id===Mp;jm.setState(Nm,am,Hv)}let vv=!1;Nm.version===Km.__version?(Km.needsLights&&Km.lightsStateVersion!==ly.state.version||Km.outputColorSpace!==iv||Rm.isBatchedMesh&&Km.batching===!1||!Rm.isBatchedMesh&&Km.batching===!0||Rm.isInstancedMesh&&Km.instancing===!1||!Rm.isInstancedMesh&&Km.instancing===!0||Rm.isSkinnedMesh&&Km.skinning===!1||!Rm.isSkinnedMesh&&Km.skinning===!0||Rm.isInstancedMesh&&Km.instancingColor===!0&&Rm.instanceColor===null||Rm.isInstancedMesh&&Km.instancingColor===!1&&Rm.instanceColor!==null||Km.envMap!==ov||Nm.fog===!0&&Km.fog!==Xm||Km.numClippingPlanes!==void 0&&(Km.numClippingPlanes!==jm.numPlanes||Km.numIntersection!==jm.numIntersection)||Km.vertexAlphas!==cv||Km.vertexTangents!==uv||Km.morphTargets!==dv||Km.morphNormals!==Tv||Km.morphColors!==Gv||Km.toneMapping!==Av||mm.isWebGL2===!0&&Km.morphTargetsCount!==sv)&&(vv=!0):(vv=!0,Km.__version=Nm.version);let Pv=Km.currentProgram;vv===!0&&(Pv=a0(Nm,bm,Rm));let Sy=!1,uy=!1,Vv=!1;const Ov=Pv.getUniforms(),wy=Km.uniforms;if(fm.useProgram(Pv.program)&&(Sy=!0,uy=!0,Vv=!0),Nm.id!==Mp&&(Mp=Nm.id,uy=!0),Sy||Op!==am){Ov.setValue(em,"projectionMatrix",am.projectionMatrix),Ov.setValue(em,"viewMatrix",am.matrixWorldInverse);const Hv=Ov.map.cameraPosition;Hv!==void 0&&Hv.setValue(em,gm.setFromMatrixPosition(am.matrixWorld)),mm.logarithmicDepthBuffer&&Ov.setValue(em,"logDepthBufFC",2/(Math.log(am.far+1)/Math.LN2)),(Nm.isMeshPhongMaterial||Nm.isMeshToonMaterial||Nm.isMeshLambertMaterial||Nm.isMeshBasicMaterial||Nm.isMeshStandardMaterial||Nm.isShaderMaterial)&&Ov.setValue(em,"isOrthographic",am.isOrthographicCamera===!0),Op!==am&&(Op=am,uy=!0,Vv=!0)}if(Rm.isSkinnedMesh){Ov.setOptional(em,Rm,"bindMatrix"),Ov.setOptional(em,Rm,"bindMatrixInverse");const Hv=Rm.skeleton;Hv&&(mm.floatVertexTextures?(Hv.boneTexture===null&&Hv.computeBoneTexture(),Ov.setValue(em,"boneTexture",Hv.boneTexture,tm)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Rm.isBatchedMesh&&(Ov.setOptional(em,Rm,"batchingTexture"),Ov.setValue(em,"batchingTexture",Rm._matricesTexture,tm));const o0=Tm.morphAttributes;if((o0.position!==void 0||o0.normal!==void 0||o0.color!==void 0&&mm.isWebGL2===!0)&&lv.update(Rm,Tm,Pv),(uy||Km.receiveShadow!==Rm.receiveShadow)&&(Km.receiveShadow=Rm.receiveShadow,Ov.setValue(em,"receiveShadow",Rm.receiveShadow)),Nm.isMeshGouraudMaterial&&Nm.envMap!==null&&(wy.envMap.value=ov,wy.flipEnvMap.value=ov.isCubeTexture&&ov.isRenderTargetTexture===!1?-1:1),uy&&(Ov.setValue(em,"toneMappingExposure",Ep.toneMappingExposure),Km.needsLights&&B1(wy,Vv),Xm&&Nm.fog===!0&&Pm.refreshFogUniforms(wy,Xm),Pm.refreshMaterialUniforms(wy,Nm,Bp,Lp,Kp),WebGLUniforms.upload(em,V0(Km),wy,tm)),Nm.isShaderMaterial&&Nm.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(em,V0(Km),wy,tm),Nm.uniformsNeedUpdate=!1),Nm.isSpriteMaterial&&Ov.setValue(em,"center",Rm.center),Ov.setValue(em,"modelViewMatrix",Rm.modelViewMatrix),Ov.setValue(em,"normalMatrix",Rm.normalMatrix),Ov.setValue(em,"modelMatrix",Rm.matrixWorld),Nm.isShaderMaterial||Nm.isRawShaderMaterial){const Hv=Nm.uniformsGroups;for(let s0=0,ry=Hv.length;s0<ry;s0++)if(mm.isWebGL2){const U0=Hv[s0];hm.update(U0,Pv),hm.bind(U0,Pv)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Pv}function B1(am,bm){am.ambientLightColor.needsUpdate=bm,am.lightProbe.needsUpdate=bm,am.directionalLights.needsUpdate=bm,am.directionalLightShadows.needsUpdate=bm,am.pointLights.needsUpdate=bm,am.pointLightShadows.needsUpdate=bm,am.spotLights.needsUpdate=bm,am.spotLightShadows.needsUpdate=bm,am.rectAreaLights.needsUpdate=bm,am.hemisphereLights.needsUpdate=bm}function F1(am){return am.isMeshLambertMaterial||am.isMeshToonMaterial||am.isMeshPhongMaterial||am.isMeshStandardMaterial||am.isShadowMaterial||am.isShaderMaterial&&am.lights===!0}this.getActiveCubeFace=function(){return Ap},this.getActiveMipmapLevel=function(){return Rp},this.getRenderTarget=function(){return Tp},this.setRenderTargetTextures=function(am,bm,Tm){zm.get(am.texture).__webglTexture=bm,zm.get(am.depthTexture).__webglTexture=Tm;const Nm=zm.get(am);Nm.__hasExternalTextures=!0,Nm.__hasExternalTextures&&(Nm.__autoAllocateDepthBuffer=Tm===void 0,Nm.__autoAllocateDepthBuffer||Zp.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Nm.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(am,bm){const Tm=zm.get(am);Tm.__webglFramebuffer=bm,Tm.__useDefaultFramebuffer=bm===void 0},this.setRenderTarget=function(am,bm=0,Tm=0){Tp=am,Ap=bm,Rp=Tm;let Nm=!0,Rm=null,Xm=!1,Zm=!1;if(am){const ov=zm.get(am);ov.__useDefaultFramebuffer!==void 0?(fm.bindFramebuffer(em.FRAMEBUFFER,null),Nm=!1):ov.__webglFramebuffer===void 0?tm.setupRenderTarget(am):ov.__hasExternalTextures&&tm.rebindTextures(am,zm.get(am.texture).__webglTexture,zm.get(am.depthTexture).__webglTexture);const cv=am.texture;(cv.isData3DTexture||cv.isDataArrayTexture||cv.isCompressedArrayTexture)&&(Zm=!0);const uv=zm.get(am).__webglFramebuffer;am.isWebGLCubeRenderTarget?(Array.isArray(uv[bm])?Rm=uv[bm][Tm]:Rm=uv[bm],Xm=!0):mm.isWebGL2&&am.samples>0&&tm.useMultisampledRTT(am)===!1?Rm=zm.get(am).__webglMultisampledFramebuffer:Array.isArray(uv)?Rm=uv[Tm]:Rm=uv,Pp.copy(am.viewport),$p.copy(am.scissor),zp=am.scissorTest}else Pp.copy(Up).multiplyScalar(Bp).floor(),$p.copy(Gp).multiplyScalar(Bp).floor(),zp=Wp;if(fm.bindFramebuffer(em.FRAMEBUFFER,Rm)&&mm.drawBuffers&&Nm&&fm.drawBuffers(am,Rm),fm.viewport(Pp),fm.scissor($p),fm.setScissorTest(zp),Xm){const ov=zm.get(am.texture);em.framebufferTexture2D(em.FRAMEBUFFER,em.COLOR_ATTACHMENT0,em.TEXTURE_CUBE_MAP_POSITIVE_X+bm,ov.__webglTexture,Tm)}else if(Zm){const ov=zm.get(am.texture),cv=bm||0;em.framebufferTextureLayer(em.FRAMEBUFFER,em.COLOR_ATTACHMENT0,ov.__webglTexture,Tm||0,cv)}Mp=-1},this.readRenderTargetPixels=function(am,bm,Tm,Nm,Rm,Xm,Zm){if(!(am&&am.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let iv=zm.get(am).__webglFramebuffer;if(am.isWebGLCubeRenderTarget&&Zm!==void 0&&(iv=iv[Zm]),iv){fm.bindFramebuffer(em.FRAMEBUFFER,iv);try{const ov=am.texture,cv=ov.format,uv=ov.type;if(cv!==RGBAFormat&&um.convert(cv)!==em.getParameter(em.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const dv=uv===HalfFloatType&&(Zp.has("EXT_color_buffer_half_float")||mm.isWebGL2&&Zp.has("EXT_color_buffer_float"));if(uv!==UnsignedByteType&&um.convert(uv)!==em.getParameter(em.IMPLEMENTATION_COLOR_READ_TYPE)&&!(uv===FloatType&&(mm.isWebGL2||Zp.has("OES_texture_float")||Zp.has("WEBGL_color_buffer_float")))&&!dv){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}bm>=0&&bm<=am.width-Nm&&Tm>=0&&Tm<=am.height-Rm&&em.readPixels(bm,Tm,Nm,Rm,um.convert(cv),um.convert(uv),Xm)}finally{const ov=Tp!==null?zm.get(Tp).__webglFramebuffer:null;fm.bindFramebuffer(em.FRAMEBUFFER,ov)}}},this.copyFramebufferToTexture=function(am,bm,Tm=0){const Nm=Math.pow(2,-Tm),Rm=Math.floor(bm.image.width*Nm),Xm=Math.floor(bm.image.height*Nm);tm.setTexture2D(bm,0),em.copyTexSubImage2D(em.TEXTURE_2D,Tm,0,0,am.x,am.y,Rm,Xm),fm.unbindTexture()},this.copyTextureToTexture=function(am,bm,Tm,Nm=0){const Rm=bm.image.width,Xm=bm.image.height,Zm=um.convert(Tm.format),iv=um.convert(Tm.type);tm.setTexture2D(Tm,0),em.pixelStorei(em.UNPACK_FLIP_Y_WEBGL,Tm.flipY),em.pixelStorei(em.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Tm.premultiplyAlpha),em.pixelStorei(em.UNPACK_ALIGNMENT,Tm.unpackAlignment),bm.isDataTexture?em.texSubImage2D(em.TEXTURE_2D,Nm,am.x,am.y,Rm,Xm,Zm,iv,bm.image.data):bm.isCompressedTexture?em.compressedTexSubImage2D(em.TEXTURE_2D,Nm,am.x,am.y,bm.mipmaps[0].width,bm.mipmaps[0].height,Zm,bm.mipmaps[0].data):em.texSubImage2D(em.TEXTURE_2D,Nm,am.x,am.y,Zm,iv,bm.image),Nm===0&&Tm.generateMipmaps&&em.generateMipmap(em.TEXTURE_2D),fm.unbindTexture()},this.copyTextureToTexture3D=function(am,bm,Tm,Nm,Rm=0){if(Ep.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Xm=am.max.x-am.min.x+1,Zm=am.max.y-am.min.y+1,iv=am.max.z-am.min.z+1,ov=um.convert(Nm.format),cv=um.convert(Nm.type);let uv;if(Nm.isData3DTexture)tm.setTexture3D(Nm,0),uv=em.TEXTURE_3D;else if(Nm.isDataArrayTexture||Nm.isCompressedArrayTexture)tm.setTexture2DArray(Nm,0),uv=em.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}em.pixelStorei(em.UNPACK_FLIP_Y_WEBGL,Nm.flipY),em.pixelStorei(em.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Nm.premultiplyAlpha),em.pixelStorei(em.UNPACK_ALIGNMENT,Nm.unpackAlignment);const dv=em.getParameter(em.UNPACK_ROW_LENGTH),Tv=em.getParameter(em.UNPACK_IMAGE_HEIGHT),Gv=em.getParameter(em.UNPACK_SKIP_PIXELS),Av=em.getParameter(em.UNPACK_SKIP_ROWS),Fv=em.getParameter(em.UNPACK_SKIP_IMAGES),sv=Tm.isCompressedTexture?Tm.mipmaps[Rm]:Tm.image;em.pixelStorei(em.UNPACK_ROW_LENGTH,sv.width),em.pixelStorei(em.UNPACK_IMAGE_HEIGHT,sv.height),em.pixelStorei(em.UNPACK_SKIP_PIXELS,am.min.x),em.pixelStorei(em.UNPACK_SKIP_ROWS,am.min.y),em.pixelStorei(em.UNPACK_SKIP_IMAGES,am.min.z),Tm.isDataTexture||Tm.isData3DTexture?em.texSubImage3D(uv,Rm,bm.x,bm.y,bm.z,Xm,Zm,iv,ov,cv,sv.data):Tm.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),em.compressedTexSubImage3D(uv,Rm,bm.x,bm.y,bm.z,Xm,Zm,iv,ov,sv.data)):em.texSubImage3D(uv,Rm,bm.x,bm.y,bm.z,Xm,Zm,iv,ov,cv,sv),em.pixelStorei(em.UNPACK_ROW_LENGTH,dv),em.pixelStorei(em.UNPACK_IMAGE_HEIGHT,Tv),em.pixelStorei(em.UNPACK_SKIP_PIXELS,Gv),em.pixelStorei(em.UNPACK_SKIP_ROWS,Av),em.pixelStorei(em.UNPACK_SKIP_IMAGES,Fv),Rm===0&&Nm.generateMipmaps&&em.generateMipmap(uv),fm.unbindTexture()},this.initTexture=function(am){am.isCubeTexture?tm.setTextureCube(am,0):am.isData3DTexture?tm.setTexture3D(am,0):am.isDataArrayTexture||am.isCompressedArrayTexture?tm.setTexture2DArray(am,0):tm.setTexture2D(am,0),fm.unbindTexture()},this.resetState=function(){Ap=0,Rp=0,Tp=null,fm.reset(),Yp.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(_d){this._outputColorSpace=_d;const np=this.getContext();np.drawingBufferColorSpace=_d===DisplayP3ColorSpace?"display-p3":"srgb",np.unpackColorSpace=ColorManagement.workingColorSpace===LinearDisplayP3ColorSpace?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===SRGBColorSpace$1?sRGBEncoding:LinearEncoding}set outputEncoding(_d){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=_d===sRGBEncoding?SRGBColorSpace$1:LinearSRGBColorSpace$1}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(_d){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=_d}}class WebGL1Renderer extends WebGLRenderer{}WebGL1Renderer.prototype.isWebGL1Renderer=!0;class FogExp2{constructor(_d,np=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color(_d),this.density=np}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Fog{constructor(_d,np=1,ap=1e3){this.isFog=!0,this.name="",this.color=new Color(_d),this.near=np,this.far=ap}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_d,np){return super.copy(_d,np),_d.background!==null&&(this.background=_d.background.clone()),_d.environment!==null&&(this.environment=_d.environment.clone()),_d.fog!==null&&(this.fog=_d.fog.clone()),this.backgroundBlurriness=_d.backgroundBlurriness,this.backgroundIntensity=_d.backgroundIntensity,_d.overrideMaterial!==null&&(this.overrideMaterial=_d.overrideMaterial.clone()),this.matrixAutoUpdate=_d.matrixAutoUpdate,this}toJSON(_d){const np=super.toJSON(_d);return this.fog!==null&&(np.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(np.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(np.object.backgroundIntensity=this.backgroundIntensity),np}}class InterleavedBuffer{constructor(_d,np){this.isInterleavedBuffer=!0,this.array=_d,this.stride=np,this.count=_d!==void 0?_d.length/np:0,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=generateUUID()}onUploadCallback(){}set needsUpdate(_d){_d===!0&&this.version++}get updateRange(){return warnOnce("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(_d){return this.usage=_d,this}addUpdateRange(_d,np){this.updateRanges.push({start:_d,count:np})}clearUpdateRanges(){this.updateRanges.length=0}copy(_d){return this.array=new _d.array.constructor(_d.array),this.count=_d.count,this.stride=_d.stride,this.usage=_d.usage,this}copyAt(_d,np,ap){_d*=this.stride,ap*=np.stride;for(let sp=0,lp=this.stride;sp<lp;sp++)this.array[_d+sp]=np.array[ap+sp];return this}set(_d,np=0){return this.array.set(_d,np),this}clone(_d){_d.arrayBuffers===void 0&&(_d.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),_d.arrayBuffers[this.array.buffer._uuid]===void 0&&(_d.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const np=new this.array.constructor(_d.arrayBuffers[this.array.buffer._uuid]),ap=new this.constructor(np,this.stride);return ap.setUsage(this.usage),ap}onUpload(_d){return this.onUploadCallback=_d,this}toJSON(_d){return _d.arrayBuffers===void 0&&(_d.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),_d.arrayBuffers[this.array.buffer._uuid]===void 0&&(_d.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$6=new Vector3;class InterleavedBufferAttribute{constructor(_d,np,ap,sp=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_d,this.itemSize=np,this.offset=ap,this.normalized=sp}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_d){this.data.needsUpdate=_d}applyMatrix4(_d){for(let np=0,ap=this.data.count;np<ap;np++)_vector$6.fromBufferAttribute(this,np),_vector$6.applyMatrix4(_d),this.setXYZ(np,_vector$6.x,_vector$6.y,_vector$6.z);return this}applyNormalMatrix(_d){for(let np=0,ap=this.count;np<ap;np++)_vector$6.fromBufferAttribute(this,np),_vector$6.applyNormalMatrix(_d),this.setXYZ(np,_vector$6.x,_vector$6.y,_vector$6.z);return this}transformDirection(_d){for(let np=0,ap=this.count;np<ap;np++)_vector$6.fromBufferAttribute(this,np),_vector$6.transformDirection(_d),this.setXYZ(np,_vector$6.x,_vector$6.y,_vector$6.z);return this}getComponent(_d,np){let ap=this.array[_d*this.data.stride+this.offset+np];return this.normalized&&(ap=denormalize(ap,this.array)),ap}setComponent(_d,np,ap){return this.normalized&&(ap=normalize(ap,this.array)),this.data.array[_d*this.data.stride+this.offset+np]=ap,this}setX(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.data.array[_d*this.data.stride+this.offset]=np,this}setY(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.data.array[_d*this.data.stride+this.offset+1]=np,this}setZ(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.data.array[_d*this.data.stride+this.offset+2]=np,this}setW(_d,np){return this.normalized&&(np=normalize(np,this.array)),this.data.array[_d*this.data.stride+this.offset+3]=np,this}getX(_d){let np=this.data.array[_d*this.data.stride+this.offset];return this.normalized&&(np=denormalize(np,this.array)),np}getY(_d){let np=this.data.array[_d*this.data.stride+this.offset+1];return this.normalized&&(np=denormalize(np,this.array)),np}getZ(_d){let np=this.data.array[_d*this.data.stride+this.offset+2];return this.normalized&&(np=denormalize(np,this.array)),np}getW(_d){let np=this.data.array[_d*this.data.stride+this.offset+3];return this.normalized&&(np=denormalize(np,this.array)),np}setXY(_d,np,ap){return _d=_d*this.data.stride+this.offset,this.normalized&&(np=normalize(np,this.array),ap=normalize(ap,this.array)),this.data.array[_d+0]=np,this.data.array[_d+1]=ap,this}setXYZ(_d,np,ap,sp){return _d=_d*this.data.stride+this.offset,this.normalized&&(np=normalize(np,this.array),ap=normalize(ap,this.array),sp=normalize(sp,this.array)),this.data.array[_d+0]=np,this.data.array[_d+1]=ap,this.data.array[_d+2]=sp,this}setXYZW(_d,np,ap,sp,lp){return _d=_d*this.data.stride+this.offset,this.normalized&&(np=normalize(np,this.array),ap=normalize(ap,this.array),sp=normalize(sp,this.array),lp=normalize(lp,this.array)),this.data.array[_d+0]=np,this.data.array[_d+1]=ap,this.data.array[_d+2]=sp,this.data.array[_d+3]=lp,this}clone(_d){if(_d===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const np=[];for(let ap=0;ap<this.count;ap++){const sp=ap*this.data.stride+this.offset;for(let lp=0;lp<this.itemSize;lp++)np.push(this.data.array[sp+lp])}return new BufferAttribute(new this.array.constructor(np),this.itemSize,this.normalized)}else return _d.interleavedBuffers===void 0&&(_d.interleavedBuffers={}),_d.interleavedBuffers[this.data.uuid]===void 0&&(_d.interleavedBuffers[this.data.uuid]=this.data.clone(_d)),new InterleavedBufferAttribute(_d.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_d){if(_d===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const np=[];for(let ap=0;ap<this.count;ap++){const sp=ap*this.data.stride+this.offset;for(let lp=0;lp<this.itemSize;lp++)np.push(this.data.array[sp+lp])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:np,normalized:this.normalized}}else return _d.interleavedBuffers===void 0&&(_d.interleavedBuffers={}),_d.interleavedBuffers[this.data.uuid]===void 0&&(_d.interleavedBuffers[this.data.uuid]=this.data.toJSON(_d)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(_d){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.color.copy(_d.color),this.map=_d.map,this.alphaMap=_d.alphaMap,this.rotation=_d.rotation,this.sizeAttenuation=_d.sizeAttenuation,this.fog=_d.fog,this}}let _geometry;const _intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2;class Sprite extends Object3D{constructor(_d=new SpriteMaterial){if(super(),this.isSprite=!0,this.type="Sprite",_geometry===void 0){_geometry=new BufferGeometry;const np=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),ap=new InterleavedBuffer(np,5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(ap,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(ap,2,3,!1))}this.geometry=_geometry,this.material=_d,this.center=new Vector2(.5,.5)}raycast(_d,np){_d.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(_d.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(_d.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),_d.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);const ap=this.material.rotation;let sp,lp;ap!==0&&(lp=Math.cos(ap),sp=Math.sin(ap));const up=this.center;transformVertex(_vA.set(-.5,-.5,0),_mvPosition,up,_worldScale,sp,lp),transformVertex(_vB.set(.5,-.5,0),_mvPosition,up,_worldScale,sp,lp),transformVertex(_vC.set(.5,.5,0),_mvPosition,up,_worldScale,sp,lp),_uvA.set(0,0),_uvB.set(1,0),_uvC.set(1,1);let cp=_d.ray.intersectTriangle(_vA,_vB,_vC,!1,_intersectPoint);if(cp===null&&(transformVertex(_vB.set(-.5,.5,0),_mvPosition,up,_worldScale,sp,lp),_uvB.set(0,1),cp=_d.ray.intersectTriangle(_vA,_vC,_vB,!1,_intersectPoint),cp===null))return;const dp=_d.ray.origin.distanceTo(_intersectPoint);dp<_d.near||dp>_d.far||np.push({distance:dp,point:_intersectPoint.clone(),uv:Triangle.getInterpolation(_intersectPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2),face:null,object:this})}copy(_d,np){return super.copy(_d,np),_d.center!==void 0&&this.center.copy(_d.center),this.material=_d.material,this}}function transformVertex(rp,_d,np,ap,sp,lp){_alignedPosition.subVectors(rp,np).addScalar(.5).multiply(ap),sp!==void 0?(_rotatedPosition.x=lp*_alignedPosition.x-sp*_alignedPosition.y,_rotatedPosition.y=sp*_alignedPosition.x+lp*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),rp.copy(_d),rp.x+=_rotatedPosition.x,rp.y+=_rotatedPosition.y,rp.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3,_v2$1=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(_d){super.copy(_d,!1);const np=_d.levels;for(let ap=0,sp=np.length;ap<sp;ap++){const lp=np[ap];this.addLevel(lp.object.clone(),lp.distance,lp.hysteresis)}return this.autoUpdate=_d.autoUpdate,this}addLevel(_d,np=0,ap=0){np=Math.abs(np);const sp=this.levels;let lp;for(lp=0;lp<sp.length&&!(np<sp[lp].distance);lp++);return sp.splice(lp,0,{distance:np,hysteresis:ap,object:_d}),this.add(_d),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(_d){const np=this.levels;if(np.length>0){let ap,sp;for(ap=1,sp=np.length;ap<sp;ap++){let lp=np[ap].distance;if(np[ap].object.visible&&(lp-=lp*np[ap].hysteresis),_d<lp)break}return np[ap-1].object}return null}raycast(_d,np){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const sp=_d.ray.origin.distanceTo(_v1$2);this.getObjectForDistance(sp).raycast(_d,np)}}update(_d){const np=this.levels;if(np.length>1){_v1$2.setFromMatrixPosition(_d.matrixWorld),_v2$1.setFromMatrixPosition(this.matrixWorld);const ap=_v1$2.distanceTo(_v2$1)/_d.zoom;np[0].object.visible=!0;let sp,lp;for(sp=1,lp=np.length;sp<lp;sp++){let up=np[sp].distance;if(np[sp].object.visible&&(up-=up*np[sp].hysteresis),ap>=up)np[sp-1].object.visible=!1,np[sp].object.visible=!0;else break}for(this._currentLevel=sp-1;sp<lp;sp++)np[sp].object.visible=!1}}toJSON(_d){const np=super.toJSON(_d);this.autoUpdate===!1&&(np.object.autoUpdate=!1),np.object.levels=[];const ap=this.levels;for(let sp=0,lp=ap.length;sp<lp;sp++){const up=ap[sp];np.object.levels.push({object:up.object.uuid,distance:up.distance,hysteresis:up.hysteresis})}return np}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$4=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2=new Ray;class SkinnedMesh extends Mesh{constructor(_d,np){super(_d,np),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AttachedBindMode,this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const _d=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const np=_d.getAttribute("position");for(let ap=0;ap<np.count;ap++)this.getVertexPosition(ap,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const _d=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const np=_d.getAttribute("position");for(let ap=0;ap<np.count;ap++)this.getVertexPosition(ap,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(_d,np){return super.copy(_d,np),this.bindMode=_d.bindMode,this.bindMatrix.copy(_d.bindMatrix),this.bindMatrixInverse.copy(_d.bindMatrixInverse),this.skeleton=_d.skeleton,_d.boundingBox!==null&&(this.boundingBox=_d.boundingBox.clone()),_d.boundingSphere!==null&&(this.boundingSphere=_d.boundingSphere.clone()),this}raycast(_d,np){const ap=this.material,sp=this.matrixWorld;ap!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$4.copy(this.boundingSphere),_sphere$4.applyMatrix4(sp),_d.ray.intersectsSphere(_sphere$4)!==!1&&(_inverseMatrix$2.copy(sp).invert(),_ray$2.copy(_d.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(_d,np,_ray$2)))}getVertexPosition(_d,np){return super.getVertexPosition(_d,np),this.applyBoneTransform(_d,np),np}bind(_d,np){this.skeleton=_d,np===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),np=this.matrixWorld),this.bindMatrix.copy(np),this.bindMatrixInverse.copy(np).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _d=new Vector4,np=this.geometry.attributes.skinWeight;for(let ap=0,sp=np.count;ap<sp;ap++){_d.fromBufferAttribute(np,ap);const lp=1/_d.manhattanLength();lp!==1/0?_d.multiplyScalar(lp):_d.set(1,0,0,0),np.setXYZW(ap,_d.x,_d.y,_d.z,_d.w)}}updateMatrixWorld(_d){super.updateMatrixWorld(_d),this.bindMode===AttachedBindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===DetachedBindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(_d,np){const ap=this.skeleton,sp=this.geometry;_skinIndex.fromBufferAttribute(sp.attributes.skinIndex,_d),_skinWeight.fromBufferAttribute(sp.attributes.skinWeight,_d),_basePosition.copy(np).applyMatrix4(this.bindMatrix),np.set(0,0,0);for(let lp=0;lp<4;lp++){const up=_skinWeight.getComponent(lp);if(up!==0){const cp=_skinIndex.getComponent(lp);_matrix4.multiplyMatrices(ap.bones[cp].matrixWorld,ap.boneInverses[cp]),np.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),up)}}return np.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture{constructor(_d=null,np=1,ap=1,sp,lp,up,cp,dp,hp=NearestFilter,fp=NearestFilter,pp,mp){super(null,up,cp,dp,hp,fp,sp,lp,pp,mp),this.isDataTexture=!0,this.image={data:_d,width:np,height:ap},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$1=new Matrix4;class Skeleton{constructor(_d=[],np=[]){this.uuid=generateUUID(),this.bones=_d.slice(0),this.boneInverses=np,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const _d=this.bones,np=this.boneInverses;if(this.boneMatrices=new Float32Array(_d.length*16),np.length===0)this.calculateInverses();else if(_d.length!==np.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let ap=0,sp=this.bones.length;ap<sp;ap++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let _d=0,np=this.bones.length;_d<np;_d++){const ap=new Matrix4;this.bones[_d]&&ap.copy(this.bones[_d].matrixWorld).invert(),this.boneInverses.push(ap)}}pose(){for(let _d=0,np=this.bones.length;_d<np;_d++){const ap=this.bones[_d];ap&&ap.matrixWorld.copy(this.boneInverses[_d]).invert()}for(let _d=0,np=this.bones.length;_d<np;_d++){const ap=this.bones[_d];ap&&(ap.parent&&ap.parent.isBone?(ap.matrix.copy(ap.parent.matrixWorld).invert(),ap.matrix.multiply(ap.matrixWorld)):ap.matrix.copy(ap.matrixWorld),ap.matrix.decompose(ap.position,ap.quaternion,ap.scale))}}update(){const _d=this.bones,np=this.boneInverses,ap=this.boneMatrices,sp=this.boneTexture;for(let lp=0,up=_d.length;lp<up;lp++){const cp=_d[lp]?_d[lp].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(cp,np[lp]),_offsetMatrix.toArray(ap,lp*16)}sp!==null&&(sp.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let _d=Math.sqrt(this.bones.length*4);_d=Math.ceil(_d/4)*4,_d=Math.max(_d,4);const np=new Float32Array(_d*_d*4);np.set(this.boneMatrices);const ap=new DataTexture(np,_d,_d,RGBAFormat,FloatType);return ap.needsUpdate=!0,this.boneMatrices=np,this.boneTexture=ap,this}getBoneByName(_d){for(let np=0,ap=this.bones.length;np<ap;np++){const sp=this.bones[np];if(sp.name===_d)return sp}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_d,np){this.uuid=_d.uuid;for(let ap=0,sp=_d.bones.length;ap<sp;ap++){const lp=_d.bones[ap];let up=np[lp];up===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",lp),up=new Bone),this.bones.push(up),this.boneInverses.push(new Matrix4().fromArray(_d.boneInverses[ap]))}return this.init(),this}toJSON(){const _d={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_d.uuid=this.uuid;const np=this.bones,ap=this.boneInverses;for(let sp=0,lp=np.length;sp<lp;sp++){const up=np[sp];_d.bones.push(up.uuid);const cp=ap[sp];_d.boneInverses.push(cp.toArray())}return _d}}class InstancedBufferAttribute extends BufferAttribute{constructor(_d,np,ap,sp=1){super(_d,np,ap),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=sp}copy(_d){return super.copy(_d),this.meshPerAttribute=_d.meshPerAttribute,this}toJSON(){const _d=super.toJSON();return _d.meshPerAttribute=this.meshPerAttribute,_d.isInstancedBufferAttribute=!0,_d}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_box3=new Box3,_identity=new Matrix4,_mesh$1=new Mesh,_sphere$3=new Sphere;class InstancedMesh extends Mesh{constructor(_d,np,ap){super(_d,np),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(ap*16),16),this.instanceColor=null,this.count=ap,this.boundingBox=null,this.boundingSphere=null;for(let sp=0;sp<ap;sp++)this.setMatrixAt(sp,_identity)}computeBoundingBox(){const _d=this.geometry,np=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),_d.boundingBox===null&&_d.computeBoundingBox(),this.boundingBox.makeEmpty();for(let ap=0;ap<np;ap++)this.getMatrixAt(ap,_instanceLocalMatrix),_box3.copy(_d.boundingBox).applyMatrix4(_instanceLocalMatrix),this.boundingBox.union(_box3)}computeBoundingSphere(){const _d=this.geometry,np=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere),_d.boundingSphere===null&&_d.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let ap=0;ap<np;ap++)this.getMatrixAt(ap,_instanceLocalMatrix),_sphere$3.copy(_d.boundingSphere).applyMatrix4(_instanceLocalMatrix),this.boundingSphere.union(_sphere$3)}copy(_d,np){return super.copy(_d,np),this.instanceMatrix.copy(_d.instanceMatrix),_d.instanceColor!==null&&(this.instanceColor=_d.instanceColor.clone()),this.count=_d.count,_d.boundingBox!==null&&(this.boundingBox=_d.boundingBox.clone()),_d.boundingSphere!==null&&(this.boundingSphere=_d.boundingSphere.clone()),this}getColorAt(_d,np){np.fromArray(this.instanceColor.array,_d*3)}getMatrixAt(_d,np){np.fromArray(this.instanceMatrix.array,_d*16)}raycast(_d,np){const ap=this.matrixWorld,sp=this.count;if(_mesh$1.geometry=this.geometry,_mesh$1.material=this.material,_mesh$1.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3.copy(this.boundingSphere),_sphere$3.applyMatrix4(ap),_d.ray.intersectsSphere(_sphere$3)!==!1))for(let lp=0;lp<sp;lp++){this.getMatrixAt(lp,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(ap,_instanceLocalMatrix),_mesh$1.matrixWorld=_instanceWorldMatrix,_mesh$1.raycast(_d,_instanceIntersects);for(let up=0,cp=_instanceIntersects.length;up<cp;up++){const dp=_instanceIntersects[up];dp.instanceId=lp,dp.object=this,np.push(dp)}_instanceIntersects.length=0}}setColorAt(_d,np){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3),3)),np.toArray(this.instanceColor.array,_d*3)}setMatrixAt(_d,np){np.toArray(this.instanceMatrix.array,_d*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function sortOpaque(rp,_d){return rp.z-_d.z}function sortTransparent(rp,_d){return _d.z-rp.z}class MultiDrawRenderList{constructor(){this.index=0,this.pool=[],this.list=[]}push(_d,np){const ap=this.pool,sp=this.list;this.index>=ap.length&&ap.push({start:-1,count:-1,z:-1});const lp=ap[this.index];sp.push(lp),this.index++,lp.start=_d.start,lp.count=_d.count,lp.z=np}reset(){this.list.length=0,this.index=0}}const ID_ATTR_NAME="batchId",_matrix=new Matrix4,_invMatrixWorld=new Matrix4,_identityMatrix$2=new Matrix4,_projScreenMatrix$2=new Matrix4,_frustum=new Frustum,_box$1=new Box3,_sphere$2=new Sphere,_vector$5=new Vector3,_renderList=new MultiDrawRenderList,_mesh=new Mesh,_batchIntersects=[];function copyAttributeData(rp,_d,np=0){const ap=_d.itemSize;if(rp.isInterleavedBufferAttribute||rp.array.constructor!==_d.array.constructor){const sp=rp.count;for(let lp=0;lp<sp;lp++)for(let up=0;up<ap;up++)_d.setComponent(lp+np,up,rp.getComponent(lp,up))}else _d.array.set(rp.array,np*ap);_d.needsUpdate=!0}class BatchedMesh extends Mesh{get maxGeometryCount(){return this._maxGeometryCount}constructor(_d,np,ap=np*2,sp){super(new BufferGeometry,sp),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=_d,this._maxVertexCount=np,this._maxIndexCount=ap,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(_d),this._multiDrawStarts=new Int32Array(_d),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let _d=Math.sqrt(this._maxGeometryCount*4);_d=Math.ceil(_d/4)*4,_d=Math.max(_d,4);const np=new Float32Array(_d*_d*4),ap=new DataTexture(np,_d,_d,RGBAFormat,FloatType);this._matricesTexture=ap}_initializeGeometry(_d){const np=this.geometry,ap=this._maxVertexCount,sp=this._maxGeometryCount,lp=this._maxIndexCount;if(this._geometryInitialized===!1){for(const cp in _d.attributes){const dp=_d.getAttribute(cp),{array:hp,itemSize:fp,normalized:pp}=dp,mp=new hp.constructor(ap*fp),gp=new dp.constructor(mp,fp,pp);gp.setUsage(dp.usage),np.setAttribute(cp,gp)}if(_d.getIndex()!==null){const cp=ap>65536?new Uint32Array(lp):new Uint16Array(lp);np.setIndex(new BufferAttribute(cp,1))}const up=sp>65536?new Uint32Array(ap):new Uint16Array(ap);np.setAttribute(ID_ATTR_NAME,new BufferAttribute(up,1)),this._geometryInitialized=!0}}_validateGeometry(_d){if(_d.getAttribute(ID_ATTR_NAME))throw new Error(`BatchedMesh: Geometry cannot use attribute "${ID_ATTR_NAME}"`);const np=this.geometry;if(!!_d.getIndex()!=!!np.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const ap in np.attributes){if(ap===ID_ATTR_NAME)continue;if(!_d.hasAttribute(ap))throw new Error(`BatchedMesh: Added geometry missing "${ap}". All geometries must have consistent attributes.`);const sp=_d.getAttribute(ap),lp=np.getAttribute(ap);if(sp.itemSize!==lp.itemSize||sp.normalized!==lp.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(_d){return this.customSort=_d,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _d=this._geometryCount,np=this.boundingBox,ap=this._active;np.makeEmpty();for(let sp=0;sp<_d;sp++)ap[sp]!==!1&&(this.getMatrixAt(sp,_matrix),this.getBoundingBoxAt(sp,_box$1).applyMatrix4(_matrix),np.union(_box$1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _d=this._geometryCount,np=this.boundingSphere,ap=this._active;np.makeEmpty();for(let sp=0;sp<_d;sp++)ap[sp]!==!1&&(this.getMatrixAt(sp,_matrix),this.getBoundingSphereAt(sp,_sphere$2).applyMatrix4(_matrix),np.union(_sphere$2))}addGeometry(_d,np=-1,ap=-1){if(this._initializeGeometry(_d),this._validateGeometry(_d),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const sp={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let lp=null;const up=this._reservedRanges,cp=this._drawRanges,dp=this._bounds;this._geometryCount!==0&&(lp=up[up.length-1]),np===-1?sp.vertexCount=_d.getAttribute("position").count:sp.vertexCount=np,lp===null?sp.vertexStart=0:sp.vertexStart=lp.vertexStart+lp.vertexCount;const hp=_d.getIndex(),fp=hp!==null;if(fp&&(ap===-1?sp.indexCount=hp.count:sp.indexCount=ap,lp===null?sp.indexStart=0:sp.indexStart=lp.indexStart+lp.indexCount),sp.indexStart!==-1&&sp.indexStart+sp.indexCount>this._maxIndexCount||sp.vertexStart+sp.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const pp=this._visibility,mp=this._active,gp=this._matricesTexture,yp=this._matricesTexture.image.data;pp.push(!0),mp.push(!0);const xp=this._geometryCount;this._geometryCount++,_identityMatrix$2.toArray(yp,xp*16),gp.needsUpdate=!0,up.push(sp),cp.push({start:fp?sp.indexStart:sp.vertexStart,count:-1}),dp.push({boxInitialized:!1,box:new Box3,sphereInitialized:!1,sphere:new Sphere});const _p=this.geometry.getAttribute(ID_ATTR_NAME);for(let vp=0;vp<sp.vertexCount;vp++)_p.setX(sp.vertexStart+vp,xp);return _p.needsUpdate=!0,this.setGeometryAt(xp,_d),xp}setGeometryAt(_d,np){if(_d>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(np);const ap=this.geometry,sp=ap.getIndex()!==null,lp=ap.getIndex(),up=np.getIndex(),cp=this._reservedRanges[_d];if(sp&&up.count>cp.indexCount||np.attributes.position.count>cp.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const dp=cp.vertexStart,hp=cp.vertexCount;for(const gp in ap.attributes){if(gp===ID_ATTR_NAME)continue;const yp=np.getAttribute(gp),xp=ap.getAttribute(gp);copyAttributeData(yp,xp,dp);const _p=yp.itemSize;for(let vp=yp.count,bp=hp;vp<bp;vp++){const Ep=dp+vp;for(let Sp=0;Sp<_p;Sp++)xp.setComponent(Ep,Sp,0)}xp.needsUpdate=!0}if(sp){const gp=cp.indexStart;for(let yp=0;yp<up.count;yp++)lp.setX(gp+yp,dp+up.getX(yp));for(let yp=up.count,xp=cp.indexCount;yp<xp;yp++)lp.setX(gp+yp,dp);lp.needsUpdate=!0}const fp=this._bounds[_d];np.boundingBox!==null?(fp.box.copy(np.boundingBox),fp.boxInitialized=!0):fp.boxInitialized=!1,np.boundingSphere!==null?(fp.sphere.copy(np.boundingSphere),fp.sphereInitialized=!0):fp.sphereInitialized=!1;const pp=this._drawRanges[_d],mp=np.getAttribute("position");return pp.count=sp?up.count:mp.count,this._visibilityChanged=!0,_d}deleteGeometry(_d){const np=this._active;return _d>=np.length||np[_d]===!1?this:(np[_d]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(_d,np){if(this._active[_d]===!1)return null;const sp=this._bounds[_d],lp=sp.box,up=this.geometry;if(sp.boxInitialized===!1){lp.makeEmpty();const cp=up.index,dp=up.attributes.position,hp=this._drawRanges[_d];for(let fp=hp.start,pp=hp.start+hp.count;fp<pp;fp++){let mp=fp;cp&&(mp=cp.getX(mp)),lp.expandByPoint(_vector$5.fromBufferAttribute(dp,mp))}sp.boxInitialized=!0}return np.copy(lp),np}getBoundingSphereAt(_d,np){if(this._active[_d]===!1)return null;const sp=this._bounds[_d],lp=sp.sphere,up=this.geometry;if(sp.sphereInitialized===!1){lp.makeEmpty(),this.getBoundingBoxAt(_d,_box$1),_box$1.getCenter(lp.center);const cp=up.index,dp=up.attributes.position,hp=this._drawRanges[_d];let fp=0;for(let pp=hp.start,mp=hp.start+hp.count;pp<mp;pp++){let gp=pp;cp&&(gp=cp.getX(gp)),_vector$5.fromBufferAttribute(dp,gp),fp=Math.max(fp,lp.center.distanceToSquared(_vector$5))}lp.radius=Math.sqrt(fp),sp.sphereInitialized=!0}return np.copy(lp),np}setMatrixAt(_d,np){const ap=this._active,sp=this._matricesTexture,lp=this._matricesTexture.image.data,up=this._geometryCount;return _d>=up||ap[_d]===!1?this:(np.toArray(lp,_d*16),sp.needsUpdate=!0,this)}getMatrixAt(_d,np){const ap=this._active,sp=this._matricesTexture.image.data,lp=this._geometryCount;return _d>=lp||ap[_d]===!1?null:np.fromArray(sp,_d*16)}setVisibleAt(_d,np){const ap=this._visibility,sp=this._active,lp=this._geometryCount;return _d>=lp||sp[_d]===!1||ap[_d]===np?this:(ap[_d]=np,this._visibilityChanged=!0,this)}getVisibleAt(_d){const np=this._visibility,ap=this._active,sp=this._geometryCount;return _d>=sp||ap[_d]===!1?!1:np[_d]}raycast(_d,np){const ap=this._visibility,sp=this._active,lp=this._drawRanges,up=this._geometryCount,cp=this.matrixWorld,dp=this.geometry;_mesh.material=this.material,_mesh.geometry.index=dp.index,_mesh.geometry.attributes=dp.attributes,_mesh.geometry.boundingBox===null&&(_mesh.geometry.boundingBox=new Box3),_mesh.geometry.boundingSphere===null&&(_mesh.geometry.boundingSphere=new Sphere);for(let hp=0;hp<up;hp++){if(!ap[hp]||!sp[hp])continue;const fp=lp[hp];_mesh.geometry.setDrawRange(fp.start,fp.count),this.getMatrixAt(hp,_mesh.matrixWorld).premultiply(cp),this.getBoundingBoxAt(hp,_mesh.geometry.boundingBox),this.getBoundingSphereAt(hp,_mesh.geometry.boundingSphere),_mesh.raycast(_d,_batchIntersects);for(let pp=0,mp=_batchIntersects.length;pp<mp;pp++){const gp=_batchIntersects[pp];gp.object=this,gp.batchId=hp,np.push(gp)}_batchIntersects.length=0}_mesh.material=null,_mesh.geometry.index=null,_mesh.geometry.attributes={},_mesh.geometry.setDrawRange(0,1/0)}copy(_d){return super.copy(_d),this.geometry=_d.geometry.clone(),this.perObjectFrustumCulled=_d.perObjectFrustumCulled,this.sortObjects=_d.sortObjects,this.boundingBox=_d.boundingBox!==null?_d.boundingBox.clone():null,this.boundingSphere=_d.boundingSphere!==null?_d.boundingSphere.clone():null,this._drawRanges=_d._drawRanges.map(np=>({...np})),this._reservedRanges=_d._reservedRanges.map(np=>({...np})),this._visibility=_d._visibility.slice(),this._active=_d._active.slice(),this._bounds=_d._bounds.map(np=>({boxInitialized:np.boxInitialized,box:np.box.clone(),sphereInitialized:np.sphereInitialized,sphere:np.sphere.clone()})),this._maxGeometryCount=_d._maxGeometryCount,this._maxVertexCount=_d._maxVertexCount,this._maxIndexCount=_d._maxIndexCount,this._geometryInitialized=_d._geometryInitialized,this._geometryCount=_d._geometryCount,this._multiDrawCounts=_d._multiDrawCounts.slice(),this._multiDrawStarts=_d._multiDrawStarts.slice(),this._matricesTexture=_d._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(_d,np,ap,sp,lp){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const up=sp.getIndex(),cp=up===null?1:up.array.BYTES_PER_ELEMENT,dp=this._active,hp=this._visibility,fp=this._multiDrawStarts,pp=this._multiDrawCounts,mp=this._drawRanges,gp=this.perObjectFrustumCulled;gp&&(_projScreenMatrix$2.multiplyMatrices(ap.projectionMatrix,ap.matrixWorldInverse).multiply(this.matrixWorld),_frustum.setFromProjectionMatrix(_projScreenMatrix$2,_d.coordinateSystem));let yp=0;if(this.sortObjects){_invMatrixWorld.copy(this.matrixWorld).invert(),_vector$5.setFromMatrixPosition(ap.matrixWorld).applyMatrix4(_invMatrixWorld);for(let vp=0,bp=hp.length;vp<bp;vp++)if(hp[vp]&&dp[vp]){this.getMatrixAt(vp,_matrix),this.getBoundingSphereAt(vp,_sphere$2).applyMatrix4(_matrix);let Ep=!1;if(gp&&(Ep=!_frustum.intersectsSphere(_sphere$2)),!Ep){const Sp=_vector$5.distanceTo(_sphere$2.center);_renderList.push(mp[vp],Sp)}}const xp=_renderList.list,_p=this.customSort;_p===null?xp.sort(lp.transparent?sortTransparent:sortOpaque):_p.call(this,xp,ap);for(let vp=0,bp=xp.length;vp<bp;vp++){const Ep=xp[vp];fp[yp]=Ep.start*cp,pp[yp]=Ep.count,yp++}_renderList.reset()}else for(let xp=0,_p=hp.length;xp<_p;xp++)if(hp[xp]&&dp[xp]){let vp=!1;if(gp&&(this.getMatrixAt(xp,_matrix),this.getBoundingSphereAt(xp,_sphere$2).applyMatrix4(_matrix),vp=!_frustum.intersectsSphere(_sphere$2)),!vp){const bp=mp[xp];fp[yp]=bp.start*cp,pp[yp]=bp.count,yp++}}this._multiDrawCount=yp,this._visibilityChanged=!1}onBeforeShadow(_d,np,ap,sp,lp,up){this.onBeforeRender(_d,null,sp,lp,up)}}class LineBasicMaterial extends Material{constructor(_d){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.color.copy(_d.color),this.map=_d.map,this.linewidth=_d.linewidth,this.linecap=_d.linecap,this.linejoin=_d.linejoin,this.fog=_d.fog,this}}const _start$1=new Vector3,_end$1=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$1=new Sphere;class Line extends Object3D{constructor(_d=new BufferGeometry,np=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=_d,this.material=np,this.updateMorphTargets()}copy(_d,np){return super.copy(_d,np),this.material=Array.isArray(_d.material)?_d.material.slice():_d.material,this.geometry=_d.geometry,this}computeLineDistances(){const _d=this.geometry;if(_d.index===null){const np=_d.attributes.position,ap=[0];for(let sp=1,lp=np.count;sp<lp;sp++)_start$1.fromBufferAttribute(np,sp-1),_end$1.fromBufferAttribute(np,sp),ap[sp]=ap[sp-1],ap[sp]+=_start$1.distanceTo(_end$1);_d.setAttribute("lineDistance",new Float32BufferAttribute(ap,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_d,np){const ap=this.geometry,sp=this.matrixWorld,lp=_d.params.Line.threshold,up=ap.drawRange;if(ap.boundingSphere===null&&ap.computeBoundingSphere(),_sphere$1.copy(ap.boundingSphere),_sphere$1.applyMatrix4(sp),_sphere$1.radius+=lp,_d.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(sp).invert(),_ray$1.copy(_d.ray).applyMatrix4(_inverseMatrix$1);const cp=lp/((this.scale.x+this.scale.y+this.scale.z)/3),dp=cp*cp,hp=new Vector3,fp=new Vector3,pp=new Vector3,mp=new Vector3,gp=this.isLineSegments?2:1,yp=ap.index,_p=ap.attributes.position;if(yp!==null){const vp=Math.max(0,up.start),bp=Math.min(yp.count,up.start+up.count);for(let Ep=vp,Sp=bp-1;Ep<Sp;Ep+=gp){const Ap=yp.getX(Ep),Rp=yp.getX(Ep+1);if(hp.fromBufferAttribute(_p,Ap),fp.fromBufferAttribute(_p,Rp),_ray$1.distanceSqToSegment(hp,fp,mp,pp)>dp)continue;mp.applyMatrix4(this.matrixWorld);const Mp=_d.ray.origin.distanceTo(mp);Mp<_d.near||Mp>_d.far||np.push({distance:Mp,point:pp.clone().applyMatrix4(this.matrixWorld),index:Ep,face:null,faceIndex:null,object:this})}}else{const vp=Math.max(0,up.start),bp=Math.min(_p.count,up.start+up.count);for(let Ep=vp,Sp=bp-1;Ep<Sp;Ep+=gp){if(hp.fromBufferAttribute(_p,Ep),fp.fromBufferAttribute(_p,Ep+1),_ray$1.distanceSqToSegment(hp,fp,mp,pp)>dp)continue;mp.applyMatrix4(this.matrixWorld);const Rp=_d.ray.origin.distanceTo(mp);Rp<_d.near||Rp>_d.far||np.push({distance:Rp,point:pp.clone().applyMatrix4(this.matrixWorld),index:Ep,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const np=this.geometry.morphAttributes,ap=Object.keys(np);if(ap.length>0){const sp=np[ap[0]];if(sp!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let lp=0,up=sp.length;lp<up;lp++){const cp=sp[lp].name||String(lp);this.morphTargetInfluences.push(0),this.morphTargetDictionary[cp]=lp}}}}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line{constructor(_d,np){super(_d,np),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _d=this.geometry;if(_d.index===null){const np=_d.attributes.position,ap=[];for(let sp=0,lp=np.count;sp<lp;sp+=2)_start.fromBufferAttribute(np,sp),_end.fromBufferAttribute(np,sp+1),ap[sp]=sp===0?0:ap[sp-1],ap[sp+1]=ap[sp]+_start.distanceTo(_end);_d.setAttribute("lineDistance",new Float32BufferAttribute(ap,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(_d,np){super(_d,np),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{constructor(_d){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.color.copy(_d.color),this.map=_d.map,this.alphaMap=_d.alphaMap,this.size=_d.size,this.sizeAttenuation=_d.sizeAttenuation,this.fog=_d.fog,this}}const _inverseMatrix=new Matrix4,_ray$4=new Ray,_sphere=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(_d=new BufferGeometry,np=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=_d,this.material=np,this.updateMorphTargets()}copy(_d,np){return super.copy(_d,np),this.material=Array.isArray(_d.material)?_d.material.slice():_d.material,this.geometry=_d.geometry,this}raycast(_d,np){const ap=this.geometry,sp=this.matrixWorld,lp=_d.params.Points.threshold,up=ap.drawRange;if(ap.boundingSphere===null&&ap.computeBoundingSphere(),_sphere.copy(ap.boundingSphere),_sphere.applyMatrix4(sp),_sphere.radius+=lp,_d.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(sp).invert(),_ray$4.copy(_d.ray).applyMatrix4(_inverseMatrix);const cp=lp/((this.scale.x+this.scale.y+this.scale.z)/3),dp=cp*cp,hp=ap.index,pp=ap.attributes.position;if(hp!==null){const mp=Math.max(0,up.start),gp=Math.min(hp.count,up.start+up.count);for(let yp=mp,xp=gp;yp<xp;yp++){const _p=hp.getX(yp);_position$2.fromBufferAttribute(pp,_p),testPoint(_position$2,_p,dp,sp,_d,np,this)}}else{const mp=Math.max(0,up.start),gp=Math.min(pp.count,up.start+up.count);for(let yp=mp,xp=gp;yp<xp;yp++)_position$2.fromBufferAttribute(pp,yp),testPoint(_position$2,yp,dp,sp,_d,np,this)}}updateMorphTargets(){const np=this.geometry.morphAttributes,ap=Object.keys(np);if(ap.length>0){const sp=np[ap[0]];if(sp!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let lp=0,up=sp.length;lp<up;lp++){const cp=sp[lp].name||String(lp);this.morphTargetInfluences.push(0),this.morphTargetDictionary[cp]=lp}}}}}function testPoint(rp,_d,np,ap,sp,lp,up){const cp=_ray$4.distanceSqToPoint(rp);if(cp<np){const dp=new Vector3;_ray$4.closestPointToPoint(rp,dp),dp.applyMatrix4(ap);const hp=sp.ray.origin.distanceTo(dp);if(hp<sp.near||hp>sp.far)return;lp.push({distance:hp,distanceToRay:Math.sqrt(cp),point:dp,index:_d,face:null,object:up})}}class VideoTexture extends Texture{constructor(_d,np,ap,sp,lp,up,cp,dp,hp){super(_d,np,ap,sp,lp,up,cp,dp,hp),this.isVideoTexture=!0,this.minFilter=up!==void 0?up:LinearFilter,this.magFilter=lp!==void 0?lp:LinearFilter,this.generateMipmaps=!1;const fp=this;function pp(){fp.needsUpdate=!0,_d.requestVideoFrameCallback(pp)}"requestVideoFrameCallback"in _d&&_d.requestVideoFrameCallback(pp)}clone(){return new this.constructor(this.image).copy(this)}update(){const _d=this.image;"requestVideoFrameCallback"in _d===!1&&_d.readyState>=_d.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class FramebufferTexture extends Texture{constructor(_d,np){super({width:_d,height:np}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class CompressedTexture extends Texture{constructor(_d,np,ap,sp,lp,up,cp,dp,hp,fp,pp,mp){super(null,up,cp,dp,hp,fp,sp,lp,pp,mp),this.isCompressedTexture=!0,this.image={width:np,height:ap},this.mipmaps=_d,this.flipY=!1,this.generateMipmaps=!1}}class CompressedArrayTexture extends CompressedTexture{constructor(_d,np,ap,sp,lp,up){super(_d,np,ap,lp,up),this.isCompressedArrayTexture=!0,this.image.depth=sp,this.wrapR=ClampToEdgeWrapping}}class CompressedCubeTexture extends CompressedTexture{constructor(_d,np,ap){super(void 0,_d[0].width,_d[0].height,np,ap,CubeReflectionMapping),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=_d}}class CanvasTexture extends Texture{constructor(_d,np,ap,sp,lp,up,cp,dp,hp){super(_d,np,ap,sp,lp,up,cp,dp,hp),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(_d,np){const ap=this.getUtoTmapping(_d);return this.getPoint(ap,np)}getPoints(_d=5){const np=[];for(let ap=0;ap<=_d;ap++)np.push(this.getPoint(ap/_d));return np}getSpacedPoints(_d=5){const np=[];for(let ap=0;ap<=_d;ap++)np.push(this.getPointAt(ap/_d));return np}getLength(){const _d=this.getLengths();return _d[_d.length-1]}getLengths(_d=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===_d+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const np=[];let ap,sp=this.getPoint(0),lp=0;np.push(0);for(let up=1;up<=_d;up++)ap=this.getPoint(up/_d),lp+=ap.distanceTo(sp),np.push(lp),sp=ap;return this.cacheArcLengths=np,np}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(_d,np){const ap=this.getLengths();let sp=0;const lp=ap.length;let up;np?up=np:up=_d*ap[lp-1];let cp=0,dp=lp-1,hp;for(;cp<=dp;)if(sp=Math.floor(cp+(dp-cp)/2),hp=ap[sp]-up,hp<0)cp=sp+1;else if(hp>0)dp=sp-1;else{dp=sp;break}if(sp=dp,ap[sp]===up)return sp/(lp-1);const fp=ap[sp],mp=ap[sp+1]-fp,gp=(up-fp)/mp;return(sp+gp)/(lp-1)}getTangent(_d,np){let sp=_d-1e-4,lp=_d+1e-4;sp<0&&(sp=0),lp>1&&(lp=1);const up=this.getPoint(sp),cp=this.getPoint(lp),dp=np||(up.isVector2?new Vector2:new Vector3);return dp.copy(cp).sub(up).normalize(),dp}getTangentAt(_d,np){const ap=this.getUtoTmapping(_d);return this.getTangent(ap,np)}computeFrenetFrames(_d,np){const ap=new Vector3,sp=[],lp=[],up=[],cp=new Vector3,dp=new Matrix4;for(let gp=0;gp<=_d;gp++){const yp=gp/_d;sp[gp]=this.getTangentAt(yp,new Vector3)}lp[0]=new Vector3,up[0]=new Vector3;let hp=Number.MAX_VALUE;const fp=Math.abs(sp[0].x),pp=Math.abs(sp[0].y),mp=Math.abs(sp[0].z);fp<=hp&&(hp=fp,ap.set(1,0,0)),pp<=hp&&(hp=pp,ap.set(0,1,0)),mp<=hp&&ap.set(0,0,1),cp.crossVectors(sp[0],ap).normalize(),lp[0].crossVectors(sp[0],cp),up[0].crossVectors(sp[0],lp[0]);for(let gp=1;gp<=_d;gp++){if(lp[gp]=lp[gp-1].clone(),up[gp]=up[gp-1].clone(),cp.crossVectors(sp[gp-1],sp[gp]),cp.length()>Number.EPSILON){cp.normalize();const yp=Math.acos(clamp(sp[gp-1].dot(sp[gp]),-1,1));lp[gp].applyMatrix4(dp.makeRotationAxis(cp,yp))}up[gp].crossVectors(sp[gp],lp[gp])}if(np===!0){let gp=Math.acos(clamp(lp[0].dot(lp[_d]),-1,1));gp/=_d,sp[0].dot(cp.crossVectors(lp[0],lp[_d]))>0&&(gp=-gp);for(let yp=1;yp<=_d;yp++)lp[yp].applyMatrix4(dp.makeRotationAxis(sp[yp],gp*yp)),up[yp].crossVectors(sp[yp],lp[yp])}return{tangents:sp,normals:lp,binormals:up}}clone(){return new this.constructor().copy(this)}copy(_d){return this.arcLengthDivisions=_d.arcLengthDivisions,this}toJSON(){const _d={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return _d.arcLengthDivisions=this.arcLengthDivisions,_d.type=this.type,_d}fromJSON(_d){return this.arcLengthDivisions=_d.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(_d=0,np=0,ap=1,sp=1,lp=0,up=Math.PI*2,cp=!1,dp=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=_d,this.aY=np,this.xRadius=ap,this.yRadius=sp,this.aStartAngle=lp,this.aEndAngle=up,this.aClockwise=cp,this.aRotation=dp}getPoint(_d,np){const ap=np||new Vector2,sp=Math.PI*2;let lp=this.aEndAngle-this.aStartAngle;const up=Math.abs(lp)<Number.EPSILON;for(;lp<0;)lp+=sp;for(;lp>sp;)lp-=sp;lp<Number.EPSILON&&(up?lp=0:lp=sp),this.aClockwise===!0&&!up&&(lp===sp?lp=-sp:lp=lp-sp);const cp=this.aStartAngle+_d*lp;let dp=this.aX+this.xRadius*Math.cos(cp),hp=this.aY+this.yRadius*Math.sin(cp);if(this.aRotation!==0){const fp=Math.cos(this.aRotation),pp=Math.sin(this.aRotation),mp=dp-this.aX,gp=hp-this.aY;dp=mp*fp-gp*pp+this.aX,hp=mp*pp+gp*fp+this.aY}return ap.set(dp,hp)}copy(_d){return super.copy(_d),this.aX=_d.aX,this.aY=_d.aY,this.xRadius=_d.xRadius,this.yRadius=_d.yRadius,this.aStartAngle=_d.aStartAngle,this.aEndAngle=_d.aEndAngle,this.aClockwise=_d.aClockwise,this.aRotation=_d.aRotation,this}toJSON(){const _d=super.toJSON();return _d.aX=this.aX,_d.aY=this.aY,_d.xRadius=this.xRadius,_d.yRadius=this.yRadius,_d.aStartAngle=this.aStartAngle,_d.aEndAngle=this.aEndAngle,_d.aClockwise=this.aClockwise,_d.aRotation=this.aRotation,_d}fromJSON(_d){return super.fromJSON(_d),this.aX=_d.aX,this.aY=_d.aY,this.xRadius=_d.xRadius,this.yRadius=_d.yRadius,this.aStartAngle=_d.aStartAngle,this.aEndAngle=_d.aEndAngle,this.aClockwise=_d.aClockwise,this.aRotation=_d.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(_d,np,ap,sp,lp,up){super(_d,np,ap,ap,sp,lp,up),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let rp=0,_d=0,np=0,ap=0;function sp(lp,up,cp,dp){rp=lp,_d=cp,np=-3*lp+3*up-2*cp-dp,ap=2*lp-2*up+cp+dp}return{initCatmullRom:function(lp,up,cp,dp,hp){sp(up,cp,hp*(cp-lp),hp*(dp-up))},initNonuniformCatmullRom:function(lp,up,cp,dp,hp,fp,pp){let mp=(up-lp)/hp-(cp-lp)/(hp+fp)+(cp-up)/fp,gp=(cp-up)/fp-(dp-up)/(fp+pp)+(dp-cp)/pp;mp*=fp,gp*=fp,sp(up,cp,mp,gp)},calc:function(lp){const up=lp*lp,cp=up*lp;return rp+_d*lp+np*up+ap*cp}}}const tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(_d=[],np=!1,ap="centripetal",sp=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=_d,this.closed=np,this.curveType=ap,this.tension=sp}getPoint(_d,np=new Vector3){const ap=np,sp=this.points,lp=sp.length,up=(lp-(this.closed?0:1))*_d;let cp=Math.floor(up),dp=up-cp;this.closed?cp+=cp>0?0:(Math.floor(Math.abs(cp)/lp)+1)*lp:dp===0&&cp===lp-1&&(cp=lp-2,dp=1);let hp,fp;this.closed||cp>0?hp=sp[(cp-1)%lp]:(tmp.subVectors(sp[0],sp[1]).add(sp[0]),hp=tmp);const pp=sp[cp%lp],mp=sp[(cp+1)%lp];if(this.closed||cp+2<lp?fp=sp[(cp+2)%lp]:(tmp.subVectors(sp[lp-1],sp[lp-2]).add(sp[lp-1]),fp=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const gp=this.curveType==="chordal"?.5:.25;let yp=Math.pow(hp.distanceToSquared(pp),gp),xp=Math.pow(pp.distanceToSquared(mp),gp),_p=Math.pow(mp.distanceToSquared(fp),gp);xp<1e-4&&(xp=1),yp<1e-4&&(yp=xp),_p<1e-4&&(_p=xp),px.initNonuniformCatmullRom(hp.x,pp.x,mp.x,fp.x,yp,xp,_p),py.initNonuniformCatmullRom(hp.y,pp.y,mp.y,fp.y,yp,xp,_p),pz.initNonuniformCatmullRom(hp.z,pp.z,mp.z,fp.z,yp,xp,_p)}else this.curveType==="catmullrom"&&(px.initCatmullRom(hp.x,pp.x,mp.x,fp.x,this.tension),py.initCatmullRom(hp.y,pp.y,mp.y,fp.y,this.tension),pz.initCatmullRom(hp.z,pp.z,mp.z,fp.z,this.tension));return ap.set(px.calc(dp),py.calc(dp),pz.calc(dp)),ap}copy(_d){super.copy(_d),this.points=[];for(let np=0,ap=_d.points.length;np<ap;np++){const sp=_d.points[np];this.points.push(sp.clone())}return this.closed=_d.closed,this.curveType=_d.curveType,this.tension=_d.tension,this}toJSON(){const _d=super.toJSON();_d.points=[];for(let np=0,ap=this.points.length;np<ap;np++){const sp=this.points[np];_d.points.push(sp.toArray())}return _d.closed=this.closed,_d.curveType=this.curveType,_d.tension=this.tension,_d}fromJSON(_d){super.fromJSON(_d),this.points=[];for(let np=0,ap=_d.points.length;np<ap;np++){const sp=_d.points[np];this.points.push(new Vector3().fromArray(sp))}return this.closed=_d.closed,this.curveType=_d.curveType,this.tension=_d.tension,this}}function CatmullRom(rp,_d,np,ap,sp){const lp=(ap-_d)*.5,up=(sp-np)*.5,cp=rp*rp,dp=rp*cp;return(2*np-2*ap+lp+up)*dp+(-3*np+3*ap-2*lp-up)*cp+lp*rp+np}function QuadraticBezierP0(rp,_d){const np=1-rp;return np*np*_d}function QuadraticBezierP1(rp,_d){return 2*(1-rp)*rp*_d}function QuadraticBezierP2(rp,_d){return rp*rp*_d}function QuadraticBezier(rp,_d,np,ap){return QuadraticBezierP0(rp,_d)+QuadraticBezierP1(rp,np)+QuadraticBezierP2(rp,ap)}function CubicBezierP0(rp,_d){const np=1-rp;return np*np*np*_d}function CubicBezierP1(rp,_d){const np=1-rp;return 3*np*np*rp*_d}function CubicBezierP2(rp,_d){return 3*(1-rp)*rp*rp*_d}function CubicBezierP3(rp,_d){return rp*rp*rp*_d}function CubicBezier(rp,_d,np,ap,sp){return CubicBezierP0(rp,_d)+CubicBezierP1(rp,np)+CubicBezierP2(rp,ap)+CubicBezierP3(rp,sp)}class CubicBezierCurve extends Curve{constructor(_d=new Vector2,np=new Vector2,ap=new Vector2,sp=new Vector2){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=_d,this.v1=np,this.v2=ap,this.v3=sp}getPoint(_d,np=new Vector2){const ap=np,sp=this.v0,lp=this.v1,up=this.v2,cp=this.v3;return ap.set(CubicBezier(_d,sp.x,lp.x,up.x,cp.x),CubicBezier(_d,sp.y,lp.y,up.y,cp.y)),ap}copy(_d){return super.copy(_d),this.v0.copy(_d.v0),this.v1.copy(_d.v1),this.v2.copy(_d.v2),this.v3.copy(_d.v3),this}toJSON(){const _d=super.toJSON();return _d.v0=this.v0.toArray(),_d.v1=this.v1.toArray(),_d.v2=this.v2.toArray(),_d.v3=this.v3.toArray(),_d}fromJSON(_d){return super.fromJSON(_d),this.v0.fromArray(_d.v0),this.v1.fromArray(_d.v1),this.v2.fromArray(_d.v2),this.v3.fromArray(_d.v3),this}}class CubicBezierCurve3 extends Curve{constructor(_d=new Vector3,np=new Vector3,ap=new Vector3,sp=new Vector3){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=_d,this.v1=np,this.v2=ap,this.v3=sp}getPoint(_d,np=new Vector3){const ap=np,sp=this.v0,lp=this.v1,up=this.v2,cp=this.v3;return ap.set(CubicBezier(_d,sp.x,lp.x,up.x,cp.x),CubicBezier(_d,sp.y,lp.y,up.y,cp.y),CubicBezier(_d,sp.z,lp.z,up.z,cp.z)),ap}copy(_d){return super.copy(_d),this.v0.copy(_d.v0),this.v1.copy(_d.v1),this.v2.copy(_d.v2),this.v3.copy(_d.v3),this}toJSON(){const _d=super.toJSON();return _d.v0=this.v0.toArray(),_d.v1=this.v1.toArray(),_d.v2=this.v2.toArray(),_d.v3=this.v3.toArray(),_d}fromJSON(_d){return super.fromJSON(_d),this.v0.fromArray(_d.v0),this.v1.fromArray(_d.v1),this.v2.fromArray(_d.v2),this.v3.fromArray(_d.v3),this}}class LineCurve extends Curve{constructor(_d=new Vector2,np=new Vector2){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=_d,this.v2=np}getPoint(_d,np=new Vector2){const ap=np;return _d===1?ap.copy(this.v2):(ap.copy(this.v2).sub(this.v1),ap.multiplyScalar(_d).add(this.v1)),ap}getPointAt(_d,np){return this.getPoint(_d,np)}getTangent(_d,np=new Vector2){return np.subVectors(this.v2,this.v1).normalize()}getTangentAt(_d,np){return this.getTangent(_d,np)}copy(_d){return super.copy(_d),this.v1.copy(_d.v1),this.v2.copy(_d.v2),this}toJSON(){const _d=super.toJSON();return _d.v1=this.v1.toArray(),_d.v2=this.v2.toArray(),_d}fromJSON(_d){return super.fromJSON(_d),this.v1.fromArray(_d.v1),this.v2.fromArray(_d.v2),this}}class LineCurve3 extends Curve{constructor(_d=new Vector3,np=new Vector3){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=_d,this.v2=np}getPoint(_d,np=new Vector3){const ap=np;return _d===1?ap.copy(this.v2):(ap.copy(this.v2).sub(this.v1),ap.multiplyScalar(_d).add(this.v1)),ap}getPointAt(_d,np){return this.getPoint(_d,np)}getTangent(_d,np=new Vector3){return np.subVectors(this.v2,this.v1).normalize()}getTangentAt(_d,np){return this.getTangent(_d,np)}copy(_d){return super.copy(_d),this.v1.copy(_d.v1),this.v2.copy(_d.v2),this}toJSON(){const _d=super.toJSON();return _d.v1=this.v1.toArray(),_d.v2=this.v2.toArray(),_d}fromJSON(_d){return super.fromJSON(_d),this.v1.fromArray(_d.v1),this.v2.fromArray(_d.v2),this}}class QuadraticBezierCurve extends Curve{constructor(_d=new Vector2,np=new Vector2,ap=new Vector2){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=_d,this.v1=np,this.v2=ap}getPoint(_d,np=new Vector2){const ap=np,sp=this.v0,lp=this.v1,up=this.v2;return ap.set(QuadraticBezier(_d,sp.x,lp.x,up.x),QuadraticBezier(_d,sp.y,lp.y,up.y)),ap}copy(_d){return super.copy(_d),this.v0.copy(_d.v0),this.v1.copy(_d.v1),this.v2.copy(_d.v2),this}toJSON(){const _d=super.toJSON();return _d.v0=this.v0.toArray(),_d.v1=this.v1.toArray(),_d.v2=this.v2.toArray(),_d}fromJSON(_d){return super.fromJSON(_d),this.v0.fromArray(_d.v0),this.v1.fromArray(_d.v1),this.v2.fromArray(_d.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(_d=new Vector3,np=new Vector3,ap=new Vector3){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=_d,this.v1=np,this.v2=ap}getPoint(_d,np=new Vector3){const ap=np,sp=this.v0,lp=this.v1,up=this.v2;return ap.set(QuadraticBezier(_d,sp.x,lp.x,up.x),QuadraticBezier(_d,sp.y,lp.y,up.y),QuadraticBezier(_d,sp.z,lp.z,up.z)),ap}copy(_d){return super.copy(_d),this.v0.copy(_d.v0),this.v1.copy(_d.v1),this.v2.copy(_d.v2),this}toJSON(){const _d=super.toJSON();return _d.v0=this.v0.toArray(),_d.v1=this.v1.toArray(),_d.v2=this.v2.toArray(),_d}fromJSON(_d){return super.fromJSON(_d),this.v0.fromArray(_d.v0),this.v1.fromArray(_d.v1),this.v2.fromArray(_d.v2),this}}class SplineCurve extends Curve{constructor(_d=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=_d}getPoint(_d,np=new Vector2){const ap=np,sp=this.points,lp=(sp.length-1)*_d,up=Math.floor(lp),cp=lp-up,dp=sp[up===0?up:up-1],hp=sp[up],fp=sp[up>sp.length-2?sp.length-1:up+1],pp=sp[up>sp.length-3?sp.length-1:up+2];return ap.set(CatmullRom(cp,dp.x,hp.x,fp.x,pp.x),CatmullRom(cp,dp.y,hp.y,fp.y,pp.y)),ap}copy(_d){super.copy(_d),this.points=[];for(let np=0,ap=_d.points.length;np<ap;np++){const sp=_d.points[np];this.points.push(sp.clone())}return this}toJSON(){const _d=super.toJSON();_d.points=[];for(let np=0,ap=this.points.length;np<ap;np++){const sp=this.points[np];_d.points.push(sp.toArray())}return _d}fromJSON(_d){super.fromJSON(_d),this.points=[];for(let np=0,ap=_d.points.length;np<ap;np++){const sp=_d.points[np];this.points.push(new Vector2().fromArray(sp))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(_d){this.curves.push(_d)}closePath(){const _d=this.curves[0].getPoint(0),np=this.curves[this.curves.length-1].getPoint(1);if(!_d.equals(np)){const ap=_d.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Curves[ap](np,_d))}return this}getPoint(_d,np){const ap=_d*this.getLength(),sp=this.getCurveLengths();let lp=0;for(;lp<sp.length;){if(sp[lp]>=ap){const up=sp[lp]-ap,cp=this.curves[lp],dp=cp.getLength(),hp=dp===0?0:1-up/dp;return cp.getPointAt(hp,np)}lp++}return null}getLength(){const _d=this.getCurveLengths();return _d[_d.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const _d=[];let np=0;for(let ap=0,sp=this.curves.length;ap<sp;ap++)np+=this.curves[ap].getLength(),_d.push(np);return this.cacheLengths=_d,_d}getSpacedPoints(_d=40){const np=[];for(let ap=0;ap<=_d;ap++)np.push(this.getPoint(ap/_d));return this.autoClose&&np.push(np[0]),np}getPoints(_d=12){const np=[];let ap;for(let sp=0,lp=this.curves;sp<lp.length;sp++){const up=lp[sp],cp=up.isEllipseCurve?_d*2:up.isLineCurve||up.isLineCurve3?1:up.isSplineCurve?_d*up.points.length:_d,dp=up.getPoints(cp);for(let hp=0;hp<dp.length;hp++){const fp=dp[hp];ap&&ap.equals(fp)||(np.push(fp),ap=fp)}}return this.autoClose&&np.length>1&&!np[np.length-1].equals(np[0])&&np.push(np[0]),np}copy(_d){super.copy(_d),this.curves=[];for(let np=0,ap=_d.curves.length;np<ap;np++){const sp=_d.curves[np];this.curves.push(sp.clone())}return this.autoClose=_d.autoClose,this}toJSON(){const _d=super.toJSON();_d.autoClose=this.autoClose,_d.curves=[];for(let np=0,ap=this.curves.length;np<ap;np++){const sp=this.curves[np];_d.curves.push(sp.toJSON())}return _d}fromJSON(_d){super.fromJSON(_d),this.autoClose=_d.autoClose,this.curves=[];for(let np=0,ap=_d.curves.length;np<ap;np++){const sp=_d.curves[np];this.curves.push(new Curves[sp.type]().fromJSON(sp))}return this}}class Path extends CurvePath{constructor(_d){super(),this.type="Path",this.currentPoint=new Vector2,_d&&this.setFromPoints(_d)}setFromPoints(_d){this.moveTo(_d[0].x,_d[0].y);for(let np=1,ap=_d.length;np<ap;np++)this.lineTo(_d[np].x,_d[np].y);return this}moveTo(_d,np){return this.currentPoint.set(_d,np),this}lineTo(_d,np){const ap=new LineCurve(this.currentPoint.clone(),new Vector2(_d,np));return this.curves.push(ap),this.currentPoint.set(_d,np),this}quadraticCurveTo(_d,np,ap,sp){const lp=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(_d,np),new Vector2(ap,sp));return this.curves.push(lp),this.currentPoint.set(ap,sp),this}bezierCurveTo(_d,np,ap,sp,lp,up){const cp=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(_d,np),new Vector2(ap,sp),new Vector2(lp,up));return this.curves.push(cp),this.currentPoint.set(lp,up),this}splineThru(_d){const np=[this.currentPoint.clone()].concat(_d),ap=new SplineCurve(np);return this.curves.push(ap),this.currentPoint.copy(_d[_d.length-1]),this}arc(_d,np,ap,sp,lp,up){const cp=this.currentPoint.x,dp=this.currentPoint.y;return this.absarc(_d+cp,np+dp,ap,sp,lp,up),this}absarc(_d,np,ap,sp,lp,up){return this.absellipse(_d,np,ap,ap,sp,lp,up),this}ellipse(_d,np,ap,sp,lp,up,cp,dp){const hp=this.currentPoint.x,fp=this.currentPoint.y;return this.absellipse(_d+hp,np+fp,ap,sp,lp,up,cp,dp),this}absellipse(_d,np,ap,sp,lp,up,cp,dp){const hp=new EllipseCurve(_d,np,ap,sp,lp,up,cp,dp);if(this.curves.length>0){const pp=hp.getPoint(0);pp.equals(this.currentPoint)||this.lineTo(pp.x,pp.y)}this.curves.push(hp);const fp=hp.getPoint(1);return this.currentPoint.copy(fp),this}copy(_d){return super.copy(_d),this.currentPoint.copy(_d.currentPoint),this}toJSON(){const _d=super.toJSON();return _d.currentPoint=this.currentPoint.toArray(),_d}fromJSON(_d){return super.fromJSON(_d),this.currentPoint.fromArray(_d.currentPoint),this}}class LatheGeometry extends BufferGeometry{constructor(_d=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],np=12,ap=0,sp=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:_d,segments:np,phiStart:ap,phiLength:sp},np=Math.floor(np),sp=clamp(sp,0,Math.PI*2);const lp=[],up=[],cp=[],dp=[],hp=[],fp=1/np,pp=new Vector3,mp=new Vector2,gp=new Vector3,yp=new Vector3,xp=new Vector3;let _p=0,vp=0;for(let bp=0;bp<=_d.length-1;bp++)switch(bp){case 0:_p=_d[bp+1].x-_d[bp].x,vp=_d[bp+1].y-_d[bp].y,gp.x=vp*1,gp.y=-_p,gp.z=vp*0,xp.copy(gp),gp.normalize(),dp.push(gp.x,gp.y,gp.z);break;case _d.length-1:dp.push(xp.x,xp.y,xp.z);break;default:_p=_d[bp+1].x-_d[bp].x,vp=_d[bp+1].y-_d[bp].y,gp.x=vp*1,gp.y=-_p,gp.z=vp*0,yp.copy(gp),gp.x+=xp.x,gp.y+=xp.y,gp.z+=xp.z,gp.normalize(),dp.push(gp.x,gp.y,gp.z),xp.copy(yp)}for(let bp=0;bp<=np;bp++){const Ep=ap+bp*fp*sp,Sp=Math.sin(Ep),Ap=Math.cos(Ep);for(let Rp=0;Rp<=_d.length-1;Rp++){pp.x=_d[Rp].x*Sp,pp.y=_d[Rp].y,pp.z=_d[Rp].x*Ap,up.push(pp.x,pp.y,pp.z),mp.x=bp/np,mp.y=Rp/(_d.length-1),cp.push(mp.x,mp.y);const Tp=dp[3*Rp+0]*Sp,Mp=dp[3*Rp+1],Op=dp[3*Rp+0]*Ap;hp.push(Tp,Mp,Op)}}for(let bp=0;bp<np;bp++)for(let Ep=0;Ep<_d.length-1;Ep++){const Sp=Ep+bp*_d.length,Ap=Sp,Rp=Sp+_d.length,Tp=Sp+_d.length+1,Mp=Sp+1;lp.push(Ap,Rp,Mp),lp.push(Tp,Mp,Rp)}this.setIndex(lp),this.setAttribute("position",new Float32BufferAttribute(up,3)),this.setAttribute("uv",new Float32BufferAttribute(cp,2)),this.setAttribute("normal",new Float32BufferAttribute(hp,3))}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new LatheGeometry(_d.points,_d.segments,_d.phiStart,_d.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(_d=1,np=1,ap=4,sp=8){const lp=new Path;lp.absarc(0,-np/2,_d,Math.PI*1.5,0),lp.absarc(0,np/2,_d,0,Math.PI*.5),super(lp.getPoints(ap),sp),this.type="CapsuleGeometry",this.parameters={radius:_d,length:np,capSegments:ap,radialSegments:sp}}static fromJSON(_d){return new CapsuleGeometry(_d.radius,_d.length,_d.capSegments,_d.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(_d=1,np=32,ap=0,sp=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:_d,segments:np,thetaStart:ap,thetaLength:sp},np=Math.max(3,np);const lp=[],up=[],cp=[],dp=[],hp=new Vector3,fp=new Vector2;up.push(0,0,0),cp.push(0,0,1),dp.push(.5,.5);for(let pp=0,mp=3;pp<=np;pp++,mp+=3){const gp=ap+pp/np*sp;hp.x=_d*Math.cos(gp),hp.y=_d*Math.sin(gp),up.push(hp.x,hp.y,hp.z),cp.push(0,0,1),fp.x=(up[mp]/_d+1)/2,fp.y=(up[mp+1]/_d+1)/2,dp.push(fp.x,fp.y)}for(let pp=1;pp<=np;pp++)lp.push(pp,pp+1,0);this.setIndex(lp),this.setAttribute("position",new Float32BufferAttribute(up,3)),this.setAttribute("normal",new Float32BufferAttribute(cp,3)),this.setAttribute("uv",new Float32BufferAttribute(dp,2))}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new CircleGeometry(_d.radius,_d.segments,_d.thetaStart,_d.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(_d=1,np=1,ap=1,sp=32,lp=1,up=!1,cp=0,dp=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:_d,radiusBottom:np,height:ap,radialSegments:sp,heightSegments:lp,openEnded:up,thetaStart:cp,thetaLength:dp};const hp=this;sp=Math.floor(sp),lp=Math.floor(lp);const fp=[],pp=[],mp=[],gp=[];let yp=0;const xp=[],_p=ap/2;let vp=0;bp(),up===!1&&(_d>0&&Ep(!0),np>0&&Ep(!1)),this.setIndex(fp),this.setAttribute("position",new Float32BufferAttribute(pp,3)),this.setAttribute("normal",new Float32BufferAttribute(mp,3)),this.setAttribute("uv",new Float32BufferAttribute(gp,2));function bp(){const Sp=new Vector3,Ap=new Vector3;let Rp=0;const Tp=(np-_d)/ap;for(let Mp=0;Mp<=lp;Mp++){const Op=[],Pp=Mp/lp,$p=Pp*(np-_d)+_d;for(let zp=0;zp<=sp;zp++){const Dp=zp/sp,Fp=Dp*dp+cp,jp=Math.sin(Fp),Lp=Math.cos(Fp);Ap.x=$p*jp,Ap.y=-Pp*ap+_p,Ap.z=$p*Lp,pp.push(Ap.x,Ap.y,Ap.z),Sp.set(jp,Tp,Lp).normalize(),mp.push(Sp.x,Sp.y,Sp.z),gp.push(Dp,1-Pp),Op.push(yp++)}xp.push(Op)}for(let Mp=0;Mp<sp;Mp++)for(let Op=0;Op<lp;Op++){const Pp=xp[Op][Mp],$p=xp[Op+1][Mp],zp=xp[Op+1][Mp+1],Dp=xp[Op][Mp+1];fp.push(Pp,$p,Dp),fp.push($p,zp,Dp),Rp+=6}hp.addGroup(vp,Rp,0),vp+=Rp}function Ep(Sp){const Ap=yp,Rp=new Vector2,Tp=new Vector3;let Mp=0;const Op=Sp===!0?_d:np,Pp=Sp===!0?1:-1;for(let zp=1;zp<=sp;zp++)pp.push(0,_p*Pp,0),mp.push(0,Pp,0),gp.push(.5,.5),yp++;const $p=yp;for(let zp=0;zp<=sp;zp++){const Fp=zp/sp*dp+cp,jp=Math.cos(Fp),Lp=Math.sin(Fp);Tp.x=Op*Lp,Tp.y=_p*Pp,Tp.z=Op*jp,pp.push(Tp.x,Tp.y,Tp.z),mp.push(0,Pp,0),Rp.x=jp*.5+.5,Rp.y=Lp*.5*Pp+.5,gp.push(Rp.x,Rp.y),yp++}for(let zp=0;zp<sp;zp++){const Dp=Ap+zp,Fp=$p+zp;Sp===!0?fp.push(Fp,Fp+1,Dp):fp.push(Fp+1,Fp,Dp),Mp+=3}hp.addGroup(vp,Mp,Sp===!0?1:2),vp+=Mp}}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new CylinderGeometry(_d.radiusTop,_d.radiusBottom,_d.height,_d.radialSegments,_d.heightSegments,_d.openEnded,_d.thetaStart,_d.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(_d=1,np=1,ap=32,sp=1,lp=!1,up=0,cp=Math.PI*2){super(0,_d,np,ap,sp,lp,up,cp),this.type="ConeGeometry",this.parameters={radius:_d,height:np,radialSegments:ap,heightSegments:sp,openEnded:lp,thetaStart:up,thetaLength:cp}}static fromJSON(_d){return new ConeGeometry(_d.radius,_d.height,_d.radialSegments,_d.heightSegments,_d.openEnded,_d.thetaStart,_d.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(_d=[],np=[],ap=1,sp=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:_d,indices:np,radius:ap,detail:sp};const lp=[],up=[];cp(sp),hp(ap),fp(),this.setAttribute("position",new Float32BufferAttribute(lp,3)),this.setAttribute("normal",new Float32BufferAttribute(lp.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(up,2)),sp===0?this.computeVertexNormals():this.normalizeNormals();function cp(bp){const Ep=new Vector3,Sp=new Vector3,Ap=new Vector3;for(let Rp=0;Rp<np.length;Rp+=3)gp(np[Rp+0],Ep),gp(np[Rp+1],Sp),gp(np[Rp+2],Ap),dp(Ep,Sp,Ap,bp)}function dp(bp,Ep,Sp,Ap){const Rp=Ap+1,Tp=[];for(let Mp=0;Mp<=Rp;Mp++){Tp[Mp]=[];const Op=bp.clone().lerp(Sp,Mp/Rp),Pp=Ep.clone().lerp(Sp,Mp/Rp),$p=Rp-Mp;for(let zp=0;zp<=$p;zp++)zp===0&&Mp===Rp?Tp[Mp][zp]=Op:Tp[Mp][zp]=Op.clone().lerp(Pp,zp/$p)}for(let Mp=0;Mp<Rp;Mp++)for(let Op=0;Op<2*(Rp-Mp)-1;Op++){const Pp=Math.floor(Op/2);Op%2===0?(mp(Tp[Mp][Pp+1]),mp(Tp[Mp+1][Pp]),mp(Tp[Mp][Pp])):(mp(Tp[Mp][Pp+1]),mp(Tp[Mp+1][Pp+1]),mp(Tp[Mp+1][Pp]))}}function hp(bp){const Ep=new Vector3;for(let Sp=0;Sp<lp.length;Sp+=3)Ep.x=lp[Sp+0],Ep.y=lp[Sp+1],Ep.z=lp[Sp+2],Ep.normalize().multiplyScalar(bp),lp[Sp+0]=Ep.x,lp[Sp+1]=Ep.y,lp[Sp+2]=Ep.z}function fp(){const bp=new Vector3;for(let Ep=0;Ep<lp.length;Ep+=3){bp.x=lp[Ep+0],bp.y=lp[Ep+1],bp.z=lp[Ep+2];const Sp=_p(bp)/2/Math.PI+.5,Ap=vp(bp)/Math.PI+.5;up.push(Sp,1-Ap)}yp(),pp()}function pp(){for(let bp=0;bp<up.length;bp+=6){const Ep=up[bp+0],Sp=up[bp+2],Ap=up[bp+4],Rp=Math.max(Ep,Sp,Ap),Tp=Math.min(Ep,Sp,Ap);Rp>.9&&Tp<.1&&(Ep<.2&&(up[bp+0]+=1),Sp<.2&&(up[bp+2]+=1),Ap<.2&&(up[bp+4]+=1))}}function mp(bp){lp.push(bp.x,bp.y,bp.z)}function gp(bp,Ep){const Sp=bp*3;Ep.x=_d[Sp+0],Ep.y=_d[Sp+1],Ep.z=_d[Sp+2]}function yp(){const bp=new Vector3,Ep=new Vector3,Sp=new Vector3,Ap=new Vector3,Rp=new Vector2,Tp=new Vector2,Mp=new Vector2;for(let Op=0,Pp=0;Op<lp.length;Op+=9,Pp+=6){bp.set(lp[Op+0],lp[Op+1],lp[Op+2]),Ep.set(lp[Op+3],lp[Op+4],lp[Op+5]),Sp.set(lp[Op+6],lp[Op+7],lp[Op+8]),Rp.set(up[Pp+0],up[Pp+1]),Tp.set(up[Pp+2],up[Pp+3]),Mp.set(up[Pp+4],up[Pp+5]),Ap.copy(bp).add(Ep).add(Sp).divideScalar(3);const $p=_p(Ap);xp(Rp,Pp+0,bp,$p),xp(Tp,Pp+2,Ep,$p),xp(Mp,Pp+4,Sp,$p)}}function xp(bp,Ep,Sp,Ap){Ap<0&&bp.x===1&&(up[Ep]=bp.x-1),Sp.x===0&&Sp.z===0&&(up[Ep]=Ap/2/Math.PI+.5)}function _p(bp){return Math.atan2(bp.z,-bp.x)}function vp(bp){return Math.atan2(-bp.y,Math.sqrt(bp.x*bp.x+bp.z*bp.z))}}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new PolyhedronGeometry(_d.vertices,_d.indices,_d.radius,_d.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(_d=1,np=0){const ap=(1+Math.sqrt(5))/2,sp=1/ap,lp=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-sp,-ap,0,-sp,ap,0,sp,-ap,0,sp,ap,-sp,-ap,0,-sp,ap,0,sp,-ap,0,sp,ap,0,-ap,0,-sp,ap,0,-sp,-ap,0,sp,ap,0,sp],up=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(lp,up,_d,np),this.type="DodecahedronGeometry",this.parameters={radius:_d,detail:np}}static fromJSON(_d){return new DodecahedronGeometry(_d.radius,_d.detail)}}const _v0=new Vector3,_v1$1=new Vector3,_normal=new Vector3,_triangle=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(_d=null,np=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:_d,thresholdAngle:np},_d!==null){const sp=Math.pow(10,4),lp=Math.cos(DEG2RAD*np),up=_d.getIndex(),cp=_d.getAttribute("position"),dp=up?up.count:cp.count,hp=[0,0,0],fp=["a","b","c"],pp=new Array(3),mp={},gp=[];for(let yp=0;yp<dp;yp+=3){up?(hp[0]=up.getX(yp),hp[1]=up.getX(yp+1),hp[2]=up.getX(yp+2)):(hp[0]=yp,hp[1]=yp+1,hp[2]=yp+2);const{a:xp,b:_p,c:vp}=_triangle;if(xp.fromBufferAttribute(cp,hp[0]),_p.fromBufferAttribute(cp,hp[1]),vp.fromBufferAttribute(cp,hp[2]),_triangle.getNormal(_normal),pp[0]=`${Math.round(xp.x*sp)},${Math.round(xp.y*sp)},${Math.round(xp.z*sp)}`,pp[1]=`${Math.round(_p.x*sp)},${Math.round(_p.y*sp)},${Math.round(_p.z*sp)}`,pp[2]=`${Math.round(vp.x*sp)},${Math.round(vp.y*sp)},${Math.round(vp.z*sp)}`,!(pp[0]===pp[1]||pp[1]===pp[2]||pp[2]===pp[0]))for(let bp=0;bp<3;bp++){const Ep=(bp+1)%3,Sp=pp[bp],Ap=pp[Ep],Rp=_triangle[fp[bp]],Tp=_triangle[fp[Ep]],Mp=`${Sp}_${Ap}`,Op=`${Ap}_${Sp}`;Op in mp&&mp[Op]?(_normal.dot(mp[Op].normal)<=lp&&(gp.push(Rp.x,Rp.y,Rp.z),gp.push(Tp.x,Tp.y,Tp.z)),mp[Op]=null):Mp in mp||(mp[Mp]={index0:hp[bp],index1:hp[Ep],normal:_normal.clone()})}}for(const yp in mp)if(mp[yp]){const{index0:xp,index1:_p}=mp[yp];_v0.fromBufferAttribute(cp,xp),_v1$1.fromBufferAttribute(cp,_p),gp.push(_v0.x,_v0.y,_v0.z),gp.push(_v1$1.x,_v1$1.y,_v1$1.z)}this.setAttribute("position",new Float32BufferAttribute(gp,3))}}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}}class Shape extends Path{constructor(_d){super(_d),this.uuid=generateUUID(),this.type="Shape",this.holes=[]}getPointsHoles(_d){const np=[];for(let ap=0,sp=this.holes.length;ap<sp;ap++)np[ap]=this.holes[ap].getPoints(_d);return np}extractPoints(_d){return{shape:this.getPoints(_d),holes:this.getPointsHoles(_d)}}copy(_d){super.copy(_d),this.holes=[];for(let np=0,ap=_d.holes.length;np<ap;np++){const sp=_d.holes[np];this.holes.push(sp.clone())}return this}toJSON(){const _d=super.toJSON();_d.uuid=this.uuid,_d.holes=[];for(let np=0,ap=this.holes.length;np<ap;np++){const sp=this.holes[np];_d.holes.push(sp.toJSON())}return _d}fromJSON(_d){super.fromJSON(_d),this.uuid=_d.uuid,this.holes=[];for(let np=0,ap=_d.holes.length;np<ap;np++){const sp=_d.holes[np];this.holes.push(new Path().fromJSON(sp))}return this}}const Earcut={triangulate:function(rp,_d,np=2){const ap=_d&&_d.length,sp=ap?_d[0]*np:rp.length;let lp=linkedList(rp,0,sp,np,!0);const up=[];if(!lp||lp.next===lp.prev)return up;let cp,dp,hp,fp,pp,mp,gp;if(ap&&(lp=eliminateHoles(rp,_d,lp,np)),rp.length>80*np){cp=hp=rp[0],dp=fp=rp[1];for(let yp=np;yp<sp;yp+=np)pp=rp[yp],mp=rp[yp+1],pp<cp&&(cp=pp),mp<dp&&(dp=mp),pp>hp&&(hp=pp),mp>fp&&(fp=mp);gp=Math.max(hp-cp,fp-dp),gp=gp!==0?32767/gp:0}return earcutLinked(lp,up,np,cp,dp,gp,0),up}};function linkedList(rp,_d,np,ap,sp){let lp,up;if(sp===signedArea(rp,_d,np,ap)>0)for(lp=_d;lp<np;lp+=ap)up=insertNode(lp,rp[lp],rp[lp+1],up);else for(lp=np-ap;lp>=_d;lp-=ap)up=insertNode(lp,rp[lp],rp[lp+1],up);return up&&equals(up,up.next)&&(removeNode(up),up=up.next),up}function filterPoints(rp,_d){if(!rp)return rp;_d||(_d=rp);let np=rp,ap;do if(ap=!1,!np.steiner&&(equals(np,np.next)||area(np.prev,np,np.next)===0)){if(removeNode(np),np=_d=np.prev,np===np.next)break;ap=!0}else np=np.next;while(ap||np!==_d);return _d}function earcutLinked(rp,_d,np,ap,sp,lp,up){if(!rp)return;!up&&lp&&indexCurve(rp,ap,sp,lp);let cp=rp,dp,hp;for(;rp.prev!==rp.next;){if(dp=rp.prev,hp=rp.next,lp?isEarHashed(rp,ap,sp,lp):isEar(rp)){_d.push(dp.i/np|0),_d.push(rp.i/np|0),_d.push(hp.i/np|0),removeNode(rp),rp=hp.next,cp=hp.next;continue}if(rp=hp,rp===cp){up?up===1?(rp=cureLocalIntersections(filterPoints(rp),_d,np),earcutLinked(rp,_d,np,ap,sp,lp,2)):up===2&&splitEarcut(rp,_d,np,ap,sp,lp):earcutLinked(filterPoints(rp),_d,np,ap,sp,lp,1);break}}}function isEar(rp){const _d=rp.prev,np=rp,ap=rp.next;if(area(_d,np,ap)>=0)return!1;const sp=_d.x,lp=np.x,up=ap.x,cp=_d.y,dp=np.y,hp=ap.y,fp=sp<lp?sp<up?sp:up:lp<up?lp:up,pp=cp<dp?cp<hp?cp:hp:dp<hp?dp:hp,mp=sp>lp?sp>up?sp:up:lp>up?lp:up,gp=cp>dp?cp>hp?cp:hp:dp>hp?dp:hp;let yp=ap.next;for(;yp!==_d;){if(yp.x>=fp&&yp.x<=mp&&yp.y>=pp&&yp.y<=gp&&pointInTriangle(sp,cp,lp,dp,up,hp,yp.x,yp.y)&&area(yp.prev,yp,yp.next)>=0)return!1;yp=yp.next}return!0}function isEarHashed(rp,_d,np,ap){const sp=rp.prev,lp=rp,up=rp.next;if(area(sp,lp,up)>=0)return!1;const cp=sp.x,dp=lp.x,hp=up.x,fp=sp.y,pp=lp.y,mp=up.y,gp=cp<dp?cp<hp?cp:hp:dp<hp?dp:hp,yp=fp<pp?fp<mp?fp:mp:pp<mp?pp:mp,xp=cp>dp?cp>hp?cp:hp:dp>hp?dp:hp,_p=fp>pp?fp>mp?fp:mp:pp>mp?pp:mp,vp=zOrder(gp,yp,_d,np,ap),bp=zOrder(xp,_p,_d,np,ap);let Ep=rp.prevZ,Sp=rp.nextZ;for(;Ep&&Ep.z>=vp&&Sp&&Sp.z<=bp;){if(Ep.x>=gp&&Ep.x<=xp&&Ep.y>=yp&&Ep.y<=_p&&Ep!==sp&&Ep!==up&&pointInTriangle(cp,fp,dp,pp,hp,mp,Ep.x,Ep.y)&&area(Ep.prev,Ep,Ep.next)>=0||(Ep=Ep.prevZ,Sp.x>=gp&&Sp.x<=xp&&Sp.y>=yp&&Sp.y<=_p&&Sp!==sp&&Sp!==up&&pointInTriangle(cp,fp,dp,pp,hp,mp,Sp.x,Sp.y)&&area(Sp.prev,Sp,Sp.next)>=0))return!1;Sp=Sp.nextZ}for(;Ep&&Ep.z>=vp;){if(Ep.x>=gp&&Ep.x<=xp&&Ep.y>=yp&&Ep.y<=_p&&Ep!==sp&&Ep!==up&&pointInTriangle(cp,fp,dp,pp,hp,mp,Ep.x,Ep.y)&&area(Ep.prev,Ep,Ep.next)>=0)return!1;Ep=Ep.prevZ}for(;Sp&&Sp.z<=bp;){if(Sp.x>=gp&&Sp.x<=xp&&Sp.y>=yp&&Sp.y<=_p&&Sp!==sp&&Sp!==up&&pointInTriangle(cp,fp,dp,pp,hp,mp,Sp.x,Sp.y)&&area(Sp.prev,Sp,Sp.next)>=0)return!1;Sp=Sp.nextZ}return!0}function cureLocalIntersections(rp,_d,np){let ap=rp;do{const sp=ap.prev,lp=ap.next.next;!equals(sp,lp)&&intersects(sp,ap,ap.next,lp)&&locallyInside(sp,lp)&&locallyInside(lp,sp)&&(_d.push(sp.i/np|0),_d.push(ap.i/np|0),_d.push(lp.i/np|0),removeNode(ap),removeNode(ap.next),ap=rp=lp),ap=ap.next}while(ap!==rp);return filterPoints(ap)}function splitEarcut(rp,_d,np,ap,sp,lp){let up=rp;do{let cp=up.next.next;for(;cp!==up.prev;){if(up.i!==cp.i&&isValidDiagonal(up,cp)){let dp=splitPolygon(up,cp);up=filterPoints(up,up.next),dp=filterPoints(dp,dp.next),earcutLinked(up,_d,np,ap,sp,lp,0),earcutLinked(dp,_d,np,ap,sp,lp,0);return}cp=cp.next}up=up.next}while(up!==rp)}function eliminateHoles(rp,_d,np,ap){const sp=[];let lp,up,cp,dp,hp;for(lp=0,up=_d.length;lp<up;lp++)cp=_d[lp]*ap,dp=lp<up-1?_d[lp+1]*ap:rp.length,hp=linkedList(rp,cp,dp,ap,!1),hp===hp.next&&(hp.steiner=!0),sp.push(getLeftmost(hp));for(sp.sort(compareX),lp=0;lp<sp.length;lp++)np=eliminateHole(sp[lp],np);return np}function compareX(rp,_d){return rp.x-_d.x}function eliminateHole(rp,_d){const np=findHoleBridge(rp,_d);if(!np)return _d;const ap=splitPolygon(np,rp);return filterPoints(ap,ap.next),filterPoints(np,np.next)}function findHoleBridge(rp,_d){let np=_d,ap=-1/0,sp;const lp=rp.x,up=rp.y;do{if(up<=np.y&&up>=np.next.y&&np.next.y!==np.y){const mp=np.x+(up-np.y)*(np.next.x-np.x)/(np.next.y-np.y);if(mp<=lp&&mp>ap&&(ap=mp,sp=np.x<np.next.x?np:np.next,mp===lp))return sp}np=np.next}while(np!==_d);if(!sp)return null;const cp=sp,dp=sp.x,hp=sp.y;let fp=1/0,pp;np=sp;do lp>=np.x&&np.x>=dp&&lp!==np.x&&pointInTriangle(up<hp?lp:ap,up,dp,hp,up<hp?ap:lp,up,np.x,np.y)&&(pp=Math.abs(up-np.y)/(lp-np.x),locallyInside(np,rp)&&(pp<fp||pp===fp&&(np.x>sp.x||np.x===sp.x&&sectorContainsSector(sp,np)))&&(sp=np,fp=pp)),np=np.next;while(np!==cp);return sp}function sectorContainsSector(rp,_d){return area(rp.prev,rp,_d.prev)<0&&area(_d.next,rp,rp.next)<0}function indexCurve(rp,_d,np,ap){let sp=rp;do sp.z===0&&(sp.z=zOrder(sp.x,sp.y,_d,np,ap)),sp.prevZ=sp.prev,sp.nextZ=sp.next,sp=sp.next;while(sp!==rp);sp.prevZ.nextZ=null,sp.prevZ=null,sortLinked(sp)}function sortLinked(rp){let _d,np,ap,sp,lp,up,cp,dp,hp=1;do{for(np=rp,rp=null,lp=null,up=0;np;){for(up++,ap=np,cp=0,_d=0;_d<hp&&(cp++,ap=ap.nextZ,!!ap);_d++);for(dp=hp;cp>0||dp>0&&ap;)cp!==0&&(dp===0||!ap||np.z<=ap.z)?(sp=np,np=np.nextZ,cp--):(sp=ap,ap=ap.nextZ,dp--),lp?lp.nextZ=sp:rp=sp,sp.prevZ=lp,lp=sp;np=ap}lp.nextZ=null,hp*=2}while(up>1);return rp}function zOrder(rp,_d,np,ap,sp){return rp=(rp-np)*sp|0,_d=(_d-ap)*sp|0,rp=(rp|rp<<8)&16711935,rp=(rp|rp<<4)&252645135,rp=(rp|rp<<2)&858993459,rp=(rp|rp<<1)&1431655765,_d=(_d|_d<<8)&16711935,_d=(_d|_d<<4)&252645135,_d=(_d|_d<<2)&858993459,_d=(_d|_d<<1)&1431655765,rp|_d<<1}function getLeftmost(rp){let _d=rp,np=rp;do(_d.x<np.x||_d.x===np.x&&_d.y<np.y)&&(np=_d),_d=_d.next;while(_d!==rp);return np}function pointInTriangle(rp,_d,np,ap,sp,lp,up,cp){return(sp-up)*(_d-cp)>=(rp-up)*(lp-cp)&&(rp-up)*(ap-cp)>=(np-up)*(_d-cp)&&(np-up)*(lp-cp)>=(sp-up)*(ap-cp)}function isValidDiagonal(rp,_d){return rp.next.i!==_d.i&&rp.prev.i!==_d.i&&!intersectsPolygon(rp,_d)&&(locallyInside(rp,_d)&&locallyInside(_d,rp)&&middleInside(rp,_d)&&(area(rp.prev,rp,_d.prev)||area(rp,_d.prev,_d))||equals(rp,_d)&&area(rp.prev,rp,rp.next)>0&&area(_d.prev,_d,_d.next)>0)}function area(rp,_d,np){return(_d.y-rp.y)*(np.x-_d.x)-(_d.x-rp.x)*(np.y-_d.y)}function equals(rp,_d){return rp.x===_d.x&&rp.y===_d.y}function intersects(rp,_d,np,ap){const sp=sign(area(rp,_d,np)),lp=sign(area(rp,_d,ap)),up=sign(area(np,ap,rp)),cp=sign(area(np,ap,_d));return!!(sp!==lp&&up!==cp||sp===0&&onSegment(rp,np,_d)||lp===0&&onSegment(rp,ap,_d)||up===0&&onSegment(np,rp,ap)||cp===0&&onSegment(np,_d,ap))}function onSegment(rp,_d,np){return _d.x<=Math.max(rp.x,np.x)&&_d.x>=Math.min(rp.x,np.x)&&_d.y<=Math.max(rp.y,np.y)&&_d.y>=Math.min(rp.y,np.y)}function sign(rp){return rp>0?1:rp<0?-1:0}function intersectsPolygon(rp,_d){let np=rp;do{if(np.i!==rp.i&&np.next.i!==rp.i&&np.i!==_d.i&&np.next.i!==_d.i&&intersects(np,np.next,rp,_d))return!0;np=np.next}while(np!==rp);return!1}function locallyInside(rp,_d){return area(rp.prev,rp,rp.next)<0?area(rp,_d,rp.next)>=0&&area(rp,rp.prev,_d)>=0:area(rp,_d,rp.prev)<0||area(rp,rp.next,_d)<0}function middleInside(rp,_d){let np=rp,ap=!1;const sp=(rp.x+_d.x)/2,lp=(rp.y+_d.y)/2;do np.y>lp!=np.next.y>lp&&np.next.y!==np.y&&sp<(np.next.x-np.x)*(lp-np.y)/(np.next.y-np.y)+np.x&&(ap=!ap),np=np.next;while(np!==rp);return ap}function splitPolygon(rp,_d){const np=new Node(rp.i,rp.x,rp.y),ap=new Node(_d.i,_d.x,_d.y),sp=rp.next,lp=_d.prev;return rp.next=_d,_d.prev=rp,np.next=sp,sp.prev=np,ap.next=np,np.prev=ap,lp.next=ap,ap.prev=lp,ap}function insertNode(rp,_d,np,ap){const sp=new Node(rp,_d,np);return ap?(sp.next=ap.next,sp.prev=ap,ap.next.prev=sp,ap.next=sp):(sp.prev=sp,sp.next=sp),sp}function removeNode(rp){rp.next.prev=rp.prev,rp.prev.next=rp.next,rp.prevZ&&(rp.prevZ.nextZ=rp.nextZ),rp.nextZ&&(rp.nextZ.prevZ=rp.prevZ)}function Node(rp,_d,np){this.i=rp,this.x=_d,this.y=np,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(rp,_d,np,ap){let sp=0;for(let lp=_d,up=np-ap;lp<np;lp+=ap)sp+=(rp[up]-rp[lp])*(rp[lp+1]+rp[up+1]),up=lp;return sp}class ShapeUtils{static area(_d){const np=_d.length;let ap=0;for(let sp=np-1,lp=0;lp<np;sp=lp++)ap+=_d[sp].x*_d[lp].y-_d[lp].x*_d[sp].y;return ap*.5}static isClockWise(_d){return ShapeUtils.area(_d)<0}static triangulateShape(_d,np){const ap=[],sp=[],lp=[];removeDupEndPts(_d),addContour(ap,_d);let up=_d.length;np.forEach(removeDupEndPts);for(let dp=0;dp<np.length;dp++)sp.push(up),up+=np[dp].length,addContour(ap,np[dp]);const cp=Earcut.triangulate(ap,sp);for(let dp=0;dp<cp.length;dp+=3)lp.push(cp.slice(dp,dp+3));return lp}}function removeDupEndPts(rp){const _d=rp.length;_d>2&&rp[_d-1].equals(rp[0])&&rp.pop()}function addContour(rp,_d){for(let np=0;np<_d.length;np++)rp.push(_d[np].x),rp.push(_d[np].y)}class ExtrudeGeometry extends BufferGeometry{constructor(_d=new Shape([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),np={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:_d,options:np},_d=Array.isArray(_d)?_d:[_d];const ap=this,sp=[],lp=[];for(let cp=0,dp=_d.length;cp<dp;cp++){const hp=_d[cp];up(hp)}this.setAttribute("position",new Float32BufferAttribute(sp,3)),this.setAttribute("uv",new Float32BufferAttribute(lp,2)),this.computeVertexNormals();function up(cp){const dp=[],hp=np.curveSegments!==void 0?np.curveSegments:12,fp=np.steps!==void 0?np.steps:1,pp=np.depth!==void 0?np.depth:1;let mp=np.bevelEnabled!==void 0?np.bevelEnabled:!0,gp=np.bevelThickness!==void 0?np.bevelThickness:.2,yp=np.bevelSize!==void 0?np.bevelSize:gp-.1,xp=np.bevelOffset!==void 0?np.bevelOffset:0,_p=np.bevelSegments!==void 0?np.bevelSegments:3;const vp=np.extrudePath,bp=np.UVGenerator!==void 0?np.UVGenerator:WorldUVGenerator;let Ep,Sp=!1,Ap,Rp,Tp,Mp;vp&&(Ep=vp.getSpacedPoints(fp),Sp=!0,mp=!1,Ap=vp.computeFrenetFrames(fp,!1),Rp=new Vector3,Tp=new Vector3,Mp=new Vector3),mp||(_p=0,gp=0,yp=0,xp=0);const Op=cp.extractPoints(hp);let Pp=Op.shape;const $p=Op.holes;if(!ShapeUtils.isClockWise(Pp)){Pp=Pp.reverse();for(let em=0,sm=$p.length;em<sm;em++){const Zp=$p[em];ShapeUtils.isClockWise(Zp)&&($p[em]=Zp.reverse())}}const Dp=ShapeUtils.triangulateShape(Pp,$p),Fp=Pp;for(let em=0,sm=$p.length;em<sm;em++){const Zp=$p[em];Pp=Pp.concat(Zp)}function jp(em,sm,Zp){return sm||console.error("THREE.ExtrudeGeometry: vec does not exist"),em.clone().addScaledVector(sm,Zp)}const Lp=Pp.length,Bp=Dp.length;function Ip(em,sm,Zp){let mm,fm,_m;const zm=em.x-sm.x,tm=em.y-sm.y,Jp=Zp.x-em.x,pm=Zp.y-em.y,km=zm*zm+tm*tm,ym=zm*pm-tm*Jp;if(Math.abs(ym)>Number.EPSILON){const Em=Math.sqrt(km),Bm=Math.sqrt(Jp*Jp+pm*pm),Pm=sm.x-tm/Em,Im=sm.y+zm/Em,Dm=Zp.x-pm/Bm,jm=Zp.y+Jp/Bm,Fm=((Dm-Pm)*pm-(jm-Im)*Jp)/(zm*pm-tm*Jp);mm=Pm+zm*Fm-em.x,fm=Im+tm*Fm-em.y;const av=mm*mm+fm*fm;if(av<=2)return new Vector2(mm,fm);_m=Math.sqrt(av/2)}else{let Em=!1;zm>Number.EPSILON?Jp>Number.EPSILON&&(Em=!0):zm<-Number.EPSILON?Jp<-Number.EPSILON&&(Em=!0):Math.sign(tm)===Math.sign(pm)&&(Em=!0),Em?(mm=-tm,fm=zm,_m=Math.sqrt(km)):(mm=zm,fm=tm,_m=Math.sqrt(km/2))}return new Vector2(mm/_m,fm/_m)}const kp=[];for(let em=0,sm=Fp.length,Zp=sm-1,mm=em+1;em<sm;em++,Zp++,mm++)Zp===sm&&(Zp=0),mm===sm&&(mm=0),kp[em]=Ip(Fp[em],Fp[Zp],Fp[mm]);const Up=[];let Gp,Wp=kp.concat();for(let em=0,sm=$p.length;em<sm;em++){const Zp=$p[em];Gp=[];for(let mm=0,fm=Zp.length,_m=fm-1,zm=mm+1;mm<fm;mm++,_m++,zm++)_m===fm&&(_m=0),zm===fm&&(zm=0),Gp[mm]=Ip(Zp[mm],Zp[_m],Zp[zm]);Up.push(Gp),Wp=Wp.concat(Gp)}for(let em=0;em<_p;em++){const sm=em/_p,Zp=gp*Math.cos(sm*Math.PI/2),mm=yp*Math.sin(sm*Math.PI/2)+xp;for(let fm=0,_m=Fp.length;fm<_m;fm++){const zm=jp(Fp[fm],kp[fm],mm);lm(zm.x,zm.y,-Zp)}for(let fm=0,_m=$p.length;fm<_m;fm++){const zm=$p[fm];Gp=Up[fm];for(let tm=0,Jp=zm.length;tm<Jp;tm++){const pm=jp(zm[tm],Gp[tm],mm);lm(pm.x,pm.y,-Zp)}}}const Qp=yp+xp;for(let em=0;em<Lp;em++){const sm=mp?jp(Pp[em],Wp[em],Qp):Pp[em];Sp?(Tp.copy(Ap.normals[0]).multiplyScalar(sm.x),Rp.copy(Ap.binormals[0]).multiplyScalar(sm.y),Mp.copy(Ep[0]).add(Tp).add(Rp),lm(Mp.x,Mp.y,Mp.z)):lm(sm.x,sm.y,0)}for(let em=1;em<=fp;em++)for(let sm=0;sm<Lp;sm++){const Zp=mp?jp(Pp[sm],Wp[sm],Qp):Pp[sm];Sp?(Tp.copy(Ap.normals[em]).multiplyScalar(Zp.x),Rp.copy(Ap.binormals[em]).multiplyScalar(Zp.y),Mp.copy(Ep[em]).add(Tp).add(Rp),lm(Mp.x,Mp.y,Mp.z)):lm(Zp.x,Zp.y,pp/fp*em)}for(let em=_p-1;em>=0;em--){const sm=em/_p,Zp=gp*Math.cos(sm*Math.PI/2),mm=yp*Math.sin(sm*Math.PI/2)+xp;for(let fm=0,_m=Fp.length;fm<_m;fm++){const zm=jp(Fp[fm],kp[fm],mm);lm(zm.x,zm.y,pp+Zp)}for(let fm=0,_m=$p.length;fm<_m;fm++){const zm=$p[fm];Gp=Up[fm];for(let tm=0,Jp=zm.length;tm<Jp;tm++){const pm=jp(zm[tm],Gp[tm],mm);Sp?lm(pm.x,pm.y+Ep[fp-1].y,Ep[fp-1].x+Zp):lm(pm.x,pm.y,pp+Zp)}}}Xp(),rm();function Xp(){const em=sp.length/3;if(mp){let sm=0,Zp=Lp*sm;for(let mm=0;mm<Bp;mm++){const fm=Dp[mm];cm(fm[2]+Zp,fm[1]+Zp,fm[0]+Zp)}sm=fp+_p*2,Zp=Lp*sm;for(let mm=0;mm<Bp;mm++){const fm=Dp[mm];cm(fm[0]+Zp,fm[1]+Zp,fm[2]+Zp)}}else{for(let sm=0;sm<Bp;sm++){const Zp=Dp[sm];cm(Zp[2],Zp[1],Zp[0])}for(let sm=0;sm<Bp;sm++){const Zp=Dp[sm];cm(Zp[0]+Lp*fp,Zp[1]+Lp*fp,Zp[2]+Lp*fp)}}ap.addGroup(em,sp.length/3-em,0)}function rm(){const em=sp.length/3;let sm=0;Kp(Fp,sm),sm+=Fp.length;for(let Zp=0,mm=$p.length;Zp<mm;Zp++){const fm=$p[Zp];Kp(fm,sm),sm+=fm.length}ap.addGroup(em,sp.length/3-em,1)}function Kp(em,sm){let Zp=em.length;for(;--Zp>=0;){const mm=Zp;let fm=Zp-1;fm<0&&(fm=em.length-1);for(let _m=0,zm=fp+_p*2;_m<zm;_m++){const tm=Lp*_m,Jp=Lp*(_m+1),pm=sm+mm+tm,km=sm+fm+tm,ym=sm+fm+Jp,Em=sm+mm+Jp;gm(pm,km,ym,Em)}}}function lm(em,sm,Zp){dp.push(em),dp.push(sm),dp.push(Zp)}function cm(em,sm,Zp){Mm(em),Mm(sm),Mm(Zp);const mm=sp.length/3,fm=bp.generateTopUV(ap,sp,mm-3,mm-2,mm-1);dm(fm[0]),dm(fm[1]),dm(fm[2])}function gm(em,sm,Zp,mm){Mm(em),Mm(sm),Mm(mm),Mm(sm),Mm(Zp),Mm(mm);const fm=sp.length/3,_m=bp.generateSideWallUV(ap,sp,fm-6,fm-3,fm-2,fm-1);dm(_m[0]),dm(_m[1]),dm(_m[3]),dm(_m[1]),dm(_m[2]),dm(_m[3])}function Mm(em){sp.push(dp[em*3+0]),sp.push(dp[em*3+1]),sp.push(dp[em*3+2])}function dm(em){lp.push(em.x),lp.push(em.y)}}}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}toJSON(){const _d=super.toJSON(),np=this.parameters.shapes,ap=this.parameters.options;return toJSON$1(np,ap,_d)}static fromJSON(_d,np){const ap=[];for(let lp=0,up=_d.shapes.length;lp<up;lp++){const cp=np[_d.shapes[lp]];ap.push(cp)}const sp=_d.options.extrudePath;return sp!==void 0&&(_d.options.extrudePath=new Curves[sp.type]().fromJSON(sp)),new ExtrudeGeometry(ap,_d.options)}}const WorldUVGenerator={generateTopUV:function(rp,_d,np,ap,sp){const lp=_d[np*3],up=_d[np*3+1],cp=_d[ap*3],dp=_d[ap*3+1],hp=_d[sp*3],fp=_d[sp*3+1];return[new Vector2(lp,up),new Vector2(cp,dp),new Vector2(hp,fp)]},generateSideWallUV:function(rp,_d,np,ap,sp,lp){const up=_d[np*3],cp=_d[np*3+1],dp=_d[np*3+2],hp=_d[ap*3],fp=_d[ap*3+1],pp=_d[ap*3+2],mp=_d[sp*3],gp=_d[sp*3+1],yp=_d[sp*3+2],xp=_d[lp*3],_p=_d[lp*3+1],vp=_d[lp*3+2];return Math.abs(cp-fp)<Math.abs(up-hp)?[new Vector2(up,1-dp),new Vector2(hp,1-pp),new Vector2(mp,1-yp),new Vector2(xp,1-vp)]:[new Vector2(cp,1-dp),new Vector2(fp,1-pp),new Vector2(gp,1-yp),new Vector2(_p,1-vp)]}};function toJSON$1(rp,_d,np){if(np.shapes=[],Array.isArray(rp))for(let ap=0,sp=rp.length;ap<sp;ap++){const lp=rp[ap];np.shapes.push(lp.uuid)}else np.shapes.push(rp.uuid);return np.options=Object.assign({},_d),_d.extrudePath!==void 0&&(np.options.extrudePath=_d.extrudePath.toJSON()),np}class IcosahedronGeometry extends PolyhedronGeometry{constructor(_d=1,np=0){const ap=(1+Math.sqrt(5))/2,sp=[-1,ap,0,1,ap,0,-1,-ap,0,1,-ap,0,0,-1,ap,0,1,ap,0,-1,-ap,0,1,-ap,ap,0,-1,ap,0,1,-ap,0,-1,-ap,0,1],lp=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(sp,lp,_d,np),this.type="IcosahedronGeometry",this.parameters={radius:_d,detail:np}}static fromJSON(_d){return new IcosahedronGeometry(_d.radius,_d.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(_d=1,np=0){const ap=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],sp=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(ap,sp,_d,np),this.type="OctahedronGeometry",this.parameters={radius:_d,detail:np}}static fromJSON(_d){return new OctahedronGeometry(_d.radius,_d.detail)}}class RingGeometry extends BufferGeometry{constructor(_d=.5,np=1,ap=32,sp=1,lp=0,up=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:_d,outerRadius:np,thetaSegments:ap,phiSegments:sp,thetaStart:lp,thetaLength:up},ap=Math.max(3,ap),sp=Math.max(1,sp);const cp=[],dp=[],hp=[],fp=[];let pp=_d;const mp=(np-_d)/sp,gp=new Vector3,yp=new Vector2;for(let xp=0;xp<=sp;xp++){for(let _p=0;_p<=ap;_p++){const vp=lp+_p/ap*up;gp.x=pp*Math.cos(vp),gp.y=pp*Math.sin(vp),dp.push(gp.x,gp.y,gp.z),hp.push(0,0,1),yp.x=(gp.x/np+1)/2,yp.y=(gp.y/np+1)/2,fp.push(yp.x,yp.y)}pp+=mp}for(let xp=0;xp<sp;xp++){const _p=xp*(ap+1);for(let vp=0;vp<ap;vp++){const bp=vp+_p,Ep=bp,Sp=bp+ap+1,Ap=bp+ap+2,Rp=bp+1;cp.push(Ep,Sp,Rp),cp.push(Sp,Ap,Rp)}}this.setIndex(cp),this.setAttribute("position",new Float32BufferAttribute(dp,3)),this.setAttribute("normal",new Float32BufferAttribute(hp,3)),this.setAttribute("uv",new Float32BufferAttribute(fp,2))}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new RingGeometry(_d.innerRadius,_d.outerRadius,_d.thetaSegments,_d.phiSegments,_d.thetaStart,_d.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(_d=new Shape([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),np=12){super(),this.type="ShapeGeometry",this.parameters={shapes:_d,curveSegments:np};const ap=[],sp=[],lp=[],up=[];let cp=0,dp=0;if(Array.isArray(_d)===!1)hp(_d);else for(let fp=0;fp<_d.length;fp++)hp(_d[fp]),this.addGroup(cp,dp,fp),cp+=dp,dp=0;this.setIndex(ap),this.setAttribute("position",new Float32BufferAttribute(sp,3)),this.setAttribute("normal",new Float32BufferAttribute(lp,3)),this.setAttribute("uv",new Float32BufferAttribute(up,2));function hp(fp){const pp=sp.length/3,mp=fp.extractPoints(np);let gp=mp.shape;const yp=mp.holes;ShapeUtils.isClockWise(gp)===!1&&(gp=gp.reverse());for(let _p=0,vp=yp.length;_p<vp;_p++){const bp=yp[_p];ShapeUtils.isClockWise(bp)===!0&&(yp[_p]=bp.reverse())}const xp=ShapeUtils.triangulateShape(gp,yp);for(let _p=0,vp=yp.length;_p<vp;_p++){const bp=yp[_p];gp=gp.concat(bp)}for(let _p=0,vp=gp.length;_p<vp;_p++){const bp=gp[_p];sp.push(bp.x,bp.y,0),lp.push(0,0,1),up.push(bp.x,bp.y)}for(let _p=0,vp=xp.length;_p<vp;_p++){const bp=xp[_p],Ep=bp[0]+pp,Sp=bp[1]+pp,Ap=bp[2]+pp;ap.push(Ep,Sp,Ap),dp+=3}}}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}toJSON(){const _d=super.toJSON(),np=this.parameters.shapes;return toJSON(np,_d)}static fromJSON(_d,np){const ap=[];for(let sp=0,lp=_d.shapes.length;sp<lp;sp++){const up=np[_d.shapes[sp]];ap.push(up)}return new ShapeGeometry(ap,_d.curveSegments)}}function toJSON(rp,_d){if(_d.shapes=[],Array.isArray(rp))for(let np=0,ap=rp.length;np<ap;np++){const sp=rp[np];_d.shapes.push(sp.uuid)}else _d.shapes.push(rp.uuid);return _d}class SphereGeometry extends BufferGeometry{constructor(_d=1,np=32,ap=16,sp=0,lp=Math.PI*2,up=0,cp=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_d,widthSegments:np,heightSegments:ap,phiStart:sp,phiLength:lp,thetaStart:up,thetaLength:cp},np=Math.max(3,Math.floor(np)),ap=Math.max(2,Math.floor(ap));const dp=Math.min(up+cp,Math.PI);let hp=0;const fp=[],pp=new Vector3,mp=new Vector3,gp=[],yp=[],xp=[],_p=[];for(let vp=0;vp<=ap;vp++){const bp=[],Ep=vp/ap;let Sp=0;vp===0&&up===0?Sp=.5/np:vp===ap&&dp===Math.PI&&(Sp=-.5/np);for(let Ap=0;Ap<=np;Ap++){const Rp=Ap/np;pp.x=-_d*Math.cos(sp+Rp*lp)*Math.sin(up+Ep*cp),pp.y=_d*Math.cos(up+Ep*cp),pp.z=_d*Math.sin(sp+Rp*lp)*Math.sin(up+Ep*cp),yp.push(pp.x,pp.y,pp.z),mp.copy(pp).normalize(),xp.push(mp.x,mp.y,mp.z),_p.push(Rp+Sp,1-Ep),bp.push(hp++)}fp.push(bp)}for(let vp=0;vp<ap;vp++)for(let bp=0;bp<np;bp++){const Ep=fp[vp][bp+1],Sp=fp[vp][bp],Ap=fp[vp+1][bp],Rp=fp[vp+1][bp+1];(vp!==0||up>0)&&gp.push(Ep,Sp,Rp),(vp!==ap-1||dp<Math.PI)&&gp.push(Sp,Ap,Rp)}this.setIndex(gp),this.setAttribute("position",new Float32BufferAttribute(yp,3)),this.setAttribute("normal",new Float32BufferAttribute(xp,3)),this.setAttribute("uv",new Float32BufferAttribute(_p,2))}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new SphereGeometry(_d.radius,_d.widthSegments,_d.heightSegments,_d.phiStart,_d.phiLength,_d.thetaStart,_d.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(_d=1,np=0){const ap=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],sp=[2,1,0,0,3,2,1,3,0,2,3,1];super(ap,sp,_d,np),this.type="TetrahedronGeometry",this.parameters={radius:_d,detail:np}}static fromJSON(_d){return new TetrahedronGeometry(_d.radius,_d.detail)}}class TorusGeometry extends BufferGeometry{constructor(_d=1,np=.4,ap=12,sp=48,lp=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:_d,tube:np,radialSegments:ap,tubularSegments:sp,arc:lp},ap=Math.floor(ap),sp=Math.floor(sp);const up=[],cp=[],dp=[],hp=[],fp=new Vector3,pp=new Vector3,mp=new Vector3;for(let gp=0;gp<=ap;gp++)for(let yp=0;yp<=sp;yp++){const xp=yp/sp*lp,_p=gp/ap*Math.PI*2;pp.x=(_d+np*Math.cos(_p))*Math.cos(xp),pp.y=(_d+np*Math.cos(_p))*Math.sin(xp),pp.z=np*Math.sin(_p),cp.push(pp.x,pp.y,pp.z),fp.x=_d*Math.cos(xp),fp.y=_d*Math.sin(xp),mp.subVectors(pp,fp).normalize(),dp.push(mp.x,mp.y,mp.z),hp.push(yp/sp),hp.push(gp/ap)}for(let gp=1;gp<=ap;gp++)for(let yp=1;yp<=sp;yp++){const xp=(sp+1)*gp+yp-1,_p=(sp+1)*(gp-1)+yp-1,vp=(sp+1)*(gp-1)+yp,bp=(sp+1)*gp+yp;up.push(xp,_p,bp),up.push(_p,vp,bp)}this.setIndex(up),this.setAttribute("position",new Float32BufferAttribute(cp,3)),this.setAttribute("normal",new Float32BufferAttribute(dp,3)),this.setAttribute("uv",new Float32BufferAttribute(hp,2))}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new TorusGeometry(_d.radius,_d.tube,_d.radialSegments,_d.tubularSegments,_d.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(_d=1,np=.4,ap=64,sp=8,lp=2,up=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:_d,tube:np,tubularSegments:ap,radialSegments:sp,p:lp,q:up},ap=Math.floor(ap),sp=Math.floor(sp);const cp=[],dp=[],hp=[],fp=[],pp=new Vector3,mp=new Vector3,gp=new Vector3,yp=new Vector3,xp=new Vector3,_p=new Vector3,vp=new Vector3;for(let Ep=0;Ep<=ap;++Ep){const Sp=Ep/ap*lp*Math.PI*2;bp(Sp,lp,up,_d,gp),bp(Sp+.01,lp,up,_d,yp),_p.subVectors(yp,gp),vp.addVectors(yp,gp),xp.crossVectors(_p,vp),vp.crossVectors(xp,_p),xp.normalize(),vp.normalize();for(let Ap=0;Ap<=sp;++Ap){const Rp=Ap/sp*Math.PI*2,Tp=-np*Math.cos(Rp),Mp=np*Math.sin(Rp);pp.x=gp.x+(Tp*vp.x+Mp*xp.x),pp.y=gp.y+(Tp*vp.y+Mp*xp.y),pp.z=gp.z+(Tp*vp.z+Mp*xp.z),dp.push(pp.x,pp.y,pp.z),mp.subVectors(pp,gp).normalize(),hp.push(mp.x,mp.y,mp.z),fp.push(Ep/ap),fp.push(Ap/sp)}}for(let Ep=1;Ep<=ap;Ep++)for(let Sp=1;Sp<=sp;Sp++){const Ap=(sp+1)*(Ep-1)+(Sp-1),Rp=(sp+1)*Ep+(Sp-1),Tp=(sp+1)*Ep+Sp,Mp=(sp+1)*(Ep-1)+Sp;cp.push(Ap,Rp,Mp),cp.push(Rp,Tp,Mp)}this.setIndex(cp),this.setAttribute("position",new Float32BufferAttribute(dp,3)),this.setAttribute("normal",new Float32BufferAttribute(hp,3)),this.setAttribute("uv",new Float32BufferAttribute(fp,2));function bp(Ep,Sp,Ap,Rp,Tp){const Mp=Math.cos(Ep),Op=Math.sin(Ep),Pp=Ap/Sp*Ep,$p=Math.cos(Pp);Tp.x=Rp*(2+$p)*.5*Mp,Tp.y=Rp*(2+$p)*Op*.5,Tp.z=Rp*Math.sin(Pp)*.5}}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}static fromJSON(_d){return new TorusKnotGeometry(_d.radius,_d.tube,_d.tubularSegments,_d.radialSegments,_d.p,_d.q)}}class TubeGeometry extends BufferGeometry{constructor(_d=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),np=64,ap=1,sp=8,lp=!1){super(),this.type="TubeGeometry",this.parameters={path:_d,tubularSegments:np,radius:ap,radialSegments:sp,closed:lp};const up=_d.computeFrenetFrames(np,lp);this.tangents=up.tangents,this.normals=up.normals,this.binormals=up.binormals;const cp=new Vector3,dp=new Vector3,hp=new Vector2;let fp=new Vector3;const pp=[],mp=[],gp=[],yp=[];xp(),this.setIndex(yp),this.setAttribute("position",new Float32BufferAttribute(pp,3)),this.setAttribute("normal",new Float32BufferAttribute(mp,3)),this.setAttribute("uv",new Float32BufferAttribute(gp,2));function xp(){for(let Ep=0;Ep<np;Ep++)_p(Ep);_p(lp===!1?np:0),bp(),vp()}function _p(Ep){fp=_d.getPointAt(Ep/np,fp);const Sp=up.normals[Ep],Ap=up.binormals[Ep];for(let Rp=0;Rp<=sp;Rp++){const Tp=Rp/sp*Math.PI*2,Mp=Math.sin(Tp),Op=-Math.cos(Tp);dp.x=Op*Sp.x+Mp*Ap.x,dp.y=Op*Sp.y+Mp*Ap.y,dp.z=Op*Sp.z+Mp*Ap.z,dp.normalize(),mp.push(dp.x,dp.y,dp.z),cp.x=fp.x+ap*dp.x,cp.y=fp.y+ap*dp.y,cp.z=fp.z+ap*dp.z,pp.push(cp.x,cp.y,cp.z)}}function vp(){for(let Ep=1;Ep<=np;Ep++)for(let Sp=1;Sp<=sp;Sp++){const Ap=(sp+1)*(Ep-1)+(Sp-1),Rp=(sp+1)*Ep+(Sp-1),Tp=(sp+1)*Ep+Sp,Mp=(sp+1)*(Ep-1)+Sp;yp.push(Ap,Rp,Mp),yp.push(Rp,Tp,Mp)}}function bp(){for(let Ep=0;Ep<=np;Ep++)for(let Sp=0;Sp<=sp;Sp++)hp.x=Ep/np,hp.y=Sp/sp,gp.push(hp.x,hp.y)}}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}toJSON(){const _d=super.toJSON();return _d.path=this.parameters.path.toJSON(),_d}static fromJSON(_d){return new TubeGeometry(new Curves[_d.path.type]().fromJSON(_d.path),_d.tubularSegments,_d.radius,_d.radialSegments,_d.closed)}}class WireframeGeometry extends BufferGeometry{constructor(_d=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:_d},_d!==null){const np=[],ap=new Set,sp=new Vector3,lp=new Vector3;if(_d.index!==null){const up=_d.attributes.position,cp=_d.index;let dp=_d.groups;dp.length===0&&(dp=[{start:0,count:cp.count,materialIndex:0}]);for(let hp=0,fp=dp.length;hp<fp;++hp){const pp=dp[hp],mp=pp.start,gp=pp.count;for(let yp=mp,xp=mp+gp;yp<xp;yp+=3)for(let _p=0;_p<3;_p++){const vp=cp.getX(yp+_p),bp=cp.getX(yp+(_p+1)%3);sp.fromBufferAttribute(up,vp),lp.fromBufferAttribute(up,bp),isUniqueEdge(sp,lp,ap)===!0&&(np.push(sp.x,sp.y,sp.z),np.push(lp.x,lp.y,lp.z))}}}else{const up=_d.attributes.position;for(let cp=0,dp=up.count/3;cp<dp;cp++)for(let hp=0;hp<3;hp++){const fp=3*cp+hp,pp=3*cp+(hp+1)%3;sp.fromBufferAttribute(up,fp),lp.fromBufferAttribute(up,pp),isUniqueEdge(sp,lp,ap)===!0&&(np.push(sp.x,sp.y,sp.z),np.push(lp.x,lp.y,lp.z))}}this.setAttribute("position",new Float32BufferAttribute(np,3))}}copy(_d){return super.copy(_d),this.parameters=Object.assign({},_d.parameters),this}}function isUniqueEdge(rp,_d,np){const ap=`${rp.x},${rp.y},${rp.z}-${_d.x},${_d.y},${_d.z}`,sp=`${_d.x},${_d.y},${_d.z}-${rp.x},${rp.y},${rp.z}`;return np.has(ap)===!0||np.has(sp)===!0?!1:(np.add(ap),np.add(sp),!0)}var Geometries=Object.freeze({__proto__:null,BoxGeometry,CapsuleGeometry,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{constructor(_d){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.color.copy(_d.color),this.fog=_d.fog,this}}class RawShaderMaterial extends ShaderMaterial{constructor(_d){super(_d),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class MeshStandardMaterial extends Material{constructor(_d){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.defines={STANDARD:""},this.color.copy(_d.color),this.roughness=_d.roughness,this.metalness=_d.metalness,this.map=_d.map,this.lightMap=_d.lightMap,this.lightMapIntensity=_d.lightMapIntensity,this.aoMap=_d.aoMap,this.aoMapIntensity=_d.aoMapIntensity,this.emissive.copy(_d.emissive),this.emissiveMap=_d.emissiveMap,this.emissiveIntensity=_d.emissiveIntensity,this.bumpMap=_d.bumpMap,this.bumpScale=_d.bumpScale,this.normalMap=_d.normalMap,this.normalMapType=_d.normalMapType,this.normalScale.copy(_d.normalScale),this.displacementMap=_d.displacementMap,this.displacementScale=_d.displacementScale,this.displacementBias=_d.displacementBias,this.roughnessMap=_d.roughnessMap,this.metalnessMap=_d.metalnessMap,this.alphaMap=_d.alphaMap,this.envMap=_d.envMap,this.envMapIntensity=_d.envMapIntensity,this.wireframe=_d.wireframe,this.wireframeLinewidth=_d.wireframeLinewidth,this.wireframeLinecap=_d.wireframeLinecap,this.wireframeLinejoin=_d.wireframeLinejoin,this.flatShading=_d.flatShading,this.fog=_d.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(_d){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(np){this.ior=(1+.4*np)/(1-.4*np)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(_d)}get anisotropy(){return this._anisotropy}set anisotropy(_d){this._anisotropy>0!=_d>0&&this.version++,this._anisotropy=_d}get clearcoat(){return this._clearcoat}set clearcoat(_d){this._clearcoat>0!=_d>0&&this.version++,this._clearcoat=_d}get iridescence(){return this._iridescence}set iridescence(_d){this._iridescence>0!=_d>0&&this.version++,this._iridescence=_d}get sheen(){return this._sheen}set sheen(_d){this._sheen>0!=_d>0&&this.version++,this._sheen=_d}get transmission(){return this._transmission}set transmission(_d){this._transmission>0!=_d>0&&this.version++,this._transmission=_d}copy(_d){return super.copy(_d),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=_d.anisotropy,this.anisotropyRotation=_d.anisotropyRotation,this.anisotropyMap=_d.anisotropyMap,this.clearcoat=_d.clearcoat,this.clearcoatMap=_d.clearcoatMap,this.clearcoatRoughness=_d.clearcoatRoughness,this.clearcoatRoughnessMap=_d.clearcoatRoughnessMap,this.clearcoatNormalMap=_d.clearcoatNormalMap,this.clearcoatNormalScale.copy(_d.clearcoatNormalScale),this.ior=_d.ior,this.iridescence=_d.iridescence,this.iridescenceMap=_d.iridescenceMap,this.iridescenceIOR=_d.iridescenceIOR,this.iridescenceThicknessRange=[..._d.iridescenceThicknessRange],this.iridescenceThicknessMap=_d.iridescenceThicknessMap,this.sheen=_d.sheen,this.sheenColor.copy(_d.sheenColor),this.sheenColorMap=_d.sheenColorMap,this.sheenRoughness=_d.sheenRoughness,this.sheenRoughnessMap=_d.sheenRoughnessMap,this.transmission=_d.transmission,this.transmissionMap=_d.transmissionMap,this.thickness=_d.thickness,this.thicknessMap=_d.thicknessMap,this.attenuationDistance=_d.attenuationDistance,this.attenuationColor.copy(_d.attenuationColor),this.specularIntensity=_d.specularIntensity,this.specularIntensityMap=_d.specularIntensityMap,this.specularColor.copy(_d.specularColor),this.specularColorMap=_d.specularColorMap,this}}class MeshPhongMaterial extends Material{constructor(_d){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.color.copy(_d.color),this.specular.copy(_d.specular),this.shininess=_d.shininess,this.map=_d.map,this.lightMap=_d.lightMap,this.lightMapIntensity=_d.lightMapIntensity,this.aoMap=_d.aoMap,this.aoMapIntensity=_d.aoMapIntensity,this.emissive.copy(_d.emissive),this.emissiveMap=_d.emissiveMap,this.emissiveIntensity=_d.emissiveIntensity,this.bumpMap=_d.bumpMap,this.bumpScale=_d.bumpScale,this.normalMap=_d.normalMap,this.normalMapType=_d.normalMapType,this.normalScale.copy(_d.normalScale),this.displacementMap=_d.displacementMap,this.displacementScale=_d.displacementScale,this.displacementBias=_d.displacementBias,this.specularMap=_d.specularMap,this.alphaMap=_d.alphaMap,this.envMap=_d.envMap,this.combine=_d.combine,this.reflectivity=_d.reflectivity,this.refractionRatio=_d.refractionRatio,this.wireframe=_d.wireframe,this.wireframeLinewidth=_d.wireframeLinewidth,this.wireframeLinecap=_d.wireframeLinecap,this.wireframeLinejoin=_d.wireframeLinejoin,this.flatShading=_d.flatShading,this.fog=_d.fog,this}}class MeshToonMaterial extends Material{constructor(_d){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.color.copy(_d.color),this.map=_d.map,this.gradientMap=_d.gradientMap,this.lightMap=_d.lightMap,this.lightMapIntensity=_d.lightMapIntensity,this.aoMap=_d.aoMap,this.aoMapIntensity=_d.aoMapIntensity,this.emissive.copy(_d.emissive),this.emissiveMap=_d.emissiveMap,this.emissiveIntensity=_d.emissiveIntensity,this.bumpMap=_d.bumpMap,this.bumpScale=_d.bumpScale,this.normalMap=_d.normalMap,this.normalMapType=_d.normalMapType,this.normalScale.copy(_d.normalScale),this.displacementMap=_d.displacementMap,this.displacementScale=_d.displacementScale,this.displacementBias=_d.displacementBias,this.alphaMap=_d.alphaMap,this.wireframe=_d.wireframe,this.wireframeLinewidth=_d.wireframeLinewidth,this.wireframeLinecap=_d.wireframeLinecap,this.wireframeLinejoin=_d.wireframeLinejoin,this.fog=_d.fog,this}}class MeshNormalMaterial extends Material{constructor(_d){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_d)}copy(_d){return super.copy(_d),this.bumpMap=_d.bumpMap,this.bumpScale=_d.bumpScale,this.normalMap=_d.normalMap,this.normalMapType=_d.normalMapType,this.normalScale.copy(_d.normalScale),this.displacementMap=_d.displacementMap,this.displacementScale=_d.displacementScale,this.displacementBias=_d.displacementBias,this.wireframe=_d.wireframe,this.wireframeLinewidth=_d.wireframeLinewidth,this.flatShading=_d.flatShading,this}}class MeshLambertMaterial extends Material{constructor(_d){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.color.copy(_d.color),this.map=_d.map,this.lightMap=_d.lightMap,this.lightMapIntensity=_d.lightMapIntensity,this.aoMap=_d.aoMap,this.aoMapIntensity=_d.aoMapIntensity,this.emissive.copy(_d.emissive),this.emissiveMap=_d.emissiveMap,this.emissiveIntensity=_d.emissiveIntensity,this.bumpMap=_d.bumpMap,this.bumpScale=_d.bumpScale,this.normalMap=_d.normalMap,this.normalMapType=_d.normalMapType,this.normalScale.copy(_d.normalScale),this.displacementMap=_d.displacementMap,this.displacementScale=_d.displacementScale,this.displacementBias=_d.displacementBias,this.specularMap=_d.specularMap,this.alphaMap=_d.alphaMap,this.envMap=_d.envMap,this.combine=_d.combine,this.reflectivity=_d.reflectivity,this.refractionRatio=_d.refractionRatio,this.wireframe=_d.wireframe,this.wireframeLinewidth=_d.wireframeLinewidth,this.wireframeLinecap=_d.wireframeLinecap,this.wireframeLinejoin=_d.wireframeLinejoin,this.flatShading=_d.flatShading,this.fog=_d.fog,this}}class MeshMatcapMaterial extends Material{constructor(_d){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_d)}copy(_d){return super.copy(_d),this.defines={MATCAP:""},this.color.copy(_d.color),this.matcap=_d.matcap,this.map=_d.map,this.bumpMap=_d.bumpMap,this.bumpScale=_d.bumpScale,this.normalMap=_d.normalMap,this.normalMapType=_d.normalMapType,this.normalScale.copy(_d.normalScale),this.displacementMap=_d.displacementMap,this.displacementScale=_d.displacementScale,this.displacementBias=_d.displacementBias,this.alphaMap=_d.alphaMap,this.flatShading=_d.flatShading,this.fog=_d.fog,this}}class LineDashedMaterial extends LineBasicMaterial{constructor(_d){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_d)}copy(_d){return super.copy(_d),this.scale=_d.scale,this.dashSize=_d.dashSize,this.gapSize=_d.gapSize,this}}function convertArray(rp,_d,np){return!rp||!np&&rp.constructor===_d?rp:typeof _d.BYTES_PER_ELEMENT=="number"?new _d(rp):Array.prototype.slice.call(rp)}function isTypedArray(rp){return ArrayBuffer.isView(rp)&&!(rp instanceof DataView)}function getKeyframeOrder(rp){function _d(sp,lp){return rp[sp]-rp[lp]}const np=rp.length,ap=new Array(np);for(let sp=0;sp!==np;++sp)ap[sp]=sp;return ap.sort(_d),ap}function sortedArray(rp,_d,np){const ap=rp.length,sp=new rp.constructor(ap);for(let lp=0,up=0;up!==ap;++lp){const cp=np[lp]*_d;for(let dp=0;dp!==_d;++dp)sp[up++]=rp[cp+dp]}return sp}function flattenJSON(rp,_d,np,ap){let sp=1,lp=rp[0];for(;lp!==void 0&&lp[ap]===void 0;)lp=rp[sp++];if(lp===void 0)return;let up=lp[ap];if(up!==void 0)if(Array.isArray(up))do up=lp[ap],up!==void 0&&(_d.push(lp.time),np.push.apply(np,up)),lp=rp[sp++];while(lp!==void 0);else if(up.toArray!==void 0)do up=lp[ap],up!==void 0&&(_d.push(lp.time),up.toArray(np,np.length)),lp=rp[sp++];while(lp!==void 0);else do up=lp[ap],up!==void 0&&(_d.push(lp.time),np.push(up)),lp=rp[sp++];while(lp!==void 0)}function subclip(rp,_d,np,ap,sp=30){const lp=rp.clone();lp.name=_d;const up=[];for(let dp=0;dp<lp.tracks.length;++dp){const hp=lp.tracks[dp],fp=hp.getValueSize(),pp=[],mp=[];for(let gp=0;gp<hp.times.length;++gp){const yp=hp.times[gp]*sp;if(!(yp<np||yp>=ap)){pp.push(hp.times[gp]);for(let xp=0;xp<fp;++xp)mp.push(hp.values[gp*fp+xp])}}pp.length!==0&&(hp.times=convertArray(pp,hp.times.constructor),hp.values=convertArray(mp,hp.values.constructor),up.push(hp))}lp.tracks=up;let cp=1/0;for(let dp=0;dp<lp.tracks.length;++dp)cp>lp.tracks[dp].times[0]&&(cp=lp.tracks[dp].times[0]);for(let dp=0;dp<lp.tracks.length;++dp)lp.tracks[dp].shift(-1*cp);return lp.resetDuration(),lp}function makeClipAdditive(rp,_d=0,np=rp,ap=30){ap<=0&&(ap=30);const sp=np.tracks.length,lp=_d/ap;for(let up=0;up<sp;++up){const cp=np.tracks[up],dp=cp.ValueTypeName;if(dp==="bool"||dp==="string")continue;const hp=rp.tracks.find(function(vp){return vp.name===cp.name&&vp.ValueTypeName===dp});if(hp===void 0)continue;let fp=0;const pp=cp.getValueSize();cp.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(fp=pp/3);let mp=0;const gp=hp.getValueSize();hp.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(mp=gp/3);const yp=cp.times.length-1;let xp;if(lp<=cp.times[0]){const vp=fp,bp=pp-fp;xp=cp.values.slice(vp,bp)}else if(lp>=cp.times[yp]){const vp=yp*pp+fp,bp=vp+pp-fp;xp=cp.values.slice(vp,bp)}else{const vp=cp.createInterpolant(),bp=fp,Ep=pp-fp;vp.evaluate(lp),xp=vp.resultBuffer.slice(bp,Ep)}dp==="quaternion"&&new Quaternion().fromArray(xp).normalize().conjugate().toArray(xp);const _p=hp.times.length;for(let vp=0;vp<_p;++vp){const bp=vp*gp+mp;if(dp==="quaternion")Quaternion.multiplyQuaternionsFlat(hp.values,bp,xp,0,hp.values,bp);else{const Ep=gp-mp*2;for(let Sp=0;Sp<Ep;++Sp)hp.values[bp+Sp]-=xp[Sp]}}}return rp.blendMode=AdditiveAnimationBlendMode,rp}const AnimationUtils={convertArray,isTypedArray,getKeyframeOrder,sortedArray,flattenJSON,subclip,makeClipAdditive};class Interpolant{constructor(_d,np,ap,sp){this.parameterPositions=_d,this._cachedIndex=0,this.resultBuffer=sp!==void 0?sp:new np.constructor(ap),this.sampleValues=np,this.valueSize=ap,this.settings=null,this.DefaultSettings_={}}evaluate(_d){const np=this.parameterPositions;let ap=this._cachedIndex,sp=np[ap],lp=np[ap-1];e:{t:{let up;n:{r:if(!(_d<sp)){for(let cp=ap+2;;){if(sp===void 0){if(_d<lp)break r;return ap=np.length,this._cachedIndex=ap,this.copySampleValue_(ap-1)}if(ap===cp)break;if(lp=sp,sp=np[++ap],_d<sp)break t}up=np.length;break n}if(!(_d>=lp)){const cp=np[1];_d<cp&&(ap=2,lp=cp);for(let dp=ap-2;;){if(lp===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(ap===dp)break;if(sp=lp,lp=np[--ap-1],_d>=lp)break t}up=ap,ap=0;break n}break e}for(;ap<up;){const cp=ap+up>>>1;_d<np[cp]?up=cp:ap=cp+1}if(sp=np[ap],lp=np[ap-1],lp===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(sp===void 0)return ap=np.length,this._cachedIndex=ap,this.copySampleValue_(ap-1)}this._cachedIndex=ap,this.intervalChanged_(ap,lp,sp)}return this.interpolate_(ap,lp,_d,sp)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_d){const np=this.resultBuffer,ap=this.sampleValues,sp=this.valueSize,lp=_d*sp;for(let up=0;up!==sp;++up)np[up]=ap[lp+up];return np}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(_d,np,ap,sp){super(_d,np,ap,sp),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(_d,np,ap){const sp=this.parameterPositions;let lp=_d-2,up=_d+1,cp=sp[lp],dp=sp[up];if(cp===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:lp=_d,cp=2*np-ap;break;case WrapAroundEnding:lp=sp.length-2,cp=np+sp[lp]-sp[lp+1];break;default:lp=_d,cp=ap}if(dp===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:up=_d,dp=2*ap-np;break;case WrapAroundEnding:up=1,dp=ap+sp[1]-sp[0];break;default:up=_d-1,dp=np}const hp=(ap-np)*.5,fp=this.valueSize;this._weightPrev=hp/(np-cp),this._weightNext=hp/(dp-ap),this._offsetPrev=lp*fp,this._offsetNext=up*fp}interpolate_(_d,np,ap,sp){const lp=this.resultBuffer,up=this.sampleValues,cp=this.valueSize,dp=_d*cp,hp=dp-cp,fp=this._offsetPrev,pp=this._offsetNext,mp=this._weightPrev,gp=this._weightNext,yp=(ap-np)/(sp-np),xp=yp*yp,_p=xp*yp,vp=-mp*_p+2*mp*xp-mp*yp,bp=(1+mp)*_p+(-1.5-2*mp)*xp+(-.5+mp)*yp+1,Ep=(-1-gp)*_p+(1.5+gp)*xp+.5*yp,Sp=gp*_p-gp*xp;for(let Ap=0;Ap!==cp;++Ap)lp[Ap]=vp*up[fp+Ap]+bp*up[hp+Ap]+Ep*up[dp+Ap]+Sp*up[pp+Ap];return lp}}class LinearInterpolant extends Interpolant{constructor(_d,np,ap,sp){super(_d,np,ap,sp)}interpolate_(_d,np,ap,sp){const lp=this.resultBuffer,up=this.sampleValues,cp=this.valueSize,dp=_d*cp,hp=dp-cp,fp=(ap-np)/(sp-np),pp=1-fp;for(let mp=0;mp!==cp;++mp)lp[mp]=up[hp+mp]*pp+up[dp+mp]*fp;return lp}}class DiscreteInterpolant extends Interpolant{constructor(_d,np,ap,sp){super(_d,np,ap,sp)}interpolate_(_d){return this.copySampleValue_(_d-1)}}class KeyframeTrack{constructor(_d,np,ap,sp){if(_d===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(np===void 0||np.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_d);this.name=_d,this.times=convertArray(np,this.TimeBufferType),this.values=convertArray(ap,this.ValueBufferType),this.setInterpolation(sp||this.DefaultInterpolation)}static toJSON(_d){const np=_d.constructor;let ap;if(np.toJSON!==this.toJSON)ap=np.toJSON(_d);else{ap={name:_d.name,times:convertArray(_d.times,Array),values:convertArray(_d.values,Array)};const sp=_d.getInterpolation();sp!==_d.DefaultInterpolation&&(ap.interpolation=sp)}return ap.type=_d.ValueTypeName,ap}InterpolantFactoryMethodDiscrete(_d){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),_d)}InterpolantFactoryMethodLinear(_d){return new LinearInterpolant(this.times,this.values,this.getValueSize(),_d)}InterpolantFactoryMethodSmooth(_d){return new CubicInterpolant(this.times,this.values,this.getValueSize(),_d)}setInterpolation(_d){let np;switch(_d){case InterpolateDiscrete:np=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:np=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:np=this.InterpolantFactoryMethodSmooth;break}if(np===void 0){const ap="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(_d!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(ap);return console.warn("THREE.KeyframeTrack:",ap),this}return this.createInterpolant=np,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(_d){if(_d!==0){const np=this.times;for(let ap=0,sp=np.length;ap!==sp;++ap)np[ap]+=_d}return this}scale(_d){if(_d!==1){const np=this.times;for(let ap=0,sp=np.length;ap!==sp;++ap)np[ap]*=_d}return this}trim(_d,np){const ap=this.times,sp=ap.length;let lp=0,up=sp-1;for(;lp!==sp&&ap[lp]<_d;)++lp;for(;up!==-1&&ap[up]>np;)--up;if(++up,lp!==0||up!==sp){lp>=up&&(up=Math.max(up,1),lp=up-1);const cp=this.getValueSize();this.times=ap.slice(lp,up),this.values=this.values.slice(lp*cp,up*cp)}return this}validate(){let _d=!0;const np=this.getValueSize();np-Math.floor(np)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_d=!1);const ap=this.times,sp=this.values,lp=ap.length;lp===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_d=!1);let up=null;for(let cp=0;cp!==lp;cp++){const dp=ap[cp];if(typeof dp=="number"&&isNaN(dp)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,cp,dp),_d=!1;break}if(up!==null&&up>dp){console.error("THREE.KeyframeTrack: Out of order keys.",this,cp,dp,up),_d=!1;break}up=dp}if(sp!==void 0&&isTypedArray(sp))for(let cp=0,dp=sp.length;cp!==dp;++cp){const hp=sp[cp];if(isNaN(hp)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,cp,hp),_d=!1;break}}return _d}optimize(){const _d=this.times.slice(),np=this.values.slice(),ap=this.getValueSize(),sp=this.getInterpolation()===InterpolateSmooth,lp=_d.length-1;let up=1;for(let cp=1;cp<lp;++cp){let dp=!1;const hp=_d[cp],fp=_d[cp+1];if(hp!==fp&&(cp!==1||hp!==_d[0]))if(sp)dp=!0;else{const pp=cp*ap,mp=pp-ap,gp=pp+ap;for(let yp=0;yp!==ap;++yp){const xp=np[pp+yp];if(xp!==np[mp+yp]||xp!==np[gp+yp]){dp=!0;break}}}if(dp){if(cp!==up){_d[up]=_d[cp];const pp=cp*ap,mp=up*ap;for(let gp=0;gp!==ap;++gp)np[mp+gp]=np[pp+gp]}++up}}if(lp>0){_d[up]=_d[lp];for(let cp=lp*ap,dp=up*ap,hp=0;hp!==ap;++hp)np[dp+hp]=np[cp+hp];++up}return up!==_d.length?(this.times=_d.slice(0,up),this.values=np.slice(0,up*ap)):(this.times=_d,this.values=np),this}clone(){const _d=this.times.slice(),np=this.values.slice(),ap=this.constructor,sp=new ap(this.name,_d,np);return sp.createInterpolant=this.createInterpolant,sp}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(_d,np,ap,sp){super(_d,np,ap,sp)}interpolate_(_d,np,ap,sp){const lp=this.resultBuffer,up=this.sampleValues,cp=this.valueSize,dp=(ap-np)/(sp-np);let hp=_d*cp;for(let fp=hp+cp;hp!==fp;hp+=4)Quaternion.slerpFlat(lp,0,up,hp-cp,up,hp,dp);return lp}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(_d){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),_d)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(_d,np=-1,ap,sp=NormalAnimationBlendMode){this.name=_d,this.tracks=ap,this.duration=np,this.blendMode=sp,this.uuid=generateUUID(),this.duration<0&&this.resetDuration()}static parse(_d){const np=[],ap=_d.tracks,sp=1/(_d.fps||1);for(let up=0,cp=ap.length;up!==cp;++up)np.push(parseKeyframeTrack(ap[up]).scale(sp));const lp=new this(_d.name,_d.duration,np,_d.blendMode);return lp.uuid=_d.uuid,lp}static toJSON(_d){const np=[],ap=_d.tracks,sp={name:_d.name,duration:_d.duration,tracks:np,uuid:_d.uuid,blendMode:_d.blendMode};for(let lp=0,up=ap.length;lp!==up;++lp)np.push(KeyframeTrack.toJSON(ap[lp]));return sp}static CreateFromMorphTargetSequence(_d,np,ap,sp){const lp=np.length,up=[];for(let cp=0;cp<lp;cp++){let dp=[],hp=[];dp.push((cp+lp-1)%lp,cp,(cp+1)%lp),hp.push(0,1,0);const fp=getKeyframeOrder(dp);dp=sortedArray(dp,1,fp),hp=sortedArray(hp,1,fp),!sp&&dp[0]===0&&(dp.push(lp),hp.push(hp[0])),up.push(new NumberKeyframeTrack(".morphTargetInfluences["+np[cp].name+"]",dp,hp).scale(1/ap))}return new this(_d,-1,up)}static findByName(_d,np){let ap=_d;if(!Array.isArray(_d)){const sp=_d;ap=sp.geometry&&sp.geometry.animations||sp.animations}for(let sp=0;sp<ap.length;sp++)if(ap[sp].name===np)return ap[sp];return null}static CreateClipsFromMorphTargetSequences(_d,np,ap){const sp={},lp=/^([\w-]*?)([\d]+)$/;for(let cp=0,dp=_d.length;cp<dp;cp++){const hp=_d[cp],fp=hp.name.match(lp);if(fp&&fp.length>1){const pp=fp[1];let mp=sp[pp];mp||(sp[pp]=mp=[]),mp.push(hp)}}const up=[];for(const cp in sp)up.push(this.CreateFromMorphTargetSequence(cp,sp[cp],np,ap));return up}static parseAnimation(_d,np){if(!_d)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const ap=function(pp,mp,gp,yp,xp){if(gp.length!==0){const _p=[],vp=[];flattenJSON(gp,_p,vp,yp),_p.length!==0&&xp.push(new pp(mp,_p,vp))}},sp=[],lp=_d.name||"default",up=_d.fps||30,cp=_d.blendMode;let dp=_d.length||-1;const hp=_d.hierarchy||[];for(let pp=0;pp<hp.length;pp++){const mp=hp[pp].keys;if(!(!mp||mp.length===0))if(mp[0].morphTargets){const gp={};let yp;for(yp=0;yp<mp.length;yp++)if(mp[yp].morphTargets)for(let xp=0;xp<mp[yp].morphTargets.length;xp++)gp[mp[yp].morphTargets[xp]]=-1;for(const xp in gp){const _p=[],vp=[];for(let bp=0;bp!==mp[yp].morphTargets.length;++bp){const Ep=mp[yp];_p.push(Ep.time),vp.push(Ep.morphTarget===xp?1:0)}sp.push(new NumberKeyframeTrack(".morphTargetInfluence["+xp+"]",_p,vp))}dp=gp.length*up}else{const gp=".bones["+np[pp].name+"]";ap(VectorKeyframeTrack,gp+".position",mp,"pos",sp),ap(QuaternionKeyframeTrack,gp+".quaternion",mp,"rot",sp),ap(VectorKeyframeTrack,gp+".scale",mp,"scl",sp)}}return sp.length===0?null:new this(lp,dp,sp,cp)}resetDuration(){const _d=this.tracks;let np=0;for(let ap=0,sp=_d.length;ap!==sp;++ap){const lp=this.tracks[ap];np=Math.max(np,lp.times[lp.times.length-1])}return this.duration=np,this}trim(){for(let _d=0;_d<this.tracks.length;_d++)this.tracks[_d].trim(0,this.duration);return this}validate(){let _d=!0;for(let np=0;np<this.tracks.length;np++)_d=_d&&this.tracks[np].validate();return _d}optimize(){for(let _d=0;_d<this.tracks.length;_d++)this.tracks[_d].optimize();return this}clone(){const _d=[];for(let np=0;np<this.tracks.length;np++)_d.push(this.tracks[np].clone());return new this.constructor(this.name,this.duration,_d,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(rp){switch(rp.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+rp)}function parseKeyframeTrack(rp){if(rp.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _d=getTrackTypeForValueTypeName(rp.type);if(rp.times===void 0){const np=[],ap=[];flattenJSON(rp.keys,np,ap,"value"),rp.times=np,rp.values=ap}return _d.parse!==void 0?_d.parse(rp):new _d(rp.name,rp.times,rp.values,rp.interpolation)}const Cache={enabled:!1,files:{},add:function(rp,_d){this.enabled!==!1&&(this.files[rp]=_d)},get:function(rp){if(this.enabled!==!1)return this.files[rp]},remove:function(rp){delete this.files[rp]},clear:function(){this.files={}}};class LoadingManager{constructor(_d,np,ap){const sp=this;let lp=!1,up=0,cp=0,dp;const hp=[];this.onStart=void 0,this.onLoad=_d,this.onProgress=np,this.onError=ap,this.itemStart=function(fp){cp++,lp===!1&&sp.onStart!==void 0&&sp.onStart(fp,up,cp),lp=!0},this.itemEnd=function(fp){up++,sp.onProgress!==void 0&&sp.onProgress(fp,up,cp),up===cp&&(lp=!1,sp.onLoad!==void 0&&sp.onLoad())},this.itemError=function(fp){sp.onError!==void 0&&sp.onError(fp)},this.resolveURL=function(fp){return dp?dp(fp):fp},this.setURLModifier=function(fp){return dp=fp,this},this.addHandler=function(fp,pp){return hp.push(fp,pp),this},this.removeHandler=function(fp){const pp=hp.indexOf(fp);return pp!==-1&&hp.splice(pp,2),this},this.getHandler=function(fp){for(let pp=0,mp=hp.length;pp<mp;pp+=2){const gp=hp[pp],yp=hp[pp+1];if(gp.global&&(gp.lastIndex=0),gp.test(fp))return yp}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(_d){this.manager=_d!==void 0?_d:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_d,np){const ap=this;return new Promise(function(sp,lp){ap.load(_d,sp,np,lp)})}parse(){}setCrossOrigin(_d){return this.crossOrigin=_d,this}setWithCredentials(_d){return this.withCredentials=_d,this}setPath(_d){return this.path=_d,this}setResourcePath(_d){return this.resourcePath=_d,this}setRequestHeader(_d){return this.requestHeader=_d,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(_d,np){super(_d),this.response=np}}class FileLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){_d===void 0&&(_d=""),this.path!==void 0&&(_d=this.path+_d),_d=this.manager.resolveURL(_d);const lp=Cache.get(_d);if(lp!==void 0)return this.manager.itemStart(_d),setTimeout(()=>{np&&np(lp),this.manager.itemEnd(_d)},0),lp;if(loading[_d]!==void 0){loading[_d].push({onLoad:np,onProgress:ap,onError:sp});return}loading[_d]=[],loading[_d].push({onLoad:np,onProgress:ap,onError:sp});const up=new Request(_d,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),cp=this.mimeType,dp=this.responseType;fetch(up).then(hp=>{if(hp.status===200||hp.status===0){if(hp.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||hp.body===void 0||hp.body.getReader===void 0)return hp;const fp=loading[_d],pp=hp.body.getReader(),mp=hp.headers.get("Content-Length")||hp.headers.get("X-File-Size"),gp=mp?parseInt(mp):0,yp=gp!==0;let xp=0;const _p=new ReadableStream({start(vp){bp();function bp(){pp.read().then(({done:Ep,value:Sp})=>{if(Ep)vp.close();else{xp+=Sp.byteLength;const Ap=new ProgressEvent("progress",{lengthComputable:yp,loaded:xp,total:gp});for(let Rp=0,Tp=fp.length;Rp<Tp;Rp++){const Mp=fp[Rp];Mp.onProgress&&Mp.onProgress(Ap)}vp.enqueue(Sp),bp()}})}}});return new Response(_p)}else throw new HttpError(`fetch for "${hp.url}" responded with ${hp.status}: ${hp.statusText}`,hp)}).then(hp=>{switch(dp){case"arraybuffer":return hp.arrayBuffer();case"blob":return hp.blob();case"document":return hp.text().then(fp=>new DOMParser().parseFromString(fp,cp));case"json":return hp.json();default:if(cp===void 0)return hp.text();{const pp=/charset="?([^;"\s]*)"?/i.exec(cp),mp=pp&&pp[1]?pp[1].toLowerCase():void 0,gp=new TextDecoder(mp);return hp.arrayBuffer().then(yp=>gp.decode(yp))}}}).then(hp=>{Cache.add(_d,hp);const fp=loading[_d];delete loading[_d];for(let pp=0,mp=fp.length;pp<mp;pp++){const gp=fp[pp];gp.onLoad&&gp.onLoad(hp)}}).catch(hp=>{const fp=loading[_d];if(fp===void 0)throw this.manager.itemError(_d),hp;delete loading[_d];for(let pp=0,mp=fp.length;pp<mp;pp++){const gp=fp[pp];gp.onError&&gp.onError(hp)}this.manager.itemError(_d)}).finally(()=>{this.manager.itemEnd(_d)}),this.manager.itemStart(_d)}setResponseType(_d){return this.responseType=_d,this}setMimeType(_d){return this.mimeType=_d,this}}class AnimationLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){const lp=this,up=new FileLoader(this.manager);up.setPath(this.path),up.setRequestHeader(this.requestHeader),up.setWithCredentials(this.withCredentials),up.load(_d,function(cp){try{np(lp.parse(JSON.parse(cp)))}catch(dp){sp?sp(dp):console.error(dp),lp.manager.itemError(_d)}},ap,sp)}parse(_d){const np=[];for(let ap=0;ap<_d.length;ap++){const sp=AnimationClip.parse(_d[ap]);np.push(sp)}return np}}class CompressedTextureLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){const lp=this,up=[],cp=new CompressedTexture,dp=new FileLoader(this.manager);dp.setPath(this.path),dp.setResponseType("arraybuffer"),dp.setRequestHeader(this.requestHeader),dp.setWithCredentials(lp.withCredentials);let hp=0;function fp(pp){dp.load(_d[pp],function(mp){const gp=lp.parse(mp,!0);up[pp]={width:gp.width,height:gp.height,format:gp.format,mipmaps:gp.mipmaps},hp+=1,hp===6&&(gp.mipmapCount===1&&(cp.minFilter=LinearFilter),cp.image=up,cp.format=gp.format,cp.needsUpdate=!0,np&&np(cp))},ap,sp)}if(Array.isArray(_d))for(let pp=0,mp=_d.length;pp<mp;++pp)fp(pp);else dp.load(_d,function(pp){const mp=lp.parse(pp,!0);if(mp.isCubemap){const gp=mp.mipmaps.length/mp.mipmapCount;for(let yp=0;yp<gp;yp++){up[yp]={mipmaps:[]};for(let xp=0;xp<mp.mipmapCount;xp++)up[yp].mipmaps.push(mp.mipmaps[yp*mp.mipmapCount+xp]),up[yp].format=mp.format,up[yp].width=mp.width,up[yp].height=mp.height}cp.image=up}else cp.image.width=mp.width,cp.image.height=mp.height,cp.mipmaps=mp.mipmaps;mp.mipmapCount===1&&(cp.minFilter=LinearFilter),cp.format=mp.format,cp.needsUpdate=!0,np&&np(cp)},ap,sp);return cp}}class ImageLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){this.path!==void 0&&(_d=this.path+_d),_d=this.manager.resolveURL(_d);const lp=this,up=Cache.get(_d);if(up!==void 0)return lp.manager.itemStart(_d),setTimeout(function(){np&&np(up),lp.manager.itemEnd(_d)},0),up;const cp=createElementNS("img");function dp(){fp(),Cache.add(_d,this),np&&np(this),lp.manager.itemEnd(_d)}function hp(pp){fp(),sp&&sp(pp),lp.manager.itemError(_d),lp.manager.itemEnd(_d)}function fp(){cp.removeEventListener("load",dp,!1),cp.removeEventListener("error",hp,!1)}return cp.addEventListener("load",dp,!1),cp.addEventListener("error",hp,!1),_d.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(cp.crossOrigin=this.crossOrigin),lp.manager.itemStart(_d),cp.src=_d,cp}}class CubeTextureLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){const lp=new CubeTexture;lp.colorSpace=SRGBColorSpace$1;const up=new ImageLoader(this.manager);up.setCrossOrigin(this.crossOrigin),up.setPath(this.path);let cp=0;function dp(hp){up.load(_d[hp],function(fp){lp.images[hp]=fp,cp++,cp===6&&(lp.needsUpdate=!0,np&&np(lp))},void 0,sp)}for(let hp=0;hp<_d.length;++hp)dp(hp);return lp}}class DataTextureLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){const lp=this,up=new DataTexture,cp=new FileLoader(this.manager);return cp.setResponseType("arraybuffer"),cp.setRequestHeader(this.requestHeader),cp.setPath(this.path),cp.setWithCredentials(lp.withCredentials),cp.load(_d,function(dp){let hp;try{hp=lp.parse(dp)}catch(fp){if(sp!==void 0)sp(fp);else{console.error(fp);return}}hp.image!==void 0?up.image=hp.image:hp.data!==void 0&&(up.image.width=hp.width,up.image.height=hp.height,up.image.data=hp.data),up.wrapS=hp.wrapS!==void 0?hp.wrapS:ClampToEdgeWrapping,up.wrapT=hp.wrapT!==void 0?hp.wrapT:ClampToEdgeWrapping,up.magFilter=hp.magFilter!==void 0?hp.magFilter:LinearFilter,up.minFilter=hp.minFilter!==void 0?hp.minFilter:LinearFilter,up.anisotropy=hp.anisotropy!==void 0?hp.anisotropy:1,hp.colorSpace!==void 0?up.colorSpace=hp.colorSpace:hp.encoding!==void 0&&(up.encoding=hp.encoding),hp.flipY!==void 0&&(up.flipY=hp.flipY),hp.format!==void 0&&(up.format=hp.format),hp.type!==void 0&&(up.type=hp.type),hp.mipmaps!==void 0&&(up.mipmaps=hp.mipmaps,up.minFilter=LinearMipmapLinearFilter),hp.mipmapCount===1&&(up.minFilter=LinearFilter),hp.generateMipmaps!==void 0&&(up.generateMipmaps=hp.generateMipmaps),up.needsUpdate=!0,np&&np(up,hp)},ap,sp),up}}class TextureLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){const lp=new Texture,up=new ImageLoader(this.manager);return up.setCrossOrigin(this.crossOrigin),up.setPath(this.path),up.load(_d,function(cp){lp.image=cp,lp.needsUpdate=!0,np!==void 0&&np(lp)},ap,sp),lp}}class Light extends Object3D{constructor(_d,np=1){super(),this.isLight=!0,this.type="Light",this.color=new Color(_d),this.intensity=np}dispose(){}copy(_d,np){return super.copy(_d,np),this.color.copy(_d.color),this.intensity=_d.intensity,this}toJSON(_d){const np=super.toJSON(_d);return np.object.color=this.color.getHex(),np.object.intensity=this.intensity,this.groundColor!==void 0&&(np.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(np.object.distance=this.distance),this.angle!==void 0&&(np.object.angle=this.angle),this.decay!==void 0&&(np.object.decay=this.decay),this.penumbra!==void 0&&(np.object.penumbra=this.penumbra),this.shadow!==void 0&&(np.object.shadow=this.shadow.toJSON()),np}}class HemisphereLight extends Light{constructor(_d,np,ap){super(_d,ap),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color(np)}copy(_d,np){return super.copy(_d,np),this.groundColor.copy(_d.groundColor),this}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(_d){this.camera=_d,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_d){const np=this.camera,ap=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(_d.matrixWorld),np.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(_d.target.matrixWorld),np.lookAt(_lookTarget$1),np.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(np.projectionMatrix,np.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),ap.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),ap.multiply(_projScreenMatrix$1)}getViewport(_d){return this._viewports[_d]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_d){return this.camera=_d.camera.clone(),this.bias=_d.bias,this.radius=_d.radius,this.mapSize.copy(_d.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _d={};return this.bias!==0&&(_d.bias=this.bias),this.normalBias!==0&&(_d.normalBias=this.normalBias),this.radius!==1&&(_d.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_d.mapSize=this.mapSize.toArray()),_d.camera=this.camera.toJSON(!1).object,delete _d.camera.matrix,_d}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera$1(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_d){const np=this.camera,ap=RAD2DEG*2*_d.angle*this.focus,sp=this.mapSize.width/this.mapSize.height,lp=_d.distance||np.far;(ap!==np.fov||sp!==np.aspect||lp!==np.far)&&(np.fov=ap,np.aspect=sp,np.far=lp,np.updateProjectionMatrix()),super.updateMatrices(_d)}copy(_d){return super.copy(_d),this.focus=_d.focus,this}}class SpotLight extends Light{constructor(_d,np,ap=0,sp=Math.PI/3,lp=0,up=2){super(_d,np),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=ap,this.angle=sp,this.penumbra=lp,this.decay=up,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(_d){this.intensity=_d/Math.PI}dispose(){this.shadow.dispose()}copy(_d,np){return super.copy(_d,np),this.distance=_d.distance,this.angle=_d.angle,this.penumbra=_d.penumbra,this.decay=_d.decay,this.target=_d.target.clone(),this.shadow=_d.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera$1(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(_d,np=0){const ap=this.camera,sp=this.matrix,lp=_d.distance||ap.far;lp!==ap.far&&(ap.far=lp,ap.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(_d.matrixWorld),ap.position.copy(_lightPositionWorld),_lookTarget.copy(ap.position),_lookTarget.add(this._cubeDirections[np]),ap.up.copy(this._cubeUps[np]),ap.lookAt(_lookTarget),ap.updateMatrixWorld(),sp.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(ap.projectionMatrix,ap.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(_d,np,ap=0,sp=2){super(_d,np),this.isPointLight=!0,this.type="PointLight",this.distance=ap,this.decay=sp,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(_d){this.intensity=_d/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_d,np){return super.copy(_d,np),this.distance=_d.distance,this.decay=_d.decay,this.shadow=_d.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(_d,np){super(_d,np),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(_d){return super.copy(_d),this.target=_d.target.clone(),this.shadow=_d.shadow.clone(),this}}class AmbientLight extends Light{constructor(_d,np){super(_d,np),this.isAmbientLight=!0,this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(_d,np,ap=10,sp=10){super(_d,np),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=ap,this.height=sp}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_d){this.intensity=_d/(this.width*this.height*Math.PI)}copy(_d){return super.copy(_d),this.width=_d.width,this.height=_d.height,this}toJSON(_d){const np=super.toJSON(_d);return np.object.width=this.width,np.object.height=this.height,np}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _d=0;_d<9;_d++)this.coefficients.push(new Vector3)}set(_d){for(let np=0;np<9;np++)this.coefficients[np].copy(_d[np]);return this}zero(){for(let _d=0;_d<9;_d++)this.coefficients[_d].set(0,0,0);return this}getAt(_d,np){const ap=_d.x,sp=_d.y,lp=_d.z,up=this.coefficients;return np.copy(up[0]).multiplyScalar(.282095),np.addScaledVector(up[1],.488603*sp),np.addScaledVector(up[2],.488603*lp),np.addScaledVector(up[3],.488603*ap),np.addScaledVector(up[4],1.092548*(ap*sp)),np.addScaledVector(up[5],1.092548*(sp*lp)),np.addScaledVector(up[6],.315392*(3*lp*lp-1)),np.addScaledVector(up[7],1.092548*(ap*lp)),np.addScaledVector(up[8],.546274*(ap*ap-sp*sp)),np}getIrradianceAt(_d,np){const ap=_d.x,sp=_d.y,lp=_d.z,up=this.coefficients;return np.copy(up[0]).multiplyScalar(.886227),np.addScaledVector(up[1],2*.511664*sp),np.addScaledVector(up[2],2*.511664*lp),np.addScaledVector(up[3],2*.511664*ap),np.addScaledVector(up[4],2*.429043*ap*sp),np.addScaledVector(up[5],2*.429043*sp*lp),np.addScaledVector(up[6],.743125*lp*lp-.247708),np.addScaledVector(up[7],2*.429043*ap*lp),np.addScaledVector(up[8],.429043*(ap*ap-sp*sp)),np}add(_d){for(let np=0;np<9;np++)this.coefficients[np].add(_d.coefficients[np]);return this}addScaledSH(_d,np){for(let ap=0;ap<9;ap++)this.coefficients[ap].addScaledVector(_d.coefficients[ap],np);return this}scale(_d){for(let np=0;np<9;np++)this.coefficients[np].multiplyScalar(_d);return this}lerp(_d,np){for(let ap=0;ap<9;ap++)this.coefficients[ap].lerp(_d.coefficients[ap],np);return this}equals(_d){for(let np=0;np<9;np++)if(!this.coefficients[np].equals(_d.coefficients[np]))return!1;return!0}copy(_d){return this.set(_d.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_d,np=0){const ap=this.coefficients;for(let sp=0;sp<9;sp++)ap[sp].fromArray(_d,np+sp*3);return this}toArray(_d=[],np=0){const ap=this.coefficients;for(let sp=0;sp<9;sp++)ap[sp].toArray(_d,np+sp*3);return _d}static getBasisAt(_d,np){const ap=_d.x,sp=_d.y,lp=_d.z;np[0]=.282095,np[1]=.488603*sp,np[2]=.488603*lp,np[3]=.488603*ap,np[4]=1.092548*ap*sp,np[5]=1.092548*sp*lp,np[6]=.315392*(3*lp*lp-1),np[7]=1.092548*ap*lp,np[8]=.546274*(ap*ap-sp*sp)}}class LightProbe extends Light{constructor(_d=new SphericalHarmonics3,np=1){super(void 0,np),this.isLightProbe=!0,this.sh=_d}copy(_d){return super.copy(_d),this.sh.copy(_d.sh),this}fromJSON(_d){return this.intensity=_d.intensity,this.sh.fromArray(_d.sh),this}toJSON(_d){const np=super.toJSON(_d);return np.object.sh=this.sh.toArray(),np}}class MaterialLoader extends Loader{constructor(_d){super(_d),this.textures={}}load(_d,np,ap,sp){const lp=this,up=new FileLoader(lp.manager);up.setPath(lp.path),up.setRequestHeader(lp.requestHeader),up.setWithCredentials(lp.withCredentials),up.load(_d,function(cp){try{np(lp.parse(JSON.parse(cp)))}catch(dp){sp?sp(dp):console.error(dp),lp.manager.itemError(_d)}},ap,sp)}parse(_d){const np=this.textures;function ap(lp){return np[lp]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",lp),np[lp]}const sp=MaterialLoader.createMaterialFromType(_d.type);if(_d.uuid!==void 0&&(sp.uuid=_d.uuid),_d.name!==void 0&&(sp.name=_d.name),_d.color!==void 0&&sp.color!==void 0&&sp.color.setHex(_d.color),_d.roughness!==void 0&&(sp.roughness=_d.roughness),_d.metalness!==void 0&&(sp.metalness=_d.metalness),_d.sheen!==void 0&&(sp.sheen=_d.sheen),_d.sheenColor!==void 0&&(sp.sheenColor=new Color().setHex(_d.sheenColor)),_d.sheenRoughness!==void 0&&(sp.sheenRoughness=_d.sheenRoughness),_d.emissive!==void 0&&sp.emissive!==void 0&&sp.emissive.setHex(_d.emissive),_d.specular!==void 0&&sp.specular!==void 0&&sp.specular.setHex(_d.specular),_d.specularIntensity!==void 0&&(sp.specularIntensity=_d.specularIntensity),_d.specularColor!==void 0&&sp.specularColor!==void 0&&sp.specularColor.setHex(_d.specularColor),_d.shininess!==void 0&&(sp.shininess=_d.shininess),_d.clearcoat!==void 0&&(sp.clearcoat=_d.clearcoat),_d.clearcoatRoughness!==void 0&&(sp.clearcoatRoughness=_d.clearcoatRoughness),_d.iridescence!==void 0&&(sp.iridescence=_d.iridescence),_d.iridescenceIOR!==void 0&&(sp.iridescenceIOR=_d.iridescenceIOR),_d.iridescenceThicknessRange!==void 0&&(sp.iridescenceThicknessRange=_d.iridescenceThicknessRange),_d.transmission!==void 0&&(sp.transmission=_d.transmission),_d.thickness!==void 0&&(sp.thickness=_d.thickness),_d.attenuationDistance!==void 0&&(sp.attenuationDistance=_d.attenuationDistance),_d.attenuationColor!==void 0&&sp.attenuationColor!==void 0&&sp.attenuationColor.setHex(_d.attenuationColor),_d.anisotropy!==void 0&&(sp.anisotropy=_d.anisotropy),_d.anisotropyRotation!==void 0&&(sp.anisotropyRotation=_d.anisotropyRotation),_d.fog!==void 0&&(sp.fog=_d.fog),_d.flatShading!==void 0&&(sp.flatShading=_d.flatShading),_d.blending!==void 0&&(sp.blending=_d.blending),_d.combine!==void 0&&(sp.combine=_d.combine),_d.side!==void 0&&(sp.side=_d.side),_d.shadowSide!==void 0&&(sp.shadowSide=_d.shadowSide),_d.opacity!==void 0&&(sp.opacity=_d.opacity),_d.transparent!==void 0&&(sp.transparent=_d.transparent),_d.alphaTest!==void 0&&(sp.alphaTest=_d.alphaTest),_d.alphaHash!==void 0&&(sp.alphaHash=_d.alphaHash),_d.depthFunc!==void 0&&(sp.depthFunc=_d.depthFunc),_d.depthTest!==void 0&&(sp.depthTest=_d.depthTest),_d.depthWrite!==void 0&&(sp.depthWrite=_d.depthWrite),_d.colorWrite!==void 0&&(sp.colorWrite=_d.colorWrite),_d.blendSrc!==void 0&&(sp.blendSrc=_d.blendSrc),_d.blendDst!==void 0&&(sp.blendDst=_d.blendDst),_d.blendEquation!==void 0&&(sp.blendEquation=_d.blendEquation),_d.blendSrcAlpha!==void 0&&(sp.blendSrcAlpha=_d.blendSrcAlpha),_d.blendDstAlpha!==void 0&&(sp.blendDstAlpha=_d.blendDstAlpha),_d.blendEquationAlpha!==void 0&&(sp.blendEquationAlpha=_d.blendEquationAlpha),_d.blendColor!==void 0&&sp.blendColor!==void 0&&sp.blendColor.setHex(_d.blendColor),_d.blendAlpha!==void 0&&(sp.blendAlpha=_d.blendAlpha),_d.stencilWriteMask!==void 0&&(sp.stencilWriteMask=_d.stencilWriteMask),_d.stencilFunc!==void 0&&(sp.stencilFunc=_d.stencilFunc),_d.stencilRef!==void 0&&(sp.stencilRef=_d.stencilRef),_d.stencilFuncMask!==void 0&&(sp.stencilFuncMask=_d.stencilFuncMask),_d.stencilFail!==void 0&&(sp.stencilFail=_d.stencilFail),_d.stencilZFail!==void 0&&(sp.stencilZFail=_d.stencilZFail),_d.stencilZPass!==void 0&&(sp.stencilZPass=_d.stencilZPass),_d.stencilWrite!==void 0&&(sp.stencilWrite=_d.stencilWrite),_d.wireframe!==void 0&&(sp.wireframe=_d.wireframe),_d.wireframeLinewidth!==void 0&&(sp.wireframeLinewidth=_d.wireframeLinewidth),_d.wireframeLinecap!==void 0&&(sp.wireframeLinecap=_d.wireframeLinecap),_d.wireframeLinejoin!==void 0&&(sp.wireframeLinejoin=_d.wireframeLinejoin),_d.rotation!==void 0&&(sp.rotation=_d.rotation),_d.linewidth!==void 0&&(sp.linewidth=_d.linewidth),_d.dashSize!==void 0&&(sp.dashSize=_d.dashSize),_d.gapSize!==void 0&&(sp.gapSize=_d.gapSize),_d.scale!==void 0&&(sp.scale=_d.scale),_d.polygonOffset!==void 0&&(sp.polygonOffset=_d.polygonOffset),_d.polygonOffsetFactor!==void 0&&(sp.polygonOffsetFactor=_d.polygonOffsetFactor),_d.polygonOffsetUnits!==void 0&&(sp.polygonOffsetUnits=_d.polygonOffsetUnits),_d.dithering!==void 0&&(sp.dithering=_d.dithering),_d.alphaToCoverage!==void 0&&(sp.alphaToCoverage=_d.alphaToCoverage),_d.premultipliedAlpha!==void 0&&(sp.premultipliedAlpha=_d.premultipliedAlpha),_d.forceSinglePass!==void 0&&(sp.forceSinglePass=_d.forceSinglePass),_d.visible!==void 0&&(sp.visible=_d.visible),_d.toneMapped!==void 0&&(sp.toneMapped=_d.toneMapped),_d.userData!==void 0&&(sp.userData=_d.userData),_d.vertexColors!==void 0&&(typeof _d.vertexColors=="number"?sp.vertexColors=_d.vertexColors>0:sp.vertexColors=_d.vertexColors),_d.uniforms!==void 0)for(const lp in _d.uniforms){const up=_d.uniforms[lp];switch(sp.uniforms[lp]={},up.type){case"t":sp.uniforms[lp].value=ap(up.value);break;case"c":sp.uniforms[lp].value=new Color().setHex(up.value);break;case"v2":sp.uniforms[lp].value=new Vector2().fromArray(up.value);break;case"v3":sp.uniforms[lp].value=new Vector3().fromArray(up.value);break;case"v4":sp.uniforms[lp].value=new Vector4().fromArray(up.value);break;case"m3":sp.uniforms[lp].value=new Matrix3().fromArray(up.value);break;case"m4":sp.uniforms[lp].value=new Matrix4().fromArray(up.value);break;default:sp.uniforms[lp].value=up.value}}if(_d.defines!==void 0&&(sp.defines=_d.defines),_d.vertexShader!==void 0&&(sp.vertexShader=_d.vertexShader),_d.fragmentShader!==void 0&&(sp.fragmentShader=_d.fragmentShader),_d.glslVersion!==void 0&&(sp.glslVersion=_d.glslVersion),_d.extensions!==void 0)for(const lp in _d.extensions)sp.extensions[lp]=_d.extensions[lp];if(_d.lights!==void 0&&(sp.lights=_d.lights),_d.clipping!==void 0&&(sp.clipping=_d.clipping),_d.size!==void 0&&(sp.size=_d.size),_d.sizeAttenuation!==void 0&&(sp.sizeAttenuation=_d.sizeAttenuation),_d.map!==void 0&&(sp.map=ap(_d.map)),_d.matcap!==void 0&&(sp.matcap=ap(_d.matcap)),_d.alphaMap!==void 0&&(sp.alphaMap=ap(_d.alphaMap)),_d.bumpMap!==void 0&&(sp.bumpMap=ap(_d.bumpMap)),_d.bumpScale!==void 0&&(sp.bumpScale=_d.bumpScale),_d.normalMap!==void 0&&(sp.normalMap=ap(_d.normalMap)),_d.normalMapType!==void 0&&(sp.normalMapType=_d.normalMapType),_d.normalScale!==void 0){let lp=_d.normalScale;Array.isArray(lp)===!1&&(lp=[lp,lp]),sp.normalScale=new Vector2().fromArray(lp)}return _d.displacementMap!==void 0&&(sp.displacementMap=ap(_d.displacementMap)),_d.displacementScale!==void 0&&(sp.displacementScale=_d.displacementScale),_d.displacementBias!==void 0&&(sp.displacementBias=_d.displacementBias),_d.roughnessMap!==void 0&&(sp.roughnessMap=ap(_d.roughnessMap)),_d.metalnessMap!==void 0&&(sp.metalnessMap=ap(_d.metalnessMap)),_d.emissiveMap!==void 0&&(sp.emissiveMap=ap(_d.emissiveMap)),_d.emissiveIntensity!==void 0&&(sp.emissiveIntensity=_d.emissiveIntensity),_d.specularMap!==void 0&&(sp.specularMap=ap(_d.specularMap)),_d.specularIntensityMap!==void 0&&(sp.specularIntensityMap=ap(_d.specularIntensityMap)),_d.specularColorMap!==void 0&&(sp.specularColorMap=ap(_d.specularColorMap)),_d.envMap!==void 0&&(sp.envMap=ap(_d.envMap)),_d.envMapIntensity!==void 0&&(sp.envMapIntensity=_d.envMapIntensity),_d.reflectivity!==void 0&&(sp.reflectivity=_d.reflectivity),_d.refractionRatio!==void 0&&(sp.refractionRatio=_d.refractionRatio),_d.lightMap!==void 0&&(sp.lightMap=ap(_d.lightMap)),_d.lightMapIntensity!==void 0&&(sp.lightMapIntensity=_d.lightMapIntensity),_d.aoMap!==void 0&&(sp.aoMap=ap(_d.aoMap)),_d.aoMapIntensity!==void 0&&(sp.aoMapIntensity=_d.aoMapIntensity),_d.gradientMap!==void 0&&(sp.gradientMap=ap(_d.gradientMap)),_d.clearcoatMap!==void 0&&(sp.clearcoatMap=ap(_d.clearcoatMap)),_d.clearcoatRoughnessMap!==void 0&&(sp.clearcoatRoughnessMap=ap(_d.clearcoatRoughnessMap)),_d.clearcoatNormalMap!==void 0&&(sp.clearcoatNormalMap=ap(_d.clearcoatNormalMap)),_d.clearcoatNormalScale!==void 0&&(sp.clearcoatNormalScale=new Vector2().fromArray(_d.clearcoatNormalScale)),_d.iridescenceMap!==void 0&&(sp.iridescenceMap=ap(_d.iridescenceMap)),_d.iridescenceThicknessMap!==void 0&&(sp.iridescenceThicknessMap=ap(_d.iridescenceThicknessMap)),_d.transmissionMap!==void 0&&(sp.transmissionMap=ap(_d.transmissionMap)),_d.thicknessMap!==void 0&&(sp.thicknessMap=ap(_d.thicknessMap)),_d.anisotropyMap!==void 0&&(sp.anisotropyMap=ap(_d.anisotropyMap)),_d.sheenColorMap!==void 0&&(sp.sheenColorMap=ap(_d.sheenColorMap)),_d.sheenRoughnessMap!==void 0&&(sp.sheenRoughnessMap=ap(_d.sheenRoughnessMap)),sp}setTextures(_d){return this.textures=_d,this}static createMaterialFromType(_d){const np={ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material};return new np[_d]}}class LoaderUtils{static decodeText(_d){if(typeof TextDecoder<"u")return new TextDecoder().decode(_d);let np="";for(let ap=0,sp=_d.length;ap<sp;ap++)np+=String.fromCharCode(_d[ap]);try{return decodeURIComponent(escape(np))}catch{return np}}static extractUrlBase(_d){const np=_d.lastIndexOf("/");return np===-1?"./":_d.slice(0,np+1)}static resolveURL(_d,np){return typeof _d!="string"||_d===""?"":(/^https?:\/\//i.test(np)&&/^\//.test(_d)&&(np=np.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_d)||/^data:.*,.*$/i.test(_d)||/^blob:.*$/i.test(_d)?_d:np+_d)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(_d){return super.copy(_d),this.instanceCount=_d.instanceCount,this}toJSON(){const _d=super.toJSON();return _d.instanceCount=this.instanceCount,_d.isInstancedBufferGeometry=!0,_d}}class BufferGeometryLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){const lp=this,up=new FileLoader(lp.manager);up.setPath(lp.path),up.setRequestHeader(lp.requestHeader),up.setWithCredentials(lp.withCredentials),up.load(_d,function(cp){try{np(lp.parse(JSON.parse(cp)))}catch(dp){sp?sp(dp):console.error(dp),lp.manager.itemError(_d)}},ap,sp)}parse(_d){const np={},ap={};function sp(gp,yp){if(np[yp]!==void 0)return np[yp];const _p=gp.interleavedBuffers[yp],vp=lp(gp,_p.buffer),bp=getTypedArray(_p.type,vp),Ep=new InterleavedBuffer(bp,_p.stride);return Ep.uuid=_p.uuid,np[yp]=Ep,Ep}function lp(gp,yp){if(ap[yp]!==void 0)return ap[yp];const _p=gp.arrayBuffers[yp],vp=new Uint32Array(_p).buffer;return ap[yp]=vp,vp}const up=_d.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,cp=_d.data.index;if(cp!==void 0){const gp=getTypedArray(cp.type,cp.array);up.setIndex(new BufferAttribute(gp,1))}const dp=_d.data.attributes;for(const gp in dp){const yp=dp[gp];let xp;if(yp.isInterleavedBufferAttribute){const _p=sp(_d.data,yp.data);xp=new InterleavedBufferAttribute(_p,yp.itemSize,yp.offset,yp.normalized)}else{const _p=getTypedArray(yp.type,yp.array),vp=yp.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;xp=new vp(_p,yp.itemSize,yp.normalized)}yp.name!==void 0&&(xp.name=yp.name),yp.usage!==void 0&&xp.setUsage(yp.usage),up.setAttribute(gp,xp)}const hp=_d.data.morphAttributes;if(hp)for(const gp in hp){const yp=hp[gp],xp=[];for(let _p=0,vp=yp.length;_p<vp;_p++){const bp=yp[_p];let Ep;if(bp.isInterleavedBufferAttribute){const Sp=sp(_d.data,bp.data);Ep=new InterleavedBufferAttribute(Sp,bp.itemSize,bp.offset,bp.normalized)}else{const Sp=getTypedArray(bp.type,bp.array);Ep=new BufferAttribute(Sp,bp.itemSize,bp.normalized)}bp.name!==void 0&&(Ep.name=bp.name),xp.push(Ep)}up.morphAttributes[gp]=xp}_d.data.morphTargetsRelative&&(up.morphTargetsRelative=!0);const pp=_d.data.groups||_d.data.drawcalls||_d.data.offsets;if(pp!==void 0)for(let gp=0,yp=pp.length;gp!==yp;++gp){const xp=pp[gp];up.addGroup(xp.start,xp.count,xp.materialIndex)}const mp=_d.data.boundingSphere;if(mp!==void 0){const gp=new Vector3;mp.center!==void 0&&gp.fromArray(mp.center),up.boundingSphere=new Sphere(gp,mp.radius)}return _d.name&&(up.name=_d.name),_d.userData&&(up.userData=_d.userData),up}}class ObjectLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){const lp=this,up=this.path===""?LoaderUtils.extractUrlBase(_d):this.path;this.resourcePath=this.resourcePath||up;const cp=new FileLoader(this.manager);cp.setPath(this.path),cp.setRequestHeader(this.requestHeader),cp.setWithCredentials(this.withCredentials),cp.load(_d,function(dp){let hp=null;try{hp=JSON.parse(dp)}catch(pp){sp!==void 0&&sp(pp),console.error("THREE:ObjectLoader: Can't parse "+_d+".",pp.message);return}const fp=hp.metadata;if(fp===void 0||fp.type===void 0||fp.type.toLowerCase()==="geometry"){sp!==void 0&&sp(new Error("THREE.ObjectLoader: Can't load "+_d)),console.error("THREE.ObjectLoader: Can't load "+_d);return}lp.parse(hp,np)},ap,sp)}async loadAsync(_d,np){const ap=this,sp=this.path===""?LoaderUtils.extractUrlBase(_d):this.path;this.resourcePath=this.resourcePath||sp;const lp=new FileLoader(this.manager);lp.setPath(this.path),lp.setRequestHeader(this.requestHeader),lp.setWithCredentials(this.withCredentials);const up=await lp.loadAsync(_d,np),cp=JSON.parse(up),dp=cp.metadata;if(dp===void 0||dp.type===void 0||dp.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+_d);return await ap.parseAsync(cp)}parse(_d,np){const ap=this.parseAnimations(_d.animations),sp=this.parseShapes(_d.shapes),lp=this.parseGeometries(_d.geometries,sp),up=this.parseImages(_d.images,function(){np!==void 0&&np(hp)}),cp=this.parseTextures(_d.textures,up),dp=this.parseMaterials(_d.materials,cp),hp=this.parseObject(_d.object,lp,dp,cp,ap),fp=this.parseSkeletons(_d.skeletons,hp);if(this.bindSkeletons(hp,fp),np!==void 0){let pp=!1;for(const mp in up)if(up[mp].data instanceof HTMLImageElement){pp=!0;break}pp===!1&&np(hp)}return hp}async parseAsync(_d){const np=this.parseAnimations(_d.animations),ap=this.parseShapes(_d.shapes),sp=this.parseGeometries(_d.geometries,ap),lp=await this.parseImagesAsync(_d.images),up=this.parseTextures(_d.textures,lp),cp=this.parseMaterials(_d.materials,up),dp=this.parseObject(_d.object,sp,cp,up,np),hp=this.parseSkeletons(_d.skeletons,dp);return this.bindSkeletons(dp,hp),dp}parseShapes(_d){const np={};if(_d!==void 0)for(let ap=0,sp=_d.length;ap<sp;ap++){const lp=new Shape().fromJSON(_d[ap]);np[lp.uuid]=lp}return np}parseSkeletons(_d,np){const ap={},sp={};if(np.traverse(function(lp){lp.isBone&&(sp[lp.uuid]=lp)}),_d!==void 0)for(let lp=0,up=_d.length;lp<up;lp++){const cp=new Skeleton().fromJSON(_d[lp],sp);ap[cp.uuid]=cp}return ap}parseGeometries(_d,np){const ap={};if(_d!==void 0){const sp=new BufferGeometryLoader;for(let lp=0,up=_d.length;lp<up;lp++){let cp;const dp=_d[lp];switch(dp.type){case"BufferGeometry":case"InstancedBufferGeometry":cp=sp.parse(dp);break;default:dp.type in Geometries?cp=Geometries[dp.type].fromJSON(dp,np):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${dp.type}"`)}cp.uuid=dp.uuid,dp.name!==void 0&&(cp.name=dp.name),dp.userData!==void 0&&(cp.userData=dp.userData),ap[dp.uuid]=cp}}return ap}parseMaterials(_d,np){const ap={},sp={};if(_d!==void 0){const lp=new MaterialLoader;lp.setTextures(np);for(let up=0,cp=_d.length;up<cp;up++){const dp=_d[up];ap[dp.uuid]===void 0&&(ap[dp.uuid]=lp.parse(dp)),sp[dp.uuid]=ap[dp.uuid]}}return sp}parseAnimations(_d){const np={};if(_d!==void 0)for(let ap=0;ap<_d.length;ap++){const sp=_d[ap],lp=AnimationClip.parse(sp);np[lp.uuid]=lp}return np}parseImages(_d,np){const ap=this,sp={};let lp;function up(dp){return ap.manager.itemStart(dp),lp.load(dp,function(){ap.manager.itemEnd(dp)},void 0,function(){ap.manager.itemError(dp),ap.manager.itemEnd(dp)})}function cp(dp){if(typeof dp=="string"){const hp=dp,fp=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(hp)?hp:ap.resourcePath+hp;return up(fp)}else return dp.data?{data:getTypedArray(dp.type,dp.data),width:dp.width,height:dp.height}:null}if(_d!==void 0&&_d.length>0){const dp=new LoadingManager(np);lp=new ImageLoader(dp),lp.setCrossOrigin(this.crossOrigin);for(let hp=0,fp=_d.length;hp<fp;hp++){const pp=_d[hp],mp=pp.url;if(Array.isArray(mp)){const gp=[];for(let yp=0,xp=mp.length;yp<xp;yp++){const _p=mp[yp],vp=cp(_p);vp!==null&&(vp instanceof HTMLImageElement?gp.push(vp):gp.push(new DataTexture(vp.data,vp.width,vp.height)))}sp[pp.uuid]=new Source(gp)}else{const gp=cp(pp.url);sp[pp.uuid]=new Source(gp)}}}return sp}async parseImagesAsync(_d){const np=this,ap={};let sp;async function lp(up){if(typeof up=="string"){const cp=up,dp=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(cp)?cp:np.resourcePath+cp;return await sp.loadAsync(dp)}else return up.data?{data:getTypedArray(up.type,up.data),width:up.width,height:up.height}:null}if(_d!==void 0&&_d.length>0){sp=new ImageLoader(this.manager),sp.setCrossOrigin(this.crossOrigin);for(let up=0,cp=_d.length;up<cp;up++){const dp=_d[up],hp=dp.url;if(Array.isArray(hp)){const fp=[];for(let pp=0,mp=hp.length;pp<mp;pp++){const gp=hp[pp],yp=await lp(gp);yp!==null&&(yp instanceof HTMLImageElement?fp.push(yp):fp.push(new DataTexture(yp.data,yp.width,yp.height)))}ap[dp.uuid]=new Source(fp)}else{const fp=await lp(dp.url);ap[dp.uuid]=new Source(fp)}}}return ap}parseTextures(_d,np){function ap(lp,up){return typeof lp=="number"?lp:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",lp),up[lp])}const sp={};if(_d!==void 0)for(let lp=0,up=_d.length;lp<up;lp++){const cp=_d[lp];cp.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',cp.uuid),np[cp.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",cp.image);const dp=np[cp.image],hp=dp.data;let fp;Array.isArray(hp)?(fp=new CubeTexture,hp.length===6&&(fp.needsUpdate=!0)):(hp&&hp.data?fp=new DataTexture:fp=new Texture,hp&&(fp.needsUpdate=!0)),fp.source=dp,fp.uuid=cp.uuid,cp.name!==void 0&&(fp.name=cp.name),cp.mapping!==void 0&&(fp.mapping=ap(cp.mapping,TEXTURE_MAPPING)),cp.channel!==void 0&&(fp.channel=cp.channel),cp.offset!==void 0&&fp.offset.fromArray(cp.offset),cp.repeat!==void 0&&fp.repeat.fromArray(cp.repeat),cp.center!==void 0&&fp.center.fromArray(cp.center),cp.rotation!==void 0&&(fp.rotation=cp.rotation),cp.wrap!==void 0&&(fp.wrapS=ap(cp.wrap[0],TEXTURE_WRAPPING),fp.wrapT=ap(cp.wrap[1],TEXTURE_WRAPPING)),cp.format!==void 0&&(fp.format=cp.format),cp.internalFormat!==void 0&&(fp.internalFormat=cp.internalFormat),cp.type!==void 0&&(fp.type=cp.type),cp.colorSpace!==void 0&&(fp.colorSpace=cp.colorSpace),cp.encoding!==void 0&&(fp.encoding=cp.encoding),cp.minFilter!==void 0&&(fp.minFilter=ap(cp.minFilter,TEXTURE_FILTER)),cp.magFilter!==void 0&&(fp.magFilter=ap(cp.magFilter,TEXTURE_FILTER)),cp.anisotropy!==void 0&&(fp.anisotropy=cp.anisotropy),cp.flipY!==void 0&&(fp.flipY=cp.flipY),cp.generateMipmaps!==void 0&&(fp.generateMipmaps=cp.generateMipmaps),cp.premultiplyAlpha!==void 0&&(fp.premultiplyAlpha=cp.premultiplyAlpha),cp.unpackAlignment!==void 0&&(fp.unpackAlignment=cp.unpackAlignment),cp.compareFunction!==void 0&&(fp.compareFunction=cp.compareFunction),cp.userData!==void 0&&(fp.userData=cp.userData),sp[cp.uuid]=fp}return sp}parseObject(_d,np,ap,sp,lp){let up;function cp(mp){return np[mp]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",mp),np[mp]}function dp(mp){if(mp!==void 0){if(Array.isArray(mp)){const gp=[];for(let yp=0,xp=mp.length;yp<xp;yp++){const _p=mp[yp];ap[_p]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_p),gp.push(ap[_p])}return gp}return ap[mp]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",mp),ap[mp]}}function hp(mp){return sp[mp]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",mp),sp[mp]}let fp,pp;switch(_d.type){case"Scene":up=new Scene,_d.background!==void 0&&(Number.isInteger(_d.background)?up.background=new Color(_d.background):up.background=hp(_d.background)),_d.environment!==void 0&&(up.environment=hp(_d.environment)),_d.fog!==void 0&&(_d.fog.type==="Fog"?up.fog=new Fog(_d.fog.color,_d.fog.near,_d.fog.far):_d.fog.type==="FogExp2"&&(up.fog=new FogExp2(_d.fog.color,_d.fog.density)),_d.fog.name!==""&&(up.fog.name=_d.fog.name)),_d.backgroundBlurriness!==void 0&&(up.backgroundBlurriness=_d.backgroundBlurriness),_d.backgroundIntensity!==void 0&&(up.backgroundIntensity=_d.backgroundIntensity);break;case"PerspectiveCamera":up=new PerspectiveCamera$1(_d.fov,_d.aspect,_d.near,_d.far),_d.focus!==void 0&&(up.focus=_d.focus),_d.zoom!==void 0&&(up.zoom=_d.zoom),_d.filmGauge!==void 0&&(up.filmGauge=_d.filmGauge),_d.filmOffset!==void 0&&(up.filmOffset=_d.filmOffset),_d.view!==void 0&&(up.view=Object.assign({},_d.view));break;case"OrthographicCamera":up=new OrthographicCamera(_d.left,_d.right,_d.top,_d.bottom,_d.near,_d.far),_d.zoom!==void 0&&(up.zoom=_d.zoom),_d.view!==void 0&&(up.view=Object.assign({},_d.view));break;case"AmbientLight":up=new AmbientLight(_d.color,_d.intensity);break;case"DirectionalLight":up=new DirectionalLight(_d.color,_d.intensity);break;case"PointLight":up=new PointLight(_d.color,_d.intensity,_d.distance,_d.decay);break;case"RectAreaLight":up=new RectAreaLight(_d.color,_d.intensity,_d.width,_d.height);break;case"SpotLight":up=new SpotLight(_d.color,_d.intensity,_d.distance,_d.angle,_d.penumbra,_d.decay);break;case"HemisphereLight":up=new HemisphereLight(_d.color,_d.groundColor,_d.intensity);break;case"LightProbe":up=new LightProbe().fromJSON(_d);break;case"SkinnedMesh":fp=cp(_d.geometry),pp=dp(_d.material),up=new SkinnedMesh(fp,pp),_d.bindMode!==void 0&&(up.bindMode=_d.bindMode),_d.bindMatrix!==void 0&&up.bindMatrix.fromArray(_d.bindMatrix),_d.skeleton!==void 0&&(up.skeleton=_d.skeleton);break;case"Mesh":fp=cp(_d.geometry),pp=dp(_d.material),up=new Mesh(fp,pp);break;case"InstancedMesh":fp=cp(_d.geometry),pp=dp(_d.material);const mp=_d.count,gp=_d.instanceMatrix,yp=_d.instanceColor;up=new InstancedMesh(fp,pp,mp),up.instanceMatrix=new InstancedBufferAttribute(new Float32Array(gp.array),16),yp!==void 0&&(up.instanceColor=new InstancedBufferAttribute(new Float32Array(yp.array),yp.itemSize));break;case"BatchedMesh":fp=cp(_d.geometry),pp=dp(_d.material),up=new BatchedMesh(_d.maxGeometryCount,_d.maxVertexCount,_d.maxIndexCount,pp),up.geometry=fp,up.perObjectFrustumCulled=_d.perObjectFrustumCulled,up.sortObjects=_d.sortObjects,up._drawRanges=_d.drawRanges,up._reservedRanges=_d.reservedRanges,up._visibility=_d.visibility,up._active=_d.active,up._bounds=_d.bounds.map(xp=>{const _p=new Box3;_p.min.fromArray(xp.boxMin),_p.max.fromArray(xp.boxMax);const vp=new Sphere;return vp.radius=xp.sphereRadius,vp.center.fromArray(xp.sphereCenter),{boxInitialized:xp.boxInitialized,box:_p,sphereInitialized:xp.sphereInitialized,sphere:vp}}),up._maxGeometryCount=_d.maxGeometryCount,up._maxVertexCount=_d.maxVertexCount,up._maxIndexCount=_d.maxIndexCount,up._geometryInitialized=_d.geometryInitialized,up._geometryCount=_d.geometryCount,up._matricesTexture=hp(_d.matricesTexture.uuid);break;case"LOD":up=new LOD;break;case"Line":up=new Line(cp(_d.geometry),dp(_d.material));break;case"LineLoop":up=new LineLoop(cp(_d.geometry),dp(_d.material));break;case"LineSegments":up=new LineSegments(cp(_d.geometry),dp(_d.material));break;case"PointCloud":case"Points":up=new Points(cp(_d.geometry),dp(_d.material));break;case"Sprite":up=new Sprite(dp(_d.material));break;case"Group":up=new Group;break;case"Bone":up=new Bone;break;default:up=new Object3D}if(up.uuid=_d.uuid,_d.name!==void 0&&(up.name=_d.name),_d.matrix!==void 0?(up.matrix.fromArray(_d.matrix),_d.matrixAutoUpdate!==void 0&&(up.matrixAutoUpdate=_d.matrixAutoUpdate),up.matrixAutoUpdate&&up.matrix.decompose(up.position,up.quaternion,up.scale)):(_d.position!==void 0&&up.position.fromArray(_d.position),_d.rotation!==void 0&&up.rotation.fromArray(_d.rotation),_d.quaternion!==void 0&&up.quaternion.fromArray(_d.quaternion),_d.scale!==void 0&&up.scale.fromArray(_d.scale)),_d.up!==void 0&&up.up.fromArray(_d.up),_d.castShadow!==void 0&&(up.castShadow=_d.castShadow),_d.receiveShadow!==void 0&&(up.receiveShadow=_d.receiveShadow),_d.shadow&&(_d.shadow.bias!==void 0&&(up.shadow.bias=_d.shadow.bias),_d.shadow.normalBias!==void 0&&(up.shadow.normalBias=_d.shadow.normalBias),_d.shadow.radius!==void 0&&(up.shadow.radius=_d.shadow.radius),_d.shadow.mapSize!==void 0&&up.shadow.mapSize.fromArray(_d.shadow.mapSize),_d.shadow.camera!==void 0&&(up.shadow.camera=this.parseObject(_d.shadow.camera))),_d.visible!==void 0&&(up.visible=_d.visible),_d.frustumCulled!==void 0&&(up.frustumCulled=_d.frustumCulled),_d.renderOrder!==void 0&&(up.renderOrder=_d.renderOrder),_d.userData!==void 0&&(up.userData=_d.userData),_d.layers!==void 0&&(up.layers.mask=_d.layers),_d.children!==void 0){const mp=_d.children;for(let gp=0;gp<mp.length;gp++)up.add(this.parseObject(mp[gp],np,ap,sp,lp))}if(_d.animations!==void 0){const mp=_d.animations;for(let gp=0;gp<mp.length;gp++){const yp=mp[gp];up.animations.push(lp[yp])}}if(_d.type==="LOD"){_d.autoUpdate!==void 0&&(up.autoUpdate=_d.autoUpdate);const mp=_d.levels;for(let gp=0;gp<mp.length;gp++){const yp=mp[gp],xp=up.getObjectByProperty("uuid",yp.object);xp!==void 0&&up.addLevel(xp,yp.distance,yp.hysteresis)}}return up}bindSkeletons(_d,np){Object.keys(np).length!==0&&_d.traverse(function(ap){if(ap.isSkinnedMesh===!0&&ap.skeleton!==void 0){const sp=np[ap.skeleton];sp===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",ap.skeleton):ap.bind(sp,ap.bindMatrix)}})}}const TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,CubeUVReflectionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};class ImageBitmapLoader extends Loader{constructor(_d){super(_d),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_d){return this.options=_d,this}load(_d,np,ap,sp){_d===void 0&&(_d=""),this.path!==void 0&&(_d=this.path+_d),_d=this.manager.resolveURL(_d);const lp=this,up=Cache.get(_d);if(up!==void 0){if(lp.manager.itemStart(_d),up.then){up.then(hp=>{np&&np(hp),lp.manager.itemEnd(_d)}).catch(hp=>{sp&&sp(hp)});return}return setTimeout(function(){np&&np(up),lp.manager.itemEnd(_d)},0),up}const cp={};cp.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",cp.headers=this.requestHeader;const dp=fetch(_d,cp).then(function(hp){return hp.blob()}).then(function(hp){return createImageBitmap(hp,Object.assign(lp.options,{colorSpaceConversion:"none"}))}).then(function(hp){return Cache.add(_d,hp),np&&np(hp),lp.manager.itemEnd(_d),hp}).catch(function(hp){sp&&sp(hp),Cache.remove(_d),lp.manager.itemError(_d),lp.manager.itemEnd(_d)});Cache.add(_d,dp),lp.manager.itemStart(_d)}}let _context;class AudioContext{static getContext(){return _context===void 0&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context}static setContext(_d){_context=_d}}class AudioLoader extends Loader{constructor(_d){super(_d)}load(_d,np,ap,sp){const lp=this,up=new FileLoader(this.manager);up.setResponseType("arraybuffer"),up.setPath(this.path),up.setRequestHeader(this.requestHeader),up.setWithCredentials(this.withCredentials),up.load(_d,function(dp){try{const hp=dp.slice(0);AudioContext.getContext().decodeAudioData(hp,function(pp){np(pp)}).catch(cp)}catch(hp){cp(hp)}},ap,sp);function cp(dp){sp?sp(dp):console.error(dp),lp.manager.itemError(_d)}}}const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera$1,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera$1,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(_d){const np=this._cache;if(np.focus!==_d.focus||np.fov!==_d.fov||np.aspect!==_d.aspect*this.aspect||np.near!==_d.near||np.far!==_d.far||np.zoom!==_d.zoom||np.eyeSep!==this.eyeSep){np.focus=_d.focus,np.fov=_d.fov,np.aspect=_d.aspect*this.aspect,np.near=_d.near,np.far=_d.far,np.zoom=_d.zoom,np.eyeSep=this.eyeSep,_projectionMatrix.copy(_d.projectionMatrix);const sp=np.eyeSep/2,lp=sp*np.near/np.focus,up=np.near*Math.tan(DEG2RAD*np.fov*.5)/np.zoom;let cp,dp;_eyeLeft.elements[12]=-sp,_eyeRight.elements[12]=sp,cp=-up*np.aspect+lp,dp=up*np.aspect+lp,_projectionMatrix.elements[0]=2*np.near/(dp-cp),_projectionMatrix.elements[8]=(dp+cp)/(dp-cp),this.cameraL.projectionMatrix.copy(_projectionMatrix),cp=-up*np.aspect-lp,dp=up*np.aspect-lp,_projectionMatrix.elements[0]=2*np.near/(dp-cp),_projectionMatrix.elements[8]=(dp+cp)/(dp-cp),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(_d.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(_d.matrixWorld).multiply(_eyeRight)}}class Clock{constructor(_d=!0){this.autoStart=_d,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _d=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const np=now();_d=(np-this.oldTime)/1e3,this.oldTime=np,this.elapsedTime+=_d}return _d}}function now(){return(typeof performance>"u"?Date:performance).now()}const _position$1=new Vector3,_quaternion$1=new Quaternion,_scale$1=new Vector3,_orientation$1=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(_d){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=_d,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(_d){return this.gain.gain.setTargetAtTime(_d,this.context.currentTime,.01),this}updateMatrixWorld(_d){super.updateMatrixWorld(_d);const np=this.context.listener,ap=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),np.positionX){const sp=this.context.currentTime+this.timeDelta;np.positionX.linearRampToValueAtTime(_position$1.x,sp),np.positionY.linearRampToValueAtTime(_position$1.y,sp),np.positionZ.linearRampToValueAtTime(_position$1.z,sp),np.forwardX.linearRampToValueAtTime(_orientation$1.x,sp),np.forwardY.linearRampToValueAtTime(_orientation$1.y,sp),np.forwardZ.linearRampToValueAtTime(_orientation$1.z,sp),np.upX.linearRampToValueAtTime(ap.x,sp),np.upY.linearRampToValueAtTime(ap.y,sp),np.upZ.linearRampToValueAtTime(ap.z,sp)}else np.setPosition(_position$1.x,_position$1.y,_position$1.z),np.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,ap.x,ap.y,ap.z)}}class Audio extends Object3D{constructor(_d){super(),this.type="Audio",this.listener=_d,this.context=_d.context,this.gain=this.context.createGain(),this.gain.connect(_d.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(_d){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_d,this.connect(),this}setMediaElementSource(_d){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(_d),this.connect(),this}setMediaStreamSource(_d){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(_d),this.connect(),this}setBuffer(_d){return this.buffer=_d,this.sourceType="buffer",this.autoplay&&this.play(),this}play(_d=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+_d;const np=this.context.createBufferSource();return np.buffer=this.buffer,np.loop=this.loop,np.loopStart=this.loopStart,np.loopEnd=this.loopEnd,np.onended=this.onEnded.bind(this),np.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=np,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let _d=1,np=this.filters.length;_d<np;_d++)this.filters[_d-1].connect(this.filters[_d]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let _d=1,np=this.filters.length;_d<np;_d++)this.filters[_d-1].disconnect(this.filters[_d]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(_d){return _d||(_d=[]),this._connected===!0?(this.disconnect(),this.filters=_d.slice(),this.connect()):this.filters=_d.slice(),this}setDetune(_d){return this.detune=_d,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(_d){return this.setFilters(_d?[_d]:[])}setPlaybackRate(_d){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=_d,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(_d){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=_d,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(_d){return this.loopStart=_d,this}setLoopEnd(_d){return this.loopEnd=_d,this}getVolume(){return this.gain.gain.value}setVolume(_d){return this.gain.gain.setTargetAtTime(_d,this.context.currentTime,.01),this}}const _position=new Vector3,_quaternion=new Quaternion,_scale=new Vector3,_orientation=new Vector3;class PositionalAudio extends Audio{constructor(_d){super(_d),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(_d){return this.panner.refDistance=_d,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(_d){return this.panner.rolloffFactor=_d,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(_d){return this.panner.distanceModel=_d,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(_d){return this.panner.maxDistance=_d,this}setDirectionalCone(_d,np,ap){return this.panner.coneInnerAngle=_d,this.panner.coneOuterAngle=np,this.panner.coneOuterGain=ap,this}updateMatrixWorld(_d){if(super.updateMatrixWorld(_d),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position,_quaternion,_scale),_orientation.set(0,0,1).applyQuaternion(_quaternion);const np=this.panner;if(np.positionX){const ap=this.context.currentTime+this.listener.timeDelta;np.positionX.linearRampToValueAtTime(_position.x,ap),np.positionY.linearRampToValueAtTime(_position.y,ap),np.positionZ.linearRampToValueAtTime(_position.z,ap),np.orientationX.linearRampToValueAtTime(_orientation.x,ap),np.orientationY.linearRampToValueAtTime(_orientation.y,ap),np.orientationZ.linearRampToValueAtTime(_orientation.z,ap)}else np.setPosition(_position.x,_position.y,_position.z),np.setOrientation(_orientation.x,_orientation.y,_orientation.z)}}class AudioAnalyser{constructor(_d,np=2048){this.analyser=_d.context.createAnalyser(),this.analyser.fftSize=np,this.data=new Uint8Array(this.analyser.frequencyBinCount),_d.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let _d=0;const np=this.getFrequencyData();for(let ap=0;ap<np.length;ap++)_d+=np[ap];return _d/np.length}}class PropertyMixer{constructor(_d,np,ap){this.binding=_d,this.valueSize=ap;let sp,lp,up;switch(np){case"quaternion":sp=this._slerp,lp=this._slerpAdditive,up=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(ap*6),this._workIndex=5;break;case"string":case"bool":sp=this._select,lp=this._select,up=this._setAdditiveIdentityOther,this.buffer=new Array(ap*5);break;default:sp=this._lerp,lp=this._lerpAdditive,up=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(ap*5)}this._mixBufferRegion=sp,this._mixBufferRegionAdditive=lp,this._setIdentity=up,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(_d,np){const ap=this.buffer,sp=this.valueSize,lp=_d*sp+sp;let up=this.cumulativeWeight;if(up===0){for(let cp=0;cp!==sp;++cp)ap[lp+cp]=ap[cp];up=np}else{up+=np;const cp=np/up;this._mixBufferRegion(ap,lp,0,cp,sp)}this.cumulativeWeight=up}accumulateAdditive(_d){const np=this.buffer,ap=this.valueSize,sp=ap*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(np,sp,0,_d,ap),this.cumulativeWeightAdditive+=_d}apply(_d){const np=this.valueSize,ap=this.buffer,sp=_d*np+np,lp=this.cumulativeWeight,up=this.cumulativeWeightAdditive,cp=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,lp<1){const dp=np*this._origIndex;this._mixBufferRegion(ap,sp,dp,1-lp,np)}up>0&&this._mixBufferRegionAdditive(ap,sp,this._addIndex*np,1,np);for(let dp=np,hp=np+np;dp!==hp;++dp)if(ap[dp]!==ap[dp+np]){cp.setValue(ap,sp);break}}saveOriginalState(){const _d=this.binding,np=this.buffer,ap=this.valueSize,sp=ap*this._origIndex;_d.getValue(np,sp);for(let lp=ap,up=sp;lp!==up;++lp)np[lp]=np[sp+lp%ap];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const _d=this.valueSize*3;this.binding.setValue(this.buffer,_d)}_setAdditiveIdentityNumeric(){const _d=this._addIndex*this.valueSize,np=_d+this.valueSize;for(let ap=_d;ap<np;ap++)this.buffer[ap]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const _d=this._origIndex*this.valueSize,np=this._addIndex*this.valueSize;for(let ap=0;ap<this.valueSize;ap++)this.buffer[np+ap]=this.buffer[_d+ap]}_select(_d,np,ap,sp,lp){if(sp>=.5)for(let up=0;up!==lp;++up)_d[np+up]=_d[ap+up]}_slerp(_d,np,ap,sp){Quaternion.slerpFlat(_d,np,_d,np,_d,ap,sp)}_slerpAdditive(_d,np,ap,sp,lp){const up=this._workIndex*lp;Quaternion.multiplyQuaternionsFlat(_d,up,_d,np,_d,ap),Quaternion.slerpFlat(_d,np,_d,np,_d,up,sp)}_lerp(_d,np,ap,sp,lp){const up=1-sp;for(let cp=0;cp!==lp;++cp){const dp=np+cp;_d[dp]=_d[dp]*up+_d[ap+cp]*sp}}_lerpAdditive(_d,np,ap,sp,lp){for(let up=0;up!==lp;++up){const cp=np+up;_d[cp]=_d[cp]+_d[ap+up]*sp}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(_d,np,ap){const sp=ap||PropertyBinding.parseTrackName(np);this._targetGroup=_d,this._bindings=_d.subscribe_(np,sp)}getValue(_d,np){this.bind();const ap=this._targetGroup.nCachedObjects_,sp=this._bindings[ap];sp!==void 0&&sp.getValue(_d,np)}setValue(_d,np){const ap=this._bindings;for(let sp=this._targetGroup.nCachedObjects_,lp=ap.length;sp!==lp;++sp)ap[sp].setValue(_d,np)}bind(){const _d=this._bindings;for(let np=this._targetGroup.nCachedObjects_,ap=_d.length;np!==ap;++np)_d[np].bind()}unbind(){const _d=this._bindings;for(let np=this._targetGroup.nCachedObjects_,ap=_d.length;np!==ap;++np)_d[np].unbind()}}class PropertyBinding{constructor(_d,np,ap){this.path=np,this.parsedPath=ap||PropertyBinding.parseTrackName(np),this.node=PropertyBinding.findNode(_d,this.parsedPath.nodeName),this.rootNode=_d,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_d,np,ap){return _d&&_d.isAnimationObjectGroup?new PropertyBinding.Composite(_d,np,ap):new PropertyBinding(_d,np,ap)}static sanitizeNodeName(_d){return _d.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(_d){const np=_trackRe.exec(_d);if(np===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_d);const ap={nodeName:np[2],objectName:np[3],objectIndex:np[4],propertyName:np[5],propertyIndex:np[6]},sp=ap.nodeName&&ap.nodeName.lastIndexOf(".");if(sp!==void 0&&sp!==-1){const lp=ap.nodeName.substring(sp+1);_supportedObjectNames.indexOf(lp)!==-1&&(ap.nodeName=ap.nodeName.substring(0,sp),ap.objectName=lp)}if(ap.propertyName===null||ap.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_d);return ap}static findNode(_d,np){if(np===void 0||np===""||np==="."||np===-1||np===_d.name||np===_d.uuid)return _d;if(_d.skeleton){const ap=_d.skeleton.getBoneByName(np);if(ap!==void 0)return ap}if(_d.children){const ap=function(lp){for(let up=0;up<lp.length;up++){const cp=lp[up];if(cp.name===np||cp.uuid===np)return cp;const dp=ap(cp.children);if(dp)return dp}return null},sp=ap(_d.children);if(sp)return sp}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_d,np){_d[np]=this.targetObject[this.propertyName]}_getValue_array(_d,np){const ap=this.resolvedProperty;for(let sp=0,lp=ap.length;sp!==lp;++sp)_d[np++]=ap[sp]}_getValue_arrayElement(_d,np){_d[np]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_d,np){this.resolvedProperty.toArray(_d,np)}_setValue_direct(_d,np){this.targetObject[this.propertyName]=_d[np]}_setValue_direct_setNeedsUpdate(_d,np){this.targetObject[this.propertyName]=_d[np],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_d,np){this.targetObject[this.propertyName]=_d[np],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_d,np){const ap=this.resolvedProperty;for(let sp=0,lp=ap.length;sp!==lp;++sp)ap[sp]=_d[np++]}_setValue_array_setNeedsUpdate(_d,np){const ap=this.resolvedProperty;for(let sp=0,lp=ap.length;sp!==lp;++sp)ap[sp]=_d[np++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_d,np){const ap=this.resolvedProperty;for(let sp=0,lp=ap.length;sp!==lp;++sp)ap[sp]=_d[np++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_d,np){this.resolvedProperty[this.propertyIndex]=_d[np]}_setValue_arrayElement_setNeedsUpdate(_d,np){this.resolvedProperty[this.propertyIndex]=_d[np],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_d,np){this.resolvedProperty[this.propertyIndex]=_d[np],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_d,np){this.resolvedProperty.fromArray(_d,np)}_setValue_fromArray_setNeedsUpdate(_d,np){this.resolvedProperty.fromArray(_d,np),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_d,np){this.resolvedProperty.fromArray(_d,np),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_d,np){this.bind(),this.getValue(_d,np)}_setValue_unbound(_d,np){this.bind(),this.setValue(_d,np)}bind(){let _d=this.node;const np=this.parsedPath,ap=np.objectName,sp=np.propertyName;let lp=np.propertyIndex;if(_d||(_d=PropertyBinding.findNode(this.rootNode,np.nodeName),this.node=_d),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_d){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(ap){let hp=np.objectIndex;switch(ap){case"materials":if(!_d.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_d.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}_d=_d.material.materials;break;case"bones":if(!_d.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}_d=_d.skeleton.bones;for(let fp=0;fp<_d.length;fp++)if(_d[fp].name===hp){hp=fp;break}break;case"map":if("map"in _d){_d=_d.map;break}if(!_d.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_d.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}_d=_d.material.map;break;default:if(_d[ap]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}_d=_d[ap]}if(hp!==void 0){if(_d[hp]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_d);return}_d=_d[hp]}}const up=_d[sp];if(up===void 0){const hp=np.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+hp+"."+sp+" but it wasn't found.",_d);return}let cp=this.Versioning.None;this.targetObject=_d,_d.needsUpdate!==void 0?cp=this.Versioning.NeedsUpdate:_d.matrixWorldNeedsUpdate!==void 0&&(cp=this.Versioning.MatrixWorldNeedsUpdate);let dp=this.BindingType.Direct;if(lp!==void 0){if(sp==="morphTargetInfluences"){if(!_d.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!_d.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}_d.morphTargetDictionary[lp]!==void 0&&(lp=_d.morphTargetDictionary[lp])}dp=this.BindingType.ArrayElement,this.resolvedProperty=up,this.propertyIndex=lp}else up.fromArray!==void 0&&up.toArray!==void 0?(dp=this.BindingType.HasFromToArray,this.resolvedProperty=up):Array.isArray(up)?(dp=this.BindingType.EntireArray,this.resolvedProperty=up):this.propertyName=sp;this.getValue=this.GetterByBindingType[dp],this.setValue=this.SetterByBindingTypeAndVersioning[dp][cp]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const _d={};this._indicesByUUID=_d;for(let ap=0,sp=arguments.length;ap!==sp;++ap)_d[arguments[ap].uuid]=ap;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const np=this;this.stats={objects:{get total(){return np._objects.length},get inUse(){return this.total-np.nCachedObjects_}},get bindingsPerObject(){return np._bindings.length}}}add(){const _d=this._objects,np=this._indicesByUUID,ap=this._paths,sp=this._parsedPaths,lp=this._bindings,up=lp.length;let cp,dp=_d.length,hp=this.nCachedObjects_;for(let fp=0,pp=arguments.length;fp!==pp;++fp){const mp=arguments[fp],gp=mp.uuid;let yp=np[gp];if(yp===void 0){yp=dp++,np[gp]=yp,_d.push(mp);for(let xp=0,_p=up;xp!==_p;++xp)lp[xp].push(new PropertyBinding(mp,ap[xp],sp[xp]))}else if(yp<hp){cp=_d[yp];const xp=--hp,_p=_d[xp];np[_p.uuid]=yp,_d[yp]=_p,np[gp]=xp,_d[xp]=mp;for(let vp=0,bp=up;vp!==bp;++vp){const Ep=lp[vp],Sp=Ep[xp];let Ap=Ep[yp];Ep[yp]=Sp,Ap===void 0&&(Ap=new PropertyBinding(mp,ap[vp],sp[vp])),Ep[xp]=Ap}}else _d[yp]!==cp&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=hp}remove(){const _d=this._objects,np=this._indicesByUUID,ap=this._bindings,sp=ap.length;let lp=this.nCachedObjects_;for(let up=0,cp=arguments.length;up!==cp;++up){const dp=arguments[up],hp=dp.uuid,fp=np[hp];if(fp!==void 0&&fp>=lp){const pp=lp++,mp=_d[pp];np[mp.uuid]=fp,_d[fp]=mp,np[hp]=pp,_d[pp]=dp;for(let gp=0,yp=sp;gp!==yp;++gp){const xp=ap[gp],_p=xp[pp],vp=xp[fp];xp[fp]=_p,xp[pp]=vp}}}this.nCachedObjects_=lp}uncache(){const _d=this._objects,np=this._indicesByUUID,ap=this._bindings,sp=ap.length;let lp=this.nCachedObjects_,up=_d.length;for(let cp=0,dp=arguments.length;cp!==dp;++cp){const hp=arguments[cp],fp=hp.uuid,pp=np[fp];if(pp!==void 0)if(delete np[fp],pp<lp){const mp=--lp,gp=_d[mp],yp=--up,xp=_d[yp];np[gp.uuid]=pp,_d[pp]=gp,np[xp.uuid]=mp,_d[mp]=xp,_d.pop();for(let _p=0,vp=sp;_p!==vp;++_p){const bp=ap[_p],Ep=bp[mp],Sp=bp[yp];bp[pp]=Ep,bp[mp]=Sp,bp.pop()}}else{const mp=--up,gp=_d[mp];mp>0&&(np[gp.uuid]=pp),_d[pp]=gp,_d.pop();for(let yp=0,xp=sp;yp!==xp;++yp){const _p=ap[yp];_p[pp]=_p[mp],_p.pop()}}}this.nCachedObjects_=lp}subscribe_(_d,np){const ap=this._bindingsIndicesByPath;let sp=ap[_d];const lp=this._bindings;if(sp!==void 0)return lp[sp];const up=this._paths,cp=this._parsedPaths,dp=this._objects,hp=dp.length,fp=this.nCachedObjects_,pp=new Array(hp);sp=lp.length,ap[_d]=sp,up.push(_d),cp.push(np),lp.push(pp);for(let mp=fp,gp=dp.length;mp!==gp;++mp){const yp=dp[mp];pp[mp]=new PropertyBinding(yp,_d,np)}return pp}unsubscribe_(_d){const np=this._bindingsIndicesByPath,ap=np[_d];if(ap!==void 0){const sp=this._paths,lp=this._parsedPaths,up=this._bindings,cp=up.length-1,dp=up[cp],hp=_d[cp];np[hp]=ap,up[ap]=dp,up.pop(),lp[ap]=lp[cp],lp.pop(),sp[ap]=sp[cp],sp.pop()}}}class AnimationAction{constructor(_d,np,ap=null,sp=np.blendMode){this._mixer=_d,this._clip=np,this._localRoot=ap,this.blendMode=sp;const lp=np.tracks,up=lp.length,cp=new Array(up),dp={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let hp=0;hp!==up;++hp){const fp=lp[hp].createInterpolant(null);cp[hp]=fp,fp.settings=dp}this._interpolantSettings=dp,this._interpolants=cp,this._propertyBindings=new Array(up),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(_d){return this._startTime=_d,this}setLoop(_d,np){return this.loop=_d,this.repetitions=np,this}setEffectiveWeight(_d){return this.weight=_d,this._effectiveWeight=this.enabled?_d:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(_d){return this._scheduleFading(_d,0,1)}fadeOut(_d){return this._scheduleFading(_d,1,0)}crossFadeFrom(_d,np,ap){if(_d.fadeOut(np),this.fadeIn(np),ap){const sp=this._clip.duration,lp=_d._clip.duration,up=lp/sp,cp=sp/lp;_d.warp(1,up,np),this.warp(cp,1,np)}return this}crossFadeTo(_d,np,ap){return _d.crossFadeFrom(this,np,ap)}stopFading(){const _d=this._weightInterpolant;return _d!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_d)),this}setEffectiveTimeScale(_d){return this.timeScale=_d,this._effectiveTimeScale=this.paused?0:_d,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(_d){return this.timeScale=this._clip.duration/_d,this.stopWarping()}syncWith(_d){return this.time=_d.time,this.timeScale=_d.timeScale,this.stopWarping()}halt(_d){return this.warp(this._effectiveTimeScale,0,_d)}warp(_d,np,ap){const sp=this._mixer,lp=sp.time,up=this.timeScale;let cp=this._timeScaleInterpolant;cp===null&&(cp=sp._lendControlInterpolant(),this._timeScaleInterpolant=cp);const dp=cp.parameterPositions,hp=cp.sampleValues;return dp[0]=lp,dp[1]=lp+ap,hp[0]=_d/up,hp[1]=np/up,this}stopWarping(){const _d=this._timeScaleInterpolant;return _d!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_d)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(_d,np,ap,sp){if(!this.enabled){this._updateWeight(_d);return}const lp=this._startTime;if(lp!==null){const dp=(_d-lp)*ap;dp<0||ap===0?np=0:(this._startTime=null,np=ap*dp)}np*=this._updateTimeScale(_d);const up=this._updateTime(np),cp=this._updateWeight(_d);if(cp>0){const dp=this._interpolants,hp=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let fp=0,pp=dp.length;fp!==pp;++fp)dp[fp].evaluate(up),hp[fp].accumulateAdditive(cp);break;case NormalAnimationBlendMode:default:for(let fp=0,pp=dp.length;fp!==pp;++fp)dp[fp].evaluate(up),hp[fp].accumulate(sp,cp)}}}_updateWeight(_d){let np=0;if(this.enabled){np=this.weight;const ap=this._weightInterpolant;if(ap!==null){const sp=ap.evaluate(_d)[0];np*=sp,_d>ap.parameterPositions[1]&&(this.stopFading(),sp===0&&(this.enabled=!1))}}return this._effectiveWeight=np,np}_updateTimeScale(_d){let np=0;if(!this.paused){np=this.timeScale;const ap=this._timeScaleInterpolant;if(ap!==null){const sp=ap.evaluate(_d)[0];np*=sp,_d>ap.parameterPositions[1]&&(this.stopWarping(),np===0?this.paused=!0:this.timeScale=np)}}return this._effectiveTimeScale=np,np}_updateTime(_d){const np=this._clip.duration,ap=this.loop;let sp=this.time+_d,lp=this._loopCount;const up=ap===LoopPingPong;if(_d===0)return lp===-1?sp:up&&(lp&1)===1?np-sp:sp;if(ap===LoopOnce){lp===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(sp>=np)sp=np;else if(sp<0)sp=0;else{this.time=sp;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=sp,this._mixer.dispatchEvent({type:"finished",action:this,direction:_d<0?-1:1})}}else{if(lp===-1&&(_d>=0?(lp=0,this._setEndings(!0,this.repetitions===0,up)):this._setEndings(this.repetitions===0,!0,up)),sp>=np||sp<0){const cp=Math.floor(sp/np);sp-=np*cp,lp+=Math.abs(cp);const dp=this.repetitions-lp;if(dp<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,sp=_d>0?np:0,this.time=sp,this._mixer.dispatchEvent({type:"finished",action:this,direction:_d>0?1:-1});else{if(dp===1){const hp=_d<0;this._setEndings(hp,!hp,up)}else this._setEndings(!1,!1,up);this._loopCount=lp,this.time=sp,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:cp})}}else this.time=sp;if(up&&(lp&1)===1)return np-sp}return sp}_setEndings(_d,np,ap){const sp=this._interpolantSettings;ap?(sp.endingStart=ZeroSlopeEnding,sp.endingEnd=ZeroSlopeEnding):(_d?sp.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:sp.endingStart=WrapAroundEnding,np?sp.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:sp.endingEnd=WrapAroundEnding)}_scheduleFading(_d,np,ap){const sp=this._mixer,lp=sp.time;let up=this._weightInterpolant;up===null&&(up=sp._lendControlInterpolant(),this._weightInterpolant=up);const cp=up.parameterPositions,dp=up.sampleValues;return cp[0]=lp,dp[0]=np,cp[1]=lp+_d,dp[1]=ap,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher{constructor(_d){super(),this._root=_d,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(_d,np){const ap=_d._localRoot||this._root,sp=_d._clip.tracks,lp=sp.length,up=_d._propertyBindings,cp=_d._interpolants,dp=ap.uuid,hp=this._bindingsByRootAndName;let fp=hp[dp];fp===void 0&&(fp={},hp[dp]=fp);for(let pp=0;pp!==lp;++pp){const mp=sp[pp],gp=mp.name;let yp=fp[gp];if(yp!==void 0)++yp.referenceCount,up[pp]=yp;else{if(yp=up[pp],yp!==void 0){yp._cacheIndex===null&&(++yp.referenceCount,this._addInactiveBinding(yp,dp,gp));continue}const xp=np&&np._propertyBindings[pp].binding.parsedPath;yp=new PropertyMixer(PropertyBinding.create(ap,gp,xp),mp.ValueTypeName,mp.getValueSize()),++yp.referenceCount,this._addInactiveBinding(yp,dp,gp),up[pp]=yp}cp[pp].resultBuffer=yp.buffer}}_activateAction(_d){if(!this._isActiveAction(_d)){if(_d._cacheIndex===null){const ap=(_d._localRoot||this._root).uuid,sp=_d._clip.uuid,lp=this._actionsByClip[sp];this._bindAction(_d,lp&&lp.knownActions[0]),this._addInactiveAction(_d,sp,ap)}const np=_d._propertyBindings;for(let ap=0,sp=np.length;ap!==sp;++ap){const lp=np[ap];lp.useCount++===0&&(this._lendBinding(lp),lp.saveOriginalState())}this._lendAction(_d)}}_deactivateAction(_d){if(this._isActiveAction(_d)){const np=_d._propertyBindings;for(let ap=0,sp=np.length;ap!==sp;++ap){const lp=np[ap];--lp.useCount===0&&(lp.restoreOriginalState(),this._takeBackBinding(lp))}this._takeBackAction(_d)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const _d=this;this.stats={actions:{get total(){return _d._actions.length},get inUse(){return _d._nActiveActions}},bindings:{get total(){return _d._bindings.length},get inUse(){return _d._nActiveBindings}},controlInterpolants:{get total(){return _d._controlInterpolants.length},get inUse(){return _d._nActiveControlInterpolants}}}}_isActiveAction(_d){const np=_d._cacheIndex;return np!==null&&np<this._nActiveActions}_addInactiveAction(_d,np,ap){const sp=this._actions,lp=this._actionsByClip;let up=lp[np];if(up===void 0)up={knownActions:[_d],actionByRoot:{}},_d._byClipCacheIndex=0,lp[np]=up;else{const cp=up.knownActions;_d._byClipCacheIndex=cp.length,cp.push(_d)}_d._cacheIndex=sp.length,sp.push(_d),up.actionByRoot[ap]=_d}_removeInactiveAction(_d){const np=this._actions,ap=np[np.length-1],sp=_d._cacheIndex;ap._cacheIndex=sp,np[sp]=ap,np.pop(),_d._cacheIndex=null;const lp=_d._clip.uuid,up=this._actionsByClip,cp=up[lp],dp=cp.knownActions,hp=dp[dp.length-1],fp=_d._byClipCacheIndex;hp._byClipCacheIndex=fp,dp[fp]=hp,dp.pop(),_d._byClipCacheIndex=null;const pp=cp.actionByRoot,mp=(_d._localRoot||this._root).uuid;delete pp[mp],dp.length===0&&delete up[lp],this._removeInactiveBindingsForAction(_d)}_removeInactiveBindingsForAction(_d){const np=_d._propertyBindings;for(let ap=0,sp=np.length;ap!==sp;++ap){const lp=np[ap];--lp.referenceCount===0&&this._removeInactiveBinding(lp)}}_lendAction(_d){const np=this._actions,ap=_d._cacheIndex,sp=this._nActiveActions++,lp=np[sp];_d._cacheIndex=sp,np[sp]=_d,lp._cacheIndex=ap,np[ap]=lp}_takeBackAction(_d){const np=this._actions,ap=_d._cacheIndex,sp=--this._nActiveActions,lp=np[sp];_d._cacheIndex=sp,np[sp]=_d,lp._cacheIndex=ap,np[ap]=lp}_addInactiveBinding(_d,np,ap){const sp=this._bindingsByRootAndName,lp=this._bindings;let up=sp[np];up===void 0&&(up={},sp[np]=up),up[ap]=_d,_d._cacheIndex=lp.length,lp.push(_d)}_removeInactiveBinding(_d){const np=this._bindings,ap=_d.binding,sp=ap.rootNode.uuid,lp=ap.path,up=this._bindingsByRootAndName,cp=up[sp],dp=np[np.length-1],hp=_d._cacheIndex;dp._cacheIndex=hp,np[hp]=dp,np.pop(),delete cp[lp],Object.keys(cp).length===0&&delete up[sp]}_lendBinding(_d){const np=this._bindings,ap=_d._cacheIndex,sp=this._nActiveBindings++,lp=np[sp];_d._cacheIndex=sp,np[sp]=_d,lp._cacheIndex=ap,np[ap]=lp}_takeBackBinding(_d){const np=this._bindings,ap=_d._cacheIndex,sp=--this._nActiveBindings,lp=np[sp];_d._cacheIndex=sp,np[sp]=_d,lp._cacheIndex=ap,np[ap]=lp}_lendControlInterpolant(){const _d=this._controlInterpolants,np=this._nActiveControlInterpolants++;let ap=_d[np];return ap===void 0&&(ap=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),ap.__cacheIndex=np,_d[np]=ap),ap}_takeBackControlInterpolant(_d){const np=this._controlInterpolants,ap=_d.__cacheIndex,sp=--this._nActiveControlInterpolants,lp=np[sp];_d.__cacheIndex=sp,np[sp]=_d,lp.__cacheIndex=ap,np[ap]=lp}clipAction(_d,np,ap){const sp=np||this._root,lp=sp.uuid;let up=typeof _d=="string"?AnimationClip.findByName(sp,_d):_d;const cp=up!==null?up.uuid:_d,dp=this._actionsByClip[cp];let hp=null;if(ap===void 0&&(up!==null?ap=up.blendMode:ap=NormalAnimationBlendMode),dp!==void 0){const pp=dp.actionByRoot[lp];if(pp!==void 0&&pp.blendMode===ap)return pp;hp=dp.knownActions[0],up===null&&(up=hp._clip)}if(up===null)return null;const fp=new AnimationAction(this,up,np,ap);return this._bindAction(fp,hp),this._addInactiveAction(fp,cp,lp),fp}existingAction(_d,np){const ap=np||this._root,sp=ap.uuid,lp=typeof _d=="string"?AnimationClip.findByName(ap,_d):_d,up=lp?lp.uuid:_d,cp=this._actionsByClip[up];return cp!==void 0&&cp.actionByRoot[sp]||null}stopAllAction(){const _d=this._actions,np=this._nActiveActions;for(let ap=np-1;ap>=0;--ap)_d[ap].stop();return this}update(_d){_d*=this.timeScale;const np=this._actions,ap=this._nActiveActions,sp=this.time+=_d,lp=Math.sign(_d),up=this._accuIndex^=1;for(let hp=0;hp!==ap;++hp)np[hp]._update(sp,_d,lp,up);const cp=this._bindings,dp=this._nActiveBindings;for(let hp=0;hp!==dp;++hp)cp[hp].apply(up);return this}setTime(_d){this.time=0;for(let np=0;np<this._actions.length;np++)this._actions[np].time=0;return this.update(_d)}getRoot(){return this._root}uncacheClip(_d){const np=this._actions,ap=_d.uuid,sp=this._actionsByClip,lp=sp[ap];if(lp!==void 0){const up=lp.knownActions;for(let cp=0,dp=up.length;cp!==dp;++cp){const hp=up[cp];this._deactivateAction(hp);const fp=hp._cacheIndex,pp=np[np.length-1];hp._cacheIndex=null,hp._byClipCacheIndex=null,pp._cacheIndex=fp,np[fp]=pp,np.pop(),this._removeInactiveBindingsForAction(hp)}delete sp[ap]}}uncacheRoot(_d){const np=_d.uuid,ap=this._actionsByClip;for(const up in ap){const cp=ap[up].actionByRoot,dp=cp[np];dp!==void 0&&(this._deactivateAction(dp),this._removeInactiveAction(dp))}const sp=this._bindingsByRootAndName,lp=sp[np];if(lp!==void 0)for(const up in lp){const cp=lp[up];cp.restoreOriginalState(),this._removeInactiveBinding(cp)}}uncacheAction(_d,np){const ap=this.existingAction(_d,np);ap!==null&&(this._deactivateAction(ap),this._removeInactiveAction(ap))}}class Uniform{constructor(_d){this.value=_d}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let _id=0;class UniformsGroup extends EventDispatcher{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:_id++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(_d){return this.uniforms.push(_d),this}remove(_d){const np=this.uniforms.indexOf(_d);return np!==-1&&this.uniforms.splice(np,1),this}setName(_d){return this.name=_d,this}setUsage(_d){return this.usage=_d,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(_d){this.name=_d.name,this.usage=_d.usage;const np=_d.uniforms;this.uniforms.length=0;for(let ap=0,sp=np.length;ap<sp;ap++){const lp=Array.isArray(np[ap])?np[ap]:[np[ap]];for(let up=0;up<lp.length;up++)this.uniforms.push(lp[up].clone())}return this}clone(){return new this.constructor().copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(_d,np,ap=1){super(_d,np),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=ap}copy(_d){return super.copy(_d),this.meshPerAttribute=_d.meshPerAttribute,this}clone(_d){const np=super.clone(_d);return np.meshPerAttribute=this.meshPerAttribute,np}toJSON(_d){const np=super.toJSON(_d);return np.isInstancedInterleavedBuffer=!0,np.meshPerAttribute=this.meshPerAttribute,np}}class GLBufferAttribute{constructor(_d,np,ap,sp,lp){this.isGLBufferAttribute=!0,this.name="",this.buffer=_d,this.type=np,this.itemSize=ap,this.elementSize=sp,this.count=lp,this.version=0}set needsUpdate(_d){_d===!0&&this.version++}setBuffer(_d){return this.buffer=_d,this}setType(_d,np){return this.type=_d,this.elementSize=np,this}setItemSize(_d){return this.itemSize=_d,this}setCount(_d){return this.count=_d,this}}class Raycaster{constructor(_d,np,ap=0,sp=1/0){this.ray=new Ray(_d,np),this.near=ap,this.far=sp,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(_d,np){this.ray.set(_d,np)}setFromCamera(_d,np){np.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(np.matrixWorld),this.ray.direction.set(_d.x,_d.y,.5).unproject(np).sub(this.ray.origin).normalize(),this.camera=np):np.isOrthographicCamera?(this.ray.origin.set(_d.x,_d.y,(np.near+np.far)/(np.near-np.far)).unproject(np),this.ray.direction.set(0,0,-1).transformDirection(np.matrixWorld),this.camera=np):console.error("THREE.Raycaster: Unsupported camera type: "+np.type)}intersectObject(_d,np=!0,ap=[]){return intersectObject(_d,this,ap,np),ap.sort(ascSort),ap}intersectObjects(_d,np=!0,ap=[]){for(let sp=0,lp=_d.length;sp<lp;sp++)intersectObject(_d[sp],this,ap,np);return ap.sort(ascSort),ap}}function ascSort(rp,_d){return rp.distance-_d.distance}function intersectObject(rp,_d,np,ap){if(rp.layers.test(_d.layers)&&rp.raycast(_d,np),ap===!0){const sp=rp.children;for(let lp=0,up=sp.length;lp<up;lp++)intersectObject(sp[lp],_d,np,!0)}}class Spherical{constructor(_d=1,np=0,ap=0){return this.radius=_d,this.phi=np,this.theta=ap,this}set(_d,np,ap){return this.radius=_d,this.phi=np,this.theta=ap,this}copy(_d){return this.radius=_d.radius,this.phi=_d.phi,this.theta=_d.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(_d){return this.setFromCartesianCoords(_d.x,_d.y,_d.z)}setFromCartesianCoords(_d,np,ap){return this.radius=Math.sqrt(_d*_d+np*np+ap*ap),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_d,ap),this.phi=Math.acos(clamp(np/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(_d=1,np=0,ap=0){return this.radius=_d,this.theta=np,this.y=ap,this}set(_d,np,ap){return this.radius=_d,this.theta=np,this.y=ap,this}copy(_d){return this.radius=_d.radius,this.theta=_d.theta,this.y=_d.y,this}setFromVector3(_d){return this.setFromCartesianCoords(_d.x,_d.y,_d.z)}setFromCartesianCoords(_d,np,ap){return this.radius=Math.sqrt(_d*_d+ap*ap),this.theta=Math.atan2(_d,ap),this.y=np,this}clone(){return new this.constructor().copy(this)}}const _vector$4=new Vector2;class Box2{constructor(_d=new Vector2(1/0,1/0),np=new Vector2(-1/0,-1/0)){this.isBox2=!0,this.min=_d,this.max=np}set(_d,np){return this.min.copy(_d),this.max.copy(np),this}setFromPoints(_d){this.makeEmpty();for(let np=0,ap=_d.length;np<ap;np++)this.expandByPoint(_d[np]);return this}setFromCenterAndSize(_d,np){const ap=_vector$4.copy(np).multiplyScalar(.5);return this.min.copy(_d).sub(ap),this.max.copy(_d).add(ap),this}clone(){return new this.constructor().copy(this)}copy(_d){return this.min.copy(_d.min),this.max.copy(_d.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(_d){return this.isEmpty()?_d.set(0,0):_d.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_d){return this.isEmpty()?_d.set(0,0):_d.subVectors(this.max,this.min)}expandByPoint(_d){return this.min.min(_d),this.max.max(_d),this}expandByVector(_d){return this.min.sub(_d),this.max.add(_d),this}expandByScalar(_d){return this.min.addScalar(-_d),this.max.addScalar(_d),this}containsPoint(_d){return!(_d.x<this.min.x||_d.x>this.max.x||_d.y<this.min.y||_d.y>this.max.y)}containsBox(_d){return this.min.x<=_d.min.x&&_d.max.x<=this.max.x&&this.min.y<=_d.min.y&&_d.max.y<=this.max.y}getParameter(_d,np){return np.set((_d.x-this.min.x)/(this.max.x-this.min.x),(_d.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(_d){return!(_d.max.x<this.min.x||_d.min.x>this.max.x||_d.max.y<this.min.y||_d.min.y>this.max.y)}clampPoint(_d,np){return np.copy(_d).clamp(this.min,this.max)}distanceToPoint(_d){return this.clampPoint(_d,_vector$4).distanceTo(_d)}intersect(_d){return this.min.max(_d.min),this.max.min(_d.max),this.isEmpty()&&this.makeEmpty(),this}union(_d){return this.min.min(_d.min),this.max.max(_d.max),this}translate(_d){return this.min.add(_d),this.max.add(_d),this}equals(_d){return _d.min.equals(this.min)&&_d.max.equals(this.max)}}const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(_d=new Vector3,np=new Vector3){this.start=_d,this.end=np}set(_d,np){return this.start.copy(_d),this.end.copy(np),this}copy(_d){return this.start.copy(_d.start),this.end.copy(_d.end),this}getCenter(_d){return _d.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_d){return _d.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_d,np){return this.delta(np).multiplyScalar(_d).add(this.start)}closestPointToPointParameter(_d,np){_startP.subVectors(_d,this.start),_startEnd.subVectors(this.end,this.start);const ap=_startEnd.dot(_startEnd);let lp=_startEnd.dot(_startP)/ap;return np&&(lp=clamp(lp,0,1)),lp}closestPointToPoint(_d,np,ap){const sp=this.closestPointToPointParameter(_d,np);return this.delta(ap).multiplyScalar(sp).add(this.start)}applyMatrix4(_d){return this.start.applyMatrix4(_d),this.end.applyMatrix4(_d),this}equals(_d){return _d.start.equals(this.start)&&_d.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3=new Vector3;class SpotLightHelper extends Object3D{constructor(_d,np){super(),this.light=_d,this.matrix=_d.matrixWorld,this.matrixAutoUpdate=!1,this.color=np,this.type="SpotLightHelper";const ap=new BufferGeometry,sp=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let up=0,cp=1,dp=32;up<dp;up++,cp++){const hp=up/dp*Math.PI*2,fp=cp/dp*Math.PI*2;sp.push(Math.cos(hp),Math.sin(hp),1,Math.cos(fp),Math.sin(fp),1)}ap.setAttribute("position",new Float32BufferAttribute(sp,3));const lp=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(ap,lp),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const _d=this.light.distance?this.light.distance:1e3,np=_d*Math.tan(this.light.angle);this.cone.scale.set(np,np,_d),_vector$3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4;class SkeletonHelper extends LineSegments{constructor(_d){const np=getBoneList(_d),ap=new BufferGeometry,sp=[],lp=[],up=new Color(0,0,1),cp=new Color(0,1,0);for(let hp=0;hp<np.length;hp++){const fp=np[hp];fp.parent&&fp.parent.isBone&&(sp.push(0,0,0),sp.push(0,0,0),lp.push(up.r,up.g,up.b),lp.push(cp.r,cp.g,cp.b))}ap.setAttribute("position",new Float32BufferAttribute(sp,3)),ap.setAttribute("color",new Float32BufferAttribute(lp,3));const dp=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(ap,dp),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=_d,this.bones=np,this.matrix=_d.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(_d){const np=this.bones,ap=this.geometry,sp=ap.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(let lp=0,up=0;lp<np.length;lp++){const cp=np[lp];cp.parent&&cp.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,cp.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),sp.setXYZ(up,_vector$2.x,_vector$2.y,_vector$2.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,cp.parent.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),sp.setXYZ(up+1,_vector$2.x,_vector$2.y,_vector$2.z),up+=2)}ap.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(_d)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(rp){const _d=[];rp.isBone===!0&&_d.push(rp);for(let np=0;np<rp.children.length;np++)_d.push.apply(_d,getBoneList(rp.children[np]));return _d}class PointLightHelper extends Mesh{constructor(_d,np,ap){const sp=new SphereGeometry(np,4,2),lp=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});super(sp,lp),this.light=_d,this.color=ap,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1=new Vector3,_color1=new Color,_color2=new Color;class HemisphereLightHelper extends Object3D{constructor(_d,np,ap){super(),this.light=_d,this.matrix=_d.matrixWorld,this.matrixAutoUpdate=!1,this.color=ap,this.type="HemisphereLightHelper";const sp=new OctahedronGeometry(np);sp.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const lp=sp.getAttribute("position"),up=new Float32Array(lp.count*3);sp.setAttribute("color",new BufferAttribute(up,3)),this.add(new Mesh(sp,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const _d=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const np=_d.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let ap=0,sp=np.count;ap<sp;ap++){const lp=ap<sp/2?_color1:_color2;np.setXYZ(ap,lp.r,lp.g,lp.b)}np.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),_d.lookAt(_vector$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(_d=10,np=10,ap=4473924,sp=8947848){ap=new Color(ap),sp=new Color(sp);const lp=np/2,up=_d/np,cp=_d/2,dp=[],hp=[];for(let mp=0,gp=0,yp=-cp;mp<=np;mp++,yp+=up){dp.push(-cp,0,yp,cp,0,yp),dp.push(yp,0,-cp,yp,0,cp);const xp=mp===lp?ap:sp;xp.toArray(hp,gp),gp+=3,xp.toArray(hp,gp),gp+=3,xp.toArray(hp,gp),gp+=3,xp.toArray(hp,gp),gp+=3}const fp=new BufferGeometry;fp.setAttribute("position",new Float32BufferAttribute(dp,3)),fp.setAttribute("color",new Float32BufferAttribute(hp,3));const pp=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(fp,pp),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(_d=10,np=16,ap=8,sp=64,lp=4473924,up=8947848){lp=new Color(lp),up=new Color(up);const cp=[],dp=[];if(np>1)for(let pp=0;pp<np;pp++){const mp=pp/np*(Math.PI*2),gp=Math.sin(mp)*_d,yp=Math.cos(mp)*_d;cp.push(0,0,0),cp.push(gp,0,yp);const xp=pp&1?lp:up;dp.push(xp.r,xp.g,xp.b),dp.push(xp.r,xp.g,xp.b)}for(let pp=0;pp<ap;pp++){const mp=pp&1?lp:up,gp=_d-_d/ap*pp;for(let yp=0;yp<sp;yp++){let xp=yp/sp*(Math.PI*2),_p=Math.sin(xp)*gp,vp=Math.cos(xp)*gp;cp.push(_p,0,vp),dp.push(mp.r,mp.g,mp.b),xp=(yp+1)/sp*(Math.PI*2),_p=Math.sin(xp)*gp,vp=Math.cos(xp)*gp,cp.push(_p,0,vp),dp.push(mp.r,mp.g,mp.b)}}const hp=new BufferGeometry;hp.setAttribute("position",new Float32BufferAttribute(cp,3)),hp.setAttribute("color",new Float32BufferAttribute(dp,3));const fp=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(hp,fp),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1=new Vector3,_v2=new Vector3,_v3=new Vector3;class DirectionalLightHelper extends Object3D{constructor(_d,np,ap){super(),this.light=_d,this.matrix=_d.matrixWorld,this.matrixAutoUpdate=!1,this.color=ap,this.type="DirectionalLightHelper",np===void 0&&(np=1);let sp=new BufferGeometry;sp.setAttribute("position",new Float32BufferAttribute([-np,np,0,np,np,0,np,-np,0,-np,-np,0,-np,np,0],3));const lp=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line(sp,lp),this.add(this.lightPlane),sp=new BufferGeometry,sp.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(sp,lp),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1.setFromMatrixPosition(this.light.matrixWorld),_v2.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2,_v1),this.lightPlane.lookAt(_v2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2),this.targetLine.scale.z=_v3.length()}}const _vector=new Vector3,_camera=new Camera;class CameraHelper extends LineSegments{constructor(_d){const np=new BufferGeometry,ap=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),sp=[],lp=[],up={};cp("n1","n2"),cp("n2","n4"),cp("n4","n3"),cp("n3","n1"),cp("f1","f2"),cp("f2","f4"),cp("f4","f3"),cp("f3","f1"),cp("n1","f1"),cp("n2","f2"),cp("n3","f3"),cp("n4","f4"),cp("p","n1"),cp("p","n2"),cp("p","n3"),cp("p","n4"),cp("u1","u2"),cp("u2","u3"),cp("u3","u1"),cp("c","t"),cp("p","c"),cp("cn1","cn2"),cp("cn3","cn4"),cp("cf1","cf2"),cp("cf3","cf4");function cp(yp,xp){dp(yp),dp(xp)}function dp(yp){sp.push(0,0,0),lp.push(0,0,0),up[yp]===void 0&&(up[yp]=[]),up[yp].push(sp.length/3-1)}np.setAttribute("position",new Float32BufferAttribute(sp,3)),np.setAttribute("color",new Float32BufferAttribute(lp,3)),super(np,ap),this.type="CameraHelper",this.camera=_d,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_d.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=up,this.update();const hp=new Color(16755200),fp=new Color(16711680),pp=new Color(43775),mp=new Color(16777215),gp=new Color(3355443);this.setColors(hp,fp,pp,mp,gp)}setColors(_d,np,ap,sp,lp){const cp=this.geometry.getAttribute("color");cp.setXYZ(0,_d.r,_d.g,_d.b),cp.setXYZ(1,_d.r,_d.g,_d.b),cp.setXYZ(2,_d.r,_d.g,_d.b),cp.setXYZ(3,_d.r,_d.g,_d.b),cp.setXYZ(4,_d.r,_d.g,_d.b),cp.setXYZ(5,_d.r,_d.g,_d.b),cp.setXYZ(6,_d.r,_d.g,_d.b),cp.setXYZ(7,_d.r,_d.g,_d.b),cp.setXYZ(8,_d.r,_d.g,_d.b),cp.setXYZ(9,_d.r,_d.g,_d.b),cp.setXYZ(10,_d.r,_d.g,_d.b),cp.setXYZ(11,_d.r,_d.g,_d.b),cp.setXYZ(12,_d.r,_d.g,_d.b),cp.setXYZ(13,_d.r,_d.g,_d.b),cp.setXYZ(14,_d.r,_d.g,_d.b),cp.setXYZ(15,_d.r,_d.g,_d.b),cp.setXYZ(16,_d.r,_d.g,_d.b),cp.setXYZ(17,_d.r,_d.g,_d.b),cp.setXYZ(18,_d.r,_d.g,_d.b),cp.setXYZ(19,_d.r,_d.g,_d.b),cp.setXYZ(20,_d.r,_d.g,_d.b),cp.setXYZ(21,_d.r,_d.g,_d.b),cp.setXYZ(22,_d.r,_d.g,_d.b),cp.setXYZ(23,_d.r,_d.g,_d.b),cp.setXYZ(24,np.r,np.g,np.b),cp.setXYZ(25,np.r,np.g,np.b),cp.setXYZ(26,np.r,np.g,np.b),cp.setXYZ(27,np.r,np.g,np.b),cp.setXYZ(28,np.r,np.g,np.b),cp.setXYZ(29,np.r,np.g,np.b),cp.setXYZ(30,np.r,np.g,np.b),cp.setXYZ(31,np.r,np.g,np.b),cp.setXYZ(32,ap.r,ap.g,ap.b),cp.setXYZ(33,ap.r,ap.g,ap.b),cp.setXYZ(34,ap.r,ap.g,ap.b),cp.setXYZ(35,ap.r,ap.g,ap.b),cp.setXYZ(36,ap.r,ap.g,ap.b),cp.setXYZ(37,ap.r,ap.g,ap.b),cp.setXYZ(38,sp.r,sp.g,sp.b),cp.setXYZ(39,sp.r,sp.g,sp.b),cp.setXYZ(40,lp.r,lp.g,lp.b),cp.setXYZ(41,lp.r,lp.g,lp.b),cp.setXYZ(42,lp.r,lp.g,lp.b),cp.setXYZ(43,lp.r,lp.g,lp.b),cp.setXYZ(44,lp.r,lp.g,lp.b),cp.setXYZ(45,lp.r,lp.g,lp.b),cp.setXYZ(46,lp.r,lp.g,lp.b),cp.setXYZ(47,lp.r,lp.g,lp.b),cp.setXYZ(48,lp.r,lp.g,lp.b),cp.setXYZ(49,lp.r,lp.g,lp.b),cp.needsUpdate=!0}update(){const _d=this.geometry,np=this.pointMap,ap=1,sp=1;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",np,_d,_camera,0,0,-1),setPoint("t",np,_d,_camera,0,0,1),setPoint("n1",np,_d,_camera,-ap,-sp,-1),setPoint("n2",np,_d,_camera,ap,-sp,-1),setPoint("n3",np,_d,_camera,-ap,sp,-1),setPoint("n4",np,_d,_camera,ap,sp,-1),setPoint("f1",np,_d,_camera,-ap,-sp,1),setPoint("f2",np,_d,_camera,ap,-sp,1),setPoint("f3",np,_d,_camera,-ap,sp,1),setPoint("f4",np,_d,_camera,ap,sp,1),setPoint("u1",np,_d,_camera,ap*.7,sp*1.1,-1),setPoint("u2",np,_d,_camera,-ap*.7,sp*1.1,-1),setPoint("u3",np,_d,_camera,0,sp*2,-1),setPoint("cf1",np,_d,_camera,-ap,0,1),setPoint("cf2",np,_d,_camera,ap,0,1),setPoint("cf3",np,_d,_camera,0,-sp,1),setPoint("cf4",np,_d,_camera,0,sp,1),setPoint("cn1",np,_d,_camera,-ap,0,-1),setPoint("cn2",np,_d,_camera,ap,0,-1),setPoint("cn3",np,_d,_camera,0,-sp,-1),setPoint("cn4",np,_d,_camera,0,sp,-1),_d.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(rp,_d,np,ap,sp,lp,up){_vector.set(sp,lp,up).unproject(ap);const cp=_d[rp];if(cp!==void 0){const dp=np.getAttribute("position");for(let hp=0,fp=cp.length;hp<fp;hp++)dp.setXYZ(cp[hp],_vector.x,_vector.y,_vector.z)}}const _box=new Box3;class BoxHelper extends LineSegments{constructor(_d,np=16776960){const ap=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),sp=new Float32Array(8*3),lp=new BufferGeometry;lp.setIndex(new BufferAttribute(ap,1)),lp.setAttribute("position",new BufferAttribute(sp,3)),super(lp,new LineBasicMaterial({color:np,toneMapped:!1})),this.object=_d,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(_d){if(_d!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box.setFromObject(this.object),_box.isEmpty())return;const np=_box.min,ap=_box.max,sp=this.geometry.attributes.position,lp=sp.array;lp[0]=ap.x,lp[1]=ap.y,lp[2]=ap.z,lp[3]=np.x,lp[4]=ap.y,lp[5]=ap.z,lp[6]=np.x,lp[7]=np.y,lp[8]=ap.z,lp[9]=ap.x,lp[10]=np.y,lp[11]=ap.z,lp[12]=ap.x,lp[13]=ap.y,lp[14]=np.z,lp[15]=np.x,lp[16]=ap.y,lp[17]=np.z,lp[18]=np.x,lp[19]=np.y,lp[20]=np.z,lp[21]=ap.x,lp[22]=np.y,lp[23]=np.z,sp.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(_d){return this.object=_d,this.update(),this}copy(_d,np){return super.copy(_d,np),this.object=_d.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(_d,np=16776960){const ap=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),sp=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],lp=new BufferGeometry;lp.setIndex(new BufferAttribute(ap,1)),lp.setAttribute("position",new Float32BufferAttribute(sp,3)),super(lp,new LineBasicMaterial({color:np,toneMapped:!1})),this.box=_d,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(_d){const np=this.box;np.isEmpty()||(np.getCenter(this.position),np.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(_d))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line{constructor(_d,np=1,ap=16776960){const sp=ap,lp=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],up=new BufferGeometry;up.setAttribute("position",new Float32BufferAttribute(lp,3)),up.computeBoundingSphere(),super(up,new LineBasicMaterial({color:sp,toneMapped:!1})),this.type="PlaneHelper",this.plane=_d,this.size=np;const cp=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],dp=new BufferGeometry;dp.setAttribute("position",new Float32BufferAttribute(cp,3)),dp.computeBoundingSphere(),this.add(new Mesh(dp,new MeshBasicMaterial({color:sp,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(_d){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(_d)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis=new Vector3;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D{constructor(_d=new Vector3(0,0,1),np=new Vector3(0,0,0),ap=1,sp=16776960,lp=ap*.2,up=lp*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(np),this.line=new Line(_lineGeometry,new LineBasicMaterial({color:sp,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:sp,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_d),this.setLength(ap,lp,up)}setDirection(_d){if(_d.y>.99999)this.quaternion.set(0,0,0,1);else if(_d.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(_d.z,0,-_d.x).normalize();const np=Math.acos(_d.y);this.quaternion.setFromAxisAngle(_axis,np)}}setLength(_d,np=_d*.2,ap=np*.2){this.line.scale.set(1,Math.max(1e-4,_d-np),1),this.line.updateMatrix(),this.cone.scale.set(ap,np,ap),this.cone.position.y=_d,this.cone.updateMatrix()}setColor(_d){this.line.material.color.set(_d),this.cone.material.color.set(_d)}copy(_d){return super.copy(_d,!1),this.line.copy(_d.line),this.cone.copy(_d.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(_d=1){const np=[0,0,0,_d,0,0,0,0,0,0,_d,0,0,0,0,0,0,_d],ap=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],sp=new BufferGeometry;sp.setAttribute("position",new Float32BufferAttribute(np,3)),sp.setAttribute("color",new Float32BufferAttribute(ap,3));const lp=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(sp,lp),this.type="AxesHelper"}setColors(_d,np,ap){const sp=new Color,lp=this.geometry.attributes.color.array;return sp.set(_d),sp.toArray(lp,0),sp.toArray(lp,3),sp.set(np),sp.toArray(lp,6),sp.toArray(lp,9),sp.set(ap),sp.toArray(lp,12),sp.toArray(lp,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}moveTo(_d,np){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_d,np),this}lineTo(_d,np){return this.currentPath.lineTo(_d,np),this}quadraticCurveTo(_d,np,ap,sp){return this.currentPath.quadraticCurveTo(_d,np,ap,sp),this}bezierCurveTo(_d,np,ap,sp,lp,up){return this.currentPath.bezierCurveTo(_d,np,ap,sp,lp,up),this}splineThru(_d){return this.currentPath.splineThru(_d),this}toShapes(_d){function np(vp){const bp=[];for(let Ep=0,Sp=vp.length;Ep<Sp;Ep++){const Ap=vp[Ep],Rp=new Shape;Rp.curves=Ap.curves,bp.push(Rp)}return bp}function ap(vp,bp){const Ep=bp.length;let Sp=!1;for(let Ap=Ep-1,Rp=0;Rp<Ep;Ap=Rp++){let Tp=bp[Ap],Mp=bp[Rp],Op=Mp.x-Tp.x,Pp=Mp.y-Tp.y;if(Math.abs(Pp)>Number.EPSILON){if(Pp<0&&(Tp=bp[Rp],Op=-Op,Mp=bp[Ap],Pp=-Pp),vp.y<Tp.y||vp.y>Mp.y)continue;if(vp.y===Tp.y){if(vp.x===Tp.x)return!0}else{const $p=Pp*(vp.x-Tp.x)-Op*(vp.y-Tp.y);if($p===0)return!0;if($p<0)continue;Sp=!Sp}}else{if(vp.y!==Tp.y)continue;if(Mp.x<=vp.x&&vp.x<=Tp.x||Tp.x<=vp.x&&vp.x<=Mp.x)return!0}}return Sp}const sp=ShapeUtils.isClockWise,lp=this.subPaths;if(lp.length===0)return[];let up,cp,dp;const hp=[];if(lp.length===1)return cp=lp[0],dp=new Shape,dp.curves=cp.curves,hp.push(dp),hp;let fp=!sp(lp[0].getPoints());fp=_d?!fp:fp;const pp=[],mp=[];let gp=[],yp=0,xp;mp[yp]=void 0,gp[yp]=[];for(let vp=0,bp=lp.length;vp<bp;vp++)cp=lp[vp],xp=cp.getPoints(),up=sp(xp),up=_d?!up:up,up?(!fp&&mp[yp]&&yp++,mp[yp]={s:new Shape,p:xp},mp[yp].s.curves=cp.curves,fp&&yp++,gp[yp]=[]):gp[yp].push({h:cp,p:xp[0]});if(!mp[0])return np(lp);if(mp.length>1){let vp=!1,bp=0;for(let Ep=0,Sp=mp.length;Ep<Sp;Ep++)pp[Ep]=[];for(let Ep=0,Sp=mp.length;Ep<Sp;Ep++){const Ap=gp[Ep];for(let Rp=0;Rp<Ap.length;Rp++){const Tp=Ap[Rp];let Mp=!0;for(let Op=0;Op<mp.length;Op++)ap(Tp.p,mp[Op].p)&&(Ep!==Op&&bp++,Mp?(Mp=!1,pp[Op].push(Tp)):vp=!0);Mp&&pp[Ep].push(Tp)}}bp>0&&vp===!1&&(gp=pp)}let _p;for(let vp=0,bp=mp.length;vp<bp;vp++){dp=mp[vp].s,hp.push(dp),_p=gp[vp];for(let Ep=0,Sp=_p.length;Ep<Sp;Ep++)dp.holes.push(_p[Ep].h)}return hp}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const THREE=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping,AddEquation,AddOperation,AdditiveAnimationBlendMode,AdditiveBlending,AgXToneMapping,AlphaFormat,AlwaysCompare,AlwaysDepth,AlwaysStencilFunc,AmbientLight,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,AttachedBindMode,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BackSide,BasicDepthPacking,BasicShadowMap,BatchedMesh,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,Cache,Camera,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CineonToneMapping,CircleGeometry,ClampToEdgeWrapping,Clock,Color,ColorKeyframeTrack,ColorManagement,CompressedArrayTexture,CompressedCubeTexture,CompressedTexture,CompressedTextureLoader,ConeGeometry,ConstantAlphaFactor,ConstantColorFactor,CubeCamera,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomToneMapping,CylinderGeometry,Cylindrical,Data3DTexture,DataArrayTexture,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DepthFormat,DepthStencilFormat,DepthTexture,DetachedBindMode,DirectionalLight,DirectionalLightHelper,DiscreteInterpolant,DisplayP3ColorSpace,DodecahedronGeometry,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualCompare,EqualDepth,EqualStencilFunc,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventDispatcher,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,Float64BufferAttribute,FloatType,Fog,FogExp2,FramebufferTexture,FrontSide,Frustum,GLBufferAttribute,GLSL1,GLSL3,GreaterCompare,GreaterDepth,GreaterEqualCompare,GreaterEqualDepth,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group,HalfFloatType,HemisphereLight,HemisphereLightHelper,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheGeometry,Layers,LessCompare,LessDepth,LessEqualCompare,LessEqualDepth,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearDisplayP3ColorSpace,LinearEncoding,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,LinearSRGBColorSpace:LinearSRGBColorSpace$1,LinearToneMapping,LinearTransfer,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,MOUSE,Material,MaterialLoader,MathUtils,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiplyBlending,MultiplyOperation,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NeverCompare,NeverDepth,NeverStencilFunc,NoBlending,NoColorSpace:NoColorSpace$1,NoToneMapping,NormalAnimationBlendMode,NormalBlending,NotEqualCompare,NotEqualDepth,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronGeometry,OneFactor,OneMinusConstantAlphaFactor,OneMinusConstantColorFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OrthographicCamera,P3Primaries,PCFShadowMap,PCFSoftShadowMap,PMREMGenerator,Path,PerspectiveCamera:PerspectiveCamera$1,Plane,PlaneGeometry,PlaneHelper,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format,RED_RGTC1_Format,REVISION,RGBADepthPacking,RGBAFormat,RGBAIntegerFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGB_BPTC_SIGNED_Format,RGB_BPTC_UNSIGNED_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RGFormat,RGIntegerFormat,RawShaderMaterial,Ray,Raycaster,Rec709Primaries,RectAreaLight,RedFormat,RedIntegerFormat,ReinhardToneMapping,RenderTarget,RepeatWrapping,ReplaceStencilOp,ReverseSubtractEquation,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format,SRGBColorSpace:SRGBColorSpace$1,SRGBTransfer,Scene,ShaderChunk,ShaderLib,ShaderMaterial,ShadowMaterial,Shape,ShapeGeometry,ShapePath,ShapeUtils,ShortType,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight,SpotLightHelper,Sprite,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation,SubtractiveBlending,TOUCH,TangentSpaceNormalMap,TetrahedronGeometry,Texture,TextureLoader,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,UVMapping,Uint16BufferAttribute,Uint32BufferAttribute,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,UniformsLib,UniformsUtils,UnsignedByteType,UnsignedInt248Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShortType,VSMShadowMap,Vector2,Vector3,Vector4,VectorKeyframeTrack,VideoTexture,WebGL1Renderer,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCoordinateSystem,WebGLCubeRenderTarget,WebGLMultipleRenderTargets,WebGLRenderTarget,WebGLRenderer,WebGLUtils,WebGPUCoordinateSystem,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,ZeroStencilOp,_SRGBAFormat,createCanvasElement,sRGBEncoding},Symbol.toStringTag,{value:"Module"}));var constants={exports:{}},reactReconcilerConstants_production_min={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */reactReconcilerConstants_production_min.ConcurrentRoot=1;reactReconcilerConstants_production_min.ContinuousEventPriority=4;reactReconcilerConstants_production_min.DefaultEventPriority=16;reactReconcilerConstants_production_min.DiscreteEventPriority=1;reactReconcilerConstants_production_min.IdleEventPriority=536870912;reactReconcilerConstants_production_min.LegacyRoot=0;constants.exports=reactReconcilerConstants_production_min;var constantsExports=constants.exports;function createStore$1(rp){let _d;const np=new Set,ap=(hp,fp)=>{const pp=typeof hp=="function"?hp(_d):hp;if(pp!==_d){const mp=_d;_d=fp?pp:Object.assign({},_d,pp),np.forEach(gp=>gp(_d,mp))}},sp=()=>_d,lp=(hp,fp=sp,pp=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let mp=fp(_d);function gp(){const yp=fp(_d);if(!pp(mp,yp)){const xp=mp;hp(mp=yp,xp)}}return np.add(gp),()=>np.delete(gp)},dp={setState:ap,getState:sp,subscribe:(hp,fp,pp)=>fp||pp?lp(hp,fp,pp):(np.add(hp),()=>np.delete(hp)),destroy:()=>np.clear()};return _d=rp(ap,sp,dp),dp}const isSSR=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect$1=isSSR?reactExports.useEffect:reactExports.useLayoutEffect;function create$1(rp){const _d=typeof rp=="function"?createStore$1(rp):rp,np=(ap=_d.getState,sp=Object.is)=>{const[,lp]=reactExports.useReducer(_p=>_p+1,0),up=_d.getState(),cp=reactExports.useRef(up),dp=reactExports.useRef(ap),hp=reactExports.useRef(sp),fp=reactExports.useRef(!1),pp=reactExports.useRef();pp.current===void 0&&(pp.current=ap(up));let mp,gp=!1;(cp.current!==up||dp.current!==ap||hp.current!==sp||fp.current)&&(mp=ap(up),gp=!sp(pp.current,mp)),useIsomorphicLayoutEffect$1(()=>{gp&&(pp.current=mp),cp.current=up,dp.current=ap,hp.current=sp,fp.current=!1});const yp=reactExports.useRef(up);useIsomorphicLayoutEffect$1(()=>{const _p=()=>{try{const bp=_d.getState(),Ep=dp.current(bp);hp.current(pp.current,Ep)||(cp.current=bp,pp.current=Ep,lp())}catch{fp.current=!0,lp()}},vp=_d.subscribe(_p);return _d.getState()!==yp.current&&_p(),vp},[]);const xp=gp?mp:pp.current;return reactExports.useDebugValue(xp),xp};return Object.assign(np,_d),np[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const ap=[np,_d];return{next(){const sp=ap.length<=0;return{value:ap.shift(),done:sp}}}},np}var reactReconciler={exports:{}},scheduler$1={exports:{}},scheduler_production_min$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(rp){function _d(Ip,kp){var Up=Ip.length;Ip.push(kp);e:for(;0<Up;){var Gp=Up-1>>>1,Wp=Ip[Gp];if(0<sp(Wp,kp))Ip[Gp]=kp,Ip[Up]=Wp,Up=Gp;else break e}}function np(Ip){return Ip.length===0?null:Ip[0]}function ap(Ip){if(Ip.length===0)return null;var kp=Ip[0],Up=Ip.pop();if(Up!==kp){Ip[0]=Up;e:for(var Gp=0,Wp=Ip.length,Qp=Wp>>>1;Gp<Qp;){var Xp=2*(Gp+1)-1,rm=Ip[Xp],Kp=Xp+1,lm=Ip[Kp];if(0>sp(rm,Up))Kp<Wp&&0>sp(lm,rm)?(Ip[Gp]=lm,Ip[Kp]=Up,Gp=Kp):(Ip[Gp]=rm,Ip[Xp]=Up,Gp=Xp);else if(Kp<Wp&&0>sp(lm,Up))Ip[Gp]=lm,Ip[Kp]=Up,Gp=Kp;else break e}}return kp}function sp(Ip,kp){var Up=Ip.sortIndex-kp.sortIndex;return Up!==0?Up:Ip.id-kp.id}if(typeof performance=="object"&&typeof performance.now=="function"){var lp=performance;rp.unstable_now=function(){return lp.now()}}else{var up=Date,cp=up.now();rp.unstable_now=function(){return up.now()-cp}}var dp=[],hp=[],fp=1,pp=null,mp=3,gp=!1,yp=!1,xp=!1,_p=typeof setTimeout=="function"?setTimeout:null,vp=typeof clearTimeout=="function"?clearTimeout:null,bp=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Ep(Ip){for(var kp=np(hp);kp!==null;){if(kp.callback===null)ap(hp);else if(kp.startTime<=Ip)ap(hp),kp.sortIndex=kp.expirationTime,_d(dp,kp);else break;kp=np(hp)}}function Sp(Ip){if(xp=!1,Ep(Ip),!yp)if(np(dp)!==null)yp=!0,Lp(Ap);else{var kp=np(hp);kp!==null&&Bp(Sp,kp.startTime-Ip)}}function Ap(Ip,kp){yp=!1,xp&&(xp=!1,vp(Mp),Mp=-1),gp=!0;var Up=mp;try{for(Ep(kp),pp=np(dp);pp!==null&&(!(pp.expirationTime>kp)||Ip&&!$p());){var Gp=pp.callback;if(typeof Gp=="function"){pp.callback=null,mp=pp.priorityLevel;var Wp=Gp(pp.expirationTime<=kp);kp=rp.unstable_now(),typeof Wp=="function"?pp.callback=Wp:pp===np(dp)&&ap(dp),Ep(kp)}else ap(dp);pp=np(dp)}if(pp!==null)var Qp=!0;else{var Xp=np(hp);Xp!==null&&Bp(Sp,Xp.startTime-kp),Qp=!1}return Qp}finally{pp=null,mp=Up,gp=!1}}var Rp=!1,Tp=null,Mp=-1,Op=5,Pp=-1;function $p(){return!(rp.unstable_now()-Pp<Op)}function zp(){if(Tp!==null){var Ip=rp.unstable_now();Pp=Ip;var kp=!0;try{kp=Tp(!0,Ip)}finally{kp?Dp():(Rp=!1,Tp=null)}}else Rp=!1}var Dp;if(typeof bp=="function")Dp=function(){bp(zp)};else if(typeof MessageChannel<"u"){var Fp=new MessageChannel,jp=Fp.port2;Fp.port1.onmessage=zp,Dp=function(){jp.postMessage(null)}}else Dp=function(){_p(zp,0)};function Lp(Ip){Tp=Ip,Rp||(Rp=!0,Dp())}function Bp(Ip,kp){Mp=_p(function(){Ip(rp.unstable_now())},kp)}rp.unstable_IdlePriority=5,rp.unstable_ImmediatePriority=1,rp.unstable_LowPriority=4,rp.unstable_NormalPriority=3,rp.unstable_Profiling=null,rp.unstable_UserBlockingPriority=2,rp.unstable_cancelCallback=function(Ip){Ip.callback=null},rp.unstable_continueExecution=function(){yp||gp||(yp=!0,Lp(Ap))},rp.unstable_forceFrameRate=function(Ip){0>Ip||125<Ip?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Op=0<Ip?Math.floor(1e3/Ip):5},rp.unstable_getCurrentPriorityLevel=function(){return mp},rp.unstable_getFirstCallbackNode=function(){return np(dp)},rp.unstable_next=function(Ip){switch(mp){case 1:case 2:case 3:var kp=3;break;default:kp=mp}var Up=mp;mp=kp;try{return Ip()}finally{mp=Up}},rp.unstable_pauseExecution=function(){},rp.unstable_requestPaint=function(){},rp.unstable_runWithPriority=function(Ip,kp){switch(Ip){case 1:case 2:case 3:case 4:case 5:break;default:Ip=3}var Up=mp;mp=Ip;try{return kp()}finally{mp=Up}},rp.unstable_scheduleCallback=function(Ip,kp,Up){var Gp=rp.unstable_now();switch(typeof Up=="object"&&Up!==null?(Up=Up.delay,Up=typeof Up=="number"&&0<Up?Gp+Up:Gp):Up=Gp,Ip){case 1:var Wp=-1;break;case 2:Wp=250;break;case 5:Wp=1073741823;break;case 4:Wp=1e4;break;default:Wp=5e3}return Wp=Up+Wp,Ip={id:fp++,callback:kp,priorityLevel:Ip,startTime:Up,expirationTime:Wp,sortIndex:-1},Up>Gp?(Ip.sortIndex=Up,_d(hp,Ip),np(dp)===null&&Ip===np(hp)&&(xp?(vp(Mp),Mp=-1):xp=!0,Bp(Sp,Up-Gp))):(Ip.sortIndex=Wp,_d(dp,Ip),yp||gp||(yp=!0,Lp(Ap))),Ip},rp.unstable_shouldYield=$p,rp.unstable_wrapCallback=function(Ip){var kp=mp;return function(){var Up=mp;mp=kp;try{return Ip.apply(this,arguments)}finally{mp=Up}}}}(scheduler_production_min$1)),scheduler_production_min$1}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler$1.exports=requireScheduler_production_min()),scheduler$1.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var reactReconciler_production_min=function rp(_d){var np={},ap=reactExports,sp=requireScheduler(),lp=Object.assign;function up(wp){for(var Cp="https://reactjs.org/docs/error-decoder.html?invariant="+wp,Np=1;Np<arguments.length;Np++)Cp+="&args[]="+encodeURIComponent(arguments[Np]);return"Minified React error #"+wp+"; visit "+Cp+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cp=ap.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dp=Symbol.for("react.element"),hp=Symbol.for("react.portal"),fp=Symbol.for("react.fragment"),pp=Symbol.for("react.strict_mode"),mp=Symbol.for("react.profiler"),gp=Symbol.for("react.provider"),yp=Symbol.for("react.context"),xp=Symbol.for("react.forward_ref"),_p=Symbol.for("react.suspense"),vp=Symbol.for("react.suspense_list"),bp=Symbol.for("react.memo"),Ep=Symbol.for("react.lazy"),Sp=Symbol.for("react.offscreen"),Ap=Symbol.iterator;function Rp(wp){return wp===null||typeof wp!="object"?null:(wp=Ap&&wp[Ap]||wp["@@iterator"],typeof wp=="function"?wp:null)}function Tp(wp){if(wp==null)return null;if(typeof wp=="function")return wp.displayName||wp.name||null;if(typeof wp=="string")return wp;switch(wp){case fp:return"Fragment";case hp:return"Portal";case mp:return"Profiler";case pp:return"StrictMode";case _p:return"Suspense";case vp:return"SuspenseList"}if(typeof wp=="object")switch(wp.$$typeof){case yp:return(wp.displayName||"Context")+".Consumer";case gp:return(wp._context.displayName||"Context")+".Provider";case xp:var Cp=wp.render;return wp=wp.displayName,wp||(wp=Cp.displayName||Cp.name||"",wp=wp!==""?"ForwardRef("+wp+")":"ForwardRef"),wp;case bp:return Cp=wp.displayName||null,Cp!==null?Cp:Tp(wp.type)||"Memo";case Ep:Cp=wp._payload,wp=wp._init;try{return Tp(wp(Cp))}catch{}}return null}function Mp(wp){var Cp=wp.type;switch(wp.tag){case 24:return"Cache";case 9:return(Cp.displayName||"Context")+".Consumer";case 10:return(Cp._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return wp=Cp.render,wp=wp.displayName||wp.name||"",Cp.displayName||(wp!==""?"ForwardRef("+wp+")":"ForwardRef");case 7:return"Fragment";case 5:return Cp;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tp(Cp);case 8:return Cp===pp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof Cp=="function")return Cp.displayName||Cp.name||null;if(typeof Cp=="string")return Cp}return null}function Op(wp){var Cp=wp,Np=wp;if(wp.alternate)for(;Cp.return;)Cp=Cp.return;else{wp=Cp;do Cp=wp,Cp.flags&4098&&(Np=Cp.return),wp=Cp.return;while(wp)}return Cp.tag===3?Np:null}function Pp(wp){if(Op(wp)!==wp)throw Error(up(188))}function $p(wp){var Cp=wp.alternate;if(!Cp){if(Cp=Op(wp),Cp===null)throw Error(up(188));return Cp!==wp?null:wp}for(var Np=wp,Vp=Cp;;){var Hp=Np.return;if(Hp===null)break;var qp=Hp.alternate;if(qp===null){if(Vp=Hp.return,Vp!==null){Np=Vp;continue}break}if(Hp.child===qp.child){for(qp=Hp.child;qp;){if(qp===Np)return Pp(Hp),wp;if(qp===Vp)return Pp(Hp),Cp;qp=qp.sibling}throw Error(up(188))}if(Np.return!==Vp.return)Np=Hp,Vp=qp;else{for(var om=!1,vm=Hp.child;vm;){if(vm===Np){om=!0,Np=Hp,Vp=qp;break}if(vm===Vp){om=!0,Vp=Hp,Np=qp;break}vm=vm.sibling}if(!om){for(vm=qp.child;vm;){if(vm===Np){om=!0,Np=qp,Vp=Hp;break}if(vm===Vp){om=!0,Vp=qp,Np=Hp;break}vm=vm.sibling}if(!om)throw Error(up(189))}}if(Np.alternate!==Vp)throw Error(up(190))}if(Np.tag!==3)throw Error(up(188));return Np.stateNode.current===Np?wp:Cp}function zp(wp){return wp=$p(wp),wp!==null?Dp(wp):null}function Dp(wp){if(wp.tag===5||wp.tag===6)return wp;for(wp=wp.child;wp!==null;){var Cp=Dp(wp);if(Cp!==null)return Cp;wp=wp.sibling}return null}function Fp(wp){if(wp.tag===5||wp.tag===6)return wp;for(wp=wp.child;wp!==null;){if(wp.tag!==4){var Cp=Fp(wp);if(Cp!==null)return Cp}wp=wp.sibling}return null}var jp=Array.isArray,Lp=_d.getPublicInstance,Bp=_d.getRootHostContext,Ip=_d.getChildHostContext,kp=_d.prepareForCommit,Up=_d.resetAfterCommit,Gp=_d.createInstance,Wp=_d.appendInitialChild,Qp=_d.finalizeInitialChildren,Xp=_d.prepareUpdate,rm=_d.shouldSetTextContent,Kp=_d.createTextInstance,lm=_d.scheduleTimeout,cm=_d.cancelTimeout,gm=_d.noTimeout,Mm=_d.isPrimaryRenderer,dm=_d.supportsMutation,em=_d.supportsPersistence,sm=_d.supportsHydration,Zp=_d.getInstanceFromNode,mm=_d.preparePortalMount,fm=_d.getCurrentEventPriority,_m=_d.detachDeletedInstance,zm=_d.supportsMicrotasks,tm=_d.scheduleMicrotask,Jp=_d.supportsTestSelectors,pm=_d.findFiberRoot,km=_d.getBoundingRect,ym=_d.getTextContent,Em=_d.isHiddenSubtree,Bm=_d.matchAccessibilityRole,Pm=_d.setFocusIfFocusable,Im=_d.setupIntersectionObserver,Dm=_d.appendChild,jm=_d.appendChildToContainer,Fm=_d.commitTextUpdate,av=_d.commitMount,lv=_d.commitUpdate,tv=_d.insertBefore,Jm=_d.insertInContainerBefore,um=_d.removeChild,Yp=_d.removeChildFromContainer,hm=_d.resetTextContent,wm=_d.hideInstance,Cm=_d.hideTextInstance,Vm=_d.unhideInstance,im=_d.unhideTextInstance,Am=_d.clearContainer,Lm=_d.cloneInstance,Um=_d.createContainerChildSet,Gm=_d.appendChildToContainerChildSet,ev=_d.finalizeContainerChildren,nv=_d.replaceContainerChildren,gv=_d.cloneHiddenInstance,xv=_d.cloneHiddenTextInstance,pv=_d.canHydrateInstance,Iv=_d.canHydrateTextInstance,Bv=_d.canHydrateSuspenseInstance,xy=_d.isSuspenseInstancePending,_0=_d.isSuspenseInstanceFallback,i0=_d.registerSuspenseInstanceRetry,Vy=_d.getNextHydratableSibling,a0=_d.getFirstHydratableChild,V0=_d.getFirstHydratableChildWithinContainer,z0=_d.getFirstHydratableChildWithinSuspenseInstance,$1=_d.hydrateInstance,B1=_d.hydrateTextInstance,F1=_d.hydrateSuspenseInstance,am=_d.getNextHydratableInstanceAfterSuspenseInstance,bm=_d.commitHydratedContainer,Tm=_d.commitHydratedSuspenseInstance,Nm=_d.clearSuspenseBoundary,Rm=_d.clearSuspenseBoundaryFromContainer,Xm=_d.shouldDeleteUnhydratedTailInstances,Zm=_d.didNotMatchHydratedContainerTextInstance,iv=_d.didNotMatchHydratedTextInstance,ov;function cv(wp){if(ov===void 0)try{throw Error()}catch(Np){var Cp=Np.stack.trim().match(/\n( *(at )?)/);ov=Cp&&Cp[1]||""}return`
`+ov+wp}var uv=!1;function dv(wp,Cp){if(!wp||uv)return"";uv=!0;var Np=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(Cp)if(Cp=function(){throw Error()},Object.defineProperty(Cp.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Cp,[])}catch(Hm){var Vp=Hm}Reflect.construct(wp,[],Cp)}else{try{Cp.call()}catch(Hm){Vp=Hm}wp.call(Cp.prototype)}else{try{throw Error()}catch(Hm){Vp=Hm}wp()}}catch(Hm){if(Hm&&Vp&&typeof Hm.stack=="string"){for(var Hp=Hm.stack.split(`
`),qp=Vp.stack.split(`
`),om=Hp.length-1,vm=qp.length-1;1<=om&&0<=vm&&Hp[om]!==qp[vm];)vm--;for(;1<=om&&0<=vm;om--,vm--)if(Hp[om]!==qp[vm]){if(om!==1||vm!==1)do if(om--,vm--,0>vm||Hp[om]!==qp[vm]){var $m=`
`+Hp[om].replace(" at new "," at ");return wp.displayName&&$m.includes("<anonymous>")&&($m=$m.replace("<anonymous>",wp.displayName)),$m}while(1<=om&&0<=vm);break}}}finally{uv=!1,Error.prepareStackTrace=Np}return(wp=wp?wp.displayName||wp.name:"")?cv(wp):""}var Tv=Object.prototype.hasOwnProperty,Gv=[],Av=-1;function Fv(wp){return{current:wp}}function sv(wp){0>Av||(wp.current=Gv[Av],Gv[Av]=null,Av--)}function Km(wp,Cp){Av++,Gv[Av]=wp.current,wp.current=Cp}var ly={},vv=Fv(ly),Pv=Fv(!1),Sy=ly;function uy(wp,Cp){var Np=wp.type.contextTypes;if(!Np)return ly;var Vp=wp.stateNode;if(Vp&&Vp.__reactInternalMemoizedUnmaskedChildContext===Cp)return Vp.__reactInternalMemoizedMaskedChildContext;var Hp={},qp;for(qp in Np)Hp[qp]=Cp[qp];return Vp&&(wp=wp.stateNode,wp.__reactInternalMemoizedUnmaskedChildContext=Cp,wp.__reactInternalMemoizedMaskedChildContext=Hp),Hp}function Vv(wp){return wp=wp.childContextTypes,wp!=null}function Ov(){sv(Pv),sv(vv)}function wy(wp,Cp,Np){if(vv.current!==ly)throw Error(up(168));Km(vv,Cp),Km(Pv,Np)}function o0(wp,Cp,Np){var Vp=wp.stateNode;if(Cp=Cp.childContextTypes,typeof Vp.getChildContext!="function")return Np;Vp=Vp.getChildContext();for(var Hp in Vp)if(!(Hp in Cp))throw Error(up(108,Mp(wp)||"Unknown",Hp));return lp({},Np,Vp)}function Hv(wp){return wp=(wp=wp.stateNode)&&wp.__reactInternalMemoizedMergedChildContext||ly,Sy=vv.current,Km(vv,wp),Km(Pv,Pv.current),!0}function s0(wp,Cp,Np){var Vp=wp.stateNode;if(!Vp)throw Error(up(169));Np?(wp=o0(wp,Cp,Sy),Vp.__reactInternalMemoizedMergedChildContext=wp,sv(Pv),sv(vv),Km(vv,wp)):sv(Pv),Km(Pv,Np)}var ry=Math.clz32?Math.clz32:wE,U0=Math.log,SE=Math.LN2;function wE(wp){return wp>>>=0,wp===0?32:31-(U0(wp)/SE|0)|0}var j0=64,G0=4194304;function b0(wp){switch(wp&-wp){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return wp&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return wp&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return wp}}function H0(wp,Cp){var Np=wp.pendingLanes;if(Np===0)return 0;var Vp=0,Hp=wp.suspendedLanes,qp=wp.pingedLanes,om=Np&268435455;if(om!==0){var vm=om&~Hp;vm!==0?Vp=b0(vm):(qp&=om,qp!==0&&(Vp=b0(qp)))}else om=Np&~Hp,om!==0?Vp=b0(om):qp!==0&&(Vp=b0(qp));if(Vp===0)return 0;if(Cp!==0&&Cp!==Vp&&!(Cp&Hp)&&(Hp=Vp&-Vp,qp=Cp&-Cp,Hp>=qp||Hp===16&&(qp&4194240)!==0))return Cp;if(Vp&4&&(Vp|=Np&16),Cp=wp.entangledLanes,Cp!==0)for(wp=wp.entanglements,Cp&=Vp;0<Cp;)Np=31-ry(Cp),Hp=1<<Np,Vp|=wp[Np],Cp&=~Hp;return Vp}function CE(wp,Cp){switch(wp){case 1:case 2:case 4:return Cp+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Cp+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AE(wp,Cp){for(var Np=wp.suspendedLanes,Vp=wp.pingedLanes,Hp=wp.expirationTimes,qp=wp.pendingLanes;0<qp;){var om=31-ry(qp),vm=1<<om,$m=Hp[om];$m===-1?(!(vm&Np)||vm&Vp)&&(Hp[om]=CE(vm,Cp)):$m<=Cp&&(wp.expiredLanes|=vm),qp&=~vm}}function V1(wp){return wp=wp.pendingLanes&-1073741825,wp!==0?wp:wp&1073741824?1073741824:0}function z1(wp){for(var Cp=[],Np=0;31>Np;Np++)Cp.push(wp);return Cp}function E0(wp,Cp,Np){wp.pendingLanes|=Cp,Cp!==536870912&&(wp.suspendedLanes=0,wp.pingedLanes=0),wp=wp.eventTimes,Cp=31-ry(Cp),wp[Cp]=Np}function RE(wp,Cp){var Np=wp.pendingLanes&~Cp;wp.pendingLanes=Cp,wp.suspendedLanes=0,wp.pingedLanes=0,wp.expiredLanes&=Cp,wp.mutableReadLanes&=Cp,wp.entangledLanes&=Cp,Cp=wp.entanglements;var Vp=wp.eventTimes;for(wp=wp.expirationTimes;0<Np;){var Hp=31-ry(Np),qp=1<<Hp;Cp[Hp]=0,Vp[Hp]=-1,wp[Hp]=-1,Np&=~qp}}function U1(wp,Cp){var Np=wp.entangledLanes|=Cp;for(wp=wp.entanglements;Np;){var Vp=31-ry(Np),Hp=1<<Vp;Hp&Cp|wp[Vp]&Cp&&(wp[Vp]|=Cp),Np&=~Hp}}var bv=0;function Wx(wp){return wp&=-wp,1<wp?4<wp?wp&268435455?16:536870912:4:1}var j1=sp.unstable_scheduleCallback,qx=sp.unstable_cancelCallback,TE=sp.unstable_shouldYield,ME=sp.unstable_requestPaint,zv=sp.unstable_now,G1=sp.unstable_ImmediatePriority,IE=sp.unstable_UserBlockingPriority,H1=sp.unstable_NormalPriority,PE=sp.unstable_IdlePriority,W0=null,Cy=null;function NE(wp){if(Cy&&typeof Cy.onCommitFiberRoot=="function")try{Cy.onCommitFiberRoot(W0,wp,void 0,(wp.current.flags&128)===128)}catch{}}function OE(wp,Cp){return wp===Cp&&(wp!==0||1/wp===1/Cp)||wp!==wp&&Cp!==Cp}var Ay=typeof Object.is=="function"?Object.is:OE,Oy=null,q0=!1,W1=!1;function Xx(wp){Oy===null?Oy=[wp]:Oy.push(wp)}function LE(wp){q0=!0,Xx(wp)}function Ry(){if(!W1&&Oy!==null){W1=!0;var wp=0,Cp=bv;try{var Np=Oy;for(bv=1;wp<Np.length;wp++){var Vp=Np[wp];do Vp=Vp(!0);while(Vp!==null)}Oy=null,q0=!1}catch(Hp){throw Oy!==null&&(Oy=Oy.slice(wp+1)),j1(G1,Ry),Hp}finally{bv=Cp,W1=!1}}return null}var kE=cp.ReactCurrentBatchConfig;function X0(wp,Cp){if(Ay(wp,Cp))return!0;if(typeof wp!="object"||wp===null||typeof Cp!="object"||Cp===null)return!1;var Np=Object.keys(wp),Vp=Object.keys(Cp);if(Np.length!==Vp.length)return!1;for(Vp=0;Vp<Np.length;Vp++){var Hp=Np[Vp];if(!Tv.call(Cp,Hp)||!Ay(wp[Hp],Cp[Hp]))return!1}return!0}function DE(wp){switch(wp.tag){case 5:return cv(wp.type);case 16:return cv("Lazy");case 13:return cv("Suspense");case 19:return cv("SuspenseList");case 0:case 2:case 15:return wp=dv(wp.type,!1),wp;case 11:return wp=dv(wp.type.render,!1),wp;case 1:return wp=dv(wp.type,!0),wp;default:return""}}function by(wp,Cp){if(wp&&wp.defaultProps){Cp=lp({},Cp),wp=wp.defaultProps;for(var Np in wp)Cp[Np]===void 0&&(Cp[Np]=wp[Np]);return Cp}return Cp}var K0=Fv(null),Y0=null,l0=null,q1=null;function X1(){q1=l0=Y0=null}function Kx(wp,Cp,Np){Mm?(Km(K0,Cp._currentValue),Cp._currentValue=Np):(Km(K0,Cp._currentValue2),Cp._currentValue2=Np)}function K1(wp){var Cp=K0.current;sv(K0),Mm?wp._currentValue=Cp:wp._currentValue2=Cp}function Y1(wp,Cp,Np){for(;wp!==null;){var Vp=wp.alternate;if((wp.childLanes&Cp)!==Cp?(wp.childLanes|=Cp,Vp!==null&&(Vp.childLanes|=Cp)):Vp!==null&&(Vp.childLanes&Cp)!==Cp&&(Vp.childLanes|=Cp),wp===Np)break;wp=wp.return}}function u0(wp,Cp){Y0=wp,q1=l0=null,wp=wp.dependencies,wp!==null&&wp.firstContext!==null&&(wp.lanes&Cp&&(oy=!0),wp.firstContext=null)}function cy(wp){var Cp=Mm?wp._currentValue:wp._currentValue2;if(q1!==wp)if(wp={context:wp,memoizedValue:Cp,next:null},l0===null){if(Y0===null)throw Error(up(308));l0=wp,Y0.dependencies={lanes:0,firstContext:wp}}else l0=l0.next=wp;return Cp}var Ty=null,zy=!1;function J1(wp){wp.updateQueue={baseState:wp.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yx(wp,Cp){wp=wp.updateQueue,Cp.updateQueue===wp&&(Cp.updateQueue={baseState:wp.baseState,firstBaseUpdate:wp.firstBaseUpdate,lastBaseUpdate:wp.lastBaseUpdate,shared:wp.shared,effects:wp.effects})}function Ly(wp,Cp){return{eventTime:wp,lane:Cp,tag:0,payload:null,callback:null,next:null}}function Uy(wp,Cp){var Np=wp.updateQueue;Np!==null&&(Np=Np.shared,kv!==null&&wp.mode&1&&!(yv&2)?(wp=Np.interleaved,wp===null?(Cp.next=Cp,Ty===null?Ty=[Np]:Ty.push(Np)):(Cp.next=wp.next,wp.next=Cp),Np.interleaved=Cp):(wp=Np.pending,wp===null?Cp.next=Cp:(Cp.next=wp.next,wp.next=Cp),Np.pending=Cp))}function J0(wp,Cp,Np){if(Cp=Cp.updateQueue,Cp!==null&&(Cp=Cp.shared,(Np&4194240)!==0)){var Vp=Cp.lanes;Vp&=wp.pendingLanes,Np|=Vp,Cp.lanes=Np,U1(wp,Np)}}function Jx(wp,Cp){var Np=wp.updateQueue,Vp=wp.alternate;if(Vp!==null&&(Vp=Vp.updateQueue,Np===Vp)){var Hp=null,qp=null;if(Np=Np.firstBaseUpdate,Np!==null){do{var om={eventTime:Np.eventTime,lane:Np.lane,tag:Np.tag,payload:Np.payload,callback:Np.callback,next:null};qp===null?Hp=qp=om:qp=qp.next=om,Np=Np.next}while(Np!==null);qp===null?Hp=qp=Cp:qp=qp.next=Cp}else Hp=qp=Cp;Np={baseState:Vp.baseState,firstBaseUpdate:Hp,lastBaseUpdate:qp,shared:Vp.shared,effects:Vp.effects},wp.updateQueue=Np;return}wp=Np.lastBaseUpdate,wp===null?Np.firstBaseUpdate=Cp:wp.next=Cp,Np.lastBaseUpdate=Cp}function Q0(wp,Cp,Np,Vp){var Hp=wp.updateQueue;zy=!1;var qp=Hp.firstBaseUpdate,om=Hp.lastBaseUpdate,vm=Hp.shared.pending;if(vm!==null){Hp.shared.pending=null;var $m=vm,Hm=$m.next;$m.next=null,om===null?qp=Hm:om.next=Hm,om=$m;var Ym=wp.alternate;Ym!==null&&(Ym=Ym.updateQueue,vm=Ym.lastBaseUpdate,vm!==om&&(vm===null?Ym.firstBaseUpdate=Hm:vm.next=Hm,Ym.lastBaseUpdate=$m))}if(qp!==null){var hv=Hp.baseState;om=0,Ym=Hm=$m=null,vm=qp;do{var rv=vm.lane,wv=vm.eventTime;if((Vp&rv)===rv){Ym!==null&&(Ym=Ym.next={eventTime:wv,lane:0,tag:vm.tag,payload:vm.payload,callback:vm.callback,next:null});e:{var _g=wp,Yv=vm;switch(rv=Cp,wv=Np,Yv.tag){case 1:if(_g=Yv.payload,typeof _g=="function"){hv=_g.call(wv,hv,rv);break e}hv=_g;break e;case 3:_g.flags=_g.flags&-65537|128;case 0:if(_g=Yv.payload,rv=typeof _g=="function"?_g.call(wv,hv,rv):_g,rv==null)break e;hv=lp({},hv,rv);break e;case 2:zy=!0}}vm.callback!==null&&vm.lane!==0&&(wp.flags|=64,rv=Hp.effects,rv===null?Hp.effects=[vm]:rv.push(vm))}else wv={eventTime:wv,lane:rv,tag:vm.tag,payload:vm.payload,callback:vm.callback,next:null},Ym===null?(Hm=Ym=wv,$m=hv):Ym=Ym.next=wv,om|=rv;if(vm=vm.next,vm===null){if(vm=Hp.shared.pending,vm===null)break;rv=vm,vm=rv.next,rv.next=null,Hp.lastBaseUpdate=rv,Hp.shared.pending=null}}while(!0);if(Ym===null&&($m=hv),Hp.baseState=$m,Hp.firstBaseUpdate=Hm,Hp.lastBaseUpdate=Ym,Cp=Hp.shared.interleaved,Cp!==null){Hp=Cp;do om|=Hp.lane,Hp=Hp.next;while(Hp!==Cp)}else qp===null&&(Hp.shared.lanes=0);y0|=om,wp.lanes=om,wp.memoizedState=hv}}function Qx(wp,Cp,Np){if(wp=Cp.effects,Cp.effects=null,wp!==null)for(Cp=0;Cp<wp.length;Cp++){var Vp=wp[Cp],Hp=Vp.callback;if(Hp!==null){if(Vp.callback=null,Vp=Np,typeof Hp!="function")throw Error(up(191,Hp));Hp.call(Vp)}}}var Zx=new ap.Component().refs;function Q1(wp,Cp,Np,Vp){Cp=wp.memoizedState,Np=Np(Vp,Cp),Np=Np==null?Cp:lp({},Cp,Np),wp.memoizedState=Np,wp.lanes===0&&(wp.updateQueue.baseState=Np)}var Z0={isMounted:function(wp){return(wp=wp._reactInternals)?Op(wp)===wp:!1},enqueueSetState:function(wp,Cp,Np){wp=wp._reactInternals;var Vp=Qv(),Hp=Hy(wp),qp=Ly(Vp,Hp);qp.payload=Cp,Np!=null&&(qp.callback=Np),Uy(wp,qp),Cp=gy(wp,Hp,Vp),Cp!==null&&J0(Cp,wp,Hp)},enqueueReplaceState:function(wp,Cp,Np){wp=wp._reactInternals;var Vp=Qv(),Hp=Hy(wp),qp=Ly(Vp,Hp);qp.tag=1,qp.payload=Cp,Np!=null&&(qp.callback=Np),Uy(wp,qp),Cp=gy(wp,Hp,Vp),Cp!==null&&J0(Cp,wp,Hp)},enqueueForceUpdate:function(wp,Cp){wp=wp._reactInternals;var Np=Qv(),Vp=Hy(wp),Hp=Ly(Np,Vp);Hp.tag=2,Cp!=null&&(Hp.callback=Cp),Uy(wp,Hp),Cp=gy(wp,Vp,Np),Cp!==null&&J0(Cp,wp,Vp)}};function e_(wp,Cp,Np,Vp,Hp,qp,om){return wp=wp.stateNode,typeof wp.shouldComponentUpdate=="function"?wp.shouldComponentUpdate(Vp,qp,om):Cp.prototype&&Cp.prototype.isPureReactComponent?!X0(Np,Vp)||!X0(Hp,qp):!0}function t_(wp,Cp,Np){var Vp=!1,Hp=ly,qp=Cp.contextType;return typeof qp=="object"&&qp!==null?qp=cy(qp):(Hp=Vv(Cp)?Sy:vv.current,Vp=Cp.contextTypes,qp=(Vp=Vp!=null)?uy(wp,Hp):ly),Cp=new Cp(Np,qp),wp.memoizedState=Cp.state!==null&&Cp.state!==void 0?Cp.state:null,Cp.updater=Z0,wp.stateNode=Cp,Cp._reactInternals=wp,Vp&&(wp=wp.stateNode,wp.__reactInternalMemoizedUnmaskedChildContext=Hp,wp.__reactInternalMemoizedMaskedChildContext=qp),Cp}function n_(wp,Cp,Np,Vp){wp=Cp.state,typeof Cp.componentWillReceiveProps=="function"&&Cp.componentWillReceiveProps(Np,Vp),typeof Cp.UNSAFE_componentWillReceiveProps=="function"&&Cp.UNSAFE_componentWillReceiveProps(Np,Vp),Cp.state!==wp&&Z0.enqueueReplaceState(Cp,Cp.state,null)}function Z1(wp,Cp,Np,Vp){var Hp=wp.stateNode;Hp.props=Np,Hp.state=wp.memoizedState,Hp.refs=Zx,J1(wp);var qp=Cp.contextType;typeof qp=="object"&&qp!==null?Hp.context=cy(qp):(qp=Vv(Cp)?Sy:vv.current,Hp.context=uy(wp,qp)),Hp.state=wp.memoizedState,qp=Cp.getDerivedStateFromProps,typeof qp=="function"&&(Q1(wp,Cp,qp,Np),Hp.state=wp.memoizedState),typeof Cp.getDerivedStateFromProps=="function"||typeof Hp.getSnapshotBeforeUpdate=="function"||typeof Hp.UNSAFE_componentWillMount!="function"&&typeof Hp.componentWillMount!="function"||(Cp=Hp.state,typeof Hp.componentWillMount=="function"&&Hp.componentWillMount(),typeof Hp.UNSAFE_componentWillMount=="function"&&Hp.UNSAFE_componentWillMount(),Cp!==Hp.state&&Z0.enqueueReplaceState(Hp,Hp.state,null),Q0(wp,Np,Hp,Vp),Hp.state=wp.memoizedState),typeof Hp.componentDidMount=="function"&&(wp.flags|=4194308)}var c0=[],d0=0,e1=null,t1=0,dy=[],hy=0,Ky=null,ky=1,Dy="";function Yy(wp,Cp){c0[d0++]=t1,c0[d0++]=e1,e1=wp,t1=Cp}function r_(wp,Cp,Np){dy[hy++]=ky,dy[hy++]=Dy,dy[hy++]=Ky,Ky=wp;var Vp=ky;wp=Dy;var Hp=32-ry(Vp)-1;Vp&=~(1<<Hp),Np+=1;var qp=32-ry(Cp)+Hp;if(30<qp){var om=Hp-Hp%5;qp=(Vp&(1<<om)-1).toString(32),Vp>>=om,Hp-=om,ky=1<<32-ry(Cp)+Hp|Np<<Hp|Vp,Dy=qp+wp}else ky=1<<qp|Np<<Hp|Vp,Dy=wp}function ex(wp){wp.return!==null&&(Yy(wp,1),r_(wp,1,0))}function tx(wp){for(;wp===e1;)e1=c0[--d0],c0[d0]=null,t1=c0[--d0],c0[d0]=null;for(;wp===Ky;)Ky=dy[--hy],dy[hy]=null,Dy=dy[--hy],dy[hy]=null,ky=dy[--hy],dy[hy]=null}var iy=null,ay=null,Rv=!1,S0=!1,Ey=null;function i_(wp,Cp){var Np=vy(5,null,null,0);Np.elementType="DELETED",Np.stateNode=Cp,Np.return=wp,Cp=wp.deletions,Cp===null?(wp.deletions=[Np],wp.flags|=16):Cp.push(Np)}function a_(wp,Cp){switch(wp.tag){case 5:return Cp=pv(Cp,wp.type,wp.pendingProps),Cp!==null?(wp.stateNode=Cp,iy=wp,ay=a0(Cp),!0):!1;case 6:return Cp=Iv(Cp,wp.pendingProps),Cp!==null?(wp.stateNode=Cp,iy=wp,ay=null,!0):!1;case 13:if(Cp=Bv(Cp),Cp!==null){var Np=Ky!==null?{id:ky,overflow:Dy}:null;return wp.memoizedState={dehydrated:Cp,treeContext:Np,retryLane:1073741824},Np=vy(18,null,null,0),Np.stateNode=Cp,Np.return=wp,wp.child=Np,iy=wp,ay=null,!0}return!1;default:return!1}}function nx(wp){return(wp.mode&1)!==0&&(wp.flags&128)===0}function rx(wp){if(Rv){var Cp=ay;if(Cp){var Np=Cp;if(!a_(wp,Cp)){if(nx(wp))throw Error(up(418));Cp=Vy(Np);var Vp=iy;Cp&&a_(wp,Cp)?i_(Vp,Np):(wp.flags=wp.flags&-4097|2,Rv=!1,iy=wp)}}else{if(nx(wp))throw Error(up(418));wp.flags=wp.flags&-4097|2,Rv=!1,iy=wp}}}function o_(wp){for(wp=wp.return;wp!==null&&wp.tag!==5&&wp.tag!==3&&wp.tag!==13;)wp=wp.return;iy=wp}function w0(wp){if(!sm||wp!==iy)return!1;if(!Rv)return o_(wp),Rv=!0,!1;if(wp.tag!==3&&(wp.tag!==5||Xm(wp.type)&&!rm(wp.type,wp.memoizedProps))){var Cp=ay;if(Cp){if(nx(wp)){for(wp=ay;wp;)wp=Vy(wp);throw Error(up(418))}for(;Cp;)i_(wp,Cp),Cp=Vy(Cp)}}if(o_(wp),wp.tag===13){if(!sm)throw Error(up(316));if(wp=wp.memoizedState,wp=wp!==null?wp.dehydrated:null,!wp)throw Error(up(317));ay=am(wp)}else ay=iy?Vy(wp.stateNode):null;return!0}function h0(){sm&&(ay=iy=null,S0=Rv=!1)}function ix(wp){Ey===null?Ey=[wp]:Ey.push(wp)}function C0(wp,Cp,Np){if(wp=Np.ref,wp!==null&&typeof wp!="function"&&typeof wp!="object"){if(Np._owner){if(Np=Np._owner,Np){if(Np.tag!==1)throw Error(up(309));var Vp=Np.stateNode}if(!Vp)throw Error(up(147,wp));var Hp=Vp,qp=""+wp;return Cp!==null&&Cp.ref!==null&&typeof Cp.ref=="function"&&Cp.ref._stringRef===qp?Cp.ref:(Cp=function(om){var vm=Hp.refs;vm===Zx&&(vm=Hp.refs={}),om===null?delete vm[qp]:vm[qp]=om},Cp._stringRef=qp,Cp)}if(typeof wp!="string")throw Error(up(284));if(!Np._owner)throw Error(up(290,wp))}return wp}function n1(wp,Cp){throw wp=Object.prototype.toString.call(Cp),Error(up(31,wp==="[object Object]"?"object with keys {"+Object.keys(Cp).join(", ")+"}":wp))}function s_(wp){var Cp=wp._init;return Cp(wp._payload)}function l_(wp){function Cp(Sm,xm){if(wp){var Om=Sm.deletions;Om===null?(Sm.deletions=[xm],Sm.flags|=16):Om.push(xm)}}function Np(Sm,xm){if(!wp)return null;for(;xm!==null;)Cp(Sm,xm),xm=xm.sibling;return null}function Vp(Sm,xm){for(Sm=new Map;xm!==null;)xm.key!==null?Sm.set(xm.key,xm):Sm.set(xm.index,xm),xm=xm.sibling;return Sm}function Hp(Sm,xm){return Sm=qy(Sm,xm),Sm.index=0,Sm.sibling=null,Sm}function qp(Sm,xm,Om){return Sm.index=Om,wp?(Om=Sm.alternate,Om!==null?(Om=Om.index,Om<xm?(Sm.flags|=2,xm):Om):(Sm.flags|=2,xm)):(Sm.flags|=1048576,xm)}function om(Sm){return wp&&Sm.alternate===null&&(Sm.flags|=2),Sm}function vm(Sm,xm,Om,qm){return xm===null||xm.tag!==6?(xm=jx(Om,Sm.mode,qm),xm.return=Sm,xm):(xm=Hp(xm,Om),xm.return=Sm,xm)}function $m(Sm,xm,Om,qm){var Qm=Om.type;return Qm===fp?Ym(Sm,xm,Om.props.children,qm,Om.key):xm!==null&&(xm.elementType===Qm||typeof Qm=="object"&&Qm!==null&&Qm.$$typeof===Ep&&s_(Qm)===xm.type)?(qm=Hp(xm,Om.props),qm.ref=C0(Sm,xm,Om),qm.return=Sm,qm):(qm=k1(Om.type,Om.key,Om.props,null,Sm.mode,qm),qm.ref=C0(Sm,xm,Om),qm.return=Sm,qm)}function Hm(Sm,xm,Om,qm){return xm===null||xm.tag!==4||xm.stateNode.containerInfo!==Om.containerInfo||xm.stateNode.implementation!==Om.implementation?(xm=Gx(Om,Sm.mode,qm),xm.return=Sm,xm):(xm=Hp(xm,Om.children||[]),xm.return=Sm,xm)}function Ym(Sm,xm,Om,qm,Qm){return xm===null||xm.tag!==7?(xm=r0(Om,Sm.mode,qm,Qm),xm.return=Sm,xm):(xm=Hp(xm,Om),xm.return=Sm,xm)}function hv(Sm,xm,Om){if(typeof xm=="string"&&xm!==""||typeof xm=="number")return xm=jx(""+xm,Sm.mode,Om),xm.return=Sm,xm;if(typeof xm=="object"&&xm!==null){switch(xm.$$typeof){case dp:return Om=k1(xm.type,xm.key,xm.props,null,Sm.mode,Om),Om.ref=C0(Sm,null,xm),Om.return=Sm,Om;case hp:return xm=Gx(xm,Sm.mode,Om),xm.return=Sm,xm;case Ep:var qm=xm._init;return hv(Sm,qm(xm._payload),Om)}if(jp(xm)||Rp(xm))return xm=r0(xm,Sm.mode,Om,null),xm.return=Sm,xm;n1(Sm,xm)}return null}function rv(Sm,xm,Om,qm){var Qm=xm!==null?xm.key:null;if(typeof Om=="string"&&Om!==""||typeof Om=="number")return Qm!==null?null:vm(Sm,xm,""+Om,qm);if(typeof Om=="object"&&Om!==null){switch(Om.$$typeof){case dp:return Om.key===Qm?$m(Sm,xm,Om,qm):null;case hp:return Om.key===Qm?Hm(Sm,xm,Om,qm):null;case Ep:return Qm=Om._init,rv(Sm,xm,Qm(Om._payload),qm)}if(jp(Om)||Rp(Om))return Qm!==null?null:Ym(Sm,xm,Om,qm,null);n1(Sm,Om)}return null}function wv(Sm,xm,Om,qm,Qm){if(typeof qm=="string"&&qm!==""||typeof qm=="number")return Sm=Sm.get(Om)||null,vm(xm,Sm,""+qm,Qm);if(typeof qm=="object"&&qm!==null){switch(qm.$$typeof){case dp:return Sm=Sm.get(qm.key===null?Om:qm.key)||null,$m(xm,Sm,qm,Qm);case hp:return Sm=Sm.get(qm.key===null?Om:qm.key)||null,Hm(xm,Sm,qm,Qm);case Ep:var mv=qm._init;return wv(Sm,xm,Om,mv(qm._payload),Qm)}if(jp(qm)||Rp(qm))return Sm=Sm.get(Om)||null,Ym(xm,Sm,qm,Qm,null);n1(xm,qm)}return null}function _g(Sm,xm,Om,qm){for(var Qm=null,mv=null,fv=xm,Ev=xm=0,jv=null;fv!==null&&Ev<Om.length;Ev++){fv.index>Ev?(jv=fv,fv=null):jv=fv.sibling;var Sv=rv(Sm,fv,Om[Ev],qm);if(Sv===null){fv===null&&(fv=jv);break}wp&&fv&&Sv.alternate===null&&Cp(Sm,fv),xm=qp(Sv,xm,Ev),mv===null?Qm=Sv:mv.sibling=Sv,mv=Sv,fv=jv}if(Ev===Om.length)return Np(Sm,fv),Rv&&Yy(Sm,Ev),Qm;if(fv===null){for(;Ev<Om.length;Ev++)fv=hv(Sm,Om[Ev],qm),fv!==null&&(xm=qp(fv,xm,Ev),mv===null?Qm=fv:mv.sibling=fv,mv=fv);return Rv&&Yy(Sm,Ev),Qm}for(fv=Vp(Sm,fv);Ev<Om.length;Ev++)jv=wv(fv,Sm,Ev,Om[Ev],qm),jv!==null&&(wp&&jv.alternate!==null&&fv.delete(jv.key===null?Ev:jv.key),xm=qp(jv,xm,Ev),mv===null?Qm=jv:mv.sibling=jv,mv=jv);return wp&&fv.forEach(function(Xy){return Cp(Sm,Xy)}),Rv&&Yy(Sm,Ev),Qm}function Yv(Sm,xm,Om,qm){var Qm=Rp(Om);if(typeof Qm!="function")throw Error(up(150));if(Om=Qm.call(Om),Om==null)throw Error(up(151));for(var mv=Qm=null,fv=xm,Ev=xm=0,jv=null,Sv=Om.next();fv!==null&&!Sv.done;Ev++,Sv=Om.next()){fv.index>Ev?(jv=fv,fv=null):jv=fv.sibling;var Xy=rv(Sm,fv,Sv.value,qm);if(Xy===null){fv===null&&(fv=jv);break}wp&&fv&&Xy.alternate===null&&Cp(Sm,fv),xm=qp(Xy,xm,Ev),mv===null?Qm=Xy:mv.sibling=Xy,mv=Xy,fv=jv}if(Sv.done)return Np(Sm,fv),Rv&&Yy(Sm,Ev),Qm;if(fv===null){for(;!Sv.done;Ev++,Sv=Om.next())Sv=hv(Sm,Sv.value,qm),Sv!==null&&(xm=qp(Sv,xm,Ev),mv===null?Qm=Sv:mv.sibling=Sv,mv=Sv);return Rv&&Yy(Sm,Ev),Qm}for(fv=Vp(Sm,fv);!Sv.done;Ev++,Sv=Om.next())Sv=wv(fv,Sm,Ev,Sv.value,qm),Sv!==null&&(wp&&Sv.alternate!==null&&fv.delete(Sv.key===null?Ev:Sv.key),xm=qp(Sv,xm,Ev),mv===null?Qm=Sv:mv.sibling=Sv,mv=Sv);return wp&&fv.forEach(function(hS){return Cp(Sm,hS)}),Rv&&Yy(Sm,Ev),Qm}function yy(Sm,xm,Om,qm){if(typeof Om=="object"&&Om!==null&&Om.type===fp&&Om.key===null&&(Om=Om.props.children),typeof Om=="object"&&Om!==null){switch(Om.$$typeof){case dp:e:{for(var Qm=Om.key,mv=xm;mv!==null;){if(mv.key===Qm){if(Qm=Om.type,Qm===fp){if(mv.tag===7){Np(Sm,mv.sibling),xm=Hp(mv,Om.props.children),xm.return=Sm,Sm=xm;break e}}else if(mv.elementType===Qm||typeof Qm=="object"&&Qm!==null&&Qm.$$typeof===Ep&&s_(Qm)===mv.type){Np(Sm,mv.sibling),xm=Hp(mv,Om.props),xm.ref=C0(Sm,mv,Om),xm.return=Sm,Sm=xm;break e}Np(Sm,mv);break}else Cp(Sm,mv);mv=mv.sibling}Om.type===fp?(xm=r0(Om.props.children,Sm.mode,qm,Om.key),xm.return=Sm,Sm=xm):(qm=k1(Om.type,Om.key,Om.props,null,Sm.mode,qm),qm.ref=C0(Sm,xm,Om),qm.return=Sm,Sm=qm)}return om(Sm);case hp:e:{for(mv=Om.key;xm!==null;){if(xm.key===mv)if(xm.tag===4&&xm.stateNode.containerInfo===Om.containerInfo&&xm.stateNode.implementation===Om.implementation){Np(Sm,xm.sibling),xm=Hp(xm,Om.children||[]),xm.return=Sm,Sm=xm;break e}else{Np(Sm,xm);break}else Cp(Sm,xm);xm=xm.sibling}xm=Gx(Om,Sm.mode,qm),xm.return=Sm,Sm=xm}return om(Sm);case Ep:return mv=Om._init,yy(Sm,xm,mv(Om._payload),qm)}if(jp(Om))return _g(Sm,xm,Om,qm);if(Rp(Om))return Yv(Sm,xm,Om,qm);n1(Sm,Om)}return typeof Om=="string"&&Om!==""||typeof Om=="number"?(Om=""+Om,xm!==null&&xm.tag===6?(Np(Sm,xm.sibling),xm=Hp(xm,Om),xm.return=Sm,Sm=xm):(Np(Sm,xm),xm=jx(Om,Sm.mode,qm),xm.return=Sm,Sm=xm),om(Sm)):Np(Sm,xm)}return yy}var f0=l_(!0),u_=l_(!1),A0={},fy=Fv(A0),R0=Fv(A0),p0=Fv(A0);function My(wp){if(wp===A0)throw Error(up(174));return wp}function ax(wp,Cp){Km(p0,Cp),Km(R0,wp),Km(fy,A0),wp=Bp(Cp),sv(fy),Km(fy,wp)}function m0(){sv(fy),sv(R0),sv(p0)}function c_(wp){var Cp=My(p0.current),Np=My(fy.current);Cp=Ip(Np,wp.type,Cp),Np!==Cp&&(Km(R0,wp),Km(fy,Cp))}function ox(wp){R0.current===wp&&(sv(fy),sv(R0))}var Mv=Fv(0);function r1(wp){for(var Cp=wp;Cp!==null;){if(Cp.tag===13){var Np=Cp.memoizedState;if(Np!==null&&(Np=Np.dehydrated,Np===null||xy(Np)||_0(Np)))return Cp}else if(Cp.tag===19&&Cp.memoizedProps.revealOrder!==void 0){if(Cp.flags&128)return Cp}else if(Cp.child!==null){Cp.child.return=Cp,Cp=Cp.child;continue}if(Cp===wp)break;for(;Cp.sibling===null;){if(Cp.return===null||Cp.return===wp)return null;Cp=Cp.return}Cp.sibling.return=Cp.return,Cp=Cp.sibling}return null}var sx=[];function lx(){for(var wp=0;wp<sx.length;wp++){var Cp=sx[wp];Mm?Cp._workInProgressVersionPrimary=null:Cp._workInProgressVersionSecondary=null}sx.length=0}var i1=cp.ReactCurrentDispatcher,my=cp.ReactCurrentBatchConfig,g0=0,Nv=null,qv=null,Uv=null,a1=!1,T0=!1,M0=0,$E=0;function Xv(){throw Error(up(321))}function ux(wp,Cp){if(Cp===null)return!1;for(var Np=0;Np<Cp.length&&Np<wp.length;Np++)if(!Ay(wp[Np],Cp[Np]))return!1;return!0}function cx(wp,Cp,Np,Vp,Hp,qp){if(g0=qp,Nv=Cp,Cp.memoizedState=null,Cp.updateQueue=null,Cp.lanes=0,i1.current=wp===null||wp.memoizedState===null?zE:UE,wp=Np(Vp,Hp),T0){qp=0;do{if(T0=!1,M0=0,25<=qp)throw Error(up(301));qp+=1,Uv=qv=null,Cp.updateQueue=null,i1.current=jE,wp=Np(Vp,Hp)}while(T0)}if(i1.current=d1,Cp=qv!==null&&qv.next!==null,g0=0,Uv=qv=Nv=null,a1=!1,Cp)throw Error(up(300));return wp}function dx(){var wp=M0!==0;return M0=0,wp}function $y(){var wp={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Uv===null?Nv.memoizedState=Uv=wp:Uv=Uv.next=wp,Uv}function Iy(){if(qv===null){var wp=Nv.alternate;wp=wp!==null?wp.memoizedState:null}else wp=qv.next;var Cp=Uv===null?Nv.memoizedState:Uv.next;if(Cp!==null)Uv=Cp,qv=wp;else{if(wp===null)throw Error(up(310));qv=wp,wp={memoizedState:qv.memoizedState,baseState:qv.baseState,baseQueue:qv.baseQueue,queue:qv.queue,next:null},Uv===null?Nv.memoizedState=Uv=wp:Uv=Uv.next=wp}return Uv}function Jy(wp,Cp){return typeof Cp=="function"?Cp(wp):Cp}function o1(wp){var Cp=Iy(),Np=Cp.queue;if(Np===null)throw Error(up(311));Np.lastRenderedReducer=wp;var Vp=qv,Hp=Vp.baseQueue,qp=Np.pending;if(qp!==null){if(Hp!==null){var om=Hp.next;Hp.next=qp.next,qp.next=om}Vp.baseQueue=Hp=qp,Np.pending=null}if(Hp!==null){qp=Hp.next,Vp=Vp.baseState;var vm=om=null,$m=null,Hm=qp;do{var Ym=Hm.lane;if((g0&Ym)===Ym)$m!==null&&($m=$m.next={lane:0,action:Hm.action,hasEagerState:Hm.hasEagerState,eagerState:Hm.eagerState,next:null}),Vp=Hm.hasEagerState?Hm.eagerState:wp(Vp,Hm.action);else{var hv={lane:Ym,action:Hm.action,hasEagerState:Hm.hasEagerState,eagerState:Hm.eagerState,next:null};$m===null?(vm=$m=hv,om=Vp):$m=$m.next=hv,Nv.lanes|=Ym,y0|=Ym}Hm=Hm.next}while(Hm!==null&&Hm!==qp);$m===null?om=Vp:$m.next=vm,Ay(Vp,Cp.memoizedState)||(oy=!0),Cp.memoizedState=Vp,Cp.baseState=om,Cp.baseQueue=$m,Np.lastRenderedState=Vp}if(wp=Np.interleaved,wp!==null){Hp=wp;do qp=Hp.lane,Nv.lanes|=qp,y0|=qp,Hp=Hp.next;while(Hp!==wp)}else Hp===null&&(Np.lanes=0);return[Cp.memoizedState,Np.dispatch]}function s1(wp){var Cp=Iy(),Np=Cp.queue;if(Np===null)throw Error(up(311));Np.lastRenderedReducer=wp;var Vp=Np.dispatch,Hp=Np.pending,qp=Cp.memoizedState;if(Hp!==null){Np.pending=null;var om=Hp=Hp.next;do qp=wp(qp,om.action),om=om.next;while(om!==Hp);Ay(qp,Cp.memoizedState)||(oy=!0),Cp.memoizedState=qp,Cp.baseQueue===null&&(Cp.baseState=qp),Np.lastRenderedState=qp}return[qp,Vp]}function d_(){}function h_(wp,Cp){var Np=Nv,Vp=Iy(),Hp=Cp(),qp=!Ay(Vp.memoizedState,Hp);if(qp&&(Vp.memoizedState=Hp,oy=!0),Vp=Vp.queue,P0(m_.bind(null,Np,Vp,wp),[wp]),Vp.getSnapshot!==Cp||qp||Uv!==null&&Uv.memoizedState.tag&1){if(Np.flags|=2048,I0(9,p_.bind(null,Np,Vp,Hp,Cp),void 0,null),kv===null)throw Error(up(349));g0&30||f_(Np,Cp,Hp)}return Hp}function f_(wp,Cp,Np){wp.flags|=16384,wp={getSnapshot:Cp,value:Np},Cp=Nv.updateQueue,Cp===null?(Cp={lastEffect:null,stores:null},Nv.updateQueue=Cp,Cp.stores=[wp]):(Np=Cp.stores,Np===null?Cp.stores=[wp]:Np.push(wp))}function p_(wp,Cp,Np,Vp){Cp.value=Np,Cp.getSnapshot=Vp,g_(Cp)&&gy(wp,1,-1)}function m_(wp,Cp,Np){return Np(function(){g_(Cp)&&gy(wp,1,-1)})}function g_(wp){var Cp=wp.getSnapshot;wp=wp.value;try{var Np=Cp();return!Ay(wp,Np)}catch{return!0}}function hx(wp){var Cp=$y();return typeof wp=="function"&&(wp=wp()),Cp.memoizedState=Cp.baseState=wp,wp={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jy,lastRenderedState:wp},Cp.queue=wp,wp=wp.dispatch=VE.bind(null,Nv,wp),[Cp.memoizedState,wp]}function I0(wp,Cp,Np,Vp){return wp={tag:wp,create:Cp,destroy:Np,deps:Vp,next:null},Cp=Nv.updateQueue,Cp===null?(Cp={lastEffect:null,stores:null},Nv.updateQueue=Cp,Cp.lastEffect=wp.next=wp):(Np=Cp.lastEffect,Np===null?Cp.lastEffect=wp.next=wp:(Vp=Np.next,Np.next=wp,wp.next=Vp,Cp.lastEffect=wp)),wp}function v_(){return Iy().memoizedState}function u1(wp,Cp,Np,Vp){var Hp=$y();Nv.flags|=wp,Hp.memoizedState=I0(1|Cp,Np,void 0,Vp===void 0?null:Vp)}function c1(wp,Cp,Np,Vp){var Hp=Iy();Vp=Vp===void 0?null:Vp;var qp=void 0;if(qv!==null){var om=qv.memoizedState;if(qp=om.destroy,Vp!==null&&ux(Vp,om.deps)){Hp.memoizedState=I0(Cp,Np,qp,Vp);return}}Nv.flags|=wp,Hp.memoizedState=I0(1|Cp,Np,qp,Vp)}function fx(wp,Cp){return u1(8390656,8,wp,Cp)}function P0(wp,Cp){return c1(2048,8,wp,Cp)}function y_(wp,Cp){return c1(4,2,wp,Cp)}function x_(wp,Cp){return c1(4,4,wp,Cp)}function __(wp,Cp){if(typeof Cp=="function")return wp=wp(),Cp(wp),function(){Cp(null)};if(Cp!=null)return wp=wp(),Cp.current=wp,function(){Cp.current=null}}function b_(wp,Cp,Np){return Np=Np!=null?Np.concat([wp]):null,c1(4,4,__.bind(null,Cp,wp),Np)}function mx(){}function E_(wp,Cp){var Np=Iy();Cp=Cp===void 0?null:Cp;var Vp=Np.memoizedState;return Vp!==null&&Cp!==null&&ux(Cp,Vp[1])?Vp[0]:(Np.memoizedState=[wp,Cp],wp)}function S_(wp,Cp){var Np=Iy();Cp=Cp===void 0?null:Cp;var Vp=Np.memoizedState;return Vp!==null&&Cp!==null&&ux(Cp,Vp[1])?Vp[0]:(wp=wp(),Np.memoizedState=[wp,Cp],wp)}function BE(wp,Cp){var Np=bv;bv=Np!==0&&4>Np?Np:4,wp(!0);var Vp=my.transition;my.transition={};try{wp(!1),Cp()}finally{bv=Np,my.transition=Vp}}function w_(){return Iy().memoizedState}function FE(wp,Cp,Np){var Vp=Hy(wp);Np={lane:Vp,action:Np,hasEagerState:!1,eagerState:null,next:null},C_(wp)?A_(Cp,Np):(R_(wp,Cp,Np),Np=Qv(),wp=gy(wp,Vp,Np),wp!==null&&T_(wp,Cp,Vp))}function VE(wp,Cp,Np){var Vp=Hy(wp),Hp={lane:Vp,action:Np,hasEagerState:!1,eagerState:null,next:null};if(C_(wp))A_(Cp,Hp);else{R_(wp,Cp,Hp);var qp=wp.alternate;if(wp.lanes===0&&(qp===null||qp.lanes===0)&&(qp=Cp.lastRenderedReducer,qp!==null))try{var om=Cp.lastRenderedState,vm=qp(om,Np);if(Hp.hasEagerState=!0,Hp.eagerState=vm,Ay(vm,om))return}catch{}finally{}Np=Qv(),wp=gy(wp,Vp,Np),wp!==null&&T_(wp,Cp,Vp)}}function C_(wp){var Cp=wp.alternate;return wp===Nv||Cp!==null&&Cp===Nv}function A_(wp,Cp){T0=a1=!0;var Np=wp.pending;Np===null?Cp.next=Cp:(Cp.next=Np.next,Np.next=Cp),wp.pending=Cp}function R_(wp,Cp,Np){kv!==null&&wp.mode&1&&!(yv&2)?(wp=Cp.interleaved,wp===null?(Np.next=Np,Ty===null?Ty=[Cp]:Ty.push(Cp)):(Np.next=wp.next,wp.next=Np),Cp.interleaved=Np):(wp=Cp.pending,wp===null?Np.next=Np:(Np.next=wp.next,wp.next=Np),Cp.pending=Np)}function T_(wp,Cp,Np){if(Np&4194240){var Vp=Cp.lanes;Vp&=wp.pendingLanes,Np|=Vp,Cp.lanes=Np,U1(wp,Np)}}var d1={readContext:cy,useCallback:Xv,useContext:Xv,useEffect:Xv,useImperativeHandle:Xv,useInsertionEffect:Xv,useLayoutEffect:Xv,useMemo:Xv,useReducer:Xv,useRef:Xv,useState:Xv,useDebugValue:Xv,useDeferredValue:Xv,useTransition:Xv,useMutableSource:Xv,useSyncExternalStore:Xv,useId:Xv,unstable_isNewReconciler:!1},zE={readContext:cy,useCallback:function(wp,Cp){return $y().memoizedState=[wp,Cp===void 0?null:Cp],wp},useContext:cy,useEffect:fx,useImperativeHandle:function(wp,Cp,Np){return Np=Np!=null?Np.concat([wp]):null,u1(4194308,4,__.bind(null,Cp,wp),Np)},useLayoutEffect:function(wp,Cp){return u1(4194308,4,wp,Cp)},useInsertionEffect:function(wp,Cp){return u1(4,2,wp,Cp)},useMemo:function(wp,Cp){var Np=$y();return Cp=Cp===void 0?null:Cp,wp=wp(),Np.memoizedState=[wp,Cp],wp},useReducer:function(wp,Cp,Np){var Vp=$y();return Cp=Np!==void 0?Np(Cp):Cp,Vp.memoizedState=Vp.baseState=Cp,wp={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wp,lastRenderedState:Cp},Vp.queue=wp,wp=wp.dispatch=FE.bind(null,Nv,wp),[Vp.memoizedState,wp]},useRef:function(wp){var Cp=$y();return wp={current:wp},Cp.memoizedState=wp},useState:hx,useDebugValue:mx,useDeferredValue:function(wp){var Cp=hx(wp),Np=Cp[0],Vp=Cp[1];return fx(function(){var Hp=my.transition;my.transition={};try{Vp(wp)}finally{my.transition=Hp}},[wp]),Np},useTransition:function(){var wp=hx(!1),Cp=wp[0];return wp=BE.bind(null,wp[1]),$y().memoizedState=wp,[Cp,wp]},useMutableSource:function(){},useSyncExternalStore:function(wp,Cp,Np){var Vp=Nv,Hp=$y();if(Rv){if(Np===void 0)throw Error(up(407));Np=Np()}else{if(Np=Cp(),kv===null)throw Error(up(349));g0&30||f_(Vp,Cp,Np)}Hp.memoizedState=Np;var qp={value:Np,getSnapshot:Cp};return Hp.queue=qp,fx(m_.bind(null,Vp,qp,wp),[wp]),Vp.flags|=2048,I0(9,p_.bind(null,Vp,qp,Np,Cp),void 0,null),Np},useId:function(){var wp=$y(),Cp=kv.identifierPrefix;if(Rv){var Np=Dy,Vp=ky;Np=(Vp&~(1<<32-ry(Vp)-1)).toString(32)+Np,Cp=":"+Cp+"R"+Np,Np=M0++,0<Np&&(Cp+="H"+Np.toString(32)),Cp+=":"}else Np=$E++,Cp=":"+Cp+"r"+Np.toString(32)+":";return wp.memoizedState=Cp},unstable_isNewReconciler:!1},UE={readContext:cy,useCallback:E_,useContext:cy,useEffect:P0,useImperativeHandle:b_,useInsertionEffect:y_,useLayoutEffect:x_,useMemo:S_,useReducer:o1,useRef:v_,useState:function(){return o1(Jy)},useDebugValue:mx,useDeferredValue:function(wp){var Cp=o1(Jy),Np=Cp[0],Vp=Cp[1];return P0(function(){var Hp=my.transition;my.transition={};try{Vp(wp)}finally{my.transition=Hp}},[wp]),Np},useTransition:function(){var wp=o1(Jy)[0],Cp=Iy().memoizedState;return[wp,Cp]},useMutableSource:d_,useSyncExternalStore:h_,useId:w_,unstable_isNewReconciler:!1},jE={readContext:cy,useCallback:E_,useContext:cy,useEffect:P0,useImperativeHandle:b_,useInsertionEffect:y_,useLayoutEffect:x_,useMemo:S_,useReducer:s1,useRef:v_,useState:function(){return s1(Jy)},useDebugValue:mx,useDeferredValue:function(wp){var Cp=s1(Jy),Np=Cp[0],Vp=Cp[1];return P0(function(){var Hp=my.transition;my.transition={};try{Vp(wp)}finally{my.transition=Hp}},[wp]),Np},useTransition:function(){var wp=s1(Jy)[0],Cp=Iy().memoizedState;return[wp,Cp]},useMutableSource:d_,useSyncExternalStore:h_,useId:w_,unstable_isNewReconciler:!1};function gx(wp,Cp){try{var Np="",Vp=Cp;do Np+=DE(Vp),Vp=Vp.return;while(Vp);var Hp=Np}catch(qp){Hp=`
Error generating stack: `+qp.message+`
`+qp.stack}return{value:wp,source:Cp,stack:Hp}}function vx(wp,Cp){try{console.error(Cp.value)}catch(Np){setTimeout(function(){throw Np})}}var GE=typeof WeakMap=="function"?WeakMap:Map;function M_(wp,Cp,Np){Np=Ly(-1,Np),Np.tag=3,Np.payload={element:null};var Vp=Cp.value;return Np.callback=function(){T1||(T1=!0,Dx=Vp),vx(wp,Cp)},Np}function I_(wp,Cp,Np){Np=Ly(-1,Np),Np.tag=3;var Vp=wp.type.getDerivedStateFromError;if(typeof Vp=="function"){var Hp=Cp.value;Np.payload=function(){return Vp(Hp)},Np.callback=function(){vx(wp,Cp)}}var qp=wp.stateNode;return qp!==null&&typeof qp.componentDidCatch=="function"&&(Np.callback=function(){vx(wp,Cp),typeof Vp!="function"&&(jy===null?jy=new Set([this]):jy.add(this));var om=Cp.stack;this.componentDidCatch(Cp.value,{componentStack:om!==null?om:""})}),Np}function P_(wp,Cp,Np){var Vp=wp.pingCache;if(Vp===null){Vp=wp.pingCache=new GE;var Hp=new Set;Vp.set(Cp,Hp)}else Hp=Vp.get(Cp),Hp===void 0&&(Hp=new Set,Vp.set(Cp,Hp));Hp.has(Np)||(Hp.add(Np),wp=iS.bind(null,wp,Cp,Np),Cp.then(wp,wp))}function N_(wp){do{var Cp;if((Cp=wp.tag===13)&&(Cp=wp.memoizedState,Cp=Cp!==null?Cp.dehydrated!==null:!0),Cp)return wp;wp=wp.return}while(wp!==null);return null}function O_(wp,Cp,Np,Vp,Hp){return wp.mode&1?(wp.flags|=65536,wp.lanes=Hp,wp):(wp===Cp?wp.flags|=65536:(wp.flags|=128,Np.flags|=131072,Np.flags&=-52805,Np.tag===1&&(Np.alternate===null?Np.tag=17:(Cp=Ly(-1,1),Cp.tag=2,Uy(Np,Cp))),Np.lanes|=1),wp)}function Py(wp){wp.flags|=4}function L_(wp,Cp){if(wp!==null&&wp.child===Cp.child)return!0;if(Cp.flags&16)return!1;for(wp=Cp.child;wp!==null;){if(wp.flags&12854||wp.subtreeFlags&12854)return!1;wp=wp.sibling}return!0}var N0,O0,h1,f1;if(dm)N0=function(wp,Cp){for(var Np=Cp.child;Np!==null;){if(Np.tag===5||Np.tag===6)Wp(wp,Np.stateNode);else if(Np.tag!==4&&Np.child!==null){Np.child.return=Np,Np=Np.child;continue}if(Np===Cp)break;for(;Np.sibling===null;){if(Np.return===null||Np.return===Cp)return;Np=Np.return}Np.sibling.return=Np.return,Np=Np.sibling}},O0=function(){},h1=function(wp,Cp,Np,Vp,Hp){if(wp=wp.memoizedProps,wp!==Vp){var qp=Cp.stateNode,om=My(fy.current);Np=Xp(qp,Np,wp,Vp,Hp,om),(Cp.updateQueue=Np)&&Py(Cp)}},f1=function(wp,Cp,Np,Vp){Np!==Vp&&Py(Cp)};else if(em){N0=function(wp,Cp,Np,Vp){for(var Hp=Cp.child;Hp!==null;){if(Hp.tag===5){var qp=Hp.stateNode;Np&&Vp&&(qp=gv(qp,Hp.type,Hp.memoizedProps,Hp)),Wp(wp,qp)}else if(Hp.tag===6)qp=Hp.stateNode,Np&&Vp&&(qp=xv(qp,Hp.memoizedProps,Hp)),Wp(wp,qp);else if(Hp.tag!==4){if(Hp.tag===22&&Hp.memoizedState!==null)qp=Hp.child,qp!==null&&(qp.return=Hp),N0(wp,Hp,!0,!0);else if(Hp.child!==null){Hp.child.return=Hp,Hp=Hp.child;continue}}if(Hp===Cp)break;for(;Hp.sibling===null;){if(Hp.return===null||Hp.return===Cp)return;Hp=Hp.return}Hp.sibling.return=Hp.return,Hp=Hp.sibling}};var k_=function(wp,Cp,Np,Vp){for(var Hp=Cp.child;Hp!==null;){if(Hp.tag===5){var qp=Hp.stateNode;Np&&Vp&&(qp=gv(qp,Hp.type,Hp.memoizedProps,Hp)),Gm(wp,qp)}else if(Hp.tag===6)qp=Hp.stateNode,Np&&Vp&&(qp=xv(qp,Hp.memoizedProps,Hp)),Gm(wp,qp);else if(Hp.tag!==4){if(Hp.tag===22&&Hp.memoizedState!==null)qp=Hp.child,qp!==null&&(qp.return=Hp),k_(wp,Hp,!0,!0);else if(Hp.child!==null){Hp.child.return=Hp,Hp=Hp.child;continue}}if(Hp===Cp)break;for(;Hp.sibling===null;){if(Hp.return===null||Hp.return===Cp)return;Hp=Hp.return}Hp.sibling.return=Hp.return,Hp=Hp.sibling}};O0=function(wp,Cp){var Np=Cp.stateNode;if(!L_(wp,Cp)){wp=Np.containerInfo;var Vp=Um(wp);k_(Vp,Cp,!1,!1),Np.pendingChildren=Vp,Py(Cp),ev(wp,Vp)}},h1=function(wp,Cp,Np,Vp,Hp){var qp=wp.stateNode,om=wp.memoizedProps;if((wp=L_(wp,Cp))&&om===Vp)Cp.stateNode=qp;else{var vm=Cp.stateNode,$m=My(fy.current),Hm=null;om!==Vp&&(Hm=Xp(vm,Np,om,Vp,Hp,$m)),wp&&Hm===null?Cp.stateNode=qp:(qp=Lm(qp,Hm,Np,om,Vp,Cp,wp,vm),Qp(qp,Np,Vp,Hp,$m)&&Py(Cp),Cp.stateNode=qp,wp?Py(Cp):N0(qp,Cp,!1,!1))}},f1=function(wp,Cp,Np,Vp){Np!==Vp?(wp=My(p0.current),Np=My(fy.current),Cp.stateNode=Kp(Vp,wp,Np,Cp),Py(Cp)):Cp.stateNode=wp.stateNode}}else O0=function(){},h1=function(){},f1=function(){};function L0(wp,Cp){if(!Rv)switch(wp.tailMode){case"hidden":Cp=wp.tail;for(var Np=null;Cp!==null;)Cp.alternate!==null&&(Np=Cp),Cp=Cp.sibling;Np===null?wp.tail=null:Np.sibling=null;break;case"collapsed":Np=wp.tail;for(var Vp=null;Np!==null;)Np.alternate!==null&&(Vp=Np),Np=Np.sibling;Vp===null?Cp||wp.tail===null?wp.tail=null:wp.tail.sibling=null:Vp.sibling=null}}function Kv(wp){var Cp=wp.alternate!==null&&wp.alternate.child===wp.child,Np=0,Vp=0;if(Cp)for(var Hp=wp.child;Hp!==null;)Np|=Hp.lanes|Hp.childLanes,Vp|=Hp.subtreeFlags&14680064,Vp|=Hp.flags&14680064,Hp.return=wp,Hp=Hp.sibling;else for(Hp=wp.child;Hp!==null;)Np|=Hp.lanes|Hp.childLanes,Vp|=Hp.subtreeFlags,Vp|=Hp.flags,Hp.return=wp,Hp=Hp.sibling;return wp.subtreeFlags|=Vp,wp.childLanes=Np,Cp}function HE(wp,Cp,Np){var Vp=Cp.pendingProps;switch(tx(Cp),Cp.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kv(Cp),null;case 1:return Vv(Cp.type)&&Ov(),Kv(Cp),null;case 3:return Vp=Cp.stateNode,m0(),sv(Pv),sv(vv),lx(),Vp.pendingContext&&(Vp.context=Vp.pendingContext,Vp.pendingContext=null),(wp===null||wp.child===null)&&(w0(Cp)?Py(Cp):wp===null||wp.memoizedState.isDehydrated&&!(Cp.flags&256)||(Cp.flags|=1024,Ey!==null&&(Fx(Ey),Ey=null))),O0(wp,Cp),Kv(Cp),null;case 5:ox(Cp),Np=My(p0.current);var Hp=Cp.type;if(wp!==null&&Cp.stateNode!=null)h1(wp,Cp,Hp,Vp,Np),wp.ref!==Cp.ref&&(Cp.flags|=512,Cp.flags|=2097152);else{if(!Vp){if(Cp.stateNode===null)throw Error(up(166));return Kv(Cp),null}if(wp=My(fy.current),w0(Cp)){if(!sm)throw Error(up(175));wp=$1(Cp.stateNode,Cp.type,Cp.memoizedProps,Np,wp,Cp,!S0),Cp.updateQueue=wp,wp!==null&&Py(Cp)}else{var qp=Gp(Hp,Vp,Np,wp,Cp);N0(qp,Cp,!1,!1),Cp.stateNode=qp,Qp(qp,Hp,Vp,Np,wp)&&Py(Cp)}Cp.ref!==null&&(Cp.flags|=512,Cp.flags|=2097152)}return Kv(Cp),null;case 6:if(wp&&Cp.stateNode!=null)f1(wp,Cp,wp.memoizedProps,Vp);else{if(typeof Vp!="string"&&Cp.stateNode===null)throw Error(up(166));if(wp=My(p0.current),Np=My(fy.current),w0(Cp)){if(!sm)throw Error(up(176));if(wp=Cp.stateNode,Vp=Cp.memoizedProps,(Np=B1(wp,Vp,Cp,!S0))&&(Hp=iy,Hp!==null))switch(qp=(Hp.mode&1)!==0,Hp.tag){case 3:Zm(Hp.stateNode.containerInfo,wp,Vp,qp);break;case 5:iv(Hp.type,Hp.memoizedProps,Hp.stateNode,wp,Vp,qp)}Np&&Py(Cp)}else Cp.stateNode=Kp(Vp,wp,Np,Cp)}return Kv(Cp),null;case 13:if(sv(Mv),Vp=Cp.memoizedState,Rv&&ay!==null&&Cp.mode&1&&!(Cp.flags&128)){for(wp=ay;wp;)wp=Vy(wp);return h0(),Cp.flags|=98560,Cp}if(Vp!==null&&Vp.dehydrated!==null){if(Vp=w0(Cp),wp===null){if(!Vp)throw Error(up(318));if(!sm)throw Error(up(344));if(wp=Cp.memoizedState,wp=wp!==null?wp.dehydrated:null,!wp)throw Error(up(317));F1(wp,Cp)}else h0(),!(Cp.flags&128)&&(Cp.memoizedState=null),Cp.flags|=4;return Kv(Cp),null}return Ey!==null&&(Fx(Ey),Ey=null),Cp.flags&128?(Cp.lanes=Np,Cp):(Vp=Vp!==null,Np=!1,wp===null?w0(Cp):Np=wp.memoizedState!==null,Vp&&!Np&&(Cp.child.flags|=8192,Cp.mode&1&&(wp===null||Mv.current&1?$v===0&&($v=3):zx())),Cp.updateQueue!==null&&(Cp.flags|=4),Kv(Cp),null);case 4:return m0(),O0(wp,Cp),wp===null&&mm(Cp.stateNode.containerInfo),Kv(Cp),null;case 10:return K1(Cp.type._context),Kv(Cp),null;case 17:return Vv(Cp.type)&&Ov(),Kv(Cp),null;case 19:if(sv(Mv),Hp=Cp.memoizedState,Hp===null)return Kv(Cp),null;if(Vp=(Cp.flags&128)!==0,qp=Hp.rendering,qp===null)if(Vp)L0(Hp,!1);else{if($v!==0||wp!==null&&wp.flags&128)for(wp=Cp.child;wp!==null;){if(qp=r1(wp),qp!==null){for(Cp.flags|=128,L0(Hp,!1),wp=qp.updateQueue,wp!==null&&(Cp.updateQueue=wp,Cp.flags|=4),Cp.subtreeFlags=0,wp=Np,Vp=Cp.child;Vp!==null;)Np=Vp,Hp=wp,Np.flags&=14680066,qp=Np.alternate,qp===null?(Np.childLanes=0,Np.lanes=Hp,Np.child=null,Np.subtreeFlags=0,Np.memoizedProps=null,Np.memoizedState=null,Np.updateQueue=null,Np.dependencies=null,Np.stateNode=null):(Np.childLanes=qp.childLanes,Np.lanes=qp.lanes,Np.child=qp.child,Np.subtreeFlags=0,Np.deletions=null,Np.memoizedProps=qp.memoizedProps,Np.memoizedState=qp.memoizedState,Np.updateQueue=qp.updateQueue,Np.type=qp.type,Hp=qp.dependencies,Np.dependencies=Hp===null?null:{lanes:Hp.lanes,firstContext:Hp.firstContext}),Vp=Vp.sibling;return Km(Mv,Mv.current&1|2),Cp.child}wp=wp.sibling}Hp.tail!==null&&zv()>kx&&(Cp.flags|=128,Vp=!0,L0(Hp,!1),Cp.lanes=4194304)}else{if(!Vp)if(wp=r1(qp),wp!==null){if(Cp.flags|=128,Vp=!0,wp=wp.updateQueue,wp!==null&&(Cp.updateQueue=wp,Cp.flags|=4),L0(Hp,!0),Hp.tail===null&&Hp.tailMode==="hidden"&&!qp.alternate&&!Rv)return Kv(Cp),null}else 2*zv()-Hp.renderingStartTime>kx&&Np!==1073741824&&(Cp.flags|=128,Vp=!0,L0(Hp,!1),Cp.lanes=4194304);Hp.isBackwards?(qp.sibling=Cp.child,Cp.child=qp):(wp=Hp.last,wp!==null?wp.sibling=qp:Cp.child=qp,Hp.last=qp)}return Hp.tail!==null?(Cp=Hp.tail,Hp.rendering=Cp,Hp.tail=Cp.sibling,Hp.renderingStartTime=zv(),Cp.sibling=null,wp=Mv.current,Km(Mv,Vp?wp&1|2:wp&1),Cp):(Kv(Cp),null);case 22:case 23:return Vx(),Vp=Cp.memoizedState!==null,wp!==null&&wp.memoizedState!==null!==Vp&&(Cp.flags|=8192),Vp&&Cp.mode&1?sy&1073741824&&(Kv(Cp),dm&&Cp.subtreeFlags&6&&(Cp.flags|=8192)):Kv(Cp),null;case 24:return null;case 25:return null}throw Error(up(156,Cp.tag))}var WE=cp.ReactCurrentOwner,oy=!1;function Jv(wp,Cp,Np,Vp){Cp.child=wp===null?u_(Cp,null,Np,Vp):f0(Cp,wp.child,Np,Vp)}function D_(wp,Cp,Np,Vp,Hp){Np=Np.render;var qp=Cp.ref;return u0(Cp,Hp),Vp=cx(wp,Cp,Np,Vp,qp,Hp),Np=dx(),wp!==null&&!oy?(Cp.updateQueue=wp.updateQueue,Cp.flags&=-2053,wp.lanes&=~Hp,By(wp,Cp,Hp)):(Rv&&Np&&ex(Cp),Cp.flags|=1,Jv(wp,Cp,Vp,Hp),Cp.child)}function $_(wp,Cp,Np,Vp,Hp){if(wp===null){var qp=Np.type;return typeof qp=="function"&&!Ux(qp)&&qp.defaultProps===void 0&&Np.compare===null&&Np.defaultProps===void 0?(Cp.tag=15,Cp.type=qp,B_(wp,Cp,qp,Vp,Hp)):(wp=k1(Np.type,null,Vp,Cp,Cp.mode,Hp),wp.ref=Cp.ref,wp.return=Cp,Cp.child=wp)}if(qp=wp.child,!(wp.lanes&Hp)){var om=qp.memoizedProps;if(Np=Np.compare,Np=Np!==null?Np:X0,Np(om,Vp)&&wp.ref===Cp.ref)return By(wp,Cp,Hp)}return Cp.flags|=1,wp=qy(qp,Vp),wp.ref=Cp.ref,wp.return=Cp,Cp.child=wp}function B_(wp,Cp,Np,Vp,Hp){if(wp!==null&&X0(wp.memoizedProps,Vp)&&wp.ref===Cp.ref)if(oy=!1,(wp.lanes&Hp)!==0)wp.flags&131072&&(oy=!0);else return Cp.lanes=wp.lanes,By(wp,Cp,Hp);return yx(wp,Cp,Np,Vp,Hp)}function F_(wp,Cp,Np){var Vp=Cp.pendingProps,Hp=Vp.children,qp=wp!==null?wp.memoizedState:null;if(Vp.mode==="hidden")if(!(Cp.mode&1))Cp.memoizedState={baseLanes:0,cachePool:null},Km(v0,sy),sy|=Np;else if(Np&1073741824)Cp.memoizedState={baseLanes:0,cachePool:null},Vp=qp!==null?qp.baseLanes:Np,Km(v0,sy),sy|=Vp;else return wp=qp!==null?qp.baseLanes|Np:Np,Cp.lanes=Cp.childLanes=1073741824,Cp.memoizedState={baseLanes:wp,cachePool:null},Cp.updateQueue=null,Km(v0,sy),sy|=wp,null;else qp!==null?(Vp=qp.baseLanes|Np,Cp.memoizedState=null):Vp=Np,Km(v0,sy),sy|=Vp;return Jv(wp,Cp,Hp,Np),Cp.child}function V_(wp,Cp){var Np=Cp.ref;(wp===null&&Np!==null||wp!==null&&wp.ref!==Np)&&(Cp.flags|=512,Cp.flags|=2097152)}function yx(wp,Cp,Np,Vp,Hp){var qp=Vv(Np)?Sy:vv.current;return qp=uy(Cp,qp),u0(Cp,Hp),Np=cx(wp,Cp,Np,Vp,qp,Hp),Vp=dx(),wp!==null&&!oy?(Cp.updateQueue=wp.updateQueue,Cp.flags&=-2053,wp.lanes&=~Hp,By(wp,Cp,Hp)):(Rv&&Vp&&ex(Cp),Cp.flags|=1,Jv(wp,Cp,Np,Hp),Cp.child)}function z_(wp,Cp,Np,Vp,Hp){if(Vv(Np)){var qp=!0;Hv(Cp)}else qp=!1;if(u0(Cp,Hp),Cp.stateNode===null)wp!==null&&(wp.alternate=null,Cp.alternate=null,Cp.flags|=2),t_(Cp,Np,Vp),Z1(Cp,Np,Vp,Hp),Vp=!0;else if(wp===null){var om=Cp.stateNode,vm=Cp.memoizedProps;om.props=vm;var $m=om.context,Hm=Np.contextType;typeof Hm=="object"&&Hm!==null?Hm=cy(Hm):(Hm=Vv(Np)?Sy:vv.current,Hm=uy(Cp,Hm));var Ym=Np.getDerivedStateFromProps,hv=typeof Ym=="function"||typeof om.getSnapshotBeforeUpdate=="function";hv||typeof om.UNSAFE_componentWillReceiveProps!="function"&&typeof om.componentWillReceiveProps!="function"||(vm!==Vp||$m!==Hm)&&n_(Cp,om,Vp,Hm),zy=!1;var rv=Cp.memoizedState;om.state=rv,Q0(Cp,Vp,om,Hp),$m=Cp.memoizedState,vm!==Vp||rv!==$m||Pv.current||zy?(typeof Ym=="function"&&(Q1(Cp,Np,Ym,Vp),$m=Cp.memoizedState),(vm=zy||e_(Cp,Np,vm,Vp,rv,$m,Hm))?(hv||typeof om.UNSAFE_componentWillMount!="function"&&typeof om.componentWillMount!="function"||(typeof om.componentWillMount=="function"&&om.componentWillMount(),typeof om.UNSAFE_componentWillMount=="function"&&om.UNSAFE_componentWillMount()),typeof om.componentDidMount=="function"&&(Cp.flags|=4194308)):(typeof om.componentDidMount=="function"&&(Cp.flags|=4194308),Cp.memoizedProps=Vp,Cp.memoizedState=$m),om.props=Vp,om.state=$m,om.context=Hm,Vp=vm):(typeof om.componentDidMount=="function"&&(Cp.flags|=4194308),Vp=!1)}else{om=Cp.stateNode,Yx(wp,Cp),vm=Cp.memoizedProps,Hm=Cp.type===Cp.elementType?vm:by(Cp.type,vm),om.props=Hm,hv=Cp.pendingProps,rv=om.context,$m=Np.contextType,typeof $m=="object"&&$m!==null?$m=cy($m):($m=Vv(Np)?Sy:vv.current,$m=uy(Cp,$m));var wv=Np.getDerivedStateFromProps;(Ym=typeof wv=="function"||typeof om.getSnapshotBeforeUpdate=="function")||typeof om.UNSAFE_componentWillReceiveProps!="function"&&typeof om.componentWillReceiveProps!="function"||(vm!==hv||rv!==$m)&&n_(Cp,om,Vp,$m),zy=!1,rv=Cp.memoizedState,om.state=rv,Q0(Cp,Vp,om,Hp);var _g=Cp.memoizedState;vm!==hv||rv!==_g||Pv.current||zy?(typeof wv=="function"&&(Q1(Cp,Np,wv,Vp),_g=Cp.memoizedState),(Hm=zy||e_(Cp,Np,Hm,Vp,rv,_g,$m)||!1)?(Ym||typeof om.UNSAFE_componentWillUpdate!="function"&&typeof om.componentWillUpdate!="function"||(typeof om.componentWillUpdate=="function"&&om.componentWillUpdate(Vp,_g,$m),typeof om.UNSAFE_componentWillUpdate=="function"&&om.UNSAFE_componentWillUpdate(Vp,_g,$m)),typeof om.componentDidUpdate=="function"&&(Cp.flags|=4),typeof om.getSnapshotBeforeUpdate=="function"&&(Cp.flags|=1024)):(typeof om.componentDidUpdate!="function"||vm===wp.memoizedProps&&rv===wp.memoizedState||(Cp.flags|=4),typeof om.getSnapshotBeforeUpdate!="function"||vm===wp.memoizedProps&&rv===wp.memoizedState||(Cp.flags|=1024),Cp.memoizedProps=Vp,Cp.memoizedState=_g),om.props=Vp,om.state=_g,om.context=$m,Vp=Hm):(typeof om.componentDidUpdate!="function"||vm===wp.memoizedProps&&rv===wp.memoizedState||(Cp.flags|=4),typeof om.getSnapshotBeforeUpdate!="function"||vm===wp.memoizedProps&&rv===wp.memoizedState||(Cp.flags|=1024),Vp=!1)}return xx(wp,Cp,Np,Vp,qp,Hp)}function xx(wp,Cp,Np,Vp,Hp,qp){V_(wp,Cp);var om=(Cp.flags&128)!==0;if(!Vp&&!om)return Hp&&s0(Cp,Np,!1),By(wp,Cp,qp);Vp=Cp.stateNode,WE.current=Cp;var vm=om&&typeof Np.getDerivedStateFromError!="function"?null:Vp.render();return Cp.flags|=1,wp!==null&&om?(Cp.child=f0(Cp,wp.child,null,qp),Cp.child=f0(Cp,null,vm,qp)):Jv(wp,Cp,vm,qp),Cp.memoizedState=Vp.state,Hp&&s0(Cp,Np,!0),Cp.child}function U_(wp){var Cp=wp.stateNode;Cp.pendingContext?wy(wp,Cp.pendingContext,Cp.pendingContext!==Cp.context):Cp.context&&wy(wp,Cp.context,!1),ax(wp,Cp.containerInfo)}function j_(wp,Cp,Np,Vp,Hp){return h0(),ix(Hp),Cp.flags|=256,Jv(wp,Cp,Np,Vp),Cp.child}var p1={dehydrated:null,treeContext:null,retryLane:0};function m1(wp){return{baseLanes:wp,cachePool:null}}function G_(wp,Cp,Np){var Vp=Cp.pendingProps,Hp=Mv.current,qp=!1,om=(Cp.flags&128)!==0,vm;if((vm=om)||(vm=wp!==null&&wp.memoizedState===null?!1:(Hp&2)!==0),vm?(qp=!0,Cp.flags&=-129):(wp===null||wp.memoizedState!==null)&&(Hp|=1),Km(Mv,Hp&1),wp===null)return rx(Cp),wp=Cp.memoizedState,wp!==null&&(wp=wp.dehydrated,wp!==null)?(Cp.mode&1?_0(wp)?Cp.lanes=8:Cp.lanes=1073741824:Cp.lanes=1,null):(Hp=Vp.children,wp=Vp.fallback,qp?(Vp=Cp.mode,qp=Cp.child,Hp={mode:"hidden",children:Hp},!(Vp&1)&&qp!==null?(qp.childLanes=0,qp.pendingProps=Hp):qp=D1(Hp,Vp,0,null),wp=r0(wp,Vp,Np,null),qp.return=Cp,wp.return=Cp,qp.sibling=wp,Cp.child=qp,Cp.child.memoizedState=m1(Np),Cp.memoizedState=p1,wp):bx(Cp,Hp));if(Hp=wp.memoizedState,Hp!==null){if(vm=Hp.dehydrated,vm!==null){if(om)return Cp.flags&256?(Cp.flags&=-257,g1(wp,Cp,Np,Error(up(422)))):Cp.memoizedState!==null?(Cp.child=wp.child,Cp.flags|=128,null):(qp=Vp.fallback,Hp=Cp.mode,Vp=D1({mode:"visible",children:Vp.children},Hp,0,null),qp=r0(qp,Hp,Np,null),qp.flags|=2,Vp.return=Cp,qp.return=Cp,Vp.sibling=qp,Cp.child=Vp,Cp.mode&1&&f0(Cp,wp.child,null,Np),Cp.child.memoizedState=m1(Np),Cp.memoizedState=p1,qp);if(!(Cp.mode&1))Cp=g1(wp,Cp,Np,null);else if(_0(vm))Cp=g1(wp,Cp,Np,Error(up(419)));else if(Vp=(Np&wp.childLanes)!==0,oy||Vp){if(Vp=kv,Vp!==null){switch(Np&-Np){case 4:qp=2;break;case 16:qp=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:qp=32;break;case 536870912:qp=268435456;break;default:qp=0}Vp=qp&(Vp.suspendedLanes|Np)?0:qp,Vp!==0&&Vp!==Hp.retryLane&&(Hp.retryLane=Vp,gy(wp,Vp,-1))}zx(),Cp=g1(wp,Cp,Np,Error(up(421)))}else xy(vm)?(Cp.flags|=128,Cp.child=wp.child,Cp=aS.bind(null,wp),i0(vm,Cp),Cp=null):(Np=Hp.treeContext,sm&&(ay=z0(vm),iy=Cp,Rv=!0,Ey=null,S0=!1,Np!==null&&(dy[hy++]=ky,dy[hy++]=Dy,dy[hy++]=Ky,ky=Np.id,Dy=Np.overflow,Ky=Cp)),Cp=bx(Cp,Cp.pendingProps.children),Cp.flags|=4096);return Cp}return qp?(Vp=W_(wp,Cp,Vp.children,Vp.fallback,Np),qp=Cp.child,Hp=wp.child.memoizedState,qp.memoizedState=Hp===null?m1(Np):{baseLanes:Hp.baseLanes|Np,cachePool:null},qp.childLanes=wp.childLanes&~Np,Cp.memoizedState=p1,Vp):(Np=H_(wp,Cp,Vp.children,Np),Cp.memoizedState=null,Np)}return qp?(Vp=W_(wp,Cp,Vp.children,Vp.fallback,Np),qp=Cp.child,Hp=wp.child.memoizedState,qp.memoizedState=Hp===null?m1(Np):{baseLanes:Hp.baseLanes|Np,cachePool:null},qp.childLanes=wp.childLanes&~Np,Cp.memoizedState=p1,Vp):(Np=H_(wp,Cp,Vp.children,Np),Cp.memoizedState=null,Np)}function bx(wp,Cp){return Cp=D1({mode:"visible",children:Cp},wp.mode,0,null),Cp.return=wp,wp.child=Cp}function H_(wp,Cp,Np,Vp){var Hp=wp.child;return wp=Hp.sibling,Np=qy(Hp,{mode:"visible",children:Np}),!(Cp.mode&1)&&(Np.lanes=Vp),Np.return=Cp,Np.sibling=null,wp!==null&&(Vp=Cp.deletions,Vp===null?(Cp.deletions=[wp],Cp.flags|=16):Vp.push(wp)),Cp.child=Np}function W_(wp,Cp,Np,Vp,Hp){var qp=Cp.mode;wp=wp.child;var om=wp.sibling,vm={mode:"hidden",children:Np};return!(qp&1)&&Cp.child!==wp?(Np=Cp.child,Np.childLanes=0,Np.pendingProps=vm,Cp.deletions=null):(Np=qy(wp,vm),Np.subtreeFlags=wp.subtreeFlags&14680064),om!==null?Vp=qy(om,Vp):(Vp=r0(Vp,qp,Hp,null),Vp.flags|=2),Vp.return=Cp,Np.return=Cp,Np.sibling=Vp,Cp.child=Np,Vp}function g1(wp,Cp,Np,Vp){return Vp!==null&&ix(Vp),f0(Cp,wp.child,null,Np),wp=bx(Cp,Cp.pendingProps.children),wp.flags|=2,Cp.memoizedState=null,wp}function q_(wp,Cp,Np){wp.lanes|=Cp;var Vp=wp.alternate;Vp!==null&&(Vp.lanes|=Cp),Y1(wp.return,Cp,Np)}function Ex(wp,Cp,Np,Vp,Hp){var qp=wp.memoizedState;qp===null?wp.memoizedState={isBackwards:Cp,rendering:null,renderingStartTime:0,last:Vp,tail:Np,tailMode:Hp}:(qp.isBackwards=Cp,qp.rendering=null,qp.renderingStartTime=0,qp.last=Vp,qp.tail=Np,qp.tailMode=Hp)}function X_(wp,Cp,Np){var Vp=Cp.pendingProps,Hp=Vp.revealOrder,qp=Vp.tail;if(Jv(wp,Cp,Vp.children,Np),Vp=Mv.current,Vp&2)Vp=Vp&1|2,Cp.flags|=128;else{if(wp!==null&&wp.flags&128)e:for(wp=Cp.child;wp!==null;){if(wp.tag===13)wp.memoizedState!==null&&q_(wp,Np,Cp);else if(wp.tag===19)q_(wp,Np,Cp);else if(wp.child!==null){wp.child.return=wp,wp=wp.child;continue}if(wp===Cp)break e;for(;wp.sibling===null;){if(wp.return===null||wp.return===Cp)break e;wp=wp.return}wp.sibling.return=wp.return,wp=wp.sibling}Vp&=1}if(Km(Mv,Vp),!(Cp.mode&1))Cp.memoizedState=null;else switch(Hp){case"forwards":for(Np=Cp.child,Hp=null;Np!==null;)wp=Np.alternate,wp!==null&&r1(wp)===null&&(Hp=Np),Np=Np.sibling;Np=Hp,Np===null?(Hp=Cp.child,Cp.child=null):(Hp=Np.sibling,Np.sibling=null),Ex(Cp,!1,Hp,Np,qp);break;case"backwards":for(Np=null,Hp=Cp.child,Cp.child=null;Hp!==null;){if(wp=Hp.alternate,wp!==null&&r1(wp)===null){Cp.child=Hp;break}wp=Hp.sibling,Hp.sibling=Np,Np=Hp,Hp=wp}Ex(Cp,!0,Np,null,qp);break;case"together":Ex(Cp,!1,null,null,void 0);break;default:Cp.memoizedState=null}return Cp.child}function By(wp,Cp,Np){if(wp!==null&&(Cp.dependencies=wp.dependencies),y0|=Cp.lanes,!(Np&Cp.childLanes))return null;if(wp!==null&&Cp.child!==wp.child)throw Error(up(153));if(Cp.child!==null){for(wp=Cp.child,Np=qy(wp,wp.pendingProps),Cp.child=Np,Np.return=Cp;wp.sibling!==null;)wp=wp.sibling,Np=Np.sibling=qy(wp,wp.pendingProps),Np.return=Cp;Np.sibling=null}return Cp.child}function qE(wp,Cp,Np){switch(Cp.tag){case 3:U_(Cp),h0();break;case 5:c_(Cp);break;case 1:Vv(Cp.type)&&Hv(Cp);break;case 4:ax(Cp,Cp.stateNode.containerInfo);break;case 10:Kx(Cp,Cp.type._context,Cp.memoizedProps.value);break;case 13:var Vp=Cp.memoizedState;if(Vp!==null)return Vp.dehydrated!==null?(Km(Mv,Mv.current&1),Cp.flags|=128,null):Np&Cp.child.childLanes?G_(wp,Cp,Np):(Km(Mv,Mv.current&1),wp=By(wp,Cp,Np),wp!==null?wp.sibling:null);Km(Mv,Mv.current&1);break;case 19:if(Vp=(Np&Cp.childLanes)!==0,wp.flags&128){if(Vp)return X_(wp,Cp,Np);Cp.flags|=128}var Hp=Cp.memoizedState;if(Hp!==null&&(Hp.rendering=null,Hp.tail=null,Hp.lastEffect=null),Km(Mv,Mv.current),Vp)break;return null;case 22:case 23:return Cp.lanes=0,F_(wp,Cp,Np)}return By(wp,Cp,Np)}function XE(wp,Cp){switch(tx(Cp),Cp.tag){case 1:return Vv(Cp.type)&&Ov(),wp=Cp.flags,wp&65536?(Cp.flags=wp&-65537|128,Cp):null;case 3:return m0(),sv(Pv),sv(vv),lx(),wp=Cp.flags,wp&65536&&!(wp&128)?(Cp.flags=wp&-65537|128,Cp):null;case 5:return ox(Cp),null;case 13:if(sv(Mv),wp=Cp.memoizedState,wp!==null&&wp.dehydrated!==null){if(Cp.alternate===null)throw Error(up(340));h0()}return wp=Cp.flags,wp&65536?(Cp.flags=wp&-65537|128,Cp):null;case 19:return sv(Mv),null;case 4:return m0(),null;case 10:return K1(Cp.type._context),null;case 22:case 23:return Vx(),null;case 24:return null;default:return null}}var y1=!1,Qy=!1,KE=typeof WeakSet=="function"?WeakSet:Set,Wm=null;function x1(wp,Cp){var Np=wp.ref;if(Np!==null)if(typeof Np=="function")try{Np(null)}catch(Vp){ny(wp,Cp,Vp)}else Np.current=null}function Sx(wp,Cp,Np){try{Np()}catch(Vp){ny(wp,Cp,Vp)}}var K_=!1;function YE(wp,Cp){for(kp(wp.containerInfo),Wm=Cp;Wm!==null;)if(wp=Wm,Cp=wp.child,(wp.subtreeFlags&1028)!==0&&Cp!==null)Cp.return=wp,Wm=Cp;else for(;Wm!==null;){wp=Wm;try{var Np=wp.alternate;if(wp.flags&1024)switch(wp.tag){case 0:case 11:case 15:break;case 1:if(Np!==null){var Vp=Np.memoizedProps,Hp=Np.memoizedState,qp=wp.stateNode,om=qp.getSnapshotBeforeUpdate(wp.elementType===wp.type?Vp:by(wp.type,Vp),Hp);qp.__reactInternalSnapshotBeforeUpdate=om}break;case 3:dm&&Am(wp.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(up(163))}}catch(vm){ny(wp,wp.return,vm)}if(Cp=wp.sibling,Cp!==null){Cp.return=wp.return,Wm=Cp;break}Wm=wp.return}return Np=K_,K_=!1,Np}function Zy(wp,Cp,Np){var Vp=Cp.updateQueue;if(Vp=Vp!==null?Vp.lastEffect:null,Vp!==null){var Hp=Vp=Vp.next;do{if((Hp.tag&wp)===wp){var qp=Hp.destroy;Hp.destroy=void 0,qp!==void 0&&Sx(Cp,Np,qp)}Hp=Hp.next}while(Hp!==Vp)}}function k0(wp,Cp){if(Cp=Cp.updateQueue,Cp=Cp!==null?Cp.lastEffect:null,Cp!==null){var Np=Cp=Cp.next;do{if((Np.tag&wp)===wp){var Vp=Np.create;Np.destroy=Vp()}Np=Np.next}while(Np!==Cp)}}function wx(wp){var Cp=wp.ref;if(Cp!==null){var Np=wp.stateNode;switch(wp.tag){case 5:wp=Lp(Np);break;default:wp=Np}typeof Cp=="function"?Cp(wp):Cp.current=wp}}function Y_(wp,Cp,Np){if(Cy&&typeof Cy.onCommitFiberUnmount=="function")try{Cy.onCommitFiberUnmount(W0,Cp)}catch{}switch(Cp.tag){case 0:case 11:case 14:case 15:if(wp=Cp.updateQueue,wp!==null&&(wp=wp.lastEffect,wp!==null)){var Vp=wp=wp.next;do{var Hp=Vp,qp=Hp.destroy;Hp=Hp.tag,qp!==void 0&&(Hp&2||Hp&4)&&Sx(Cp,Np,qp),Vp=Vp.next}while(Vp!==wp)}break;case 1:if(x1(Cp,Np),wp=Cp.stateNode,typeof wp.componentWillUnmount=="function")try{wp.props=Cp.memoizedProps,wp.state=Cp.memoizedState,wp.componentWillUnmount()}catch(om){ny(Cp,Np,om)}break;case 5:x1(Cp,Np);break;case 4:dm?tE(wp,Cp,Np):em&&em&&(Cp=Cp.stateNode.containerInfo,Np=Um(Cp),nv(Cp,Np))}}function J_(wp,Cp,Np){for(var Vp=Cp;;)if(Y_(wp,Vp,Np),Vp.child===null||dm&&Vp.tag===4){if(Vp===Cp)break;for(;Vp.sibling===null;){if(Vp.return===null||Vp.return===Cp)return;Vp=Vp.return}Vp.sibling.return=Vp.return,Vp=Vp.sibling}else Vp.child.return=Vp,Vp=Vp.child}function Q_(wp){var Cp=wp.alternate;Cp!==null&&(wp.alternate=null,Q_(Cp)),wp.child=null,wp.deletions=null,wp.sibling=null,wp.tag===5&&(Cp=wp.stateNode,Cp!==null&&_m(Cp)),wp.stateNode=null,wp.return=null,wp.dependencies=null,wp.memoizedProps=null,wp.memoizedState=null,wp.pendingProps=null,wp.stateNode=null,wp.updateQueue=null}function Z_(wp){return wp.tag===5||wp.tag===3||wp.tag===4}function _b(wp){e:for(;;){for(;wp.sibling===null;){if(wp.return===null||Z_(wp.return))return null;wp=wp.return}for(wp.sibling.return=wp.return,wp=wp.sibling;wp.tag!==5&&wp.tag!==6&&wp.tag!==18;){if(wp.flags&2||wp.child===null||wp.tag===4)continue e;wp.child.return=wp,wp=wp.child}if(!(wp.flags&2))return wp.stateNode}}function eE(wp){if(dm){e:{for(var Cp=wp.return;Cp!==null;){if(Z_(Cp))break e;Cp=Cp.return}throw Error(up(160))}var Np=Cp;switch(Np.tag){case 5:Cp=Np.stateNode,Np.flags&32&&(hm(Cp),Np.flags&=-33),Np=_b(wp),Ax(wp,Np,Cp);break;case 3:case 4:Cp=Np.stateNode.containerInfo,Np=_b(wp),Cx(wp,Np,Cp);break;default:throw Error(up(161))}}}function Cx(wp,Cp,Np){var Vp=wp.tag;if(Vp===5||Vp===6)wp=wp.stateNode,Cp?Jm(Np,wp,Cp):jm(Np,wp);else if(Vp!==4&&(wp=wp.child,wp!==null))for(Cx(wp,Cp,Np),wp=wp.sibling;wp!==null;)Cx(wp,Cp,Np),wp=wp.sibling}function Ax(wp,Cp,Np){var Vp=wp.tag;if(Vp===5||Vp===6)wp=wp.stateNode,Cp?tv(Np,wp,Cp):Dm(Np,wp);else if(Vp!==4&&(wp=wp.child,wp!==null))for(Ax(wp,Cp,Np),wp=wp.sibling;wp!==null;)Ax(wp,Cp,Np),wp=wp.sibling}function tE(wp,Cp,Np){for(var Vp=Cp,Hp=!1,qp,om;;){if(!Hp){Hp=Vp.return;e:for(;;){if(Hp===null)throw Error(up(160));switch(qp=Hp.stateNode,Hp.tag){case 5:om=!1;break e;case 3:qp=qp.containerInfo,om=!0;break e;case 4:qp=qp.containerInfo,om=!0;break e}Hp=Hp.return}Hp=!0}if(Vp.tag===5||Vp.tag===6)J_(wp,Vp,Np),om?Yp(qp,Vp.stateNode):um(qp,Vp.stateNode);else if(Vp.tag===18)om?Rm(qp,Vp.stateNode):Nm(qp,Vp.stateNode);else if(Vp.tag===4){if(Vp.child!==null){qp=Vp.stateNode.containerInfo,om=!0,Vp.child.return=Vp,Vp=Vp.child;continue}}else if(Y_(wp,Vp,Np),Vp.child!==null){Vp.child.return=Vp,Vp=Vp.child;continue}if(Vp===Cp)break;for(;Vp.sibling===null;){if(Vp.return===null||Vp.return===Cp)return;Vp=Vp.return,Vp.tag===4&&(Hp=!1)}Vp.sibling.return=Vp.return,Vp=Vp.sibling}}function Rx(wp,Cp){if(dm){switch(Cp.tag){case 0:case 11:case 14:case 15:Zy(3,Cp,Cp.return),k0(3,Cp),Zy(5,Cp,Cp.return);return;case 1:return;case 5:var Np=Cp.stateNode;if(Np!=null){var Vp=Cp.memoizedProps;wp=wp!==null?wp.memoizedProps:Vp;var Hp=Cp.type,qp=Cp.updateQueue;Cp.updateQueue=null,qp!==null&&lv(Np,qp,Hp,wp,Vp,Cp)}return;case 6:if(Cp.stateNode===null)throw Error(up(162));Np=Cp.memoizedProps,Fm(Cp.stateNode,wp!==null?wp.memoizedProps:Np,Np);return;case 3:sm&&wp!==null&&wp.memoizedState.isDehydrated&&bm(Cp.stateNode.containerInfo);return;case 12:return;case 13:_1(Cp);return;case 19:_1(Cp);return;case 17:return}throw Error(up(163))}switch(Cp.tag){case 0:case 11:case 14:case 15:Zy(3,Cp,Cp.return),k0(3,Cp),Zy(5,Cp,Cp.return);return;case 12:return;case 13:_1(Cp);return;case 19:_1(Cp);return;case 3:sm&&wp!==null&&wp.memoizedState.isDehydrated&&bm(Cp.stateNode.containerInfo);break;case 22:case 23:return}e:if(em){switch(Cp.tag){case 1:case 5:case 6:break e;case 3:case 4:Cp=Cp.stateNode,nv(Cp.containerInfo,Cp.pendingChildren);break e}throw Error(up(163))}}function _1(wp){var Cp=wp.updateQueue;if(Cp!==null){wp.updateQueue=null;var Np=wp.stateNode;Np===null&&(Np=wp.stateNode=new KE),Cp.forEach(function(Vp){var Hp=oS.bind(null,wp,Vp);Np.has(Vp)||(Np.add(Vp),Vp.then(Hp,Hp))})}}function JE(wp,Cp){for(Wm=Cp;Wm!==null;){Cp=Wm;var Np=Cp.deletions;if(Np!==null)for(var Vp=0;Vp<Np.length;Vp++){var Hp=Np[Vp];try{var qp=wp;dm?tE(qp,Hp,Cp):J_(qp,Hp,Cp);var om=Hp.alternate;om!==null&&(om.return=null),Hp.return=null}catch(Qm){ny(Hp,Cp,Qm)}}if(Np=Cp.child,Cp.subtreeFlags&12854&&Np!==null)Np.return=Cp,Wm=Np;else for(;Wm!==null;){Cp=Wm;try{var vm=Cp.flags;if(vm&32&&dm&&hm(Cp.stateNode),vm&512){var $m=Cp.alternate;if($m!==null){var Hm=$m.ref;Hm!==null&&(typeof Hm=="function"?Hm(null):Hm.current=null)}}if(vm&8192)switch(Cp.tag){case 13:if(Cp.memoizedState!==null){var Ym=Cp.alternate;(Ym===null||Ym.memoizedState===null)&&(Lx=zv())}break;case 22:var hv=Cp.memoizedState!==null,rv=Cp.alternate,wv=rv!==null&&rv.memoizedState!==null;if(Np=Cp,dm){e:if(Vp=Np,Hp=hv,qp=null,dm)for(var _g=Vp;;){if(_g.tag===5){if(qp===null){qp=_g;var Yv=_g.stateNode;Hp?wm(Yv):Vm(_g.stateNode,_g.memoizedProps)}}else if(_g.tag===6){if(qp===null){var yy=_g.stateNode;Hp?Cm(yy):im(yy,_g.memoizedProps)}}else if((_g.tag!==22&&_g.tag!==23||_g.memoizedState===null||_g===Vp)&&_g.child!==null){_g.child.return=_g,_g=_g.child;continue}if(_g===Vp)break;for(;_g.sibling===null;){if(_g.return===null||_g.return===Vp)break e;qp===_g&&(qp=null),_g=_g.return}qp===_g&&(qp=null),_g.sibling.return=_g.return,_g=_g.sibling}}if(hv&&!wv&&Np.mode&1){Wm=Np;for(var Sm=Np.child;Sm!==null;){for(Np=Wm=Sm;Wm!==null;){Vp=Wm;var xm=Vp.child;switch(Vp.tag){case 0:case 11:case 14:case 15:Zy(4,Vp,Vp.return);break;case 1:x1(Vp,Vp.return);var Om=Vp.stateNode;if(typeof Om.componentWillUnmount=="function"){var qm=Vp.return;try{Om.props=Vp.memoizedProps,Om.state=Vp.memoizedState,Om.componentWillUnmount()}catch(Qm){ny(Vp,qm,Qm)}}break;case 5:x1(Vp,Vp.return);break;case 22:if(Vp.memoizedState!==null){iE(Np);continue}}xm!==null?(xm.return=Vp,Wm=xm):iE(Np)}Sm=Sm.sibling}}}switch(vm&4102){case 2:eE(Cp),Cp.flags&=-3;break;case 6:eE(Cp),Cp.flags&=-3,Rx(Cp.alternate,Cp);break;case 4096:Cp.flags&=-4097;break;case 4100:Cp.flags&=-4097,Rx(Cp.alternate,Cp);break;case 4:Rx(Cp.alternate,Cp)}}catch(Qm){ny(Cp,Cp.return,Qm)}if(Np=Cp.sibling,Np!==null){Np.return=Cp.return,Wm=Np;break}Wm=Cp.return}}}function QE(wp,Cp,Np){Wm=wp,nE(wp)}function nE(wp,Cp,Np){for(var Vp=(wp.mode&1)!==0;Wm!==null;){var Hp=Wm,qp=Hp.child;if(Hp.tag===22&&Vp){var om=Hp.memoizedState!==null||y1;if(!om){var vm=Hp.alternate,$m=vm!==null&&vm.memoizedState!==null||Qy;vm=y1;var Hm=Qy;if(y1=om,(Qy=$m)&&!Hm)for(Wm=Hp;Wm!==null;)om=Wm,$m=om.child,om.tag===22&&om.memoizedState!==null?aE(Hp):$m!==null?($m.return=om,Wm=$m):aE(Hp);for(;qp!==null;)Wm=qp,nE(qp),qp=qp.sibling;Wm=Hp,y1=vm,Qy=Hm}rE(wp)}else Hp.subtreeFlags&8772&&qp!==null?(qp.return=Hp,Wm=qp):rE(wp)}}function rE(wp){for(;Wm!==null;){var Cp=Wm;if(Cp.flags&8772){var Np=Cp.alternate;try{if(Cp.flags&8772)switch(Cp.tag){case 0:case 11:case 15:Qy||k0(5,Cp);break;case 1:var Vp=Cp.stateNode;if(Cp.flags&4&&!Qy)if(Np===null)Vp.componentDidMount();else{var Hp=Cp.elementType===Cp.type?Np.memoizedProps:by(Cp.type,Np.memoizedProps);Vp.componentDidUpdate(Hp,Np.memoizedState,Vp.__reactInternalSnapshotBeforeUpdate)}var qp=Cp.updateQueue;qp!==null&&Qx(Cp,qp,Vp);break;case 3:var om=Cp.updateQueue;if(om!==null){if(Np=null,Cp.child!==null)switch(Cp.child.tag){case 5:Np=Lp(Cp.child.stateNode);break;case 1:Np=Cp.child.stateNode}Qx(Cp,om,Np)}break;case 5:var vm=Cp.stateNode;Np===null&&Cp.flags&4&&av(vm,Cp.type,Cp.memoizedProps,Cp);break;case 6:break;case 4:break;case 12:break;case 13:if(sm&&Cp.memoizedState===null){var $m=Cp.alternate;if($m!==null){var Hm=$m.memoizedState;if(Hm!==null){var Ym=Hm.dehydrated;Ym!==null&&Tm(Ym)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(up(163))}Qy||Cp.flags&512&&wx(Cp)}catch(hv){ny(Cp,Cp.return,hv)}}if(Cp===wp){Wm=null;break}if(Np=Cp.sibling,Np!==null){Np.return=Cp.return,Wm=Np;break}Wm=Cp.return}}function iE(wp){for(;Wm!==null;){var Cp=Wm;if(Cp===wp){Wm=null;break}var Np=Cp.sibling;if(Np!==null){Np.return=Cp.return,Wm=Np;break}Wm=Cp.return}}function aE(wp){for(;Wm!==null;){var Cp=Wm;try{switch(Cp.tag){case 0:case 11:case 15:var Np=Cp.return;try{k0(4,Cp)}catch($m){ny(Cp,Np,$m)}break;case 1:var Vp=Cp.stateNode;if(typeof Vp.componentDidMount=="function"){var Hp=Cp.return;try{Vp.componentDidMount()}catch($m){ny(Cp,Hp,$m)}}var qp=Cp.return;try{wx(Cp)}catch($m){ny(Cp,qp,$m)}break;case 5:var om=Cp.return;try{wx(Cp)}catch($m){ny(Cp,om,$m)}}}catch($m){ny(Cp,Cp.return,$m)}if(Cp===wp){Wm=null;break}var vm=Cp.sibling;if(vm!==null){vm.return=Cp.return,Wm=vm;break}Wm=Cp.return}}var b1=0,E1=1,S1=2,w1=3,C1=4;if(typeof Symbol=="function"&&Symbol.for){var D0=Symbol.for;b1=D0("selector.component"),E1=D0("selector.has_pseudo_class"),S1=D0("selector.role"),w1=D0("selector.test_id"),C1=D0("selector.text")}function Tx(wp){var Cp=Zp(wp);if(Cp!=null){if(typeof Cp.memoizedProps["data-testname"]!="string")throw Error(up(364));return Cp}if(wp=pm(wp),wp===null)throw Error(up(362));return wp.stateNode.current}function Mx(wp,Cp){switch(Cp.$$typeof){case b1:if(wp.type===Cp.value)return!0;break;case E1:e:{Cp=Cp.value,wp=[wp,0];for(var Np=0;Np<wp.length;){var Vp=wp[Np++],Hp=wp[Np++],qp=Cp[Hp];if(Vp.tag!==5||!Em(Vp)){for(;qp!=null&&Mx(Vp,qp);)Hp++,qp=Cp[Hp];if(Hp===Cp.length){Cp=!0;break e}else for(Vp=Vp.child;Vp!==null;)wp.push(Vp,Hp),Vp=Vp.sibling}}Cp=!1}return Cp;case S1:if(wp.tag===5&&Bm(wp.stateNode,Cp.value))return!0;break;case C1:if((wp.tag===5||wp.tag===6)&&(wp=ym(wp),wp!==null&&0<=wp.indexOf(Cp.value)))return!0;break;case w1:if(wp.tag===5&&(wp=wp.memoizedProps["data-testname"],typeof wp=="string"&&wp.toLowerCase()===Cp.value.toLowerCase()))return!0;break;default:throw Error(up(365))}return!1}function Ix(wp){switch(wp.$$typeof){case b1:return"<"+(Tp(wp.value)||"Unknown")+">";case E1:return":has("+(Ix(wp)||"")+")";case S1:return'[role="'+wp.value+'"]';case C1:return'"'+wp.value+'"';case w1:return'[data-testname="'+wp.value+'"]';default:throw Error(up(365))}}function oE(wp,Cp){var Np=[];wp=[wp,0];for(var Vp=0;Vp<wp.length;){var Hp=wp[Vp++],qp=wp[Vp++],om=Cp[qp];if(Hp.tag!==5||!Em(Hp)){for(;om!=null&&Mx(Hp,om);)qp++,om=Cp[qp];if(qp===Cp.length)Np.push(Hp);else for(Hp=Hp.child;Hp!==null;)wp.push(Hp,qp),Hp=Hp.sibling}}return Np}function Px(wp,Cp){if(!Jp)throw Error(up(363));wp=Tx(wp),wp=oE(wp,Cp),Cp=[],wp=Array.from(wp);for(var Np=0;Np<wp.length;){var Vp=wp[Np++];if(Vp.tag===5)Em(Vp)||Cp.push(Vp.stateNode);else for(Vp=Vp.child;Vp!==null;)wp.push(Vp),Vp=Vp.sibling}return Cp}var ZE=Math.ceil,A1=cp.ReactCurrentDispatcher,Nx=cp.ReactCurrentOwner,Lv=cp.ReactCurrentBatchConfig,yv=0,kv=null,Dv=null,Wv=0,sy=0,v0=Fv(0),$v=0,$0=null,y0=0,R1=0,Ox=0,B0=null,ey=null,Lx=0,kx=1/0;function x0(){kx=zv()+500}var T1=!1,Dx=null,jy=null,M1=!1,Gy=null,I1=0,F0=0,$x=null,P1=-1,N1=0;function Qv(){return yv&6?zv():P1!==-1?P1:P1=zv()}function Hy(wp){return wp.mode&1?yv&2&&Wv!==0?Wv&-Wv:kE.transition!==null?(N1===0&&(wp=j0,j0<<=1,!(j0&4194240)&&(j0=64),N1=wp),N1):(wp=bv,wp!==0?wp:fm()):1}function gy(wp,Cp,Np){if(50<F0)throw F0=0,$x=null,Error(up(185));var Vp=O1(wp,Cp);return Vp===null?null:(E0(Vp,Cp,Np),(!(yv&2)||Vp!==kv)&&(Vp===kv&&(!(yv&2)&&(R1|=Cp),$v===4&&Wy(Vp,Wv)),ty(Vp,Np),Cp===1&&yv===0&&!(wp.mode&1)&&(x0(),q0&&Ry())),Vp)}function O1(wp,Cp){wp.lanes|=Cp;var Np=wp.alternate;for(Np!==null&&(Np.lanes|=Cp),Np=wp,wp=wp.return;wp!==null;)wp.childLanes|=Cp,Np=wp.alternate,Np!==null&&(Np.childLanes|=Cp),Np=wp,wp=wp.return;return Np.tag===3?Np.stateNode:null}function ty(wp,Cp){var Np=wp.callbackNode;AE(wp,Cp);var Vp=H0(wp,wp===kv?Wv:0);if(Vp===0)Np!==null&&qx(Np),wp.callbackNode=null,wp.callbackPriority=0;else if(Cp=Vp&-Vp,wp.callbackPriority!==Cp){if(Np!=null&&qx(Np),Cp===1)wp.tag===0?LE(lE.bind(null,wp)):Xx(lE.bind(null,wp)),zm?tm(function(){yv===0&&Ry()}):j1(G1,Ry),Np=null;else{switch(Wx(Vp)){case 1:Np=G1;break;case 4:Np=IE;break;case 16:Np=H1;break;case 536870912:Np=PE;break;default:Np=H1}Np=vE(Np,sE.bind(null,wp))}wp.callbackPriority=Cp,wp.callbackNode=Np}}function sE(wp,Cp){if(P1=-1,N1=0,yv&6)throw Error(up(327));var Np=wp.callbackNode;if(n0()&&wp.callbackNode!==Np)return null;var Vp=H0(wp,wp===kv?Wv:0);if(Vp===0)return null;if(Vp&30||Vp&wp.expiredLanes||Cp)Cp=L1(wp,Vp);else{Cp=Vp;var Hp=yv;yv|=2;var qp=dE();(kv!==wp||Wv!==Cp)&&(x0(),e0(wp,Cp));do try{nS();break}catch(vm){cE(wp,vm)}while(!0);X1(),A1.current=qp,yv=Hp,Dv!==null?Cp=0:(kv=null,Wv=0,Cp=$v)}if(Cp!==0){if(Cp===2&&(Hp=V1(wp),Hp!==0&&(Vp=Hp,Cp=Bx(wp,Hp))),Cp===1)throw Np=$0,e0(wp,0),Wy(wp,Vp),ty(wp,zv()),Np;if(Cp===6)Wy(wp,Vp);else{if(Hp=wp.current.alternate,!(Vp&30)&&!eS(Hp)&&(Cp=L1(wp,Vp),Cp===2&&(qp=V1(wp),qp!==0&&(Vp=qp,Cp=Bx(wp,qp))),Cp===1))throw Np=$0,e0(wp,0),Wy(wp,Vp),ty(wp,zv()),Np;switch(wp.finishedWork=Hp,wp.finishedLanes=Vp,Cp){case 0:case 1:throw Error(up(345));case 2:t0(wp,ey);break;case 3:if(Wy(wp,Vp),(Vp&130023424)===Vp&&(Cp=Lx+500-zv(),10<Cp)){if(H0(wp,0)!==0)break;if(Hp=wp.suspendedLanes,(Hp&Vp)!==Vp){Qv(),wp.pingedLanes|=wp.suspendedLanes&Hp;break}wp.timeoutHandle=lm(t0.bind(null,wp,ey),Cp);break}t0(wp,ey);break;case 4:if(Wy(wp,Vp),(Vp&4194240)===Vp)break;for(Cp=wp.eventTimes,Hp=-1;0<Vp;){var om=31-ry(Vp);qp=1<<om,om=Cp[om],om>Hp&&(Hp=om),Vp&=~qp}if(Vp=Hp,Vp=zv()-Vp,Vp=(120>Vp?120:480>Vp?480:1080>Vp?1080:1920>Vp?1920:3e3>Vp?3e3:4320>Vp?4320:1960*ZE(Vp/1960))-Vp,10<Vp){wp.timeoutHandle=lm(t0.bind(null,wp,ey),Vp);break}t0(wp,ey);break;case 5:t0(wp,ey);break;default:throw Error(up(329))}}}return ty(wp,zv()),wp.callbackNode===Np?sE.bind(null,wp):null}function Bx(wp,Cp){var Np=B0;return wp.current.memoizedState.isDehydrated&&(e0(wp,Cp).flags|=256),wp=L1(wp,Cp),wp!==2&&(Cp=ey,ey=Np,Cp!==null&&Fx(Cp)),wp}function Fx(wp){ey===null?ey=wp:ey.push.apply(ey,wp)}function eS(wp){for(var Cp=wp;;){if(Cp.flags&16384){var Np=Cp.updateQueue;if(Np!==null&&(Np=Np.stores,Np!==null))for(var Vp=0;Vp<Np.length;Vp++){var Hp=Np[Vp],qp=Hp.getSnapshot;Hp=Hp.value;try{if(!Ay(qp(),Hp))return!1}catch{return!1}}}if(Np=Cp.child,Cp.subtreeFlags&16384&&Np!==null)Np.return=Cp,Cp=Np;else{if(Cp===wp)break;for(;Cp.sibling===null;){if(Cp.return===null||Cp.return===wp)return!0;Cp=Cp.return}Cp.sibling.return=Cp.return,Cp=Cp.sibling}}return!0}function Wy(wp,Cp){for(Cp&=~Ox,Cp&=~R1,wp.suspendedLanes|=Cp,wp.pingedLanes&=~Cp,wp=wp.expirationTimes;0<Cp;){var Np=31-ry(Cp),Vp=1<<Np;wp[Np]=-1,Cp&=~Vp}}function lE(wp){if(yv&6)throw Error(up(327));n0();var Cp=H0(wp,0);if(!(Cp&1))return ty(wp,zv()),null;var Np=L1(wp,Cp);if(wp.tag!==0&&Np===2){var Vp=V1(wp);Vp!==0&&(Cp=Vp,Np=Bx(wp,Vp))}if(Np===1)throw Np=$0,e0(wp,0),Wy(wp,Cp),ty(wp,zv()),Np;if(Np===6)throw Error(up(345));return wp.finishedWork=wp.current.alternate,wp.finishedLanes=Cp,t0(wp,ey),ty(wp,zv()),null}function uE(wp){Gy!==null&&Gy.tag===0&&!(yv&6)&&n0();var Cp=yv;yv|=1;var Np=Lv.transition,Vp=bv;try{if(Lv.transition=null,bv=1,wp)return wp()}finally{bv=Vp,Lv.transition=Np,yv=Cp,!(yv&6)&&Ry()}}function Vx(){sy=v0.current,sv(v0)}function e0(wp,Cp){wp.finishedWork=null,wp.finishedLanes=0;var Np=wp.timeoutHandle;if(Np!==gm&&(wp.timeoutHandle=gm,cm(Np)),Dv!==null)for(Np=Dv.return;Np!==null;){var Vp=Np;switch(tx(Vp),Vp.tag){case 1:Vp=Vp.type.childContextTypes,Vp!=null&&Ov();break;case 3:m0(),sv(Pv),sv(vv),lx();break;case 5:ox(Vp);break;case 4:m0();break;case 13:sv(Mv);break;case 19:sv(Mv);break;case 10:K1(Vp.type._context);break;case 22:case 23:Vx()}Np=Np.return}if(kv=wp,Dv=wp=qy(wp.current,null),Wv=sy=Cp,$v=0,$0=null,Ox=R1=y0=0,ey=B0=null,Ty!==null){for(Cp=0;Cp<Ty.length;Cp++)if(Np=Ty[Cp],Vp=Np.interleaved,Vp!==null){Np.interleaved=null;var Hp=Vp.next,qp=Np.pending;if(qp!==null){var om=qp.next;qp.next=Hp,Vp.next=om}Np.pending=Vp}Ty=null}return wp}function cE(wp,Cp){do{var Np=Dv;try{if(X1(),i1.current=d1,a1){for(var Vp=Nv.memoizedState;Vp!==null;){var Hp=Vp.queue;Hp!==null&&(Hp.pending=null),Vp=Vp.next}a1=!1}if(g0=0,Uv=qv=Nv=null,T0=!1,M0=0,Nx.current=null,Np===null||Np.return===null){$v=1,$0=Cp,Dv=null;break}e:{var qp=wp,om=Np.return,vm=Np,$m=Cp;if(Cp=Wv,vm.flags|=32768,$m!==null&&typeof $m=="object"&&typeof $m.then=="function"){var Hm=$m,Ym=vm,hv=Ym.tag;if(!(Ym.mode&1)&&(hv===0||hv===11||hv===15)){var rv=Ym.alternate;rv?(Ym.updateQueue=rv.updateQueue,Ym.memoizedState=rv.memoizedState,Ym.lanes=rv.lanes):(Ym.updateQueue=null,Ym.memoizedState=null)}var wv=N_(om);if(wv!==null){wv.flags&=-257,O_(wv,om,vm,qp,Cp),wv.mode&1&&P_(qp,Hm,Cp),Cp=wv,$m=Hm;var _g=Cp.updateQueue;if(_g===null){var Yv=new Set;Yv.add($m),Cp.updateQueue=Yv}else _g.add($m);break e}else{if(!(Cp&1)){P_(qp,Hm,Cp),zx();break e}$m=Error(up(426))}}else if(Rv&&vm.mode&1){var yy=N_(om);if(yy!==null){!(yy.flags&65536)&&(yy.flags|=256),O_(yy,om,vm,qp,Cp),ix($m);break e}}qp=$m,$v!==4&&($v=2),B0===null?B0=[qp]:B0.push(qp),$m=gx($m,vm),vm=om;do{switch(vm.tag){case 3:vm.flags|=65536,Cp&=-Cp,vm.lanes|=Cp;var Sm=M_(vm,$m,Cp);Jx(vm,Sm);break e;case 1:qp=$m;var xm=vm.type,Om=vm.stateNode;if(!(vm.flags&128)&&(typeof xm.getDerivedStateFromError=="function"||Om!==null&&typeof Om.componentDidCatch=="function"&&(jy===null||!jy.has(Om)))){vm.flags|=65536,Cp&=-Cp,vm.lanes|=Cp;var qm=I_(vm,qp,Cp);Jx(vm,qm);break e}}vm=vm.return}while(vm!==null)}fE(Np)}catch(Qm){Cp=Qm,Dv===Np&&Np!==null&&(Dv=Np=Np.return);continue}break}while(!0)}function dE(){var wp=A1.current;return A1.current=d1,wp===null?d1:wp}function zx(){($v===0||$v===3||$v===2)&&($v=4),kv===null||!(y0&268435455)&&!(R1&268435455)||Wy(kv,Wv)}function L1(wp,Cp){var Np=yv;yv|=2;var Vp=dE();kv===wp&&Wv===Cp||e0(wp,Cp);do try{tS();break}catch(Hp){cE(wp,Hp)}while(!0);if(X1(),yv=Np,A1.current=Vp,Dv!==null)throw Error(up(261));return kv=null,Wv=0,$v}function tS(){for(;Dv!==null;)hE(Dv)}function nS(){for(;Dv!==null&&!TE();)hE(Dv)}function hE(wp){var Cp=gE(wp.alternate,wp,sy);wp.memoizedProps=wp.pendingProps,Cp===null?fE(wp):Dv=Cp,Nx.current=null}function fE(wp){var Cp=wp;do{var Np=Cp.alternate;if(wp=Cp.return,Cp.flags&32768){if(Np=XE(Np,Cp),Np!==null){Np.flags&=32767,Dv=Np;return}if(wp!==null)wp.flags|=32768,wp.subtreeFlags=0,wp.deletions=null;else{$v=6,Dv=null;return}}else if(Np=HE(Np,Cp,sy),Np!==null){Dv=Np;return}if(Cp=Cp.sibling,Cp!==null){Dv=Cp;return}Dv=Cp=wp}while(Cp!==null);$v===0&&($v=5)}function t0(wp,Cp){var Np=bv,Vp=Lv.transition;try{Lv.transition=null,bv=1,rS(wp,Cp,Np)}finally{Lv.transition=Vp,bv=Np}return null}function rS(wp,Cp,Np){do n0();while(Gy!==null);if(yv&6)throw Error(up(327));var Vp=wp.finishedWork,Hp=wp.finishedLanes;if(Vp===null)return null;if(wp.finishedWork=null,wp.finishedLanes=0,Vp===wp.current)throw Error(up(177));wp.callbackNode=null,wp.callbackPriority=0;var qp=Vp.lanes|Vp.childLanes;if(RE(wp,qp),wp===kv&&(Dv=kv=null,Wv=0),!(Vp.subtreeFlags&2064)&&!(Vp.flags&2064)||M1||(M1=!0,vE(H1,function(){return n0(),null})),qp=(Vp.flags&15990)!==0,Vp.subtreeFlags&15990||qp){qp=Lv.transition,Lv.transition=null;var om=bv;bv=1;var vm=yv;yv|=4,Nx.current=null,YE(wp,Vp),JE(wp,Vp),Up(wp.containerInfo),wp.current=Vp,QE(Vp),ME(),yv=vm,bv=om,Lv.transition=qp}else wp.current=Vp;if(M1&&(M1=!1,Gy=wp,I1=Hp),qp=wp.pendingLanes,qp===0&&(jy=null),NE(Vp.stateNode),ty(wp,zv()),Cp!==null)for(Np=wp.onRecoverableError,Vp=0;Vp<Cp.length;Vp++)Np(Cp[Vp]);if(T1)throw T1=!1,wp=Dx,Dx=null,wp;return I1&1&&wp.tag!==0&&n0(),qp=wp.pendingLanes,qp&1?wp===$x?F0++:(F0=0,$x=wp):F0=0,Ry(),null}function n0(){if(Gy!==null){var wp=Wx(I1),Cp=Lv.transition,Np=bv;try{if(Lv.transition=null,bv=16>wp?16:wp,Gy===null)var Vp=!1;else{if(wp=Gy,Gy=null,I1=0,yv&6)throw Error(up(331));var Hp=yv;for(yv|=4,Wm=wp.current;Wm!==null;){var qp=Wm,om=qp.child;if(Wm.flags&16){var vm=qp.deletions;if(vm!==null){for(var $m=0;$m<vm.length;$m++){var Hm=vm[$m];for(Wm=Hm;Wm!==null;){var Ym=Wm;switch(Ym.tag){case 0:case 11:case 15:Zy(8,Ym,qp)}var hv=Ym.child;if(hv!==null)hv.return=Ym,Wm=hv;else for(;Wm!==null;){Ym=Wm;var rv=Ym.sibling,wv=Ym.return;if(Q_(Ym),Ym===Hm){Wm=null;break}if(rv!==null){rv.return=wv,Wm=rv;break}Wm=wv}}}var _g=qp.alternate;if(_g!==null){var Yv=_g.child;if(Yv!==null){_g.child=null;do{var yy=Yv.sibling;Yv.sibling=null,Yv=yy}while(Yv!==null)}}Wm=qp}}if(qp.subtreeFlags&2064&&om!==null)om.return=qp,Wm=om;else e:for(;Wm!==null;){if(qp=Wm,qp.flags&2048)switch(qp.tag){case 0:case 11:case 15:Zy(9,qp,qp.return)}var Sm=qp.sibling;if(Sm!==null){Sm.return=qp.return,Wm=Sm;break e}Wm=qp.return}}var xm=wp.current;for(Wm=xm;Wm!==null;){om=Wm;var Om=om.child;if(om.subtreeFlags&2064&&Om!==null)Om.return=om,Wm=Om;else e:for(om=xm;Wm!==null;){if(vm=Wm,vm.flags&2048)try{switch(vm.tag){case 0:case 11:case 15:k0(9,vm)}}catch(Qm){ny(vm,vm.return,Qm)}if(vm===om){Wm=null;break e}var qm=vm.sibling;if(qm!==null){qm.return=vm.return,Wm=qm;break e}Wm=vm.return}}if(yv=Hp,Ry(),Cy&&typeof Cy.onPostCommitFiberRoot=="function")try{Cy.onPostCommitFiberRoot(W0,wp)}catch{}Vp=!0}return Vp}finally{bv=Np,Lv.transition=Cp}}return!1}function pE(wp,Cp,Np){Cp=gx(Np,Cp),Cp=M_(wp,Cp,1),Uy(wp,Cp),Cp=Qv(),wp=O1(wp,1),wp!==null&&(E0(wp,1,Cp),ty(wp,Cp))}function ny(wp,Cp,Np){if(wp.tag===3)pE(wp,wp,Np);else for(;Cp!==null;){if(Cp.tag===3){pE(Cp,wp,Np);break}else if(Cp.tag===1){var Vp=Cp.stateNode;if(typeof Cp.type.getDerivedStateFromError=="function"||typeof Vp.componentDidCatch=="function"&&(jy===null||!jy.has(Vp))){wp=gx(Np,wp),wp=I_(Cp,wp,1),Uy(Cp,wp),wp=Qv(),Cp=O1(Cp,1),Cp!==null&&(E0(Cp,1,wp),ty(Cp,wp));break}}Cp=Cp.return}}function iS(wp,Cp,Np){var Vp=wp.pingCache;Vp!==null&&Vp.delete(Cp),Cp=Qv(),wp.pingedLanes|=wp.suspendedLanes&Np,kv===wp&&(Wv&Np)===Np&&($v===4||$v===3&&(Wv&130023424)===Wv&&500>zv()-Lx?e0(wp,0):Ox|=Np),ty(wp,Cp)}function mE(wp,Cp){Cp===0&&(wp.mode&1?(Cp=G0,G0<<=1,!(G0&130023424)&&(G0=4194304)):Cp=1);var Np=Qv();wp=O1(wp,Cp),wp!==null&&(E0(wp,Cp,Np),ty(wp,Np))}function aS(wp){var Cp=wp.memoizedState,Np=0;Cp!==null&&(Np=Cp.retryLane),mE(wp,Np)}function oS(wp,Cp){var Np=0;switch(wp.tag){case 13:var Vp=wp.stateNode,Hp=wp.memoizedState;Hp!==null&&(Np=Hp.retryLane);break;case 19:Vp=wp.stateNode;break;default:throw Error(up(314))}Vp!==null&&Vp.delete(Cp),mE(wp,Np)}var gE;gE=function(wp,Cp,Np){if(wp!==null)if(wp.memoizedProps!==Cp.pendingProps||Pv.current)oy=!0;else{if(!(wp.lanes&Np)&&!(Cp.flags&128))return oy=!1,qE(wp,Cp,Np);oy=!!(wp.flags&131072)}else oy=!1,Rv&&Cp.flags&1048576&&r_(Cp,t1,Cp.index);switch(Cp.lanes=0,Cp.tag){case 2:var Vp=Cp.type;wp!==null&&(wp.alternate=null,Cp.alternate=null,Cp.flags|=2),wp=Cp.pendingProps;var Hp=uy(Cp,vv.current);u0(Cp,Np),Hp=cx(null,Cp,Vp,wp,Hp,Np);var qp=dx();return Cp.flags|=1,typeof Hp=="object"&&Hp!==null&&typeof Hp.render=="function"&&Hp.$$typeof===void 0?(Cp.tag=1,Cp.memoizedState=null,Cp.updateQueue=null,Vv(Vp)?(qp=!0,Hv(Cp)):qp=!1,Cp.memoizedState=Hp.state!==null&&Hp.state!==void 0?Hp.state:null,J1(Cp),Hp.updater=Z0,Cp.stateNode=Hp,Hp._reactInternals=Cp,Z1(Cp,Vp,wp,Np),Cp=xx(null,Cp,Vp,!0,qp,Np)):(Cp.tag=0,Rv&&qp&&ex(Cp),Jv(null,Cp,Hp,Np),Cp=Cp.child),Cp;case 16:Vp=Cp.elementType;e:{switch(wp!==null&&(wp.alternate=null,Cp.alternate=null,Cp.flags|=2),wp=Cp.pendingProps,Hp=Vp._init,Vp=Hp(Vp._payload),Cp.type=Vp,Hp=Cp.tag=lS(Vp),wp=by(Vp,wp),Hp){case 0:Cp=yx(null,Cp,Vp,wp,Np);break e;case 1:Cp=z_(null,Cp,Vp,wp,Np);break e;case 11:Cp=D_(null,Cp,Vp,wp,Np);break e;case 14:Cp=$_(null,Cp,Vp,by(Vp.type,wp),Np);break e}throw Error(up(306,Vp,""))}return Cp;case 0:return Vp=Cp.type,Hp=Cp.pendingProps,Hp=Cp.elementType===Vp?Hp:by(Vp,Hp),yx(wp,Cp,Vp,Hp,Np);case 1:return Vp=Cp.type,Hp=Cp.pendingProps,Hp=Cp.elementType===Vp?Hp:by(Vp,Hp),z_(wp,Cp,Vp,Hp,Np);case 3:e:{if(U_(Cp),wp===null)throw Error(up(387));Vp=Cp.pendingProps,qp=Cp.memoizedState,Hp=qp.element,Yx(wp,Cp),Q0(Cp,Vp,null,Np);var om=Cp.memoizedState;if(Vp=om.element,sm&&qp.isDehydrated)if(qp={element:Vp,isDehydrated:!1,cache:om.cache,transitions:om.transitions},Cp.updateQueue.baseState=qp,Cp.memoizedState=qp,Cp.flags&256){Hp=Error(up(423)),Cp=j_(wp,Cp,Vp,Np,Hp);break e}else if(Vp!==Hp){Hp=Error(up(424)),Cp=j_(wp,Cp,Vp,Np,Hp);break e}else for(sm&&(ay=V0(Cp.stateNode.containerInfo),iy=Cp,Rv=!0,Ey=null,S0=!1),Np=u_(Cp,null,Vp,Np),Cp.child=Np;Np;)Np.flags=Np.flags&-3|4096,Np=Np.sibling;else{if(h0(),Vp===Hp){Cp=By(wp,Cp,Np);break e}Jv(wp,Cp,Vp,Np)}Cp=Cp.child}return Cp;case 5:return c_(Cp),wp===null&&rx(Cp),Vp=Cp.type,Hp=Cp.pendingProps,qp=wp!==null?wp.memoizedProps:null,om=Hp.children,rm(Vp,Hp)?om=null:qp!==null&&rm(Vp,qp)&&(Cp.flags|=32),V_(wp,Cp),Jv(wp,Cp,om,Np),Cp.child;case 6:return wp===null&&rx(Cp),null;case 13:return G_(wp,Cp,Np);case 4:return ax(Cp,Cp.stateNode.containerInfo),Vp=Cp.pendingProps,wp===null?Cp.child=f0(Cp,null,Vp,Np):Jv(wp,Cp,Vp,Np),Cp.child;case 11:return Vp=Cp.type,Hp=Cp.pendingProps,Hp=Cp.elementType===Vp?Hp:by(Vp,Hp),D_(wp,Cp,Vp,Hp,Np);case 7:return Jv(wp,Cp,Cp.pendingProps,Np),Cp.child;case 8:return Jv(wp,Cp,Cp.pendingProps.children,Np),Cp.child;case 12:return Jv(wp,Cp,Cp.pendingProps.children,Np),Cp.child;case 10:e:{if(Vp=Cp.type._context,Hp=Cp.pendingProps,qp=Cp.memoizedProps,om=Hp.value,Kx(Cp,Vp,om),qp!==null)if(Ay(qp.value,om)){if(qp.children===Hp.children&&!Pv.current){Cp=By(wp,Cp,Np);break e}}else for(qp=Cp.child,qp!==null&&(qp.return=Cp);qp!==null;){var vm=qp.dependencies;if(vm!==null){om=qp.child;for(var $m=vm.firstContext;$m!==null;){if($m.context===Vp){if(qp.tag===1){$m=Ly(-1,Np&-Np),$m.tag=2;var Hm=qp.updateQueue;if(Hm!==null){Hm=Hm.shared;var Ym=Hm.pending;Ym===null?$m.next=$m:($m.next=Ym.next,Ym.next=$m),Hm.pending=$m}}qp.lanes|=Np,$m=qp.alternate,$m!==null&&($m.lanes|=Np),Y1(qp.return,Np,Cp),vm.lanes|=Np;break}$m=$m.next}}else if(qp.tag===10)om=qp.type===Cp.type?null:qp.child;else if(qp.tag===18){if(om=qp.return,om===null)throw Error(up(341));om.lanes|=Np,vm=om.alternate,vm!==null&&(vm.lanes|=Np),Y1(om,Np,Cp),om=qp.sibling}else om=qp.child;if(om!==null)om.return=qp;else for(om=qp;om!==null;){if(om===Cp){om=null;break}if(qp=om.sibling,qp!==null){qp.return=om.return,om=qp;break}om=om.return}qp=om}Jv(wp,Cp,Hp.children,Np),Cp=Cp.child}return Cp;case 9:return Hp=Cp.type,Vp=Cp.pendingProps.children,u0(Cp,Np),Hp=cy(Hp),Vp=Vp(Hp),Cp.flags|=1,Jv(wp,Cp,Vp,Np),Cp.child;case 14:return Vp=Cp.type,Hp=by(Vp,Cp.pendingProps),Hp=by(Vp.type,Hp),$_(wp,Cp,Vp,Hp,Np);case 15:return B_(wp,Cp,Cp.type,Cp.pendingProps,Np);case 17:return Vp=Cp.type,Hp=Cp.pendingProps,Hp=Cp.elementType===Vp?Hp:by(Vp,Hp),wp!==null&&(wp.alternate=null,Cp.alternate=null,Cp.flags|=2),Cp.tag=1,Vv(Vp)?(wp=!0,Hv(Cp)):wp=!1,u0(Cp,Np),t_(Cp,Vp,Hp),Z1(Cp,Vp,Hp,Np),xx(null,Cp,Vp,!0,wp,Np);case 19:return X_(wp,Cp,Np);case 22:return F_(wp,Cp,Np)}throw Error(up(156,Cp.tag))};function vE(wp,Cp){return j1(wp,Cp)}function sS(wp,Cp,Np,Vp){this.tag=wp,this.key=Np,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=Cp,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Vp,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vy(wp,Cp,Np,Vp){return new sS(wp,Cp,Np,Vp)}function Ux(wp){return wp=wp.prototype,!(!wp||!wp.isReactComponent)}function lS(wp){if(typeof wp=="function")return Ux(wp)?1:0;if(wp!=null){if(wp=wp.$$typeof,wp===xp)return 11;if(wp===bp)return 14}return 2}function qy(wp,Cp){var Np=wp.alternate;return Np===null?(Np=vy(wp.tag,Cp,wp.key,wp.mode),Np.elementType=wp.elementType,Np.type=wp.type,Np.stateNode=wp.stateNode,Np.alternate=wp,wp.alternate=Np):(Np.pendingProps=Cp,Np.type=wp.type,Np.flags=0,Np.subtreeFlags=0,Np.deletions=null),Np.flags=wp.flags&14680064,Np.childLanes=wp.childLanes,Np.lanes=wp.lanes,Np.child=wp.child,Np.memoizedProps=wp.memoizedProps,Np.memoizedState=wp.memoizedState,Np.updateQueue=wp.updateQueue,Cp=wp.dependencies,Np.dependencies=Cp===null?null:{lanes:Cp.lanes,firstContext:Cp.firstContext},Np.sibling=wp.sibling,Np.index=wp.index,Np.ref=wp.ref,Np}function k1(wp,Cp,Np,Vp,Hp,qp){var om=2;if(Vp=wp,typeof wp=="function")Ux(wp)&&(om=1);else if(typeof wp=="string")om=5;else e:switch(wp){case fp:return r0(Np.children,Hp,qp,Cp);case pp:om=8,Hp|=8;break;case mp:return wp=vy(12,Np,Cp,Hp|2),wp.elementType=mp,wp.lanes=qp,wp;case _p:return wp=vy(13,Np,Cp,Hp),wp.elementType=_p,wp.lanes=qp,wp;case vp:return wp=vy(19,Np,Cp,Hp),wp.elementType=vp,wp.lanes=qp,wp;case Sp:return D1(Np,Hp,qp,Cp);default:if(typeof wp=="object"&&wp!==null)switch(wp.$$typeof){case gp:om=10;break e;case yp:om=9;break e;case xp:om=11;break e;case bp:om=14;break e;case Ep:om=16,Vp=null;break e}throw Error(up(130,wp==null?wp:typeof wp,""))}return Cp=vy(om,Np,Cp,Hp),Cp.elementType=wp,Cp.type=Vp,Cp.lanes=qp,Cp}function r0(wp,Cp,Np,Vp){return wp=vy(7,wp,Vp,Cp),wp.lanes=Np,wp}function D1(wp,Cp,Np,Vp){return wp=vy(22,wp,Vp,Cp),wp.elementType=Sp,wp.lanes=Np,wp.stateNode={},wp}function jx(wp,Cp,Np){return wp=vy(6,wp,null,Cp),wp.lanes=Np,wp}function Gx(wp,Cp,Np){return Cp=vy(4,wp.children!==null?wp.children:[],wp.key,Cp),Cp.lanes=Np,Cp.stateNode={containerInfo:wp.containerInfo,pendingChildren:null,implementation:wp.implementation},Cp}function uS(wp,Cp,Np,Vp,Hp){this.tag=Cp,this.containerInfo=wp,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=gm,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=z1(0),this.expirationTimes=z1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z1(0),this.identifierPrefix=Vp,this.onRecoverableError=Hp,sm&&(this.mutableSourceEagerHydrationData=null)}function yE(wp,Cp,Np,Vp,Hp,qp,om,vm,$m){return wp=new uS(wp,Cp,Np,vm,$m),Cp===1?(Cp=1,qp===!0&&(Cp|=8)):Cp=0,qp=vy(3,null,null,Cp),wp.current=qp,qp.stateNode=wp,qp.memoizedState={element:Vp,isDehydrated:Np,cache:null,transitions:null},J1(qp),wp}function xE(wp){if(!wp)return ly;wp=wp._reactInternals;e:{if(Op(wp)!==wp||wp.tag!==1)throw Error(up(170));var Cp=wp;do{switch(Cp.tag){case 3:Cp=Cp.stateNode.context;break e;case 1:if(Vv(Cp.type)){Cp=Cp.stateNode.__reactInternalMemoizedMergedChildContext;break e}}Cp=Cp.return}while(Cp!==null);throw Error(up(171))}if(wp.tag===1){var Np=wp.type;if(Vv(Np))return o0(wp,Np,Cp)}return Cp}function _E(wp){var Cp=wp._reactInternals;if(Cp===void 0)throw typeof wp.render=="function"?Error(up(188)):(wp=Object.keys(wp).join(","),Error(up(268,wp)));return wp=zp(Cp),wp===null?null:wp.stateNode}function bE(wp,Cp){if(wp=wp.memoizedState,wp!==null&&wp.dehydrated!==null){var Np=wp.retryLane;wp.retryLane=Np!==0&&Np<Cp?Np:Cp}}function Hx(wp,Cp){bE(wp,Cp),(wp=wp.alternate)&&bE(wp,Cp)}function cS(wp){return wp=zp(wp),wp===null?null:wp.stateNode}function dS(){return null}return np.attemptContinuousHydration=function(wp){if(wp.tag===13){var Cp=Qv();gy(wp,134217728,Cp),Hx(wp,134217728)}},np.attemptHydrationAtCurrentPriority=function(wp){if(wp.tag===13){var Cp=Qv(),Np=Hy(wp);gy(wp,Np,Cp),Hx(wp,Np)}},np.attemptSynchronousHydration=function(wp){switch(wp.tag){case 3:var Cp=wp.stateNode;if(Cp.current.memoizedState.isDehydrated){var Np=b0(Cp.pendingLanes);Np!==0&&(U1(Cp,Np|1),ty(Cp,zv()),!(yv&6)&&(x0(),Ry()))}break;case 13:var Vp=Qv();uE(function(){return gy(wp,1,Vp)}),Hx(wp,1)}},np.batchedUpdates=function(wp,Cp){var Np=yv;yv|=1;try{return wp(Cp)}finally{yv=Np,yv===0&&(x0(),q0&&Ry())}},np.createComponentSelector=function(wp){return{$$typeof:b1,value:wp}},np.createContainer=function(wp,Cp,Np,Vp,Hp,qp,om){return yE(wp,Cp,!1,null,Np,Vp,Hp,qp,om)},np.createHasPseudoClassSelector=function(wp){return{$$typeof:E1,value:wp}},np.createHydrationContainer=function(wp,Cp,Np,Vp,Hp,qp,om,vm,$m){return wp=yE(Np,Vp,!0,wp,Hp,qp,om,vm,$m),wp.context=xE(null),Np=wp.current,Vp=Qv(),Hp=Hy(Np),qp=Ly(Vp,Hp),qp.callback=Cp??null,Uy(Np,qp),wp.current.lanes=Hp,E0(wp,Hp,Vp),ty(wp,Vp),wp},np.createPortal=function(wp,Cp,Np){var Vp=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hp,key:Vp==null?null:""+Vp,children:wp,containerInfo:Cp,implementation:Np}},np.createRoleSelector=function(wp){return{$$typeof:S1,value:wp}},np.createTestNameSelector=function(wp){return{$$typeof:w1,value:wp}},np.createTextSelector=function(wp){return{$$typeof:C1,value:wp}},np.deferredUpdates=function(wp){var Cp=bv,Np=Lv.transition;try{return Lv.transition=null,bv=16,wp()}finally{bv=Cp,Lv.transition=Np}},np.discreteUpdates=function(wp,Cp,Np,Vp,Hp){var qp=bv,om=Lv.transition;try{return Lv.transition=null,bv=1,wp(Cp,Np,Vp,Hp)}finally{bv=qp,Lv.transition=om,yv===0&&x0()}},np.findAllNodes=Px,np.findBoundingRects=function(wp,Cp){if(!Jp)throw Error(up(363));Cp=Px(wp,Cp),wp=[];for(var Np=0;Np<Cp.length;Np++)wp.push(km(Cp[Np]));for(Cp=wp.length-1;0<Cp;Cp--){Np=wp[Cp];for(var Vp=Np.x,Hp=Vp+Np.width,qp=Np.y,om=qp+Np.height,vm=Cp-1;0<=vm;vm--)if(Cp!==vm){var $m=wp[vm],Hm=$m.x,Ym=Hm+$m.width,hv=$m.y,rv=hv+$m.height;if(Vp>=Hm&&qp>=hv&&Hp<=Ym&&om<=rv){wp.splice(Cp,1);break}else if(Vp!==Hm||Np.width!==$m.width||rv<qp||hv>om){if(!(qp!==hv||Np.height!==$m.height||Ym<Vp||Hm>Hp)){Hm>Vp&&($m.width+=Hm-Vp,$m.x=Vp),Ym<Hp&&($m.width=Hp-Hm),wp.splice(Cp,1);break}}else{hv>qp&&($m.height+=hv-qp,$m.y=qp),rv<om&&($m.height=om-hv),wp.splice(Cp,1);break}}}return wp},np.findHostInstance=_E,np.findHostInstanceWithNoPortals=function(wp){return wp=$p(wp),wp=wp!==null?Fp(wp):null,wp===null?null:wp.stateNode},np.findHostInstanceWithWarning=function(wp){return _E(wp)},np.flushControlled=function(wp){var Cp=yv;yv|=1;var Np=Lv.transition,Vp=bv;try{Lv.transition=null,bv=1,wp()}finally{bv=Vp,Lv.transition=Np,yv=Cp,yv===0&&(x0(),Ry())}},np.flushPassiveEffects=n0,np.flushSync=uE,np.focusWithin=function(wp,Cp){if(!Jp)throw Error(up(363));for(wp=Tx(wp),Cp=oE(wp,Cp),Cp=Array.from(Cp),wp=0;wp<Cp.length;){var Np=Cp[wp++];if(!Em(Np)){if(Np.tag===5&&Pm(Np.stateNode))return!0;for(Np=Np.child;Np!==null;)Cp.push(Np),Np=Np.sibling}}return!1},np.getCurrentUpdatePriority=function(){return bv},np.getFindAllNodesFailureDescription=function(wp,Cp){if(!Jp)throw Error(up(363));var Np=0,Vp=[];wp=[Tx(wp),0];for(var Hp=0;Hp<wp.length;){var qp=wp[Hp++],om=wp[Hp++],vm=Cp[om];if((qp.tag!==5||!Em(qp))&&(Mx(qp,vm)&&(Vp.push(Ix(vm)),om++,om>Np&&(Np=om)),om<Cp.length))for(qp=qp.child;qp!==null;)wp.push(qp,om),qp=qp.sibling}if(Np<Cp.length){for(wp=[];Np<Cp.length;Np++)wp.push(Ix(Cp[Np]));return`findAllNodes was able to match part of the selector:
  `+(Vp.join(" > ")+`

No matching component was found for:
  `)+wp.join(" > ")}return null},np.getPublicRootInstance=function(wp){if(wp=wp.current,!wp.child)return null;switch(wp.child.tag){case 5:return Lp(wp.child.stateNode);default:return wp.child.stateNode}},np.injectIntoDevTools=function(wp){if(wp={bundleType:wp.bundleType,version:wp.version,rendererPackageName:wp.rendererPackageName,rendererConfig:wp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cp.ReactCurrentDispatcher,findHostInstanceByFiber:cS,findFiberByHostInstance:wp.findFiberByHostInstance||dS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")wp=!1;else{var Cp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(Cp.isDisabled||!Cp.supportsFiber)wp=!0;else{try{W0=Cp.inject(wp),Cy=Cp}catch{}wp=!!Cp.checkDCE}}return wp},np.isAlreadyRendering=function(){return!1},np.observeVisibleRects=function(wp,Cp,Np,Vp){if(!Jp)throw Error(up(363));wp=Px(wp,Cp);var Hp=Im(wp,Np,Vp).disconnect;return{disconnect:function(){Hp()}}},np.registerMutableSourceForHydration=function(wp,Cp){var Np=Cp._getVersion;Np=Np(Cp._source),wp.mutableSourceEagerHydrationData==null?wp.mutableSourceEagerHydrationData=[Cp,Np]:wp.mutableSourceEagerHydrationData.push(Cp,Np)},np.runWithPriority=function(wp,Cp){var Np=bv;try{return bv=wp,Cp()}finally{bv=Np}},np.shouldError=function(){return null},np.shouldSuspend=function(){return!1},np.updateContainer=function(wp,Cp,Np,Vp){var Hp=Cp.current,qp=Qv(),om=Hy(Hp);return Np=xE(Np),Cp.context===null?Cp.context=Np:Cp.pendingContext=Np,Cp=Ly(qp,om),Cp.payload={element:wp},Vp=Vp===void 0?null:Vp,Vp!==null&&(Cp.callback=Vp),Uy(Hp,Cp),wp=gy(Hp,om,qp),wp!==null&&J0(wp,Hp,om),om},np};reactReconciler.exports=reactReconciler_production_min;var reactReconcilerExports=reactReconciler.exports;const Reconciler=getDefaultExportFromCjs(reactReconcilerExports);var scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(rp){function _d(Ip,kp){var Up=Ip.length;Ip.push(kp);e:for(;0<Up;){var Gp=Up-1>>>1,Wp=Ip[Gp];if(0<sp(Wp,kp))Ip[Gp]=kp,Ip[Up]=Wp,Up=Gp;else break e}}function np(Ip){return Ip.length===0?null:Ip[0]}function ap(Ip){if(Ip.length===0)return null;var kp=Ip[0],Up=Ip.pop();if(Up!==kp){Ip[0]=Up;e:for(var Gp=0,Wp=Ip.length,Qp=Wp>>>1;Gp<Qp;){var Xp=2*(Gp+1)-1,rm=Ip[Xp],Kp=Xp+1,lm=Ip[Kp];if(0>sp(rm,Up))Kp<Wp&&0>sp(lm,rm)?(Ip[Gp]=lm,Ip[Kp]=Up,Gp=Kp):(Ip[Gp]=rm,Ip[Xp]=Up,Gp=Xp);else if(Kp<Wp&&0>sp(lm,Up))Ip[Gp]=lm,Ip[Kp]=Up,Gp=Kp;else break e}}return kp}function sp(Ip,kp){var Up=Ip.sortIndex-kp.sortIndex;return Up!==0?Up:Ip.id-kp.id}if(typeof performance=="object"&&typeof performance.now=="function"){var lp=performance;rp.unstable_now=function(){return lp.now()}}else{var up=Date,cp=up.now();rp.unstable_now=function(){return up.now()-cp}}var dp=[],hp=[],fp=1,pp=null,mp=3,gp=!1,yp=!1,xp=!1,_p=typeof setTimeout=="function"?setTimeout:null,vp=typeof clearTimeout=="function"?clearTimeout:null,bp=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Ep(Ip){for(var kp=np(hp);kp!==null;){if(kp.callback===null)ap(hp);else if(kp.startTime<=Ip)ap(hp),kp.sortIndex=kp.expirationTime,_d(dp,kp);else break;kp=np(hp)}}function Sp(Ip){if(xp=!1,Ep(Ip),!yp)if(np(dp)!==null)yp=!0,Lp(Ap);else{var kp=np(hp);kp!==null&&Bp(Sp,kp.startTime-Ip)}}function Ap(Ip,kp){yp=!1,xp&&(xp=!1,vp(Mp),Mp=-1),gp=!0;var Up=mp;try{for(Ep(kp),pp=np(dp);pp!==null&&(!(pp.expirationTime>kp)||Ip&&!$p());){var Gp=pp.callback;if(typeof Gp=="function"){pp.callback=null,mp=pp.priorityLevel;var Wp=Gp(pp.expirationTime<=kp);kp=rp.unstable_now(),typeof Wp=="function"?pp.callback=Wp:pp===np(dp)&&ap(dp),Ep(kp)}else ap(dp);pp=np(dp)}if(pp!==null)var Qp=!0;else{var Xp=np(hp);Xp!==null&&Bp(Sp,Xp.startTime-kp),Qp=!1}return Qp}finally{pp=null,mp=Up,gp=!1}}var Rp=!1,Tp=null,Mp=-1,Op=5,Pp=-1;function $p(){return!(rp.unstable_now()-Pp<Op)}function zp(){if(Tp!==null){var Ip=rp.unstable_now();Pp=Ip;var kp=!0;try{kp=Tp(!0,Ip)}finally{kp?Dp():(Rp=!1,Tp=null)}}else Rp=!1}var Dp;if(typeof bp=="function")Dp=function(){bp(zp)};else if(typeof MessageChannel<"u"){var Fp=new MessageChannel,jp=Fp.port2;Fp.port1.onmessage=zp,Dp=function(){jp.postMessage(null)}}else Dp=function(){_p(zp,0)};function Lp(Ip){Tp=Ip,Rp||(Rp=!0,Dp())}function Bp(Ip,kp){Mp=_p(function(){Ip(rp.unstable_now())},kp)}rp.unstable_IdlePriority=5,rp.unstable_ImmediatePriority=1,rp.unstable_LowPriority=4,rp.unstable_NormalPriority=3,rp.unstable_Profiling=null,rp.unstable_UserBlockingPriority=2,rp.unstable_cancelCallback=function(Ip){Ip.callback=null},rp.unstable_continueExecution=function(){yp||gp||(yp=!0,Lp(Ap))},rp.unstable_forceFrameRate=function(Ip){0>Ip||125<Ip?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Op=0<Ip?Math.floor(1e3/Ip):5},rp.unstable_getCurrentPriorityLevel=function(){return mp},rp.unstable_getFirstCallbackNode=function(){return np(dp)},rp.unstable_next=function(Ip){switch(mp){case 1:case 2:case 3:var kp=3;break;default:kp=mp}var Up=mp;mp=kp;try{return Ip()}finally{mp=Up}},rp.unstable_pauseExecution=function(){},rp.unstable_requestPaint=function(){},rp.unstable_runWithPriority=function(Ip,kp){switch(Ip){case 1:case 2:case 3:case 4:case 5:break;default:Ip=3}var Up=mp;mp=Ip;try{return kp()}finally{mp=Up}},rp.unstable_scheduleCallback=function(Ip,kp,Up){var Gp=rp.unstable_now();switch(typeof Up=="object"&&Up!==null?(Up=Up.delay,Up=typeof Up=="number"&&0<Up?Gp+Up:Gp):Up=Gp,Ip){case 1:var Wp=-1;break;case 2:Wp=250;break;case 5:Wp=1073741823;break;case 4:Wp=1e4;break;default:Wp=5e3}return Wp=Up+Wp,Ip={id:fp++,callback:kp,priorityLevel:Ip,startTime:Up,expirationTime:Wp,sortIndex:-1},Up>Gp?(Ip.sortIndex=Up,_d(hp,Ip),np(dp)===null&&Ip===np(hp)&&(xp?(vp(Mp),Mp=-1):xp=!0,Bp(Sp,Up-Gp))):(Ip.sortIndex=Wp,_d(dp,Ip),yp||gp||(yp=!0,Lp(Ap))),Ip},rp.unstable_shouldYield=$p,rp.unstable_wrapCallback=function(Ip){var kp=mp;return function(){var Up=mp;mp=kp;try{return Ip.apply(this,arguments)}finally{mp=Up}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;const isPromise=rp=>typeof rp=="object"&&typeof rp.then=="function",globalCache=[];function shallowEqualArrays(rp,_d,np=(ap,sp)=>ap===sp){if(rp===_d)return!0;if(!rp||!_d)return!1;const ap=rp.length;if(_d.length!==ap)return!1;for(let sp=0;sp<ap;sp++)if(!np(rp[sp],_d[sp]))return!1;return!0}function query(rp,_d=null,np=!1,ap={}){_d===null&&(_d=[rp]);for(const lp of globalCache)if(shallowEqualArrays(_d,lp.keys,lp.equal)){if(np)return;if(Object.prototype.hasOwnProperty.call(lp,"error"))throw lp.error;if(Object.prototype.hasOwnProperty.call(lp,"response"))return ap.lifespan&&ap.lifespan>0&&(lp.timeout&&clearTimeout(lp.timeout),lp.timeout=setTimeout(lp.remove,ap.lifespan)),lp.response;if(!np)throw lp.promise}const sp={keys:_d,equal:ap.equal,remove:()=>{const lp=globalCache.indexOf(sp);lp!==-1&&globalCache.splice(lp,1)},promise:(isPromise(rp)?rp:rp(..._d)).then(lp=>{sp.response=lp,ap.lifespan&&ap.lifespan>0&&(sp.timeout=setTimeout(sp.remove,ap.lifespan))}).catch(lp=>sp.error=lp)};if(globalCache.push(sp),!np)throw sp.promise}const suspend=(rp,_d,np)=>query(rp,_d,!1,np),preload=(rp,_d,np)=>void query(rp,_d,!0,np),clear=rp=>{if(rp===void 0||rp.length===0)globalCache.splice(0,globalCache.length);else{const _d=globalCache.find(np=>shallowEqualArrays(rp,np.keys,np.equal));_d&&_d.remove()}},catalogue={},extend=rp=>void Object.assign(catalogue,rp);function createRenderer(rp,_d){function np(fp,{args:pp=[],attach:mp,...gp},yp){let xp=`${fp[0].toUpperCase()}${fp.slice(1)}`,_p;if(fp==="primitive"){if(gp.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const vp=gp.object;_p=prepare(vp,{type:fp,root:yp,attach:mp,primitive:!0})}else{const vp=catalogue[xp];if(!vp)throw new Error(`R3F: ${xp} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(pp))throw new Error("R3F: The args prop must be an array!");_p=prepare(new vp(...pp),{type:fp,root:yp,attach:mp,memoizedProps:{args:pp}})}return _p.__r3f.attach===void 0&&(_p instanceof BufferGeometry?_p.__r3f.attach="geometry":_p instanceof Material&&(_p.__r3f.attach="material")),xp!=="inject"&&applyProps$1(_p,gp),_p}function ap(fp,pp){let mp=!1;if(pp){var gp,yp;(gp=pp.__r3f)!=null&&gp.attach?attach(fp,pp,pp.__r3f.attach):pp.isObject3D&&fp.isObject3D&&(fp.add(pp),mp=!0),mp||(yp=fp.__r3f)==null||yp.objects.push(pp),pp.__r3f||prepare(pp,{}),pp.__r3f.parent=fp,updateInstance(pp),invalidateInstance(pp)}}function sp(fp,pp,mp){let gp=!1;if(pp){var yp,xp;if((yp=pp.__r3f)!=null&&yp.attach)attach(fp,pp,pp.__r3f.attach);else if(pp.isObject3D&&fp.isObject3D){pp.parent=fp,pp.dispatchEvent({type:"added"});const _p=fp.children.filter(bp=>bp!==pp),vp=_p.indexOf(mp);fp.children=[..._p.slice(0,vp),pp,..._p.slice(vp)],gp=!0}gp||(xp=fp.__r3f)==null||xp.objects.push(pp),pp.__r3f||prepare(pp,{}),pp.__r3f.parent=fp,updateInstance(pp),invalidateInstance(pp)}}function lp(fp,pp,mp=!1){fp&&[...fp].forEach(gp=>up(pp,gp,mp))}function up(fp,pp,mp){if(pp){var gp,yp,xp;if(pp.__r3f&&(pp.__r3f.parent=null),(gp=fp.__r3f)!=null&&gp.objects&&(fp.__r3f.objects=fp.__r3f.objects.filter(Sp=>Sp!==pp)),(yp=pp.__r3f)!=null&&yp.attach)detach(fp,pp,pp.__r3f.attach);else if(pp.isObject3D&&fp.isObject3D){var _p;fp.remove(pp),(_p=pp.__r3f)!=null&&_p.root&&removeInteractivity(findInitialRoot(pp),pp)}const bp=(xp=pp.__r3f)==null?void 0:xp.primitive,Ep=!bp&&(mp===void 0?pp.dispose!==null:mp);if(!bp){var vp;lp((vp=pp.__r3f)==null?void 0:vp.objects,pp,Ep),lp(pp.children,pp,Ep)}if(delete pp.__r3f,Ep&&pp.dispose&&pp.type!=="Scene"){const Sp=()=>{try{pp.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?schedulerExports.unstable_scheduleCallback(schedulerExports.unstable_IdlePriority,Sp):Sp()}invalidateInstance(fp)}}function cp(fp,pp,mp,gp){var yp;const xp=(yp=fp.__r3f)==null?void 0:yp.parent;if(!xp)return;const _p=np(pp,mp,fp.__r3f.root);if(fp.children){for(const vp of fp.children)vp.__r3f&&ap(_p,vp);fp.children=fp.children.filter(vp=>!vp.__r3f)}fp.__r3f.objects.forEach(vp=>ap(_p,vp)),fp.__r3f.objects=[],fp.__r3f.autoRemovedBeforeAppend||up(xp,fp),_p.parent&&(_p.__r3f.autoRemovedBeforeAppend=!0),ap(xp,_p),_p.raycast&&_p.__r3f.eventCount&&findInitialRoot(_p).getState().internal.interaction.push(_p),[gp,gp.alternate].forEach(vp=>{vp!==null&&(vp.stateNode=_p,vp.ref&&(typeof vp.ref=="function"?vp.ref(_p):vp.ref.current=_p))})}const dp=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Reconciler({createInstance:np,removeChild:up,appendChild:ap,appendInitialChild:ap,insertBefore:sp,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(fp,pp)=>{if(!pp)return;const mp=fp.getState().scene;mp.__r3f&&(mp.__r3f.root=fp,ap(mp,pp))},removeChildFromContainer:(fp,pp)=>{pp&&up(fp.getState().scene,pp)},insertInContainerBefore:(fp,pp,mp)=>{if(!pp||!mp)return;const gp=fp.getState().scene;gp.__r3f&&sp(gp,pp,mp)},getRootHostContext:()=>null,getChildHostContext:fp=>fp,finalizeInitialChildren(fp){var pp;return!!((pp=fp==null?void 0:fp.__r3f)!=null?pp:{}).handlers},prepareUpdate(fp,pp,mp,gp){var yp;if(((yp=fp==null?void 0:fp.__r3f)!=null?yp:{}).primitive&&gp.object&&gp.object!==fp)return[!0];{const{args:_p=[],children:vp,...bp}=gp,{args:Ep=[],children:Sp,...Ap}=mp;if(!Array.isArray(_p))throw new Error("R3F: the args prop must be an array!");if(_p.some((Tp,Mp)=>Tp!==Ep[Mp]))return[!0];const Rp=diffProps(fp,bp,Ap,!0);return Rp.changes.length?[!1,Rp]:null}},commitUpdate(fp,[pp,mp],gp,yp,xp,_p){pp?cp(fp,gp,xp,_p):applyProps$1(fp,mp)},commitMount(fp,pp,mp,gp){var yp;const xp=(yp=fp.__r3f)!=null?yp:{};fp.raycast&&xp.handlers&&xp.eventCount&&findInitialRoot(fp).getState().internal.interaction.push(fp)},getPublicInstance:fp=>fp,prepareForCommit:()=>null,preparePortalMount:fp=>prepare(fp.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(fp){var pp;const{attach:mp,parent:gp}=(pp=fp.__r3f)!=null?pp:{};mp&&gp&&detach(gp,fp,mp),fp.isObject3D&&(fp.visible=!1),invalidateInstance(fp)},unhideInstance(fp,pp){var mp;const{attach:gp,parent:yp}=(mp=fp.__r3f)!=null?mp:{};gp&&yp&&attach(yp,fp,gp),(fp.isObject3D&&pp.visible==null||pp.visible)&&(fp.visible=!0),invalidateInstance(fp)},createTextInstance:dp,hideTextInstance:dp,unhideTextInstance:dp,getCurrentEventPriority:()=>_d?_d():constantsExports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&is.fun(performance.now)?performance.now:is.fun(Date.now)?Date.now:()=>0,scheduleTimeout:is.fun(setTimeout)?setTimeout:void 0,cancelTimeout:is.fun(clearTimeout)?clearTimeout:void 0}),applyProps:applyProps$1}}var _window$document,_window$navigator;const hasColorSpace=rp=>"colorSpace"in rp||"outputColorSpace"in rp,getColorManagement=()=>{var rp;return(rp=catalogue.ColorManagement)!=null?rp:null},isOrthographicCamera=rp=>rp&&rp.isOrthographicCamera,isRef=rp=>rp&&rp.hasOwnProperty("current"),useIsomorphicLayoutEffect=typeof window<"u"&&((_window$document=window.document)!=null&&_window$document.createElement||((_window$navigator=window.navigator)==null?void 0:_window$navigator.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableCallback(rp){const _d=reactExports.useRef(rp);return useIsomorphicLayoutEffect(()=>void(_d.current=rp),[rp]),_d}function Block({set:rp}){return useIsomorphicLayoutEffect(()=>(rp(new Promise(()=>null)),()=>rp(!1)),[rp]),null}class ErrorBoundary extends reactExports.Component{constructor(..._d){super(..._d),this.state={error:!1}}componentDidCatch(_d){this.props.set(_d)}render(){return this.state.error?null:this.props.children}}ErrorBoundary.getDerivedStateFromError=()=>({error:!0});const DEFAULT="__default",DEFAULTS=new Map,isDiffSet=rp=>rp&&!!rp.memoized&&!!rp.changes;function calculateDpr(rp){var _d;const np=typeof window<"u"?(_d=window.devicePixelRatio)!=null?_d:2:1;return Array.isArray(rp)?Math.min(Math.max(rp[0],np),rp[1]):rp}const getRootState=rp=>{var _d;return(_d=rp.__r3f)==null?void 0:_d.root.getState()};function findInitialRoot(rp){let _d=rp.__r3f.root;for(;_d.getState().previousRoot;)_d=_d.getState().previousRoot;return _d}const is={obj:rp=>rp===Object(rp)&&!is.arr(rp)&&typeof rp!="function",fun:rp=>typeof rp=="function",str:rp=>typeof rp=="string",num:rp=>typeof rp=="number",boo:rp=>typeof rp=="boolean",und:rp=>rp===void 0,arr:rp=>Array.isArray(rp),equ(rp,_d,{arrays:np="shallow",objects:ap="reference",strict:sp=!0}={}){if(typeof rp!=typeof _d||!!rp!=!!_d)return!1;if(is.str(rp)||is.num(rp))return rp===_d;const lp=is.obj(rp);if(lp&&ap==="reference")return rp===_d;const up=is.arr(rp);if(up&&np==="reference")return rp===_d;if((up||lp)&&rp===_d)return!0;let cp;for(cp in rp)if(!(cp in _d))return!1;if(lp&&np==="shallow"&&ap==="shallow"){for(cp in sp?_d:rp)if(!is.equ(rp[cp],_d[cp],{strict:sp,objects:"reference"}))return!1}else for(cp in sp?_d:rp)if(rp[cp]!==_d[cp])return!1;if(is.und(cp)){if(up&&rp.length===0&&_d.length===0||lp&&Object.keys(rp).length===0&&Object.keys(_d).length===0)return!0;if(rp!==_d)return!1}return!0}};function buildGraph(rp){const _d={nodes:{},materials:{}};return rp&&rp.traverse(np=>{np.name&&(_d.nodes[np.name]=np),np.material&&!_d.materials[np.material.name]&&(_d.materials[np.material.name]=np.material)}),_d}function dispose(rp){rp.dispose&&rp.type!=="Scene"&&rp.dispose();for(const _d in rp)_d.dispose==null||_d.dispose(),delete rp[_d]}function prepare(rp,_d){const np=rp;return np.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,..._d},rp}function resolve(rp,_d){let np=rp;if(_d.includes("-")){const ap=_d.split("-"),sp=ap.pop();return np=ap.reduce((lp,up)=>lp[up],rp),{target:np,key:sp}}else return{target:np,key:_d}}const INDEX_REGEX=/-\d+$/;function attach(rp,_d,np){if(is.str(np)){if(INDEX_REGEX.test(np)){const lp=np.replace(INDEX_REGEX,""),{target:up,key:cp}=resolve(rp,lp);Array.isArray(up[cp])||(up[cp]=[])}const{target:ap,key:sp}=resolve(rp,np);_d.__r3f.previousAttach=ap[sp],ap[sp]=_d}else _d.__r3f.previousAttach=np(rp,_d)}function detach(rp,_d,np){var ap,sp;if(is.str(np)){const{target:lp,key:up}=resolve(rp,np),cp=_d.__r3f.previousAttach;cp===void 0?delete lp[up]:lp[up]=cp}else(ap=_d.__r3f)==null||ap.previousAttach==null||ap.previousAttach(rp,_d);(sp=_d.__r3f)==null||delete sp.previousAttach}function diffProps(rp,{children:_d,key:np,ref:ap,...sp},{children:lp,key:up,ref:cp,...dp}={},hp=!1){var fp;const pp=(fp=rp==null?void 0:rp.__r3f)!=null?fp:{},mp=Object.entries(sp),gp=[];if(hp){const xp=Object.keys(dp);for(let _p=0;_p<xp.length;_p++)sp.hasOwnProperty(xp[_p])||mp.unshift([xp[_p],DEFAULT+"remove"])}mp.forEach(([xp,_p])=>{var vp;if((vp=rp.__r3f)!=null&&vp.primitive&&xp==="object"||is.equ(_p,dp[xp]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(xp))return gp.push([xp,_p,!0,[]]);let bp=[];xp.includes("-")&&(bp=xp.split("-")),gp.push([xp,_p,!1,bp]);for(const Ep in sp){const Sp=sp[Ep];Ep.startsWith(`${xp}-`)&&gp.push([Ep,Sp,!1,Ep.split("-")])}});const yp={...sp};return pp.memoizedProps&&pp.memoizedProps.args&&(yp.args=pp.memoizedProps.args),pp.memoizedProps&&pp.memoizedProps.attach&&(yp.attach=pp.memoizedProps.attach),{memoized:yp,changes:gp}}const __DEV__=typeof process<"u"&&!1;function applyProps$1(rp,_d){var np,ap,sp;const lp=(np=rp.__r3f)!=null?np:{},up=lp.root,cp=(ap=up==null||up.getState==null?void 0:up.getState())!=null?ap:{},{memoized:dp,changes:hp}=isDiffSet(_d)?_d:diffProps(rp,_d),fp=lp.eventCount;rp.__r3f&&(rp.__r3f.memoizedProps=dp);for(let mp=0;mp<hp.length;mp++){let[gp,yp,xp,_p]=hp[mp];if(hasColorSpace(rp)){const Sp="srgb",Ap="srgb-linear";gp==="encoding"?(gp="colorSpace",yp=yp===3001?Sp:Ap):gp==="outputEncoding"&&(gp="outputColorSpace",yp=yp===3001?Sp:Ap)}let vp=rp,bp=vp[gp];if(_p.length&&(bp=_p.reduce((Ep,Sp)=>Ep[Sp],rp),!(bp&&bp.set))){const[Ep,...Sp]=_p.reverse();vp=Sp.reverse().reduce((Ap,Rp)=>Ap[Rp],rp),gp=Ep}if(yp===DEFAULT+"remove")if(vp.constructor){let Ep=DEFAULTS.get(vp.constructor);Ep||(Ep=new vp.constructor,DEFAULTS.set(vp.constructor,Ep)),yp=Ep[gp]}else yp=0;if(xp)yp?lp.handlers[gp]=yp:delete lp.handlers[gp],lp.eventCount=Object.keys(lp.handlers).length;else if(bp&&bp.set&&(bp.copy||bp instanceof Layers)){if(Array.isArray(yp))bp.fromArray?bp.fromArray(yp):bp.set(...yp);else if(bp.copy&&yp&&yp.constructor&&(__DEV__?bp.constructor.name===yp.constructor.name:bp.constructor===yp.constructor))bp.copy(yp);else if(yp!==void 0){const Ep=bp instanceof Color;!Ep&&bp.setScalar?bp.setScalar(yp):bp instanceof Layers&&yp instanceof Layers?bp.mask=yp.mask:bp.set(yp),!getColorManagement()&&!cp.linear&&Ep&&bp.convertSRGBToLinear()}}else if(vp[gp]=yp,vp[gp]instanceof Texture&&vp[gp].format===RGBAFormat&&vp[gp].type===UnsignedByteType){const Ep=vp[gp];hasColorSpace(Ep)&&hasColorSpace(cp.gl)?Ep.colorSpace=cp.gl.outputColorSpace:Ep.encoding=cp.gl.outputEncoding}invalidateInstance(rp)}if(lp.parent&&rp.raycast&&fp!==lp.eventCount){const mp=findInitialRoot(rp).getState().internal,gp=mp.interaction.indexOf(rp);gp>-1&&mp.interaction.splice(gp,1),lp.eventCount&&mp.interaction.push(rp)}return!(hp.length===1&&hp[0][0]==="onUpdate")&&hp.length&&(sp=rp.__r3f)!=null&&sp.parent&&updateInstance(rp),rp}function invalidateInstance(rp){var _d,np;const ap=(_d=rp.__r3f)==null||(np=_d.root)==null||np.getState==null?void 0:np.getState();ap&&ap.internal.frames===0&&ap.invalidate()}function updateInstance(rp){rp.onUpdate==null||rp.onUpdate(rp)}function updateCamera(rp,_d){rp.manual||(isOrthographicCamera(rp)?(rp.left=_d.width/-2,rp.right=_d.width/2,rp.top=_d.height/2,rp.bottom=_d.height/-2):rp.aspect=_d.width/_d.height,rp.updateProjectionMatrix(),rp.updateMatrixWorld())}function makeId(rp){return(rp.eventObject||rp.object).uuid+"/"+rp.index+rp.instanceId}function getEventPriority(){var rp;const _d=typeof self<"u"&&self||typeof window<"u"&&window;if(!_d)return constantsExports.DefaultEventPriority;switch((rp=_d.event)==null?void 0:rp.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return constantsExports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return constantsExports.ContinuousEventPriority;default:return constantsExports.DefaultEventPriority}}function releaseInternalPointerCapture(rp,_d,np,ap){const sp=np.get(_d);sp&&(np.delete(_d),np.size===0&&(rp.delete(ap),sp.target.releasePointerCapture(ap)))}function removeInteractivity(rp,_d){const{internal:np}=rp.getState();np.interaction=np.interaction.filter(ap=>ap!==_d),np.initialHits=np.initialHits.filter(ap=>ap!==_d),np.hovered.forEach((ap,sp)=>{(ap.eventObject===_d||ap.object===_d)&&np.hovered.delete(sp)}),np.capturedMap.forEach((ap,sp)=>{releaseInternalPointerCapture(np.capturedMap,_d,ap,sp)})}function createEvents(rp){function _d(dp){const{internal:hp}=rp.getState(),fp=dp.offsetX-hp.initialClick[0],pp=dp.offsetY-hp.initialClick[1];return Math.round(Math.sqrt(fp*fp+pp*pp))}function np(dp){return dp.filter(hp=>["Move","Over","Enter","Out","Leave"].some(fp=>{var pp;return(pp=hp.__r3f)==null?void 0:pp.handlers["onPointer"+fp]}))}function ap(dp,hp){const fp=rp.getState(),pp=new Set,mp=[],gp=hp?hp(fp.internal.interaction):fp.internal.interaction;for(let vp=0;vp<gp.length;vp++){const bp=getRootState(gp[vp]);bp&&(bp.raycaster.camera=void 0)}fp.previousRoot||fp.events.compute==null||fp.events.compute(dp,fp);function yp(vp){const bp=getRootState(vp);if(!bp||!bp.events.enabled||bp.raycaster.camera===null)return[];if(bp.raycaster.camera===void 0){var Ep;bp.events.compute==null||bp.events.compute(dp,bp,(Ep=bp.previousRoot)==null?void 0:Ep.getState()),bp.raycaster.camera===void 0&&(bp.raycaster.camera=null)}return bp.raycaster.camera?bp.raycaster.intersectObject(vp,!0):[]}let xp=gp.flatMap(yp).sort((vp,bp)=>{const Ep=getRootState(vp.object),Sp=getRootState(bp.object);return!Ep||!Sp?vp.distance-bp.distance:Sp.events.priority-Ep.events.priority||vp.distance-bp.distance}).filter(vp=>{const bp=makeId(vp);return pp.has(bp)?!1:(pp.add(bp),!0)});fp.events.filter&&(xp=fp.events.filter(xp,fp));for(const vp of xp){let bp=vp.object;for(;bp;){var _p;(_p=bp.__r3f)!=null&&_p.eventCount&&mp.push({...vp,eventObject:bp}),bp=bp.parent}}if("pointerId"in dp&&fp.internal.capturedMap.has(dp.pointerId))for(let vp of fp.internal.capturedMap.get(dp.pointerId).values())pp.has(makeId(vp.intersection))||mp.push(vp.intersection);return mp}function sp(dp,hp,fp,pp){const mp=rp.getState();if(dp.length){const gp={stopped:!1};for(const yp of dp){const xp=getRootState(yp.object)||mp,{raycaster:_p,pointer:vp,camera:bp,internal:Ep}=xp,Sp=new Vector3(vp.x,vp.y,0).unproject(bp),Ap=Pp=>{var $p,zp;return($p=(zp=Ep.capturedMap.get(Pp))==null?void 0:zp.has(yp.eventObject))!=null?$p:!1},Rp=Pp=>{const $p={intersection:yp,target:hp.target};Ep.capturedMap.has(Pp)?Ep.capturedMap.get(Pp).set(yp.eventObject,$p):Ep.capturedMap.set(Pp,new Map([[yp.eventObject,$p]])),hp.target.setPointerCapture(Pp)},Tp=Pp=>{const $p=Ep.capturedMap.get(Pp);$p&&releaseInternalPointerCapture(Ep.capturedMap,yp.eventObject,$p,Pp)};let Mp={};for(let Pp in hp){let $p=hp[Pp];typeof $p!="function"&&(Mp[Pp]=$p)}let Op={...yp,...Mp,pointer:vp,intersections:dp,stopped:gp.stopped,delta:fp,unprojectedPoint:Sp,ray:_p.ray,camera:bp,stopPropagation(){const Pp="pointerId"in hp&&Ep.capturedMap.get(hp.pointerId);if((!Pp||Pp.has(yp.eventObject))&&(Op.stopped=gp.stopped=!0,Ep.hovered.size&&Array.from(Ep.hovered.values()).find($p=>$p.eventObject===yp.eventObject))){const $p=dp.slice(0,dp.indexOf(yp));lp([...$p,yp])}},target:{hasPointerCapture:Ap,setPointerCapture:Rp,releasePointerCapture:Tp},currentTarget:{hasPointerCapture:Ap,setPointerCapture:Rp,releasePointerCapture:Tp},nativeEvent:hp};if(pp(Op),gp.stopped===!0)break}}return dp}function lp(dp){const{internal:hp}=rp.getState();for(const fp of hp.hovered.values())if(!dp.length||!dp.find(pp=>pp.object===fp.object&&pp.index===fp.index&&pp.instanceId===fp.instanceId)){const mp=fp.eventObject.__r3f,gp=mp==null?void 0:mp.handlers;if(hp.hovered.delete(makeId(fp)),mp!=null&&mp.eventCount){const yp={...fp,intersections:dp};gp.onPointerOut==null||gp.onPointerOut(yp),gp.onPointerLeave==null||gp.onPointerLeave(yp)}}}function up(dp,hp){for(let fp=0;fp<hp.length;fp++){const pp=hp[fp].__r3f;pp==null||pp.handlers.onPointerMissed==null||pp.handlers.onPointerMissed(dp)}}function cp(dp){switch(dp){case"onPointerLeave":case"onPointerCancel":return()=>lp([]);case"onLostPointerCapture":return hp=>{const{internal:fp}=rp.getState();"pointerId"in hp&&fp.capturedMap.has(hp.pointerId)&&requestAnimationFrame(()=>{fp.capturedMap.has(hp.pointerId)&&(fp.capturedMap.delete(hp.pointerId),lp([]))})}}return function(fp){const{onPointerMissed:pp,internal:mp}=rp.getState();mp.lastEvent.current=fp;const gp=dp==="onPointerMove",yp=dp==="onClick"||dp==="onContextMenu"||dp==="onDoubleClick",_p=ap(fp,gp?np:void 0),vp=yp?_d(fp):0;dp==="onPointerDown"&&(mp.initialClick=[fp.offsetX,fp.offsetY],mp.initialHits=_p.map(Ep=>Ep.eventObject)),yp&&!_p.length&&vp<=2&&(up(fp,mp.interaction),pp&&pp(fp)),gp&&lp(_p);function bp(Ep){const Sp=Ep.eventObject,Ap=Sp.__r3f,Rp=Ap==null?void 0:Ap.handlers;if(Ap!=null&&Ap.eventCount)if(gp){if(Rp.onPointerOver||Rp.onPointerEnter||Rp.onPointerOut||Rp.onPointerLeave){const Tp=makeId(Ep),Mp=mp.hovered.get(Tp);Mp?Mp.stopped&&Ep.stopPropagation():(mp.hovered.set(Tp,Ep),Rp.onPointerOver==null||Rp.onPointerOver(Ep),Rp.onPointerEnter==null||Rp.onPointerEnter(Ep))}Rp.onPointerMove==null||Rp.onPointerMove(Ep)}else{const Tp=Rp[dp];Tp?(!yp||mp.initialHits.includes(Sp))&&(up(fp,mp.interaction.filter(Mp=>!mp.initialHits.includes(Mp))),Tp(Ep)):yp&&mp.initialHits.includes(Sp)&&up(fp,mp.interaction.filter(Mp=>!mp.initialHits.includes(Mp)))}}sp(_p,fp,vp,bp)}}return{handlePointer:cp}}const isRenderer=rp=>!!(rp!=null&&rp.render),context=reactExports.createContext(null),createStore=(rp,_d)=>{const np=create$1((cp,dp)=>{const hp=new Vector3,fp=new Vector3,pp=new Vector3;function mp(vp=dp().camera,bp=fp,Ep=dp().size){const{width:Sp,height:Ap,top:Rp,left:Tp}=Ep,Mp=Sp/Ap;bp instanceof Vector3?pp.copy(bp):pp.set(...bp);const Op=vp.getWorldPosition(hp).distanceTo(pp);if(isOrthographicCamera(vp))return{width:Sp/vp.zoom,height:Ap/vp.zoom,top:Rp,left:Tp,factor:1,distance:Op,aspect:Mp};{const Pp=vp.fov*Math.PI/180,$p=2*Math.tan(Pp/2)*Op,zp=$p*(Sp/Ap);return{width:zp,height:$p,top:Rp,left:Tp,factor:Sp/zp,distance:Op,aspect:Mp}}}let gp;const yp=vp=>cp(bp=>({performance:{...bp.performance,current:vp}})),xp=new Vector2;return{set:cp,get:dp,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(vp=1)=>rp(dp(),vp),advance:(vp,bp)=>_d(vp,bp,dp()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Clock,pointer:xp,mouse:xp,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const vp=dp();gp&&clearTimeout(gp),vp.performance.current!==vp.performance.min&&yp(vp.performance.min),gp=setTimeout(()=>yp(dp().performance.max),vp.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:mp},setEvents:vp=>cp(bp=>({...bp,events:{...bp.events,...vp}})),setSize:(vp,bp,Ep,Sp,Ap)=>{const Rp=dp().camera,Tp={width:vp,height:bp,top:Sp||0,left:Ap||0,updateStyle:Ep};cp(Mp=>({size:Tp,viewport:{...Mp.viewport,...mp(Rp,fp,Tp)}}))},setDpr:vp=>cp(bp=>{const Ep=calculateDpr(vp);return{viewport:{...bp.viewport,dpr:Ep,initialDpr:bp.viewport.initialDpr||Ep}}}),setFrameloop:(vp="always")=>{const bp=dp().clock;bp.stop(),bp.elapsedTime=0,vp!=="never"&&(bp.start(),bp.elapsedTime=0),cp(()=>({frameloop:vp}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:reactExports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(vp,bp,Ep)=>{const Sp=dp().internal;return Sp.priority=Sp.priority+(bp>0?1:0),Sp.subscribers.push({ref:vp,priority:bp,store:Ep}),Sp.subscribers=Sp.subscribers.sort((Ap,Rp)=>Ap.priority-Rp.priority),()=>{const Ap=dp().internal;Ap!=null&&Ap.subscribers&&(Ap.priority=Ap.priority-(bp>0?1:0),Ap.subscribers=Ap.subscribers.filter(Rp=>Rp.ref!==vp))}}}}}),ap=np.getState();let sp=ap.size,lp=ap.viewport.dpr,up=ap.camera;return np.subscribe(()=>{const{camera:cp,size:dp,viewport:hp,gl:fp,set:pp}=np.getState();if(dp.width!==sp.width||dp.height!==sp.height||hp.dpr!==lp){var mp;sp=dp,lp=hp.dpr,updateCamera(cp,dp),fp.setPixelRatio(hp.dpr);const gp=(mp=dp.updateStyle)!=null?mp:typeof HTMLCanvasElement<"u"&&fp.domElement instanceof HTMLCanvasElement;fp.setSize(dp.width,dp.height,gp)}cp!==up&&(up=cp,pp(gp=>({viewport:{...gp.viewport,...gp.viewport.getCurrentViewport(cp)}})))}),np.subscribe(cp=>rp(cp)),np};let i,globalEffects=new Set,globalAfterEffects=new Set,globalTailEffects=new Set;function run(rp,_d){if(rp.size)for(const{callback:np}of rp.values())np(_d)}function flushGlobalEffects(rp,_d){switch(rp){case"before":return run(globalEffects,_d);case"after":return run(globalAfterEffects,_d);case"tail":return run(globalTailEffects,_d)}}let subscribers,subscription;function render$1(rp,_d,np){let ap=_d.clock.getDelta();for(_d.frameloop==="never"&&typeof rp=="number"&&(ap=rp-_d.clock.elapsedTime,_d.clock.oldTime=_d.clock.elapsedTime,_d.clock.elapsedTime=rp),subscribers=_d.internal.subscribers,i=0;i<subscribers.length;i++)subscription=subscribers[i],subscription.ref.current(subscription.store.getState(),ap,np);return!_d.internal.priority&&_d.gl.render&&_d.gl.render(_d.scene,_d.camera),_d.internal.frames=Math.max(0,_d.internal.frames-1),_d.frameloop==="always"?1:_d.internal.frames}function createLoop(rp){let _d=!1,np,ap,sp;function lp(dp){ap=requestAnimationFrame(lp),_d=!0,np=0,flushGlobalEffects("before",dp);for(const fp of rp.values()){var hp;sp=fp.store.getState(),sp.internal.active&&(sp.frameloop==="always"||sp.internal.frames>0)&&!((hp=sp.gl.xr)!=null&&hp.isPresenting)&&(np+=render$1(dp,sp))}if(flushGlobalEffects("after",dp),np===0)return flushGlobalEffects("tail",dp),_d=!1,cancelAnimationFrame(ap)}function up(dp,hp=1){var fp;if(!dp)return rp.forEach(pp=>up(pp.store.getState()),hp);(fp=dp.gl.xr)!=null&&fp.isPresenting||!dp.internal.active||dp.frameloop==="never"||(dp.internal.frames=Math.min(60,dp.internal.frames+hp),_d||(_d=!0,requestAnimationFrame(lp)))}function cp(dp,hp=!0,fp,pp){if(hp&&flushGlobalEffects("before",dp),fp)render$1(dp,fp,pp);else for(const mp of rp.values())render$1(dp,mp.store.getState());hp&&flushGlobalEffects("after",dp)}return{loop:lp,invalidate:up,advance:cp}}function useInstanceHandle(rp){const _d=reactExports.useRef(null);return useIsomorphicLayoutEffect(()=>void(_d.current=rp.current.__r3f),[rp]),_d}function useStore(){const rp=reactExports.useContext(context);if(!rp)throw new Error("R3F: Hooks can only be used within the Canvas component!");return rp}function useThree(rp=np=>np,_d){return useStore()(rp,_d)}function useFrame(rp,_d=0){const np=useStore(),ap=np.getState().internal.subscribe,sp=useMutableCallback(rp);return useIsomorphicLayoutEffect(()=>ap(sp,_d,np),[_d,ap,np]),null}const memoizedLoaders=new WeakMap;function loadingFn(rp,_d){return function(np,...ap){let sp=memoizedLoaders.get(np);return sp||(sp=new np,memoizedLoaders.set(np,sp)),rp&&rp(sp),Promise.all(ap.map(lp=>new Promise((up,cp)=>sp.load(lp,dp=>{dp.scene&&Object.assign(dp,buildGraph(dp.scene)),up(dp)},_d,dp=>cp(new Error(`Could not load ${lp}: ${dp==null?void 0:dp.message}`)))))).finally(()=>sp.dispose==null?void 0:sp.dispose())}}function useLoader(rp,_d,np,ap){const sp=Array.isArray(_d)?_d:[_d],lp=suspend(loadingFn(np,ap),[rp,...sp],{equal:is.equ});return Array.isArray(_d)?lp:lp[0]}useLoader.preload=function(rp,_d,np){const ap=Array.isArray(_d)?_d:[_d];return preload(loadingFn(np),[rp,...ap])};useLoader.clear=function(rp,_d){const np=Array.isArray(_d)?_d:[_d];return clear([rp,...np])};const roots=new Map,{invalidate,advance}=createLoop(roots),{reconciler,applyProps}=createRenderer(roots,getEventPriority),shallowLoose={objects:"shallow",strict:!1},createRendererInstance=(rp,_d)=>{const np=typeof rp=="function"?rp(_d):rp;return isRenderer(np)?np:new WebGLRenderer({powerPreference:"high-performance",canvas:_d,antialias:!0,alpha:!0,...rp})};function computeInitialSize(rp,_d){const np=typeof HTMLCanvasElement<"u"&&rp instanceof HTMLCanvasElement;if(_d){const{width:ap,height:sp,top:lp,left:up,updateStyle:cp=np}=_d;return{width:ap,height:sp,top:lp,left:up,updateStyle:cp}}else if(typeof HTMLCanvasElement<"u"&&rp instanceof HTMLCanvasElement&&rp.parentElement){const{width:ap,height:sp,top:lp,left:up}=rp.parentElement.getBoundingClientRect();return{width:ap,height:sp,top:lp,left:up,updateStyle:np}}else if(typeof OffscreenCanvas<"u"&&rp instanceof OffscreenCanvas)return{width:rp.width,height:rp.height,top:0,left:0,updateStyle:np};return{width:0,height:0,top:0,left:0}}function createRoot(rp){const _d=roots.get(rp),np=_d==null?void 0:_d.fiber,ap=_d==null?void 0:_d.store;_d&&console.warn("R3F.createRoot should only be called once!");const sp=typeof reportError=="function"?reportError:console.error,lp=ap||createStore(invalidate,advance),up=np||reconciler.createContainer(lp,constantsExports.ConcurrentRoot,null,!1,null,"",sp,null);_d||roots.set(rp,{fiber:up,store:lp});let cp,dp=!1,hp;return{configure(fp={}){let{gl:pp,size:mp,scene:gp,events:yp,onCreated:xp,shadows:_p=!1,linear:vp=!1,flat:bp=!1,legacy:Ep=!1,orthographic:Sp=!1,frameloop:Ap="always",dpr:Rp=[1,2],performance:Tp,raycaster:Mp,camera:Op,onPointerMissed:Pp}=fp,$p=lp.getState(),zp=$p.gl;$p.gl||$p.set({gl:zp=createRendererInstance(pp,rp)});let Dp=$p.raycaster;Dp||$p.set({raycaster:Dp=new Raycaster});const{params:Fp,...jp}=Mp||{};if(is.equ(jp,Dp,shallowLoose)||applyProps(Dp,{...jp}),is.equ(Fp,Dp.params,shallowLoose)||applyProps(Dp,{params:{...Dp.params,...Fp}}),!$p.camera||$p.camera===hp&&!is.equ(hp,Op,shallowLoose)){hp=Op;const Wp=Op instanceof Camera,Qp=Wp?Op:Sp?new OrthographicCamera(0,0,0,0,.1,1e3):new PerspectiveCamera$1(75,0,.1,1e3);Wp||(Qp.position.z=5,Op&&applyProps(Qp,Op),!$p.camera&&!(Op!=null&&Op.rotation)&&Qp.lookAt(0,0,0)),$p.set({camera:Qp}),Dp.camera=Qp}if(!$p.scene){let Wp;gp instanceof Scene?Wp=gp:(Wp=new Scene,gp&&applyProps(Wp,gp)),$p.set({scene:prepare(Wp)})}if(!$p.xr){var Lp;const Wp=(rm,Kp)=>{const lm=lp.getState();lm.frameloop!=="never"&&advance(rm,!0,lm,Kp)},Qp=()=>{const rm=lp.getState();rm.gl.xr.enabled=rm.gl.xr.isPresenting,rm.gl.xr.setAnimationLoop(rm.gl.xr.isPresenting?Wp:null),rm.gl.xr.isPresenting||invalidate(rm)},Xp={connect(){const rm=lp.getState().gl;rm.xr.addEventListener("sessionstart",Qp),rm.xr.addEventListener("sessionend",Qp)},disconnect(){const rm=lp.getState().gl;rm.xr.removeEventListener("sessionstart",Qp),rm.xr.removeEventListener("sessionend",Qp)}};typeof((Lp=zp.xr)==null?void 0:Lp.addEventListener)=="function"&&Xp.connect(),$p.set({xr:Xp})}if(zp.shadowMap){const Wp=zp.shadowMap.enabled,Qp=zp.shadowMap.type;if(zp.shadowMap.enabled=!!_p,is.boo(_p))zp.shadowMap.type=PCFSoftShadowMap;else if(is.str(_p)){var Bp;const Xp={basic:BasicShadowMap,percentage:PCFShadowMap,soft:PCFSoftShadowMap,variance:VSMShadowMap};zp.shadowMap.type=(Bp=Xp[_p])!=null?Bp:PCFSoftShadowMap}else is.obj(_p)&&Object.assign(zp.shadowMap,_p);(Wp!==zp.shadowMap.enabled||Qp!==zp.shadowMap.type)&&(zp.shadowMap.needsUpdate=!0)}const Ip=getColorManagement();Ip&&("enabled"in Ip?Ip.enabled=!Ep:"legacyMode"in Ip&&(Ip.legacyMode=Ep)),applyProps(zp,{outputEncoding:vp?3e3:3001,toneMapping:bp?NoToneMapping:ACESFilmicToneMapping}),$p.legacy!==Ep&&$p.set(()=>({legacy:Ep})),$p.linear!==vp&&$p.set(()=>({linear:vp})),$p.flat!==bp&&$p.set(()=>({flat:bp})),pp&&!is.fun(pp)&&!isRenderer(pp)&&!is.equ(pp,zp,shallowLoose)&&applyProps(zp,pp),yp&&!$p.events.handlers&&$p.set({events:yp(lp)});const Gp=computeInitialSize(rp,mp);return is.equ(Gp,$p.size,shallowLoose)||$p.setSize(Gp.width,Gp.height,Gp.updateStyle,Gp.top,Gp.left),Rp&&$p.viewport.dpr!==calculateDpr(Rp)&&$p.setDpr(Rp),$p.frameloop!==Ap&&$p.setFrameloop(Ap),$p.onPointerMissed||$p.set({onPointerMissed:Pp}),Tp&&!is.equ(Tp,$p.performance,shallowLoose)&&$p.set(Wp=>({performance:{...Wp.performance,...Tp}})),cp=xp,dp=!0,this},render(fp){return dp||this.configure(),reconciler.updateContainer(reactExports.createElement(Provider,{store:lp,children:fp,onCreated:cp,rootElement:rp}),up,null,()=>{}),lp},unmount(){unmountComponentAtNode(rp)}}}function Provider({store:rp,children:_d,onCreated:np,rootElement:ap}){return useIsomorphicLayoutEffect(()=>{const sp=rp.getState();sp.set(lp=>({internal:{...lp.internal,active:!0}})),np&&np(sp),rp.getState().events.connected||sp.events.connect==null||sp.events.connect(ap)},[]),reactExports.createElement(context.Provider,{value:rp},_d)}function unmountComponentAtNode(rp,_d){const np=roots.get(rp),ap=np==null?void 0:np.fiber;if(ap){const sp=np==null?void 0:np.store.getState();sp&&(sp.internal.active=!1),reconciler.updateContainer(null,ap,null,()=>{sp&&setTimeout(()=>{try{var lp,up,cp,dp;sp.events.disconnect==null||sp.events.disconnect(),(lp=sp.gl)==null||(up=lp.renderLists)==null||up.dispose==null||up.dispose(),(cp=sp.gl)==null||cp.forceContextLoss==null||cp.forceContextLoss(),(dp=sp.gl)!=null&&dp.xr&&sp.xr.disconnect(),dispose(sp),roots.delete(rp),_d&&_d(rp)}catch{}},500)})}}reconciler.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:reactExports.version});function debounce(rp,_d,np){var ap,sp,lp,up,cp;_d==null&&(_d=100);function dp(){var fp=Date.now()-up;fp<_d&&fp>=0?ap=setTimeout(dp,_d-fp):(ap=null,np||(cp=rp.apply(lp,sp),lp=sp=null))}var hp=function(){lp=this,sp=arguments,up=Date.now();var fp=np&&!ap;return ap||(ap=setTimeout(dp,_d)),fp&&(cp=rp.apply(lp,sp),lp=sp=null),cp};return hp.clear=function(){ap&&(clearTimeout(ap),ap=null)},hp.flush=function(){ap&&(cp=rp.apply(lp,sp),lp=sp=null,clearTimeout(ap),ap=null)},hp}debounce.debounce=debounce;var debounce_1=debounce;const createDebounce=getDefaultExportFromCjs(debounce_1);function useMeasure(rp){let{debounce:_d,scroll:np,polyfill:ap,offsetSize:sp}=rp===void 0?{debounce:0,scroll:!1,offsetSize:!1}:rp;const lp=ap||(typeof window>"u"?class{}:window.ResizeObserver);if(!lp)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[up,cp]=reactExports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),dp=reactExports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:up}),hp=_d?typeof _d=="number"?_d:_d.scroll:null,fp=_d?typeof _d=="number"?_d:_d.resize:null,pp=reactExports.useRef(!1);reactExports.useEffect(()=>(pp.current=!0,()=>void(pp.current=!1)));const[mp,gp,yp]=reactExports.useMemo(()=>{const bp=()=>{if(!dp.current.element)return;const{left:Ep,top:Sp,width:Ap,height:Rp,bottom:Tp,right:Mp,x:Op,y:Pp}=dp.current.element.getBoundingClientRect(),$p={left:Ep,top:Sp,width:Ap,height:Rp,bottom:Tp,right:Mp,x:Op,y:Pp};dp.current.element instanceof HTMLElement&&sp&&($p.height=dp.current.element.offsetHeight,$p.width=dp.current.element.offsetWidth),Object.freeze($p),pp.current&&!areBoundsEqual(dp.current.lastBounds,$p)&&cp(dp.current.lastBounds=$p)};return[bp,fp?createDebounce(bp,fp):bp,hp?createDebounce(bp,hp):bp]},[cp,sp,hp,fp]);function xp(){dp.current.scrollContainers&&(dp.current.scrollContainers.forEach(bp=>bp.removeEventListener("scroll",yp,!0)),dp.current.scrollContainers=null),dp.current.resizeObserver&&(dp.current.resizeObserver.disconnect(),dp.current.resizeObserver=null)}function _p(){dp.current.element&&(dp.current.resizeObserver=new lp(yp),dp.current.resizeObserver.observe(dp.current.element),np&&dp.current.scrollContainers&&dp.current.scrollContainers.forEach(bp=>bp.addEventListener("scroll",yp,{capture:!0,passive:!0})))}const vp=bp=>{!bp||bp===dp.current.element||(xp(),dp.current.element=bp,dp.current.scrollContainers=findScrollContainers(bp),_p())};return useOnWindowScroll(yp,!!np),useOnWindowResize(gp),reactExports.useEffect(()=>{xp(),_p()},[np,yp,gp]),reactExports.useEffect(()=>xp,[]),[vp,up,mp]}function useOnWindowResize(rp){reactExports.useEffect(()=>{const _d=rp;return window.addEventListener("resize",_d),()=>void window.removeEventListener("resize",_d)},[rp])}function useOnWindowScroll(rp,_d){reactExports.useEffect(()=>{if(_d){const np=rp;return window.addEventListener("scroll",np,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",np,!0)}},[rp,_d])}function findScrollContainers(rp){const _d=[];if(!rp||rp===document.body)return _d;const{overflow:np,overflowX:ap,overflowY:sp}=window.getComputedStyle(rp);return[np,ap,sp].some(lp=>lp==="auto"||lp==="scroll")&&_d.push(rp),[..._d,...findScrollContainers(rp.parentElement)]}const keys=["x","y","top","bottom","left","right","width","height"],areBoundsEqual=(rp,_d)=>keys.every(np=>rp[np]===_d[np]);var __defProp$1=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp$1=(rp,_d,np)=>_d in rp?__defProp$1(rp,_d,{enumerable:!0,configurable:!0,writable:!0,value:np}):rp[_d]=np,__spreadValues=(rp,_d)=>{for(var np in _d||(_d={}))__hasOwnProp.call(_d,np)&&__defNormalProp$1(rp,np,_d[np]);if(__getOwnPropSymbols)for(var np of __getOwnPropSymbols(_d))__propIsEnum.call(_d,np)&&__defNormalProp$1(rp,np,_d[np]);return rp},__spreadProps=(rp,_d)=>__defProps(rp,__getOwnPropDescs(_d));function traverseFiber(rp,_d,np){if(!rp)return;if(np(rp)===!0)return rp;let ap=_d?rp.return:rp.child;for(;ap;){const sp=traverseFiber(ap,_d,np);if(sp)return sp;ap=_d?null:ap.sibling}}function wrapContext(rp){try{return Object.defineProperties(rp,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return rp}}const FiberContext=wrapContext(reactExports.createContext(null));class FiberProvider extends reactExports.Component{render(){return reactExports.createElement(FiberContext.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner,ReactCurrentDispatcher}=reactExports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function useFiber(){const rp=reactExports.useContext(FiberContext);if(rp===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const _d=reactExports.useId();return reactExports.useMemo(()=>{for(const ap of[ReactCurrentOwner==null?void 0:ReactCurrentOwner.current,rp,rp==null?void 0:rp.alternate]){if(!ap)continue;const sp=traverseFiber(ap,!1,lp=>{let up=lp.memoizedState;for(;up;){if(up.memoizedState===_d)return!0;up=up.next}});if(sp)return sp}},[rp,_d])}function useContextMap(){var rp,_d;const np=useFiber(),[ap]=reactExports.useState(()=>new Map);ap.clear();let sp=np;for(;sp;){const lp=(rp=sp.type)==null?void 0:rp._context;lp&&lp!==FiberContext&&!ap.has(lp)&&ap.set(lp,(_d=ReactCurrentDispatcher==null?void 0:ReactCurrentDispatcher.current)==null?void 0:_d.readContext(wrapContext(lp))),sp=sp.return}return ap}function useContextBridge(){const rp=useContextMap();return reactExports.useMemo(()=>Array.from(rp.keys()).reduce((_d,np)=>ap=>reactExports.createElement(_d,null,reactExports.createElement(np.Provider,__spreadProps(__spreadValues({},ap),{value:rp.get(np)}))),_d=>reactExports.createElement(FiberProvider,__spreadValues({},_d))),[rp])}const DOM_EVENTS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function createPointerEvents(rp){const{handlePointer:_d}=createEvents(rp);return{priority:1,enabled:!0,compute(np,ap,sp){ap.pointer.set(np.offsetX/ap.size.width*2-1,-(np.offsetY/ap.size.height)*2+1),ap.raycaster.setFromCamera(ap.pointer,ap.camera)},connected:void 0,handlers:Object.keys(DOM_EVENTS).reduce((np,ap)=>({...np,[ap]:_d(ap)}),{}),update:()=>{var np;const{events:ap,internal:sp}=rp.getState();(np=sp.lastEvent)!=null&&np.current&&ap.handlers&&ap.handlers.onPointerMove(sp.lastEvent.current)},connect:np=>{var ap;const{set:sp,events:lp}=rp.getState();lp.disconnect==null||lp.disconnect(),sp(up=>({events:{...up.events,connected:np}})),Object.entries((ap=lp.handlers)!=null?ap:[]).forEach(([up,cp])=>{const[dp,hp]=DOM_EVENTS[up];np.addEventListener(dp,cp,{passive:hp})})},disconnect:()=>{const{set:np,events:ap}=rp.getState();if(ap.connected){var sp;Object.entries((sp=ap.handlers)!=null?sp:[]).forEach(([lp,up])=>{if(ap&&ap.connected instanceof HTMLElement){const[cp]=DOM_EVENTS[lp];ap.connected.removeEventListener(cp,up)}}),np(lp=>({events:{...lp.events,connected:void 0}}))}}}}const CanvasImpl=reactExports.forwardRef(function rp({children:_d,fallback:np,resize:ap,style:sp,gl:lp,events:up=createPointerEvents,eventSource:cp,eventPrefix:dp,shadows:hp,linear:fp,flat:pp,legacy:mp,orthographic:gp,frameloop:yp,dpr:xp,performance:_p,raycaster:vp,camera:bp,scene:Ep,onPointerMissed:Sp,onCreated:Ap,...Rp},Tp){reactExports.useMemo(()=>extend(THREE),[]);const Mp=useContextBridge(),[Op,Pp]=useMeasure({scroll:!0,debounce:{scroll:50,resize:0},...ap}),$p=reactExports.useRef(null),zp=reactExports.useRef(null);reactExports.useImperativeHandle(Tp,()=>$p.current);const Dp=useMutableCallback(Sp),[Fp,jp]=reactExports.useState(!1),[Lp,Bp]=reactExports.useState(!1);if(Fp)throw Fp;if(Lp)throw Lp;const Ip=reactExports.useRef(null);useIsomorphicLayoutEffect(()=>{const Up=$p.current;Pp.width>0&&Pp.height>0&&Up&&(Ip.current||(Ip.current=createRoot(Up)),Ip.current.configure({gl:lp,events:up,shadows:hp,linear:fp,flat:pp,legacy:mp,orthographic:gp,frameloop:yp,dpr:xp,performance:_p,raycaster:vp,camera:bp,scene:Ep,size:Pp,onPointerMissed:(...Gp)=>Dp.current==null?void 0:Dp.current(...Gp),onCreated:Gp=>{Gp.events.connect==null||Gp.events.connect(cp?isRef(cp)?cp.current:cp:zp.current),dp&&Gp.setEvents({compute:(Wp,Qp)=>{const Xp=Wp[dp+"X"],rm=Wp[dp+"Y"];Qp.pointer.set(Xp/Qp.size.width*2-1,-(rm/Qp.size.height)*2+1),Qp.raycaster.setFromCamera(Qp.pointer,Qp.camera)}}),Ap==null||Ap(Gp)}}),Ip.current.render(reactExports.createElement(Mp,null,reactExports.createElement(ErrorBoundary,{set:Bp},reactExports.createElement(reactExports.Suspense,{fallback:reactExports.createElement(Block,{set:jp})},_d)))))}),reactExports.useEffect(()=>{const Up=$p.current;if(Up)return()=>unmountComponentAtNode(Up)},[]);const kp=cp?"none":"auto";return reactExports.createElement("div",_extends$1({ref:zp,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:kp,...sp}},Rp),reactExports.createElement("div",{ref:Op,style:{width:"100%",height:"100%"}},reactExports.createElement("canvas",{ref:$p,style:{display:"block"}},np)))}),Canvas=reactExports.forwardRef(function rp(_d,np){return reactExports.createElement(FiberProvider,null,reactExports.createElement(CanvasImpl,_extends$1({},_d,{ref:np})))});function mergeRefs(rp){return function(_d){rp.forEach(function(np){typeof np=="function"?np(_d):np!=null&&(np.current=_d)})}}let webGL2Available;function isWebGL2Available(){var rp;if(webGL2Available!==void 0)return webGL2Available;try{let _d;const np=document.createElement("canvas");return webGL2Available=!!(window.WebGL2RenderingContext&&(_d=np.getContext("webgl2"))),_d&&((rp=_d.getExtension("WEBGL_lose_context"))==null||rp.loseContext()),webGL2Available}catch{return webGL2Available=!1}}function toTrianglesDrawMode(rp,_d){if(_d===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),rp;if(_d===TriangleFanDrawMode||_d===TriangleStripDrawMode){let np=rp.getIndex();if(np===null){const up=[],cp=rp.getAttribute("position");if(cp!==void 0){for(let dp=0;dp<cp.count;dp++)up.push(dp);rp.setIndex(up),np=rp.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),rp}const ap=np.count-2,sp=[];if(np)if(_d===TriangleFanDrawMode)for(let up=1;up<=ap;up++)sp.push(np.getX(0)),sp.push(np.getX(up)),sp.push(np.getX(up+1));else for(let up=0;up<ap;up++)up%2===0?(sp.push(np.getX(up)),sp.push(np.getX(up+1)),sp.push(np.getX(up+2))):(sp.push(np.getX(up+2)),sp.push(np.getX(up+1)),sp.push(np.getX(up)));sp.length/3!==ap&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const lp=rp.clone();return lp.setIndex(sp),lp.clearGroups(),lp}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_d),rp}const version=parseInt(REVISION.replace(/\D+/g,""));var __defProp=Object.defineProperty,__defNormalProp=(rp,_d,np)=>_d in rp?__defProp(rp,_d,{enumerable:!0,configurable:!0,writable:!0,value:np}):rp[_d]=np,__publicField=(rp,_d,np)=>(__defNormalProp(rp,typeof _d!="symbol"?_d+"":_d,np),np);const _ray=new Ray,_plane=new Plane,TILT_LIMIT=Math.cos(70*(Math.PI/180)),moduloWrapAround=(rp,_d)=>(rp%_d+_d)%_d;let OrbitControls$1=class extends EventDispatcher{constructor(_d,np){super(),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"enabled",!0),__publicField(this,"target",new Vector3),__publicField(this,"minDistance",0),__publicField(this,"maxDistance",1/0),__publicField(this,"minZoom",0),__publicField(this,"maxZoom",1/0),__publicField(this,"minPolarAngle",0),__publicField(this,"maxPolarAngle",Math.PI),__publicField(this,"minAzimuthAngle",-1/0),__publicField(this,"maxAzimuthAngle",1/0),__publicField(this,"enableDamping",!1),__publicField(this,"dampingFactor",.05),__publicField(this,"enableZoom",!0),__publicField(this,"zoomSpeed",1),__publicField(this,"enableRotate",!0),__publicField(this,"rotateSpeed",1),__publicField(this,"enablePan",!0),__publicField(this,"panSpeed",1),__publicField(this,"screenSpacePanning",!0),__publicField(this,"keyPanSpeed",7),__publicField(this,"zoomToCursor",!1),__publicField(this,"autoRotate",!1),__publicField(this,"autoRotateSpeed",2),__publicField(this,"reverseOrbit",!1),__publicField(this,"reverseHorizontalOrbit",!1),__publicField(this,"reverseVerticalOrbit",!1),__publicField(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),__publicField(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),__publicField(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),__publicField(this,"target0"),__publicField(this,"position0"),__publicField(this,"zoom0"),__publicField(this,"_domElementKeyEvents",null),__publicField(this,"getPolarAngle"),__publicField(this,"getAzimuthalAngle"),__publicField(this,"setPolarAngle"),__publicField(this,"setAzimuthalAngle"),__publicField(this,"getDistance"),__publicField(this,"listenToKeyEvents"),__publicField(this,"stopListenToKeyEvents"),__publicField(this,"saveState"),__publicField(this,"reset"),__publicField(this,"update"),__publicField(this,"connect"),__publicField(this,"dispose"),this.object=_d,this.domElement=np,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>fp.phi,this.getAzimuthalAngle=()=>fp.theta,this.setPolarAngle=Yp=>{let hm=moduloWrapAround(Yp,2*Math.PI),wm=fp.phi;wm<0&&(wm+=2*Math.PI),hm<0&&(hm+=2*Math.PI);let Cm=Math.abs(hm-wm);2*Math.PI-Cm<Cm&&(hm<wm?hm+=2*Math.PI:wm+=2*Math.PI),pp.phi=hm-wm,ap.update()},this.setAzimuthalAngle=Yp=>{let hm=moduloWrapAround(Yp,2*Math.PI),wm=fp.theta;wm<0&&(wm+=2*Math.PI),hm<0&&(hm+=2*Math.PI);let Cm=Math.abs(hm-wm);2*Math.PI-Cm<Cm&&(hm<wm?hm+=2*Math.PI:wm+=2*Math.PI),pp.theta=hm-wm,ap.update()},this.getDistance=()=>ap.object.position.distanceTo(ap.target),this.listenToKeyEvents=Yp=>{Yp.addEventListener("keydown",Dm),this._domElementKeyEvents=Yp},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Dm),this._domElementKeyEvents=null},this.saveState=()=>{ap.target0.copy(ap.target),ap.position0.copy(ap.object.position),ap.zoom0=ap.object.zoom},this.reset=()=>{ap.target.copy(ap.target0),ap.object.position.copy(ap.position0),ap.object.zoom=ap.zoom0,ap.object.updateProjectionMatrix(),ap.dispatchEvent(sp),ap.update(),dp=cp.NONE},this.update=(()=>{const Yp=new Vector3,hm=new Vector3(0,1,0),wm=new Quaternion().setFromUnitVectors(_d.up,hm),Cm=wm.clone().invert(),Vm=new Vector3,im=new Quaternion,Am=2*Math.PI;return function(){const Um=ap.object.position;wm.setFromUnitVectors(_d.up,hm),Cm.copy(wm).invert(),Yp.copy(Um).sub(ap.target),Yp.applyQuaternion(wm),fp.setFromVector3(Yp),ap.autoRotate&&dp===cp.NONE&&Fp(zp()),ap.enableDamping?(fp.theta+=pp.theta*ap.dampingFactor,fp.phi+=pp.phi*ap.dampingFactor):(fp.theta+=pp.theta,fp.phi+=pp.phi);let Gm=ap.minAzimuthAngle,ev=ap.maxAzimuthAngle;isFinite(Gm)&&isFinite(ev)&&(Gm<-Math.PI?Gm+=Am:Gm>Math.PI&&(Gm-=Am),ev<-Math.PI?ev+=Am:ev>Math.PI&&(ev-=Am),Gm<=ev?fp.theta=Math.max(Gm,Math.min(ev,fp.theta)):fp.theta=fp.theta>(Gm+ev)/2?Math.max(Gm,fp.theta):Math.min(ev,fp.theta)),fp.phi=Math.max(ap.minPolarAngle,Math.min(ap.maxPolarAngle,fp.phi)),fp.makeSafe(),ap.enableDamping===!0?ap.target.addScaledVector(gp,ap.dampingFactor):ap.target.add(gp),ap.zoomToCursor&&Op||ap.object.isOrthographicCamera?fp.radius=Wp(fp.radius):fp.radius=Wp(fp.radius*mp),Yp.setFromSpherical(fp),Yp.applyQuaternion(Cm),Um.copy(ap.target).add(Yp),ap.object.matrixAutoUpdate||ap.object.updateMatrix(),ap.object.lookAt(ap.target),ap.enableDamping===!0?(pp.theta*=1-ap.dampingFactor,pp.phi*=1-ap.dampingFactor,gp.multiplyScalar(1-ap.dampingFactor)):(pp.set(0,0,0),gp.set(0,0,0));let nv=!1;if(ap.zoomToCursor&&Op){let gv=null;if(ap.object instanceof PerspectiveCamera$1&&ap.object.isPerspectiveCamera){const xv=Yp.length();gv=Wp(xv*mp);const pv=xv-gv;ap.object.position.addScaledVector(Tp,pv),ap.object.updateMatrixWorld()}else if(ap.object.isOrthographicCamera){const xv=new Vector3(Mp.x,Mp.y,0);xv.unproject(ap.object),ap.object.zoom=Math.max(ap.minZoom,Math.min(ap.maxZoom,ap.object.zoom/mp)),ap.object.updateProjectionMatrix(),nv=!0;const pv=new Vector3(Mp.x,Mp.y,0);pv.unproject(ap.object),ap.object.position.sub(pv).add(xv),ap.object.updateMatrixWorld(),gv=Yp.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),ap.zoomToCursor=!1;gv!==null&&(ap.screenSpacePanning?ap.target.set(0,0,-1).transformDirection(ap.object.matrix).multiplyScalar(gv).add(ap.object.position):(_ray.origin.copy(ap.object.position),_ray.direction.set(0,0,-1).transformDirection(ap.object.matrix),Math.abs(ap.object.up.dot(_ray.direction))<TILT_LIMIT?_d.lookAt(ap.target):(_plane.setFromNormalAndCoplanarPoint(ap.object.up,ap.target),_ray.intersectPlane(_plane,ap.target))))}else ap.object instanceof OrthographicCamera&&ap.object.isOrthographicCamera&&(nv=mp!==1,nv&&(ap.object.zoom=Math.max(ap.minZoom,Math.min(ap.maxZoom,ap.object.zoom/mp)),ap.object.updateProjectionMatrix()));return mp=1,Op=!1,nv||Vm.distanceToSquared(ap.object.position)>hp||8*(1-im.dot(ap.object.quaternion))>hp?(ap.dispatchEvent(sp),Vm.copy(ap.object.position),im.copy(ap.object.quaternion),nv=!1,!0):!1}})(),this.connect=Yp=>{Yp===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),ap.domElement=Yp,ap.domElement.style.touchAction="none",ap.domElement.addEventListener("contextmenu",av),ap.domElement.addEventListener("pointerdown",pm),ap.domElement.addEventListener("pointercancel",Em),ap.domElement.addEventListener("wheel",Im)},this.dispose=()=>{var Yp,hm,wm,Cm,Vm,im;(Yp=ap.domElement)==null||Yp.removeEventListener("contextmenu",av),(hm=ap.domElement)==null||hm.removeEventListener("pointerdown",pm),(wm=ap.domElement)==null||wm.removeEventListener("pointercancel",Em),(Cm=ap.domElement)==null||Cm.removeEventListener("wheel",Im),(Vm=ap.domElement)==null||Vm.ownerDocument.removeEventListener("pointermove",km),(im=ap.domElement)==null||im.ownerDocument.removeEventListener("pointerup",ym),ap._domElementKeyEvents!==null&&ap._domElementKeyEvents.removeEventListener("keydown",Dm)};const ap=this,sp={type:"change"},lp={type:"start"},up={type:"end"},cp={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let dp=cp.NONE;const hp=1e-6,fp=new Spherical,pp=new Spherical;let mp=1;const gp=new Vector3,yp=new Vector2,xp=new Vector2,_p=new Vector2,vp=new Vector2,bp=new Vector2,Ep=new Vector2,Sp=new Vector2,Ap=new Vector2,Rp=new Vector2,Tp=new Vector3,Mp=new Vector2;let Op=!1;const Pp=[],$p={};function zp(){return 2*Math.PI/60/60*ap.autoRotateSpeed}function Dp(){return Math.pow(.95,ap.zoomSpeed)}function Fp(Yp){ap.reverseOrbit||ap.reverseHorizontalOrbit?pp.theta+=Yp:pp.theta-=Yp}function jp(Yp){ap.reverseOrbit||ap.reverseVerticalOrbit?pp.phi+=Yp:pp.phi-=Yp}const Lp=(()=>{const Yp=new Vector3;return function(wm,Cm){Yp.setFromMatrixColumn(Cm,0),Yp.multiplyScalar(-wm),gp.add(Yp)}})(),Bp=(()=>{const Yp=new Vector3;return function(wm,Cm){ap.screenSpacePanning===!0?Yp.setFromMatrixColumn(Cm,1):(Yp.setFromMatrixColumn(Cm,0),Yp.crossVectors(ap.object.up,Yp)),Yp.multiplyScalar(wm),gp.add(Yp)}})(),Ip=(()=>{const Yp=new Vector3;return function(wm,Cm){const Vm=ap.domElement;if(Vm&&ap.object instanceof PerspectiveCamera$1&&ap.object.isPerspectiveCamera){const im=ap.object.position;Yp.copy(im).sub(ap.target);let Am=Yp.length();Am*=Math.tan(ap.object.fov/2*Math.PI/180),Lp(2*wm*Am/Vm.clientHeight,ap.object.matrix),Bp(2*Cm*Am/Vm.clientHeight,ap.object.matrix)}else Vm&&ap.object instanceof OrthographicCamera&&ap.object.isOrthographicCamera?(Lp(wm*(ap.object.right-ap.object.left)/ap.object.zoom/Vm.clientWidth,ap.object.matrix),Bp(Cm*(ap.object.top-ap.object.bottom)/ap.object.zoom/Vm.clientHeight,ap.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),ap.enablePan=!1)}})();function kp(Yp){ap.object instanceof PerspectiveCamera$1&&ap.object.isPerspectiveCamera||ap.object instanceof OrthographicCamera&&ap.object.isOrthographicCamera?mp/=Yp:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),ap.enableZoom=!1)}function Up(Yp){ap.object instanceof PerspectiveCamera$1&&ap.object.isPerspectiveCamera||ap.object instanceof OrthographicCamera&&ap.object.isOrthographicCamera?mp*=Yp:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),ap.enableZoom=!1)}function Gp(Yp){if(!ap.zoomToCursor||!ap.domElement)return;Op=!0;const hm=ap.domElement.getBoundingClientRect(),wm=Yp.clientX-hm.left,Cm=Yp.clientY-hm.top,Vm=hm.width,im=hm.height;Mp.x=wm/Vm*2-1,Mp.y=-(Cm/im)*2+1,Tp.set(Mp.x,Mp.y,1).unproject(ap.object).sub(ap.object.position).normalize()}function Wp(Yp){return Math.max(ap.minDistance,Math.min(ap.maxDistance,Yp))}function Qp(Yp){yp.set(Yp.clientX,Yp.clientY)}function Xp(Yp){Gp(Yp),Sp.set(Yp.clientX,Yp.clientY)}function rm(Yp){vp.set(Yp.clientX,Yp.clientY)}function Kp(Yp){xp.set(Yp.clientX,Yp.clientY),_p.subVectors(xp,yp).multiplyScalar(ap.rotateSpeed);const hm=ap.domElement;hm&&(Fp(2*Math.PI*_p.x/hm.clientHeight),jp(2*Math.PI*_p.y/hm.clientHeight)),yp.copy(xp),ap.update()}function lm(Yp){Ap.set(Yp.clientX,Yp.clientY),Rp.subVectors(Ap,Sp),Rp.y>0?kp(Dp()):Rp.y<0&&Up(Dp()),Sp.copy(Ap),ap.update()}function cm(Yp){bp.set(Yp.clientX,Yp.clientY),Ep.subVectors(bp,vp).multiplyScalar(ap.panSpeed),Ip(Ep.x,Ep.y),vp.copy(bp),ap.update()}function gm(Yp){Gp(Yp),Yp.deltaY<0?Up(Dp()):Yp.deltaY>0&&kp(Dp()),ap.update()}function Mm(Yp){let hm=!1;switch(Yp.code){case ap.keys.UP:Ip(0,ap.keyPanSpeed),hm=!0;break;case ap.keys.BOTTOM:Ip(0,-ap.keyPanSpeed),hm=!0;break;case ap.keys.LEFT:Ip(ap.keyPanSpeed,0),hm=!0;break;case ap.keys.RIGHT:Ip(-ap.keyPanSpeed,0),hm=!0;break}hm&&(Yp.preventDefault(),ap.update())}function dm(){if(Pp.length==1)yp.set(Pp[0].pageX,Pp[0].pageY);else{const Yp=.5*(Pp[0].pageX+Pp[1].pageX),hm=.5*(Pp[0].pageY+Pp[1].pageY);yp.set(Yp,hm)}}function em(){if(Pp.length==1)vp.set(Pp[0].pageX,Pp[0].pageY);else{const Yp=.5*(Pp[0].pageX+Pp[1].pageX),hm=.5*(Pp[0].pageY+Pp[1].pageY);vp.set(Yp,hm)}}function sm(){const Yp=Pp[0].pageX-Pp[1].pageX,hm=Pp[0].pageY-Pp[1].pageY,wm=Math.sqrt(Yp*Yp+hm*hm);Sp.set(0,wm)}function Zp(){ap.enableZoom&&sm(),ap.enablePan&&em()}function mm(){ap.enableZoom&&sm(),ap.enableRotate&&dm()}function fm(Yp){if(Pp.length==1)xp.set(Yp.pageX,Yp.pageY);else{const wm=um(Yp),Cm=.5*(Yp.pageX+wm.x),Vm=.5*(Yp.pageY+wm.y);xp.set(Cm,Vm)}_p.subVectors(xp,yp).multiplyScalar(ap.rotateSpeed);const hm=ap.domElement;hm&&(Fp(2*Math.PI*_p.x/hm.clientHeight),jp(2*Math.PI*_p.y/hm.clientHeight)),yp.copy(xp)}function _m(Yp){if(Pp.length==1)bp.set(Yp.pageX,Yp.pageY);else{const hm=um(Yp),wm=.5*(Yp.pageX+hm.x),Cm=.5*(Yp.pageY+hm.y);bp.set(wm,Cm)}Ep.subVectors(bp,vp).multiplyScalar(ap.panSpeed),Ip(Ep.x,Ep.y),vp.copy(bp)}function zm(Yp){const hm=um(Yp),wm=Yp.pageX-hm.x,Cm=Yp.pageY-hm.y,Vm=Math.sqrt(wm*wm+Cm*Cm);Ap.set(0,Vm),Rp.set(0,Math.pow(Ap.y/Sp.y,ap.zoomSpeed)),kp(Rp.y),Sp.copy(Ap)}function tm(Yp){ap.enableZoom&&zm(Yp),ap.enablePan&&_m(Yp)}function Jp(Yp){ap.enableZoom&&zm(Yp),ap.enableRotate&&fm(Yp)}function pm(Yp){var hm,wm;ap.enabled!==!1&&(Pp.length===0&&((hm=ap.domElement)==null||hm.ownerDocument.addEventListener("pointermove",km),(wm=ap.domElement)==null||wm.ownerDocument.addEventListener("pointerup",ym)),lv(Yp),Yp.pointerType==="touch"?jm(Yp):Bm(Yp))}function km(Yp){ap.enabled!==!1&&(Yp.pointerType==="touch"?Fm(Yp):Pm(Yp))}function ym(Yp){var hm,wm,Cm;tv(Yp),Pp.length===0&&((hm=ap.domElement)==null||hm.releasePointerCapture(Yp.pointerId),(wm=ap.domElement)==null||wm.ownerDocument.removeEventListener("pointermove",km),(Cm=ap.domElement)==null||Cm.ownerDocument.removeEventListener("pointerup",ym)),ap.dispatchEvent(up),dp=cp.NONE}function Em(Yp){tv(Yp)}function Bm(Yp){let hm;switch(Yp.button){case 0:hm=ap.mouseButtons.LEFT;break;case 1:hm=ap.mouseButtons.MIDDLE;break;case 2:hm=ap.mouseButtons.RIGHT;break;default:hm=-1}switch(hm){case MOUSE.DOLLY:if(ap.enableZoom===!1)return;Xp(Yp),dp=cp.DOLLY;break;case MOUSE.ROTATE:if(Yp.ctrlKey||Yp.metaKey||Yp.shiftKey){if(ap.enablePan===!1)return;rm(Yp),dp=cp.PAN}else{if(ap.enableRotate===!1)return;Qp(Yp),dp=cp.ROTATE}break;case MOUSE.PAN:if(Yp.ctrlKey||Yp.metaKey||Yp.shiftKey){if(ap.enableRotate===!1)return;Qp(Yp),dp=cp.ROTATE}else{if(ap.enablePan===!1)return;rm(Yp),dp=cp.PAN}break;default:dp=cp.NONE}dp!==cp.NONE&&ap.dispatchEvent(lp)}function Pm(Yp){if(ap.enabled!==!1)switch(dp){case cp.ROTATE:if(ap.enableRotate===!1)return;Kp(Yp);break;case cp.DOLLY:if(ap.enableZoom===!1)return;lm(Yp);break;case cp.PAN:if(ap.enablePan===!1)return;cm(Yp);break}}function Im(Yp){ap.enabled===!1||ap.enableZoom===!1||dp!==cp.NONE&&dp!==cp.ROTATE||(Yp.preventDefault(),ap.dispatchEvent(lp),gm(Yp),ap.dispatchEvent(up))}function Dm(Yp){ap.enabled===!1||ap.enablePan===!1||Mm(Yp)}function jm(Yp){switch(Jm(Yp),Pp.length){case 1:switch(ap.touches.ONE){case TOUCH.ROTATE:if(ap.enableRotate===!1)return;dm(),dp=cp.TOUCH_ROTATE;break;case TOUCH.PAN:if(ap.enablePan===!1)return;em(),dp=cp.TOUCH_PAN;break;default:dp=cp.NONE}break;case 2:switch(ap.touches.TWO){case TOUCH.DOLLY_PAN:if(ap.enableZoom===!1&&ap.enablePan===!1)return;Zp(),dp=cp.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(ap.enableZoom===!1&&ap.enableRotate===!1)return;mm(),dp=cp.TOUCH_DOLLY_ROTATE;break;default:dp=cp.NONE}break;default:dp=cp.NONE}dp!==cp.NONE&&ap.dispatchEvent(lp)}function Fm(Yp){switch(Jm(Yp),dp){case cp.TOUCH_ROTATE:if(ap.enableRotate===!1)return;fm(Yp),ap.update();break;case cp.TOUCH_PAN:if(ap.enablePan===!1)return;_m(Yp),ap.update();break;case cp.TOUCH_DOLLY_PAN:if(ap.enableZoom===!1&&ap.enablePan===!1)return;tm(Yp),ap.update();break;case cp.TOUCH_DOLLY_ROTATE:if(ap.enableZoom===!1&&ap.enableRotate===!1)return;Jp(Yp),ap.update();break;default:dp=cp.NONE}}function av(Yp){ap.enabled!==!1&&Yp.preventDefault()}function lv(Yp){Pp.push(Yp)}function tv(Yp){delete $p[Yp.pointerId];for(let hm=0;hm<Pp.length;hm++)if(Pp[hm].pointerId==Yp.pointerId){Pp.splice(hm,1);return}}function Jm(Yp){let hm=$p[Yp.pointerId];hm===void 0&&(hm=new Vector2,$p[Yp.pointerId]=hm),hm.set(Yp.pageX,Yp.pageY)}function um(Yp){const hm=Yp.pointerId===Pp[0].pointerId?Pp[1]:Pp[0];return $p[hm.pointerId]}np!==void 0&&this.connect(np),this.update()}};class GLTFLoader extends Loader{constructor(_d){super(_d),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(np){return new GLTFMaterialsClearcoatExtension(np)}),this.register(function(np){return new GLTFTextureBasisUExtension(np)}),this.register(function(np){return new GLTFTextureWebPExtension(np)}),this.register(function(np){return new GLTFTextureAVIFExtension(np)}),this.register(function(np){return new GLTFMaterialsSheenExtension(np)}),this.register(function(np){return new GLTFMaterialsTransmissionExtension(np)}),this.register(function(np){return new GLTFMaterialsVolumeExtension(np)}),this.register(function(np){return new GLTFMaterialsIorExtension(np)}),this.register(function(np){return new GLTFMaterialsEmissiveStrengthExtension(np)}),this.register(function(np){return new GLTFMaterialsSpecularExtension(np)}),this.register(function(np){return new GLTFMaterialsIridescenceExtension(np)}),this.register(function(np){return new GLTFMaterialsAnisotropyExtension(np)}),this.register(function(np){return new GLTFLightsExtension(np)}),this.register(function(np){return new GLTFMeshoptCompression(np)}),this.register(function(np){return new GLTFMeshGpuInstancing(np)})}load(_d,np,ap,sp){const lp=this;let up;this.resourcePath!==""?up=this.resourcePath:this.path!==""?up=this.path:up=LoaderUtils.extractUrlBase(_d),this.manager.itemStart(_d);const cp=function(hp){sp?sp(hp):console.error(hp),lp.manager.itemError(_d),lp.manager.itemEnd(_d)},dp=new FileLoader(this.manager);dp.setPath(this.path),dp.setResponseType("arraybuffer"),dp.setRequestHeader(this.requestHeader),dp.setWithCredentials(this.withCredentials),dp.load(_d,function(hp){try{lp.parse(hp,up,function(fp){np(fp),lp.manager.itemEnd(_d)},cp)}catch(fp){cp(fp)}},ap,cp)}setDRACOLoader(_d){return this.dracoLoader=_d,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_d){return this.ktx2Loader=_d,this}setMeshoptDecoder(_d){return this.meshoptDecoder=_d,this}register(_d){return this.pluginCallbacks.indexOf(_d)===-1&&this.pluginCallbacks.push(_d),this}unregister(_d){return this.pluginCallbacks.indexOf(_d)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_d),1),this}parse(_d,np,ap,sp){let lp;const up={},cp={};if(typeof _d=="string")lp=JSON.parse(_d);else if(_d instanceof ArrayBuffer)if(LoaderUtils.decodeText(new Uint8Array(_d.slice(0,4)))===BINARY_EXTENSION_HEADER_MAGIC){try{up[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(_d)}catch(fp){sp&&sp(fp);return}lp=JSON.parse(up[EXTENSIONS.KHR_BINARY_GLTF].content)}else lp=JSON.parse(LoaderUtils.decodeText(new Uint8Array(_d)));else lp=_d;if(lp.asset===void 0||lp.asset.version[0]<2){sp&&sp(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const dp=new GLTFParser(lp,{path:np||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});dp.fileLoader.setRequestHeader(this.requestHeader);for(let hp=0;hp<this.pluginCallbacks.length;hp++){const fp=this.pluginCallbacks[hp](dp);cp[fp.name]=fp,up[fp.name]=!0}if(lp.extensionsUsed)for(let hp=0;hp<lp.extensionsUsed.length;++hp){const fp=lp.extensionsUsed[hp],pp=lp.extensionsRequired||[];switch(fp){case EXTENSIONS.KHR_MATERIALS_UNLIT:up[fp]=new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:up[fp]=new GLTFDracoMeshCompressionExtension(lp,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:up[fp]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:up[fp]=new GLTFMeshQuantizationExtension;break;default:pp.indexOf(fp)>=0&&cp[fp]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+fp+'".')}}dp.setExtensions(up),dp.setPlugins(cp),dp.parse(ap,sp)}parseAsync(_d,np){const ap=this;return new Promise(function(sp,lp){ap.parse(_d,np,sp,lp)})}}function GLTFRegistry(){let rp={};return{get:function(_d){return rp[_d]},add:function(_d,np){rp[_d]=np},remove:function(_d){delete rp[_d]},removeAll:function(){rp={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _d=this.parser,np=this.parser.json.nodes||[];for(let ap=0,sp=np.length;ap<sp;ap++){const lp=np[ap];lp.extensions&&lp.extensions[this.name]&&lp.extensions[this.name].light!==void 0&&_d._addNodeRef(this.cache,lp.extensions[this.name].light)}}_loadLight(_d){const np=this.parser,ap="light:"+_d;let sp=np.cache.get(ap);if(sp)return sp;const lp=np.json,dp=((lp.extensions&&lp.extensions[this.name]||{}).lights||[])[_d];let hp;const fp=new Color(16777215);dp.color!==void 0&&fp.fromArray(dp.color);const pp=dp.range!==void 0?dp.range:0;switch(dp.type){case"directional":hp=new DirectionalLight(fp),hp.target.position.set(0,0,-1),hp.add(hp.target);break;case"point":hp=new PointLight(fp),hp.distance=pp;break;case"spot":hp=new SpotLight(fp),hp.distance=pp,dp.spot=dp.spot||{},dp.spot.innerConeAngle=dp.spot.innerConeAngle!==void 0?dp.spot.innerConeAngle:0,dp.spot.outerConeAngle=dp.spot.outerConeAngle!==void 0?dp.spot.outerConeAngle:Math.PI/4,hp.angle=dp.spot.outerConeAngle,hp.penumbra=1-dp.spot.innerConeAngle/dp.spot.outerConeAngle,hp.target.position.set(0,0,-1),hp.add(hp.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+dp.type)}return hp.position.set(0,0,0),hp.decay=2,assignExtrasToUserData(hp,dp),dp.intensity!==void 0&&(hp.intensity=dp.intensity),hp.name=np.createUniqueName(dp.name||"light_"+_d),sp=Promise.resolve(hp),np.cache.add(ap,sp),sp}getDependency(_d,np){if(_d==="light")return this._loadLight(np)}createNodeAttachment(_d){const np=this,ap=this.parser,lp=ap.json.nodes[_d],cp=(lp.extensions&&lp.extensions[this.name]||{}).light;return cp===void 0?null:this._loadLight(cp).then(function(dp){return ap._getNodeRef(np.cache,cp,dp)})}}class GLTFMaterialsUnlitExtension{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(_d,np,ap){const sp=[];_d.color=new Color(1,1,1),_d.opacity=1;const lp=np.pbrMetallicRoughness;if(lp){if(Array.isArray(lp.baseColorFactor)){const up=lp.baseColorFactor;_d.color.fromArray(up),_d.opacity=up[3]}lp.baseColorTexture!==void 0&&sp.push(ap.assignTexture(_d,"map",lp.baseColorTexture,3001))}return Promise.all(sp)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_d,np){const sp=this.parser.json.materials[_d];if(!sp.extensions||!sp.extensions[this.name])return Promise.resolve();const lp=sp.extensions[this.name].emissiveStrength;return lp!==void 0&&(np.emissiveIntensity=lp),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(_d){const ap=this.parser.json.materials[_d];return!ap.extensions||!ap.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_d,np){const ap=this.parser,sp=ap.json.materials[_d];if(!sp.extensions||!sp.extensions[this.name])return Promise.resolve();const lp=[],up=sp.extensions[this.name];if(up.clearcoatFactor!==void 0&&(np.clearcoat=up.clearcoatFactor),up.clearcoatTexture!==void 0&&lp.push(ap.assignTexture(np,"clearcoatMap",up.clearcoatTexture)),up.clearcoatRoughnessFactor!==void 0&&(np.clearcoatRoughness=up.clearcoatRoughnessFactor),up.clearcoatRoughnessTexture!==void 0&&lp.push(ap.assignTexture(np,"clearcoatRoughnessMap",up.clearcoatRoughnessTexture)),up.clearcoatNormalTexture!==void 0&&(lp.push(ap.assignTexture(np,"clearcoatNormalMap",up.clearcoatNormalTexture)),up.clearcoatNormalTexture.scale!==void 0)){const cp=up.clearcoatNormalTexture.scale;np.clearcoatNormalScale=new Vector2(cp,cp)}return Promise.all(lp)}}class GLTFMaterialsIridescenceExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_d){const ap=this.parser.json.materials[_d];return!ap.extensions||!ap.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_d,np){const ap=this.parser,sp=ap.json.materials[_d];if(!sp.extensions||!sp.extensions[this.name])return Promise.resolve();const lp=[],up=sp.extensions[this.name];return up.iridescenceFactor!==void 0&&(np.iridescence=up.iridescenceFactor),up.iridescenceTexture!==void 0&&lp.push(ap.assignTexture(np,"iridescenceMap",up.iridescenceTexture)),up.iridescenceIor!==void 0&&(np.iridescenceIOR=up.iridescenceIor),np.iridescenceThicknessRange===void 0&&(np.iridescenceThicknessRange=[100,400]),up.iridescenceThicknessMinimum!==void 0&&(np.iridescenceThicknessRange[0]=up.iridescenceThicknessMinimum),up.iridescenceThicknessMaximum!==void 0&&(np.iridescenceThicknessRange[1]=up.iridescenceThicknessMaximum),up.iridescenceThicknessTexture!==void 0&&lp.push(ap.assignTexture(np,"iridescenceThicknessMap",up.iridescenceThicknessTexture)),Promise.all(lp)}}class GLTFMaterialsSheenExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(_d){const ap=this.parser.json.materials[_d];return!ap.extensions||!ap.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_d,np){const ap=this.parser,sp=ap.json.materials[_d];if(!sp.extensions||!sp.extensions[this.name])return Promise.resolve();const lp=[];np.sheenColor=new Color(0,0,0),np.sheenRoughness=0,np.sheen=1;const up=sp.extensions[this.name];return up.sheenColorFactor!==void 0&&np.sheenColor.fromArray(up.sheenColorFactor),up.sheenRoughnessFactor!==void 0&&(np.sheenRoughness=up.sheenRoughnessFactor),up.sheenColorTexture!==void 0&&lp.push(ap.assignTexture(np,"sheenColorMap",up.sheenColorTexture,3001)),up.sheenRoughnessTexture!==void 0&&lp.push(ap.assignTexture(np,"sheenRoughnessMap",up.sheenRoughnessTexture)),Promise.all(lp)}}class GLTFMaterialsTransmissionExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(_d){const ap=this.parser.json.materials[_d];return!ap.extensions||!ap.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_d,np){const ap=this.parser,sp=ap.json.materials[_d];if(!sp.extensions||!sp.extensions[this.name])return Promise.resolve();const lp=[],up=sp.extensions[this.name];return up.transmissionFactor!==void 0&&(np.transmission=up.transmissionFactor),up.transmissionTexture!==void 0&&lp.push(ap.assignTexture(np,"transmissionMap",up.transmissionTexture)),Promise.all(lp)}}class GLTFMaterialsVolumeExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(_d){const ap=this.parser.json.materials[_d];return!ap.extensions||!ap.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_d,np){const ap=this.parser,sp=ap.json.materials[_d];if(!sp.extensions||!sp.extensions[this.name])return Promise.resolve();const lp=[],up=sp.extensions[this.name];np.thickness=up.thicknessFactor!==void 0?up.thicknessFactor:0,up.thicknessTexture!==void 0&&lp.push(ap.assignTexture(np,"thicknessMap",up.thicknessTexture)),np.attenuationDistance=up.attenuationDistance||1/0;const cp=up.attenuationColor||[1,1,1];return np.attenuationColor=new Color(cp[0],cp[1],cp[2]),Promise.all(lp)}}class GLTFMaterialsIorExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(_d){const ap=this.parser.json.materials[_d];return!ap.extensions||!ap.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_d,np){const sp=this.parser.json.materials[_d];if(!sp.extensions||!sp.extensions[this.name])return Promise.resolve();const lp=sp.extensions[this.name];return np.ior=lp.ior!==void 0?lp.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(_d){const ap=this.parser.json.materials[_d];return!ap.extensions||!ap.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_d,np){const ap=this.parser,sp=ap.json.materials[_d];if(!sp.extensions||!sp.extensions[this.name])return Promise.resolve();const lp=[],up=sp.extensions[this.name];np.specularIntensity=up.specularFactor!==void 0?up.specularFactor:1,up.specularTexture!==void 0&&lp.push(ap.assignTexture(np,"specularIntensityMap",up.specularTexture));const cp=up.specularColorFactor||[1,1,1];return np.specularColor=new Color(cp[0],cp[1],cp[2]),up.specularColorTexture!==void 0&&lp.push(ap.assignTexture(np,"specularColorMap",up.specularColorTexture,3001)),Promise.all(lp)}}class GLTFMaterialsAnisotropyExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(_d){const ap=this.parser.json.materials[_d];return!ap.extensions||!ap.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_d,np){const ap=this.parser,sp=ap.json.materials[_d];if(!sp.extensions||!sp.extensions[this.name])return Promise.resolve();const lp=[],up=sp.extensions[this.name];return up.anisotropyStrength!==void 0&&(np.anisotropy=up.anisotropyStrength),up.anisotropyRotation!==void 0&&(np.anisotropyRotation=up.anisotropyRotation),up.anisotropyTexture!==void 0&&lp.push(ap.assignTexture(np,"anisotropyMap",up.anisotropyTexture)),Promise.all(lp)}}class GLTFTextureBasisUExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(_d){const np=this.parser,ap=np.json,sp=ap.textures[_d];if(!sp.extensions||!sp.extensions[this.name])return null;const lp=sp.extensions[this.name],up=np.options.ktx2Loader;if(!up){if(ap.extensionsRequired&&ap.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return np.loadTextureImage(_d,lp.source,up)}}class GLTFTextureWebPExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_d){const np=this.name,ap=this.parser,sp=ap.json,lp=sp.textures[_d];if(!lp.extensions||!lp.extensions[np])return null;const up=lp.extensions[np],cp=sp.images[up.source];let dp=ap.textureLoader;if(cp.uri){const hp=ap.options.manager.getHandler(cp.uri);hp!==null&&(dp=hp)}return this.detectSupport().then(function(hp){if(hp)return ap.loadTextureImage(_d,up.source,dp);if(sp.extensionsRequired&&sp.extensionsRequired.indexOf(np)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return ap.loadTexture(_d)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_d){const np=new Image;np.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",np.onload=np.onerror=function(){_d(np.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(_d){this.parser=_d,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_d){const np=this.name,ap=this.parser,sp=ap.json,lp=sp.textures[_d];if(!lp.extensions||!lp.extensions[np])return null;const up=lp.extensions[np],cp=sp.images[up.source];let dp=ap.textureLoader;if(cp.uri){const hp=ap.options.manager.getHandler(cp.uri);hp!==null&&(dp=hp)}return this.detectSupport().then(function(hp){if(hp)return ap.loadTextureImage(_d,up.source,dp);if(sp.extensionsRequired&&sp.extensionsRequired.indexOf(np)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return ap.loadTexture(_d)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_d){const np=new Image;np.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",np.onload=np.onerror=function(){_d(np.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(_d){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=_d}loadBufferView(_d){const np=this.parser.json,ap=np.bufferViews[_d];if(ap.extensions&&ap.extensions[this.name]){const sp=ap.extensions[this.name],lp=this.parser.getDependency("buffer",sp.buffer),up=this.parser.options.meshoptDecoder;if(!up||!up.supported){if(np.extensionsRequired&&np.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return lp.then(function(cp){const dp=sp.byteOffset||0,hp=sp.byteLength||0,fp=sp.count,pp=sp.byteStride,mp=new Uint8Array(cp,dp,hp);return up.decodeGltfBufferAsync?up.decodeGltfBufferAsync(fp,pp,mp,sp.mode,sp.filter).then(function(gp){return gp.buffer}):up.ready.then(function(){const gp=new ArrayBuffer(fp*pp);return up.decodeGltfBuffer(new Uint8Array(gp),fp,pp,mp,sp.mode,sp.filter),gp})})}else return null}}class GLTFMeshGpuInstancing{constructor(_d){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=_d}createNodeMesh(_d){const np=this.parser.json,ap=np.nodes[_d];if(!ap.extensions||!ap.extensions[this.name]||ap.mesh===void 0)return null;const sp=np.meshes[ap.mesh];for(const hp of sp.primitives)if(hp.mode!==WEBGL_CONSTANTS.TRIANGLES&&hp.mode!==WEBGL_CONSTANTS.TRIANGLE_STRIP&&hp.mode!==WEBGL_CONSTANTS.TRIANGLE_FAN&&hp.mode!==void 0)return null;const up=ap.extensions[this.name].attributes,cp=[],dp={};for(const hp in up)cp.push(this.parser.getDependency("accessor",up[hp]).then(fp=>(dp[hp]=fp,dp[hp])));return cp.length<1?null:(cp.push(this.parser.createNodeMesh(_d)),Promise.all(cp).then(hp=>{const fp=hp.pop(),pp=fp.isGroup?fp.children:[fp],mp=hp[0].count,gp=[];for(const yp of pp){const xp=new Matrix4,_p=new Vector3,vp=new Quaternion,bp=new Vector3(1,1,1),Ep=new InstancedMesh(yp.geometry,yp.material,mp);for(let Sp=0;Sp<mp;Sp++)dp.TRANSLATION&&_p.fromBufferAttribute(dp.TRANSLATION,Sp),dp.ROTATION&&vp.fromBufferAttribute(dp.ROTATION,Sp),dp.SCALE&&bp.fromBufferAttribute(dp.SCALE,Sp),Ep.setMatrixAt(Sp,xp.compose(_p,vp,bp));for(const Sp in dp)Sp!=="TRANSLATION"&&Sp!=="ROTATION"&&Sp!=="SCALE"&&yp.geometry.setAttribute(Sp,dp[Sp]);Object3D.prototype.copy.call(Ep,yp),this.parser.assignFinalMaterial(Ep),gp.push(Ep)}return fp.isGroup?(fp.clear(),fp.add(...gp),fp):gp[0]}))}}const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(_d){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const np=new DataView(_d,0,BINARY_EXTENSION_HEADER_LENGTH);if(this.header={magic:LoaderUtils.decodeText(new Uint8Array(_d.slice(0,4))),version:np.getUint32(4,!0),length:np.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const ap=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,sp=new DataView(_d,BINARY_EXTENSION_HEADER_LENGTH);let lp=0;for(;lp<ap;){const up=sp.getUint32(lp,!0);lp+=4;const cp=sp.getUint32(lp,!0);if(lp+=4,cp===BINARY_EXTENSION_CHUNK_TYPES.JSON){const dp=new Uint8Array(_d,BINARY_EXTENSION_HEADER_LENGTH+lp,up);this.content=LoaderUtils.decodeText(dp)}else if(cp===BINARY_EXTENSION_CHUNK_TYPES.BIN){const dp=BINARY_EXTENSION_HEADER_LENGTH+lp;this.body=_d.slice(dp,dp+up)}lp+=up}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(_d,np){if(!np)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=_d,this.dracoLoader=np,this.dracoLoader.preload()}decodePrimitive(_d,np){const ap=this.json,sp=this.dracoLoader,lp=_d.extensions[this.name].bufferView,up=_d.extensions[this.name].attributes,cp={},dp={},hp={};for(const fp in up){const pp=ATTRIBUTES[fp]||fp.toLowerCase();cp[pp]=up[fp]}for(const fp in _d.attributes){const pp=ATTRIBUTES[fp]||fp.toLowerCase();if(up[fp]!==void 0){const mp=ap.accessors[_d.attributes[fp]],gp=WEBGL_COMPONENT_TYPES[mp.componentType];hp[pp]=gp.name,dp[pp]=mp.normalized===!0}}return np.getDependency("bufferView",lp).then(function(fp){return new Promise(function(pp){sp.decodeDracoFile(fp,function(mp){for(const gp in mp.attributes){const yp=mp.attributes[gp],xp=dp[gp];xp!==void 0&&(yp.normalized=xp)}pp(mp)},cp,hp)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(_d,np){return(np.texCoord===void 0||np.texCoord===_d.channel)&&np.offset===void 0&&np.rotation===void 0&&np.scale===void 0||(_d=_d.clone(),np.texCoord!==void 0&&(_d.channel=np.texCoord),np.offset!==void 0&&_d.offset.fromArray(np.offset),np.rotation!==void 0&&(_d.rotation=np.rotation),np.scale!==void 0&&_d.repeat.fromArray(np.scale),_d.needsUpdate=!0),_d}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(_d,np,ap,sp){super(_d,np,ap,sp)}copySampleValue_(_d){const np=this.resultBuffer,ap=this.sampleValues,sp=this.valueSize,lp=_d*sp*3+sp;for(let up=0;up!==sp;up++)np[up]=ap[lp+up];return np}interpolate_(_d,np,ap,sp){const lp=this.resultBuffer,up=this.sampleValues,cp=this.valueSize,dp=cp*2,hp=cp*3,fp=sp-np,pp=(ap-np)/fp,mp=pp*pp,gp=mp*pp,yp=_d*hp,xp=yp-hp,_p=-2*gp+3*mp,vp=gp-mp,bp=1-_p,Ep=vp-mp+pp;for(let Sp=0;Sp!==cp;Sp++){const Ap=up[xp+Sp+cp],Rp=up[xp+Sp+dp]*fp,Tp=up[yp+Sp+cp],Mp=up[yp+Sp]*fp;lp[Sp]=bp*Ap+Ep*Rp+_p*Tp+vp*Mp}return lp}}const _q=new Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(_d,np,ap,sp){const lp=super.interpolate_(_d,np,ap,sp);return _q.fromArray(lp).normalize().toArray(lp),lp}}const WEBGL_CONSTANTS={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...version>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(rp){return rp.DefaultMaterial===void 0&&(rp.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),rp.DefaultMaterial}function addUnknownExtensionsToUserData(rp,_d,np){for(const ap in np.extensions)rp[ap]===void 0&&(_d.userData.gltfExtensions=_d.userData.gltfExtensions||{},_d.userData.gltfExtensions[ap]=np.extensions[ap])}function assignExtrasToUserData(rp,_d){_d.extras!==void 0&&(typeof _d.extras=="object"?Object.assign(rp.userData,_d.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_d.extras))}function addMorphTargets(rp,_d,np){let ap=!1,sp=!1,lp=!1;for(let hp=0,fp=_d.length;hp<fp;hp++){const pp=_d[hp];if(pp.POSITION!==void 0&&(ap=!0),pp.NORMAL!==void 0&&(sp=!0),pp.COLOR_0!==void 0&&(lp=!0),ap&&sp&&lp)break}if(!ap&&!sp&&!lp)return Promise.resolve(rp);const up=[],cp=[],dp=[];for(let hp=0,fp=_d.length;hp<fp;hp++){const pp=_d[hp];if(ap){const mp=pp.POSITION!==void 0?np.getDependency("accessor",pp.POSITION):rp.attributes.position;up.push(mp)}if(sp){const mp=pp.NORMAL!==void 0?np.getDependency("accessor",pp.NORMAL):rp.attributes.normal;cp.push(mp)}if(lp){const mp=pp.COLOR_0!==void 0?np.getDependency("accessor",pp.COLOR_0):rp.attributes.color;dp.push(mp)}}return Promise.all([Promise.all(up),Promise.all(cp),Promise.all(dp)]).then(function(hp){const fp=hp[0],pp=hp[1],mp=hp[2];return ap&&(rp.morphAttributes.position=fp),sp&&(rp.morphAttributes.normal=pp),lp&&(rp.morphAttributes.color=mp),rp.morphTargetsRelative=!0,rp})}function updateMorphTargets(rp,_d){if(rp.updateMorphTargets(),_d.weights!==void 0)for(let np=0,ap=_d.weights.length;np<ap;np++)rp.morphTargetInfluences[np]=_d.weights[np];if(_d.extras&&Array.isArray(_d.extras.targetNames)){const np=_d.extras.targetNames;if(rp.morphTargetInfluences.length===np.length){rp.morphTargetDictionary={};for(let ap=0,sp=np.length;ap<sp;ap++)rp.morphTargetDictionary[np[ap]]=ap}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(rp){let _d;const np=rp.extensions&&rp.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(np?_d="draco:"+np.bufferView+":"+np.indices+":"+createAttributesKey(np.attributes):_d=rp.indices+":"+createAttributesKey(rp.attributes)+":"+rp.mode,rp.targets!==void 0)for(let ap=0,sp=rp.targets.length;ap<sp;ap++)_d+=":"+createAttributesKey(rp.targets[ap]);return _d}function createAttributesKey(rp){let _d="";const np=Object.keys(rp).sort();for(let ap=0,sp=np.length;ap<sp;ap++)_d+=np[ap]+":"+rp[np[ap]]+";";return _d}function getNormalizedComponentScale(rp){switch(rp){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(rp){return rp.search(/\.jpe?g($|\?)/i)>0||rp.search(/^data\:image\/jpeg/)===0?"image/jpeg":rp.search(/\.webp($|\?)/i)>0||rp.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix=new Matrix4;class GLTFParser{constructor(_d={},np={}){this.json=_d,this.extensions={},this.plugins={},this.options=np,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let ap=!1,sp=!1,lp=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(ap=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,sp=navigator.userAgent.indexOf("Firefox")>-1,lp=sp?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||ap||sp&&lp<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_d){this.extensions=_d}setPlugins(_d){this.plugins=_d}parse(_d,np){const ap=this,sp=this.json,lp=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(up){return up._markDefs&&up._markDefs()}),Promise.all(this._invokeAll(function(up){return up.beforeRoot&&up.beforeRoot()})).then(function(){return Promise.all([ap.getDependencies("scene"),ap.getDependencies("animation"),ap.getDependencies("camera")])}).then(function(up){const cp={scene:up[0][sp.scene||0],scenes:up[0],animations:up[1],cameras:up[2],asset:sp.asset,parser:ap,userData:{}};addUnknownExtensionsToUserData(lp,cp,sp),assignExtrasToUserData(cp,sp),Promise.all(ap._invokeAll(function(dp){return dp.afterRoot&&dp.afterRoot(cp)})).then(function(){_d(cp)})}).catch(np)}_markDefs(){const _d=this.json.nodes||[],np=this.json.skins||[],ap=this.json.meshes||[];for(let sp=0,lp=np.length;sp<lp;sp++){const up=np[sp].joints;for(let cp=0,dp=up.length;cp<dp;cp++)_d[up[cp]].isBone=!0}for(let sp=0,lp=_d.length;sp<lp;sp++){const up=_d[sp];up.mesh!==void 0&&(this._addNodeRef(this.meshCache,up.mesh),up.skin!==void 0&&(ap[up.mesh].isSkinnedMesh=!0)),up.camera!==void 0&&this._addNodeRef(this.cameraCache,up.camera)}}_addNodeRef(_d,np){np!==void 0&&(_d.refs[np]===void 0&&(_d.refs[np]=_d.uses[np]=0),_d.refs[np]++)}_getNodeRef(_d,np,ap){if(_d.refs[np]<=1)return ap;const sp=ap.clone(),lp=(up,cp)=>{const dp=this.associations.get(up);dp!=null&&this.associations.set(cp,dp);for(const[hp,fp]of up.children.entries())lp(fp,cp.children[hp])};return lp(ap,sp),sp.name+="_instance_"+_d.uses[np]++,sp}_invokeOne(_d){const np=Object.values(this.plugins);np.push(this);for(let ap=0;ap<np.length;ap++){const sp=_d(np[ap]);if(sp)return sp}return null}_invokeAll(_d){const np=Object.values(this.plugins);np.unshift(this);const ap=[];for(let sp=0;sp<np.length;sp++){const lp=_d(np[sp]);lp&&ap.push(lp)}return ap}getDependency(_d,np){const ap=_d+":"+np;let sp=this.cache.get(ap);if(!sp){switch(_d){case"scene":sp=this.loadScene(np);break;case"node":sp=this._invokeOne(function(lp){return lp.loadNode&&lp.loadNode(np)});break;case"mesh":sp=this._invokeOne(function(lp){return lp.loadMesh&&lp.loadMesh(np)});break;case"accessor":sp=this.loadAccessor(np);break;case"bufferView":sp=this._invokeOne(function(lp){return lp.loadBufferView&&lp.loadBufferView(np)});break;case"buffer":sp=this.loadBuffer(np);break;case"material":sp=this._invokeOne(function(lp){return lp.loadMaterial&&lp.loadMaterial(np)});break;case"texture":sp=this._invokeOne(function(lp){return lp.loadTexture&&lp.loadTexture(np)});break;case"skin":sp=this.loadSkin(np);break;case"animation":sp=this._invokeOne(function(lp){return lp.loadAnimation&&lp.loadAnimation(np)});break;case"camera":sp=this.loadCamera(np);break;default:if(sp=this._invokeOne(function(lp){return lp!=this&&lp.getDependency&&lp.getDependency(_d,np)}),!sp)throw new Error("Unknown type: "+_d);break}this.cache.add(ap,sp)}return sp}getDependencies(_d){let np=this.cache.get(_d);if(!np){const ap=this,sp=this.json[_d+(_d==="mesh"?"es":"s")]||[];np=Promise.all(sp.map(function(lp,up){return ap.getDependency(_d,up)})),this.cache.add(_d,np)}return np}loadBuffer(_d){const np=this.json.buffers[_d],ap=this.fileLoader;if(np.type&&np.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+np.type+" buffer type is not supported.");if(np.uri===void 0&&_d===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const sp=this.options;return new Promise(function(lp,up){ap.load(LoaderUtils.resolveURL(np.uri,sp.path),lp,void 0,function(){up(new Error('THREE.GLTFLoader: Failed to load buffer "'+np.uri+'".'))})})}loadBufferView(_d){const np=this.json.bufferViews[_d];return this.getDependency("buffer",np.buffer).then(function(ap){const sp=np.byteLength||0,lp=np.byteOffset||0;return ap.slice(lp,lp+sp)})}loadAccessor(_d){const np=this,ap=this.json,sp=this.json.accessors[_d];if(sp.bufferView===void 0&&sp.sparse===void 0){const up=WEBGL_TYPE_SIZES[sp.type],cp=WEBGL_COMPONENT_TYPES[sp.componentType],dp=sp.normalized===!0,hp=new cp(sp.count*up);return Promise.resolve(new BufferAttribute(hp,up,dp))}const lp=[];return sp.bufferView!==void 0?lp.push(this.getDependency("bufferView",sp.bufferView)):lp.push(null),sp.sparse!==void 0&&(lp.push(this.getDependency("bufferView",sp.sparse.indices.bufferView)),lp.push(this.getDependency("bufferView",sp.sparse.values.bufferView))),Promise.all(lp).then(function(up){const cp=up[0],dp=WEBGL_TYPE_SIZES[sp.type],hp=WEBGL_COMPONENT_TYPES[sp.componentType],fp=hp.BYTES_PER_ELEMENT,pp=fp*dp,mp=sp.byteOffset||0,gp=sp.bufferView!==void 0?ap.bufferViews[sp.bufferView].byteStride:void 0,yp=sp.normalized===!0;let xp,_p;if(gp&&gp!==pp){const vp=Math.floor(mp/gp),bp="InterleavedBuffer:"+sp.bufferView+":"+sp.componentType+":"+vp+":"+sp.count;let Ep=np.cache.get(bp);Ep||(xp=new hp(cp,vp*gp,sp.count*gp/fp),Ep=new InterleavedBuffer(xp,gp/fp),np.cache.add(bp,Ep)),_p=new InterleavedBufferAttribute(Ep,dp,mp%gp/fp,yp)}else cp===null?xp=new hp(sp.count*dp):xp=new hp(cp,mp,sp.count*dp),_p=new BufferAttribute(xp,dp,yp);if(sp.sparse!==void 0){const vp=WEBGL_TYPE_SIZES.SCALAR,bp=WEBGL_COMPONENT_TYPES[sp.sparse.indices.componentType],Ep=sp.sparse.indices.byteOffset||0,Sp=sp.sparse.values.byteOffset||0,Ap=new bp(up[1],Ep,sp.sparse.count*vp),Rp=new hp(up[2],Sp,sp.sparse.count*dp);cp!==null&&(_p=new BufferAttribute(_p.array.slice(),_p.itemSize,_p.normalized));for(let Tp=0,Mp=Ap.length;Tp<Mp;Tp++){const Op=Ap[Tp];if(_p.setX(Op,Rp[Tp*dp]),dp>=2&&_p.setY(Op,Rp[Tp*dp+1]),dp>=3&&_p.setZ(Op,Rp[Tp*dp+2]),dp>=4&&_p.setW(Op,Rp[Tp*dp+3]),dp>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return _p})}loadTexture(_d){const np=this.json,ap=this.options,lp=np.textures[_d].source,up=np.images[lp];let cp=this.textureLoader;if(up.uri){const dp=ap.manager.getHandler(up.uri);dp!==null&&(cp=dp)}return this.loadTextureImage(_d,lp,cp)}loadTextureImage(_d,np,ap){const sp=this,lp=this.json,up=lp.textures[_d],cp=lp.images[np],dp=(cp.uri||cp.bufferView)+":"+up.sampler;if(this.textureCache[dp])return this.textureCache[dp];const hp=this.loadImageSource(np,ap).then(function(fp){fp.flipY=!1,fp.name=up.name||cp.name||"",fp.name===""&&typeof cp.uri=="string"&&cp.uri.startsWith("data:image/")===!1&&(fp.name=cp.uri);const mp=(lp.samplers||{})[up.sampler]||{};return fp.magFilter=WEBGL_FILTERS[mp.magFilter]||LinearFilter,fp.minFilter=WEBGL_FILTERS[mp.minFilter]||LinearMipmapLinearFilter,fp.wrapS=WEBGL_WRAPPINGS[mp.wrapS]||RepeatWrapping,fp.wrapT=WEBGL_WRAPPINGS[mp.wrapT]||RepeatWrapping,sp.associations.set(fp,{textures:_d}),fp}).catch(function(){return null});return this.textureCache[dp]=hp,hp}loadImageSource(_d,np){const ap=this,sp=this.json,lp=this.options;if(this.sourceCache[_d]!==void 0)return this.sourceCache[_d].then(pp=>pp.clone());const up=sp.images[_d],cp=self.URL||self.webkitURL;let dp=up.uri||"",hp=!1;if(up.bufferView!==void 0)dp=ap.getDependency("bufferView",up.bufferView).then(function(pp){hp=!0;const mp=new Blob([pp],{type:up.mimeType});return dp=cp.createObjectURL(mp),dp});else if(up.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_d+" is missing URI and bufferView");const fp=Promise.resolve(dp).then(function(pp){return new Promise(function(mp,gp){let yp=mp;np.isImageBitmapLoader===!0&&(yp=function(xp){const _p=new Texture(xp);_p.needsUpdate=!0,mp(_p)}),np.load(LoaderUtils.resolveURL(pp,lp.path),yp,void 0,gp)})}).then(function(pp){return hp===!0&&cp.revokeObjectURL(dp),pp.userData.mimeType=up.mimeType||getImageURIMimeType(up.uri),pp}).catch(function(pp){throw console.error("THREE.GLTFLoader: Couldn't load texture",dp),pp});return this.sourceCache[_d]=fp,fp}assignTexture(_d,np,ap,sp){const lp=this;return this.getDependency("texture",ap.index).then(function(up){if(!up)return null;if(ap.texCoord!==void 0&&ap.texCoord>0&&(up=up.clone(),up.channel=ap.texCoord),lp.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const cp=ap.extensions!==void 0?ap.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(cp){const dp=lp.associations.get(up);up=lp.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(up,cp),lp.associations.set(up,dp)}}return sp!==void 0&&("colorSpace"in up?up.colorSpace=sp===3001?"srgb":"srgb-linear":up.encoding=sp),_d[np]=up,up})}assignFinalMaterial(_d){const np=_d.geometry;let ap=_d.material;const sp=np.attributes.tangent===void 0,lp=np.attributes.color!==void 0,up=np.attributes.normal===void 0;if(_d.isPoints){const cp="PointsMaterial:"+ap.uuid;let dp=this.cache.get(cp);dp||(dp=new PointsMaterial,Material.prototype.copy.call(dp,ap),dp.color.copy(ap.color),dp.map=ap.map,dp.sizeAttenuation=!1,this.cache.add(cp,dp)),ap=dp}else if(_d.isLine){const cp="LineBasicMaterial:"+ap.uuid;let dp=this.cache.get(cp);dp||(dp=new LineBasicMaterial,Material.prototype.copy.call(dp,ap),dp.color.copy(ap.color),dp.map=ap.map,this.cache.add(cp,dp)),ap=dp}if(sp||lp||up){let cp="ClonedMaterial:"+ap.uuid+":";sp&&(cp+="derivative-tangents:"),lp&&(cp+="vertex-colors:"),up&&(cp+="flat-shading:");let dp=this.cache.get(cp);dp||(dp=ap.clone(),lp&&(dp.vertexColors=!0),up&&(dp.flatShading=!0),sp&&(dp.normalScale&&(dp.normalScale.y*=-1),dp.clearcoatNormalScale&&(dp.clearcoatNormalScale.y*=-1)),this.cache.add(cp,dp),this.associations.set(dp,this.associations.get(ap))),ap=dp}_d.material=ap}getMaterialType(){return MeshStandardMaterial}loadMaterial(_d){const np=this,ap=this.json,sp=this.extensions,lp=ap.materials[_d];let up;const cp={},dp=lp.extensions||{},hp=[];if(dp[EXTENSIONS.KHR_MATERIALS_UNLIT]){const pp=sp[EXTENSIONS.KHR_MATERIALS_UNLIT];up=pp.getMaterialType(),hp.push(pp.extendParams(cp,lp,np))}else{const pp=lp.pbrMetallicRoughness||{};if(cp.color=new Color(1,1,1),cp.opacity=1,Array.isArray(pp.baseColorFactor)){const mp=pp.baseColorFactor;cp.color.fromArray(mp),cp.opacity=mp[3]}pp.baseColorTexture!==void 0&&hp.push(np.assignTexture(cp,"map",pp.baseColorTexture,3001)),cp.metalness=pp.metallicFactor!==void 0?pp.metallicFactor:1,cp.roughness=pp.roughnessFactor!==void 0?pp.roughnessFactor:1,pp.metallicRoughnessTexture!==void 0&&(hp.push(np.assignTexture(cp,"metalnessMap",pp.metallicRoughnessTexture)),hp.push(np.assignTexture(cp,"roughnessMap",pp.metallicRoughnessTexture))),up=this._invokeOne(function(mp){return mp.getMaterialType&&mp.getMaterialType(_d)}),hp.push(Promise.all(this._invokeAll(function(mp){return mp.extendMaterialParams&&mp.extendMaterialParams(_d,cp)})))}lp.doubleSided===!0&&(cp.side=DoubleSide);const fp=lp.alphaMode||ALPHA_MODES.OPAQUE;if(fp===ALPHA_MODES.BLEND?(cp.transparent=!0,cp.depthWrite=!1):(cp.transparent=!1,fp===ALPHA_MODES.MASK&&(cp.alphaTest=lp.alphaCutoff!==void 0?lp.alphaCutoff:.5)),lp.normalTexture!==void 0&&up!==MeshBasicMaterial&&(hp.push(np.assignTexture(cp,"normalMap",lp.normalTexture)),cp.normalScale=new Vector2(1,1),lp.normalTexture.scale!==void 0)){const pp=lp.normalTexture.scale;cp.normalScale.set(pp,pp)}return lp.occlusionTexture!==void 0&&up!==MeshBasicMaterial&&(hp.push(np.assignTexture(cp,"aoMap",lp.occlusionTexture)),lp.occlusionTexture.strength!==void 0&&(cp.aoMapIntensity=lp.occlusionTexture.strength)),lp.emissiveFactor!==void 0&&up!==MeshBasicMaterial&&(cp.emissive=new Color().fromArray(lp.emissiveFactor)),lp.emissiveTexture!==void 0&&up!==MeshBasicMaterial&&hp.push(np.assignTexture(cp,"emissiveMap",lp.emissiveTexture,3001)),Promise.all(hp).then(function(){const pp=new up(cp);return lp.name&&(pp.name=lp.name),assignExtrasToUserData(pp,lp),np.associations.set(pp,{materials:_d}),lp.extensions&&addUnknownExtensionsToUserData(sp,pp,lp),pp})}createUniqueName(_d){const np=PropertyBinding.sanitizeNodeName(_d||"");return np in this.nodeNamesUsed?np+"_"+ ++this.nodeNamesUsed[np]:(this.nodeNamesUsed[np]=0,np)}loadGeometries(_d){const np=this,ap=this.extensions,sp=this.primitiveCache;function lp(cp){return ap[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(cp,np).then(function(dp){return addPrimitiveAttributes(dp,cp,np)})}const up=[];for(let cp=0,dp=_d.length;cp<dp;cp++){const hp=_d[cp],fp=createPrimitiveKey(hp),pp=sp[fp];if(pp)up.push(pp.promise);else{let mp;hp.extensions&&hp.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?mp=lp(hp):mp=addPrimitiveAttributes(new BufferGeometry,hp,np),sp[fp]={primitive:hp,promise:mp},up.push(mp)}}return Promise.all(up)}loadMesh(_d){const np=this,ap=this.json,sp=this.extensions,lp=ap.meshes[_d],up=lp.primitives,cp=[];for(let dp=0,hp=up.length;dp<hp;dp++){const fp=up[dp].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",up[dp].material);cp.push(fp)}return cp.push(np.loadGeometries(up)),Promise.all(cp).then(function(dp){const hp=dp.slice(0,dp.length-1),fp=dp[dp.length-1],pp=[];for(let gp=0,yp=fp.length;gp<yp;gp++){const xp=fp[gp],_p=up[gp];let vp;const bp=hp[gp];if(_p.mode===WEBGL_CONSTANTS.TRIANGLES||_p.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||_p.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||_p.mode===void 0)vp=lp.isSkinnedMesh===!0?new SkinnedMesh(xp,bp):new Mesh(xp,bp),vp.isSkinnedMesh===!0&&vp.normalizeSkinWeights(),_p.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP?vp.geometry=toTrianglesDrawMode(vp.geometry,TriangleStripDrawMode):_p.mode===WEBGL_CONSTANTS.TRIANGLE_FAN&&(vp.geometry=toTrianglesDrawMode(vp.geometry,TriangleFanDrawMode));else if(_p.mode===WEBGL_CONSTANTS.LINES)vp=new LineSegments(xp,bp);else if(_p.mode===WEBGL_CONSTANTS.LINE_STRIP)vp=new Line(xp,bp);else if(_p.mode===WEBGL_CONSTANTS.LINE_LOOP)vp=new LineLoop(xp,bp);else if(_p.mode===WEBGL_CONSTANTS.POINTS)vp=new Points(xp,bp);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_p.mode);Object.keys(vp.geometry.morphAttributes).length>0&&updateMorphTargets(vp,lp),vp.name=np.createUniqueName(lp.name||"mesh_"+_d),assignExtrasToUserData(vp,lp),_p.extensions&&addUnknownExtensionsToUserData(sp,vp,_p),np.assignFinalMaterial(vp),pp.push(vp)}for(let gp=0,yp=pp.length;gp<yp;gp++)np.associations.set(pp[gp],{meshes:_d,primitives:gp});if(pp.length===1)return lp.extensions&&addUnknownExtensionsToUserData(sp,pp[0],lp),pp[0];const mp=new Group;lp.extensions&&addUnknownExtensionsToUserData(sp,mp,lp),np.associations.set(mp,{meshes:_d});for(let gp=0,yp=pp.length;gp<yp;gp++)mp.add(pp[gp]);return mp})}loadCamera(_d){let np;const ap=this.json.cameras[_d],sp=ap[ap.type];if(!sp){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return ap.type==="perspective"?np=new PerspectiveCamera$1(MathUtils.radToDeg(sp.yfov),sp.aspectRatio||1,sp.znear||1,sp.zfar||2e6):ap.type==="orthographic"&&(np=new OrthographicCamera(-sp.xmag,sp.xmag,sp.ymag,-sp.ymag,sp.znear,sp.zfar)),ap.name&&(np.name=this.createUniqueName(ap.name)),assignExtrasToUserData(np,ap),Promise.resolve(np)}loadSkin(_d){const np=this.json.skins[_d],ap=[];for(let sp=0,lp=np.joints.length;sp<lp;sp++)ap.push(this._loadNodeShallow(np.joints[sp]));return np.inverseBindMatrices!==void 0?ap.push(this.getDependency("accessor",np.inverseBindMatrices)):ap.push(null),Promise.all(ap).then(function(sp){const lp=sp.pop(),up=sp,cp=[],dp=[];for(let hp=0,fp=up.length;hp<fp;hp++){const pp=up[hp];if(pp){cp.push(pp);const mp=new Matrix4;lp!==null&&mp.fromArray(lp.array,hp*16),dp.push(mp)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',np.joints[hp])}return new Skeleton(cp,dp)})}loadAnimation(_d){const ap=this.json.animations[_d],sp=ap.name?ap.name:"animation_"+_d,lp=[],up=[],cp=[],dp=[],hp=[];for(let fp=0,pp=ap.channels.length;fp<pp;fp++){const mp=ap.channels[fp],gp=ap.samplers[mp.sampler],yp=mp.target,xp=yp.node,_p=ap.parameters!==void 0?ap.parameters[gp.input]:gp.input,vp=ap.parameters!==void 0?ap.parameters[gp.output]:gp.output;yp.node!==void 0&&(lp.push(this.getDependency("node",xp)),up.push(this.getDependency("accessor",_p)),cp.push(this.getDependency("accessor",vp)),dp.push(gp),hp.push(yp))}return Promise.all([Promise.all(lp),Promise.all(up),Promise.all(cp),Promise.all(dp),Promise.all(hp)]).then(function(fp){const pp=fp[0],mp=fp[1],gp=fp[2],yp=fp[3],xp=fp[4],_p=[];for(let vp=0,bp=pp.length;vp<bp;vp++){const Ep=pp[vp],Sp=mp[vp],Ap=gp[vp],Rp=yp[vp],Tp=xp[vp];if(Ep===void 0)continue;Ep.updateMatrix();let Mp;switch(PATH_PROPERTIES[Tp.path]){case PATH_PROPERTIES.weights:Mp=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:Mp=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:default:Mp=VectorKeyframeTrack;break}const Op=Ep.name?Ep.name:Ep.uuid,Pp=Rp.interpolation!==void 0?INTERPOLATION[Rp.interpolation]:InterpolateLinear,$p=[];PATH_PROPERTIES[Tp.path]===PATH_PROPERTIES.weights?Ep.traverse(function(Dp){Dp.morphTargetInfluences&&$p.push(Dp.name?Dp.name:Dp.uuid)}):$p.push(Op);let zp=Ap.array;if(Ap.normalized){const Dp=getNormalizedComponentScale(zp.constructor),Fp=new Float32Array(zp.length);for(let jp=0,Lp=zp.length;jp<Lp;jp++)Fp[jp]=zp[jp]*Dp;zp=Fp}for(let Dp=0,Fp=$p.length;Dp<Fp;Dp++){const jp=new Mp($p[Dp]+"."+PATH_PROPERTIES[Tp.path],Sp.array,zp,Pp);Rp.interpolation==="CUBICSPLINE"&&(jp.createInterpolant=function(Bp){const Ip=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new Ip(this.times,this.values,this.getValueSize()/3,Bp)},jp.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),_p.push(jp)}}return new AnimationClip(sp,void 0,_p)})}createNodeMesh(_d){const np=this.json,ap=this,sp=np.nodes[_d];return sp.mesh===void 0?null:ap.getDependency("mesh",sp.mesh).then(function(lp){const up=ap._getNodeRef(ap.meshCache,sp.mesh,lp);return sp.weights!==void 0&&up.traverse(function(cp){if(cp.isMesh)for(let dp=0,hp=sp.weights.length;dp<hp;dp++)cp.morphTargetInfluences[dp]=sp.weights[dp]}),up})}loadNode(_d){const np=this.json,ap=this,sp=np.nodes[_d],lp=ap._loadNodeShallow(_d),up=[],cp=sp.children||[];for(let hp=0,fp=cp.length;hp<fp;hp++)up.push(ap.getDependency("node",cp[hp]));const dp=sp.skin===void 0?Promise.resolve(null):ap.getDependency("skin",sp.skin);return Promise.all([lp,Promise.all(up),dp]).then(function(hp){const fp=hp[0],pp=hp[1],mp=hp[2];mp!==null&&fp.traverse(function(gp){gp.isSkinnedMesh&&gp.bind(mp,_identityMatrix)});for(let gp=0,yp=pp.length;gp<yp;gp++)fp.add(pp[gp]);return fp})}_loadNodeShallow(_d){const np=this.json,ap=this.extensions,sp=this;if(this.nodeCache[_d]!==void 0)return this.nodeCache[_d];const lp=np.nodes[_d],up=lp.name?sp.createUniqueName(lp.name):"",cp=[],dp=sp._invokeOne(function(hp){return hp.createNodeMesh&&hp.createNodeMesh(_d)});return dp&&cp.push(dp),lp.camera!==void 0&&cp.push(sp.getDependency("camera",lp.camera).then(function(hp){return sp._getNodeRef(sp.cameraCache,lp.camera,hp)})),sp._invokeAll(function(hp){return hp.createNodeAttachment&&hp.createNodeAttachment(_d)}).forEach(function(hp){cp.push(hp)}),this.nodeCache[_d]=Promise.all(cp).then(function(hp){let fp;if(lp.isBone===!0?fp=new Bone:hp.length>1?fp=new Group:hp.length===1?fp=hp[0]:fp=new Object3D,fp!==hp[0])for(let pp=0,mp=hp.length;pp<mp;pp++)fp.add(hp[pp]);if(lp.name&&(fp.userData.name=lp.name,fp.name=up),assignExtrasToUserData(fp,lp),lp.extensions&&addUnknownExtensionsToUserData(ap,fp,lp),lp.matrix!==void 0){const pp=new Matrix4;pp.fromArray(lp.matrix),fp.applyMatrix4(pp)}else lp.translation!==void 0&&fp.position.fromArray(lp.translation),lp.rotation!==void 0&&fp.quaternion.fromArray(lp.rotation),lp.scale!==void 0&&fp.scale.fromArray(lp.scale);return sp.associations.has(fp)||sp.associations.set(fp,{}),sp.associations.get(fp).nodes=_d,fp}),this.nodeCache[_d]}loadScene(_d){const np=this.extensions,ap=this.json.scenes[_d],sp=this,lp=new Group;ap.name&&(lp.name=sp.createUniqueName(ap.name)),assignExtrasToUserData(lp,ap),ap.extensions&&addUnknownExtensionsToUserData(np,lp,ap);const up=ap.nodes||[],cp=[];for(let dp=0,hp=up.length;dp<hp;dp++)cp.push(sp.getDependency("node",up[dp]));return Promise.all(cp).then(function(dp){for(let fp=0,pp=dp.length;fp<pp;fp++)lp.add(dp[fp]);const hp=fp=>{const pp=new Map;for(const[mp,gp]of sp.associations)(mp instanceof Material||mp instanceof Texture)&&pp.set(mp,gp);return fp.traverse(mp=>{const gp=sp.associations.get(mp);gp!=null&&pp.set(mp,gp)}),pp};return sp.associations=hp(lp),lp})}}function computeBounds(rp,_d,np){const ap=_d.attributes,sp=new Box3;if(ap.POSITION!==void 0){const cp=np.json.accessors[ap.POSITION],dp=cp.min,hp=cp.max;if(dp!==void 0&&hp!==void 0){if(sp.set(new Vector3(dp[0],dp[1],dp[2]),new Vector3(hp[0],hp[1],hp[2])),cp.normalized){const fp=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[cp.componentType]);sp.min.multiplyScalar(fp),sp.max.multiplyScalar(fp)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const lp=_d.targets;if(lp!==void 0){const cp=new Vector3,dp=new Vector3;for(let hp=0,fp=lp.length;hp<fp;hp++){const pp=lp[hp];if(pp.POSITION!==void 0){const mp=np.json.accessors[pp.POSITION],gp=mp.min,yp=mp.max;if(gp!==void 0&&yp!==void 0){if(dp.setX(Math.max(Math.abs(gp[0]),Math.abs(yp[0]))),dp.setY(Math.max(Math.abs(gp[1]),Math.abs(yp[1]))),dp.setZ(Math.max(Math.abs(gp[2]),Math.abs(yp[2]))),mp.normalized){const xp=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[mp.componentType]);dp.multiplyScalar(xp)}cp.max(dp)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}sp.expandByVector(cp)}rp.boundingBox=sp;const up=new Sphere;sp.getCenter(up.center),up.radius=sp.min.distanceTo(sp.max)/2,rp.boundingSphere=up}function addPrimitiveAttributes(rp,_d,np){const ap=_d.attributes,sp=[];function lp(up,cp){return np.getDependency("accessor",up).then(function(dp){rp.setAttribute(cp,dp)})}for(const up in ap){const cp=ATTRIBUTES[up]||up.toLowerCase();cp in rp.attributes||sp.push(lp(ap[up],cp))}if(_d.indices!==void 0&&!rp.index){const up=np.getDependency("accessor",_d.indices).then(function(cp){rp.setIndex(cp)});sp.push(up)}return assignExtrasToUserData(rp,_d),computeBounds(rp,_d,np),Promise.all(sp).then(function(){return _d.targets!==void 0?addMorphTargets(rp,_d.targets,np):rp})}const _taskCache=new WeakMap;class DRACOLoader extends Loader{constructor(_d){super(_d),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(_d){return this.decoderPath=_d,this}setDecoderConfig(_d){return this.decoderConfig=_d,this}setWorkerLimit(_d){return this.workerLimit=_d,this}load(_d,np,ap,sp){const lp=new FileLoader(this.manager);lp.setPath(this.path),lp.setResponseType("arraybuffer"),lp.setRequestHeader(this.requestHeader),lp.setWithCredentials(this.withCredentials),lp.load(_d,up=>{const cp={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(up,cp).then(np).catch(sp)},ap,sp)}decodeDracoFile(_d,np,ap,sp){const lp={attributeIDs:ap||this.defaultAttributeIDs,attributeTypes:sp||this.defaultAttributeTypes,useUniqueIDs:!!ap};this.decodeGeometry(_d,lp).then(np)}decodeGeometry(_d,np){for(const dp in np.attributeTypes){const hp=np.attributeTypes[dp];hp.BYTES_PER_ELEMENT!==void 0&&(np.attributeTypes[dp]=hp.name)}const ap=JSON.stringify(np);if(_taskCache.has(_d)){const dp=_taskCache.get(_d);if(dp.key===ap)return dp.promise;if(_d.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let sp;const lp=this.workerNextTaskID++,up=_d.byteLength,cp=this._getWorker(lp,up).then(dp=>(sp=dp,new Promise((hp,fp)=>{sp._callbacks[lp]={resolve:hp,reject:fp},sp.postMessage({type:"decode",id:lp,taskConfig:np,buffer:_d},[_d])}))).then(dp=>this._createGeometry(dp.geometry));return cp.catch(()=>!0).then(()=>{sp&&lp&&this._releaseTask(sp,lp)}),_taskCache.set(_d,{key:ap,promise:cp}),cp}_createGeometry(_d){const np=new BufferGeometry;_d.index&&np.setIndex(new BufferAttribute(_d.index.array,1));for(let ap=0;ap<_d.attributes.length;ap++){const sp=_d.attributes[ap],lp=sp.name,up=sp.array,cp=sp.itemSize;np.setAttribute(lp,new BufferAttribute(up,cp))}return np}_loadLibrary(_d,np){const ap=new FileLoader(this.manager);return ap.setPath(this.decoderPath),ap.setResponseType(np),ap.setWithCredentials(this.withCredentials),new Promise((sp,lp)=>{ap.load(_d,sp,void 0,lp)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const _d=typeof WebAssembly!="object"||this.decoderConfig.type==="js",np=[];return _d?np.push(this._loadLibrary("draco_decoder.js","text")):(np.push(this._loadLibrary("draco_wasm_wrapper.js","text")),np.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(np).then(ap=>{const sp=ap[0];_d||(this.decoderConfig.wasmBinary=ap[1]);const lp=DRACOWorker.toString(),up=["/* draco decoder */",sp,"","/* worker */",lp.substring(lp.indexOf("{")+1,lp.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([up]))}),this.decoderPending}_getWorker(_d,np){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const sp=new Worker(this.workerSourceURL);sp._callbacks={},sp._taskCosts={},sp._taskLoad=0,sp.postMessage({type:"init",decoderConfig:this.decoderConfig}),sp.onmessage=function(lp){const up=lp.data;switch(up.type){case"decode":sp._callbacks[up.id].resolve(up);break;case"error":sp._callbacks[up.id].reject(up);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+up.type+'"')}},this.workerPool.push(sp)}else this.workerPool.sort(function(sp,lp){return sp._taskLoad>lp._taskLoad?-1:1});const ap=this.workerPool[this.workerPool.length-1];return ap._taskCosts[_d]=np,ap._taskLoad+=np,ap})}_releaseTask(_d,np){_d._taskLoad-=_d._taskCosts[np],delete _d._callbacks[np],delete _d._taskCosts[np]}debug(){console.log("Task load: ",this.workerPool.map(_d=>_d._taskLoad))}dispose(){for(let _d=0;_d<this.workerPool.length;++_d)this.workerPool[_d].terminate();return this.workerPool.length=0,this}}function DRACOWorker(){let rp,_d;onmessage=function(up){const cp=up.data;switch(cp.type){case"init":rp=cp.decoderConfig,_d=new Promise(function(fp){rp.onModuleLoaded=function(pp){fp({draco:pp})},DracoDecoderModule(rp)});break;case"decode":const dp=cp.buffer,hp=cp.taskConfig;_d.then(fp=>{const pp=fp.draco,mp=new pp.Decoder,gp=new pp.DecoderBuffer;gp.Init(new Int8Array(dp),dp.byteLength);try{const yp=np(pp,mp,gp,hp),xp=yp.attributes.map(_p=>_p.array.buffer);yp.index&&xp.push(yp.index.array.buffer),self.postMessage({type:"decode",id:cp.id,geometry:yp},xp)}catch(yp){console.error(yp),self.postMessage({type:"error",id:cp.id,error:yp.message})}finally{pp.destroy(gp),pp.destroy(mp)}});break}};function np(up,cp,dp,hp){const fp=hp.attributeIDs,pp=hp.attributeTypes;let mp,gp;const yp=cp.GetEncodedGeometryType(dp);if(yp===up.TRIANGULAR_MESH)mp=new up.Mesh,gp=cp.DecodeBufferToMesh(dp,mp);else if(yp===up.POINT_CLOUD)mp=new up.PointCloud,gp=cp.DecodeBufferToPointCloud(dp,mp);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!gp.ok()||mp.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+gp.error_msg());const xp={index:null,attributes:[]};for(const _p in fp){const vp=self[pp[_p]];let bp,Ep;if(hp.useUniqueIDs)Ep=fp[_p],bp=cp.GetAttributeByUniqueId(mp,Ep);else{if(Ep=cp.GetAttributeId(mp,up[fp[_p]]),Ep===-1)continue;bp=cp.GetAttribute(mp,Ep)}xp.attributes.push(sp(up,cp,mp,_p,vp,bp))}return yp===up.TRIANGULAR_MESH&&(xp.index=ap(up,cp,mp)),up.destroy(mp),xp}function ap(up,cp,dp){const fp=dp.num_faces()*3,pp=fp*4,mp=up._malloc(pp);cp.GetTrianglesUInt32Array(dp,pp,mp);const gp=new Uint32Array(up.HEAPF32.buffer,mp,fp).slice();return up._free(mp),{array:gp,itemSize:1}}function sp(up,cp,dp,hp,fp,pp){const mp=pp.num_components(),yp=dp.num_points()*mp,xp=yp*fp.BYTES_PER_ELEMENT,_p=lp(up,fp),vp=up._malloc(xp);cp.GetAttributeDataArrayForAllPoints(dp,pp,_p,xp,vp);const bp=new fp(up.HEAPF32.buffer,vp,yp).slice();return up._free(vp),{name:hp,array:bp,itemSize:mp}}function lp(up,cp){switch(cp){case Float32Array:return up.DT_FLOAT32;case Int8Array:return up.DT_INT8;case Int16Array:return up.DT_INT16;case Int32Array:return up.DT_INT32;case Uint8Array:return up.DT_UINT8;case Uint16Array:return up.DT_UINT16;case Uint32Array:return up.DT_UINT32}}}let generated;const MeshoptDecoder=()=>{if(generated)return generated;const rp="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",_d="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",np=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),ap=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let sp=rp;WebAssembly.validate(np)&&(sp=_d);let lp;const up=WebAssembly.instantiate(cp(sp),{}).then(pp=>{lp=pp.instance,lp.exports.__wasm_call_ctors()});function cp(pp){const mp=new Uint8Array(pp.length);for(let yp=0;yp<pp.length;++yp){const xp=pp.charCodeAt(yp);mp[yp]=xp>96?xp-71:xp>64?xp-65:xp>47?xp+4:xp>46?63:62}let gp=0;for(let yp=0;yp<pp.length;++yp)mp[gp++]=mp[yp]<60?ap[mp[yp]]:(mp[yp]-60)*64+mp[++yp];return mp.buffer.slice(0,gp)}function dp(pp,mp,gp,yp,xp,_p){const vp=lp.exports.sbrk,bp=gp+3&-4,Ep=vp(bp*yp),Sp=vp(xp.length),Ap=new Uint8Array(lp.exports.memory.buffer);Ap.set(xp,Sp);const Rp=pp(Ep,gp,yp,Sp,xp.length);if(Rp===0&&_p&&_p(Ep,bp,yp),mp.set(Ap.subarray(Ep,Ep+gp*yp)),vp(Ep-vp(0)),Rp!==0)throw new Error(`Malformed buffer data: ${Rp}`)}const hp={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},fp={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return generated={ready:up,supported:!0,decodeVertexBuffer(pp,mp,gp,yp,xp){dp(lp.exports.meshopt_decodeVertexBuffer,pp,mp,gp,yp,lp.exports[hp[xp]])},decodeIndexBuffer(pp,mp,gp,yp){dp(lp.exports.meshopt_decodeIndexBuffer,pp,mp,gp,yp)},decodeIndexSequence(pp,mp,gp,yp){dp(lp.exports.meshopt_decodeIndexSequence,pp,mp,gp,yp)},decodeGltfBuffer(pp,mp,gp,yp,xp,_p){dp(lp.exports[fp[xp]],pp,mp,gp,yp,lp.exports[hp[_p]])}},generated};let dracoLoader=null,decoderPath="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function extensions(rp,_d,np){return ap=>{np&&np(ap),rp&&(dracoLoader||(dracoLoader=new DRACOLoader),dracoLoader.setDecoderPath(typeof rp=="string"?rp:decoderPath),ap.setDRACOLoader(dracoLoader)),_d&&ap.setMeshoptDecoder(typeof MeshoptDecoder=="function"?MeshoptDecoder():MeshoptDecoder)}}function useGLTF(rp,_d=!0,np=!0,ap){return useLoader(GLTFLoader,rp,extensions(_d,np,ap))}useGLTF.preload=(rp,_d=!0,np=!0,ap)=>useLoader.preload(GLTFLoader,rp,extensions(_d,np,ap));useGLTF.clear=rp=>useLoader.clear(GLTFLoader,rp);useGLTF.setDecoderPath=rp=>{decoderPath=rp};function useFBO(rp,_d,np){const ap=useThree(mp=>mp.size),sp=useThree(mp=>mp.viewport),lp=typeof rp=="number"?rp:ap.width*sp.dpr,up=typeof _d=="number"?_d:ap.height*sp.dpr,cp=(typeof rp=="number"?np:rp)||{},{samples:dp=0,depth:hp,...fp}=cp,pp=reactExports.useMemo(()=>{const mp=new WebGLRenderTarget(lp,up,{minFilter:LinearFilter,magFilter:LinearFilter,type:HalfFloatType,...fp});return hp&&(mp.depthTexture=new DepthTexture(lp,up,FloatType)),mp.samples=dp,mp},[]);return reactExports.useLayoutEffect(()=>{pp.setSize(lp,up),dp&&(pp.samples=dp)},[dp,pp,lp,up]),reactExports.useEffect(()=>()=>pp.dispose(),[]),pp}const isFunction=rp=>typeof rp=="function",PerspectiveCamera=reactExports.forwardRef(({envMap:rp,resolution:_d=256,frames:np=1/0,makeDefault:ap,children:sp,...lp},up)=>{const cp=useThree(({set:_p})=>_p),dp=useThree(({camera:_p})=>_p),hp=useThree(({size:_p})=>_p),fp=reactExports.useRef(null),pp=reactExports.useRef(null),mp=useFBO(_d);reactExports.useLayoutEffect(()=>{lp.manual||(fp.current.aspect=hp.width/hp.height)},[hp,lp]),reactExports.useLayoutEffect(()=>{fp.current.updateProjectionMatrix()});let gp=0,yp=null;const xp=isFunction(sp);return useFrame(_p=>{xp&&(np===1/0||gp<np)&&(pp.current.visible=!1,_p.gl.setRenderTarget(mp),yp=_p.scene.background,rp&&(_p.scene.background=rp),_p.gl.render(_p.scene,fp.current),_p.scene.background=yp,_p.gl.setRenderTarget(null),pp.current.visible=!0,gp++)}),reactExports.useLayoutEffect(()=>{if(ap){const _p=dp;return cp(()=>({camera:fp.current})),()=>cp(()=>({camera:_p}))}},[fp,ap,cp]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("perspectiveCamera",_extends$1({ref:mergeRefs([fp,up])},lp),!xp&&sp),reactExports.createElement("group",{ref:pp},xp&&sp(mp.texture)))}),OrbitControls=reactExports.forwardRef(({makeDefault:rp,camera:_d,regress:np,domElement:ap,enableDamping:sp=!0,keyEvents:lp=!1,onChange:up,onStart:cp,onEnd:dp,...hp},fp)=>{const pp=useThree(Rp=>Rp.invalidate),mp=useThree(Rp=>Rp.camera),gp=useThree(Rp=>Rp.gl),yp=useThree(Rp=>Rp.events),xp=useThree(Rp=>Rp.setEvents),_p=useThree(Rp=>Rp.set),vp=useThree(Rp=>Rp.get),bp=useThree(Rp=>Rp.performance),Ep=_d||mp,Sp=ap||yp.connected||gp.domElement,Ap=reactExports.useMemo(()=>new OrbitControls$1(Ep),[Ep]);return useFrame(()=>{Ap.enabled&&Ap.update()},-1),reactExports.useEffect(()=>(lp&&Ap.connect(lp===!0?Sp:lp),Ap.connect(Sp),()=>void Ap.dispose()),[lp,Sp,np,Ap,pp]),reactExports.useEffect(()=>{const Rp=Op=>{pp(),np&&bp.regress(),up&&up(Op)},Tp=Op=>{cp&&cp(Op)},Mp=Op=>{dp&&dp(Op)};return Ap.addEventListener("change",Rp),Ap.addEventListener("start",Tp),Ap.addEventListener("end",Mp),()=>{Ap.removeEventListener("start",Tp),Ap.removeEventListener("end",Mp),Ap.removeEventListener("change",Rp)}},[up,cp,dp,Ap,pp,xp]),reactExports.useEffect(()=>{if(rp){const Rp=vp().controls;return _p({controls:Ap}),()=>_p({controls:Rp})}},[rp,Ap]),reactExports.createElement("primitive",_extends$1({ref:fp,object:Ap,enableDamping:sp},hp))});function create(rp,_d){const np=rp+"Geometry";return reactExports.forwardRef(({args:ap,children:sp,...lp},up)=>{const cp=reactExports.useRef(null);return reactExports.useImperativeHandle(up,()=>cp.current),reactExports.useLayoutEffect(()=>void(_d==null?void 0:_d(cp.current))),reactExports.createElement("mesh",_extends$1({ref:cp},lp),reactExports.createElement(np,{attach:"geometry",args:ap}),sp)})}const Box=create("box");function lerp(rp,_d,np){return(1-np)*rp+np*_d}function Chest(rp){const{nodes:_d,materials:np}=useGLTF("/Chest.glb");let ap=!1;const sp=reactExports.useRef(),lp=reactExports.useRef();let up=0;return np.Gold.color,np.Planks.color,np["Gold.001"].color,useFrame(({clock:cp})=>{cp.getElapsedTime(),up=ap?lerp(up,.7,.1):lerp(up,0,.1),sp.current.rotation.set(0,0,up),_d.Cube003_1.geometry.rotation=[0,0,up],_d.Cube003.geometry.needsUpdate=!0,_d.Cube003_1.geometry.needsUpdate=!0}),jsxRuntimeExports.jsxs("group",{...rp,dispose:null,onClick:cp=>{ap=!ap,cp.stopPropagation()},onPointerOver:()=>{},onPointerOut:()=>{},children:[jsxRuntimeExports.jsxs("group",{ref:lp,children:[jsxRuntimeExports.jsx("mesh",{geometry:_d.Cube002.geometry,material:np.Gold}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Cube002_1.geometry,material:np.Planks}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Cube002_2.geometry,material:np["Gold.001"]})]}),jsxRuntimeExports.jsxs("group",{position:[-1,1.43,0],ref:sp,rotation:[0,0,.79],children:[jsxRuntimeExports.jsx("mesh",{geometry:_d.Cube003.geometry,material:np.Gold}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Cube003_1.geometry,material:np.Planks})]})]})}useGLTF.preload("/Chest.glb");let meshes$1=[],originalPositions$2={};function SeaWeed(rp){const{nodes:_d,materials:np}=useGLTF("/SeaWeed.glb");Object.keys(np).forEach(sp=>np[sp].side=DoubleSide);const ap=(sp,lp,up)=>{if(!originalPositions$2[lp])return;const cp=originalPositions$2[lp];for(let dp=0;dp<cp.length;dp+=3){const hp=cp[dp],fp=cp[dp+1],pp=cp[dp+2];let mp=new Vector3(hp,fp,pp);mp.x=hp+Math.sin(up/2)*Math.cos(fp*10)/20,mp.z=pp+Math.sin(up)*Math.cos(fp*2)/20,sp.attributes.position.array[dp]=mp.x,sp.attributes.position.array[dp+1]=mp.y,sp.attributes.position.array[dp+2]=mp.z}return sp.attributes.position.needsUpdate=!0,sp};return(!meshes$1||meshes$1.length===0)&&(meshes$1=Object.keys(_d).filter(sp=>_d[sp].type==="Mesh").map((sp,lp)=>{let up=_d[sp].geometry;originalPositions$2[lp]=[];for(let cp=0;cp<up.attributes.position.array.length;cp+=3){const dp=up.attributes.position.array[cp],hp=up.attributes.position.array[cp+1],fp=up.attributes.position.array[cp+2];originalPositions$2[lp][cp]=dp,originalPositions$2[lp][cp+1]=hp,originalPositions$2[lp][cp+2]=fp}return up})),useFrame(({clock:sp})=>{const lp=sp.getElapsedTime();meshes$1=meshes$1.map((up,cp)=>ap(up,cp,lp))}),jsxRuntimeExports.jsx("group",{...rp,dispose:null,children:jsxRuntimeExports.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:meshes$1[0],material:np["Material.006"]})})}useGLTF.preload("/SeaWeed.glb");let meshes=[];const originalPositions$1={};function GoldFish(rp){const{nodes:_d,materials:np}=useGLTF("/Goldfish.glb");console.log(np),console.log(_d),Object.keys(np).forEach(sp=>np[sp].side=DoubleSide);const ap=(sp,lp,up)=>{if(!originalPositions$1[lp])return;const cp=originalPositions$1[lp];for(let dp=0;dp<cp.length;dp+=3){const hp=cp[dp],fp=cp[dp+1],pp=cp[dp+2];let mp=new Vector3(hp,fp,pp);mp.x=hp+Math.sin(up*6+Math.sin(pp)*5)/20,sp.attributes.position.array[dp]=mp.x,sp.attributes.position.array[dp+1]=mp.y,sp.attributes.position.array[dp+2]=mp.z}return sp.attributes.position.needsUpdate=!0,sp};return(!meshes||meshes.length===0)&&(meshes=Object.keys(_d).filter(sp=>_d[sp].type==="Mesh").map((sp,lp)=>{let up=_d[sp].geometry;originalPositions$1[lp]=[];for(let cp=0;cp<up.attributes.position.array.length;cp+=3){const dp=up.attributes.position.array[cp],hp=up.attributes.position.array[cp+1],fp=up.attributes.position.array[cp+2];originalPositions$1[lp][cp]=dp,originalPositions$1[lp][cp+1]=hp,originalPositions$1[lp][cp+2]=fp}return up})),useFrame(({clock:sp})=>{const lp=sp.getElapsedTime();meshes=meshes.map((up,cp)=>ap(up,cp,lp))}),jsxRuntimeExports.jsxs("group",{...rp,dispose:null,children:[jsxRuntimeExports.jsx("instancedMesh",{castShadow:!0,receiveShadow:!0,ref:rp.fishRef[0],args:[null,null,rp.amount??1],geometry:meshes[0],material:np["Material.003"]}),jsxRuntimeExports.jsx("instancedMesh",{castShadow:!0,receiveShadow:!0,ref:rp.fishRef[1],args:[null,null,rp.amount??1],geometry:meshes[1],material:np["Material.002"]}),jsxRuntimeExports.jsx("instancedMesh",{castShadow:!0,receiveShadow:!0,ref:rp.fishRef[2],args:[null,null,rp.amount??1],geometry:meshes[2],material:np["Material.001"]}),jsxRuntimeExports.jsx("instancedMesh",{castShadow:!0,receiveShadow:!0,ref:rp.fishRef[3],args:[null,null,rp.amount??1],geometry:meshes[3],material:np["Material.004"]}),jsxRuntimeExports.jsx("instancedMesh",{castShadow:!0,receiveShadow:!0,ref:rp.fishRef[4],args:[null,null,rp.amount??1],geometry:meshes[4],material:np.Material})]})}useGLTF.preload("/Goldfish.glb");let mesh;const originalPositions=[];function Clownfish(rp){const{nodes:_d,materials:np}=useGLTF("/clownfish.glb");console.log(_d),console.log(np);const ap=(sp,lp)=>{if(!originalPositions.length)return;const up=originalPositions;for(let cp=0;cp<up.length;cp+=3){const dp=up[cp],hp=up[cp+1],fp=up[cp+2];let pp=new Vector3(dp,hp,fp);pp.x=dp+Math.sin(lp*6+Math.sin(fp)*5)/20,sp.attributes.position.array[cp]=pp.x,sp.attributes.position.array[cp+1]=pp.y,sp.attributes.position.array[cp+2]=pp.z}return sp.attributes.position.needsUpdate=!0,sp};if(!mesh){mesh=_d.Cube003_Material_0.geometry,originalPositions.length=0;for(let sp=0;sp<mesh.attributes.position.array.length;sp+=3){const lp=mesh.attributes.position.array[sp],up=mesh.attributes.position.array[sp+1],cp=mesh.attributes.position.array[sp+2];originalPositions[sp]=lp,originalPositions[sp+1]=up,originalPositions[sp+2]=cp}}return useFrame(({clock:sp})=>{const lp=sp.getElapsedTime();mesh=ap(mesh,lp)}),jsxRuntimeExports.jsx("group",{...rp,dispose:null,children:jsxRuntimeExports.jsx("instancedMesh",{geometry:mesh,material:np.Material,args:[null,null,1],scale:.3})})}useGLTF.preload("/clownfish.glb");function Stonefish(rp){const{nodes:_d,materials:np}=useGLTF("/Stonefish.glb");return jsxRuntimeExports.jsx("group",{...rp,dispose:null,children:jsxRuntimeExports.jsxs("group",{rotation:[.846,1.379,.192],scale:.5,children:[jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_6.geometry,material:np["Q11783-1all_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_7.geometry,material:np["Q11783-1all_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_8.geometry,material:np["Q11783-1all_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_9.geometry,material:np["Q11783-1all_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_10.geometry,material:np["Q11783-1all_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_11.geometry,material:np["Q11783-1all_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_12.geometry,material:np["Q11783-1all_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_13.geometry,material:np["Q11783-1all_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_14.geometry,material:np["Q11783-1all_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_15.geometry,material:np["Q11783-1all_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_16.geometry,material:np["Q11783-1all_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_17.geometry,material:np["Q11783-1all_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_18.geometry,material:np["Q11783-1all_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_19.geometry,material:np["Q11783-1all_tex1"]})]})})}useGLTF.preload("/Stonefish.glb");function SeaBreamfish(rp){const{nodes:_d,materials:np}=useGLTF("/SeaBreamfish.glb");return jsxRuntimeExports.jsx("group",{...rp,dispose:null,children:jsxRuntimeExports.jsxs("group",{rotation:[.024,-.379,-2.866],scale:.5,children:[jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_6.geometry,material:np["Q11679-1all-2_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_7.geometry,material:np["Q11679-1all-2_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_8.geometry,material:np["Q11679-1all-2_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_9.geometry,material:np["Q11679-1all-2_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_10.geometry,material:np["Q11679-1all-2_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_11.geometry,material:np["Q11679-1all-2_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_12.geometry,material:np["Q11679-1all-2_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_13.geometry,material:np["Q11679-1all-2_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_14.geometry,material:np["Q11679-1all-2_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_15.geometry,material:np["Q11679-1all-2_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_16.geometry,material:np["Q11679-1all-2_tex1"]})]})})}useGLTF.preload("/SeaBreamfish.glb");function Blackfish(rp){const{nodes:_d,materials:np}=useGLTF("/Blackfish.glb");return console.log(_d),console.log(np),jsxRuntimeExports.jsx("group",{...rp,dispose:null,children:jsxRuntimeExports.jsxs("group",{rotation:[.365,-1.01,-2.883],scale:.5,children:[jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_6.geometry,material:np["Q11246-1all-1-body_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_7.geometry,material:np["Q11246-1all-1-body_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_8.geometry,material:np["Q11246-1all-1-body_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_9.geometry,material:np["Q11246-1all-1-body_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_10.geometry,material:np["Q11246-1all-1-body_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_11.geometry,material:np["Q11246-1all-1-body_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_12.geometry,material:np["Q11246-1all-1-body_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_13.geometry,material:np["Q11246-1all-1-body_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_14.geometry,material:np["Q11246-1all-1-body_tex0"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_15.geometry,material:np["Q11246-1all-1-body_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_16.geometry,material:np["Q11246-1all-1-body_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_17.geometry,material:np["Q11246-1all-1-body_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_18.geometry,material:np["Q11246-1all-1-body_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_19.geometry,material:np["Q11246-1all-1-body_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_20.geometry,material:np["Q11246-1all-1-body_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_21.geometry,material:np["Q11246-1all-1-body_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_22.geometry,material:np["Q11246-1all-1-body_tex1"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_23.geometry,material:np["Q11246-1all-1-body_tex2"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_24.geometry,material:np["Q11246-1all-1-body_tex2"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_25.geometry,material:np["Q11246-1all-1-body_tex2"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_26.geometry,material:np["Q11246-1all-1-body_tex2"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_27.geometry,material:np["Q11246-1all-1-body_tex2"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_28.geometry,material:np["Q11246-1all-1-body_tex2"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_29.geometry,material:np["Q11246-1all-1-body_tex2"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_30.geometry,material:np["Q11246-1all-1-body_tex2"]}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Object_31.geometry,material:np["Q11246-1all-1-futa"]})]})})}useGLTF.preload("/Blackfish.glb");class Boid{constructor(){this.position=new Vector3(0,0,0);const np=Math.random()*.1;this.velocity=new Vector3(0,0,0),this.velocity.randomDirection(),this.velocity.multiplyScalar(np),this.acceleration=new Vector3(0,0,0),this.rotation=new Vector3(0,0,0),this.scale=new Vector3(0,0,0),this.maxVelocity=.06,this.maxDistance=1.5,this.maxForceAlignment=.001,this.maxForceSeparation=.001,this.maxForceCohesion=.001,this.maxSpeedAlignment=2,this.maxSpeedSeparation=6,this.maxSpeedCohesion=.1}calculateFlocking(_d){let np=new Vector3(0,0,0),ap=new Vector3(0,0,0),sp=new Vector3(0,0,0),lp=0;for(let cp of _d){const dp=cp.position.distanceTo(this.position);if(cp===this||dp>this.maxDistance)continue;const hp=new Vector3(cp.velocity.x,cp.velocity.y,cp.velocity.z);np.add(hp);const fp=new Vector3(this.position.x,this.position.y,this.position.z);fp.sub(cp.position),fp.divideScalar(dp*dp),ap.add(fp);const pp=new Vector3(cp.position.x,cp.position.y,cp.position.z);sp.add(pp),lp++}const up=new Vector3(0,0,0);return lp>0&&(np.divideScalar(lp),np.setLength(this.maxSpeedAlignment),np.sub(this.velocity),np.clampLength(0,this.maxForceAlignment),ap.divideScalar(lp),ap.setLength(this.maxSpeedSeparation),ap.sub(this.position),ap.clampLength(0,this.maxForceSeparation),sp.divideScalar(lp),sp.setLength(this.maxSpeedCohesion),sp.sub(this.position),sp.clampLength(0,this.maxForceCohesion),up.add(np),up.add(ap),up.add(sp)),up}flock(_d){const np=this.calculateFlocking(_d);this.acceleration.add(np)}update(){this.velocity.add(this.acceleration),this.velocity.clampLength(0,this.maxVelocity);const _d=new Vector3(this.position.x,this.position.y-5,this.position.z),np=_d.length();_d.multiplyScalar(-1),np!==0&&np>10&&(_d.divideScalar(1e4),_d.y=_d.y*2,this.velocity.add(_d)),this.position.add(this.velocity),this.acceleration=new Vector3(0,0,0)}}class Flock{constructor(_d){this.boids=[],this.maxDistance=1.5,this.maxSpeedAlignment=2,this.maxSpeedSeparation=6,this.maxSpeedCohesion=.1,this.amountOfBoids=_d,this.initialize()}initialize(){for(let ap=0;ap<this.amountOfBoids;ap++){const sp=Math.random()*.75+.2,lp=new Vector3(Math.random()*25-25/2,Math.random()*20-5,Math.random()*25-25/2),up=new Vector3(Math.random()*.5,Math.random()*360,Math.random()*.5),cp=new Vector3(sp,sp,sp),dp=new Boid;dp.position=lp,dp.rotation=up,dp.scale=cp,this.boids.push(dp)}}update(){this.boids&&(this.boids.forEach(_d=>{_d.maxSpeedAlignment=this.maxSpeedAlignment,_d.maxSpeedCohesion=this.maxSpeedCohesion,_d.maxSpeedSeparation=this.maxSpeedSeparation,_d.maxDistance=this.maxDistance,_d.flock(this.boids)}),this.boids.forEach(_d=>{_d.update()}))}}function FishGroup(rp){const _d=reactExports.useRef(),np=reactExports.useRef(),ap=reactExports.useRef(),sp=reactExports.useRef(),lp=reactExports.useRef();reactExports.useRef();const up=new Object3D,{alignment:cp,cohesion:dp,separation:hp,maxDistance:fp,amount:pp,reset:mp,clownExist:gp,stoneExist:yp,breamExist:xp,blackExist:_p}=rp,vp=reactExports.useRef(new Flock(pp));reactExports.useEffect(()=>{vp.current.maxSpeedAlignment=cp,vp.current.maxSpeedCohesion=dp,vp.current.maxSpeedSeparation=hp,vp.current.maxDistance=fp},[cp,dp,hp,fp]),reactExports.useEffect(()=>{vp.current=new Flock(pp)},[pp,mp]);const bp=()=>{var Sp,Ap;if((_d==null?void 0:_d.current)==null)return;let Ep=0;(Ap=(Sp=vp==null?void 0:vp.current)==null?void 0:Sp.boids)==null||Ap.forEach(Rp=>{const Tp=Ep++,{position:Mp,scale:Op,velocity:Pp}=Rp;up.position.set(Mp.x,Mp.y,Mp.z),up.scale.set(Op.x,Op.y,Op.z),up.lookAt(Mp.x-Pp.x,Mp.y-Pp.y/2,Mp.z-Pp.z),up.updateMatrix(),_d.current.setMatrixAt(Tp,up.matrix),_d.current.instanceMatrix.needsUpdate=!0,np.current.setMatrixAt(Tp,up.matrix),np.current.instanceMatrix.needsUpdate=!0,ap.current.setMatrixAt(Tp,up.matrix),ap.current.instanceMatrix.needsUpdate=!0,sp.current.setMatrixAt(Tp,up.matrix),sp.current.instanceMatrix.needsUpdate=!0,lp.current.setMatrixAt(Tp,up.matrix),lp.current.instanceMatrix.needsUpdate=!0})};return useFrame(()=>{var Ep;(Ep=vp==null?void 0:vp.current)==null||Ep.update(),bp()}),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("group",{...rp,children:[jsxRuntimeExports.jsx(GoldFish,{fishRef:[_d,np,ap,sp,lp],amount:vp.current.boids.length}),gp&&jsxRuntimeExports.jsx(Clownfish,{}),yp&&jsxRuntimeExports.jsx(Stonefish,{}),xp&&jsxRuntimeExports.jsx(SeaBreamfish,{}),_p&&jsxRuntimeExports.jsx(Blackfish,{})]})})}/**
 * postprocessing v6.34.3 build Sat Feb 10 2024
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2024 Raoul van Rschen
 * @license Zlib
 */var common_default="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",BlendFunction={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DepthTestStrategy={DEFAULT:0,KEEP_MAX_DEPTH:1,DISCARD_MAX_DEPTH:2},EffectAttribute={NONE:0,DEPTH:1,CONVOLUTION:2},EffectShaderSection={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},KernelSize={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},revision=Number(REVISION.replace(/\D+/g,"")),useColorSpace=revision>=152,encodingToColorSpace=new Map([[LinearEncoding,LinearSRGBColorSpace],[sRGBEncoding,SRGBColorSpace]]),colorSpaceToEncoding=new Map([[LinearSRGBColorSpace,LinearEncoding],[SRGBColorSpace,sRGBEncoding]]);function getOutputColorSpace(rp){return rp===null?null:useColorSpace?rp.outputColorSpace:encodingToColorSpace.get(rp.outputEncoding)}function setTextureColorSpace(rp,_d){rp!==null&&(useColorSpace?rp.colorSpace=_d:rp.encoding=colorSpaceToEncoding.get(_d))}function updateFragmentShader(rp){return revision<154?rp.replace("colorspace_fragment","encodings_fragment"):rp}var convolution_kawase_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,convolution_kawase_default2="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",kernelPresets=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],KawaseBlurMaterial=class extends ShaderMaterial{constructor(rp=new Vector4){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Uniform(null),texelSize:new Uniform(new Vector4),scale:new Uniform(1),kernel:new Uniform(0)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_kawase_default,vertexShader:convolution_kawase_default2}),this.fragmentShader=updateFragmentShader(this.fragmentShader),this.setTexelSize(rp.x,rp.y),this.kernelSize=KernelSize.MEDIUM}set inputBuffer(rp){this.uniforms.inputBuffer.value=rp}setInputBuffer(rp){this.inputBuffer=rp}get kernelSequence(){return kernelPresets[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(rp){this.uniforms.scale.value=rp}getScale(){return this.uniforms.scale.value}setScale(rp){this.uniforms.scale.value=rp}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(rp){this.uniforms.kernel.value=rp}setKernel(rp){this.kernel=rp}setTexelSize(rp,_d){this.uniforms.texelSize.value.set(rp,_d,rp*.5,_d*.5)}setSize(rp,_d){const np=1/rp,ap=1/_d;this.uniforms.texelSize.value.set(np,ap,np*.5,ap*.5)}},copy_default=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,CopyMaterial=class extends ShaderMaterial{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Uniform(null),opacity:new Uniform(1)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:copy_default,vertexShader:common_default}),this.fragmentShader=updateFragmentShader(this.fragmentShader)}set inputBuffer(rp){this.uniforms.inputBuffer.value=rp}setInputBuffer(rp){this.uniforms.inputBuffer.value=rp}getOpacity(rp){return this.uniforms.opacity.value}setOpacity(rp){this.uniforms.opacity.value=rp}},depth_downsampling_default=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,depth_downsampling_default2="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",DepthDownsamplingMaterial=class extends ShaderMaterial{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Uniform(null),normalBuffer:new Uniform(null),texelSize:new Uniform(new Vector2)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:depth_downsampling_default,vertexShader:depth_downsampling_default2})}set depthBuffer(rp){this.uniforms.depthBuffer.value=rp}set depthPacking(rp){this.defines.DEPTH_PACKING=rp.toFixed(0),this.needsUpdate=!0}setDepthBuffer(rp,_d=BasicDepthPacking){this.depthBuffer=rp,this.depthPacking=_d}set normalBuffer(rp){this.uniforms.normalBuffer.value=rp,rp!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(rp){this.normalBuffer=rp}setTexelSize(rp,_d){this.uniforms.texelSize.value.set(rp,_d)}setSize(rp,_d){this.uniforms.texelSize.value.set(1/rp,1/_d)}},depth_mask_default=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer0;uniform highp sampler2D depthBuffer1;
#else
uniform mediump sampler2D depthBuffer0;uniform mediump sampler2D depthBuffer1;
#endif
uniform sampler2D inputBuffer;uniform vec2 cameraNearFar;float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNearFar.x,cameraNearFar.y);
#else
return orthographicDepthToViewZ(depth,cameraNearFar.x,cameraNearFar.y);
#endif
}varying vec2 vUv;void main(){vec2 depth;
#if DEPTH_PACKING_0 == 3201
depth.x=unpackRGBAToDepth(texture2D(depthBuffer0,vUv));
#else
depth.x=texture2D(depthBuffer0,vUv).r;
#ifdef LOG_DEPTH
float d=pow(2.0,depth.x*log2(cameraNearFar.y+1.0))-1.0;float a=cameraNearFar.y/(cameraNearFar.y-cameraNearFar.x);float b=cameraNearFar.y*cameraNearFar.x/(cameraNearFar.x-cameraNearFar.y);depth.x=a+b/d;
#endif
#endif
#if DEPTH_PACKING_1 == 3201
depth.y=unpackRGBAToDepth(texture2D(depthBuffer1,vUv));
#else
depth.y=texture2D(depthBuffer1,vUv).r;
#ifdef LOG_DEPTH
float d=pow(2.0,depth.y*log2(cameraNearFar.y+1.0))-1.0;float a=cameraNearFar.y/(cameraNearFar.y-cameraNearFar.x);float b=cameraNearFar.y*cameraNearFar.x/(cameraNearFar.x-cameraNearFar.y);depth.y=a+b/d;
#endif
#endif
bool isMaxDepth=(depth.x==1.0);
#ifdef PERSPECTIVE_CAMERA
depth.x=viewZToOrthographicDepth(getViewZ(depth.x),cameraNearFar.x,cameraNearFar.y);depth.y=viewZToOrthographicDepth(getViewZ(depth.y),cameraNearFar.x,cameraNearFar.y);
#endif
#if DEPTH_TEST_STRATEGY == 0
bool keep=depthTest(depth.x,depth.y);
#elif DEPTH_TEST_STRATEGY == 1
bool keep=isMaxDepth||depthTest(depth.x,depth.y);
#else
bool keep=!isMaxDepth&&depthTest(depth.x,depth.y);
#endif
if(keep){gl_FragColor=texture2D(inputBuffer,vUv);}else{discard;}}`,DepthMaskMaterial=class extends ShaderMaterial{constructor(){super({name:"DepthMaskMaterial",defines:{DEPTH_EPSILON:"0.0001",DEPTH_PACKING_0:"0",DEPTH_PACKING_1:"0",DEPTH_TEST_STRATEGY:DepthTestStrategy.KEEP_MAX_DEPTH},uniforms:{inputBuffer:new Uniform(null),depthBuffer0:new Uniform(null),depthBuffer1:new Uniform(null),cameraNearFar:new Uniform(new Vector2(1,1))},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:depth_mask_default,vertexShader:common_default}),this.depthMode=LessDepth}set depthBuffer0(rp){this.uniforms.depthBuffer0.value=rp}set depthPacking0(rp){this.defines.DEPTH_PACKING_0=rp.toFixed(0),this.needsUpdate=!0}setDepthBuffer0(rp,_d=BasicDepthPacking){this.depthBuffer0=rp,this.depthPacking0=_d}set depthBuffer1(rp){this.uniforms.depthBuffer1.value=rp}set depthPacking1(rp){this.defines.DEPTH_PACKING_1=rp.toFixed(0),this.needsUpdate=!0}setDepthBuffer1(rp,_d=BasicDepthPacking){this.depthBuffer1=rp,this.depthPacking1=_d}get maxDepthStrategy(){return Number(this.defines.DEPTH_TEST_STRATEGY)}set maxDepthStrategy(rp){this.defines.DEPTH_TEST_STRATEGY=rp.toFixed(0),this.needsUpdate=!0}get keepFar(){return this.maxDepthStrategy}set keepFar(rp){this.maxDepthStrategy=rp?DepthTestStrategy.KEEP_MAX_DEPTH:DepthTestStrategy.DISCARD_MAX_DEPTH}getMaxDepthStrategy(){return this.maxDepthStrategy}setMaxDepthStrategy(rp){this.maxDepthStrategy=rp}get epsilon(){return Number(this.defines.DEPTH_EPSILON)}set epsilon(rp){this.defines.DEPTH_EPSILON=rp.toFixed(16),this.needsUpdate=!0}getEpsilon(){return this.epsilon}setEpsilon(rp){this.epsilon=rp}get depthMode(){return Number(this.defines.DEPTH_MODE)}set depthMode(rp){let _d;switch(rp){case NeverDepth:_d="false";break;case AlwaysDepth:_d="true";break;case EqualDepth:_d="abs(d1 - d0) <= DEPTH_EPSILON";break;case NotEqualDepth:_d="abs(d1 - d0) > DEPTH_EPSILON";break;case LessDepth:_d="d0 > d1";break;case LessEqualDepth:_d="d0 >= d1";break;case GreaterEqualDepth:_d="d0 <= d1";break;case GreaterDepth:default:_d="d0 < d1";break}this.defines.DEPTH_MODE=rp.toFixed(0),this.defines["depthTest(d0, d1)"]=_d,this.needsUpdate=!0}getDepthMode(){return this.depthMode}setDepthMode(rp){this.depthMode=rp}adoptCameraSettings(rp){this.copyCameraSettings(rp)}copyCameraSettings(rp){rp&&(this.uniforms.cameraNearFar.value.set(rp.near,rp.far),rp instanceof PerspectiveCamera$1?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},effect_default=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,effect_default2="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",EffectMaterial=class extends ShaderMaterial{constructor(rp,_d,np,ap,sp=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:REVISION.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Uniform(null),depthBuffer:new Uniform(null),resolution:new Uniform(new Vector2),texelSize:new Uniform(new Vector2),cameraNear:new Uniform(.3),cameraFar:new Uniform(1e3),aspect:new Uniform(1),time:new Uniform(0)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:sp}),rp&&this.setShaderParts(rp),_d&&this.setDefines(_d),np&&this.setUniforms(np),this.copyCameraSettings(ap)}set inputBuffer(rp){this.uniforms.inputBuffer.value=rp}setInputBuffer(rp){this.uniforms.inputBuffer.value=rp}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(rp){this.uniforms.depthBuffer.value=rp}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(rp){this.defines.DEPTH_PACKING=rp.toFixed(0),this.needsUpdate=!0}setDepthBuffer(rp,_d=BasicDepthPacking){this.depthBuffer=rp,this.depthPacking=_d}setShaderData(rp){this.setShaderParts(rp.shaderParts),this.setDefines(rp.defines),this.setUniforms(rp.uniforms),this.setExtensions(rp.extensions)}setShaderParts(rp){return this.fragmentShader=effect_default.replace(EffectShaderSection.FRAGMENT_HEAD,rp.get(EffectShaderSection.FRAGMENT_HEAD)||"").replace(EffectShaderSection.FRAGMENT_MAIN_UV,rp.get(EffectShaderSection.FRAGMENT_MAIN_UV)||"").replace(EffectShaderSection.FRAGMENT_MAIN_IMAGE,rp.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=effect_default2.replace(EffectShaderSection.VERTEX_HEAD,rp.get(EffectShaderSection.VERTEX_HEAD)||"").replace(EffectShaderSection.VERTEX_MAIN_SUPPORT,rp.get(EffectShaderSection.VERTEX_MAIN_SUPPORT)||""),this.fragmentShader=updateFragmentShader(this.fragmentShader),this.needsUpdate=!0,this}setDefines(rp){for(const _d of rp.entries())this.defines[_d[0]]=_d[1];return this.needsUpdate=!0,this}setUniforms(rp){for(const _d of rp.entries())this.uniforms[_d[0]]=_d[1];return this}setExtensions(rp){this.extensions={};for(const _d of rp)this.extensions[_d]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(rp){this.encodeOutput!==rp&&(rp?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(rp){return this.encodeOutput}setOutputEncodingEnabled(rp){this.encodeOutput=rp}get time(){return this.uniforms.time.value}set time(rp){this.uniforms.time.value=rp}setDeltaTime(rp){this.uniforms.time.value+=rp}adoptCameraSettings(rp){this.copyCameraSettings(rp)}copyCameraSettings(rp){rp&&(this.uniforms.cameraNear.value=rp.near,this.uniforms.cameraFar.value=rp.far,rp instanceof PerspectiveCamera$1?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(rp,_d){const np=this.uniforms;np.resolution.value.set(rp,_d),np.texelSize.value.set(1/rp,1/_d),np.aspect.value=rp/_d}static get Section(){return EffectShaderSection}},convolution_god_rays_default=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform vec2 lightPosition;uniform float exposure;uniform float decay;uniform float density;uniform float weight;uniform float clampMax;varying vec2 vUv;void main(){vec2 coord=vUv;vec2 delta=lightPosition-coord;delta*=1.0/SAMPLES_FLOAT*density;float illuminationDecay=1.0;vec4 color=vec4(0.0);for(int i=0;i<SAMPLES_INT;++i){coord+=delta;vec4 texel=texture2D(inputBuffer,coord);texel*=illuminationDecay*weight;color+=texel;illuminationDecay*=decay;}gl_FragColor=clamp(color*exposure,0.0,clampMax);
#include <dithering_fragment>
}`,GodRaysMaterial=class extends ShaderMaterial{constructor(rp){super({name:"GodRaysMaterial",defines:{SAMPLES_INT:"60",SAMPLES_FLOAT:"60.0"},uniforms:{inputBuffer:new Uniform(null),lightPosition:new Uniform(rp),density:new Uniform(1),decay:new Uniform(1),weight:new Uniform(1),exposure:new Uniform(1),clampMax:new Uniform(1)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_god_rays_default,vertexShader:common_default})}set inputBuffer(rp){this.uniforms.inputBuffer.value=rp}setInputBuffer(rp){this.uniforms.inputBuffer.value=rp}get lightPosition(){return this.uniforms.lightPosition.value}getLightPosition(){return this.uniforms.lightPosition.value}setLightPosition(rp){this.uniforms.lightPosition.value=rp}get density(){return this.uniforms.density.value}set density(rp){this.uniforms.density.value=rp}getDensity(){return this.uniforms.density.value}setDensity(rp){this.uniforms.density.value=rp}get decay(){return this.uniforms.decay.value}set decay(rp){this.uniforms.decay.value=rp}getDecay(){return this.uniforms.decay.value}setDecay(rp){this.uniforms.decay.value=rp}get weight(){return this.uniforms.weight.value}set weight(rp){this.uniforms.weight.value=rp}getWeight(){return this.uniforms.weight.value}setWeight(rp){this.uniforms.weight.value=rp}get exposure(){return this.uniforms.exposure.value}set exposure(rp){this.uniforms.exposure.value=rp}getExposure(){return this.uniforms.exposure.value}setExposure(rp){this.uniforms.exposure.value=rp}get maxIntensity(){return this.uniforms.clampMax.value}set maxIntensity(rp){this.uniforms.clampMax.value=rp}getMaxIntensity(){return this.uniforms.clampMax.value}setMaxIntensity(rp){this.uniforms.clampMax.value=rp}get samples(){return Number(this.defines.SAMPLES_INT)}set samples(rp){const _d=Math.floor(rp);this.defines.SAMPLES_INT=_d.toFixed(0),this.defines.SAMPLES_FLOAT=_d.toFixed(1),this.needsUpdate=!0}getSamples(){return this.samples}setSamples(rp){this.samples=rp}},dummyCamera=new Camera,geometry=null;function getFullscreenTriangle(){if(geometry===null){const rp=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),_d=new Float32Array([0,0,2,0,0,2]);geometry=new BufferGeometry,geometry.setAttribute!==void 0?(geometry.setAttribute("position",new BufferAttribute(rp,3)),geometry.setAttribute("uv",new BufferAttribute(_d,2))):(geometry.addAttribute("position",new BufferAttribute(rp,3)),geometry.addAttribute("uv",new BufferAttribute(_d,2)))}return geometry}var Pass=class EE{constructor(_d="Pass",np=new Scene,ap=dummyCamera){this.name=_d,this.renderer=null,this.scene=np,this.camera=ap,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(_d){if(this.rtt===_d){const np=this.fullscreenMaterial;np!==null&&(np.needsUpdate=!0),this.rtt=!_d}}set mainScene(_d){}set mainCamera(_d){}setRenderer(_d){this.renderer=_d}isEnabled(){return this.enabled}setEnabled(_d){this.enabled=_d}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(_d){let np=this.screen;np!==null?np.material=_d:(np=new Mesh(getFullscreenTriangle(),_d),np.frustumCulled=!1,this.scene===null&&(this.scene=new Scene),this.scene.add(np),this.screen=np)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(_d){this.fullscreenMaterial=_d}getDepthTexture(){return null}setDepthTexture(_d,np=BasicDepthPacking){}render(_d,np,ap,sp,lp){throw new Error("Render method not implemented!")}setSize(_d,np){}initialize(_d,np,ap){}dispose(){for(const _d of Object.keys(this)){const np=this[_d];(np instanceof WebGLRenderTarget||np instanceof Material||np instanceof Texture||np instanceof EE)&&this[_d].dispose()}}},CopyPass=class extends Pass{constructor(rp,_d=!0){super("CopyPass"),this.fullscreenMaterial=new CopyMaterial,this.needsSwap=!1,this.renderTarget=rp,rp===void 0&&(this.renderTarget=new WebGLRenderTarget(1,1,{minFilter:LinearFilter,magFilter:LinearFilter,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=_d}get resize(){return this.autoResize}set resize(rp){this.autoResize=rp}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(rp){this.autoResize=rp}render(rp,_d,np,ap,sp){this.fullscreenMaterial.inputBuffer=_d.texture,rp.setRenderTarget(this.renderToScreen?null:this.renderTarget),rp.render(this.scene,this.camera)}setSize(rp,_d){this.autoResize&&this.renderTarget.setSize(rp,_d)}initialize(rp,_d,np){np!==void 0&&(this.renderTarget.texture.type=np,np!==UnsignedByteType?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":getOutputColorSpace(rp)===SRGBColorSpace&&setTextureColorSpace(this.renderTarget.texture,SRGBColorSpace))}},ClearMaskPass=class extends Pass{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(rp,_d,np,ap,sp){const lp=rp.state.buffers.stencil;lp.setLocked(!1),lp.setTest(!1)}},color=new Color,ClearPass=class extends Pass{constructor(rp=!0,_d=!0,np=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=rp,this.depth=_d,this.stencil=np,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(rp,_d,np){this.color=rp,this.depth=_d,this.stencil=np}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(rp){this.overrideClearColor=rp}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(rp){this.overrideClearAlpha=rp}render(rp,_d,np,ap,sp){const lp=this.overrideClearColor,up=this.overrideClearAlpha,cp=rp.getClearAlpha(),dp=lp!==null,hp=up>=0;dp?(rp.getClearColor(color),rp.setClearColor(lp,hp?up:cp)):hp&&rp.setClearAlpha(up),rp.setRenderTarget(this.renderToScreen?null:_d),rp.clear(this.color,this.depth,this.stencil),dp?rp.setClearColor(color,cp):hp&&rp.setClearAlpha(cp)}},RenderPass=class extends Pass{constructor(rp,_d,np=null){super("RenderPass",rp,_d),this.needsSwap=!1,this.clearPass=new ClearPass,this.overrideMaterialManager=np===null?null:new OverrideMaterialManager(np),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(rp){this.scene=rp}set mainCamera(rp){this.camera=rp}get renderToScreen(){return super.renderToScreen}set renderToScreen(rp){super.renderToScreen=rp,this.clearPass.renderToScreen=rp}get overrideMaterial(){const rp=this.overrideMaterialManager;return rp!==null?rp.material:null}set overrideMaterial(rp){const _d=this.overrideMaterialManager;rp!==null?_d!==null?_d.setMaterial(rp):this.overrideMaterialManager=new OverrideMaterialManager(rp):_d!==null&&(_d.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(rp){this.overrideMaterial=rp}get clear(){return this.clearPass.enabled}set clear(rp){this.clearPass.enabled=rp}getSelection(){return this.selection}setSelection(rp){this.selection=rp}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(rp){this.ignoreBackground=rp}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(rp){this.skipShadowMapUpdate=rp}getClearPass(){return this.clearPass}render(rp,_d,np,ap,sp){const lp=this.scene,up=this.camera,cp=this.selection,dp=up.layers.mask,hp=lp.background,fp=rp.shadowMap.autoUpdate,pp=this.renderToScreen?null:_d;cp!==null&&up.layers.set(cp.getLayer()),this.skipShadowMapUpdate&&(rp.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(lp.background=null),this.clearPass.enabled&&this.clearPass.render(rp,_d),rp.setRenderTarget(pp),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(rp,lp,up):rp.render(lp,up),up.layers.mask=dp,lp.background=hp,rp.shadowMap.autoUpdate=fp}},DepthDownsamplingPass=class extends Pass{constructor({normalBuffer:rp=null,resolutionScale:_d=.5,width:np=Resolution.AUTO_SIZE,height:ap=Resolution.AUTO_SIZE,resolutionX:sp=np,resolutionY:lp=ap}={}){super("DepthDownsamplingPass");const up=new DepthDownsamplingMaterial;up.normalBuffer=rp,this.fullscreenMaterial=up,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new WebGLRenderTarget(1,1,{minFilter:NearestFilter,magFilter:NearestFilter,depthBuffer:!1,type:FloatType}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const cp=this.resolution=new Resolution(this,sp,lp,_d);cp.addEventListener("change",dp=>this.setSize(cp.baseWidth,cp.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(rp,_d=BasicDepthPacking){this.fullscreenMaterial.depthBuffer=rp,this.fullscreenMaterial.depthPacking=_d}render(rp,_d,np,ap,sp){rp.setRenderTarget(this.renderToScreen?null:this.renderTarget),rp.render(this.scene,this.camera)}setSize(rp,_d){const np=this.resolution;np.setBaseSize(rp,_d),this.renderTarget.setSize(np.width,np.height),this.fullscreenMaterial.setSize(rp,_d)}initialize(rp,_d,np){const ap=rp.getContext();if(!(ap.getExtension("EXT_color_buffer_float")||ap.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}};function prefixSubstrings(rp,_d,np){for(const ap of _d){const sp="$1"+rp+ap.charAt(0).toUpperCase()+ap.slice(1),lp=new RegExp("([^\\.])(\\b"+ap+"\\b)","g");for(const up of np.entries())up[1]!==null&&np.set(up[0],up[1].replace(lp,sp))}}function integrateEffect(rp,_d,np){let ap=_d.getFragmentShader(),sp=_d.getVertexShader();const lp=ap!==void 0&&/mainImage/.test(ap),up=ap!==void 0&&/mainUv/.test(ap);if(np.attributes|=_d.getAttributes(),ap===void 0)throw new Error(`Missing fragment shader (${_d.name})`);if(up&&np.attributes&EffectAttribute.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${_d.name})`);if(!lp&&!up)throw new Error(`Could not find mainImage or mainUv function (${_d.name})`);{const cp=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,dp=np.shaderParts;let hp=dp.get(EffectShaderSection.FRAGMENT_HEAD)||"",fp=dp.get(EffectShaderSection.FRAGMENT_MAIN_UV)||"",pp=dp.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE)||"",mp=dp.get(EffectShaderSection.VERTEX_HEAD)||"",gp=dp.get(EffectShaderSection.VERTEX_MAIN_SUPPORT)||"";const yp=new Set,xp=new Set;if(up&&(fp+=`	${rp}MainUv(UV);
`,np.uvTransformation=!0),sp!==null&&/mainSupport/.test(sp)){const bp=/mainSupport *\([\w\s]*?uv\s*?\)/.test(sp);gp+=`	${rp}MainSupport(`,gp+=bp?`vUv);
`:`);
`;for(const Ep of sp.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const Sp of Ep[1].split(/\s*,\s*/))np.varyings.add(Sp),yp.add(Sp),xp.add(Sp);for(const Ep of sp.matchAll(cp))xp.add(Ep[1])}for(const bp of ap.matchAll(cp))xp.add(bp[1]);for(const bp of _d.defines.keys())xp.add(bp.replace(/\([\w\s,]*\)/g,""));for(const bp of _d.uniforms.keys())xp.add(bp);xp.delete("while"),xp.delete("for"),xp.delete("if"),_d.uniforms.forEach((bp,Ep)=>np.uniforms.set(rp+Ep.charAt(0).toUpperCase()+Ep.slice(1),bp)),_d.defines.forEach((bp,Ep)=>np.defines.set(rp+Ep.charAt(0).toUpperCase()+Ep.slice(1),bp));const _p=new Map([["fragment",ap],["vertex",sp]]);prefixSubstrings(rp,xp,np.defines),prefixSubstrings(rp,xp,_p),ap=_p.get("fragment"),sp=_p.get("vertex");const vp=_d.blendMode;if(np.blendModes.set(vp.blendFunction,vp),lp){_d.inputColorSpace!==null&&_d.inputColorSpace!==np.colorSpace&&(pp+=_d.inputColorSpace===SRGBColorSpace?`color0 = LinearTosRGB(color0);
	`:`color0 = sRGBToLinear(color0);
	`),_d.outputColorSpace!==NoColorSpace?np.colorSpace=_d.outputColorSpace:_d.inputColorSpace!==null&&(np.colorSpace=_d.inputColorSpace);const bp=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;pp+=`${rp}MainImage(color0, UV, `,np.attributes&EffectAttribute.DEPTH&&bp.test(ap)&&(pp+="depth, ",np.readDepth=!0),pp+=`color1);
	`;const Ep=rp+"BlendOpacity";np.uniforms.set(Ep,vp.opacity),pp+=`color0 = blend${vp.blendFunction}(color0, color1, ${Ep});

	`,hp+=`uniform float ${Ep};

`}if(hp+=ap+`
`,sp!==null&&(mp+=sp+`
`),dp.set(EffectShaderSection.FRAGMENT_HEAD,hp),dp.set(EffectShaderSection.FRAGMENT_MAIN_UV,fp),dp.set(EffectShaderSection.FRAGMENT_MAIN_IMAGE,pp),dp.set(EffectShaderSection.VERTEX_HEAD,mp),dp.set(EffectShaderSection.VERTEX_MAIN_SUPPORT,gp),_d.extensions!==null)for(const bp of _d.extensions)np.extensions.add(bp)}}var EffectPass=class extends Pass{constructor(rp,..._d){super("EffectPass"),this.fullscreenMaterial=new EffectMaterial(null,null,null,rp),this.listener=np=>this.handleEvent(np),this.effects=[],this.setEffects(_d),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(rp){for(const _d of this.effects)_d.mainScene=rp}set mainCamera(rp){this.fullscreenMaterial.copyCameraSettings(rp);for(const _d of this.effects)_d.mainCamera=rp}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(rp){this.fullscreenMaterial.encodeOutput=rp}get dithering(){return this.fullscreenMaterial.dithering}set dithering(rp){const _d=this.fullscreenMaterial;_d.dithering=rp,_d.needsUpdate=!0}setEffects(rp){for(const _d of this.effects)_d.removeEventListener("change",this.listener);this.effects=rp.sort((_d,np)=>np.attributes-_d.attributes);for(const _d of this.effects)_d.addEventListener("change",this.listener)}updateMaterial(){const rp=new EffectShaderData;let _d=0;for(const up of this.effects)if(up.blendMode.blendFunction===BlendFunction.DST)rp.attributes|=up.getAttributes()&EffectAttribute.DEPTH;else{if(rp.attributes&up.getAttributes()&EffectAttribute.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${up.name})`);integrateEffect("e"+_d++,up,rp)}let np=rp.shaderParts.get(EffectShaderSection.FRAGMENT_HEAD),ap=rp.shaderParts.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE),sp=rp.shaderParts.get(EffectShaderSection.FRAGMENT_MAIN_UV);const lp=/\bblend\b/g;for(const up of rp.blendModes.values())np+=up.getShaderCode().replace(lp,`blend${up.blendFunction}`)+`
`;rp.attributes&EffectAttribute.DEPTH?(rp.readDepth&&(ap=`float depth = readDepth(UV);

	`+ap),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,rp.colorSpace===SRGBColorSpace&&(ap+=`color0 = sRGBToLinear(color0);
	`),rp.uvTransformation?(sp=`vec2 transformedUv = vUv;
`+sp,rp.defines.set("UV","transformedUv")):rp.defines.set("UV","vUv"),rp.shaderParts.set(EffectShaderSection.FRAGMENT_HEAD,np),rp.shaderParts.set(EffectShaderSection.FRAGMENT_MAIN_IMAGE,ap),rp.shaderParts.set(EffectShaderSection.FRAGMENT_MAIN_UV,sp);for(const[up,cp]of rp.shaderParts)cp!==null&&rp.shaderParts.set(up,cp.trim().replace(/^#/,`
#`));this.skipRendering=_d===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(rp)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(rp,_d=BasicDepthPacking){this.fullscreenMaterial.depthBuffer=rp,this.fullscreenMaterial.depthPacking=_d;for(const np of this.effects)np.setDepthTexture(rp,_d)}render(rp,_d,np,ap,sp){for(const lp of this.effects)lp.update(rp,_d,ap);if(!this.skipRendering||this.renderToScreen){const lp=this.fullscreenMaterial;lp.inputBuffer=_d.texture,lp.time+=ap*this.timeScale,rp.setRenderTarget(this.renderToScreen?null:np),rp.render(this.scene,this.camera)}}setSize(rp,_d){this.fullscreenMaterial.setSize(rp,_d);for(const np of this.effects)np.setSize(rp,_d)}initialize(rp,_d,np){this.renderer=rp;for(const ap of this.effects)ap.initialize(rp,_d,np);this.updateMaterial(),np!==void 0&&np!==UnsignedByteType&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const rp of this.effects)rp.removeEventListener("change",this.listener),rp.dispose()}handleEvent(rp){switch(rp.type){case"change":this.recompile();break}}},KawaseBlurPass=class extends Pass{constructor({kernelSize:rp=KernelSize.MEDIUM,resolutionScale:_d=.5,width:np=Resolution.AUTO_SIZE,height:ap=Resolution.AUTO_SIZE,resolutionX:sp=np,resolutionY:lp=ap}={}){super("KawaseBlurPass"),this.renderTargetA=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const up=this.resolution=new Resolution(this,sp,lp,_d);up.addEventListener("change",cp=>this.setSize(up.baseWidth,up.baseHeight)),this._blurMaterial=new KawaseBlurMaterial,this._blurMaterial.kernelSize=rp,this.copyMaterial=new CopyMaterial}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(rp){this._blurMaterial=rp}get dithering(){return this.copyMaterial.dithering}set dithering(rp){this.copyMaterial.dithering=rp}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(rp){this.blurMaterial.kernelSize=rp}get width(){return this.resolution.width}set width(rp){this.resolution.preferredWidth=rp}get height(){return this.resolution.height}set height(rp){this.resolution.preferredHeight=rp}get scale(){return this.blurMaterial.scale}set scale(rp){this.blurMaterial.scale=rp}getScale(){return this.blurMaterial.scale}setScale(rp){this.blurMaterial.scale=rp}getKernelSize(){return this.kernelSize}setKernelSize(rp){this.kernelSize=rp}getResolutionScale(){return this.resolution.scale}setResolutionScale(rp){this.resolution.scale=rp}render(rp,_d,np,ap,sp){const lp=this.scene,up=this.camera,cp=this.renderTargetA,dp=this.renderTargetB,hp=this.blurMaterial,fp=hp.kernelSequence;let pp=_d;this.fullscreenMaterial=hp;for(let mp=0,gp=fp.length;mp<gp;++mp){const yp=mp&1?dp:cp;hp.kernel=fp[mp],hp.inputBuffer=pp.texture,rp.setRenderTarget(yp),rp.render(lp,up),pp=yp}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=pp.texture,rp.setRenderTarget(this.renderToScreen?null:np),rp.render(lp,up)}setSize(rp,_d){const np=this.resolution;np.setBaseSize(rp,_d);const ap=np.width,sp=np.height;this.renderTargetA.setSize(ap,sp),this.renderTargetB.setSize(ap,sp),this.blurMaterial.setSize(rp,_d)}initialize(rp,_d,np){np!==void 0&&(this.renderTargetA.texture.type=np,this.renderTargetB.texture.type=np,np!==UnsignedByteType?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):getOutputColorSpace(rp)===SRGBColorSpace&&(setTextureColorSpace(this.renderTargetA.texture,SRGBColorSpace),setTextureColorSpace(this.renderTargetB.texture,SRGBColorSpace)))}static get AUTO_SIZE(){return Resolution.AUTO_SIZE}},MaskPass=class extends Pass{constructor(rp,_d){super("MaskPass",rp,_d),this.needsSwap=!1,this.clearPass=new ClearPass(!1,!1,!0),this.inverse=!1}set mainScene(rp){this.scene=rp}set mainCamera(rp){this.camera=rp}get inverted(){return this.inverse}set inverted(rp){this.inverse=rp}get clear(){return this.clearPass.enabled}set clear(rp){this.clearPass.enabled=rp}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(rp){this.inverted=rp}render(rp,_d,np,ap,sp){const lp=rp.getContext(),up=rp.state.buffers,cp=this.scene,dp=this.camera,hp=this.clearPass,fp=this.inverted?0:1,pp=1-fp;up.color.setMask(!1),up.depth.setMask(!1),up.color.setLocked(!0),up.depth.setLocked(!0),up.stencil.setTest(!0),up.stencil.setOp(lp.REPLACE,lp.REPLACE,lp.REPLACE),up.stencil.setFunc(lp.ALWAYS,fp,4294967295),up.stencil.setClear(pp),up.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?hp.render(rp,null):(hp.render(rp,_d),hp.render(rp,np))),this.renderToScreen?(rp.setRenderTarget(null),rp.render(cp,dp)):(rp.setRenderTarget(_d),rp.render(cp,dp),rp.setRenderTarget(np),rp.render(cp,dp)),up.color.setLocked(!1),up.depth.setLocked(!1),up.stencil.setLocked(!1),up.stencil.setFunc(lp.EQUAL,1,4294967295),up.stencil.setOp(lp.KEEP,lp.KEEP,lp.KEEP),up.stencil.setLocked(!0)}},NormalPass=class extends Pass{constructor(rp,_d,{renderTarget:np,resolutionScale:ap=1,width:sp=Resolution.AUTO_SIZE,height:lp=Resolution.AUTO_SIZE,resolutionX:up=sp,resolutionY:cp=lp}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new RenderPass(rp,_d,new MeshNormalMaterial);const dp=this.renderPass;dp.ignoreBackground=!0,dp.skipShadowMapUpdate=!0;const hp=dp.getClearPass();hp.overrideClearColor=new Color(7829503),hp.overrideClearAlpha=1,this.renderTarget=np,this.renderTarget===void 0&&(this.renderTarget=new WebGLRenderTarget(1,1,{minFilter:NearestFilter,magFilter:NearestFilter}),this.renderTarget.texture.name="NormalPass.Target");const fp=this.resolution=new Resolution(this,up,cp,ap);fp.addEventListener("change",pp=>this.setSize(fp.baseWidth,fp.baseHeight))}set mainScene(rp){this.renderPass.mainScene=rp}set mainCamera(rp){this.renderPass.mainCamera=rp}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(rp){this.resolution.scale=rp}render(rp,_d,np,ap,sp){const lp=this.renderToScreen?null:this.renderTarget;this.renderPass.render(rp,lp,lp)}setSize(rp,_d){const np=this.resolution;np.setBaseSize(rp,_d),this.renderTarget.setSize(np.width,np.height)}},ShaderPass=class extends Pass{constructor(rp,_d="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=rp,this.input=_d}setInput(rp){this.input=rp}render(rp,_d,np,ap,sp){const lp=this.fullscreenMaterial.uniforms;_d!==null&&lp!==void 0&&lp[this.input]!==void 0&&(lp[this.input].value=_d.texture),rp.setRenderTarget(this.renderToScreen?null:np),rp.render(this.scene,this.camera)}initialize(rp,_d,np){np!==void 0&&np!==UnsignedByteType&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},MILLISECONDS_TO_SECONDS=1/1e3,SECONDS_TO_MILLISECONDS=1e3,Timer=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(rp){typeof document<"u"&&document.hidden!==void 0&&(rp?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=rp)}get delta(){return this._delta*MILLISECONDS_TO_SECONDS}get fixedDelta(){return this._fixedDelta*MILLISECONDS_TO_SECONDS}set fixedDelta(rp){this._fixedDelta=rp*SECONDS_TO_MILLISECONDS}get elapsed(){return this._elapsed*MILLISECONDS_TO_SECONDS}update(rp){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(rp!==void 0?rp:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}handleEvent(rp){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},EffectComposer$1=class{constructor(_d=null,{depthBuffer:np=!0,stencilBuffer:ap=!1,multisampling:sp=0,frameBufferType:lp}={}){this.renderer=null,this.inputBuffer=this.createBuffer(np,ap,lp,sp),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new CopyPass,this.depthTexture=null,this.passes=[],this.timer=new Timer,this.autoRenderToScreen=!0,this.setRenderer(_d)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(_d){const np=this.inputBuffer,ap=this.multisampling;ap>0&&_d>0?(this.inputBuffer.samples=_d,this.outputBuffer.samples=_d,this.inputBuffer.dispose(),this.outputBuffer.dispose()):ap!==_d&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(np.depthBuffer,np.stencilBuffer,np.texture.type,_d),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(_d){if(this.renderer=_d,_d!==null){const np=_d.getSize(new Vector2),ap=_d.getContext().getContextAttributes().alpha,sp=this.inputBuffer.texture.type;sp===UnsignedByteType&&getOutputColorSpace(_d)===SRGBColorSpace&&(setTextureColorSpace(this.inputBuffer.texture,SRGBColorSpace),setTextureColorSpace(this.outputBuffer.texture,SRGBColorSpace),this.inputBuffer.dispose(),this.outputBuffer.dispose()),_d.autoClear=!1,this.setSize(np.width,np.height);for(const lp of this.passes)lp.initialize(_d,ap,sp)}}replaceRenderer(_d,np=!0){const ap=this.renderer,sp=ap.domElement.parentNode;return this.setRenderer(_d),np&&sp!==null&&(sp.removeChild(ap.domElement),sp.appendChild(_d.domElement)),ap}createDepthTexture(){const _d=this.depthTexture=new DepthTexture;return this.inputBuffer.depthTexture=_d,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(_d.format=DepthStencilFormat,_d.type=UnsignedInt248Type):_d.type=UnsignedIntType,_d}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const _d of this.passes)_d.setDepthTexture(null)}}createBuffer(_d,np,ap,sp){const lp=this.renderer,up=lp===null?new Vector2:lp.getDrawingBufferSize(new Vector2),cp={minFilter:LinearFilter,magFilter:LinearFilter,stencilBuffer:np,depthBuffer:_d,type:ap},dp=new WebGLRenderTarget(up.width,up.height,cp);return sp>0&&(dp.ignoreDepthForMultisampleCopy=!1,dp.samples=sp),ap===UnsignedByteType&&getOutputColorSpace(lp)===SRGBColorSpace&&setTextureColorSpace(dp.texture,SRGBColorSpace),dp.texture.name="EffectComposer.Buffer",dp.texture.generateMipmaps=!1,dp}setMainScene(_d){for(const np of this.passes)np.mainScene=_d}setMainCamera(_d){for(const np of this.passes)np.mainCamera=_d}addPass(_d,np){const ap=this.passes,sp=this.renderer,lp=sp.getDrawingBufferSize(new Vector2),up=sp.getContext().getContextAttributes().alpha,cp=this.inputBuffer.texture.type;if(_d.setRenderer(sp),_d.setSize(lp.width,lp.height),_d.initialize(sp,up,cp),this.autoRenderToScreen&&(ap.length>0&&(ap[ap.length-1].renderToScreen=!1),_d.renderToScreen&&(this.autoRenderToScreen=!1)),np!==void 0?ap.splice(np,0,_d):ap.push(_d),this.autoRenderToScreen&&(ap[ap.length-1].renderToScreen=!0),_d.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const dp=this.createDepthTexture();for(_d of ap)_d.setDepthTexture(dp)}else _d.setDepthTexture(this.depthTexture)}removePass(_d){const np=this.passes,ap=np.indexOf(_d);if(ap!==-1&&np.splice(ap,1).length>0){if(this.depthTexture!==null){const up=(dp,hp)=>dp||hp.needsDepthTexture;np.reduce(up,!1)||(_d.getDepthTexture()===this.depthTexture&&_d.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&ap===np.length&&(_d.renderToScreen=!1,np.length>0&&(np[np.length-1].renderToScreen=!0))}}removeAllPasses(){const _d=this.passes;this.deleteDepthTexture(),_d.length>0&&(this.autoRenderToScreen&&(_d[_d.length-1].renderToScreen=!1),this.passes=[])}render(_d){const np=this.renderer,ap=this.copyPass;let sp=this.inputBuffer,lp=this.outputBuffer,up=!1,cp,dp,hp;_d===void 0&&(this.timer.update(),_d=this.timer.delta);for(const fp of this.passes)fp.enabled&&(fp.render(np,sp,lp,_d,up),fp.needsSwap&&(up&&(ap.renderToScreen=fp.renderToScreen,cp=np.getContext(),dp=np.state.buffers.stencil,dp.setFunc(cp.NOTEQUAL,1,4294967295),ap.render(np,sp,lp,_d,up),dp.setFunc(cp.EQUAL,1,4294967295)),hp=sp,sp=lp,lp=hp),fp instanceof MaskPass?up=!0:fp instanceof ClearMaskPass&&(up=!1))}setSize(_d,np,ap){const sp=this.renderer,lp=sp.getSize(new Vector2);(_d===void 0||np===void 0)&&(_d=lp.width,np=lp.height),(lp.width!==_d||lp.height!==np)&&sp.setSize(_d,np,ap);const up=sp.getDrawingBufferSize(new Vector2);this.inputBuffer.setSize(up.width,up.height),this.outputBuffer.setSize(up.width,up.height);for(const cp of this.passes)cp.setSize(up.width,up.height)}reset(){const _d=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=_d}dispose(){for(const _d of this.passes)_d.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},EffectShaderData=class{constructor(){this.shaderParts=new Map([[EffectShaderSection.FRAGMENT_HEAD,null],[EffectShaderSection.FRAGMENT_MAIN_UV,null],[EffectShaderSection.FRAGMENT_MAIN_IMAGE,null],[EffectShaderSection.VERTEX_HEAD,null],[EffectShaderSection.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=EffectAttribute.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=LinearSRGBColorSpace}},workaroundEnabled=!1,OverrideMaterialManager=class{constructor(rp=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(rp),this.meshCount=0,this.replaceMaterial=_d=>{if(_d.isMesh){let np;if(_d.material.flatShading)switch(_d.material.side){case DoubleSide:np=this.materialsFlatShadedDoubleSide;break;case BackSide:np=this.materialsFlatShadedBackSide;break;default:np=this.materialsFlatShaded;break}else switch(_d.material.side){case DoubleSide:np=this.materialsDoubleSide;break;case BackSide:np=this.materialsBackSide;break;default:np=this.materials;break}this.originalMaterials.set(_d,_d.material),_d.isSkinnedMesh?_d.material=np[2]:_d.isInstancedMesh?_d.material=np[1]:_d.material=np[0],++this.meshCount}}}cloneMaterial(rp){if(!(rp instanceof ShaderMaterial))return rp.clone();const _d=rp.uniforms,np=new Map;for(const sp in _d){const lp=_d[sp].value;lp.isRenderTargetTexture&&(_d[sp].value=null,np.set(sp,lp))}const ap=rp.clone();for(const sp of np)_d[sp[0]].value=sp[1],ap.uniforms[sp[0]].value=sp[1];return ap}setMaterial(rp){if(this.disposeMaterials(),this.material=rp,rp!==null){const _d=this.materials=[this.cloneMaterial(rp),this.cloneMaterial(rp),this.cloneMaterial(rp)];for(const np of _d)np.uniforms=Object.assign({},rp.uniforms),np.side=FrontSide;_d[2].skinning=!0,this.materialsBackSide=_d.map(np=>{const ap=this.cloneMaterial(np);return ap.uniforms=Object.assign({},rp.uniforms),ap.side=BackSide,ap}),this.materialsDoubleSide=_d.map(np=>{const ap=this.cloneMaterial(np);return ap.uniforms=Object.assign({},rp.uniforms),ap.side=DoubleSide,ap}),this.materialsFlatShaded=_d.map(np=>{const ap=this.cloneMaterial(np);return ap.uniforms=Object.assign({},rp.uniforms),ap.flatShading=!0,ap}),this.materialsFlatShadedBackSide=_d.map(np=>{const ap=this.cloneMaterial(np);return ap.uniforms=Object.assign({},rp.uniforms),ap.flatShading=!0,ap.side=BackSide,ap}),this.materialsFlatShadedDoubleSide=_d.map(np=>{const ap=this.cloneMaterial(np);return ap.uniforms=Object.assign({},rp.uniforms),ap.flatShading=!0,ap.side=DoubleSide,ap})}}render(rp,_d,np){const ap=rp.shadowMap.enabled;if(rp.shadowMap.enabled=!1,workaroundEnabled){const sp=this.originalMaterials;this.meshCount=0,_d.traverse(this.replaceMaterial),rp.render(_d,np);for(const lp of sp)lp[0].material=lp[1];this.meshCount!==sp.size&&sp.clear()}else{const sp=_d.overrideMaterial;_d.overrideMaterial=this.material,rp.render(_d,np),_d.overrideMaterial=sp}rp.shadowMap.enabled=ap}disposeMaterials(){if(this.material!==null){const rp=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const _d of rp)_d.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return workaroundEnabled}static set workaroundEnabled(rp){workaroundEnabled=rp}},AUTO_SIZE=-1,Resolution=class extends EventDispatcher{constructor(rp,_d=AUTO_SIZE,np=AUTO_SIZE,ap=1){super(),this.resizable=rp,this.baseSize=new Vector2(1,1),this.preferredSize=new Vector2(_d,np),this.target=this.preferredSize,this.s=ap,this.effectiveSize=new Vector2,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const rp=this.baseSize,_d=this.preferredSize,np=this.effectiveSize,ap=this.scale;_d.width!==AUTO_SIZE?np.width=_d.width:_d.height!==AUTO_SIZE?np.width=Math.round(_d.height*(rp.width/Math.max(rp.height,1))):np.width=Math.round(rp.width*ap),_d.height!==AUTO_SIZE?np.height=_d.height:_d.width!==AUTO_SIZE?np.height=Math.round(_d.width/Math.max(rp.width/Math.max(rp.height,1),1)):np.height=Math.round(rp.height*ap)}get width(){return this.effectiveSize.width}set width(rp){this.preferredWidth=rp}get height(){return this.effectiveSize.height}set height(rp){this.preferredHeight=rp}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(rp){this.s!==rp&&(this.s=rp,this.preferredSize.setScalar(AUTO_SIZE),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(rp){this.scale=rp}get baseWidth(){return this.baseSize.width}set baseWidth(rp){this.baseSize.width!==rp&&(this.baseSize.width=rp,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(rp){this.baseWidth=rp}get baseHeight(){return this.baseSize.height}set baseHeight(rp){this.baseSize.height!==rp&&(this.baseSize.height=rp,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(rp){this.baseHeight=rp}setBaseSize(rp,_d){(this.baseSize.width!==rp||this.baseSize.height!==_d)&&(this.baseSize.set(rp,_d),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(rp){this.preferredSize.width!==rp&&(this.preferredSize.width=rp,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(rp){this.preferredWidth=rp}get preferredHeight(){return this.preferredSize.height}set preferredHeight(rp){this.preferredSize.height!==rp&&(this.preferredSize.height=rp,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(rp){this.preferredHeight=rp}setPreferredSize(rp,_d){(this.preferredSize.width!==rp||this.preferredSize.height!==_d)&&(this.preferredSize.set(rp,_d),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(rp){this.s=rp.scale,this.baseSize.set(rp.baseWidth,rp.baseHeight),this.preferredSize.set(rp.preferredWidth,rp.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return AUTO_SIZE}},add_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",alpha_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",average_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",color_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",color_burn_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",color_dodge_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",darken_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",difference_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",divide_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",exclusion_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",hard_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",hard_mix_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",hue_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",invert_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",invert_rgb_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",lighten_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",linear_burn_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",linear_dodge_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",linear_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",luminosity_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",multiply_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",negation_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",normal_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",overlay_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",pin_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",reflect_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",saturation_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",screen_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",soft_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",src_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",subtract_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",vivid_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",blendFunctions=new Map([[BlendFunction.ADD,add_default],[BlendFunction.ALPHA,alpha_default],[BlendFunction.AVERAGE,average_default],[BlendFunction.COLOR,color_default],[BlendFunction.COLOR_BURN,color_burn_default],[BlendFunction.COLOR_DODGE,color_dodge_default],[BlendFunction.DARKEN,darken_default],[BlendFunction.DIFFERENCE,difference_default],[BlendFunction.DIVIDE,divide_default],[BlendFunction.DST,null],[BlendFunction.EXCLUSION,exclusion_default],[BlendFunction.HARD_LIGHT,hard_light_default],[BlendFunction.HARD_MIX,hard_mix_default],[BlendFunction.HUE,hue_default],[BlendFunction.INVERT,invert_default],[BlendFunction.INVERT_RGB,invert_rgb_default],[BlendFunction.LIGHTEN,lighten_default],[BlendFunction.LINEAR_BURN,linear_burn_default],[BlendFunction.LINEAR_DODGE,linear_dodge_default],[BlendFunction.LINEAR_LIGHT,linear_light_default],[BlendFunction.LUMINOSITY,luminosity_default],[BlendFunction.MULTIPLY,multiply_default],[BlendFunction.NEGATION,negation_default],[BlendFunction.NORMAL,normal_default],[BlendFunction.OVERLAY,overlay_default],[BlendFunction.PIN_LIGHT,pin_light_default],[BlendFunction.REFLECT,reflect_default],[BlendFunction.SATURATION,saturation_default],[BlendFunction.SCREEN,screen_default],[BlendFunction.SOFT_LIGHT,soft_light_default],[BlendFunction.SRC,src_default],[BlendFunction.SUBTRACT,subtract_default],[BlendFunction.VIVID_LIGHT,vivid_light_default]]),BlendMode=class extends EventDispatcher{constructor(rp,_d=1){super(),this._blendFunction=rp,this.opacity=new Uniform(_d)}getOpacity(){return this.opacity.value}setOpacity(rp){this.opacity.value=rp}get blendFunction(){return this._blendFunction}set blendFunction(rp){this._blendFunction=rp,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(rp){this.blendFunction=rp}getShaderCode(){return blendFunctions.get(this.blendFunction)}},Effect=class extends EventDispatcher{constructor(rp,_d,{attributes:np=EffectAttribute.NONE,blendFunction:ap=BlendFunction.NORMAL,defines:sp=new Map,uniforms:lp=new Map,extensions:up=null,vertexShader:cp=null}={}){super(),this.name=rp,this.renderer=null,this.attributes=np,this.fragmentShader=_d,this.vertexShader=cp,this.defines=sp,this.uniforms=lp,this.extensions=up,this.blendMode=new BlendMode(ap),this.blendMode.addEventListener("change",dp=>this.setChanged()),this._inputColorSpace=LinearSRGBColorSpace,this._outputColorSpace=NoColorSpace}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(rp){this._inputColorSpace=rp,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(rp){this._outputColorSpace=rp,this.setChanged()}set mainScene(rp){}set mainCamera(rp){}getName(){return this.name}setRenderer(rp){this.renderer=rp}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(rp){this.attributes=rp,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(rp){this.fragmentShader=rp,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(rp){this.vertexShader=rp,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(rp,_d=BasicDepthPacking){}update(rp,_d,np){}setSize(rp,_d){}initialize(rp,_d,np){}dispose(){for(const rp of Object.keys(this)){const _d=this[rp];(_d instanceof WebGLRenderTarget||_d instanceof Material||_d instanceof Texture||_d instanceof Pass)&&this[rp].dispose()}}},god_rays_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=texture2D(map,uv);}`,v=new Vector3,m=new Matrix4,GodRaysEffect=class extends Effect{constructor(rp,_d,{blendFunction:np=BlendFunction.SCREEN,samples:ap=60,density:sp=.96,decay:lp=.9,weight:up=.4,exposure:cp=.6,clampMax:dp=1,blur:hp=!0,kernelSize:fp=KernelSize.SMALL,resolutionScale:pp=.5,width:mp=Resolution.AUTO_SIZE,height:gp=Resolution.AUTO_SIZE,resolutionX:yp=mp,resolutionY:xp=gp}={}){super("GodRaysEffect",god_rays_default,{blendFunction:np,attributes:EffectAttribute.DEPTH,uniforms:new Map([["map",new Uniform(null)]])}),this.camera=rp,this._lightSource=_d,this.lightSource=_d,this.lightScene=new Scene,this.screenPosition=new Vector2,this.renderTargetA=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="GodRays.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="GodRays.Target.B",this.uniforms.get("map").value=this.renderTargetB.texture,this.renderTargetLight=new WebGLRenderTarget(1,1),this.renderTargetLight.texture.name="GodRays.Light",this.renderTargetLight.depthTexture=new DepthTexture,this.renderPassLight=new RenderPass(this.lightScene,rp),this.renderPassLight.clearPass.overrideClearColor=new Color(0),this.clearPass=new ClearPass(!0,!1,!1),this.clearPass.overrideClearColor=new Color(0),this.blurPass=new KawaseBlurPass({kernelSize:fp}),this.blurPass.enabled=hp,this.depthMaskPass=new ShaderPass(new DepthMaskMaterial);const _p=this.depthMaskMaterial;_p.depthBuffer1=this.renderTargetLight.depthTexture,_p.copyCameraSettings(rp),this.godRaysPass=new ShaderPass(new GodRaysMaterial(this.screenPosition));const vp=this.godRaysMaterial;vp.density=sp,vp.decay=lp,vp.weight=up,vp.exposure=cp,vp.maxIntensity=dp,vp.samples=ap;const bp=this.resolution=new Resolution(this,yp,xp,pp);bp.addEventListener("change",Ep=>this.setSize(bp.baseWidth,bp.baseHeight))}set mainCamera(rp){this.camera=rp,this.renderPassLight.mainCamera=rp,this.depthMaskMaterial.copyCameraSettings(rp)}get lightSource(){return this._lightSource}set lightSource(rp){this._lightSource=rp,rp!==null&&(rp.material.depthWrite=!1,rp.material.transparent=!0)}getBlurPass(){return this.blurPass}get texture(){return this.renderTargetB.texture}getTexture(){return this.texture}get depthMaskMaterial(){return this.depthMaskPass.fullscreenMaterial}get godRaysMaterial(){return this.godRaysPass.fullscreenMaterial}getGodRaysMaterial(){return this.godRaysMaterial}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(rp){this.resolution.preferredWidth=rp}get height(){return this.resolution.height}set height(rp){this.resolution.preferredHeight=rp}get dithering(){return this.godRaysMaterial.dithering}set dithering(rp){const _d=this.godRaysMaterial;_d.dithering=rp,_d.needsUpdate=!0}get blur(){return this.blurPass.enabled}set blur(rp){this.blurPass.enabled=rp}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(rp){this.blurPass.kernelSize=rp}getResolutionScale(){return this.resolution.scale}setResolutionScale(rp){this.resolution.scale=rp}get samples(){return this.godRaysMaterial.samples}set samples(rp){this.godRaysMaterial.samples=rp}setDepthTexture(rp,_d=BasicDepthPacking){this.depthMaskPass.fullscreenMaterial.depthBuffer0=rp,this.depthMaskPass.fullscreenMaterial.depthPacking0=_d}update(rp,_d,np){const ap=this.lightSource,sp=ap.parent,lp=ap.matrixAutoUpdate,up=this.renderTargetA,cp=this.renderTargetLight;ap.material.depthWrite=!0,ap.matrixAutoUpdate=!1,ap.updateWorldMatrix(!0,!1),sp!==null&&(lp||m.copy(ap.matrix),ap.matrix.copy(ap.matrixWorld)),this.lightScene.add(ap),this.renderPassLight.render(rp,cp),this.clearPass.render(rp,up),this.depthMaskPass.render(rp,cp,up),ap.material.depthWrite=!1,ap.matrixAutoUpdate=lp,sp!==null&&(lp||ap.matrix.copy(m),sp.add(ap)),v.setFromMatrixPosition(ap.matrixWorld).project(this.camera),this.screenPosition.set(Math.min(Math.max((v.x+1)*.5,-1),2),Math.min(Math.max((v.y+1)*.5,-1),2)),this.blurPass.enabled&&this.blurPass.render(rp,up,up),this.godRaysPass.render(rp,up,this.renderTargetB)}setSize(rp,_d){const np=this.resolution;np.setBaseSize(rp,_d);const ap=np.width,sp=np.height;this.renderTargetA.setSize(ap,sp),this.renderTargetB.setSize(ap,sp),this.renderTargetLight.setSize(ap,sp),this.blurPass.resolution.copy(np)}initialize(rp,_d,np){this.blurPass.initialize(rp,_d,np),this.renderPassLight.initialize(rp,_d,np),this.depthMaskPass.initialize(rp,_d,np),this.godRaysPass.initialize(rp,_d,np),np!==void 0&&(this.renderTargetA.texture.type=np,this.renderTargetB.texture.type=np,this.renderTargetLight.texture.type=np,getOutputColorSpace(rp)===SRGBColorSpace&&(setTextureColorSpace(this.renderTargetA.texture,SRGBColorSpace),setTextureColorSpace(this.renderTargetB.texture,SRGBColorSpace),setTextureColorSpace(this.renderTargetLight.texture,SRGBColorSpace)))}};const EffectComposerContext=reactExports.createContext(null),isConvolution=rp=>(rp.getAttributes()&EffectAttribute.CONVOLUTION)===EffectAttribute.CONVOLUTION,EffectComposer=React.memo(reactExports.forwardRef(({children:rp,camera:_d,scene:np,resolutionScale:ap,enabled:sp=!0,renderPriority:lp=1,autoClear:up=!0,depthBuffer:cp,disableNormalPass:dp,stencilBuffer:hp,multisampling:fp=8,frameBufferType:pp=HalfFloatType},mp)=>{const{gl:gp,scene:yp,camera:xp,size:_p}=useThree(),vp=np||yp,bp=_d||xp,[Ep,Sp,Ap]=reactExports.useMemo(()=>{const Op=isWebGL2Available(),Pp=new EffectComposer$1(gp,{depthBuffer:cp,stencilBuffer:hp,multisampling:fp>0&&Op?fp:0,frameBufferType:pp});Pp.addPass(new RenderPass(vp,bp));let $p=null,zp=null;return dp||(zp=new NormalPass(vp,bp),zp.enabled=!1,Pp.addPass(zp),ap!==void 0&&Op&&($p=new DepthDownsamplingPass({normalBuffer:zp.texture,resolutionScale:ap}),$p.enabled=!1,Pp.addPass($p))),[Pp,zp,$p]},[bp,gp,cp,hp,fp,pp,vp,dp,ap]);reactExports.useEffect(()=>Ep==null?void 0:Ep.setSize(_p.width,_p.height),[Ep,_p]),useFrame((Op,Pp)=>{if(sp){const $p=gp.autoClear;gp.autoClear=up,hp&&!up&&gp.clearStencil(),Ep.render(Pp),gp.autoClear=$p}},sp?lp:0);const Rp=reactExports.useRef(null),Tp=useInstanceHandle(Rp);reactExports.useLayoutEffect(()=>{const Op=[];if(Rp.current&&Tp.current&&Ep){const Pp=Tp.current.objects;for(let $p=0;$p<Pp.length;$p++){const zp=Pp[$p];if(zp instanceof Effect){const Dp=[zp];if(!isConvolution(zp)){let jp=null;for(;(jp=Pp[$p+1])instanceof Effect&&!isConvolution(jp);)Dp.push(jp),$p++}const Fp=new EffectPass(bp,...Dp);Op.push(Fp)}else zp instanceof Pass&&Op.push(zp)}for(const $p of Op)Ep==null||Ep.addPass($p);Sp&&(Sp.enabled=!0),Ap&&(Ap.enabled=!0)}return()=>{for(const Pp of Op)Ep==null||Ep.removePass(Pp);Sp&&(Sp.enabled=!1),Ap&&(Ap.enabled=!1)}},[Ep,rp,bp,Sp,Ap,Tp]);const Mp=reactExports.useMemo(()=>({composer:Ep,normalPass:Sp,downSamplingPass:Ap,resolutionScale:ap,camera:bp,scene:vp}),[Ep,Sp,Ap,ap,bp,vp]);return reactExports.useImperativeHandle(mp,()=>Ep,[Ep]),jsxRuntimeExports.jsx(EffectComposerContext.Provider,{value:Mp,children:jsxRuntimeExports.jsx("group",{ref:Rp,children:rp})})})),resolveRef=rp=>typeof rp=="object"&&rp!=null&&"current"in rp?rp.current:rp,GodRays=reactExports.forwardRef(function rp(_d,np){const{camera:ap}=reactExports.useContext(EffectComposerContext),sp=reactExports.useMemo(()=>new GodRaysEffect(ap,resolveRef(_d.sun),_d),[ap,_d]);return reactExports.useLayoutEffect(()=>void(sp.lightSource=resolveRef(_d.sun)),[sp,_d.sun]),jsxRuntimeExports.jsx("primitive",{ref:np,object:sp,dispose:null})});function Underwater(rp){const{nodes:_d,materials:np}=useGLTF("/underwater.glb");return jsxRuntimeExports.jsx("group",{...rp,dispose:null,children:jsxRuntimeExports.jsx("group",{children:jsxRuntimeExports.jsxs("group",{rotation:[-Math.PI,0,0],children:[jsxRuntimeExports.jsx("primitive",{object:_d._rootJoint}),jsxRuntimeExports.jsxs("group",{position:[-.088,.4,1.677],scale:1,children:[jsxRuntimeExports.jsx("mesh",{geometry:_d.Large_rock_05_Assets_Texture_0.geometry,material:np.Assets_Texture,scale:.6}),jsxRuntimeExports.jsx("mesh",{geometry:_d.Large_rock_05_Sand_Texture_0.geometry,material:np.Sand_Texture})]})]})})})}useGLTF.preload("/underwater.glb");const FishTankScene=({alignment:rp,cohesion:_d,separation:np,maxDistance:ap,amountOfFish:sp,reset:lp,hasPostProcessing:up,environment:cp,clownExist:dp,stoneExist:hp,breamExist:fp,blackExist:pp})=>{const mp=reactExports.useRef(),gp=new Mesh(new CylinderGeometry(.6,.6,3,20),new MeshBasicMaterial({color:"#CC8C39",transparent:!0,opacity:.5})),yp=new Mesh(new SphereGeometry(.5,.5,3,20),new MeshBasicMaterial({color:"#CC8C39",transparent:!0,opacity:1})),xp=()=>{const vp=reactExports.useRef();return useFrame((bp,Ep)=>{vp.current&&(vp.current.position.x=Math.sin(bp.clock.elapsedTime)*2,vp.current.position.y=Math.sin(bp.clock.elapsedTime*1.5),vp.current.rotation.x+=.01,vp.current.rotation.y+=.01)}),jsxRuntimeExports.jsx(Box,{ref:vp,position:[0,0,0],args:[1,1,1],children:jsxRuntimeExports.jsx("meshStandardMaterial",{attach:"material",color:"aquamarine"})})},_p=40;return jsxRuntimeExports.jsxs(Canvas,{className:"threeCanvas",shadows:"soft",children:[jsxRuntimeExports.jsx(xp,{}),jsxRuntimeExports.jsx("directionalLight",{castShadow:!0,position:[10,10,10],intensity:2,"shadow-camera-left":-_p,"shadow-camera-right":_p,"shadow-camera-bottom":_p,"shadow-camera-top":-_p,"shadow-mapSize-height":400,"shadow-mapSize-width":400,"shadow-bias":-.001}),jsxRuntimeExports.jsx(Underwater,{position:[5,-27,0],rotation:[Math.PI/2,0,11],scale:1.5}),jsxRuntimeExports.jsx(SeaWeed,{scale:[3,4.3,3],position:[6,-25,0],rotation:[0,3,0]}),jsxRuntimeExports.jsx(SeaWeed,{scale:[4,4,4],position:[10,-25,6]}),jsxRuntimeExports.jsx(SeaWeed,{scale:[4,4.5,4],position:[-15,-25,-10]}),jsxRuntimeExports.jsx(SeaWeed,{scale:[4,4.5,4],position:[-12,-25,-11]}),jsxRuntimeExports.jsx(SeaWeed,{scale:[4,4.5,4],position:[-15,-25,-0],rotation:[-.1,1.3,0]}),jsxRuntimeExports.jsx(SeaWeed,{scale:[4,4.5,4],position:[-0,-25,-10],rotation:[.1,1.4,0]}),jsxRuntimeExports.jsx(SeaWeed,{scale:[4,4.5,4],position:[-14,-25,-9],rotation:[0,2,0]}),jsxRuntimeExports.jsx(SeaWeed,{scale:[4,4.5,4],position:[-5,-25,-10]}),jsxRuntimeExports.jsx(Chest,{position:[-8,-24,10],scale:[1.5,1.5,1.5],rotation:[0,.5,0]}),jsxRuntimeExports.jsx(FishGroup,{reset:lp,amount:sp,cohesion:_d,separation:np,alignment:rp,maxDistance:ap,scale:[1.5,1.5,1.5],clownExist:dp,stoneExist:hp,breamExist:fp,blackExist:pp}),jsxRuntimeExports.jsx(PerspectiveCamera,{position:[100,50,0],near:.01,far:1e3,ref:mp,makeDefault:!0}),jsxRuntimeExports.jsx(OrbitControls,{target:[0,3,0],camera:mp.current,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/2,minDistance:5,maxDistance:100,autoRotate:!1,enablePan:!1,enableRotate:!0}),up&&jsxRuntimeExports.jsxs(EffectComposer,{children:[jsxRuntimeExports.jsx("primitive",{object:gp,position:[-8,-22,10],rotation:[Math.PI/2,0,0]}),jsxRuntimeExports.jsx("primitive",{object:yp,position:[100,70,50],rotation:[Math.PI/2,0,0]}),jsxRuntimeExports.jsx(GodRays,{sun:gp,blendFunction:BlendFunction.SCREEN,samples:40,density:.98,decay:.98,weight:.6,exposure:.1,clampMax:1,width:Resolution.AUTO_SIZE,height:Resolution.AUTO_SIZE,kernelSize:KernelSize.SMALL,blur:.25}),jsxRuntimeExports.jsx(GodRays,{sun:yp,blendFunction:BlendFunction.SCREEN,samples:40,density:2,decay:.99,weight:.75,exposure:.2,clampMax:1,width:Resolution.AUTO_SIZE,height:Resolution.AUTO_SIZE,kernelSize:KernelSize.SMALL,blur:.25})]})]})},Aquarium=()=>{const[rp,_d]=reactExports.useState(100),[np,ap]=reactExports.useState(50),[sp,lp]=reactExports.useState(70),[up,cp]=reactExports.useState(50),[dp,hp]=reactExports.useState(6),[fp,pp]=reactExports.useState(!1),[mp,gp]=reactExports.useState(!0),[yp,xp]=reactExports.useState("Sunset"),[_p,vp]=reactExports.useState(!1),[bp,Ep]=reactExports.useState(!0),[Sp,Ap]=reactExports.useState(!1),[Rp,Tp]=reactExports.useState(!0),[Mp,Op]=reactExports.useState(!1),[Pp,$p]=reactExports.useState(!0),[zp,Dp]=reactExports.useState(!1),[Fp,jp]=reactExports.useState(!0);return jsxRuntimeExports.jsxs("div",{className:"aquarium",children:[jsxRuntimeExports.jsx("img",{src:back,alt:"",className:"back-fish-lish",onClick:()=>history.back()}),jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"spinner"}),jsxRuntimeExports.jsx("p",{children:"Loading..."})]}),children:[jsxRuntimeExports.jsx(Controls,{clownExist:_p,setClownExist:vp,clownCatch:bp,stoneExist:Sp,setStoneExist:Ap,stoneCatch:Rp,breamExist:Mp,setBreamExist:Op,breamCatch:Pp,blackExist:zp,setBlackExist:Dp,blackCatch:Fp}),jsxRuntimeExports.jsx(FishTankScene,{separation:rp,alignment:sp,cohesion:np,hasPostProcessing:mp,reset:fp,maxDistance:up,amountOfFish:dp,environment:yp,clownExist:_p,stoneExist:Sp,breamExist:Mp,blackExist:zp})]})]})};function App(){return jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsxs(Route,{path:"/",element:jsxRuntimeExports.jsx(Navbar,{}),children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(HomePage,{})}),jsxRuntimeExports.jsxs(Route,{path:"fish",children:[jsxRuntimeExports.jsx(Route,{path:"image/result",element:jsxRuntimeExports.jsx(ImageResultPage,{})}),jsxRuntimeExports.jsx(Route,{path:"map",element:jsxRuntimeExports.jsx(FishMapPage,{})})]}),jsxRuntimeExports.jsxs(Route,{path:"media",children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(MediaPage,{})}),jsxRuntimeExports.jsxs(Route,{path:"roomList",children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(RoomList,{})}),jsxRuntimeExports.jsx(Route,{path:"create",children:jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(CreateRoom,{})})})]}),jsxRuntimeExports.jsx(Route,{path:"board",children:jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(BoardPage,{})})})]}),jsxRuntimeExports.jsxs(Route,{path:"user/mypage",children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(MyPage,{})}),jsxRuntimeExports.jsx(Route,{path:"edit",element:jsxRuntimeExports.jsx(MyPageEdit,{})}),jsxRuntimeExports.jsx(Route,{path:"fish",element:jsxRuntimeExports.jsx(MyFishPage,{})}),jsxRuntimeExports.jsx(Route,{path:"location",element:jsxRuntimeExports.jsx(MyLocationPage,{})})]})]}),jsxRuntimeExports.jsxs(Route,{path:"media",children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(MediaPage,{})}),jsxRuntimeExports.jsxs(Route,{path:"board",children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(BoardPage,{})}),jsxRuntimeExports.jsx(Route,{path:"create",element:jsxRuntimeExports.jsx(BoardCreate,{})}),jsxRuntimeExports.jsx(Route,{path:"modify/:id",element:jsxRuntimeExports.jsx(BoardModify,{})}),jsxRuntimeExports.jsx(Route,{path:":id",element:jsxRuntimeExports.jsx(BoardDetail,{})})]})]}),jsxRuntimeExports.jsxs(Route,{path:"/tutorial",children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(TutorialPage,{})}),jsxRuntimeExports.jsx(Route,{path:":id",element:jsxRuntimeExports.jsx(TutorialDetailPage,{})})]}),jsxRuntimeExports.jsxs(Route,{path:"/fish",children:[jsxRuntimeExports.jsx(Route,{path:"map",children:jsxRuntimeExports.jsx(Route,{path:":idx",element:jsxRuntimeExports.jsx(FishMapDetailPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"image/edit",element:jsxRuntimeExports.jsx(ImageEditPage,{})})]}),jsxRuntimeExports.jsxs(Route,{path:"/fishbook",children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(FishBook,{})}),jsxRuntimeExports.jsx(Route,{path:":id",element:jsxRuntimeExports.jsx(FishBookDetailPage,{})})]}),jsxRuntimeExports.jsxs(Route,{path:"/login",children:[jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(LoginPage,{})}),jsxRuntimeExports.jsx(Route,{path:":social",element:jsxRuntimeExports.jsx(AuthPage,{})})]}),jsxRuntimeExports.jsx(Route,{path:"/live/:id",element:jsxRuntimeExports.jsx(VideoRoomComponent,{})}),jsxRuntimeExports.jsx(Route,{path:"/chatBot",children:jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(ChatBot,{})})}),jsxRuntimeExports.jsx(Route,{path:"/aquarium",children:jsxRuntimeExports.jsx(Route,{index:!0,element:jsxRuntimeExports.jsx(Aquarium,{})})})]})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(Recoil_index_5,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(App,{})})}));
