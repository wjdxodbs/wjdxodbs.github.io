import{r as d,j as s}from"./index-CkMYCJQD.js";import{H as u}from"./Header-DKOjmQyZ.js";import{d as i}from"./dayjs.min-CYYA7PJ3.js";import{a as m}from"./common-BryWrCT5.js";import"./AddressContent-CyLnO-_a.js";const l=m(),h=async e=>{try{const{data:n}=await l.post(`/users/user/coupon/${e}`);return n}catch(n){throw console.log(n),n}},x=async()=>{try{const{data:e}=await l.get("/users/user/coupon");return e}catch(e){throw console.log(e),e}},y=()=>{const[e,n]=d.useState([]);d.useEffect(()=>{r()},[]);const r=async()=>{const o=await x();n(o)},p=async o=>{if(window.confirm("쿠폰을 적용하시겠습니까?")){const a=e.find(t=>t.couponId===o);if(!a)return;if(e.some(t=>t.couponName===a.couponName&&t.couponStatus==="사용 중")){alert("이미 같은 쿠폰을 사용중입니다.");return}await h(o),r()}};return s.jsx("div",{className:"MyCouponBody",children:e.length>0?e.map(o=>{const c=i(o.couponEndDate).diff(i(),"day"),a=c<=3;return s.jsxs("div",{className:"coupon-body",children:[s.jsxs("div",{className:"coupon-header",children:[s.jsx("div",{className:"coupon-title",children:o.couponName}),s.jsx("div",{className:"coupon-desc",children:o.couponDescription})]}),s.jsx("div",{className:`coupon-apply ${o.couponStatus==="사용 전"?"":"inactive"}`,onClick:()=>o.couponStatus==="사용 전"&&p(o.couponId),children:s.jsx("div",{className:`coupon-apply-btn ${o.couponStatus!=="사용 전"&&"coupon-apply-active"}`,children:o.couponStatus})}),s.jsx("hr",{}),s.jsxs("div",{className:"coupon-end-date",children:[s.jsx("div",{className:`${a&&"coupon-end-date-how-imminent"}`,children:`D-${c}`}),s.jsxs("div",{className:"coupon-end-date-when",children:[i(o.couponEndDate).format("YY/MM/DD HH:mm:ss"),"까지"]})]})]},o.couponId)}):s.jsx("div",{className:"SearchedWords",children:s.jsxs("div",{className:"no-word-container",children:[s.jsx("div",{className:"title",children:"앗!"}),s.jsx("div",{className:"subtitle",children:"사용 가능한 쿠폰이 없습니다."})]})})})},g=()=>s.jsxs("div",{className:"MyCouponPage",children:[s.jsx(u,{centerText:"쿠폰함"}),s.jsx("div",{className:"body none-scroll",children:s.jsx(y,{})})]});export{g as default};
