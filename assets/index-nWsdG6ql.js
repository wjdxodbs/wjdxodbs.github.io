var Mj=Object.defineProperty;var Pj=(t,n,e)=>n in t?Mj(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var dr=(t,n,e)=>(Pj(t,typeof n!="symbol"?n+"":n,e),e);function Lj(t,n){for(var e=0;e<n.length;e++){const r=n[e];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();var ve=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function jv(t){if(t.__esModule)return t;var n=t.default;if(typeof n=="function"){var e=function r(){return this instanceof r?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};e.prototype=n.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),e}var R_={exports:{}},Vv={},T_={exports:{}},ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xf=Symbol.for("react.element"),Fj=Symbol.for("react.portal"),zj=Symbol.for("react.fragment"),Bj=Symbol.for("react.strict_mode"),jj=Symbol.for("react.profiler"),Vj=Symbol.for("react.provider"),$j=Symbol.for("react.context"),Uj=Symbol.for("react.forward_ref"),Wj=Symbol.for("react.suspense"),Hj=Symbol.for("react.memo"),Gj=Symbol.for("react.lazy"),FR=Symbol.iterator;function qj(t){return t===null||typeof t!="object"?null:(t=FR&&t[FR]||t["@@iterator"],typeof t=="function"?t:null)}var N_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k_=Object.assign,I_={};function yc(t,n,e){this.props=t,this.context=n,this.refs=I_,this.updater=e||N_}yc.prototype.isReactComponent={};yc.prototype.setState=function(t,n){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,n,"setState")};yc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function __(){}__.prototype=yc.prototype;function Tx(t,n,e){this.props=t,this.context=n,this.refs=I_,this.updater=e||N_}var Nx=Tx.prototype=new __;Nx.constructor=Tx;k_(Nx,yc.prototype);Nx.isPureReactComponent=!0;var zR=Array.isArray,A_=Object.prototype.hasOwnProperty,kx={current:null},O_={key:!0,ref:!0,__self:!0,__source:!0};function D_(t,n,e){var r,i={},o=null,a=null;if(n!=null)for(r in n.ref!==void 0&&(a=n.ref),n.key!==void 0&&(o=""+n.key),n)A_.call(n,r)&&!O_.hasOwnProperty(r)&&(i[r]=n[r]);var s=arguments.length-2;if(s===1)i.children=e;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];i.children=u}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:Xf,type:t,key:o,ref:a,props:i,_owner:kx.current}}function Kj(t,n){return{$$typeof:Xf,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}function Ix(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xf}function Xj(t){var n={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(e){return n[e]})}var BR=/\/+/g;function c0(t,n){return typeof t=="object"&&t!==null&&t.key!=null?Xj(""+t.key):n.toString(36)}function Gh(t,n,e,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Xf:case Fj:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+c0(a,0):r,zR(i)?(e="",t!=null&&(e=t.replace(BR,"$&/")+"/"),Gh(i,n,e,"",function(l){return l})):i!=null&&(Ix(i)&&(i=Kj(i,e+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(BR,"$&/")+"/")+t)),n.push(i)),1;if(a=0,r=r===""?".":r+":",zR(t))for(var s=0;s<t.length;s++){o=t[s];var u=r+c0(o,s);a+=Gh(o,n,e,u,i)}else if(u=qj(t),typeof u=="function")for(t=u.call(t),s=0;!(o=t.next()).done;)o=o.value,u=r+c0(o,s++),a+=Gh(o,n,e,u,i);else if(o==="object")throw n=String(t),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return a}function Qp(t,n,e){if(t==null)return t;var r=[],i=0;return Gh(t,r,"","",function(o){return n.call(e,o,i++)}),r}function Yj(t){if(t._status===-1){var n=t._result;n=n(),n.then(function(e){(t._status===0||t._status===-1)&&(t._status=1,t._result=e)},function(e){(t._status===0||t._status===-1)&&(t._status=2,t._result=e)}),t._status===-1&&(t._status=0,t._result=n)}if(t._status===1)return t._result.default;throw t._result}var xr={current:null},qh={transition:null},Jj={ReactCurrentDispatcher:xr,ReactCurrentBatchConfig:qh,ReactCurrentOwner:kx};ft.Children={map:Qp,forEach:function(t,n,e){Qp(t,function(){n.apply(this,arguments)},e)},count:function(t){var n=0;return Qp(t,function(){n++}),n},toArray:function(t){return Qp(t,function(n){return n})||[]},only:function(t){if(!Ix(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ft.Component=yc;ft.Fragment=zj;ft.Profiler=jj;ft.PureComponent=Tx;ft.StrictMode=Bj;ft.Suspense=Wj;ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jj;ft.cloneElement=function(t,n,e){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=k_({},t.props),i=t.key,o=t.ref,a=t._owner;if(n!=null){if(n.ref!==void 0&&(o=n.ref,a=kx.current),n.key!==void 0&&(i=""+n.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(u in n)A_.call(n,u)&&!O_.hasOwnProperty(u)&&(r[u]=n[u]===void 0&&s!==void 0?s[u]:n[u])}var u=arguments.length-2;if(u===1)r.children=e;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:Xf,type:t.type,key:i,ref:o,props:r,_owner:a}};ft.createContext=function(t){return t={$$typeof:$j,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Vj,_context:t},t.Consumer=t};ft.createElement=D_;ft.createFactory=function(t){var n=D_.bind(null,t);return n.type=t,n};ft.createRef=function(){return{current:null}};ft.forwardRef=function(t){return{$$typeof:Uj,render:t}};ft.isValidElement=Ix;ft.lazy=function(t){return{$$typeof:Gj,_payload:{_status:-1,_result:t},_init:Yj}};ft.memo=function(t,n){return{$$typeof:Hj,type:t,compare:n===void 0?null:n}};ft.startTransition=function(t){var n=qh.transition;qh.transition={};try{t()}finally{qh.transition=n}};ft.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ft.useCallback=function(t,n){return xr.current.useCallback(t,n)};ft.useContext=function(t){return xr.current.useContext(t)};ft.useDebugValue=function(){};ft.useDeferredValue=function(t){return xr.current.useDeferredValue(t)};ft.useEffect=function(t,n){return xr.current.useEffect(t,n)};ft.useId=function(){return xr.current.useId()};ft.useImperativeHandle=function(t,n,e){return xr.current.useImperativeHandle(t,n,e)};ft.useInsertionEffect=function(t,n){return xr.current.useInsertionEffect(t,n)};ft.useLayoutEffect=function(t,n){return xr.current.useLayoutEffect(t,n)};ft.useMemo=function(t,n){return xr.current.useMemo(t,n)};ft.useReducer=function(t,n,e){return xr.current.useReducer(t,n,e)};ft.useRef=function(t){return xr.current.useRef(t)};ft.useState=function(t){return xr.current.useState(t)};ft.useSyncExternalStore=function(t,n,e){return xr.current.useSyncExternalStore(t,n,e)};ft.useTransition=function(){return xr.current.useTransition()};ft.version="18.2.0";T_.exports=ft;var W=T_.exports;const Ae=C_(W),Rm=Lj({__proto__:null,default:Ae},[W]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qj=W,Zj=Symbol.for("react.element"),eV=Symbol.for("react.fragment"),tV=Object.prototype.hasOwnProperty,nV=Qj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rV={key:!0,ref:!0,__self:!0,__source:!0};function M_(t,n,e){var r,i={},o=null,a=null;e!==void 0&&(o=""+e),n.key!==void 0&&(o=""+n.key),n.ref!==void 0&&(a=n.ref);for(r in n)tV.call(n,r)&&!rV.hasOwnProperty(r)&&(i[r]=n[r]);if(t&&t.defaultProps)for(r in n=t.defaultProps,n)i[r]===void 0&&(i[r]=n[r]);return{$$typeof:Zj,type:t,key:o,ref:a,props:i,_owner:nV.current}}Vv.Fragment=eV;Vv.jsx=M_;Vv.jsxs=M_;R_.exports=Vv;var R=R_.exports,P_={exports:{}},ii={},L_={exports:{}},F_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function n(_,F){var L=_.length;_.push(F);e:for(;0<L;){var H=L-1>>>1,B=_[H];if(0<i(B,F))_[H]=F,_[L]=B,L=H;else break e}}function e(_){return _.length===0?null:_[0]}function r(_){if(_.length===0)return null;var F=_[0],L=_.pop();if(L!==F){_[0]=L;e:for(var H=0,B=_.length,q=B>>>1;H<q;){var G=2*(H+1)-1,re=_[G],j=G+1,ae=_[j];if(0>i(re,L))j<B&&0>i(ae,re)?(_[H]=ae,_[j]=L,H=j):(_[H]=re,_[G]=L,H=G);else if(j<B&&0>i(ae,L))_[H]=ae,_[j]=L,H=j;else break e}}return F}function i(_,F){var L=_.sortIndex-F.sortIndex;return L!==0?L:_.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,d=null,f=3,p=!1,h=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(_){for(var F=e(l);F!==null;){if(F.callback===null)r(l);else if(F.startTime<=_)r(l),F.sortIndex=F.expirationTime,n(u,F);else break;F=e(l)}}function w(_){if(v=!1,b(_),!h)if(e(u)!==null)h=!0,A(x);else{var F=e(l);F!==null&&I(w,F.startTime-_)}}function x(_,F){h=!1,v&&(v=!1,m(S),S=-1),p=!0;var L=f;try{for(b(F),d=e(u);d!==null&&(!(d.expirationTime>F)||_&&!M());){var H=d.callback;if(typeof H=="function"){d.callback=null,f=d.priorityLevel;var B=H(d.expirationTime<=F);F=t.unstable_now(),typeof B=="function"?d.callback=B:d===e(u)&&r(u),b(F)}else r(u);d=e(u)}if(d!==null)var q=!0;else{var G=e(l);G!==null&&I(w,G.startTime-F),q=!1}return q}finally{d=null,f=L,p=!1}}var C=!1,E=null,S=-1,k=5,N=-1;function M(){return!(t.unstable_now()-N<k)}function D(){if(E!==null){var _=t.unstable_now();N=_;var F=!0;try{F=E(!0,_)}finally{F?T():(C=!1,E=null)}}else C=!1}var T;if(typeof y=="function")T=function(){y(D)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,P=O.port2;O.port1.onmessage=D,T=function(){P.postMessage(null)}}else T=function(){g(D,0)};function A(_){E=_,C||(C=!0,T())}function I(_,F){S=g(function(){_(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_continueExecution=function(){h||p||(h=!0,A(x))},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return e(u)},t.unstable_next=function(_){switch(f){case 1:case 2:case 3:var F=3;break;default:F=f}var L=f;f=F;try{return _()}finally{f=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_,F){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var L=f;f=_;try{return F()}finally{f=L}},t.unstable_scheduleCallback=function(_,F,L){var H=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?H+L:H):L=H,_){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=L+B,_={id:c++,callback:F,priorityLevel:_,startTime:L,expirationTime:B,sortIndex:-1},L>H?(_.sortIndex=L,n(l,_),e(u)===null&&_===e(l)&&(v?(m(S),S=-1):v=!0,I(w,L-H))):(_.sortIndex=B,n(u,_),h||p||(h=!0,A(x))),_},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(_){var F=f;return function(){var L=f;f=F;try{return _.apply(this,arguments)}finally{f=L}}}})(F_);L_.exports=F_;var iV=L_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z_=W,Zr=iV;function ye(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,e=1;e<arguments.length;e++)n+="&args[]="+encodeURIComponent(arguments[e]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var B_=new Set,sf={};function wu(t,n){jl(t,n),jl(t+"Capture",n)}function jl(t,n){for(sf[t]=n,t=0;t<n.length;t++)B_.add(n[t])}var Jo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rb=Object.prototype.hasOwnProperty,oV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jR={},VR={};function aV(t){return rb.call(VR,t)?!0:rb.call(jR,t)?!1:oV.test(t)?VR[t]=!0:(jR[t]=!0,!1)}function sV(t,n,e,r){if(e!==null&&e.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return r?!1:e!==null?!e.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function uV(t,n,e,r){if(n===null||typeof n>"u"||sV(t,n,e,r))return!0;if(r)return!1;if(e!==null)switch(e.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Sr(t,n,e,r,i,o,a){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=e,this.propertyName=t,this.type=n,this.sanitizeURL=o,this.removeEmptyString=a}var Jn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Jn[t]=new Sr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var n=t[0];Jn[n]=new Sr(n,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Jn[t]=new Sr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Jn[t]=new Sr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Jn[t]=new Sr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Jn[t]=new Sr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Jn[t]=new Sr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Jn[t]=new Sr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Jn[t]=new Sr(t,5,!1,t.toLowerCase(),null,!1,!1)});var _x=/[\-:]([a-z])/g;function Ax(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var n=t.replace(_x,Ax);Jn[n]=new Sr(n,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var n=t.replace(_x,Ax);Jn[n]=new Sr(n,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var n=t.replace(_x,Ax);Jn[n]=new Sr(n,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Jn[t]=new Sr(t,1,!1,t.toLowerCase(),null,!1,!1)});Jn.xlinkHref=new Sr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Jn[t]=new Sr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ox(t,n,e,r){var i=Jn.hasOwnProperty(n)?Jn[n]:null;(i!==null?i.type!==0:r||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(uV(n,e,i,r)&&(e=null),r||i===null?aV(n)&&(e===null?t.removeAttribute(n):t.setAttribute(n,""+e)):i.mustUseProperty?t[i.propertyName]=e===null?i.type===3?!1:"":e:(n=i.attributeName,r=i.attributeNamespace,e===null?t.removeAttribute(n):(i=i.type,e=i===3||i===4&&e===!0?"":""+e,r?t.setAttributeNS(r,n,e):t.setAttribute(n,e))))}var oa=z_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zp=Symbol.for("react.element"),sl=Symbol.for("react.portal"),ul=Symbol.for("react.fragment"),Dx=Symbol.for("react.strict_mode"),ib=Symbol.for("react.profiler"),j_=Symbol.for("react.provider"),V_=Symbol.for("react.context"),Mx=Symbol.for("react.forward_ref"),ob=Symbol.for("react.suspense"),ab=Symbol.for("react.suspense_list"),Px=Symbol.for("react.memo"),Ca=Symbol.for("react.lazy"),$_=Symbol.for("react.offscreen"),$R=Symbol.iterator;function Jc(t){return t===null||typeof t!="object"?null:(t=$R&&t[$R]||t["@@iterator"],typeof t=="function"?t:null)}var on=Object.assign,d0;function Id(t){if(d0===void 0)try{throw Error()}catch(e){var n=e.stack.trim().match(/\n( *(at )?)/);d0=n&&n[1]||""}return`
`+d0+t}var f0=!1;function p0(t,n){if(!t||f0)return"";f0=!0;var e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(l){var r=l}Reflect.construct(t,[],n)}else{try{n.call()}catch(l){r=l}t.call(n.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(a!==1||s!==1)do if(a--,s--,0>s||i[a]!==o[s]){var u=`
`+i[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=s);break}}}finally{f0=!1,Error.prepareStackTrace=e}return(t=t?t.displayName||t.name:"")?Id(t):""}function lV(t){switch(t.tag){case 5:return Id(t.type);case 16:return Id("Lazy");case 13:return Id("Suspense");case 19:return Id("SuspenseList");case 0:case 2:case 15:return t=p0(t.type,!1),t;case 11:return t=p0(t.type.render,!1),t;case 1:return t=p0(t.type,!0),t;default:return""}}function sb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ul:return"Fragment";case sl:return"Portal";case ib:return"Profiler";case Dx:return"StrictMode";case ob:return"Suspense";case ab:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case V_:return(t.displayName||"Context")+".Consumer";case j_:return(t._context.displayName||"Context")+".Provider";case Mx:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Px:return n=t.displayName||null,n!==null?n:sb(t.type)||"Memo";case Ca:n=t._payload,t=t._init;try{return sb(t(n))}catch{}}return null}function cV(t){var n=t.type;switch(t.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=n.render,t=t.displayName||t.name||"",n.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sb(n);case 8:return n===Dx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function is(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function U_(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function dV(t){var n=U_(t)?"checked":"value",e=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),r=""+t[n];if(!t.hasOwnProperty(n)&&typeof e<"u"&&typeof e.get=="function"&&typeof e.set=="function"){var i=e.get,o=e.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,n,{enumerable:e.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function eh(t){t._valueTracker||(t._valueTracker=dV(t))}function W_(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var e=n.getValue(),r="";return t&&(r=U_(t)?t.checked?"true":"false":t.value),t=r,t!==e?(n.setValue(t),!0):!1}function Tm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ub(t,n){var e=n.checked;return on({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:e??t._wrapperState.initialChecked})}function UR(t,n){var e=n.defaultValue==null?"":n.defaultValue,r=n.checked!=null?n.checked:n.defaultChecked;e=is(n.value!=null?n.value:e),t._wrapperState={initialChecked:r,initialValue:e,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function H_(t,n){n=n.checked,n!=null&&Ox(t,"checked",n,!1)}function lb(t,n){H_(t,n);var e=is(n.value),r=n.type;if(e!=null)r==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+e):t.value!==""+e&&(t.value=""+e);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}n.hasOwnProperty("value")?cb(t,n.type,e):n.hasOwnProperty("defaultValue")&&cb(t,n.type,is(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(t.defaultChecked=!!n.defaultChecked)}function WR(t,n,e){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var r=n.type;if(!(r!=="submit"&&r!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+t._wrapperState.initialValue,e||n===t.value||(t.value=n),t.defaultValue=n}e=t.name,e!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,e!==""&&(t.name=e)}function cb(t,n,e){(n!=="number"||Tm(t.ownerDocument)!==t)&&(e==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+e&&(t.defaultValue=""+e))}var _d=Array.isArray;function El(t,n,e,r){if(t=t.options,n){n={};for(var i=0;i<e.length;i++)n["$"+e[i]]=!0;for(e=0;e<t.length;e++)i=n.hasOwnProperty("$"+t[e].value),t[e].selected!==i&&(t[e].selected=i),i&&r&&(t[e].defaultSelected=!0)}else{for(e=""+is(e),n=null,i=0;i<t.length;i++){if(t[i].value===e){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}n!==null||t[i].disabled||(n=t[i])}n!==null&&(n.selected=!0)}}function db(t,n){if(n.dangerouslySetInnerHTML!=null)throw Error(ye(91));return on({},n,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function HR(t,n){var e=n.value;if(e==null){if(e=n.children,n=n.defaultValue,e!=null){if(n!=null)throw Error(ye(92));if(_d(e)){if(1<e.length)throw Error(ye(93));e=e[0]}n=e}n==null&&(n=""),e=n}t._wrapperState={initialValue:is(e)}}function G_(t,n){var e=is(n.value),r=is(n.defaultValue);e!=null&&(e=""+e,e!==t.value&&(t.value=e),n.defaultValue==null&&t.defaultValue!==e&&(t.defaultValue=e)),r!=null&&(t.defaultValue=""+r)}function GR(t){var n=t.textContent;n===t._wrapperState.initialValue&&n!==""&&n!==null&&(t.value=n)}function q_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fb(t,n){return t==null||t==="http://www.w3.org/1999/xhtml"?q_(n):t==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var th,K_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,e,r,i){MSApp.execUnsafeLocalFunction(function(){return t(n,e,r,i)})}:t}(function(t,n){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=n;else{for(th=th||document.createElement("div"),th.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=th.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;n.firstChild;)t.appendChild(n.firstChild)}});function uf(t,n){if(n){var e=t.firstChild;if(e&&e===t.lastChild&&e.nodeType===3){e.nodeValue=n;return}}t.textContent=n}var jd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fV=["Webkit","ms","Moz","O"];Object.keys(jd).forEach(function(t){fV.forEach(function(n){n=n+t.charAt(0).toUpperCase()+t.substring(1),jd[n]=jd[t]})});function X_(t,n,e){return n==null||typeof n=="boolean"||n===""?"":e||typeof n!="number"||n===0||jd.hasOwnProperty(t)&&jd[t]?(""+n).trim():n+"px"}function Y_(t,n){t=t.style;for(var e in n)if(n.hasOwnProperty(e)){var r=e.indexOf("--")===0,i=X_(e,n[e],r);e==="float"&&(e="cssFloat"),r?t.setProperty(e,i):t[e]=i}}var pV=on({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pb(t,n){if(n){if(pV[t]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(ye(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(ye(61))}if(n.style!=null&&typeof n.style!="object")throw Error(ye(62))}}function hb(t,n){if(t.indexOf("-")===-1)return typeof n.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mb=null;function Lx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vb=null,Cl=null,Rl=null;function qR(t){if(t=Qf(t)){if(typeof vb!="function")throw Error(ye(280));var n=t.stateNode;n&&(n=Gv(n),vb(t.stateNode,t.type,n))}}function J_(t){Cl?Rl?Rl.push(t):Rl=[t]:Cl=t}function Q_(){if(Cl){var t=Cl,n=Rl;if(Rl=Cl=null,qR(t),n)for(t=0;t<n.length;t++)qR(n[t])}}function Z_(t,n){return t(n)}function eA(){}var h0=!1;function tA(t,n,e){if(h0)return t(n,e);h0=!0;try{return Z_(t,n,e)}finally{h0=!1,(Cl!==null||Rl!==null)&&(eA(),Q_())}}function lf(t,n){var e=t.stateNode;if(e===null)return null;var r=Gv(e);if(r===null)return null;e=r[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(e&&typeof e!="function")throw Error(ye(231,n,typeof e));return e}var gb=!1;if(Jo)try{var Qc={};Object.defineProperty(Qc,"passive",{get:function(){gb=!0}}),window.addEventListener("test",Qc,Qc),window.removeEventListener("test",Qc,Qc)}catch{gb=!1}function hV(t,n,e,r,i,o,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{n.apply(e,l)}catch(c){this.onError(c)}}var Vd=!1,Nm=null,km=!1,yb=null,mV={onError:function(t){Vd=!0,Nm=t}};function vV(t,n,e,r,i,o,a,s,u){Vd=!1,Nm=null,hV.apply(mV,arguments)}function gV(t,n,e,r,i,o,a,s,u){if(vV.apply(this,arguments),Vd){if(Vd){var l=Nm;Vd=!1,Nm=null}else throw Error(ye(198));km||(km=!0,yb=l)}}function xu(t){var n=t,e=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,n.flags&4098&&(e=n.return),t=n.return;while(t)}return n.tag===3?e:null}function nA(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function KR(t){if(xu(t)!==t)throw Error(ye(188))}function yV(t){var n=t.alternate;if(!n){if(n=xu(t),n===null)throw Error(ye(188));return n!==t?null:t}for(var e=t,r=n;;){var i=e.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){e=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===e)return KR(i),t;if(o===r)return KR(i),n;o=o.sibling}throw Error(ye(188))}if(e.return!==r.return)e=i,r=o;else{for(var a=!1,s=i.child;s;){if(s===e){a=!0,e=i,r=o;break}if(s===r){a=!0,r=i,e=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===e){a=!0,e=o,r=i;break}if(s===r){a=!0,r=o,e=i;break}s=s.sibling}if(!a)throw Error(ye(189))}}if(e.alternate!==r)throw Error(ye(190))}if(e.tag!==3)throw Error(ye(188));return e.stateNode.current===e?t:n}function rA(t){return t=yV(t),t!==null?iA(t):null}function iA(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var n=iA(t);if(n!==null)return n;t=t.sibling}return null}var oA=Zr.unstable_scheduleCallback,XR=Zr.unstable_cancelCallback,bV=Zr.unstable_shouldYield,wV=Zr.unstable_requestPaint,vn=Zr.unstable_now,xV=Zr.unstable_getCurrentPriorityLevel,Fx=Zr.unstable_ImmediatePriority,aA=Zr.unstable_UserBlockingPriority,Im=Zr.unstable_NormalPriority,SV=Zr.unstable_LowPriority,sA=Zr.unstable_IdlePriority,$v=null,ho=null;function EV(t){if(ho&&typeof ho.onCommitFiberRoot=="function")try{ho.onCommitFiberRoot($v,t,void 0,(t.current.flags&128)===128)}catch{}}var Fi=Math.clz32?Math.clz32:TV,CV=Math.log,RV=Math.LN2;function TV(t){return t>>>=0,t===0?32:31-(CV(t)/RV|0)|0}var nh=64,rh=4194304;function Ad(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function _m(t,n){var e=t.pendingLanes;if(e===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=e&268435455;if(a!==0){var s=a&~i;s!==0?r=Ad(s):(o&=a,o!==0&&(r=Ad(o)))}else a=e&~i,a!==0?r=Ad(a):o!==0&&(r=Ad(o));if(r===0)return 0;if(n!==0&&n!==r&&!(n&i)&&(i=r&-r,o=n&-n,i>=o||i===16&&(o&4194240)!==0))return n;if(r&4&&(r|=e&16),n=t.entangledLanes,n!==0)for(t=t.entanglements,n&=r;0<n;)e=31-Fi(n),i=1<<e,r|=t[e],n&=~i;return r}function NV(t,n){switch(t){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kV(t,n){for(var e=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-Fi(o),s=1<<a,u=i[a];u===-1?(!(s&e)||s&r)&&(i[a]=NV(s,n)):u<=n&&(t.expiredLanes|=s),o&=~s}}function bb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function uA(){var t=nh;return nh<<=1,!(nh&4194240)&&(nh=64),t}function m0(t){for(var n=[],e=0;31>e;e++)n.push(t);return n}function Yf(t,n,e){t.pendingLanes|=n,n!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,n=31-Fi(n),t[n]=e}function IV(t,n){var e=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<e;){var i=31-Fi(e),o=1<<i;n[i]=0,r[i]=-1,t[i]=-1,e&=~o}}function zx(t,n){var e=t.entangledLanes|=n;for(t=t.entanglements;e;){var r=31-Fi(e),i=1<<r;i&n|t[r]&n&&(t[r]|=n),e&=~i}}var Ot=0;function lA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var cA,Bx,dA,fA,pA,wb=!1,ih=[],Ua=null,Wa=null,Ha=null,cf=new Map,df=new Map,ka=[],_V="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function YR(t,n){switch(t){case"focusin":case"focusout":Ua=null;break;case"dragenter":case"dragleave":Wa=null;break;case"mouseover":case"mouseout":Ha=null;break;case"pointerover":case"pointerout":cf.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":df.delete(n.pointerId)}}function Zc(t,n,e,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:n,domEventName:e,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},n!==null&&(n=Qf(n),n!==null&&Bx(n)),t):(t.eventSystemFlags|=r,n=t.targetContainers,i!==null&&n.indexOf(i)===-1&&n.push(i),t)}function AV(t,n,e,r,i){switch(n){case"focusin":return Ua=Zc(Ua,t,n,e,r,i),!0;case"dragenter":return Wa=Zc(Wa,t,n,e,r,i),!0;case"mouseover":return Ha=Zc(Ha,t,n,e,r,i),!0;case"pointerover":var o=i.pointerId;return cf.set(o,Zc(cf.get(o)||null,t,n,e,r,i)),!0;case"gotpointercapture":return o=i.pointerId,df.set(o,Zc(df.get(o)||null,t,n,e,r,i)),!0}return!1}function hA(t){var n=$s(t.target);if(n!==null){var e=xu(n);if(e!==null){if(n=e.tag,n===13){if(n=nA(e),n!==null){t.blockedOn=n,pA(t.priority,function(){dA(e)});return}}else if(n===3&&e.stateNode.current.memoizedState.isDehydrated){t.blockedOn=e.tag===3?e.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Kh(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var e=xb(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(e===null){e=t.nativeEvent;var r=new e.constructor(e.type,e);mb=r,e.target.dispatchEvent(r),mb=null}else return n=Qf(e),n!==null&&Bx(n),t.blockedOn=e,!1;n.shift()}return!0}function JR(t,n,e){Kh(t)&&e.delete(n)}function OV(){wb=!1,Ua!==null&&Kh(Ua)&&(Ua=null),Wa!==null&&Kh(Wa)&&(Wa=null),Ha!==null&&Kh(Ha)&&(Ha=null),cf.forEach(JR),df.forEach(JR)}function ed(t,n){t.blockedOn===n&&(t.blockedOn=null,wb||(wb=!0,Zr.unstable_scheduleCallback(Zr.unstable_NormalPriority,OV)))}function ff(t){function n(i){return ed(i,t)}if(0<ih.length){ed(ih[0],t);for(var e=1;e<ih.length;e++){var r=ih[e];r.blockedOn===t&&(r.blockedOn=null)}}for(Ua!==null&&ed(Ua,t),Wa!==null&&ed(Wa,t),Ha!==null&&ed(Ha,t),cf.forEach(n),df.forEach(n),e=0;e<ka.length;e++)r=ka[e],r.blockedOn===t&&(r.blockedOn=null);for(;0<ka.length&&(e=ka[0],e.blockedOn===null);)hA(e),e.blockedOn===null&&ka.shift()}var Tl=oa.ReactCurrentBatchConfig,Am=!0;function DV(t,n,e,r){var i=Ot,o=Tl.transition;Tl.transition=null;try{Ot=1,jx(t,n,e,r)}finally{Ot=i,Tl.transition=o}}function MV(t,n,e,r){var i=Ot,o=Tl.transition;Tl.transition=null;try{Ot=4,jx(t,n,e,r)}finally{Ot=i,Tl.transition=o}}function jx(t,n,e,r){if(Am){var i=xb(t,n,e,r);if(i===null)R0(t,n,r,Om,e),YR(t,r);else if(AV(i,t,n,e,r))r.stopPropagation();else if(YR(t,r),n&4&&-1<_V.indexOf(t)){for(;i!==null;){var o=Qf(i);if(o!==null&&cA(o),o=xb(t,n,e,r),o===null&&R0(t,n,r,Om,e),o===i)break;i=o}i!==null&&r.stopPropagation()}else R0(t,n,r,null,e)}}var Om=null;function xb(t,n,e,r){if(Om=null,t=Lx(r),t=$s(t),t!==null)if(n=xu(t),n===null)t=null;else if(e=n.tag,e===13){if(t=nA(n),t!==null)return t;t=null}else if(e===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null);return Om=t,null}function mA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xV()){case Fx:return 1;case aA:return 4;case Im:case SV:return 16;case sA:return 536870912;default:return 16}default:return 16}}var Oa=null,Vx=null,Xh=null;function vA(){if(Xh)return Xh;var t,n=Vx,e=n.length,r,i="value"in Oa?Oa.value:Oa.textContent,o=i.length;for(t=0;t<e&&n[t]===i[t];t++);var a=e-t;for(r=1;r<=a&&n[e-r]===i[o-r];r++);return Xh=i.slice(t,1<r?1-r:void 0)}function Yh(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function oh(){return!0}function QR(){return!1}function oi(t){function n(e,r,i,o,a){this._reactName=e,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(e=t[s],this[s]=e?e(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?oh:QR,this.isPropagationStopped=QR,this}return on(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():typeof e.returnValue!="unknown"&&(e.returnValue=!1),this.isDefaultPrevented=oh)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():typeof e.cancelBubble!="unknown"&&(e.cancelBubble=!0),this.isPropagationStopped=oh)},persist:function(){},isPersistent:oh}),n}var bc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$x=oi(bc),Jf=on({},bc,{view:0,detail:0}),PV=oi(Jf),v0,g0,td,Uv=on({},Jf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ux,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==td&&(td&&t.type==="mousemove"?(v0=t.screenX-td.screenX,g0=t.screenY-td.screenY):g0=v0=0,td=t),v0)},movementY:function(t){return"movementY"in t?t.movementY:g0}}),ZR=oi(Uv),LV=on({},Uv,{dataTransfer:0}),FV=oi(LV),zV=on({},Jf,{relatedTarget:0}),y0=oi(zV),BV=on({},bc,{animationName:0,elapsedTime:0,pseudoElement:0}),jV=oi(BV),VV=on({},bc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),$V=oi(VV),UV=on({},bc,{data:0}),eT=oi(UV),WV={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HV={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GV={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qV(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=GV[t])?!!n[t]:!1}function Ux(){return qV}var KV=on({},Jf,{key:function(t){if(t.key){var n=WV[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=Yh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?HV[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ux,charCode:function(t){return t.type==="keypress"?Yh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Yh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),XV=oi(KV),YV=on({},Uv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tT=oi(YV),JV=on({},Jf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ux}),QV=oi(JV),ZV=on({},bc,{propertyName:0,elapsedTime:0,pseudoElement:0}),e$=oi(ZV),t$=on({},Uv,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),n$=oi(t$),r$=[9,13,27,32],Wx=Jo&&"CompositionEvent"in window,$d=null;Jo&&"documentMode"in document&&($d=document.documentMode);var i$=Jo&&"TextEvent"in window&&!$d,gA=Jo&&(!Wx||$d&&8<$d&&11>=$d),nT=" ",rT=!1;function yA(t,n){switch(t){case"keyup":return r$.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ll=!1;function o$(t,n){switch(t){case"compositionend":return bA(n);case"keypress":return n.which!==32?null:(rT=!0,nT);case"textInput":return t=n.data,t===nT&&rT?null:t;default:return null}}function a$(t,n){if(ll)return t==="compositionend"||!Wx&&yA(t,n)?(t=vA(),Xh=Vx=Oa=null,ll=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return gA&&n.locale!=="ko"?null:n.data;default:return null}}var s$={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function iT(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!s$[t.type]:n==="textarea"}function wA(t,n,e,r){J_(r),n=Dm(n,"onChange"),0<n.length&&(e=new $x("onChange","change",null,e,r),t.push({event:e,listeners:n}))}var Ud=null,pf=null;function u$(t){AA(t,0)}function Wv(t){var n=fl(t);if(W_(n))return t}function l$(t,n){if(t==="change")return n}var xA=!1;if(Jo){var b0;if(Jo){var w0="oninput"in document;if(!w0){var oT=document.createElement("div");oT.setAttribute("oninput","return;"),w0=typeof oT.oninput=="function"}b0=w0}else b0=!1;xA=b0&&(!document.documentMode||9<document.documentMode)}function aT(){Ud&&(Ud.detachEvent("onpropertychange",SA),pf=Ud=null)}function SA(t){if(t.propertyName==="value"&&Wv(pf)){var n=[];wA(n,pf,t,Lx(t)),tA(u$,n)}}function c$(t,n,e){t==="focusin"?(aT(),Ud=n,pf=e,Ud.attachEvent("onpropertychange",SA)):t==="focusout"&&aT()}function d$(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Wv(pf)}function f$(t,n){if(t==="click")return Wv(n)}function p$(t,n){if(t==="input"||t==="change")return Wv(n)}function h$(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Vi=typeof Object.is=="function"?Object.is:h$;function hf(t,n){if(Vi(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var e=Object.keys(t),r=Object.keys(n);if(e.length!==r.length)return!1;for(r=0;r<e.length;r++){var i=e[r];if(!rb.call(n,i)||!Vi(t[i],n[i]))return!1}return!0}function sT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function uT(t,n){var e=sT(t);t=0;for(var r;e;){if(e.nodeType===3){if(r=t+e.textContent.length,t<=n&&r>=n)return{node:e,offset:n-t};t=r}e:{for(;e;){if(e.nextSibling){e=e.nextSibling;break e}e=e.parentNode}e=void 0}e=sT(e)}}function EA(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?EA(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function CA(){for(var t=window,n=Tm();n instanceof t.HTMLIFrameElement;){try{var e=typeof n.contentWindow.location.href=="string"}catch{e=!1}if(e)t=n.contentWindow;else break;n=Tm(t.document)}return n}function Hx(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function m$(t){var n=CA(),e=t.focusedElem,r=t.selectionRange;if(n!==e&&e&&e.ownerDocument&&EA(e.ownerDocument.documentElement,e)){if(r!==null&&Hx(e)){if(n=r.start,t=r.end,t===void 0&&(t=n),"selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(t,e.value.length);else if(t=(n=e.ownerDocument||document)&&n.defaultView||window,t.getSelection){t=t.getSelection();var i=e.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=uT(e,o);var a=uT(e,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(n=n.createRange(),n.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(n),t.extend(a.node,a.offset)):(n.setEnd(a.node,a.offset),t.addRange(n)))}}for(n=[],t=e;t=t.parentNode;)t.nodeType===1&&n.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof e.focus=="function"&&e.focus(),e=0;e<n.length;e++)t=n[e],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var v$=Jo&&"documentMode"in document&&11>=document.documentMode,cl=null,Sb=null,Wd=null,Eb=!1;function lT(t,n,e){var r=e.window===e?e.document:e.nodeType===9?e:e.ownerDocument;Eb||cl==null||cl!==Tm(r)||(r=cl,"selectionStart"in r&&Hx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Wd&&hf(Wd,r)||(Wd=r,r=Dm(Sb,"onSelect"),0<r.length&&(n=new $x("onSelect","select",null,n,e),t.push({event:n,listeners:r}),n.target=cl)))}function ah(t,n){var e={};return e[t.toLowerCase()]=n.toLowerCase(),e["Webkit"+t]="webkit"+n,e["Moz"+t]="moz"+n,e}var dl={animationend:ah("Animation","AnimationEnd"),animationiteration:ah("Animation","AnimationIteration"),animationstart:ah("Animation","AnimationStart"),transitionend:ah("Transition","TransitionEnd")},x0={},RA={};Jo&&(RA=document.createElement("div").style,"AnimationEvent"in window||(delete dl.animationend.animation,delete dl.animationiteration.animation,delete dl.animationstart.animation),"TransitionEvent"in window||delete dl.transitionend.transition);function Hv(t){if(x0[t])return x0[t];if(!dl[t])return t;var n=dl[t],e;for(e in n)if(n.hasOwnProperty(e)&&e in RA)return x0[t]=n[e];return t}var TA=Hv("animationend"),NA=Hv("animationiteration"),kA=Hv("animationstart"),IA=Hv("transitionend"),_A=new Map,cT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fs(t,n){_A.set(t,n),wu(n,[t])}for(var S0=0;S0<cT.length;S0++){var E0=cT[S0],g$=E0.toLowerCase(),y$=E0[0].toUpperCase()+E0.slice(1);fs(g$,"on"+y$)}fs(TA,"onAnimationEnd");fs(NA,"onAnimationIteration");fs(kA,"onAnimationStart");fs("dblclick","onDoubleClick");fs("focusin","onFocus");fs("focusout","onBlur");fs(IA,"onTransitionEnd");jl("onMouseEnter",["mouseout","mouseover"]);jl("onMouseLeave",["mouseout","mouseover"]);jl("onPointerEnter",["pointerout","pointerover"]);jl("onPointerLeave",["pointerout","pointerover"]);wu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wu("onBeforeInput",["compositionend","keypress","textInput","paste"]);wu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Od="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),b$=new Set("cancel close invalid load scroll toggle".split(" ").concat(Od));function dT(t,n,e){var r=t.type||"unknown-event";t.currentTarget=e,gV(r,n,void 0,t),t.currentTarget=null}function AA(t,n){n=(n&4)!==0;for(var e=0;e<t.length;e++){var r=t[e],i=r.event;r=r.listeners;e:{var o=void 0;if(n)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;dT(i,s,l),o=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;dT(i,s,l),o=u}}}if(km)throw t=yb,km=!1,yb=null,t}function Vt(t,n){var e=n[kb];e===void 0&&(e=n[kb]=new Set);var r=t+"__bubble";e.has(r)||(OA(n,t,2,!1),e.add(r))}function C0(t,n,e){var r=0;n&&(r|=4),OA(e,t,r,n)}var sh="_reactListening"+Math.random().toString(36).slice(2);function mf(t){if(!t[sh]){t[sh]=!0,B_.forEach(function(e){e!=="selectionchange"&&(b$.has(e)||C0(e,!1,t),C0(e,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[sh]||(n[sh]=!0,C0("selectionchange",!1,n))}}function OA(t,n,e,r){switch(mA(n)){case 1:var i=DV;break;case 4:i=MV;break;default:i=jx}e=i.bind(null,n,e,t),i=void 0,!gb||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(n,e,{capture:!0,passive:i}):t.addEventListener(n,e,!0):i!==void 0?t.addEventListener(n,e,{passive:i}):t.addEventListener(n,e,!1)}function R0(t,n,e,r,i){var o=r;if(!(n&1)&&!(n&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;a=a.return}for(;s!==null;){if(a=$s(s),a===null)return;if(u=a.tag,u===5||u===6){r=o=a;continue e}s=s.parentNode}}r=r.return}tA(function(){var l=o,c=Lx(e),d=[];e:{var f=_A.get(t);if(f!==void 0){var p=$x,h=t;switch(t){case"keypress":if(Yh(e)===0)break e;case"keydown":case"keyup":p=XV;break;case"focusin":h="focus",p=y0;break;case"focusout":h="blur",p=y0;break;case"beforeblur":case"afterblur":p=y0;break;case"click":if(e.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=ZR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=FV;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=QV;break;case TA:case NA:case kA:p=jV;break;case IA:p=e$;break;case"scroll":p=PV;break;case"wheel":p=n$;break;case"copy":case"cut":case"paste":p=$V;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=tT}var v=(n&4)!==0,g=!v&&t==="scroll",m=v?f!==null?f+"Capture":null:f;v=[];for(var y=l,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,m!==null&&(w=lf(y,m),w!=null&&v.push(vf(y,w,b)))),g)break;y=y.return}0<v.length&&(f=new p(f,h,null,e,c),d.push({event:f,listeners:v}))}}if(!(n&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&e!==mb&&(h=e.relatedTarget||e.fromElement)&&($s(h)||h[Qo]))break e;if((p||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,p?(h=e.relatedTarget||e.toElement,p=l,h=h?$s(h):null,h!==null&&(g=xu(h),h!==g||h.tag!==5&&h.tag!==6)&&(h=null)):(p=null,h=l),p!==h)){if(v=ZR,w="onMouseLeave",m="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(v=tT,w="onPointerLeave",m="onPointerEnter",y="pointer"),g=p==null?f:fl(p),b=h==null?f:fl(h),f=new v(w,y+"leave",p,e,c),f.target=g,f.relatedTarget=b,w=null,$s(c)===l&&(v=new v(m,y+"enter",h,e,c),v.target=b,v.relatedTarget=g,w=v),g=w,p&&h)t:{for(v=p,m=h,y=0,b=v;b;b=$u(b))y++;for(b=0,w=m;w;w=$u(w))b++;for(;0<y-b;)v=$u(v),y--;for(;0<b-y;)m=$u(m),b--;for(;y--;){if(v===m||m!==null&&v===m.alternate)break t;v=$u(v),m=$u(m)}v=null}else v=null;p!==null&&fT(d,f,p,v,!1),h!==null&&g!==null&&fT(d,g,h,v,!0)}}e:{if(f=l?fl(l):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var x=l$;else if(iT(f))if(xA)x=p$;else{x=d$;var C=c$}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(x=f$);if(x&&(x=x(t,l))){wA(d,x,e,c);break e}C&&C(t,f,l),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&cb(f,"number",f.value)}switch(C=l?fl(l):window,t){case"focusin":(iT(C)||C.contentEditable==="true")&&(cl=C,Sb=l,Wd=null);break;case"focusout":Wd=Sb=cl=null;break;case"mousedown":Eb=!0;break;case"contextmenu":case"mouseup":case"dragend":Eb=!1,lT(d,e,c);break;case"selectionchange":if(v$)break;case"keydown":case"keyup":lT(d,e,c)}var E;if(Wx)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else ll?yA(t,e)&&(S="onCompositionEnd"):t==="keydown"&&e.keyCode===229&&(S="onCompositionStart");S&&(gA&&e.locale!=="ko"&&(ll||S!=="onCompositionStart"?S==="onCompositionEnd"&&ll&&(E=vA()):(Oa=c,Vx="value"in Oa?Oa.value:Oa.textContent,ll=!0)),C=Dm(l,S),0<C.length&&(S=new eT(S,t,null,e,c),d.push({event:S,listeners:C}),E?S.data=E:(E=bA(e),E!==null&&(S.data=E)))),(E=i$?o$(t,e):a$(t,e))&&(l=Dm(l,"onBeforeInput"),0<l.length&&(c=new eT("onBeforeInput","beforeinput",null,e,c),d.push({event:c,listeners:l}),c.data=E))}AA(d,n)})}function vf(t,n,e){return{instance:t,listener:n,currentTarget:e}}function Dm(t,n){for(var e=n+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=lf(t,e),o!=null&&r.unshift(vf(t,o,i)),o=lf(t,n),o!=null&&r.push(vf(t,o,i))),t=t.return}return r}function $u(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function fT(t,n,e,r,i){for(var o=n._reactName,a=[];e!==null&&e!==r;){var s=e,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,i?(u=lf(e,o),u!=null&&a.unshift(vf(e,u,s))):i||(u=lf(e,o),u!=null&&a.push(vf(e,u,s)))),e=e.return}a.length!==0&&t.push({event:n,listeners:a})}var w$=/\r\n?/g,x$=/\u0000|\uFFFD/g;function pT(t){return(typeof t=="string"?t:""+t).replace(w$,`
`).replace(x$,"")}function uh(t,n,e){if(n=pT(n),pT(t)!==n&&e)throw Error(ye(425))}function Mm(){}var Cb=null,Rb=null;function Tb(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Nb=typeof setTimeout=="function"?setTimeout:void 0,S$=typeof clearTimeout=="function"?clearTimeout:void 0,hT=typeof Promise=="function"?Promise:void 0,E$=typeof queueMicrotask=="function"?queueMicrotask:typeof hT<"u"?function(t){return hT.resolve(null).then(t).catch(C$)}:Nb;function C$(t){setTimeout(function(){throw t})}function T0(t,n){var e=n,r=0;do{var i=e.nextSibling;if(t.removeChild(e),i&&i.nodeType===8)if(e=i.data,e==="/$"){if(r===0){t.removeChild(i),ff(n);return}r--}else e!=="$"&&e!=="$?"&&e!=="$!"||r++;e=i}while(e);ff(n)}function Ga(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return t}function mT(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var e=t.data;if(e==="$"||e==="$!"||e==="$?"){if(n===0)return t;n--}else e==="/$"&&n++}t=t.previousSibling}return null}var wc=Math.random().toString(36).slice(2),ao="__reactFiber$"+wc,gf="__reactProps$"+wc,Qo="__reactContainer$"+wc,kb="__reactEvents$"+wc,R$="__reactListeners$"+wc,T$="__reactHandles$"+wc;function $s(t){var n=t[ao];if(n)return n;for(var e=t.parentNode;e;){if(n=e[Qo]||e[ao]){if(e=n.alternate,n.child!==null||e!==null&&e.child!==null)for(t=mT(t);t!==null;){if(e=t[ao])return e;t=mT(t)}return n}t=e,e=t.parentNode}return null}function Qf(t){return t=t[ao]||t[Qo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function fl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function Gv(t){return t[gf]||null}var Ib=[],pl=-1;function ps(t){return{current:t}}function Ht(t){0>pl||(t.current=Ib[pl],Ib[pl]=null,pl--)}function Bt(t,n){pl++,Ib[pl]=t.current,t.current=n}var os={},ur=ps(os),Dr=ps(!1),iu=os;function Vl(t,n){var e=t.type.contextTypes;if(!e)return os;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===n)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in e)i[o]=n[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=i),i}function Mr(t){return t=t.childContextTypes,t!=null}function Pm(){Ht(Dr),Ht(ur)}function vT(t,n,e){if(ur.current!==os)throw Error(ye(168));Bt(ur,n),Bt(Dr,e)}function DA(t,n,e){var r=t.stateNode;if(n=n.childContextTypes,typeof r.getChildContext!="function")return e;r=r.getChildContext();for(var i in r)if(!(i in n))throw Error(ye(108,cV(t)||"Unknown",i));return on({},e,r)}function Lm(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||os,iu=ur.current,Bt(ur,t),Bt(Dr,Dr.current),!0}function gT(t,n,e){var r=t.stateNode;if(!r)throw Error(ye(169));e?(t=DA(t,n,iu),r.__reactInternalMemoizedMergedChildContext=t,Ht(Dr),Ht(ur),Bt(ur,t)):Ht(Dr),Bt(Dr,e)}var zo=null,qv=!1,N0=!1;function MA(t){zo===null?zo=[t]:zo.push(t)}function N$(t){qv=!0,MA(t)}function hs(){if(!N0&&zo!==null){N0=!0;var t=0,n=Ot;try{var e=zo;for(Ot=1;t<e.length;t++){var r=e[t];do r=r(!0);while(r!==null)}zo=null,qv=!1}catch(i){throw zo!==null&&(zo=zo.slice(t+1)),oA(Fx,hs),i}finally{Ot=n,N0=!1}}return null}var hl=[],ml=0,Fm=null,zm=0,pi=[],hi=0,ou=null,Vo=1,$o="";function Os(t,n){hl[ml++]=zm,hl[ml++]=Fm,Fm=t,zm=n}function PA(t,n,e){pi[hi++]=Vo,pi[hi++]=$o,pi[hi++]=ou,ou=t;var r=Vo;t=$o;var i=32-Fi(r)-1;r&=~(1<<i),e+=1;var o=32-Fi(n)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Vo=1<<32-Fi(n)+i|e<<i|r,$o=o+t}else Vo=1<<o|e<<i|r,$o=t}function Gx(t){t.return!==null&&(Os(t,1),PA(t,1,0))}function qx(t){for(;t===Fm;)Fm=hl[--ml],hl[ml]=null,zm=hl[--ml],hl[ml]=null;for(;t===ou;)ou=pi[--hi],pi[hi]=null,$o=pi[--hi],pi[hi]=null,Vo=pi[--hi],pi[hi]=null}var Jr=null,Kr=null,Qt=!1,Oi=null;function LA(t,n){var e=gi(5,null,null,0);e.elementType="DELETED",e.stateNode=n,e.return=t,n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)}function yT(t,n){switch(t.tag){case 5:var e=t.type;return n=n.nodeType!==1||e.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(t.stateNode=n,Jr=t,Kr=Ga(n.firstChild),!0):!1;case 6:return n=t.pendingProps===""||n.nodeType!==3?null:n,n!==null?(t.stateNode=n,Jr=t,Kr=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(e=ou!==null?{id:Vo,overflow:$o}:null,t.memoizedState={dehydrated:n,treeContext:e,retryLane:1073741824},e=gi(18,null,null,0),e.stateNode=n,e.return=t,t.child=e,Jr=t,Kr=null,!0):!1;default:return!1}}function _b(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ab(t){if(Qt){var n=Kr;if(n){var e=n;if(!yT(t,n)){if(_b(t))throw Error(ye(418));n=Ga(e.nextSibling);var r=Jr;n&&yT(t,n)?LA(r,e):(t.flags=t.flags&-4097|2,Qt=!1,Jr=t)}}else{if(_b(t))throw Error(ye(418));t.flags=t.flags&-4097|2,Qt=!1,Jr=t}}}function bT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jr=t}function lh(t){if(t!==Jr)return!1;if(!Qt)return bT(t),Qt=!0,!1;var n;if((n=t.tag!==3)&&!(n=t.tag!==5)&&(n=t.type,n=n!=="head"&&n!=="body"&&!Tb(t.type,t.memoizedProps)),n&&(n=Kr)){if(_b(t))throw FA(),Error(ye(418));for(;n;)LA(t,n),n=Ga(n.nextSibling)}if(bT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8){var e=t.data;if(e==="/$"){if(n===0){Kr=Ga(t.nextSibling);break e}n--}else e!=="$"&&e!=="$!"&&e!=="$?"||n++}t=t.nextSibling}Kr=null}}else Kr=Jr?Ga(t.stateNode.nextSibling):null;return!0}function FA(){for(var t=Kr;t;)t=Ga(t.nextSibling)}function $l(){Kr=Jr=null,Qt=!1}function Kx(t){Oi===null?Oi=[t]:Oi.push(t)}var k$=oa.ReactCurrentBatchConfig;function _i(t,n){if(t&&t.defaultProps){n=on({},n),t=t.defaultProps;for(var e in t)n[e]===void 0&&(n[e]=t[e]);return n}return n}var Bm=ps(null),jm=null,vl=null,Xx=null;function Yx(){Xx=vl=jm=null}function Jx(t){var n=Bm.current;Ht(Bm),t._currentValue=n}function Ob(t,n,e){for(;t!==null;){var r=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,r!==null&&(r.childLanes|=n)):r!==null&&(r.childLanes&n)!==n&&(r.childLanes|=n),t===e)break;t=t.return}}function Nl(t,n){jm=t,Xx=vl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&n&&(Or=!0),t.firstContext=null)}function wi(t){var n=t._currentValue;if(Xx!==t)if(t={context:t,memoizedValue:n,next:null},vl===null){if(jm===null)throw Error(ye(308));vl=t,jm.dependencies={lanes:0,firstContext:t}}else vl=vl.next=t;return n}var Us=null;function Qx(t){Us===null?Us=[t]:Us.push(t)}function zA(t,n,e,r){var i=n.interleaved;return i===null?(e.next=e,Qx(n)):(e.next=i.next,i.next=e),n.interleaved=e,Zo(t,r)}function Zo(t,n){t.lanes|=n;var e=t.alternate;for(e!==null&&(e.lanes|=n),e=t,t=t.return;t!==null;)t.childLanes|=n,e=t.alternate,e!==null&&(e.childLanes|=n),e=t,t=t.return;return e.tag===3?e.stateNode:null}var Ra=!1;function Zx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function BA(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wo(t,n){return{eventTime:t,lane:n,tag:0,payload:null,callback:null,next:null}}function qa(t,n,e){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,St&2){var i=r.pending;return i===null?n.next=n:(n.next=i.next,i.next=n),r.pending=n,Zo(t,e)}return i=r.interleaved,i===null?(n.next=n,Qx(r)):(n.next=i.next,i.next=n),r.interleaved=n,Zo(t,e)}function Jh(t,n,e){if(n=n.updateQueue,n!==null&&(n=n.shared,(e&4194240)!==0)){var r=n.lanes;r&=t.pendingLanes,e|=r,n.lanes=e,zx(t,e)}}function wT(t,n){var e=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,e===r)){var i=null,o=null;if(e=e.firstBaseUpdate,e!==null){do{var a={eventTime:e.eventTime,lane:e.lane,tag:e.tag,payload:e.payload,callback:e.callback,next:null};o===null?i=o=a:o=o.next=a,e=e.next}while(e!==null);o===null?i=o=n:o=o.next=n}else i=o=n;e={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=e;return}t=e.lastBaseUpdate,t===null?e.firstBaseUpdate=n:t.next=n,e.lastBaseUpdate=n}function Vm(t,n,e,r){var i=t.updateQueue;Ra=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?o=l:a.next=l,a=u;var c=t.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(o!==null){var d=i.baseState;a=0,c=l=u=null,s=o;do{var f=s.lane,p=s.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=t,v=s;switch(f=n,p=e,v.tag){case 1:if(h=v.payload,typeof h=="function"){d=h.call(p,d,f);break e}d=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=v.payload,f=typeof h=="function"?h.call(p,d,f):h,f==null)break e;d=on({},d,f);break e;case 2:Ra=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[s]:f.push(s))}else p={eventTime:p,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=p,u=d):c=c.next=p,a|=f;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;f=s,s=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(c===null&&(u=d),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,n=i.shared.interleaved,n!==null){i=n;do a|=i.lane,i=i.next;while(i!==n)}else o===null&&(i.shared.lanes=0);su|=a,t.lanes=a,t.memoizedState=d}}function xT(t,n,e){if(t=n.effects,n.effects=null,t!==null)for(n=0;n<t.length;n++){var r=t[n],i=r.callback;if(i!==null){if(r.callback=null,r=e,typeof i!="function")throw Error(ye(191,i));i.call(r)}}}var jA=new z_.Component().refs;function Db(t,n,e,r){n=t.memoizedState,e=e(r,n),e=e==null?n:on({},n,e),t.memoizedState=e,t.lanes===0&&(t.updateQueue.baseState=e)}var Kv={isMounted:function(t){return(t=t._reactInternals)?xu(t)===t:!1},enqueueSetState:function(t,n,e){t=t._reactInternals;var r=gr(),i=Xa(t),o=Wo(r,i);o.payload=n,e!=null&&(o.callback=e),n=qa(t,o,i),n!==null&&(zi(n,t,i,r),Jh(n,t,i))},enqueueReplaceState:function(t,n,e){t=t._reactInternals;var r=gr(),i=Xa(t),o=Wo(r,i);o.tag=1,o.payload=n,e!=null&&(o.callback=e),n=qa(t,o,i),n!==null&&(zi(n,t,i,r),Jh(n,t,i))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var e=gr(),r=Xa(t),i=Wo(e,r);i.tag=2,n!=null&&(i.callback=n),n=qa(t,i,r),n!==null&&(zi(n,t,r,e),Jh(n,t,r))}};function ST(t,n,e,r,i,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):n.prototype&&n.prototype.isPureReactComponent?!hf(e,r)||!hf(i,o):!0}function VA(t,n,e){var r=!1,i=os,o=n.contextType;return typeof o=="object"&&o!==null?o=wi(o):(i=Mr(n)?iu:ur.current,r=n.contextTypes,o=(r=r!=null)?Vl(t,i):os),n=new n(e,o),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Kv,t.stateNode=n,n._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),n}function ET(t,n,e,r){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(e,r),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(e,r),n.state!==t&&Kv.enqueueReplaceState(n,n.state,null)}function Mb(t,n,e,r){var i=t.stateNode;i.props=e,i.state=t.memoizedState,i.refs=jA,Zx(t);var o=n.contextType;typeof o=="object"&&o!==null?i.context=wi(o):(o=Mr(n)?iu:ur.current,i.context=Vl(t,o)),i.state=t.memoizedState,o=n.getDerivedStateFromProps,typeof o=="function"&&(Db(t,n,o,e),i.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(n=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),n!==i.state&&Kv.enqueueReplaceState(i,i.state,null),Vm(t,e,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function nd(t,n,e){if(t=e.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(e._owner){if(e=e._owner,e){if(e.tag!==1)throw Error(ye(309));var r=e.stateNode}if(!r)throw Error(ye(147,t));var i=r,o=""+t;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===o?n.ref:(n=function(a){var s=i.refs;s===jA&&(s=i.refs={}),a===null?delete s[o]:s[o]=a},n._stringRef=o,n)}if(typeof t!="string")throw Error(ye(284));if(!e._owner)throw Error(ye(290,t))}return t}function ch(t,n){throw t=Object.prototype.toString.call(n),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}function CT(t){var n=t._init;return n(t._payload)}function $A(t){function n(m,y){if(t){var b=m.deletions;b===null?(m.deletions=[y],m.flags|=16):b.push(y)}}function e(m,y){if(!t)return null;for(;y!==null;)n(m,y),y=y.sibling;return null}function r(m,y){for(m=new Map;y!==null;)y.key!==null?m.set(y.key,y):m.set(y.index,y),y=y.sibling;return m}function i(m,y){return m=Ya(m,y),m.index=0,m.sibling=null,m}function o(m,y,b){return m.index=b,t?(b=m.alternate,b!==null?(b=b.index,b<y?(m.flags|=2,y):b):(m.flags|=2,y)):(m.flags|=1048576,y)}function a(m){return t&&m.alternate===null&&(m.flags|=2),m}function s(m,y,b,w){return y===null||y.tag!==6?(y=M0(b,m.mode,w),y.return=m,y):(y=i(y,b),y.return=m,y)}function u(m,y,b,w){var x=b.type;return x===ul?c(m,y,b.props.children,w,b.key):y!==null&&(y.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ca&&CT(x)===y.type)?(w=i(y,b.props),w.ref=nd(m,y,b),w.return=m,w):(w=rm(b.type,b.key,b.props,null,m.mode,w),w.ref=nd(m,y,b),w.return=m,w)}function l(m,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=P0(b,m.mode,w),y.return=m,y):(y=i(y,b.children||[]),y.return=m,y)}function c(m,y,b,w,x){return y===null||y.tag!==7?(y=Qs(b,m.mode,w,x),y.return=m,y):(y=i(y,b),y.return=m,y)}function d(m,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=M0(""+y,m.mode,b),y.return=m,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Zp:return b=rm(y.type,y.key,y.props,null,m.mode,b),b.ref=nd(m,null,y),b.return=m,b;case sl:return y=P0(y,m.mode,b),y.return=m,y;case Ca:var w=y._init;return d(m,w(y._payload),b)}if(_d(y)||Jc(y))return y=Qs(y,m.mode,b,null),y.return=m,y;ch(m,y)}return null}function f(m,y,b,w){var x=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return x!==null?null:s(m,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Zp:return b.key===x?u(m,y,b,w):null;case sl:return b.key===x?l(m,y,b,w):null;case Ca:return x=b._init,f(m,y,x(b._payload),w)}if(_d(b)||Jc(b))return x!==null?null:c(m,y,b,w,null);ch(m,b)}return null}function p(m,y,b,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(b)||null,s(y,m,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Zp:return m=m.get(w.key===null?b:w.key)||null,u(y,m,w,x);case sl:return m=m.get(w.key===null?b:w.key)||null,l(y,m,w,x);case Ca:var C=w._init;return p(m,y,b,C(w._payload),x)}if(_d(w)||Jc(w))return m=m.get(b)||null,c(y,m,w,x,null);ch(y,w)}return null}function h(m,y,b,w){for(var x=null,C=null,E=y,S=y=0,k=null;E!==null&&S<b.length;S++){E.index>S?(k=E,E=null):k=E.sibling;var N=f(m,E,b[S],w);if(N===null){E===null&&(E=k);break}t&&E&&N.alternate===null&&n(m,E),y=o(N,y,S),C===null?x=N:C.sibling=N,C=N,E=k}if(S===b.length)return e(m,E),Qt&&Os(m,S),x;if(E===null){for(;S<b.length;S++)E=d(m,b[S],w),E!==null&&(y=o(E,y,S),C===null?x=E:C.sibling=E,C=E);return Qt&&Os(m,S),x}for(E=r(m,E);S<b.length;S++)k=p(E,m,S,b[S],w),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?S:k.key),y=o(k,y,S),C===null?x=k:C.sibling=k,C=k);return t&&E.forEach(function(M){return n(m,M)}),Qt&&Os(m,S),x}function v(m,y,b,w){var x=Jc(b);if(typeof x!="function")throw Error(ye(150));if(b=x.call(b),b==null)throw Error(ye(151));for(var C=x=null,E=y,S=y=0,k=null,N=b.next();E!==null&&!N.done;S++,N=b.next()){E.index>S?(k=E,E=null):k=E.sibling;var M=f(m,E,N.value,w);if(M===null){E===null&&(E=k);break}t&&E&&M.alternate===null&&n(m,E),y=o(M,y,S),C===null?x=M:C.sibling=M,C=M,E=k}if(N.done)return e(m,E),Qt&&Os(m,S),x;if(E===null){for(;!N.done;S++,N=b.next())N=d(m,N.value,w),N!==null&&(y=o(N,y,S),C===null?x=N:C.sibling=N,C=N);return Qt&&Os(m,S),x}for(E=r(m,E);!N.done;S++,N=b.next())N=p(E,m,S,N.value,w),N!==null&&(t&&N.alternate!==null&&E.delete(N.key===null?S:N.key),y=o(N,y,S),C===null?x=N:C.sibling=N,C=N);return t&&E.forEach(function(D){return n(m,D)}),Qt&&Os(m,S),x}function g(m,y,b,w){if(typeof b=="object"&&b!==null&&b.type===ul&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Zp:e:{for(var x=b.key,C=y;C!==null;){if(C.key===x){if(x=b.type,x===ul){if(C.tag===7){e(m,C.sibling),y=i(C,b.props.children),y.return=m,m=y;break e}}else if(C.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ca&&CT(x)===C.type){e(m,C.sibling),y=i(C,b.props),y.ref=nd(m,C,b),y.return=m,m=y;break e}e(m,C);break}else n(m,C);C=C.sibling}b.type===ul?(y=Qs(b.props.children,m.mode,w,b.key),y.return=m,m=y):(w=rm(b.type,b.key,b.props,null,m.mode,w),w.ref=nd(m,y,b),w.return=m,m=w)}return a(m);case sl:e:{for(C=b.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){e(m,y.sibling),y=i(y,b.children||[]),y.return=m,m=y;break e}else{e(m,y);break}else n(m,y);y=y.sibling}y=P0(b,m.mode,w),y.return=m,m=y}return a(m);case Ca:return C=b._init,g(m,y,C(b._payload),w)}if(_d(b))return h(m,y,b,w);if(Jc(b))return v(m,y,b,w);ch(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(e(m,y.sibling),y=i(y,b),y.return=m,m=y):(e(m,y),y=M0(b,m.mode,w),y.return=m,m=y),a(m)):e(m,y)}return g}var Ul=$A(!0),UA=$A(!1),Zf={},mo=ps(Zf),yf=ps(Zf),bf=ps(Zf);function Ws(t){if(t===Zf)throw Error(ye(174));return t}function eS(t,n){switch(Bt(bf,n),Bt(yf,t),Bt(mo,Zf),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:fb(null,"");break;default:t=t===8?n.parentNode:n,n=t.namespaceURI||null,t=t.tagName,n=fb(n,t)}Ht(mo),Bt(mo,n)}function Wl(){Ht(mo),Ht(yf),Ht(bf)}function WA(t){Ws(bf.current);var n=Ws(mo.current),e=fb(n,t.type);n!==e&&(Bt(yf,t),Bt(mo,e))}function tS(t){yf.current===t&&(Ht(mo),Ht(yf))}var tn=ps(0);function $m(t){for(var n=t;n!==null;){if(n.tag===13){var e=n.memoizedState;if(e!==null&&(e=e.dehydrated,e===null||e.data==="$?"||e.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var k0=[];function nS(){for(var t=0;t<k0.length;t++)k0[t]._workInProgressVersionPrimary=null;k0.length=0}var Qh=oa.ReactCurrentDispatcher,I0=oa.ReactCurrentBatchConfig,au=0,nn=null,kn=null,Ln=null,Um=!1,Hd=!1,wf=0,I$=0;function Qn(){throw Error(ye(321))}function rS(t,n){if(n===null)return!1;for(var e=0;e<n.length&&e<t.length;e++)if(!Vi(t[e],n[e]))return!1;return!0}function iS(t,n,e,r,i,o){if(au=o,nn=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Qh.current=t===null||t.memoizedState===null?D$:M$,t=e(r,i),Hd){o=0;do{if(Hd=!1,wf=0,25<=o)throw Error(ye(301));o+=1,Ln=kn=null,n.updateQueue=null,Qh.current=P$,t=e(r,i)}while(Hd)}if(Qh.current=Wm,n=kn!==null&&kn.next!==null,au=0,Ln=kn=nn=null,Um=!1,n)throw Error(ye(300));return t}function oS(){var t=wf!==0;return wf=0,t}function no(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?nn.memoizedState=Ln=t:Ln=Ln.next=t,Ln}function xi(){if(kn===null){var t=nn.alternate;t=t!==null?t.memoizedState:null}else t=kn.next;var n=Ln===null?nn.memoizedState:Ln.next;if(n!==null)Ln=n,kn=t;else{if(t===null)throw Error(ye(310));kn=t,t={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},Ln===null?nn.memoizedState=Ln=t:Ln=Ln.next=t}return Ln}function xf(t,n){return typeof n=="function"?n(t):n}function _0(t){var n=xi(),e=n.queue;if(e===null)throw Error(ye(311));e.lastRenderedReducer=t;var r=kn,i=r.baseQueue,o=e.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,e.pending=null}if(i!==null){o=i.next,r=r.baseState;var s=a=null,u=null,l=o;do{var c=l.lane;if((au&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=d,a=r):u=u.next=d,nn.lanes|=c,su|=c}l=l.next}while(l!==null&&l!==o);u===null?a=r:u.next=s,Vi(r,n.memoizedState)||(Or=!0),n.memoizedState=r,n.baseState=a,n.baseQueue=u,e.lastRenderedState=r}if(t=e.interleaved,t!==null){i=t;do o=i.lane,nn.lanes|=o,su|=o,i=i.next;while(i!==t)}else i===null&&(e.lanes=0);return[n.memoizedState,e.dispatch]}function A0(t){var n=xi(),e=n.queue;if(e===null)throw Error(ye(311));e.lastRenderedReducer=t;var r=e.dispatch,i=e.pending,o=n.memoizedState;if(i!==null){e.pending=null;var a=i=i.next;do o=t(o,a.action),a=a.next;while(a!==i);Vi(o,n.memoizedState)||(Or=!0),n.memoizedState=o,n.baseQueue===null&&(n.baseState=o),e.lastRenderedState=o}return[o,r]}function HA(){}function GA(t,n){var e=nn,r=xi(),i=n(),o=!Vi(r.memoizedState,i);if(o&&(r.memoizedState=i,Or=!0),r=r.queue,aS(XA.bind(null,e,r,t),[t]),r.getSnapshot!==n||o||Ln!==null&&Ln.memoizedState.tag&1){if(e.flags|=2048,Sf(9,KA.bind(null,e,r,i,n),void 0,null),zn===null)throw Error(ye(349));au&30||qA(e,n,i)}return i}function qA(t,n,e){t.flags|=16384,t={getSnapshot:n,value:e},n=nn.updateQueue,n===null?(n={lastEffect:null,stores:null},nn.updateQueue=n,n.stores=[t]):(e=n.stores,e===null?n.stores=[t]:e.push(t))}function KA(t,n,e,r){n.value=e,n.getSnapshot=r,YA(n)&&JA(t)}function XA(t,n,e){return e(function(){YA(n)&&JA(t)})}function YA(t){var n=t.getSnapshot;t=t.value;try{var e=n();return!Vi(t,e)}catch{return!0}}function JA(t){var n=Zo(t,1);n!==null&&zi(n,t,1,-1)}function RT(t){var n=no();return typeof t=="function"&&(t=t()),n.memoizedState=n.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xf,lastRenderedState:t},n.queue=t,t=t.dispatch=O$.bind(null,nn,t),[n.memoizedState,t]}function Sf(t,n,e,r){return t={tag:t,create:n,destroy:e,deps:r,next:null},n=nn.updateQueue,n===null?(n={lastEffect:null,stores:null},nn.updateQueue=n,n.lastEffect=t.next=t):(e=n.lastEffect,e===null?n.lastEffect=t.next=t:(r=e.next,e.next=t,t.next=r,n.lastEffect=t)),t}function QA(){return xi().memoizedState}function Zh(t,n,e,r){var i=no();nn.flags|=t,i.memoizedState=Sf(1|n,e,void 0,r===void 0?null:r)}function Xv(t,n,e,r){var i=xi();r=r===void 0?null:r;var o=void 0;if(kn!==null){var a=kn.memoizedState;if(o=a.destroy,r!==null&&rS(r,a.deps)){i.memoizedState=Sf(n,e,o,r);return}}nn.flags|=t,i.memoizedState=Sf(1|n,e,o,r)}function TT(t,n){return Zh(8390656,8,t,n)}function aS(t,n){return Xv(2048,8,t,n)}function ZA(t,n){return Xv(4,2,t,n)}function eO(t,n){return Xv(4,4,t,n)}function tO(t,n){if(typeof n=="function")return t=t(),n(t),function(){n(null)};if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function nO(t,n,e){return e=e!=null?e.concat([t]):null,Xv(4,4,tO.bind(null,n,t),e)}function sS(){}function rO(t,n){var e=xi();n=n===void 0?null:n;var r=e.memoizedState;return r!==null&&n!==null&&rS(n,r[1])?r[0]:(e.memoizedState=[t,n],t)}function iO(t,n){var e=xi();n=n===void 0?null:n;var r=e.memoizedState;return r!==null&&n!==null&&rS(n,r[1])?r[0]:(t=t(),e.memoizedState=[t,n],t)}function oO(t,n,e){return au&21?(Vi(e,n)||(e=uA(),nn.lanes|=e,su|=e,t.baseState=!0),n):(t.baseState&&(t.baseState=!1,Or=!0),t.memoizedState=e)}function _$(t,n){var e=Ot;Ot=e!==0&&4>e?e:4,t(!0);var r=I0.transition;I0.transition={};try{t(!1),n()}finally{Ot=e,I0.transition=r}}function aO(){return xi().memoizedState}function A$(t,n,e){var r=Xa(t);if(e={lane:r,action:e,hasEagerState:!1,eagerState:null,next:null},sO(t))uO(n,e);else if(e=zA(t,n,e,r),e!==null){var i=gr();zi(e,t,r,i),lO(e,n,r)}}function O$(t,n,e){var r=Xa(t),i={lane:r,action:e,hasEagerState:!1,eagerState:null,next:null};if(sO(t))uO(n,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=n.lastRenderedReducer,o!==null))try{var a=n.lastRenderedState,s=o(a,e);if(i.hasEagerState=!0,i.eagerState=s,Vi(s,a)){var u=n.interleaved;u===null?(i.next=i,Qx(n)):(i.next=u.next,u.next=i),n.interleaved=i;return}}catch{}finally{}e=zA(t,n,i,r),e!==null&&(i=gr(),zi(e,t,r,i),lO(e,n,r))}}function sO(t){var n=t.alternate;return t===nn||n!==null&&n===nn}function uO(t,n){Hd=Um=!0;var e=t.pending;e===null?n.next=n:(n.next=e.next,e.next=n),t.pending=n}function lO(t,n,e){if(e&4194240){var r=n.lanes;r&=t.pendingLanes,e|=r,n.lanes=e,zx(t,e)}}var Wm={readContext:wi,useCallback:Qn,useContext:Qn,useEffect:Qn,useImperativeHandle:Qn,useInsertionEffect:Qn,useLayoutEffect:Qn,useMemo:Qn,useReducer:Qn,useRef:Qn,useState:Qn,useDebugValue:Qn,useDeferredValue:Qn,useTransition:Qn,useMutableSource:Qn,useSyncExternalStore:Qn,useId:Qn,unstable_isNewReconciler:!1},D$={readContext:wi,useCallback:function(t,n){return no().memoizedState=[t,n===void 0?null:n],t},useContext:wi,useEffect:TT,useImperativeHandle:function(t,n,e){return e=e!=null?e.concat([t]):null,Zh(4194308,4,tO.bind(null,n,t),e)},useLayoutEffect:function(t,n){return Zh(4194308,4,t,n)},useInsertionEffect:function(t,n){return Zh(4,2,t,n)},useMemo:function(t,n){var e=no();return n=n===void 0?null:n,t=t(),e.memoizedState=[t,n],t},useReducer:function(t,n,e){var r=no();return n=e!==void 0?e(n):n,r.memoizedState=r.baseState=n,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},r.queue=t,t=t.dispatch=A$.bind(null,nn,t),[r.memoizedState,t]},useRef:function(t){var n=no();return t={current:t},n.memoizedState=t},useState:RT,useDebugValue:sS,useDeferredValue:function(t){return no().memoizedState=t},useTransition:function(){var t=RT(!1),n=t[0];return t=_$.bind(null,t[1]),no().memoizedState=t,[n,t]},useMutableSource:function(){},useSyncExternalStore:function(t,n,e){var r=nn,i=no();if(Qt){if(e===void 0)throw Error(ye(407));e=e()}else{if(e=n(),zn===null)throw Error(ye(349));au&30||qA(r,n,e)}i.memoizedState=e;var o={value:e,getSnapshot:n};return i.queue=o,TT(XA.bind(null,r,o,t),[t]),r.flags|=2048,Sf(9,KA.bind(null,r,o,e,n),void 0,null),e},useId:function(){var t=no(),n=zn.identifierPrefix;if(Qt){var e=$o,r=Vo;e=(r&~(1<<32-Fi(r)-1)).toString(32)+e,n=":"+n+"R"+e,e=wf++,0<e&&(n+="H"+e.toString(32)),n+=":"}else e=I$++,n=":"+n+"r"+e.toString(32)+":";return t.memoizedState=n},unstable_isNewReconciler:!1},M$={readContext:wi,useCallback:rO,useContext:wi,useEffect:aS,useImperativeHandle:nO,useInsertionEffect:ZA,useLayoutEffect:eO,useMemo:iO,useReducer:_0,useRef:QA,useState:function(){return _0(xf)},useDebugValue:sS,useDeferredValue:function(t){var n=xi();return oO(n,kn.memoizedState,t)},useTransition:function(){var t=_0(xf)[0],n=xi().memoizedState;return[t,n]},useMutableSource:HA,useSyncExternalStore:GA,useId:aO,unstable_isNewReconciler:!1},P$={readContext:wi,useCallback:rO,useContext:wi,useEffect:aS,useImperativeHandle:nO,useInsertionEffect:ZA,useLayoutEffect:eO,useMemo:iO,useReducer:A0,useRef:QA,useState:function(){return A0(xf)},useDebugValue:sS,useDeferredValue:function(t){var n=xi();return kn===null?n.memoizedState=t:oO(n,kn.memoizedState,t)},useTransition:function(){var t=A0(xf)[0],n=xi().memoizedState;return[t,n]},useMutableSource:HA,useSyncExternalStore:GA,useId:aO,unstable_isNewReconciler:!1};function Hl(t,n){try{var e="",r=n;do e+=lV(r),r=r.return;while(r);var i=e}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:n,stack:i,digest:null}}function O0(t,n,e){return{value:t,source:null,stack:e??null,digest:n??null}}function Pb(t,n){try{console.error(n.value)}catch(e){setTimeout(function(){throw e})}}var L$=typeof WeakMap=="function"?WeakMap:Map;function cO(t,n,e){e=Wo(-1,e),e.tag=3,e.payload={element:null};var r=n.value;return e.callback=function(){Gm||(Gm=!0,Hb=r),Pb(t,n)},e}function dO(t,n,e){e=Wo(-1,e),e.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=n.value;e.payload=function(){return r(i)},e.callback=function(){Pb(t,n)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(e.callback=function(){Pb(t,n),typeof r!="function"&&(Ka===null?Ka=new Set([this]):Ka.add(this));var a=n.stack;this.componentDidCatch(n.value,{componentStack:a!==null?a:""})}),e}function NT(t,n,e){var r=t.pingCache;if(r===null){r=t.pingCache=new L$;var i=new Set;r.set(n,i)}else i=r.get(n),i===void 0&&(i=new Set,r.set(n,i));i.has(e)||(i.add(e),t=Y$.bind(null,t,n,e),n.then(t,t))}function kT(t){do{var n;if((n=t.tag===13)&&(n=t.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return t;t=t.return}while(t!==null);return null}function IT(t,n,e,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===n?t.flags|=65536:(t.flags|=128,e.flags|=131072,e.flags&=-52805,e.tag===1&&(e.alternate===null?e.tag=17:(n=Wo(-1,1),n.tag=2,qa(e,n,1))),e.lanes|=1),t)}var F$=oa.ReactCurrentOwner,Or=!1;function pr(t,n,e,r){n.child=t===null?UA(n,null,e,r):Ul(n,t.child,e,r)}function _T(t,n,e,r,i){e=e.render;var o=n.ref;return Nl(n,i),r=iS(t,n,e,r,o,i),e=oS(),t!==null&&!Or?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~i,ea(t,n,i)):(Qt&&e&&Gx(n),n.flags|=1,pr(t,n,r,i),n.child)}function AT(t,n,e,r,i){if(t===null){var o=e.type;return typeof o=="function"&&!mS(o)&&o.defaultProps===void 0&&e.compare===null&&e.defaultProps===void 0?(n.tag=15,n.type=o,fO(t,n,o,r,i)):(t=rm(e.type,null,r,n,n.mode,i),t.ref=n.ref,t.return=n,n.child=t)}if(o=t.child,!(t.lanes&i)){var a=o.memoizedProps;if(e=e.compare,e=e!==null?e:hf,e(a,r)&&t.ref===n.ref)return ea(t,n,i)}return n.flags|=1,t=Ya(o,r),t.ref=n.ref,t.return=n,n.child=t}function fO(t,n,e,r,i){if(t!==null){var o=t.memoizedProps;if(hf(o,r)&&t.ref===n.ref)if(Or=!1,n.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Or=!0);else return n.lanes=t.lanes,ea(t,n,i)}return Lb(t,n,e,r,i)}function pO(t,n,e){var r=n.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bt(yl,$r),$r|=e;else{if(!(e&1073741824))return t=o!==null?o.baseLanes|e:e,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:t,cachePool:null,transitions:null},n.updateQueue=null,Bt(yl,$r),$r|=t,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:e,Bt(yl,$r),$r|=r}else o!==null?(r=o.baseLanes|e,n.memoizedState=null):r=e,Bt(yl,$r),$r|=r;return pr(t,n,i,e),n.child}function hO(t,n){var e=n.ref;(t===null&&e!==null||t!==null&&t.ref!==e)&&(n.flags|=512,n.flags|=2097152)}function Lb(t,n,e,r,i){var o=Mr(e)?iu:ur.current;return o=Vl(n,o),Nl(n,i),e=iS(t,n,e,r,o,i),r=oS(),t!==null&&!Or?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~i,ea(t,n,i)):(Qt&&r&&Gx(n),n.flags|=1,pr(t,n,e,i),n.child)}function OT(t,n,e,r,i){if(Mr(e)){var o=!0;Lm(n)}else o=!1;if(Nl(n,i),n.stateNode===null)em(t,n),VA(n,e,r),Mb(n,e,r,i),r=!0;else if(t===null){var a=n.stateNode,s=n.memoizedProps;a.props=s;var u=a.context,l=e.contextType;typeof l=="object"&&l!==null?l=wi(l):(l=Mr(e)?iu:ur.current,l=Vl(n,l));var c=e.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&ET(n,a,r,l),Ra=!1;var f=n.memoizedState;a.state=f,Vm(n,r,a,i),u=n.memoizedState,s!==r||f!==u||Dr.current||Ra?(typeof c=="function"&&(Db(n,e,c,r),u=n.memoizedState),(s=Ra||ST(n,e,s,r,f,u,l))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(n.flags|=4194308)):(typeof a.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=r,n.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(n.flags|=4194308),r=!1)}else{a=n.stateNode,BA(t,n),s=n.memoizedProps,l=n.type===n.elementType?s:_i(n.type,s),a.props=l,d=n.pendingProps,f=a.context,u=e.contextType,typeof u=="object"&&u!==null?u=wi(u):(u=Mr(e)?iu:ur.current,u=Vl(n,u));var p=e.getDerivedStateFromProps;(c=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||f!==u)&&ET(n,a,r,u),Ra=!1,f=n.memoizedState,a.state=f,Vm(n,r,a,i);var h=n.memoizedState;s!==d||f!==h||Dr.current||Ra?(typeof p=="function"&&(Db(n,e,p,r),h=n.memoizedState),(l=Ra||ST(n,e,l,r,f,h,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,h,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,h,u)),typeof a.componentDidUpdate=="function"&&(n.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(n.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(n.flags|=1024),n.memoizedProps=r,n.memoizedState=h),a.props=r,a.state=h,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(n.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(n.flags|=1024),r=!1)}return Fb(t,n,e,r,o,i)}function Fb(t,n,e,r,i,o){hO(t,n);var a=(n.flags&128)!==0;if(!r&&!a)return i&&gT(n,e,!1),ea(t,n,o);r=n.stateNode,F$.current=n;var s=a&&typeof e.getDerivedStateFromError!="function"?null:r.render();return n.flags|=1,t!==null&&a?(n.child=Ul(n,t.child,null,o),n.child=Ul(n,null,s,o)):pr(t,n,s,o),n.memoizedState=r.state,i&&gT(n,e,!0),n.child}function mO(t){var n=t.stateNode;n.pendingContext?vT(t,n.pendingContext,n.pendingContext!==n.context):n.context&&vT(t,n.context,!1),eS(t,n.containerInfo)}function DT(t,n,e,r,i){return $l(),Kx(i),n.flags|=256,pr(t,n,e,r),n.child}var zb={dehydrated:null,treeContext:null,retryLane:0};function Bb(t){return{baseLanes:t,cachePool:null,transitions:null}}function vO(t,n,e){var r=n.pendingProps,i=tn.current,o=!1,a=(n.flags&128)!==0,s;if((s=a)||(s=t!==null&&t.memoizedState===null?!1:(i&2)!==0),s?(o=!0,n.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Bt(tn,i&1),t===null)return Ab(n),t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(n.mode&1?t.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(a=r.children,t=r.fallback,o?(r=n.mode,o=n.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Qv(a,r,0,null),t=Qs(t,r,e,null),o.return=n,t.return=n,o.sibling=t,n.child=o,n.child.memoizedState=Bb(e),n.memoizedState=zb,t):uS(n,a));if(i=t.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return z$(t,n,a,r,s,i,e);if(o){o=r.fallback,a=n.mode,i=t.child,s=i.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&n.child!==i?(r=n.child,r.childLanes=0,r.pendingProps=u,n.deletions=null):(r=Ya(i,u),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?o=Ya(s,o):(o=Qs(o,a,e,null),o.flags|=2),o.return=n,r.return=n,r.sibling=o,n.child=r,r=o,o=n.child,a=t.child.memoizedState,a=a===null?Bb(e):{baseLanes:a.baseLanes|e,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~e,n.memoizedState=zb,r}return o=t.child,t=o.sibling,r=Ya(o,{mode:"visible",children:r.children}),!(n.mode&1)&&(r.lanes=e),r.return=n,r.sibling=null,t!==null&&(e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)),n.child=r,n.memoizedState=null,r}function uS(t,n){return n=Qv({mode:"visible",children:n},t.mode,0,null),n.return=t,t.child=n}function dh(t,n,e,r){return r!==null&&Kx(r),Ul(n,t.child,null,e),t=uS(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function z$(t,n,e,r,i,o,a){if(e)return n.flags&256?(n.flags&=-257,r=O0(Error(ye(422))),dh(t,n,a,r)):n.memoizedState!==null?(n.child=t.child,n.flags|=128,null):(o=r.fallback,i=n.mode,r=Qv({mode:"visible",children:r.children},i,0,null),o=Qs(o,i,a,null),o.flags|=2,r.return=n,o.return=n,r.sibling=o,n.child=r,n.mode&1&&Ul(n,t.child,null,a),n.child.memoizedState=Bb(a),n.memoizedState=zb,o);if(!(n.mode&1))return dh(t,n,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,o=Error(ye(419)),r=O0(o,r,void 0),dh(t,n,a,r)}if(s=(a&t.childLanes)!==0,Or||s){if(r=zn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Zo(t,i),zi(r,t,i,-1))}return hS(),r=O0(Error(ye(421))),dh(t,n,a,r)}return i.data==="$?"?(n.flags|=128,n.child=t.child,n=J$.bind(null,t),i._reactRetry=n,null):(t=o.treeContext,Kr=Ga(i.nextSibling),Jr=n,Qt=!0,Oi=null,t!==null&&(pi[hi++]=Vo,pi[hi++]=$o,pi[hi++]=ou,Vo=t.id,$o=t.overflow,ou=n),n=uS(n,r.children),n.flags|=4096,n)}function MT(t,n,e){t.lanes|=n;var r=t.alternate;r!==null&&(r.lanes|=n),Ob(t.return,n,e)}function D0(t,n,e,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:r,tail:e,tailMode:i}:(o.isBackwards=n,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=e,o.tailMode=i)}function gO(t,n,e){var r=n.pendingProps,i=r.revealOrder,o=r.tail;if(pr(t,n,r.children,e),r=tn.current,r&2)r=r&1|2,n.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&MT(t,e,n);else if(t.tag===19)MT(t,e,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Bt(tn,r),!(n.mode&1))n.memoizedState=null;else switch(i){case"forwards":for(e=n.child,i=null;e!==null;)t=e.alternate,t!==null&&$m(t)===null&&(i=e),e=e.sibling;e=i,e===null?(i=n.child,n.child=null):(i=e.sibling,e.sibling=null),D0(n,!1,i,e,o);break;case"backwards":for(e=null,i=n.child,n.child=null;i!==null;){if(t=i.alternate,t!==null&&$m(t)===null){n.child=i;break}t=i.sibling,i.sibling=e,e=i,i=t}D0(n,!0,e,null,o);break;case"together":D0(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function em(t,n){!(n.mode&1)&&t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2)}function ea(t,n,e){if(t!==null&&(n.dependencies=t.dependencies),su|=n.lanes,!(e&n.childLanes))return null;if(t!==null&&n.child!==t.child)throw Error(ye(153));if(n.child!==null){for(t=n.child,e=Ya(t,t.pendingProps),n.child=e,e.return=n;t.sibling!==null;)t=t.sibling,e=e.sibling=Ya(t,t.pendingProps),e.return=n;e.sibling=null}return n.child}function B$(t,n,e){switch(n.tag){case 3:mO(n),$l();break;case 5:WA(n);break;case 1:Mr(n.type)&&Lm(n);break;case 4:eS(n,n.stateNode.containerInfo);break;case 10:var r=n.type._context,i=n.memoizedProps.value;Bt(Bm,r._currentValue),r._currentValue=i;break;case 13:if(r=n.memoizedState,r!==null)return r.dehydrated!==null?(Bt(tn,tn.current&1),n.flags|=128,null):e&n.child.childLanes?vO(t,n,e):(Bt(tn,tn.current&1),t=ea(t,n,e),t!==null?t.sibling:null);Bt(tn,tn.current&1);break;case 19:if(r=(e&n.childLanes)!==0,t.flags&128){if(r)return gO(t,n,e);n.flags|=128}if(i=n.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Bt(tn,tn.current),r)break;return null;case 22:case 23:return n.lanes=0,pO(t,n,e)}return ea(t,n,e)}var yO,jb,bO,wO;yO=function(t,n){for(var e=n.child;e!==null;){if(e.tag===5||e.tag===6)t.appendChild(e.stateNode);else if(e.tag!==4&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return;e=e.return}e.sibling.return=e.return,e=e.sibling}};jb=function(){};bO=function(t,n,e,r){var i=t.memoizedProps;if(i!==r){t=n.stateNode,Ws(mo.current);var o=null;switch(e){case"input":i=ub(t,i),r=ub(t,r),o=[];break;case"select":i=on({},i,{value:void 0}),r=on({},r,{value:void 0}),o=[];break;case"textarea":i=db(t,i),r=db(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Mm)}pb(e,r);var a;e=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var s=i[l];for(a in s)s.hasOwnProperty(a)&&(e||(e={}),e[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(sf.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var u=r[l];if(s=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(e||(e={}),e[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(e||(e={}),e[a]=u[a])}else e||(o||(o=[]),o.push(l,e)),e=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(o=o||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(sf.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Vt("scroll",t),o||s===u||(o=[])):(o=o||[]).push(l,u))}e&&(o=o||[]).push("style",e);var l=o;(n.updateQueue=l)&&(n.flags|=4)}};wO=function(t,n,e,r){e!==r&&(n.flags|=4)};function rd(t,n){if(!Qt)switch(t.tailMode){case"hidden":n=t.tail;for(var e=null;n!==null;)n.alternate!==null&&(e=n),n=n.sibling;e===null?t.tail=null:e.sibling=null;break;case"collapsed":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Zn(t){var n=t.alternate!==null&&t.alternate.child===t.child,e=0,r=0;if(n)for(var i=t.child;i!==null;)e|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)e|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=e,n}function j$(t,n,e){var r=n.pendingProps;switch(qx(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(n),null;case 1:return Mr(n.type)&&Pm(),Zn(n),null;case 3:return r=n.stateNode,Wl(),Ht(Dr),Ht(ur),nS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(lh(n)?n.flags|=4:t===null||t.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Oi!==null&&(Kb(Oi),Oi=null))),jb(t,n),Zn(n),null;case 5:tS(n);var i=Ws(bf.current);if(e=n.type,t!==null&&n.stateNode!=null)bO(t,n,e,r,i),t.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!r){if(n.stateNode===null)throw Error(ye(166));return Zn(n),null}if(t=Ws(mo.current),lh(n)){r=n.stateNode,e=n.type;var o=n.memoizedProps;switch(r[ao]=n,r[gf]=o,t=(n.mode&1)!==0,e){case"dialog":Vt("cancel",r),Vt("close",r);break;case"iframe":case"object":case"embed":Vt("load",r);break;case"video":case"audio":for(i=0;i<Od.length;i++)Vt(Od[i],r);break;case"source":Vt("error",r);break;case"img":case"image":case"link":Vt("error",r),Vt("load",r);break;case"details":Vt("toggle",r);break;case"input":UR(r,o),Vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Vt("invalid",r);break;case"textarea":HR(r,o),Vt("invalid",r)}pb(e,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="children"?typeof s=="string"?r.textContent!==s&&(o.suppressHydrationWarning!==!0&&uh(r.textContent,s,t),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&uh(r.textContent,s,t),i=["children",""+s]):sf.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&Vt("scroll",r)}switch(e){case"input":eh(r),WR(r,o,!0);break;case"textarea":eh(r),GR(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Mm)}r=i,n.updateQueue=r,r!==null&&(n.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=q_(e)),t==="http://www.w3.org/1999/xhtml"?e==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(e,{is:r.is}):(t=a.createElement(e),e==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,e),t[ao]=n,t[gf]=r,yO(t,n,!1,!1),n.stateNode=t;e:{switch(a=hb(e,r),e){case"dialog":Vt("cancel",t),Vt("close",t),i=r;break;case"iframe":case"object":case"embed":Vt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Od.length;i++)Vt(Od[i],t);i=r;break;case"source":Vt("error",t),i=r;break;case"img":case"image":case"link":Vt("error",t),Vt("load",t),i=r;break;case"details":Vt("toggle",t),i=r;break;case"input":UR(t,r),i=ub(t,r),Vt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=on({},r,{value:void 0}),Vt("invalid",t);break;case"textarea":HR(t,r),i=db(t,r),Vt("invalid",t);break;default:i=r}pb(e,i),s=i;for(o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="style"?Y_(t,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&K_(t,u)):o==="children"?typeof u=="string"?(e!=="textarea"||u!=="")&&uf(t,u):typeof u=="number"&&uf(t,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(sf.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Vt("scroll",t):u!=null&&Ox(t,o,u,a))}switch(e){case"input":eh(t),WR(t,r,!1);break;case"textarea":eh(t),GR(t);break;case"option":r.value!=null&&t.setAttribute("value",""+is(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?El(t,!!r.multiple,o,!1):r.defaultValue!=null&&El(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Mm)}switch(e){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Zn(n),null;case 6:if(t&&n.stateNode!=null)wO(t,n,t.memoizedProps,r);else{if(typeof r!="string"&&n.stateNode===null)throw Error(ye(166));if(e=Ws(bf.current),Ws(mo.current),lh(n)){if(r=n.stateNode,e=n.memoizedProps,r[ao]=n,(o=r.nodeValue!==e)&&(t=Jr,t!==null))switch(t.tag){case 3:uh(r.nodeValue,e,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&uh(r.nodeValue,e,(t.mode&1)!==0)}o&&(n.flags|=4)}else r=(e.nodeType===9?e:e.ownerDocument).createTextNode(r),r[ao]=n,n.stateNode=r}return Zn(n),null;case 13:if(Ht(tn),r=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Qt&&Kr!==null&&n.mode&1&&!(n.flags&128))FA(),$l(),n.flags|=98560,o=!1;else if(o=lh(n),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ye(318));if(o=n.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ye(317));o[ao]=n}else $l(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Zn(n),o=!1}else Oi!==null&&(Kb(Oi),Oi=null),o=!0;if(!o)return n.flags&65536?n:null}return n.flags&128?(n.lanes=e,n):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(n.child.flags|=8192,n.mode&1&&(t===null||tn.current&1?In===0&&(In=3):hS())),n.updateQueue!==null&&(n.flags|=4),Zn(n),null);case 4:return Wl(),jb(t,n),t===null&&mf(n.stateNode.containerInfo),Zn(n),null;case 10:return Jx(n.type._context),Zn(n),null;case 17:return Mr(n.type)&&Pm(),Zn(n),null;case 19:if(Ht(tn),o=n.memoizedState,o===null)return Zn(n),null;if(r=(n.flags&128)!==0,a=o.rendering,a===null)if(r)rd(o,!1);else{if(In!==0||t!==null&&t.flags&128)for(t=n.child;t!==null;){if(a=$m(t),a!==null){for(n.flags|=128,rd(o,!1),r=a.updateQueue,r!==null&&(n.updateQueue=r,n.flags|=4),n.subtreeFlags=0,r=e,e=n.child;e!==null;)o=e,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e=e.sibling;return Bt(tn,tn.current&1|2),n.child}t=t.sibling}o.tail!==null&&vn()>Gl&&(n.flags|=128,r=!0,rd(o,!1),n.lanes=4194304)}else{if(!r)if(t=$m(a),t!==null){if(n.flags|=128,r=!0,e=t.updateQueue,e!==null&&(n.updateQueue=e,n.flags|=4),rd(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Qt)return Zn(n),null}else 2*vn()-o.renderingStartTime>Gl&&e!==1073741824&&(n.flags|=128,r=!0,rd(o,!1),n.lanes=4194304);o.isBackwards?(a.sibling=n.child,n.child=a):(e=o.last,e!==null?e.sibling=a:n.child=a,o.last=a)}return o.tail!==null?(n=o.tail,o.rendering=n,o.tail=n.sibling,o.renderingStartTime=vn(),n.sibling=null,e=tn.current,Bt(tn,r?e&1|2:e&1),n):(Zn(n),null);case 22:case 23:return pS(),r=n.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(n.flags|=8192),r&&n.mode&1?$r&1073741824&&(Zn(n),n.subtreeFlags&6&&(n.flags|=8192)):Zn(n),null;case 24:return null;case 25:return null}throw Error(ye(156,n.tag))}function V$(t,n){switch(qx(n),n.tag){case 1:return Mr(n.type)&&Pm(),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Wl(),Ht(Dr),Ht(ur),nS(),t=n.flags,t&65536&&!(t&128)?(n.flags=t&-65537|128,n):null;case 5:return tS(n),null;case 13:if(Ht(tn),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(ye(340));$l()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return Ht(tn),null;case 4:return Wl(),null;case 10:return Jx(n.type._context),null;case 22:case 23:return pS(),null;case 24:return null;default:return null}}var fh=!1,ar=!1,$$=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function gl(t,n){var e=t.ref;if(e!==null)if(typeof e=="function")try{e(null)}catch(r){cn(t,n,r)}else e.current=null}function Vb(t,n,e){try{e()}catch(r){cn(t,n,r)}}var PT=!1;function U$(t,n){if(Cb=Am,t=CA(),Hx(t)){if("selectionStart"in t)var e={start:t.selectionStart,end:t.selectionEnd};else e:{e=(e=t.ownerDocument)&&e.defaultView||window;var r=e.getSelection&&e.getSelection();if(r&&r.rangeCount!==0){e=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{e.nodeType,o.nodeType}catch{e=null;break e}var a=0,s=-1,u=-1,l=0,c=0,d=t,f=null;t:for(;;){for(var p;d!==e||i!==0&&d.nodeType!==3||(s=a+i),d!==o||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===t)break t;if(f===e&&++l===i&&(s=a),f===o&&++c===r&&(u=a),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}e=s===-1||u===-1?null:{start:s,end:u}}else e=null}e=e||{start:0,end:0}}else e=null;for(Rb={focusedElem:t,selectionRange:e},Am=!1,Ne=n;Ne!==null;)if(n=Ne,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,Ne=t;else for(;Ne!==null;){n=Ne;try{var h=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var v=h.memoizedProps,g=h.memoizedState,m=n.stateNode,y=m.getSnapshotBeforeUpdate(n.elementType===n.type?v:_i(n.type,v),g);m.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=n.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(w){cn(n,n.return,w)}if(t=n.sibling,t!==null){t.return=n.return,Ne=t;break}Ne=n.return}return h=PT,PT=!1,h}function Gd(t,n,e){var r=n.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Vb(n,e,o)}i=i.next}while(i!==r)}}function Yv(t,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var e=n=n.next;do{if((e.tag&t)===t){var r=e.create;e.destroy=r()}e=e.next}while(e!==n)}}function $b(t){var n=t.ref;if(n!==null){var e=t.stateNode;switch(t.tag){case 5:t=e;break;default:t=e}typeof n=="function"?n(t):n.current=t}}function xO(t){var n=t.alternate;n!==null&&(t.alternate=null,xO(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&(delete n[ao],delete n[gf],delete n[kb],delete n[R$],delete n[T$])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function SO(t){return t.tag===5||t.tag===3||t.tag===4}function LT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||SO(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ub(t,n,e){var r=t.tag;if(r===5||r===6)t=t.stateNode,n?e.nodeType===8?e.parentNode.insertBefore(t,n):e.insertBefore(t,n):(e.nodeType===8?(n=e.parentNode,n.insertBefore(t,e)):(n=e,n.appendChild(t)),e=e._reactRootContainer,e!=null||n.onclick!==null||(n.onclick=Mm));else if(r!==4&&(t=t.child,t!==null))for(Ub(t,n,e),t=t.sibling;t!==null;)Ub(t,n,e),t=t.sibling}function Wb(t,n,e){var r=t.tag;if(r===5||r===6)t=t.stateNode,n?e.insertBefore(t,n):e.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wb(t,n,e),t=t.sibling;t!==null;)Wb(t,n,e),t=t.sibling}var Hn=null,Ai=!1;function va(t,n,e){for(e=e.child;e!==null;)EO(t,n,e),e=e.sibling}function EO(t,n,e){if(ho&&typeof ho.onCommitFiberUnmount=="function")try{ho.onCommitFiberUnmount($v,e)}catch{}switch(e.tag){case 5:ar||gl(e,n);case 6:var r=Hn,i=Ai;Hn=null,va(t,n,e),Hn=r,Ai=i,Hn!==null&&(Ai?(t=Hn,e=e.stateNode,t.nodeType===8?t.parentNode.removeChild(e):t.removeChild(e)):Hn.removeChild(e.stateNode));break;case 18:Hn!==null&&(Ai?(t=Hn,e=e.stateNode,t.nodeType===8?T0(t.parentNode,e):t.nodeType===1&&T0(t,e),ff(t)):T0(Hn,e.stateNode));break;case 4:r=Hn,i=Ai,Hn=e.stateNode.containerInfo,Ai=!0,va(t,n,e),Hn=r,Ai=i;break;case 0:case 11:case 14:case 15:if(!ar&&(r=e.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Vb(e,n,a),i=i.next}while(i!==r)}va(t,n,e);break;case 1:if(!ar&&(gl(e,n),r=e.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=e.memoizedProps,r.state=e.memoizedState,r.componentWillUnmount()}catch(s){cn(e,n,s)}va(t,n,e);break;case 21:va(t,n,e);break;case 22:e.mode&1?(ar=(r=ar)||e.memoizedState!==null,va(t,n,e),ar=r):va(t,n,e);break;default:va(t,n,e)}}function FT(t){var n=t.updateQueue;if(n!==null){t.updateQueue=null;var e=t.stateNode;e===null&&(e=t.stateNode=new $$),n.forEach(function(r){var i=Q$.bind(null,t,r);e.has(r)||(e.add(r),r.then(i,i))})}}function Ti(t,n){var e=n.deletions;if(e!==null)for(var r=0;r<e.length;r++){var i=e[r];try{var o=t,a=n,s=a;e:for(;s!==null;){switch(s.tag){case 5:Hn=s.stateNode,Ai=!1;break e;case 3:Hn=s.stateNode.containerInfo,Ai=!0;break e;case 4:Hn=s.stateNode.containerInfo,Ai=!0;break e}s=s.return}if(Hn===null)throw Error(ye(160));EO(o,a,i),Hn=null,Ai=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(l){cn(i,n,l)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)CO(n,t),n=n.sibling}function CO(t,n){var e=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ti(n,t),Ji(t),r&4){try{Gd(3,t,t.return),Yv(3,t)}catch(v){cn(t,t.return,v)}try{Gd(5,t,t.return)}catch(v){cn(t,t.return,v)}}break;case 1:Ti(n,t),Ji(t),r&512&&e!==null&&gl(e,e.return);break;case 5:if(Ti(n,t),Ji(t),r&512&&e!==null&&gl(e,e.return),t.flags&32){var i=t.stateNode;try{uf(i,"")}catch(v){cn(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,a=e!==null?e.memoizedProps:o,s=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&H_(i,o),hb(s,a);var l=hb(s,o);for(a=0;a<u.length;a+=2){var c=u[a],d=u[a+1];c==="style"?Y_(i,d):c==="dangerouslySetInnerHTML"?K_(i,d):c==="children"?uf(i,d):Ox(i,c,d,l)}switch(s){case"input":lb(i,o);break;case"textarea":G_(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?El(i,!!o.multiple,p,!1):f!==!!o.multiple&&(o.defaultValue!=null?El(i,!!o.multiple,o.defaultValue,!0):El(i,!!o.multiple,o.multiple?[]:"",!1))}i[gf]=o}catch(v){cn(t,t.return,v)}}break;case 6:if(Ti(n,t),Ji(t),r&4){if(t.stateNode===null)throw Error(ye(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(v){cn(t,t.return,v)}}break;case 3:if(Ti(n,t),Ji(t),r&4&&e!==null&&e.memoizedState.isDehydrated)try{ff(n.containerInfo)}catch(v){cn(t,t.return,v)}break;case 4:Ti(n,t),Ji(t);break;case 13:Ti(n,t),Ji(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(dS=vn())),r&4&&FT(t);break;case 22:if(c=e!==null&&e.memoizedState!==null,t.mode&1?(ar=(l=ar)||c,Ti(n,t),ar=l):Ti(n,t),Ji(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!c&&t.mode&1)for(Ne=t,c=t.child;c!==null;){for(d=Ne=c;Ne!==null;){switch(f=Ne,p=f.child,f.tag){case 0:case 11:case 14:case 15:Gd(4,f,f.return);break;case 1:gl(f,f.return);var h=f.stateNode;if(typeof h.componentWillUnmount=="function"){r=f,e=f.return;try{n=r,h.props=n.memoizedProps,h.state=n.memoizedState,h.componentWillUnmount()}catch(v){cn(r,e,v)}}break;case 5:gl(f,f.return);break;case 22:if(f.memoizedState!==null){BT(d);continue}}p!==null?(p.return=f,Ne=p):BT(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=d.stateNode,u=d.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=X_("display",a))}catch(v){cn(t,t.return,v)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(v){cn(t,t.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ti(n,t),Ji(t),r&4&&FT(t);break;case 21:break;default:Ti(n,t),Ji(t)}}function Ji(t){var n=t.flags;if(n&2){try{e:{for(var e=t.return;e!==null;){if(SO(e)){var r=e;break e}e=e.return}throw Error(ye(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(uf(i,""),r.flags&=-33);var o=LT(t);Wb(t,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,s=LT(t);Ub(t,s,a);break;default:throw Error(ye(161))}}catch(u){cn(t,t.return,u)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function W$(t,n,e){Ne=t,RO(t)}function RO(t,n,e){for(var r=(t.mode&1)!==0;Ne!==null;){var i=Ne,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||fh;if(!a){var s=i.alternate,u=s!==null&&s.memoizedState!==null||ar;s=fh;var l=ar;if(fh=a,(ar=u)&&!l)for(Ne=i;Ne!==null;)a=Ne,u=a.child,a.tag===22&&a.memoizedState!==null?jT(i):u!==null?(u.return=a,Ne=u):jT(i);for(;o!==null;)Ne=o,RO(o),o=o.sibling;Ne=i,fh=s,ar=l}zT(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Ne=o):zT(t)}}function zT(t){for(;Ne!==null;){var n=Ne;if(n.flags&8772){var e=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:ar||Yv(5,n);break;case 1:var r=n.stateNode;if(n.flags&4&&!ar)if(e===null)r.componentDidMount();else{var i=n.elementType===n.type?e.memoizedProps:_i(n.type,e.memoizedProps);r.componentDidUpdate(i,e.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=n.updateQueue;o!==null&&xT(n,o,r);break;case 3:var a=n.updateQueue;if(a!==null){if(e=null,n.child!==null)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}xT(n,a,e)}break;case 5:var s=n.stateNode;if(e===null&&n.flags&4){e=s;var u=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&e.focus();break;case"img":u.src&&(e.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var l=n.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&ff(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}ar||n.flags&512&&$b(n)}catch(f){cn(n,n.return,f)}}if(n===t){Ne=null;break}if(e=n.sibling,e!==null){e.return=n.return,Ne=e;break}Ne=n.return}}function BT(t){for(;Ne!==null;){var n=Ne;if(n===t){Ne=null;break}var e=n.sibling;if(e!==null){e.return=n.return,Ne=e;break}Ne=n.return}}function jT(t){for(;Ne!==null;){var n=Ne;try{switch(n.tag){case 0:case 11:case 15:var e=n.return;try{Yv(4,n)}catch(u){cn(n,e,u)}break;case 1:var r=n.stateNode;if(typeof r.componentDidMount=="function"){var i=n.return;try{r.componentDidMount()}catch(u){cn(n,i,u)}}var o=n.return;try{$b(n)}catch(u){cn(n,o,u)}break;case 5:var a=n.return;try{$b(n)}catch(u){cn(n,a,u)}}}catch(u){cn(n,n.return,u)}if(n===t){Ne=null;break}var s=n.sibling;if(s!==null){s.return=n.return,Ne=s;break}Ne=n.return}}var H$=Math.ceil,Hm=oa.ReactCurrentDispatcher,lS=oa.ReactCurrentOwner,yi=oa.ReactCurrentBatchConfig,St=0,zn=null,xn=null,Yn=0,$r=0,yl=ps(0),In=0,Ef=null,su=0,Jv=0,cS=0,qd=null,Ir=null,dS=0,Gl=1/0,Lo=null,Gm=!1,Hb=null,Ka=null,ph=!1,Da=null,qm=0,Kd=0,Gb=null,tm=-1,nm=0;function gr(){return St&6?vn():tm!==-1?tm:tm=vn()}function Xa(t){return t.mode&1?St&2&&Yn!==0?Yn&-Yn:k$.transition!==null?(nm===0&&(nm=uA()),nm):(t=Ot,t!==0||(t=window.event,t=t===void 0?16:mA(t.type)),t):1}function zi(t,n,e,r){if(50<Kd)throw Kd=0,Gb=null,Error(ye(185));Yf(t,e,r),(!(St&2)||t!==zn)&&(t===zn&&(!(St&2)&&(Jv|=e),In===4&&Ia(t,Yn)),Pr(t,r),e===1&&St===0&&!(n.mode&1)&&(Gl=vn()+500,qv&&hs()))}function Pr(t,n){var e=t.callbackNode;kV(t,n);var r=_m(t,t===zn?Yn:0);if(r===0)e!==null&&XR(e),t.callbackNode=null,t.callbackPriority=0;else if(n=r&-r,t.callbackPriority!==n){if(e!=null&&XR(e),n===1)t.tag===0?N$(VT.bind(null,t)):MA(VT.bind(null,t)),E$(function(){!(St&6)&&hs()}),e=null;else{switch(lA(r)){case 1:e=Fx;break;case 4:e=aA;break;case 16:e=Im;break;case 536870912:e=sA;break;default:e=Im}e=DO(e,TO.bind(null,t))}t.callbackPriority=n,t.callbackNode=e}}function TO(t,n){if(tm=-1,nm=0,St&6)throw Error(ye(327));var e=t.callbackNode;if(kl()&&t.callbackNode!==e)return null;var r=_m(t,t===zn?Yn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||n)n=Km(t,r);else{n=r;var i=St;St|=2;var o=kO();(zn!==t||Yn!==n)&&(Lo=null,Gl=vn()+500,Js(t,n));do try{K$();break}catch(s){NO(t,s)}while(!0);Yx(),Hm.current=o,St=i,xn!==null?n=0:(zn=null,Yn=0,n=In)}if(n!==0){if(n===2&&(i=bb(t),i!==0&&(r=i,n=qb(t,i))),n===1)throw e=Ef,Js(t,0),Ia(t,r),Pr(t,vn()),e;if(n===6)Ia(t,r);else{if(i=t.current.alternate,!(r&30)&&!G$(i)&&(n=Km(t,r),n===2&&(o=bb(t),o!==0&&(r=o,n=qb(t,o))),n===1))throw e=Ef,Js(t,0),Ia(t,r),Pr(t,vn()),e;switch(t.finishedWork=i,t.finishedLanes=r,n){case 0:case 1:throw Error(ye(345));case 2:Ds(t,Ir,Lo);break;case 3:if(Ia(t,r),(r&130023424)===r&&(n=dS+500-vn(),10<n)){if(_m(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){gr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Nb(Ds.bind(null,t,Ir,Lo),n);break}Ds(t,Ir,Lo);break;case 4:if(Ia(t,r),(r&4194240)===r)break;for(n=t.eventTimes,i=-1;0<r;){var a=31-Fi(r);o=1<<a,a=n[a],a>i&&(i=a),r&=~o}if(r=i,r=vn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*H$(r/1960))-r,10<r){t.timeoutHandle=Nb(Ds.bind(null,t,Ir,Lo),r);break}Ds(t,Ir,Lo);break;case 5:Ds(t,Ir,Lo);break;default:throw Error(ye(329))}}}return Pr(t,vn()),t.callbackNode===e?TO.bind(null,t):null}function qb(t,n){var e=qd;return t.current.memoizedState.isDehydrated&&(Js(t,n).flags|=256),t=Km(t,n),t!==2&&(n=Ir,Ir=e,n!==null&&Kb(n)),t}function Kb(t){Ir===null?Ir=t:Ir.push.apply(Ir,t)}function G$(t){for(var n=t;;){if(n.flags&16384){var e=n.updateQueue;if(e!==null&&(e=e.stores,e!==null))for(var r=0;r<e.length;r++){var i=e[r],o=i.getSnapshot;i=i.value;try{if(!Vi(o(),i))return!1}catch{return!1}}}if(e=n.child,n.subtreeFlags&16384&&e!==null)e.return=n,n=e;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ia(t,n){for(n&=~cS,n&=~Jv,t.suspendedLanes|=n,t.pingedLanes&=~n,t=t.expirationTimes;0<n;){var e=31-Fi(n),r=1<<e;t[e]=-1,n&=~r}}function VT(t){if(St&6)throw Error(ye(327));kl();var n=_m(t,0);if(!(n&1))return Pr(t,vn()),null;var e=Km(t,n);if(t.tag!==0&&e===2){var r=bb(t);r!==0&&(n=r,e=qb(t,r))}if(e===1)throw e=Ef,Js(t,0),Ia(t,n),Pr(t,vn()),e;if(e===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=n,Ds(t,Ir,Lo),Pr(t,vn()),null}function fS(t,n){var e=St;St|=1;try{return t(n)}finally{St=e,St===0&&(Gl=vn()+500,qv&&hs())}}function uu(t){Da!==null&&Da.tag===0&&!(St&6)&&kl();var n=St;St|=1;var e=yi.transition,r=Ot;try{if(yi.transition=null,Ot=1,t)return t()}finally{Ot=r,yi.transition=e,St=n,!(St&6)&&hs()}}function pS(){$r=yl.current,Ht(yl)}function Js(t,n){t.finishedWork=null,t.finishedLanes=0;var e=t.timeoutHandle;if(e!==-1&&(t.timeoutHandle=-1,S$(e)),xn!==null)for(e=xn.return;e!==null;){var r=e;switch(qx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pm();break;case 3:Wl(),Ht(Dr),Ht(ur),nS();break;case 5:tS(r);break;case 4:Wl();break;case 13:Ht(tn);break;case 19:Ht(tn);break;case 10:Jx(r.type._context);break;case 22:case 23:pS()}e=e.return}if(zn=t,xn=t=Ya(t.current,null),Yn=$r=n,In=0,Ef=null,cS=Jv=su=0,Ir=qd=null,Us!==null){for(n=0;n<Us.length;n++)if(e=Us[n],r=e.interleaved,r!==null){e.interleaved=null;var i=r.next,o=e.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}e.pending=r}Us=null}return t}function NO(t,n){do{var e=xn;try{if(Yx(),Qh.current=Wm,Um){for(var r=nn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Um=!1}if(au=0,Ln=kn=nn=null,Hd=!1,wf=0,lS.current=null,e===null||e.return===null){In=1,Ef=n,xn=null;break}e:{var o=t,a=e.return,s=e,u=n;if(n=Yn,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=kT(a);if(p!==null){p.flags&=-257,IT(p,a,s,o,n),p.mode&1&&NT(o,l,n),n=p,u=l;var h=n.updateQueue;if(h===null){var v=new Set;v.add(u),n.updateQueue=v}else h.add(u);break e}else{if(!(n&1)){NT(o,l,n),hS();break e}u=Error(ye(426))}}else if(Qt&&s.mode&1){var g=kT(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),IT(g,a,s,o,n),Kx(Hl(u,s));break e}}o=u=Hl(u,s),In!==4&&(In=2),qd===null?qd=[o]:qd.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,n&=-n,o.lanes|=n;var m=cO(o,u,n);wT(o,m);break e;case 1:s=u;var y=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ka===null||!Ka.has(b)))){o.flags|=65536,n&=-n,o.lanes|=n;var w=dO(o,s,n);wT(o,w);break e}}o=o.return}while(o!==null)}_O(e)}catch(x){n=x,xn===e&&e!==null&&(xn=e=e.return);continue}break}while(!0)}function kO(){var t=Hm.current;return Hm.current=Wm,t===null?Wm:t}function hS(){(In===0||In===3||In===2)&&(In=4),zn===null||!(su&268435455)&&!(Jv&268435455)||Ia(zn,Yn)}function Km(t,n){var e=St;St|=2;var r=kO();(zn!==t||Yn!==n)&&(Lo=null,Js(t,n));do try{q$();break}catch(i){NO(t,i)}while(!0);if(Yx(),St=e,Hm.current=r,xn!==null)throw Error(ye(261));return zn=null,Yn=0,In}function q$(){for(;xn!==null;)IO(xn)}function K$(){for(;xn!==null&&!bV();)IO(xn)}function IO(t){var n=OO(t.alternate,t,$r);t.memoizedProps=t.pendingProps,n===null?_O(t):xn=n,lS.current=null}function _O(t){var n=t;do{var e=n.alternate;if(t=n.return,n.flags&32768){if(e=V$(e,n),e!==null){e.flags&=32767,xn=e;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{In=6,xn=null;return}}else if(e=j$(e,n,$r),e!==null){xn=e;return}if(n=n.sibling,n!==null){xn=n;return}xn=n=t}while(n!==null);In===0&&(In=5)}function Ds(t,n,e){var r=Ot,i=yi.transition;try{yi.transition=null,Ot=1,X$(t,n,e,r)}finally{yi.transition=i,Ot=r}return null}function X$(t,n,e,r){do kl();while(Da!==null);if(St&6)throw Error(ye(327));e=t.finishedWork;var i=t.finishedLanes;if(e===null)return null;if(t.finishedWork=null,t.finishedLanes=0,e===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var o=e.lanes|e.childLanes;if(IV(t,o),t===zn&&(xn=zn=null,Yn=0),!(e.subtreeFlags&2064)&&!(e.flags&2064)||ph||(ph=!0,DO(Im,function(){return kl(),null})),o=(e.flags&15990)!==0,e.subtreeFlags&15990||o){o=yi.transition,yi.transition=null;var a=Ot;Ot=1;var s=St;St|=4,lS.current=null,U$(t,e),CO(e,t),m$(Rb),Am=!!Cb,Rb=Cb=null,t.current=e,W$(e),wV(),St=s,Ot=a,yi.transition=o}else t.current=e;if(ph&&(ph=!1,Da=t,qm=i),o=t.pendingLanes,o===0&&(Ka=null),EV(e.stateNode),Pr(t,vn()),n!==null)for(r=t.onRecoverableError,e=0;e<n.length;e++)i=n[e],r(i.value,{componentStack:i.stack,digest:i.digest});if(Gm)throw Gm=!1,t=Hb,Hb=null,t;return qm&1&&t.tag!==0&&kl(),o=t.pendingLanes,o&1?t===Gb?Kd++:(Kd=0,Gb=t):Kd=0,hs(),null}function kl(){if(Da!==null){var t=lA(qm),n=yi.transition,e=Ot;try{if(yi.transition=null,Ot=16>t?16:t,Da===null)var r=!1;else{if(t=Da,Da=null,qm=0,St&6)throw Error(ye(331));var i=St;for(St|=4,Ne=t.current;Ne!==null;){var o=Ne,a=o.child;if(Ne.flags&16){var s=o.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(Ne=l;Ne!==null;){var c=Ne;switch(c.tag){case 0:case 11:case 15:Gd(8,c,o)}var d=c.child;if(d!==null)d.return=c,Ne=d;else for(;Ne!==null;){c=Ne;var f=c.sibling,p=c.return;if(xO(c),c===l){Ne=null;break}if(f!==null){f.return=p,Ne=f;break}Ne=p}}}var h=o.alternate;if(h!==null){var v=h.child;if(v!==null){h.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(v!==null)}}Ne=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,Ne=a;else e:for(;Ne!==null;){if(o=Ne,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Gd(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,Ne=m;break e}Ne=o.return}}var y=t.current;for(Ne=y;Ne!==null;){a=Ne;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,Ne=b;else e:for(a=y;Ne!==null;){if(s=Ne,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Yv(9,s)}}catch(x){cn(s,s.return,x)}if(s===a){Ne=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,Ne=w;break e}Ne=s.return}}if(St=i,hs(),ho&&typeof ho.onPostCommitFiberRoot=="function")try{ho.onPostCommitFiberRoot($v,t)}catch{}r=!0}return r}finally{Ot=e,yi.transition=n}}return!1}function $T(t,n,e){n=Hl(e,n),n=cO(t,n,1),t=qa(t,n,1),n=gr(),t!==null&&(Yf(t,1,n),Pr(t,n))}function cn(t,n,e){if(t.tag===3)$T(t,t,e);else for(;n!==null;){if(n.tag===3){$T(n,t,e);break}else if(n.tag===1){var r=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ka===null||!Ka.has(r))){t=Hl(e,t),t=dO(n,t,1),n=qa(n,t,1),t=gr(),n!==null&&(Yf(n,1,t),Pr(n,t));break}}n=n.return}}function Y$(t,n,e){var r=t.pingCache;r!==null&&r.delete(n),n=gr(),t.pingedLanes|=t.suspendedLanes&e,zn===t&&(Yn&e)===e&&(In===4||In===3&&(Yn&130023424)===Yn&&500>vn()-dS?Js(t,0):cS|=e),Pr(t,n)}function AO(t,n){n===0&&(t.mode&1?(n=rh,rh<<=1,!(rh&130023424)&&(rh=4194304)):n=1);var e=gr();t=Zo(t,n),t!==null&&(Yf(t,n,e),Pr(t,e))}function J$(t){var n=t.memoizedState,e=0;n!==null&&(e=n.retryLane),AO(t,e)}function Q$(t,n){var e=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(e=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ye(314))}r!==null&&r.delete(n),AO(t,e)}var OO;OO=function(t,n,e){if(t!==null)if(t.memoizedProps!==n.pendingProps||Dr.current)Or=!0;else{if(!(t.lanes&e)&&!(n.flags&128))return Or=!1,B$(t,n,e);Or=!!(t.flags&131072)}else Or=!1,Qt&&n.flags&1048576&&PA(n,zm,n.index);switch(n.lanes=0,n.tag){case 2:var r=n.type;em(t,n),t=n.pendingProps;var i=Vl(n,ur.current);Nl(n,e),i=iS(null,n,r,t,i,e);var o=oS();return n.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Mr(r)?(o=!0,Lm(n)):o=!1,n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Zx(n),i.updater=Kv,n.stateNode=i,i._reactInternals=n,Mb(n,r,t,e),n=Fb(null,n,r,!0,o,e)):(n.tag=0,Qt&&o&&Gx(n),pr(null,n,i,e),n=n.child),n;case 16:r=n.elementType;e:{switch(em(t,n),t=n.pendingProps,i=r._init,r=i(r._payload),n.type=r,i=n.tag=e5(r),t=_i(r,t),i){case 0:n=Lb(null,n,r,t,e);break e;case 1:n=OT(null,n,r,t,e);break e;case 11:n=_T(null,n,r,t,e);break e;case 14:n=AT(null,n,r,_i(r.type,t),e);break e}throw Error(ye(306,r,""))}return n;case 0:return r=n.type,i=n.pendingProps,i=n.elementType===r?i:_i(r,i),Lb(t,n,r,i,e);case 1:return r=n.type,i=n.pendingProps,i=n.elementType===r?i:_i(r,i),OT(t,n,r,i,e);case 3:e:{if(mO(n),t===null)throw Error(ye(387));r=n.pendingProps,o=n.memoizedState,i=o.element,BA(t,n),Vm(n,r,null,e);var a=n.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},n.updateQueue.baseState=o,n.memoizedState=o,n.flags&256){i=Hl(Error(ye(423)),n),n=DT(t,n,r,e,i);break e}else if(r!==i){i=Hl(Error(ye(424)),n),n=DT(t,n,r,e,i);break e}else for(Kr=Ga(n.stateNode.containerInfo.firstChild),Jr=n,Qt=!0,Oi=null,e=UA(n,null,r,e),n.child=e;e;)e.flags=e.flags&-3|4096,e=e.sibling;else{if($l(),r===i){n=ea(t,n,e);break e}pr(t,n,r,e)}n=n.child}return n;case 5:return WA(n),t===null&&Ab(n),r=n.type,i=n.pendingProps,o=t!==null?t.memoizedProps:null,a=i.children,Tb(r,i)?a=null:o!==null&&Tb(r,o)&&(n.flags|=32),hO(t,n),pr(t,n,a,e),n.child;case 6:return t===null&&Ab(n),null;case 13:return vO(t,n,e);case 4:return eS(n,n.stateNode.containerInfo),r=n.pendingProps,t===null?n.child=Ul(n,null,r,e):pr(t,n,r,e),n.child;case 11:return r=n.type,i=n.pendingProps,i=n.elementType===r?i:_i(r,i),_T(t,n,r,i,e);case 7:return pr(t,n,n.pendingProps,e),n.child;case 8:return pr(t,n,n.pendingProps.children,e),n.child;case 12:return pr(t,n,n.pendingProps.children,e),n.child;case 10:e:{if(r=n.type._context,i=n.pendingProps,o=n.memoizedProps,a=i.value,Bt(Bm,r._currentValue),r._currentValue=a,o!==null)if(Vi(o.value,a)){if(o.children===i.children&&!Dr.current){n=ea(t,n,e);break e}}else for(o=n.child,o!==null&&(o.return=n);o!==null;){var s=o.dependencies;if(s!==null){a=o.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=Wo(-1,e&-e),u.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}o.lanes|=e,u=o.alternate,u!==null&&(u.lanes|=e),Ob(o.return,e,n),s.lanes|=e;break}u=u.next}}else if(o.tag===10)a=o.type===n.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(ye(341));a.lanes|=e,s=a.alternate,s!==null&&(s.lanes|=e),Ob(a,e,n),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===n){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}pr(t,n,i.children,e),n=n.child}return n;case 9:return i=n.type,r=n.pendingProps.children,Nl(n,e),i=wi(i),r=r(i),n.flags|=1,pr(t,n,r,e),n.child;case 14:return r=n.type,i=_i(r,n.pendingProps),i=_i(r.type,i),AT(t,n,r,i,e);case 15:return fO(t,n,n.type,n.pendingProps,e);case 17:return r=n.type,i=n.pendingProps,i=n.elementType===r?i:_i(r,i),em(t,n),n.tag=1,Mr(r)?(t=!0,Lm(n)):t=!1,Nl(n,e),VA(n,r,i),Mb(n,r,i,e),Fb(null,n,r,!0,t,e);case 19:return gO(t,n,e);case 22:return pO(t,n,e)}throw Error(ye(156,n.tag))};function DO(t,n){return oA(t,n)}function Z$(t,n,e,r){this.tag=t,this.key=e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gi(t,n,e,r){return new Z$(t,n,e,r)}function mS(t){return t=t.prototype,!(!t||!t.isReactComponent)}function e5(t){if(typeof t=="function")return mS(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Mx)return 11;if(t===Px)return 14}return 2}function Ya(t,n){var e=t.alternate;return e===null?(e=gi(t.tag,n,t.key,t.mode),e.elementType=t.elementType,e.type=t.type,e.stateNode=t.stateNode,e.alternate=t,t.alternate=e):(e.pendingProps=n,e.type=t.type,e.flags=0,e.subtreeFlags=0,e.deletions=null),e.flags=t.flags&14680064,e.childLanes=t.childLanes,e.lanes=t.lanes,e.child=t.child,e.memoizedProps=t.memoizedProps,e.memoizedState=t.memoizedState,e.updateQueue=t.updateQueue,n=t.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},e.sibling=t.sibling,e.index=t.index,e.ref=t.ref,e}function rm(t,n,e,r,i,o){var a=2;if(r=t,typeof t=="function")mS(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ul:return Qs(e.children,i,o,n);case Dx:a=8,i|=8;break;case ib:return t=gi(12,e,n,i|2),t.elementType=ib,t.lanes=o,t;case ob:return t=gi(13,e,n,i),t.elementType=ob,t.lanes=o,t;case ab:return t=gi(19,e,n,i),t.elementType=ab,t.lanes=o,t;case $_:return Qv(e,i,o,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case j_:a=10;break e;case V_:a=9;break e;case Mx:a=11;break e;case Px:a=14;break e;case Ca:a=16,r=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return n=gi(a,e,n,i),n.elementType=t,n.type=r,n.lanes=o,n}function Qs(t,n,e,r){return t=gi(7,t,r,n),t.lanes=e,t}function Qv(t,n,e,r){return t=gi(22,t,r,n),t.elementType=$_,t.lanes=e,t.stateNode={isHidden:!1},t}function M0(t,n,e){return t=gi(6,t,null,n),t.lanes=e,t}function P0(t,n,e){return n=gi(4,t.children!==null?t.children:[],t.key,n),n.lanes=e,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function t5(t,n,e,r,i){this.tag=n,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=m0(0),this.expirationTimes=m0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=m0(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function vS(t,n,e,r,i,o,a,s,u){return t=new t5(t,n,e,s,u),n===1?(n=1,o===!0&&(n|=8)):n=0,o=gi(3,null,null,n),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:e,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zx(o),t}function n5(t,n,e){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sl,key:r==null?null:""+r,children:t,containerInfo:n,implementation:e}}function MO(t){if(!t)return os;t=t._reactInternals;e:{if(xu(t)!==t||t.tag!==1)throw Error(ye(170));var n=t;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Mr(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(ye(171))}if(t.tag===1){var e=t.type;if(Mr(e))return DA(t,e,n)}return n}function PO(t,n,e,r,i,o,a,s,u){return t=vS(e,r,!0,t,i,o,a,s,u),t.context=MO(null),e=t.current,r=gr(),i=Xa(e),o=Wo(r,i),o.callback=n??null,qa(e,o,i),t.current.lanes=i,Yf(t,i,r),Pr(t,r),t}function Zv(t,n,e,r){var i=n.current,o=gr(),a=Xa(i);return e=MO(e),n.context===null?n.context=e:n.pendingContext=e,n=Wo(o,a),n.payload={element:t},r=r===void 0?null:r,r!==null&&(n.callback=r),t=qa(i,n,a),t!==null&&(zi(t,i,a,o),Jh(t,i,a)),a}function Xm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function UT(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var e=t.retryLane;t.retryLane=e!==0&&e<n?e:n}}function gS(t,n){UT(t,n),(t=t.alternate)&&UT(t,n)}function r5(){return null}var LO=typeof reportError=="function"?reportError:function(t){console.error(t)};function yS(t){this._internalRoot=t}eg.prototype.render=yS.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(ye(409));Zv(t,n,null,null)};eg.prototype.unmount=yS.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;uu(function(){Zv(null,t,null,null)}),n[Qo]=null}};function eg(t){this._internalRoot=t}eg.prototype.unstable_scheduleHydration=function(t){if(t){var n=fA();t={blockedOn:null,target:t,priority:n};for(var e=0;e<ka.length&&n!==0&&n<ka[e].priority;e++);ka.splice(e,0,t),e===0&&hA(t)}};function bS(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function tg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function WT(){}function i5(t,n,e,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=Xm(a);o.call(l)}}var a=PO(n,r,t,0,null,!1,!1,"",WT);return t._reactRootContainer=a,t[Qo]=a.current,mf(t.nodeType===8?t.parentNode:t),uu(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var l=Xm(u);s.call(l)}}var u=vS(t,0,!1,null,null,!1,!1,"",WT);return t._reactRootContainer=u,t[Qo]=u.current,mf(t.nodeType===8?t.parentNode:t),uu(function(){Zv(n,u,e,r)}),u}function ng(t,n,e,r,i){var o=e._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var s=i;i=function(){var u=Xm(a);s.call(u)}}Zv(n,a,t,i)}else a=i5(e,n,t,i,r);return Xm(a)}cA=function(t){switch(t.tag){case 3:var n=t.stateNode;if(n.current.memoizedState.isDehydrated){var e=Ad(n.pendingLanes);e!==0&&(zx(n,e|1),Pr(n,vn()),!(St&6)&&(Gl=vn()+500,hs()))}break;case 13:uu(function(){var r=Zo(t,1);if(r!==null){var i=gr();zi(r,t,1,i)}}),gS(t,1)}};Bx=function(t){if(t.tag===13){var n=Zo(t,134217728);if(n!==null){var e=gr();zi(n,t,134217728,e)}gS(t,134217728)}};dA=function(t){if(t.tag===13){var n=Xa(t),e=Zo(t,n);if(e!==null){var r=gr();zi(e,t,n,r)}gS(t,n)}};fA=function(){return Ot};pA=function(t,n){var e=Ot;try{return Ot=t,n()}finally{Ot=e}};vb=function(t,n,e){switch(n){case"input":if(lb(t,e),n=e.name,e.type==="radio"&&n!=null){for(e=t;e.parentNode;)e=e.parentNode;for(e=e.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<e.length;n++){var r=e[n];if(r!==t&&r.form===t.form){var i=Gv(r);if(!i)throw Error(ye(90));W_(r),lb(r,i)}}}break;case"textarea":G_(t,e);break;case"select":n=e.value,n!=null&&El(t,!!e.multiple,n,!1)}};Z_=fS;eA=uu;var o5={usingClientEntryPoint:!1,Events:[Qf,fl,Gv,J_,Q_,fS]},id={findFiberByHostInstance:$s,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},a5={bundleType:id.bundleType,version:id.version,rendererPackageName:id.rendererPackageName,rendererConfig:id.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oa.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=rA(t),t===null?null:t.stateNode},findFiberByHostInstance:id.findFiberByHostInstance||r5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hh.isDisabled&&hh.supportsFiber)try{$v=hh.inject(a5),ho=hh}catch{}}ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o5;ii.createPortal=function(t,n){var e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bS(n))throw Error(ye(200));return n5(t,n,null,e)};ii.createRoot=function(t,n){if(!bS(t))throw Error(ye(299));var e=!1,r="",i=LO;return n!=null&&(n.unstable_strictMode===!0&&(e=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),n=vS(t,1,!1,null,null,e,!1,r,i),t[Qo]=n.current,mf(t.nodeType===8?t.parentNode:t),new yS(n)};ii.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=rA(n),t=t===null?null:t.stateNode,t};ii.flushSync=function(t){return uu(t)};ii.hydrate=function(t,n,e){if(!tg(n))throw Error(ye(200));return ng(null,t,n,!0,e)};ii.hydrateRoot=function(t,n,e){if(!bS(t))throw Error(ye(405));var r=e!=null&&e.hydratedSources||null,i=!1,o="",a=LO;if(e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),n=PO(n,null,t,1,e??null,i,!1,o,a),t[Qo]=n.current,mf(t),r)for(t=0;t<r.length;t++)e=r[t],i=e._getVersion,i=i(e._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[e,i]:n.mutableSourceEagerHydrationData.push(e,i);return new eg(n)};ii.render=function(t,n,e){if(!tg(n))throw Error(ye(200));return ng(null,t,n,!1,e)};ii.unmountComponentAtNode=function(t){if(!tg(t))throw Error(ye(40));return t._reactRootContainer?(uu(function(){ng(null,null,t,!1,function(){t._reactRootContainer=null,t[Qo]=null})}),!0):!1};ii.unstable_batchedUpdates=fS;ii.unstable_renderSubtreeIntoContainer=function(t,n,e,r){if(!tg(e))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return ng(t,n,e,!1,r)};ii.version="18.2.0-next-9e3b772b8-20220608";function FO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FO)}catch(t){console.error(t)}}FO(),P_.exports=ii;var zO=P_.exports;const BO=C_(zO);/**
 * @remix-run/router v1.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cf(){return Cf=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Cf.apply(this,arguments)}var Ma;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ma||(Ma={}));const HT="popstate";function s5(t){t===void 0&&(t={});function n(r,i){let{pathname:o,search:a,hash:s}=r.location;return Xb("",{pathname:o,search:a,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function e(r,i){return typeof i=="string"?i:Ym(i)}return l5(n,e,null,t)}function dn(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function wS(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function u5(){return Math.random().toString(36).substr(2,8)}function GT(t,n){return{usr:t.state,key:t.key,idx:n}}function Xb(t,n,e,r){return e===void 0&&(e=null),Cf({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof n=="string"?xc(n):n,{state:e,key:n&&n.key||r||u5()})}function Ym(t){let{pathname:n="/",search:e="",hash:r=""}=t;return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(n+=r.charAt(0)==="#"?r:"#"+r),n}function xc(t){let n={};if(t){let e=t.indexOf("#");e>=0&&(n.hash=t.substr(e),t=t.substr(0,e));let r=t.indexOf("?");r>=0&&(n.search=t.substr(r),t=t.substr(0,r)),t&&(n.pathname=t)}return n}function l5(t,n,e,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,s=Ma.Pop,u=null,l=c();l==null&&(l=0,a.replaceState(Cf({},a.state,{idx:l}),""));function c(){return(a.state||{idx:null}).idx}function d(){s=Ma.Pop;let g=c(),m=g==null?null:g-l;l=g,u&&u({action:s,location:v.location,delta:m})}function f(g,m){s=Ma.Push;let y=Xb(v.location,g,m);e&&e(y,g),l=c()+1;let b=GT(y,l),w=v.createHref(y);try{a.pushState(b,"",w)}catch(x){if(x instanceof DOMException&&x.name==="DataCloneError")throw x;i.location.assign(w)}o&&u&&u({action:s,location:v.location,delta:1})}function p(g,m){s=Ma.Replace;let y=Xb(v.location,g,m);e&&e(y,g),l=c();let b=GT(y,l),w=v.createHref(y);a.replaceState(b,"",w),o&&u&&u({action:s,location:v.location,delta:0})}function h(g){let m=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof g=="string"?g:Ym(g);return dn(m,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,m)}let v={get action(){return s},get location(){return t(i,a)},listen(g){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(HT,d),u=g,()=>{i.removeEventListener(HT,d),u=null}},createHref(g){return n(i,g)},createURL:h,encodeLocation(g){let m=h(g);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:p,go(g){return a.go(g)}};return v}var qT;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(qT||(qT={}));function c5(t,n,e){e===void 0&&(e="/");let r=typeof n=="string"?xc(n):n,i=ql(r.pathname||"/",e);if(i==null)return null;let o=jO(t);d5(o);let a=null;for(let s=0;a==null&&s<o.length;++s)a=w5(o[s],S5(i));return a}function jO(t,n,e,r){n===void 0&&(n=[]),e===void 0&&(e=[]),r===void 0&&(r="");let i=(o,a,s)=>{let u={relativePath:s===void 0?o.path||"":s,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};u.relativePath.startsWith("/")&&(dn(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let l=Ja([r,u.relativePath]),c=e.concat(u);o.children&&o.children.length>0&&(dn(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),jO(o.children,n,c,l)),!(o.path==null&&!o.index)&&n.push({path:l,score:y5(l,o.index),routesMeta:c})};return t.forEach((o,a)=>{var s;if(o.path===""||!((s=o.path)!=null&&s.includes("?")))i(o,a);else for(let u of VO(o.path))i(o,a,u)}),n}function VO(t){let n=t.split("/");if(n.length===0)return[];let[e,...r]=n,i=e.endsWith("?"),o=e.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let a=VO(r.join("/")),s=[];return s.push(...a.map(u=>u===""?o:[o,u].join("/"))),i&&s.push(...a),s.map(u=>t.startsWith("/")&&u===""?"/":u)}function d5(t){t.sort((n,e)=>n.score!==e.score?e.score-n.score:b5(n.routesMeta.map(r=>r.childrenIndex),e.routesMeta.map(r=>r.childrenIndex)))}const f5=/^:[\w-]+$/,p5=3,h5=2,m5=1,v5=10,g5=-2,KT=t=>t==="*";function y5(t,n){let e=t.split("/"),r=e.length;return e.some(KT)&&(r+=g5),n&&(r+=h5),e.filter(i=>!KT(i)).reduce((i,o)=>i+(f5.test(o)?p5:o===""?m5:v5),r)}function b5(t,n){return t.length===n.length&&t.slice(0,-1).every((r,i)=>r===n[i])?t[t.length-1]-n[n.length-1]:0}function w5(t,n){let{routesMeta:e}=t,r={},i="/",o=[];for(let a=0;a<e.length;++a){let s=e[a],u=a===e.length-1,l=i==="/"?n:n.slice(i.length)||"/",c=Yb({path:s.relativePath,caseSensitive:s.caseSensitive,end:u},l);if(!c)return null;Object.assign(r,c.params);let d=s.route;o.push({params:r,pathname:Ja([i,c.pathname]),pathnameBase:N5(Ja([i,c.pathnameBase])),route:d}),c.pathnameBase!=="/"&&(i=Ja([i,c.pathnameBase]))}return o}function Yb(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[e,r]=x5(t.path,t.caseSensitive,t.end),i=n.match(e);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((l,c,d)=>{let{paramName:f,isOptional:p}=c;if(f==="*"){let v=s[d]||"";a=o.slice(0,o.length-v.length).replace(/(.)\/+$/,"$1")}const h=s[d];return p&&!h?l[f]=void 0:l[f]=E5(h||"",f),l},{}),pathname:o,pathnameBase:a,pattern:t}}function x5(t,n,e){n===void 0&&(n=!1),e===void 0&&(e=!0),wS(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,n?void 0:"i"),r]}function S5(t){try{return decodeURI(t)}catch(n){return wS(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),t}}function E5(t,n){try{return decodeURIComponent(t)}catch(e){return wS(!1,'The value for the URL param "'+n+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+e+").")),t}}function ql(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let e=n.endsWith("/")?n.length-1:n.length,r=t.charAt(e);return r&&r!=="/"?null:t.slice(e)||"/"}function C5(t,n){n===void 0&&(n="/");let{pathname:e,search:r="",hash:i=""}=typeof t=="string"?xc(t):t;return{pathname:e?e.startsWith("/")?e:R5(e,n):n,search:k5(r),hash:I5(i)}}function R5(t,n){let e=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?e.length>1&&e.pop():i!=="."&&e.push(i)}),e.length>1?e.join("/"):"/"}function L0(t,n,e,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+e+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function T5(t){return t.filter((n,e)=>e===0||n.route.path&&n.route.path.length>0)}function $O(t,n){let e=T5(t);return n?e.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):e.map(r=>r.pathnameBase)}function UO(t,n,e,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=xc(t):(i=Cf({},t),dn(!i.pathname||!i.pathname.includes("?"),L0("?","pathname","search",i)),dn(!i.pathname||!i.pathname.includes("#"),L0("#","pathname","hash",i)),dn(!i.search||!i.search.includes("#"),L0("#","search","hash",i)));let o=t===""||i.pathname==="",a=o?"/":i.pathname,s;if(a==null)s=e;else{let d=n.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}s=d>=0?n[d]:"/"}let u=C5(i,s),l=a&&a!=="/"&&a.endsWith("/"),c=(o||a===".")&&e.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}const Ja=t=>t.join("/").replace(/\/\/+/g,"/"),N5=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),k5=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,I5=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function _5(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const WO=["post","put","patch","delete"];new Set(WO);const A5=["get",...WO];new Set(A5);/**
 * React Router v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rf(){return Rf=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Rf.apply(this,arguments)}const rg=W.createContext(null),HO=W.createContext(null),ms=W.createContext(null),ig=W.createContext(null),aa=W.createContext({outlet:null,matches:[],isDataRoute:!1}),GO=W.createContext(null);function O5(t,n){let{relative:e}=n===void 0?{}:n;ep()||dn(!1);let{basename:r,navigator:i}=W.useContext(ms),{hash:o,pathname:a,search:s}=og(t,{relative:e}),u=a;return r!=="/"&&(u=a==="/"?r:Ja([r,a])),i.createHref({pathname:u,search:s,hash:o})}function ep(){return W.useContext(ig)!=null}function Si(){return ep()||dn(!1),W.useContext(ig).location}function qO(t){W.useContext(ms).static||W.useLayoutEffect(t)}function Er(){let{isDataRoute:t}=W.useContext(aa);return t?q5():D5()}function D5(){ep()||dn(!1);let t=W.useContext(rg),{basename:n,future:e,navigator:r}=W.useContext(ms),{matches:i}=W.useContext(aa),{pathname:o}=Si(),a=JSON.stringify($O(i,e.v7_relativeSplatPath)),s=W.useRef(!1);return qO(()=>{s.current=!0}),W.useCallback(function(l,c){if(c===void 0&&(c={}),!s.current)return;if(typeof l=="number"){r.go(l);return}let d=UO(l,JSON.parse(a),o,c.relative==="path");t==null&&n!=="/"&&(d.pathname=d.pathname==="/"?n:Ja([n,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[n,r,a,o,t])}const M5=W.createContext(null);function P5(t){let n=W.useContext(aa).outlet;return n&&W.createElement(M5.Provider,{value:t},n)}function xS(){let{matches:t}=W.useContext(aa),n=t[t.length-1];return n?n.params:{}}function og(t,n){let{relative:e}=n===void 0?{}:n,{future:r}=W.useContext(ms),{matches:i}=W.useContext(aa),{pathname:o}=Si(),a=JSON.stringify($O(i,r.v7_relativeSplatPath));return W.useMemo(()=>UO(t,JSON.parse(a),o,e==="path"),[t,a,o,e])}function L5(t,n){return F5(t,n)}function F5(t,n,e,r){ep()||dn(!1);let{navigator:i}=W.useContext(ms),{matches:o}=W.useContext(aa),a=o[o.length-1],s=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let l=Si(),c;if(n){var d;let g=typeof n=="string"?xc(n):n;u==="/"||(d=g.pathname)!=null&&d.startsWith(u)||dn(!1),c=g}else c=l;let f=c.pathname||"/",p=u==="/"?f:f.slice(u.length)||"/",h=c5(t,{pathname:p}),v=$5(h&&h.map(g=>Object.assign({},g,{params:Object.assign({},s,g.params),pathname:Ja([u,i.encodeLocation?i.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?u:Ja([u,i.encodeLocation?i.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),o,e,r);return n&&v?W.createElement(ig.Provider,{value:{location:Rf({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Ma.Pop}},v):v}function z5(){let t=G5(),n=_5(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),e=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},n),e?W.createElement("pre",{style:i},e):null,null)}const B5=W.createElement(z5,null);class j5 extends W.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?W.createElement(aa.Provider,{value:this.props.routeContext},W.createElement(GO.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function V5(t){let{routeContext:n,match:e,children:r}=t,i=W.useContext(rg);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),W.createElement(aa.Provider,{value:n},r)}function $5(t,n,e,r){var i;if(n===void 0&&(n=[]),e===void 0&&(e=null),r===void 0&&(r=null),t==null){var o;if((o=e)!=null&&o.errors)t=e.matches;else return null}let a=t,s=(i=e)==null?void 0:i.errors;if(s!=null){let c=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id]));c>=0||dn(!1),a=a.slice(0,Math.min(a.length,c+1))}let u=!1,l=-1;if(e&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let d=a[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=c),d.route.id){let{loaderData:f,errors:p}=e,h=d.route.loader&&f[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||h){u=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,d,f)=>{let p,h=!1,v=null,g=null;e&&(p=s&&d.route.id?s[d.route.id]:void 0,v=d.route.errorElement||B5,u&&(l<0&&f===0?(K5("route-fallback",!1),h=!0,g=null):l===f&&(h=!0,g=d.route.hydrateFallbackElement||null)));let m=n.concat(a.slice(0,f+1)),y=()=>{let b;return p?b=v:h?b=g:d.route.Component?b=W.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=c,W.createElement(V5,{match:d,routeContext:{outlet:c,matches:m,isDataRoute:e!=null},children:b})};return e&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?W.createElement(j5,{location:e.location,revalidation:e.revalidation,component:v,error:p,children:y(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):y()},null)}var KO=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(KO||{}),Jm=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Jm||{});function U5(t){let n=W.useContext(rg);return n||dn(!1),n}function W5(t){let n=W.useContext(HO);return n||dn(!1),n}function H5(t){let n=W.useContext(aa);return n||dn(!1),n}function XO(t){let n=H5(),e=n.matches[n.matches.length-1];return e.route.id||dn(!1),e.route.id}function G5(){var t;let n=W.useContext(GO),e=W5(Jm.UseRouteError),r=XO(Jm.UseRouteError);return n!==void 0?n:(t=e.errors)==null?void 0:t[r]}function q5(){let{router:t}=U5(KO.UseNavigateStable),n=XO(Jm.UseNavigateStable),e=W.useRef(!1);return qO(()=>{e.current=!0}),W.useCallback(function(i,o){o===void 0&&(o={}),e.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Rf({fromRouteId:n},o)))},[t,n])}const XT={};function K5(t,n,e){!n&&!XT[t]&&(XT[t]=!0)}function X5(t){return P5(t.context)}function it(t){dn(!1)}function Y5(t){let{basename:n="/",children:e=null,location:r,navigationType:i=Ma.Pop,navigator:o,static:a=!1,future:s}=t;ep()&&dn(!1);let u=n.replace(/^\/*/,"/"),l=W.useMemo(()=>({basename:u,navigator:o,static:a,future:Rf({v7_relativeSplatPath:!1},s)}),[u,s,o,a]);typeof r=="string"&&(r=xc(r));let{pathname:c="/",search:d="",hash:f="",state:p=null,key:h="default"}=r,v=W.useMemo(()=>{let g=ql(c,u);return g==null?null:{location:{pathname:g,search:d,hash:f,state:p,key:h},navigationType:i}},[u,c,d,f,p,h,i]);return v==null?null:W.createElement(ms.Provider,{value:l},W.createElement(ig.Provider,{children:e,value:v}))}function J5(t){let{children:n,location:e}=t;return L5(Jb(n),e)}new Promise(()=>{});function Jb(t,n){n===void 0&&(n=[]);let e=[];return W.Children.forEach(t,(r,i)=>{if(!W.isValidElement(r))return;let o=[...n,i];if(r.type===W.Fragment){e.push.apply(e,Jb(r.props.children,o));return}r.type!==it&&dn(!1),!r.props.index||!r.props.children||dn(!1);let a={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Jb(r.props.children,o)),e.push(a)}),e}/**
 * React Router DOM v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qm(){return Qm=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Qm.apply(this,arguments)}function YO(t,n){if(t==null)return{};var e={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(n.indexOf(i)>=0)&&(e[i]=t[i]);return e}function Q5(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Z5(t,n){return t.button===0&&(!n||n==="_self")&&!Q5(t)}const eU=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],tU=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],nU=W.createContext({isTransitioning:!1}),rU="startTransition",YT=Rm[rU];function iU(t){let{basename:n,children:e,future:r,window:i}=t,o=W.useRef();o.current==null&&(o.current=s5({window:i,v5Compat:!0}));let a=o.current,[s,u]=W.useState({action:a.action,location:a.location}),{v7_startTransition:l}=r||{},c=W.useCallback(d=>{l&&YT?YT(()=>u(d)):u(d)},[u,l]);return W.useLayoutEffect(()=>a.listen(c),[a,c]),W.createElement(Y5,{basename:n,children:e,location:s.location,navigationType:s.action,navigator:a,future:r})}const oU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",aU=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ho=W.forwardRef(function(n,e){let{onClick:r,relative:i,reloadDocument:o,replace:a,state:s,target:u,to:l,preventScrollReset:c,unstable_viewTransition:d}=n,f=YO(n,eU),{basename:p}=W.useContext(ms),h,v=!1;if(typeof l=="string"&&aU.test(l)&&(h=l,oU))try{let b=new URL(window.location.href),w=l.startsWith("//")?new URL(b.protocol+l):new URL(l),x=ql(w.pathname,p);w.origin===b.origin&&x!=null?l=x+w.search+w.hash:v=!0}catch{}let g=O5(l,{relative:i}),m=uU(l,{replace:a,state:s,target:u,preventScrollReset:c,relative:i,unstable_viewTransition:d});function y(b){r&&r(b),b.defaultPrevented||m(b)}return W.createElement("a",Qm({},f,{href:h||g,onClick:v||o?r:y,ref:e,target:u}))}),Dd=W.forwardRef(function(n,e){let{"aria-current":r="page",caseSensitive:i=!1,className:o="",end:a=!1,style:s,to:u,unstable_viewTransition:l,children:c}=n,d=YO(n,tU),f=og(u,{relative:d.relative}),p=Si(),h=W.useContext(HO),{navigator:v,basename:g}=W.useContext(ms),m=h!=null&&lU(f)&&l===!0,y=v.encodeLocation?v.encodeLocation(f).pathname:f.pathname,b=p.pathname,w=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;i||(b=b.toLowerCase(),w=w?w.toLowerCase():null,y=y.toLowerCase()),w&&g&&(w=ql(w,g)||w);const x=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let C=b===y||!a&&b.startsWith(y)&&b.charAt(x)==="/",E=w!=null&&(w===y||!a&&w.startsWith(y)&&w.charAt(y.length)==="/"),S={isActive:C,isPending:E,isTransitioning:m},k=C?r:void 0,N;typeof o=="function"?N=o(S):N=[o,C?"active":null,E?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let M=typeof s=="function"?s(S):s;return W.createElement(Ho,Qm({},d,{"aria-current":k,className:N,ref:e,style:M,to:u,unstable_viewTransition:l}),typeof c=="function"?c(S):c)});var Qb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Qb||(Qb={}));var JT;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(JT||(JT={}));function sU(t){let n=W.useContext(rg);return n||dn(!1),n}function uU(t,n){let{target:e,replace:r,state:i,preventScrollReset:o,relative:a,unstable_viewTransition:s}=n===void 0?{}:n,u=Er(),l=Si(),c=og(t,{relative:a});return W.useCallback(d=>{if(Z5(d,e)){d.preventDefault();let f=r!==void 0?r:Ym(l)===Ym(c);u(t,{replace:f,state:i,preventScrollReset:o,relative:a,unstable_viewTransition:s})}},[l,u,c,r,i,e,t,o,a,s])}function lU(t,n){n===void 0&&(n={});let e=W.useContext(nU);e==null&&dn(!1);let{basename:r}=sU(Qb.useViewTransitionState),i=og(t,{relative:n.relative});if(!e.isTransitioning)return!1;let o=ql(e.currentLocation.pathname,r)||e.currentLocation.pathname,a=ql(e.nextLocation.pathname,r)||e.nextLocation.pathname;return Yb(i.pathname,a)!=null||Yb(i.pathname,o)!=null}var Zb={},QT=zO;Zb.createRoot=QT.createRoot,Zb.hydrateRoot=QT.hydrateRoot;var JO={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ZT=Ae.createContext&&Ae.createContext(JO),cU=["attr","size","title"];function dU(t,n){if(t==null)return{};var e=fU(t,n),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(e[r]=t[r])}return e}function fU(t,n){if(t==null)return{};var e={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(n.indexOf(i)>=0)&&(e[i]=t[i]);return e}function Zm(){return Zm=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Zm.apply(this,arguments)}function eN(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,r)}return e}function ev(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?eN(Object(e),!0).forEach(function(r){pU(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):eN(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}function pU(t,n,e){return n=hU(n),n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function hU(t){var n=mU(t,"string");return typeof n=="symbol"?n:String(n)}function mU(t,n){if(typeof t!="object"||t===null)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var r=e.call(t,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function QO(t){return t&&t.map((n,e)=>Ae.createElement(n.tag,ev({key:e},n.attr),QO(n.child)))}function SS(t){return n=>Ae.createElement(vU,Zm({attr:ev({},t.attr)},n),QO(t.child))}function vU(t){var n=e=>{var{attr:r,size:i,title:o}=t,a=dU(t,cU),s=i||e.size||"1em",u;return e.className&&(u=e.className),t.className&&(u=(u?u+" ":"")+t.className),Ae.createElement("svg",Zm({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},e.attr,r,a,{className:u,style:ev(ev({color:t.color||e.color},e.style),t.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),o&&Ae.createElement("title",null,o),t.children)};return ZT!==void 0?Ae.createElement(ZT.Consumer,null,e=>n(e)):n(JO)}const Xd="/assets/login_img-6Ph5owg1.png",gU=()=>{const t=[Xd,Xd,Xd],[n,e]=W.useState(0),r=W.useRef(),i=()=>{const o=r.current,a=Math.round(o.scrollLeft/o.offsetWidth);e(a)};return R.jsxs("div",{className:"Carousel",children:[R.jsx("div",{className:"slides",ref:r,onScroll:i,children:t.map((o,a)=>R.jsx("img",{src:o,alt:"",className:`slide-${a+1}`},a))}),R.jsxs("div",{className:"Carousel_idx",children:[n+1," / ",R.jsx("span",{children:t.length})]})]})};var ES={},ZO={exports:{}};(function(t){function n(e){return e&&e.__esModule?e:{default:e}}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(ZO);var yt=ZO.exports,F0={};function ht(){return ht=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},ht.apply(this,arguments)}function _a(t){if(typeof t!="object"||t===null)return!1;const n=Object.getPrototypeOf(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function eD(t){if(!_a(t))return t;const n={};return Object.keys(t).forEach(e=>{n[e]=eD(t[e])}),n}function Bi(t,n,e={clone:!0}){const r=e.clone?ht({},t):t;return _a(t)&&_a(n)&&Object.keys(n).forEach(i=>{i!=="__proto__"&&(_a(n[i])&&i in t&&_a(t[i])?r[i]=Bi(t[i],n[i],e):e.clone?r[i]=_a(n[i])?eD(n[i]):n[i]:r[i]=n[i])}),r}function Kl(t){let n="https://mui.com/production-error/?code="+t;for(let e=1;e<arguments.length;e+=1)n+="&args[]="+encodeURIComponent(arguments[e]);return"Minified MUI error #"+t+"; visit "+n+" for the full message."}function vo(t){if(typeof t!="string")throw new Error(Kl(7));return t.charAt(0).toUpperCase()+t.slice(1)}function yU(...t){return t.reduce((n,e)=>e==null?n:function(...i){n.apply(this,i),e.apply(this,i)},()=>{})}function bU(t,n=166){let e;function r(...i){const o=()=>{t.apply(this,i)};clearTimeout(e),e=setTimeout(o,n)}return r.clear=()=>{clearTimeout(e)},r}function wU(t,n){return()=>null}function xU(t,n){var e,r;return W.isValidElement(t)&&n.indexOf((e=t.type.muiName)!=null?e:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function tD(t){return t&&t.ownerDocument||document}function SU(t){return tD(t).defaultView||window}function EU(t,n){return()=>null}function nD(t,n){typeof t=="function"?t(n):t&&(t.current=n)}const CU=typeof window<"u"?W.useLayoutEffect:W.useEffect,rD=CU;let tN=0;function RU(t){const[n,e]=W.useState(t),r=t||n;return W.useEffect(()=>{n==null&&(tN+=1,e(`mui-${tN}`))},[n]),r}const nN=Rm.useId;function TU(t){if(nN!==void 0){const n=nN();return t??n}return RU(t)}function NU(t,n,e,r,i){return null}function kU({controlled:t,default:n,name:e,state:r="value"}){const{current:i}=W.useRef(t!==void 0),[o,a]=W.useState(n),s=i?t:o,u=W.useCallback(l=>{i||a(l)},[]);return[s,u]}function IU(t){const n=W.useRef(t);return rD(()=>{n.current=t}),W.useRef((...e)=>(0,n.current)(...e)).current}function _U(...t){return W.useMemo(()=>t.every(n=>n==null)?null:n=>{t.forEach(e=>{nD(e,n)})},t)}let ag=!0,ew=!1,rN;const AU={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function OU(t){const{type:n,tagName:e}=t;return!!(e==="INPUT"&&AU[n]&&!t.readOnly||e==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function DU(t){t.metaKey||t.altKey||t.ctrlKey||(ag=!0)}function z0(){ag=!1}function MU(){this.visibilityState==="hidden"&&ew&&(ag=!0)}function PU(t){t.addEventListener("keydown",DU,!0),t.addEventListener("mousedown",z0,!0),t.addEventListener("pointerdown",z0,!0),t.addEventListener("touchstart",z0,!0),t.addEventListener("visibilitychange",MU,!0)}function LU(t){const{target:n}=t;try{return n.matches(":focus-visible")}catch{}return ag||OU(n)}function FU(){const t=W.useCallback(i=>{i!=null&&PU(i.ownerDocument)},[]),n=W.useRef(!1);function e(){return n.current?(ew=!0,window.clearTimeout(rN),rN=window.setTimeout(()=>{ew=!1},100),n.current=!1,!0):!1}function r(i){return LU(i)?(n.current=!0,!0):!1}return{isFocusVisibleRef:n,onFocus:r,onBlur:e,ref:t}}function iD(t,n){const e=ht({},n);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))e[r]=ht({},t[r],e[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=t[r]||{},o=n[r];e[r]={},!o||!Object.keys(o)?e[r]=i:!i||!Object.keys(i)?e[r]=o:(e[r]=ht({},o),Object.keys(i).forEach(a=>{e[r][a]=iD(i[a],o[a])}))}else e[r]===void 0&&(e[r]=t[r])}),e}function zU(t,n,e=void 0){const r={};return Object.keys(t).forEach(i=>{r[i]=t[i].reduce((o,a)=>{if(a){const s=n(a);s!==""&&o.push(s),e&&e[a]&&o.push(e[a])}return o},[]).join(" ")}),r}const iN=t=>t,BU=()=>{let t=iN;return{configure(n){t=n},generate(n){return t(n)},reset(){t=iN}}},oD=BU(),jU={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function aD(t,n,e="Mui"){const r=jU[n];return r?`${e}-${r}`:`${oD.generate(t)}-${n}`}function VU(t,n,e="Mui"){const r={};return n.forEach(i=>{r[i]=aD(t,i,e)}),r}function $U(t,n=Number.MIN_SAFE_INTEGER,e=Number.MAX_SAFE_INTEGER){return Math.max(n,Math.min(t,e))}function sa(t,n){if(t==null)return{};var e={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(n.indexOf(i)>=0)&&(e[i]=t[i]);return e}function sD(t){var n,e,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(e=sD(t[n]))&&(r&&(r+=" "),r+=e)}else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function UU(){for(var t,n,e=0,r="",i=arguments.length;e<i;e++)(t=arguments[e])&&(n=sD(t))&&(r&&(r+=" "),r+=n);return r}function uD(t){var n=Object.create(null);return function(e){return n[e]===void 0&&(n[e]=t(e)),n[e]}}var WU=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,HU=uD(function(t){return WU.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function GU(t){if(t.sheet)return t.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===t)return document.styleSheets[n]}function qU(t){var n=document.createElement("style");return n.setAttribute("data-emotion",t.key),t.nonce!==void 0&&n.setAttribute("nonce",t.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var KU=function(){function t(e){var r=this;this._insertTag=function(i){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,o),r.tags.push(i)},this.isSpeedy=e.speedy===void 0?!0:e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var n=t.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(qU(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var o=GU(i);try{o.insertRule(r,o.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},t}(),or="-ms-",tv="-moz-",Tt="-webkit-",lD="comm",CS="rule",RS="decl",XU="@import",cD="@keyframes",YU="@layer",JU=Math.abs,sg=String.fromCharCode,QU=Object.assign;function ZU(t,n){return qn(t,0)^45?(((n<<2^qn(t,0))<<2^qn(t,1))<<2^qn(t,2))<<2^qn(t,3):0}function dD(t){return t.trim()}function e6(t,n){return(t=n.exec(t))?t[0]:t}function Nt(t,n,e){return t.replace(n,e)}function tw(t,n){return t.indexOf(n)}function qn(t,n){return t.charCodeAt(n)|0}function Tf(t,n,e){return t.slice(n,e)}function ro(t){return t.length}function TS(t){return t.length}function mh(t,n){return n.push(t),t}function t6(t,n){return t.map(n).join("")}var ug=1,Xl=1,fD=0,Fr=0,wn=0,Sc="";function lg(t,n,e,r,i,o,a){return{value:t,root:n,parent:e,type:r,props:i,children:o,line:ug,column:Xl,length:a,return:""}}function od(t,n){return QU(lg("",null,null,"",null,null,0),t,{length:-t.length},n)}function n6(){return wn}function r6(){return wn=Fr>0?qn(Sc,--Fr):0,Xl--,wn===10&&(Xl=1,ug--),wn}function Qr(){return wn=Fr<fD?qn(Sc,Fr++):0,Xl++,wn===10&&(Xl=1,ug++),wn}function go(){return qn(Sc,Fr)}function im(){return Fr}function tp(t,n){return Tf(Sc,t,n)}function Nf(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function pD(t){return ug=Xl=1,fD=ro(Sc=t),Fr=0,[]}function hD(t){return Sc="",t}function om(t){return dD(tp(Fr-1,nw(t===91?t+2:t===40?t+1:t)))}function i6(t){for(;(wn=go())&&wn<33;)Qr();return Nf(t)>2||Nf(wn)>3?"":" "}function o6(t,n){for(;--n&&Qr()&&!(wn<48||wn>102||wn>57&&wn<65||wn>70&&wn<97););return tp(t,im()+(n<6&&go()==32&&Qr()==32))}function nw(t){for(;Qr();)switch(wn){case t:return Fr;case 34:case 39:t!==34&&t!==39&&nw(wn);break;case 40:t===41&&nw(t);break;case 92:Qr();break}return Fr}function a6(t,n){for(;Qr()&&t+wn!==57;)if(t+wn===84&&go()===47)break;return"/*"+tp(n,Fr-1)+"*"+sg(t===47?t:Qr())}function s6(t){for(;!Nf(go());)Qr();return tp(t,Fr)}function u6(t){return hD(am("",null,null,null,[""],t=pD(t),0,[0],t))}function am(t,n,e,r,i,o,a,s,u){for(var l=0,c=0,d=a,f=0,p=0,h=0,v=1,g=1,m=1,y=0,b="",w=i,x=o,C=r,E=b;g;)switch(h=y,y=Qr()){case 40:if(h!=108&&qn(E,d-1)==58){tw(E+=Nt(om(y),"&","&\f"),"&\f")!=-1&&(m=-1);break}case 34:case 39:case 91:E+=om(y);break;case 9:case 10:case 13:case 32:E+=i6(h);break;case 92:E+=o6(im()-1,7);continue;case 47:switch(go()){case 42:case 47:mh(l6(a6(Qr(),im()),n,e),u);break;default:E+="/"}break;case 123*v:s[l++]=ro(E)*m;case 125*v:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+c:m==-1&&(E=Nt(E,/\f/g,"")),p>0&&ro(E)-d&&mh(p>32?aN(E+";",r,e,d-1):aN(Nt(E," ","")+";",r,e,d-2),u);break;case 59:E+=";";default:if(mh(C=oN(E,n,e,l,c,i,s,b,w=[],x=[],d),o),y===123)if(c===0)am(E,n,C,C,w,o,d,s,x);else switch(f===99&&qn(E,3)===110?100:f){case 100:case 108:case 109:case 115:am(t,C,C,r&&mh(oN(t,C,C,0,0,i,s,b,i,w=[],d),x),i,x,d,s,r?w:x);break;default:am(E,C,C,C,[""],x,0,s,x)}}l=c=p=0,v=m=1,b=E="",d=a;break;case 58:d=1+ro(E),p=h;default:if(v<1){if(y==123)--v;else if(y==125&&v++==0&&r6()==125)continue}switch(E+=sg(y),y*v){case 38:m=c>0?1:(E+="\f",-1);break;case 44:s[l++]=(ro(E)-1)*m,m=1;break;case 64:go()===45&&(E+=om(Qr())),f=go(),c=d=ro(b=E+=s6(im())),y++;break;case 45:h===45&&ro(E)==2&&(v=0)}}return o}function oN(t,n,e,r,i,o,a,s,u,l,c){for(var d=i-1,f=i===0?o:[""],p=TS(f),h=0,v=0,g=0;h<r;++h)for(var m=0,y=Tf(t,d+1,d=JU(v=a[h])),b=t;m<p;++m)(b=dD(v>0?f[m]+" "+y:Nt(y,/&\f/g,f[m])))&&(u[g++]=b);return lg(t,n,e,i===0?CS:s,u,l,c)}function l6(t,n,e){return lg(t,n,e,lD,sg(n6()),Tf(t,2,-2),0)}function aN(t,n,e,r){return lg(t,n,e,RS,Tf(t,0,r),Tf(t,r+1,-1),r)}function Il(t,n){for(var e="",r=TS(t),i=0;i<r;i++)e+=n(t[i],i,t,n)||"";return e}function c6(t,n,e,r){switch(t.type){case YU:if(t.children.length)break;case XU:case RS:return t.return=t.return||t.value;case lD:return"";case cD:return t.return=t.value+"{"+Il(t.children,r)+"}";case CS:t.value=t.props.join(",")}return ro(e=Il(t.children,r))?t.return=t.value+"{"+e+"}":""}function d6(t){var n=TS(t);return function(e,r,i,o){for(var a="",s=0;s<n;s++)a+=t[s](e,r,i,o)||"";return a}}function f6(t){return function(n){n.root||(n=n.return)&&t(n)}}var p6=function(n,e,r){for(var i=0,o=0;i=o,o=go(),i===38&&o===12&&(e[r]=1),!Nf(o);)Qr();return tp(n,Fr)},h6=function(n,e){var r=-1,i=44;do switch(Nf(i)){case 0:i===38&&go()===12&&(e[r]=1),n[r]+=p6(Fr-1,e,r);break;case 2:n[r]+=om(i);break;case 4:if(i===44){n[++r]=go()===58?"&\f":"",e[r]=n[r].length;break}default:n[r]+=sg(i)}while(i=Qr());return n},m6=function(n,e){return hD(h6(pD(n),e))},sN=new WeakMap,v6=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var e=n.value,r=n.parent,i=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&e.charCodeAt(0)!==58&&!sN.get(r))&&!i){sN.set(n,!0);for(var o=[],a=m6(e,o),s=r.props,u=0,l=0;u<a.length;u++)for(var c=0;c<s.length;c++,l++)n.props[l]=o[u]?a[u].replace(/&\f/g,s[c]):s[c]+" "+a[u]}}},g6=function(n){if(n.type==="decl"){var e=n.value;e.charCodeAt(0)===108&&e.charCodeAt(2)===98&&(n.return="",n.value="")}};function mD(t,n){switch(ZU(t,n)){case 5103:return Tt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Tt+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Tt+t+tv+t+or+t+t;case 6828:case 4268:return Tt+t+or+t+t;case 6165:return Tt+t+or+"flex-"+t+t;case 5187:return Tt+t+Nt(t,/(\w+).+(:[^]+)/,Tt+"box-$1$2"+or+"flex-$1$2")+t;case 5443:return Tt+t+or+"flex-item-"+Nt(t,/flex-|-self/,"")+t;case 4675:return Tt+t+or+"flex-line-pack"+Nt(t,/align-content|flex-|-self/,"")+t;case 5548:return Tt+t+or+Nt(t,"shrink","negative")+t;case 5292:return Tt+t+or+Nt(t,"basis","preferred-size")+t;case 6060:return Tt+"box-"+Nt(t,"-grow","")+Tt+t+or+Nt(t,"grow","positive")+t;case 4554:return Tt+Nt(t,/([^-])(transform)/g,"$1"+Tt+"$2")+t;case 6187:return Nt(Nt(Nt(t,/(zoom-|grab)/,Tt+"$1"),/(image-set)/,Tt+"$1"),t,"")+t;case 5495:case 3959:return Nt(t,/(image-set\([^]*)/,Tt+"$1$`$1");case 4968:return Nt(Nt(t,/(.+:)(flex-)?(.*)/,Tt+"box-pack:$3"+or+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Tt+t+t;case 4095:case 3583:case 4068:case 2532:return Nt(t,/(.+)-inline(.+)/,Tt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ro(t)-1-n>6)switch(qn(t,n+1)){case 109:if(qn(t,n+4)!==45)break;case 102:return Nt(t,/(.+:)(.+)-([^]+)/,"$1"+Tt+"$2-$3$1"+tv+(qn(t,n+3)==108?"$3":"$2-$3"))+t;case 115:return~tw(t,"stretch")?mD(Nt(t,"stretch","fill-available"),n)+t:t}break;case 4949:if(qn(t,n+1)!==115)break;case 6444:switch(qn(t,ro(t)-3-(~tw(t,"!important")&&10))){case 107:return Nt(t,":",":"+Tt)+t;case 101:return Nt(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Tt+(qn(t,14)===45?"inline-":"")+"box$3$1"+Tt+"$2$3$1"+or+"$2box$3")+t}break;case 5936:switch(qn(t,n+11)){case 114:return Tt+t+or+Nt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Tt+t+or+Nt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Tt+t+or+Nt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Tt+t+or+t+t}return t}var y6=function(n,e,r,i){if(n.length>-1&&!n.return)switch(n.type){case RS:n.return=mD(n.value,n.length);break;case cD:return Il([od(n,{value:Nt(n.value,"@","@"+Tt)})],i);case CS:if(n.length)return t6(n.props,function(o){switch(e6(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Il([od(n,{props:[Nt(o,/:(read-\w+)/,":"+tv+"$1")]})],i);case"::placeholder":return Il([od(n,{props:[Nt(o,/:(plac\w+)/,":"+Tt+"input-$1")]}),od(n,{props:[Nt(o,/:(plac\w+)/,":"+tv+"$1")]}),od(n,{props:[Nt(o,/:(plac\w+)/,or+"input-$1")]})],i)}return""})}},b6=[y6],w6=function(n){var e=n.key;if(e==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(v){var g=v.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(v),v.setAttribute("data-s",""))})}var i=n.stylisPlugins||b6,o={},a,s=[];a=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),function(v){for(var g=v.getAttribute("data-emotion").split(" "),m=1;m<g.length;m++)o[g[m]]=!0;s.push(v)});var u,l=[v6,g6];{var c,d=[c6,f6(function(v){c.insert(v)})],f=d6(l.concat(i,d)),p=function(g){return Il(u6(g),f)};u=function(g,m,y,b){c=y,p(g?g+"{"+m.styles+"}":m.styles),b&&(h.inserted[m.name]=!0)}}var h={key:e,sheet:new KU({key:e,container:a,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:o,registered:{},insert:u};return h.sheet.hydrate(s),h},x6=!0;function S6(t,n,e){var r="";return e.split(" ").forEach(function(i){t[i]!==void 0?n.push(t[i]+";"):r+=i+" "}),r}var vD=function(n,e,r){var i=n.key+"-"+e.name;(r===!1||x6===!1)&&n.registered[i]===void 0&&(n.registered[i]=e.styles)},E6=function(n,e,r){vD(n,e,r);var i=n.key+"-"+e.name;if(n.inserted[e.name]===void 0){var o=e;do n.insert(e===o?"."+i:"",o,n.sheet,!0),o=o.next;while(o!==void 0)}};function C6(t){for(var n=0,e,r=0,i=t.length;i>=4;++r,i-=4)e=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,e=(e&65535)*1540483477+((e>>>16)*59797<<16),e^=e>>>24,n=(e&65535)*1540483477+((e>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(i){case 3:n^=(t.charCodeAt(r+2)&255)<<16;case 2:n^=(t.charCodeAt(r+1)&255)<<8;case 1:n^=t.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var R6={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},T6=/[A-Z]|^ms/g,N6=/_EMO_([^_]+?)_([^]*?)_EMO_/g,gD=function(n){return n.charCodeAt(1)===45},uN=function(n){return n!=null&&typeof n!="boolean"},B0=uD(function(t){return gD(t)?t:t.replace(T6,"-$&").toLowerCase()}),lN=function(n,e){switch(n){case"animation":case"animationName":if(typeof e=="string")return e.replace(N6,function(r,i,o){return io={name:i,styles:o,next:io},i})}return R6[n]!==1&&!gD(n)&&typeof e=="number"&&e!==0?e+"px":e};function kf(t,n,e){if(e==null)return"";if(e.__emotion_styles!==void 0)return e;switch(typeof e){case"boolean":return"";case"object":{if(e.anim===1)return io={name:e.name,styles:e.styles,next:io},e.name;if(e.styles!==void 0){var r=e.next;if(r!==void 0)for(;r!==void 0;)io={name:r.name,styles:r.styles,next:io},r=r.next;var i=e.styles+";";return i}return k6(t,n,e)}case"function":{if(t!==void 0){var o=io,a=e(t);return io=o,kf(t,n,a)}break}}if(n==null)return e;var s=n[e];return s!==void 0?s:e}function k6(t,n,e){var r="";if(Array.isArray(e))for(var i=0;i<e.length;i++)r+=kf(t,n,e[i])+";";else for(var o in e){var a=e[o];if(typeof a!="object")n!=null&&n[a]!==void 0?r+=o+"{"+n[a]+"}":uN(a)&&(r+=B0(o)+":"+lN(o,a)+";");else if(Array.isArray(a)&&typeof a[0]=="string"&&(n==null||n[a[0]]===void 0))for(var s=0;s<a.length;s++)uN(a[s])&&(r+=B0(o)+":"+lN(o,a[s])+";");else{var u=kf(t,n,a);switch(o){case"animation":case"animationName":{r+=B0(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var cN=/label:\s*([^\s;\n{]+)\s*(;|$)/g,io,I6=function(n,e,r){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var i=!0,o="";io=void 0;var a=n[0];a==null||a.raw===void 0?(i=!1,o+=kf(r,e,a)):o+=a[0];for(var s=1;s<n.length;s++)o+=kf(r,e,n[s]),i&&(o+=a[s]);cN.lastIndex=0;for(var u="",l;(l=cN.exec(o))!==null;)u+="-"+l[1];var c=C6(o)+u;return{name:c,styles:o,next:io}},_6=function(n){return n()},A6=Rm.useInsertionEffect?Rm.useInsertionEffect:!1,O6=A6||_6,yD=W.createContext(typeof HTMLElement<"u"?w6({key:"css"}):null);yD.Provider;var D6=function(n){return W.forwardRef(function(e,r){var i=W.useContext(yD);return n(e,i,r)})},bD=W.createContext({}),M6=HU,P6=function(n){return n!=="theme"},dN=function(n){return typeof n=="string"&&n.charCodeAt(0)>96?M6:P6},fN=function(n,e,r){var i;if(e){var o=e.shouldForwardProp;i=n.__emotion_forwardProp&&o?function(a){return n.__emotion_forwardProp(a)&&o(a)}:o}return typeof i!="function"&&r&&(i=n.__emotion_forwardProp),i},L6=function(n){var e=n.cache,r=n.serialized,i=n.isStringTag;return vD(e,r,i),O6(function(){return E6(e,r,i)}),null},F6=function t(n,e){var r=n.__emotion_real===n,i=r&&n.__emotion_base||n,o,a;e!==void 0&&(o=e.label,a=e.target);var s=fN(n,e,r),u=s||dN(i),l=!u("as");return function(){var c=arguments,d=r&&n.__emotion_styles!==void 0?n.__emotion_styles.slice(0):[];if(o!==void 0&&d.push("label:"+o+";"),c[0]==null||c[0].raw===void 0)d.push.apply(d,c);else{d.push(c[0][0]);for(var f=c.length,p=1;p<f;p++)d.push(c[p],c[0][p])}var h=D6(function(v,g,m){var y=l&&v.as||i,b="",w=[],x=v;if(v.theme==null){x={};for(var C in v)x[C]=v[C];x.theme=W.useContext(bD)}typeof v.className=="string"?b=S6(g.registered,w,v.className):v.className!=null&&(b=v.className+" ");var E=I6(d.concat(w),g.registered,x);b+=g.key+"-"+E.name,a!==void 0&&(b+=" "+a);var S=l&&s===void 0?dN(y):u,k={};for(var N in v)l&&N==="as"||S(N)&&(k[N]=v[N]);return k.className=b,k.ref=m,W.createElement(W.Fragment,null,W.createElement(L6,{cache:g,serialized:E,isStringTag:typeof y=="string"}),W.createElement(y,k))});return h.displayName=o!==void 0?o:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",h.defaultProps=n.defaultProps,h.__emotion_real=h,h.__emotion_base=i,h.__emotion_styles=d,h.__emotion_forwardProp=s,Object.defineProperty(h,"toString",{value:function(){return"."+a}}),h.withComponent=function(v,g){return t(v,ht({},e,g,{shouldForwardProp:fN(h,g,!0)})).apply(void 0,d)},h}},z6=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],rw=F6.bind();z6.forEach(function(t){rw[t]=rw(t)});function B6(t,n){return rw(t,n)}const j6=(t,n)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=n(t.__emotion_styles))},V6=["values","unit","step"],$6=t=>{const n=Object.keys(t).map(e=>({key:e,val:t[e]}))||[];return n.sort((e,r)=>e.val-r.val),n.reduce((e,r)=>ht({},e,{[r.key]:r.val}),{})};function U6(t){const{values:n={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:e="px",step:r=5}=t,i=sa(t,V6),o=$6(n),a=Object.keys(o);function s(f){return`@media (min-width:${typeof n[f]=="number"?n[f]:f}${e})`}function u(f){return`@media (max-width:${(typeof n[f]=="number"?n[f]:f)-r/100}${e})`}function l(f,p){const h=a.indexOf(p);return`@media (min-width:${typeof n[f]=="number"?n[f]:f}${e}) and (max-width:${(h!==-1&&typeof n[a[h]]=="number"?n[a[h]]:p)-r/100}${e})`}function c(f){return a.indexOf(f)+1<a.length?l(f,a[a.indexOf(f)+1]):s(f)}function d(f){const p=a.indexOf(f);return p===0?s(a[1]):p===a.length-1?u(a[p]):l(f,a[a.indexOf(f)+1]).replace("@media","@media not all and")}return ht({keys:a,values:o,up:s,down:u,between:l,only:c,not:d,unit:e},i)}const W6={borderRadius:4},H6=W6;function Yd(t,n){return n?Bi(t,n,{clone:!1}):t}const NS={xs:0,sm:600,md:900,lg:1200,xl:1536},pN={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${NS[t]}px)`};function ta(t,n,e){const r=t.theme||{};if(Array.isArray(n)){const o=r.breakpoints||pN;return n.reduce((a,s,u)=>(a[o.up(o.keys[u])]=e(n[u]),a),{})}if(typeof n=="object"){const o=r.breakpoints||pN;return Object.keys(n).reduce((a,s)=>{if(Object.keys(o.values||NS).indexOf(s)!==-1){const u=o.up(s);a[u]=e(n[s],s)}else{const u=s;a[u]=n[u]}return a},{})}return e(n)}function G6(t={}){var n;return((n=t.keys)==null?void 0:n.reduce((r,i)=>{const o=t.up(i);return r[o]={},r},{}))||{}}function q6(t,n){return t.reduce((e,r)=>{const i=e[r];return(!i||Object.keys(i).length===0)&&delete e[r],e},n)}function cg(t,n,e=!0){if(!n||typeof n!="string")return null;if(t&&t.vars&&e){const r=`vars.${n}`.split(".").reduce((i,o)=>i&&i[o]?i[o]:null,t);if(r!=null)return r}return n.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function nv(t,n,e,r=e){let i;return typeof t=="function"?i=t(e):Array.isArray(t)?i=t[e]||r:i=cg(t,e)||r,n&&(i=n(i,r,t)),i}function yn(t){const{prop:n,cssProperty:e=t.prop,themeKey:r,transform:i}=t,o=a=>{if(a[n]==null)return null;const s=a[n],u=a.theme,l=cg(u,r)||{};return ta(a,s,d=>{let f=nv(l,i,d);return d===f&&typeof d=="string"&&(f=nv(l,i,`${n}${d==="default"?"":vo(d)}`,d)),e===!1?f:{[e]:f}})};return o.propTypes={},o.filterProps=[n],o}function K6(t){const n={};return e=>(n[e]===void 0&&(n[e]=t(e)),n[e])}const X6={m:"margin",p:"padding"},Y6={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},hN={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},J6=K6(t=>{if(t.length>2)if(hN[t])t=hN[t];else return[t];const[n,e]=t.split(""),r=X6[n],i=Y6[e]||"";return Array.isArray(i)?i.map(o=>r+o):[r+i]}),kS=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],IS=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...kS,...IS];function np(t,n,e,r){var i;const o=(i=cg(t,n,!1))!=null?i:e;return typeof o=="number"?a=>typeof a=="string"?a:o*a:Array.isArray(o)?a=>typeof a=="string"?a:o[a]:typeof o=="function"?o:()=>{}}function wD(t){return np(t,"spacing",8)}function rp(t,n){if(typeof n=="string"||n==null)return n;const e=Math.abs(n),r=t(e);return n>=0?r:typeof r=="number"?-r:`-${r}`}function Q6(t,n){return e=>t.reduce((r,i)=>(r[i]=rp(n,e),r),{})}function Z6(t,n,e,r){if(n.indexOf(e)===-1)return null;const i=J6(e),o=Q6(i,r),a=t[e];return ta(t,a,o)}function xD(t,n){const e=wD(t.theme);return Object.keys(t).map(r=>Z6(t,n,r,e)).reduce(Yd,{})}function un(t){return xD(t,kS)}un.propTypes={};un.filterProps=kS;function ln(t){return xD(t,IS)}ln.propTypes={};ln.filterProps=IS;function eW(t=8){if(t.mui)return t;const n=wD({spacing:t}),e=(...r)=>(r.length===0?[1]:r).map(o=>{const a=n(o);return typeof a=="number"?`${a}px`:a}).join(" ");return e.mui=!0,e}function dg(...t){const n=t.reduce((r,i)=>(i.filterProps.forEach(o=>{r[o]=i}),r),{}),e=r=>Object.keys(r).reduce((i,o)=>n[o]?Yd(i,n[o](r)):i,{});return e.propTypes={},e.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),e}function mi(t){return typeof t!="number"?t:`${t}px solid`}function Ei(t,n){return yn({prop:t,themeKey:"borders",transform:n})}const tW=Ei("border",mi),nW=Ei("borderTop",mi),rW=Ei("borderRight",mi),iW=Ei("borderBottom",mi),oW=Ei("borderLeft",mi),aW=Ei("borderColor"),sW=Ei("borderTopColor"),uW=Ei("borderRightColor"),lW=Ei("borderBottomColor"),cW=Ei("borderLeftColor"),dW=Ei("outline",mi),fW=Ei("outlineColor"),fg=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const n=np(t.theme,"shape.borderRadius",4),e=r=>({borderRadius:rp(n,r)});return ta(t,t.borderRadius,e)}return null};fg.propTypes={};fg.filterProps=["borderRadius"];dg(tW,nW,rW,iW,oW,aW,sW,uW,lW,cW,fg,dW,fW);const pg=t=>{if(t.gap!==void 0&&t.gap!==null){const n=np(t.theme,"spacing",8),e=r=>({gap:rp(n,r)});return ta(t,t.gap,e)}return null};pg.propTypes={};pg.filterProps=["gap"];const hg=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const n=np(t.theme,"spacing",8),e=r=>({columnGap:rp(n,r)});return ta(t,t.columnGap,e)}return null};hg.propTypes={};hg.filterProps=["columnGap"];const mg=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const n=np(t.theme,"spacing",8),e=r=>({rowGap:rp(n,r)});return ta(t,t.rowGap,e)}return null};mg.propTypes={};mg.filterProps=["rowGap"];const pW=yn({prop:"gridColumn"}),hW=yn({prop:"gridRow"}),mW=yn({prop:"gridAutoFlow"}),vW=yn({prop:"gridAutoColumns"}),gW=yn({prop:"gridAutoRows"}),yW=yn({prop:"gridTemplateColumns"}),bW=yn({prop:"gridTemplateRows"}),wW=yn({prop:"gridTemplateAreas"}),xW=yn({prop:"gridArea"});dg(pg,hg,mg,pW,hW,mW,vW,gW,yW,bW,wW,xW);function _l(t,n){return n==="grey"?n:t}const SW=yn({prop:"color",themeKey:"palette",transform:_l}),EW=yn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:_l}),CW=yn({prop:"backgroundColor",themeKey:"palette",transform:_l});dg(SW,EW,CW);function Gr(t){return t<=1&&t!==0?`${t*100}%`:t}const RW=yn({prop:"width",transform:Gr}),_S=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const n=e=>{var r,i;const o=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[e])||NS[e];return o?((i=t.theme)==null||(i=i.breakpoints)==null?void 0:i.unit)!=="px"?{maxWidth:`${o}${t.theme.breakpoints.unit}`}:{maxWidth:o}:{maxWidth:Gr(e)}};return ta(t,t.maxWidth,n)}return null};_S.filterProps=["maxWidth"];const TW=yn({prop:"minWidth",transform:Gr}),NW=yn({prop:"height",transform:Gr}),kW=yn({prop:"maxHeight",transform:Gr}),IW=yn({prop:"minHeight",transform:Gr});yn({prop:"size",cssProperty:"width",transform:Gr});yn({prop:"size",cssProperty:"height",transform:Gr});const _W=yn({prop:"boxSizing"});dg(RW,_S,TW,NW,kW,IW,_W);const AW={border:{themeKey:"borders",transform:mi},borderTop:{themeKey:"borders",transform:mi},borderRight:{themeKey:"borders",transform:mi},borderBottom:{themeKey:"borders",transform:mi},borderLeft:{themeKey:"borders",transform:mi},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:mi},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:fg},color:{themeKey:"palette",transform:_l},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:_l},backgroundColor:{themeKey:"palette",transform:_l},p:{style:ln},pt:{style:ln},pr:{style:ln},pb:{style:ln},pl:{style:ln},px:{style:ln},py:{style:ln},padding:{style:ln},paddingTop:{style:ln},paddingRight:{style:ln},paddingBottom:{style:ln},paddingLeft:{style:ln},paddingX:{style:ln},paddingY:{style:ln},paddingInline:{style:ln},paddingInlineStart:{style:ln},paddingInlineEnd:{style:ln},paddingBlock:{style:ln},paddingBlockStart:{style:ln},paddingBlockEnd:{style:ln},m:{style:un},mt:{style:un},mr:{style:un},mb:{style:un},ml:{style:un},mx:{style:un},my:{style:un},margin:{style:un},marginTop:{style:un},marginRight:{style:un},marginBottom:{style:un},marginLeft:{style:un},marginX:{style:un},marginY:{style:un},marginInline:{style:un},marginInlineStart:{style:un},marginInlineEnd:{style:un},marginBlock:{style:un},marginBlockStart:{style:un},marginBlockEnd:{style:un},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:pg},rowGap:{style:mg},columnGap:{style:hg},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Gr},maxWidth:{style:_S},minWidth:{transform:Gr},height:{transform:Gr},maxHeight:{transform:Gr},minHeight:{transform:Gr},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},AS=AW;function OW(...t){const n=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),e=new Set(n);return t.every(r=>e.size===Object.keys(r).length)}function DW(t,n){return typeof t=="function"?t(n):t}function MW(){function t(e,r,i,o){const a={[e]:r,theme:i},s=o[e];if(!s)return{[e]:r};const{cssProperty:u=e,themeKey:l,transform:c,style:d}=s;if(r==null)return null;if(l==="typography"&&r==="inherit")return{[e]:r};const f=cg(i,l)||{};return d?d(a):ta(a,r,h=>{let v=nv(f,c,h);return h===v&&typeof h=="string"&&(v=nv(f,c,`${e}${h==="default"?"":vo(h)}`,h)),u===!1?v:{[u]:v}})}function n(e){var r;const{sx:i,theme:o={}}=e||{};if(!i)return null;const a=(r=o.unstable_sxConfig)!=null?r:AS;function s(u){let l=u;if(typeof u=="function")l=u(o);else if(typeof u!="object")return u;if(!l)return null;const c=G6(o.breakpoints),d=Object.keys(c);let f=c;return Object.keys(l).forEach(p=>{const h=DW(l[p],o);if(h!=null)if(typeof h=="object")if(a[p])f=Yd(f,t(p,h,o,a));else{const v=ta({theme:o},h,g=>({[p]:g}));OW(v,h)?f[p]=n({sx:h,theme:o}):f=Yd(f,v)}else f=Yd(f,t(p,h,o,a))}),q6(d,f)}return Array.isArray(i)?i.map(s):s(i)}return n}const vg=MW();vg.filterProps=["sx"];const PW=["breakpoints","palette","spacing","shape"];function OS(t={},...n){const{breakpoints:e={},palette:r={},spacing:i,shape:o={}}=t,a=sa(t,PW),s=U6(e),u=eW(i);let l=Bi({breakpoints:s,direction:"ltr",components:{},palette:ht({mode:"light"},r),spacing:u,shape:ht({},H6,o)},a);return l=n.reduce((c,d)=>Bi(c,d),l),l.unstable_sxConfig=ht({},AS,a==null?void 0:a.unstable_sxConfig),l.unstable_sx=function(d){return vg({sx:d,theme:this})},l}function LW(t){return Object.keys(t).length===0}function FW(t=null){const n=W.useContext(bD);return!n||LW(n)?t:n}const zW=OS();function BW(t=zW){return FW(t)}const jW=["variant"];function mN(t){return t.length===0}function SD(t){const{variant:n}=t,e=sa(t,jW);let r=n||"";return Object.keys(e).sort().forEach(i=>{i==="color"?r+=mN(r)?t[i]:vo(t[i]):r+=`${mN(r)?i:vo(i)}${vo(t[i].toString())}`}),r}const VW=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function $W(t){return Object.keys(t).length===0}function UW(t){return typeof t=="string"&&t.charCodeAt(0)>96}const WW=(t,n)=>n.components&&n.components[t]&&n.components[t].styleOverrides?n.components[t].styleOverrides:null,rv=t=>{let n=0;const e={};return t&&t.forEach(r=>{let i="";typeof r.props=="function"?(i=`callback${n}`,n+=1):i=SD(r.props),e[i]=r.style}),e},HW=(t,n)=>{let e=[];return n&&n.components&&n.components[t]&&n.components[t].variants&&(e=n.components[t].variants),rv(e)},iv=(t,n,e)=>{const{ownerState:r={}}=t,i=[];let o=0;return e&&e.forEach(a=>{let s=!0;if(typeof a.props=="function"){const u=ht({},t,r);s=a.props(u)}else Object.keys(a.props).forEach(u=>{r[u]!==a.props[u]&&t[u]!==a.props[u]&&(s=!1)});s&&(typeof a.props=="function"?i.push(n[`callback${o}`]):i.push(n[SD(a.props)])),typeof a.props=="function"&&(o+=1)}),i},GW=(t,n,e,r)=>{var i;const o=e==null||(i=e.components)==null||(i=i[r])==null?void 0:i.variants;return iv(t,n,o)};function sm(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const qW=OS(),KW=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function um({defaultTheme:t,theme:n,themeId:e}){return $W(n)?t:n[e]||n}function XW(t){return t?(n,e)=>e[t]:null}const vN=({styledArg:t,props:n,defaultTheme:e,themeId:r})=>{const i=t(ht({},n,{theme:um(ht({},n,{defaultTheme:e,themeId:r}))}));let o;if(i&&i.variants&&(o=i.variants,delete i.variants),o){const a=iv(n,rv(o),o);return[i,...a]}return i};function YW(t={}){const{themeId:n,defaultTheme:e=qW,rootShouldForwardProp:r=sm,slotShouldForwardProp:i=sm}=t,o=a=>vg(ht({},a,{theme:um(ht({},a,{defaultTheme:e,themeId:n}))}));return o.__mui_systemSx=!0,(a,s={})=>{j6(a,w=>w.filter(x=>!(x!=null&&x.__mui_systemSx)));const{name:u,slot:l,skipVariantsResolver:c,skipSx:d,overridesResolver:f=XW(KW(l))}=s,p=sa(s,VW),h=c!==void 0?c:l&&l!=="Root"&&l!=="root"||!1,v=d||!1;let g,m=sm;l==="Root"||l==="root"?m=r:l?m=i:UW(a)&&(m=void 0);const y=B6(a,ht({shouldForwardProp:m,label:g},p)),b=(w,...x)=>{const C=x?x.map(N=>{if(typeof N=="function"&&N.__emotion_real!==N)return M=>vN({styledArg:N,props:M,defaultTheme:e,themeId:n});if(_a(N)){let M=N,D;return N&&N.variants&&(D=N.variants,delete M.variants,M=T=>{let O=N;return iv(T,rv(D),D).forEach(A=>{O=Bi(O,A)}),O}),M}return N}):[];let E=w;if(_a(w)){let N;w&&w.variants&&(N=w.variants,delete E.variants,E=M=>{let D=w;return iv(M,rv(N),N).forEach(O=>{D=Bi(D,O)}),D})}else typeof w=="function"&&w.__emotion_real!==w&&(E=N=>vN({styledArg:w,props:N,defaultTheme:e,themeId:n}));u&&f&&C.push(N=>{const M=um(ht({},N,{defaultTheme:e,themeId:n})),D=WW(u,M);if(D){const T={};return Object.entries(D).forEach(([O,P])=>{T[O]=typeof P=="function"?P(ht({},N,{theme:M})):P}),f(N,T)}return null}),u&&!h&&C.push(N=>{const M=um(ht({},N,{defaultTheme:e,themeId:n}));return GW(N,HW(u,M),M,u)}),v||C.push(o);const S=C.length-x.length;if(Array.isArray(w)&&S>0){const N=new Array(S).fill("");E=[...w,...N],E.raw=[...w.raw,...N]}const k=y(E,...C);return a.muiName&&(k.muiName=a.muiName),k};return y.withConfig&&(b.withConfig=y.withConfig),b}}function JW(t){const{theme:n,name:e,props:r}=t;return!n||!n.components||!n.components[e]||!n.components[e].defaultProps?r:iD(n.components[e].defaultProps,r)}function QW({props:t,name:n,defaultTheme:e,themeId:r}){let i=BW(e);return r&&(i=i[r]||i),JW({theme:i,name:n,props:t})}function ED(t,n=0,e=1){return $U(t,n,e)}function ZW(t){t=t.slice(1);const n=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let e=t.match(n);return e&&e[0].length===1&&(e=e.map(r=>r+r)),e?`rgb${e.length===4?"a":""}(${e.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Yl(t){if(t.type)return t;if(t.charAt(0)==="#")return Yl(ZW(t));const n=t.indexOf("("),e=t.substring(0,n);if(["rgb","rgba","hsl","hsla","color"].indexOf(e)===-1)throw new Error(Kl(9,t));let r=t.substring(n+1,t.length-1),i;if(e==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(Kl(10,i))}else r=r.split(",");return r=r.map(o=>parseFloat(o)),{type:e,values:r,colorSpace:i}}function DS(t){const{type:n,colorSpace:e}=t;let{values:r}=t;return n.indexOf("rgb")!==-1?r=r.map((i,o)=>o<3?parseInt(i,10):i):n.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),n.indexOf("color")!==-1?r=`${e} ${r.join(" ")}`:r=`${r.join(", ")}`,`${n}(${r})`}function e8(t){t=Yl(t);const{values:n}=t,e=n[0],r=n[1]/100,i=n[2]/100,o=r*Math.min(i,1-i),a=(l,c=(l+e/30)%12)=>i-o*Math.max(Math.min(c-3,9-c,1),-1);let s="rgb";const u=[Math.round(a(0)*255),Math.round(a(8)*255),Math.round(a(4)*255)];return t.type==="hsla"&&(s+="a",u.push(n[3])),DS({type:s,values:u})}function gN(t){t=Yl(t);let n=t.type==="hsl"||t.type==="hsla"?Yl(e8(t)).values:t.values;return n=n.map(e=>(t.type!=="color"&&(e/=255),e<=.03928?e/12.92:((e+.055)/1.055)**2.4)),Number((.2126*n[0]+.7152*n[1]+.0722*n[2]).toFixed(3))}function t8(t,n){const e=gN(t),r=gN(n);return(Math.max(e,r)+.05)/(Math.min(e,r)+.05)}function n8(t,n){if(t=Yl(t),n=ED(n),t.type.indexOf("hsl")!==-1)t.values[2]*=1-n;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let e=0;e<3;e+=1)t.values[e]*=1-n;return DS(t)}function r8(t,n){if(t=Yl(t),n=ED(n),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*n;else if(t.type.indexOf("rgb")!==-1)for(let e=0;e<3;e+=1)t.values[e]+=(255-t.values[e])*n;else if(t.type.indexOf("color")!==-1)for(let e=0;e<3;e+=1)t.values[e]+=(1-t.values[e])*n;return DS(t)}function i8(t,n){return ht({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},n)}const o8={black:"#000",white:"#fff"},If=o8,a8={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},s8=a8,u8={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Uu=u8,l8={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Wu=l8,c8={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},ad=c8,d8={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Hu=d8,f8={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Gu=f8,p8={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},qu=p8,h8=["mode","contrastThreshold","tonalOffset"],yN={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:If.white,default:If.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},j0={text:{primary:If.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:If.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function bN(t,n,e,r){const i=r.light||r,o=r.dark||r*1.5;t[n]||(t.hasOwnProperty(e)?t[n]=t[e]:n==="light"?t.light=r8(t.main,i):n==="dark"&&(t.dark=n8(t.main,o)))}function m8(t="light"){return t==="dark"?{main:Hu[200],light:Hu[50],dark:Hu[400]}:{main:Hu[700],light:Hu[400],dark:Hu[800]}}function v8(t="light"){return t==="dark"?{main:Uu[200],light:Uu[50],dark:Uu[400]}:{main:Uu[500],light:Uu[300],dark:Uu[700]}}function g8(t="light"){return t==="dark"?{main:Wu[500],light:Wu[300],dark:Wu[700]}:{main:Wu[700],light:Wu[400],dark:Wu[800]}}function y8(t="light"){return t==="dark"?{main:Gu[400],light:Gu[300],dark:Gu[700]}:{main:Gu[700],light:Gu[500],dark:Gu[900]}}function b8(t="light"){return t==="dark"?{main:qu[400],light:qu[300],dark:qu[700]}:{main:qu[800],light:qu[500],dark:qu[900]}}function w8(t="light"){return t==="dark"?{main:ad[400],light:ad[300],dark:ad[700]}:{main:"#ed6c02",light:ad[500],dark:ad[900]}}function x8(t){const{mode:n="light",contrastThreshold:e=3,tonalOffset:r=.2}=t,i=sa(t,h8),o=t.primary||m8(n),a=t.secondary||v8(n),s=t.error||g8(n),u=t.info||y8(n),l=t.success||b8(n),c=t.warning||w8(n);function d(v){return t8(v,j0.text.primary)>=e?j0.text.primary:yN.text.primary}const f=({color:v,name:g,mainShade:m=500,lightShade:y=300,darkShade:b=700})=>{if(v=ht({},v),!v.main&&v[m]&&(v.main=v[m]),!v.hasOwnProperty("main"))throw new Error(Kl(11,g?` (${g})`:"",m));if(typeof v.main!="string")throw new Error(Kl(12,g?` (${g})`:"",JSON.stringify(v.main)));return bN(v,"light",y,r),bN(v,"dark",b,r),v.contrastText||(v.contrastText=d(v.main)),v},p={dark:j0,light:yN};return Bi(ht({common:ht({},If),mode:n,primary:f({color:o,name:"primary"}),secondary:f({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:f({color:s,name:"error"}),warning:f({color:c,name:"warning"}),info:f({color:u,name:"info"}),success:f({color:l,name:"success"}),grey:s8,contrastThreshold:e,getContrastText:d,augmentColor:f,tonalOffset:r},p[n]),i)}const S8=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function E8(t){return Math.round(t*1e5)/1e5}const wN={textTransform:"uppercase"},xN='"Roboto", "Helvetica", "Arial", sans-serif';function C8(t,n){const e=typeof n=="function"?n(t):n,{fontFamily:r=xN,fontSize:i=14,fontWeightLight:o=300,fontWeightRegular:a=400,fontWeightMedium:s=500,fontWeightBold:u=700,htmlFontSize:l=16,allVariants:c,pxToRem:d}=e,f=sa(e,S8),p=i/14,h=d||(m=>`${m/l*p}rem`),v=(m,y,b,w,x)=>ht({fontFamily:r,fontWeight:m,fontSize:h(y),lineHeight:b},r===xN?{letterSpacing:`${E8(w/y)}em`}:{},x,c),g={h1:v(o,96,1.167,-1.5),h2:v(o,60,1.2,-.5),h3:v(a,48,1.167,0),h4:v(a,34,1.235,.25),h5:v(a,24,1.334,0),h6:v(s,20,1.6,.15),subtitle1:v(a,16,1.75,.15),subtitle2:v(s,14,1.57,.1),body1:v(a,16,1.5,.15),body2:v(a,14,1.43,.15),button:v(s,14,1.75,.4,wN),caption:v(a,12,1.66,.4),overline:v(a,12,2.66,1,wN),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Bi(ht({htmlFontSize:l,pxToRem:h,fontFamily:r,fontSize:i,fontWeightLight:o,fontWeightRegular:a,fontWeightMedium:s,fontWeightBold:u},g),f,{clone:!1})}const R8=.2,T8=.14,N8=.12;function Xt(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${R8})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${T8})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${N8})`].join(",")}const k8=["none",Xt(0,2,1,-1,0,1,1,0,0,1,3,0),Xt(0,3,1,-2,0,2,2,0,0,1,5,0),Xt(0,3,3,-2,0,3,4,0,0,1,8,0),Xt(0,2,4,-1,0,4,5,0,0,1,10,0),Xt(0,3,5,-1,0,5,8,0,0,1,14,0),Xt(0,3,5,-1,0,6,10,0,0,1,18,0),Xt(0,4,5,-2,0,7,10,1,0,2,16,1),Xt(0,5,5,-3,0,8,10,1,0,3,14,2),Xt(0,5,6,-3,0,9,12,1,0,3,16,2),Xt(0,6,6,-3,0,10,14,1,0,4,18,3),Xt(0,6,7,-4,0,11,15,1,0,4,20,3),Xt(0,7,8,-4,0,12,17,2,0,5,22,4),Xt(0,7,8,-4,0,13,19,2,0,5,24,4),Xt(0,7,9,-4,0,14,21,2,0,5,26,4),Xt(0,8,9,-5,0,15,22,2,0,6,28,5),Xt(0,8,10,-5,0,16,24,2,0,6,30,5),Xt(0,8,11,-5,0,17,26,2,0,6,32,5),Xt(0,9,11,-5,0,18,28,2,0,7,34,6),Xt(0,9,12,-6,0,19,29,2,0,7,36,6),Xt(0,10,13,-6,0,20,31,3,0,8,38,7),Xt(0,10,13,-6,0,21,33,3,0,8,40,7),Xt(0,10,14,-6,0,22,35,3,0,8,42,7),Xt(0,11,14,-7,0,23,36,3,0,9,44,8),Xt(0,11,15,-7,0,24,38,3,0,9,46,8)],I8=["duration","easing","delay"],_8={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},A8={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function SN(t){return`${Math.round(t)}ms`}function O8(t){if(!t)return 0;const n=t/36;return Math.round((4+15*n**.25+n/5)*10)}function D8(t){const n=ht({},_8,t.easing),e=ht({},A8,t.duration);return ht({getAutoHeightDuration:O8,create:(i=["all"],o={})=>{const{duration:a=e.standard,easing:s=n.easeInOut,delay:u=0}=o;return sa(o,I8),(Array.isArray(i)?i:[i]).map(l=>`${l} ${typeof a=="string"?a:SN(a)} ${s} ${typeof u=="string"?u:SN(u)}`).join(",")}},t,{easing:n,duration:e})}const M8={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},P8=M8,L8=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function F8(t={},...n){const{mixins:e={},palette:r={},transitions:i={},typography:o={}}=t,a=sa(t,L8);if(t.vars)throw new Error(Kl(18));const s=x8(r),u=OS(t);let l=Bi(u,{mixins:i8(u.breakpoints,e),palette:s,shadows:k8.slice(),typography:C8(s,o),transitions:D8(i),zIndex:ht({},P8),applyDarkStyles(c){return this.vars?{[this.getColorSchemeSelector("dark").replace(/(\[[^\]]+\])/,":where($1)")]:c}:this.palette.mode==="dark"?c:{}}});return l=Bi(l,a),l=n.reduce((c,d)=>Bi(c,d),l),l.unstable_sxConfig=ht({},AS,a==null?void 0:a.unstable_sxConfig),l.unstable_sx=function(d){return vg({sx:d,theme:this})},l}const z8=F8(),CD=z8,RD="$$material";function B8({props:t,name:n}){return QW({props:t,name:n,defaultTheme:CD,themeId:RD})}const j8=t=>sm(t)&&t!=="classes",V8=YW({themeId:RD,defaultTheme:CD,rootShouldForwardProp:j8});function $8(t){return aD("MuiSvgIcon",t)}VU("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const U8=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],W8=t=>{const{color:n,fontSize:e,classes:r}=t,i={root:["root",n!=="inherit"&&`color${vo(n)}`,`fontSize${vo(e)}`]};return zU(i,$8,r)},H8=V8("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:e}=t;return[n.root,e.color!=="inherit"&&n[`color${vo(e.color)}`],n[`fontSize${vo(e.fontSize)}`]]}})(({theme:t,ownerState:n})=>{var e,r,i,o,a,s,u,l,c,d,f,p,h;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:n.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(e=t.transitions)==null||(r=e.create)==null?void 0:r.call(e,"fill",{duration:(i=t.transitions)==null||(i=i.duration)==null?void 0:i.shorter}),fontSize:{inherit:"inherit",small:((o=t.typography)==null||(a=o.pxToRem)==null?void 0:a.call(o,20))||"1.25rem",medium:((s=t.typography)==null||(u=s.pxToRem)==null?void 0:u.call(s,24))||"1.5rem",large:((l=t.typography)==null||(c=l.pxToRem)==null?void 0:c.call(l,35))||"2.1875rem"}[n.fontSize],color:(d=(f=(t.vars||t).palette)==null||(f=f[n.color])==null?void 0:f.main)!=null?d:{action:(p=(t.vars||t).palette)==null||(p=p.action)==null?void 0:p.active,disabled:(h=(t.vars||t).palette)==null||(h=h.action)==null?void 0:h.disabled,inherit:void 0}[n.color]}}),iw=W.forwardRef(function(n,e){const r=B8({props:n,name:"MuiSvgIcon"}),{children:i,className:o,color:a="inherit",component:s="svg",fontSize:u="medium",htmlColor:l,inheritViewBox:c=!1,titleAccess:d,viewBox:f="0 0 24 24"}=r,p=sa(r,U8),h=W.isValidElement(i)&&i.type==="svg",v=ht({},r,{color:a,component:s,fontSize:u,instanceFontSize:n.fontSize,inheritViewBox:c,viewBox:f,hasSvgAsChild:h}),g={};c||(g.viewBox=f);const m=W8(v);return R.jsxs(H8,ht({as:s,className:UU(m.root,o),focusable:"false",color:l,"aria-hidden":d?void 0:!0,role:d?"img":void 0,ref:e},g,p,h&&i.props,{ownerState:v,children:[h?i.props.children:i,d?R.jsx("title",{children:d}):null]}))});iw.muiName="SvgIcon";function G8(t,n){function e(r,i){return R.jsx(iw,ht({"data-testid":`${n}Icon`,ref:i},r,{children:t}))}return e.muiName=iw.muiName,W.memo(W.forwardRef(e))}const q8={configure:t=>{oD.configure(t)}},K8=Object.freeze(Object.defineProperty({__proto__:null,capitalize:vo,createChainedFunction:yU,createSvgIcon:G8,debounce:bU,deprecatedPropType:wU,isMuiElement:xU,ownerDocument:tD,ownerWindow:SU,requirePropFactory:EU,setRef:nD,unstable_ClassNameGenerator:q8,unstable_useEnhancedEffect:rD,unstable_useId:TU,unsupportedProp:NU,useControlled:kU,useEventCallback:IU,useForkRef:_U,useIsFocusVisible:FU},Symbol.toStringTag,{value:"Module"})),X8=jv(K8);var EN;function bt(){return EN||(EN=1,function(t){"use client";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=X8}(F0)),F0}var Y8=yt;Object.defineProperty(ES,"__esModule",{value:!0});var MS=ES.default=void 0,J8=Y8(bt()),Q8=R;MS=ES.default=(0,J8.default)((0,Q8.jsx)("path",{d:"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4"}),"PersonOutlineOutlined");const Z8=()=>{const[t,n]=W.useState(!1),e=W.useCallback(()=>{n(!0)},[]),r=W.useCallback(()=>{n(!1)},[]);return R.jsxs(R.Fragment,{children:[R.jsxs("div",{onClick:e,className:"NoneLogin_wrapper",children:[R.jsx(MS,{}),R.jsx("div",{className:"login-btn",children:"마이"})]}),t&&R.jsxs("div",{className:"NoneLogin_open",children:[R.jsxs("div",{className:"NoneLogin_header",children:[R.jsx("span",{children:"해당 기능을 이용하시려면"}),R.jsx("span",{children:"로그인이 필요합니다!"})]}),R.jsxs("div",{className:"NoneLogin_footer",children:[R.jsx(gU,{}),R.jsxs("div",{className:"NoneLogin_footer_btn",children:[R.jsx(Ho,{to:"/login",onClick:r,children:"로그인 하기"}),R.jsx("div",{children:"|"}),R.jsx("button",{onClick:r,children:"나중에 하기"})]})]})]})]})};var PS={},eH=yt;Object.defineProperty(PS,"__esModule",{value:!0});var TD=PS.default=void 0,tH=eH(bt()),nH=R;TD=PS.default=(0,tH.default)((0,nH.jsx)("path",{d:"m9.4 10.5 4.77-8.26C13.47 2.09 12.75 2 12 2c-2.4 0-4.6.85-6.32 2.25l3.66 6.35zM21.54 9c-.92-2.92-3.15-5.26-6-6.34L11.88 9zm.26 1h-7.49l.29.5 4.76 8.25C21 16.97 22 14.61 22 12c0-.69-.07-1.35-.2-2M8.54 12l-3.9-6.75C3.01 7.03 2 9.39 2 12c0 .69.07 1.35.2 2h7.49zm-6.08 3c.92 2.92 3.15 5.26 6 6.34L12.12 15zm11.27 0-3.9 6.76c.7.15 1.42.24 2.17.24 2.4 0 4.6-.85 6.32-2.25l-3.66-6.35z"}),"Camera");var LS={},rH=yt;Object.defineProperty(LS,"__esModule",{value:!0});var ND=LS.default=void 0,iH=rH(bt()),oH=R;ND=LS.default=(0,iH.default)((0,oH.jsx)("path",{d:"M19 5v2h-4V5zM9 5v6H5V5zm10 8v6h-4v-6zM9 17v2H5v-2zM21 3h-8v6h8zM11 3H3v10h8zm10 8h-8v10h8zm-10 4H3v6h8z"}),"DashboardOutlined");var FS={},aH=yt;Object.defineProperty(FS,"__esModule",{value:!0});var kD=FS.default=void 0,sH=aH(bt()),uH=R;kD=FS.default=(0,sH.default)((0,uH.jsx)("path",{d:"m12 5.69 5 4.5V18h-2v-6H9v6H7v-7.81zM12 3 2 12h3v8h6v-6h2v6h6v-8h3z"}),"HomeOutlined");var zS={},lH=yt;Object.defineProperty(zS,"__esModule",{value:!0});var ID=zS.default=void 0,cH=lH(bt()),CN=R;ID=zS.default=(0,cH.default)([(0,CN.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7M7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9"},"0"),(0,CN.jsx)("circle",{cx:"12",cy:"9",r:"2.5"},"1")],"LocationOnOutlined");const dH=()=>{const t=Er(),n=localStorage.getItem("jwt"),e=r=>{const i=r.target.files[0],o=new FileReader;o.readAsDataURL(i),o.onloadend=()=>[t("/fish/image/edit",{state:{value:o.result}})]};return R.jsx(R.Fragment,{children:R.jsxs("div",{className:"container",children:[R.jsx("div",{className:"Navbar_body",children:R.jsx(X5,{})}),R.jsxs("nav",{className:"nav",children:[R.jsxs(Dd,{to:"/",className:"nav-item",children:[R.jsx(kD,{}),R.jsx("span",{children:"홈"})]}),R.jsxs(Dd,{to:"/fish/map",className:"nav-item",children:[R.jsx(ID,{}),R.jsx("span",{children:"피싱맵"})]}),R.jsxs("div",{className:"nav-item hidden",children:[R.jsxs("svg",{className:"icon",stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[R.jsx("circle",{cx:"9",cy:"21",r:"1"}),R.jsx("circle",{cx:"20",cy:"21",r:"1"}),R.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),R.jsx("span",{children:"Home"})]}),R.jsx("div",{className:"nav-item btn",children:R.jsxs("label",{className:"custum-file-upload bg-blue",htmlFor:"file",children:[R.jsx(TD,{style:{width:"3rem",height:"3rem"}}),R.jsx("input",{type:"file",id:"file",accept:"image/*",onChange:e})]})}),R.jsxs(Dd,{to:"/media",className:"nav-item",children:[R.jsx(ND,{}),R.jsx("span",{children:"RoomList"})]}),n?R.jsxs(Dd,{to:"/user/mypage",className:"nav-item",children:[R.jsx(MS,{}),R.jsx("span",{children:"마이"})]}):R.jsx("div",{className:"nav-item",children:R.jsx(Z8,{})})]})]})})};function RN(t){return SS({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 160c16-63.16 76.43-95.41 208-96a15.94 15.94 0 0 1 16 16v288a16 16 0 0 1-16 16c-128 0-177.45 25.81-208 64-30.37-38-80-64-208-64-9.88 0-16-8.05-16-17.93V80a15.94 15.94 0 0 1 16-16c131.57.59 192 32.84 208 96zm0 0v288"},child:[]}]})(t)}const fH="/assets/Logo-WtStl40p.svg";function TN(t){return t!==null&&typeof t=="object"&&"constructor"in t&&t.constructor===Object}function BS(t,n){t===void 0&&(t={}),n===void 0&&(n={}),Object.keys(n).forEach(e=>{typeof t[e]>"u"?t[e]=n[e]:TN(n[e])&&TN(t[e])&&Object.keys(n[e]).length>0&&BS(t[e],n[e])})}const _D={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function Ec(){const t=typeof document<"u"?document:{};return BS(t,_D),t}const pH={document:_D,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(t){return typeof setTimeout>"u"?(t(),null):setTimeout(t,0)},cancelAnimationFrame(t){typeof setTimeout>"u"||clearTimeout(t)}};function ai(){const t=typeof window<"u"?window:{};return BS(t,pH),t}function hH(t){return t===void 0&&(t=""),t.trim().split(" ").filter(n=>!!n.trim())}function mH(t){const n=t;Object.keys(n).forEach(e=>{try{n[e]=null}catch{}try{delete n[e]}catch{}})}function ow(t,n){return n===void 0&&(n=0),setTimeout(t,n)}function ov(){return Date.now()}function vH(t){const n=ai();let e;return n.getComputedStyle&&(e=n.getComputedStyle(t,null)),!e&&t.currentStyle&&(e=t.currentStyle),e||(e=t.style),e}function gH(t,n){n===void 0&&(n="x");const e=ai();let r,i,o;const a=vH(t);return e.WebKitCSSMatrix?(i=a.transform||a.webkitTransform,i.split(",").length>6&&(i=i.split(", ").map(s=>s.replace(",",".")).join(", ")),o=new e.WebKitCSSMatrix(i==="none"?"":i)):(o=a.MozTransform||a.OTransform||a.MsTransform||a.msTransform||a.transform||a.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),r=o.toString().split(",")),n==="x"&&(e.WebKitCSSMatrix?i=o.m41:r.length===16?i=parseFloat(r[12]):i=parseFloat(r[4])),n==="y"&&(e.WebKitCSSMatrix?i=o.m42:r.length===16?i=parseFloat(r[13]):i=parseFloat(r[5])),i||0}function vh(t){return typeof t=="object"&&t!==null&&t.constructor&&Object.prototype.toString.call(t).slice(8,-1)==="Object"}function yH(t){return typeof window<"u"&&typeof window.HTMLElement<"u"?t instanceof HTMLElement:t&&(t.nodeType===1||t.nodeType===11)}function Ur(){const t=Object(arguments.length<=0?void 0:arguments[0]),n=["__proto__","constructor","prototype"];for(let e=1;e<arguments.length;e+=1){const r=e<0||arguments.length<=e?void 0:arguments[e];if(r!=null&&!yH(r)){const i=Object.keys(Object(r)).filter(o=>n.indexOf(o)<0);for(let o=0,a=i.length;o<a;o+=1){const s=i[o],u=Object.getOwnPropertyDescriptor(r,s);u!==void 0&&u.enumerable&&(vh(t[s])&&vh(r[s])?r[s].__swiper__?t[s]=r[s]:Ur(t[s],r[s]):!vh(t[s])&&vh(r[s])?(t[s]={},r[s].__swiper__?t[s]=r[s]:Ur(t[s],r[s])):t[s]=r[s])}}}return t}function gh(t,n,e){t.style.setProperty(n,e)}function AD(t){let{swiper:n,targetPosition:e,side:r}=t;const i=ai(),o=-n.translate;let a=null,s;const u=n.params.speed;n.wrapperEl.style.scrollSnapType="none",i.cancelAnimationFrame(n.cssModeFrameID);const l=e>o?"next":"prev",c=(f,p)=>l==="next"&&f>=p||l==="prev"&&f<=p,d=()=>{s=new Date().getTime(),a===null&&(a=s);const f=Math.max(Math.min((s-a)/u,1),0),p=.5-Math.cos(f*Math.PI)/2;let h=o+p*(e-o);if(c(h,e)&&(h=e),n.wrapperEl.scrollTo({[r]:h}),c(h,e)){n.wrapperEl.style.overflow="hidden",n.wrapperEl.style.scrollSnapType="",setTimeout(()=>{n.wrapperEl.style.overflow="",n.wrapperEl.scrollTo({[r]:h})}),i.cancelAnimationFrame(n.cssModeFrameID);return}n.cssModeFrameID=i.requestAnimationFrame(d)};d()}function jS(t){return t.querySelector(".swiper-slide-transform")||t.shadowRoot&&t.shadowRoot.querySelector(".swiper-slide-transform")||t}function Uo(t,n){return n===void 0&&(n=""),[...t.children].filter(e=>e.matches(n))}function av(t){try{console.warn(t);return}catch{}}function sv(t,n){n===void 0&&(n=[]);const e=document.createElement(t);return e.classList.add(...Array.isArray(n)?n:hH(n)),e}function bH(t,n){const e=[];for(;t.previousElementSibling;){const r=t.previousElementSibling;n?r.matches(n)&&e.push(r):e.push(r),t=r}return e}function wH(t,n){const e=[];for(;t.nextElementSibling;){const r=t.nextElementSibling;n?r.matches(n)&&e.push(r):e.push(r),t=r}return e}function Pa(t,n){return ai().getComputedStyle(t,null).getPropertyValue(n)}function NN(t){let n=t,e;if(n){for(e=0;(n=n.previousSibling)!==null;)n.nodeType===1&&(e+=1);return e}}function xH(t,n){const e=[];let r=t.parentElement;for(;r;)n?r.matches(n)&&e.push(r):e.push(r),r=r.parentElement;return e}function kN(t,n,e){const r=ai();return e?t[n==="width"?"offsetWidth":"offsetHeight"]+parseFloat(r.getComputedStyle(t,null).getPropertyValue(n==="width"?"margin-right":"margin-top"))+parseFloat(r.getComputedStyle(t,null).getPropertyValue(n==="width"?"margin-left":"margin-bottom")):t.offsetWidth}let V0;function SH(){const t=ai(),n=Ec();return{smoothScroll:n.documentElement&&n.documentElement.style&&"scrollBehavior"in n.documentElement.style,touch:!!("ontouchstart"in t||t.DocumentTouch&&n instanceof t.DocumentTouch)}}function OD(){return V0||(V0=SH()),V0}let $0;function EH(t){let{userAgent:n}=t===void 0?{}:t;const e=OD(),r=ai(),i=r.navigator.platform,o=n||r.navigator.userAgent,a={ios:!1,android:!1},s=r.screen.width,u=r.screen.height,l=o.match(/(Android);?[\s\/]+([\d.]+)?/);let c=o.match(/(iPad).*OS\s([\d_]+)/);const d=o.match(/(iPod)(.*OS\s([\d_]+))?/),f=!c&&o.match(/(iPhone\sOS|iOS)\s([\d_]+)/),p=i==="Win32";let h=i==="MacIntel";const v=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!c&&h&&e.touch&&v.indexOf(`${s}x${u}`)>=0&&(c=o.match(/(Version)\/([\d.]+)/),c||(c=[0,1,"13_0_0"]),h=!1),l&&!p&&(a.os="android",a.android=!0),(c||f||d)&&(a.os="ios",a.ios=!0),a}function CH(t){return t===void 0&&(t={}),$0||($0=EH(t)),$0}let U0;function RH(){const t=ai();let n=!1;function e(){const r=t.navigator.userAgent.toLowerCase();return r.indexOf("safari")>=0&&r.indexOf("chrome")<0&&r.indexOf("android")<0}if(e()){const r=String(t.navigator.userAgent);if(r.includes("Version/")){const[i,o]=r.split("Version/")[1].split(" ")[0].split(".").map(a=>Number(a));n=i<16||i===16&&o<2}}return{isSafari:n||e(),needPerspectiveFix:n,isWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(t.navigator.userAgent)}}function TH(){return U0||(U0=RH()),U0}function NH(t){let{swiper:n,on:e,emit:r}=t;const i=ai();let o=null,a=null;const s=()=>{!n||n.destroyed||!n.initialized||(r("beforeResize"),r("resize"))},u=()=>{!n||n.destroyed||!n.initialized||(o=new ResizeObserver(d=>{a=i.requestAnimationFrame(()=>{const{width:f,height:p}=n;let h=f,v=p;d.forEach(g=>{let{contentBoxSize:m,contentRect:y,target:b}=g;b&&b!==n.el||(h=y?y.width:(m[0]||m).inlineSize,v=y?y.height:(m[0]||m).blockSize)}),(h!==f||v!==p)&&s()})}),o.observe(n.el))},l=()=>{a&&i.cancelAnimationFrame(a),o&&o.unobserve&&n.el&&(o.unobserve(n.el),o=null)},c=()=>{!n||n.destroyed||!n.initialized||r("orientationchange")};e("init",()=>{if(n.params.resizeObserver&&typeof i.ResizeObserver<"u"){u();return}i.addEventListener("resize",s),i.addEventListener("orientationchange",c)}),e("destroy",()=>{l(),i.removeEventListener("resize",s),i.removeEventListener("orientationchange",c)})}function kH(t){let{swiper:n,extendParams:e,on:r,emit:i}=t;const o=[],a=ai(),s=function(c,d){d===void 0&&(d={});const f=a.MutationObserver||a.WebkitMutationObserver,p=new f(h=>{if(n.__preventObserver__)return;if(h.length===1){i("observerUpdate",h[0]);return}const v=function(){i("observerUpdate",h[0])};a.requestAnimationFrame?a.requestAnimationFrame(v):a.setTimeout(v,0)});p.observe(c,{attributes:typeof d.attributes>"u"?!0:d.attributes,childList:typeof d.childList>"u"?!0:d.childList,characterData:typeof d.characterData>"u"?!0:d.characterData}),o.push(p)},u=()=>{if(n.params.observer){if(n.params.observeParents){const c=xH(n.hostEl);for(let d=0;d<c.length;d+=1)s(c[d])}s(n.hostEl,{childList:n.params.observeSlideChildren}),s(n.wrapperEl,{attributes:!1})}},l=()=>{o.forEach(c=>{c.disconnect()}),o.splice(0,o.length)};e({observer:!1,observeParents:!1,observeSlideChildren:!1}),r("init",u),r("destroy",l)}var IH={on(t,n,e){const r=this;if(!r.eventsListeners||r.destroyed||typeof n!="function")return r;const i=e?"unshift":"push";return t.split(" ").forEach(o=>{r.eventsListeners[o]||(r.eventsListeners[o]=[]),r.eventsListeners[o][i](n)}),r},once(t,n,e){const r=this;if(!r.eventsListeners||r.destroyed||typeof n!="function")return r;function i(){r.off(t,i),i.__emitterProxy&&delete i.__emitterProxy;for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];n.apply(r,a)}return i.__emitterProxy=n,r.on(t,i,e)},onAny(t,n){const e=this;if(!e.eventsListeners||e.destroyed||typeof t!="function")return e;const r=n?"unshift":"push";return e.eventsAnyListeners.indexOf(t)<0&&e.eventsAnyListeners[r](t),e},offAny(t){const n=this;if(!n.eventsListeners||n.destroyed||!n.eventsAnyListeners)return n;const e=n.eventsAnyListeners.indexOf(t);return e>=0&&n.eventsAnyListeners.splice(e,1),n},off(t,n){const e=this;return!e.eventsListeners||e.destroyed||!e.eventsListeners||t.split(" ").forEach(r=>{typeof n>"u"?e.eventsListeners[r]=[]:e.eventsListeners[r]&&e.eventsListeners[r].forEach((i,o)=>{(i===n||i.__emitterProxy&&i.__emitterProxy===n)&&e.eventsListeners[r].splice(o,1)})}),e},emit(){const t=this;if(!t.eventsListeners||t.destroyed||!t.eventsListeners)return t;let n,e,r;for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return typeof o[0]=="string"||Array.isArray(o[0])?(n=o[0],e=o.slice(1,o.length),r=t):(n=o[0].events,e=o[0].data,r=o[0].context||t),e.unshift(r),(Array.isArray(n)?n:n.split(" ")).forEach(u=>{t.eventsAnyListeners&&t.eventsAnyListeners.length&&t.eventsAnyListeners.forEach(l=>{l.apply(r,[u,...e])}),t.eventsListeners&&t.eventsListeners[u]&&t.eventsListeners[u].forEach(l=>{l.apply(r,e)})}),t}};function _H(){const t=this;let n,e;const r=t.el;typeof t.params.width<"u"&&t.params.width!==null?n=t.params.width:n=r.clientWidth,typeof t.params.height<"u"&&t.params.height!==null?e=t.params.height:e=r.clientHeight,!(n===0&&t.isHorizontal()||e===0&&t.isVertical())&&(n=n-parseInt(Pa(r,"padding-left")||0,10)-parseInt(Pa(r,"padding-right")||0,10),e=e-parseInt(Pa(r,"padding-top")||0,10)-parseInt(Pa(r,"padding-bottom")||0,10),Number.isNaN(n)&&(n=0),Number.isNaN(e)&&(e=0),Object.assign(t,{width:n,height:e,size:t.isHorizontal()?n:e}))}function AH(){const t=this;function n(N,M){return parseFloat(N.getPropertyValue(t.getDirectionLabel(M))||0)}const e=t.params,{wrapperEl:r,slidesEl:i,size:o,rtlTranslate:a,wrongRTL:s}=t,u=t.virtual&&e.virtual.enabled,l=u?t.virtual.slides.length:t.slides.length,c=Uo(i,`.${t.params.slideClass}, swiper-slide`),d=u?t.virtual.slides.length:c.length;let f=[];const p=[],h=[];let v=e.slidesOffsetBefore;typeof v=="function"&&(v=e.slidesOffsetBefore.call(t));let g=e.slidesOffsetAfter;typeof g=="function"&&(g=e.slidesOffsetAfter.call(t));const m=t.snapGrid.length,y=t.slidesGrid.length;let b=e.spaceBetween,w=-v,x=0,C=0;if(typeof o>"u")return;typeof b=="string"&&b.indexOf("%")>=0?b=parseFloat(b.replace("%",""))/100*o:typeof b=="string"&&(b=parseFloat(b)),t.virtualSize=-b,c.forEach(N=>{a?N.style.marginLeft="":N.style.marginRight="",N.style.marginBottom="",N.style.marginTop=""}),e.centeredSlides&&e.cssMode&&(gh(r,"--swiper-centered-offset-before",""),gh(r,"--swiper-centered-offset-after",""));const E=e.grid&&e.grid.rows>1&&t.grid;E?t.grid.initSlides(c):t.grid&&t.grid.unsetSlides();let S;const k=e.slidesPerView==="auto"&&e.breakpoints&&Object.keys(e.breakpoints).filter(N=>typeof e.breakpoints[N].slidesPerView<"u").length>0;for(let N=0;N<d;N+=1){S=0;let M;if(c[N]&&(M=c[N]),E&&t.grid.updateSlide(N,M,c),!(c[N]&&Pa(M,"display")==="none")){if(e.slidesPerView==="auto"){k&&(c[N].style[t.getDirectionLabel("width")]="");const D=getComputedStyle(M),T=M.style.transform,O=M.style.webkitTransform;if(T&&(M.style.transform="none"),O&&(M.style.webkitTransform="none"),e.roundLengths)S=t.isHorizontal()?kN(M,"width",!0):kN(M,"height",!0);else{const P=n(D,"width"),A=n(D,"padding-left"),I=n(D,"padding-right"),_=n(D,"margin-left"),F=n(D,"margin-right"),L=D.getPropertyValue("box-sizing");if(L&&L==="border-box")S=P+_+F;else{const{clientWidth:H,offsetWidth:B}=M;S=P+A+I+_+F+(B-H)}}T&&(M.style.transform=T),O&&(M.style.webkitTransform=O),e.roundLengths&&(S=Math.floor(S))}else S=(o-(e.slidesPerView-1)*b)/e.slidesPerView,e.roundLengths&&(S=Math.floor(S)),c[N]&&(c[N].style[t.getDirectionLabel("width")]=`${S}px`);c[N]&&(c[N].swiperSlideSize=S),h.push(S),e.centeredSlides?(w=w+S/2+x/2+b,x===0&&N!==0&&(w=w-o/2-b),N===0&&(w=w-o/2-b),Math.abs(w)<1/1e3&&(w=0),e.roundLengths&&(w=Math.floor(w)),C%e.slidesPerGroup===0&&f.push(w),p.push(w)):(e.roundLengths&&(w=Math.floor(w)),(C-Math.min(t.params.slidesPerGroupSkip,C))%t.params.slidesPerGroup===0&&f.push(w),p.push(w),w=w+S+b),t.virtualSize+=S+b,x=S,C+=1}}if(t.virtualSize=Math.max(t.virtualSize,o)+g,a&&s&&(e.effect==="slide"||e.effect==="coverflow")&&(r.style.width=`${t.virtualSize+b}px`),e.setWrapperSize&&(r.style[t.getDirectionLabel("width")]=`${t.virtualSize+b}px`),E&&t.grid.updateWrapperSize(S,f),!e.centeredSlides){const N=[];for(let M=0;M<f.length;M+=1){let D=f[M];e.roundLengths&&(D=Math.floor(D)),f[M]<=t.virtualSize-o&&N.push(D)}f=N,Math.floor(t.virtualSize-o)-Math.floor(f[f.length-1])>1&&f.push(t.virtualSize-o)}if(u&&e.loop){const N=h[0]+b;if(e.slidesPerGroup>1){const M=Math.ceil((t.virtual.slidesBefore+t.virtual.slidesAfter)/e.slidesPerGroup),D=N*e.slidesPerGroup;for(let T=0;T<M;T+=1)f.push(f[f.length-1]+D)}for(let M=0;M<t.virtual.slidesBefore+t.virtual.slidesAfter;M+=1)e.slidesPerGroup===1&&f.push(f[f.length-1]+N),p.push(p[p.length-1]+N),t.virtualSize+=N}if(f.length===0&&(f=[0]),b!==0){const N=t.isHorizontal()&&a?"marginLeft":t.getDirectionLabel("marginRight");c.filter((M,D)=>!e.cssMode||e.loop?!0:D!==c.length-1).forEach(M=>{M.style[N]=`${b}px`})}if(e.centeredSlides&&e.centeredSlidesBounds){let N=0;h.forEach(D=>{N+=D+(b||0)}),N-=b;const M=N-o;f=f.map(D=>D<=0?-v:D>M?M+g:D)}if(e.centerInsufficientSlides){let N=0;if(h.forEach(M=>{N+=M+(b||0)}),N-=b,N<o){const M=(o-N)/2;f.forEach((D,T)=>{f[T]=D-M}),p.forEach((D,T)=>{p[T]=D+M})}}if(Object.assign(t,{slides:c,snapGrid:f,slidesGrid:p,slidesSizesGrid:h}),e.centeredSlides&&e.cssMode&&!e.centeredSlidesBounds){gh(r,"--swiper-centered-offset-before",`${-f[0]}px`),gh(r,"--swiper-centered-offset-after",`${t.size/2-h[h.length-1]/2}px`);const N=-t.snapGrid[0],M=-t.slidesGrid[0];t.snapGrid=t.snapGrid.map(D=>D+N),t.slidesGrid=t.slidesGrid.map(D=>D+M)}if(d!==l&&t.emit("slidesLengthChange"),f.length!==m&&(t.params.watchOverflow&&t.checkOverflow(),t.emit("snapGridLengthChange")),p.length!==y&&t.emit("slidesGridLengthChange"),e.watchSlidesProgress&&t.updateSlidesOffset(),t.emit("slidesUpdated"),!u&&!e.cssMode&&(e.effect==="slide"||e.effect==="fade")){const N=`${e.containerModifierClass}backface-hidden`,M=t.el.classList.contains(N);d<=e.maxBackfaceHiddenSlides?M||t.el.classList.add(N):M&&t.el.classList.remove(N)}}function OH(t){const n=this,e=[],r=n.virtual&&n.params.virtual.enabled;let i=0,o;typeof t=="number"?n.setTransition(t):t===!0&&n.setTransition(n.params.speed);const a=s=>r?n.slides[n.getSlideIndexByData(s)]:n.slides[s];if(n.params.slidesPerView!=="auto"&&n.params.slidesPerView>1)if(n.params.centeredSlides)(n.visibleSlides||[]).forEach(s=>{e.push(s)});else for(o=0;o<Math.ceil(n.params.slidesPerView);o+=1){const s=n.activeIndex+o;if(s>n.slides.length&&!r)break;e.push(a(s))}else e.push(a(n.activeIndex));for(o=0;o<e.length;o+=1)if(typeof e[o]<"u"){const s=e[o].offsetHeight;i=s>i?s:i}(i||i===0)&&(n.wrapperEl.style.height=`${i}px`)}function DH(){const t=this,n=t.slides,e=t.isElement?t.isHorizontal()?t.wrapperEl.offsetLeft:t.wrapperEl.offsetTop:0;for(let r=0;r<n.length;r+=1)n[r].swiperSlideOffset=(t.isHorizontal()?n[r].offsetLeft:n[r].offsetTop)-e-t.cssOverflowAdjustment()}function MH(t){t===void 0&&(t=this&&this.translate||0);const n=this,e=n.params,{slides:r,rtlTranslate:i,snapGrid:o}=n;if(r.length===0)return;typeof r[0].swiperSlideOffset>"u"&&n.updateSlidesOffset();let a=-t;i&&(a=t),r.forEach(u=>{u.classList.remove(e.slideVisibleClass,e.slideFullyVisibleClass)}),n.visibleSlidesIndexes=[],n.visibleSlides=[];let s=e.spaceBetween;typeof s=="string"&&s.indexOf("%")>=0?s=parseFloat(s.replace("%",""))/100*n.size:typeof s=="string"&&(s=parseFloat(s));for(let u=0;u<r.length;u+=1){const l=r[u];let c=l.swiperSlideOffset;e.cssMode&&e.centeredSlides&&(c-=r[0].swiperSlideOffset);const d=(a+(e.centeredSlides?n.minTranslate():0)-c)/(l.swiperSlideSize+s),f=(a-o[0]+(e.centeredSlides?n.minTranslate():0)-c)/(l.swiperSlideSize+s),p=-(a-c),h=p+n.slidesSizesGrid[u],v=p>=0&&p<=n.size-n.slidesSizesGrid[u];(p>=0&&p<n.size-1||h>1&&h<=n.size||p<=0&&h>=n.size)&&(n.visibleSlides.push(l),n.visibleSlidesIndexes.push(u),r[u].classList.add(e.slideVisibleClass)),v&&r[u].classList.add(e.slideFullyVisibleClass),l.progress=i?-d:d,l.originalProgress=i?-f:f}}function PH(t){const n=this;if(typeof t>"u"){const c=n.rtlTranslate?-1:1;t=n&&n.translate&&n.translate*c||0}const e=n.params,r=n.maxTranslate()-n.minTranslate();let{progress:i,isBeginning:o,isEnd:a,progressLoop:s}=n;const u=o,l=a;if(r===0)i=0,o=!0,a=!0;else{i=(t-n.minTranslate())/r;const c=Math.abs(t-n.minTranslate())<1,d=Math.abs(t-n.maxTranslate())<1;o=c||i<=0,a=d||i>=1,c&&(i=0),d&&(i=1)}if(e.loop){const c=n.getSlideIndexByData(0),d=n.getSlideIndexByData(n.slides.length-1),f=n.slidesGrid[c],p=n.slidesGrid[d],h=n.slidesGrid[n.slidesGrid.length-1],v=Math.abs(t);v>=f?s=(v-f)/h:s=(v+h-p)/h,s>1&&(s-=1)}Object.assign(n,{progress:i,progressLoop:s,isBeginning:o,isEnd:a}),(e.watchSlidesProgress||e.centeredSlides&&e.autoHeight)&&n.updateSlidesProgress(t),o&&!u&&n.emit("reachBeginning toEdge"),a&&!l&&n.emit("reachEnd toEdge"),(u&&!o||l&&!a)&&n.emit("fromEdge"),n.emit("progress",i)}function LH(){const t=this,{slides:n,params:e,slidesEl:r,activeIndex:i}=t,o=t.virtual&&e.virtual.enabled,a=t.grid&&e.grid&&e.grid.rows>1,s=d=>Uo(r,`.${e.slideClass}${d}, swiper-slide${d}`)[0];n.forEach(d=>{d.classList.remove(e.slideActiveClass,e.slideNextClass,e.slidePrevClass)});let u,l,c;if(o)if(e.loop){let d=i-t.virtual.slidesBefore;d<0&&(d=t.virtual.slides.length+d),d>=t.virtual.slides.length&&(d-=t.virtual.slides.length),u=s(`[data-swiper-slide-index="${d}"]`)}else u=s(`[data-swiper-slide-index="${i}"]`);else a?(u=n.filter(d=>d.column===i)[0],c=n.filter(d=>d.column===i+1)[0],l=n.filter(d=>d.column===i-1)[0]):u=n[i];u&&(u.classList.add(e.slideActiveClass),a?(c&&c.classList.add(e.slideNextClass),l&&l.classList.add(e.slidePrevClass)):(c=wH(u,`.${e.slideClass}, swiper-slide`)[0],e.loop&&!c&&(c=n[0]),c&&c.classList.add(e.slideNextClass),l=bH(u,`.${e.slideClass}, swiper-slide`)[0],e.loop&&!l===0&&(l=n[n.length-1]),l&&l.classList.add(e.slidePrevClass))),t.emitSlidesClasses()}const lm=(t,n)=>{if(!t||t.destroyed||!t.params)return;const e=()=>t.isElement?"swiper-slide":`.${t.params.slideClass}`,r=n.closest(e());if(r){let i=r.querySelector(`.${t.params.lazyPreloaderClass}`);!i&&t.isElement&&(r.shadowRoot?i=r.shadowRoot.querySelector(`.${t.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{r.shadowRoot&&(i=r.shadowRoot.querySelector(`.${t.params.lazyPreloaderClass}`),i&&i.remove())})),i&&i.remove()}},W0=(t,n)=>{if(!t.slides[n])return;const e=t.slides[n].querySelector('[loading="lazy"]');e&&e.removeAttribute("loading")},aw=t=>{if(!t||t.destroyed||!t.params)return;let n=t.params.lazyPreloadPrevNext;const e=t.slides.length;if(!e||!n||n<0)return;n=Math.min(n,e);const r=t.params.slidesPerView==="auto"?t.slidesPerViewDynamic():Math.ceil(t.params.slidesPerView),i=t.activeIndex;if(t.params.grid&&t.params.grid.rows>1){const a=i,s=[a-n];s.push(...Array.from({length:n}).map((u,l)=>a+r+l)),t.slides.forEach((u,l)=>{s.includes(u.column)&&W0(t,l)});return}const o=i+r-1;if(t.params.rewind||t.params.loop)for(let a=i-n;a<=o+n;a+=1){const s=(a%e+e)%e;(s<i||s>o)&&W0(t,s)}else for(let a=Math.max(i-n,0);a<=Math.min(o+n,e-1);a+=1)a!==i&&(a>o||a<i)&&W0(t,a)};function FH(t){const{slidesGrid:n,params:e}=t,r=t.rtlTranslate?t.translate:-t.translate;let i;for(let o=0;o<n.length;o+=1)typeof n[o+1]<"u"?r>=n[o]&&r<n[o+1]-(n[o+1]-n[o])/2?i=o:r>=n[o]&&r<n[o+1]&&(i=o+1):r>=n[o]&&(i=o);return e.normalizeSlideIndex&&(i<0||typeof i>"u")&&(i=0),i}function zH(t){const n=this,e=n.rtlTranslate?n.translate:-n.translate,{snapGrid:r,params:i,activeIndex:o,realIndex:a,snapIndex:s}=n;let u=t,l;const c=p=>{let h=p-n.virtual.slidesBefore;return h<0&&(h=n.virtual.slides.length+h),h>=n.virtual.slides.length&&(h-=n.virtual.slides.length),h};if(typeof u>"u"&&(u=FH(n)),r.indexOf(e)>=0)l=r.indexOf(e);else{const p=Math.min(i.slidesPerGroupSkip,u);l=p+Math.floor((u-p)/i.slidesPerGroup)}if(l>=r.length&&(l=r.length-1),u===o&&!n.params.loop){l!==s&&(n.snapIndex=l,n.emit("snapIndexChange"));return}if(u===o&&n.params.loop&&n.virtual&&n.params.virtual.enabled){n.realIndex=c(u);return}const d=n.grid&&i.grid&&i.grid.rows>1;let f;if(n.virtual&&i.virtual.enabled&&i.loop)f=c(u);else if(d){const p=n.slides.filter(v=>v.column===u)[0];let h=parseInt(p.getAttribute("data-swiper-slide-index"),10);Number.isNaN(h)&&(h=Math.max(n.slides.indexOf(p),0)),f=Math.floor(h/i.grid.rows)}else if(n.slides[u]){const p=n.slides[u].getAttribute("data-swiper-slide-index");p?f=parseInt(p,10):f=u}else f=u;Object.assign(n,{previousSnapIndex:s,snapIndex:l,previousRealIndex:a,realIndex:f,previousIndex:o,activeIndex:u}),n.initialized&&aw(n),n.emit("activeIndexChange"),n.emit("snapIndexChange"),(n.initialized||n.params.runCallbacksOnInit)&&(a!==f&&n.emit("realIndexChange"),n.emit("slideChange"))}function BH(t,n){const e=this,r=e.params;let i=t.closest(`.${r.slideClass}, swiper-slide`);!i&&e.isElement&&n&&n.length>1&&n.includes(t)&&[...n.slice(n.indexOf(t)+1,n.length)].forEach(s=>{!i&&s.matches&&s.matches(`.${r.slideClass}, swiper-slide`)&&(i=s)});let o=!1,a;if(i){for(let s=0;s<e.slides.length;s+=1)if(e.slides[s]===i){o=!0,a=s;break}}if(i&&o)e.clickedSlide=i,e.virtual&&e.params.virtual.enabled?e.clickedIndex=parseInt(i.getAttribute("data-swiper-slide-index"),10):e.clickedIndex=a;else{e.clickedSlide=void 0,e.clickedIndex=void 0;return}r.slideToClickedSlide&&e.clickedIndex!==void 0&&e.clickedIndex!==e.activeIndex&&e.slideToClickedSlide()}var jH={updateSize:_H,updateSlides:AH,updateAutoHeight:OH,updateSlidesOffset:DH,updateSlidesProgress:MH,updateProgress:PH,updateSlidesClasses:LH,updateActiveIndex:zH,updateClickedSlide:BH};function VH(t){t===void 0&&(t=this.isHorizontal()?"x":"y");const n=this,{params:e,rtlTranslate:r,translate:i,wrapperEl:o}=n;if(e.virtualTranslate)return r?-i:i;if(e.cssMode)return i;let a=gH(o,t);return a+=n.cssOverflowAdjustment(),r&&(a=-a),a||0}function $H(t,n){const e=this,{rtlTranslate:r,params:i,wrapperEl:o,progress:a}=e;let s=0,u=0;const l=0;e.isHorizontal()?s=r?-t:t:u=t,i.roundLengths&&(s=Math.floor(s),u=Math.floor(u)),e.previousTranslate=e.translate,e.translate=e.isHorizontal()?s:u,i.cssMode?o[e.isHorizontal()?"scrollLeft":"scrollTop"]=e.isHorizontal()?-s:-u:i.virtualTranslate||(e.isHorizontal()?s-=e.cssOverflowAdjustment():u-=e.cssOverflowAdjustment(),o.style.transform=`translate3d(${s}px, ${u}px, ${l}px)`);let c;const d=e.maxTranslate()-e.minTranslate();d===0?c=0:c=(t-e.minTranslate())/d,c!==a&&e.updateProgress(t),e.emit("setTranslate",e.translate,n)}function UH(){return-this.snapGrid[0]}function WH(){return-this.snapGrid[this.snapGrid.length-1]}function HH(t,n,e,r,i){t===void 0&&(t=0),n===void 0&&(n=this.params.speed),e===void 0&&(e=!0),r===void 0&&(r=!0);const o=this,{params:a,wrapperEl:s}=o;if(o.animating&&a.preventInteractionOnTransition)return!1;const u=o.minTranslate(),l=o.maxTranslate();let c;if(r&&t>u?c=u:r&&t<l?c=l:c=t,o.updateProgress(c),a.cssMode){const d=o.isHorizontal();if(n===0)s[d?"scrollLeft":"scrollTop"]=-c;else{if(!o.support.smoothScroll)return AD({swiper:o,targetPosition:-c,side:d?"left":"top"}),!0;s.scrollTo({[d?"left":"top"]:-c,behavior:"smooth"})}return!0}return n===0?(o.setTransition(0),o.setTranslate(c),e&&(o.emit("beforeTransitionStart",n,i),o.emit("transitionEnd"))):(o.setTransition(n),o.setTranslate(c),e&&(o.emit("beforeTransitionStart",n,i),o.emit("transitionStart")),o.animating||(o.animating=!0,o.onTranslateToWrapperTransitionEnd||(o.onTranslateToWrapperTransitionEnd=function(f){!o||o.destroyed||f.target===this&&(o.wrapperEl.removeEventListener("transitionend",o.onTranslateToWrapperTransitionEnd),o.onTranslateToWrapperTransitionEnd=null,delete o.onTranslateToWrapperTransitionEnd,e&&o.emit("transitionEnd"))}),o.wrapperEl.addEventListener("transitionend",o.onTranslateToWrapperTransitionEnd))),!0}var GH={getTranslate:VH,setTranslate:$H,minTranslate:UH,maxTranslate:WH,translateTo:HH};function qH(t,n){const e=this;e.params.cssMode||(e.wrapperEl.style.transitionDuration=`${t}ms`,e.wrapperEl.style.transitionDelay=t===0?"0ms":""),e.emit("setTransition",t,n)}function DD(t){let{swiper:n,runCallbacks:e,direction:r,step:i}=t;const{activeIndex:o,previousIndex:a}=n;let s=r;if(s||(o>a?s="next":o<a?s="prev":s="reset"),n.emit(`transition${i}`),e&&o!==a){if(s==="reset"){n.emit(`slideResetTransition${i}`);return}n.emit(`slideChangeTransition${i}`),s==="next"?n.emit(`slideNextTransition${i}`):n.emit(`slidePrevTransition${i}`)}}function KH(t,n){t===void 0&&(t=!0);const e=this,{params:r}=e;r.cssMode||(r.autoHeight&&e.updateAutoHeight(),DD({swiper:e,runCallbacks:t,direction:n,step:"Start"}))}function XH(t,n){t===void 0&&(t=!0);const e=this,{params:r}=e;e.animating=!1,!r.cssMode&&(e.setTransition(0),DD({swiper:e,runCallbacks:t,direction:n,step:"End"}))}var YH={setTransition:qH,transitionStart:KH,transitionEnd:XH};function JH(t,n,e,r,i){t===void 0&&(t=0),n===void 0&&(n=this.params.speed),e===void 0&&(e=!0),typeof t=="string"&&(t=parseInt(t,10));const o=this;let a=t;a<0&&(a=0);const{params:s,snapGrid:u,slidesGrid:l,previousIndex:c,activeIndex:d,rtlTranslate:f,wrapperEl:p,enabled:h}=o;if(o.animating&&s.preventInteractionOnTransition||!h&&!r&&!i)return!1;const v=Math.min(o.params.slidesPerGroupSkip,a);let g=v+Math.floor((a-v)/o.params.slidesPerGroup);g>=u.length&&(g=u.length-1);const m=-u[g];if(s.normalizeSlideIndex)for(let b=0;b<l.length;b+=1){const w=-Math.floor(m*100),x=Math.floor(l[b]*100),C=Math.floor(l[b+1]*100);typeof l[b+1]<"u"?w>=x&&w<C-(C-x)/2?a=b:w>=x&&w<C&&(a=b+1):w>=x&&(a=b)}if(o.initialized&&a!==d&&(!o.allowSlideNext&&(f?m>o.translate&&m>o.minTranslate():m<o.translate&&m<o.minTranslate())||!o.allowSlidePrev&&m>o.translate&&m>o.maxTranslate()&&(d||0)!==a))return!1;a!==(c||0)&&e&&o.emit("beforeSlideChangeStart"),o.updateProgress(m);let y;if(a>d?y="next":a<d?y="prev":y="reset",f&&-m===o.translate||!f&&m===o.translate)return o.updateActiveIndex(a),s.autoHeight&&o.updateAutoHeight(),o.updateSlidesClasses(),s.effect!=="slide"&&o.setTranslate(m),y!=="reset"&&(o.transitionStart(e,y),o.transitionEnd(e,y)),!1;if(s.cssMode){const b=o.isHorizontal(),w=f?m:-m;if(n===0){const x=o.virtual&&o.params.virtual.enabled;x&&(o.wrapperEl.style.scrollSnapType="none",o._immediateVirtual=!0),x&&!o._cssModeVirtualInitialSet&&o.params.initialSlide>0?(o._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{p[b?"scrollLeft":"scrollTop"]=w})):p[b?"scrollLeft":"scrollTop"]=w,x&&requestAnimationFrame(()=>{o.wrapperEl.style.scrollSnapType="",o._immediateVirtual=!1})}else{if(!o.support.smoothScroll)return AD({swiper:o,targetPosition:w,side:b?"left":"top"}),!0;p.scrollTo({[b?"left":"top"]:w,behavior:"smooth"})}return!0}return o.setTransition(n),o.setTranslate(m),o.updateActiveIndex(a),o.updateSlidesClasses(),o.emit("beforeTransitionStart",n,r),o.transitionStart(e,y),n===0?o.transitionEnd(e,y):o.animating||(o.animating=!0,o.onSlideToWrapperTransitionEnd||(o.onSlideToWrapperTransitionEnd=function(w){!o||o.destroyed||w.target===this&&(o.wrapperEl.removeEventListener("transitionend",o.onSlideToWrapperTransitionEnd),o.onSlideToWrapperTransitionEnd=null,delete o.onSlideToWrapperTransitionEnd,o.transitionEnd(e,y))}),o.wrapperEl.addEventListener("transitionend",o.onSlideToWrapperTransitionEnd)),!0}function QH(t,n,e,r){t===void 0&&(t=0),n===void 0&&(n=this.params.speed),e===void 0&&(e=!0),typeof t=="string"&&(t=parseInt(t,10));const i=this,o=i.grid&&i.params.grid&&i.params.grid.rows>1;let a=t;if(i.params.loop)if(i.virtual&&i.params.virtual.enabled)a=a+i.virtual.slidesBefore;else{let s;if(o){const f=a*i.params.grid.rows;s=i.slides.filter(p=>p.getAttribute("data-swiper-slide-index")*1===f)[0].column}else s=i.getSlideIndexByData(a);const u=o?Math.ceil(i.slides.length/i.params.grid.rows):i.slides.length,{centeredSlides:l}=i.params;let c=i.params.slidesPerView;c==="auto"?c=i.slidesPerViewDynamic():(c=Math.ceil(parseFloat(i.params.slidesPerView,10)),l&&c%2===0&&(c=c+1));let d=u-s<c;if(l&&(d=d||s<Math.ceil(c/2)),d){const f=l?s<i.activeIndex?"prev":"next":s-i.activeIndex-1<i.params.slidesPerView?"next":"prev";i.loopFix({direction:f,slideTo:!0,activeSlideIndex:f==="next"?s+1:s-u+1,slideRealIndex:f==="next"?i.realIndex:void 0})}if(o){const f=a*i.params.grid.rows;a=i.slides.filter(p=>p.getAttribute("data-swiper-slide-index")*1===f)[0].column}else a=i.getSlideIndexByData(a)}return requestAnimationFrame(()=>{i.slideTo(a,n,e,r)}),i}function ZH(t,n,e){t===void 0&&(t=this.params.speed),n===void 0&&(n=!0);const r=this,{enabled:i,params:o,animating:a}=r;if(!i)return r;let s=o.slidesPerGroup;o.slidesPerView==="auto"&&o.slidesPerGroup===1&&o.slidesPerGroupAuto&&(s=Math.max(r.slidesPerViewDynamic("current",!0),1));const u=r.activeIndex<o.slidesPerGroupSkip?1:s,l=r.virtual&&o.virtual.enabled;if(o.loop){if(a&&!l&&o.loopPreventsSliding)return!1;if(r.loopFix({direction:"next"}),r._clientLeft=r.wrapperEl.clientLeft,r.activeIndex===r.slides.length-1&&o.cssMode)return requestAnimationFrame(()=>{r.slideTo(r.activeIndex+u,t,n,e)}),!0}return o.rewind&&r.isEnd?r.slideTo(0,t,n,e):r.slideTo(r.activeIndex+u,t,n,e)}function e9(t,n,e){t===void 0&&(t=this.params.speed),n===void 0&&(n=!0);const r=this,{params:i,snapGrid:o,slidesGrid:a,rtlTranslate:s,enabled:u,animating:l}=r;if(!u)return r;const c=r.virtual&&i.virtual.enabled;if(i.loop){if(l&&!c&&i.loopPreventsSliding)return!1;r.loopFix({direction:"prev"}),r._clientLeft=r.wrapperEl.clientLeft}const d=s?r.translate:-r.translate;function f(m){return m<0?-Math.floor(Math.abs(m)):Math.floor(m)}const p=f(d),h=o.map(m=>f(m));let v=o[h.indexOf(p)-1];if(typeof v>"u"&&i.cssMode){let m;o.forEach((y,b)=>{p>=y&&(m=b)}),typeof m<"u"&&(v=o[m>0?m-1:m])}let g=0;if(typeof v<"u"&&(g=a.indexOf(v),g<0&&(g=r.activeIndex-1),i.slidesPerView==="auto"&&i.slidesPerGroup===1&&i.slidesPerGroupAuto&&(g=g-r.slidesPerViewDynamic("previous",!0)+1,g=Math.max(g,0))),i.rewind&&r.isBeginning){const m=r.params.virtual&&r.params.virtual.enabled&&r.virtual?r.virtual.slides.length-1:r.slides.length-1;return r.slideTo(m,t,n,e)}else if(i.loop&&r.activeIndex===0&&i.cssMode)return requestAnimationFrame(()=>{r.slideTo(g,t,n,e)}),!0;return r.slideTo(g,t,n,e)}function t9(t,n,e){t===void 0&&(t=this.params.speed),n===void 0&&(n=!0);const r=this;return r.slideTo(r.activeIndex,t,n,e)}function n9(t,n,e,r){t===void 0&&(t=this.params.speed),n===void 0&&(n=!0),r===void 0&&(r=.5);const i=this;let o=i.activeIndex;const a=Math.min(i.params.slidesPerGroupSkip,o),s=a+Math.floor((o-a)/i.params.slidesPerGroup),u=i.rtlTranslate?i.translate:-i.translate;if(u>=i.snapGrid[s]){const l=i.snapGrid[s],c=i.snapGrid[s+1];u-l>(c-l)*r&&(o+=i.params.slidesPerGroup)}else{const l=i.snapGrid[s-1],c=i.snapGrid[s];u-l<=(c-l)*r&&(o-=i.params.slidesPerGroup)}return o=Math.max(o,0),o=Math.min(o,i.slidesGrid.length-1),i.slideTo(o,t,n,e)}function r9(){const t=this,{params:n,slidesEl:e}=t,r=n.slidesPerView==="auto"?t.slidesPerViewDynamic():n.slidesPerView;let i=t.clickedIndex,o;const a=t.isElement?"swiper-slide":`.${n.slideClass}`;if(n.loop){if(t.animating)return;o=parseInt(t.clickedSlide.getAttribute("data-swiper-slide-index"),10),n.centeredSlides?i<t.loopedSlides-r/2||i>t.slides.length-t.loopedSlides+r/2?(t.loopFix(),i=t.getSlideIndex(Uo(e,`${a}[data-swiper-slide-index="${o}"]`)[0]),ow(()=>{t.slideTo(i)})):t.slideTo(i):i>t.slides.length-r?(t.loopFix(),i=t.getSlideIndex(Uo(e,`${a}[data-swiper-slide-index="${o}"]`)[0]),ow(()=>{t.slideTo(i)})):t.slideTo(i)}else t.slideTo(i)}var i9={slideTo:JH,slideToLoop:QH,slideNext:ZH,slidePrev:e9,slideReset:t9,slideToClosest:n9,slideToClickedSlide:r9};function o9(t){const n=this,{params:e,slidesEl:r}=n;if(!e.loop||n.virtual&&n.params.virtual.enabled)return;const i=()=>{Uo(r,`.${e.slideClass}, swiper-slide`).forEach((d,f)=>{d.setAttribute("data-swiper-slide-index",f)})},o=n.grid&&e.grid&&e.grid.rows>1,a=e.slidesPerGroup*(o?e.grid.rows:1),s=n.slides.length%a!==0,u=o&&n.slides.length%e.grid.rows!==0,l=c=>{for(let d=0;d<c;d+=1){const f=n.isElement?sv("swiper-slide",[e.slideBlankClass]):sv("div",[e.slideClass,e.slideBlankClass]);n.slidesEl.append(f)}};if(s){if(e.loopAddBlankSlides){const c=a-n.slides.length%a;l(c),n.recalcSlides(),n.updateSlides()}else av("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");i()}else if(u){if(e.loopAddBlankSlides){const c=e.grid.rows-n.slides.length%e.grid.rows;l(c),n.recalcSlides(),n.updateSlides()}else av("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");i()}else i();n.loopFix({slideRealIndex:t,direction:e.centeredSlides?void 0:"next"})}function a9(t){let{slideRealIndex:n,slideTo:e=!0,direction:r,setTranslate:i,activeSlideIndex:o,byController:a,byMousewheel:s}=t===void 0?{}:t;const u=this;if(!u.params.loop)return;u.emit("beforeLoopFix");const{slides:l,allowSlidePrev:c,allowSlideNext:d,slidesEl:f,params:p}=u,{centeredSlides:h}=p;if(u.allowSlidePrev=!0,u.allowSlideNext=!0,u.virtual&&p.virtual.enabled){e&&(!p.centeredSlides&&u.snapIndex===0?u.slideTo(u.virtual.slides.length,0,!1,!0):p.centeredSlides&&u.snapIndex<p.slidesPerView?u.slideTo(u.virtual.slides.length+u.snapIndex,0,!1,!0):u.snapIndex===u.snapGrid.length-1&&u.slideTo(u.virtual.slidesBefore,0,!1,!0)),u.allowSlidePrev=c,u.allowSlideNext=d,u.emit("loopFix");return}let v=p.slidesPerView;v==="auto"?v=u.slidesPerViewDynamic():(v=Math.ceil(parseFloat(p.slidesPerView,10)),h&&v%2===0&&(v=v+1));const g=p.slidesPerGroupAuto?v:p.slidesPerGroup;let m=g;m%g!==0&&(m+=g-m%g),m+=p.loopAdditionalSlides,u.loopedSlides=m;const y=u.grid&&p.grid&&p.grid.rows>1;l.length<v+m?av("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):y&&p.grid.fill==="row"&&av("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const b=[],w=[];let x=u.activeIndex;typeof o>"u"?o=u.getSlideIndex(l.filter(T=>T.classList.contains(p.slideActiveClass))[0]):x=o;const C=r==="next"||!r,E=r==="prev"||!r;let S=0,k=0;const N=y?Math.ceil(l.length/p.grid.rows):l.length,D=(y?l[o].column:o)+(h&&typeof i>"u"?-v/2+.5:0);if(D<m){S=Math.max(m-D,g);for(let T=0;T<m-D;T+=1){const O=T-Math.floor(T/N)*N;if(y){const P=N-O-1;for(let A=l.length-1;A>=0;A-=1)l[A].column===P&&b.push(A)}else b.push(N-O-1)}}else if(D+v>N-m){k=Math.max(D-(N-m*2),g);for(let T=0;T<k;T+=1){const O=T-Math.floor(T/N)*N;y?l.forEach((P,A)=>{P.column===O&&w.push(A)}):w.push(O)}}if(u.__preventObserver__=!0,requestAnimationFrame(()=>{u.__preventObserver__=!1}),E&&b.forEach(T=>{l[T].swiperLoopMoveDOM=!0,f.prepend(l[T]),l[T].swiperLoopMoveDOM=!1}),C&&w.forEach(T=>{l[T].swiperLoopMoveDOM=!0,f.append(l[T]),l[T].swiperLoopMoveDOM=!1}),u.recalcSlides(),p.slidesPerView==="auto"?u.updateSlides():y&&(b.length>0&&E||w.length>0&&C)&&u.slides.forEach((T,O)=>{u.grid.updateSlide(O,T,u.slides)}),p.watchSlidesProgress&&u.updateSlidesOffset(),e){if(b.length>0&&E){if(typeof n>"u"){const T=u.slidesGrid[x],P=u.slidesGrid[x+S]-T;s?u.setTranslate(u.translate-P):(u.slideTo(x+S,0,!1,!0),i&&(u.touchEventsData.startTranslate=u.touchEventsData.startTranslate-P,u.touchEventsData.currentTranslate=u.touchEventsData.currentTranslate-P))}else if(i){const T=y?b.length/p.grid.rows:b.length;u.slideTo(u.activeIndex+T,0,!1,!0),u.touchEventsData.currentTranslate=u.translate}}else if(w.length>0&&C)if(typeof n>"u"){const T=u.slidesGrid[x],P=u.slidesGrid[x-k]-T;s?u.setTranslate(u.translate-P):(u.slideTo(x-k,0,!1,!0),i&&(u.touchEventsData.startTranslate=u.touchEventsData.startTranslate-P,u.touchEventsData.currentTranslate=u.touchEventsData.currentTranslate-P))}else{const T=y?w.length/p.grid.rows:w.length;u.slideTo(u.activeIndex-T,0,!1,!0)}}if(u.allowSlidePrev=c,u.allowSlideNext=d,u.controller&&u.controller.control&&!a){const T={slideRealIndex:n,direction:r,setTranslate:i,activeSlideIndex:o,byController:!0};Array.isArray(u.controller.control)?u.controller.control.forEach(O=>{!O.destroyed&&O.params.loop&&O.loopFix({...T,slideTo:O.params.slidesPerView===p.slidesPerView?e:!1})}):u.controller.control instanceof u.constructor&&u.controller.control.params.loop&&u.controller.control.loopFix({...T,slideTo:u.controller.control.params.slidesPerView===p.slidesPerView?e:!1})}u.emit("loopFix")}function s9(){const t=this,{params:n,slidesEl:e}=t;if(!n.loop||t.virtual&&t.params.virtual.enabled)return;t.recalcSlides();const r=[];t.slides.forEach(i=>{const o=typeof i.swiperSlideIndex>"u"?i.getAttribute("data-swiper-slide-index")*1:i.swiperSlideIndex;r[o]=i}),t.slides.forEach(i=>{i.removeAttribute("data-swiper-slide-index")}),r.forEach(i=>{e.append(i)}),t.recalcSlides(),t.slideTo(t.realIndex,0)}var u9={loopCreate:o9,loopFix:a9,loopDestroy:s9};function l9(t){const n=this;if(!n.params.simulateTouch||n.params.watchOverflow&&n.isLocked||n.params.cssMode)return;const e=n.params.touchEventsTarget==="container"?n.el:n.wrapperEl;n.isElement&&(n.__preventObserver__=!0),e.style.cursor="move",e.style.cursor=t?"grabbing":"grab",n.isElement&&requestAnimationFrame(()=>{n.__preventObserver__=!1})}function c9(){const t=this;t.params.watchOverflow&&t.isLocked||t.params.cssMode||(t.isElement&&(t.__preventObserver__=!0),t[t.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",t.isElement&&requestAnimationFrame(()=>{t.__preventObserver__=!1}))}var d9={setGrabCursor:l9,unsetGrabCursor:c9};function f9(t,n){n===void 0&&(n=this);function e(r){if(!r||r===Ec()||r===ai())return null;r.assignedSlot&&(r=r.assignedSlot);const i=r.closest(t);return!i&&!r.getRootNode?null:i||e(r.getRootNode().host)}return e(n)}function IN(t,n,e){const r=ai(),{params:i}=t,o=i.edgeSwipeDetection,a=i.edgeSwipeThreshold;return o&&(e<=a||e>=r.innerWidth-a)?o==="prevent"?(n.preventDefault(),!0):!1:!0}function p9(t){const n=this,e=Ec();let r=t;r.originalEvent&&(r=r.originalEvent);const i=n.touchEventsData;if(r.type==="pointerdown"){if(i.pointerId!==null&&i.pointerId!==r.pointerId)return;i.pointerId=r.pointerId}else r.type==="touchstart"&&r.targetTouches.length===1&&(i.touchId=r.targetTouches[0].identifier);if(r.type==="touchstart"){IN(n,r,r.targetTouches[0].pageX);return}const{params:o,touches:a,enabled:s}=n;if(!s||!o.simulateTouch&&r.pointerType==="mouse"||n.animating&&o.preventInteractionOnTransition)return;!n.animating&&o.cssMode&&o.loop&&n.loopFix();let u=r.target;if(o.touchEventsTarget==="wrapper"&&!n.wrapperEl.contains(u)||"which"in r&&r.which===3||"button"in r&&r.button>0||i.isTouched&&i.isMoved)return;const l=!!o.noSwipingClass&&o.noSwipingClass!=="",c=r.composedPath?r.composedPath():r.path;l&&r.target&&r.target.shadowRoot&&c&&(u=c[0]);const d=o.noSwipingSelector?o.noSwipingSelector:`.${o.noSwipingClass}`,f=!!(r.target&&r.target.shadowRoot);if(o.noSwiping&&(f?f9(d,u):u.closest(d))){n.allowClick=!0;return}if(o.swipeHandler&&!u.closest(o.swipeHandler))return;a.currentX=r.pageX,a.currentY=r.pageY;const p=a.currentX,h=a.currentY;if(!IN(n,r,p))return;Object.assign(i,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),a.startX=p,a.startY=h,i.touchStartTime=ov(),n.allowClick=!0,n.updateSize(),n.swipeDirection=void 0,o.threshold>0&&(i.allowThresholdMove=!1);let v=!0;u.matches(i.focusableElements)&&(v=!1,u.nodeName==="SELECT"&&(i.isTouched=!1)),e.activeElement&&e.activeElement.matches(i.focusableElements)&&e.activeElement!==u&&e.activeElement.blur();const g=v&&n.allowTouchMove&&o.touchStartPreventDefault;(o.touchStartForcePreventDefault||g)&&!u.isContentEditable&&r.preventDefault(),o.freeMode&&o.freeMode.enabled&&n.freeMode&&n.animating&&!o.cssMode&&n.freeMode.onTouchStart(),n.emit("touchStart",r)}function h9(t){const n=Ec(),e=this,r=e.touchEventsData,{params:i,touches:o,rtlTranslate:a,enabled:s}=e;if(!s||!i.simulateTouch&&t.pointerType==="mouse")return;let u=t;if(u.originalEvent&&(u=u.originalEvent),u.type==="pointermove"&&(r.touchId!==null||u.pointerId!==r.pointerId))return;let l;if(u.type==="touchmove"){if(l=[...u.changedTouches].filter(C=>C.identifier===r.touchId)[0],!l||l.identifier!==r.touchId)return}else l=u;if(!r.isTouched){r.startMoving&&r.isScrolling&&e.emit("touchMoveOpposite",u);return}const c=l.pageX,d=l.pageY;if(u.preventedByNestedSwiper){o.startX=c,o.startY=d;return}if(!e.allowTouchMove){u.target.matches(r.focusableElements)||(e.allowClick=!1),r.isTouched&&(Object.assign(o,{startX:c,startY:d,currentX:c,currentY:d}),r.touchStartTime=ov());return}if(i.touchReleaseOnEdges&&!i.loop){if(e.isVertical()){if(d<o.startY&&e.translate<=e.maxTranslate()||d>o.startY&&e.translate>=e.minTranslate()){r.isTouched=!1,r.isMoved=!1;return}}else if(c<o.startX&&e.translate<=e.maxTranslate()||c>o.startX&&e.translate>=e.minTranslate())return}if(n.activeElement&&u.target===n.activeElement&&u.target.matches(r.focusableElements)){r.isMoved=!0,e.allowClick=!1;return}r.allowTouchCallbacks&&e.emit("touchMove",u),o.previousX=o.currentX,o.previousY=o.currentY,o.currentX=c,o.currentY=d;const f=o.currentX-o.startX,p=o.currentY-o.startY;if(e.params.threshold&&Math.sqrt(f**2+p**2)<e.params.threshold)return;if(typeof r.isScrolling>"u"){let C;e.isHorizontal()&&o.currentY===o.startY||e.isVertical()&&o.currentX===o.startX?r.isScrolling=!1:f*f+p*p>=25&&(C=Math.atan2(Math.abs(p),Math.abs(f))*180/Math.PI,r.isScrolling=e.isHorizontal()?C>i.touchAngle:90-C>i.touchAngle)}if(r.isScrolling&&e.emit("touchMoveOpposite",u),typeof r.startMoving>"u"&&(o.currentX!==o.startX||o.currentY!==o.startY)&&(r.startMoving=!0),r.isScrolling){r.isTouched=!1;return}if(!r.startMoving)return;e.allowClick=!1,!i.cssMode&&u.cancelable&&u.preventDefault(),i.touchMoveStopPropagation&&!i.nested&&u.stopPropagation();let h=e.isHorizontal()?f:p,v=e.isHorizontal()?o.currentX-o.previousX:o.currentY-o.previousY;i.oneWayMovement&&(h=Math.abs(h)*(a?1:-1),v=Math.abs(v)*(a?1:-1)),o.diff=h,h*=i.touchRatio,a&&(h=-h,v=-v);const g=e.touchesDirection;e.swipeDirection=h>0?"prev":"next",e.touchesDirection=v>0?"prev":"next";const m=e.params.loop&&!i.cssMode,y=e.touchesDirection==="next"&&e.allowSlideNext||e.touchesDirection==="prev"&&e.allowSlidePrev;if(!r.isMoved){if(m&&y&&e.loopFix({direction:e.swipeDirection}),r.startTranslate=e.getTranslate(),e.setTransition(0),e.animating){const C=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});e.wrapperEl.dispatchEvent(C)}r.allowMomentumBounce=!1,i.grabCursor&&(e.allowSlideNext===!0||e.allowSlidePrev===!0)&&e.setGrabCursor(!0),e.emit("sliderFirstMove",u)}let b;if(new Date().getTime(),r.isMoved&&r.allowThresholdMove&&g!==e.touchesDirection&&m&&y&&Math.abs(h)>=1){Object.assign(o,{startX:c,startY:d,currentX:c,currentY:d,startTranslate:r.currentTranslate}),r.loopSwapReset=!0,r.startTranslate=r.currentTranslate;return}e.emit("sliderMove",u),r.isMoved=!0,r.currentTranslate=h+r.startTranslate;let w=!0,x=i.resistanceRatio;if(i.touchReleaseOnEdges&&(x=0),h>0?(m&&y&&!b&&r.allowThresholdMove&&r.currentTranslate>(i.centeredSlides?e.minTranslate()-e.slidesSizesGrid[e.activeIndex+1]:e.minTranslate())&&e.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),r.currentTranslate>e.minTranslate()&&(w=!1,i.resistance&&(r.currentTranslate=e.minTranslate()-1+(-e.minTranslate()+r.startTranslate+h)**x))):h<0&&(m&&y&&!b&&r.allowThresholdMove&&r.currentTranslate<(i.centeredSlides?e.maxTranslate()+e.slidesSizesGrid[e.slidesSizesGrid.length-1]:e.maxTranslate())&&e.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:e.slides.length-(i.slidesPerView==="auto"?e.slidesPerViewDynamic():Math.ceil(parseFloat(i.slidesPerView,10)))}),r.currentTranslate<e.maxTranslate()&&(w=!1,i.resistance&&(r.currentTranslate=e.maxTranslate()+1-(e.maxTranslate()-r.startTranslate-h)**x))),w&&(u.preventedByNestedSwiper=!0),!e.allowSlideNext&&e.swipeDirection==="next"&&r.currentTranslate<r.startTranslate&&(r.currentTranslate=r.startTranslate),!e.allowSlidePrev&&e.swipeDirection==="prev"&&r.currentTranslate>r.startTranslate&&(r.currentTranslate=r.startTranslate),!e.allowSlidePrev&&!e.allowSlideNext&&(r.currentTranslate=r.startTranslate),i.threshold>0)if(Math.abs(h)>i.threshold||r.allowThresholdMove){if(!r.allowThresholdMove){r.allowThresholdMove=!0,o.startX=o.currentX,o.startY=o.currentY,r.currentTranslate=r.startTranslate,o.diff=e.isHorizontal()?o.currentX-o.startX:o.currentY-o.startY;return}}else{r.currentTranslate=r.startTranslate;return}!i.followFinger||i.cssMode||((i.freeMode&&i.freeMode.enabled&&e.freeMode||i.watchSlidesProgress)&&(e.updateActiveIndex(),e.updateSlidesClasses()),i.freeMode&&i.freeMode.enabled&&e.freeMode&&e.freeMode.onTouchMove(),e.updateProgress(r.currentTranslate),e.setTranslate(r.currentTranslate))}function m9(t){const n=this,e=n.touchEventsData;let r=t;r.originalEvent&&(r=r.originalEvent);let i;if(r.type==="touchend"||r.type==="touchcancel"){if(i=[...r.changedTouches].filter(x=>x.identifier===e.touchId)[0],!i||i.identifier!==e.touchId)return}else{if(e.touchId!==null||r.pointerId!==e.pointerId)return;i=r}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(r.type)&&!(["pointercancel","contextmenu"].includes(r.type)&&(n.browser.isSafari||n.browser.isWebView)))return;e.pointerId=null,e.touchId=null;const{params:a,touches:s,rtlTranslate:u,slidesGrid:l,enabled:c}=n;if(!c||!a.simulateTouch&&r.pointerType==="mouse")return;if(e.allowTouchCallbacks&&n.emit("touchEnd",r),e.allowTouchCallbacks=!1,!e.isTouched){e.isMoved&&a.grabCursor&&n.setGrabCursor(!1),e.isMoved=!1,e.startMoving=!1;return}a.grabCursor&&e.isMoved&&e.isTouched&&(n.allowSlideNext===!0||n.allowSlidePrev===!0)&&n.setGrabCursor(!1);const d=ov(),f=d-e.touchStartTime;if(n.allowClick){const x=r.path||r.composedPath&&r.composedPath();n.updateClickedSlide(x&&x[0]||r.target,x),n.emit("tap click",r),f<300&&d-e.lastClickTime<300&&n.emit("doubleTap doubleClick",r)}if(e.lastClickTime=ov(),ow(()=>{n.destroyed||(n.allowClick=!0)}),!e.isTouched||!e.isMoved||!n.swipeDirection||s.diff===0&&!e.loopSwapReset||e.currentTranslate===e.startTranslate&&!e.loopSwapReset){e.isTouched=!1,e.isMoved=!1,e.startMoving=!1;return}e.isTouched=!1,e.isMoved=!1,e.startMoving=!1;let p;if(a.followFinger?p=u?n.translate:-n.translate:p=-e.currentTranslate,a.cssMode)return;if(a.freeMode&&a.freeMode.enabled){n.freeMode.onTouchEnd({currentPos:p});return}const h=p>=-n.maxTranslate()&&!n.params.loop;let v=0,g=n.slidesSizesGrid[0];for(let x=0;x<l.length;x+=x<a.slidesPerGroupSkip?1:a.slidesPerGroup){const C=x<a.slidesPerGroupSkip-1?1:a.slidesPerGroup;typeof l[x+C]<"u"?(h||p>=l[x]&&p<l[x+C])&&(v=x,g=l[x+C]-l[x]):(h||p>=l[x])&&(v=x,g=l[l.length-1]-l[l.length-2])}let m=null,y=null;a.rewind&&(n.isBeginning?y=a.virtual&&a.virtual.enabled&&n.virtual?n.virtual.slides.length-1:n.slides.length-1:n.isEnd&&(m=0));const b=(p-l[v])/g,w=v<a.slidesPerGroupSkip-1?1:a.slidesPerGroup;if(f>a.longSwipesMs){if(!a.longSwipes){n.slideTo(n.activeIndex);return}n.swipeDirection==="next"&&(b>=a.longSwipesRatio?n.slideTo(a.rewind&&n.isEnd?m:v+w):n.slideTo(v)),n.swipeDirection==="prev"&&(b>1-a.longSwipesRatio?n.slideTo(v+w):y!==null&&b<0&&Math.abs(b)>a.longSwipesRatio?n.slideTo(y):n.slideTo(v))}else{if(!a.shortSwipes){n.slideTo(n.activeIndex);return}n.navigation&&(r.target===n.navigation.nextEl||r.target===n.navigation.prevEl)?r.target===n.navigation.nextEl?n.slideTo(v+w):n.slideTo(v):(n.swipeDirection==="next"&&n.slideTo(m!==null?m:v+w),n.swipeDirection==="prev"&&n.slideTo(y!==null?y:v))}}function _N(){const t=this,{params:n,el:e}=t;if(e&&e.offsetWidth===0)return;n.breakpoints&&t.setBreakpoint();const{allowSlideNext:r,allowSlidePrev:i,snapGrid:o}=t,a=t.virtual&&t.params.virtual.enabled;t.allowSlideNext=!0,t.allowSlidePrev=!0,t.updateSize(),t.updateSlides(),t.updateSlidesClasses();const s=a&&n.loop;(n.slidesPerView==="auto"||n.slidesPerView>1)&&t.isEnd&&!t.isBeginning&&!t.params.centeredSlides&&!s?t.slideTo(t.slides.length-1,0,!1,!0):t.params.loop&&!a?t.slideToLoop(t.realIndex,0,!1,!0):t.slideTo(t.activeIndex,0,!1,!0),t.autoplay&&t.autoplay.running&&t.autoplay.paused&&(clearTimeout(t.autoplay.resizeTimeout),t.autoplay.resizeTimeout=setTimeout(()=>{t.autoplay&&t.autoplay.running&&t.autoplay.paused&&t.autoplay.resume()},500)),t.allowSlidePrev=i,t.allowSlideNext=r,t.params.watchOverflow&&o!==t.snapGrid&&t.checkOverflow()}function v9(t){const n=this;n.enabled&&(n.allowClick||(n.params.preventClicks&&t.preventDefault(),n.params.preventClicksPropagation&&n.animating&&(t.stopPropagation(),t.stopImmediatePropagation())))}function g9(){const t=this,{wrapperEl:n,rtlTranslate:e,enabled:r}=t;if(!r)return;t.previousTranslate=t.translate,t.isHorizontal()?t.translate=-n.scrollLeft:t.translate=-n.scrollTop,t.translate===0&&(t.translate=0),t.updateActiveIndex(),t.updateSlidesClasses();let i;const o=t.maxTranslate()-t.minTranslate();o===0?i=0:i=(t.translate-t.minTranslate())/o,i!==t.progress&&t.updateProgress(e?-t.translate:t.translate),t.emit("setTranslate",t.translate,!1)}function y9(t){const n=this;lm(n,t.target),!(n.params.cssMode||n.params.slidesPerView!=="auto"&&!n.params.autoHeight)&&n.update()}function b9(){const t=this;t.documentTouchHandlerProceeded||(t.documentTouchHandlerProceeded=!0,t.params.touchReleaseOnEdges&&(t.el.style.touchAction="auto"))}const MD=(t,n)=>{const e=Ec(),{params:r,el:i,wrapperEl:o,device:a}=t,s=!!r.nested,u=n==="on"?"addEventListener":"removeEventListener",l=n;e[u]("touchstart",t.onDocumentTouchStart,{passive:!1,capture:s}),i[u]("touchstart",t.onTouchStart,{passive:!1}),i[u]("pointerdown",t.onTouchStart,{passive:!1}),e[u]("touchmove",t.onTouchMove,{passive:!1,capture:s}),e[u]("pointermove",t.onTouchMove,{passive:!1,capture:s}),e[u]("touchend",t.onTouchEnd,{passive:!0}),e[u]("pointerup",t.onTouchEnd,{passive:!0}),e[u]("pointercancel",t.onTouchEnd,{passive:!0}),e[u]("touchcancel",t.onTouchEnd,{passive:!0}),e[u]("pointerout",t.onTouchEnd,{passive:!0}),e[u]("pointerleave",t.onTouchEnd,{passive:!0}),e[u]("contextmenu",t.onTouchEnd,{passive:!0}),(r.preventClicks||r.preventClicksPropagation)&&i[u]("click",t.onClick,!0),r.cssMode&&o[u]("scroll",t.onScroll),r.updateOnWindowResize?t[l](a.ios||a.android?"resize orientationchange observerUpdate":"resize observerUpdate",_N,!0):t[l]("observerUpdate",_N,!0),i[u]("load",t.onLoad,{capture:!0})};function w9(){const t=this,{params:n}=t;t.onTouchStart=p9.bind(t),t.onTouchMove=h9.bind(t),t.onTouchEnd=m9.bind(t),t.onDocumentTouchStart=b9.bind(t),n.cssMode&&(t.onScroll=g9.bind(t)),t.onClick=v9.bind(t),t.onLoad=y9.bind(t),MD(t,"on")}function x9(){MD(this,"off")}var S9={attachEvents:w9,detachEvents:x9};const AN=(t,n)=>t.grid&&n.grid&&n.grid.rows>1;function E9(){const t=this,{realIndex:n,initialized:e,params:r,el:i}=t,o=r.breakpoints;if(!o||o&&Object.keys(o).length===0)return;const a=t.getBreakpoint(o,t.params.breakpointsBase,t.el);if(!a||t.currentBreakpoint===a)return;const u=(a in o?o[a]:void 0)||t.originalParams,l=AN(t,r),c=AN(t,u),d=r.enabled;l&&!c?(i.classList.remove(`${r.containerModifierClass}grid`,`${r.containerModifierClass}grid-column`),t.emitContainerClasses()):!l&&c&&(i.classList.add(`${r.containerModifierClass}grid`),(u.grid.fill&&u.grid.fill==="column"||!u.grid.fill&&r.grid.fill==="column")&&i.classList.add(`${r.containerModifierClass}grid-column`),t.emitContainerClasses()),["navigation","pagination","scrollbar"].forEach(m=>{if(typeof u[m]>"u")return;const y=r[m]&&r[m].enabled,b=u[m]&&u[m].enabled;y&&!b&&t[m].disable(),!y&&b&&t[m].enable()});const f=u.direction&&u.direction!==r.direction,p=r.loop&&(u.slidesPerView!==r.slidesPerView||f),h=r.loop;f&&e&&t.changeDirection(),Ur(t.params,u);const v=t.params.enabled,g=t.params.loop;Object.assign(t,{allowTouchMove:t.params.allowTouchMove,allowSlideNext:t.params.allowSlideNext,allowSlidePrev:t.params.allowSlidePrev}),d&&!v?t.disable():!d&&v&&t.enable(),t.currentBreakpoint=a,t.emit("_beforeBreakpoint",u),e&&(p?(t.loopDestroy(),t.loopCreate(n),t.updateSlides()):!h&&g?(t.loopCreate(n),t.updateSlides()):h&&!g&&t.loopDestroy()),t.emit("breakpoint",u)}function C9(t,n,e){if(n===void 0&&(n="window"),!t||n==="container"&&!e)return;let r=!1;const i=ai(),o=n==="window"?i.innerHeight:e.clientHeight,a=Object.keys(t).map(s=>{if(typeof s=="string"&&s.indexOf("@")===0){const u=parseFloat(s.substr(1));return{value:o*u,point:s}}return{value:s,point:s}});a.sort((s,u)=>parseInt(s.value,10)-parseInt(u.value,10));for(let s=0;s<a.length;s+=1){const{point:u,value:l}=a[s];n==="window"?i.matchMedia(`(min-width: ${l}px)`).matches&&(r=u):l<=e.clientWidth&&(r=u)}return r||"max"}var R9={setBreakpoint:E9,getBreakpoint:C9};function T9(t,n){const e=[];return t.forEach(r=>{typeof r=="object"?Object.keys(r).forEach(i=>{r[i]&&e.push(n+i)}):typeof r=="string"&&e.push(n+r)}),e}function N9(){const t=this,{classNames:n,params:e,rtl:r,el:i,device:o}=t,a=T9(["initialized",e.direction,{"free-mode":t.params.freeMode&&e.freeMode.enabled},{autoheight:e.autoHeight},{rtl:r},{grid:e.grid&&e.grid.rows>1},{"grid-column":e.grid&&e.grid.rows>1&&e.grid.fill==="column"},{android:o.android},{ios:o.ios},{"css-mode":e.cssMode},{centered:e.cssMode&&e.centeredSlides},{"watch-progress":e.watchSlidesProgress}],e.containerModifierClass);n.push(...a),i.classList.add(...n),t.emitContainerClasses()}function k9(){const t=this,{el:n,classNames:e}=t;n.classList.remove(...e),t.emitContainerClasses()}var I9={addClasses:N9,removeClasses:k9};function _9(){const t=this,{isLocked:n,params:e}=t,{slidesOffsetBefore:r}=e;if(r){const i=t.slides.length-1,o=t.slidesGrid[i]+t.slidesSizesGrid[i]+r*2;t.isLocked=t.size>o}else t.isLocked=t.snapGrid.length===1;e.allowSlideNext===!0&&(t.allowSlideNext=!t.isLocked),e.allowSlidePrev===!0&&(t.allowSlidePrev=!t.isLocked),n&&n!==t.isLocked&&(t.isEnd=!1),n!==t.isLocked&&t.emit(t.isLocked?"lock":"unlock")}var A9={checkOverflow:_9},sw={init:!0,direction:"horizontal",oneWayMovement:!1,touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function O9(t,n){return function(r){r===void 0&&(r={});const i=Object.keys(r)[0],o=r[i];if(typeof o!="object"||o===null){Ur(n,r);return}if(t[i]===!0&&(t[i]={enabled:!0}),i==="navigation"&&t[i]&&t[i].enabled&&!t[i].prevEl&&!t[i].nextEl&&(t[i].auto=!0),["pagination","scrollbar"].indexOf(i)>=0&&t[i]&&t[i].enabled&&!t[i].el&&(t[i].auto=!0),!(i in t&&"enabled"in o)){Ur(n,r);return}typeof t[i]=="object"&&!("enabled"in t[i])&&(t[i].enabled=!0),t[i]||(t[i]={enabled:!1}),Ur(n,r)}}const H0={eventsEmitter:IH,update:jH,translate:GH,transition:YH,slide:i9,loop:u9,grabCursor:d9,events:S9,breakpoints:R9,checkOverflow:A9,classes:I9},G0={};let VS=class Do{constructor(){let n,e;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];i.length===1&&i[0].constructor&&Object.prototype.toString.call(i[0]).slice(8,-1)==="Object"?e=i[0]:[n,e]=i,e||(e={}),e=Ur({},e),n&&!e.el&&(e.el=n);const a=Ec();if(e.el&&typeof e.el=="string"&&a.querySelectorAll(e.el).length>1){const c=[];return a.querySelectorAll(e.el).forEach(d=>{const f=Ur({},e,{el:d});c.push(new Do(f))}),c}const s=this;s.__swiper__=!0,s.support=OD(),s.device=CH({userAgent:e.userAgent}),s.browser=TH(),s.eventsListeners={},s.eventsAnyListeners=[],s.modules=[...s.__modules__],e.modules&&Array.isArray(e.modules)&&s.modules.push(...e.modules);const u={};s.modules.forEach(c=>{c({params:e,swiper:s,extendParams:O9(e,u),on:s.on.bind(s),once:s.once.bind(s),off:s.off.bind(s),emit:s.emit.bind(s)})});const l=Ur({},sw,u);return s.params=Ur({},l,G0,e),s.originalParams=Ur({},s.params),s.passedParams=Ur({},e),s.params&&s.params.on&&Object.keys(s.params.on).forEach(c=>{s.on(c,s.params.on[c])}),s.params&&s.params.onAny&&s.onAny(s.params.onAny),Object.assign(s,{enabled:s.params.enabled,el:n,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return s.params.direction==="horizontal"},isVertical(){return s.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:s.params.allowSlideNext,allowSlidePrev:s.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:s.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:s.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),s.emit("_swiper"),s.params.init&&s.init(),s}getDirectionLabel(n){return this.isHorizontal()?n:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[n]}getSlideIndex(n){const{slidesEl:e,params:r}=this,i=Uo(e,`.${r.slideClass}, swiper-slide`),o=NN(i[0]);return NN(n)-o}getSlideIndexByData(n){return this.getSlideIndex(this.slides.filter(e=>e.getAttribute("data-swiper-slide-index")*1===n)[0])}recalcSlides(){const n=this,{slidesEl:e,params:r}=n;n.slides=Uo(e,`.${r.slideClass}, swiper-slide`)}enable(){const n=this;n.enabled||(n.enabled=!0,n.params.grabCursor&&n.setGrabCursor(),n.emit("enable"))}disable(){const n=this;n.enabled&&(n.enabled=!1,n.params.grabCursor&&n.unsetGrabCursor(),n.emit("disable"))}setProgress(n,e){const r=this;n=Math.min(Math.max(n,0),1);const i=r.minTranslate(),a=(r.maxTranslate()-i)*n+i;r.translateTo(a,typeof e>"u"?0:e),r.updateActiveIndex(),r.updateSlidesClasses()}emitContainerClasses(){const n=this;if(!n.params._emitClasses||!n.el)return;const e=n.el.className.split(" ").filter(r=>r.indexOf("swiper")===0||r.indexOf(n.params.containerModifierClass)===0);n.emit("_containerClasses",e.join(" "))}getSlideClasses(n){const e=this;return e.destroyed?"":n.className.split(" ").filter(r=>r.indexOf("swiper-slide")===0||r.indexOf(e.params.slideClass)===0).join(" ")}emitSlidesClasses(){const n=this;if(!n.params._emitClasses||!n.el)return;const e=[];n.slides.forEach(r=>{const i=n.getSlideClasses(r);e.push({slideEl:r,classNames:i}),n.emit("_slideClass",r,i)}),n.emit("_slideClasses",e)}slidesPerViewDynamic(n,e){n===void 0&&(n="current"),e===void 0&&(e=!1);const r=this,{params:i,slides:o,slidesGrid:a,slidesSizesGrid:s,size:u,activeIndex:l}=r;let c=1;if(typeof i.slidesPerView=="number")return i.slidesPerView;if(i.centeredSlides){let d=o[l]?o[l].swiperSlideSize:0,f;for(let p=l+1;p<o.length;p+=1)o[p]&&!f&&(d+=o[p].swiperSlideSize,c+=1,d>u&&(f=!0));for(let p=l-1;p>=0;p-=1)o[p]&&!f&&(d+=o[p].swiperSlideSize,c+=1,d>u&&(f=!0))}else if(n==="current")for(let d=l+1;d<o.length;d+=1)(e?a[d]+s[d]-a[l]<u:a[d]-a[l]<u)&&(c+=1);else for(let d=l-1;d>=0;d-=1)a[l]-a[d]<u&&(c+=1);return c}update(){const n=this;if(!n||n.destroyed)return;const{snapGrid:e,params:r}=n;r.breakpoints&&n.setBreakpoint(),[...n.el.querySelectorAll('[loading="lazy"]')].forEach(a=>{a.complete&&lm(n,a)}),n.updateSize(),n.updateSlides(),n.updateProgress(),n.updateSlidesClasses();function i(){const a=n.rtlTranslate?n.translate*-1:n.translate,s=Math.min(Math.max(a,n.maxTranslate()),n.minTranslate());n.setTranslate(s),n.updateActiveIndex(),n.updateSlidesClasses()}let o;if(r.freeMode&&r.freeMode.enabled&&!r.cssMode)i(),r.autoHeight&&n.updateAutoHeight();else{if((r.slidesPerView==="auto"||r.slidesPerView>1)&&n.isEnd&&!r.centeredSlides){const a=n.virtual&&r.virtual.enabled?n.virtual.slides:n.slides;o=n.slideTo(a.length-1,0,!1,!0)}else o=n.slideTo(n.activeIndex,0,!1,!0);o||i()}r.watchOverflow&&e!==n.snapGrid&&n.checkOverflow(),n.emit("update")}changeDirection(n,e){e===void 0&&(e=!0);const r=this,i=r.params.direction;return n||(n=i==="horizontal"?"vertical":"horizontal"),n===i||n!=="horizontal"&&n!=="vertical"||(r.el.classList.remove(`${r.params.containerModifierClass}${i}`),r.el.classList.add(`${r.params.containerModifierClass}${n}`),r.emitContainerClasses(),r.params.direction=n,r.slides.forEach(o=>{n==="vertical"?o.style.width="":o.style.height=""}),r.emit("changeDirection"),e&&r.update()),r}changeLanguageDirection(n){const e=this;e.rtl&&n==="rtl"||!e.rtl&&n==="ltr"||(e.rtl=n==="rtl",e.rtlTranslate=e.params.direction==="horizontal"&&e.rtl,e.rtl?(e.el.classList.add(`${e.params.containerModifierClass}rtl`),e.el.dir="rtl"):(e.el.classList.remove(`${e.params.containerModifierClass}rtl`),e.el.dir="ltr"),e.update())}mount(n){const e=this;if(e.mounted)return!0;let r=n||e.params.el;if(typeof r=="string"&&(r=document.querySelector(r)),!r)return!1;r.swiper=e,r.parentNode&&r.parentNode.host&&r.parentNode.host.nodeName==="SWIPER-CONTAINER"&&(e.isElement=!0);const i=()=>`.${(e.params.wrapperClass||"").trim().split(" ").join(".")}`;let a=r&&r.shadowRoot&&r.shadowRoot.querySelector?r.shadowRoot.querySelector(i()):Uo(r,i())[0];return!a&&e.params.createElements&&(a=sv("div",e.params.wrapperClass),r.append(a),Uo(r,`.${e.params.slideClass}`).forEach(s=>{a.append(s)})),Object.assign(e,{el:r,wrapperEl:a,slidesEl:e.isElement&&!r.parentNode.host.slideSlots?r.parentNode.host:a,hostEl:e.isElement?r.parentNode.host:r,mounted:!0,rtl:r.dir.toLowerCase()==="rtl"||Pa(r,"direction")==="rtl",rtlTranslate:e.params.direction==="horizontal"&&(r.dir.toLowerCase()==="rtl"||Pa(r,"direction")==="rtl"),wrongRTL:Pa(a,"display")==="-webkit-box"}),!0}init(n){const e=this;if(e.initialized||e.mount(n)===!1)return e;e.emit("beforeInit"),e.params.breakpoints&&e.setBreakpoint(),e.addClasses(),e.updateSize(),e.updateSlides(),e.params.watchOverflow&&e.checkOverflow(),e.params.grabCursor&&e.enabled&&e.setGrabCursor(),e.params.loop&&e.virtual&&e.params.virtual.enabled?e.slideTo(e.params.initialSlide+e.virtual.slidesBefore,0,e.params.runCallbacksOnInit,!1,!0):e.slideTo(e.params.initialSlide,0,e.params.runCallbacksOnInit,!1,!0),e.params.loop&&e.loopCreate(),e.attachEvents();const i=[...e.el.querySelectorAll('[loading="lazy"]')];return e.isElement&&i.push(...e.hostEl.querySelectorAll('[loading="lazy"]')),i.forEach(o=>{o.complete?lm(e,o):o.addEventListener("load",a=>{lm(e,a.target)})}),aw(e),e.initialized=!0,aw(e),e.emit("init"),e.emit("afterInit"),e}destroy(n,e){n===void 0&&(n=!0),e===void 0&&(e=!0);const r=this,{params:i,el:o,wrapperEl:a,slides:s}=r;return typeof r.params>"u"||r.destroyed||(r.emit("beforeDestroy"),r.initialized=!1,r.detachEvents(),i.loop&&r.loopDestroy(),e&&(r.removeClasses(),o.removeAttribute("style"),a.removeAttribute("style"),s&&s.length&&s.forEach(u=>{u.classList.remove(i.slideVisibleClass,i.slideFullyVisibleClass,i.slideActiveClass,i.slideNextClass,i.slidePrevClass),u.removeAttribute("style"),u.removeAttribute("data-swiper-slide-index")})),r.emit("destroy"),Object.keys(r.eventsListeners).forEach(u=>{r.off(u)}),n!==!1&&(r.el.swiper=null,mH(r)),r.destroyed=!0),null}static extendDefaults(n){Ur(G0,n)}static get extendedDefaults(){return G0}static get defaults(){return sw}static installModule(n){Do.prototype.__modules__||(Do.prototype.__modules__=[]);const e=Do.prototype.__modules__;typeof n=="function"&&e.indexOf(n)<0&&e.push(n)}static use(n){return Array.isArray(n)?(n.forEach(e=>Do.installModule(e)),Do):(Do.installModule(n),Do)}};Object.keys(H0).forEach(t=>{Object.keys(H0[t]).forEach(n=>{VS.prototype[n]=H0[t][n]})});VS.use([NH,kH]);const PD=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function lu(t){return typeof t=="object"&&t!==null&&t.constructor&&Object.prototype.toString.call(t).slice(8,-1)==="Object"&&!t.__swiper__}function Al(t,n){const e=["__proto__","constructor","prototype"];Object.keys(n).filter(r=>e.indexOf(r)<0).forEach(r=>{typeof t[r]>"u"?t[r]=n[r]:lu(n[r])&&lu(t[r])&&Object.keys(n[r]).length>0?n[r].__swiper__?t[r]=n[r]:Al(t[r],n[r]):t[r]=n[r]})}function LD(t){return t===void 0&&(t={}),t.navigation&&typeof t.navigation.nextEl>"u"&&typeof t.navigation.prevEl>"u"}function FD(t){return t===void 0&&(t={}),t.pagination&&typeof t.pagination.el>"u"}function zD(t){return t===void 0&&(t={}),t.scrollbar&&typeof t.scrollbar.el>"u"}function BD(t){t===void 0&&(t="");const n=t.split(" ").map(r=>r.trim()).filter(r=>!!r),e=[];return n.forEach(r=>{e.indexOf(r)<0&&e.push(r)}),e.join(" ")}function D9(t){return t===void 0&&(t=""),t?t.includes("swiper-wrapper")?t:`swiper-wrapper ${t}`:"swiper-wrapper"}function M9(t){let{swiper:n,slides:e,passedParams:r,changedParams:i,nextEl:o,prevEl:a,scrollbarEl:s,paginationEl:u}=t;const l=i.filter(k=>k!=="children"&&k!=="direction"&&k!=="wrapperClass"),{params:c,pagination:d,navigation:f,scrollbar:p,virtual:h,thumbs:v}=n;let g,m,y,b,w,x,C,E;i.includes("thumbs")&&r.thumbs&&r.thumbs.swiper&&c.thumbs&&!c.thumbs.swiper&&(g=!0),i.includes("controller")&&r.controller&&r.controller.control&&c.controller&&!c.controller.control&&(m=!0),i.includes("pagination")&&r.pagination&&(r.pagination.el||u)&&(c.pagination||c.pagination===!1)&&d&&!d.el&&(y=!0),i.includes("scrollbar")&&r.scrollbar&&(r.scrollbar.el||s)&&(c.scrollbar||c.scrollbar===!1)&&p&&!p.el&&(b=!0),i.includes("navigation")&&r.navigation&&(r.navigation.prevEl||a)&&(r.navigation.nextEl||o)&&(c.navigation||c.navigation===!1)&&f&&!f.prevEl&&!f.nextEl&&(w=!0);const S=k=>{n[k]&&(n[k].destroy(),k==="navigation"?(n.isElement&&(n[k].prevEl.remove(),n[k].nextEl.remove()),c[k].prevEl=void 0,c[k].nextEl=void 0,n[k].prevEl=void 0,n[k].nextEl=void 0):(n.isElement&&n[k].el.remove(),c[k].el=void 0,n[k].el=void 0))};i.includes("loop")&&n.isElement&&(c.loop&&!r.loop?x=!0:!c.loop&&r.loop?C=!0:E=!0),l.forEach(k=>{if(lu(c[k])&&lu(r[k]))Object.assign(c[k],r[k]),(k==="navigation"||k==="pagination"||k==="scrollbar")&&"enabled"in r[k]&&!r[k].enabled&&S(k);else{const N=r[k];(N===!0||N===!1)&&(k==="navigation"||k==="pagination"||k==="scrollbar")?N===!1&&S(k):c[k]=r[k]}}),l.includes("controller")&&!m&&n.controller&&n.controller.control&&c.controller&&c.controller.control&&(n.controller.control=c.controller.control),i.includes("children")&&e&&h&&c.virtual.enabled?(h.slides=e,h.update(!0)):i.includes("virtual")&&h&&c.virtual.enabled&&(e&&(h.slides=e),h.update(!0)),i.includes("children")&&e&&c.loop&&(E=!0),g&&v.init()&&v.update(!0),m&&(n.controller.control=c.controller.control),y&&(n.isElement&&(!u||typeof u=="string")&&(u=document.createElement("div"),u.classList.add("swiper-pagination"),u.part.add("pagination"),n.el.appendChild(u)),u&&(c.pagination.el=u),d.init(),d.render(),d.update()),b&&(n.isElement&&(!s||typeof s=="string")&&(s=document.createElement("div"),s.classList.add("swiper-scrollbar"),s.part.add("scrollbar"),n.el.appendChild(s)),s&&(c.scrollbar.el=s),p.init(),p.updateSize(),p.setTranslate()),w&&(n.isElement&&((!o||typeof o=="string")&&(o=document.createElement("div"),o.classList.add("swiper-button-next"),o.innerHTML=n.hostEl.constructor.nextButtonSvg,o.part.add("button-next"),n.el.appendChild(o)),(!a||typeof a=="string")&&(a=document.createElement("div"),a.classList.add("swiper-button-prev"),a.innerHTML=n.hostEl.constructor.prevButtonSvg,a.part.add("button-prev"),n.el.appendChild(a))),o&&(c.navigation.nextEl=o),a&&(c.navigation.prevEl=a),f.init(),f.update()),i.includes("allowSlideNext")&&(n.allowSlideNext=r.allowSlideNext),i.includes("allowSlidePrev")&&(n.allowSlidePrev=r.allowSlidePrev),i.includes("direction")&&n.changeDirection(r.direction,!1),(x||E)&&n.loopDestroy(),(C||E)&&n.loopCreate(),n.update()}function P9(t,n){t===void 0&&(t={}),n===void 0&&(n=!0);const e={on:{}},r={},i={};Al(e,sw),e._emitClasses=!0,e.init=!1;const o={},a=PD.map(u=>u.replace(/_/,"")),s=Object.assign({},t);return Object.keys(s).forEach(u=>{typeof t[u]>"u"||(a.indexOf(u)>=0?lu(t[u])?(e[u]={},i[u]={},Al(e[u],t[u]),Al(i[u],t[u])):(e[u]=t[u],i[u]=t[u]):u.search(/on[A-Z]/)===0&&typeof t[u]=="function"?n?r[`${u[2].toLowerCase()}${u.substr(3)}`]=t[u]:e.on[`${u[2].toLowerCase()}${u.substr(3)}`]=t[u]:o[u]=t[u])}),["navigation","pagination","scrollbar"].forEach(u=>{e[u]===!0&&(e[u]={}),e[u]===!1&&delete e[u]}),{params:e,passedParams:i,rest:o,events:r}}function L9(t,n){let{el:e,nextEl:r,prevEl:i,paginationEl:o,scrollbarEl:a,swiper:s}=t;LD(n)&&r&&i&&(s.params.navigation.nextEl=r,s.originalParams.navigation.nextEl=r,s.params.navigation.prevEl=i,s.originalParams.navigation.prevEl=i),FD(n)&&o&&(s.params.pagination.el=o,s.originalParams.pagination.el=o),zD(n)&&a&&(s.params.scrollbar.el=a,s.originalParams.scrollbar.el=a),s.init(e)}function F9(t,n,e,r,i){const o=[];if(!n)return o;const a=u=>{o.indexOf(u)<0&&o.push(u)};if(e&&r){const u=r.map(i),l=e.map(i);u.join("")!==l.join("")&&a("children"),r.length!==e.length&&a("children")}return PD.filter(u=>u[0]==="_").map(u=>u.replace(/_/,"")).forEach(u=>{if(u in t&&u in n)if(lu(t[u])&&lu(n[u])){const l=Object.keys(t[u]),c=Object.keys(n[u]);l.length!==c.length?a(u):(l.forEach(d=>{t[u][d]!==n[u][d]&&a(u)}),c.forEach(d=>{t[u][d]!==n[u][d]&&a(u)}))}else t[u]!==n[u]&&a(u)}),o}const z9=t=>{!t||t.destroyed||!t.params.virtual||t.params.virtual&&!t.params.virtual.enabled||(t.updateSlides(),t.updateProgress(),t.updateSlidesClasses(),t.parallax&&t.params.parallax&&t.params.parallax.enabled&&t.parallax.setTranslate())};function uv(){return uv=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},uv.apply(this,arguments)}function jD(t){return t.type&&t.type.displayName&&t.type.displayName.includes("SwiperSlide")}function VD(t){const n=[];return Ae.Children.toArray(t).forEach(e=>{jD(e)?n.push(e):e.props&&e.props.children&&VD(e.props.children).forEach(r=>n.push(r))}),n}function B9(t){const n=[],e={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return Ae.Children.toArray(t).forEach(r=>{if(jD(r))n.push(r);else if(r.props&&r.props.slot&&e[r.props.slot])e[r.props.slot].push(r);else if(r.props&&r.props.children){const i=VD(r.props.children);i.length>0?i.forEach(o=>n.push(o)):e["container-end"].push(r)}else e["container-end"].push(r)}),{slides:n,slots:e}}function j9(t,n,e){if(!e)return null;const r=c=>{let d=c;return c<0?d=n.length+c:d>=n.length&&(d=d-n.length),d},i=t.isHorizontal()?{[t.rtlTranslate?"right":"left"]:`${e.offset}px`}:{top:`${e.offset}px`},{from:o,to:a}=e,s=t.params.loop?-n.length:0,u=t.params.loop?n.length*2:n.length,l=[];for(let c=s;c<u;c+=1)c>=o&&c<=a&&l.push(n[r(c)]);return l.map((c,d)=>Ae.cloneElement(c,{swiper:t,style:i,key:`slide-${d}`}))}function Jd(t,n){return typeof window>"u"?W.useEffect(t,n):W.useLayoutEffect(t,n)}const ON=W.createContext(null),V9=W.createContext(null),$D=W.forwardRef(function(t,n){let{className:e,tag:r="div",wrapperTag:i="div",children:o,onSwiper:a,...s}=t===void 0?{}:t,u=!1;const[l,c]=W.useState("swiper"),[d,f]=W.useState(null),[p,h]=W.useState(!1),v=W.useRef(!1),g=W.useRef(null),m=W.useRef(null),y=W.useRef(null),b=W.useRef(null),w=W.useRef(null),x=W.useRef(null),C=W.useRef(null),E=W.useRef(null),{params:S,passedParams:k,rest:N,events:M}=P9(s),{slides:D,slots:T}=B9(o),O=()=>{h(!p)};Object.assign(S.on,{_containerClasses(F,L){c(L)}});const P=()=>{Object.assign(S.on,M),u=!0;const F={...S};if(delete F.wrapperClass,m.current=new VS(F),m.current.virtual&&m.current.params.virtual.enabled){m.current.virtual.slides=D;const L={cache:!1,slides:D,renderExternal:f,renderExternalUpdate:!1};Al(m.current.params.virtual,L),Al(m.current.originalParams.virtual,L)}};g.current||P(),m.current&&m.current.on("_beforeBreakpoint",O);const A=()=>{u||!M||!m.current||Object.keys(M).forEach(F=>{m.current.on(F,M[F])})},I=()=>{!M||!m.current||Object.keys(M).forEach(F=>{m.current.off(F,M[F])})};W.useEffect(()=>()=>{m.current&&m.current.off("_beforeBreakpoint",O)}),W.useEffect(()=>{!v.current&&m.current&&(m.current.emitSlidesClasses(),v.current=!0)}),Jd(()=>{if(n&&(n.current=g.current),!!g.current)return m.current.destroyed&&P(),L9({el:g.current,nextEl:w.current,prevEl:x.current,paginationEl:C.current,scrollbarEl:E.current,swiper:m.current},S),a&&a(m.current),()=>{m.current&&!m.current.destroyed&&m.current.destroy(!0,!1)}},[]),Jd(()=>{A();const F=F9(k,y.current,D,b.current,L=>L.key);return y.current=k,b.current=D,F.length&&m.current&&!m.current.destroyed&&M9({swiper:m.current,slides:D,passedParams:k,changedParams:F,nextEl:w.current,prevEl:x.current,scrollbarEl:E.current,paginationEl:C.current}),()=>{I()}}),Jd(()=>{z9(m.current)},[d]);function _(){return S.virtual?j9(m.current,D,d):D.map((F,L)=>Ae.cloneElement(F,{swiper:m.current,swiperSlideIndex:L}))}return Ae.createElement(r,uv({ref:g,className:BD(`${l}${e?` ${e}`:""}`)},N),Ae.createElement(V9.Provider,{value:m.current},T["container-start"],Ae.createElement(i,{className:D9(S.wrapperClass)},T["wrapper-start"],_(),T["wrapper-end"]),LD(S)&&Ae.createElement(Ae.Fragment,null,Ae.createElement("div",{ref:x,className:"swiper-button-prev"}),Ae.createElement("div",{ref:w,className:"swiper-button-next"})),zD(S)&&Ae.createElement("div",{ref:E,className:"swiper-scrollbar"}),FD(S)&&Ae.createElement("div",{ref:C,className:"swiper-pagination"}),T["container-end"]))});$D.displayName="Swiper";const UD=W.forwardRef(function(t,n){let{tag:e="div",children:r,className:i="",swiper:o,zoom:a,lazy:s,virtualIndex:u,swiperSlideIndex:l,...c}=t===void 0?{}:t;const d=W.useRef(null),[f,p]=W.useState("swiper-slide"),[h,v]=W.useState(!1);function g(w,x,C){x===d.current&&p(C)}Jd(()=>{if(typeof l<"u"&&(d.current.swiperSlideIndex=l),n&&(n.current=d.current),!(!d.current||!o)){if(o.destroyed){f!=="swiper-slide"&&p("swiper-slide");return}return o.on("_slideClass",g),()=>{o&&o.off("_slideClass",g)}}}),Jd(()=>{o&&d.current&&!o.destroyed&&p(o.getSlideClasses(d.current))},[o]);const m={isActive:f.indexOf("swiper-slide-active")>=0,isVisible:f.indexOf("swiper-slide-visible")>=0,isPrev:f.indexOf("swiper-slide-prev")>=0,isNext:f.indexOf("swiper-slide-next")>=0},y=()=>typeof r=="function"?r(m):r,b=()=>{v(!0)};return Ae.createElement(e,uv({ref:d,className:BD(`${f}${i?` ${i}`:""}`),"data-swiper-slide-index":u,onLoad:b},c),a&&Ae.createElement(ON.Provider,{value:m},Ae.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":typeof a=="number"?a:void 0},y(),s&&!h&&Ae.createElement("div",{className:"swiper-lazy-preloader"}))),!a&&Ae.createElement(ON.Provider,{value:m},y(),s&&!h&&Ae.createElement("div",{className:"swiper-lazy-preloader"})))});UD.displayName="SwiperSlide";function $9(t){const{effect:n,swiper:e,on:r,setTranslate:i,setTransition:o,overwriteParams:a,perspective:s,recreateShadows:u,getEffectParams:l}=t;r("beforeInit",()=>{if(e.params.effect!==n)return;e.classNames.push(`${e.params.containerModifierClass}${n}`),s&&s()&&e.classNames.push(`${e.params.containerModifierClass}3d`);const d=a?a():{};Object.assign(e.params,d),Object.assign(e.originalParams,d)}),r("setTranslate",()=>{e.params.effect===n&&i()}),r("setTransition",(d,f)=>{e.params.effect===n&&o(f)}),r("transitionEnd",()=>{if(e.params.effect===n&&u){if(!l||!l().slideShadows)return;e.slides.forEach(d=>{d.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(f=>f.remove())}),u()}});let c;r("virtualUpdate",()=>{e.params.effect===n&&(e.slides.length||(c=!0),requestAnimationFrame(()=>{c&&e.slides&&e.slides.length&&(i(),c=!1)}))})}function U9(t,n){const e=jS(n);return e!==n&&(e.style.backfaceVisibility="hidden",e.style["-webkit-backface-visibility"]="hidden"),e}function DN(t,n,e){const r=`swiper-slide-shadow${e?`-${e}`:""}${t?` swiper-slide-shadow-${t}`:""}`,i=jS(n);let o=i.querySelector(`.${r.split(" ").join(".")}`);return o||(o=sv("div",r.split(" ")),i.append(o)),o}function W9(t){let{swiper:n,extendParams:e,on:r}=t;e({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),$9({effect:"coverflow",swiper:n,on:r,setTranslate:()=>{const{width:a,height:s,slides:u,slidesSizesGrid:l}=n,c=n.params.coverflowEffect,d=n.isHorizontal(),f=n.translate,p=d?-f+a/2:-f+s/2,h=d?c.rotate:-c.rotate,v=c.depth;for(let g=0,m=u.length;g<m;g+=1){const y=u[g],b=l[g],w=y.swiperSlideOffset,x=(p-w-b/2)/b,C=typeof c.modifier=="function"?c.modifier(x):x*c.modifier;let E=d?h*C:0,S=d?0:h*C,k=-v*Math.abs(C),N=c.stretch;typeof N=="string"&&N.indexOf("%")!==-1&&(N=parseFloat(c.stretch)/100*b);let M=d?0:N*C,D=d?N*C:0,T=1-(1-c.scale)*Math.abs(C);Math.abs(D)<.001&&(D=0),Math.abs(M)<.001&&(M=0),Math.abs(k)<.001&&(k=0),Math.abs(E)<.001&&(E=0),Math.abs(S)<.001&&(S=0),Math.abs(T)<.001&&(T=0),n.browser&&n.browser.isSafari&&(Math.abs(E)/90%2===1&&(E+=.001),Math.abs(S)/90%2===1&&(S+=.001));const O=`translate3d(${D}px,${M}px,${k}px)  rotateX(${S}deg) rotateY(${E}deg) scale(${T})`,P=U9(c,y);if(P.style.transform=O,y.style.zIndex=-Math.abs(Math.round(C))+1,c.slideShadows){let A=d?y.querySelector(".swiper-slide-shadow-left"):y.querySelector(".swiper-slide-shadow-top"),I=d?y.querySelector(".swiper-slide-shadow-right"):y.querySelector(".swiper-slide-shadow-bottom");A||(A=DN("coverflow",y,d?"left":"top")),I||(I=DN("coverflow",y,d?"right":"bottom")),A&&(A.style.opacity=C>0?C:0),I&&(I.style.opacity=-C>0?-C:0)}}},setTransition:a=>{n.slides.map(u=>jS(u)).forEach(u=>{u.style.transitionDuration=`${a}ms`,u.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(l=>{l.style.transitionDuration=`${a}ms`})})},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}const H9=[{rating:8.5,title:"The Queen's Gambit"},{rating:9.5,title:"Breaking Bad"},{rating:8.1,title:"Wednesday"},{rating:8.7,title:"Stranger Things"},{rating:8.6,title:"Anne with an E"},{rating:8.9,title:"Friends"},{rating:8.6,title:"The Crown"},{rating:8.7,title:"House M.D."},{rating:9.2,title:"Game of Thrones"}],G9=()=>R.jsx($D,{modules:[W9],effect:"coverflow",slidesPerView:1.4,centeredSlides:!0,mousewheel:{invert:!1},onSlideChange:()=>console.log("slide change"),spaceBetween:-100,slideToClickedSlide:!0,coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},children:H9.map((t,n)=>R.jsx(UD,{},n))});var $S={},q9=yt;Object.defineProperty($S,"__esModule",{value:!0});var WD=$S.default=void 0,K9=q9(bt()),X9=R;WD=$S.default=(0,K9.default)((0,X9.jsx)("path",{d:"M19 9c0-1.3-.84-2.4-2-2.82V2h-2v4.18C13.84 6.6 13 7.7 13 9s.84 2.4 2 2.82V15c0 2.21-1.79 4-4 4s-4-1.79-4-4v-1h3L5 9v6c0 3.31 2.69 6 6 6s6-2.69 6-6v-3.18c1.16-.42 2-1.52 2-2.82m-3 1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"Phishing");var Y9={VITE_BASE_URL:"https://i10c203.p.ssafy.io/api",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function J9(){return console.log(Y9),R.jsx(R.Fragment,{children:R.jsxs("div",{className:"Home",children:[R.jsxs("div",{className:"Home_header",children:[R.jsx("img",{src:fH,alt:"logo"}),R.jsx(Ho,{to:"/fishbook",children:R.jsx(RN,{})}),R.jsx(Ho,{to:"/tutorial",children:R.jsx(RN,{})}),R.jsx(Ho,{to:"/chatbot",children:R.jsx(WD,{})})]}),R.jsx(G9,{})]})})}var HD={},US={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var GD=function(t,n){return(GD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])})(t,n)};function Hi(t,n){function e(){this.constructor=t}GD(t,n),t.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}function Oe(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(c){o(c)}}function s(l){try{u(r.throw(l))}catch(c){o(c)}}function u(l){l.done?i(l.value):new e(function(c){c(l.value)}).then(a,s)}u((r=r.apply(t,n||[])).next())})}function De(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(l){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(c[0]===6&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=n.call(t,a)}catch(d){c=[6,d],r=0}finally{e=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var qD=function(){function t(n){this.global=n,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(n,e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=n,this.platform=e},t.prototype.registerFlag=function(n,e,r){if(this.flagRegistry[n]={evaluationFn:e,setHook:r},this.urlFlags[n]!=null){var i=this.urlFlags[n];console.warn("Setting feature override from URL "+n+": "+i+"."),this.set(n,i)}},t.prototype.get=function(n){return n in this.flags?this.flags[n]:(this.flags[n]=this.evaluateFlag(n),this.flags[n])},t.prototype.getNumber=function(n){return this.get(n)},t.prototype.getBool=function(n){return this.get(n)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(n,e){if(this.flagRegistry[n]==null)throw new Error("Cannot set flag "+n+" as it has not been registered.");this.flags[n]=e,this.flagRegistry[n].setHook!=null&&this.flagRegistry[n].setHook(e)},t.prototype.evaluateFlag=function(n){if(this.flagRegistry[n]==null)throw new Error("Cannot evaluate flag '"+n+"': no evaluation function found.");return this.flagRegistry[n].evaluationFn()},t.prototype.setFlags=function(n){this.flags=Object.assign({},n)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var n=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var e,r,i=(e=this.global.location.search,r={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(o){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return function(u,l,c){u[decodeURIComponent(l)]=decodeURIComponent(c||"")}(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach(function(o){var a=o.split(":"),s=a[0],u=a[1];n.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},t}();function ie(){return WS}var WS=null,Jl=new Map;function KD(t,n){var e=HS(t,n);return Jl.get(e)}function uw(t){for(var n=Jl.entries(),e=[];;){var r=n.next(),i=r.done,o=r.value;if(i)break;var a=o[0],s=o[1];a.split("_")[0]===t&&e.push(s)}return e}function lw(t){var n=t.kernelName,e=t.backendName,r=HS(n,e);if(Jl.has(r))throw new Error("The kernel '"+n+"' for backend '"+e+"' is already registered");Jl.set(r,t)}function Q9(t,n){var e=HS(t,n);if(!Jl.has(e))throw new Error("The kernel '"+t+"' for backend '"+n+"' is not registered");Jl.delete(e)}function HS(t,n){return n+"_"+t}function MN(t){for(var n=t.length,e=0,r=0;n>0;)r=Math.random()*n|0,e=t[--n],t[n]=t[r],t[r]=e}function lv(t,n,e){return Math.max(t,Math.min(n,e))}function GS(t){return t%2==0?t:t+1}function XD(t){for(var n=0,e=0;e<t.length;e++)n+=t[e];return n}function U(t,n){if(!t)throw new Error(typeof n=="string"?n:n())}function gt(t,n,e){e===void 0&&(e=""),U(Bn(t,n),function(){return e+" Shapes "+t+" and "+n+" must match"})}function Su(t){U(t!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function na(t,n,e){if(n===void 0&&(n=[]),e===void 0&&(e=!1),n==null&&(n=[]),Array.isArray(t)||Kn(t)&&!e)for(var r=0;r<t.length;++r)na(t[r],n,e);else n.push(t);return n}function Pe(t){if(t.length===0)return 1;for(var n=t[0],e=1;e<t.length;e++)n*=t[e];return n}function Bn(t,n){if(t===n)return!0;if(t==null||n==null||t.length!==n.length)return!1;for(var e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function rn(t){return t%1==0}function YD(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var n=Math.exp(2*t);return(n-1)/(n+1)}function cv(t){var n=Math.ceil(Math.sqrt(t));return[n,Math.ceil(t/n)]}function Zs(t,n){return n<=t.length?t:t+" ".repeat(n-t.length)}function cw(t,n,e){return n===void 0&&(n=function(r){return 0}),new Promise(function(r,i){var o=0,a=function(){if(t())r();else{var s=n(++o);e!=null&&o>=e?i():setTimeout(a,s)}};a()})}function JD(t,n){for(var e=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)e*=t[i];else if(t[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(r===-1){if(n>0&&n!==e)throw Error("Size("+n+") must match the product of shape "+t);return t}if(e===0)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(n%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+n+" / "+e);var o=t.slice();return o[r]=n/e,o}function Vn(t,n){var e=n.length;return U((t=t==null?n.map(function(r,i){return i}):[].concat(t)).every(function(r){return r>=-e&&r<e}),function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+t}),U(t.every(function(r){return rn(r)}),function(){return"All values in axis param must be integers but got axis "+t}),t.map(function(r){return r<0?e+r:r})}function Aa(t,n){for(var e=[],r=[],i=n!=null&&Array.isArray(n)&&n.length===0,o=n==null||i?null:Vn(n,t).sort(),a=0,s=0;s<t.length;++s){if(o!=null){if(o[a]===s&&t[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(o[a]==null||o[a]>s)&&t[s]===1&&(e.push(t[s]),r.push(s)),o[a]<=s&&a++}t[s]!==1&&(e.push(t[s]),r.push(s))}return{newShape:e,keptDims:r}}function _f(t,n){var e=null;if(t==null||t==="float32")e=new Float32Array(n);else if(t==="int32")e=new Int32Array(n);else{if(t!=="bool")throw new Error("Unknown data type "+t);e=new Uint8Array(n)}return e}function Af(t,n){var e=null;if(t==null||t==="float32")e=new Float32Array(n);else if(t==="int32")e=new Int32Array(n);else if(t==="bool")e=new Uint8Array(n);else{if(t!=="string")throw new Error("Unknown data type "+t);e=new Array(n)}return e}function QD(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+n+" being uploaded contains "+r+".")}}function ZD(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function eM(t,n){return n!=="complex64"&&(n!=="float32"||t==="complex64")&&(n!=="int32"||t==="float32"||t==="complex64")&&(n!=="bool"||t!=="bool")}function Kn(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function qS(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error("Unknown dtype "+t)}function tM(t){if(t==null)return 0;var n=0;return t.forEach(function(e){return n+=e.length}),n}function La(t){return typeof t=="string"||t instanceof String}function nM(t){return typeof t=="boolean"}function rM(t){return typeof t=="number"}function Cc(t){return Array.isArray(t)?Cc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":rM(t)?"float32":La(t)?"string":nM(t)?"bool":"float32"}function as(t){return!!(t&&t.constructor&&t.call&&t.apply)}function dv(t,n){for(var e=n;e<t;++e)if(t%e==0)return e;return t}function vs(t){var n=t.length;if(n<2)return[];var e=new Array(n-1);e[n-2]=t[n-1];for(var r=n-3;r>=0;--r)e[r]=e[r+1]*t[r+1];return e}function KS(t,n,e){if(n==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=na(t)),e&&QD(t,n),function(o,a){return o instanceof Float32Array&&a==="float32"||o instanceof Int32Array&&a==="int32"||o instanceof Uint8Array&&a==="bool"}(t,n))return t;if(n==null||n==="float32"||n==="complex64")return new Float32Array(t);if(n==="int32")return new Int32Array(t);if(n==="bool"){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)Math.round(t[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+n)}function dw(t,n){if(t.length===0)return n[0];var e=t.reduce(function(r,i){return r*i});if(e===0)return[];if(e!==n.length)throw new Error("["+t+"] does not match the input size.");return function r(i,o,a){var s=new Array;if(o.length===1)for(var u=o[0],l=0;l<u;l++)s[l]=a[i+l];else{u=o[0];var c=o.slice(1),d=c.reduce(function(f,p){return f*p});for(l=0;l<u;l++)s[l]=r(i+l*d,c,a)}return s}(0,t,n)}function XS(t,n){for(var e=Rc(t,n),r=0;r<e.length;r++)e[r]=1;return e}function Rc(t,n){if(n==null||n==="float32"||n==="complex64")return new Float32Array(t);if(n==="int32")return new Int32Array(t);if(n==="bool")return new Uint8Array(t);throw new Error("Unknown data type "+n)}function Di(){return ie().platform.now()}function YS(t){t.forEach(function(n){U(Number.isInteger(n)&&n>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."})})}function iM(t,n){return n===void 0&&(n="utf-8"),n=n||"utf-8",ie().platform.encode(t,n)}function Of(t,n){return n===void 0&&(n="utf-8"),n=n||"utf-8",ie().platform.decode(t,n)}var Fe=Object.freeze({shuffle:MN,clamp:lv,nearestLargerEven:GS,sum:XD,randUniform:function(t,n){var e=Math.random();return n*e+(1-e)*t},distSquared:function(t,n){for(var e=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(n[r]);e+=i*i}return e},assert:U,assertShapesMatch:gt,assertNonNull:Su,flatten:na,sizeFromShape:Pe,isScalarShape:function(t){return t.length===0},arraysEqual:Bn,isInt:rn,tanh:YD,sizeToSquarishShape:cv,createShuffledIndices:function(t){for(var n=new Uint32Array(t),e=0;e<t;++e)n[e]=e;return MN(n),n},rightPad:Zs,repeatedTry:cw,inferFromImplicitShape:JD,parseAxisParam:Vn,squeezeShape:Aa,getTypedArrayFromDType:_f,getArrayFromDType:Af,checkConversionForErrors:QD,isValidDtype:ZD,hasEncodingLoss:eM,isTypedArray:Kn,bytesPerElement:qS,bytesFromStringArray:tM,isString:La,isBoolean:nM,isNumber:rM,inferDtype:Cc,isFunction:as,nearestDivisor:dv,computeStrides:vs,toTypedArray:KS,toNestedArray:dw,makeOnesTypedArray:XS,makeZerosTypedArray:Rc,now:Di,assertNonNegativeIntegerDimensions:YS,fetch:function(t,n){return ie().platform.fetch(t,n)},encodeString:iM,decodeString:Of}),Z9=function(){function t(n,e){this.backendTimer=n,this.logger=e,e==null&&(this.logger=new e7)}return t.prototype.profileKernel=function(n,e,r){var i,o=this,a=this.backendTimer.time(function(){i=r()});return i.forEach(function(s){s.data().then(function(u){(function(l,c,d){if(c!=="float32")return!1;for(var f=0;f<l.length;f++){var p=l[f];if(isNaN(p)||!isFinite(p))return console.warn("Found "+p+" in the result of '"+d+"'"),!0}})(u,s.dtype,n),a.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),o.logger.logKernelProfile(n,s,u,l.kernelMs,e,c)})})}),i},t}(),e7=function(){function t(){}return t.prototype.logKernelProfile=function(n,e,r,i,o,a){var s=Zs(i+"ms",9),u=Zs(n,25),l=e.rank,c=e.size,d=Zs(e.shape.toString(),14),f="";for(var p in o){var h=o[p].shape,v=h.length;f+=p+": "+v+"D "+(v>0?h:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+d+"	%c"+c+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),PN=20,sd=3,q0=7;function t7(t,n,e,r){var i=vs(n),o=function(l,c,d,f){var p=Pe(c),h=f[f.length-1],v=new Array(h).fill(0),g=c.length,m=d==="complex64"?ld(l):l;if(g>1)for(var y=0;y<p/h;y++)for(var b=y*h,w=0;w<h;w++)v[w]=Math.max(v[w],ud(m[b+w],0,d).length);return v}(t,n,e,i),a=n.length,s=function l(c,d,f,p,h,v){v===void 0&&(v=!0);var g=f==="complex64"?2:1,m=d[0],y=d.length;if(y===0){if(f==="complex64"){var b=ld(c);return[ud(b[0],0,f)]}return f==="bool"?[oM(c[0])]:[c[0].toString()]}if(y===1){if(m>PN){var w=sd*g,x=Array.from(c.slice(0,w)),C=Array.from(c.slice(m-sd*g,m));return f==="complex64"&&(x=ld(x),C=ld(C)),["["+x.map(function(I,_){return ud(I,h[_],f)}).join(", ")+", ..., "+C.map(function(I,_){return ud(I,h[m-sd+_],f)}).join(", ")+"]"]}var E=f==="complex64"?ld(c):Array.from(c);return["["+E.map(function(I,_){return ud(I,h[_],f)}).join(", ")+"]"]}var S=d.slice(1),k=p.slice(1),N=p[0]*g,M=[];if(m>PN){for(var D=0;D<sd;D++){var T=D*N,O=T+N;M.push.apply(M,l(c.slice(T,O),S,f,k,h,!1))}M.push("...");for(var D=m-sd;D<m;D++){var T=D*N,O=T+N;M.push.apply(M,l(c.slice(T,O),S,f,k,h,D===m-1))}}else for(var D=0;D<m;D++){var T=D*N,O=T+N;M.push.apply(M,l(c.slice(T,O),S,f,k,h,D===m-1))}var P=y===2?",":"";M[0]="["+M[0]+P;for(var D=1;D<M.length-1;D++)M[D]=" "+M[D]+P;for(var A=`,
`,D=2;D<y;D++)A+=`
`;return M[M.length-1]=" "+M[M.length-1]+"]"+(v?"":A),M}(t,n,e,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+e),u.push("  rank: "+a),u.push("  shape: ["+n+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function ud(t,n,e){return Zs(Array.isArray(t)?parseFloat(t[0].toFixed(q0))+" + "+parseFloat(t[1].toFixed(q0))+"j":La(t)?"'"+t+"'":e==="bool"?oM(t):parseFloat(t.toFixed(q0)).toString(),n)}function oM(t){return t===0?"false":"true"}function ld(t){for(var n=[],e=0;e<t.length;e+=2)n.push([t[e],t[e+1]]);return n}var Ql=function(){function t(n,e,r){var i=this;if(this.dtype=e,this.shape=n.slice(),this.size=Pe(n),r!=null){var o=r.length;U(o===this.size,function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+i.size+"'."})}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Af(e,this.size),this.strides=vs(n)}return t.prototype.set=function(n){for(var e=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),U(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+e.rank+")"});var o=this.locToIndex(r);this.values[o]=n},t.prototype.get=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];n.length===0&&(n=[0]);for(var r=0,i=0,o=n;i<o.length;i++){var a=o[i];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+n+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=n[n.length-1],l=0;l<n.length-1;++l)u+=this.strides[l]*n[l];return this.values[u]},t.prototype.locToIndex=function(n){if(this.rank===0)return 0;if(this.rank===1)return n[0];for(var e=n[n.length-1],r=0;r<n.length-1;++r)e+=this.strides[r]*n[r];return e},t.prototype.indexToLoc=function(n){if(this.rank===0)return[];if(this.rank===1)return[n];for(var e=new Array(this.shape.length),r=0;r<e.length-1;++r)e[r]=Math.floor(n/this.strides[r]),n-=e[r]*this.strides[r];return e[e.length-1]=n,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return so().makeTensor(this.values,this.shape,this.dtype)},t}(),so=null,oe=null,aM=null,At=function(){function t(n,e,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=n.slice(),this.dtype=e||"float32",this.size=Pe(n),this.strides=vs(n),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),U(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(n,e){return this.throwIfDisposed(),this.reshape([n,e])},t.prototype.as3D=function(n,e,r){return this.throwIfDisposed(),this.reshape([n,e,r])},t.prototype.as4D=function(n,e,r,i){return this.throwIfDisposed(),this.reshape([n,e,r,i])},t.prototype.as5D=function(n,e,r,i,o){return this.throwIfDisposed(),this.reshape([n,e,r,i,o])},t.prototype.asType=function(n){return this.throwIfDisposed(),oe.cast(this,n)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return Oe(this,void 0,void 0,function(){var n;return De(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return n=e.sent(),[2,oe.buffer(this.shape,this.dtype,n)]}})})},t.prototype.bufferSync=function(){return oe.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return Oe(this,void 0,void 0,function(){var n;return De(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return n=e.sent(),[2,dw(this.shape,n)]}})})},t.prototype.arraySync=function(){return dw(this.shape,this.dataSync())},t.prototype.data=function(){return Oe(this,void 0,void 0,function(){var n,e;return De(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),n=so().read(this.dataId),this.dtype!=="string"?[3,2]:[4,n];case 1:e=r.sent();try{return[2,e.map(function(i){return Of(i)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,n]}})})},t.prototype.dataSync=function(){this.throwIfDisposed();var n=so().readSync(this.dataId);if(this.dtype==="string")try{return n.map(function(e){return Of(e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return n},t.prototype.bytes=function(){return Oe(this,void 0,void 0,function(){var n;return De(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,so().read(this.dataId)];case 1:return n=e.sent(),this.dtype==="string"?[2,n]:[2,new Uint8Array(n.buffer)]}})})},t.prototype.dispose=function(){this.isDisposed||(so().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(n){return n===void 0&&(n=!1),oe.print(this,n)},t.prototype.reshape=function(n){return this.throwIfDisposed(),oe.reshape(this,n)},t.prototype.reshapeAs=function(n){return this.throwIfDisposed(),this.reshape(n.shape)},t.prototype.expandDims=function(n){return n===void 0&&(n=0),oe.expandDims(this,n)},t.prototype.cumsum=function(n,e,r){return n===void 0&&(n=0),e===void 0&&(e=!1),r===void 0&&(r=!1),oe.cumsum(this,n,e,r)},t.prototype.squeeze=function(n){return this.throwIfDisposed(),oe.squeeze(this,n)},t.prototype.clone=function(){return this.throwIfDisposed(),oe.clone(this)},t.prototype.oneHot=function(n,e,r){return this.throwIfDisposed(),oe.oneHot(this,n,e,r)},t.prototype.toString=function(n){return n===void 0&&(n=!1),t7(this.dataSync(),this.shape,this.dtype,n)},t.prototype.tile=function(n){return this.throwIfDisposed(),oe.tile(this,n)},t.prototype.gather=function(n,e){return e===void 0&&(e=0),this.throwIfDisposed(),oe.gather(this,n,e)},t.prototype.matMul=function(n,e,r){return e===void 0&&(e=!1),r===void 0&&(r=!1),this.throwIfDisposed(),oe.matMul(this,n,e,r)},t.prototype.dot=function(n){return this.throwIfDisposed(),oe.dot(this,n)},t.prototype.norm=function(n,e,r){return n===void 0&&(n="euclidean"),e===void 0&&(e=null),r===void 0&&(r=!1),this.throwIfDisposed(),oe.norm(this,n,e,r)},t.prototype.slice=function(n,e){return this.throwIfDisposed(),oe.slice(this,n,e)},t.prototype.reverse=function(n){return this.throwIfDisposed(),oe.reverse(this,n)},t.prototype.concat=function(n,e){return e===void 0&&(e=0),this.throwIfDisposed(),n instanceof t&&(n=[n]),oe.concat([this].concat(n),e)},t.prototype.split=function(n,e){return e===void 0&&(e=0),this.throwIfDisposed(),oe.split(this,n,e)},t.prototype.stack=function(n,e){return e===void 0&&(e=0),oe.stack([this,n],e)},t.prototype.unstack=function(n){return n===void 0&&(n=0),oe.unstack(this,n)},t.prototype.pad=function(n,e){return e===void 0&&(e=0),oe.pad(this,n,e)},t.prototype.batchNormalization=function(n,e,r,i,o){return r===void 0&&(r=.001),aM("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(n,e,o,i,r)},t.prototype.batchNorm=function(n,e,r,i,o){return o===void 0&&(o=.001),this.throwIfDisposed(),oe.batchNorm(this,n,e,r,i,o)},t.prototype.all=function(n,e){return n===void 0&&(n=null),e===void 0&&(e=!1),this.throwIfDisposed(),oe.all(this,n,e)},t.prototype.any=function(n,e){return n===void 0&&(n=null),e===void 0&&(e=!1),this.throwIfDisposed(),oe.any(this,n,e)},t.prototype.logSumExp=function(n,e){return n===void 0&&(n=null),e===void 0&&(e=!1),this.throwIfDisposed(),oe.logSumExp(this,n,e)},t.prototype.sum=function(n,e){return n===void 0&&(n=null),e===void 0&&(e=!1),this.throwIfDisposed(),oe.sum(this,n,e)},t.prototype.prod=function(n,e){return n===void 0&&(n=null),e===void 0&&(e=!1),this.throwIfDisposed(),oe.prod(this,n,e)},t.prototype.mean=function(n,e){return n===void 0&&(n=null),e===void 0&&(e=!1),this.throwIfDisposed(),oe.mean(this,n,e)},t.prototype.min=function(n,e){return n===void 0&&(n=null),e===void 0&&(e=!1),this.throwIfDisposed(),oe.min(this,n,e)},t.prototype.max=function(n,e){return n===void 0&&(n=null),e===void 0&&(e=!1),this.throwIfDisposed(),oe.max(this,n,e)},t.prototype.argMin=function(n){return n===void 0&&(n=null),this.throwIfDisposed(),oe.argMin(this,n)},t.prototype.argMax=function(n){return n===void 0&&(n=null),this.throwIfDisposed(),oe.argMax(this,n)},t.prototype.cast=function(n){return this.throwIfDisposed(),oe.cast(this,n)},t.prototype.add=function(n){return this.throwIfDisposed(),oe.add(this,n)},t.prototype.addStrict=function(n){return this.throwIfDisposed(),oe.addStrict(this,n)},t.prototype.atan2=function(n){return this.throwIfDisposed(),oe.atan2(this,n)},t.prototype.sub=function(n){return this.throwIfDisposed(),oe.sub(this,n)},t.prototype.subStrict=function(n){return this.throwIfDisposed(),oe.subStrict(this,n)},t.prototype.pow=function(n){return this.throwIfDisposed(),oe.pow(this,n)},t.prototype.powStrict=function(n){return this.throwIfDisposed(),oe.powStrict(this,n)},t.prototype.mul=function(n){return this.throwIfDisposed(),oe.mul(this,n)},t.prototype.mulStrict=function(n){return this.throwIfDisposed(),oe.mulStrict(this,n)},t.prototype.div=function(n){return this.throwIfDisposed(),oe.div(this,n)},t.prototype.floorDiv=function(n){return this.throwIfDisposed(),oe.floorDiv(this,n)},t.prototype.divStrict=function(n){return this.throwIfDisposed(),oe.divStrict(this,n)},t.prototype.minimum=function(n){return this.throwIfDisposed(),oe.minimum(this,n)},t.prototype.minimumStrict=function(n){return this.throwIfDisposed(),oe.minimumStrict(this,n)},t.prototype.maximum=function(n){return this.throwIfDisposed(),oe.maximum(this,n)},t.prototype.maximumStrict=function(n){return this.throwIfDisposed(),oe.maximumStrict(this,n)},t.prototype.mod=function(n){return this.throwIfDisposed(),oe.mod(this,n)},t.prototype.modStrict=function(n){return this.throwIfDisposed(),oe.modStrict(this,n)},t.prototype.squaredDifference=function(n){return this.throwIfDisposed(),oe.squaredDifference(this,n)},t.prototype.squaredDifferenceStrict=function(n){return this.throwIfDisposed(),oe.squaredDifferenceStrict(this,n)},t.prototype.transpose=function(n){return this.throwIfDisposed(),oe.transpose(this,n)},t.prototype.notEqual=function(n){return this.throwIfDisposed(),oe.notEqual(this,n)},t.prototype.notEqualStrict=function(n){return this.throwIfDisposed(),oe.notEqualStrict(this,n)},t.prototype.less=function(n){return this.throwIfDisposed(),oe.less(this,n)},t.prototype.lessStrict=function(n){return this.throwIfDisposed(),oe.lessStrict(this,n)},t.prototype.equal=function(n){return this.throwIfDisposed(),oe.equal(this,n)},t.prototype.equalStrict=function(n){return this.throwIfDisposed(),oe.equalStrict(this,n)},t.prototype.lessEqual=function(n){return this.throwIfDisposed(),oe.lessEqual(this,n)},t.prototype.lessEqualStrict=function(n){return this.throwIfDisposed(),oe.lessEqualStrict(this,n)},t.prototype.greater=function(n){return this.throwIfDisposed(),oe.greater(this,n)},t.prototype.greaterStrict=function(n){return this.throwIfDisposed(),oe.greaterStrict(this,n)},t.prototype.greaterEqual=function(n){return this.throwIfDisposed(),oe.greaterEqual(this,n)},t.prototype.greaterEqualStrict=function(n){return this.throwIfDisposed(),oe.greaterEqualStrict(this,n)},t.prototype.logicalAnd=function(n){return this.throwIfDisposed(),oe.logicalAnd(this,n)},t.prototype.logicalOr=function(n){return this.throwIfDisposed(),oe.logicalOr(this,n)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),oe.logicalNot(this)},t.prototype.logicalXor=function(n){return this.throwIfDisposed(),oe.logicalXor(this,n)},t.prototype.where=function(n,e){return this.throwIfDisposed(),oe.where(n,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),oe.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),oe.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),oe.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),oe.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),oe.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),oe.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),oe.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),oe.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),oe.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),oe.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),oe.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),oe.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),oe.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),oe.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),oe.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),oe.abs(this)},t.prototype.clipByValue=function(n,e){return this.throwIfDisposed(),oe.clipByValue(this,n,e)},t.prototype.relu=function(){return this.throwIfDisposed(),oe.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),oe.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),oe.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),oe.selu(this)},t.prototype.leakyRelu=function(n){return n===void 0&&(n=.2),this.throwIfDisposed(),oe.leakyRelu(this,n)},t.prototype.prelu=function(n){return this.throwIfDisposed(),oe.prelu(this,n)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),oe.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),oe.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),oe.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),oe.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),oe.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),oe.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),oe.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),oe.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),oe.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),oe.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),oe.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),oe.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),oe.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),oe.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),oe.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),oe.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),oe.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),oe.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),oe.round(this)},t.prototype.step=function(n){return n===void 0&&(n=0),this.throwIfDisposed(),oe.step(this,n)},t.prototype.softmax=function(n){return n===void 0&&(n=-1),this.throwIfDisposed(),oe.softmax(this,n)},t.prototype.logSoftmax=function(n){return n===void 0&&(n=-1),this.throwIfDisposed(),oe.logSoftmax(this,n)},t.prototype.resizeBilinear=function(n,e){return e===void 0&&(e=!1),this.throwIfDisposed(),oe.image.resizeBilinear(this,n,e)},t.prototype.resizeNearestNeighbor=function(n,e){return e===void 0&&(e=!1),this.throwIfDisposed(),oe.image.resizeNearestNeighbor(this,n,e)},t.prototype.conv1d=function(n,e,r,i,o,a){return i===void 0&&(i="NWC"),o===void 0&&(o=1),this.throwIfDisposed(),oe.conv1d(this,n,e,r,i,o,a)},t.prototype.conv2d=function(n,e,r,i,o,a){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),oe.conv2d(this,n,e,r,i,o,a)},t.prototype.conv2dTranspose=function(n,e,r,i,o){return this.throwIfDisposed(),oe.conv2dTranspose(this,n,e,r,i,o)},t.prototype.depthwiseConv2D=function(n,e,r,i,o,a){return i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),oe.depthwiseConv2d(this,n,e,r,i,o,a)},t.prototype.separableConv2d=function(n,e,r,i,o,a){return o===void 0&&(o=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),oe.separableConv2d(this,n,e,r,i,o,a)},t.prototype.avgPool=function(n,e,r,i){return this.throwIfDisposed(),oe.avgPool(this,n,e,r,i)},t.prototype.maxPool=function(n,e,r,i){return this.throwIfDisposed(),oe.maxPool(this,n,e,r,i)},t.prototype.localResponseNormalization=function(n,e,r,i){return n===void 0&&(n=5),e===void 0&&(e=1),r===void 0&&(r=1),i===void 0&&(i=.5),oe.localResponseNormalization(this,n,e,r,i)},t.prototype.pool=function(n,e,r,i,o){return this.throwIfDisposed(),oe.pool(this,n,e,r,i,o)},t.prototype.variable=function(n,e,r){return n===void 0&&(n=!0),this.throwIfDisposed(),so().makeVariable(this,n,e,r)},t.prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),oe.unsortedSegmentSum(this,n,e)},t.prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),oe.batchToSpaceND(this,n,e)},t.prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),oe.spaceToBatchND(this,n,e)},t.prototype.topk=function(n,e){return n===void 0&&(n=1),e===void 0&&(e=!0),this.throwIfDisposed(),oe.topk(this,n,e)},t.prototype.stridedSlice=function(n,e,r,i,o,a,s,u){return i===void 0&&(i=0),o===void 0&&(o=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),oe.stridedSlice(this,n,e,r,i,o,a,s,u)},t.prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),oe.depthToSpace(this,n,e)},t.prototype.fft=function(){return this.throwIfDisposed(),oe.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),oe.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),oe.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),oe.spectral.irfft(this)},t}();Object.defineProperty(At,Symbol.hasInstance,{value:function(t){return!!t&&t.dataId!=null&&t.shape!=null&&t.dtype!=null}});var fw,pw,hw,mw,vw,Df=function(t){function n(e,r,i,o){var a=t.call(this,e.shape,e.dtype,e.dataId,o)||this;return a.trainable=r,a.name=i,a}return Hi(n,t),n.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!Bn(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");so().disposeTensor(this),this.dataId=e.dataId,so().incRef(this,null)},n.prototype.dispose=function(){so().disposeVariable(this),this.isDisposedInternal=!0},n}(At);Object.defineProperty(Df,Symbol.hasInstance,{value:function(t){return t instanceof At&&t.assign!=null&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(fw||(fw={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(pw||(pw={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(hw||(hw={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(mw||(mw={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(vw||(vw={}));var n7={float32:mw,int32:pw,bool:hw,complex64:vw};function bn(t,n){if(t==="string"||n==="string"){if(t==="string"&&n==="string")return"string";throw new Error("Can not upcast "+t+" with "+n)}return n7[t][n]}function K0(t){return bn(t,"int32")}function fn(t,n){if(t.dtype===n.dtype)return[t,n];var e=bn(t.dtype,n.dtype);return[t.cast(e),n.cast(e)]}function sM(t,n){U(t.dtype===n.dtype,function(){return"The dtypes of the first("+t.dtype+") and second("+n.dtype+") input must match"})}function JS(t){var n=[];return function e(r,i,o){if(r!=null){if(r instanceof At)return void i.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var l=s[u];o.has(l)||(o.add(l),e(l,i,o))}}}}(t,n,new Set),n}var X0,yo=Object.freeze({makeTypesMatch:fn,assertTypesMatch:sM,isTensorInList:function(t,n){for(var e=0;e<n.length;e++)if(n[e].id===t.id)return!0;return!1},getTensorsInContainer:JS}),LN=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var n in this.registeredVariables)this.registeredVariables[n].dispose()},t}(),r7=function(){function t(n){this.ENV=n,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new LN}return t.prototype.ready=function(){return Oe(this,void 0,void 0,function(){var n,e,r;return De(this,function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];n=this.getSortedBackends(),e=0,i.label=1;case 1:return e<n.length?(r=n[e],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(t.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(this.backendInstance==null){var n=this.initializeBackendsAndReturnBest(),e=n.name;if(n.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(n){return!(n in this.registry)&&(!(n in this.registryFactory)||this.initializeBackend(n).asyncInit)?null:this.registry[n]},t.prototype.findBackendFactory=function(n){return n in this.registryFactory?this.registryFactory[n].factory:null},t.prototype.registerBackend=function(n,e,r){return r===void 0&&(r=1),n in this.registryFactory?(console.warn(n+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[n]={factory:e,priority:r},!0)},t.prototype.setBackend=function(n){return Oe(this,void 0,void 0,function(){var e,r,i;return De(this,function(o){switch(o.label){case 0:if(this.registryFactory[n]==null)throw new Error("Backend name '"+n+"' not found in registry");return this.backendName=n,this.registry[n]!=null?[3,4]:(this.backendInstance=null,e=this.initializeBackend(n),r=e.success,e.asyncInit?[4,r]:[3,2]);case 1:return i=o.sent(),[3,3];case 2:i=r,o.label=3;case 3:if(!i)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[n],this.setupRegisteredKernels(),this.profiler=new Z9(this.backendInstance),[2,!0]}})})},t.prototype.setupRegisteredKernels=function(){var n=this;uw(this.backendName).forEach(function(e){e.setupFunc!=null&&e.setupFunc(n.backendInstance)})},t.prototype.disposeRegisteredKernels=function(n){var e=this;uw(n).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(e.registry[n])})},t.prototype.initializeBackend=function(n){var e=this,r=this.registryFactory[n];if(r==null)throw new Error("Cannot initialize backend "+n+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var o=++this.pendingBackendInitId,a=i.then(function(s){return!(o<e.pendingBackendInitId)&&(e.registry[n]=s,e.pendingBackendInit=null,!0)}).catch(function(s){return!(o<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+n+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[n]=i,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+n+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(n){if(!(n in this.registryFactory))throw new Error(n+" backend not found in registry");this.backendName===n&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,n in this.registry&&(this.disposeRegisteredKernels(n),this.registry[n].dispose(),delete this.registry[n]),delete this.registryFactory[n],this.backendName===n&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var n=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,r){return n.registryFactory[r].priority-n.registryFactory[e].priority})},t.prototype.initializeBackendsAndReturnBest=function(){for(var n=this.getSortedBackends(),e=0;e<n.length;e++){var r=n[e],i=this.initializeBackend(r),o=i.success,a=i.asyncInit;if(a||o)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(n,e){var r=this.state.tensorInfo.get(e),i=r.backend,o=this.readSync(e);i.disposeData(e),r.backend=n,n.move(e,o,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(n,e){var r,i=this,o=null;if(e==null){if(typeof n!="function")throw new Error("Please provide a function to tidy()");e=n}else{if(typeof n!="string"&&!(n instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=n}return this.scopedRun(function(){return i.startScope(o)},function(){return i.endScope(r)},function(){return(r=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},t.prototype.scopedRun=function(n,e,r){n();try{var i=r();return e(),i}catch(o){throw e(),o}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(n){var e=this.makeTensorFromDataId(n.dataId,n.shape,n.dtype),r={x:n};return this.addTapeNode(this.state.activeScope.name,r,[e],function(i){return{x:function(){return i.toFloat()}}},[]),e},t.prototype.runKernel=function(n,e,r,i,o){return this.runKernelFunc(null,e,null,n,r,i,o)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(n,e,r){var i=this.backend.numDataIds(),o=0;r.forEach(function(u){o+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=i-e-o-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+n+"'")},t.prototype.runKernelFunc=function(n,e,r,i,o,a,s){var u,l=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c,d=[],f=this.isTapeOn(),p=this.state.activeScope!=null?this.state.activeScope.name:"",h=function(b){f&&(d=b.map(function(w){return l.keep(l.clone(w))}))},v=this.state.numBytes,g=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var m,y=KD(i,this.backendName);return c=y!=null?function(){var b=l.backend.numDataIds();m=y.kernelFunc({inputs:e,attrs:o,backend:l.backend});var w=Array.isArray(m)?m:[m];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(p,b,w);var x=w.map(function(E){var S=E.dataId,k=E.shape,N=E.dtype;return l.makeTensorFromDataId(S,k,N)}),C=x.filter(function(E,S){return s[S]});return h(a.slice().concat(C)),x}:function(){var b=l.backend.numDataIds();m=l.tidy(function(){return n(l.backend,h)});var w=Array.isArray(m)?m:[m];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(p,b,w),w},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(p,e,function(){return c()}):c()}),f&&this.addTapeNode(p,e,u,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:p,bytesAdded:this.state.numBytes-v,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-g,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(b){return e[b].shape}),outputShapes:u.map(function(b){return b.shape})}),Array.isArray(m)?u:u[0]},t.prototype.makeTensor=function(n,e,r,i){if(n==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var o=n;r==="string"&&La(n[0])&&(o=n.map(function(c){return iM(c)}));var a=i.write(o,e,r),s=new At(e,r,a,this.nextTensorId());if(this.incRef(s,i),r==="string"){var u=this.state.tensorInfo.get(a),l=tM(o);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},t.prototype.makeTensorFromDataId=function(n,e,r,i){var o=new At(e,r=r||"float32",n,this.nextTensorId());return this.incRef(o,i),o},t.prototype.makeVariable=function(n,e,r,i){e===void 0&&(e=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==n.dtype&&(n=n.asType(i));var o=new Df(n,e,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},t.prototype.incRef=function(n,e){var r=this.state.tensorInfo.has(n.dataId)?this.state.tensorInfo.get(n.dataId).refCount:0;if(this.state.numTensors++,n.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;n.dtype!=="complex64"&&n.dtype!=="string"&&(i=n.size*qS(n.dtype)),this.state.tensorInfo.set(n.dataId,{backend:e||this.backend,dtype:n.dtype,shape:n.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(n.dataId).refCount++,n instanceof Df||this.track(n)},t.prototype.disposeTensor=function(n){if(this.state.tensorInfo.has(n.dataId)){this.state.numTensors--,n.dtype==="string"&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(n.dataId);e.refCount<=1?(n.dtype!=="complex64"&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(n.dataId),this.state.tensorInfo.delete(n.dataId)):this.state.tensorInfo.get(n.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var n in this.state.registeredVariables){var e=this.state.registeredVariables[n];this.disposeVariable(e)}},t.prototype.disposeVariable=function(n){this.disposeTensor(n),this.state.registeredVariables[n.name]!=null&&delete this.state.registeredVariables[n.name]},t.prototype.memory=function(){var n=this.backend.memory();return n.numTensors=this.state.numTensors,n.numDataBuffers=this.state.numDataBuffers,n.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(n.unreliable=!0,n.reasons==null&&(n.reasons=[]),n.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),n},t.prototype.profile=function(n){return Oe(this,void 0,void 0,function(){var e,r;return De(this,function(i){return this.state.profiling=!0,e=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=n(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(o){return o.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},t.prototype.addTapeNode=function(n,e,r,i,o){var a=this,s={id:this.state.nextTapeNodeId++,name:n,inputs:e,outputs:r,saved:o};i!=null&&(s.gradient=function(u){return u=u.map(function(l,c){if(l==null){var d=r[c],f=Rc(d.size,d.dtype);return a.makeTensor(f,d.shape,d.dtype)}return l}),i(u.length>1?u:u[0],o)}),this.state.activeTape.push(s)},t.prototype.keep=function(n){return n.kept=!0,n},t.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(n){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};n&&(e.name=n),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(n){for(var e=this,r=JS(n),i=new Set(r.map(function(u){return u.id})),o=0;o<this.state.activeScope.track.length;o++){var a=this.state.activeScope.track[o];a.kept||i.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||e.track(u)})},t.prototype.gradients=function(n,e,r,i){var o=this;if(i===void 0&&(i=!1),U(e.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return o.startTape()},function(){return o.endTape()},function(){return o.tidy("forward",n)});U(a instanceof At,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var d={},f={},p=0;p<l.length;p++)d[l[p].id]=!0;for(p=0;p<u.length;p++){var h=(C=u[p]).inputs;for(var v in h){for(var g=h[v],m=!1,y=0;y<l.length;y++)if(d[g.id]){C.outputs.forEach(function(N){return d[N.id]=!0}),m=!0,f[C.id]=!0;break}if(m)break}}var b={};b[c.id]=!0;var w={};for(p=u.length-1;p>=0;p--)for(h=(C=u[p]).inputs,y=0;y<C.outputs.length;y++)if(b[C.outputs[y].id]){for(var v in h)b[h[v].id]=!0,w[C.id]=!0;break}var x=[];for(p=0;p<u.length;p++){var C;if(f[(C=u[p]).id]&&w[C.id]){var E={};for(var v in C.inputs){var S=C.inputs[v];d[S.id]&&(E[v]=S)}var k=Object.assign({},C);k.inputs=E,k.outputs=C.outputs,x.push(k)}}return x}(this.state.activeTape,e,a);if(!i&&s.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[a.id]=r??(u=a.shape,l=XS(Pe(u),"float32"),K.makeTensor(l,u,"float32")),function(f,p,h){for(var v=function(m){var y=p[m],b=[];if(y.outputs.forEach(function(E){var S=f[E.id];S!=null?b.push(S):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.name+".");var w=y.gradient(b),x=function(E){if(!(E in w))throw new Error("Cannot backprop through input "+E+". Available gradients found: "+Object.keys(w)+".");var S=h(function(){return w[E]()});if(S.dtype!=="float32")throw new Error("Error in gradient for op "+y.name+". The gradient of input "+E+" must have 'float32' dtype, but has '"+S.dtype+"'");var k=y.inputs[E];if(!Bn(S.shape,k.shape))throw new Error("Error in gradient for op "+y.name+". The gradient of input '"+E+"' has shape '"+S.shape+"', which does not match the shape of the input '"+k.shape+"'");if(f[k.id]==null)f[k.id]=S;else{var N=f[k.id];f[k.id]=N.add(S),N.dispose()}};for(var C in y.inputs)x(C)},g=p.length-1;g>=0;g--)v(g)}(c,s,function(f){return o.tidy(f)});var d=e.map(function(f){return c[f.id]});return o.state.gradientDepth===0&&(o.state.activeTape.forEach(function(f){for(var p in f.saved)f.saved[p].dispose()}),o.state.activeTape=null),{value:a,grads:d}})},t.prototype.customGrad=function(n){var e=this;return U(as(n),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];U(i.every(function(s){return s instanceof At}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return i.forEach(function(s,u){a[u]=s}),e.runKernelFunc(function(s,u){return U((r=n.apply(void 0,i.concat([u]))).value instanceof At,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),U(as(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];U(c.length===i.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),U(c.every(function(f){return f instanceof At}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return c.forEach(function(f,p){d[p]=function(){return f}}),d})}},t.prototype.readSync=function(n){return this.state.tensorInfo.get(n).backend.readSync(n)},t.prototype.read=function(n){return this.state.tensorInfo.get(n).backend.read(n)},t.prototype.fromPixels=function(n,e){return this.backend.fromPixels(n,e)},t.prototype.time=function(n){return Oe(this,void 0,void 0,function(){var e,r;return De(this,function(i){switch(i.label){case 0:return e=Di(),[4,this.backend.time(n)];case 1:return(r=i.sent()).wallMs=Di()-e,[2,r]}})})},t.prototype.track=function(n){return this.state.activeScope!=null&&(n.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(n)),n},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var n in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new LN,this.registry)this.disposeRegisteredKernels(n),this.registry[n].dispose(),delete this.registry[n];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),K=function(){var t=function(){if(X0==null){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}X0=e}return X0}();if(t._tfengine==null){var n=new qD(t);t._tfengine=new r7(n)}return function(e){WS=e}(t._tfengine.ENV),so=function(){return t._tfengine},t._tfengine}();function uM(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Ao=ie();Ao.registerFlag("DEBUG",function(){return!1},function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Ao.registerFlag("IS_BROWSER",function(){return uM()}),Ao.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Ao.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Ao.registerFlag("PROD",function(){return!1}),Ao.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Ao.getBool("DEBUG")}),Ao.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Ao.registerFlag("IS_TEST",function(){return!1});var Mf,qr,Wr,Ms={},Y0={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function lM(t,n){Ms[t]=n}function Co(t){t in Ms||(Ms[t]=function(e){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=cM(e);return r.addEventListener("webglcontextlost",function(i){i.preventDefault(),delete Ms[e]},!1),e===1?r.getContext("webgl",Y0)||r.getContext("experimental-webgl",Y0):r.getContext("webgl2",Y0)}(t));var n=Ms[t];return n.isContextLost()?(delete Ms[t],Co(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ms[t])}function cM(t){if(typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function gg(t,n){return[n,t]}function Qd(t){var n=Pe(t);return cv(Math.ceil(n/4))}function ip(t,n){return[Math.max(1,Math.ceil(n/2)),Math.max(1,Math.ceil(t/2))]}function QS(t,n){var e,r,i,o,a,s,u,l,c,d=t;return ie().getNumber("WEBGL_VERSION")===2?(e=d.R32F,r=d.R16F,i=d.RGBA16F,o=d.RGBA32F,a=d.RED,s=4,u=1,l=d.HALF_FLOAT,c=d.FLOAT):(e=t.RGBA,r=t.RGBA,i=t.RGBA,o=d.RGBA,a=t.RGBA,s=4,u=4,l=n!=null?n.HALF_FLOAT_OES:null,c=t.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function ke(t,n,e){var r=e();return n&&function(i){var o=i.getError();if(o!==i.NO_ERROR)throw new Error("WebGL Error: "+fM(i,o))}(t),r}(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Mf||(Mf={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(qr||(qr={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Wr||(Wr={}));var i7=596e-10,o7=65504;function dM(t){return!!(ie().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||i7<Math.abs(t)&&Math.abs(t)<o7)}function fM(t,n){switch(n){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+n}}function cm(t,n,e){return ua(t,n,function(){return t.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function pM(t,n,e){var r=ua(t,n,function(){return t.createShader(t.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ke(t,n,function(){return t.shaderSource(r,e)}),ke(t,n,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function hM(t,n,e){var r=ua(t,n,function(){return t.createShader(t.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ke(t,n,function(){return t.shaderSource(r,e)}),ke(t,n,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw function(i,o){var a=a7.exec(o);if(a==null)return console.log("Couldn't parse line number in error: "+o),void console.log(i);for(var s=+a[1],u=i.split(`
`),l=u.length.toString().length+2,c=u.map(function(g,m){return Zs((m+1).toString(),l)+g}),d=0,f=0;f<c.length;f++)d=Math.max(c[f].length,d);var p=c.slice(0,s-1),h=c.slice(s-1,s),v=c.slice(s);console.log(p.join(`
`)),console.log(o.split(`
`)[0]),console.log("%c "+Zs(h[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(v.join(`
`))}(e,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var dm,fm,a7=/ERROR: [0-9]+:([0-9]+):/g;function mM(t,n){return ua(t,n,function(){return t.createProgram()},"Unable to create WebGLProgram.")}function vM(t,n,e){if(ke(t,n,function(){return t.linkProgram(e)}),t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function pm(t,n,e){if(ke(t,n,function(){return t.validateProgram(e)}),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function gM(t,n,e){var r=ua(t,n,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return ke(t,n,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),ke(t,n,function(){return t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)}),r}function yM(t,n,e){var r=ua(t,n,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return ke(t,n,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)}),ke(t,n,function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)}),r}function bM(t,n){return ua(t,n,function(){return t.createTexture()},"Unable to create WebGLTexture.")}function wM(t,n){var e=ie().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||n<=0){var r="["+t+"x"+n+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>e||n>e)throw r="["+t+"x"+n+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+e+"x"+e+"]")+".")}function xM(t,n){return ua(t,n,function(){return t.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function gw(t,n,e,r,i,o,a,s){var u=t.getAttribLocation(e,r);return u!==-1&&(ke(t,n,function(){return t.bindBuffer(t.ARRAY_BUFFER,i)}),ke(t,n,function(){return t.vertexAttribPointer(u,o,t.FLOAT,!1,a,s)}),ke(t,n,function(){return t.enableVertexAttribArray(u)}),!0)}function SM(t,n,e,r){NM(t,r),ke(t,n,function(){return t.activeTexture(t.TEXTURE0+r)}),ke(t,n,function(){return t.bindTexture(t.TEXTURE_2D,e)})}function EM(t,n,e,r){return ua(t,n,function(){return t.getUniformLocation(e,r)},'uniform "'+r+'" not present in program.')}function CM(t,n,e){return t.getUniformLocation(n,e)}function RM(t,n,e,r,i,o){ke(t,n,function(){return SM(t,n,r,o)}),ke(t,n,function(){return t.uniform1i(i,o)})}function hm(t,n,e,r){ke(t,n,function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)}),ke(t,n,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)})}function yw(t,n,e){ke(t,n,function(){return t.bindFramebuffer(t.FRAMEBUFFER,e)}),ke(t,n,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)})}function Md(t){var n=t.checkFramebufferStatus(t.FRAMEBUFFER);if(n!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+TM(t,n))}function TM(t,n){switch(n){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+n}}function ua(t,n,e,r){var i=ke(t,n,function(){return e()});if(i==null)throw new Error(r);return i}function NM(t,n){var e=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=n+t.TEXTURE0;if(r<t.TEXTURE0||r>e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+e+"]")+".")}function Pf(t,n){return n===void 0&&(n=2),Pe(t.slice(0,t.length-n))}function Lf(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function mm(t){var n=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(n=[Pf(t)].concat(Lf(t))),n}function kM(t,n){var e;n===void 0&&(n=!1);var r=ie().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n&&(r*=2,(t=t.map(function(l,c){return c>=t.length-2?GS(t[c]):t[c]})).length===1&&(t=[2,t[0]])),t.length!==2){var i=Aa(t);t=i.newShape}var o=Pe(t);if(t.length<=1&&o<=r)return[1,o];if(t.length===2&&t[0]<=r&&t[1]<=r)return t;if(t.length===3&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(t.length===3&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(t.length===4&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(t.length===4&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(n){var a=Pf(t),s=2,u=2;return t.length&&(s=(e=Lf(t))[0],u=e[1]),cv(o=a*(s/2)*(u/2)).map(function(l){return 2*l})}return cv(o)}function yh(t){return t%2==0}function Pd(t,n){if(Bn(t=t.slice(-2),n=n.slice(-2))||!t.length||!n.length||t[0]===0||t[1]===0||n[0]===0||n[1]===0)return!0;if(t.length!==n.length){var e=t.slice(-1)[0],r=n.slice(-1)[0];if(e===r||yh(e)&&yh(r)&&(t[0]===1||n[0]===1))return!0}return t[1]===n[1]&&yh(t[0])&&yh(n[0])}function IM(t){if(dm==null){var n=Co(t);dm=n.getParameter(n.MAX_TEXTURE_SIZE)}return dm}function _M(t){if(fm==null){var n=Co(t);fm=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,fm)}function AM(t){if(t===0)return 0;var n=Co(t);return Mi(n,"EXT_disjoint_timer_query_webgl2")&&t===2?2:Mi(n,"EXT_disjoint_timer_query")?1:0}function Mi(t,n){return t.getExtension(n)!=null}function bw(t){try{if(Co(t)!=null)return!0}catch{return!1}return!1}function OM(t){if(t===0)return!1;var n=Co(t);if(t===1){if(!Mi(n,"OES_texture_float"))return!1}else if(!Mi(n,"EXT_color_buffer_float"))return!1;return ww(n)}function DM(t){if(t===0)return!1;var n=Co(t);if(t!==1){if(Mi(n,"EXT_color_buffer_float"))return ww(n);if(Mi(n,"EXT_color_buffer_half_float")){var e=n.getExtension("EXT_color_buffer_half_float");return function(r,i){var o=QS(r,i),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,o.internalFormatHalfFloat,1,1,0,o.textureFormatFloat,o.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(n,e)}return!1}return!!Mi(n,"OES_texture_float")&&!!Mi(n,"WEBGL_color_buffer_float")&&ww(n)}function ww(t){var n=QS(t),e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatFloat,1,1,0,n.textureFormatFloat,n.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(e),t.deleteFramebuffer(r),i}function MM(t){return t===2&&Co(t).fenceSync!=null}var s7=Object.freeze({callAndCheck:ke,canBeRepresented:dM,getWebGLErrorMessage:fM,getExtensionOrThrow:cm,createVertexShader:pM,createFragmentShader:hM,createProgram:mM,linkProgram:vM,validateProgram:pm,createStaticVertexBuffer:gM,createStaticIndexBuffer:yM,getNumChannels:function(){return ie().getNumber("WEBGL_VERSION")===2?1:4},createTexture:bM,validateTextureSize:wM,createFramebuffer:xM,bindVertexBufferToProgramAttribute:gw,bindTextureUnit:SM,unbindTextureUnit:function(t,n,e){NM(t,e),ke(t,n,function(){return t.activeTexture(t.TEXTURE0+e)}),ke(t,n,function(){return t.bindTexture(t.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:EM,getProgramUniformLocation:CM,bindTextureToProgramUniformSampler:RM,bindCanvasToFramebuffer:function(t,n){ke(t,n,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),ke(t,n,function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)}),ke(t,n,function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)})},bindColorTextureToFramebuffer:hm,unbindColorTextureFromFramebuffer:yw,validateFramebuffer:Md,getFramebufferErrorMessage:TM,getBatchDim:Pf,getRowsCols:Lf,getShapeAs3D:mm,getTextureShapeFromLogicalShape:kM,isReshapeFree:Pd,getWebGLMaxTextureSize:IM,resetMaxTextureSize:function(){dm=null},resetMaxTexturesInShader:function(){fm=null},getMaxTexturesInShader:_M,getWebGLDisjointQueryTimerVersion:AM,hasExtension:Mi,isWebGLVersionEnabled:bw,isCapableOfRenderingToFloatTexture:OM,isDownloadFloatTextureEnabled:DM,isWebGLFenceEnabled:MM}),$e=ie();function u7(){ie().set("PROD",!0)}function l7(){ie().set("DEBUG",!0)}function c7(){ie().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function yg(t){ie().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function d7(){K.disposeVariables()}function f7(){return K}function fv(){return K.memory()}function p7(t){return K.profile(t)}function ee(t,n){return K.tidy(t,n)}function Ze(t){JS(t).forEach(function(n){return n.dispose()})}function wo(t){return K.keep(t)}function h7(t){return K.time(t)}function m7(t){return K.setBackend(t)}function v7(){return K.ready()}function g7(){return K.backendName}function y7(t){K.removeBackend(t)}function b7(t){return K.findBackend(t)}function w7(t){return K.findBackendFactory(t)}function x7(t,n,e){return e===void 0&&(e=1),K.registerBackend(t,n,e)}function PM(){return K.backend}function S7(t,n){ie().setPlatform(t,n)}function xw(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];ie().getBool("IS_TEST")||console.warn.apply(console,t)}function xo(t,n){var e=t;if(Kn(t))return n==="string"?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(e)||Kn(e)&&n!=="string";)r.push(e.length),e=e[0];return Array.isArray(t)&&ie().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function i(o,a,s){if(s=s||[],!Array.isArray(o)&&!Kn(o))return void U(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});U(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+o.length+" elements"}),U(o.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+o.length+" elements"});for(var u=a.slice(1),l=0;l<o.length;++l)i(o[l],u,s.concat(l))}(t,r,[]),r}function FN(t,n,e,r){if(t!=null&&(t!=="numeric"&&t!==n||t==="numeric"&&n==="string"))throw new Error("Argument '"+e+"' passed to '"+r+"' must be "+t+" tensor, but got "+n+" tensor")}function V(t,n,e,r){if(r===void 0&&(r="numeric"),t instanceof At)return FN(r,t.dtype,n,e),t;var i=Cc(t);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),FN(r,i,n,e),t==null||!Kn(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){var o=t==null?"null":t.constructor.name;throw new Error("Argument '"+n+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+o+"'")}var a=xo(t,i);Kn(t)||Array.isArray(t)||(t=[t]);var s=i!=="string"?KS(t,i,ie().getBool("DEBUG")):na(t,[],!0);return K.makeTensor(s,a,i)}function Ff(t,n,e,r){if(r===void 0&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+n+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return t.map(function(i,o){return V(i,n+"["+o+"]",e)},r)}function ZS(t,n){for(var e=0;e<t.length;++e)if(t[t.length-e-1]!==n-1-e)return!1;return!0}function LM(t,n,e){for(var r=t.length+n.length,i=[],o=0,a=0,s=0;s<r;s++)e.indexOf(s)===-1?i.push(t[o++]):i.push(n[a++]);return i}function Gn(t,n){for(var e=[],r=t.length,i=0;i<r;i++)n.indexOf(i)===-1&&e.push(t[i]);return[e,n.map(function(o){return t[o]})]}function ei(t,n){return LM(t,n.map(function(e){return 1}),n)}function Nr(t,n,e){U(ZS(n,e),function(){return t+" supports only inner-most axes for now. Got axes "+n+" and rank-"+e+" input."})}function Gi(t,n){if(ZS(t,n))return null;for(var e=[],r=0;r<n;++r)t.indexOf(r)===-1&&e.push(r);return t.forEach(function(i){return e.push(i)}),e}function bg(t){return t.map(function(n,e){return[e,n]}).sort(function(n,e){return n[1]-e[1]}).map(function(n){return n[0]})}function qi(t,n){for(var e=[],r=n-t;r<n;++r)e.push(r);return e}function FM(t,n){var e=t[0].length;t.forEach(function(i,o){U(i.length===e,function(){return"Error in concat"+e+"D: rank of tensors["+o+"] must be the same as the rank of the rest ("+e+")"})}),U(n>=0&&n<e,function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."});var r=t[0];t.forEach(function(i,o){for(var a=0;a<e;a++)U(a===n||i[a]===r[a],function(){return"Error in concat"+e+"D: Shape of tensors["+o+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."})})}function cu(t,n){for(var e=t[0].slice(),r=1;r<t.length;r++)e[n]+=t[r][n];return e}function X(t){var n=Object.keys(t);if(n.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+n.length+" keys.");var e=n[0],r=t[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var i=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];K.startScope(e);try{var s=r.apply(void 0,o);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),K.endScope(s),s}catch(u){throw K.endScope(null),u}};return Object.defineProperty(i,"name",{value:e,configurable:!0}),i}$e.registerFlag("HAS_WEBGL",function(){return $e.getNumber("WEBGL_VERSION")>0}),$e.registerFlag("WEBGL_VERSION",function(){return bw(2)?2:bw(1)?1:0}),$e.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return $e.get("WEBGL_VERSION")===2}),$e.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),$e.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),$e.registerFlag("WEBGL_PACK",function(){return $e.getBool("HAS_WEBGL")}),$e.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return $e.getBool("WEBGL_PACK")}),$e.registerFlag("WEBGL_PACK_CLIP",function(){return $e.getBool("WEBGL_PACK")}),$e.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),$e.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return $e.getBool("WEBGL_PACK")}),$e.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return $e.getBool("WEBGL_PACK")}),$e.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return $e.getBool("WEBGL_PACK")}),$e.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return $e.getBool("WEBGL_PACK")}),$e.registerFlag("WEBGL_PACK_REDUCE",function(){return $e.getBool("WEBGL_PACK")}),$e.registerFlag("WEBGL_LAZILY_UNPACK",function(){return $e.getBool("WEBGL_PACK")}),$e.registerFlag("WEBGL_CONV_IM2COL",function(){return $e.getBool("WEBGL_PACK")}),$e.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return IM($e.getNumber("WEBGL_VERSION"))}),$e.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return _M($e.getNumber("WEBGL_VERSION"))}),$e.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var t=$e.getNumber("WEBGL_VERSION");return t===0?0:AM(t)}),$e.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return $e.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t}),$e.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return OM($e.getNumber("WEBGL_VERSION"))}),$e.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!$e.getBool("WEBGL_FORCE_F16_TEXTURES")&&$e.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),$e.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return DM($e.getNumber("WEBGL_VERSION"))}),$e.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return MM($e.getNumber("WEBGL_VERSION"))}),$e.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return $e.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),aM=yg;var Nn=X({complex_:function(t,n){var e=V(t,"real","complex"),r=V(n,"imag","complex");return gt(e.shape,r.shape,"real and imag shapes, "+e.shape+" and "+r.shape+", must match in call to tf.complex()."),K.runKernelFunc(function(i){return i.complex(e,r)},{$real:e,$imag:r})}}),_r=X({real_:function(t){var n=V(t,"input","real");return K.runKernelFunc(function(e){return e.real(n)},{$input:n})}}),vi=X({imag_:function(t){var n=V(t,"input","imag");return K.runKernelFunc(function(e){return e.imag(n)},{$input:n})}});function mn(t,n,e){return gs(t,n,xo(t,e),e)}function gs(t,n,e,r){if(r==null&&(r=Cc(t)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Kn(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(n!=null){YS(n);var i=Pe(n),o=Pe(e);U(i===o,function(){return"Based on the provided shape, ["+n+"], the tensor should have "+i+" values but has "+o});for(var a=0;a<e.length;++a){var s=e[a],u=a!==e.length-1||s!==Pe(n.slice(a));U(e[a]===n[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+n+"). "})}}return Kn(t)||Array.isArray(t)||(t=[t]),n=n||e,t=r!=="string"?KS(t,r,ie().getBool("DEBUG")):na(t,[],!0),K.makeTensor(t,n,r)}function Ie(t,n){if((Kn(t)&&n!=="string"||Array.isArray(t))&&n!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(n==="string"&&Kn(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return gs(t,[],[],n)}function zr(t,n){Su(t);var e=xo(t,n);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return gs(t,null,e,n)}function Go(t,n,e){if(Su(t),n!=null&&n.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=xo(t,e);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&n==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return gs(t,n,r,e)}function eE(t,n,e){if(Su(t),n!=null&&n.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=xo(t,e);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&n==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return gs(t,n,r,e)}function Ta(t,n,e){if(Su(t),n!=null&&n.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=xo(t,e);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&n==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return gs(t,n,r,e)}function zM(t,n,e){if(Su(t),n!=null&&n.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=xo(t,e);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&n==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return gs(t,n,r,e)}function BM(t,n,e){if(Su(t),n!=null&&n.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=xo(t,e);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&n==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return gs(t,n=n||r,r,e)}function tE(t,n,e,r){return n===void 0&&(n=!0),K.makeVariable(t,n,e,r)}function Ro(t,n){if(n===void 0&&(n="float32"),n==="complex64"){var e=Ro(t,"float32"),r=_t(t,"float32");return Nn(e,r)}var i=XS(Pe(t),n);return K.makeTensor(i,t,n)}function _t(t,n){if(n===void 0&&(n="float32"),n==="complex64"){var e=_t(t,"float32"),r=_t(t,"float32");return Nn(e,r)}var i=Rc(Pe(t),n);return K.makeTensor(i,t,n)}function Tc(t,n,e){return K.runKernelFunc(function(r){return r.fill(t,n,e)},{})}function nE(t,n,e){if(e<=0)throw new Error("The number of values should be positive.");return K.runKernelFunc(function(r){return r.linspace(t,n,e)},{})}function wg(t,n,e,r){if(e===void 0&&(e=1),r===void 0&&(r="float32"),e===0)throw new Error("Cannot have a step of zero");if(t===n||t<n&&e<0||n<t&&e>1)return _t([0],r);var i=Rc(Math.abs(Math.ceil((n-t)/e)),r);n<t&&e===1&&(e=-1),i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+e;return zr(i,r)}var ti=X({onesLike_:function(t){var n=V(t,"x","onesLike");if(n.dtype==="complex64"){var e=ti(_r(n)),r=dt(vi(n));return Nn(e,r)}return K.runKernelFunc(function(i){return i.onesLike(n)},{$x:n},function(i,o){return{$x:function(){return dt(i)}}})}}),dt=X({zerosLike_:function(t){var n=V(t,"x","zerosLike");return K.runKernelFunc(function(e){return e.zerosLike(n)},{$x:n},function(e,r){return{$x:function(){return dt(e)}}})}}),lr=X({concat_:function(t,n){n===void 0&&(n=0),U(t.length>=1,function(){return"Pass at least one tensor to concat"});var e=Ff(t,"tensors","concat");e[0].dtype==="complex64"&&e.forEach(function(a){if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+a.dtype+". ")}),n=Vn(n,e[0].shape)[0];var r=cu(e.map(function(a){return a.shape}),n);if(Pe(r)===0)return mn([],r);if((e=e.filter(function(a){return a.size>0})).length===1)return e[0];var i=e.map(function(a){return a.shape});FM(i,n);var o=e;return K.runKernelFunc(function(a){return a.concat(e,n)},o,function(a){var s=i.map(function(u){return u[n]});return qo(a,s,n).map(function(u){return function(){return u}})})}}),rE=X({concat1d_:function(t){return lr(t,0)}}),iE=X({concat2d_:function(t,n){return lr(t,n)}}),oE=X({concat3d_:function(t,n){return lr(t,n)}}),aE=X({concat4d_:function(t,n){return lr(t,n)}}),qo=X({split_:function(t,n,e){e===void 0&&(e=0);var r,i=V(t,"x","split");return e=Vn(e,i.shape)[0],typeof n=="number"?(U(i.shape[e]%n==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(n).fill(i.shape[e]/n)):(U(i.shape[e]===n.reduce(function(o,a){return o+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=n),K.runKernelFunc(function(o){return o.split(i,r,e)},{$x:i},function(o){return{$x:function(){return lr(o,e)}}})}});function Eu(t,n){return t(n={exports:{}},n.exports),n.exports}var E7=Eu(function(t){(function(n,e,r){function i(s){var u,l=this,c=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var p=.02519603282416938*(u+=d.charCodeAt(f));p-=u=p>>>0,u=(p*=u)>>>0,u+=4294967296*(p-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function o(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new i(s),c=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,c&&(typeof c=="object"&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(0,t,!1)}),C7=Eu(function(t){(function(n,e,r){function i(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(0,t,!1)}),R7=Eu(function(t){(function(n,e,r){function i(s){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(0,t,!1)}),T7=Eu(function(t){(function(n,e,r){function i(s){var u=this;u.next=function(){var l,c,d=u.x,f=u.i;return l=d[f],c=(l^=l>>>7)^l<<24,c^=(l=d[f+1&7])^l>>>10,c^=(l=d[f+3&7])^l>>>3,c^=(l=d[f+4&7])^l<<7,l=d[f+7&7],c^=(l^=l<<13)^l<<9,d[f]=c,u.i=f+1&7,c},function(l,c){var d,f=[];if(c===(0|c))f[0]=c;else for(c=""+c,d=0;d<c.length;++d)f[7&d]=f[7&d]<<15^c.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],l.x=f,l.i=0,d=256;d>0;--d)l.next()}(u,s)}function o(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.x&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(0,t,!1)}),N7=Eu(function(t){(function(n,e,r){function i(s){var u=this;u.next=function(){var l,c,d=u.w,f=u.X,p=u.i;return u.w=d=d+1640531527|0,c=f[p+34&127],l=f[p=p+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=f[p]=c^l,u.i=p,c+(d^d>>>16)|0},function(l,c){var d,f,p,h,v,g=[],m=128;for(c===(0|c)?(f=c,c=null):(c+="\0",f=0,m=Math.max(m,c.length)),p=0,h=-32;h<m;++h)c&&(f^=c.charCodeAt((h+32)%c.length)),h===0&&(v=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,h>=0&&(v=v+1640531527|0,p=(d=g[127&h]^=f+v)==0?p+1:0);for(p>=128&&(g[127&(c&&c.length||0)]=-1),p=127,h=512;h>0;--h)f=g[p+34&127],d=g[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[p]=f^d;l.w=v,l.X=g,l.i=p}(u,s)}function o(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.X&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(0,t,!1)}),k7=Eu(function(t){(function(n,e,r){function i(s){var u=this,l="";u.next=function(){var d=u.b,f=u.c,p=u.d,h=u.a;return d=d<<25^d>>>7^f,f=f-p|0,p=p<<24^p>>>8^h,h=h-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-p|0,u.d=p<<16^f>>>16^h,u.a=h-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function o(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(0,t,!1)}),Ps=Eu(function(t){(function(n,e){var r,i=this,o=256,a=6,s="random",u=e.pow(o,a),l=e.pow(2,52),c=2*l,d=o-1;function f(m,y,b){var w=[],x=v(function S(k,N){var M,D=[],T=typeof k;if(N&&T=="object")for(M in k)try{D.push(S(k[M],N-1))}catch{}return D.length?D:T=="string"?k:k+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[m,g(n)]:m??function(){try{var S;return r&&(S=r.randomBytes)?S=S(o):(S=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(S)),g(S)}catch{var k=i.navigator,N=k&&k.plugins;return[+new Date,i,N,i.screen,g(n)]}}(),3),w),C=new p(w),E=function(){for(var S=C.g(a),k=u,N=0;S<l;)S=(S+N)*o,k*=o,N=C.g(1);for(;S>=c;)S/=2,k/=2,N>>>=1;return(S+N)/k};return E.int32=function(){return 0|C.g(4)},E.quick=function(){return C.g(4)/4294967296},E.double=E,v(g(C.S),n),(y.pass||b||function(S,k,N,M){return M&&(M.S&&h(M,C),S.state=function(){return h(C,{})}),N?(e[s]=S,k):S})(E,x,"global"in y?y.global:this==e,y.state)}function p(m){var y,b=m.length,w=this,x=0,C=w.i=w.j=0,E=w.S=[];for(b||(m=[b++]);x<o;)E[x]=x++;for(x=0;x<o;x++)E[x]=E[C=d&C+m[x%b]+(y=E[x])],E[C]=y;(w.g=function(S){for(var k,N=0,M=w.i,D=w.j,T=w.S;S--;)k=T[M=d&M+1],N=N*o+T[d&(T[M]=T[D=d&D+k])+(T[D]=k)];return w.i=M,w.j=D,N})(o)}function h(m,y){return y.i=m.i,y.j=m.j,y.S=m.S.slice(),y}function v(m,y){for(var b,w=m+"",x=0;x<w.length;)y[d&x]=d&(b^=19*y[d&x])+w.charCodeAt(x++);return g(y)}function g(m){return String.fromCharCode.apply(0,m)}if(e["seed"+s]=f,v(e.random(),n),t.exports){t.exports=f;try{r=require("crypto")}catch{}}})([],Math)});Ps.alea=E7,Ps.xor128=C7,Ps.xorwow=R7,Ps.xorshift7=T7,Ps.xor4096=N7,Ps.tychei=k7;var xg=Ps.alea,sE=function(){function t(n,e,r,i,o){this.mean=n,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=o||Math.random();this.random=xg(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var n=this.nextVal;return this.nextVal=NaN,n}for(var e,r,i=!1;!i;){var o=void 0,a=void 0,s=void 0;do s=(o=2*this.random()-1)*o+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*o*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(e)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(e)},t.prototype.convertValue=function(n){return this.dtype==null||this.dtype==="float32"?n:Math.round(n)},t.prototype.isValidTruncated=function(n){return n<=this.upper&&n>=this.lower},t}(),I7=function(){function t(n,e,r,i){this.alpha=n,this.beta=1/e,this.dtype=r;var o=i||Math.random();this.randu=xg(o.toString()),this.randn=new sE(0,1,r,!1,this.randu()),this.d=n<1?n+2/3:n-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var n,e,r,i,o,a;;){do i=this.randn.nextValue(),a=1+this.c*i;while(a<=0);if(a*=a*a,e=1-.331*(n=i*i)*n,r=.5*n+this.d*(1-a+Math.log(a)),(o=this.randu())<e||Math.log(o)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(n){return this.dtype==="float32"?n:Math.round(n)},t}(),_7=function(){function t(n,e,r,i){var o=this;if(n===void 0&&(n=0),e===void 0&&(e=1),this.canReturnFloat=function(){return o.dtype==null||o.dtype==="float32"},this.min=n,this.range=e-n,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+n+" - "+e+" <= 1 and dtype is not float");this.random=xg(i)}return t.prototype.convertValue=function(n){return this.canReturnFloat()?n:Math.round(n)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function He(t,n,e){return n===void 0&&(n="float32"),n=n||"float32",YS(t),new Ql(t,n,e)}function jM(t,n){n===void 0&&(n=!1),console.log(t.toString(n))}var Sg=X({batchToSpaceND_:function(t,n,e){var r=V(t,"x","batchToSpaceND"),i=n.reduce(function(o,a){return o*a});return U(r.rank>=1+n.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+n.length}),U(e.length===n.length,function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+n.length}),U(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+n.join(" * ")+" === "+i}),K.runKernelFunc(function(o){return o.batchToSpaceND(r,n,e)},{$x:r},function(o){return{$x:function(){return o.spaceToBatchND(n,e)}}})}}),Eg=X({cast_:function(t,n){var e=V(t,"x","cast");if(!ZD(n))throw new Error("Failed to cast to unknown dtype "+n);if(n==="string"&&e.dtype!=="string"||n!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:n};return K.runKernelFunc(function(i){return i.cast(e,n)},{x:e},function(i){return{x:function(){return i.clone()}}},"Cast",r)}}),VM=X({clone_:function(t){var n=V(t,"x","clone",null);return K.runKernelFunc(function(){return K.makeTensorFromDataId(n.dataId,n.shape,n.dtype)},{$x:n},function(e){return{$x:function(){return e.toFloat()}}})}}),$M=X({cumsum_:function(t,n,e,r){n===void 0&&(n=0),e===void 0&&(e=!1),r===void 0&&(r=!1);var i=V(t,"x","cumsum"),o=Gi([n|=0],i.rank),a=i;o!=null&&(a=i.transpose(o));var s=qi(1,i.rank)[0],u=K.runKernelFunc(function(l){return l.cumsum(a,s,e,r)},{permutedX:a},function(l){return{permutedX:function(){return l.cumsum(n,e,!r)}}});return o!=null&&(u=u.transpose(o)),u}}),uE=X({depthToSpace_:function(t,n,e){e===void 0&&(e="NHWC");var r=V(t,"x","depthToSpace"),i=e==="NHWC"?r.shape[1]:r.shape[2],o=e==="NHWC"?r.shape[2]:r.shape[3],a=e==="NHWC"?r.shape[3]:r.shape[1];return U(i*n>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+n+`  for depthToSpace with input shape
      `+r.shape}),U(o*n>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+n+` for depthToSpace with input shape
          `+r.shape}),U(a%(n*n)==0,function(){return"Dimension size must be evenly divisible by "+n*n+" but is "+a+" for depthToSpace with input shape "+r.shape}),K.runKernelFunc(function(s){return s.depthToSpace(r,n,e)},{$x:r})}}),Hr=X({expandDims_:function(t,n){n===void 0&&(n=0);var e=V(t,"x","expandDims",null);U(n<=e.rank,function(){return"Axis must be <= rank of the tensor"});var r=e.shape.slice();return n<0&&(U(-(e.rank+1)<=n,function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"}),n=e.rank+n+1),r.splice(n,0,1),op(e,r)}}),Cg=X({eye_:function(t,n,e,r){r===void 0&&(r="float32"),n==null&&(n=t);for(var i=He([t,n],r),o=t<=n?t:n,a=0;a<o;++a)i.set(1,a,a);var s=i.toTensor().as2D(t,n);if(e==null)return s;if(e.length===1)return Qa(Hr(s,0),[e[0],1,1]);if(e.length===2)return Qa(Hr(Hr(s,0),0),[e[0],e[1],1,1]);if(e.length===3)return Qa(Hr(Hr(Hr(s,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),lE=X({multinomial_:function(t,n,e,r){r===void 0&&(r=!1);var i=V(t,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);e=e||Math.random();var s=a===1?i.as2D(1,-1):i,u=K.runKernelFunc(function(l){return l.multinomial(s,r,n,e)},{logits2D:s});return a===1?u.as1D():u}}),Zl=X({oneHot_:function(t,n,e,r){if(e===void 0&&(e=1),r===void 0&&(r=0),n<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+n);var i=V(t,"indices","oneHot","int32"),o=i.shape.concat([n]);return i=i.flatten(),K.runKernelFunc(function(a){return a.oneHot(i,n,e,r)},{$indices:i},function(a){return{$indices:function(){return _t(i.shape,"float32")}}}).reshape(o)}}),ys=X({pad_:function(t,n,e){e===void 0&&(e=0);var r=V(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=n.map(function(o){return o[0]});return K.runKernelFunc(function(o){return o.pad(r,n,e)},{$x:r},function(o){return{$x:function(){return o.slice(i,r.shape)}}})}}),UM=X({pad1d_:function(t,n,e){return e===void 0&&(e=0),U(n.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),ys(t,[n],e)}}),WM=X({pad2d_:function(t,n,e){return e===void 0&&(e=0),U(n.length===2&&n[0].length===2&&n[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ys(t,n,e)}}),HM=X({pad3d_:function(t,n,e){return e===void 0&&(e=0),U(n.length===3&&n[0].length===2&&n[1].length===2&&n[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ys(t,n,e)}}),GM=X({pad4d_:function(t,n,e){return e===void 0&&(e=0),U(n.length===4&&n[0].length===2&&n[1].length===2&&n[2].length===2&&n[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),ys(t,n,e)}}),qM=X({rand_:function(t,n,e){var r=Pe(t),i=null;if(e==null||e==="float32")i=new Float32Array(r);else if(e==="int32")i=new Int32Array(r);else{if(e!=="bool")throw new Error("Unknown data type "+e);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=n();return K.makeTensor(i,t,e)}}),cE=X({randomNormal_:function(t,n,e,r,i){if(n===void 0&&(n=0),e===void 0&&(e=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new sE(n,e,r,!1,i),a=He(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),KM=X({randomGamma_:function(t,n,e,r,i){if(e===void 0&&(e=1),r===void 0&&(r="float32"),e==null&&(e=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var o=new I7(n,e,r,i),a=He(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Cu=X({randomUniform_:function(t,n,e,r,i){n===void 0&&(n=0),e===void 0&&(e=1),r===void 0&&(r="float32");for(var o=He(t,r),a=new _7(n,e,null,i),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),op=X({reshape_:function(t,n){var e=V(t,"x","reshape",null);n=JD(n,e.size),U(e.size===Pe(n),function(){return"new shape and old shape must have the same number of elements."});var r={shape:n};return K.runKernelFunc(function(i){return i.reshape(e,n)},{x:e},function(i){return{x:function(){return i.reshape(e.shape)}}},"Reshape",r)}}),Rg=X({spaceToBatchND_:function(t,n,e){var r=V(t,"x","spaceToBatchND");return U(r.rank>=1+n.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+n.length}),U(e.length===n.length,function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+n.length}),U(r.shape.reduce(function(i,o,a){return a>0&&a<=n.length?i&&(o+e[a-1][0]+e[a-1][1])%n[a-1]==0:i},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+n.toString()}),K.runKernelFunc(function(i){return i.spaceToBatchND(r,n,e)},{$x:r},function(i){return{$x:function(){return i.batchToSpaceND(n,e)}}})}}),ap=X({squeeze_:function(t,n){var e=V(t,"x","squeeze");return op(e,Aa(e.shape,n).newShape)}}),$i=X({stack_:function(t,n){n===void 0&&(n=0);var e=Ff(t,"tensors","stack");if(U(e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),e.length===1)return e[0].expandDims(n);var r=e[0].rank,i=e[0].shape,o=e[0].dtype;U(n<=r,function(){return"Axis must be <= rank of the tensor"}),e.forEach(function(s){gt(i,s.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(s){U(o===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=e.map(function(s){return s.expandDims(n)});return lr(a,n)}}),Qa=X({tile_:function(t,n){var e=V(t,"x","tile",null);return U(e.rank===n.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+n+"."}),K.runKernelFunc(function(r,i){var o=r.tile(e,n);return i([e]),o},{$x:e},function(r,i){var o=i[0];return{$x:function(){var a=dt(o);if(o.rank===1)for(var s=0;s<n[0];++s)a=a.add(r.slice([s*o.shape[0]],[o.shape[0]]));else if(o.rank===2)for(s=0;s<n[0];++s)for(var u=0;u<n[1];++u)a=a.add(r.slice([s*o.shape[0],u*o.shape[1]],[o.shape[0],o.shape[1]]));else if(o.rank===3)for(s=0;s<n[0];++s)for(u=0;u<n[1];++u)for(var l=0;l<n[2];++l)a=a.add(r.slice([s*o.shape[0],u*o.shape[1],l*o.shape[2]],[o.shape[0],o.shape[1],o.shape[2]]));else{if(o.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+o.rank+" tensors yet.");for(s=0;s<n[0];++s)for(u=0;u<n[1];++u)for(l=0;l<n[2];++l)for(var c=0;c<n[3];++c)a=a.add(r.slice([s*o.shape[0],u*o.shape[1],l*o.shape[2],c*o.shape[3]],[o.shape[0],o.shape[1],o.shape[2],o.shape[3]]))}return a}}})}}),sp=X({truncatedNormal_:function(t,n,e,r,i){if(n===void 0&&(n=0),e===void 0&&(e=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var o=new sE(n,e,r,!0,i),a=He(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),du=X({unstack_:function(t,n){n===void 0&&(n=0),n=n||0;var e=V(t,"x","unstack");return U(n>=-e.shape.length&&n<e.shape.length,function(){return"Axis = "+n+" is not in [-"+e.shape.length+", "+e.shape.length+")"}),n<0&&(n+=e.shape.length),K.runKernelFunc(function(r){return r.unstack(e,n)},{$x:e},function(r){return{$x:function(){return $i(r,n)}}})}}),dE=function(t,n){return Oe(this,void 0,void 0,function(){var e,r,i,o,a,s,u,l,c,d;return De(this,function(f){switch(f.label){case 0:return e=V(t,"x","setdiff1d"),r=V(n,"y","setdiff1d"),U(e.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+r.dtype+")."}),U(e.rank===1,function(){return"x should be 1D tensor, but got x ("+e.shape+")."}),U(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,e.data()];case 1:return i=f.sent(),[4,r.data()];case 2:for(o=f.sent(),a=new Set(o),s=0,c=0;c<i.length;c++)a.has(i[c])||s++;for(u=new Ql([s],e.dtype),l=new Ql([s],"int32"),c=0,d=0;c<i.length;c++)a.has(i[c])||(u.values[d]=i[c],l.values[d]=c,d++);return[2,[u.toTensor(),l.toTensor()]]}})})};function pv(t,n,e,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(n.slice(0))).push(t[0]/e),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var o=n.length,a=0;a<o;++a)i=i.concat([t[a+1]/n[a],n[a]]);i=i.concat(t.slice(o+1))}return i}function hv(t,n,e){e===void 0&&(e=!0);var r=[];if(e){r.push(n);for(var i=n+1;i<t;++i)i<=2*n?(r.push(i),r.push(i-(n+1))):r.push(i)}else{var o=[],a=[];for(i=1;i<t;++i)i>=2*n+1||i%2==1?a.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,a)}return r}function mv(t,n,e,r){r===void 0&&(r=!0);var i=[];r?i.push(t[0]/e):i.push(t[0]*e);for(var o=1;o<t.length;++o)o<=n.length?r?i.push(n[o-1]*t[o]):i.push(t[o]/n[o-1]):i.push(t[o]);return i}function XM(t,n){for(var e=[0],r=0;r<n;++r)e.push(t[r][0]);return e}function YM(t,n,e){for(var r=t.slice(0,1),i=0;i<e;++i)r.push(t[i+1]-n[i][0]-n[i][1]);return r}function JM(t,n){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(n.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+n.rank+".");if(n.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+n.dtype+".");if(n.shape[n.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+n.shape[n.rank-1]+" vs. "+t.rank);if(t.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var e=n.shape,r=e[e.length-1],i=1,o=0;o<e.length-1;++o)i*=e[o];var a=t.shape,s=e.slice();s.pop();var u=1;for(o=r;o<t.rank;++o)u*=a[o],s.push(a[o]);var l=vs(t.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,i,u,l]}var QM=30;function J0(t){return t<=QM?t:dv(t,Math.floor(Math.sqrt(t)))}function A7(t,n,e){if(n.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+n.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if(n.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+n.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(e.length===0){if(n.size===0)throw new Error("Indices specified for empty output. indices shape: "+n.shape);if(t.size===0)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}(function(r,i,o){var a=i.rank>1?i.shape[i.rank-1]:1,s=i.rank>1?i.rank-1:1,u="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+o.shape+", indices.shape: "+i.shape+", shape: "+r+", sliceDim: "+a+", and batchDim: "+s+".";if(o.rank<s)throw new Error(u+" update.rank < "+s+". ");if(r.length<a+(o.rank-s))throw new Error(u+" Output shape length < "+(a+(o.rank-s)));if(o.rank!==s+r.length-a)throw new Error(u+" update.rank != "+(s+r.length-a));for(var l=0;l<s;++l)if(o.shape[l]!==i.shape[l])throw new Error(u+" updates.shape["+l+"] ("+o.shape[l]+") != indices.shape["+l+"] ("+i.shape[l]+").");for(l=0;l<o.rank-s;++l)if(o.shape[l+s]!==r[l+a])throw new Error(u+" updates.shape["+(l+s)+"] ("+o.shape[l+s]+") != shape["+(l+s)+"] ("+r[l+s]+")")})(e,n,t)}function vv(t,n,e){for(var r=n.rank>1?n.shape[n.rank-1]:1,i=e.length,o=1,a=r;a<i;++a)o*=e[a];var s=r<1?1:r;return{sliceRank:r,numUpdates:n.size/s,sliceSize:o,strides:vs(e.slice(0,r)).concat([1]),outputSize:Pe(e)}}function ZM(t,n,e){U(t.rank===n.length,function(){return"Error in slice"+t.rank+"D: Length of begin "+n+" must match the rank of the array ("+t.rank+")."}),U(t.rank===e.length,function(){return"Error in slice"+t.rank+"D: Length of size "+e+" must match the rank of the array ("+t.rank+")."});for(var r=function(o){U(n[o]+e[o]<=t.shape[o],function(){return"Error in slice"+t.rank+"D: begin["+o+"] + size["+o+"] ("+(n[o]+e[o])+") would overflow input.shape["+o+"] ("+t.shape[o]+")"})},i=0;i<t.rank;++i)r(i)}function Sw(t){for(var n=[],e=0;t>0;)1&t&&n.push(e),t/=2,e++;return n}function Tg(t,n,e){for(var r=[],i=0;i<t.length;i++)r[i]=Math.ceil((n[i]-t[i])/e[i]);return r}function eP(t,n,e,r,i){var o=n[i],a=e[i]||1;(t&1<<i||o==null)&&(o=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),o=lv(0,o,s-1)}function tP(t,n,e,r,i){var o=n[i],a=e[i]||1;(t&1<<i||o==null)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),o=a>0?lv(0,o,s):lv(-1,o,s-1)}function fE(t,n,e){for(var r=e.length,i=0;i<e.length;i++)if(e[i]>1){r=i;break}for(i=r+1;i<e.length;i++)if(n[i]>0||e[i]!==t[i])return!1;return!0}function pE(t,n){for(var e=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)e+=t[r]*n[r];return e}var O7=Object.freeze({assertParamsValid:ZM,maskToAxes:Sw,computeOutShape:Tg,startForAxis:eP,stopForAxis:tP,isSliceContinous:fE,computeFlatOffset:pE});function D7(t){return U(as(t),function(){return"The f passed in grad(f) must be a function"}),function(n,e){var r=V(n,"x","tf.grad",null),i=e!=null?V(e,"dy","tf.grad"):null;return K.tidy(function(){var o=K.gradients(function(){return t(r)},[r],i),a=o.value,s=o.grads;return i!=null&&gt(a.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Ng(s),s[0]})}}function M7(t){return U(as(t),function(){return"The f passed in grads(f) must be a function"}),function(n,e){U(Array.isArray(n),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var r=Ff(n,"args","tf.grads",null),i=e!=null?V(e,"dy","tf.grads"):null;return K.tidy(function(){var o=K.gradients(function(){return t.apply(void 0,r)},r,i),a=o.value,s=o.grads;return i!=null&&gt(a.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Ng(s),s})}}function P7(t){return U(as(t),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(n,e){U(n instanceof At,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),U(e==null||e instanceof At,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var r=K.gradients(function(){return t(n)},[n],e),i=r.grads,o=r.value;return Ng(i),{grad:i[0],value:o}}}function L7(t){return U(as(t),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(n,e){U(Array.isArray(n)&&n.every(function(i){return i instanceof At}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),U(e==null||e instanceof At,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var r=K.gradients(function(){return t.apply(void 0,n)},n,e);return e!=null&&gt(r.value.shape,e.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Ng(r.grads),r}}function nP(t,n){U(as(t),function(){return"The f passed in variableGrads(f) must be a function"}),U(n==null||Array.isArray(n)&&n.every(function(c){return c instanceof Df}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var e=n!=null;if(!e)for(var r in n=[],K.registeredVariables)n.push(K.registeredVariables[r]);var i=e?n.filter(function(c){return!c.trainable}):null,o=n.length;U((n=n.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."});var a=K.gradients(t,n,null,!0),s=a.value,u=a.grads;U(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),U(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return n.forEach(function(c,d){u[d]!=null&&(l[c.name]=u[d])}),i!=null&&i.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function Nc(t){return K.customGrad(t)}function Ng(t){if(t.filter(function(n){return n==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var Ru=X({softmax_:function(t,n){n===void 0&&(n=-1);var e=V(t,"logits","softmax");if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+n);return Nc(function(r,i){var o=r.logSumExp([n],!0),a=r.toFloat().sub(o).exp();return i([a]),{value:a,gradFunc:function(s,u){var l=u[0],c=s.mul(l);return c.sub(c.sum([n],!0).mul(l))}}})(e)}}),kg=X({logSoftmax_:function(t,n){n===void 0&&(n=-1);var e=V(t,"logits","logSoftmax");if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+n);return Nc(function(r,i){var o=r.max(n,!0),a=r.sub(o),s=a.toFloat().sub(a.exp().sum(n,!0).log());return i([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(n,!0).mul(c))}}})(e)}}),hE=function(){function t(n,e){this.backend=n,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(n){return this.data.has(n)||this.dataMover.moveData(this.backend,n),this.data.get(n)},t.prototype.set=function(n,e){this.dataIdsCount++,this.data.set(n,e)},t.prototype.has=function(n){return this.data.has(n)},t.prototype.delete=function(n){return this.dataIdsCount--,this.data.delete(n)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),mE=function(){function t(){}return t.prototype.time=function(n){return te()},t.prototype.read=function(n){return te()},t.prototype.readSync=function(n){return te()},t.prototype.numDataIds=function(){return te()},t.prototype.disposeData=function(n){return te()},t.prototype.fromPixels=function(n,e){return te()},t.prototype.write=function(n,e,r){return te()},t.prototype.move=function(n,e,r,i){return te()},t.prototype.memory=function(){return te()},t.prototype.floatPrecision=function(){return te()},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.batchMatMul=function(n,e,r,i){return te()},t.prototype.fusedBatchMatMul=function(n){return n.a,n.b,n.transposeA,n.transposeB,n.bias,n.activation,n.preluActivationWeights,te()},t.prototype.slice=function(n,e,r){return te()},t.prototype.stridedSlice=function(n,e,r,i){return te()},t.prototype.unstack=function(n,e){return te()},t.prototype.reverse=function(n,e){return te()},t.prototype.concat=function(n,e){return te()},t.prototype.neg=function(n){return te()},t.prototype.add=function(n,e){return te()},t.prototype.addN=function(n){return te()},t.prototype.subtract=function(n,e){return te()},t.prototype.multiply=function(n,e){return te()},t.prototype.realDivide=function(n,e){return te()},t.prototype.floorDiv=function(n,e){return te()},t.prototype.sum=function(n,e){return te()},t.prototype.prod=function(n,e){return te()},t.prototype.unsortedSegmentSum=function(n,e,r){return te()},t.prototype.argMin=function(n,e){return te()},t.prototype.argMax=function(n,e){return te()},t.prototype.equal=function(n,e){return te()},t.prototype.notEqual=function(n,e){return te()},t.prototype.less=function(n,e){return te()},t.prototype.lessEqual=function(n,e){return te()},t.prototype.greater=function(n,e){return te()},t.prototype.greaterEqual=function(n,e){return te()},t.prototype.logicalNot=function(n){return te()},t.prototype.logicalAnd=function(n,e){return te()},t.prototype.logicalOr=function(n,e){return te()},t.prototype.where=function(n){return te()},t.prototype.select=function(n,e,r){return te()},t.prototype.topk=function(n,e,r){return te()},t.prototype.min=function(n,e){return te()},t.prototype.minimum=function(n,e){return te()},t.prototype.mod=function(n,e){return te()},t.prototype.max=function(n,e){return te()},t.prototype.maximum=function(n,e){return te()},t.prototype.all=function(n,e){return te()},t.prototype.any=function(n,e){return te()},t.prototype.squaredDifference=function(n,e){return te()},t.prototype.ceil=function(n){return te()},t.prototype.floor=function(n){return te()},t.prototype.round=function(n){return te()},t.prototype.sign=function(n){return te()},t.prototype.isNaN=function(n){return te()},t.prototype.isInf=function(n){return te()},t.prototype.isFinite=function(n){return te()},t.prototype.pow=function(n,e){return te()},t.prototype.exp=function(n){return te()},t.prototype.expm1=function(n){return te()},t.prototype.log=function(n){return te()},t.prototype.log1p=function(n){return te()},t.prototype.sqrt=function(n){return te()},t.prototype.rsqrt=function(n){return te()},t.prototype.square=function(n){return te()},t.prototype.reciprocal=function(n){return te()},t.prototype.relu=function(n){return te()},t.prototype.relu6=function(n){return te()},t.prototype.prelu=function(n,e){return te()},t.prototype.elu=function(n){return te()},t.prototype.eluDer=function(n,e){return te()},t.prototype.selu=function(n){return te()},t.prototype.int=function(n){return te()},t.prototype.clip=function(n,e,r){return te()},t.prototype.abs=function(n){return te()},t.prototype.complexAbs=function(n){return te()},t.prototype.sigmoid=function(n){return te()},t.prototype.softplus=function(n){return te()},t.prototype.sin=function(n){return te()},t.prototype.cos=function(n){return te()},t.prototype.tan=function(n){return te()},t.prototype.asin=function(n){return te()},t.prototype.acos=function(n){return te()},t.prototype.atan=function(n){return te()},t.prototype.atan2=function(n,e){return te()},t.prototype.sinh=function(n){return te()},t.prototype.cosh=function(n){return te()},t.prototype.tanh=function(n){return te()},t.prototype.asinh=function(n){return te()},t.prototype.acosh=function(n){return te()},t.prototype.atanh=function(n){return te()},t.prototype.erf=function(n){return te()},t.prototype.step=function(n,e){return te()},t.prototype.fusedConv2d=function(n){return n.input,n.filter,n.convInfo,n.bias,n.activation,n.preluActivationWeights,te()},t.prototype.conv2d=function(n,e,r){return te()},t.prototype.conv2dDerInput=function(n,e,r){return te()},t.prototype.conv2dDerFilter=function(n,e,r){return te()},t.prototype.fusedDepthwiseConv2D=function(n){return n.input,n.filter,n.convInfo,n.bias,n.activation,n.preluActivationWeights,te()},t.prototype.depthwiseConv2D=function(n,e,r){return te()},t.prototype.depthwiseConv2DDerInput=function(n,e,r){return te()},t.prototype.depthwiseConv2DDerFilter=function(n,e,r){return te()},t.prototype.conv3d=function(n,e,r){return te()},t.prototype.conv3dDerInput=function(n,e,r){return te()},t.prototype.conv3dDerFilter=function(n,e,r){return te()},t.prototype.maxPool=function(n,e){return te()},t.prototype.maxPoolBackprop=function(n,e,r,i){return te()},t.prototype.avgPool=function(n,e){return te()},t.prototype.avgPoolBackprop=function(n,e,r){return te()},t.prototype.avgPool3d=function(n,e){return te()},t.prototype.avgPool3dBackprop=function(n,e,r){return te()},t.prototype.maxPool3d=function(n,e){return te()},t.prototype.maxPool3dBackprop=function(n,e,r,i){return te()},t.prototype.reshape=function(n,e){return te()},t.prototype.cast=function(n,e){return te()},t.prototype.tile=function(n,e){return te()},t.prototype.pad=function(n,e,r){return te()},t.prototype.transpose=function(n,e){return te()},t.prototype.gather=function(n,e,r){return te()},t.prototype.gatherND=function(n,e){return te()},t.prototype.scatterND=function(n,e,r){return te()},t.prototype.batchToSpaceND=function(n,e,r){return te()},t.prototype.spaceToBatchND=function(n,e,r){return te()},t.prototype.resizeBilinear=function(n,e,r,i){return te()},t.prototype.resizeBilinearBackprop=function(n,e,r){return te()},t.prototype.resizeNearestNeighbor=function(n,e,r,i){return te()},t.prototype.resizeNearestNeighborBackprop=function(n,e,r){return te()},t.prototype.batchNormalization=function(n,e,r,i,o,a){return te()},t.prototype.localResponseNormalization4D=function(n,e,r,i,o){return te()},t.prototype.LRNGrad=function(n,e,r,i,o,a,s){return te()},t.prototype.multinomial=function(n,e,r,i){return te()},t.prototype.oneHot=function(n,e,r,i){return te()},t.prototype.cumsum=function(n,e,r,i){return te()},t.prototype.nonMaxSuppression=function(n,e,r,i,o){return te()},t.prototype.fft=function(n){return te()},t.prototype.ifft=function(n){return te()},t.prototype.complex=function(n,e){return te()},t.prototype.real=function(n){return te()},t.prototype.imag=function(n){return te()},t.prototype.cropAndResize=function(n,e,r,i,o,a){return te()},t.prototype.depthToSpace=function(n,e,r){return te()},t.prototype.split=function(n,e,r){return te()},t.prototype.sparseToDense=function(n,e,r,i){return te()},t.prototype.diag=function(n){return te()},t.prototype.fill=function(n,e,r){throw new Error("Not yet implemented.")},t.prototype.onesLike=function(n){return te()},t.prototype.zerosLike=function(n){return te()},t.prototype.linspace=function(n,e,r){return te()},t.prototype.dispose=function(){return te()},t}();function te(){throw new Error("Not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Hs(t,n){for(var e=t.length,r=[],i=0;i<e;i++){var o=e-1-i,a=t[o]||1;(n[n.length-1-i]||1)>1&&a===1&&r.unshift(o)}return r}function Rn(t,n){for(var e=[],r=0;r<n.length;r++){var i=t[t.length-r-1],o=n.length-r-1,a=n[o];(i==null||i===1&&a>1)&&e.unshift(o)}return e}function lt(t,n){for(var e=[],r=Math.max(t.length,n.length),i=0;i<r;i++){var o=t[t.length-i-1];o==null&&(o=1);var a=n[n.length-i-1];if(a==null&&(a=1),o===1)e.unshift(a);else if(a===1)e.unshift(o);else{if(o!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+n+".");e.unshift(o)}}return e}function ec(t,n,e,r,i,o,a){a===void 0&&(a="channelsLast");var s,u=gv(n),l=u[0],c=u[1];if(a==="channelsLast")s=[l,c,t[3],t[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[l,c,t[1],t[1]]}return bs(t,s,e,r,i,o,!1,a)}function zf(t,n,e,r,i,o,a){a===void 0&&(a="NDHWC");var s,u,l=Ew(n),c=l[0],d=l[1],f=l[2];if(a==="NDHWC")u="channelsLast",s=[c,d,f,t[4],t[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,d,f,t[1],t[1]]}return Bf(t,s,e,r,i,!1,u,o)}function bs(t,n,e,r,i,o,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3];if(s==="channelsLast")l=t[0],c=t[1],d=t[2],f=t[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=t[0],f=t[1],c=t[2],d=t[3]}var p,h=n[0],v=n[1],g=n[3],m=gv(e),y=m[0],b=m[1],w=gv(r),x=w[0],C=w[1],E=Ol(h,x),S=Ol(v,C),k=function(O,P,A,I,_,F,L,H){var B,q,G;if(typeof O=="number"){var re=O===0?"VALID":"NUMBER";B={top:O,bottom:O,left:O,right:O,type:re};var j=function(de,Z,ge,be,fe){be==null&&(be=vE(de,Z,ge));var On=de[0],pn=de[1],Me=Zd((On-Z+2*be)/ge+1,fe);U(rn(Me),function(){return"The output # of rows ("+Me+") must be an integer. Change the stride and/or zero pad parameters"});var tt=Zd((pn-Z+2*be)/ge+1,fe);return U(rn(tt),function(){return"The output # of columns ("+tt+") must be an integer. Change the stride and/or zero pad parameters"}),[Me,tt]}([P,A],F,I,O,H);q=j[0],G=j[1]}else if(O==="same"){q=Math.ceil(P/I),G=Math.ceil(A/_);var ae=Math.max(0,(q-1)*I+F-P),ne=Math.max(0,(G-1)*_+L-A),le=Math.floor(ae/2),xe=ae-le,se=Math.floor(ne/2),we=ne-se;B={top:le,bottom:xe,left:se,right:we,type:"SAME"}}else{if(O!=="valid")throw Error("Unknown padding parameter: "+O);B={top:0,bottom:0,left:0,right:0,type:"VALID"},q=Math.ceil((P-F+1)/I),G=Math.ceil((A-L+1)/_)}return{padInfo:B,outHeight:q,outWidth:G}}(i,c,d,y,b,E,S,o),N=k.padInfo,M=k.outHeight,D=k.outWidth,T=a?g*f:g;return s==="channelsFirst"?p=[l,T,M,D]:s==="channelsLast"&&(p=[l,M,D,T]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:d,inChannels:f,outHeight:M,outWidth:D,outChannels:T,padInfo:N,strideHeight:y,strideWidth:b,filterHeight:h,filterWidth:v,effectiveFilterHeight:E,effectiveFilterWidth:S,dilationHeight:x,dilationWidth:C,inShape:t,outShape:p,filterShape:n}}function Bf(t,n,e,r,i,o,a,s){o===void 0&&(o=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3],p=u[4];if(a==="channelsLast")l=t[0],c=t[1],d=t[2],f=t[3],p=t[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=t[0],p=t[1],c=t[2],d=t[3],f=t[4]}var h,v=n[0],g=n[1],m=n[2],y=n[4],b=Ew(e),w=b[0],x=b[1],C=b[2],E=Ew(r),S=E[0],k=E[1],N=E[2],M=Ol(v,S),D=Ol(g,k),T=Ol(m,N),O=function(L,H,B,q,G,re,j,ae,ne,le,xe){var se,we,de,Z;if(typeof L=="number"){var ge=L===0?"VALID":"NUMBER";se={top:L,bottom:L,left:L,right:L,front:L,back:L,type:ge};var be=function(rt,ot,Ge,Ct,_o,ui){_o==null&&(_o=vE(rt,ot,Ct));var ju=rt[0],qc=rt[1],Kc=rt[2],Q=Zd((ju-ot+2*_o)/Ct+1,ui);U(rn(Q),function(){return"The output # of depths ("+Q+") must be an integer. Change the stride and/or zero pad parameters"});var J=Zd((qc-ot+2*_o)/Ct+1,ui);U(rn(J),function(){return"The output # of rows ("+J+") must be an integer. Change the stride and/or zero pad parameters"});var me=Zd((Kc-ot+2*_o)/Ct+1,ui);return U(rn(me),function(){return"The output # of columns ("+me+") must be an integer. Change the stride and/or zero pad parameters"}),[Q,J,me,Ge]}([H,B,q,1],ae,1,G,L,xe);we=be[0],de=be[1],Z=be[2]}else if(L==="same"){we=Math.ceil(H/G),de=Math.ceil(B/re),Z=Math.ceil(q/j);var fe=(we-1)*G+ae-H,On=(de-1)*re+ne-B,pn=(Z-1)*j+le-q,Me=Math.floor(fe/2),tt=fe-Me,wt=Math.floor(On/2),Te=On-wt,nt=Math.floor(pn/2),Le=pn-nt;se={top:wt,bottom:Te,left:nt,right:Le,front:Me,back:tt,type:"SAME"}}else{if(L!=="valid")throw Error("Unknown padding parameter: "+L);se={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},we=Math.ceil((H-ae+1)/G),de=Math.ceil((B-ne+1)/re),Z=Math.ceil((q-le+1)/j)}return{padInfo:se,outDepth:we,outHeight:de,outWidth:Z}}(i,c,d,f,w,x,C,M,D,T,s),P=O.padInfo,A=O.outDepth,I=O.outHeight,_=O.outWidth,F=o?y*p:y;return a==="channelsFirst"?h=[l,F,A,I,_]:a==="channelsLast"&&(h=[l,A,I,_,F]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:d,inWidth:f,inChannels:p,outDepth:A,outHeight:I,outWidth:_,outChannels:F,padInfo:P,strideDepth:w,strideHeight:x,strideWidth:C,filterDepth:v,filterHeight:g,filterWidth:m,effectiveFilterDepth:M,effectiveFilterHeight:D,effectiveFilterWidth:T,dilationDepth:S,dilationHeight:k,dilationWidth:N,inShape:t,outShape:h,filterShape:n}}function vE(t,n,e,r){r===void 0&&(r=1);var i=Ol(n,r);return Math.floor((t[0]*(e-1)-e+i)/2)}function gv(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Ew(t){return typeof t=="number"?[t,t,t]:t}function Ol(t,n){return n<=1?t:t+(t-1)*(n-1)}function Zd(t,n){if(!n)return t;switch(n){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+n)}}function fu(t){var n=gv(t),e=n[0],r=n[1],i=n[2];return e===1&&r===1&&i===1}function yr(t,n){return fu(t)||fu(n)}function Ig(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function gE(t,n,e){if(n==="complex64"){if(t.dtype==="complex64")return t.clone();var r=_t(t.shape),i=t.toFloat(),o=e.complex(i,r);return r.dispose(),i.dispose(),o}if(!eM(t.dtype,n))return K.makeTensorFromDataId(t.dataId,t.shape,n);if(t.dtype==="complex64"){var a=e.real(t);return o=a.cast(n),a.dispose(),o}if(n==="int32")return e.int(t);if(n==="bool"){var s=Ie(0,t.dtype);return o=e.notEqual(t,s),s.dispose(),o}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+n)}function yv(t,n){return K.makeTensorFromDataId(t.dataId,n,t.dtype)}function yE(t,n,e){var r=(n-t)/(e-1),i=Rc(e,"float32");i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return zr(i,"float32")}var F7=Object.freeze({castTensor:gE,reshapeTensor:yv,linspaceImpl:yE,upcastType:bn,axesAreInnerMostDims:ZS,combineLocations:LM,computeOutAndReduceShapes:Gn,expandShapeToKeepDim:ei,assertAxesAreInnerMostDims:Nr,getAxesPermutation:Gi,getUndoAxesPermutation:bg,getInnerMostAxes:qi,getBroadcastDims:Hs,getReductionAxes:Rn,assertAndGetBroadcastShape:lt,assertParamsConsistent:FM,computeOutShape:cu,computePool2DInfo:ec,computePool3DInfo:zf,computeConv2DInfo:bs,computeConv3DInfo:Bf,computeDefaultPad:vE,tupleValuesAreOne:fu,eitherStridesOrDilationsAreOne:yr,convertConv2DDataFormat:Ig});function Cw(t,n){if(t.length!==n.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+n.length+".");for(var e=new Float32Array(2*t.length),r=0;r<e.length;r+=2)e[r]=t[r/2],e[r+1]=n[r/2];return e}function zN(t,n){return{real:t[2*n],imag:t[2*n+1]}}function z7(t,n,e,r){t[2*r]=n,t[2*r+1]=e}function B7(t,n,e){var r=(e?2:-2)*Math.PI*(t/n);return{real:Math.cos(r),imag:Math.sin(r)}}function bE(t,n,e,r,i){for(var o=Array.from(n).map(function(p,h){return{score:p,boxIndex:h}}).filter(function(p){return p.score>i}).sort(function(p,h){return h.score-p.score}),a=[],s=0;s<o.length;s++){var u=o[s],l=u.score,c=u.boxIndex;if(l<i)break;for(var d=!1,f=a.length-1;f>=0;--f)if(j7(t,c,a[f])>=r){d=!0;break}if(!d&&(a.push(c),a.length>=e))break}return zr(a,"int32")}function j7(t,n,e){var r=t.subarray(4*n,4*n+4),i=t.subarray(4*e,4*e+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),f=Math.max(i[1],i[3]),p=(s-o)*(u-a),h=(d-l)*(f-c);if(p<=0||h<=0)return 0;var v=Math.max(o,l),g=Math.max(a,c),m=Math.min(s,d),y=Math.min(u,f),b=Math.max(m-v,0)*Math.max(y-g,0);return b/(p+h-b)}function rP(t,n,e){var r=new Array(t.rank).fill(0),i=t.shape.slice();return n.map(function(o){i[e]=o;var a=t.slice(r,i);return r[e]+=o,a})}function iP(t,n){for(var e=new Array(t.rank),r=0;r<e.length;r++)e[r]=t.shape[r]*n[r];var i=He(e,t.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=o[s]%t.shape[s];var u=t.locToIndex(a);i.values[r]=t.values[u]}return i.toTensor()}function oP(t,n,e,r,i){for(var o=n[n.length-1],a=[t.length/o,o],s=a[0],u=a[1],l=_f(e,s*r),c=_f("int32",s*r),d=0;d<s;d++){for(var f=d*u,p=t.subarray(f,f+u),h=[],v=0;v<p.length;v++)h.push({value:p[v],index:v});h.sort(function(w,x){return x.value-w.value});var g=d*r,m=l.subarray(g,g+r),y=c.subarray(g,g+r);for(v=0;v<r;v++)m[v]=h[v].value,y[v]=h[v].index}var b=n.slice();return b[b.length-1]=r,[mn(l,b,e),mn(c,b,"int32")]}function wE(t,n){for(var e=[],r=0;r<n.length;r++)n[r]&&e.push(r);var i=He(t,"int32"),o=He([e.length,t.length],"int32");for(r=0;r<e.length;r++){var a=i.indexToLoc(e[r]),s=r*t.length;o.values.set(a,s)}return o.toTensor()}var V7=function(){return function(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map(function(i,o){return"T"+o});var e=[];this.variableNames.forEach(function(i){e.push("float v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `}}(),$7=function(){return function(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map(function(i,o){return"T"+o});var e=[];this.variableNames.forEach(function(i){e.push("vec4 v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `}}(),U7=function(){return function(t,n,e){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,o=t.inSize,a=Math.ceil(o/r);e||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];var s=n==="max"?">":"<",u=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}();function aP(t,n){return["x","y","z","w","u","v"].slice(0,n).map(function(e){return t+"."+e})}function Ar(t,n){return n===1?[t]:aP(t,n)}function sr(){var t,n,e,r,i,o,a,s,u,l;return ie().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",n="in",e="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",n="attribute",e="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:n,varyingVs:e,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function Gs(t,n,e){e===void 0&&(e="index");var r=vs(n);return r.map(function(i,o){return"int "+t[o]+" = "+e+" / "+i+"; "+(o===r.length-1?"int "+t[o+1]+" = "+e+" - "+t[o]+" * "+i:"index -= "+t[o]+" * "+i)+";"}).join("")}function xE(t){var n=vs(t).map(function(e){return e.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+n[0]+" + coords.y * "+n[1]+` + coords.z;
  }
`}var sP=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function W7(t,n,e,r){var i=[];t.forEach(function(p){var h=Pe(p.shapeInfo.logicalShape);p.shapeInfo.isUniform?i.push("uniform float "+p.name+(h>1?"["+h+"]":"")+";"):(i.push("uniform sampler2D "+p.name+";"),i.push("uniform int offset"+p.name+";"))});var o,a,s=i.join(`
`),u=t.map(function(p){return function(h,v,g){g===void 0&&(g=!1);var m="";m+=g?uP(h):rl(h);var y=h.shapeInfo.logicalShape,b=v.logicalShape;return y.length<=b.length&&(m+=g?function(w,x){var C,E=w.name,S=E.charAt(0).toUpperCase()+E.slice(1),k="get"+S+"AtOutCoords",N=w.shapeInfo.logicalShape.length,M=x.logicalShape.length,D=Hs(w.shapeInfo.logicalShape,x.logicalShape),T=jt(M),O=M-N,P=["x","y","z","w","u","v"];C=N===0?"":M<2&&D.length>=1?"coords = 0;":D.map(function(B){return"coords."+P[B+O]+" = 0;"}).join(`
`);var A="";A=M<2&&N>0?"coords":w.shapeInfo.logicalShape.map(function(B,q){return"coords."+P[q+O]}).join(", ");var I="return outputValue;",_=Pe(w.shapeInfo.logicalShape)===1,F=Pe(x.logicalShape)===1;if(N!==1||_||F){if(_&&!F)I=M===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(D.length){var L=N-2,H=N-1;D.indexOf(L)>-1&&D.indexOf(H)>-1?I="return vec4(outputValue.x);":D.indexOf(L)>-1?I="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":D.indexOf(H)>-1&&(I="return vec4(outputValue.xx, outputValue.zz);")}}else I=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+k+`() {
      `+T+` coords = getOutputCoords();
      `+C+`
      vec4 outputValue = get`+S+"("+A+`);
      `+I+`
    }
  `}(h,v):function(w,x){var C=w.name,E=C.charAt(0).toUpperCase()+C.slice(1),S="get"+E+"AtOutCoords",k=x.texShape,N=w.shapeInfo.texShape,M=w.shapeInfo.logicalShape.length,D=x.logicalShape.length;if(!w.shapeInfo.isUniform&&M===D&&w.shapeInfo.flatOffset==null&&Bn(N,k))return`
      float `+S+`() {
        return sampleTexture(`+C+`, resultUV);
      }
    `;var T,O=jt(D),P=Hs(w.shapeInfo.logicalShape,x.logicalShape),A=D-M,I=["x","y","z","w","u","v"];T=M===0?"":D<2&&P.length>=1?"coords = 0;":P.map(function(F){return"coords."+I[F+A]+" = 0;"}).join(`
`);var _="";return _=D<2&&M>0?"coords":w.shapeInfo.logicalShape.map(function(F,L){return"coords."+I[L+A]}).join(", "),`
    float `+S+`() {
      `+O+` coords = getOutputCoords();
      `+T+`
      return get`+E+"("+_+`);
    }
  `}(h,v)),m}(p,n,r)}).join(`
`),l=n.texShape,c=sr(),d=function(p){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+p.texture2D+`(textureSampler, uv).r;
    }
  `}(c),f=function(p){return p.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+p.varyingFs+` vec2 resultUV;
    `+p.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+p.defineSpecialNaN+`
    `+p.defineSpecialInf+`
    `+p.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+H7+`
    `+G7+`
    `+q7+`
  `}(c);return n.isPacked?(o=function(p,h){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,x){var C=[Math.ceil(x[0]/2),Math.ceil(x[1]/2)];return C[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+C[1]+`.0);
      }
    `:C[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+C[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      return 2 * (resTexRC.x * `+C[1]+` + resTexRC.y);
    }
  `}(0,h);case 2:return function(w,x){var C=[Math.ceil(x[0]/2),Math.ceil(x[1]/2)];if(Bn(w,x))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+C[0]+", "+C[1]+`));
      }
    `;var E=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));

      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec2(r, c);
    }
  `}(p,h);case 3:return v=p,g=h,m=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(v[2]/2),b=y*Math.ceil(v[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,x){for(var C=[Math.ceil(x[0]/2),Math.ceil(x[1]/2)],E=Math.ceil(w[w.length-1]/2),S=E*Math.ceil(w[w.length-2]/2),k=S,N="",M="b, r, c",D=2;D<w.length-1;D++)k*=w[w.length-D-1],N=`
      int b`+D+" = index / "+k+`;
      index -= b`+D+" * "+k+`;
    `+N,M="b"+D+", "+M;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+N+`

      int b = index / `+S+`;
      index -= b * `+S+`;

      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec`+w.length+"("+M+`);
    }
  `}(p,h)}var v,g,m,y,b}(n.logicalShape,l),a=function(p){return`
    void setOutput(vec4 val) {
      `+p.output+` = val;
    }
  `}(c)):(o=function(p,h){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(m,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,h);case 2:return function(m,y){return Bn(m,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:m[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:m[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+m[1]+`;
      int c = index - r * `+m[1]+`;
      return ivec2(r, c);
    }
  `}(p,h);case 3:return v=h,g=Gs(["r","c","d"],p),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(m,y){var b=Gs(["r","c","d","d2"],m);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(p,h);case 5:return function(m,y){var b=Gs(["r","c","d","d2","d3"],m);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(p,h);case 6:return function(m,y){var b=Gs(["r","c","d","d2","d3","d4"],m);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(p,h);default:throw new Error(p.length+"-D output sampling is not yet supported")}var v,g}(n.logicalShape,l),a=function(p){return`
    void setOutput(float val) {
      `+p.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(f+=K7),[f,d,a,s,o,u,e].join(`
`)}function rl(t){var n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(e){var r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var o=e.shapeInfo.texShape,a=o[0],s=o[1];if(a===1&&s===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=e.shapeInfo.texShape,l=u[0],c=u[1],d=Rs(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 1:return function(e){var r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+Ku(e)+`
      }
    `;var o=e.shapeInfo.texShape,a=o[0],s=o[1];if(s===1&&a===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Rs(r);return s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 2:return function(e){var r=e.shapeInfo.logicalShape,i=e.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=e.shapeInfo.texShape;if(a!=null&&Bn(r,a)){var s=a[0],u=a[1];return`
    float `+o+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=Aa(r),c=l.newShape,d=l.keptDims,f=c;if(f.length<r.length){var p=il(e,f);return`
      `+rl(p)+`
      float `+o+`(int row, int col) {
        return `+o+"("+ol(["row","col"],d)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Ku(e)+`
      }
    `;var h=a[0],v=a[1],g=Rs(i);return v===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+h+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:h===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+v+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+o+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+h+", "+v+`, index);
    return sampleTexture(`+i+`, uv);
  }
`}(t);case 3:return function(e){var r=e.shapeInfo.logicalShape,i=e.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[1]*r[2],s=r[2],u=Aa(r),l=u.newShape,c=u.keptDims,d=l;if(d.length<r.length){var f=il(e,d);return`
        `+rl(f)+`
        float `+o+`(int row, int col, int depth) {
          return `+o+"("+ol(["row","col","depth"],c)+`);
        }
      `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+Ku(e)+`
      }
    `;var p=e.shapeInfo.texShape,h=p[0],v=p[1],g=e.shapeInfo.flatOffset;if(v===a&&g==null)return`
        float `+o+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+v+".0, "+h+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(v===s&&g==null)return`
    float `+o+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+v+".0, "+h+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var m=Rs(i);return`
      float `+o+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+m+`;
        vec2 uv = uvFromFlat(`+h+", "+v+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `}(t);case 4:return function(e){var r=e.shapeInfo.logicalShape,i=e.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,l=Aa(r),c=l.newShape,d=l.keptDims;if(c.length<r.length){var f=il(e,c);return`
      `+rl(f)+`
      float `+o+`(int row, int col, int depth, int depth2) {
        return `+o+"("+ol(["row","col","depth","depth2"],d)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+Ku(e)+`
      }
    `;var p=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,v=h[0],g=h[1];if(g===u&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(g===a&&p==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var m=Rs(i);return`
    float `+o+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+v+", "+g+", index + "+m+`);
      return sampleTexture(`+i+`, uv);
    }
  `}(t);case 5:return function(e){var r=e.shapeInfo.logicalShape,i=e.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,l=r[1]*u,c=Aa(r),d=c.newShape,f=c.keptDims;if(d.length<r.length){var p=il(e,d);return`
      `+rl(p)+`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        return `+o+"("+ol(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+Ku(e)+`
      }
    `;var h=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,g=v[0],m=v[1];if(m===l&&h==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(m===a&&h==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var y=Rs(i);return`
    float `+o+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+m+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(t);case 6:return function(e){var r=e.shapeInfo.logicalShape,i=e.name,o="get"+i.charAt(0).toUpperCase()+i.slice(1),a=Aa(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var l=il(e,s);return`
      `+rl(l)+`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+o+"("+ol(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],d=r[4]*c,f=r[3]*d,p=r[2]*f,h=r[1]*p;if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+h+", "+p+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Ku(e)+`
      }
    `;var v=e.shapeInfo.flatOffset,g=e.shapeInfo.texShape,m=g[0],y=g[1];if(y===h&&v==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+p+", "+f+", "+d+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(y===c&&v==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var b=Rs(i);return`
    float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+h+" + col * "+p+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+m+", "+y+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(t);default:throw new Error(n.length+"-D input sampling is not yet supported")}}function uP(t){var n,e,r;switch(t.shapeInfo.logicalShape.length){case 0:return n=t.name,e="get"+n.charAt(0).toUpperCase()+n.slice(1),r=sr(),`
    vec4 `+e+`() {
      return `+r.texture2D+"("+n+`, halfCR);
    }
  `;case 1:return function(i){var o=i.name,a="get"+o.charAt(0).toUpperCase()+o.slice(1),s=i.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=sr();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+o+`, uv);
    }
  `}(t);case 2:return function(i){var o=i.shapeInfo.logicalShape,a=i.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=i.shapeInfo.texShape,l=u[0],c=u[1],d=sr();if(u!=null&&Bn(o,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+d.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],p=Math.ceil(o[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+p+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+a+`, uv);
    }
  `}(t);case 3:return function(i){var o=i.shapeInfo.logicalShape,a=i.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(o[0]===1){var c=o.slice(1),d=il(i,c);return`
        `+uP(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+ol(["b","row","col"],[1,2])+`);
        }
      `}var f=l[0],p=l[1],h=Math.ceil(o[2]/2),v=h*Math.ceil(o[1]/2),g=sr();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+p+", "+v+", "+h+`, b, row, col);
      return `+g.texture2D+"("+a+`, uv);
    }
  `}(t);default:return function(i){for(var o=i.shapeInfo.logicalShape,a=o.length,s=i.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=i.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=c[0],f=c[1],p=Math.ceil(o[a-1]/2),h=p*Math.ceil(o[a-2]/2),v="int b, int row, int col",g="b * "+h+" + (row / 2) * "+p+" + (col / 2)",m=2;m<a-1;m++)v="int b"+m+", "+v,h*=o[a-m-1],g="b"+m+" * "+h+" + "+g;var y=sr();return`
    vec4 `+u+"("+v+`) {
      int index = `+g+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(t)}}var H7=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,G7=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,q7=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,K7=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Rs(t){return"offset"+t}function Ku(t){var n=t.name,e=Pe(t.shapeInfo.logicalShape);return e<2?"return "+n+";":`
    for (int i = 0; i < `+e+`; i++) {
      if (i == index) {
        return `+n+`[i];
      }
    }
  `}function jt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function il(t,n){var e=JSON.parse(JSON.stringify(t));return e.shapeInfo.logicalShape=n,e}function ol(t,n){return n.map(function(e){return t[e]}).join(", ")}var X7=function(){return function(t,n,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,U(t.length>2,function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."});var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=jt(l),d=Ar("coords",l);if(o===1){var f=jt(s=l+1);a=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else s=l,a=`
        `+c+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+d[l-2]+";";var p=["x","y","z","w","u","v"].slice(0,s),h="."+p[s-1],v=p.map(function(S){return"int "+S}),g=Ar("sourceLocR",s-1).concat("inIdx.r"),m=Ar("sourceLocG",s-1).concat("inIdx.g"),y=Ar("sourceLocB",s-1).concat("inIdx.b"),b=Ar("sourceLocA",s-1).concat("inIdx.a"),w=e==="max"?"greaterThan":"lessThan",x=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",C=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+m.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",E=r?"":`
      float getBestIndicesAChannel(`+v.join()+`) {
        return getChannel(getBestIndicesA(`+p.join()+`),
                                          vec2(`+p.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+v.join()+`) {
        return getChannel(getA(`+p.join()+`),
                               vec2(`+p.slice(-2).join()+`));
      }
      `+E+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+h+", sourceLocG"+h+`,
          sourceLocB`+h+", sourceLocA"+h+") * "+n+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+C+`;

        for (int i = 0; i < `+n+`; i++) {
          inIdx = srcIdx;
          `+x+`
          vec4 candidate = `+C+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}(),Y7=function(){return function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,e=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=s-1-t.padInfo.top,c=u-1-t.padInfo.left,d=1/(n*e);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+o+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}(),J7=function(){return function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,e=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,p=c-1-t.padInfo.front,h=d-1-t.padInfo.top,v=f-1-t.padInfo.left,g=1/(n*e*r);this.userCode=`
      const ivec3 pads = ivec3(`+p+", "+h+", "+v+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),Q7=function(){return function(t,n,e,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],lt(t,n),lt(t,e);var a="0.0";r!=null&&(lt(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";i!=null&&(lt(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+o+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}(),Z7=function(){return function(t,n,e,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],lt(t,n),lt(t,e);var a="vec4(0.0)";r!=null&&(lt(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";i!=null&&(lt(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+o+`));

        setOutput((x - mean) * inv + offset);
      }
    `}}(),eG="return areal * breal - aimag * bimag;",tG="return areal * bimag + aimag * breal;",BN=function(){return function(t,n,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=lt(n,e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+t+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}(),Q0="return a + b;",Z0="return a - b;",jN="return a * b;",lP="return (a < 0.) ? b * a : a;",an=function(){return function(t,n,e){this.variableNames=["A","B"],this.outputShape=lt(n,e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+t+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}(),cP=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Oo=function(){return function(t,n,e,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=lt(n,e);var i=this.outputShape.length,o="";if(r)if(i===0||Pe(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          `+jt(i)+` coords = getOutputCoords();
        `,i===1)o+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=Ar("coords",i);o+=`
            bool nextRowOutOfBounds =
              (`+a[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+a[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+t+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+o+`

        setOutput(result);
      }
    `}}(),nG=function(){function t(n){this.variableNames=["A"],this.outputShape=n,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return t.prototype.getCustomSetupFunc=function(n,e){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,n),i.gl.uniform1f(r.maxLoc,e)}},t}(),rG=function(){function t(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return t.prototype.getCustomSetupFunc=function(n,e){var r=this;return function(i,o){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(o,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(o,"maxVal")),i.gl.uniform1f(r.minLoc,n),i.gl.uniform1f(r.maxLoc,e)}},t}(),iG=function(){return function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}(),oG=function(){return function(t){this.outputShape=[],this.outputShape=cu(t,1),this.variableNames=t.map(function(s,u){return"T"+u});var n=new Array(t.length-1);n[0]=t[0][1];for(var e=1;e<n.length;e++)n[e]=n[e-1]+t[e][1];var r=["if (yC < "+n[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<n.length;e++){var i=n[e-1];r.push("else if (yC < "+n[e]+") setOutput(getT"+e+"(yR, yC-"+i+"));")}var o=n.length,a=n[n.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `}}(),aG=function(){return function(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=cu(t,n);var e=this.outputShape,r=e.length,i=jt(r),o=Ar("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(function(g,m){return"T"+m});var s=new Array(t.length-1);s[0]=t[0][n];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][n];var l=a[n],c=a.slice(-2),d=a.join(),f="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var p=s[u-1];f+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+bh(a,l,p)+`),
            vec2(`+bh(c,l,p)+`));
        }`}var h=s.length,v=s[s.length-1];f+=`
        return getChannel(
          getT`+h+"("+bh(a,l,v)+`),
          vec2(`+bh(c,l,v)+"));",this.userCode=`
      float getValue(`+a.map(function(g){return"int "+g})+`) {
        `+f+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+o+`), 0., 0., 0.);

        `+o[r-1]+" = "+o[r-1]+` + 1;
        if (`+o[r-1]+" < "+e[r-1]+`) {
          result.g = getValue(`+o+`);
        }

        `+o[r-2]+" = "+o[r-2]+` + 1;
        if (`+o[r-2]+" < "+e[r-2]+`) {
          result.a = getValue(`+o+`);
        }

        `+o[r-1]+" = "+o[r-1]+` - 1;
        if (`+o[r-2]+" < "+e[r-2]+` &&
            `+o[r-1]+" < "+e[r-1]+`) {
          result.b = getValue(`+o+`);
        }
        setOutput(result);
      }
    `}}();function bh(t,n,e){var r=t.indexOf(n);return t.map(function(i,o){return o===r?i+" - "+e:i}).join()}var sG=function(){return function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,e=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+n+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+i+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              if (`+o+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),uG=function(){return function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,e=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=t.dataFormat==="channelsLast",a=n-1-t.padInfo.top,s=e-1-t.padInfo.left,u=o?1:2,l=o?2:3,c=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+n+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+n+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {

              if (`+o+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),lG=function(){return function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,e=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yF = 0; yF < `+t.outDepth+`; yF++) {
            int xF = wF + yF * `+n+" - "+i+`;

            if (xF < 0 || xF >= `+t.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+t.outHeight+`; yR++) {
              int xR = wR + yR * `+e+" - "+o+`;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+t.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),cG=function(){return function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,e=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=n-1-t.padInfo.front,u=e-1-t.padInfo.top,l=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+n+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+t.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+n+` - 1 - wF;

          for (int wR = 0; wR < `+e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+e+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),dG=function(){return function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,e=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+o+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+n+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+i+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),fG=function(){return function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,e=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,a=e-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+n+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+n+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),VN=function(){return function(t,n,e,r){n===void 0&&(n=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.padInfo.top,o=t.padInfo.left,a=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4,h=t.dataFormat==="channelsLast",v=h?1:2,g=h?2:3,m=h?3:1,y="",b="";e&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,b="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+i+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+m+`];

        ivec2 xRCCorner =
            ivec2(coords[`+v+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+t.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+h+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(p===1)+`) {

              if (`+h+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(p===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+h+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(p===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+h+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+b+`
        setOutput(result);
      }
    `}}(),pG=function(){return function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,e=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterDepth,d=t.filterHeight,f=t.filterWidth,p=4*Math.floor(t.inChannels/4),h=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+o+", "+a+`);
      const ivec3 pads = ivec3(`+n+", "+e+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+p+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(h===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+p+`) *
                  getW(wF, wR, wC, `+p+`, d2);
              } else if (`+(h===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(h===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1),
                  getX(batch, xF, xR, xC, `+p+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2),
                  getW(wF, wR, wC, `+p+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),$N=function(){return function(t,n,e,r){n===void 0&&(n=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.inHeight,o=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,p=t.filterWidth,h=t.outChannels/t.inChannels,v="",g="";e&&(v=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,g="result = activation(result);");var m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+v+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+h+`;
        int q = d2 - d1 * `+h+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+o+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+m+`
        `+g+`
        setOutput(result);
      }
    `}}(),UN=function(){return function(t,n,e,r){n===void 0&&(n=!1),e===void 0&&(e=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var i=t.inHeight,o=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,p=t.filterWidth,h=p,v="int xR; int xC; int xCOffset;",g=0;g<f;g++)for(var m=0;m<p;m++)v+=`
          vec4 xTexelR`+g+"C"+2*m+` = vec4(0.);
          vec4 wR`+g+"C"+m+` = vec4(0.);
          vec4 xR`+g+"C"+m+" = vec4(0.);";for(g=0;g<f;g++)for(var y=0;y<h;y++){if(v+=`
          xR = xRCorner + `+g*c+`;
          xC = xCCorner + `+(m=2*y)*d+`;
        `,l===1){if(m<p&&(v+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);
                  xR`+g+"C"+m+" = vec4(previous.zw, xTexelR"+g+"C"+m+`.xy);
                } else {
                  xR`+g+"C"+m+" = vec4(0, 0, xTexelR"+g+"C"+m+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+o+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                xR`+g+"C"+m+" = xTexelR"+g+"C"+m+`;
              `,m+1<p)){var b=s%2==0?GS(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(v+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(v+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+o+`) {
                      xTexelR`+g+"C"+m+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+m+` = vec4(0.);
                    }
                  `),v+=`
                  xR`+g+"C"+(m+1)+` = vec4(
                    xTexelR`+g+"C"+m+".zw, xTexelR"+g+"C"+(m+2)+`.xy);
                `):v+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(m+1)+" = xTexelR"+g+"C"+(m+2)+`;
                `}}else m<p&&(v+=`
              if(xR >= 0 && xR < `+i+`) {
            `,s%2==1?(v+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+o+`) {
                  xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(m+2)+` = vec4(0.);
                }

                xR`+g+"C"+m+` = vec4(
                  xTexelR`+g+"C"+m+".zw, xTexelR"+g+"C"+(m+2)+`.zw);
              `,m+1<p&&(v+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+o+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(m+1)+" = vec4(xTexelR"+g+"C"+(m+2)+`.xy, final.xy);
                `)):(v+=`
                if(xC >= 0 && xC < `+o+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(m+2)+` = vec4(0.);
                }

                xR`+g+"C"+m+` = vec4(
                  xTexelR`+g+"C"+m+".xy, xTexelR"+g+"C"+(m+2)+`.xy);
              `,m+1<p&&(v+=`
                  xR`+g+"C"+(m+1)+` = vec4(
                    xTexelR`+g+"C"+m+".zw, xTexelR"+g+"C"+(m+2)+`.zw);
                `)),v+="}");m<p&&(v+=`
            vec4 wTexelR`+g+"C"+m+" = getW("+g+", "+m+`, d1, q);
            wR`+g+"C"+m+" = vec4(wTexelR"+g+"C"+m+".xz, wTexelR"+g+"C"+m+`.xz);
          `,m+1<p&&(v+=`
              vec4 wTexelR`+g+"C"+(m+1)+" = getW("+g+", "+(m+1)+`, d1, q);
              wR`+g+"C"+(m+1)+` =
                vec4(wTexelR`+g+"C"+(m+1)+".xz, wTexelR"+g+"C"+(m+1)+".xz);"))}for(g=0;g<f;g++)for(m=0;m<p;m++)v+="dotProd += xR"+g+"C"+m+" * wR"+g+"C"+m+";";var w="",x="";e&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`vec4 activation(vec4 x) {
          `+e+`
        }`,x="result = activation(result);");var C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+v+`

        vec4 result = dotProd;
        `+C+`
        `+x+`
        setOutput(result);
      }
    `}}(),hG=function(){return function(t,n,e,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=t[0],a=t[1],s=t[2],u=t[3],l=n[0],c=e[0],d=e[1];this.outputShape=[l,c,d,u];var f=r==="bilinear"?1:0,p=[a-1+".0",s-1+".0"],h=p[0],v=p[1],g=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],m=g[0],y=g[1],b=g[2],w=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],x=w[0],C=w[1],E=w[2];this.userCode=`
      const float height_ratio = float(`+m+`);
      const float width_ratio = float(`+x+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+o+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+C+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+h+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+E+`;
        if( in_x < 0.0 || in_x > `+v+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}(),mG=function(){return function(t,n,e){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],o=e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(e?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+jt(r)+` coords = getOutputCoords();
        int end = `+WN(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+o+` end) {
            continue;
          }
          if (idx == end && `+n+`) {
            continue;
          }
          `+WN(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `}}();function WN(t,n){if(t===1)return""+n;if(t===2)return n+".y";if(t===3)return n+".z";if(t===4)return n+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var vG=function(){return function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Mf.DENSE;var n=Qd(t),e=sr();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Gs(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+n[0]+", "+n[1]+`));
        int index = 4 * (resTexRC.x * `+n[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+e.output+` = result;
      }
    `}}(),gG=function(){return function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Mf.DENSE;var n=Qd(t),e=sr();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Gs(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+n[0]+", "+n[1]+`));
        int index = 4 * (resTexRC.x * `+n[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+e.output+` = result;
      }
    `}}(),yG=function(){function t(n,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=n,this.blockSize=e,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+e+`;
      int offset_h = imod(h, `+e+`);
      int in_w = w / `+e+`;
      int offset_w = imod(w, `+e+`);
      int offset_d = (offset_h * `+e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return t.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),bG=function(){return function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}(),wG=function(){return function(t){this.variableNames=["A"],this.outTexUsage=qr.DOWNLOAD;var n=sr();this.outputShape=t,this.userCode=`
      `+sP+`

      void main() {
        float x = getAAtOutCoords();
        `+n.output+` = encode_float(x);
      }
    `}}(),xG=function(){return function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=qr.DOWNLOAD;var n=sr();this.outputShape=t,this.userCode=`
      `+sP+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+n.output+` = encode_float(x);
      }
    `}}(),SG=function(){return function(t,n,e){e===void 0&&(e=!1),this.variableNames=["A"];var r=sr(),i=n[0],o=n[1];this.outputShape=t;var a="result";e&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+xE(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+o+`;
        int c = imod(flatIndex, `+o+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `}}(),EG=function(){return function(t,n,e){e===void 0&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=sr(),i=n[0],o=n[1];this.outputShape=t;var a="",s="result";e&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+t[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+t[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+o+`;
              c = imod(flatIndex, `+o+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+xE(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `}}(),CG="return real * expR - imag * expI;",RG="return real * expI + imag * expR;",HN=function(){return function(t,n,e){this.variableNames=["real","imag"];var r=n[1];this.outputShape=n;var i=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=e?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+t+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+o+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}(),TG=function(){function t(n,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=n,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return t.prototype.getCustomSetupFunc=function(n){var e=this;return function(r,i){e.valueLoc==null&&(e.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(e.valueLoc,n)}},t}(),NG=function(){return function(t){this.variableNames=["A"];var n=sr(),e=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+e+`.0);

        vec4 values = `+n.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}(),kG=function(){return function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=sr(),e=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+e+`.0);
            vec4 values = `+n.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+n.output+` = result;
      }
    `}}(),IG=function(){return function(t,n,e){this.variableNames=["A","indices"];var r=t.slice();r[e]=n,this.outputShape=r,this.rank=r.length;var i=jt(this.rank),o=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],d=0;d<a.length;d++)d===s?c.push("int(getIndices("+l[d]+"))"):c.push(""+l[d]);return c.join()}(t,e);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `}}(),_G=function(){return function(t,n,e){this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=e;var r=jt(n.length),i=jt(e.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+o+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}}();function dP(t,n){var e=sr();return pM(t,n,e.version+`
    precision highp float;
    `+e.attribute+` vec3 clipSpacePos;
    `+e.attribute+` vec2 uv;
    `+e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function fP(t,n){return gM(t,n,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function pP(t,n){return yM(t,n,new Uint16Array([0,1,2,2,1,3]))}function up(t,n,e,r,i,o,a){wM(e,r);var s=bM(t,n),u=t.TEXTURE_2D;return ke(t,n,function(){return t.bindTexture(u,s)}),ke(t,n,function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)}),ke(t,n,function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}),ke(t,n,function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)}),ke(t,n,function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)}),ke(t,n,function(){return t.texImage2D(u,0,i,e,r,0,o,a,null)}),ke(t,n,function(){return t.bindTexture(t.TEXTURE_2D,null)}),s}function hP(t,n,e,r,i){var o=gg(e,r);return up(t,n,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function mP(t,n,e,r,i){var o=gg(e,r);return up(t,n,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function vP(t,n,e,r,i){var o=gg(e,r);return up(t,n,o[0],o[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function gP(t,n,e,r,i){var o=ip(e,r);return up(t,n,o[0],o[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function yP(t,n,e,r,i){var o=ip(e,r);return up(t,n,o[0],o[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function bP(t,n,e,r){return ke(t,n,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),gw(t,n,e,"clipSpacePos",r,3,20,0)&&gw(t,n,e,"uv",r,2,20,12)}function wP(t,n,e,r,i,o,a){var s,u,l;ke(t,n,function(){return t.bindTexture(t.TEXTURE_2D,e)}),o instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,l=t.RGBA):(s=new Float32Array(r*i*4),u=t.FLOAT,l=a.internalFormatPackedFloat),s.set(o),ke(t,n,function(){return t.texImage2D(t.TEXTURE_2D,0,l,r,i,0,t.RGBA,u,s)}),ke(t,n,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function xP(t,n,e,r){ke(t,n,function(){return t.bindTexture(t.TEXTURE_2D,e)}),r.data instanceof Uint8Array?ke(t,n,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)}):ke(t,n,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}),ke(t,n,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function SP(t,n,e,r,i){var o=t.createBuffer();ke(t,n,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,o)});var a=16*e*r;return ke(t,n,function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)}),ke(t,n,function(){return t.readPixels(0,0,r,e,t.RGBA,t.FLOAT,0)}),ke(t,n,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}),o}function EP(t,n,e){var r=t,i=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,n),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function CP(t,n,e,r,i){var o=gg(e,r),a=o[0],s=o[1],u=new Uint8Array(e*r*4);return ke(t,n,function(){return t.readPixels(0,0,a,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function RP(t,n,e,r,i,o,a,s){var u=t,l=new Float32Array(function(c,d){var f=ip(c,d);return f[0]*f[1]*4}(o,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,n),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function TP(t,n,e,r){var i=new Float32Array(e*r*4);return ke(t,n,function(){return t.readPixels(0,0,r,e,t.RGBA,t.FLOAT,i)}),i}var AG=Object.freeze({createVertexShader:dP,createVertexBuffer:fP,createIndexBuffer:pP,createFloat32MatrixTexture:hP,createFloat16MatrixTexture:mP,createUnsignedBytesMatrixTexture:vP,createPackedMatrixTexture:gP,createFloat16PackedMatrixTexture:yP,bindVertexProgramAttributeStreams:bP,uploadDenseMatrixToTexture:wP,uploadPixelDataToTexture:xP,createBufferFromOutputTexture:SP,downloadFloat32MatrixFromBuffer:EP,downloadByteEncodedFloatMatrixFromOutputTexture:CP,downloadPackedMatrixFromBuffer:RP,downloadMatrixFromPackedOutputTexture:TP}),NP=function(){function t(n){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=ie().getNumber("WEBGL_VERSION");if(n!=null?(this.gl=n,lM(e,n)):this.gl=Co(e),ie().getNumber("WEBGL_VERSION")===1)this.textureFloatExtension=cm(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=cm(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(Mi(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!Mi(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=fP(this.gl,this.debug),this.indexBuffer=pP(this.gl,this.debug),this.framebuffer=xM(this.gl,this.debug),this.textureConfig=QS(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return ie().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var n=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;ke(e,this.debug,function(){return e.finish()}),ke(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),ke(e,this.debug,function(){return e.deleteFramebuffer(n.framebuffer)}),ke(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),ke(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),ke(e,this.debug,function(){return e.deleteBuffer(n.indexBuffer)}),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(n,e){return this.throwIfDisposed(),hP(this.gl,this.debug,n,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(n,e){return this.throwIfDisposed(),mP(this.gl,this.debug,n,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(n,e){return this.throwIfDisposed(),vP(this.gl,this.debug,n,e,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(n,e){this.throwIfDisposed(),xP(this.gl,this.debug,n,e)},t.prototype.uploadDenseMatrixToTexture=function(n,e,r,i){this.throwIfDisposed(),wP(this.gl,this.debug,n,e,r,i,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(n,e){return this.throwIfDisposed(),yP(this.gl,this.debug,n,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(n,e){return this.throwIfDisposed(),gP(this.gl,this.debug,n,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(n){var e=this;this.throwIfDisposed(),this.outputTexture===n&&(yw(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ke(this.gl,this.debug,function(){return e.gl.deleteTexture(n)})},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(n,e,r){var i=this;return this.downloadMatrixDriver(n,function(){return CP(i.gl,i.debug,e,r,i.textureConfig)})},t.prototype.downloadPackedMatrixFromBuffer=function(n,e,r,i,o,a){return RP(this.gl,n,0,0,0,o,a,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(n,e){return EP(this.gl,n,e)},t.prototype.createBufferFromTexture=function(n,e,r){this.bindTextureToFrameBuffer(n);var i=SP(this.gl,this.debug,e,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},t.prototype.createAndWaitForFence=function(){var n=this.createFence(this.gl);return this.pollFence(n)},t.prototype.createFence=function(n){var e,r,i=this;if(ie().getBool("WEBGL_FENCE_API_ENABLED")){var o=n,a=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);n.flush(),r=function(){var s=o.clientWaitSync(a,0,0);return s===o.ALREADY_SIGNALED||s===o.CONDITION_SATISFIED},e=a}else ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(e,ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:e,isFencePassed:r}},t.prototype.downloadMatrixFromPackedTexture=function(n,e,r){var i=this;return this.downloadMatrixDriver(n,function(){return TP(i.gl,i.debug,e,r)})},t.prototype.createProgram=function(n){this.throwIfDisposed();var e=this.gl,r=hM(e,this.debug,n),i=dP(e,this.debug),o=mM(e,this.debug);return ke(e,this.debug,function(){return e.attachShader(o,i)}),ke(e,this.debug,function(){return e.attachShader(o,r)}),vM(e,this.debug,o),this.debug&&pm(e,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=bP(e,this.debug,this.program,this.vertexBuffer)),o},t.prototype.deleteProgram=function(n){var e=this;this.throwIfDisposed(),n===this.program&&(this.program=null),n!=null&&ke(this.gl,this.debug,function(){return e.gl.deleteProgram(n)})},t.prototype.setProgram=function(n){var e=this;this.throwIfDisposed(),this.program=n,this.program!=null&&this.debug&&pm(this.gl,this.debug,this.program),ke(this.gl,this.debug,function(){return e.gl.useProgram(n)})},t.prototype.getUniformLocation=function(n,e,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?EM(this.gl,this.debug,n,e):CM(this.gl,n,e)},t.prototype.getAttributeLocation=function(n,e){var r=this;return this.throwIfDisposed(),ke(this.gl,this.debug,function(){return r.gl.getAttribLocation(n,e)})},t.prototype.getUniformLocationNoThrow=function(n,e){return this.throwIfDisposed(),this.gl.getUniformLocation(n,e)},t.prototype.setInputMatrixTexture=function(n,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),RM(this.gl,this.debug,this.program,n,e,r)},t.prototype.setOutputMatrixTexture=function(n,e,r){this.setOutputMatrixTextureDriver(n,r,e)},t.prototype.setOutputPackedMatrixTexture=function(n,e,r){this.throwIfDisposed();var i=ip(e,r),o=i[0],a=i[1];this.setOutputMatrixTextureDriver(n,o,a)},t.prototype.setOutputMatrixWriteRegion=function(n,e,r,i){this.setOutputMatrixWriteRegionDriver(r,n,i,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(n,e,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){this.program!=null&&pm(this.gl,this.debug,this.program),Md(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var n=this.gl;this.debug&&this.debugValidate(),ke(n,this.debug,function(){return n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0)})},t.prototype.blockUntilAllProgramsCompleted=function(){var n=this;this.throwIfDisposed(),ke(this.gl,this.debug,function(){return n.gl.finish()})},t.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=cm(this.gl,this.debug,ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var n=this.gl,e=this.getQueryTimerExtensionWebGL2(),r=n.createQuery();return n.beginQuery(e.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),o=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,o),o},t.prototype.endQuery=function(){if(ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var n=this.getQueryTimerExtensionWebGL1();n.endQueryEXT(n.TIME_ELAPSED_EXT)}else{var e=this.gl,r=this.getQueryTimerExtensionWebGL2();e.endQuery(r.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(n){return Oe(this,void 0,void 0,function(){var e=this;return De(this,function(r){switch(r.label){case 0:return[4,cw(function(){return e.disposed||e.isQueryAvailable(n,ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(n,ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},t.prototype.getQueryTime=function(n,e){if(e===0)return null;if(e===2){var r=this.gl;return r.getQueryParameter(n,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(n,i.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(n,e){if(e===0)return!0;if(e===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(n,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(n,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint},t.prototype.pollFence=function(n){var e=this;return new Promise(function(r){e.addItemToPoll(function(){return n.isFencePassed()},function(){return r()})})},t.prototype.pollItems=function(){for(var n=function(r){for(var i=0;i<r.length;++i){var o=r[i]();if(!o)break}return i-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),e=0;e<=n;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(n+1)},t.prototype.addItemToPoll=function(n,e){var r=this;this.itemsToPoll.push({isDoneFn:n,resolveFn:e}),this.itemsToPoll.length>1||cw(function(){return r.pollItems(),r.itemsToPoll.length===0})},t.prototype.bindTextureToFrameBuffer=function(n){this.throwIfDisposed(),hm(this.gl,this.debug,n,this.framebuffer),this.debug&&Md(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(hm(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Md(this.gl)):yw(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(n,e){this.bindTextureToFrameBuffer(n);var r=e();return this.unbindTextureToFrameBuffer(),r},t.prototype.setOutputMatrixTextureDriver=function(n,e,r){this.throwIfDisposed();var i=this.gl;hm(i,this.debug,n,this.framebuffer),this.debug&&Md(i),this.outputTexture=n,ke(i,this.debug,function(){return i.viewport(0,0,e,r)}),ke(i,this.debug,function(){return i.scissor(0,0,e,r)})},t.prototype.setOutputMatrixWriteRegionDriver=function(n,e,r,i){var o=this;this.throwIfDisposed(),ke(this.gl,this.debug,function(){return o.gl.scissor(n,e,r,i)})},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},t}();function GN(t,n){if(t.length!==n.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+n.length+" inputs");t.forEach(function(e,r){var i=e.logicalShape,o=n[r],a=o.shape;if(!Bn(i,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+a+" must match");if(!e.isUniform||!o.isUniform){var s=e.texShape,u=o.isUniform?null:o.texData.texShape;if(!Bn(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var OG=function(){return function(t,n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=e.filterWidth,i=e.inChannels,o=e.strideWidth,a=e.strideHeight,s=e.padInfo,u=e.outWidth,l=e.dilationWidth,c=e.dilationHeight,d=e.dataFormat,f=s.left,p=s.top,h=i*r,v=sr(),g=d==="channelsLast",m=g?0:1,y=g?1:2,b="",w=0;w<=1;w++)for(var x=0;x<=1;x++)b+=`
          blockIndex = rc.y + `+x+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+t[1]+" && pos < "+t[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+p+`;
            d0 = offsetY + `+c+" * (pos / "+h+`);

            if(d0 < `+n[m]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+o+". - "+f+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+h+".) / "+i+`.));

              if(d1 < `+n[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+x)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+x)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+v.output+` = result;
      }
    `}}(),DG=function(){return function(t,n,e,r,i){this.variableNames=["x"],this.outputShape=[];var o,a=n,s=t[3]-1;this.outputShape=t;var u="float("+e+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+o+`;
        setOutput(val);
      }
    `}}(),MG=function(){return function(t,n,e,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=e,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+n+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+n+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}(),PG=function(){return function(t,n,e,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,a=n,s=t[3]-1;this.outputShape=t;var u="float("+e+") + float("+r+") * sum";o=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+o+`;
        setOutput(result);
      }
    `}}(),LG=function(){return function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,e=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,a=i-1-t.padInfo.top,s=o-1-t.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+o+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+e+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+o+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}(),FG=function(){return function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,e=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=s-1-t.padInfo.front,d=u-1-t.padInfo.top,f=l-1-t.padInfo.left,p=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+n+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+o+`) {
            float dyR = float(dyRCorner + wR) / `+e+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+p+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),e1=function(){return function(t,n,e,r,i,o,a){e===void 0&&(e=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),o===void 0&&(o=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;var s=e?t[1]:t[2],u=Math.ceil(s/2),l=e?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",d=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",h="";o&&(p=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+o+`
        }`:`vec4 activation(vec4 x) {
          `+o+`
        }`,h="result = activation(result);");var v=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+v+`

        `+h+`

        setOutput(result);
      }
    `}}(),zG=function(){function t(n,e,r){this.variableNames=["probs"],this.outputShape=[n,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(e-1)+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(n){var e=this;return function(r,i){e.seedLoc==null&&(e.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(e.seedLoc,n)}},t}(),BG=function(){return function(t,n,e,r){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+e+`),
                      float(index == coords.y)));
      }
    `}}(),jG=function(){return function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(n===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var e=Ar("rc",n),r=jt(n),i=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",d=s-2;d<s;d++)c+=l[d]+" >= "+u[d],d<s-1&&(c+="||");return c}(n,t,e),o=function(s,u,l,c){if(s===1)return"";var d=c.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(n,t[t.length-1],t[t.length-2],e),a=function(s,u){var l=s.length,c=function(d,f){for(var p=[],h=0;h<=1;h++)for(var v=0;v<=1;v++){for(var g=(h===0?"r":"rp1")+", "+(v===0?"c":"cp1"),m=2;m<d;m++)g=f[f.length-1-m]+","+g;p.push(g)}return p}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(t,e);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+o+`

            setOutput(vec4(`+a+`));
          }
        }
      `}}}(),VG=function(){return function(t,n,e){this.variableNames=["x"],this.outputShape=n.map(function(u,l){return u[0]+t[l]+u[1]});var r=t.length,i=jt(r),o=n.map(function(u){return u[0]}).join(","),a=n.map(function(u,l){return u[0]+t[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+o+`);
      `+i+" end = "+i+"("+a+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+e+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+o+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `}}(),$G=function(){return function(t,n,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map(function(g,m){return g[0]+t[m]+g[1]});for(var r=t.length,i=jt(r),o=n.map(function(g){return g[0]}).join(","),a=n.map(function(g,m){return g[0]+t[m]}).join(","),s=Ar("rc",r),u=Ar("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[i+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",h=0,v=r===1?2:4;h<v;h++)p+=`
        `+d[h]+`
        if (`+f+`) {
          result[`+h+"] = float("+e+`);
        } else {
          `+i+` source = rc - start;
          result[`+h+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+o+`);
      const `+i+" end = "+i+"("+a+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+p+`
        setOutput(result);
      }
    `}}(),t1=function(){return function(t,n,e){if(this.variableNames=["x"],n==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=t.padInfo.top,d=t.padInfo.left;this.outputShape=t.outShape;var f=n==="avg",p="0.0";if(f||(p="-1.0 / 1e-20"),e)this.userCode=`
        const ivec2 strides = ivec2(`+i+", "+o+`);
        const ivec2 pads = ivec2(`+c+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var h=n+"("+n+"("+n+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";n==="avg"&&(h="avgValue / count");var v=4*Math.floor(r/4),g=r%4,m=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+i+", "+o+`);
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float initializationValue = `+p+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+p+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+m+`
          }

          int xC = xCCorner + `+v+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+m+`
          }
        }
        setOutput(`+h+`);
      }
    `}}}(),n1=function(){return function(t,n,e){if(this.variableNames=["x"],n==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,p=t.padInfo.front,h=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;var g=n==="avg",m="0.0";if(g||(m="-1.0 / 1e-20"),e)this.userCode=`
        const ivec3 strides =
            ivec3(`+i+", "+o+", "+a+`);
        const ivec3 pads = ivec3(`+p+", "+h+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+t.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=n+"("+n+"("+n+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";n==="avg"&&(y="avgValue / count");var b=4*Math.floor(r/4),w=r%4,x=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+i+", "+o+", "+a+`);
      const ivec3 pads = ivec3(`+p+", "+h+", "+v+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+b+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+x+`
            }

            int xC = xCCorner + `+b+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+x+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+x+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+x+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}}}(),UG=function(){return function(t,n){this.variableNames=["x"];var e=t.windowSize,r=t.batchSize,i=t.inSize,o=Math.ceil(i/e);this.outputShape=[r,o];var a="0.0",s="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",s="min"):n==="max"&&(a="-1.0 / 1e-20",s="max");var u=n+"("+n+"("+n+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");var l=4*Math.floor(e/4),c=e%4,d=`
      if (`+(n==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(n==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var p="";i%e>0&&(p=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+p+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+e+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `}}(),WG=function(){return function(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var e="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),e+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Gs(["r","c","d"],n)+`
      return ivec3(r, c, d);
    }
  
      `+xE(t)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+t[1]+`;
        int cols = `+t[2]+`;

        `+e+`

        setOutput(result);
      }
    `}}(),HG=function(){return function(t,n,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var r=n.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],l=[e&&s>1?i-1:i,e&&u>1?o-1:o],c=[e&&s>1?s-1:s,e&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],p=1/d,h=1/f,v=2*Math.ceil(p)+2,g=2*Math.ceil(h)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+h+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(o-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}(),GG=function(){return function(t,n,e,r){this.variableNames=["A"],this.outputShape=[];var i=t[0],o=t[1],a=t[2],s=t[3];this.outputShape=[i,n,e,s];var u=[r&&n>1?o-1:o,r&&e>1?a-1:a],l=[r&&n>1?n-1:n,r&&e>1?e-1:e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}(),qG=function(){return function(t,n,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=t[0],o=t[1],a=t[2],s=t[3];this.outputShape=[i,n,e,s];var u=[r&&n>1?o-1:o,r&&e>1?a-1:a],l=[r&&n>1?n-1:n,r&&e>1?e-1:e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+o+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}(),KG=function(){return function(t,n,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var r=n.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],l=[e&&s>1?i-1:i,e&&u>1?o-1:o],c=[e&&s>1?s-1:s,e&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],p=1/d,h=1/f,v=2*Math.ceil(p)+2,g=2*Math.ceil(h)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+h+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+o+`) - 1),
                `+e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}(),XG=function(){return function(t,n,e,r){this.variableNames=["A"],this.outputShape=[];var i=t[0],o=t[1],a=t[2],s=t[3];this.outputShape=[i,n,e,s];var u=[r&&n>1?o-1:o,r&&e>1?a-1:a],l=[r&&n>1?n-1:n,r&&e>1?e-1:e],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}(),YG=function(){return function(t,n){this.variableNames=["x"];var e=t.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=t,e!==1){var r=t.map(function(o,a){return function(s){return n.indexOf(s)!==-1&&t[s]!==1?t[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),i=jt(e);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+t[0]+` - coord - 1));
        }
      `}}(),JG=function(){return function(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=t.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=t;var r=Ar("rc",e),i=r[e-1]+" + 1 < "+this.outputShape[e-1],o=r[e-2]+" + 1 < "+this.outputShape[e-2],a=jt(e);function s(u){var l=t.map(function(c,d){return function(f,p){return n.indexOf(f)!==-1&&t[f]!==1?t[f]+" - "+p[f]+" - 1":""+p[f]}(d,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+t[0]+` - rc - 1),
            `+t[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+t[0]+` - (rc  + 1) - 1),
                `+t[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+i+`){
            result.g = `+function(u){return u[e-1]="("+u[e-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+o+`) {
            result.b = `+function(u){return u[e-2]="("+u[e-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+i+`) {
              result.a = `+function(u){return u[e-1]="("+u[e-1]+" + 1)",u[e-2]="("+u[e-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `}}(),qN=function(){return function(t,n,e,r,i,o,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=jt(i.length),u=jt(o.length),l="";e===1?l="i":e===2&&(l="i, j");var c="getIndices("+l+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",p=n>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+t+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+n+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+p+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}(),QG=function(){return function(t,n){this.variableNames=["x","segmentIds"];var e=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,a=o*Math.ceil(i/e);this.outputShape=[r,a];var s=4*Math.floor(e/4),u=e%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";i%e>0&&(c=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var d="";i%e>0&&(d=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+o+")) * float("+e+`));
        int currentSeg = int(mod(float(outIdx), float(`+o+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `}}(),ZG=function(){return function(t,n,e){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=n,e>4)throw Error("Where for rank "+e+" is not yet supported");if(e===1)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<n.length;u++)s.push(""+o[u]),u<t&&a.push(""+o[u]);r=a.join(),i=s.join()}var l=jt(e);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `}}(),eq=function(){function t(n){this.variableNames=["source"],this.outputShape=n,this.rank=n.length;var e,r=jt(this.rank),i="uniform int start["+this.rank+"];",o=function(a){if(a===1)return"sourceLoc";if(a<=6)return r1.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);e=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+n.map(function(a,s){return"sourceLoc."+r1[s]+" = start["+s+"] + coords."+r1[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+e+`
        setOutput(getSource(`+o+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(n){var e=this;if(n.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+n.length+")");return function(r,i){e.startLoc==null&&(e.startLoc=r.getUniformLocationNoThrow(i,"start"),e.startLoc==null)||r.gl.uniform1iv(e.startLoc,n)}},t}(),r1=["x","y","z","w","u","v"],tq=function(){function t(n){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.rank=n.length;var e=jt(this.rank),r=Ar("coords",this.rank),i=Ar("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",a="getChannel(getSource("+i.join()+"), "+o+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+n[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+a+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+n[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+n[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+e+"("+n.map(function(c,d){return"start["+d+"]"}).join()+");":n.map(function(c,d){return i[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+e+` coords = getOutputCoords();
        `+e+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return t.prototype.getCustomSetupFunc=function(n){var e=this;if(n.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+n.length+")");return function(r,i){e.startLoc==null&&(e.startLoc=r.getUniformLocationNoThrow(i,"start"),e.startLoc==null)||r.gl.uniform1iv(e.startLoc,n)}},t}(),nq=function(){return function(t,n,e){this.variableNames=["x"],this.outputShape=e;var r=e.length,i=jt(e.length),o=jt(e.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=e.map(function(u,l){return s++,e.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+t+`);
      `+i+" strides = "+i+"("+n+`);

      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `}}(),rq=function(){function t(n){this.gpgpu=n,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(n,e,r){var i,o=KN(e,r),a=XN(n,o,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),o===Wr.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(n[0],n[1]):o===Wr.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(n[0],n[1]):o===Wr.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(n[0],n[1]):o===Wr.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(n[0],n[1]):o===Wr.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(n[0],n[1])),this.usedTextures[a].push(i),i},t.prototype.releaseTexture=function(n,e,r,i){if(this.freeTextures!=null){var o=XN(e,KN(r,i),i);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(n),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[o],s=a.indexOf(n);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var n=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+n+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var n=this;if(this.freeTextures!=null){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(r){n.gpgpu.deleteMatrixTexture(r)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(i){n.gpgpu.deleteMatrixTexture(i)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function KN(t,n){if(t===qr.UPLOAD)return Wr.PACKED_2X2_FLOAT32;if(t===qr.RENDER||t==null)return function(e){return ie().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Wr.PACKED_2X2_FLOAT32:Wr.UNPACKED_FLOAT32:e?Wr.PACKED_2X2_FLOAT16:Wr.UNPACKED_FLOAT16}(n);if(t===qr.DOWNLOAD||t===qr.PIXELS)return Wr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function XN(t,n,e){return t[0]+"_"+t[1]+"_"+n+"_"+e}var iq=function(){return function(t,n){this.variableNames=["A"];for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=t[r]*n[r];this.outputShape=e,this.rank=e.length;var i=jt(this.rank),o=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<a.length;c++)l.push("imod("+u[c]+", "+a[c]+")");return l.join()}(t);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `}}(),oq=function(){return function(t,n){this.variableNames=["A"];for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=t[n[r]];this.outputShape=e,this.rank=e.length;var i=jt(this.rank),o=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<a.length;c++)l[a[c]]=u[c];return l.join()}(n);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+o+`));
    }
    `}}(),aq=function(){return function(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=t[n[r]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=jt(this.rank),o=aP("rc",this.rank),a=new Array(this.rank);for(r=0;r<n.length;r++)a[n[r]]=o[r];var s="vec2("+a.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+e[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+o[this.rank-1]+`;
      if(++`+o[this.rank-2]+" < "+e[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `}}(),SE=1.7580993408473768,EE=1.0507009873554805,Je=function(){return function(t,n){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        `+n+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}(),Ki="if (isnan(x)) return x;",sq="return x;",YN="return abs(x);",kP=Ki+`
  return (x < 0.0) ? 0.0 : x;
`,IP=Ki+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,_P="return (x >= 0.0) ? x : (exp(x) - 1.0);",uq=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+SE+`;
  float scale = `+EE+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,JN="return -x;",QN="return ceil(x);",ZN="return floor(x);",ek="return exp(x);",tk="return exp(x) - 1.0;",lq=Ki+`
  return sin(x);
`,cq=Ki+`
  return cos(x);
`,dq=Ki+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,fq=Ki+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,pq=Ki+`
  return atan(x);
`,hq=Ki+"return log(x + sqrt(x * x + 1.0));",mq=Ki+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,vq=Ki+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,wh="return x;",gq="return x;",AP=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,OP=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,DP=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,cd=function(){return function(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+n+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}(),yq=function(){return function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,e=Ar("rc",n),r=jt(n),i=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(n,e),o=e.slice(-2),a=n<=1?"rc":"vec2("+o.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `}}(),xh={};function Sh(t,n){if(n===void 0&&(n=!1),t==="linear")return n?gq:sq;if(t==="relu")return n?AP:kP;if(t==="elu")return n?DP:_P;if(t==="relu6")return n?OP:IP;if(t==="prelu")return n?cP:lP;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var bq=600,MP=function(t){function n(e){var r,i=t.call(this)||this;if(i.gpgpu=e,i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!ie().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){var o=Co(ie().getNumber("WEBGL_VERSION"));i.binaryCache=((r=ie().getNumber("WEBGL_VERSION"))in xh||(xh[r]={}),xh[r]),i.gpgpu=new NP(o),i.canvas=o.canvas,i.gpgpuCreatedLocally=!0}else i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=e.gl.canvas;return i.textureManager=new rq(i.gpgpu),i.numMBBeforeWarning=ie().global.screen==null?1024:ie().global.screen.height*ie().global.screen.width*window.devicePixelRatio*bq/1024/1024,i.texData=new hE(i,K),i}return Hi(n,t),n.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},n.prototype.fromPixels=function(e,r){if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var i=typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement,o=e.data instanceof Uint8Array,a=typeof ImageData<"u"&&e instanceof ImageData,s=typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement,u=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,l=s?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],d=l[1],f=[d,c],p=[d,c,r];if(!(i||o||a||s||u))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);(u||s)&&(this.fromPixels2DContext==null&&(this.fromPixels2DContext=cM(ie().getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=c,this.fromPixels2DContext.canvas.height=d,this.fromPixels2DContext.drawImage(e,0,0,c,d),e=this.fromPixels2DContext.canvas);var h,v,g=this.makeTensorInfo(f,"int32");return this.texData.get(g.dataId).usage=qr.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(g.dataId),e),ie().getBool("WEBGL_PACK")?(h=new kG(p),v=this.compileAndRun(h,[g])):(h=new NG(p),v=this.compileAndRun(h,[g])),this.disposeData(g.dataId),v},n.prototype.write=function(e,r,i){if(ie().getBool("DEBUG")&&this.checkNumericalProblems(e),i==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var o={};return this.texData.set(o,{shape:r,dtype:i,values:e,usage:qr.UPLOAD}),o},n.prototype.move=function(e,r,i,o){if(ie().getBool("DEBUG")&&this.checkNumericalProblems(r),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:i,dtype:o,values:r,usage:qr.UPLOAD})},n.prototype.readSync=function(e){var r=this.texData.get(e),i=r.values,o=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new cd(u,wh):new Je(u,wh);var d=this.runWebGLProgram(c,[{dataId:e,shape:u,dtype:o}],o),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(i!=null)return this.convertAndCacheOnCPU(e);if(o==="string")return i;var p,h,v=this.activeTimers!=null;return v&&(p=Di()),o==="complex64"?h=Cw(a.real.dataSync(),a.imag.dataSync()):h=this.getValuesFromTexture(e),v&&(this.downloadWaitMs+=Di()-p),this.convertAndCacheOnCPU(e,h)},n.prototype.read=function(e){return Oe(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,C,E,S;return De(this,function(k){switch(k.label){case 0:if(this.pendingRead.has(e))return r=this.pendingRead.get(e),[2,new Promise(function(N){return r.push(N)})];if(i=this.texData.get(e),o=i.values,a=i.shape,s=i.slice,u=i.dtype,l=i.complexTensors,c=i.isPacked,s!=null)return d=void 0,d=c?new cd(a,wh):new Je(a,wh),f=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:u}],u),p=this.read(f.dataId),this.disposeData(f.dataId),[2,p];if(o!=null)return[2,this.convertAndCacheOnCPU(e)];if(!ie().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ie().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,u!=="complex64"&&ie().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(e),g=this.texData.get(v.dataId),h=(S=this.gpgpu).createBufferFromTexture.apply(S,[g.texture].concat(Qd(a)))),this.pendingRead.set(e,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:k.sent(),k.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=k.sent(),b=y[0],w=y[1],m=Cw(b,w),[3,5];case 4:h==null?m=this.getValuesFromTexture(e):(x=Pe(a),m=this.gpgpu.downloadFloat32MatrixFromBuffer(h,x)),k.label=5;case 5:return v!=null&&this.disposeData(v.dataId),C=this.convertAndCacheOnCPU(e,m),E=this.pendingRead.get(e),this.pendingRead.delete(e),E.forEach(function(N){return N(C)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,C]}})})},n.prototype.checkNumericalProblems=function(e){if(e!=null)for(var r=0;r<e.length;r++){var i=e[r];if(!dM(i))throw ie().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},n.prototype.getValuesFromTexture=function(e){var r,i=this.texData.get(e),o=i.shape,a=i.dtype,s=i.isPacked,u=Pe(o);if(ie().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(e),c=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(Qd(o))).subarray(0,u);return this.disposeData(l.dataId),d}var f=ie().getBool("WEBGL_PACK")&&s===!0,p=f?mm(o):o,h=f?new xG(p):new wG(p),v=this.runWebGLProgram(h,[{shape:p,dtype:a,dataId:e}],"float32"),g=this.texData.get(v.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(v.dataId),m},n.prototype.time=function(e){return Oe(this,void 0,void 0,function(){var r,i,o,a,s,u,l;return De(this,function(c){switch(c.label){case 0:return r=this.activeTimers,i=[],o=!1,this.programTimersStack==null?(this.programTimersStack=i,o=!0):this.activeTimers.push(i),this.activeTimers=i,e(),a=na(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=na(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,o&&(this.programTimersStack=null),[4,Promise.all(a)];case 1:return u=c.sent(),l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:XD(u),getExtraProfileInfo:function(){return u.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,l]}})})},n.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},n.prototype.startTimer=function(){return ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:Di(),endMs:null}},n.prototype.endTimer=function(e){return ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),e):(e.endMs=Di(),e)},n.prototype.getQueryTime=function(e){return Oe(this,void 0,void 0,function(){var r;return De(this,function(i){return ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(r=e).endMs-r.startMs]})})},n.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var r=this.texData.get(e).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(e)}}},n.prototype.releaseGPUData=function(e){var r=this.texData.get(e),i=r.texture,o=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||e,d=this.dataRefCount.get(c);d>1?this.dataRefCount.set(c,d-1):(this.dataRefCount.delete(c),i!=null&&(this.numBytesInGPU-=this.computeBytes(a,o),this.textureManager.releaseTexture(i,a,s,u)));var f=this.texData.get(e);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},n.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},n.prototype.getDataInfo=function(e){return this.texData.get(e)},n.prototype.getCPUBackend=function(){return ie().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=K.findBackend("cpu")),this.cpuBackend):null},n.prototype.shouldExecuteOnCPU=function(e,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&e.every(function(o){return i.texData.get(o.dataId).texture==null&&o.size<r})},n.prototype.getGPGPUContext=function(){return this.gpgpu},n.prototype.complex=function(e,r){var i=this.makeOutput(e.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:K.keep(e.clone()),imag:K.keep(r.clone())},i},n.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},n.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},n.prototype.slice=function(e,r,i){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,r,i);if(Pe(i)===0)return mn([],i,e.dtype);var o=this.texData.get(e.dataId).isPacked,a=fE(e.shape,r,i);if(o||!a){var s=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tq(i):new eq(i),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[e],null,u)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,r,i)},n.prototype.shallowSlice=function(e,r,i){var o=this.texData.get(e.dataId),a=this.makeOutput(i,e.dtype),s=this.texData.get(a.dataId);Object.assign(s,o),s.shape=i,s.dtype=e.dtype;var u=pE(r,e.strides);o.slice&&(u+=o.slice.flatOffset),s.slice={flatOffset:u,origDataId:o.slice&&o.slice.origDataId||e.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),a},n.prototype.stridedSlice=function(e,r,i,o){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,r,i,o);var a=Tg(r,i,o);if(a.some(function(u){return u===0}))return mn([],a);var s=new nq(r,o,a);return this.compileAndRun(s,[e])},n.prototype.reverse=function(e,r){var i=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new JG(e.shape,r):new YG(e.shape,r);return this.compileAndRun(i,[e])},n.prototype.concat=function(e,r){if(e[0].dtype==="complex64"){var i=e.map(function(p){return _r(p)}),o=e.map(function(p){return vi(p)});return Nn(this.concat(i,r),this.concat(o,r))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,r);if(e.length===1)return e[0];if(e.length>ie().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(e.length/2),s=this.concat(e.slice(0,a),r),u=this.concat(e.slice(a),r);return this.concat([s,u],r)}if(ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var l=new aG(e.map(function(p){return p.shape}),r);return this.compileAndRun(l,e)}var c=cu(e.map(function(p){return p.shape}),r),d=e.map(function(p){return p.as2D(-1,Pe(p.shape.slice(r)))}),f=new oG(d.map(function(p){return p.shape}));return this.compileAndRun(f,d).reshape(c)},n.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(ie().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,JN,e.dtype);var r=new Je(e.shape,JN);return this.compileAndRun(r,[e])},n.prototype.batchMatMul=function(e,r,i,o){var a=i?e.shape[2]:e.shape[1],s=o?r.shape[1]:r.shape[2],u=i?e.shape[1]:e.shape[2],l=e.shape[0];if((a===1||s===1)&&u>1e3){i&&(e=e.transpose([0,2,1])),o&&(r=r.transpose([0,2,1]));var c=s===1?e:e.as3D(l,u,1),d=s===1?2:1,f=s===1?r.as3D(l,1,u):r;return this.multiply(c,f).sum(d,!0)}var p=bn(e.dtype,r.dtype),h=new e1(e.shape,[l,a,s],i,o);return this.compileAndRun(h,[e,r],p)},n.prototype.fusedBatchMatMul=function(e){var r=e.a,i=e.b,o=e.transposeA,a=e.transposeB,s=e.bias,u=e.activation,l=e.preluActivationWeights,c=o?r.shape[2]:r.shape[1],d=a?i.shape[1]:i.shape[2],f=r.shape[0],p=bn(r.dtype,i.dtype),h=s!=null,v=l!=null,g=u?Sh(u,!0):null,m=new e1(r.shape,[f,c,d],o,a,h,g,v),y=[r,i];return s&&y.push(s),l&&y.push(l),this.compileAndRun(m,y,p)},n.prototype.multiply=function(e,r){if(e.dtype==="complex64"){var i=this.texData.get(e.dataId),o=this.texData.get(r.dataId),a=new BN(eG,e.shape,r.shape),s=new BN(tG,e.shape,r.shape),u=[this.makeComplexComponentTensorInfo(e,i.complexTensors.real),this.makeComplexComponentTensorInfo(e,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,o.complexTensors.real),this.makeComplexComponentTensorInfo(r,o.complexTensors.imag)],l=this.compileAndRun(a,u),c=this.compileAndRun(s,u),d=this.complex(l,c);return l.dispose(),c.dispose(),d}if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.multiply(e,r);if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,jN,e.dtype);var f=new an(jN,e.shape,r.shape);return this.compileAndRun(f,[e,r],e.dtype)},n.prototype.batchNormalization=function(e,r,i,o,a,s){var u=[e,r,i],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(a!=null&&(c=a.shape,u.push(a)),ie().getBool("WEBGL_PACK_NORMALIZATION")){var d=new Z7(e.shape,r.shape,i.shape,l,c,o);return this.compileAndRun(d,u)}var f=new Q7(e.shape,r.shape,i.shape,l,c,o);return this.compileAndRun(f,u)},n.prototype.localResponseNormalization4D=function(e,r,i,o,a){var s=ie().getBool("WEBGL_PACK_NORMALIZATION")?new PG(e.shape,r,i,o,a):new DG(e.shape,r,i,o,a);return this.compileAndRun(s,[e])},n.prototype.LRNGrad=function(e,r,i,o,a,s,u){var l=new MG(r.shape,o,a,s,u);return this.compileAndRun(l,[r,i,e])},n.prototype.tile=function(e,r){if(e.dtype==="string"){var i=this.readSync(e.dataId).map(function(a){return Of(a)});return iP(He(e.shape,e.dtype,i),r)}var o=new iq(e.shape,r);return this.compileAndRun(o,[e])},n.prototype.pad=function(e,r,i){var o=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $G(e.shape,r,i):new VG(e.shape,r,i);return this.compileAndRun(o,[e])},n.prototype.transpose=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,r);var i=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aq(e.shape,r):new oq(e.shape,r);return this.compileAndRun(i,[e])},n.prototype.gather=function(e,r,i){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.gather(e,r,i);var o=new IG(e.shape,r.size,i);return this.compileAndRun(o,[e,r])},n.prototype.batchToSpaceND=function(e,r,i){U(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(d,f){return d*f}),a=pv(e.shape,r,o),s=hv(a.length,r.length),u=mv(e.shape,r,o),l=XM(i,r.length),c=YM(u,i,r.length);return e.reshape(a).transpose(s).reshape(u).slice(l,c)},n.prototype.spaceToBatchND=function(e,r,i){U(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var o=r.reduce(function(f,p){return f*p}),a=[[0,0]];a.push.apply(a,i);for(var s=1+r.length;s<e.shape.length;++s)a.push([0,0]);var u=e.pad(a),l=pv(u.shape,r,o,!1),c=hv(l.length,r.length,!1),d=mv(u.shape,r,o,!1);return u.reshape(l).transpose(c).reshape(d)},n.prototype.reduce=function(e,r,i){var o=e.shape[0],a=e.shape[1],s=J0(a),u=new UG({windowSize:s,inSize:a,batchSize:o},r),l=this.compileAndRun(u,[e],i);return l.shape[1]===1?l:this.reduce(l,r,i)},n.prototype.argReduce=function(e,r,i){i===void 0&&(i=null);var o=e.shape[0],a=e.shape[1];i!=null&&(o=i.shape[0],a=i.shape[1]);var s=J0(a),u=new U7({windowSize:s,inSize:a,batchSize:o},r,i==null),l=[e];i!=null&&l.push(i);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(e,r,c)},n.prototype.argReducePacked=function(e,r,i){i===void 0&&(i=null);var o=i!=null?i.shape:e.shape,a=J0(o[o.length-1]),s=new X7(o,a,r,i==null),u=i==null?[e]:[e,i],l=this.compileAndRun(s,u,"int32");return l.rank===e.rank?this.argReducePacked(e,r,l):l},n.prototype.sum=function(e,r){Nr("sum",r,e.rank);var i=Gn(e.shape,r),o=i[0],a=Pe(i[1]),s=e.as2D(-1,a),u=K0(e.dtype);return this.reduce(s,"sum",u).reshape(o)},n.prototype.prod=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,r);var i=Gn(e.shape,r),o=i[0],a=Pe(i[1]),s=e.as2D(-1,a),u=K0(e.dtype);return this.reduce(s,"prod",u).reshape(o)},n.prototype.unsortedSegmentSum=function(e,r,i){var o=0,a=Gi([o],e.rank),s=e;a!=null&&(s=e.transpose(a),o=qi(1,e.rank)[0]);var u=function(p,h,v){for(var g=[],m=p.length,y=0;y<m;y++)y!==h?g.push(p[y]):g.push(v);return g}(s.shape,o,i),l=Pe([s.shape[o]]),c=s.as2D(-1,l),d=K0(e.dtype),f=this.segOpCompute(c,"unsortedSegmentSum",r,d,i).reshape(u);return a!=null&&(f=f.transpose(bg(a))),f},n.prototype.segOpCompute=function(e,r,i,o,a){var s=e.shape[0],u=e.shape[1],l=function(f,p){var h,v=!1;for(f<=QM?(h=f,v=!0):h=dv(f,Math.floor(Math.sqrt(f)));!v;)h>p||h===f?v=!0:h=dv(f,h+1);return h}(u,a),c=new QG({windowSize:l,inSize:u,batchSize:s,numSegments:a},r),d=this.compileAndRun(c,[e,i],o);return d.shape[1]===a?d:(i=wg(0,a).tile([u/l]),this.segOpCompute(d,r,i,o,a))},n.prototype.argMinMaxReduce=function(e,r,i){var o=[r];if(Nr("arg"+i.charAt(0).toUpperCase()+i.slice(1),o,e.rank),!ie().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var a=Gn(e.shape,o),s=a[0],u=Pe(a[1]),l=e.as2D(-1,u);return this.argReduce(l,i).reshape(s)}return this.argReducePacked(e,i)},n.prototype.argMin=function(e,r){return this.argMinMaxReduce(e,r,"min")},n.prototype.argMax=function(e,r){return this.argMinMaxReduce(e,r,"max")},n.prototype.cumsum=function(e,r,i,o){if(r!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+r);var a=new mG(e.shape,i,o);return this.compileAndRun(a,[e])},n.prototype.equal=function(e,r){if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(equal(a, b));
`,"bool");var i=new an("return float(a == b);",e.shape,r.shape);return this.compileAndRun(i,[e,r],"bool")},n.prototype.notEqual=function(e,r){if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new an("return float(a != b);",e.shape,r.shape);return this.compileAndRun(i,[e,r],"bool")},n.prototype.less=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.less(e,r);if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new an("return float(a < b);",e.shape,r.shape);return this.compileAndRun(i,[e,r],"bool")},n.prototype.lessEqual=function(e,r){if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new an("return float(a <= b);",e.shape,r.shape);return this.compileAndRun(i,[e,r],"bool")},n.prototype.greater=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.greater(e,r);if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new an("return float(a > b);",e.shape,r.shape);return this.compileAndRun(i,[e,r],"bool")},n.prototype.greaterEqual=function(e,r){if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new an("return float(a >= b);",e.shape,r.shape);return this.compileAndRun(i,[e,r],"bool")},n.prototype.logicalNot=function(e){var r=new Je(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[e])},n.prototype.logicalAnd=function(e,r){if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new an("return float(a >= 1.0 && b >= 1.0);",e.shape,r.shape);return this.compileAndRun(i,[e,r],"bool")},n.prototype.logicalOr=function(e,r){if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new an("return float(a >= 1.0 || b >= 1.0);",e.shape,r.shape);return this.compileAndRun(i,[e,r],"bool")},n.prototype.select=function(e,r,i){var o=new ZG(e.rank,r.shape,r.rank);return this.compileAndRun(o,[e,r,i],bn(r.dtype,i.dtype))},n.prototype.where=function(e){xw("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=e.dataSync();return wE(e.shape,r)},n.prototype.topk=function(e,r,i){return oP(e.dataSync(),e.shape,e.dtype,r)},n.prototype.min=function(e,r){Nr("min",r,e.rank);var i=Gn(e.shape,r),o=i[0],a=Pe(i[1]),s=e.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(o)},n.prototype.minimum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.minimum(e,r);var i=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Oo(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new an(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,e.shape,r.shape);return this.compileAndRun(i,[e,r])},n.prototype.mod=function(e,r){var i=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Oo(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new an(`if (b == 0.0) return NAN;
  return mod(a, b);`,e.shape,r.shape);return this.compileAndRun(i,[e,r])},n.prototype.max=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,r);Nr("max",r,e.rank);var i=Gn(e.shape,r),o=i[0],a=Pe(i[1]),s=e.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(o)},n.prototype.maximum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.maximum(e,r);var i=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Oo(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new an(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,e.shape,r.shape);return this.compileAndRun(i,[e,r])},n.prototype.all=function(e,r){Nr("all",r,e.rank);var i=Gn(e.shape,r),o=i[0],a=Pe(i[1]),s=e.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(o)},n.prototype.any=function(e,r){Nr("any",r,e.rank);var i=Gn(e.shape,r),o=i[0],a=Pe(i[1]),s=e.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(o)},n.prototype.squaredDifference=function(e,r){var i=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Oo("return (a - b) * (a - b);",e.shape,r.shape):new an("return (a - b) * (a - b);",e.shape,r.shape);return this.compileAndRun(i,[e,r])},n.prototype.realDivide=function(e,r){if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var i=new an(`
if (a == b) {
  return 1.0;
};
return a / b;`,e.shape,r.shape);return this.compileAndRun(i,[e,r],"float32")},n.prototype.floorDiv=function(e,r){if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new an(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,e.shape,r.shape);return this.compileAndRun(i,[e,r],"int32")},n.prototype.add=function(e,r){if(e.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(e,r,Q0);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.add(e,r);var i=bn(e.dtype,r.dtype);if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,Q0,i);var o=new an(Q0,e.shape,r.shape);return this.compileAndRun(o,[e,r],i)},n.prototype.packedUnaryOp=function(e,r,i){var o=new cd(e.shape,r);return this.compileAndRun(o,[e],i)},n.prototype.packedBinaryOp=function(e,r,i,o,a){a===void 0&&(a=!1);var s=new Oo(i,e.shape,r.shape,a);return this.compileAndRun(s,[e,r],o)},n.prototype.complexSeparableBinaryOp=function(e,r,i){var o=this,a=this.texData.get(e.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var p=f[0],h=f[1],v=o.makeComplexComponentTensorInfo(e,p),g=o.makeComplexComponentTensorInfo(r,h),m=new an(i,e.shape,r.shape);return o.compileAndRun(m,[v,g],bn(p.dtype,h.dtype))}),l=u[0],c=u[1],d=this.complex(l,c);return l.dispose(),c.dispose(),d},n.prototype.makeComplexComponentTensorInfo=function(e,r){return{dataId:r.dataId,dtype:r.dtype,shape:e.shape}},n.prototype.addN=function(e){if(e.length===1)return e[0];if(e.length>ie().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(e.length/2),i=this.addN(e.slice(0,r)),o=this.addN(e.slice(r));return this.addN([i,o])}var a=e.map(function(l){return l.dtype}).reduce(function(l,c){return bn(l,c)}),s=e.map(function(l){return l.shape}),u=ie().getBool("WEBGL_PACK")?new $7(e[0].shape,s):new V7(e[0].shape,s);return this.compileAndRun(u,e,a)},n.prototype.subtract=function(e,r){if(e.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(e,r,Z0);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.subtract(e,r);var i=bn(e.dtype,r.dtype);if(ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,Z0,e.dtype);var o=new an(Z0,e.shape,r.shape);return this.compileAndRun(o,[e,r],i)},n.prototype.pow=function(e,r){var i=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Oo(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new an(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,e.shape,r.shape),o=bn(e.dtype,r.dtype);return this.compileAndRun(i,[e,r],o)},n.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(ie().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,QN,e.dtype);var r=new Je(e.shape,QN);return this.compileAndRun(r,[e])},n.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(ie().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ZN,e.dtype);var r=new Je(e.shape,ZN);return this.compileAndRun(r,[e])},n.prototype.sign=function(e){var r=new Je(e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[e])},n.prototype.isNaN=function(e){var r=new Je(e.shape,"return float(isnan(x));");return this.compileAndRun(r,[e],"bool")},n.prototype.isInf=function(e){var r=new Je(e.shape,"return float(isinf(x));");return this.compileAndRun(r,[e],"bool")},n.prototype.isFinite=function(e){var r=new Je(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[e],"bool")},n.prototype.round=function(e){var r=new Je(e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[e])},n.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(ie().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ek,e.dtype);var r=new Je(e.shape,ek);return this.compileAndRun(r,[e])},n.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(ie().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,tk,e.dtype);var r=new Je(e.shape,tk);return this.compileAndRun(r,[e])},n.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(ie().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,e.dtype);var r=new Je(e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[e])},n.prototype.log1p=function(e){var r=new Je(e.shape,"return log(1.0 + x);");return this.compileAndRun(r,[e])},n.prototype.sqrt=function(e){var r=new Je(e.shape,"return sqrt(x);");return this.compileAndRun(r,[e])},n.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var r=new Je(e.shape,"return inversesqrt(x);");return this.compileAndRun(r,[e])},n.prototype.reciprocal=function(e){var r=new Je(e.shape,"return 1.0 / x;");return this.compileAndRun(r,[e])},n.prototype.relu=function(e){var r;return r=ie().getBool("WEBGL_PACK")?new cd(e.shape,AP):new Je(e.shape,kP),this.compileAndRun(r,[e])},n.prototype.relu6=function(e){var r;return r=ie().getBool("WEBGL_PACK")?new cd(e.shape,OP):new Je(e.shape,IP),this.compileAndRun(r,[e])},n.prototype.prelu=function(e,r){var i=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Oo(cP,e.shape,r.shape):new an(lP,e.shape,r.shape);return this.compileAndRun(i,[e,r])},n.prototype.elu=function(e){if(ie().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,DP,e.dtype);var r=new Je(e.shape,_P);return this.compileAndRun(r,[e])},n.prototype.eluDer=function(e,r){var i=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Oo(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,e.shape,r.shape):new an("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,r.shape);return this.compileAndRun(i,[e,r])},n.prototype.selu=function(e){var r=new Je(e.shape,uq);return this.compileAndRun(r,[e])},n.prototype.int=function(e){var r=new Je(e.shape,"return float(int(x));");return this.compileAndRun(r,[e],"int32")},n.prototype.clip=function(e,r,i){var o,a=(o=ie().getBool("WEBGL_PACK_CLIP")?new rG(e.shape):new nG(e.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(o,[e],null,a)},n.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(ie().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,YN,e.dtype);var r=new Je(e.shape,YN);return this.compileAndRun(r,[e])},n.prototype.complexAbs=function(e){var r=this.texData.get(e.dataId),i=new iG(e.shape),o=[this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)];return this.compileAndRun(i,o)},n.prototype.sigmoid=function(e){var r=new Je(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[e])},n.prototype.softplus=function(e){var r=new Je(e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[e])},n.prototype.sin=function(e){var r=new Je(e.shape,lq);return this.compileAndRun(r,[e])},n.prototype.cos=function(e){var r=new Je(e.shape,cq);return this.compileAndRun(r,[e])},n.prototype.tan=function(e){var r=new Je(e.shape,"return tan(x);");return this.compileAndRun(r,[e])},n.prototype.asin=function(e){var r=new Je(e.shape,dq);return this.compileAndRun(r,[e])},n.prototype.acos=function(e){var r=new Je(e.shape,fq);return this.compileAndRun(r,[e])},n.prototype.atan=function(e){var r=new Je(e.shape,pq);return this.compileAndRun(r,[e])},n.prototype.atan2=function(e,r){var i=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Oo(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,r.shape):new an(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,e.shape,r.shape);return this.compileAndRun(i,[e,r])},n.prototype.sinh=function(e){var r=new Je(e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[e])},n.prototype.cosh=function(e){var r=new Je(e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[e])},n.prototype.tanh=function(e){var r=new Je(e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[e])},n.prototype.asinh=function(e){var r=new Je(e.shape,hq);return this.compileAndRun(r,[e])},n.prototype.acosh=function(e){var r=new Je(e.shape,mq);return this.compileAndRun(r,[e])},n.prototype.atanh=function(e){var r=new Je(e.shape,vq);return this.compileAndRun(r,[e])},n.prototype.erf=function(e){var r=new Je(e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[e])},n.prototype.step=function(e,r){var i=new Je(e.shape,function(o){return o===void 0&&(o=0),Ki+`
    return x > 0.0 ? 1.0 : float(`+o+`);
  `}(r));return this.compileAndRun(i,[e])},n.prototype.conv2dByMatMul=function(e,r,i,o,a,s){var u=e.shape,l=this.texData.get(e.dataId),c=i.inChannels,d=u[0]*u[1]*u[2],f=i.outChannels,p=i.dataFormat==="channelsLast",h=(d===1||f===1)&&c>1e3,v=u[2]%2!=0&&!!l.isPacked;if(h||!ie().getBool("WEBGL_LAZILY_UNPACK")||!ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!v){var g=p?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],m=this.reshape(e,[1,g,i.inChannels]),y=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:y,transposeA:!1,transposeB:!1,bias:o,activation:a,preluActivationWeights:s}),i.outShape)}var b=p?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),w={dataId:e.dataId,shape:[1,b,i.inChannels],dtype:e.dtype},x=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,U(Pd(l.shape,w.shape),function(){return"packed reshape "+l.shape+" to "+w.shape+" isn't free"});var C=this.reshape(r,[1,i.inChannels,i.outChannels]),E=this.fusedBatchMatMul({a:w,b:C,transposeA:!1,transposeB:!1,bias:o,activation:a,preluActivationWeights:s}),S=this.texData.get(E.dataId);return U(S.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=x,S.shape=i.outShape,K.makeTensorFromDataId(E.dataId,i.outShape,E.dtype)},n.prototype.conv2dWithIm2Row=function(e,r,i,o,a,s){var u=i.filterWidth,l=i.filterHeight,c=i.inChannels,d=i.outWidth,f=i.outHeight,p=i.dataFormat==="channelsLast",h=u*l*c,v=f*d,g=[h,v],m=e.squeeze([0]),y=r.reshape([1,h,-1]),b=new OG(g,m.shape,i),w=this.compileAndRun(b,[m]).reshape([1,g[0],g[1]]),x=o!=null,C=s!=null,E=a?Sh(a,!0):null,S=new e1(w.shape,[1,v,i.outChannels],!0,!1,x,E,C),k=[w,y];o&&k.push(o),C&&k.push(s);var N=this.compileAndRun(S,k);return p?N.reshape([1,f,d,i.outChannels]):N.reshape([1,i.outChannels,f,d])},n.prototype.fusedConv2d=function(e){var r=e.input,i=e.filter,o=e.convInfo,a=e.bias,s=e.activation,u=e.preluActivationWeights;if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,o,a,s,u);if(ie().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,o,a,s,u);var l=a!=null,c=u!=null,d=s?Sh(s,!1):null,f=new VN(o,l,d,c),p=[r,i];return a&&p.push(a),u&&p.push(u),this.compileAndRun(f,p)},n.prototype.conv2d=function(e,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(e,r,i);if(ie().getBool("WEBGL_CONV_IM2COL")&&e.shape[0]===1)return this.conv2dWithIm2Row(e,r,i);var o=new VN(i);return this.compileAndRun(o,[e,r])},n.prototype.conv2dDerInput=function(e,r,i){var o=new uG(i);return this.compileAndRun(o,[e,r])},n.prototype.conv2dDerFilter=function(e,r,i){var o=new sG(i);return this.compileAndRun(o,[e,r])},n.prototype.fusedDepthwiseConv2D=function(e){var r,i=e.input,o=e.filter,a=e.convInfo,s=e.bias,u=e.activation,l=e.preluActivationWeights,c=ie().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?Sh(u,c):null,f=[i,o],p=s!=null,h=l!=null;return p&&f.push(s),h&&f.push(l),c?(r=new UN(a,p,d,h),this.compileAndRun(r,f)):(r=new $N(a,p,d,h),this.compileAndRun(r,f))},n.prototype.depthwiseConv2D=function(e,r,i){var o;return ie().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(o=new UN(i),this.compileAndRun(o,[e,r])):(o=new $N(i),this.compileAndRun(o,[e,r]))},n.prototype.depthwiseConv2DDerInput=function(e,r,i){var o=new fG(i);return this.compileAndRun(o,[e,r])},n.prototype.depthwiseConv2DDerFilter=function(e,r,i){var o=new dG(i);return this.compileAndRun(o,[e,r])},n.prototype.conv3d=function(e,r,i){var o=new pG(i);return this.compileAndRun(o,[e,r])},n.prototype.conv3dDerInput=function(e,r,i){var o=new cG(i);return this.compileAndRun(o,[e,r])},n.prototype.conv3dDerFilter=function(e,r,i){var o=new lG(i);return this.compileAndRun(o,[e,r])},n.prototype.maxPool=function(e,r){var i=new t1(r,"max",!1);return this.compileAndRun(i,[e])},n.prototype.avgPool=function(e,r){var i=new t1(r,"avg",!1);return this.compileAndRun(i,[e],"float32")},n.prototype.maxPoolBackprop=function(e,r,i,o){var a=new t1(o,"max",!0),s=this.compileAndRun(a,[r]),u=new LG(o),l=this.compileAndRun(u,[e,s],r.dtype);return s.dispose(),l},n.prototype.avgPoolBackprop=function(e,r,i){var o=new Y7(i);return this.compileAndRun(o,[e],r.dtype)},n.prototype.cast=function(e,r){return gE(e,r,this)},n.prototype.unstack=function(e,r){for(var i=e.shape[r],o=new Array(e.rank-1),a=0,s=0;s<e.rank;s++)s!==r&&(o[a++]=e.shape[s]);var u=new Array(e.rank).fill(0),l=e.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(e,u,l).reshape(o);return c},n.prototype.avgPool3d=function(e,r){var i=new n1(r,"avg",!1);return this.compileAndRun(i,[e],"float32")},n.prototype.avgPool3dBackprop=function(e,r,i){var o=new J7(i);return this.compileAndRun(o,[e],r.dtype)},n.prototype.maxPool3d=function(e,r){var i=new n1(r,"max",!1);return this.compileAndRun(i,[e],"float32")},n.prototype.maxPool3dBackprop=function(e,r,i,o){var a=new n1(o,"max",!0),s=this.compileAndRun(a,[r]),u=new FG(o),l=this.compileAndRun(u,[e,s],r.dtype);return s.dispose(),l},n.prototype.reshape=function(e,r){var i=this.texData.get(e.dataId);if(i.isPacked&&!Pd(e.shape,r)&&(i.texture===null||!Pd(i.shape,r))){var o=this.packedReshape(e,r);return K.makeTensorFromDataId(o.dataId,o.shape,o.dtype)}return yv(e,r)},n.prototype.resizeBilinear=function(e,r,i,o){var a=ie().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new qG(e.shape,r,i,o):new GG(e.shape,r,i,o);return this.compileAndRun(a,[e])},n.prototype.resizeBilinearBackprop=function(e,r,i){var o=new HG(e,r,i);return this.compileAndRun(o,[e])},n.prototype.resizeNearestNeighbor=function(e,r,i,o){var a=new XG(e.shape,r,i,o);return this.compileAndRun(a,[e])},n.prototype.resizeNearestNeighborBackprop=function(e,r,i){var o=new KG(e,r,i);return this.compileAndRun(o,[e])},n.prototype.multinomial=function(e,r,i,o){var a=r?e:Ru(e),s=a.shape[0],u=a.shape[1],l=new zG(s,u,i),c=l.getCustomSetupFunc(o);return this.compileAndRun(l,[a],"int32",c)},n.prototype.oneHot=function(e,r,i,o){var a=new BG(e.size,r,i,o);return this.compileAndRun(a,[e])},n.prototype.diag=function(e){var r=new bG(e.size);return this.compileAndRun(r,[e])},n.prototype.nonMaxSuppression=function(e,r,i,o,a){return xw("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),bE(e.dataSync(),r.dataSync(),i,o,a)},n.prototype.cropAndResize=function(e,r,i,o,a,s){var u=new hG(e.shape,r.shape,o,a,s);return this.compileAndRun(u,[e,r,i])},n.prototype.depthToSpace=function(e,r,i){U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var o=e.shape[0],a=i==="NHWC"?e.shape[1]:e.shape[2],s=i==="NHWC"?e.shape[2]:e.shape[3],u=i==="NHWC"?e.shape[3]:e.shape[1],l=a*r,c=s*r,d=u/(r*r),f=new yG(i==="NHWC"?[o,l,c,d]:[o,d,l,c],r,i);return this.compileAndRun(f,[e])},n.prototype.split=function(e,r,i){return rP(e,r,i)},n.prototype.scatterND=function(e,r,i){var o=vv(0,e,i),a=o.sliceRank,s=o.numUpdates,u=o.sliceSize,l=o.strides,c=o.outputSize,d=[c/u,u],f=e.reshape([s,a]),p=r.reshape([s,u]);if(c===0)return yv(mn([]),i);var h=Ie(0),v=new qN(s,a,f.rank,p.rank,l,d);return this.compileAndRun(v,[p,f,h]).reshape(i)},n.prototype.sparseToDense=function(e,r,i,o){var a=vv(0,e,i),s=a.sliceRank,u=a.numUpdates,l=a.strides,c=a.outputSize,d=new qN(u,s,e.rank,r.rank,l,[c,1],!1);return this.compileAndRun(d,[r,e,o]).reshape(i)},n.prototype.fft=function(e){return this.fftImpl(e,!1)},n.prototype.ifft=function(e){return this.fftImpl(e,!0)},n.prototype.fftImpl=function(e,r){var i=this.texData.get(e.dataId),o=new HN(CG,e.shape,r),a=new HN(RG,e.shape,r),s=[this.makeComplexComponentTensorInfo(e,i.complexTensors.real),this.makeComplexComponentTensorInfo(e,i.complexTensors.imag)],u=this.compileAndRun(o,s),l=this.compileAndRun(a,s),c=this.complex(u,l).as2D(e.shape[0],e.shape[1]);return u.dispose(),l.dispose(),c},n.prototype.gatherND=function(e,r){var i=r.shape,o=i[i.length-1],a=JM(e,r),s=a[0],u=a[1],l=a[2],c=a[3],d=r.reshape([u,o]),f=e.reshape([e.size/l,l]),p=new _G(o,c,[u,l]);return this.compileAndRun(p,[f,d]).reshape(s)},n.prototype.fill=function(e,r,i){if((i=i||Cc(r))==="string"){var o=Af(i,Pe(e));return o.fill(r),K.makeTensor(o,e,i,this)}var a=new TG(e,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],i,s)},n.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},n.prototype.zerosLike=function(e){return this.fill(e.shape,e.dtype==="string"?"":0,e.dtype)},n.prototype.linspace=function(e,r,i){return yE(e,r,i)},n.prototype.makeTensorInfo=function(e,r){var i=this.write(null,e,r);return this.texData.get(i).usage=null,{dataId:i,shape:e,dtype:r}},n.prototype.makeOutput=function(e,r){var i=this.makeTensorInfo(e,r).dataId;return K.makeTensorFromDataId(i,e,r,this)},n.prototype.unpackTensor=function(e){var r=new yq(e.shape);return this.runWebGLProgram(r,[e],e.dtype)},n.prototype.packTensor=function(e){var r=new jG(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)},n.prototype.packedReshape=function(e,r){var i=[Pf(e.shape)].concat(Lf(e.shape)),o={dtype:e.dtype,shape:i,dataId:e.dataId},a=[Pf(r)].concat(Lf(r)),s=new WG(a,i),u=this.runWebGLProgram(s,[o],e.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},n.prototype.decode=function(e){var r,i=this.texData.get(e),o=i.isPacked,a=i.shape,s=i.dtype,u=mm(a);return r=o?new gG(u):new vG(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:e}],s,null,!0).dataId}},n.prototype.runWebGLProgram=function(e,r,i,o,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(e.outputShape,i),l=this.texData.get(u.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Mf.DENSE){var c=Qd(e.outputShape);l.texShape=c.map(function(b){return 2*b})}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Pe(u.shape)===0)return l.values=_f(u.dtype,0),u;var d=[],f=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(b.dataId);if(w.texture==null){if(!e.packedInputs&&Pe(b.shape)<=ie().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:w.values};e.packedInputs&&(w.isPacked=!0,w.shape=b.shape)}else if(!!w.isPacked!=!!e.packedInputs)b=w.isPacked?s.unpackTensor(b):s.packTensor(b),d.push(b),w=s.texData.get(b.dataId);else if(w.isPacked&&!Pd(w.shape,b.shape)){var x=b,C=b.shape;b.shape=w.shape,b=s.packedReshape(b,C),d.push(b),w=s.texData.get(b.dataId),x.shape=C}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:w,isUniform:!1}});this.uploadToGPU(u.dataId);var p,h={shape:u.shape,texData:l,isUniform:!1},v=function(b,w,x){var C="";w.concat(x).forEach(function(k){var N=k.texData!=null&&k.texData.slice!=null&&k.texData.slice.flatOffset>0,M=k.isUniform?"uniform":k.texData.texShape;C+=k.shape+"_"+M+"_"+N});var E=b.userCode,S=b.constructor.name;return S+="_"+C+"_"+E}(e,f,h),g=this.getAndSaveBinary(v,function(){return function(b,w,x,C){var E=w.userCode,S=x.map(function(_,F){var L={logicalShape:_.shape,texShape:_.isUniform?null:_.texData.texShape,isUniform:_.isUniform,isPacked:!_.isUniform&&_.texData.isPacked,flatOffset:null};return _.texData!=null&&_.texData.slice!=null&&_.texData.slice.flatOffset>0&&(L.flatOffset=_.texData.slice.flatOffset),{name:w.variableNames[F],shapeInfo:L}}),k=S.map(function(_){return _.shapeInfo}),N={logicalShape:C.shape,texShape:C.texData.texShape,isUniform:!1,isPacked:C.texData.isPacked,flatOffset:null},M=W7(S,N,E,w.packedInputs),D=b.createProgram(M),T=null,O=b.getUniformLocation(D,"NAN",!1);ie().getNumber("WEBGL_VERSION")===1&&(T=b.getUniformLocation(D,"INFINITY",!1));for(var P={},A=0;A<w.variableNames.length;A++){var I=w.variableNames[A];P[I]=b.getUniformLocation(D,I,!1),P["offset"+I]=b.getUniformLocation(D,"offset"+I,!1)}return{program:w,source:M,webGLProgram:D,uniformLocations:P,inShapeInfos:k,outShapeInfo:N,infLoc:T,nanLoc:O}}(s.gpgpu,e,f,h)}),m=this.activeTimers!=null;if(m&&(p=this.startTimer()),function(b,w,x,C,E){GN(w.inShapeInfos,x),GN([w.outShapeInfo],[C]);var S=C.texData.texture,k=C.texData.texShape;C.texData.isPacked?b.setOutputPackedMatrixTexture(S,k[0],k[1]):b.setOutputMatrixTexture(S,k[0],k[1]),b.setProgram(w.webGLProgram),ie().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&b.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&b.gl.uniform1f(w.nanLoc,NaN),x.forEach(function(N,M){var D=w.program.variableNames[M],T=w.uniformLocations[D],O=w.uniformLocations["offset"+D];if(T!=null)if(N.isUniform)if(Pe(N.shape)<2)b.gl.uniform1f(T,N.uniformValues[0]);else{var P=N.uniformValues;P instanceof Float32Array||(P=new Float32Array(P)),b.gl.uniform1fv(T,P)}else N.texData.slice!=null&&O!=null&&b.gl.uniform1i(O,N.texData.slice.flatOffset),b.setInputMatrixTexture(N.texData.texture,T,M)}),E!=null&&E(b,w.webGLProgram),b.executeProgram()}(this.gpgpu,g,f,h,o),d.forEach(function(b){return s.disposeData(b.dataId)}),m&&(p=this.endTimer(p),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(p)})),!ie().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},n.prototype.compileAndRun=function(e,r,i,o,a){a===void 0&&(a=!1),i=i||r[0].dtype;var s=this.runWebGLProgram(e,r,i,o,a);return K.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},n.prototype.getAndSaveBinary=function(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]},n.prototype.getTextureManager=function(){return this.textureManager},n.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.fromPixels2DContext!=null&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},n.prototype.floatPrecision=function(){var e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ee(function(){if(!ie().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=ie().getBool("DEBUG");ie().set("DEBUG",!1);var i=e.abs(Ie(1e-8)).dataSync()[0];if(ie().set("DEBUG",r),i>0)return 32}return 16})),this.floatPrecisionValue},n.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},n.prototype.uploadToGPU=function(e){var r,i=this.texData.get(e),o=i.shape,a=i.dtype,s=i.values,u=i.texture,l=i.usage,c=i.isPacked;if(u==null){var d,f=this.activeTimers!=null;f&&(d=Di());var p=i.texShape;if(p==null&&(p=kM(o,c),i.texShape=p),s!=null){var h=mm(o),v=void 0,g=p[1],m=p[0],y=s instanceof Uint8Array;c?(g=(r=ip(p[0],p[1]))[0],m=r[1],v=new EG(h,[m,g],y)):v=new SG(h,[m,g],y);var b=this.makeTensorInfo([m,g],a);this.texData.get(b.dataId).usage=y?qr.PIXELS:qr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),g,m,s);var w=this.runWebGLProgram(v,[b],a,null,!0),x=this.texData.get(w.dataId);i.texture=x.texture,i.texShape=x.texShape,i.isPacked=x.isPacked,i.usage=x.usage,this.disposeData(b.dataId),this.texData.delete(w.dataId),i.values=null,f&&(this.uploadWaitMs+=Di()-d)}else{var C=this.acquireTexture(p,l,a,c);i.texture=C}}},n.prototype.convertAndCacheOnCPU=function(e,r){var i=this.texData.get(e),o=i.dtype;return this.releaseGPUData(e),r!=null&&(i.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),l=0;l<u.length;++l)u[l]=Math.round(a[l]);return u}throw new Error("Unknown dtype "+s)}(r,o)),i.values},n.prototype.acquireTexture=function(e,r,i,o){if(this.numBytesInGPU+=this.computeBytes(e,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,r,o)},n.prototype.computeBytes=function(e,r){return e[0]*e[1]*qS(r)},n}(mE);uM()&&K.registerBackend("webgl",function(){return new MP},2);var CE=X({square_:function(t){var n=V(t,"x","square"),e=[n];return K.runKernelFunc(function(r,i){return i([n]),r.square(n)},{x:n},function(r,i){var o=i[0];return{x:function(){return r.mul(o.toFloat().mul(2))}}},"Square",{},e,[])}}),ss=X({abs_:function(t){var n=V(t,"x","abs");return n.dtype==="complex64"?K.runKernelFunc(function(e){return e.complexAbs(n)},{$x:n}):K.runKernelFunc(function(e,r){var i=e.abs(n);return r([n]),i},{x:n},function(e,r){var i=r[0];return{x:function(){return e.mul(i.toFloat().step(-1))}}},"Abs")}}),RE=X({acos_:function(t){var n=V(t,"x","acos");return K.runKernelFunc(function(e,r){var i=e.acos(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.divStrict(Ie(1).sub(i.toFloat().square()).sqrt()).neg()}}})}}),TE=X({acosh_:function(t){var n=V(t,"x","acosh");return K.runKernelFunc(function(e,r){var i=e.acosh(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.divStrict(i.toFloat().square().sub(1).sqrt())}}})}}),NE=X({asin_:function(t){var n=V(t,"x","asin");return K.runKernelFunc(function(e,r){var i=e.asin(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.divStrict(Ie(1).sub(i.toFloat().square()).sqrt())}}})}}),kE=X({asinh_:function(t){var n=V(t,"x","asinh");return K.runKernelFunc(function(e,r){var i=e.asinh(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.divStrict(Ie(1).add(i.toFloat().square()).sqrt())}}})}}),IE=X({atan_:function(t){var n=V(t,"x","atan");return K.runKernelFunc(function(e,r){var i=e.atan(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.div(i.toFloat().square().add(1))}}})}}),_E=X({atanh_:function(t){var n=V(t,"x","atanh");return K.runKernelFunc(function(e,r){var i=e.atanh(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.div(Ie(1).sub(i.toFloat().square()))}}})}}),AE=X({ceil_:function(t){var n=V(t,"x","ceil");return K.runKernelFunc(function(e){return e.ceil(n)},{$x:n},function(e){return{$x:function(){return dt(e)}}})}}),br=X({clipByValue_:function(t,n,e){var r=V(t,"x","clipByValue");return U(n<=e,function(){return"Error in clip: min ("+n+") must be less than or equal to max ("+e+")."}),K.runKernelFunc(function(i,o){var a=i.clip(r,n,e);return o([r]),a},{$x:r},function(i,o){var a=o[0];return{$x:function(){return i.where(a.greaterEqual(n).logicalAnd(a.lessEqual(e)),dt(i))}}})}}),OE=X({cos_:function(t){var n=V(t,"x","cos");return K.runKernelFunc(function(e,r){var i=e.cos(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return i.toFloat().sin().neg().mul(e)}}})}}),DE=X({cosh_:function(t){var n=V(t,"x","cosh");return K.runKernelFunc(function(e,r){var i=e.cosh(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(e)}}})}}),ME=X({erf_:function(t){var n=V(t,"x","erf");return U(n.dtype==="int32"||n.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),n.dtype==="int32"&&(n=n.toFloat()),K.runKernelFunc(function(e,r){var i=e.erf(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),PE=X({exp_:function(t){var n=V(t,"x","exp");return K.runKernelFunc(function(e,r){var i=e.exp(n);return r([i]),i},{$x:n},function(e,r){return{$x:function(){return e.mulStrict(r[0])}}})}}),LE=X({expm1_:function(t){var n=V(t,"x","expm1");return K.runKernelFunc(function(e,r){var i=e.expm1(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.mul(i.exp())}}})}}),_g=X({floor_:function(t){var n=V(t,"x","floor");return K.runKernelFunc(function(e){return e.floor(n)},{$x:n},function(e){return{$x:function(){return dt(e)}}})}}),ra=X({log_:function(t){var n=V(t,"x","log");return K.runKernelFunc(function(e,r){var i=e.log(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.div(i.toFloat())}}})}}),FE=X({log1p_:function(t){var n=V(t,"x","log1p");return K.runKernelFunc(function(e,r){var i=e.log1p(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.div(i.add(1))}}})}}),PP=X({logSigmoid_:function(t){var n=V(t,"x","logSigmoid");return K.runKernelFunc(function(e,r){var i=e.softplus(n.neg()).neg();return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.mul(i.neg().sigmoid())}}})}}),Tu=X({neg_:function(t){var n=V(t,"x","neg");return K.runKernelFunc(function(e){return e.neg(n)},{$x:n},function(e){return{$x:function(){return e.neg()}}})}}),zE=X({reciprocal_:function(t){var n=V(t,"x","reciprocal");return K.runKernelFunc(function(e,r){var i=e.reciprocal(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.div(i.square().neg())}}})}}),BE=X({round_:function(t){var n=V(t,"x","round");return K.runKernelFunc(function(e){return e.round(n)},{$x:n},function(e){return{$x:function(){return dt(e)}}})}}),Ag=X({rsqrt_:function(t){var n=V(t,"x","rsqrt");return K.runKernelFunc(function(e,r){var i=e.rsqrt(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.div(i.pow(1.5).mul(2)).neg()}}})}}),Og=X({sigmoid_:function(t){var n=V(t,"x","sigmoid");return K.runKernelFunc(function(e,r){var i=e.sigmoid(n);return r([i]),i},{x:n},function(e,r){var i=r[0];return{x:function(){return e.mul(i.mul(Ie(1).sub(i)))}}},"Sigmoid")}}),jE=X({sign_:function(t){var n=V(t,"x","sign");return K.runKernelFunc(function(e){return e.sign(n)},{$x:n},function(e){return{$x:function(){return dt(e)}}})}}),LP=X({isNaN_:function(t){var n=V(t,"x","isNaN");return K.runKernelFunc(function(e){return e.isNaN(n)},{$x:n},function(e){return{$x:function(){return dt(e)}}})}}),FP=X({isInf_:function(t){var n=V(t,"x","isInf");return K.runKernelFunc(function(e){return e.isInf(n)},{$x:n},function(e){return{$x:function(){return dt(e)}}})}}),zP=X({isFinite_:function(t){var n=V(t,"x","isFinite");return K.runKernelFunc(function(e){return e.isFinite(n)},{$x:n},function(e){return{$x:function(){return dt(e)}}})}}),VE=X({sin_:function(t){var n=V(t,"x","sin");return K.runKernelFunc(function(e,r){var i=e.sin(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return i.toFloat().cos().mul(e)}}})}}),$E=X({sinh_:function(t){var n=V(t,"x","sinh");return K.runKernelFunc(function(e,r){var i=e.sinh(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(e)}}})}}),lp=X({softplus_:function(t){var n=V(t,"x","softplus");return K.runKernelFunc(function(e,r){var i=e.softplus(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.mul(i.sigmoid())}}})}}),cp=X({sqrt_:function(t){var n=V(t,"x","sqrt");return K.runKernelFunc(function(e,r){var i=e.sqrt(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.div(i.toFloat().sqrt().mul(2))}}})}}),BP=X({step_:function(t,n){n===void 0&&(n=0);var e=V(t,"x","step");return K.runKernelFunc(function(r){return r.step(e,n)},{$x:e},function(r){return{$x:function(){return dt(r)}}})}}),UE=X({tan_:function(t){var n=V(t,"x","tan");return K.runKernelFunc(function(e,r){var i=e.tan(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.div(i.cos().square())}}})}}),Dg=X({tanh_:function(t){var n=V(t,"x","tanh");return K.runKernelFunc(function(e,r){var i=e.tanh(n);return r([i]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return Ie(1).sub(i.square()).mulStrict(e)}}})}});function jP(t,n,e,r,i,o){var a,s,u=V(t,"x","batchNorm"),l=V(n,"mean","batchNorm"),c=V(e,"variance","batchNorm");return i!=null&&(a=V(i,"scale","batchNorm")),r!=null&&(s=V(r,"offset","batchNorm")),U(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),U(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&U(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&U(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),dp(u,l,c,s,a,o)}function VP(t,n,e,r,i,o){var a,s,u=V(t,"x","batchNorm"),l=V(n,"mean","batchNorm"),c=V(e,"variance","batchNorm");return i!=null&&(a=V(i,"scale","batchNorm")),r!=null&&(s=V(r,"offset","batchNorm")),U(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),U(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&U(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&U(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),dp(u,l,c,s,a,o)}function $P(t,n,e,r,i,o){var a,s,u=V(t,"x","batchNorm"),l=V(n,"mean","batchNorm"),c=V(e,"variance","batchNorm");return i!=null&&(a=V(i,"scale","batchNorm")),r!=null&&(s=V(r,"offset","batchNorm")),U(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),U(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),U(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&U(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&U(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),dp(u,l,c,s,a,o)}function dp(t,n,e,r,i,o){o==null&&(o=.001);var a,s,u,l=V(t,"x","batchNorm"),c=V(n,"mean","batchNorm"),d=V(e,"variance","batchNorm");i!=null&&(a=V(i,"scale","batchNorm")),r!=null&&(s=V(r,"offset","batchNorm")),U(c.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),U(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),U(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var f=[l,c,d,a];return K.runKernelFunc(function(p,h){var v=p.batchNormalization(u,Eh(c),Eh(d),o,Eh(a),Eh(s));return h([l,c,d,a]),v},{x:l,mean:c,variance:d,scale:a,offset:s},function(p,h){var v=h,g=v[0],m=v[1],y=v[2],b=v[3],w=b??Ie(1),x=Rn(m.shape,u.shape),C=[];if(m.rank===1){for(var E=0;E<u.shape.length-1;++E)C.push(u.shape[E]);C.push(1)}var S=g.sub(m),k=p.mul(w),N=Ag(y.add(Ie(o))),M=N.mul(N).mul(N).mul(Ie(-.5));return{x:function(){return m.rank===1?p.mul(Qa(N.as4D(1,1,1,m.shape[0]),C)).mul(w).reshape(g.shape):p.mul(N).mul(w).reshape(g.shape)},mean:function(){var D=N.mul(Ie(-1)).mul(k);return m.rank===1&&(D=D.sum(x)),D.reshape(m.shape)},variance:function(){var D=M.mul(S).mul(k);return m.rank===1&&(D=D.sum(x)),D.reshape(m.shape)},scale:function(){var D=S.mul(N),T=p.mul(D);return m.rank===1&&(T=T.sum(x)),T.reshape(m.shape)},offset:function(){var D=p;return m.rank===1&&(D=D.sum(x)),D.reshape(m.shape)}}},"BatchNormalization",{varianceEpsilon:o},f).reshape(l.shape)}function Eh(t){return t==null?null:t.rank===0?t.as1D():t.rank===1?t:t.rank===2?t.as4D(1,1,t.shape[0],t.shape[1]):t.rank===3?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function Mg(){yg("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var UP=X({batchNormalization2d_:function(t,n,e,r,i,o){return r===void 0&&(r=.001),Mg(),jP(t,n,e,o,i,r)}}),WP=X({batchNormalization3d_:function(t,n,e,r,i,o){return r===void 0&&(r=.001),Mg(),VP(t,n,e,o,i,r)}}),HP=X({batchNormalization4d_:function(t,n,e,r,i,o){return r===void 0&&(r=.001),Mg(),$P(t,n,e,o,i,r)}}),GP=X({batchNormalization_:function(t,n,e,r,i,o){return r===void 0&&(r=.001),Mg(),dp(t,n,e,o,i,r)}}),WE=X({batchNorm_:dp}),HE=X({batchNorm2d_:jP}),GE=X({batchNorm3d_:VP}),qE=X({batchNorm4d_:$P}),la=X({logicalAnd_:function(t,n){var e=V(t,"a","logicalAnd","bool"),r=V(n,"b","logicalAnd","bool");return lt(e.shape,r.shape),K.runKernelFunc(function(i){return i.logicalAnd(e,r)},{$a:e,$b:r})}}),KE=X({logicalNot_:function(t){var n=V(t,"x","logicalNot","bool");return K.runKernelFunc(function(e){return e.logicalNot(n)},{$x:n})}}),Pg=X({logicalOr_:function(t,n){var e=V(t,"a","logicalOr","bool"),r=V(n,"b","logicalOr","bool");return lt(e.shape,r.shape),K.runKernelFunc(function(i){return i.logicalOr(e,r)},{$a:e,$b:r})}}),qP=X({logicalXor_:function(t,n){var e=V(t,"a","logicalXor","bool"),r=V(n,"b","logicalXor","bool");return lt(e.shape,r.shape),Pg(t,n).logicalAnd(la(t,n).logicalNot())}}),ia=X({where_:function(t,n,e){var r=V(n,"a","where"),i=V(e,"b","where"),o=V(t,"condition","where","bool");return gt(r.shape,i.shape,"Error in where: "),o.rank===1?U(o.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):gt(o.shape,i.shape,"Error in where: "),K.runKernelFunc(function(a,s){var u=a.select(o,r,i);return s([o]),u},{$condition:o,$a:r,$b:i},function(a,s){var u=s[0];return{$condition:function(){return dt(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),Lg=function(t){return Oe(this,void 0,void 0,function(){var n,e,r;return De(this,function(i){switch(i.label){case 0:return[4,(n=V(t,"condition","whereAsync","bool")).data()];case 1:return e=i.sent(),r=wE(n.shape,e),t!==n&&n.dispose(),[2,r]}})})},st=X({add_:function(t,n){var e,r=V(t,"a","add"),i=V(n,"b","add");e=fn(r,i),r=e[0],i=e[1];var o=lt(r.shape,i.shape);return K.runKernelFunc(function(a){return a.add(r,i)},{a:r,b:i},function(a){return{a:function(){var s=a,u=Rn(r.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Rn(i.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(i.shape)}}},"Add")}}),XE=X({addN_:function(t){U(Array.isArray(t),function(){return"The argument passed to tf.addN() must be a list of tensors"}),U(t.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length});var n=t.map(function(i,o){return V(i,"tensors"+o,"addN")}),e=n[0];n.forEach(function(i){if(i.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),n.forEach(function(i){if(!Bn(i.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=n;return K.runKernelFunc(function(i){return i.addN(n)},r,function(i){var o={};return n.forEach(function(a,s){o[s]=function(){return i.clone()}}),o})}}),KP=X({addStrict_:function(t,n){var e=V(t,"a","addStrict"),r=V(n,"b","addStrict");return gt(e.shape,r.shape,"Error in addStrict: "),e.add(r)}}),YE=X({atan2_:function(t,n){var e,r=V(t,"a","atan2"),i=V(n,"b","atan2");e=fn(r,i),r=e[0],i=e[1];var o=lt(r.shape,i.shape);return K.runKernelFunc(function(a,s){var u=a.atan2(r,i);return s([r,i]),u},{$a:r,$b:i},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=st(u.square(),l.square()),d=a.mul(l.div(c)),f=Rn(u.shape,o);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var c=st(u.square(),l.square()),d=Tu(a.mul(u.div(c))),f=Rn(l.shape,o);return f.length>0&&(d=d.sum(f)),d.reshape(l.shape)}}})}}),cr=X({div_:function(t,n){var e,r=V(t,"a","div"),i=V(n,"b","div");if(e=fn(r,i),r=e[0],i=e[1],r.dtype==="int32"&&i.dtype==="int32")return Fg(r,i);var o=lt(r.shape,i.shape);return K.runKernelFunc(function(a,s){var u=a.realDivide(r,i);return s([r,i]),u},{a:r,b:i},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),d=Rn(u.shape,o);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=Rn(l.shape,o);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"Div")}}),XP=X({divStrict_:function(t,n){var e=V(t,"a","div"),r=V(n,"b","div");return gt(e.shape,r.shape,"Error in divideStrict: "),e.div(r)}}),Fg=X({floorDiv_:function(t,n){var e,r=V(t,"a","floorDiv"),i=V(n,"b","floorDiv");e=fn(r,i),r=e[0],i=e[1];var o=lt(r.shape,i.shape);return K.runKernelFunc(function(a,s){var u=a.floorDiv(r,i);return s([r,i]),u},{$a:r,$b:i},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=a.div(l.toFloat()),d=Rn(u.shape,o);return d.length>0?c.sum(d).reshape(u.shape):c},$b:function(){var c=a.mul(u.toFloat()),d=Rn(l.shape,o);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}})}}),To=X({maximum_:function(t,n){var e,r=V(t,"a","maximum"),i=V(n,"b","maximum");return e=fn(r,i),r=e[0],i=e[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),lt(r.shape,i.shape),K.runKernelFunc(function(o,a){var s=o.maximum(r,i);return a([r,i]),s},{$a:r,$b:i},function(o,a){var s=a[0],u=a[1];return{$a:function(){return o.mul(s.greaterEqual(u).toFloat())},$b:function(){return o.mul(s.less(u).toFloat())}}})}}),YP=X({maximumStrict_:function(t,n){var e=V(t,"a","maximumStrict"),r=V(n,"b","maximumStrict");return gt(e.shape,r.shape,"Error in maximumStrict: "),e.maximum(r)}}),kc=X({minimum_:function(t,n){var e,r=V(t,"a","minimum"),i=V(n,"b","minimum");return e=fn(r,i),r=e[0],i=e[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),lt(r.shape,i.shape),K.runKernelFunc(function(o,a){var s=o.minimum(r,i);return a([r,i]),s},{$a:r,$b:i},function(o,a){var s=a[0],u=a[1];return{$a:function(){return o.mul(s.lessEqual(u).toFloat())},$b:function(){return o.mul(s.greater(u).toFloat())}}})}}),JP=X({minimumStrict_:function(t,n){var e=V(t,"a","minimumStrict"),r=V(n,"b","minimumStrict");return gt(e.shape,r.shape,"Error in minimumStrict: "),e.minimum(r)}}),JE=X({mod_:function(t,n){var e,r=V(t,"a","mod"),i=V(n,"b","mod");e=fn(r,i),r=e[0],i=e[1];var o=lt(r.shape,i.shape);return K.runKernelFunc(function(a,s){var u=a.mod(r,i);return s([r,i]),u},{$a:r,$b:i},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=Rn(u.shape,o);return c.length>0?a.sum(c).reshape(u.shape):a},$b:function(){var c=a.mul(u.div(l).floor().neg()),d=Rn(l.shape,o);return d.length>0?c.sum(d).reshape(l.shape):c}}})}}),QP=X({modStrict_:function(t,n){var e=V(t,"a","modStrict"),r=V(n,"b","modStrict");return gt(e.shape,r.shape,"Error in modStrict: "),e.mod(r)}}),We=X({mul_:function(t,n){var e,r=V(t,"a","mul"),i=V(n,"b","mul");e=fn(r,i),r=e[0],i=e[1];var o=lt(r.shape,i.shape);return K.runKernelFunc(function(a,s){var u=a.multiply(r,i);return s([r,i]),u},{a:r,b:i},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.mul(l.toFloat()),d=Rn(u.shape,o);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=Rn(l.shape,o);return d.length>0?c.sum(d).reshape(l.shape):c}}},"Mul")}}),zg=X({mulStrict_:function(t,n){var e=V(t,"a","mul"),r=V(n,"b","mul");return gt(e.shape,r.shape,"Error in multiplyStrict: "),e.mul(r)}}),tc=X({pow_:function(t,n){var e=V(t,"base","pow"),r=V(n,"exp","pow"),i=lt(e.shape,r.shape);return t=e.cast(bn(e.dtype,r.dtype)),n=r.cast(bn(e.dtype,r.dtype)),K.runKernelFunc(function(o,a){var s=o.pow(e,r);return a([e,r,s]),s},{$base:e,$exp:r},function(o,a){var s=a[0],u=a[1],l=a[2];return{$base:function(){var c=u.toFloat(),d=o.mul(c.mul(s.pow(c.sub(Ie(1))))),f=Rn(s.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(s.shape)},$exp:function(){var c=s.greater(0),d=s.log().where(c,dt(s)),f=o.mul(l.mul(d)),p=Rn(u.shape,i);return p.length>0&&(f=f.sum(p)),f.reshape(u.shape)}}})}}),ZP=X({powStrict_:function(t,n){return gt(t.shape,n.shape,"Error in powStrict: "),t.pow(n)}}),QE=X({squaredDifference_:function(t,n){var e,r=V(t,"a","squaredDifference"),i=V(n,"b","squaredDifference");return e=fn(r,i),r=e[0],i=e[1],lt(r.shape,i.shape),K.runKernelFunc(function(o,a){var s=o.squaredDifference(r,i);return a([r,i]),s},{$a:r,$b:i},function(o,a){var s=a[0],u=a[1],l=Ie(2);return{$a:function(){return o.mul(s.sub(u).mul(l))},$b:function(){return o.mul(u.sub(s).mul(l))}}})}}),eL=X({squaredDifferenceStrict_:function(t,n){var e=V(t,"a","squaredDifferenceStrict"),r=V(n,"b","squaredDifferenceStrict");return gt(e.shape,r.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(r)}}),jn=X({sub_:function(t,n){var e,r=V(t,"a","sub"),i=V(n,"b","sub");e=fn(r,i),r=e[0],i=e[1];var o=lt(r.shape,i.shape);return K.runKernelFunc(function(a){return a.subtract(r,i)},{a:r,b:i},function(a){return{a:function(){var s=a,u=Rn(r.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Rn(i.shape,o);return u.length>0&&(s=s.sum(u)),s.neg().reshape(i.shape)}}},"Sub")}}),tL=X({subStrict_:function(t,n){var e=V(t,"a","subStrict"),r=V(n,"b","subStrict");return gt(e.shape,r.shape,"Error in subStrict: "),e.sub(r)}}),Nu=X({equal_:function(t,n){var e,r=V(t,"a","equal"),i=V(n,"b","equal");return e=fn(r,i),r=e[0],i=e[1],lt(r.shape,i.shape),K.runKernelFunc(function(o){return o.equal(r,i)},{$a:r,$b:i})}}),nL=X({equalStrict_:function(t,n){var e=V(t,"a","equalStrict"),r=V(n,"b","equalStrict");return gt(e.shape,r.shape,"Error in equalStrict: "),e.equal(r)}}),Ic=X({greater_:function(t,n){var e,r=V(t,"a","greater"),i=V(n,"b","greater");return e=fn(r,i),r=e[0],i=e[1],lt(r.shape,i.shape),K.runKernelFunc(function(o){return o.greater(r,i)},{$a:r,$b:i})}}),fp=X({greaterEqual_:function(t,n){var e,r=V(t,"a","greaterEqual"),i=V(n,"b","greaterEqual");return e=fn(r,i),r=e[0],i=e[1],lt(r.shape,i.shape),K.runKernelFunc(function(o,a){var s=o.greaterEqual(r,i);return a([r,i]),s},{$a:r,$b:i},function(o,a){var s=a[0],u=a[1];return{$a:function(){return dt(s)},$b:function(){return dt(u)}}})}}),rL=X({greaterEqualStrict_:function(t,n){var e=V(t,"a","greaterEqualStrict"),r=V(n,"b","greaterEqualStrict");return gt(e.shape,r.shape,"Error in greaterEqualStrict: "),e.greaterEqual(r)}}),iL=X({greaterStrict_:function(t,n){var e=V(t,"a","greaterStrict"),r=V(n,"b","greaterStrict");return gt(e.shape,r.shape,"Error in greaterStrict: "),e.greater(r)}}),ZE=X({less_:function(t,n){var e,r=V(t,"a","less"),i=V(n,"b","less");return e=fn(r,i),r=e[0],i=e[1],lt(r.shape,i.shape),K.runKernelFunc(function(o){return o.less(r,i)},{$a:r,$b:i})}}),eC=X({lessEqual_:function(t,n){var e,r=V(t,"a","lessEqual"),i=V(n,"b","lessEqual");return e=fn(r,i),r=e[0],i=e[1],lt(r.shape,i.shape),K.runKernelFunc(function(o){return o.lessEqual(r,i)},{$a:r,$b:i})}}),oL=X({lessEqualStrict_:function(t,n){var e=V(t,"a","lessEqualStrict"),r=V(n,"b","lessEqualStrict");return gt(e.shape,r.shape,"Error in lessEqualStrict: "),e.lessEqual(r)}}),aL=X({lessStrict_:function(t,n){var e=V(t,"a","lessStrict"),r=V(n,"b","lessStrict");return gt(e.shape,r.shape,"Error in lessStrict: "),e.less(r)}}),nc=X({notEqual_:function(t,n){var e,r=V(t,"a","notEqual"),i=V(n,"b","notEqual");return e=fn(r,i),r=e[0],i=e[1],lt(r.shape,i.shape),K.runKernelFunc(function(o){return o.notEqual(r,i)},{$a:r,$b:i})}}),sL=X({notEqualStrict_:function(t,n){var e=V(t,"a","notEqualStrict"),r=V(n,"b","notEqualStrict");return gt(e.shape,r.shape,"Error in notEqualStrict: "),e.notEqual(r)}});function nk(t,n){for(var e=[],r=t;r<n;++r)e.push(r);return e}function rk(t){for(var n=[],e=0;e<t.length;++e)for(var r=0;r<t[e].length;++r)n.push(t[e][r]);return n}var _c=X({gather_:function(t,n,e){e===void 0&&(e=0);var r=V(t,"x","gather"),i=V(n,"indices","gather","int32");e=Vn(e,r.shape)[0];var o=function(a,s,u){for(var l=a.shape[u],c=[],d=1,f=1,p=0;p<u;p++)c.push(a.shape[p]),d*=a.shape[p];for(p=0;p<s.rank;p++)c.push(s.shape[p]);for(p=u+1;p<a.rank;p++)c.push(a.shape[p]),f*=a.shape[p];return{batchSize:d,sliceSize:f,dimSize:l,outputShape:c}}(r,i,e);return K.runKernelFunc(function(a,s){var u=a.gather(r,i.flatten(),e);return s([i]),u},{$x:r},function(a,s){var u=s[0];return{$x:function(){var l=r.shape,c=u.size,d=l.slice(0,e),f=d.length,p=l.slice(e,l.length).slice(1),h=p.length,v=nk(0,f),g=nk(f+1,f+1+h),m=rk([d,[c],p]),y=a.reshape(m),b=u.reshape([c]),w=rk([[f],v,g]),x=y.transpose(w),C=tC(x,b,r.shape[e]),E=bg(w);return C=C.transpose(E)}}}).reshape(o.outputShape)}}),tC=X({unsortedSegmentSum_:function(t,n,e){var r=V(t,"x","unsortedSegmentSum"),i=V(n,"segmentIds","unsortedSegmentSum","int32");return U(rn(e),function(){return"numSegments must be of dtype int"}),K.runKernelFunc(function(o,a){var s=o.unsortedSegmentSum(r,i,e);return a([i]),s},{$x:r},function(o,a){var s=a[0];return{$x:function(){return function(u,l){for(var c=To(l,dt(l)),d=_c(u,c),f=fp(l,Ie(0,"int32")),p=d.rank-f.rank,h=0;h<p;++h)f=Hr(f,h+1);f=la(f,Ro(d.shape,"bool"));var v=dt(d);return ia(f,d,v)}(o,s)}}})}}),uL=function(t,n,e){return Oe(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,d,f,p,h,v;return De(this,function(g){switch(g.label){case 0:for(r=V(t,"tensor","boolMask"),i=V(n,"mask","boolMask","bool"),o=e??0,a=i.rank,s=r.shape,U(a>0,function(){return"mask cannot be scalar"}),gt(s.slice(o,o+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=o;l<o+a;l++)u*=s[l];return c=s.slice(0,o).concat([u],s.slice(o+a)),d=r.reshape(c),f=i.reshape([-1]),[4,Lg(f)];case 1:return p=g.sent(),h=p.squeeze([1]),v=_c(d,h,o),t!==r&&r.dispose(),n!==i&&i.dispose(),h.dispose(),d.dispose(),f.dispose(),p.dispose(),[2,v]}})})};function lL(t,n,e,r,i,o,a){o===void 0&&(o="NHWC"),U(t.length===n.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+n.rank+") must match"});var s=t,u=n,l=!1;n.rank===3&&(l=!0,u=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]),s=[1,t[0],t[1],t[2]]),U(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),U(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),U(e.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank});var c=o==="NHWC"?s[3]:s[1],d=o==="NHWC"?u.shape[3]:u.shape[1];U(c===e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+e.shape[2]+"."}),U(d===e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+e.shape[3]+"."}),a!=null&&U(rn(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var f=Ig(o),p=bs(s,e.shape,r,1,i,a,!1,f),h=K.runKernelFunc(function(v,g){var m=v.conv2dDerInput(u,e,p);return g([e,u]),m},{dy4D:u,filter:e},function(v,g){var m=g[0],y=g[1];return{dy4D:function(){return ku(v,m,r,i,o,1,a)},filter:function(){return nC(v,y,m.shape,r,i,o,a)}}});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function i1(t){var n=function(o){return typeof o=="number"?[o,o,o]:o.length===2?[o[0],o[1],1]:o}(t),e=n[0],r=n[1],i=n[2];return e===1&&r===1&&i===1}function cL(t,n,e,r,i){U(t.length===n.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+n.rank+") must match"});var o=t,a=n,s=!1;n.rank===4&&(s=!0,a=n.as5D(1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]),o=[1,t[0],t[1],t[2],t[3]]);var u=o[4],l=a.shape[4];U(o.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."}),U(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),U(e.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank}),U(u===e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+e.shape[3]+"."}),U(l===e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+e.shape[4]+"."});var c=Bf(o,e.shape,r,1,i),d=K.runKernelFunc(function(f){return f.conv3dDerInput(a,e,c)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var Bg=X({conv1d_:function(t,n,e,r,i,o,a){i===void 0&&(i="NWC"),o===void 0&&(o=1);var s=V(t,"x","conv1d"),u=V(n,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),U(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),U(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&U(rn(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),U(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),U(yr(e,o),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+o+"'"}),U(i==="NWC",function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),p=ku(f,d,[1,e],r,"NHWC",[1,o],a);return c?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),ku=X({conv2d_:function(t,n,e,r,i,o,a){i===void 0&&(i="NHWC"),o===void 0&&(o=[1,1]);var s=V(t,"x","conv2d"),u=V(n,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&U(rn(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=i==="NHWC"?l.shape[3]:l.shape[1];U(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),U(yr(e,o),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+o+"'"});var f=Ig(i),p=bs(l.shape,u.shape,e,o,r,a,!1,f),h=K.runKernelFunc(function(v,g){var m=v.conv2d(l,u,p);return g([u,l]),m},{x:l,$filter:u},function(v,g){var m=g,y=m[0],b=m[1];return U(fu(o),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}),{x:function(){return dL(b.shape,v,y,e,r,i)},$filter:function(){return nC(b,v,y.shape,e,r,i)}}});return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),jg=X({conv3d_:function(t,n,e,r,i,o){i===void 0&&(i="NDHWC"),o===void 0&&(o=[1,1,1]);var a=V(t,"x","conv3d"),s=V(n,"filter","conv3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),U(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),U(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),U(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),U(function(f,p){return i1(f)||i1(p)}(e,o),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+o+"'"}),U(i==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=Bf(u.shape,s.shape,e,o,r),d=K.runKernelFunc(function(f,p){var h=f.conv3d(u,s,c);return p([u,s]),h},{x:u,$filter:s},function(f,p){U(i1(o),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"});var h=p[0],v=p[1];return{x:function(){return cL(h.shape,f,v,e,r)},$filter:function(){return function(g,m,y,b,w){var x=g;g.rank===4&&(x=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var C=m;C.rank===4&&(C=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),U(x.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+x.shape+"."}),U(C.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+C.shape+"."}),U(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),U(x.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+x.shape[4]+") must match input depth in filter ("+y[3]+"."}),U(C.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+C.shape[4]+") must match output depth for filter ("+y[4]+")."});var E=Bf(x.shape,y,b,1,w);return K.runKernelFunc(function(S){return S.conv3dDerFilter(x,C,E)},{x5D:x,dy5D:C})}(h,f,v.shape,e,r)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),nC=X({conv2dDerFilter_:function(t,n,e,r,i,o,a){o===void 0&&(o="NHWC");var s=t;t.rank===3&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=n;u.rank===3&&(u=n.as4D(1,n.shape[0],n.shape[1],n.shape[2])),U(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),U(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),U(e.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."});var l=o==="NHWC"?s.shape[3]:s.shape[1],c=o==="NHWC"?u.shape[3]:u.shape[1];U(l===e[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+e[2]+"."}),U(c===e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+e[3]+")."}),a!=null&&U(rn(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var d=Ig(o),f=bs(s.shape,e,r,1,i,a,!1,d);return K.runKernelFunc(function(p){return p.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),dL=X({conv2dDerInput_:lL}),Ac=X({depthwiseConv2d_:function(t,n,e,r,i,o,a){o===void 0&&(o=[1,1]);var s=V(t,"x","depthwiseConv2d"),u=V(n,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),o==null&&(o=[1,1]),U(yr(e,o),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+o+"'"}),a!=null&&U(rn(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=bs(l.shape,u.shape,e,o,r,a,!0),f=K.runKernelFunc(function(p,h){var v=p.depthwiseConv2D(l,u,d);return h([l,u]),v},{x:l,$filter:u},function(p,h){U(fu(o),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"});var v=h[0],g=h[1];return{x:function(){return fL(v.shape,p,g,d)},$filter:function(){return pL(v,p,g.shape,d)}}});return c?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),fL=X({depthwiseConv2dDerInput_:function(t,n,e,r){var i=n,o=!1;n.rank===3&&(o=!0,i=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var a=K.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(i,e,r)},{dy4D:i});return o?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),pL=X({depthwiseConv2dDerFilter_:function(t,n,e,r){var i=t;t.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=n;return o.rank===3&&(o=n.as4D(1,n.shape[0],n.shape[1],n.shape[2])),K.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(i,o,r)},{x4D:i,dy4D:o})}}),rC=X({separableConv2d_:function(t,n,e,r,i,o,a){o===void 0&&(o=[1,1]),a===void 0&&(a="NHWC");var s=V(t,"x","separableConv2d"),u=V(n,"depthwiseFilter","separableConv2d"),l=V(e,"pointwiseFilter","separableConv2d"),c=s,d=!1;if(s.rank===3&&(d=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");U(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),U(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),U(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var f=u.shape[2],p=u.shape[3];U(l.shape[2]===f*p,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*p+", but got "+l.shape[2]+"."});var h=Ac(c,u,r,i,a,o),v=ku(h,l,1,"valid",a);return d?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),Vg=X({conv2dTranspose_:function(t,n,e,r,i,o){return lL(e,V(t,"x","conv2dTranspose"),V(n,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),hL=X({conv3dTranspose_:function(t,n,e,r,i){return cL(e,V(t,"x","conv3dTranspose"),V(n,"filter","conv3dTranspose"),r,i)}}),$g=X({matMul_:function(t,n,e,r){var i;e===void 0&&(e=!1),r===void 0&&(r=!1);var o=V(t,"a","matMul"),a=V(n,"b","matMul");i=fn(o,a),o=i[0],a=i[1];var s=e?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=e?o.shape[o.rank-1]:o.shape[o.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=o.shape.slice(0,-2),f=a.shape.slice(0,-2),p=Pe(d),h=Pe(f);U(o.rank>=2&&a.rank>=2&&o.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+a.rank+"."}),U(Bn(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+o.shape+" and "+a.shape+" must match."}),U(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+o.shape+" and "+a.shape+" and transposeA="+e+" and transposeB="+r+" must match."});var v=o.shape.slice(0,-2).concat([l,c]),g=e?o.as3D(p,s,l):o.as3D(p,l,s),m=r?a.as3D(h,c,u):a.as3D(h,u,c),y={transposeA:e,transposeB:r};return K.runKernelFunc(function(b,w){var x=b.batchMatMul(g,m,e,r);return w([g,m]),x},{a:g,b:m},function(b,w){var x=w,C=x[0],E=x[1];return e||r?!e&&r?{a:function(){return b.matMul(E,!1,!1)},b:function(){return b.matMul(C,!0,!1)}}:e&&!r?{a:function(){return E.matMul(b,!1,!0)},b:function(){return C.matMul(b,!1,!1)}}:{a:function(){return E.matMul(b,!0,!0)},b:function(){return b.matMul(C,!0,!0)}}:{a:function(){return b.matMul(E,!1,!0)},b:function(){return C.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(v)}}),mL=X({dot_:function(t,n){var e=V(t,"t1","dot"),r=V(n,"t2","dot");U(!(e.rank!==1&&e.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+r.rank+"."});var i=e.rank===1?e.size:e.shape[1],o=r.rank===1?r.size:r.shape[0];return U(i===o,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."}),e.rank===1&&r.rank===1?e.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():e.rank===1&&r.rank===2?e.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():e.rank===2&&r.rank===1?e.matMul(r.as2D(-1,1)).as1D():e.matMul(r.as2D(r.shape[0],r.shape[1]))}}),vL=X({outerProduct_:function(t,n){var e=V(t,"v1","outerProduct"),r=V(n,"v2","outerProduct");return U(e.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+r.rank+"."}),e.as2D(-1,1).matMul(r.as2D(1,-1))}}),So=X({reverse_:function(t,n){var e=V(t,"x","reverse");if(e.rank===0)return e.clone();var r=Vn(n,e.shape);return K.runKernelFunc(function(i){return i.reverse(e,r)},{$x:e},function(i){return{$x:function(){return i.reverse(r)}}}).reshapeAs(e)}}),gL=X({reverse1d_:function(t){var n=V(t,"x","reverse");return U(n.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+n.rank+"."}),So(n,0)}}),yL=X({reverse2d_:function(t,n){var e=V(t,"x","reverse");return U(e.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."}),So(e,n)}}),bL=X({reverse3d_:function(t,n){var e=V(t,"x","reverse");return U(e.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."}),So(e,n)}}),wL=X({reverse4d_:function(t,n){var e=V(t,"x","reverse");return U(e.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."}),So(e,n)}});function xL(t,n,e,r,i,o){var a=V(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),r==null&&(r=[1,1]),U(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),U(yr(e,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"}),o!=null&&U(rn(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var l=ec(s.shape,n,e,r,i,o),c=K.runKernelFunc(function(d,f){var p=d.maxPool(s,l);return f([s,p]),p},{x:s},function(d,f){var p=f[0],h=f[1];return{x:function(){return function(v,g,m,y,b,w,x,C){var E=V(v,"dy","maxPoolBackprop"),S=V(g,"input","maxPoolBackprop"),k=V(m,"output","maxPoolBackprop");U(S.rank===E.rank,function(){return"Rank of input ("+S.rank+") does not match rank of dy ("+E.rank+")"}),w==null&&(w=[1,1]),U(yr(b,w),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+w+"'"}),U(E.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),U(S.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+S.rank+"."}),C!=null&&U(rn(x),function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+x+"."});var N=ec(S.shape,y,b,w,x,C);return K.runKernelFunc(function(M){return M.maxPoolBackprop(E,S,k,N)},{$dy:E,$input:S})}(d,p,h,n,e,r,i)}}});return u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}function SL(t,n,e,r,i,o){var a=V(t,"x","avgPool","float32");r==null&&(r=[1,1]),U(yr(e,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),U(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),o!=null&&U(rn(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var l=ec(s.shape,n,e,r,i,o),c=K.runKernelFunc(function(d){return d.avgPool(s,l)},{x:s},function(d){return{x:function(){return function(f,p,h,v,g,m){var y=V(f,"dy","avgPoolBackprop"),b=V(p,"input","avgPoolBackprop");U(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),g==null&&(g=[1,1]),U(yr(v,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+v+" and dilations '"+g+"'"});var w=b,x=y,C=!1;b.rank===3&&(C=!0,w=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),x=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),U(x.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+x.rank+"."}),U(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var E=ec(w.shape,h,v,g,m),S=K.runKernelFunc(function(k){return k.avgPoolBackprop(x,w,E)},{dy4D:x,input4D:w});return C?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}(d,s,n,e,r,i)}}});return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var Ug=X({maxPool_:function(t,n,e,r,i){return xL(t,n,e,1,r,i)}}),Wg=X({avgPool_:function(t,n,e,r,i){return SL(t,n,e,1,r,i)}}),EL=X({pool_:function(t,n,e,r,i,o){i==null&&(i=[1,1]),o==null&&(o=1),r===0&&(r="valid");var a=V(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),U(yr(o,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"});var l,c=ec(s.shape,n,o,i,r),d=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(w,x){var C=w.map(function(k,N){return k+(k-1)*(x[N]-1)}).map(function(k){return k-1}),E=C.map(function(k){return Math.floor(k/2)}),S=C.map(function(k,N){return k-E[N]});return C.map(function(k,N){return[E[N],S[N]]})}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,p=function(w,x,C){var E=C.map(function(O){return O[0]}),S=C.map(function(O){return O[1]}),k=w.concat(E,S),N=x.map(function(O,P){return(O-k[P]%O)%O}),M=S.map(function(O,P){return O+N[P]}),D=x.map(function(O,P){return[E[P],M[P]]}),T=x.map(function(O,P){return[0,N[P]]});return[D,T]}([c.inHeight,c.inWidth],d,l),h=p[0],v=p[1],g=f?r:"valid",m=f?s:Rg(s,d,h),y=(e==="avg"?function(){return SL(m,n,o,1,g)}:function(){return xL(m,n,o,1,g)})(),b=f?y:Sg(y,d,v);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),Hg=X({maxPool3d_:function(t,n,e,r,i,o,a){o===void 0&&(o="NDHWC");var s=V(t,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),U(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(o==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),U(yr(e,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+a+"'"}),i!=null&&U(rn(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=zf(u.shape,n,e,a,r,i,o),d=K.runKernelFunc(function(f,p){var h=f.maxPool3d(u,c);return p([u,h]),h},{x:u},function(f,p){var h=p[0],v=p[1];return{x:function(){return function(g,m,y,b,w,x,C,E){var S=V(g,"dy","maxPool3dBackprop"),k=V(m,"input","maxPool3dBackprop"),N=V(y,"output","maxPool3dBackprop"),M=S,D=k,T=N,O=!1;k.rank===4&&(O=!0,M=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3]),D=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),T=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3])),U(M.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+M.rank+"."}),U(D.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+D.rank+"."}),U(T.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+T.rank+"."}),x==null&&(x=[1,1,1]),U(yr(w,x),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+x+"'"}),E!=null&&U(rn(C),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+E+" but got pad "+C+"."});var P=zf(D.shape,b,w,x,C,E),A=K.runKernelFunc(function(I){return I.maxPool3dBackprop(M,D,T,P)},{dy5D:M,input5D:D});return O?A.as4D(A.shape[1],A.shape[2],A.shape[3],A.shape[4]):A}(f,h,v,n,e,a,r,i)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Gg=X({avgPool3d_:function(t,n,e,r,i,o,a){o===void 0&&(o="NDHWC");var s=V(t,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),U(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(o==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o}),U(yr(e,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+a+"'"}),i!=null&&U(rn(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=zf(u.shape,n,e,a,r,i,o),d=K.runKernelFunc(function(f){return f.avgPool3d(u,c)},{x:u},function(f){return{x:function(){return function(p,h,v,g,m,y,b){var w=V(p,"dy","avgPool3dBackprop"),x=V(h,"input","avgPool3dBackprop"),C=w,E=x,S=!1;x.rank===4&&(S=!0,C=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),E=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3])),U(C.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+C.rank+"."}),U(E.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+E.rank+"."}),m==null&&(m=[1,1,1]),U(yr(g,m),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+m+"'"}),b!=null&&U(rn(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var k=zf(E.shape,v,g,m,y,b),N=K.runKernelFunc(function(M){return M.avgPool3dBackprop(C,E,k)},{dy5D:C,input5D:E});return S?N.as4D(N.shape[1],N.shape[2],N.shape[3],N.shape[4]):N}(f,u,n,e,a,r,i)}}});return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),ni=X({slice_:function(t,n,e){var r,i,o=V(t,"x","slice");if(o.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof n=="number"?[n].concat(new Array(o.rank-1).fill(0)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(0)):n.slice()).forEach(function(u){U(u!==-1,function(){return"slice() does not support negative begin indexing."})}),i=(i=e==null?new Array(o.rank).fill(-1):typeof e=="number"?[e].concat(new Array(o.rank-1).fill(-1)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(-1)):e).map(function(u,l){return u>=0?u:(U(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),o.shape[l]-r[l])}),ZM(o,r,i);var a=o.shape,s={begin:r,size:i};return K.runKernelFunc(function(u){return u.slice(o,r,i)},{x:o},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],a[c]-r[c]-i[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),pp=X({slice1d_:function(t,n,e){var r=V(t,"x","slice1d");return U(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),ni(r,[n],[e])}}),qg=X({slice2d_:function(t,n,e){var r=V(t,"x","slice2d");return U(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),ni(r,n,e)}}),hp=X({slice3d_:function(t,n,e){var r=V(t,"x","slice3d");return U(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),ni(r,n,e)}}),rc=X({slice4d_:function(t,n,e){var r=V(t,"x","slice4d");return U(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),ni(r,n,e)}});function CL(t,n,e,r,i){return n.rank<e.rank&&(n=n.reshape(ei(n.shape,r))),t.rank<e.rank&&(t=t.reshape(ei(t.shape,r))),{$x:function(){var o=t.mul(e.equal(n).cast(t.dtype));return i==null?o:o.transpose(i)}}}var Kg=X({all_:function(t,n,e){n===void 0&&(n=null),e===void 0&&(e=!1);var r=V(t,"x","all","bool"),i=Vn(n,r.shape),o=i,a=Gi(o,r.rank);a!=null&&(r=r.transpose(a),o=qi(o.length,r.rank));var s=K.runKernelFunc(function(l){return l.all(r,o)},{$x:r});if(e){var u=ei(s.shape,i);return s.reshape(u)}return s}}),jf=X({any_:function(t,n,e){n===void 0&&(n=null),e===void 0&&(e=!1);var r=V(t,"x","any","bool"),i=Vn(n,r.shape),o=i,a=Gi(o,r.rank);a!=null&&(r=r.transpose(a),o=qi(o.length,r.rank));var s=K.runKernelFunc(function(l){return l.any(r,o)},{$x:r});if(e){var u=ei(s.shape,i);return s.reshape(u)}return s}}),Vf=X({argMax_:function(t,n){n===void 0&&(n=0);var e=V(t,"x","argMax");n==null&&(n=0);var r=Vn(n,e.shape),i=Gi(r,e.rank);return i!=null&&(e=e.transpose(i),r=qi(r.length,e.rank)),K.runKernelFunc(function(o,a){var s=o.argMax(e,r[0]);return a([e]),s},{$x:e},function(o,a){var s=a[0];return{$x:function(){return dt(s)}}})}}),iC=X({argMin_:function(t,n){n===void 0&&(n=0);var e=V(t,"x","argMin");n==null&&(n=0);var r=Vn(n,e.shape),i=Gi(r,e.rank);return i!=null&&(e=e.transpose(i),r=qi(r.length,e.rank)),K.runKernelFunc(function(o,a){var s=o.argMin(e,r[0]);return a([e]),s},{$x:e},function(o,a){var s=a[0];return{$x:function(){return dt(s)}}})}}),RL=X({logSumExp_:function(t,n,e){n===void 0&&(n=null),e===void 0&&(e=!1);var r=V(t,"x","logSumExp"),i=Vn(n,r.shape),o=r.max(i,!0),a=r.sub(o).exp().sum(i).log(),s=o.reshape(a.shape).add(a);if(e){var u=ei(s.shape,i);return s.reshape(u)}return s}}),us=X({max_:function(t,n,e){n===void 0&&(n=null),e===void 0&&(e=!1);var r=V(t,"x","max"),i=r,o=Vn(n,r.shape),a=o,s=Gi(a,r.rank);s!=null&&(r=r.transpose(s),a=qi(a.length,r.rank));var u=K.runKernelFunc(function(c,d){var f=c.max(r,a);return d([i,f]),f},{$x:r},function(c,d){return CL(c,d[1],d[0],o,s)});if(e){var l=ei(u.shape,o);u=u.reshape(l)}return u}}),gn=X({mean_:function(t,n,e){n===void 0&&(n=null),e===void 0&&(e=!1);var r=V(t,"x","mean"),i=Vn(n,r.shape),o=Pe(Gn(r.shape,i)[1]);return Nc(function(a){var s=Ie(o);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(n,e),gradFunc:function(u){var l=a.shape.slice();return i.forEach(function(c){l[c]=1}),u.reshape(l).mul(Ro(a.shape,"float32")).div(o)}}})(r)}}),Xg=X({min_:function(t,n,e){n===void 0&&(n=null),e===void 0&&(e=!1);var r=V(t,"x","min"),i=r,o=Vn(n,r.shape),a=o,s=Gi(a,r.rank);s!=null&&(r=r.transpose(s),a=qi(a.length,r.rank));var u=K.runKernelFunc(function(c,d){var f=c.min(r,a);return d([i,f]),f},{$x:r},function(c,d){return CL(c,d[1],d[0],o,s)});if(e){var l=ei(u.shape,o);u=u.reshape(l)}return u}}),mp=X({moments_:function(t,n,e){n===void 0&&(n=null),e===void 0&&(e=!1);var r=Vn(n,(t=V(t,"x","moments")).shape),i=t.mean(r,e),o=i.shape;e||(o=ei(i.shape,r));var a=t.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:a.mean(r,e)}}}),Br=X({sum_:function(t,n,e){n===void 0&&(n=null),e===void 0&&(e=!1);var r=V(t,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=Vn(n,r.shape);return Nc(function(o){var a=Gi(i,o.rank),s=i,u=o;a!=null&&(u=o.transpose(a),s=qi(s.length,o.rank));var l=K.runKernelFunc(function(d){return d.sum(u,s)},{permutedX:u});if(e){var c=ei(l.shape,i);l=l.reshape(c)}return{value:l,gradFunc:function(d){var f=o.shape.slice();return i.forEach(function(p){f[p]=1}),d.reshape(f).mul(Ro(o.shape,"float32"))}}})(r)}}),Yg=X({prod_:function(t,n,e){n===void 0&&(n=null),e===void 0&&(e=!1);var r=V(t,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=Vn(n,r.shape),o=Gi(i,r.rank),a=i,s=r;o!=null&&(s=r.transpose(o),a=qi(a.length,r.rank));var u=K.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(e){var l=ei(u.shape,i);u=u.reshape(l)}return u}}),Oc=X({elu_:function(t){var n=V(t,"x","elu");return K.runKernelFunc(function(e,r){var i=e.elu(n);return r([i]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return K.runKernelFunc(function(o){return o.eluDer(e,i)},{dy:e,y:i})}}})}}),Jg=X({leakyRelu_:function(t,n){n===void 0&&(n=.2);var e=V(t,"x","leakyRelu");return To(Ie(n).mul(e),e)}}),Qg=X({prelu_:function(t,n){var e=V(t,"x","prelu"),r=V(n,"alpha","prelu");return K.runKernelFunc(function(i,o){var a=i.prelu(e,r);return o([e,r]),a},{x:e,alpha:r},function(i,o){var a=o[0],s=o[1],u=a.greater(0);return{x:function(){return ia(u,i,i.mul(s))},alpha:function(){var l=ia(u,dt(i),i.mul(a)),c=Rn(s.shape,i.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),ws=X({relu_:function(t){var n=V(t,"x","relu");return n.dtype==="bool"?n.toInt():K.runKernelFunc(function(e,r){var i=e.relu(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){return e.mulStrict(i.step().toFloat())}}})}}),oC=X({relu6_:function(t){var n=V(t,"x","relu6");return n.dtype==="bool"?n.toInt():K.runKernelFunc(function(e,r){var i=e.relu6(n);return r([n]),i},{$x:n},function(e,r){var i=r[0],o=i.lessEqual(6).mul(i.step());return{$x:function(){return e.mulStrict(o.toFloat())}}})}}),Zg=X({selu_:function(t){var n=V(t,"x","selu");return K.runKernelFunc(function(e,r){var i=e.selu(n);return r([n]),i},{$x:n},function(e,r){var i=r[0];return{$x:function(){var o=i.greater(Ie(0)),a=Ie(SE),s=Ie(EE),u=e.mul(s),l=e.mul(a).mul(i.toFloat().exp());return ia(o,u,l)}}})}}),en=X({transpose_:function(t,n){var e=V(t,"x","transpose");return n==null&&(n=e.shape.map(function(r,i){return i}).reverse()),U(e.rank===n.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+n+"."}),n.forEach(function(r){U(r>=0&&r<e.rank,function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+n})}),e.rank<=1?e.clone():K.runKernelFunc(function(r){return r.transpose(e,n)},{$x:e},function(r){var i=bg(n);return{$x:function(){return r.transpose(i)}}})}}),aC=X({localResponseNormalization_:function(t,n,e,r,i){n===void 0&&(n=5),e===void 0&&(e=1),r===void 0&&(r=1),i===void 0&&(i=.5);var o=V(t,"x","localResponseNormalization");U(o.rank===4||o.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+o.rank+"."}),U(rn(n),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+n+"."});var a=o,s=!1;o.rank===3&&(s=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=K.runKernelFunc(function(l,c){var d=l.localResponseNormalization4D(a,n,e,r,i);return c([a,d]),d},{x4D:a},function(l,c){var d=c[0],f=c[1];return{x4D:function(){return K.runKernelFunc(function(p){return p.LRNGrad(l,d,f,n,e,r,i)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),sC=X({norm_:function(t,n,e,r){n===void 0&&(n="euclidean"),e===void 0&&(e=null),r===void 0&&(r=!1);var i=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(Ie(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(t=V(t,"x","norm"),n,e),o=i.shape;if(r){var a=Vn(e,t.shape);o=ei(i.shape,a)}return i.reshape(o)}}),TL=X({basicLSTMCell_:function(t,n,e,r,i,o){var a=V(t,"forgetBias","basicLSTMCell"),s=V(n,"lstmKernel","basicLSTMCell"),u=V(e,"lstmBias","basicLSTMCell"),l=V(r,"data","basicLSTMCell"),c=V(i,"c","basicLSTMCell"),d=V(o,"h","basicLSTMCell"),f=l.concat(d,1).matMul(s).add(u),p=f.shape[0],h=f.shape[1]/4,v=[p,h],g=f.slice([0,0],v),m=f.slice([0,h],v),y=f.slice([0,2*h],v),b=f.slice([0,3*h],v),w=g.sigmoid().mulStrict(m.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),x=w.tanh().mulStrict(b.sigmoid());return[w,x]}}),NL=X({multiRNNCell_:function(t,n,e,r){for(var i=V(n,"data","multiRNNCell"),o=Ff(e,"c","multiRNNCell"),a=Ff(r,"h","multiRNNCell"),s=i,u=[],l=0;l<t.length;l++){var c=t[l](s,o[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var d=[],f=[];for(l=0;l<u.length;l+=2)d.push(u[l]),f.push(u[l+1]);return[d,f]}}),kL=X({movingAverage_:function(t,n,e,r,i){i===void 0&&(i=!0);var o=V(t,"v","movingAverage"),a=V(n,"x","movingAverage"),s=V(e,"decay","movingAverage");sM(o,a),U(Bn(o.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=Ie(1),l=u.sub(s),c=a.sub(o).mul(l);if(i){U(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=V(r,"step","movingAverage");c=c.div(u.sub(tc(s,d)))}return o.add(c)}}),uC=X({stridedSlice_:function(t,n,e,r,i,o,a,s,u){if(i===void 0&&(i=0),o===void 0&&(o=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(n.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var l=V(t,"x","stridedSlice"),c=Sw(s),d=l.shape.slice();c.forEach(function(g){n[g]=0,e[g]=1,d.splice(g,0,1)}),l=l.reshape(d);for(var f=0;f<l.rank;f++)n[f]=eP(i,n,r,l.shape,f),e[f]=tP(o,e,r,l.shape,f),r[f]=r[f]||1;var p=Sw(u);p.forEach(function(g){e[g]=n[g]+1,r[g]=1});var h=Tg(n,e,r),v=h.filter(function(g,m){return p.indexOf(m)===-1});return r.every(function(g){return g===1})?ni(l,n,h).reshape(v):K.runKernelFunc(function(g){return g.stridedSlice(l,n,e,r)},{$x:l}).reshape(v)}}),lC=X({topk_:function(t,n,e){n===void 0&&(n=1),e===void 0&&(e=!0);var r=V(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(n>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+n);var o=K.runKernelFunc(function(a){return a.topk(r,n,e)},{$x:r});return{values:o[0],indices:o[1]}}}),cC=X({scatterND_:function(t,n,e){var r=V(t,"indices","scatterND","int32"),i=V(n,"updates","scatterND");return A7(i,r,e),K.runKernelFunc(function(o){return o.scatterND(r,i,e)},{$indices:r,$updates:i})}}),vp=X({fft_:function(t){U(t.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."});var n=t.shape[t.shape.length-1],e=t.size/n,r=t.as2D(e,n);return K.runKernelFunc(function(i){return i.fft(r)},{input:t}).reshape(t.shape)}}),ic=X({ifft_:function(t){U(t.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."});var n=t.shape[t.shape.length-1],e=t.size/n,r=t.as2D(e,n);return K.runKernelFunc(function(i){return i.ifft(r)},{input:t}).reshape(t.shape)}}),gp=X({rfft_:function(t,n){U(t.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+t.dtype});var e,r=t.shape[t.shape.length-1],i=t.size/r;if(n!=null&&n<r){var o=t.shape.map(function(m){return 0}),a=t.shape.map(function(m){return m});a[t.shape.length-1]=n,e=t.slice(o,a),r=n}else if(n!=null&&n>r){var s=t.shape.map(function(m){return m});s[t.shape.length-1]=n-r,e=t.concat(_t(s),t.shape.length-1),r=n}else e=t;var u=e.zerosLike(),l=Nn(e,u).as2D(i,r),c=vp(l),d=Math.floor(r/2)+1,f=_r(c),p=vi(c),h=f.split([d,r-d],f.shape.length-1),v=p.split([d,r-d],p.shape.length-1),g=e.shape.slice();return g[e.shape.length-1]=d,Nn(h[0],v[0]).reshape(g)}}),ey=X({irfft_:function(t){var n=t.shape[t.shape.length-1],e=t.size/n;if(n<=2){var r=t.as2D(e,n),i=ic(r);return _r(i)}var o=[e,2*(n-1)],a=_r(t).as2D(e,n),s=vi(t).as2D(e,n),u=a.slice([0,1],[e,n-2]).reverse(1),l=s.slice([0,1],[e,n-2]).reverse(1).mul(Ie(-1)),c=a.concat(u,1),d=s.concat(l,1);return r=Nn(c,d).as2D(o[0],o[1]),i=ic(r),_r(i)}}),IL=Object.freeze({fft:vp,ifft:ic,rfft:gp,irfft:ey}),ty=X({sparseToDense_:function(t,n,e,r){r===void 0&&(r=0);var i=V(t,"sparseIndices","sparseToDense","int32"),o=V(n,"sparseValues","sparseToDense"),a=V(r,"defaultValue","sparseToDense",o.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(l.length!==f)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+f+".");var p=u.size;if(u.rank!==0&&(u.rank!==1||p!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,e,a),K.runKernelFunc(function(s){return s.sparseToDense(i,o,e,a)},{$sparseIndices:i,$sparseValues:o,$defaultValue:a})}}),dC=X({gatherND_:function(t,n){var e=V(n,"indices","gatherND","int32"),r=V(t,"x","gatherND");return K.runKernelFunc(function(i){return i.gatherND(r,e)},{$x:r,$indices:e})}}),_L=X({diag_:function(t){var n=V(t,"x","diag").flatten(),e=t.shape.concat(t.shape);return K.runKernelFunc(function(r){return r.diag(n)},{$x:n}).reshape(e)}}),fC=X({dropout_:function(t,n,e,r){var i=V(t,"x","dropout");if(U(i.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),U(n>=0&&n<1,function(){return"rate must be a float in the range [0, 1), but got "+n+"."}),n===0)return t instanceof At?i.clone():i;var o=function(u,l){if(l==null)return u.shape.slice();if(Bn(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?c.push(u.shape[d]):c.push(l[d]);return c}return l}(i,e),a=1-n,s=Cu(o,0,1,"float32",r).add(a).floor().div(a);return i.mul(s)}});function AL(t,n,e){for(var r=1-t%2,i=new Float32Array(t),o=0;o<t;++o){var a=2*Math.PI*o/(t+r-1);i[o]=n-e*Math.cos(a)}return zr(i,"float32")}var ny=X({hannWindow_:function(t){return AL(t,.5,.5)}}),pC=X({hammingWindow_:function(t){return AL(t,.54,.46)}}),ry=X({frame_:function(t,n,e,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var o=0,a=[];o+n<=t.size;)a.push(ni(t,o,n)),o+=e;if(r)for(;o<t.size;){var s=o+n-t.size,u=lr([ni(t,o,n-s),Tc([s],i)]);a.push(u),o+=e}return a.length===0?Go([],[0,n]):lr(a).as2D(a.length,n)}}),hC=X({stft_:function(t,n,e,r,i){var o;i===void 0&&(i=ny),r==null&&(o=n,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var a=ry(t,n,e),s=We(a,i(n)),u=[],l=0;l<a.shape[0];l++)u.push(gp(s.slice([l,0],[1,n]),r));return lr(u)}}),OL=Object.freeze({hannWindow:ny,hammingWindow:pC,frame:ry,stft:hC}),Xn,DL=function(t,n,e){return e===void 0&&(e=1),Oe(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g;return De(this,function(m){switch(m.label){case 0:return r=V(t,"predictions","inTopK"),i=V(n,"targets","inTopK"),U(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),U(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),gt(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],U(e>0&&e<=o,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+e}),[4,r.data()];case 1:return a=m.sent(),[4,i.data()];case 2:for(s=m.sent(),u=[a.length/o,o],c=u[1],d=_f("bool",l=u[0]),f=0;f<l;f++){for(p=f*c,h=a.subarray(p,p+c),v=[],g=0;g<h.length;g++)v.push({value:h[g],index:g});for(v.sort(function(y,b){return b.value-y.value}),d[f]=0,g=0;g<e;g++)if(v[g].index===s[f]){d[f]=1;break}}return t!==r&&r.dispose(),n!==i&&i.dispose(),[2,mn(d,i.shape,"bool")]}})})};(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Xn||(Xn={}));var wq=X({absoluteDifference_:function(t,n,e,r){r===void 0&&(r=Xn.SUM_BY_NONZERO_WEIGHTS);var i=V(t,"labels","absoluteDifference"),o=V(n,"predictions","absoluteDifference"),a=null;e!=null&&(a=V(e,"weights","absoluteDifference")),gt(i.shape,o.shape,"Error in absoluteDifference: ");var s=i.sub(o).abs();return ca(s,a,r)}}),ca=X({computeWeightedLoss_:function(t,n,e){e===void 0&&(e=Xn.SUM_BY_NONZERO_WEIGHTS);var r=V(t,"losses","computeWeightedLoss"),i=null;n!=null&&(i=V(n,"weights","computeWeightedLoss"));var o=i==null?r:r.mul(i);if(e===Xn.NONE)return o;if(e===Xn.SUM)return o.sum();if(e===Xn.MEAN){if(i==null)return o.mean();var a=r.size/i.size,s=o.sum().div(i.sum());return a>1?s.div(Ie(a)):s}if(e===Xn.SUM_BY_NONZERO_WEIGHTS){if(i==null)return o.sum().div(Ie(r.size));var u=i.mul(Ro(r.shape)).notEqual(Ie(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+e)}}),xq=X({cosineDistance_:function(t,n,e,r,i){i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=V(t,"labels","cosineDistance"),a=V(n,"predictions","cosineDistance"),s=null;r!=null&&(s=V(r,"weights","cosineDistance")),gt(o.shape,a.shape,"Error in cosineDistance: ");var u=Ie(1).sub(o.mul(a).sum(e,!0));return ca(u,s,i)}}),Sq=X({hingeLoss_:function(t,n,e,r){r===void 0&&(r=Xn.SUM_BY_NONZERO_WEIGHTS);var i=V(t,"labels","hingeLoss"),o=V(n,"predictions","hingeLoss"),a=null;e!=null&&(a=V(e,"weights","hingeLoss")),gt(i.shape,o.shape,"Error in hingeLoss: ");var s=Ie(1);i=Ie(2).mul(i).sub(s);var u=s.sub(i.mul(o)).relu();return ca(u,a,r)}}),Eq=X({huberLoss_:function(t,n,e,r,i){r===void 0&&(r=1),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=V(t,"labels","huberLoss"),a=V(n,"predictions","huberLoss"),s=null;e!=null&&(s=V(e,"weights","huberLoss")),gt(o.shape,a.shape,"Error in huberLoss: ");var u=Ie(r),l=a.sub(o).abs(),c=kc(l,u),d=l.sub(c),f=Ie(.5).mul(c.square()).add(u.mul(d));return ca(f,s,i)}}),Cq=X({logLoss_:function(t,n,e,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=V(t,"labels","logLoss"),a=V(n,"predictions","logLoss"),s=null;e!=null&&(s=V(e,"weights","logLoss")),gt(o.shape,a.shape,"Error in logLoss: ");var u=Ie(1),l=Ie(r),c=o.mul(a.add(l).log()).neg().sub(u.sub(o).mul(u.sub(a).add(l).log()));return ca(c,s,i)}}),Rq=X({meanSquaredError_:function(t,n,e,r){r===void 0&&(r=Xn.SUM_BY_NONZERO_WEIGHTS);var i=V(t,"labels","meanSquaredError"),o=V(n,"predictions","meanSquaredError"),a=null;e!=null&&(a=V(e,"weights","meanSquaredError")),gt(i.shape,o.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(o);return ca(s,a,r)}}),Tq=X({sigmoidCrossEntropy_:function(t,n,e,r,i){r===void 0&&(r=0),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=V(t,"multiClassLabels","sigmoidCrossEntropy"),a=V(n,"logits","sigmoidCrossEntropy"),s=null;if(e!=null&&(s=V(e,"weights","sigmoidCrossEntropy")),gt(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Ie(r),l=Ie(1),c=Ie(.5);o=o.mul(l.sub(u)).add(c.mul(u))}var d=function(f,p){var h=V(f,"labels","sigmoidCrossEntropyWithLogits"),v=V(p,"logits","sigmoidCrossEntropyWithLogits");gt(h.shape,v.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=v.relu(),m=v.mul(h),y=v.abs().neg().exp().log1p();return g.sub(m).add(y)}(o,a);return ca(d,s,i)}}),Nq=X({softmaxCrossEntropy_:function(t,n,e,r,i){r===void 0&&(r=0),i===void 0&&(i=Xn.SUM_BY_NONZERO_WEIGHTS);var o=V(t,"onehotLabels","softmaxCrossEntropy"),a=V(n,"logits","softmaxCrossEntropy"),s=null;if(e!=null&&(s=V(e,"weights","softmaxCrossEntropy")),gt(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Ie(r),l=Ie(1),c=Ie(o.shape[1]);o=o.mul(l.sub(u)).add(u.div(c))}var d=function(f,p,h){if(h===void 0&&(h=-1),h===-1&&(h=p.rank-1),h!==p.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+p.rank+" and dim was "+h);return Nc(function(v,g,m){var y=g.logSumExp([h],!0),b=g.toFloat().sub(y);return m([v,b]),{value:b.mul(v).neg().sum([h]),gradFunc:function(w,x){var C=x[0],E=x[1],S=ei(w.shape,[h]);return[w.reshape(S).mul(C.toFloat().sub(E.exp())),w.reshape(S).mul(E.exp().sub(C.toFloat()))]}}})(f,p)}(o,a);return ca(d,s,i)}}),ML=Object.freeze({get Reduction(){return Xn},absoluteDifference:wq,computeWeightedLoss:ca,cosineDistance:xq,hingeLoss:Sq,huberLoss:Eq,logLoss:Cq,meanSquaredError:Rq,sigmoidCrossEntropy:Tq,softmaxCrossEntropy:Nq});function ik(t,n){return n===void 0&&(n=!1),K.tidy(function(){if(t.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var e=t.shape[0],r=t.shape[1],i=Cg(e),o=t.clone(),a=Go([[1]],[1,1]),s=a.clone(),u=e>=r?r:e,l=function(d){var f,p=o,h=s,v=i;f=K.tidy(function(){var g=o.slice([d,d],[e-d,1]),m=g.norm(),y=o.slice([d,d],[1,1]),b=Go([[-1]]).where(y.greater(0),Go([[1]])),w=y.sub(b.mul(m)),x=g.div(w);s=x.shape[0]===1?a.clone():a.concat(x.slice([1,0],[x.shape[0]-1,x.shape[1]]),0);var C=b.matMul(w).div(m).neg(),E=o.slice([d,0],[e-d,r]),S=C.mul(s);if(d===0)o=E.sub(S.matMul(s.transpose().matMul(E)));else{var k=E.sub(S.matMul(s.transpose().matMul(E)));o=o.slice([0,0],[d,r]).concat(k,0)}var N=i.slice([0,d],[e,i.shape[1]-d]);if(d===0)i=N.sub(N.matMul(s).matMul(S.transpose()));else{var M=N.sub(N.matMul(s).matMul(S.transpose()));i=i.slice([0,0],[e,d]).concat(M,1)}return[s,o,i]}),s=f[0],o=f[1],i=f[2],Ze([p,h,v])},c=0;c<u;++c)l(c);return!n&&e>r&&(i=i.slice([0,0],[e,r]),o=o.slice([0,0],[r,r])),[i,o]})}var kq=X({gramSchmidt_:function(t){var n;if(Array.isArray(t)){n=!1,U(t!=null&&t.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var e=t[0].shape[0],r=function(u){U(t[u].shape[0]===e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[u].shape[0]+" vs. "+e+")"})},i=1;i<t.length;++i)r(i)}else n=!0,t=qo(t,t.shape[0],0).map(function(u){return ap(u,[0])});U(t.length<=t[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."});var o=[],a=t,s=function(u){o.push(K.tidy(function(){var l=a[u];if(u>0)for(var c=0;c<u;++c){var d=Br(o[c].mulStrict(l)).mul(o[c]);l=l.sub(d)}return l.div(sC(l,"euclidean"))}))};for(i=0;i<t.length;++i)s(i);return n?$i(o,0):o}}),Iq=X({qr_:function(t,n){if(n===void 0&&(n=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(t.rank===2)return ik(t,n);var e=t.shape.slice(0,t.shape.length-2).reduce(function(a,s){return a*s}),r=du(t.reshape([e,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];return r.forEach(function(a){var s=ik(a,n),u=s[0],l=s[1];i.push(u),o.push(l)}),[$i(i,0).reshape(t.shape),$i(o,0).reshape(t.shape)]}}),mC=Object.freeze({gramSchmidt:kq,qr:Iq});function PL(t,n,e,r,i){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY);var o=t.shape[0];return e=Math.min(e,o),U(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),U(t.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"}),U(t.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]}),U(n.rank===1,function(){return"scores must be a 1D tensor"}),U(n.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+n.shape[0]}),{maxOutputSize:e,iouThreshold:r,scoreThreshold:i}}var _q=X({resizeBilinear_:function(t,n,e){e===void 0&&(e=!1);var r=V(t,"images","resizeBilinear");U(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(n.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+n+"."});var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=n[0],s=n[1],u=K.runKernelFunc(function(l,c){return c([i]),l.resizeBilinear(i,a,s,e)},{batchImages:i},function(l,c){return{batchImages:function(){return K.runKernelFunc(function(d){return d.resizeBilinearBackprop(l,c[0],e)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Aq=X({resizeNearestNeighbor_:function(t,n,e){e===void 0&&(e=!1);var r=V(t,"images","resizeNearestNeighbor");U(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(n.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+n+"."}),U(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,o=!1;r.rank===3&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=n[0],s=n[1],u=K.runKernelFunc(function(l,c){return c([i]),l.resizeNearestNeighbor(i,a,s,e)},{batchImages:i},function(l,c){return{batchImages:function(){return K.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(l,c[0],e)},{})}}});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Oq=X({nonMaxSuppression_:function(t,n,e,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var o=V(t,"boxes","nonMaxSuppression"),a=V(n,"scores","nonMaxSuppression"),s=PL(o,a,e,r,i);return e=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,K.runKernelFunc(function(u){return u.nonMaxSuppression(o,a,e,r,i)},{$boxes:o})}}),Dq=function(t,n,e,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),Oe(this,void 0,void 0,function(){var o,a,s,u,l,c,d;return De(this,function(f){switch(f.label){case 0:return o=V(t,"boxes","nonMaxSuppressionAsync"),a=V(n,"scores","nonMaxSuppressionAsync"),s=PL(o,a,e,r,i),e=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([o.data(),a.data()])];case 1:return u=f.sent(),l=u[0],c=u[1],d=bE(l,c,e,r,i),o!==t&&o.dispose(),a!==n&&a.dispose(),[2,d]}})})},Mq=X({cropAndResize_:function(t,n,e,r,i,o){var a=V(t,"image","cropAndResize","float32"),s=V(n,"boxes","cropAndResize","float32"),u=V(e,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var l=s.shape[0];return U(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),U(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),U(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),U(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),U(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),U(i==="bilinear"||i==="nearest",function(){return"method must be bilinear or nearest, but was "+i}),K.runKernelFunc(function(c,d){return c.cropAndResize(a,s,u,r,i,o)},{$image:a,$boxes:s})}}),eu=Object.freeze({resizeBilinear:_q,resizeNearestNeighbor:Aq,nonMaxSuppression:Oq,nonMaxSuppressionAsync:Dq,cropAndResize:Mq}),vC=function(t,n){return!(t>0)&&(n==="linear"||n==="relu")},gC=function(t,n,e){if(e==null||e==="linear")return t;if(e==="relu")return t.mul(n.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},yC=function(t,n){var e=n,r=Rn(t.shape,n.shape);return r.length>0&&(e=e.sum(r)),e.reshape(t.shape)},bC=function(t,n,e){if(n==="linear")return t;if(n==="relu")return ws(t);if(n==="elu")return Oc(t);if(n==="relu6")return oC(t);if(n==="prelu")return Qg(t,e);throw new Error("Unknown fused activation "+n+".")},Pq=X({matMul_:function(t){var n,e=t.a,r=t.b,i=t.transposeA,o=i!==void 0&&i,a=t.transposeB,s=a!==void 0&&a,u=t.bias,l=t.activation,c=l===void 0?"linear":l,d=t.preluActivationWeights;if(vC(K.state.gradientDepth,c)===!1){var f=$g(e,r,o,s);return u!=null&&(f=st(f,u)),bC(f,c,d)}var p=V(e,"a","fused matMul"),h=V(r,"b","fused matMul");n=fn(p,h),p=n[0],h=n[1];var v=o?p.shape[p.rank-2]:p.shape[p.rank-1],g=s?h.shape[h.rank-1]:h.shape[h.rank-2],m=o?p.shape[p.rank-1]:p.shape[p.rank-2],y=s?h.shape[h.rank-2]:h.shape[h.rank-1],b=p.shape.slice(0,-2),w=h.shape.slice(0,-2),x=Pe(b),C=Pe(w);U(p.rank>=2&&h.rank>=2&&p.rank===h.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+h.rank+"."}),U(Bn(b,w),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+w+") of Tensors with shapes "+p.shape+" and "+h.shape+" must match."}),U(v===g,function(){return"Error in fused matMul: inner shapes ("+v+") and ("+g+") of Tensors with shapes "+p.shape+" and "+h.shape+" and transposeA="+o+" and transposeB="+s+" must match."});var E,S,k=p.shape.slice(0,-2).concat([m,y]),N=o?p.as3D(x,v,m):p.as3D(x,m,v),M=s?h.as3D(C,y,g):h.as3D(C,g,y);u!=null&&lt(k,(E=fn(E=V(u,"bias","fused matMul"),p)[0]).shape),d!=null&&(S=V(d,"prelu weights","fused matMul"));var D={$a:N,$b:M};return u!=null&&(D.$bias=E),d!=null&&(D.$preluActivationWeights=S),K.runKernelFunc(function(T,O){var P=T.fusedBatchMatMul({a:N,b:M,transposeA:o,transposeB:s,bias:E,activation:c,preluActivationWeights:S});return O([N,M,P]),P},D,function(T,O){var P=O[0],A=O[1],I=O[2],_=gC(T,I,c),F={};return u!=null&&(F={$bias:function(){return yC(E,_)}}),Object.assign(o||s?!o&&s?{$a:function(){return _.matMul(A,!1,!1)},$b:function(){return _.matMul(P,!0,!1)}}:o&&!s?{$a:function(){return A.matMul(_,!1,!0)},$b:function(){return P.matMul(_,!1,!1)}}:{$a:function(){return A.matMul(_,!0,!0)},$b:function(){return _.matMul(P,!0,!0)}}:{$a:function(){return _.matMul(A,!1,!0)},$b:function(){return P.matMul(_,!0,!1)}},F)}).reshape(k)}}),Lq=X({conv2d_:function(t){var n=t.x,e=t.filter,r=t.strides,i=t.pad,o=t.dataFormat,a=o===void 0?"NHWC":o,s=t.dilations,u=s===void 0?[1,1]:s,l=t.dimRoundingMode,c=t.bias,d=t.activation,f=d===void 0?"linear":d,p=t.preluActivationWeights;if(f=f||"linear",vC(K.state.gradientDepth,f)===!1){var h=ku(n,e,r,i,a,u,l);return c!=null&&(h=st(h,c)),bC(h,f,p)}var v=V(n,"x","conv2d"),g=V(e,"filter","conv2d"),m=v,y=!1;v.rank===3&&(y=!0,m=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),U(m.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."}),U(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),l!=null&&U(rn(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."}),U(m.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),U(yr(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),U(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var b,w,x=bs(m.shape,g.shape,r,u,i,l);c!=null&&(b=fn(b=V(c,"bias","fused conv2d"),v)[0],lt(x.outShape,b.shape)),p!=null&&(w=V(p,"prelu weights","fused conv2d"));var C={x:m,$filter:g};c!=null&&(C.$bias=b),p!=null&&(C.$preluActivationWeights=w);var E=K.runKernelFunc(function(S,k){var N=S.fusedConv2d({input:m,filter:g,convInfo:x,bias:b,activation:f,preluActivationWeights:w});return k([g,m,N]),N},C,function(S,k){var N=k,M=N[0],D=N[1],T=N[2],O=gC(S,T,f);U(fu(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var P={};return c!=null&&(P={$bias:function(){return yC(b,O)}}),Object.assign({x:function(){return dL(D.shape,O,M,r,i)},$filter:function(){return nC(D,O,M.shape,r,i)}},P)});return y?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),Fq=X({depthwiseConv2d_:function(t){var n=t.x,e=t.filter,r=t.strides,i=t.pad,o=t.dataFormat,a=o===void 0?"NHWC":o,s=t.dilations,u=s===void 0?[1,1]:s,l=t.dimRoundingMode,c=t.bias,d=t.activation,f=d===void 0?"linear":d,p=t.preluActivationWeights;if(vC(K.state.gradientDepth,f)===!1){var h=Ac(n,e,r,i,a,u,l);return c!=null&&(h=st(h,c)),bC(h,f,p)}var v=V(n,"x","depthwiseConv2d"),g=V(e,"filter","depthwiseConv2d"),m=v,y=!1;v.rank===3&&(y=!0,m=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),U(m.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),U(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),U(m.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),U(yr(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&U(rn(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."});var b,w,x=bs(m.shape,g.shape,r,u,i,l,!0);c!=null&&(b=fn(b=V(c,"bias","fused conv2d"),v)[0],lt(x.outShape,b.shape)),p!=null&&(w=V(p,"prelu weights","fused depthwiseConv2d"));var C={x:m,$filter:g};c!=null&&(C.$bias=b),p!=null&&(C.$preluActivationWeights=w);var E=K.runKernelFunc(function(S,k){var N=S.fusedDepthwiseConv2D({input:m,filter:g,convInfo:x,bias:b,activation:f,preluActivationWeights:w});return k([m,g,N]),N},C,function(S,k){U(fu(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var N=k[0],M=k[1],D=k[2],T=gC(S,D,f),O={};return c!=null&&(O={$bias:function(){return yC(b,T)}}),Object.assign({x:function(){return fL(N.shape,T,M,x)},$filter:function(){return pL(N,T,M.shape,x)}},O)});return y?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),oc=Object.freeze({matMul:Pq,conv2d:Lq,depthwiseConv2d:Fq}),zq=Object.freeze({image:eu,linalg:mC,losses:ML,spectral:IL,fused:oc,signal:OL,square:CE,conv1d:Bg,conv2d:ku,conv3d:jg,depthwiseConv2d:Ac,separableConv2d:rC,conv2dTranspose:Vg,conv3dTranspose:hL,op:X,batchNormalization2d:UP,batchNormalization3d:WP,batchNormalization4d:HP,batchNormalization:GP,batchNorm:WE,batchNorm2d:HE,batchNorm3d:GE,batchNorm4d:qE,booleanMaskAsync:uL,complex:Nn,real:_r,imag:vi,concat:lr,concat1d:rE,concat2d:iE,concat3d:oE,concat4d:aE,split:qo,matMul:$g,dot:mL,outerProduct:vL,reverse:So,reverse1d:gL,reverse2d:yL,reverse3d:bL,reverse4d:wL,maxPool:Ug,avgPool:Wg,pool:EL,maxPool3d:Hg,avgPool3d:Gg,slice:ni,slice1d:pp,slice2d:qg,slice3d:hp,slice4d:rc,abs:ss,acos:RE,acosh:TE,asin:NE,asinh:kE,atan:IE,atanh:_E,ceil:AE,clipByValue:br,cos:OE,cosh:DE,erf:ME,exp:PE,expm1:LE,floor:_g,log:ra,log1p:FE,logSigmoid:PP,neg:Tu,reciprocal:zE,round:BE,rsqrt:Ag,sigmoid:Og,sign:jE,isNaN:LP,isInf:FP,isFinite:zP,sin:VE,sinh:$E,softplus:lp,sqrt:cp,step:BP,tan:UE,tanh:Dg,all:Kg,any:jf,argMax:Vf,argMin:iC,logSumExp:RL,max:us,mean:gn,min:Xg,moments:mp,sum:Br,prod:Yg,equal:Nu,equalStrict:nL,greater:Ic,greaterEqual:fp,greaterEqualStrict:rL,greaterStrict:iL,less:ZE,lessEqual:eC,lessEqualStrict:oL,lessStrict:aL,notEqual:nc,notEqualStrict:sL,add:st,addN:XE,addStrict:KP,atan2:YE,div:cr,divStrict:XP,floorDiv:Fg,maximum:To,maximumStrict:YP,minimum:kc,minimumStrict:JP,mod:JE,modStrict:QP,mul:We,mulStrict:zg,pow:tc,powStrict:ZP,squaredDifference:QE,squaredDifferenceStrict:eL,sub:jn,subStrict:tL,elu:Oc,leakyRelu:Jg,prelu:Qg,relu:ws,relu6:oC,selu:Zg,logicalAnd:la,logicalNot:KE,logicalOr:Pg,logicalXor:qP,where:ia,whereAsync:Lg,buffer:He,print:jM,batchToSpaceND:Sg,cast:Eg,clone:VM,cumsum:$M,depthToSpace:uE,expandDims:Hr,eye:Cg,multinomial:lE,oneHot:Zl,pad:ys,pad1d:UM,pad2d:WM,pad3d:HM,pad4d:GM,rand:qM,randomNormal:cE,randomGamma:KM,randomUniform:Cu,reshape:op,spaceToBatchND:Rg,squeeze:ap,stack:$i,tile:Qa,truncatedNormal:sp,unstack:du,setdiff1dAsync:dE,fill:Tc,linspace:nE,ones:Ro,range:wg,scalar:Ie,tensor:mn,tensor1d:zr,tensor2d:Go,tensor3d:eE,tensor4d:Ta,tensor5d:zM,tensor6d:BM,variable:tE,zeros:_t,onesLike:ti,zerosLike:dt,transpose:en,softmax:Ru,logSoftmax:kg,localResponseNormalization:aC,norm:sC,gather:_c,unsortedSegmentSum:tC,basicLSTMCell:TL,multiRNNCell:NL,movingAverage:kL,stridedSlice:uC,topk:lC,scatterND:cC,fft:vp,ifft:ic,rfft:gp,irfft:ey,sparseToDense:ty,gatherND:dC,diag:_L,dropout:fC,hannWindow:ny,hammingWindow:pC,frame:ry,stft:hC,inTopKAsync:DL});function pe(t,n){Array.isArray(t)||(t=[t]),t.forEach(function(e){e!=null&&U(e.dtype!=="complex64",function(){return n+" does not support complex64 tensors."})})}function o1(t,n,e,r){if(e==="linear")return t.linear(n);if(e==="relu")return t.relu(n);if(e==="elu")return t.elu(n);if(e==="relu6")return t.relu6(n);if(e==="prelu")return t.prelu(n,r);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var Bq=function(t){function n(){var e=t.call(this)||this;if(e.blockSize=48,e.firstUse=!0,ie().get("IS_BROWSER")){var r=typeof OffscreenCanvas<"u"?new OffscreenCanvas(300,150):typeof document<"u"?document.createElement("canvas"):null;r!==null&&(e.fromPixels2DContext=r.getContext("2d"))}return e.data=new hE(e,K),e}return Hi(n,t),n.prototype.write=function(e,r,i){this.firstUse&&(this.firstUse=!1,ie().get("IS_NODE")&&xw(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================
`));var o={};return this.data.set(o,{values:e,dtype:i}),o},n.prototype.move=function(e,r,i,o){this.data.set(e,{values:r,dtype:o})},n.prototype.numDataIds=function(){return this.data.numDataIds()},n.prototype.fromPixels=function(e,r){if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var i,o,a=e.data instanceof Uint8Array,s=typeof ImageData<"u"&&e instanceof ImageData,u=typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,c=u?[e.videoWidth,e.videoHeight]:[e.width,e.height],d=c[0],f=c[1];if(ie().get("IS_NODE")&&e.getContext==null)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(e.getContext!=null)i=e.getContext("2d").getImageData(0,0,d,f).data;else if(s||a)i=e.data;else{if(!l&&!u)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);if(this.fromPixels2DContext==null)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=d,this.fromPixels2DContext.canvas.height=f,this.fromPixels2DContext.drawImage(e,0,0,d,f),i=this.fromPixels2DContext.getImageData(0,0,d,f).data}if(r===4)o=new Int32Array(i);else{var p=d*f;o=new Int32Array(p*r);for(var h=0;h<p;h++)for(var v=0;v<r;++v)o[h*r+v]=i[4*h+v]}return eE(o,[f,d,r],"int32")},n.prototype.read=function(e){return Oe(this,void 0,void 0,function(){return De(this,function(r){return[2,this.readSync(e)]})})},n.prototype.readSync=function(e){var r=this.data.get(e),i=r.dtype,o=r.complexTensors;return i==="complex64"?Cw(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.data.get(e).values},n.prototype.bufferSync=function(e){var r=this.readSync(e.dataId),i=r;if(e.dtype==="string")try{i=r.map(function(o){return Of(o)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return He(e.shape,e.dtype,i)},n.prototype.makeOutput=function(e,r,i){var o=this.write(e,r,i);return K.makeTensorFromDataId(o,r,i,this)},n.prototype.disposeData=function(e){if(this.data.has(e)){var r=this.data.get(e).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(e)}},n.prototype.time=function(e){return Oe(this,void 0,void 0,function(){var r;return De(this,function(i){return r=Di(),e(),[2,{kernelMs:Di()-r}]})})},n.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},n.prototype.complex=function(e,r){var i=this.makeOutput(null,e.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:K.keep(e.clone()),imag:K.keep(r.clone())},i},n.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},n.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},n.prototype.slice=function(e,r,i){if(pe(e,"slice"),fE(e.shape,r,i)){var o=pE(r,e.strides),a=Pe(i);return mn(this.readSync(e.dataId).subarray(o,o+a),i,e.dtype)}for(var s=He(i,e.dtype),u=this.bufferSync(e),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(d,f){return d+r[f]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},n.prototype.stridedSlice=function(e,r,i,o){pe(e,"stridedSlice");var a=Tg(r,i,o);if(a.some(function(p){return p===0}))return mn([],a);for(var s=He(a,e.dtype),u=this.bufferSync(e),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),d=new Array(c.length),f=0;f<d.length;f++)d[f]=c[f]*o[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(c))}return s.toTensor()},n.prototype.diag=function(e){for(var r=this.readSync(e.dataId),i=He([e.size,e.size],e.dtype),o=i.values,a=0;a<r.length;a++)o[a*e.size+a]=r[a];return i.toTensor()},n.prototype.unstack=function(e,r){for(var i=e.shape[r],o=new Array(e.rank-1),a=0,s=0;s<e.rank;s++)s!==r&&(o[a++]=e.shape[s]);var u=new Array(e.rank).fill(0),l=e.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(e,u,l).reshape(o);return c},n.prototype.reverse=function(e,r){pe(e,"reverse");for(var i=He(e.shape,e.dtype),o=this.bufferSync(e),a=function(u){var l=i.indexToLoc(u),c=l.slice();r.forEach(function(d){return c[d]=e.shape[d]-1-c[d]}),i.set.apply(i,[o.get.apply(o,c)].concat(l))},s=0;s<i.size;s++)a(s);return i.toTensor()},n.prototype.concat=function(e,r){var i=this;if(e[0].dtype==="complex64"){var o=e.map(function(p){return _r(p)}),a=e.map(function(p){return vi(p)});return Nn(this.concat(o,r),this.concat(a,r))}var s=e.map(function(p){var h=Pe(p.shape.slice(r));return p.as2D(-1,h)}),u=cu(s.map(function(p){return p.shape}),1),l=He(u,e[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(p){l.set(i.readSync(p.dataId),c),c+=p.size})}else{var d=0;s.forEach(function(p){for(var h=i.readSync(p.dataId),v=0,g=0;g<p.shape[0];++g)for(var m=g*u[1]+d,y=0;y<p.shape[1];++y)l[m+y]=h[v++];d+=p.shape[1]})}var f=cu(e.map(function(p){return p.shape}),r);return mn(l,f,e[0].dtype)},n.prototype.neg=function(e){return pe(e,"neg"),this.multiply(Ie(-1),e)},n.prototype.add=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(i,o,a,s){return{real:i+a,imag:o+s}}):this.broadcastedBinaryOp(e,r,bn(e.dtype,r.dtype),function(i,o){return i+o})},n.prototype.addN=function(e){var r=this;pe(e,"addN");for(var i=e.map(function(c){return r.readSync(c.dataId)}),o=He(e[0].shape,e[0].dtype),a=o.values,s=0;s<e.length;s++)for(var u=i[s],l=0;l<a.length;l++)a[l]+=u[l];return o.toTensor()},n.prototype.subtract=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(i,o,a,s){return{real:i-a,imag:o-s}}):this.broadcastedBinaryOp(e,r,bn(e.dtype,r.dtype),function(i,o){return i-o})},n.prototype.pow=function(e,r){return pe([e,r],"pow"),this.broadcastedBinaryOp(e,r,e.dtype,function(i,o){return Math.pow(i,o)})},n.prototype.batchMatMul=function(e,r,i,o){pe([e,r],"matMul");for(var a=i?e.shape[1]:e.shape[2],s=i?e.shape[2]:e.shape[1],u=o?r.shape[1]:r.shape[2],l=e.shape[0],c=this.readSync(e.dataId),d=this.readSync(r.dataId),f=i?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],p=f[0],h=f[1],v=f[2],g=o?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],m=g[0],y=g[1],b=g[2],w=s*u,x=He([l,s,u],e.dtype),C=x.values,E=this.blockSize,S=0;S<l;S++)for(var k=0;k<s;k+=E)for(var N=0;N<u;N+=E)for(var M=0;M<a;M+=E)for(var D=Math.min(k+E,s),T=Math.min(N+E,u),O=Math.min(M+E,a),P=k;P<D;P++)for(var A=N;A<T;A++){for(var I=0,_=M;_<O;_++)I+=c[S*p+P*h+_*v]*d[_*m+A*y+S*b];C[S*w+(P*u+A)]+=I}return x.toTensor()},n.prototype.fusedBatchMatMul=function(e){var r=e.a,i=e.b,o=e.transposeA,a=e.transposeB,s=e.bias,u=e.activation,l=e.preluActivationWeights,c=this.batchMatMul(r,i,o,a);return s&&(c=this.add(c,s)),u&&(c=o1(this,c,u,l)),c},n.prototype.multiply=function(e,r){return e.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(i,o,a,s){return{real:i*a-o*s,imag:i*s+o*a}}):this.broadcastedBinaryOp(e,r,bn(e.dtype,r.dtype),function(i,o){return i*o})},n.prototype.realDivide=function(e,r){return pe([e,r],"realDivide"),this.broadcastedBinaryOp(e,r,"float32",function(i,o){return i/o})},n.prototype.floorDiv=function(e,r){return pe([e,r],"floorDiv"),this.broadcastedBinaryOp(e,r,"int32",function(i,o){return Math.floor(i/o)})},n.prototype.sum=function(e,r){pe(e,"sum"),Nr("sum",r,e.rank);for(var i=Gn(e.shape,r),o=i[0],a=i[1],s=_t(o,bn(e.dtype,"int32")),u=Pe(a),l=this.readSync(s.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,p=0,h=0;h<u;++h)p+=c[f+h];l[d]=p}return s},n.prototype.prod=function(e,r){pe(e,"sum");for(var i=Gn(e.shape,r),o=i[0],a=i[1],s=_t(o,bn(e.dtype,"int32")),u=Pe(a),l=this.readSync(s.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,p=1,h=0;h<u;++h)p*=c[f+h];l[d]=p}return s},n.prototype.unsortedSegmentSum=function(e,r,i){pe(e,"unsortedSegmentSum");for(var o=[],a=e.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<i;++s){var u=Ie(s,"int32"),l=Nu(u,r).asType("float32").mul(e).sum(0);o.push(l)}return $i(o)},n.prototype.argMin=function(e,r){pe(e,"argMin");var i=[r];Nr("argMin",i,e.rank);for(var o=Gn(e.shape,i),a=o[0],s=o[1],u=_t(a,"int32"),l=Pe(s),c=this.readSync(u.dataId),d=this.readSync(e.dataId),f=0;f<c.length;++f){for(var p=f*l,h=d[p],v=0,g=0;g<l;++g){var m=d[p+g];m<h&&(h=m,v=g)}c[f]=v}return u},n.prototype.argMax=function(e,r){pe(e,"argMax");var i=[r];Nr("argMax",i,e.rank);for(var o=Gn(e.shape,i),a=o[0],s=o[1],u=_t(a,"int32"),l=Pe(s),c=this.readSync(u.dataId),d=this.readSync(e.dataId),f=0;f<c.length;++f){for(var p=f*l,h=d[p],v=0,g=0;g<l;++g){var m=d[p+g];m>h&&(h=m,v=g)}c[f]=v}return u},n.prototype.cumsum=function(e,r,i,o){if(pe(e,"cumsum"),r!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+r);for(var a=bn(e.dtype,"int32"),s=_t(e.shape,a),u=this.readSync(s.dataId),l=this.readSync(e.dataId),c=e.shape[e.rank-1],d=o?function(g,m){return g+c-m-1}:function(g,m){return g+m},f=0;f<l.length;f+=c)for(var p=0;p<c;p++){var h=d(f,p);if(p===0)u[h]=i?0:l[h];else{var v=d(f,p-1);u[h]=i?l[v]+u[v]:l[h]+u[v]}}return s},n.prototype.equal=function(e,r){return pe([e,r],"equal"),this.broadcastedBinaryOp(e,r,"bool",function(i,o){return i===o?1:0})},n.prototype.notEqual=function(e,r){return pe([e,r],"notEqual"),this.broadcastedBinaryOp(e,r,"bool",function(i,o){return i!==o?1:0})},n.prototype.less=function(e,r){return pe([e,r],"less"),this.broadcastedBinaryOp(e,r,"bool",function(i,o){return i<o?1:0})},n.prototype.lessEqual=function(e,r){return pe([e,r],"lessEqual"),this.broadcastedBinaryOp(e,r,"bool",function(i,o){return i<=o?1:0})},n.prototype.greater=function(e,r){return pe([e,r],"greater"),this.broadcastedBinaryOp(e,r,"bool",function(i,o){return i>o?1:0})},n.prototype.greaterEqual=function(e,r){return pe([e,r],"greaterEqual"),this.broadcastedBinaryOp(e,r,"bool",function(i,o){return i>=o?1:0})},n.prototype.logicalNot=function(e){pe(e,"logicalNot");for(var r=this.readSync(e.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r[o]?0:1;return this.makeOutput(i,e.shape,"bool")},n.prototype.logicalAnd=function(e,r){return pe([e,r],"logicalAnd"),this.broadcastedBinaryOp(e,r,"bool",function(i,o){return i&&o})},n.prototype.logicalOr=function(e,r){return pe([e,r],"logicalOr"),this.broadcastedBinaryOp(e,r,"bool",function(i,o){return i||o})},n.prototype.select=function(e,r,i){pe([e,r,i],"select");for(var o=this.readSync(e.dataId),a=this.readSync(r.dataId),s=this.readSync(i.dataId),u=_t(r.shape,bn(r.dtype,i.dtype)),l=this.readSync(u.dataId),c=0,d=e.rank===0||e.rank>1||r.rank===1?1:Pe(r.shape.slice(1)),f=0;f<o.length;f++)for(var p=0;p<d;p++)o[f]===1?l[c++]=a[f]:l[c++]=s[f];return u},n.prototype.where=function(e){pe([e],"where");var r=this.readSync(e.dataId);return wE(e.shape,r)},n.prototype.topk=function(e,r,i){return pe(e,"topk"),oP(this.readSync(e.dataId),e.shape,e.dtype,r)},n.prototype.min=function(e,r){pe(e,"min"),Nr("min",r,e.rank);for(var i=Gn(e.shape,r),o=i[0],a=i[1],s=_t(o,e.dtype),u=Pe(a),l=this.readSync(s.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,p=c[f],h=0;h<u;++h){var v=c[f+h];v<p&&(p=v)}l[d]=p}return s},n.prototype.minimum=function(e,r){return pe([e,r],"minimum"),this.broadcastedBinaryOp(e,r,e.dtype,function(i,o){return Math.min(i,o)})},n.prototype.mod=function(e,r){return pe([e,r],"mod"),this.broadcastedBinaryOp(e,r,e.dtype,function(i,o){var a=i%o;return i<0&&o<0||i>=0&&o>=0?a:(a+o)%o})},n.prototype.max=function(e,r){pe(e,"max"),Nr("max",r,e.rank);for(var i=Gn(e.shape,r),o=i[0],a=i[1],s=_t(o,e.dtype),u=Pe(a),l=this.readSync(s.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,p=c[f],h=0;h<u;++h){var v=c[f+h];v>p&&(p=v)}l[d]=p}return s},n.prototype.maximum=function(e,r){return pe([e,r],"maximum"),this.broadcastedBinaryOp(e,r,e.dtype,function(i,o){return Math.max(i,o)})},n.prototype.all=function(e,r){pe(e,"all"),Nr("all",r,e.rank);for(var i=Gn(e.shape,r),o=i[0],a=i[1],s=_t(o,e.dtype),u=Pe(a),l=this.readSync(s.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,p=c[f],h=0;h<u;++h){var v=c[f+h];p=p&&v}l[d]=p}return s},n.prototype.any=function(e,r){pe(e,"any"),Nr("any",r,e.rank);for(var i=Gn(e.shape,r),o=i[0],a=i[1],s=_t(o,e.dtype),u=Pe(a),l=this.readSync(s.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,p=c[f],h=0;h<u;++h){var v=c[f+h];p=p||v}l[d]=p}return s},n.prototype.squaredDifference=function(e,r){return pe([e,r],"squaredDifference"),this.broadcastedBinaryOp(e,r,e.dtype,function(i,o){var a=i-o;return a*a})},n.prototype.ceil=function(e){pe(e,"ceil");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.ceil(r[o]);return this.makeOutput(i,e.shape,"float32")},n.prototype.floor=function(e){pe(e,"floor");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.floor(r[o]);return this.makeOutput(i,e.shape,"float32")},n.prototype.sign=function(e){pe(e,"x");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)r[o]<0?i[o]=-1:r[o]>0?i[o]=1:i[o]=0;return this.makeOutput(i,e.shape,"float32")},n.prototype.isNaN=function(e){pe(e,"x");for(var r=this.readSync(e.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isNaN(r[o])&&(i[o]=1);return this.makeOutput(i,e.shape,"bool")},n.prototype.isInf=function(e){pe(e,"x");for(var r=this.readSync(e.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Math.abs(r[o])===1/0&&(i[o]=1);return this.makeOutput(i,e.shape,"bool")},n.prototype.isFinite=function(e){pe(e,"x");for(var r=this.readSync(e.dataId),i=new Uint8Array(r.length),o=0;o<r.length;++o)Number.isFinite(r[o])&&(i[o]=1);return this.makeOutput(i,e.shape,"bool")},n.prototype.round=function(e){pe(e,"round");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=Math.floor(r[o]);r[o]-a<.5?i[o]=Math.floor(r[o]):r[o]-a>.5?i[o]=Math.ceil(r[o]):i[o]=a%2==0?a:a+1}return this.makeOutput(i,e.shape,"float32")},n.prototype.exp=function(e){pe(e,"exp");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.exp(r[o]);return this.makeOutput(i,e.shape,"float32")},n.prototype.expm1=function(e){pe(e,"expm1");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=Math.expm1(r[o]);return this.makeOutput(i,e.shape,"float32")},n.prototype.log=function(e){pe(e,"log");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=Math.log(a)}return this.makeOutput(i,e.shape,"float32")},n.prototype.log1p=function(e){pe(e,"log1p");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=Math.log1p(a)}return this.makeOutput(i,e.shape,"float32")},n.prototype.sqrt=function(e){pe(e,"sqrt");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=Math.sqrt(a)}return this.makeOutput(i,e.shape,"float32")},n.prototype.rsqrt=function(e){pe(e,"rsqrt");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o){var a=r[o];i[o]=1/Math.sqrt(a)}return this.makeOutput(i,e.shape,"float32")},n.prototype.reciprocal=function(e){pe(e,"reciprocal");for(var r=this.readSync(e.dataId),i=new Float32Array(r.length),o=0;o<r.length;++o)i[o]=1/r[o];return this.makeOutput(i,e.shape,"float32")},n.prototype.linear=function(e){return e},n.prototype.relu=function(e){pe(e,"relu");for(var r=_t(e.shape,e.dtype),i=this.readSync(r.dataId),o=this.readSync(e.dataId),a=0;a<o.length;++a)i[a]=Math.max(0,o[a]);return r},n.prototype.relu6=function(e){pe(e,"relu");for(var r=_t(e.shape,e.dtype),i=this.readSync(r.dataId),o=this.readSync(e.dataId),a=0;a<o.length;++a)i[a]=Math.min(Math.max(0,o[a]),6);return r},n.prototype.prelu=function(e,r){return pe([e,r],"prelu"),this.broadcastedBinaryOp(e,r,e.dtype,function(i,o){return i<0?o*i:i})},n.prototype.elu=function(e){pe(e,"elu");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,e.shape,"float32")},n.prototype.eluDer=function(e,r){pe([e,r],"eluDer");for(var i=new Float32Array(r.size),o=this.readSync(r.dataId),a=this.readSync(e.dataId),s=0;s<o.length;++s){var u=o[s];i[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(i,r.shape,"float32")},n.prototype.selu=function(e){pe(e,"selu");for(var r=SE,i=EE,o=new Float32Array(e.size),a=this.readSync(e.dataId),s=0;s<a.length;++s){var u=a[s];o[s]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(o,e.shape,"float32")},n.prototype.clip=function(e,r,i){pe(e,"clip");for(var o=new Float32Array(e.size),a=this.readSync(e.dataId),s=0;s<a.length;++s){var u=a[s];o[s]=u>i?i:u<r?r:u}return this.makeOutput(o,e.shape,"float32")},n.prototype.abs=function(e){for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.abs(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.complexAbs=function(e){for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<e.size;++o){var a=i[2*o],s=i[2*o+1];r[o]=Math.hypot(a,s)}return this.makeOutput(r,e.shape,"float32")},n.prototype.int=function(e){pe(e,"int");for(var r=new Int32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=i[o];return this.makeOutput(r,e.shape,"int32")},n.prototype.sigmoid=function(e){pe(e,"sigmoid");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=1/(1+Math.exp(-i[o]));return this.makeOutput(r,e.shape,"float32")},n.prototype.softplus=function(e){pe(e,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(e.size),o=this.readSync(e.dataId),a=0;a<o.length;++a){var s=o[a]>-r,u=o[a]<r,l=Math.exp(o[a]),c=void 0;c=u?l:s?o[a]:Math.log(1+l),i[a]=c}return this.makeOutput(i,e.shape,"float32")},n.prototype.sin=function(e){pe(e,"sin");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.sin(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.cos=function(e){pe(e,"cos");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.cos(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.tan=function(e){pe(e,"tan");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.tan(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.asin=function(e){pe(e,"asin");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.asin(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.acos=function(e){pe(e,"acos");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.acos(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.atan=function(e){pe(e,"atan");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.atan(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.atan2=function(e,r){return pe([e,r],"atan2"),this.broadcastedBinaryOp(e,r,e.dtype,function(i,o){return Math.atan2(i,o)})},n.prototype.sinh=function(e){pe(e,"sinh");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.sinh(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.cosh=function(e){pe(e,"cosh");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.cosh(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.tanh=function(e){pe(e,"tanh");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=YD(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.asinh=function(e){pe(e,"asinh");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.asinh(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.acosh=function(e){pe(e,"acosh");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.acosh(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.atanh=function(e){pe(e,"atanh");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o)r[o]=Math.atanh(i[o]);return this.makeOutput(r,e.shape,"float32")},n.prototype.erf=function(e){pe(e,"erf");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),o=0;o<i.length;++o){var a=Math.sign(i[o]),s=Math.abs(i[o]),u=1/(1+.3275911*s);r[o]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,e.shape,"float32")},n.prototype.step=function(e,r){r===void 0&&(r=0),pe(e,"step");for(var i=new Float32Array(e.size),o=this.readSync(e.dataId),a=0;a<o.length;++a){var s=o[a];isNaN(s)?i[a]=NaN:i[a]=s>0?1:r}return this.makeOutput(i,e.shape,"float32")},n.prototype.fusedConv2d=function(e){var r=e.input,i=e.filter,o=e.convInfo,a=e.bias,s=e.activation,u=e.preluActivationWeights,l=this.conv2d(r,i,o);return a&&(l=this.add(l,a)),s&&(l=o1(this,l,s,u)),l},n.prototype.conv2d=function(e,r,i){pe([e,r],"conv2d");for(var o=i.filterHeight,a=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,d=i.dataFormat==="channelsLast",f=He(i.outShape,e.dtype),p=e.strides[0],h=d?e.strides[1]:e.strides[2],v=d?e.strides[2]:1,g=d?1:e.strides[1],m=f.strides[0],y=d?f.strides[1]:f.strides[2],b=d?f.strides[2]:1,w=d?1:f.strides[1],x=this.readSync(e.dataId),C=this.readSync(r.dataId),E=f.values,S=0;S<i.batchSize;++S)for(var k=S*p,N=S*m,M=0;M<i.outHeight;++M)for(var D=N+M*y,T=M*i.strideHeight-c,O=0;O<o;O++){var P=T+O*s;if(!(P<0||P>=i.inHeight))for(var A=O*r.strides[0],I=k+P*h,_=0;_<i.outWidth;++_)for(var F=D+_*b,L=_*i.strideWidth-l,H=0;H<a;H++){var B=L+H*u;if(!(B<0||B>=i.inWidth))for(var q=I+B*v,G=A+H*r.strides[1],re=0;re<i.inChannels;++re){for(var j=x[q+re*g],ae=0;ae<i.outChannels;++ae)E[F+ae*w]+=j*C[G+ae];G+=i.outChannels}}}return f.toTensor()},n.prototype.conv3d=function(e,r,i){for(var o=i.filterDepth,a=i.filterHeight,s=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,c=i.dilationWidth,d=i.padInfo.front,f=i.padInfo.left,p=i.padInfo.top,h=He(i.outShape,e.dtype),v=this.readSync(e.dataId),g=this.readSync(r.dataId),m=h.values,y=0;y<i.batchSize;++y)for(var b=y*e.strides[0],w=y*h.strides[0],x=0;x<i.outDepth;++x)for(var C=w+x*h.strides[1],E=x*i.strideDepth-d,S=0;S<o;S++){var k=E+S*u;if(!(k<0||k>=i.inDepth))for(var N=S*r.strides[0],M=b+k*e.strides[1],D=0;D<i.outHeight;++D)for(var T=C+D*h.strides[2],O=D*i.strideHeight-p,P=0;P<a;P++){var A=O+P*l;if(!(A<0||A>=i.inHeight))for(var I=N+P*r.strides[1],_=M+A*e.strides[2],F=0;F<i.outWidth;++F)for(var L=T+F*i.outChannels,H=F*i.strideWidth-f,B=0;B<s;B++){var q=H+B*c;if(!(q<0||q>=i.inWidth))for(var G=I+B*r.strides[2],re=_+q*i.inChannels,j=G,ae=0;ae<i.inChannels;++ae){for(var ne=v[re+ae],le=0;le<i.outChannels;++le)m[L+le]+=ne*g[j+le];j+=i.outChannels}}}}return h.toTensor()},n.prototype.conv2dDerInput=function(e,r,i){pe([e,r],"conv2dDerInput");for(var o=He(i.inShape,"float32"),a=o.values,s=this.readSync(e.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],d=l[1],f=l[2],p=i.batchSize,h=i.filterHeight,v=i.filterWidth,g=i.inChannels,m=i.inHeight,y=i.inWidth,b=i.outChannels,w=i.outHeight,x=i.outWidth,C=i.strideHeight,E=i.strideWidth,S=i.dataFormat,k=h-1-i.padInfo.top,N=v-1-i.padInfo.left,M=S==="channelsLast",D=o.strides[0],T=M?o.strides[1]:o.strides[2],O=M?o.strides[2]:1,P=M?1:o.strides[1],A=e.strides[0],I=M?e.strides[1]:e.strides[2],_=M?e.strides[2]:1,F=M?1:e.strides[1],L=0;L<p;++L)for(var H=0;H<g;++H)for(var B=0;B<m;++B)for(var q=B-k,G=Math.max(0,Math.ceil(q/C)),re=Math.min(w,(h+q)/C),j=0;j<y;++j){for(var ae=j-N,ne=Math.max(0,Math.ceil(ae/E)),le=Math.min(x,(v+ae)/E),xe=0,se=G;se<re;++se)for(var we=se*C-q,de=ne;de<le;++de)for(var Z=A*L+I*se+_*de,ge=c*(h-1-we)+d*(v-1-(de*E-ae))+f*H,be=0;be<b;++be)xe+=s[Z+F*be]*u[ge+be];a[D*L+T*B+O*j+P*H]=xe}return o.toTensor()},n.prototype.conv3dDerInput=function(e,r,i){for(var o=He(i.inShape,"float32"),a=o.values,s=o.strides,u=s[0],l=s[1],c=s[2],d=s[3],f=this.readSync(e.dataId),p=e.strides,h=p[0],v=p[1],g=p[2],m=p[3],y=this.readSync(r.dataId),b=r.strides,w=b[0],x=b[1],C=b[2],E=b[3],S=i.batchSize,k=i.filterDepth,N=i.filterHeight,M=i.filterWidth,D=i.inChannels,T=i.inDepth,O=i.inHeight,P=i.inWidth,A=i.outChannels,I=i.outDepth,_=i.outHeight,F=i.outWidth,L=i.strideDepth,H=i.strideHeight,B=i.strideWidth,q=k-1-i.padInfo.front,G=N-1-i.padInfo.top,re=M-1-i.padInfo.left,j=0;j<S;++j)for(var ae=0;ae<D;++ae)for(var ne=0;ne<T;++ne)for(var le=ne-q,xe=Math.max(0,Math.ceil(le/L)),se=Math.min(I,(k+le)/L),we=0;we<O;++we)for(var de=we-G,Z=Math.max(0,Math.ceil(de/H)),ge=Math.min(_,(N+de)/H),be=0;be<P;++be){for(var fe=be-re,On=Math.max(0,Math.ceil(fe/B)),pn=Math.min(F,(M+fe)/B),Me=0,tt=xe;tt<se;++tt)for(var wt=tt*L-le,Te=Z;Te<ge;++Te)for(var nt=Te*H-de,Le=On;Le<pn;++Le)for(var rt=h*j+v*tt+g*Te+m*Le,ot=w*(k-1-wt)+x*(N-1-nt)+C*(M-1-(Le*B-fe))+E*ae,Ge=0;Ge<A;++Ge)Me+=f[rt+Ge]*y[ot+Ge];a[u*j+l*ne+c*we+d*be+ae]=Me}return o.toTensor()},n.prototype.conv2dDerFilter=function(e,r,i){pe([e,r],"conv2dDerFilter");for(var o=i.strideHeight,a=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",c=He(i.filterShape,"float32"),d=i.padInfo.left,f=i.padInfo.top,p=this.bufferSync(e),h=this.bufferSync(r),v=0;v<s;++v)for(var g=Math.max(0,Math.ceil((f-v)/o)),m=Math.min(i.outHeight,(i.inHeight+f-v)/o),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((d-y)/a)),w=Math.min(i.outWidth,(i.inWidth+d-y)/a),x=0;x<i.inChannels;++x)for(var C=0;C<i.outChannels;++C){for(var E=0,S=0;S<i.batchSize;++S)for(var k=g;k<m;++k)for(var N=v+k*o-f,M=b;M<w;++M){var D=y+M*a-d;E+=l?p.get(S,N,D,x)*h.get(S,k,M,C):p.get(S,x,N,D)*h.get(S,C,k,M)}c.set(E,v,y,x,C)}return c.toTensor()},n.prototype.conv3dDerFilter=function(e,r,i){for(var o=i.strideDepth,a=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,d=He(i.filterShape,"float32"),f=d.values,p=d.strides,h=p[0],v=p[1],g=p[2],m=p[3],y=this.readSync(r.dataId),b=r.strides,w=b[0],x=b[1],C=b[2],E=b[3],S=this.readSync(e.dataId),k=e.strides,N=k[0],M=k[1],D=k[2],T=k[3],O=i.padInfo.front,P=i.padInfo.left,A=i.padInfo.top,I=0;I<u;++I)for(var _=Math.max(0,Math.ceil((O-I)/o)),F=Math.min(i.outDepth,(i.inDepth+O-I)/o),L=I*h,H=0;H<l;++H)for(var B=Math.max(0,Math.ceil((A-H)/a)),q=Math.min(i.outHeight,(i.inHeight+A-H)/a),G=H*v+L,re=0;re<c;++re)for(var j=Math.max(0,Math.ceil((P-re)/s)),ae=Math.min(i.outWidth,(i.inWidth+P-re)/s),ne=re*g+G,le=0;le<i.inChannels;++le)for(var xe=le*m+ne,se=0;se<i.outChannels;++se){for(var we=0,de=0;de<i.batchSize;++de)for(var Z=de*N,ge=de*w,be=_;be<F;++be)for(var fe=(I+be*o-O)*M+Z,On=be*x+ge,pn=B;pn<q;++pn)for(var Me=(H+pn*a-A)*D+fe,tt=pn*C+On,wt=j;wt<ae;++wt){var Te=wt*E+tt;we+=S[(re+wt*s-P)*T+Me+le]*y[Te+se]}f[xe+se]=we}return d.toTensor()},n.prototype.fusedDepthwiseConv2D=function(e){var r=e.input,i=e.filter,o=e.convInfo,a=e.bias,s=e.activation,u=e.preluActivationWeights,l=this.depthwiseConv2D(r,i,o);return a&&(l=this.add(l,a)),s&&(l=o1(this,l,s,u)),l},n.prototype.depthwiseConv2D=function(e,r,i){pe([e,r],"depthwiseConv2D");for(var o=i.filterHeight,a=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,d=i.outChannels/i.inChannels,f=He(i.outShape,e.dtype),p=this.readSync(e.dataId),h=this.readSync(r.dataId),v=f.values,g=0;g<i.batchSize;++g)for(var m=g*e.strides[0],y=g*f.strides[0],b=0;b<i.outHeight;++b)for(var w=y+b*f.strides[1],x=b*i.strideHeight-l,C=0;C<o;++C){var E=x+C*s;if(!(E<0||E>=i.inHeight))for(var S=C*r.strides[0],k=m+E*e.strides[1],N=0;N<i.outWidth;++N)for(var M=w+N*f.strides[2],D=N*i.strideWidth-c,T=0;T<a;++T){var O=D+T*u;if(!(O<0||O>=i.inWidth))for(var P=S+T*r.strides[1],A=k+O*i.inChannels,I=M,_=P,F=0;F<i.inChannels;++F){for(var L=p[A+F],H=0;H<d;++H)v[I+H]+=L*h[_+H];I+=d,_+=d}}}return f.toTensor()},n.prototype.depthwiseConv2DDerInput=function(e,r,i){pe([e,r],"depthwiseConv2DDerInput");for(var o=He(i.inShape,"float32"),a=o.values,s=o.strides,u=s[0],l=s[1],c=s[2],d=this.readSync(e.dataId),f=e.strides,p=f[0],h=f[1],v=f[2],g=this.readSync(r.dataId),m=r.strides,y=m[0],b=m[1],w=m[2],x=i.batchSize,C=i.filterHeight,E=i.filterWidth,S=i.inChannels,k=i.inHeight,N=i.inWidth,M=i.outChannels,D=i.outHeight,T=i.outWidth,O=i.strideHeight,P=i.strideWidth,A=C-1-i.padInfo.top,I=E-1-i.padInfo.left,_=M/S,F=0;F<x;++F)for(var L=0;L<S;++L)for(var H=0;H<k;++H)for(var B=H-A,q=Math.max(0,Math.ceil(B/O)),G=Math.min(D,(C+B)/O),re=0;re<N;++re){for(var j=re-I,ae=Math.max(0,Math.ceil(j/P)),ne=Math.min(T,(E+j)/P),le=0,xe=q;xe<G;++xe)for(var se=xe*O-B,we=ae;we<ne;++we)for(var de=p*F+h*xe+v*we,Z=y*(C-1-se)+b*(E-1-(we*P-j))+w*L,ge=0;ge<_;++ge)le+=d[de+(L*_+ge)]*g[Z+ge];a[u*F+l*H+c*re+L]=le}return o.toTensor()},n.prototype.depthwiseConv2DDerFilter=function(e,r,i){pe([e,r],"depthwiseConv2DDerFilter");for(var o=i.strideHeight,a=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=He(i.filterShape,"float32"),c=i.padInfo.left,d=i.padInfo.top,f=i.outChannels/i.inChannels,p=this.bufferSync(e),h=this.bufferSync(r),v=0;v<s;++v)for(var g=Math.max(0,Math.ceil((d-v)/o)),m=Math.min(i.outHeight,(i.inHeight+d-v)/o),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((c-y)/a)),w=Math.min(i.outWidth,(i.inWidth+c-y)/a),x=0;x<i.outChannels;++x){for(var C=Math.trunc(x/f),E=x%f,S=0,k=0;k<i.batchSize;++k)for(var N=g;N<m;++N)for(var M=v+N*o-d,D=b;D<w;++D){var T=y+D*a-c;S+=p.get(k,M,T,C)*h.get(k,N,D,x)}l.set(S,v,y,C,E)}return l.toTensor()},n.prototype.tile=function(e,r){return pe(e,"tile"),iP(this.bufferSync(e),r)},n.prototype.pad=function(e,r,i){pe(e,"pad");var o=r.map(function(f,p){return f[0]+e.shape[p]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(e),u=He(o,e.dtype);i!==0&&u.values.fill(i);for(var l=0;l<e.size;l++){var c=s.indexToLoc(l),d=c.map(function(f,p){return f+a[p]});u.set.apply(u,[s.get.apply(s,c)].concat(d))}return u.toTensor()},n.prototype.transpose=function(e,r){pe(e,"transpose");for(var i=new Array(e.rank),o=0;o<i.length;o++)i[o]=e.shape[r[o]];var a=this.readSync(e.dataId),s=He(i,e.dtype),u=this.bufferSync(e);for(o=0;o<e.size;++o){for(var l=u.indexToLoc(o),c=new Array(l.length),d=0;d<c.length;d++)c[d]=l[r[d]];var f=s.locToIndex(c);s.values[f]=a[o]}return s.toTensor()},n.prototype.gather=function(e,r,i){pe([e,r],"gather");var o=e.shape.slice(),a=this.readSync(r.dataId);o[i]=a.length;for(var s=He(o,e.dtype),u=this.bufferSync(e),l=0;l<s.size;++l){var c=s.indexToLoc(l),d=c.slice();d[i]=a[c[i]];var f=u.locToIndex(d);s.values[l]=u.values[f]}return s.toTensor()},n.prototype.batchToSpaceND=function(e,r,i){pe([e],"batchToSpaceND");var o=r.reduce(function(d,f){return d*f}),a=pv(e.shape,r,o),s=hv(a.length,r.length),u=mv(e.shape,r,o),l=XM(i,r.length),c=YM(u,i,r.length);return e.reshape(a).transpose(s).reshape(u).slice(l,c)},n.prototype.spaceToBatchND=function(e,r,i){pe([e],"spaceToBatchND");var o=r.reduce(function(f,p){return f*p}),a=[[0,0]];a.push.apply(a,i);for(var s=1+r.length;s<e.shape.length;++s)a.push([0,0]);var u=e.pad(a),l=pv(u.shape,r,o,!1),c=hv(l.length,r.length,!1),d=mv(u.shape,r,o,!1);return u.reshape(l).transpose(c).reshape(d)},n.prototype.pool=function(e,r,i){pe(e,"pool");for(var o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,h=this.readSync(e.dataId),v=He(r.outShape,e.dtype),g=v.values,m=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3],w=0;w<r.batchSize;++w)for(var x=w*m,C=w*e.strides[0],E=0;E<r.inChannels;++E)for(var S=0;S<r.outHeight;++S)for(var k=S*o-d,N=Math.max(0,k),M=Math.min(r.inHeight,l+k),D=x+S*y,T=0;T<r.outWidth;++T){for(var O=T*a-f,P=Math.max(0,O),A=Math.min(r.inWidth,c+O),I=p,_=0,F=0,L=N;L<M;L+=s){for(var H=C+L*e.strides[1],B=P;B<A;B+=u){var q=h[H+B*e.strides[2]+E];i==="max"&&q>I?I=q:i==="avg"&&(_+=q,F++)}if(isNaN(I))break}g[D+T*b+E]=i==="avg"?_/F:I}return v.toTensor()},n.prototype.maxPool=function(e,r){return this.pool(e,r,"max")},n.prototype.maxPoolPositions=function(e,r){for(var i=He(r.outShape,"int32"),o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,p=this.bufferSync(e),h=0;h<r.batchSize;++h)for(var v=0;v<r.inChannels;++v)for(var g=0;g<r.outHeight;++g){for(var m=g*o-d,y=m;y<0;)y+=s;for(var b=Math.min(r.inHeight,l+m),w=0;w<r.outWidth;++w){for(var x=w*a-f,C=x;C<0;)C+=u;for(var E=Math.min(r.inWidth,c+x),S=Number.NEGATIVE_INFINITY,k=-1,N=y;N<b;N+=s)for(var M=N-m,D=C;D<E;D+=u){var T=D-x,O=p.get(h,N,D,v);O>S&&(S=O,k=M*c+T)}i.set(k,h,g,w,v)}}return i.toTensor()},n.prototype.maxPoolBackprop=function(e,r,i,o){pe([r,i],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,o),s=o.strideHeight,u=o.strideWidth,l=o.dilationHeight,c=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,p=f-1-o.padInfo.left,h=d-1-o.padInfo.top,v=He(r.shape,"float32"),g=this.bufferSync(a),m=this.bufferSync(e),y=0;y<o.batchSize;++y)for(var b=0;b<o.inChannels;++b)for(var w=0;w<o.inHeight;++w)for(var x=0;x<o.inWidth;++x){for(var C=w-h,E=x-p,S=0,k=0;k<d;k+=l){var N=(C+k)/s;if(!(N<0||N>=o.outHeight||Math.floor(N)!==N))for(var M=0;M<f;M+=c){var D=(E+M)/u;if(!(D<0||D>=o.outWidth||Math.floor(D)!==D)){var T=d*f-1-g.get(y,N,D,b)===k*f+M?1:0;T!==0&&(S+=m.get(y,N,D,b)*T)}}}v.set(S,y,w,x,b)}return v.toTensor()},n.prototype.avgPoolBackprop=function(e,r,i){pe([e,r],"avgPoolBackprop");for(var o=i.strideHeight,a=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,c=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,p=f-1-i.padInfo.left,h=d-1-i.padInfo.top,v=He(r.shape,"float32"),g=1/(s*u),m=this.bufferSync(e),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var w=0;w<i.inHeight;++w)for(var x=0;x<i.inWidth;++x){for(var C=w-h,E=x-p,S=0,k=0;k<d;k+=l){var N=(C+k)/o;if(!(N<0||N>=i.outHeight||Math.floor(N)!==N))for(var M=0;M<f;M+=c){var D=(E+M)/a;D<0||D>=i.outWidth||Math.floor(D)!==D||(S+=m.get(y,N,D,b))}}v.set(S*g,y,w,x,b)}return v.toTensor()},n.prototype.pool3d=function(e,r,i){pe(e,"pool3d");for(var o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=r.padInfo.front,v=r.padInfo.top,g=r.padInfo.left,m=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(e.dataId),b=He(r.outShape,e.dtype),w=b.values,x=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[3]*r.outShape[4],S=r.outShape[4],k=0;k<r.batchSize;++k)for(var N=k*x,M=k*e.strides[0],D=0;D<r.inChannels;++D)for(var T=0;T<r.outDepth;++T){for(var O=T*o-h,P=O;P<0;)P+=u;for(var A=Math.min(r.inDepth,d+O),I=N+T*C,_=0;_<r.outHeight;++_){for(var F=_*a-v,L=F;L<0;)L+=l;for(var H=Math.min(r.inHeight,f+F),B=I+_*E,q=0;q<r.outWidth;++q){for(var G=q*s-g,re=G;re<0;)re+=c;for(var j=Math.min(r.inWidth,p+G),ae=B+q*S,ne=m,le=0,xe=0,se=P;se<A;se+=u){for(var we=M+se*e.strides[1],de=L;de<H;de+=l){for(var Z=we+de*e.strides[2],ge=re;ge<j;ge+=c){var be=y[Z+ge*e.strides[3]+D];if(i==="max"&&be>ne?ne=be:i==="avg"&&(le+=be,xe++),isNaN(ne))break}if(isNaN(ne))break}if(isNaN(ne))break}w[ae+D]=i==="avg"?le/xe:ne}}}return b.toTensor()},n.prototype.avgPool3d=function(e,r){return pe(e,"avgPool3d"),this.pool3d(e,r,"avg").toFloat()},n.prototype.avgPool3dBackprop=function(e,r,i){pe([e,r],"avgPool3dBackprop");for(var o=i.strideDepth,a=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,d=i.dilationDepth,f=i.dilationHeight,p=i.dilationWidth,h=i.effectiveFilterDepth,v=i.effectiveFilterHeight,g=i.effectiveFilterWidth,m=h-1-i.padInfo.front,y=g-1-i.padInfo.left,b=v-1-i.padInfo.top,w=He(r.shape,"float32"),x=1/(u*l*c),C=this.bufferSync(e),E=0;E<i.batchSize;++E)for(var S=0;S<i.inChannels;++S)for(var k=0;k<i.inDepth;++k)for(var N=0;N<i.inHeight;++N)for(var M=0;M<i.inWidth;++M){for(var D=k-m,T=N-b,O=M-y,P=0,A=0;A<h;A+=d){var I=(D+A)/o;if(!(I<0||I>=i.outDepth||Math.floor(I)!==I))for(var _=0;_<v;_+=f){var F=(T+_)/a;if(!(F<0||F>=i.outHeight||Math.floor(F)!==F))for(var L=0;L<g;L+=p){var H=(O+L)/s;H<0||H>=i.outWidth||Math.floor(H)!==H||(P+=C.get(E,I,F,H,S))}}}w.set(P*x,E,k,N,M,S)}return w.toTensor()},n.prototype.maxPool3d=function(e,r){return pe(e,"maxPool3d"),this.pool3d(e,r,"max").toFloat()},n.prototype.maxPool3dPositions=function(e,r){for(var i=He(r.outShape,"int32"),o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=r.padInfo.front,v=r.padInfo.top,g=r.padInfo.left,m=this.bufferSync(e),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var w=0;w<r.outDepth;++w){for(var x=w*o-h,C=x;C<0;)C+=u;for(var E=Math.min(r.inDepth,d+x),S=0;S<r.outHeight;++S){for(var k=S*a-v,N=k;N<0;)N+=l;for(var M=Math.min(r.inHeight,f+k),D=0;D<r.outWidth;++D){for(var T=D*s-g,O=T;O<0;)O+=c;for(var P=Math.min(r.inWidth,p+T),A=Number.NEGATIVE_INFINITY,I=-1,_=C;_<E;_+=u)for(var F=_-x,L=N;L<M;L+=l)for(var H=L-k,B=O;B<P;B+=c){var q=B-T,G=m.get(y,_,L,B,b);G>=A&&(A=G,I=F*f*p+H*f+q)}i.set(I,y,w,S,D,b)}}}return i.toTensor()},n.prototype.maxPool3dBackprop=function(e,r,i,o){pe([r,i],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,o),s=o.strideDepth,u=o.strideHeight,l=o.strideWidth,c=o.dilationDepth,d=o.dilationHeight,f=o.dilationWidth,p=o.effectiveFilterDepth,h=o.effectiveFilterHeight,v=o.effectiveFilterWidth,g=p-1-o.padInfo.front,m=v-1-o.padInfo.left,y=h-1-o.padInfo.top,b=He(r.shape,"float32"),w=this.bufferSync(a),x=this.bufferSync(e),C=0;C<o.batchSize;++C)for(var E=0;E<o.inChannels;++E)for(var S=0;S<o.inDepth;++S)for(var k=0;k<o.inHeight;++k)for(var N=0;N<o.inWidth;++N){for(var M=S-g,D=k-y,T=N-m,O=0,P=0;P<p;P+=c){var A=(M+P)/s;if(!(A<0||A>=o.outDepth||Math.floor(A)!==A))for(var I=0;I<h;I+=d){var _=(D+I)/u;if(!(_<0||_>=o.outHeight||Math.floor(_)!==_))for(var F=0;F<v;F+=f){var L=(T+F)/l;if(!(L<0||L>=o.outWidth||Math.floor(L)!==L)){var H=p*h*v-1-w.get(C,A,_,L,E)===P*h*v+I*v+F?1:0;H!==0&&(O+=x.get(C,A,_,L,E)*H)}}}}b.set(O,C,S,k,N,E)}return b.toTensor()},n.prototype.cast=function(e,r){return gE(e,r,this)},n.prototype.reshape=function(e,r){return yv(e,r)},n.prototype.avgPool=function(e,r){return pe(e,"avgPool"),this.pool(e,r,"avg").toFloat()},n.prototype.resizeBilinear=function(e,r,i,o){pe(e,"resizeBilinear");for(var a=e.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(e.dataId),f=new Float32Array(Pe([s,r,i,c])),p=[o&&r>1?u-1:u,o&&i>1?l-1:l],h=[o&&r>1?r-1:r,o&&i>1?i-1:i],v=0,g=p[0]/h[0],m=p[1]/h[1],y=0;y<s;y++)for(var b=0;b<r;b++)for(var w=g*b,x=Math.floor(w),C=w-x,E=Math.min(u-1,Math.ceil(w)),S=y*e.strides[0]+x*e.strides[1],k=y*e.strides[0]+E*e.strides[1],N=0;N<i;N++)for(var M=m*N,D=Math.floor(M),T=M-D,O=Math.min(l-1,Math.ceil(M)),P=S+D*e.strides[2],A=k+D*e.strides[2],I=S+ +O*e.strides[2],_=k+O*e.strides[2],F=0;F<c;F++){var L=d[P+F],H=d[A+F],B=L+(d[I+F]-L)*T,q=B+(H+(d[_+F]-H)*T-B)*C;f[v++]=q}return mn(f,[s,r,i,c])},n.prototype.resizeBilinearBackprop=function(e,r,i){pe([e,r],"resizeBilinearBackprop");for(var o=r.shape,a=o[0],s=o[1],u=o[2],l=o[3],c=e.shape,d=c[1],f=c[2],p=new Float32Array(a*s*u*l),h=[i&&d>1?s-1:s,i&&f>1?u-1:u],v=[i&&d>1?d-1:d,i&&f>1?f-1:f],g=h[0]/v[0],m=h[1]/v[1],y=this.readSync(e.dataId),b=0,w=0;w<a;w++)for(var x=w*r.strides[0],C=0;C<d;C++)for(var E=C*g,S=Math.floor(E),k=Math.min(Math.ceil(E),s-1),N=x+S*r.strides[1],M=x+k*r.strides[1],D=E-S,T=1-D,O=0;O<f;O++)for(var P=O*m,A=Math.floor(P),I=Math.min(Math.ceil(P),u-1),_=P-A,F=1-_,L=N+A*r.strides[2],H=N+I*r.strides[2],B=M+A*r.strides[2],q=M+I*r.strides[2],G=T*F,re=T*_,j=D*F,ae=D*_,ne=0;ne<l;ne++){var le=y[b++];p[L+ne]+=le*G,p[H+ne]+=le*re,p[B+ne]+=le*j,p[q+ne]+=le*ae}return Ta(p,[a,u,s,l],r.dtype)},n.prototype.resizeNearestNeighbor=function(e,r,i,o){pe(e,"resizeNearestNeighbor");for(var a=e.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(e.dataId),f=new Float32Array(s*r*i*c),p=[o&&r>1?u-1:u,o&&i>1?l-1:l],h=[o&&r>1?r-1:r,o&&i>1?i-1:i],v=p[0]/h[0],g=p[1]/h[1],m=0,y=0;y<s;y++)for(var b=y*e.strides[0],w=0;w<r;w++)for(var x=v*w,C=b+Math.min(u-1,o?Math.round(x):Math.floor(x))*e.strides[1],E=0;E<i;E++)for(var S=g*E,k=C+Math.min(l-1,o?Math.round(S):Math.floor(S))*e.strides[2],N=0;N<c;N++){var M=d[k+N];f[m++]=M}return mn(f,[s,r,i,c],e.dtype)},n.prototype.resizeNearestNeighborBackprop=function(e,r,i){pe([e,r],"resizeNearestNeighborBackprop");for(var o=r.shape,a=o[0],s=o[1],u=o[2],l=o[3],c=e.shape,d=c[1],f=c[2],p=new Float32Array(a*s*u*l),h=this.readSync(e.dataId),v=[i&&d>1?s-1:s,i&&f>1?u-1:u],g=[i&&d>1?d-1:d,i&&f>1?f-1:f],m=v[0]/g[0],y=v[1]/g[1],b=1/m,w=1/y,x=2*Math.ceil(b)+2,C=2*Math.ceil(w)+2,E=0;E<a;E++)for(var S=E*r.strides[0],k=0;k<s;k++)for(var N=S+k*r.strides[1],M=Math.floor(k*b),D=Math.floor(M-x/2),T=0;T<u;T++)for(var O=N+T*r.strides[2],P=Math.floor(T*w),A=Math.floor(P-C/2),I=0;I<l;I++){for(var _=0,F=0;F<x;F++){var L=F+D;if(!(L<0||L>=d)){var H=S+L*e.strides[1],B=L*m;if(k===Math.min(s-1,i?Math.round(B):Math.floor(B)))for(var q=0;q<C;q++){var G=q+A;if(!(G<0||G>=f)){var re=H+G*e.strides[2],j=G*y;T===Math.min(u-1,i?Math.round(j):Math.floor(j))&&(_+=h[re+I])}}}}p[O+I]=_}return Ta(p,r.shape,r.dtype)},n.prototype.batchNormalization=function(e,r,i,o,a,s){pe([e,r,i,a,s],"batchNorm");for(var u=this.readSync(e.dataId),l=this.readSync(r.dataId),c=this.readSync(i.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),p=new Float32Array(u.length),h=f.length,v=d.length,g=c.length,m=l.length,y=0,b=0,w=0,x=0,C=0;C<u.length;++C)p[C]=f[y++]+(u[C]-l[b++])*d[w++]/Math.sqrt(c[x++]+o),y>=h&&(y=0),b>=m&&(b=0),w>=v&&(w=0),x>=g&&(x=0);return Ta(p,e.shape)},n.prototype.localResponseNormalization4D=function(e,r,i,o,a){pe(e,"localResponseNormalization4D");var s=e.shape[3],u=s-1,l=this.readSync(e.dataId),c=e.size,d=new Float32Array(c);function f(g){for(var m=g%s,y=g-m+Math.max(0,m-r),b=g-m+Math.min(m+r,u),w=0;y<=b;y++){var x=l[y];w+=x*x}return w}for(var p=0;p<c;p++){var h=f(p),v=l[p]*Math.pow(i+o*h,-a);d[p]=v}return Ta(d,e.shape)},n.prototype.LRNGrad=function(e,r,i,o,a,s,u){pe(e,"LRNGrad");for(var l=e.shape[3],c=this.readSync(e.dataId),d=this.readSync(r.dataId),f=this.readSync(i.dataId),p=new Float32Array(e.size),h=e.size,v=0;v<h;v++){for(var g=v%l,m=v-g+Math.max(0,g-o),y=v-g+Math.min(l,g+o+1),b=0,w=m;w<y;w++)b+=Math.pow(d[w],2);for(b=s*b+a,w=m;w<y;w++){var x=-2*s*u*d[w]*f[v]/b;v===w&&(x+=Math.pow(b,-u)),x*=c[v],p[w]+=x}}return Ta(p,e.shape)},n.prototype.multinomial=function(e,r,i,o){pe(e,"multinomial");for(var a=r?e:Ru(e),s=a.shape[0],u=a.shape[1],l=_t([s,i],"int32"),c=this.readSync(l.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var p=f*u,h=new Float32Array(u-1);h[0]=d[p];for(var v=1;v<h.length;++v)h[v]=h[v-1]+d[p+v];for(var g=xg(o.toString()),m=f*i,y=0;y<i;++y){var b=g();c[m+y]=h.length;for(var w=0;w<h.length;w++)if(b<h[w]){c[m+y]=w;break}}}return l},n.prototype.oneHot=function(e,r,i,o){pe(e,"oneHot");var a=new Float32Array(e.size*r);a.fill(o);for(var s=this.readSync(e.dataId),u=0;u<e.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=i);return Go(a,[e.size,r],"int32")},n.prototype.nonMaxSuppression=function(e,r,i,o,a){return pe(e,"nonMaxSuppression"),bE(this.readSync(e.dataId),this.readSync(r.dataId),i,o,a)},n.prototype.fft=function(e){return this.fftBatch(e,!1)},n.prototype.ifft=function(e){return this.fftBatch(e,!0)},n.prototype.fftBatch=function(e,r){for(var i=e.shape[0],o=e.shape[1],a=He(e.shape,"float32"),s=He(e.shape,"float32"),u=_r(e).as2D(i,o),l=vi(e).as2D(i,o),c=0;c<i;c++)for(var d=u.slice([c,0],[1,o]),f=l.slice([c,0],[1,o]),p=Nn(d,f),h=this.readSync(this.fftImpl(p,r).dataId),v=0;v<o;v++){var g=zN(h,v);a.values[c*o+v]=g.real,s.values[c*o+v]=g.imag}return Nn(a.toTensor(),s.toTensor()).as2D(i,o)},n.prototype.fftImpl=function(e,r){var i=e.as1D(),o=i.size;if(this.isExponentOf2(o)){var a=this.fftRadix2(i,o,r).as2D(e.shape[0],e.shape[1]);return r&&(a=Nn(_r(a).div(Ie(o)),vi(a).div(Ie(o)))),a}var s=this.readSync(e.dataId),u=function(l){for(var c=new Float32Array(l.length/2),d=new Float32Array(l.length/2),f=0;f<l.length;f+=2)c[f/2]=l[f],d[f/2]=l[f+1];return{real:c,imag:d}}(this.fourierTransformByMatmul(s,o,r));return Nn(u.real,u.imag).as2D(e.shape[0],e.shape[1])},n.prototype.isExponentOf2=function(e){return(e&e-1)==0},n.prototype.fftRadix2=function(e,r,i){if(r===1)return e;var o=this.readSync(e.dataId),a=r/2,s=function(m){for(var y=Math.ceil(m.length/4),b=new Float32Array(y),w=new Float32Array(y),x=0;x<m.length;x+=4)b[Math.floor(x/4)]=m[x],w[Math.floor(x/4)]=m[x+1];return{real:b,imag:w}}(o),u=Nn(s.real,s.imag).as1D(),l=function(m){for(var y=Math.floor(m.length/4),b=new Float32Array(y),w=new Float32Array(y),x=2;x<m.length;x+=4)b[Math.floor(x/4)]=m[x],w[Math.floor(x/4)]=m[x+1];return{real:b,imag:w}}(o),c=Nn(l.real,l.imag).as1D();u=this.fftRadix2(u,a,i),c=this.fftRadix2(c,a,i);var d=function(m,y){for(var b=new Float32Array(m/2),w=new Float32Array(m/2),x=0;x<Math.ceil(m/2);x++){var C=(y?2:-2)*Math.PI*(x/m);b[x]=Math.cos(C),w[x]=Math.sin(C)}return{real:b,imag:w}}(r,i),f=Nn(d.real,d.imag).mul(c),p=u.add(f),h=u.sub(f),v=_r(p).concat(_r(h)),g=vi(p).concat(vi(h));return Nn(v,g).as1D()},n.prototype.fourierTransformByMatmul=function(e,r,i){for(var o=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,l=0;l<r;l++){var c=B7(a*l,r,i),d=zN(e,l);s+=d.real*c.real-d.imag*c.imag,u+=d.real*c.imag+d.imag*c.real}i&&(s/=r,u/=r),z7(o,s,u,a)}return o},n.prototype.depthToSpace=function(e,r,i){U(i==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i}),U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var o=e.shape[0],a=e.shape[1],s=e.shape[2],u=e.shape[3],l=a*r,c=s*r,d=u/(r*r),f=this.readSync(e.dataId),p=new Float32Array(o*l*c*d),h=0,v=0;v<o;++v)for(var g=0;g<l;++g)for(var m=Math.floor(g/r),y=g%r,b=0;b<c;++b)for(var w=Math.floor(b/r),x=(y*r+b%r)*d,C=0;C<d;++C){var E=C+x+u*(w+s*(m+a*v));p[h++]=f[E]}return Ta(p,[o,l,c,d])},n.prototype.broadcastedBinaryOp=function(e,r,i,o){var a=lt(e.shape,r.shape),s=He(a,i),u=this.readSync(e.dataId),l=this.readSync(r.dataId),c=Hs(e.shape,a),d=Hs(r.shape,a),f=s.values;if(c.length+d.length===0)for(var p=0;p<f.length;++p)f[p]=o(u[p%u.length],l[p%l.length]);else{var h=this.bufferSync(e),v=this.bufferSync(r),g=function(m){var y=s.indexToLoc(m),b=y.slice(-e.rank);c.forEach(function(E){return b[E]=0});var w=h.locToIndex(b),x=y.slice(-r.rank);d.forEach(function(E){return x[E]=0});var C=v.locToIndex(x);f[m]=o(u[w],l[C])};for(p=0;p<f.length;++p)g(p)}return s.toTensor()},n.prototype.broadcastedBinaryComplexOp=function(e,r,i){var o=lt(e.shape,r.shape),a=He(o,"float32"),s=He(o,"float32"),u=this.readSync(e.dataId),l=this.readSync(r.dataId),c=Hs(e.shape,o),d=Hs(r.shape,o),f=a.values,p=s.values;if(c.length+d.length===0)for(var h=0;h<f.length;h++){var v=h%u.length,g=h%l.length,m=i(u[2*v],u[2*v+1],l[2*g],l[2*g+1]);f[h]=m.real,p[h]=m.imag}else{var y=this.bufferSync(this.data.get(e.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(x){var C=a.indexToLoc(x),E=C.slice(-e.rank);c.forEach(function(D){return E[D]=0});var S=y.locToIndex(E),k=C.slice(-r.rank);d.forEach(function(D){return k[D]=0});var N=b.locToIndex(k),M=i(u[2*S],u[2*S+1],l[2*N],l[2*N+1]);f[x]=M.real,p[x]=M.imag};for(h=0;h<f.length;h++)w(h)}return this.complex(a.toTensor(),s.toTensor())},n.prototype.split=function(e,r,i){return rP(e,r,i)},n.prototype.dispose=function(){},n.prototype.floatPrecision=function(){return 32},n.prototype.epsilon=function(){return 1e-7},n.prototype.cropAndResize=function(e,r,i,o,a,s){for(var u=e.shape,l=u[0],c=u[1],d=u[2],f=u[3],p=r.shape[0],h=o[0],v=o[1],g=He([p,h,v,f],e.dtype),m=this.readSync(r.dataId),y=this.readSync(i.dataId),b=this.readSync(e.dataId),w=e.strides,x=g.strides,C=0;C<p;C++){var E=4*C,S=m[E],k=m[E+1],N=m[E+2],M=m[E+3],D=y[C];if(!(D>=l))for(var T=h>1?(N-S)*(c-1)/(h-1):0,O=v>1?(M-k)*(d-1)/(v-1):0,P=0;P<h;P++){var A=h>1?S*(c-1)+P*T:.5*(S+N)*(c-1);if(A<0||A>c-1)for(var I=0;I<v;I++)for(var _=0;_<f;_++){var F=_+I*x[2]+P*x[1]+C*x[0];g.values[F]=s}else if(a==="bilinear"){var L=Math.floor(A),H=Math.ceil(A),B=A-L;for(I=0;I<v;I++)if((se=v>1?k*(d-1)+I*O:.5*(k+M)*(d-1))<0||se>d-1)for(_=0;_<f;_++)F=_+I*x[2]+P*x[1]+C*x[0],g.values[F]=s;else{var q=Math.floor(se),G=Math.ceil(se),re=se-q;for(_=0;_<f;_++){var j=b[F=_+q*w[2]+L*w[1]+D*w[0]],ae=b[F=_+G*w[2]+L*w[1]+D*w[0]],ne=b[F=_+q*w[2]+H*w[1]+D*w[0]],le=j+(ae-j)*re,xe=ne+(b[F=_+G*w[2]+H*w[1]+D*w[0]]-ne)*re;F=_+I*x[2]+P*x[1]+C*x[0],g.values[F]=le+(xe-le)*B}}}else for(I=0;I<v;++I){var se;if((se=v>1?k*(d-1)+I*O:.5*(k+M)*(d-1))<0||se>d-1)for(_=0;_<f;_++)F=_+I*x[2]+P*x[1]+C*x[0],g.values[F]=s;else{var we=Math.round(se),de=Math.round(A);for(_=0;_<f;_++){var Z=_+we*w[2]+de*w[1]+D*w[0],ge=_+I*x[2]+P*x[1]+C*x[0];g.values[ge]=b[Z]}}}}}return g.toTensor()},n.prototype.sparseToDense=function(e,r,i,o){var a=vv(0,e,i),s=a.sliceRank,u=a.numUpdates,l=a.sliceSize,c=a.strides,d=a.outputSize;return this.scatter(e,r,i,d,l,u,s,c,o,!1)},n.prototype.gatherND=function(e,r){var i=r.shape,o=i[i.length-1],a=JM(e,r),s=a[0],u=a[1],l=a[2],c=a[3];if(u===0)return mn([],s,e.dtype);for(var d=new Ql([u,l],e.dtype),f=this.readSync(r.dataId),p=this.readSync(e.dataId),h=0;h<u;h++){for(var v=[],g=0,m=0;m<o;m++){var y=f[h*o+m];g+=y*c[m],v.push(y)}if(g<0||g>=e.size/l)throw new Error("Invalid indices: "+v+" does not index into "+e.shape);for(var b=0;b<l;b++)d.values[h*l+b]=p[g*l+b]}return d.toTensor().reshape(s)},n.prototype.scatterND=function(e,r,i){var o=vv(0,e,i),a=o.sliceRank,s=o.numUpdates,u=o.sliceSize,l=o.strides,c=o.outputSize,d=Ie(0);return this.scatter(e,r,i,c,u,s,a,l,d,!0)},n.prototype.fill=function(e,r,i){var o=Af(i=i||Cc(r),Pe(e));return o.fill(r),K.makeTensor(o,e,i,this)},n.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},n.prototype.zerosLike=function(e){var r=Af(e.dtype,Pe(e.shape));return this.makeOutput(r,e.shape,e.dtype)},n.prototype.linspace=function(e,r,i){return yE(e,r,i)},n.prototype.scatter=function(e,r,i,o,a,s,u,l,c,d){var f=[o/a,a],p=this.readSync(e.dataId),h=this.readSync(r.dataId);if(o===0)return mn([],i,r.dtype);var v=new Ql(f,r.dtype);v.values.fill(this.readSync(c.dataId)[0]);for(var g=0;g<s;g++){for(var m=[],y=0,b=0;b<u;b++){var w=p[g*u+b];m.push(w),y+=w*l[b]}if(y<0||y>=o/a)throw new Error("Invalid indices: "+m+" does not index into "+i);for(var x=0;x<a;x++)d?v.values[y*a+x]+=h[g*a+x]:v.values[y*a+x]=r.rank===0?h[0]:h[g*a+x]}return v.toTensor().reshape(i)},n}(mE);K.registerBackend("cpu",function(){return new Bq},1),lw({kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var n=t.inputs,e=t.backend,r=n.x,i=e;pe(r,"square");for(var o=i.data.get(r.dataId).values,a=new Float32Array(o.length),s=0;s<o.length;++s){var u=o[s];a[s]=u*u}return{dataId:i.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}}),lw({kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var n=t.inputs,e=t.backend,r=n.x,i=e,o=new Je(r.shape,"return x * x;");return i.runWebGLProgram(o,[r],r.dtype)}});var jq=function(){function t(){}return t.prototype.fetch=function(n,e){return fetch(n,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(n,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(n)},t.prototype.decode=function(n,e){return new TextDecoder(e).decode(n)},t}();ie().get("IS_BROWSER")&&ie().setPlatform("browser",new jq);var a1,Vq=function(){return require("node-fetch")},$q=function(){function t(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(n,e){return ie().global.fetch!=null?ie().global.fetch(n,e):(a1==null&&(a1=Vq()),a1(n,e))},t.prototype.now=function(){var n=process.hrtime();return 1e3*n[0]+n[1]/1e6},t.prototype.encode=function(n,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(n)},t.prototype.decode=function(n,e){return n.length===0?"":new this.util.TextDecoder(e).decode(n)},t}();ie().get("IS_NODE")&&ie().setPlatform("node",new $q);var Rw={float32:4,int32:4,uint16:2,uint8:1,bool:1},bv=4;function LL(t,n){for(var e={},r=0,i=function(s){var u=s.name,l=s.dtype,c=s.shape,d=Pe(c),f=void 0;if("quantization"in s){var p=s.quantization;if(p.dtype!=="uint8"&&p.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+p.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var h=Rw[p.dtype],v=t.slice(r,r+d*h),g=p.dtype==="uint8"?new Uint8Array(v):new Uint16Array(v);if(l==="float32")f=Float32Array.from(g,function(C){return C*p.scale+p.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=Int32Array.from(g,function(C){return Math.round(C*p.scale+p.min)})}r+=d*h}else if(l==="string"){var m=Pe(s.shape);f=[];for(var y=0;y<m;y++){var b=new Uint32Array(t.slice(r,r+bv))[0];r+=bv;var w=new Uint8Array(t.slice(r,r+b));f.push(w),r+=b}}else{var x=Rw[l];if(v=t.slice(r,r+d*x),l==="float32")f=new Float32Array(v);else if(l==="int32")f=new Int32Array(v);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=new Uint8Array(v)}r+=d*x}e[u]=mn(f,c,l)},o=0,a=n;o<a.length;o++)i(a[o]);return e}function Uq(t){if(t===null)throw new Error("Invalid input value: "+JSON.stringify(t));var n=0,e=[];t.forEach(function(o){if(n+=o.byteLength,e.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+o.constructor.name)});var r=new Uint8Array(n),i=0;return e.forEach(function(o){r.set(new Uint8Array(o.buffer),i),i+=o.byteLength}),r.buffer}var Tw=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function ok(t){return Tw?Buffer.byteLength(t):new Blob([t]).size}function wC(t){var n=0;t.forEach(function(i){n+=i.byteLength});var e=new Uint8Array(n),r=0;return t.forEach(function(i){e.set(new Uint8Array(i),r),r+=i.byteLength}),e.buffer}function ak(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var n=t.split("/");return n[n.length-1]}function yp(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:ok(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:ok(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}var Xr=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerSaveRouter=function(n){t.getInstance().saveRouters.push(n)},t.registerLoadRouter=function(n){t.getInstance().loadRouters.push(n)},t.getSaveHandlers=function(n){return t.getHandlers(n,"save")},t.getLoadHandlers=function(n,e){return t.getHandlers(n,"load",e)},t.getHandlers=function(n,e,r){var i=[];return(e==="load"?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach(function(o){var a=o(n,r);a!==null&&i.push(a)}),i},t}(),Dl="://",Za=function(){function t(){this.managers={}}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerManager=function(n,e){U(n!=null,function(){return"scheme must not be undefined or null."}),n.endsWith(Dl)&&(n=n.slice(0,n.indexOf(Dl))),U(n.length>0,function(){return"scheme must not be an empty string."});var r=t.getInstance();U(r.managers[n]==null,function(){return"A model store manager is already registered for scheme '"+n+"'."}),r.managers[n]=e},t.getManager=function(n){var e=this.getInstance().managers[n];if(e==null)throw new Error("Cannot find model manager for scheme '"+n+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function vm(t){if(t.indexOf(Dl)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Za.getSchemes().join(","));return{scheme:t.split(Dl)[0],path:t.split(Dl)[1]}}function sk(t,n,e){return e===void 0&&(e=!1),Oe(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,d;return De(this,function(f){switch(f.label){case 0:return U(t!==n,function(){return"Old path and new path are the same: '"+t+"'"}),U((r=Xr.getLoadHandlers(t)).length>0,function(){return"Copying failed because no load handler is found for source URL "+t+"."}),U(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."}),i=r[0],U((o=Xr.getSaveHandlers(n)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+n+"."}),U(o.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+n+"."}),a=o[0],s=vm(t).scheme,u=vm(t).path,l=s===vm(t).scheme,[4,i.load()];case 1:return c=f.sent(),e&&l?[4,Za.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(c)];case 4:return d=f.sent(),!e||l?[3,6]:[4,Za.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var qs="models_store",Fa="model_info_store";function FL(){if(!ie().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window,n=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(n==null)throw new Error("The current browser does not appear to support IndexedDB.");return n}function Nw(t){var n=t.result;n.createObjectStore(qs,{keyPath:"modelPath"}),n.createObjectStore(Fa,{keyPath:"modelPath"})}var Ml=function(){function t(n){if(this.indexedDB=FL(),n==null||!n)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=n}return t.prototype.save=function(n){return Oe(this,void 0,void 0,function(){return De(this,function(e){if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,n)]})})},t.prototype.load=function(){return Oe(this,void 0,void 0,function(){return De(this,function(n){return[2,this.databaseAction(this.modelPath)]})})},t.prototype.databaseAction=function(n,e){var r=this;return new Promise(function(i,o){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Nw(a)},a.onsuccess=function(){var s=a.result;if(e==null){var u=s.transaction(qs,"readonly"),l=u.objectStore(qs).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),o(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(v){return s.close(),o(l.error)},u.oncomplete=function(){return s.close()}}else{var c,d=yp(e),f=s.transaction(Fa,"readwrite"),p=f.objectStore(Fa),h=p.put({modelPath:r.modelPath,modelArtifactsInfo:d});h.onsuccess=function(){var v=(c=s.transaction(qs,"readwrite")).objectStore(qs).put({modelPath:r.modelPath,modelArtifacts:e,modelArtifactsInfo:d});v.onsuccess=function(){return i({modelArtifactsInfo:d})},v.onerror=function(g){var m=(p=f.objectStore(Fa)).delete(r.modelPath);m.onsuccess=function(){return s.close(),o(v.error)},m.onerror=function(y){return s.close(),o(v.error)}}},h.onerror=function(v){return s.close(),o(h.error)},f.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return o(a.error)}})},t.URL_SCHEME="indexeddb://",t}(),uk=function(t){return ie().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ml.URL_SCHEME)?(n=t.slice(Ml.URL_SCHEME.length),new Ml(n)):null;var n};Xr.registerSaveRouter(uk),Xr.registerLoadRouter(uk);var Wq=function(){function t(){this.indexedDB=FL()}return t.prototype.listModels=function(){return Oe(this,void 0,void 0,function(){var n=this;return De(this,function(e){return[2,new Promise(function(r,i){var o=n.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return Nw(o)},o.onsuccess=function(){var a=o.result,s=a.transaction(Fa,"readonly"),u=s.objectStore(Fa).getAll();u.onsuccess=function(){for(var l={},c=0,d=u.result;c<d.length;c++){var f=d[c];l[f.modelPath]=f.modelArtifactsInfo}r(l)},u.onerror=function(l){return a.close(),i(u.error)},s.oncomplete=function(){return a.close()}},o.onerror=function(a){return i(o.error)}})]})})},t.prototype.removeModel=function(n){return Oe(this,void 0,void 0,function(){var e=this;return De(this,function(r){var i;return n=(i=n).startsWith(Ml.URL_SCHEME)?i.slice(Ml.URL_SCHEME.length):i,[2,new Promise(function(o,a){var s=e.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Nw(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(Fa,"readwrite"),d=c.objectStore(Fa),f=d.get(n);f.onsuccess=function(){if(f.result==null)return l.close(),a(new Error("Cannot find model with path '"+n+"' in IndexedDB."));var p=d.delete(n),h=function(){var v=(u=l.transaction(qs,"readwrite")).objectStore(qs).delete(n);v.onsuccess=function(){return o(f.result.modelArtifactsInfo)},v.onerror=function(g){return a(f.error)}};p.onsuccess=h,p.onerror=function(v){return h(),l.close(),a(f.error)}},f.onerror=function(p){return l.close(),a(f.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return a(s.error)}})]})})},t}();if(ie().getBool("IS_BROWSER"))try{Za.registerManager(Ml.URL_SCHEME,new Wq)}catch{}var jo="/",al="tensorflowjs_models",zL="info",Hq="model_topology",Gq="weight_specs",qq="weight_data",Kq="model_metadata";function BL(t){return{info:[al,t,zL].join(jo),topology:[al,t,Hq].join(jo),weightSpecs:[al,t,Gq].join(jo),weightData:[al,t,qq].join(jo),modelMetadata:[al,t,Kq].join(jo)}}function Xq(t){var n=t.split(jo);if(n.length<3)throw new Error("Invalid key format: "+t);return n.slice(1,n.length-1).join(jo)}var Pl=function(){function t(n){if(!ie().getBool("IS_BROWSER")||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,n==null||!n)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=n,this.keys=BL(this.modelPath)}return t.prototype.save=function(n){return Oe(this,void 0,void 0,function(){var e,r,i;return De(this,function(o){if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(n.modelTopology),r=JSON.stringify(n.weightSpecs),i=yp(n);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,(a=n.weightData,Tw?Buffer.from(a).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(a))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy})),[2,{modelArtifactsInfo:i}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}var a;return[2]})})},t.prototype.load=function(){return Oe(this,void 0,void 0,function(){var n,e,r,i,o,a,s;return De(this,function(u){if((n=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(n.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=i,(o=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(o),e.format=a.format,e.generatedBy=a.generatedBy,e.convertedBy=a.convertedBy),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(l){if(Tw){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var d=atob(l),f=new Uint8Array(d.length),p=0;p<d.length;++p)f.set([d.charCodeAt(p)],p);return f.buffer}(s),[2,e]})})},t.URL_SCHEME="localstorage://",t}(),lk=function(t){return ie().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Pl.URL_SCHEME)?(n=t.slice(Pl.URL_SCHEME.length),new Pl(n)):null;var n};Xr.registerSaveRouter(lk),Xr.registerLoadRouter(lk);var Yq=function(){function t(){U(ie().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),U(window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return t.prototype.listModels=function(){return Oe(this,void 0,void 0,function(){var n,e,r,i,o,a;return De(this,function(s){for(n={},e=al+jo,r=jo+zL,i=0;i<this.LS.length;++i)(o=this.LS.key(i)).startsWith(e)&&o.endsWith(r)&&(a=Xq(o),n[a]=JSON.parse(this.LS.getItem(o)));return[2,n]})})},t.prototype.removeModel=function(n){return Oe(this,void 0,void 0,function(){var e,r;return De(this,function(i){var o;if(n=(o=n).startsWith(Pl.URL_SCHEME)?o.slice(Pl.URL_SCHEME.length):o,e=BL(n),this.LS.getItem(e.info)==null)throw new Error("Cannot find model at path '"+n+"'");return r=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,r]})})},t}();if(ie().getBool("IS_BROWSER"))try{Za.registerManager(Pl.URL_SCHEME,new Yq)}catch{}var Jq="model",Qq=".json",Zq=".weights.bin";function ck(t){return new Promise(function(n){return setTimeout(n)}).then(t)}var s1=function(){function t(n){if(!ie().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");n.startsWith(t.URL_SCHEME)&&(n=n.slice(t.URL_SCHEME.length)),n!=null&&n.length!==0||(n=Jq),this.modelTopologyFileName=n+Qq,this.weightDataFileName=n+Zq}return t.prototype.save=function(n){return Oe(this,void 0,void 0,function(){var e,r,i,o,a,s;return De(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([n.weightData],{type:"application/octet-stream"})),!(n.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:n.weightSpecs}],i={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:r},o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=o,[4,ck(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),n.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=e,[4,ck(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:yp(n)}]}})})},t.URL_SCHEME="downloads://",t}(),eK=function(){function t(n){if(n==null||n.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+n);this.files=n}return t.prototype.load=function(){return Oe(this,void 0,void 0,function(){var n,e,r=this;return De(this,function(i){return n=this.files[0],e=this.files.slice(1),[2,new Promise(function(o,a){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){e.length===0&&o({modelTopology:c});var d=l.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,e)}catch(g){return void a(g)}var p=[],h=[],v=[];d.forEach(function(g){g.paths.forEach(function(m){h.push(m),v.push(null)}),p.push.apply(p,g.weights)}),d.forEach(function(g){g.paths.forEach(function(m){var y=new FileReader;y.onload=function(b){var w=b.target.result,x=h.indexOf(m);v[x]=w,v.indexOf(null)===-1&&o({modelTopology:c,weightSpecs:p,weightData:wC(v)})},y.onerror=function(b){return a("Failed to weights data from file of path '"+m+"'.")},y.readAsArrayBuffer(f[m])})})}else a(new Error("weightManifest field is missing from file "+n.name))}else a(new Error("modelTopology field is missing from file "+n.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+n.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(n)})]})})},t.prototype.checkManifestAndWeightFiles=function(n,e){for(var r=[],i=e.map(function(u){return ak(u.name)}),o={},a=0,s=n;a<s.length;a++)s[a].paths.forEach(function(u){var l=ak(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");o[u]=e[i.indexOf(l)]});if(r.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+e.length+").");return o},t}();function dk(t,n,e,r){(function(o){U(o!=null&&Array.isArray(o)&&o.length>0,function(){return"promises must be a none empty array"})})(t),function(o,a){U(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+o}),U(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),U(a>=o,function(){return"startFraction must be no more than endFraction, but got startFraction "+o+" and endFraction "+a})}(e=e??0,r=r??1);var i=0;return Promise.all(t.map(function(o){return o.then(function(a){var s=e+ ++i/t.length*(r-e);return n(s),a}),o}))}function jL(t,n){return Oe(this,void 0,void 0,function(){var e,r,i,o,a,s,u,l,c;return De(this,function(d){switch(d.label){case 0:return n==null&&(n={}),e=n.fetchFunc==null?ie().platform.fetch:n.fetchFunc,r=t.map(function(f){return e(f,n.requestInit,{isBinary:!0})}),i=0,o=.5,n.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,dk(r,n.onProgress,i,o)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,l=1,n.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=d.sent(),[3,8];case 6:return[4,dk(s,n.onProgress,u,l)];case 7:c=d.sent(),d.label=8;case 8:return[2,c]}})})}function fk(t){var n=this;return function(e,r,i){return r===void 0&&(r=""),Oe(n,void 0,void 0,function(){var o,a,s,u,l,c,d,f,p,h;return De(this,function(v){switch(v.label){case 0:if(o=e.map(function(){return!1}),a={},s=i!=null?i.map(function(){return!1}):[],u=[],e.forEach(function(g,m){var y=0;g.weights.forEach(function(b){var w="quantization"in b?b.quantization.dtype:b.dtype,x=Rw[w]*Pe(b.shape),C=function(){o[m]=!0,a[m]==null&&(a[m]=[]),a[m].push({manifestEntry:b,groupOffset:y,sizeBytes:x})};i!=null?i.forEach(function(E,S){E===b.name&&(C(),s[S]=!0)}):C(),u.push(b.name),y+=x})}),!s.every(function(g){return g}))throw l=i.filter(function(g,m){return!s[m]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=o.reduce(function(g,m,y){return m&&g.push(y),g},[]),d=[],c.forEach(function(g){e[g].paths.forEach(function(m){var y=r+(r.endsWith("/")?"":"/")+m;d.push(y)})}),[4,t(d)];case 1:return f=v.sent(),p={},h=0,c.forEach(function(g){for(var m=e[g].paths.length,y=0,b=0;b<m;b++)y+=f[h+b].byteLength;for(var w=new ArrayBuffer(y),x=new Uint8Array(w),C=0,E=0;E<m;E++){var S=new Uint8Array(f[h+E]);x.set(S,C),C+=S.byteLength}a[g].forEach(function(k){var N=LL(w.slice(k.groupOffset,k.groupOffset+k.sizeBytes),[k.manifestEntry]);for(var M in N)p[M]=N[M]}),h+=m}),[2,p]}})})}}Xr.registerSaveRouter(function(t){return ie().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(s1.URL_SCHEME)?(n=t.slice(s1.URL_SCHEME.length),n===void 0&&(n="model"),new s1(n)):null;var n});var VL=function(){function t(n,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,e.fetchFunc!=null?(U(typeof e.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=ie().platform.fetch,U(n!=null&&n.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(n)&&U(n.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+n.length+")."}),this.path=n,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(n){return Oe(this,void 0,void 0,function(){var e,r,i,o;return De(this,function(a){switch(a.label){case 0:if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:n.weightSpecs}],i={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,userDefinedMetadata:n.userDefinedMetadata,weightsManifest:r},e.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),n.weightData!=null&&e.body.append("model.weights.bin",new Blob([n.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((o=a.sent()).ok)return[2,{modelArtifactsInfo:yp(n),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}})})},t.prototype.load=function(){return Oe(this,void 0,void 0,function(){var n,e,r,i,o,a,s,u;return De(this,function(l){switch(l.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(n=l.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+n.status+". Please verify this URL points to the model JSON of the model to load.");l.label=2;case 2:return l.trys.push([2,4,,5]),[4,n.json()];case 3:return e=l.sent(),[3,5];case 4:throw l.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=e.modelTopology,o=e.weightsManifest,i==null&&o==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return o==null?[3,7]:[4,this.loadWeights(o)];case 6:u=l.sent(),a=u[0],s=u[1],l.label=7;case 7:return[2,{modelTopology:i,weightSpecs:a,weightData:s}]}})})},t.prototype.loadWeights=function(n){return Oe(this,void 0,void 0,function(){var e,r,i,o,a,s,u,l,c,d,f;return De(this,function(p){switch(p.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,r=function(h){var v=h.lastIndexOf("/"),g=h.lastIndexOf("?"),m=h.substring(0,v),y=g>v?h.substring(g):"";return[m+"/",y]}(e),i=r[0],o=r[1],a=this.weightPathPrefix||i,s=[],u=0,l=n;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return d=[],n.forEach(function(h){h.paths.forEach(function(v){d.push(a+v+o)})}),[4,jL(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=p.sent(),[2,[s,wC(f)]]}})})},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function kw(t){return t.match(VL.URL_SCHEME_REGEX)!=null}var pk=function(t,n){return typeof fetch>"u"?null:(Array.isArray(t)?t.every(function(e){return kw(e)}):kw(t))?Iw(t,{onProgress:n}):null};function Iw(t,n){return new VL(t,n)}Xr.registerSaveRouter(pk),Xr.registerLoadRouter(pk);var u1=function(){function t(n){this.modelArtifacts=n}return t.prototype.load=function(){return Oe(this,void 0,void 0,function(){return De(this,function(n){return[2,this.modelArtifacts]})})},t}(),tK=function(){function t(n){this.saveHandler=n}return t.prototype.save=function(n){return Oe(this,void 0,void 0,function(){return De(this,function(e){return[2,this.saveHandler(n)]})})},t}(),Yr=Object.freeze({browserFiles:function(t){return new eK(t)},browserHTTPRequest:function(t,n){return Iw(t,n)},concatenateArrayBuffers:wC,decodeWeights:LL,encodeWeights:function(t,n){return Oe(this,void 0,void 0,function(){var e,r,i,o,a,s=this;return De(this,function(u){switch(u.label){case 0:for(e=[],r=[],i=Array.isArray(t)?t.map(function(l){return l.name}):Object.keys(t),o=function(l){var c=i[l],d=Array.isArray(t)?t[l].tensor:t[c];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+d.dtype);var f={name:c,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var p=new Promise(function(h){return Oe(s,void 0,void 0,function(){var v,g,m,y,b,w,x;return De(this,function(C){switch(C.label){case 0:return[4,d.bytes()];case 1:for(v=C.sent(),g=v.reduce(function(E,S){return E+S.length},0)+bv*v.length,m=new Uint8Array(g),y=0,b=0;b<v.length;b++)w=v[b],x=new Uint8Array(new Uint32Array([w.length]).buffer),m.set(x,y),y+=bv,m.set(w,y),y+=w.length;return h(m),[2]}})})});r.push(p)}else r.push(d.data());n!=null&&(f.group=n),e.push(f)},a=0;a<i.length;++a)o(a);return[4,Promise.all(r)];case 1:return[2,{data:Uq(u.sent()),specs:e}]}})})},fromMemory:function(t,n,e,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new u1(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new u1({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new u1({modelTopology:t,weightSpecs:n,weightData:e,trainingConfig:r}))},getLoadHandlers:function(t,n){return Xr.getLoadHandlers(t,n)},getModelArtifactsInfoForJSON:yp,getSaveHandlers:function(t){return Xr.getSaveHandlers(t)},http:Iw,isHTTPScheme:kw,loadWeights:function(t,n,e,r){return n===void 0&&(n=""),Oe(this,void 0,void 0,function(){return De(this,function(i){return[2,fk(function(o){return jL(o,{requestInit:r})})(t,n,e)]})})},registerLoadRouter:function(t){return Xr.registerLoadRouter(t)},registerSaveRouter:function(t){return Xr.registerSaveRouter(t)},weightsLoaderFactory:fk,withSaveHandler:function(t){return new tK(t)},copyModel:function(t,n){return Oe(this,void 0,void 0,function(){return De(this,function(e){return[2,sk(t,n,!1)]})})},listModels:function(){return Oe(this,void 0,void 0,function(){var t,n,e,r,i,o,a;return De(this,function(s){switch(s.label){case 0:t=Za.getSchemes(),n={},e=0,r=t,s.label=1;case 1:return e<r.length?(i=r[e],[4,Za.getManager(i).listModels()]):[3,4];case 2:for(a in o=s.sent())n[i+Dl+a]=o[a];s.label=3;case 3:return e++,[3,1];case 4:return[2,n]}})})},moveModel:function(t,n){return Oe(this,void 0,void 0,function(){return De(this,function(e){return[2,sk(t,n,!0)]})})},removeModel:function(t){return Oe(this,void 0,void 0,function(){var n;return De(this,function(e){return n=vm(t),[2,Za.getManager(n.scheme).removeModel(n.path)]})})}}),nK=X({confusionMatrix_:function(t,n,e){var r=V(t,"labels","confusionMatrix"),i=V(n,"predictions","confusionMatrix");U(e==null||e>0&&Number.isInteger(e),function(){return"If provided, numClasses must be a positive integer, but got "+e}),U(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),U(i.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),U(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),U(e>0&&Number.isInteger(e),function(){return"numClasses is required to be a positive integer, but got "+e});var o=Zl(r.asType("int32"),e),a=Zl(i.asType("int32"),e);return o.transpose().matMul(a).asType("int32")}}),rK=Object.freeze({confusionMatrix:nK}),iK=X({fromPixels_:function(t,n){if(n===void 0&&(n=3),n>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var e=typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement;if(e&&e&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return K.fromPixels(t,n)}}),$L=Object.freeze({toPixels:function(t,n){return Oe(this,void 0,void 0,function(){var e,r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,C,E,S;return De(this,function(k){switch(k.label){case 0:if(e=V(t,"img","toPixels"),t instanceof At||(e=e.toInt()),e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(r=e.shape.slice(0,2),i=r[0],o=r[1],(a=e.rank===2?1:e.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,e.data()];case 1:return s=k.sent(),u=e.min(),l=e.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=k.sent(),d=c[0],f=c[1],p=d[0],h=f[0],u.dispose(),l.dispose(),e.dtype==="float32"){if(p<0||h>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+p+" - "+h+"].")}else{if(e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(p<0||h>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+p+" - "+h+"].")}for(v=e.dtype==="float32"?255:1,g=new Uint8ClampedArray(o*i*4),m=0;m<i*o;++m)y=void 0,b=void 0,w=void 0,x=void 0,a===1?(y=s[m]*v,b=s[m]*v,w=s[m]*v,x=255):a===3?(y=s[3*m]*v,b=s[3*m+1]*v,w=s[3*m+2]*v,x=255):a===4&&(y=s[4*m]*v,b=s[4*m+1]*v,w=s[4*m+2]*v,x=s[4*m+3]*v),g[0+(C=4*m)]=Math.round(y),g[C+1]=Math.round(b),g[C+2]=Math.round(w),g[C+3]=Math.round(x);return n!=null&&(n.width=o,n.height=i,E=n.getContext("2d"),S=new ImageData(g,o,i),E.putImageData(S,0,0)),e!==t&&e.dispose(),[2,g]}})})},fromPixels:iK}),UL=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(n,e){return new n(e)},t}(),WL=function(){function t(){this.classNameMap={}}return t.getMap=function(){return t.instance==null&&(t.instance=new t),t.instance},t.register=function(n){t.getMap().classNameMap[n.className]=[n,n.fromConfig]},t}();function xs(t){U(t.className!=null,function(){return"Class being registered does not have the static className property defined."}),U(typeof t.className=="string",function(){return"className is required to be a string, but got type "+typeof t.className}),U(t.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),WL.register(t)}var he=Object.freeze({Serializable:UL,SerializationMap:WL,registerClass:xs}),oK=.001,HL=.1;function l1(){return K.backend.floatPrecision()===32?oK:HL}function c1(t,n,e){var r=!0;if((Kn(t)||Kn(n))&&(r=!1),Kn(t)&&Kn(n)&&(r=!0),r){var i=t.constructor.name,o=n.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(t)&&Array.isArray(n)){var a=xo(t),s=xo(n);if(!Bn(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=Kn(t)?t:na(t),l=Kn(n)?n:na(n);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+`.
Actual:   `+u+`.
Expected: `+l+".");for(var c=0;c<l.length;++c){var d=u[c],f=l[c];if(!e(d,f))throw new Error("Arrays differ: actual["+c+"] = "+d+", expected["+c+"] = "+f+`.
Actual:   `+u+`.
Expected: `+l+".")}}function d1(t,n,e){return!isFinite(t)&&!isFinite(n)||!(isNaN(t)||isNaN(n)||Math.abs(t-n)>e)}var aK=Object.freeze({TEST_EPSILON_FLOAT16:HL,expectArraysClose:function(t,n,e){return e==null&&(e=l1()),c1(t,n,function(r,i){return d1(r,i,e)})},testEpsilon:l1,expectPromiseToFail:function(t,n){t().then(function(){return n.fail()},function(){return n()})},expectArraysEqual:function(t,n){var e=typeof n=="string"||typeof n=="number"||typeof n=="boolean"?[n]:n;return La(t)||La(t[0])||La(n)||La(n[0])?c1(t,e,function(r,i){return r==i}):c1(t,n,function(r,i){return d1(r,i,0)})},expectNumbersClose:function(t,n,e){if(e==null&&(e=l1()),!d1(t,n,e))throw new Error("Numbers differ: actual === "+t+", expected === "+n)},expectValuesInRange:function(t,n,e){for(var r=0;r<t.length;r++)if(t[r]<n||t[r]>e)throw new Error("Value out of range:"+t[r]+" low: "+n+", high: "+e)},expectArrayBuffersEqual:function(t,n){expect(new Float32Array(t)).toEqual(new Float32Array(n))}}),GL="1.3.1",sK=Object.freeze({gpgpu_util:AG,webgl_util:s7,forceHalfFloat:function(){ie().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:MP,setWebGLContext:lM,GPGPUContext:NP}),da=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return Hi(n,t),n.prototype.minimize=function(e,r,i){r===void 0&&(r=!1);var o=this.computeGradients(e,i),a=o.value,s=o.grads;if(i!=null){var u=i.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return Ze(s),r?a:(a.dispose(),null)},Object.defineProperty(n.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),n.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},n.prototype.computeGradients=function(e,r){return nP(e,r)},n.prototype.dispose=function(){this.iterations_!=null&&Ze(this.iterations_)},n.prototype.saveIterations=function(){return Oe(this,void 0,void 0,function(){return De(this,function(e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Ie(this.iterations_,"int32")}]})})},n.prototype.getWeights=function(){return Oe(this,void 0,void 0,function(){return De(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},n.prototype.setWeights=function(e){return Oe(this,void 0,void 0,function(){return De(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},n.prototype.extractIterations=function(e){return Oe(this,void 0,void 0,function(){var r;return De(this,function(i){switch(i.label){case 0:return r=this,[4,e[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,e.slice(1)]}})})},n}(UL);Object.defineProperty(da,Symbol.hasInstance,{value:function(t){return t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null}});var xC=function(t){function n(e,r,i){i===void 0&&(i=null);var o=t.call(this)||this;return o.learningRate=e,o.rho=r,o.epsilon=i,o.accumulatedGrads=[],o.accumulatedUpdates=[],i==null&&(o.epsilon=K.backend.epsilon()),o}return Hi(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e)).forEach(function(i,o){var a=K.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accum_grad",variable:ee(function(){return dt(a).variable(!1)})}),r.accumulatedUpdates[o]==null&&(r.accumulatedUpdates[o]={originalName:i+"/accum_var",variable:ee(function(){return dt(a).variable(!1)})});var s=Array.isArray(e)?e[o].tensor:e[i];if(s!=null){var u=r.accumulatedGrads[o].variable,l=r.accumulatedUpdates[o].variable;ee(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(c),l.assign(f);var p=d.mul(-r.learningRate).add(a);a.assign(p)})}}),this.incrementIterations()},n.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Ze(this.accumulatedGrads.map(function(e){return e.variable})),Ze(this.accumulatedUpdates.map(function(e){return e.variable})))},n.prototype.getWeights=function(){return Oe(this,void 0,void 0,function(){var e;return De(this,function(r){switch(r.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},n.prototype.setWeights=function(e){return Oe(this,void 0,void 0,function(){var r;return De(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),r=e.length/2,this.accumulatedGrads=e.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},n.fromConfig=function(e,r){return new e(r.learningRate,r.rho,r.epsilon)},n.className="Adadelta",n}(da);xs(xC);var SC=function(t){function n(e,r){r===void 0&&(r=.1);var i=t.call(this)||this;return i.learningRate=e,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return Hi(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e)).forEach(function(i,o){var a=K.registeredVariables[i];r.accumulatedGrads[o]==null&&(r.accumulatedGrads[o]={originalName:i+"/accumulator",variable:ee(function(){return Tc(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(e)?e[o].tensor:e[i];if(s!=null){var u=r.accumulatedGrads[o].variable;ee(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(K.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},n.prototype.dispose=function(){this.accumulatedGrads!=null&&Ze(this.accumulatedGrads.map(function(e){return e.variable}))},n.prototype.getWeights=function(){return Oe(this,void 0,void 0,function(){return De(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},n.prototype.setWeights=function(e){return Oe(this,void 0,void 0,function(){return De(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulatedGrads=e.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},n.fromConfig=function(e,r){return new e(r.learningRate,r.initialAccumulatorValue)},n.className="Adagrad",n}(da);xs(SC);var EC=function(t){function n(e,r,i,o){o===void 0&&(o=null);var a=t.call(this)||this;return a.learningRate=e,a.beta1=r,a.beta2=i,a.epsilon=o,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],ee(function(){a.accBeta1=Ie(r).variable(),a.accBeta2=Ie(i).variable()}),o==null&&(a.epsilon=K.backend.epsilon()),a}return Hi(n,t),n.prototype.applyGradients=function(e){var r=this,i=Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e);ee(function(){var o=jn(1,r.accBeta1),a=jn(1,r.accBeta2);i.forEach(function(s,u){var l=K.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ee(function(){return dt(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:ee(function(){return dt(l).variable(!1)})});var c=Array.isArray(e)?e[u].tensor:e[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,p=d.mul(r.beta1).add(c.mul(1-r.beta1)),h=f.mul(r.beta2).add(c.square().mul(1-r.beta2)),v=p.div(o),g=h.div(a);d.assign(p),f.assign(h);var m=v.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(m)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},n.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ze(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedSecondMoment!=null&&Ze(this.accumulatedSecondMoment.map(function(e){return e.variable}))},n.prototype.getWeights=function(){return Oe(this,void 0,void 0,function(){var e;return De(this,function(r){switch(r.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},n.prototype.setWeights=function(e){return Oe(this,void 0,void 0,function(){var r,i=this;return De(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(e)];case 1:return e=o.sent(),ee(function(){i.accBeta1.assign(tc(i.beta1,i.iterations_+1)),i.accBeta2.assign(tc(i.beta2,i.iterations_+1))}),r=e.length/2,this.accumulatedFirstMoment=e.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},n.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon)},n.className="Adam",n}(da);xs(EC);var CC=function(t){function n(e,r,i,o,a){o===void 0&&(o=null),a===void 0&&(a=0);var s=t.call(this)||this;return s.learningRate=e,s.beta1=r,s.beta2=i,s.epsilon=o,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],ee(function(){s.iteration=Ie(0).variable(),s.accBeta1=Ie(r).variable()}),o==null&&(s.epsilon=K.backend.epsilon()),s}return Hi(n,t),n.prototype.applyGradients=function(e){var r=this,i=Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e);ee(function(){var o=jn(1,r.accBeta1),a=cr(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach(function(s,u){var l=K.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:dt(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:dt(l).variable(!1)});var c=Array.isArray(e)?e[u].tensor:e[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,p=d.mul(r.beta1).add(c.mul(1-r.beta1)),h=f.mul(r.beta2),v=c.abs(),g=h.maximum(v);d.assign(p),f.assign(g);var m=a.div(o).mul(p.div(g.add(r.epsilon))).add(l);l.assign(m)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},n.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ze(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedWeightedInfNorm!=null&&Ze(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},n.prototype.getWeights=function(){return Oe(this,void 0,void 0,function(){return De(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},n.prototype.setWeights=function(e){return Oe(this,void 0,void 0,function(){return De(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},n.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},n.className="Adamax",n}(da);xs(CC);var iy=function(t){function n(e){var r=t.call(this)||this;return r.learningRate=e,r.setLearningRate(e),r}return Hi(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e)).forEach(function(i,o){var a=Array.isArray(e)?e[o].tensor:e[i];if(a!=null){var s=K.registeredVariables[i];ee(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},n.prototype.setLearningRate=function(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=wo(Ie(-e))},n.prototype.dispose=function(){this.c.dispose()},n.prototype.getWeights=function(){return Oe(this,void 0,void 0,function(){return De(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},n.prototype.setWeights=function(e){return Oe(this,void 0,void 0,function(){return De(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:if((e=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate}},n.fromConfig=function(e,r){return new e(r.learningRate)},n.className="SGD",n}(da);xs(iy);var RC=function(t){function n(e,r,i){i===void 0&&(i=!1);var o=t.call(this,e)||this;return o.learningRate=e,o.momentum=r,o.useNesterov=i,o.accumulations=[],o.m=Ie(o.momentum),o}return Hi(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e)).forEach(function(i,o){var a=K.registeredVariables[i];r.accumulations[o]==null&&(r.accumulations[o]={originalName:i+"/momentum",variable:ee(function(){return dt(a).variable(!1)})});var s=r.accumulations[o].variable,u=Array.isArray(e)?e[o].tensor:e[i];u!=null&&ee(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(l)})}),this.incrementIterations()},n.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Ze(this.accumulations.map(function(e){return e.variable}))},n.prototype.setMomentum=function(e){this.momentum=e},n.prototype.getWeights=function(){return Oe(this,void 0,void 0,function(){return De(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},n.prototype.setWeights=function(e){return Oe(this,void 0,void 0,function(){return De(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulations=e.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},n.fromConfig=function(e,r){return new e(r.learningRate,r.momentum,r.useNesterov)},n.className="Momentum",n}(iy);xs(RC);var TC=function(t){function n(e,r,i,o,a){r===void 0&&(r=.9),i===void 0&&(i=0),o===void 0&&(o=null),a===void 0&&(a=!1);var s=t.call(this)||this;return s.learningRate=e,s.decay=r,s.momentum=i,s.epsilon=o,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,o==null&&(s.epsilon=K.backend.epsilon()),s}return Hi(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e)).forEach(function(i,o){var a=K.registeredVariables[i];r.accumulatedMeanSquares[o]==null&&(r.accumulatedMeanSquares[o]={originalName:i+"/rms",variable:ee(function(){return dt(a).variable(!1)})}),r.accumulatedMoments[o]==null&&(r.accumulatedMoments[o]={originalName:i+"/momentum",variable:ee(function(){return dt(a).variable(!1)})}),r.accumulatedMeanGrads[o]==null&&r.centered&&(r.accumulatedMeanGrads[o]={originalName:i+"/mg",variable:ee(function(){return dt(a).variable(!1)})});var s=Array.isArray(e)?e[o].tensor:e[i];if(s!=null){var u=r.accumulatedMeanSquares[o].variable,l=r.accumulatedMoments[o].variable;ee(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[o].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),p=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(f.square().add(r.epsilon)).sqrt()));u.assign(c),d.assign(f),l.assign(p);var h=a.sub(p);a.assign(h)}else{var v=u.mul(r.decay).add(s.square().mul(1-r.decay));p=l.mul(r.momentum).add(s.mul(r.learningRate).div(v.add(r.epsilon).sqrt())),u.assign(v),l.assign(p),h=a.sub(p),a.assign(h)}})}}),this.incrementIterations()},n.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Ze(this.accumulatedMeanSquares.map(function(e){return e.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Ze(this.accumulatedMeanGrads.map(function(e){return e.variable})),this.accumulatedMoments!=null&&Ze(this.accumulatedMoments.map(function(e){return e.variable}))},n.prototype.getWeights=function(){return Oe(this,void 0,void 0,function(){var e;return De(this,function(r){switch(r.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},n.prototype.setWeights=function(e){return Oe(this,void 0,void 0,function(){var r;return De(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),r=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*r,3*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},n.fromConfig=function(e,r){return new e(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},n.className="RMSProp",n}(da);xs(TC);var Ts=function(){function t(){}return t.sgd=function(n){return new iy(n)},t.momentum=function(n,e,r){return r===void 0&&(r=!1),new RC(n,e,r)},t.rmsprop=function(n,e,r,i,o){return e===void 0&&(e=.9),r===void 0&&(r=0),i===void 0&&(i=null),o===void 0&&(o=!1),new TC(n,e,r,i,o)},t.adam=function(n,e,r,i){return n===void 0&&(n=.001),e===void 0&&(e=.9),r===void 0&&(r=.999),i===void 0&&(i=null),new EC(n,e,r,i)},t.adadelta=function(n,e,r){return n===void 0&&(n=.001),e===void 0&&(e=.95),r===void 0&&(r=null),new xC(n,e,r)},t.adamax=function(n,e,r,i,o){return n===void 0&&(n=.002),e===void 0&&(e=.9),r===void 0&&(r=.999),i===void 0&&(i=null),o===void 0&&(o=0),new CC(n,e,r,i,o)},t.adagrad=function(n,e){return e===void 0&&(e=.1),new SC(n,e)},t}(),Ls={sgd:Ts.sgd,momentum:Ts.momentum,adadelta:Ts.adadelta,adagrad:Ts.adagrad,rmsprop:Ts.rmsprop,adamax:Ts.adamax,adam:Ts.adam},uK=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:function(t){return t()};function gm(){return new Promise(function(t){return uK(function(){return t()})})}oe=zq;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qL=function(t,n){return(qL=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])})(t,n)};function ue(t,n){function e(){this.constructor=t}qL(t,n),t.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var f1,Ld=function(){return(Ld=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)};function Ue(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(c){o(c)}}function s(l){try{u(r.throw(l))}catch(c){o(c)}}function u(l){l.done?i(l.value):new e(function(c){c(l.value)}).then(a,s)}u((r=r.apply(t,n||[])).next())})}function ze(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(l){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(c[0]===6&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=n.call(t,a)}catch(d){c=[6,d],r=0}finally{e=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function En(){return f1==null&&(f1=PM().epsilon()),f1}function Ui(){return"channelsLast"}var Fs=function(t){function n(e){var r=t.call(this,e)||this;return Object.setPrototypeOf(r,n.prototype),r}return ue(n,t),n}(Error),lo=function(t){function n(e){var r=t.call(this,e)||this;return Object.setPrototypeOf(r,n.prototype),r}return ue(n,t),n}(Error),Y=function(t){function n(e){var r=t.call(this,e)||this;return Object.setPrototypeOf(r,n.prototype),r}return ue(n,t),n}(Error),Xe=function(t){function n(e){var r=t.call(this,e)||this;return Object.setPrototypeOf(r,n.prototype),r}return ue(n,t),n}(Error),lK=function(t){function n(e){var r=t.call(this,e)||this;return Object.setPrototypeOf(r,n.prototype),r}return ue(n,t),n}(Error);(function(t){function n(e){var r=t.call(this,e)||this;return Object.setPrototypeOf(r,n.prototype),r}return ue(n,t),n})(Error);function pu(t,n){if(Array.isArray(t)){for(var e=[],r=0;r<n;r++)e=e.concat(t);return e}return(e=new Array(n)).fill(t),e}function oo(t,n){if(!t)throw new lK(n)}function hk(t,n){for(var e=0,r=0,i=t;r<i.length;r++)i[r]===n&&e++;return e}function mr(t){return t.length===1?t[0]:t}function zt(t){return Array.isArray(t)?t:[t]}function Bo(t){var n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Bs(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,function(n,e){return e.toUpperCase()})}var ci={};function NC(t){if(t==null)return null;var n={};return n.className=t.getClassName(),n.config=t.getConfig(),n}function _w(t){if(t!=null&&typeof t=="object")if(Array.isArray(t))t.forEach(function(o){return _w(o)});else for(var n=0,e=Object.keys(t);n<e.length;n++){var r=e[n],i=t[r];i!=null&&typeof i=="object"&&(Array.isArray(i)||i.type!=="ndarray"||typeof i.value!="number"?_w(i):t[r]=i.value)}}function bp(t,n,e,r,i){var o,a,s;if(n===void 0&&(n={}),e===void 0&&(e={}),r===void 0&&(r="object"),i===void 0&&(i=!1),typeof t=="string"){var u=t,l=void 0;if(u in e)l=e[u];else if(u in ci)l=ci[u];else if((l=n[u])==null)throw new Y("Unknown "+r+": "+t+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return l}var c=t;if(c.className==null||c.config==null)throw new Y(r+": Improper config format: "+JSON.stringify(c)+`.
'className' and 'config' must set.`);var d=c.className,f=void 0,p=void 0;if(d in e?(f=(o=e[d])[0],p=o[1]):d in ci?(f=(a=ci.className)[0],p=a[1]):d in n&&(f=(s=n[d])[0],p=s[1]),f==null)throw new Y("Unknown "+r+": "+d+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(p!=null){for(var h={},v=0,g=Object.keys(ci);v<g.length;v++)h[C=g[v]]=ci[C];for(var m=0,y=Object.keys(e);m<y.length;m++)h[C=y[m]]=e[C];c.config.customObjects=h;for(var b=Ld({},ci),w=0,x=Object.keys(e);w<x.length;w++){var C=x[w];ci[C]=e[C]}_w(c.config);var E=p(f,c.config,e,i);return ci=Ld({},b),E}b=Ld({},ci);for(var S=0,k=Object.keys(e);S<k.length;S++)C=k[S],ci[C]=e[C];return E=new f(c.config),ci=Ld({},b),E}function cK(t,n){return t<n?-1:t>n?1:0}function Ch(t,n){return-1*cK(t,n)}function es(t){if(t==null)return t;for(var n=[],e=0,r=t;e<r.length;e++){var i=r[e];n.indexOf(i)===-1&&n.push(i)}return n}function dK(t){if(t==null)throw new Y("Invalid value in obj: "+JSON.stringify(t));for(var n in t)if(t.hasOwnProperty(n))return!1;return!0}function Dc(t,n,e){if(e!=null&&t.indexOf(e)<0)throw new Y(e+" is not a valid "+n+".  Valid values are "+t+" or null/undefined.")}function kC(t,n,e,r){return e===void 0&&(e=0),r===void 0&&(r=1/0),oo(e>=0),oo(r>=e),Array.isArray(t)&&t.length>=e&&t.length<=r&&t.every(function(i){return typeof i===n})}function wr(t,n){Array.isArray(t)?(Fe.assert(t.length>0,function(){return n+" is unexpectedly an empty array."}),t.forEach(function(e,r){return wr(e,"element "+(r+1)+" of "+n)})):Fe.assert(Number.isInteger(t)&&t>0,function(){return"Expected "+n+" to be a positive integer, but got "+KL(t)+"."})}function KL(t){return t===null?"null":Array.isArray(t)?"["+t.map(function(n){return KL(n)}).join(",")+"]":typeof t=="string"?'"'+t+'"':""+t}function fK(t,n){var e,r=Fe.now();return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var a=Fe.now();return a-r<n?e:(r=a,e=t.apply(void 0,i))}}function XL(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}function IC(t,n){return ee(function(){return cp(Br(zg(t,t),n,!0))})}var wp=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.getConfig=function(){return{}},n}(he.Serializable),YL=function(t){function n(e){var r=t.call(this)||this;return r.defaultMaxValue=2,r.defaultAxis=0,r.maxValue=e.maxValue!=null?e.maxValue:r.defaultMaxValue,r.axis=e.axis!=null?e.axis:r.defaultAxis,r}return ue(n,t),n.prototype.apply=function(e){var r=this;return ee(function(){var i=IC(e,r.axis),o=br(i,0,r.maxValue);return We(e,cr(o,st(En(),i)))})},n.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},n.className="MaxNorm",n}(wp);he.registerClass(YL);var JL=function(t){function n(e){var r=t.call(this)||this;return r.defaultAxis=0,r.axis=e.axis!=null?e.axis:r.defaultAxis,r}return ue(n,t),n.prototype.apply=function(e){var r=this;return ee(function(){return cr(e,st(En(),IC(e,r.axis)))})},n.prototype.getConfig=function(){return{axis:this.axis}},n.className="UnitNorm",n}(wp);he.registerClass(JL);var QL=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return ws(e)},n.className="NonNeg",n}(wp);he.registerClass(QL);var ZL=function(t){function n(e){var r=t.call(this)||this;return r.defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=e.minValue!=null?e.minValue:r.defaultMinValue,r.maxValue=e.maxValue!=null?e.maxValue:r.defaultMaxValue,r.rate=e.rate!=null?e.rate:r.defaultRate,r.axis=e.axis!=null?e.axis:r.defaultAxis,r}return ue(n,t),n.prototype.apply=function(e){var r=this;return ee(function(){var i=IC(e,r.axis),o=st(We(r.rate,br(i,r.minValue,r.maxValue)),We(1-r.rate,i));return We(e,cr(o,st(En(),i)))})},n.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},n.className="MinMaxNorm",n}(wp);he.registerClass(ZL);var mk={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Dt(t){return NC(t)}function vk(t,n){return n===void 0&&(n={}),bp(t,he.SerializationMap.getMap().classNameMap,n,"constraint")}function Cn(t){return t==null?null:typeof t=="string"?vk({className:t in mk?mk[t]:t,config:{}}):t instanceof wp?t:vk(t)}function pK(t){return new YL(t)}function hK(t){return new JL(t)}function mK(){return new QL}function vK(t){return new ZL(t)}var gK=Object.freeze({maxNorm:pK,unitNorm:hK,nonNeg:mK,minMaxNorm:vK}),yK=["channelsFirst","channelsLast"],bK=["valid","same","causal"],wK=["max","avg"],xK=["sum","mul","concat","ave"],Xu=new Map;function Tn(t){Dc(yK,"DataFormat",t)}function Ci(t){Dc(bK,"PaddingMode",t)}function e3(t){Dc(wK,"PoolMode",t)}var ef=[],gk="/";function tu(t,n){ef.push(t);try{var e=n();return ef.pop(),e}catch(r){throw ef.pop(),r}}function SK(){return ef.length===0?"":ef.join(gk)+gk}function t3(t){if(!r3(t))throw new Error("Not a valid tensor name: '"+t+"'");return SK()+t}function n3(t){if(!r3(t))throw new Error("Not a valid tensor name: '"+t+"'");Xu.has(t)||Xu.set(t,0);var n=Xu.get(t);if(Xu.set(t,Xu.get(t)+1),n>0){var e=t+"_"+n;return Xu.set(e,1),e}return t}var EK=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function r3(t){return!!t.match(EK)}function CK(t){return t===parseInt(t.toString(),10)}function ts(t,n,e){n==null&&(n=0),e==null&&(e=t.length);for(var r=1,i=n;i<e;++i)r*=t[i];return r}function i3(t){return t=Array.isArray(t)?new Float32Array(t):t,zr(t)}function ac(t){return Xg(i3(t)).dataSync()[0]}function ls(t){return us(i3(t)).dataSync()[0]}function Wi(t,n){if(n<t)throw new Y("end ("+n+") < begin ("+t+") is forbidden.");for(var e=[],r=t;r<n;++r)e.push(r);return e}function xp(t,n){return t.asType(n)}function Sp(t,n){n===void 0&&(n=-1);var e=t.shape.slice();return n<0&&(n=e.length+n+1),e.splice(n,0,1),t.reshape(e)}function RK(t,n){return ee(function(){if(t.shape.length!==2)throw new Y("repeat() expects a rank-2 tensor, but received a rank-"+t.shape.length+" tensor.");return Aw(Sp(t,1),[1,n,1])})}function TK(t){var n=[ts(t.shape)];return t.reshape(n)}function NK(t){if(t.rank<=1)throw new Y("batchFlatten requires a minimum rank of 2. Got rank: "+t.rank+".");var n=[t.shape[0],ts(t.shape,1)];return t.reshape(n)}function nu(t,n,e){return ee(function(){switch(t.rank){case 1:return pp(t,n,e);case 2:return qg(t,[n,0],[e,t.shape[1]]);case 3:return hp(t,[n,0,0],[e,t.shape[1],t.shape[2]]);case 4:return rc(t,[n,0,0,0],[e,t.shape[1],t.shape[2],t.shape[3]]);case 5:return ni(t,[n,0,0,0,0],[e,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return ni(t,[n,0,0,0,0,0],[e,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new Y("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}})}function p1(t,n,e){return ee(function(){switch(t.rank){case 1:return pp(t,n,e);case 2:return qg(t,[0,n],[t.shape[0],e]);case 3:return hp(t,[0,0,n],[t.shape[0],t.shape[1],e]);case 4:return rc(t,[0,0,0,n],[t.shape[0],t.shape[1],t.shape[2],e]);default:throw new Y("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function Rh(t,n,e,r){return ee(function(){switch(t.rank){case 1:return pp(t,n,e);case 2:switch(r){case 1:return nu(t,n,e);case 2:return p1(t,n,e);default:throw new Y("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return nu(t,n,e);case 2:return hp(t,[0,n,0],[t.shape[0],e,t.shape[2]]);case 3:return p1(t,n,e);default:throw new Y("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return nu(t,n,e);case 2:return rc(t,[0,n,0,0],[t.shape[0],e,t.shape[2],t.shape[3]]);case 3:return rc(t,[0,0,n,0],[t.shape[0],t.shape[1],e,t.shape[3]]);case 4:return p1(t,n,e);default:throw new Y("The axis is not within the rank of the tensor "+r)}default:throw new Y("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function o3(t,n){var e;return n===void 0&&(n=-1),n<0&&(n=(e=t[0].rank)!==0?e:0),n===t[0].rank&&(n=-1),lr(t,n)}function yk(t,n){switch(t.rank){case 1:return rE([t,n]);case 2:return iE([t,n],0);case 3:return oE([t,n],0);case 4:return aE([t,n],0);default:throw new Y("concatAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}function Aw(t,n){if(Array.isArray(n)||(n=[n]),t.rank!==n.length)throw new Y("The length of input n ("+n.length+") does not match the number of dimensions in input x ("+t.rank+")");return Qa(t,n)}function oy(t,n,e,r,i){return n===void 0&&(n=0),e===void 0&&(e=1),cE(t,n,e,r,i)}function Ko(t,n,e,r){if(t.rank<2||n.rank<2)throw new Xe("dot requires both inputs to be rank >= 2 but got x shape = "+t.shape+" and y shape = "+n.shape);if(n.rank>=3&&t.shape.slice(-1)[0]!==(c=n.shape.slice(-2)[0]))throw new Xe("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+t.shape+" and  y shape = "+n.shape);if(t.rank===2&&n.rank===2){var i=!1,o=!1;return oc.matMul({a:t,b:n,transposeA:i,transposeB:o,bias:r?Ow(t.rank,r,Ui()):null,activation:e})}var a=t.shape.slice(),s=a.pop();t=t.reshape([-1,s]);var u=n.shape.slice(),l=u.pop(),c=u.pop(),d=u.concat([l]),f=Array.from({length:n.rank},function(h,v){return v===0?n.rank-2:v<=n.rank-2?v-1:v});n=n.transpose(f).reshape([c,-1]);var p=a.concat(d);return i=!1,o=!1,oc.matMul({a:t,b:n,transposeA:i,transposeB:o,bias:r?Ow(t.rank,r,Ui()):null,activation:e}).reshape(p)}function a3(t,n,e){return ee(function(){return n=Array.isArray(n)?zr(n,"int32"):n.toInt(),_c(t,n,e)})}function Ep(t){return zg(t,t)}function Ow(t,n,e){var r=n.shape;if(n.rank!==1&&n.rank!==t)throw new Y("Unexpected bias dimensions: "+n.rank+"; expected it to be 1 or "+t);if(t===5){if(e==="channelsFirst")return r.length===1?n.reshape([1,r[0],1,1,1]):n.reshape([1,r[3],r[0],r[1],r[2]]);if(e==="channelsLast")return r.length===1?n.reshape([1,1,1,1,r[0]]):n.reshape([1].concat(r))}else if(t===4){if(e==="channelsFirst")return r.length===1?n.reshape([1,r[0],1,1]):n.reshape([1,r[2],r[0],r[1]]);if(e==="channelsLast")return r.length===1?n.reshape([1,1,1,r[0]]):n.reshape([1].concat(r))}else if(t===3){if(e==="channelsFirst")return r.length===1?n.reshape([1,r[0],1]):n.reshape([1,r[1],r[0]]);if(e==="channelsLast")return r.length===1?n.reshape([1,1,r[0]]):n.reshape([1].concat(r))}else if(t<3)return n;throw new Y("Unsupported input rank by biasAdd: "+n.rank)}function fa(t,n,e){return ee(function(){return e==null&&(e=Ui()),Tn(e),t.add(Ow(t.rank,n,e))})}function kK(t,n){if(n===void 0&&(n=1),n!==1)throw new Xe("Support for alpha values other than 1 ("+n+") is not implemented yet.");return Oc(t)}function IK(t){return ee(function(){return cr(t,ss(t).add(1))})}function s3(t,n,e,r){return ee(function(){return fC(t,n,e,r)})}function _K(t){return ee(function(){var n=st(.5,We(.2,t));return br(n,0,1)})}function sc(t,n,e){return e===void 0&&(e=!1),e?t():n()}var AK=["fanIn","fanOut","fanAvg"],OK=["normal","uniform","truncatedNormal"];function DK(t){Dc(AK,"FanMode",t)}function MK(t){Dc(OK,"Distribution",t)}var Xi=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.fromConfigUsesCustomObjects=function(){return!1},n.prototype.getConfig=function(){return{}},n}(he.Serializable),u3=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e,r){return _t(e,r)},n.className="Zeros",n}(Xi);he.registerClass(u3);var _C=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e,r){return Ro(e,r)},n.className="Ones",n}(Xi);he.registerClass(_C);var l3=function(t){function n(e){var r=t.call(this)||this;if(typeof e!="object")throw new Y("Expected argument of type ConstantConfig but got "+e);if(e.value===void 0)throw new Y("config must have value set but got "+e);return r.value=e.value,r}return ue(n,t),n.prototype.apply=function(e,r){var i=this;return ee(function(){return We(Ie(i.value),Ro(e,r))})},n.prototype.getConfig=function(){return{value:this.value}},n.className="Constant",n}(Xi);he.registerClass(l3);var c3=function(t){function n(e){var r=t.call(this)||this;return r.DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return ue(n,t),n.prototype.apply=function(e,r){return Cu(e,this.minval,this.maxval,r)},n.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},n.className="RandomUniform",n}(Xi);he.registerClass(c3);var d3=function(t){function n(e){var r=t.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return ue(n,t),n.prototype.apply=function(e,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new Xe("randomNormal does not support dType "+r+".");return oy(e,this.mean,this.stddev,r,this.seed)},n.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},n.className="RandomNormal",n}(Xi);he.registerClass(d3);var f3=function(t){function n(e){var r=t.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return ue(n,t),n.prototype.apply=function(e,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new Xe("truncatedNormal does not support dType "+r+".");return sp(e,this.mean,this.stddev,r,this.seed)},n.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},n.className="TruncatedNormal",n}(Xi);he.registerClass(f3);var p3=function(t){function n(e){var r=t.call(this)||this;return r.gain=e.gain!=null?e.gain:1,r}return ue(n,t),n.prototype.apply=function(e,r){var i=this;return ee(function(){if(e.length!==2||e[0]!==e[1])throw new Y("Identity matrix initializer can only be used for 2D square matrices.");return We(i.gain,Cg(e[0]))})},n.prototype.getConfig=function(){return{gain:this.gain}},n.className="Identity",n}(Xi);function PK(t,n){var e,r;if(n===void 0&&(n="channelsLast"),Tn(n),t.length===2)e=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1)if(n==="channelsFirst"){var i=ts(t,2);e=t[1]*i,r=t[0]*i}else n==="channelsLast"&&(i=ts(t,0,t.length-2),e=t[t.length-2]*i,r=t[t.length-1]*i);else{var o=ts(t);e=Math.sqrt(o),r=Math.sqrt(o)}return[e,r]}he.registerClass(p3);var jr=function(t){function n(e){var r=t.call(this)||this;if(e.scale<0)throw new Y("scale must be a positive float. Got: "+e.scale);return r.scale=e.scale==null?1:e.scale,r.mode=e.mode==null?"fanIn":e.mode,DK(r.mode),r.distribution=e.distribution==null?"normal":e.distribution,MK(r.distribution),r.seed=e.seed,r}return ue(n,t),n.prototype.apply=function(e,r){var i=PK(e),o=i[0],a=i[1],s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,o):this.mode==="fanOut"?s/=Math.max(1,a):s/=Math.max(1,(o+a)/2),this.distribution==="normal"){var u=Math.sqrt(s);if((r=r||"float32")!=="float32"&&r!=="int32")throw new Xe(this.getClassName()+" does not support dType "+r+".");return sp(e,0,u,r,this.seed)}var l=Math.sqrt(3*s);return Cu(e,-l,l,r)},n.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},n.className="VarianceScaling",n}(Xi);he.registerClass(jr);var AC=function(t){function n(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})||this}return ue(n,t),n.prototype.getClassName=function(){return jr.className},n.className="GlorotUniform",n}(jr);he.registerClass(AC);var OC=function(t){function n(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})||this}return ue(n,t),n.prototype.getClassName=function(){return jr.className},n.className="GlorotNormal",n}(jr);he.registerClass(OC);var DC=function(t){function n(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})||this}return ue(n,t),n.prototype.getClassName=function(){return jr.className},n.className="HeNormal",n}(jr);he.registerClass(DC);var MC=function(t){function n(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})||this}return ue(n,t),n.prototype.getClassName=function(){return jr.className},n.className="HeUniform",n}(jr);he.registerClass(MC);var PC=function(t){function n(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})||this}return ue(n,t),n.prototype.getClassName=function(){return jr.className},n.className="LeCunNormal",n}(jr);he.registerClass(PC);var LC=function(t){function n(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})||this}return ue(n,t),n.prototype.getClassName=function(){return jr.className},n.className="LeCunNormal",n}(jr);he.registerClass(LC);var h3=function(t){function n(e){var r=t.call(this)||this;if(r.DEFAULT_GAIN=1,r.gain=e.gain==null?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,r.seed!=null)throw new Xe("Random seed is not implemented for Orthogonal Initializer yet.");return r}return ue(n,t),n.prototype.apply=function(e,r){var i=this;return ee(function(){if(e.length!==2)throw new Xe("The Orthogonal Initializer does not support non-2D shapes yet.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+e[0]*e[1]+") elements: Slowness may result.");var o=oy(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),a=mC.gramSchmidt(o);return e[0]>e[1]&&(a=a.transpose()),We(i.gain,a)})},n.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},n.className="Orthogonal",n}(Xi);he.registerClass(h3);var bk={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function wk(t,n){return n===void 0&&(n={}),bp(t,he.SerializationMap.getMap().classNameMap,n,"initializer")}function Et(t){return NC(t)}function Gt(t){if(typeof t=="string"){var n=t in bk?bk[t]:t;if(n==="GlorotNormal")return new OC;if(n==="GlorotUniform")return new AC;if(n==="HeNormal")return new DC;if(n==="HeUniform")return new MC;if(n==="LeCunNormal")return new PC;if(n==="LeCunUniform")return new LC;var e={};return e.className=n,e.config={},wk(e)}return t instanceof Xi?t:wk(t)}function LK(){return new u3}function FK(){return new _C}function zK(t){return new l3(t)}function BK(t){return new c3(t)}function jK(t){return new d3(t)}function VK(t){return new f3(t)}function $K(t){return new p3(t)}function UK(t){return new jr(t)}function WK(t){return new AC(t)}function HK(t){return new OC(t)}function GK(t){return new DC(t)}function qK(t){return new MC(t)}function KK(t){return new PC(t)}function XK(t){return new LC(t)}function YK(t){return new h3(t)}var JK=Object.freeze({zeros:LK,ones:FK,constant:zK,randomUniform:BK,randomNormal:jK,truncatedNormal:VK,identity:$K,varianceScaling:UK,glorotUniform:WK,glorotNormal:HK,heNormal:GK,heUniform:qK,leCunNormal:KK,leCunUniform:XK,orthogonal:YK}),QK=0;function m3(){return QK++}var Th={};function ay(t){return t===void 0&&(t=""),t in Th||(Th[t]=0),Th[t]+=1,t+Th[t].toString()}function Dw(t){return Array.isArray(t)&&Array.isArray(t[0])}function wv(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function Ye(t){var n;if(Array.isArray(t)){if(t.length!==1)throw new Y("Expected Tensor length to be 1; got "+t.length);n=t[0]}else n=t;return n}function Lt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return(t=t)[0];throw new Y("Expected exactly 1 Shape; got "+t.length)}return t}function xv(t){for(var n=0,e=0,r=t;e<r.length;e++){var i=r[e];i.shape.length===0?n+=1:n+=i.shape.reduce(function(o,a){return o*a})}return n}var xk="Variable",v3=function(){function t(n,e,r,i,o){e===void 0&&(e="float32"),r===void 0&&(r=xk),i===void 0&&(i=!0),o===void 0&&(o=null),this.dtype=e??"float32",this.shape=n.shape,this.id=m3(),r=r??xk,this.originalName=t3(r),this.name=n3(this.originalName),this.trainable_=i,this.constraint=o,this.val=tE(n,this.trainable_,this.name,this.dtype)}return t.prototype.read=function(){return this.assertNotDisposed(),this.val},t.prototype.write=function(n){return this.assertNotDisposed(),ZK(this.val,n),this.val.id!==n.id&&(this.val.assign(n),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},t.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},t.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this.trainable_=n,this.val.trainable=n},enumerable:!0,configurable:!0}),t}();function ZK(t,n){if(t.shape.toString()!==n.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(n.shape))}function Mw(t){return t.map(function(n){return n.read()})}function FC(t){t.forEach(function(n){n[0].write(n[1])})}var Fn=function(){return function(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}(),Pi=function(){return function(t,n,e,r,i,o,a){this.dtype=t,this.shape=n,this.sourceLayer=e,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=m3(),o!=null&&(this.originalName=t3(o),this.name=n3(this.originalName)),this.rank=n.length}}(),eX=0,sy=function(){function t(n,e){this.callArgs=e,this.id=eX++,this.outboundLayer=n.outboundLayer,this.inboundLayers=n.inboundLayers,this.nodeIndices=n.nodeIndices,this.tensorIndices=n.tensorIndices,this.inputTensors=n.inputTensors,this.outputTensors=n.outputTensors,this.inputMasks=n.inputMasks,this.outputMasks=n.outputMasks,this.inputShapes=n.inputShapes,this.outputShapes=n.outputShapes;for(var r=0,i=n.inboundLayers;r<i.length;r++){var o=i[r];o!=null&&o.outboundNodes.push(this)}n.outboundLayer.inboundNodes.push(this)}return t.prototype.getConfig=function(){for(var n=[],e=0,r=this.inboundLayers;e<r.length;e++){var i=r[e];i!=null?n.push(i.name):n.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:n,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},t}(),tX=0,pt=function(t){function n(e){var r=t.call(this)||this;r._callHook=null,r._addedWeightNames=[],r._stateful=!1,r.id=tX++,r.activityRegularizer=null,r.inputSpec=null,r.supportsMasking=!1,r._trainableWeights=[],r._nonTrainableWeights=[],r._losses=[],r._updates=[],r._built=!1,r.inboundNodes=[],r.outboundNodes=[];var i=e.name;if(!i){var o=r.getClassName();i=Bo(o)+"_"+ay(o)}if(r.name=i,r.trainable_=e.trainable==null||e.trainable,e.inputShape!=null||e.batchInputShape!=null){var a=void 0;if(e.batchInputShape!=null)a=e.batchInputShape;else if(e.inputShape!=null){var s=null;e.batchSize!=null&&(s=e.batchSize),a=[s].concat(e.inputShape)}r.batchInputShape=a;var u=e.dtype;u==null&&(u=e.inputDType),u==null&&(u="float32"),r.dtype=u}return e.weights!=null?r.initialWeights=e.weights:r.initialWeights=null,r._refCount=null,r.fastWeightInitDuringBuild=!1,r}return ue(n,t),n.nodeKey=function(e,r){return e.name+"_ib-"+r.toString()},n.prototype.getNodeAtIndex=function(e,r){if(this.inboundNodes.length===0)throw new lo("The layer has never been called and thus has no defined "+r+".");if(this.inboundNodes.length<=e)throw new Y("Asked to get "+r+" at node "+e+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[e]},n.prototype.getInputAt=function(e){return mr(this.getNodeAtIndex(e,"input").inputTensors)},n.prototype.getOutputAt=function(e){return mr(this.getNodeAtIndex(e,"output").outputTensors)},Object.defineProperty(n.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new Fs("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new Fs("Layer "+this.name+" is not connected, no input to return.");return mr(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new Fs("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Fs("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return mr(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),n.prototype.calculateLosses=function(){return this.losses.map(function(e){return e()})},Object.defineProperty(n.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"built",{get:function(){return this._built},set:function(e){this._built=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"trainable",{get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach(function(r){return r.trainable=e}),this.trainable_=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(e){return e.trainable}):[]},set:function(e){this._trainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(e){return!e.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),n.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},n.prototype.assertInputCompatibility=function(e){if(e=zt(e),this.inputSpec!=null&&this.inputSpec.length!==0){var r=zt(this.inputSpec);if(e.length!==r.length)throw new Y("Layer "+this.name+" expects "+r.length+" inputs, but it received "+e.length+" input tensors. Input received: "+e);for(var i=0;i<e.length;i++){var o=e[i],a=r[i];if(a!=null){var s=o.rank;if(a.ndim!=null&&s!==a.ndim)throw new Y("Input "+i+" is incompatible with layer "+this.name+": expected ndim="+a.ndim+", found ndim="+s);if(a.maxNDim!=null&&s>a.maxNDim)throw new Y("Input "+i+" is incompatible with layer "+this.name+": expected max_ndim="+a.maxNDim+", found ndim="+s);if(a.minNDim!=null&&s<a.minNDim)throw new Y("Input "+i+" is incompatible with layer "+this.name+": expected min_ndim="+a.minNDim+", found ndim="+s+".");if(a.dtype!=null&&o.dtype!==a.dtype)throw new Y("Input "+i+" is incompatible with layer "+this.name+" : expected dtype="+a.dtype+", found dtype="+o.dtype+".");if(a.axes){var u=o.shape;for(var l in a.axes){var c=Number(l),d=a.axes[l],f=c>=0?u[c]:u[u.length+c];if(d!=null&&[d,null].indexOf(f)===-1)throw new Y("Input "+i+" is incompatible with layer "+this.name+": expected axis "+c+" of input shape to have value "+d+" but got shape "+u+".")}}if(a.shape!=null)for(var p=0;p<a.shape.length;++p){var h=a.shape[p],v=o.shape[p];if(h!=null&&v!=null&&h!==v)throw new Y("Input "+i+" is incompatible with layer "+this.name+": expected shape="+a.shape+", found shape="+o.shape+".")}}}}},n.prototype.call=function(e,r){return e},n.prototype.invokeCallHook=function(e,r){this._callHook!=null&&this._callHook(e,r)},n.prototype.setCallHook=function(e){this._callHook=e},n.prototype.clearCallHook=function(){this._callHook=null},n.prototype.apply=function(e,r){var i=this;r=r||{},this.assertNotDisposed();for(var o=zt(e),a=!0,s=0,u=o;s<u.length;s++)if(!(u[s]instanceof Pi)){a=!1;break}for(var l=!0,c=0,d=o;c<d.length;c++)if(d[c]instanceof Pi){l=!1;break}if(a===l)throw new Y("Arguments to apply() must be all SymbolicTensors or all Tensors");return tu(this.name,function(){if(!i.built){i.assertInputCompatibility(e);for(var f=[],p=0,h=zt(e);p<h.length;p++){var v=h[p];f.push(v.shape)}i.build(mr(f)),i.built=!0,i.initialWeights&&i.setWeights(i.initialWeights),i._refCount===null&&l&&(i._refCount=1)}if(i.assertInputCompatibility(e),l){for(var g=[],m=0,y=zt(C=i.call(e,r));m<y.length;m++){var b=y[m];o.indexOf(b)!==-1&&(b=b.clone()),g.push(b)}if(C=mr(g),i.activityRegularizer!=null)throw new Xe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return C}var w=nX(e),x=i.computeOutputShape(w),C=void 0,E=rX(e);if(i.warnOnIncompatibleInputShape(Array.isArray(e)?w[0]:w),C=x!=null&&x.length>0&&Array.isArray(x[0])?x.map(function(S,k){return new Pi(E,S,i,zt(e),r,i.name,k)}):new Pi(E,x,i,zt(e),r,i.name),i.addInboundNode(e,C,null,null,w,x,r),i._refCount++,i.activityRegularizer!=null)throw new Xe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return C})},n.prototype.warnOnIncompatibleInputShape=function(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(e)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var r=!1;this.batchInputShape.forEach(function(i,o){i!=null&&e[o]!=null&&e[o]!==i&&(r=!0)}),r&&console.warn("The shape of the input tensor ("+JSON.stringify(e)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(n.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Fs("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var e=[],r=0,i=this.inboundNodes;r<i.length;r++){var o=i[r],a=JSON.stringify(o.outputShapes);e.indexOf(a)===-1&&e.push(a)}if(e.length===1){var s=this.inboundNodes[0].outputShapes;return Array.isArray(s)&&Array.isArray(s[0])&&s.length===1?s[0]:s}throw new Fs("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),n.prototype.countParams=function(){if(!this.built)throw new lo("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return xv(this.weights)},n.prototype.build=function(e){this.built=!0},n.prototype.getWeights=function(e){return e===void 0&&(e=!1),Mw(e?this.trainableWeights:this.weights)},n.prototype.setWeights=function(e){var r=this;ee(function(){var i=r.weights;if(i.length!==e.length)throw new Y('You called setWeights(weights) on layer "'+r.name+'" with a weight list of length '+e.length+", but the layer was expecting "+i.length+" weights. Provided weights: "+e+"...");if(i.length!==0){for(var o=[],a=Mw(i),s=0;s<a.length;++s){var u=a[s],l=i[s],c=e[s];if(!Fe.arraysEqual(u.shape,c.shape))throw new Y("Layer weight shape "+u.shape+" not compatible with provided weight shape "+c.shape);o.push([l,c])}FC(o)}})},n.prototype.addWeight=function(e,r,i,o,a,s,u){if(this._addedWeightNames.indexOf(e)!==-1)throw new Y("Duplicate weight name "+e+" for layer "+this.name);this._addedWeightNames.push(e),i==null&&(i="float32"),this.fastWeightInitDuringBuild&&(o=Gt("zeros"));var l=o.apply(r,i),c=new v3(l,i,e,s,u);return l.dispose(),a!=null&&this.addLoss(function(){return a.apply(c.read())}),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c},n.prototype.setFastWeightInitDuringBuild=function(e){this.fastWeightInitDuringBuild=e},n.prototype.addLoss=function(e){var r;e==null||Array.isArray(e)&&e.length===0||(e=zt(e),this._losses!==void 0&&this._losses!==null&&(r=this.losses).push.apply(r,e))},n.prototype.computeOutputShape=function(e){return e},n.prototype.computeMask=function(e,r){var i=this;if(!this.supportsMasking){if(r!=null){if(!Array.isArray(r))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");r.forEach(function(o){if(o!=null)throw new TypeError("Layer "+i.name+" does not support masking, but was passed an inputMask.")})}return null}return r},n.prototype.addInboundNode=function(e,r,i,o,a,s,u){u===void 0&&(u=null);var l=zt(e);r=zt(r),i=zt(i),o=zt(o),a=wv(a),s=wv(s);for(var c=[],d=[],f=[],p=0,h=l;p<h.length;p++){var v=h[p];c.push(v.sourceLayer),d.push(v.nodeIndex),f.push(v.tensorIndex)}new sy({outboundLayer:this,inboundLayers:c,nodeIndices:d,tensorIndices:f,inputTensors:l,outputTensors:r,inputMasks:i,outputMasks:o,inputShapes:a,outputShapes:s},u);for(var g=0;g<r.length;g++)r[g].sourceLayer=this,r[g].nodeIndex=this.inboundNodes.length-1,r[g].tensorIndex=g},n.prototype.getConfig=function(){var e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e},n.prototype.disposeWeights=function(){return this.weights.forEach(function(e){return e.dispose()}),this.weights.length},n.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},n.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var e=0;return--this._refCount==0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}},n}(he.Serializable);function nX(t){for(var n=[],e=0,r=t=zt(t);e<r.length;e++){var i=r[e];n.push(i.shape)}return mr(n)}function rX(t){return"float32"}function g3(t,n,e){if((n==null||e!=null&&e>0)&&(n=t.sourceLayer,e=t.nodeIndex),n.inboundNodes.length===0)return[t];var r=n.inboundNodes[e];if(r.inboundLayers.length===0)return r.inputTensors;for(var i=[],o=0;o<r.inboundLayers.length;o++)for(var a=0,s=g3(r.inputTensors[o],r.inboundLayers[o],r.nodeIndices[o]);a<s.length;a++){var u=s[a];i.indexOf(u)===-1&&i.push(u)}return i}var Sk,Cp=function(t){function n(e){var r=t.call(this,{dtype:e.dtype,name:e.name!=null?e.name:ay("input").toString()})||this;if(e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new Y("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var i=e.batchInputShape;if(i==null){if(e.inputShape==null)throw new Y("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");i=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new Y("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var o=e.dtype||"float32";r.batchInputShape=i,r.dtype=o,r.inputSpec=[{shape:i}];var a=new Pi(r.dtype,r.batchInputShape,r,[],{},r.name);return a.nodeIndex=0,a.tensorIndex=0,new sy({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[i],outputShapes:[i]}),r}return ue(n,t),n.prototype.apply=function(e,r){throw new Y("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},n.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},n.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},n.className="InputLayer",n}(pt);function y3(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new Y("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var n=t.batchShape;t.shape!=null&&n==null&&(n=[null].concat(t.shape));var e=t.dtype;return e==null&&(e="float32"),new Cp({batchInputShape:n,name:t.name,dtype:e,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}function Ea(t){return Ue(this,void 0,void 0,function(){var n,e,r,i,o,a,s,u;return ze(this,function(l){switch(l.label){case 0:if(t==null)return[2];for(i in n=[],e=[],r=[],t)typeof(o=t[i])!="number"&&(a=o,n.push(a.data()),e.push(i),r.push(a));return n.length>0?[4,Promise.all(n)]:[3,2];case 1:for(s=l.sent(),u=0;u<s.length;++u)t[e[u]]=s[u][0];Ze(r),l.label=2;case 2:return[2]}})})}function b3(t){if(t!=null)for(var n in t){var e=t[n];typeof e!="number"&&e.dispose()}}he.registerClass(Cp),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(Sk||(Sk={}));var iX=125,uc=function(){function t(){this.validationData=null}return t.prototype.setParams=function(n){this.params=n},t.prototype.onEpochBegin=function(n,e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){return[2]})})},t.prototype.onEpochEnd=function(n,e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){return[2]})})},t.prototype.onBatchBegin=function(n,e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){return[2]})})},t.prototype.onBatchEnd=function(n,e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){return[2]})})},t.prototype.onTrainBegin=function(n){return Ue(this,void 0,void 0,function(){return ze(this,function(e){return[2]})})},t.prototype.onTrainEnd=function(n){return Ue(this,void 0,void 0,function(){return ze(this,function(e){return[2]})})},t.prototype.setModel=function(n){},t}(),w3=function(){function t(n,e){e===void 0&&(e=10),n==null&&(n=[]),this.callbacks=n,this.queueLength=e}return t.prototype.append=function(n){this.callbacks.push(n)},t.prototype.setParams=function(n){for(var e=0,r=this.callbacks;e<r.length;e++)r[e].setParams(n)},t.prototype.setModel=function(n){for(var e=0,r=this.callbacks;e<r.length;e++)r[e].setModel(n)},t.prototype.onEpochBegin=function(n,e){return Ue(this,void 0,void 0,function(){var r,i;return ze(this,function(o){switch(o.label){case 0:e==null&&(e={}),r=0,i=this.callbacks,o.label=1;case 1:return r<i.length?[4,i[r].onEpochBegin(n,e)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},t.prototype.onEpochEnd=function(n,e){return Ue(this,void 0,void 0,function(){var r,i;return ze(this,function(o){switch(o.label){case 0:e==null&&(e={}),r=0,i=this.callbacks,o.label=1;case 1:return r<i.length?[4,i[r].onEpochEnd(n,e)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},t.prototype.onBatchBegin=function(n,e){return Ue(this,void 0,void 0,function(){var r,i;return ze(this,function(o){switch(o.label){case 0:e==null&&(e={}),r=0,i=this.callbacks,o.label=1;case 1:return r<i.length?[4,i[r].onBatchBegin(n,e)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},t.prototype.onBatchEnd=function(n,e){return Ue(this,void 0,void 0,function(){var r,i;return ze(this,function(o){switch(o.label){case 0:e==null&&(e={}),r=0,i=this.callbacks,o.label=1;case 1:return r<i.length?[4,i[r].onBatchEnd(n,e)]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},t.prototype.onTrainBegin=function(n){return Ue(this,void 0,void 0,function(){var e,r;return ze(this,function(i){switch(i.label){case 0:n==null&&(n={}),e=0,r=this.callbacks,i.label=1;case 1:return e<r.length?[4,r[e].onTrainBegin(n)]:[3,4];case 2:i.sent(),i.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.onTrainEnd=function(n){return Ue(this,void 0,void 0,function(){var e,r;return ze(this,function(i){switch(i.label){case 0:n==null&&(n={}),e=0,r=this.callbacks,i.label=1;case 1:return e<r.length?[4,r[e].onTrainEnd(n)]:[3,4];case 2:i.sent(),i.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t}(),oX=function(t){function n(){return t.call(this)||this}return ue(n,t),n.prototype.onEpochBegin=function(e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){return this.seen=0,this.totals={},[2]})})},n.prototype.onBatchEnd=function(e,r){return Ue(this,void 0,void 0,function(){var i,o,a,s,u=this;return ze(this,function(l){for(s in r==null&&(r={}),i=r.size==null?0:r.size,this.seen+=i,o=function(c){var d=r[c];if(typeof d=="number")a.totals.hasOwnProperty(c)||(a.totals[c]=0),a.totals[c]=a.totals[c]+d*i;else{var f=void 0;c in a.totals?f=a.totals[c]:a.totals[c]=0;var p=ee(function(){return st(u.totals[c],We(d,i))});a.totals[c]=p,f!=null&&f.dispose()}},a=this,r)o(s);return[2]})})},n.prototype.onEpochEnd=function(e,r){return Ue(this,void 0,void 0,function(){var i,o,a,s,u,l=this;return ze(this,function(c){if(r!=null)for(i=function(d){if(o.totals[d]==null)return"continue";typeof o.totals[d]=="number"?r[d]=o.totals[d]/o.seen:ee(function(){var f=We(cr(1,l.seen),l.totals[d]);r[d]=f,l.totals[d].dispose(),wo(r[d])})},o=this,a=0,s=this.params.metrics;a<s.length;a++)u=s[a],i(u);return[2]})})},n}(uc),x3=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.onTrainBegin=function(e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){return this.epoch=[],this.history={},[2]})})},n.prototype.onEpochEnd=function(e,r){return Ue(this,void 0,void 0,function(){var i;return ze(this,function(o){for(i in r==null&&(r={}),this.epoch.push(e),r)this.history[i]==null&&(this.history[i]=[]),this.history[i].push(r[i]);return[2]})})},n.prototype.syncData=function(){return Ue(this,void 0,void 0,function(){var e,r,i,o,a,s,u,l,c;return ze(this,function(d){switch(d.label){case 0:for(o in e=[],r=[],i=[],this.history)for(a=this.history[o],s=0;s<a.length;++s)typeof a[s]!="number"&&(u=a[s],e.push(u.data()),r.push(o),i.push(s));return[4,Promise.all(e)];case 1:for(l=d.sent(),c=0;c<l.length;++c)this.history[r[c]][i[c]].dispose(),this.history[r[c]][i[c]]=l[c][0];return[2]}})})},n}(uc),S3=function(t){function n(e,r){var i=t.call(this)||this;if(i.currentEpoch=0,i.yieldEvery=r||"auto",i.yieldEvery==="auto"&&(i.yieldEvery=iX),i.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return Fe.isNumber(i.yieldEvery)&&(i.maybeWait=fK(i.maybeWait.bind(i),i.yieldEvery)),i.trainBegin=e.onTrainBegin,i.trainEnd=e.onTrainEnd,i.epochBegin=e.onEpochBegin,i.epochEnd=e.onEpochEnd,i.batchBegin=e.onBatchBegin,i.batchEnd=e.onBatchEnd,i.yield=e.onYield,i}return ue(n,t),n.prototype.maybeWait=function(e,r,i){return Ue(this,void 0,void 0,function(){var o;return ze(this,function(a){switch(a.label){case 0:return o=[],this.yield==null?[3,2]:[4,Ea(i)];case 1:a.sent(),o.push(this.yield(e,r,i)),a.label=2;case 2:return o.push(gm()),[4,Promise.all(o)];case 3:return a.sent(),[2]}})})},n.prototype.onEpochBegin=function(e,r){return Ue(this,void 0,void 0,function(){return ze(this,function(i){switch(i.label){case 0:return this.currentEpoch=e,this.epochBegin==null?[3,3]:[4,Ea(r)];case 1:return i.sent(),[4,this.epochBegin(e,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},n.prototype.onEpochEnd=function(e,r){return Ue(this,void 0,void 0,function(){var i;return ze(this,function(o){switch(o.label){case 0:return i=[],this.epochEnd==null?[3,2]:[4,Ea(r)];case 1:o.sent(),i.push(this.epochEnd(e,r)),o.label=2;case 2:return this.yieldEvery==="epoch"&&i.push(gm()),[4,Promise.all(i)];case 3:return o.sent(),[2]}})})},n.prototype.onBatchBegin=function(e,r){return Ue(this,void 0,void 0,function(){return ze(this,function(i){switch(i.label){case 0:return this.batchBegin==null?[3,3]:[4,Ea(r)];case 1:return i.sent(),[4,this.batchBegin(e,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},n.prototype.onBatchEnd=function(e,r){return Ue(this,void 0,void 0,function(){var i;return ze(this,function(o){switch(o.label){case 0:return i=[],this.batchEnd==null?[3,2]:[4,Ea(r)];case 1:o.sent(),i.push(this.batchEnd(e,r)),o.label=2;case 2:return this.yieldEvery==="batch"?i.push(gm()):Fe.isNumber(this.yieldEvery)&&i.push(this.maybeWait(this.currentEpoch,e,r)),[4,Promise.all(i)];case 3:return o.sent(),[2]}})})},n.prototype.onTrainBegin=function(e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){switch(r.label){case 0:return this.trainBegin==null?[3,3]:[4,Ea(e)];case 1:return r.sent(),[4,this.trainBegin(e)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},n.prototype.onTrainEnd=function(e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){switch(r.label){case 0:return this.trainEnd==null?[3,3]:[4,Ea(e)];case 1:return r.sent(),[4,this.trainEnd(e)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},n}(uc);function E3(t,n){return t==null&&(t={}),t instanceof uc?[t]:Array.isArray(t)&&t[0]instanceof uc?t:zt(t).map(function(e){return new S3(e,n)})}var C3=function(){function t(){}return t.registerCallbackConstructor=function(n,e){Fe.assert(n>=0&&Number.isInteger(n),function(){return"Verbosity level is expected to be an integer >= 0, but got "+n}),t.checkForDuplicate(e),t.constructors[n]==null&&(t.constructors[n]=[]),t.constructors[n].push(e)},t.checkForDuplicate=function(n){for(var e in t.constructors)t.constructors[+e].forEach(function(r){if(r===n)throw new Y("Duplicate callback constructor.")})},t.clear=function(){t.constructors={}},t.createCallbacks=function(n){var e=[];for(var r in t.constructors){var i=+r;n>=i&&e.push.apply(e,t.constructors[i])}return e.map(function(o){return new o})},t.constructors={},t}();function R3(t,n,e,r,i,o,a,s,u){var l=new x3,c=[new oX].concat(C3.createCallbacks(n));t!=null&&c.push.apply(c,t),c.push(l);var d=new w3(c);return d.setParams({epochs:e,initialEpoch:r,samples:i,steps:o,batchSize:a,verbose:n,doValidation:s,metrics:u}),{callbackList:d,history:l}}function ji(t,n,e){return n===void 0&&(n={}),e===void 0&&(e=!1),bp(t,he.SerializationMap.getMap().classNameMap,n,"layer",e)}function Sv(t,n){return ee(function(){t.dtype!=="float32"&&(t=t.asType("float32"));var e=Br(Ep(t),n,!0),r=Tc(e.shape,En()),i=cp(To(e,r));return cr(t,i)})}function Iu(t,n){return ee(function(){return gn(Ep(jn(n,t)),-1)})}function uy(t,n){return ee(function(){return gn(ss(jn(n,t)),-1)})}function Mc(t,n){return ee(function(){var e=jn(t,n),r=br(ss(t),En(),Number.MAX_VALUE),i=ss(cr(e,r));return We(100,gn(i,-1))})}function aX(t,n){return ee(function(){var e=br(n,En(),Number.MAX_VALUE),r=ra(st(1,e)),i=br(t,En(),Number.MAX_VALUE),o=ra(st(1,i));return gn(Ep(jn(r,o)),-1)})}function sX(t,n){return ee(function(){var e=To(0,jn(1,We(t,n)));return gn(Ep(e),-1)})}function uX(t,n){return ee(function(){var e=To(0,jn(1,We(t,n)));return gn(e,-1)})}function lX(t,n){return ee(function(){var e=Br(We(t,n),-1),r=us(We(jn(1,t),n),-1);return To(0,st(1,jn(r,e)))})}function cX(t,n){return ee(function(){var e=Math.log(2),r=jn(n,t),i=jn(st(r,lp(We(-2,r))),e);return gn(i,-1)})}function $f(t,n,e){return e===void 0&&(e=!1),ee(function(){if(e)n=Ru(n);else{var r=Br(n,n.shape.length-1,!0);n=cr(n,r)}return n=br(n,En(),1-En()),Tu(Br(We(t.toFloat(),ra(n)),n.shape.length-1))})}function Ev(t,n){return ee(function(){var e=_g(TK(t)).toInt(),r=(n=br(n,En(),1-En())).shape;return $f(Zl(e,r[r.length-1]).reshape(r),n,!1)})}function dX(t,n){if(!Fe.arraysEqual(t.shape,n.shape))throw new Y("logits and labels must have the same shape, but got shapes "+JSON.stringify(t.shape)+" and "+JSON.stringify(n.shape));return ee(function(){var e=n.relu(),r=n.abs().neg();return e.sub(n.mul(t)).add(r.exp().log1p())})}function ly(t,n){return ee(function(){var e;return e=br(n,En(),1-En()),e=ra(cr(e,jn(1,e))),gn(dX(t,e),-1)})}function fX(t,n){return ee(function(){var e=br(t,En(),1),r=br(n,En(),1);return Br(We(t,ra(cr(e,r))),-1)})}function pX(t,n){return ee(function(){var e=ra(st(En(),n));return gn(jn(n,We(t,e)),-1)})}function zC(t,n){return ee(function(){var e=Sv(t,-1),r=Sv(n,-1),i=We(e,r);return Tu(Br(i,-1))})}var Cv={meanSquaredError:Iu,meanAbsoluteError:uy,meanAbsolutePercentageError:Mc,meanSquaredLogarithmicError:aX,squaredHinge:sX,hinge:uX,categoricalHinge:lX,logcosh:cX,categoricalCrossentropy:$f,sparseCategoricalCrossentropy:Ev,binaryCrossentropy:ly,kullbackLeiblerDivergence:fX,poisson:pX,cosineProximity:zC};function h1(t){if(typeof t=="string"){if(t in Cv)return Cv[t];var n="Unknown loss "+t;throw t.toLowerCase().includes("softmaxcrossentropy")&&(n="Unknown loss "+t+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Y(n)}return t}function BC(t,n){return ee(function(){var e=We(.5,ti(n)),r=xp(Ic(n,e),t.dtype);return gn(Nu(t,r),-1)})}function jC(t,n){return ee(function(){return xp(Nu(Vf(t,-1),Vf(n,-1)),"float32")})}function T3(t,n){return ee(function(){return la(t.equal(1),n.equal(1)).sum().cast("float32")})}function hX(t,n){return ee(function(){return la(t.equal(1),n.equal(0)).sum().cast("float32")})}function mX(t,n){return ee(function(){return la(t.equal(0),n.equal(1)).sum().cast("float32")})}function N3(t,n){return ee(function(){var e=T3(t,n),r=mX(t,n),i=e.add(r);return ia(Ic(i,0),e.div(i),0).cast("float32")})}function vX(t,n){return ee(function(){var e=T3(t,n),r=hX(t,n),i=e.add(r);return ia(Ic(i,0),e.div(i),0).cast("float32")})}function k3(t,n){return ly(t,n)}function I3(t,n){return t.rank===n.rank&&(t=t.squeeze([t.rank-1])),(n=n.argMax(-1)).dtype!==t.dtype&&(n=n.asType(t.dtype)),Nu(t,n).asType("float32")}var gX=Iu,yX=Iu,bX=uy,wX=uy,xX=Mc,SX=Mc,VC=$f,EX=zC,_3=Ev,Rv={binaryAccuracy:BC,categoricalAccuracy:jC,precision:N3,categoricalCrossentropy:VC,sparseCategoricalCrossentropy:_3,mse:gX,MSE:yX,mae:bX,MAE:wX,mape:xX,MAPE:SX,cosine:EX};function CX(t){if(typeof t=="string"&&t in Rv)return Rv[t];if(typeof t!="string"&&t!=null)return t;throw new Y("Unknown metric "+t)}function Nh(t){if(oo(t!==null,"Unknown LossOrMetricFn "+t),typeof t=="string")return t;for(var n=void 0,e=0,r=Object.keys(Cv);e<r.length;e++){var i=r[e];if(Cv[i]===t){n=i;break}}if(n!==void 0)return n;for(var o=0,a=Object.keys(Rv);o<a.length;o++)if(i=a[o],Rv[i]===t){n=i;break}return n!==void 0?n:t.name}function RX(t){var n={Adagrad:function(){return Ls.adagrad(.01)},Adadelta:function(){return Ls.adadelta(1,.95,En())},Adam:function(){return Ls.adam(.001,.9,.999,En())},Adamax:function(){return Ls.adamax(.002,.9,.999,En(),0)},RMSProp:function(){return Ls.rmsprop(.001,.9,0,En())},SGD:function(){return Ls.sgd(.01)}};if(n.adagrad=n.Adagrad,n.adadelta=n.Adadelta,n.adam=n.Adam,n.adamax=n.Adamax,n.rmsprop=n.RMSProp,n.sgd=n.SGD,t in n)return n[t]();throw new Y("Unknown Optimizer "+t)}var Ek=1048576;function Ck(t,n,e){if(e===void 0&&(e=!1),t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!Pw(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){var r=JSON.stringify(t);r.length>Ek&&console.warn('User-defined metadata of model "'+n+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+Ek+".")}}function Pw(t){if(t===null)return!0;if(typeof t=="object"){if(Object.getPrototypeOf(t)===Object.prototype){for(var n=0,e=Object.keys(t);n<e.length;n++){var r=e[n];if(typeof r!="string"||!Pw(t[r]))return!1}return!0}if(Array.isArray(t)){for(var i=0,o=t;i<o.length;i++)if(!Pw(o[i]))return!1;return!0}return!1}var a=typeof t;return a==="string"||a==="number"||a==="boolean"}function TX(t,n,e,r){r===void 0&&(r=console.log);var i,o=kX(t),a=["Layer (type)","Output shape","Param #"];if(o?(n=n||65,e=e||[.45,.85,1]):(n=n||98,e=e||[.33,.55,.67,1]),e[e.length-1]<=1&&(e=e.map(function(f){return Math.floor(n*f)})),!o)for(var s in a.push("Receives inputs"),i=[],t.nodesByDepth)i.push.apply(i,t.nodesByDepth[s]);r("_".repeat(n)),Tv(a,e,r),r("=".repeat(n));for(var u=t.layers,l=0;l<u.length;++l)o?IX(u[l],e,r):_X(u[l],e,i,r),r((l===u.length-1?"=":"_").repeat(n));t.checkTrainableWeightsConsistency();var c=NX(t),d=xv(t.nonTrainableWeights);r("Total params: "+(c+d)),r("Trainable params: "+c),r("Non-trainable params: "+d),r("_".repeat(n))}function NX(t){return t.collectedTrainableWeights!=null?xv(t.collectedTrainableWeights):xv(t.trainableWeights)}function kX(t){var n=!0,e=[],r=[];for(var i in t.nodesByDepth)e.push(t.nodesByDepth[i]);for(var o=0,a=e;o<a.length;o++){var s=a[o];if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){n=!1;break}r.push.apply(r,s)}if(n)for(var u=0,l=t.layers;u<l.length;u++){for(var c=!1,d=0,f=l[u].inboundNodes;d<f.length;d++){var p=f[d];if(r.indexOf(p)!==-1){if(c){n=!1;break}c=!0}}if(!n)break}return n}function Tv(t,n,e){e===void 0&&(e=console.log);for(var r="",i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=t[i]).slice(0,n[i]),r+=" ".repeat(n[i]-r.length);e(r)}function IX(t,n,e){var r;try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}Tv([t.name+" ("+t.getClassName()+")",r,t.countParams().toString()],n,e)}function _X(t,n,e,r){var i;try{i=JSON.stringify(t.outputShape)}catch{i="multiple"}for(var o=[],a=0,s=t.inboundNodes;a<s.length;a++){var u=s[a];if(!(e!=null&&e.length>0&&e.indexOf(u)===-1))for(var l=0;l<u.inboundLayers.length;++l){var c=u.inboundLayers[l].name,d=u.nodeIndices[l],f=u.tensorIndices[l];o.push(c+"["+d+"]["+f+"]")}}var p=t.name,h=t.getClassName(),v=o.length===0?"":o[0];for(Tv([p+" ("+h+")",i,t.countParams().toString(),v],n,r),l=1;l<o.length;++l)Tv(["","","",o[l]],n,r)}function A3(t,n,e){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&n===0&&typeof e=="string"}function Uf(t,n){if(t===null)return null;if(typeof t=="string")return Bs(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){for(var e=[],r=t.length,i=0;i<r;++i){var o=t[i];A3(n,i,o)?e.push(o):e.push(Uf(o,n))}return e}for(var a={},s=0,u=Object.keys(t);s<u.length;s++){var l=u[s],c=t[l];if(l==="name"&&typeof c=="string")a[l]=c;else{var d=Bs(l);a[d]=Uf(c,d)}}return a}function Lw(t,n){if(t==null)return null;if(typeof t=="string")return Bo(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){for(var e=[],r=t.length,i=0;i<r;++i){var o=t[i];A3(n,i,o)?e.push(o):e.push(Lw(o,n))}return e}for(var a={},s=0,u=Object.keys(t);s<u.length;s++){var l=u[s],c=t[l],d=Bo(l);a[d]=l!=="name"&&l!=="className"||typeof c!="string"?Lw(c,l):c}return a}var cy="1.3.1";function AX(t,n){if(t.dtype==null||t.dtype===n.dtype)return n;try{return Eg(n,t.dtype)}catch{throw new Y("The dtype of the feed ("+n.dtype+") can not be cast to the dtype of the key '"+t.name+"' ("+t.dtype+").")}}var bl=function(){function t(n){if(this.id2Value={},this.id2Mask={},this.name2Id={},n instanceof t)for(var e in n.id2Value)this.id2Value[e]=n.id2Value[e],e in n.id2Mask&&(this.id2Mask[e]=n.id2Mask[e]);else{if(n==null)return;for(var r=0,i=n;r<i.length;r++){var o=i[r];this.add(o.key,o.value)}}}return t.prototype.add=function(n,e,r){if(this.id2Value[n.id]!=null)throw new Y("Duplicate key: name="+n.name+", id="+n.id);return this.id2Value[n.id]=AX(n,e),this.name2Id[n.name]=n.id,r!=null&&(this.id2Mask[n.id]=r),this},t.prototype.addFeed=function(n){this.add(n.key,n.value)},t.prototype.hasKey=function(n){return this.id2Value[n.id]!=null},t.prototype.names=function(){return Object.keys(this.name2Id)},t.prototype.getValue=function(n){if(n instanceof Pi){if(this.id2Value[n.id]==null)throw new Y("Nonexistent key: "+n.name);return this.id2Value[n.id]}var e=this.name2Id[n];if(e==null)throw new Y("Feed dict has no SymbolicTensor name: "+n);return this.id2Value[e]},t.prototype.getMask=function(n){if(n instanceof Pi){if(this.id2Value[n.id]==null)throw new Y("Nonexistent key: "+n.name);return this.id2Mask[n.id]}var e=this.name2Id[n];if(e==null)throw new Y("Feed dict has no SymbolicTensor name: "+n);return this.id2Mask[e]},t.prototype.disposeMasks=function(){this.id2Mask!=null&&Ze(this.id2Mask)},t}(),m1={},Rk={};function Fd(t,n,e,r){for(var i=e!=null&&e.training,o=Array.isArray(t),a=o?t:[t],s=a.map(function(H){return H.name}),u=[],l=n.names(),c=0,d=s;c<d.length;c++){var f=d[c];l.indexOf(f)!==-1?u.push(n.getValue(f)):u.push(null)}r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var p,h,v=s.join(",")+"|"+n.names().join(",");if(m1[v]==null){var g=OX(a,n);p=g.sorted,h=g.recipientCounts,m1[v]=p,Rk[v]=h}p=m1[v],h={},i||Object.assign(h,Rk[v]);for(var m=new bl(n),y=0;y<p.length;++y){if(r!=null){var b=fv().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var w=p[y],x=w.sourceLayer;if(!(x instanceof Cp)){for(var C=[],E=[],S=[],k=!1,N=0,M=w.inputs;N<M.length;N++){var D=M[N],T=m.getValue(D),O=m.getMask(D);C.push(T),E.push(O),O!=null&&(k=!0),i||(h[D.name]--,h[D.name]!==0||n.hasKey(D)||s.indexOf(D.name)!==-1||T.isDisposed||D.sourceLayer.stateful===!0||S.push(T))}k&&((e=e||{}).mask=E[0]);var P=zt(x.apply(C,e)),A=null;x.supportsMasking&&(A=x.computeMask(C,E));for(var I=MX(w),_=Array.isArray(I)?I:[I],F=0;F<_.length;++F){m.hasKey(_[F])||m.add(_[F],P[F],Array.isArray(A)?A[0]:A);var L=s.indexOf(_[F].name);L!==-1&&(u[L]=P[F])}i||Ze(S)}}return m.disposeMasks(),o?u:u[0]}function OX(t,n){Fe.assert(t!=null&&t.length>0,function(){return"Expected at least one fetch, got none"});var e=[],r={};if(t.length===1){var i=Tk(t[0],n);e=i.sorted,r=i.recipientMap}else for(var o=new Set,a=0,s=t;a<s.length;a++){for(var u=Tk(s[a],n),l=u.sorted,c=u.recipientMap,d=0,f=l;d<f.length;d++){var p=f[d];o.has(p.name)||(e.push(p),o.add(p.name))}var h=function(g){r[g]==null&&(r[g]=new Set),c[g].forEach(function(m){return r[g].add(m)})};for(var v in c)h(v)}return{sorted:e,recipientCounts:DX(r)}}function DX(t){var n={};for(var e in t)n[e]=t[e].size;return n}function Tk(t,n){for(var e=new Set,r=[],i={},o=0,a=n.names();o<a.length;o++){var s=a[o];e.add(s)}var u=[],l=[];for(u.push(t);u.length>0;){var c=u[u.length-1];if(e.has(c.name))u.pop();else{var d=l[l.length-1]===u.length-1;if(c.inputs.length===0||d)u.pop(),r.push(c),e.add(c.name),d&&l.pop();else{l.push(u.length-1);for(var f=0,p=c.inputs;f<p.length;f++){var h=p[f];i[h.name]==null&&(i[h.name]=new Set),i[h.name].add(c.name),e.has(h.name)||u.push(h)}}}}return{sorted:r,recipientMap:i}}function MX(t){var n;if(t.sourceLayer.inboundNodes.length===1)n=t.sourceLayer.output;else{for(var e=null,r=0;r<t.sourceLayer.inboundNodes.length;++r)for(var i=0,o=t.sourceLayer.inboundNodes[r].outputTensors;i<o.length;i++)if(o[i].id===t.id){e=r;break}n=t.sourceLayer.getOutputAt(e)}return n}var PX=function(t){function n(e){var r=t.call(this,{})||this;if(r.containerNodes=new Set,r.name=e.name,r.name==null){var i=r.getClassName().toLowerCase();r.name=ay(i)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],es(r.inputs).length!==r.inputs.length)throw new Y("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map(function(Te){return Te.name}));es(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map(function(Te){return Te.name})),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var o=0,a=r.outputs;o<a.length;o++){var s=(N=a[o]).sourceLayer,u=N.nodeIndex,l=N.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,d=r.inputs;c<d.length;c++)s=(N=d[c]).sourceLayer,u=N.nodeIndex,l=N.tensorIndex,oo(u===0,"input layer has >1 nodes"),oo(l===0,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var f=0;f<r.inputLayers.length;f++){if(!((s=r.inputLayers[f])instanceof Cp))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+e.inputs+". Input "+f+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var p=0,h=r.outputLayers;p<h.length;p++)s=h[p],r.outputNames.push(s.name);r.internalInputShapes=r.inputs.map(function(Te){return Te.shape}),r.internalOutputShapes=r.outputs.map(function(Te){return Te.shape});for(var v={},g={},m={},y={},b={},w=[],x=function(Te,nt,Le,rt,ot,Ge){rt!=null&&ot!=null&&Ge!=null||(rt=Te.sourceLayer,ot=Te.nodeIndex,Ge=Te.tensorIndex);var Ct=rt.inboundNodes[ot];if(Le.indexOf(Ct)!==-1)throw new lo("The tensor "+Te.name+' at layer "'+rt.name+'" is part of a cycle.');if(nt.indexOf(Ct)===-1){r.containerNodes.add(n.nodeKey(rt,ot)),rt.id in b||(b[rt.id]=Object.keys(b).length),Le.indexOf(Ct)===-1&&Le.push(Ct);for(var _o=Ct.inboundLayers.length,ui=0;ui<_o;ui++){var ju=Ct.inputTensors[ui],qc=Ct.inboundLayers[ui],Kc=Ct.nodeIndices[ui],Q=Ct.tensorIndices[ui];x(ju,nt,Le,qc,Kc,Q)}for(nt.push(Ct);Le.indexOf(Ct)>=0;)Le.splice(Le.indexOf(Ct),1);w.push(Ct)}},C=[],E=[],S=0,k=r.outputs;S<k.length;S++){var N=k[S];x(N,C,E)}for(var M=0,D=w.slice().reverse();M<D.length;M++){g[(Z=D[M]).id]=Z,Z.id in v||(v[Z.id]=0);var T=v[Z.id],O=m[Z.outboundLayer.id]==null?0:m[Z.outboundLayer.id];for(T=Math.max(T,O),m[Z.outboundLayer.id]=T,y[Z.outboundLayer.id]=Z.outboundLayer,v[Z.id]=T,f=0;f<Z.inboundLayers.length;f++){var P=Z.inboundLayers[f],A=(u=Z.nodeIndices[f],P.inboundNodes[u]),I=v[A.id]==null?0:v[A.id];v[A.id]=Math.max(T+1,I),g[A.id]=A}}var _={};for(var F in v)(T=v[F])in _||(_[T]=[]),_[T].push(g[F]);var L={};for(var H in m)(T=m[H])in L||(L[T]=[]),L[T].push(y[H]);var B=Object.keys(L).map(function(Te){return parseInt(Te,10)}).sort(Ch);r.layers=[];for(var q=0,G=B;q<G.length;q++){var re=L[T=G[q]];re.sort(function(Te,nt){var Le=b[Te.id],rt=b[nt.id];return Le<rt?-1:Le>rt?1:0});for(var j=0,ae=re;j<ae.length;j++)(s=ae[j])instanceof n&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=L,B=Object.keys(_).map(function(Te){return parseInt(Te,10)}).sort(Ch);for(var ne=r.inputs.slice(),le=[],xe=0,se=B;xe<se.length;xe++)for(var we=0,de=_[T=se[xe]];we<de.length;we++){var Z;if((s=(Z=de[we]).outboundLayer)!=null){for(var ge=0,be=Z.inputTensors;ge<be.length;ge++)if(N=be[ge],ne.indexOf(N)===-1)throw new lo("Graph disconnected: cannot obtain value for tensor "+N+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+le);for(var fe=0,On=Z.outputTensors;fe<On.length;fe++)N=On[fe],ne.push(N);le.push(s.name)}}r.nodesByDepth=_;for(var pn=r.layers.map(function(Te){return Te.name}),Me=function(Te){var nt=pn.filter(function(Le){return Le===Te}).length;if(nt!==1)throw new lo('The name "'+Te+'" is used '+nt+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(pn))},tt=0,wt=pn;tt<wt.length;tt++)Me(wt[tt]);return r.outboundNodes=[],r.inboundNodes=[],new sy({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map(function(Te){return null}),outputMasks:r.outputs.map(function(Te){return null}),inputShapes:r.inputs.map(function(Te){return Te.shape}),outputShapes:r.outputs.map(function(Te){return Te.shape})}),r.built=!0,r._refCount=1,r}return ue(n,t),n.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},n.prototype.dispose=function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var r=0,i=this.layers;r<i.length;r++){var o=i[r];e.numDisposedVariables+=o.dispose().numDisposedVariables}for(var a=0,s=this.internalContainerRefs;a<s.length;a++){var u=s[a];e.numDisposedVariables+=u.dispose().numDisposedVariables}}return e.refCountAfterDispose=this._refCount,e},Object.defineProperty(n.prototype,"trainable",{get:function(){return this.trainable_},set:function(e){this.layers.forEach(function(r){r._trainableWeights.forEach(function(i){return i.trainable=e})}),this.trainable_=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new Y("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var e=[],r=0,i=this.layers;r<i.length;r++){var o=i[r];e=e.concat(o.trainableWeights)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nonTrainableWeights",{get:function(){for(var e=[],r=0,i=this.layers;r<i.length;r++){var o=i[r];e.push.apply(e,o.nonTrainableWeights)}if(!this.trainable){for(var a=[],s=0,u=this.layers;s<u.length;s++)o=u[s],a.push.apply(a,o.trainableWeights);return a.concat(e)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),n.prototype.loadWeights=function(e,r){r===void 0&&(r=!0);for(var i={},o=0,a=0,s=this.layers;a<s.length;a++)for(var u=0,l=s[a].weights;u<l.length;u++){var c=l[u];if(i[c.originalName]!=null)throw new Y("Duplicate weight name: "+c.originalName);i[c.originalName]=c,o++}var d=[];for(var f in e){if(i[f]!=null)d.push([i[f],e[f]]);else if(r)throw new Y("Provided weight data has no target variable: "+f);delete i[f]}if(r){var p=[];for(var h in i)p.push(h);if(p.length>0)throw new Y(p.length+" of "+o+" weights are not set: "+p)}FC(d)},n.prototype.updatedConfig=function(){var e=this.getConfig(),r={};return r.className=this.getClassName(),r.config=e,r.kerasVersion="tfjs-layers "+cy,r.backend="TensorFlow.js",r},n.prototype.toJSON=function(e,r){r===void 0&&(r=!0);var i=Lw(this.updatedConfig());return r?JSON.stringify(i):i},n.prototype.call=function(e,r){var i=this;return ee(function(){e=zt(e);for(var o=new bl,a=0;a<i.inputs.length;++a)o.add(i.inputs[a],e[a]);return Fd(i.outputs,o,r)})},n.prototype.computeMask=function(e,r){var i=this;return ee(function(){var o;return e=zt(e),o=r==null?pu(null,e.length):zt(r),i.runInternalGraph(e,o)[1]})},n.prototype.computeOutputShape=function(e){var r=wv(e);if(r.length!==this.inputLayers.length)throw new Y("Invalid inputShape argument "+e+": model has "+this.inputLayers.length+" tensor inputs.");for(var i={},o=0;o<r.length;o++){var a=this.inputLayers[o],s=r[o];i[k=a.name+"_0_0"]=s}var u=Object.keys(this.nodesByDepth).map(function(M){return parseInt(M,10)}).sort(Ch);if(u.length>1)for(var l=0,c=u;l<c.length;l++)for(var d=c[l],f=0,p=this.nodesByDepth[d];f<p.length;f++){var h=p[f];if(a=h.outboundLayer,this.inputLayers.map(function(M){return M.id}).indexOf(a.id)===-1){for(var v=[],g=0;g<h.inboundLayers.length;g++){var m=h.inboundLayers[g],y=h.nodeIndices[g],b=h.tensorIndices[g],w=i[k=m.name+"_"+y+"_"+b];v.push(w)}var x=wv(a.computeOutputShape(mr(v))),C=a.inboundNodes.indexOf(h);for(g=0;g<x.length;g++)i[k=a.name+"_"+C+"_"+g]=x[g]}}var E=[],S=[];for(o=0;o<this.outputLayers.length;o++){a=this.outputLayers[o],C=this.outputLayersNodeIndices[o],b=this.outputLayersTensorIndices[o];var k=a.name+"_"+C+"_"+b;S.push(k)}for(o=0;o<S.length;o++){var N=S[o];oo(N in i),E.push(i[N])}return mr(E)},n.prototype.runInternalGraph=function(e,r){r==null&&(r=pu(null,e.length));for(var i={},o=0;o<this.inputs.length;++o){var a=this.inputs[o],s=e[o],u=r[o];i[a.id]=[s,u]}for(var l=0,c=Object.keys(this.nodesByDepth).map(function(L){return parseInt(L,10)}).sort(Ch);l<c.length;l++)for(var d=c[l],f=0,p=this.nodesByDepth[d];f<p.length;f++){for(var h=p[f],v=h.outboundLayer,g=h.inputTensors,m=h.outputTensors,y=new Array,b=0,w=g;b<w.length;b++)(a=w[b]).id in i&&y.push(i[a.id]);if(y.length===g.length){var x={},C=void 0,E=void 0,S=void 0,k=void 0;if(h.callArgs!=null&&(x=h.callArgs),y.length===1){var N=y[0],M=N[0],D=N[1];x.mask==null&&(x.mask=D),S=zt(v.call(M,x)),k=zt(v.computeMask(M,D)),C=[M],E=[D]}else C=y.map(function(L){return L[0]}),E=y.map(function(L){return L[1]}),x.mask==null&&(x.mask=E),S=zt(v.call(C,x)),k=zt(v.computeMask(C,E));if(v.activityRegularizer)throw new Xe("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(o=0;o<m.length;++o)a=m[o],s=S[o],u=k[o],i[a.id]=[s,u]}}for(var T=[],O=[],P=[],A=0,I=this.outputs;A<I.length;A++){oo((a=I[A]).id in i,"Could not compute output "+a.name+" : "+a.id);var _=i[a.id],F=_[0];u=_[1],P.push(F.shape),T.push(F),O.push(u)}return[T,O,P]},n.prototype.buildNodeConversionMap=function(e){for(var r,i={},o=0,a=this.layers;o<a.length;o++){var s=a[o];r=s instanceof n?1:0;for(var u=0;u<s.inboundNodes.length;u++){var l=n.nodeKey(s,u);this.containerNodes.has(l)&&(i[l]=r,r+=1)}}return i},n.prototype.getLayer=function(e,r){if(r!=null){if(this.layers.length<=r)throw new Y("Was asked to retrieve layer at index "+r+", but model only has "+this.layers.length+" layer(s).");return this.layers[r]}if(e==null)throw new Y("Provide either a layer name or layer index");for(var i=0,o=this.layers;i<o.length;i++){var a=o[i];if(a.name===e)return a}throw new Y("No such layer: "+e)},n.prototype.calculateLosses=function(){var e=this;return ee(function(){for(var r=[],i=0,o=e.layers;i<o.length;i++)for(var a=o[i],s=0;s<a.inboundNodes.length;++s){var u=n.nodeKey(a,s);e.containerNodes.has(u)&&r.push.apply(r,a.calculateLosses())}return r})},n.prototype.getConfig=function(){for(var e={name:this.name},r=this.buildNodeConversionMap(this.layers),i=[],o=0,a=this.layers;o<a.length;o++){for(var s=(x=a[o]).getClassName(),u=x.getConfig(),l=[],c=0;c<x.inboundNodes.length;c++){var d=x.inboundNodes[c],f=n.nodeKey(x,c),p={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn("Layer "+x.name+" was passed non-serializable keyword arguments: "+d.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),p={}}if(d.inboundLayers.length>0){for(var h=[],v=0;v<d.inboundLayers.length;v++){var g=d.inboundLayers[v],m=d.nodeIndices[v],y=d.tensorIndices[v];(E=r[n.nodeKey(g,m)])==null&&(E=0),h.push([g.name,E,y,p])}l.push(h)}}}var b={};b.name=x.name,b.className=s,b.config=u,b.inboundNodes=l,i.push(b)}e.layers=i;var w=[];for(v=0;v<this.inputLayers.length;v++){var x=this.inputLayers[v];m=this.inputLayersNodeIndices[v],f=n.nodeKey(x,m),this.containerNodes.has(f)&&((E=r[f])!==null&&E!==void 0||(E=0),y=this.inputLayersTensorIndices[v],w.push([x.name,E,y]))}e.inputLayers=w;var C=[];for(v=0;v<this.outputLayers.length;v++)if(x=this.outputLayers[v],m=this.outputLayersNodeIndices[v],f=n.nodeKey(x,m),this.containerNodes.has(f)){var E;(E=r[f])!==null&&E!==void 0||(E=0),y=this.outputLayersTensorIndices[v],C.push([x.name,E,y])}return e.outputLayers=C,e},n.fromConfig=function(e,r,i,o){o===void 0&&(o=!1);var a={},s={};function u(A,I){A.name in s?s[A.name].push(I):s[A.name]=[I]}function l(A,I){for(var _,F=[],L=0,H=I;L<H.length;L++){var B=H[L],q=B[0],G=B[1],re=B[2];if(_=B[3]==null?{}:B[3],!(q in a))return void u(A,I);var j=a[q];if(j.inboundNodes.length<=G)return void u(A,I);var ae=j.inboundNodes[G];F.push(ae.outputTensors[re])}F.length>0&&A.apply(mr(F),_)}function c(A){var I=A.name,_=ji(A,r.customObjects!=null?r.customObjects:{});_.setFastWeightInitDuringBuild(o),a[I]=_,A.inboundNodes.forEach(function(F){if(!(F instanceof Array))throw new Y("Corrupted configuration, expected array for nodeData: "+F);u(_,F)})}for(var d=r.name,f=r.layers,p=0,h=f;p<h.length;p++)c(m=h[p]);for(;!dK(s);)for(var v=0,g=f;v<g.length;v++){var m=g[v];if((P=a[m.name]).name in s){var y=s[P.name];delete s[P.name];for(var b=0,w=y;b<w.length;b++)l(P,w[b])}}for(var x=[],C=[],E=0,S=r.inputLayers;E<S.length;E++){var k=(m=S[E])[0],N=m[1],M=m[2];oo(k in a);var D=(P=a[k]).inboundNodes[N].outputTensors;x.push(D[M])}for(var T=0,O=r.outputLayers;T<O.length;T++){k=(m=O[T])[0],N=m[1],M=m[2],oo(k in a);var P;D=(P=a[k]).inboundNodes[N].outputTensors,C.push(D[M])}return new e({inputs:x,outputs:C,name:d})},Object.defineProperty(n.prototype,"stateful",{get:function(){if(this._stateful)throw new Y("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var e=0,r=this.layers;e<r.length;e++)if(r[e].stateful)return!0;return!1},enumerable:!0,configurable:!0}),n.prototype.resetStates=function(){var e=this;ee(function(){e.layers.forEach(function(r){r.stateful&&r.resetStates()})})},n}(pt);function LX(t,n,e){var r=n.length;if(t==null||Array.isArray(t)&&t.length===0)return n.map(function(o){return null});if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&n[0]in t?[t[n[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided "+e+" is an array of "+t.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return t}if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){var i=[];return n.forEach(function(o){o in t?i.push(t[o]):i.push(null)}),i}throw new Error("The model has multiple ("+r+") outputs, so "+e+" must be either an array with "+r+" elements or an object with "+n+" keys. Provided "+e+" not understood: "+JSON.stringify(t))}function O3(t,n){return LX(t,n,"classWeight")}function D3(t,n,e,r){return Ue(this,void 0,void 0,function(){var i,o,a,s,u;return ze(this,function(l){switch(l.label){case 0:if(n!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");return e==null?[3,2]:(i=ee(function(){if(t.shape.length===1)return t.clone();if(t.shape.length===2){if(t.shape[1]>1)return t.argMax(1);if(t.shape[1]===1)return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+t.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+t.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),s=(a=Array).from,[4,i.data()]);case 1:return o=s.apply(a,[l.sent()]),Ze(i),u=[],o.forEach(function(c){if(e[c]==null)throw new Error("classWeight must contain all classes in the training data. The class "+c+" exists in the data but not in classWeight");u.push(e[c])}),[2,zr(u,"float32")];case 2:return[2,null]}})})}function FX(t,n){return We(t,n)}var zX=32;function M3(t,n){var e,r,i=n;e=i.xs,r=i.ys,Fe.assert(e!=null&&r!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+n});var o=Nk("input",t.inputNames,e),a=Nk("output",t.outputNames,r),s=o[0].shape[0];Fe.assert(o.length===t.inputs.length,function(){return"LayersModel has "+t.inputs.length+" inputs, but the dataset provides "+o.length+" inputs.  (Expected input keys: "+JSON.stringify(t.inputNames)+")"}),Fe.assert(a.length===t.outputs.length,function(){return"LayersModel has "+t.outputs.length+" outputs, but the dataset provides "+a.length+" outputs.  (Expected output keys: "+JSON.stringify(t.outputNames)+")"});var u=function(f){Fe.assert(o[f].shape[0]===s,function(){return"Batch size mismatch: input "+t.inputNames[f]+" has "+o[f].shape[0]+"; expected  "+s+" based on input "+t.inputNames[0]+"."})};for(var l in o)u(l);var c=function(f){Fe.assert(a[f].shape[0]===s,function(){return"Batch size mismatch: output "+t.outputNames[f]+" has "+a[f].shape[0]+"; expected  "+s+" based on input "+t.inputNames[0]+"."})};for(var d in a)c(d);return{xs:o,ys:a}}function Nk(t,n,e){if(e instanceof At)return[e];if(Array.isArray(e))return Fe.assert(e.length===n.length,function(){return"Received an array of "+e.length+" Tensors, but expected "+n.length+" to match the "+t+" keys "+n+"."}),e;for(var r=[],i=0,o=n;i<o.length;i++){var a=o[i];if(e[a]==null)throw new Y("The feature data generated by the dataset lacks the required "+t+" key '"+a+"'.");r.push(e[a])}return r}function BX(t){if(t.length===3)throw new Xe("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}function jX(t,n,e){return Ue(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,C,E,S,k,N,M,D,T,O,P,A,I,_,F,L;return ze(this,function(H){switch(H.label){case 0:if(r=e.batchesPerEpoch!=null,Fe.assert(t.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),Fe.assert(e!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),Fe.assert(e.epochs!=null&&e.epochs>0&&Number.isInteger(e.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+e.epochs}),Fe.assert(!r||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+e.batchesPerEpoch}),Fe.assert(e.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,H.label=1;case 1:return H.trys.push([1,,26,27]),i=e.validationData!=null,o=void 0,a=void 0,i&&(kk(e.validationData)?Fe.assert(e.validationBatches==null||e.validationBatches>0&&Number.isInteger(e.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+e.validationBatches}):(s=BX(e.validationData),o=s.xs,a=s.ys)),u=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),c=void 0,c=i?l.slice().concat(l.map(function(B){return"val_"+B})):l.slice(),d=E3(e.callbacks,e.yieldEvery),f=e.verbose==null?1:e.verbose,p=R3(d,f,e.epochs,null,null,VX(n,e),null,i,c),h=p.callbackList,v=p.history,h.setModel(t),t.history=v,[4,h.onTrainBegin()];case 2:return H.sent(),t.stopTraining_=!1,g=e.initialEpoch==null?0:e.initialEpoch,[4,n.iterator()];case 3:m=H.sent(),H.label=4;case 4:return g<e.epochs?(y={},[4,h.onEpochBegin(g)]):[3,23];case 5:return H.sent(),b=0,w=0,r?[3,7]:[4,n.iterator()];case 6:m=H.sent(),H.label=7;case 7:return!r||b<e.batchesPerEpoch?[4,m.next()]:[3,21];case 8:return x=H.sent(),r&&x.done?(console.warn("You provided `batchesPerEpoch` as "+e.batchesPerEpoch+", but your dataset iterator ran out of data after "+b+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+e.batchesPerEpoch*e.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):x.value==null?[3,15]:(C=M3(t,x.value),E=C.xs,S=C.ys,(k={}).batch=w,k.size=E[0].shape[0],[4,h.onBatchBegin(w,k)]);case 9:if(H.sent(),N=[],e.classWeight==null)return[3,13];M=O3(e.classWeight,t.outputNames),L=0,H.label=10;case 10:return L<M.length?(T=(D=N).push,[4,D3(S[L],null,M[L])]):[3,13];case 11:T.apply(D,[H.sent()]),H.label=12;case 12:return++L,[3,10];case 13:for(O=E.concat(S).concat(N),P=u(O),Ze(O),L=0;L<l.length;++L)A=l[L],I=P[L],k[A]=I,wo(I);return[4,h.onBatchEnd(w,k)];case 14:H.sent(),b3(k),w++,b++,H.label=15;case 15:return(r?b>=e.batchesPerEpoch:x.done)?i?(_=void 0,kk(e.validationData)?(F=zt,[4,t.evaluateDataset(e.validationData,{batches:e.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return _=F.apply(void 0,[H.sent()]),[3,18];case 17:_=zt(t.evaluate(o,a,{batchSize:e.validationBatchSize==null?zX:e.validationBatchSize,verbose:0})),H.label=18;case 18:for(L=0;L<t.metricsNames.length;++L)y["val_"+t.metricsNames[L]]=_[L];H.label=19;case 19:return[3,21];case 20:return t.stopTraining_?[3,21]:[3,7];case 21:return[4,h.onEpochEnd(g,y)];case 22:return H.sent(),g++,t.stopTraining_?[3,23]:[3,4];case 23:return[4,h.onTrainEnd()];case 24:return H.sent(),[4,t.history.syncData()];case 25:return H.sent(),[2,t.history];case 26:return t.isTraining=!1,[7];case 27:return[2]}})})}function VX(t,n){var e=null;return n.batchesPerEpoch!=null?e=n.batchesPerEpoch:Number.isFinite(t.size)&&(e=t.size),e}function kk(t){return typeof t.iterator=="function"}function $X(t){return typeof t.next=="function"}function UX(t,n,e){return Ue(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,d,f;return ze(this,function(p){switch(p.label){case 0:if(r=(e=e||{}).batches!=null,i=t.testFunction,o=[],e.verbose>0)throw new Xe("Verbose mode is not implemented yet.");return Fe.assert(!r||e.batches>0&&Number.isInteger(e.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(e.batches)}),$X(n)?(s=n,[3,3]):[3,1];case 1:return[4,n.iterator()];case 2:s=p.sent(),p.label=3;case 3:a=s,u=0,l=0,c=function(){var h;return ze(this,function(v){switch(v.label){case 0:return[4,a.next()];case 1:return h=v.sent(),o=ee(function(){if(h.value){var g=M3(t,h.value),m=g.xs,y=g.ys,b=m.concat(y),w=ee(function(){return i(b)});if(Ze(b),l===0)for(var x=0;x<w.length;++x)o.push(Ie(0));var C=b[0].shape[0],E=function(S){var k=w[S],N=o[S];o[S]=ee(function(){return st(o[S],We(C,k))}),l>0&&Ze(N)};for(x=0;x<w.length;++x)E(x);Ze(w),u+=C,++l}return o}),h.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+e.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},p.label=4;case 4:return!r||l<e.batches?[5,c()]:[3,6];case 5:return p.sent()==="break"?[3,6]:[3,4];case 6:for(d=0;d<o.length;++d)f=o[d],o[d]=cr(o[d],u),Ze(f);return[2,mr(o)]}})})}function Fw(t){Fe.assert(t>0&&Number.isInteger(t),function(){return"batchSize is required to be a positive integer, but got "+t})}function zd(t,n,e){return t==null?[null]:Array.isArray(t)?t.map(function(r){return nu(r,n,e-n)}):nu(t,n,e-n)}function $C(t,n){return ee(function(){return t==null?null:Array.isArray(t)?t.map(function(e){return $C(e,n)}):a3(t,n.dtype==="int32"?n:n.toInt())})}function zw(t,n){for(var e=[],r=0,i=null;r<t;)(i=r+n)>=t&&(i=t),e.push([r,i]),r=i;return e}function WX(t,n,e,r,i,o,a,s,u,l,c,d,f,p,h){return Ue(this,void 0,void 0,function(){var v,g,m,y,b,w,x,C;return ze(this,function(E){switch(E.label){case 0:if(i==null&&(i=32),o==null&&(o=1),c==null&&(c=!0),f==null&&(f=0),v=!1,u!=null&&l!=null&&(v=!0),h!=null&&(v=!0,p==null))throw new Y("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return(g=t.checkNumSamples(e,i,p,"steps_per_epoch"))!=null&&(m=Wi(0,g)),a==null&&(a=1),y=R3(s,a,o,f,g,p,i,v,d),b=y.callbackList,w=y.history,b.setModel(t),t.history=w,[4,b.onTrainBegin()];case 1:E.sent(),t.stopTraining_=!1,x=function(S){var k,N,M,D,T;return ze(this,function(O){switch(O.label){case 0:return[4,b.onEpochBegin(S)];case 1:if(O.sent(),k={},p==null)return[3,2];throw new Xe("stepsPerEpoch mode is not implemented yet.");case 2:if(c==="batch")throw new Xe("batch shuffling is not implemneted yet");c&&Fe.shuffle(m),N=zr(m),M=zw(g,i),D=function(P){var A;return ze(this,function(I){switch(I.label){case 0:return A={},[4,b.onBatchBegin(P,A)];case 1:return I.sent(),ee(function(){var _=M[P][0],F=M[P][1],L=nu(N,_,F-_);A.batch=P,A.size=F-_;for(var H=$C(e,L),B=n(H),q=0;q<r.length;++q){var G=r[q],re=B[q];A[G]=re,wo(re)}if(P===M.length-1&&v){var j=t.testLoop(u,l,i);for(q=0;q<r.length;++q)G=r[q],re=j[q],wo(re),k["val_"+G]=re}}),[4,b.onBatchEnd(P,A)];case 2:return I.sent(),b3(A),t.stopTraining_?[2,"break"]:[2]}})},T=0,O.label=3;case 3:return T<M.length?[5,D(T)]:[3,6];case 4:if(O.sent()==="break")return[3,6];O.label=5;case 5:return++T,[3,3];case 6:N.dispose(),O.label=7;case 7:return[4,b.onEpochEnd(S,k)];case 8:return O.sent(),t.stopTraining_?[2,"break"]:[2]}})},C=f,E.label=2;case 2:return C<o?[5,x(C)]:[3,5];case 3:if(E.sent()==="break")return[3,5];E.label=4;case 4:return++C,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return E.sent(),[4,t.history.syncData()];case 7:return E.sent(),[2,t.history]}})})}function HX(t,n,e,r){return r===void 0&&(r={}),Ue(this,void 0,void 0,function(){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,C,E,S,k;return ze(this,function(N){switch(N.label){case 0:if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,N.label=1;case 1:return N.trys.push([1,,7,8]),Fw(d=r.batchSize==null?32:r.batchSize),f=!1,[4,t.standardizeUserData(n,e,r.sampleWeight,r.classWeight,f,d)];case 2:if(p=N.sent(),i=p[0],o=p[1],c=p[2],h=!1,v=void 0,!(r.validationData!=null&&r.validationData.length>0))return[3,4];if(h=!0,r.validationData.length!==2)throw r.validationData.length===3?new Xe("validationData including sample weights is not supported yet."):new Y("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return a=r.validationData[0],s=r.validationData[1],g=!0,[4,t.standardizeUserData(a,s,null,null,g,d)];case 3:return m=N.sent(),u=m[0],l=m[1],v=u.concat(l),[3,5];case 4:r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1?(h=!0,y=Math.floor(i[0].shape[0]*(1-r.validationSplit)),b=i[0].shape[0],u=zd(i,y,b),i=zd(i,0,y),l=zd(o,y,b),o=zd(o,0,y),v=u.concat(l)):r.validationSteps!=null&&(h=!0),N.label=5;case 5:return w=i.concat(o).concat(c),t.checkTrainableWeightsConsistency(),x=t.makeTrainFunction(),C=t.getDedupedMetricsNames(),E=void 0,S=void 0,h?(t.makeTestFunction(),E=t.testFunction,S=C.slice().concat(C.map(function(M){return"val_"+M}))):(E=null,v=[],S=C.slice()),k=E3(r.callbacks,r.yieldEvery),[4,WX(t,x,w,C,d,r.epochs,r.verbose,k,E,v,r.shuffle,S,r.initialEpoch,null,null)];case 6:return[2,N.sent()];case 7:return t.isTraining=!1,Ks(i,n),Ks(o,e),Ks(u,a),Ks(l,s),c!=null&&Ze(c),[7];case 8:return[2]}})})}function P3(t){var n=[];t instanceof At&&(t=[t]);for(var e=0;e<t.length;++e){var r=t[e];if(r.rank===1)n.push(Sp(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");n.push(r)}}return n}function Ks(t,n){if(t!=null){var e=[];if(n instanceof At)e.push(n.id);else if(Array.isArray(n))n.forEach(function(u){return e.push(u.id)});else if(n!=null)for(var r in n){var i=n[r];e.push(i.id)}var o=[];if(t instanceof At)e.indexOf(t.id)===-1&&o.push(t);else if(Array.isArray(t))t.forEach(function(u){e.indexOf(u.id)===-1&&o.push(u)});else if(t!=null)for(var a in t){var s=t[a];e.indexOf(s.id)===-1&&o.push(s)}o.forEach(function(u){u.isDisposed||u.dispose()})}}function GX(t){return t instanceof At}function Bw(t){return Array.isArray(t)}function Ik(t){return!GX(t)&&!Bw(t)}function _k(t,n,e,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=""),n==null||n.length===0){if(t!=null){var o=!1;if(Bw(t)&&t.length>0)o=!0;else if(Ik(t)){for(var a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new Y("Error when checking model "+i+" expected no data, but got "+t)}return[]}if(t==null)return n.map(function(g){return null});var s;if(Ik(t)){t=t,s=[];for(var u=0,l=n;u<l.length;u++){var c=l[u];if(t[c]==null)throw new Y('No data provided for "'+c+'". Need data for each key in: '+n);s.push(t[c])}}else if(Bw(t)){if((t=t).length!==n.length)throw new Y("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+n.length+" Tensor(s), but instead got the following list of Tensor(s): "+t);s=t}else{if(t=t,n.length>1)throw new Y("The model "+i+" expects "+n.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+t.shape);s=[t]}if(s=P3(s),e!=null){for(var d=0;d<n.length;++d)if(e[d]!=null){var f=s[d];if(f.shape.length!==e[d].length)throw new Y("Error when checking "+i+": expected "+n[d]+" to have "+e[d].length+" dimension(s). but got array with shape "+f.shape);for(var p=0;p<e[d].length;++p)if(p!==0||r){var h=f.shape[p],v=e[d][p];if(v!=null&&v>=0&&h!==v)throw new Y("Error when checking "+i+": expected "+n[d]+" to have shape ["+e[d]+"], but got array with shape ["+f.shape+"].")}}}return s}function qX(t,n,e){var r=es(t.map(function(o){return o.shape[0]}));r.sort();var i=es(n.map(function(o){return o.shape[0]}));if(i.sort(),r.length>1)throw new Y("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(o){return o.shape})));if(i.length>1)throw new Y("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(n.map(function(o){return o.shape})));if(r.length>0&&i.length>0&&!Fe.arraysEqual(r,i))throw new Y("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+i[0]+" target sample(s).")}function KX(t,n,e){for(var r=[Iu,ly,$f],i=0;i<t.length;++i){var o=t[i],a=n[i],s=e[i];if(a!=null){if(a===$f&&o.shape[o.shape.length-1]===1)throw new Y("You are passing a target array of shape "+o.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(r.indexOf(a)!==-1)for(var u=o.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var d=u[c],f=l[c];if(f!=null&&d!==f)throw new Y("A target Tensor with shape "+o.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}function Ak(t,n,e,r,i){var o;if(r===void 0&&(r=!0),i===void 0&&(i=""),Array.isArray(t)){if(t.length!==n.length)throw new Y("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+n.length+" Tensor(s), but instead got "+t.length+" Tensors(s).");o=t}else{if(n.length>1)throw new Y("The model expects "+n.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(t.shape)+".");o=[t]}if(e!=null){for(var a=0;a<n.length;++a)if(e[a]!=null){var s=o[a];if(s.shape.length!==e[a].length)throw new Y("Error when checking "+i+": expected "+n[a]+" to have "+e[a].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<e[a].length;++u)if(u!==0||r){var l=s.shape[u],c=e[a][u];if(c!=null&&c!==l)throw new Y("Error when checking "+i+": expected "+n[a]+" to have shape "+JSON.stringify(e[a])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}}function XX(t,n){if(t==null||Array.isArray(t)&&t.length===0)return n.map(function(u){return[]});var e;if(typeof t=="string"||typeof t=="function")e=[t];else{if(!Array.isArray(t)&&typeof t!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+t);e=t}if(Array.isArray(e))return n.map(function(u){return e});for(var r=[],i=0,o=n;i<o.length;i++){var a=o[i],s=e.hasOwnProperty(a)?e[a]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}var YX="layers-model",ru=function(t){function n(e){var r=t.call(this,e)||this;return r.isTraining=!1,r}return ue(n,t),n.prototype.summary=function(e,r,i){if(i===void 0&&(i=console.log),!this.built)throw new Y("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");TX(this,e,r,i)},n.prototype.compile=function(e){var r=this;if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=RX(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof da))throw new Y("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var i=[];if(Array.isArray(e.loss)||typeof e.loss=="string"||typeof e.loss=="function")if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Y("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+e.loss+".");var o=e.loss;i=o.map(function(g){return h1(g)})}else{var a=h1(e.loss);this.outputs.forEach(function(g){i.push(a)})}else{for(var s in e.loss=e.loss,e.loss)if(this.outputNames.indexOf(s)===-1)throw new Y('Unknown entry in loss dictionary: "'+s+'". Only expected the following keys: '+this.outputNames);for(var u=0,l=this.outputNames;u<l.length;u++){var c=l[u];e.loss[c]==null&&console.warn('Output "'+c+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+c+" during training"),i.push(h1(e.loss[c]))}}this.lossFunctions=i,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var d=0;d<this.outputs.length;++d){var f=this.internalOutputShapes[d],p=this.outputNames[d];this.feedOutputNames.push(p),this.feedOutputShapes.push(f),this.feedLossFns.push(this.lossFunctions[d])}var h=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],tu("loss",function(){for(var g=0;g<r.outputs.length;++g)if(h.indexOf(g)===-1){var m=r.lossFunctions[g];r.outputs.length>1&&(r.metricsTensors.push([m,g]),r.metricsNames.push(r.outputNames[g]+"_loss"))}});var v=XX(e.metrics,this.outputNames);tu("metric",function(){for(var g=function(y){if(h.indexOf(y)!==-1)return"continue";(function(b){for(var w,x,C,E=function(N){if(typeof N=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(N)!==-1){var M=r.internalOutputShapes[y];M[M.length-1]===1||r.lossFunctions[y]===ly?["accuracy","acc"].indexOf(N)!==-1?x=BC:["crossentropy","ce"].indexOf(N)!==-1&&(x=k3):r.lossFunctions[y]===Ev?["accuracy","acc"].indexOf(N)!==-1?x=I3:["crossentropy","ce"].indexOf(N)!==-1&&(x=_3):["accuracy","acc"].indexOf(N)!==-1?x=jC:["crossentropy","ce"].indexOf(N)!==-1&&(x=VC);var D=void 0;["accuracy","acc"].indexOf(N)!==-1?D="acc":["crossentropy","ce"].indexOf(N)!==-1&&(D="ce"),C=x,w=""+D}else{var T=CX(N);C=T,w=""+Nh(N)}var O;tu(w,function(){O=C}),function(P,A,I){r.outputNames.length>1&&(A=r.outputNames[P]+"_"+A),r.metricsNames.push(A),r.metricsTensors.push([I,P])}(y,w,O)},S=0,k=b;S<k.length;S++)E(k[S])})(v[y])},m=0;m<r.outputs.length;++m)g(m)}),this.collectedTrainableWeights=this.trainableWeights},n.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},n.prototype.evaluate=function(e,r,i){i===void 0&&(i={});var o=i.batchSize==null?32:i.batchSize;Fw(o);var a=this.standardizeUserDataXY(e,r,!0,o);try{var s=a[0].concat(a[1]);this.makeTestFunction();var u=this.testFunction;return mr(this.testLoop(u,s,o,i.verbose,i.steps))}finally{Ks(a[0],e),Ks(a[1],r)}},n.prototype.evaluateDataset=function(e,r){return Ue(this,void 0,void 0,function(){return ze(this,function(i){return this.makeTestFunction(),[2,UX(this,e,r)]})})},n.prototype.checkNumSamples=function(e,r,i,o){var a;if(o===void 0&&(o="steps"),i!=null){if(a=null,r!=null)throw new Y("If "+o+" is set, batchSize must be null or undefined.Got batchSize = "+r)}else{if(e==null)throw new Y("Either the input data should have a defined shape, or "+o+" shoud be specified.");a=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return a},n.prototype.execute=function(e,r){if(Array.isArray(r)&&r.length===0)throw new Y("`outputs` is an empty Array, which is not allowed.");var i=Array.isArray(r),o=i?r:[r],a=this.retrieveSymbolicTensors(o),s=new bl;if(e instanceof At&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Y("The number of inputs provided ("+e.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var u=0;u<this.inputs.length;++u)s.add(this.inputs[u],e[u])}else for(var l=0,c=this.inputs;l<c.length;l++){var d=c[l],f=e[d.name];if(f==null)throw new Y("No value is provided for the model's input "+d.name);s.add(d,f)}var p=Fd(a,s);return i?p:p[0]},n.prototype.retrieveSymbolicTensors=function(e){for(var r=pu(null,e.length),i=e.length,o=0,a=this.layers;o<a.length;o++){for(var s=a[o],u=Array.isArray(s.output)?s.output:[s.output],l=u.map(function(p){return p.name}),c=0;c<e.length;++c){var d=l.indexOf(e[c]);if(d!==-1&&(r[c]=u[d],i--),i===0)break}if(i===0)break}if(i>0){var f=[];throw r.forEach(function(p,h){p==null&&f.push(e[h])}),new Y("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(f))}return r},n.prototype.predictLoop=function(e,r,i){var o=this;return r===void 0&&(r=32),i===void 0&&(i=!1),ee(function(){var a=o.checkNumSamples(e);if(i)throw new Xe("Verbose predictLoop() is not implemented yet.");for(var s=zw(a,r),u=o.outputs.map(function(d){return[]}),l=function(d){ee(function(){var f=s[d][0],p=s[d][1],h=zd(e,f,p),v=[];if(Array.isArray(h))for(var g=0;g<h.length;++g)v.push({key:o.inputs[g],value:h[g]});else v.push({key:o.inputs[0],value:h});var m=new bl(v);return Fd(o.outputs,m)}).forEach(function(f,p){return u[p].push(f)})},c=0;c<s.length;++c)l(c);return mr(u.map(function(d){return lr(d,0)}))})},n.prototype.predict=function(e,r){r===void 0&&(r={});var i=P3(e);Ak(i,this.inputNames,this.feedInputShapes,!1);try{var o=r.batchSize==null?32:r.batchSize;return Fw(o),this.predictLoop(i,o)}finally{Ks(i,e)}},n.prototype.predictOnBatch=function(e){Ak(e,this.inputNames,this.feedInputShapes,!0);var r=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,r)},n.prototype.standardizeUserDataXY=function(e,r,i,o){if(this.optimizer_==null)throw new lo("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var a=[],s=0;s<this.feedOutputShapes.length;++s){var u=this.feedOutputShapes[s];this.feedLossFns[s]===Ev?a.push(u.slice(0,u.length-1).concat([1])):a.push(u)}if(qX(e=_k(e,this.feedInputNames,this.feedInputShapes,!1,"input"),r=_k(r,this.feedOutputNames,a,!1,"target")),KX(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&o!=null&&o>0&&e[0].shape[0]%o!=0)throw new Y("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+o+". Found: "+e[0].shape[0]+" sample(s).");return[e,r]},n.prototype.standardizeUserData=function(e,r,i,o,a,s){return a===void 0&&(a=!0),Ue(this,void 0,void 0,function(){var u,l,c,d,f,p,h,v;return ze(this,function(g){switch(g.label){case 0:if(u=this.standardizeUserDataXY(e,r,a,s),l=u[0],c=u[1],i!=null)throw new Error("sample weight is not supported yet.");if(d=null,o==null)return[3,4];f=O3(o,this.outputNames),d=[],p=0,g.label=1;case 1:return p<f.length?(v=(h=d).push,[4,D3(c[p],null,f[p])]):[3,4];case 2:v.apply(h,[g.sent()]),g.label=3;case 3:return++p,[3,1];case 4:return[2,[l,c,d]]}})})},n.prototype.testLoop=function(e,r,i,o,a){var s=this;return o===void 0&&(o=0),ee(function(){var u=s.checkNumSamples(r,i,a,"steps"),l=[];if(o>0)throw new Xe("Verbose mode is not implemented yet.");if(a!=null)throw new Xe("steps mode in testLoop() is not implemented yet");for(var c=zw(u,i),d=zr(Wi(0,u)),f=0;f<c.length;++f){var p=c[f][0],h=c[f][1],v=nu(d,p,h-p),g=$C(r,v),m=e(g);if(f===0)for(var y=0;y<m.length;++y)l.push(Ie(0));for(y=0;y<m.length;++y){var b=m[y];l[y]=st(l[y],We(h-p,b))}}for(y=0;y<l.length;++y)l[y]=cr(l[y],u);return l})},n.prototype.getDedupedMetricsNames=function(){for(var e=this.metricsNames,r=[],i=0;i<e.length;++i){var o=e[i],a=o;hk(e,o)>1&&(a+="_"+hk(e.slice(0,i),o)),r.push(a)}return r},n.prototype.makeTrainFunction=function(){var e=this;return function(r){var i=[],o=r.slice(0,e.inputs.length),a=r.slice(e.inputs.length,e.inputs.length+e.outputs.length),s=r.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),u=[],l=e.collectedTrainableWeights.map(function(c){return c.read()});return[e.optimizer_.minimize(function(){for(var c=[],d=0;d<e.inputs.length;++d)c.push({key:e.inputs[d],value:o[d]});var f,p=new bl(c),h=Fd(e.outputs,p,{training:!0});for(d=0;d<e.lossFunctions.length;++d){var v=(0,e.lossFunctions[d])(a[d],h[d]);s[d]!=null&&(v=FX(v,s[d]));var g=gn(v);i.push(g),f=d===0?v:st(f,v)}for(d=0;d<e.metricsTensors.length;++d){var m=void 0;if(e.outputs.length>1&&d<e.outputs.length)m=i[d];else{var y=e.metricsTensors[d][0],b=e.metricsTensors[d][1];m=gn(y(a[b],h[b]))}wo(m),u.push(m)}return f=gn(f),e.calculateLosses().forEach(function(w){f=st(f,w)}),f},!0,l)].concat(u)}},n.prototype.makeTestFunction=function(){var e=this;this.testFunction=function(r){return ee(function(){for(var i,o=[],a=r.slice(0,e.inputs.length),s=r.slice(e.inputs.length,e.inputs.length+e.outputs.length),u=[],l=0;l<e.inputs.length;++l)u.push({key:e.inputs[l],value:a[l]});var c=new bl(u),d=Fd(e.outputs,c);for(l=0;l<e.lossFunctions.length;++l){var f=e.lossFunctions[l],p=gn(f(s[l],d[l]));i=l===0?p:st(i,p),o.push(i)}for(l=0;l<e.metricsTensors.length;++l){var h=e.metricsTensors[l][0],v=e.metricsTensors[l][1],g=gn(h(s[v],d[v]));o.push(g)}return o})}},n.prototype.fit=function(e,r,i){return i===void 0&&(i={}),Ue(this,void 0,void 0,function(){return ze(this,function(o){return[2,HX(this,e,r,i)]})})},n.prototype.fitDataset=function(e,r){return Ue(this,void 0,void 0,function(){return ze(this,function(i){return[2,jX(this,e,r)]})})},n.prototype.trainOnBatch=function(e,r){return Ue(this,void 0,void 0,function(){var i,o,a,s,u,l,c,d,f;return ze(this,function(p){switch(p.label){case 0:return[4,this.standardizeUserData(e,r)];case 1:i=p.sent(),o=i[0],a=i[1],s=this.makeTrainFunction(),u=s(o.concat(a)),l=[],c=0,d=u,p.label=2;case 2:return c<d.length?[4,d[c].data()]:[3,5];case 3:f=p.sent(),l.push(f[0]),p.label=4;case 4:return c++,[3,2];case 5:return Ze(u),[2,mr(l)]}})})},n.prototype.getNamedWeights=function(e){for(var r=[],i=e!=null&&e.trainableOnly,o=i?this.trainableWeights:this.weights,a=this.getWeights(i),s=0;s<o.length;++s)i&&!o[s].trainable||r.push({name:o[s].originalName,tensor:a[s]});return r},Object.defineProperty(n.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var e=t.prototype.dispose.call(this);if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var r=fv().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=r-fv().numTensors}return e},n.prototype.getLossIdentifiers=function(){var e;if(typeof this.loss=="string")e=Bo(this.loss);else if(Array.isArray(this.loss)){for(var r=0,i=this.loss;r<i.length;r++)if(typeof i[r]!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(function(c){return Bo(c)})}else{var o=Object.keys(this.loss);e={};for(var a=this.loss,s=0,u=o;s<u.length;s++){var l=u[s];if(typeof a[l]!="string")throw new Error("Serialization of non-string loss is not supported.");e[l]=Bo(a[l])}}return e},n.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Bo(Nh(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(i){return Bo(Nh(i))});var e={};for(var r in this.metrics)e[r]=Bo(Nh(this.metrics[r]));return e},n.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},n.prototype.loadTrainingConfig=function(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var r,i,o=ji(Uf(e.optimizer_config));if(typeof e.loss=="string")r=Bs(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(function(s){return Bs(s)});else if(e.loss!=null)for(var a in r={},e.loss)r[a]=Bs(e.loss[a]);if(Array.isArray(e.metrics))i=e.metrics.map(function(s){return Bs(s)});else if(e.metrics!=null)for(var a in i={},e.metrics)i[a]=Bs(e.metrics[a]);this.compile({loss:r,metrics:i,optimizer:o})},n.prototype.save=function(e,r){return Ue(this,void 0,void 0,function(){var i,o,a,s,u,l,c,d,f,p,h,v,g,m;return ze(this,function(y){switch(y.label){case 0:if(typeof e=="string"){if((i=Yr.getSaveHandlers(e)).length===0)throw new Y("Cannot find any save handlers for URL '"+e+"'");if(i.length>1)throw new Y("Found more than one ("+i.length+") save handlers for URL '"+e+"'");e=i[0]}if(e.save==null)throw new Y("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,Yr.encodeWeights(this.getNamedWeights(r))];case 1:return o=y.sent(),a=!1,s=null,u=this.toJSON(s,a),l={modelTopology:u,format:YX,generatedBy:"TensorFlow.js tfjs-layers v"+cy,convertedBy:null},r!=null&&r.includeOptimizer&&this.optimizer!=null?(l.trainingConfig=this.getTrainingConfig(),c="optimizer",v=(h=Yr).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,v.apply(h,[y.sent(),c])];case 3:d=y.sent(),f=d.data,p=d.specs,(m=o.specs).push.apply(m,p),o.data=Yr.concatenateArrayBuffers([o.data,f]),y.label=4;case 4:return this.userDefinedMetadata!=null&&(g=!0,Ck(this.userDefinedMetadata,this.name,g),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=o.data,l.weightSpecs=o.specs,[2,e.save(l)]}})})},n.prototype.setUserDefinedMetadata=function(e){Ck(e,this.name),this.userDefinedMetadata=e},n.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},n.className="Model",n}(PX);function JX(t,n){return Ue(this,void 0,void 0,function(){var e,r,i,o,a,s,u,l;return ze(this,function(c){switch(c.label){case 0:return"modelTopology"in t||(t={modelTopology:t}),(e=(t=t).modelTopology).model_config!=null&&(e=e.model_config),r=Uf(e),i=ji(r,n),t.weightsManifest==null?[3,2]:[4,Yr.loadWeights(t.weightsManifest,t.pathPrefix,i.weights.map(function(d){return d.originalName}))];case 1:for(o=c.sent(),a={},s=0,u=i.weights;s<u.length;s++)l=u[s],a[l.originalName]=o[l.originalName];i.loadWeights(a),Ze(o),c.label=2;case 2:return[2,i]}})})}function QX(t,n){return Ue(this,void 0,void 0,function(){var e;return ze(this,function(r){if(n==null&&(n={}),typeof t=="string"){if((e=Yr.getLoadHandlers(t,n.onProgress)).length===0)e.push(Yr.browserHTTPRequest(t,n));else if(e.length>1)throw new Y("Found more than one ("+e.length+") load handlers for URL '"+t+"'");t=e[0]}return[2,ZX(t,void 0,n)]})})}function ZX(t,n,e){return Ue(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,d;return ze(this,function(f){switch(f.label){case 0:if(e==null&&(e={}),t.load==null)throw new Y("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,t.load()];case 1:if(r=f.sent(),(i=r.modelTopology).model_config!=null&&(i=i.model_config),o=e.strict==null||e.strict,a=r.weightData!=null&&r.weightSpecs!=null&&o,s=ji(Uf(i),n,a),(u=r.trainingConfig)!=null&&s.loadTrainingConfig(u),r.userDefinedMetadata!=null&&s.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData==null)return[3,4];if(r.weightSpecs==null)throw new Y("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return l=eY(r.weightData,r.weightSpecs),c=l.modelWeights,d=l.optimizerWeights,s.loadWeights(c,o),s.optimizer!=null&&d.length>0?[4,s.optimizer.setWeights(d)]:[3,3];case 2:f.sent(),f.label=3;case 3:Ze(c),Ze(d.map(function(p){return p.tensor})),f.label=4;case 4:return[2,s]}})})}function eY(t,n){var e=Yr.decodeWeights(t,n),r={},i=[];return n.forEach(function(o){o.group==="optimizer"?i.push({name:o.name,tensor:e[o.name]}):r[o.name]=e[o.name]}),{modelWeights:r,optimizerWeights:i}}he.registerClass(ru);var UC=function(t){function n(e){var r=t.call(this,{inputs:[],outputs:[]})||this;if(e=e||{},r.trainable=!0,r.built=!1,r.name=e.name!=null?e.name:ay("sequential_"),e.layers!=null)for(var i=0,o=e.layers;i<o.length;i++){var a=o[i];r.add(a)}return r}return ue(n,t),n.prototype.checkShape=function(e){if(e.inboundNodes[0].outputTensors[0].shape.some(function(r){return r<0}))throw new Y("Negative dimension size caused by adding layer "+e.name+" with input shape ["+e.inboundNodes[0].inputTensors[0].shape+"]")},n.prototype.add=function(e){var r,i=e instanceof n||e instanceof ru;if(i){if((r=e).outputs.length!==1)throw new Y("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new Y("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new Y("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var o=y3({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(o)}if(i)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new Y("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+e.name+" which has "+e.inboundNodes.length+" pre-existing inbound connections.");if(e.inboundNodes[0].outputTensors.length!==1)throw new Y("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=g3(this.outputs[0])}this.inboundNodes=[],new sy({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:pu(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(s){return s.shape}),outputShapes:this.outputs[0].shape})}else{var a=e.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1},n.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},n.prototype.call=function(e,r){return this.model==null&&this.build(),this.model.call(e,r)},n.prototype.build=function(e){if(Lt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new ru({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},n.prototype.countParams=function(){return this.built||this.build(),t.prototype.countParams.call(this)},n.prototype.summary=function(e,r,i){i===void 0&&(i=console.log),this.built||this.build(),t.prototype.summary.call(this,e,r,i)},n.prototype.setWeights=function(e){this.model==null&&this.build(),this.model.setWeights(e)},n.prototype.evaluate=function(e,r,i){if(i===void 0&&(i={}),!this.built)throw new lo("The model needs to be compiled before being used.");return this.model.evaluate(e,r,i)},n.prototype.evaluateDataset=function(e,r){return Ue(this,void 0,void 0,function(){return ze(this,function(i){if(!this.built)throw new lo("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(e,r)]})})},n.prototype.predict=function(e,r){return r===void 0&&(r={}),this.model==null&&this.build(),this.model.predict(e,r)},n.prototype.predictOnBatch=function(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)},n.prototype.compile=function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(n.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e},enumerable:!0,configurable:!0}),n.prototype.fit=function(e,r,i){return i===void 0&&(i={}),Ue(this,void 0,void 0,function(){return ze(this,function(o){if(!this.built)throw new lo("The model needs to be compiled before being used.");return[2,this.model.fit(e,r,i)]})})},n.prototype.fitDataset=function(e,r){return Ue(this,void 0,void 0,function(){return ze(this,function(i){if(!this.built)throw new lo("The model needs to be compiled before being used.");return[2,this.model.fitDataset(e,r)]})})},n.prototype.trainOnBatch=function(e,r){return Ue(this,void 0,void 0,function(){return ze(this,function(i){return[2,this.model.trainOnBatch(e,r)]})})},n.fromConfig=function(e,r,i,o){var a;o===void 0&&(o=!1);var s={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new Y("Legacy serialization format not supported yet.");a=r}else Fe.assert(r.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),a=r.layers,delete r.layers,s=r;var u=new e(s);if(!(u instanceof n))throw new Xe("Sequential.fromConfig called on non-Sequential input: "+u);for(var l=0,c=a;l<c.length;l++){var d=ji(c[l],void 0,o);o&&d.setFastWeightInitDuringBuild(!0),u.add(d)}return u},Object.defineProperty(n.prototype,"stopTraining",{get:function(){if(this.model==null)throw new Y("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(this.model==null)throw new Y("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e},enumerable:!0,configurable:!0}),n.prototype.getConfig=function(){for(var e=[],r=0,i=this.layers;r<i.length;r++){var o=i[r],a={};a.className=o.getClassName(),a.config=o.getConfig(),e.push(a)}return{name:this.name,layers:e}},n.className="Sequential",n}(ru);function tY(t){return new ru(t)}function nY(t){return new UC(t)}function rY(t,n){return n==null&&(n={}),QX(t,n)}function L3(t){return y3(t)}function iY(t,n){C3.registerCallbackConstructor(t,n)}he.registerClass(UC);var si=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.getConfig=function(){return{}},n}(he.Serializable),oY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e,r){return r===void 0&&(r=1),kK(e,r)},n.className="elu",n}(si);he.registerClass(oY);var aY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return Zg(e)},n.className="selu",n}(si);he.registerClass(aY);var sY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return ws(e)},n.className="relu",n}(si);he.registerClass(sY);var uY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return ee(function(){return kc(6,ws(e))})},n.className="relu6",n}(si);he.registerClass(uY);var lY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return e},n.className="linear",n}(si);he.registerClass(lY);var cY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return Og(e)},n.className="sigmoid",n}(si);he.registerClass(cY);var dY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return _K(e)},n.className="hardSigmoid",n}(si);he.registerClass(dY);var fY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return lp(e)},n.className="softplus",n}(si);he.registerClass(fY);var pY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return IK(e)},n.className="softsign",n}(si);he.registerClass(pY);var hY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e){return Dg(e)},n.className="tanh",n}(si);he.registerClass(hY);var F3=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e,r){return r===void 0&&(r=-1),Ru(e,r)},n.className="softmax",n}(si);he.registerClass(F3);var mY=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.apply=function(e,r){return r===void 0&&(r=-1),kg(e,r)},n.className="logSoftmax",n}(si);function ri(t){return t.getClassName()}function v1(t,n){return n===void 0&&(n={}),bp(t,he.SerializationMap.getMap().classNameMap,n,"activation")}function cs(t){var n;return t==null?v1(n={className:"linear",config:{}}):typeof t=="string"?((n={}).className=t,n.config={},v1(n)):t instanceof si?t:v1(t)}function WC(t){if(t!=null&&typeof t!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+t)}he.registerClass(mY);var z3=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n}(he.Serializable),dy=function(t){function n(e){var r=t.call(this)||this;return WC(e),r.l1=e==null||e.l1==null?.01:e.l1,r.l2=e==null||e.l2==null?.01:e.l2,r.hasL1=r.l1!==0,r.hasL2=r.l2!==0,r}return ue(n,t),n.prototype.apply=function(e){var r=this;return ee(function(){var i=_t([1]);return r.hasL1&&(i=st(i,Br(We(r.l1,ss(e))))),r.hasL2&&(i=st(i,Br(We(r.l2,Ep(e))))),i.asScalar()})},n.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},n.fromConfig=function(e,r){return new e({l1:r.l1,l2:r.l2})},n.className="L1L2",n}(z3);function vY(t){return WC(t),new dy({l1:t!=null?t.l1:null,l2:0})}function gY(t){return WC(t),new dy({l2:t!=null?t.l2:null,l1:0})}he.registerClass(dy);var Ok={l1l2:"L1L2"};function et(t){return NC(t)}function Dk(t,n){return n===void 0&&(n={}),bp(t,he.SerializationMap.getMap().classNameMap,n,"regularizer")}function qt(t){return t==null?null:typeof t=="string"?Dk({className:t in Ok?Ok[t]:t,config:{}}):t instanceof z3?t:Dk(t)}var B3=function(t){function n(e){var r=t.call(this,e??{})||this;return r.supportsMasking=!0,e!=null&&(r.maxValue=e.maxValue),r}return ue(n,t),n.prototype.call=function(e,r){e=Ye(e);var i=ws(e);return this.maxValue!=null&&(i=br(i,0,this.maxValue)),i},n.prototype.computeOutputShape=function(e){return e},n.prototype.getConfig=function(){var e={maxValue:this.maxValue},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="ReLU",n}(pt);he.registerClass(B3);var j3=function(t){function n(e){var r=t.call(this,e??{})||this;return r.DEFAULT_ALPHA=.3,e==null&&(e={}),r.alpha=e.alpha==null?r.DEFAULT_ALPHA:e.alpha,r}return ue(n,t),n.prototype.call=function(e,r){var i=Ye(e);return Jg(i,this.alpha)},n.prototype.computeOutputShape=function(e){return e},n.prototype.getConfig=function(){var e={alpha:this.alpha},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="LeakyReLU",n}(pt);he.registerClass(j3);var V3=function(t){function n(e){var r=t.call(this,e??{})||this;if(r.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),r.supportsMasking=!0,r.alphaInitializer=Gt(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=qt(e.alphaRegularizer),r.alphaConstraint=Cn(e.alphaConstraint),e.sharedAxes==null)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if(typeof e.sharedAxes!="number")throw new Y("Expected sharedAxes to be a number or an array of numbers, but got "+e.sharedAxes);r.sharedAxes=[e.sharedAxes]}return r}return ue(n,t),n.prototype.build=function(e){var r=(e=Lt(e)).slice(1);if(this.sharedAxes!=null)for(var i=0,o=this.sharedAxes;i<o.length;i++)r[(s=o[i])-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(this.sharedAxes!=null)for(var s=1;s<e.length;++s)a[s]=e[s];this.inputSpec=[new Fn({ndim:e.length,axes:a})],this.built=!0},n.prototype.call=function(e,r){return e=Ye(e),Qg(e,this.alpha.read())},n.prototype.getConfig=function(){var e={alphaInitializer:Et(this.alphaInitializer),alphaRegularizer:et(this.alphaRegularizer),alphaConstraint:Dt(this.alphaConstraint),sharedAxes:this.sharedAxes},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="PReLU",n}(pt);he.registerClass(V3);var $3=function(t){function n(e){var r=t.call(this,e??{})||this;if(r.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==r.DEFAULT_ALPHA)throw new Xe("Non-default alpha value ("+e.alpha+") is not supported by the ELU layer yet.");return r.alpha=e.alpha==null?r.DEFAULT_ALPHA:e.alpha,r}return ue(n,t),n.prototype.call=function(e,r){var i=Ye(e);return Oc(i)},n.prototype.computeOutputShape=function(e){return e},n.prototype.getConfig=function(){var e={alpha:this.alpha},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="ELU",n}(pt);he.registerClass($3);var U3=function(t){function n(e){var r=t.call(this,e??{})||this;return r.DEFAULT_THETA=1,e==null&&(e={}),r.theta=e.theta==null?r.DEFAULT_THETA:e.theta,r}return ue(n,t),n.prototype.call=function(e,r){var i=Ye(e);return i.mul(xp(i.greater(this.theta),"float32"))},n.prototype.computeOutputShape=function(e){return e},n.prototype.getConfig=function(){var e={theta:this.theta},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="ThresholdedReLU",n}(pt);he.registerClass(U3);var W3=function(t){function n(e){var r=t.call(this,e??{})||this;return r.DEFAULT_AXIS=1,e==null&&(e={}),r.softmax=new F3().apply,r.axis=e.axis==null?r.DEFAULT_AXIS:e.axis,r}return ue(n,t),n.prototype.call=function(e,r){var i=Ye(e);return this.softmax(i,this.axis)},n.prototype.computeOutputShape=function(e){return e},n.prototype.getConfig=function(){var e={axis:this.axis},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="Softmax",n}(pt);function g1(t,n,e){if(typeof t=="number")return pu(t,n);if(t.length!==n)throw new Y("The "+e+" argument must be an integer or tuple of "+n+" integers. Received: "+t.length+" elements.");for(var r=0;r<n;++r){var i=t[r];if(!CK(i))throw new Y("The "+e+" argument must be an integer or tuple of "+n+" integers. Received: "+JSON.stringify(t)+" including a non-integer number "+i)}return t}function Xo(t,n,e,r,i){return i===void 0&&(i=1),t==null?t:(o=e==="same"?t:t-(n+(n-1)*(i-1))+1,Math.floor((o+r-1)/r));var o}function kh(t,n,e,r){if(t==null)return null;if(r==="valid")t=t*n+ls([e-n,0]);else{if(r!=="same")throw new Y("Unsupport padding mode: "+r+".");t*=n}return t}function HC(t,n){return ee(function(){return Tn(n),n==="channelsFirst"?en(t,[0,2,3,1]):t})}function H3(t,n){return ee(function(){return Tn(n),n==="channelsFirst"?en(t,[0,2,3,4,1]):t})}function yY(t,n,e,r,i,o,a){return r===void 0&&(r=1),i===void 0&&(i="valid"),a===void 0&&(a=1),ee(function(){if(o==null&&(o=Ui()),Tn(o),t.shape.length!==3)throw new Y("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(n.shape.length!==3)throw new Y("The kernel for a conv1dWithBias operation should be 3, but is "+n.shape.length+" instead");if(e!=null&&e.shape.length!==1)throw new Y("The bias for a conv1dWithBias operation should be 1, but is "+n.shape.length+" instead");if(o==="channelsFirst"&&(t=en(t,[0,2,1])),i==="causal")throw new Xe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=Bg(t,n,r,i==="same"?"same":"valid","NWC",a);return e!=null&&(s=fa(s,e)),s})}function Mk(t,n,e,r,i,o,a,s){return r===void 0&&(r=[1,1]),i===void 0&&(i="valid"),s===void 0&&(s=null),ee(function(){if(o==null&&(o=Ui()),Tn(o),t.rank!==3&&t.rank!==4)throw new Y("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+t.rank+".");if(n.rank!==3&&n.rank!==4)throw new Y("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+t.rank+".");var u=HC(t,o);if(i==="causal")throw new Xe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=oc.conv2d({x:u,filter:n,strides:r,pad:i==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:e,activation:s}),o==="channelsFirst"&&(u=en(u,[0,3,1,2])),u})}function bY(t,n,e,r,i,o,a){return r===void 0&&(r=[1,1,1]),i===void 0&&(i="valid"),ee(function(){if(o==null&&(o=Ui()),Tn(o),t.rank!==4&&t.rank!==5)throw new Y("conv3dWithBias expects input to be of rank 4 or 5, but received "+t.rank+".");if(n.rank!==4&&n.rank!==5)throw new Y("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+t.rank+".");var s=H3(t,o);if(i==="causal")throw new Xe("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=jg(s,n,r,i==="same"?"same":"valid","NDHWC",a),e!=null&&(s=fa(s,e)),o==="channelsFirst"&&(s=en(s,[0,4,1,2,3])),s})}he.registerClass(W3);var G3=function(t){function n(e,r){var i=t.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),i.rank=e,wr(i.rank,"rank"),i.rank!==1&&i.rank!==2&&i.rank!==3)throw new Xe("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=g1(r.kernelSize,e,"kernelSize"),i.strides=g1(r.strides==null?1:r.strides,e,"strides"),i.padding=r.padding==null?"valid":r.padding,Ci(i.padding),i.dataFormat=r.dataFormat==null?"channelsLast":r.dataFormat,Tn(i.dataFormat),i.activation=cs(r.activation),i.useBias=r.useBias==null||r.useBias,i.biasInitializer=Gt(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=Cn(r.biasConstraint),i.biasRegularizer=qt(r.biasRegularizer),i.activityRegularizer=qt(r.activityRegularizer),i.dilationRate=g1(r.dilationRate==null?1:r.dilationRate,e,"dilationRate"),i.rank===1&&Array.isArray(i.dilationRate)&&i.dilationRate.length!==1)throw new Y("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(i.rank===2){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==2)throw new Y("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(i.rank===3){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==3)throw new Y("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate))}return i}return ue(n,t),n.verifyArgs=function(e){if(oo("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!kC(e.kernelSize,"number",1,3))throw new Y("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(e.kernelSize)+".")},n.prototype.getConfig=function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:ri(this.activation),useBias:this.useBias,biasInitializer:Et(this.biasInitializer),biasRegularizer:et(this.biasRegularizer),activityRegularizer:et(this.activityRegularizer),biasConstraint:Dt(this.biasConstraint)},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n}(pt),fy=function(t){function n(e,r){var i=t.call(this,e,r)||this;return i.kernel=null,n.verifyArgs(r),i.filters=r.filters,wr(i.filters,"filters"),i.kernelInitializer=Gt(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=Cn(r.kernelConstraint),i.kernelRegularizer=qt(r.kernelRegularizer),i}return ue(n,t),n.prototype.build=function(e){var r;e=Lt(e);var i=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[i]==null)throw new Y("The channel dimension of the input should be defined. Found "+e[i]);var o=e[i],a=this.kernelSize.concat([o,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(r={},r[i]=o,r)}],this.built=!0},n.prototype.call=function(e,r){var i=this;return ee(function(){var o;e=Ye(e);var a=i.bias==null?null:i.bias.read(),s=XL(i.activation.getClassName());if(s!=null&&i.rank===2)o=Mk(e,i.kernel.read(),a,i.strides,i.padding,i.dataFormat,i.dilationRate,s);else{if(i.rank===1)o=yY(e,i.kernel.read(),a,i.strides[0],i.padding,i.dataFormat,i.dilationRate[0]);else if(i.rank===2)o=Mk(e,i.kernel.read(),a,i.strides,i.padding,i.dataFormat,i.dilationRate);else{if(i.rank!==3)throw new Xe("convolutions greater than 3D are not implemented yet.");o=bY(e,i.kernel.read(),a,i.strides,i.padding,i.dataFormat,i.dilationRate)}i.activation!=null&&(o=i.activation.apply(o))}return o})},n.prototype.computeOutputShape=function(e){e=Lt(e);for(var r=[],i=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2),o=0;o<i.length;++o){var a=Xo(i[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);r.push(a)}var s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(r)).push(this.filters):(s.push(this.filters),s=s.concat(r)),s},n.prototype.getConfig=function(){var e={filters:this.filters,kernelInitializer:Et(this.kernelInitializer),kernelRegularizer:et(this.kernelRegularizer),kernelConstraint:Dt(this.kernelConstraint)},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.verifyArgs=function(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new Y("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(e.filters))},n}(G3),GC=function(t){function n(e){var r=t.call(this,2,e)||this;return n.verifyArgs(e),r}return ue(n,t),n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},n.verifyArgs=function(e){if(typeof e.kernelSize!="number"&&!kC(e.kernelSize,"number",1,2))throw new Y("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(e.kernelSize)+".")},n.className="Conv2D",n}(fy);he.registerClass(GC);var q3=function(t){function n(e){var r=t.call(this,3,e)||this;return n.verifyArgs(e),r}return ue(n,t),n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},n.verifyArgs=function(e){if(typeof e.kernelSize!="number"&&(!Array.isArray(e.kernelSize)||e.kernelSize.length!==1&&e.kernelSize.length!==3))throw new Y("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(e.kernelSize)+".")},n.className="Conv3D",n}(fy);he.registerClass(q3);var K3=function(t){function n(e){var r=t.call(this,e)||this;if(r.inputSpec=[new Fn({ndim:4})],r.padding!=="same"&&r.padding!=="valid")throw new Y("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+r.padding);return r}return ue(n,t),n.prototype.build=function(e){var r;if((e=Lt(e)).length!==4)throw new Y("Input should have rank 4; Received input shape: "+JSON.stringify(e));var i=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[i]==null)throw new Y("The channel dimension of the inputs should be defined. Found `None`.");var o=e[i],a=this.kernelSize.concat([this.filters,o]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fn({ndim:4,axes:(r={},r[i]=o,r)})],this.built=!0},n.prototype.call=function(e,r){var i=this;return ee(function(){var o=Ye(e);if(o.shape.length!==4)throw new Y("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+o.shape.length);var a,s,u=o.shape,l=u[0];i.dataFormat==="channelsFirst"?(a=2,s=3):(a=1,s=2);var c=u[a],d=u[s],f=i.kernelSize[0],p=i.kernelSize[1],h=i.strides[0],v=i.strides[1],g=[l,kh(c,h,f,i.padding),kh(d,v,p,i.padding),i.filters];i.dataFormat!=="channelsLast"&&(o=en(o,[0,2,3,1]));var m=Vg(o,i.kernel.read(),g,i.strides,i.padding);return i.dataFormat!=="channelsLast"&&(m=en(m,[0,3,1,2])),i.bias!=null&&(m=fa(m,i.bias.read(),i.dataFormat)),i.activation!=null&&(m=i.activation.apply(m)),m})},n.prototype.computeOutputShape=function(e){var r,i,o,a=(e=Lt(e)).slice();this.dataFormat==="channelsFirst"?(r=1,i=2,o=3):(r=3,i=1,o=2);var s=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return a[r]=this.filters,a[i]=kh(a[i],l,s,this.padding),a[o]=kh(a[o],c,u,this.padding),a},n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.dilationRate,e},n.className="Conv2DTranspose",n}(GC);he.registerClass(K3);var wY=function(t){function n(e,r){var i=t.call(this,e,r)||this;if(i.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",i.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",i.depthwiseKernel=null,i.pointwiseKernel=null,r.filters==null)throw new Y("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new Y("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new Y("SeparableConv"+i.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(r.padding));return i.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,i.depthwiseInitializer=Gt(r.depthwiseInitializer||i.DEFAULT_DEPTHWISE_INITIALIZER),i.depthwiseRegularizer=qt(r.depthwiseRegularizer),i.depthwiseConstraint=Cn(r.depthwiseConstraint),i.pointwiseInitializer=Gt(r.depthwiseInitializer||i.DEFAULT_POINTWISE_INITIALIZER),i.pointwiseRegularizer=qt(r.pointwiseRegularizer),i.pointwiseConstraint=Cn(r.pointwiseConstraint),i}return ue(n,t),n.prototype.build=function(e){var r;if((e=Lt(e)).length<this.rank+2)throw new Y("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(e));var i=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[i]==null||e[i]<0)throw new Y("The channel dimension of the inputs should be defined, but found "+JSON.stringify(e[i]));for(var o=e[i],a=this.kernelSize.concat([o,this.depthMultiplier]),s=[],u=0;u<this.rank;++u)s.push(1);s.push(o*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new Fn({ndim:this.rank+2,axes:(r={},r[i]=o,r)})],this.built=!0},n.prototype.call=function(e,r){var i=this;return ee(function(){var o;if(e=Ye(e),i.rank===1)throw new Xe("1D separable convolution is not implemented yet.");return i.rank===2&&(i.dataFormat==="channelsFirst"&&(e=en(e,[0,2,3,1])),o=rC(e,i.depthwiseKernel.read(),i.pointwiseKernel.read(),i.strides,i.padding,i.dilationRate,"NHWC")),i.useBias&&(o=fa(o,i.bias.read(),i.dataFormat)),i.activation!=null&&(o=i.activation.apply(o)),i.dataFormat==="channelsFirst"&&(o=en(o,[0,3,1,2])),o})},n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Et(this.depthwiseInitializer),e.pointwiseInitializer=Et(this.pointwiseInitializer),e.depthwiseRegularizer=et(this.depthwiseRegularizer),e.pointwiseRegularizer=et(this.pointwiseRegularizer),e.depthwiseConstraint=Dt(this.depthwiseConstraint),e.pointwiseConstraint=Dt(this.pointwiseConstraint),e},n.className="SeparableConv",n}(fy),X3=function(t){function n(e){return t.call(this,2,e)||this}return ue(n,t),n.className="SeparableConv2D",n}(wY);he.registerClass(X3);var Y3=function(t){function n(e){var r=t.call(this,1,e)||this;return n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return ue(n,t),n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.dataFormat,e},n.verifyArgs=function(e){if(typeof e.kernelSize!="number"&&!kC(e.kernelSize,"number",1,1))throw new Y("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(e.kernelSize)+".")},n.className="Conv1D",n}(fy);he.registerClass(Y3);var J3=function(t){function n(e){var r=t.call(this,e)||this;return typeof e.cropping=="number"?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return ue(n,t),n.prototype.computeOutputShape=function(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]},n.prototype.call=function(e,r){var i=this;return ee(function(){return e=Ye(e),i.dataFormat==="channelsLast"?Rh(Rh(e,i.cropping[0][0],e.shape[1]-i.cropping[0][0]-i.cropping[0][1],2),i.cropping[1][0],e.shape[2]-i.cropping[1][1]-i.cropping[1][0],3):Rh(Rh(e,i.cropping[0][0],e.shape[2]-i.cropping[0][0]-i.cropping[0][1],3),i.cropping[1][0],e.shape[3]-i.cropping[1][1]-i.cropping[1][0],4)})},n.prototype.getConfig=function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="Cropping2D",n}(pt);he.registerClass(J3);var Q3=function(t){function n(e){var r=t.call(this,e)||this;return r.DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=e.size==null?r.DEFAULT_SIZE:e.size,r.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,r}return ue(n,t),n.prototype.computeOutputShape=function(e){if(this.dataFormat==="channelsFirst"){var r=e[2]==null?null:this.size[0]*e[2],i=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],r,i]}return r=e[1]==null?null:this.size[0]*e[1],i=e[2]==null?null:this.size[1]*e[2],[e[0],r,i,e[3]]},n.prototype.call=function(e,r){var i=this;return ee(function(){var o=Ye(e),a=o.shape;if(i.dataFormat==="channelsFirst"){o=en(o,[0,2,3,1]);var s=i.size[0]*a[2],u=i.size[1]*a[3],l=o.resizeNearestNeighbor([s,u]);return en(l,[0,3,1,2])}return s=i.size[0]*a[1],u=i.size[1]*a[2],o.resizeNearestNeighbor([s,u])})},n.prototype.getConfig=function(){var e={size:this.size,dataFormat:this.dataFormat},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="UpSampling2D",n}(pt);function xY(t,n,e,r,i,o){return e===void 0&&(e=[1,1]),r===void 0&&(r="valid"),ee(function(){i==null&&(i=Ui()),Tn(i);var a=HC(t,i);if(t.rank!==4)throw new Y("Input for depthwiseConv2d is required to be 4-D, but is instead "+t.rank+"-D");if(n.rank!==4)throw new Y("depthwiseKernel is required to be 4-D, but is instead "+n.rank+"-D");return a=Ac(a,n,e,r==="same"?"same":"valid","NHWC",o),i==="channelsFirst"&&(a=en(a,[0,3,1,2])),a})}he.registerClass(Q3);var Z3=function(t){function n(e){var r=t.call(this,2,e)||this;return r.depthwiseKernel=null,r.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,r.depthwiseInitializer=Gt(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=Cn(e.depthwiseConstraint),r.depthwiseRegularizer=qt(e.depthwiseRegularizer),r}return ue(n,t),n.prototype.build=function(e){if((e=Lt(e)).length<4)throw new Y("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(e)+".");var r=this.dataFormat==="channelsFirst"?1:3;if(e[r]==null||e[r]<0)throw new Y("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+e[r]+").");var i=e[r],o=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",o,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},n.prototype.call=function(e,r){var i=this;return ee(function(){var o=xY(e=Ye(e),i.depthwiseKernel.read(),i.strides,i.padding,i.dataFormat,null);return i.useBias&&(o=fa(o,i.bias.read(),i.dataFormat)),i.activation!=null&&(o=i.activation.apply(o)),o})},n.prototype.computeOutputShape=function(e){e=Lt(e);var r=this.dataFormat==="channelsFirst"?e[2]:e[1],i=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=Xo(r,this.kernelSize[0],this.padding,this.strides[0]),s=Xo(i,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],o,a,s]:[e[0],a,s,o]},n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Et(this.depthwiseInitializer),e.depthwiseRegularizer=et(this.depthwiseRegularizer),e.depthwiseConstraint=Dt(this.depthwiseRegularizer),e},n.className="DepthwiseConv2D",n}(G3);he.registerClass(Z3);var e4=function(t){function n(e){var r=t.call(this,e)||this;return r.rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return ue(n,t),n.prototype.getNoiseShape=function(e){if(this.noiseShape==null)return this.noiseShape;for(var r=e.shape,i=[],o=0;o<this.noiseShape.length;++o)i.push(this.noiseShape[o]==null?r[o]:this.noiseShape[o]);return i},n.prototype.call=function(e,r){var i=this;return ee(function(){i.invokeCallHook(e,r);var o=Ye(e);if(0<i.rate&&i.rate<1){var a=r.training!=null&&r.training,s=i.getNoiseShape(o);return sc(function(){return s3(o,i.rate,s,i.seed)},function(){return o},a)}return e})},n.prototype.getConfig=function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.prototype.dispose=function(){return t.prototype.dispose.call(this)},n.className="Dropout",n}(pt);he.registerClass(e4);var t4=function(t){function n(e){var r=t.call(this,e)||this;if(r.activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){var i=null;e.batchSize!=null&&(i=e.batchSize),r.batchInputShape=[i,e.inputDim]}return r.units=e.units,wr(r.units,"units"),r.activation=cs(e.activation),e.useBias!=null&&(r.useBias=e.useBias),r.kernelInitializer=Gt(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=Gt(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=Cn(e.kernelConstraint),r.biasConstraint=Cn(e.biasConstraint),r.kernelRegularizer=qt(e.kernelRegularizer),r.biasRegularizer=qt(e.biasRegularizer),r.activityRegularizer=qt(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return ue(n,t),n.prototype.build=function(e){var r,i=(e=Lt(e))[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[i,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(r={},r[-1]=i,r)}],this.built=!0},n.prototype.computeOutputShape=function(e){var r=(e=Lt(e)).slice();return r[r.length-1]=this.units,r},n.prototype.call=function(e,r){var i=this;return ee(function(){i.invokeCallHook(e,r);var o,a=Ye(e),s=XL(i.activation.getClassName());return s!=null?o=Ko(a,i.kernel.read(),s,i.bias?i.bias.read():null):(o=Ko(a,i.kernel.read()),i.bias!=null&&(o=fa(o,i.bias.read())),i.activation!=null&&(o=i.activation.apply(o))),o})},n.prototype.getConfig=function(){var e={units:this.units,activation:ri(this.activation),useBias:this.useBias,kernelInitializer:Et(this.kernelInitializer),biasInitializer:Et(this.biasInitializer),kernelRegularizer:et(this.kernelRegularizer),biasRegularizer:et(this.biasRegularizer),activityRegularizer:et(this.activityRegularizer),kernelConstraint:Dt(this.kernelConstraint),biasConstraint:Dt(this.biasConstraint)},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="Dense",n}(pt);he.registerClass(t4);var n4=function(t){function n(e){var r=t.call(this,e||{})||this;return r.inputSpec=[{minNDim:3}],r}return ue(n,t),n.prototype.computeOutputShape=function(e){for(var r=0,i=(e=Lt(e)).slice(1);r<i.length;r++)if(i[r]==null)throw new Y('The shape of the input to "Flatten" is not fully defined (got '+e.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],ts(e,1)]},n.prototype.call=function(e,r){var i=this;return ee(function(){return i.invokeCallHook(e,r),NK(Ye(e))})},n.className="Flatten",n}(pt);he.registerClass(n4);var r4=function(t){function n(e){var r=t.call(this,e)||this;return r.supportsMasking=!0,r.activation=cs(e.activation),r}return ue(n,t),n.prototype.call=function(e,r){var i=this;return ee(function(){i.invokeCallHook(e,r);var o=Ye(e);return i.activation.apply(o)})},n.prototype.getConfig=function(){var e={activation:ri(this.activation)},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="Activation",n}(pt);he.registerClass(r4);var i4=function(t){function n(e){var r=t.call(this,e)||this;return r.n=e.n,r.inputSpec=[{ndim:2}],r}return ue(n,t),n.prototype.computeOutputShape=function(e){return[e[0],this.n,e[1]]},n.prototype.call=function(e,r){var i=this;return ee(function(){return RK(e=Ye(e),i.n)})},n.prototype.getConfig=function(){var e={n:this.n},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="RepeatVector",n}(pt);he.registerClass(i4);var o4=function(t){function n(e){var r=t.call(this,e)||this;r.targetShape=e.targetShape;for(var i=0;i<r.targetShape.length;++i)r.isUnknown(r.targetShape[i])&&(r.targetShape[i]=null);return r}return ue(n,t),n.prototype.isUnknown=function(e){return e<0||e==null},n.prototype.fixUnknownDimension=function(e,r){for(var i="Total size of new array must be unchanged.",o=r.slice(),a=1,s=null,u=0;u<o.length;++u){var l=o[u];if(this.isUnknown(l)){if(s!==null)throw new Y("Can only specifiy one unknown dimension.");s=u}else a*=l}var c=ts(e);if(s!==null){if(a===0||c%a!=0)throw new Y(i);o[s]=c/a}else if(c!==a)throw new Y(i);return o},n.prototype.computeOutputShape=function(e){for(var r=!1,i=0;i<e.length;++i)if(this.isUnknown(e[i])){r=!0;break}return r?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))},n.prototype.call=function(e,r){var i=this;return ee(function(){i.invokeCallHook(e,r);var o=Ye(e),a=o.shape,s=a.slice(0,1).concat(i.fixUnknownDimension(a.slice(1),i.targetShape));return o.reshape(s)})},n.prototype.getConfig=function(){var e={targetShape:this.targetShape},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="Reshape",n}(pt);he.registerClass(o4);var a4=function(t){function n(e){var r=t.call(this,e)||this;if(e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+e.dims+" instead.");var i=Wi(1,e.dims.length+1);if(!Fe.arraysEqual(e.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Fn({ndim:r.dims.length+1})],r}return ue(n,t),n.prototype.computeOutputShape=function(e){var r=(e=Lt(e)).slice();return this.dims.forEach(function(i,o){r[o+1]=e[i]}),r},n.prototype.call=function(e,r){return en(Ye(e),this.dimsIncludingBatch)},n.prototype.getConfig=function(){var e={dims:this.dims},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="Permute",n}(pt);he.registerClass(a4);var s4=function(t){function n(e){var r=t.call(this,e??{})||this;return r.supportsMasking=!0,r.maskValue=e!=null?e.maskValue==null?0:e.maskValue:0,r}return ue(n,t),n.prototype.computeOutputShape=function(e){return e},n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),r={maskValue:this.maskValue};return Object.assign(r,e),r},n.prototype.computeMask=function(e,r){var i=Ye(e);return jf(nc(i,this.maskValue),-1)},n.prototype.call=function(e,r){var i=this;return ee(function(){i.invokeCallHook(e,r);var o=Ye(e),a=jf(nc(o,i.maskValue),-1,!0);return o.mul(a.asType(o.dtype))})},n.className="Masking",n}(pt);he.registerClass(s4);var u4=function(t){function n(e){var r=t.call(this,e)||this;if(r.embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){var i=null;e.batchSize!=null&&(i=e.batchSize),e.inputLength==null?r.batchInputShape=[i,null]:r.batchInputShape=[i].concat(zt(e.inputLength))}return r.inputDim=e.inputDim,wr(r.inputDim,"inputDim"),r.outputDim=e.outputDim,wr(r.outputDim,"outputDim"),r.embeddingsInitializer=Gt(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=qt(e.embeddingsRegularizer),r.activityRegularizer=qt(e.activityRegularizer),r.embeddingsConstraint=Cn(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return ue(n,t),n.prototype.build=function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},n.prototype.warnOnIncompatibleInputShape=function(e){},n.prototype.computeMask=function(e,r){var i=this;return ee(function(){return i.maskZero?(e=Ye(e),nc(e,dt(e))):null})},n.prototype.computeOutputShape=function(e){if(e=Lt(e),this.inputLength==null)return e.concat([this.outputDim]);var r=zt(this.inputLength);if(r.length!==e.length-1)throw new Y('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);for(var i=0,o=0;o<r.length;++o){var a=r[o],s=e[o+1];if(a!=null&&s!=null&&a!==s)throw new Y('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);a==null&&(r[i]=s),i++}return[e[0]].concat(r,[this.outputDim])},n.prototype.call=function(e,r){var i=this;return ee(function(){i.invokeCallHook(e,r);var o=Ye(e);return o.dtype!=="int32"&&(o=xp(o,"int32")),a3(i.embeddings.read(),o.as1D()).reshape(Lt(i.computeOutputShape(o.shape)))})},n.prototype.getConfig=function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Et(this.embeddingsInitializer),embeddingsRegularizer:et(this.embeddingsRegularizer),activityRegularizer:et(this.activityRegularizer),embeddingsConstraint:Dt(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="Embedding",n}(pt);he.registerClass(u4);var _u=function(t){function n(e){var r=t.call(this,e||{})||this;return r.supportsMasking=!0,r}return ue(n,t),n.prototype.mergeFunction=function(e){throw new Xe},n.prototype.computeElementwiseOpOutputShape=function(e,r){if(e==null||r==null)return null;if(e.length<r.length)return this.computeElementwiseOpOutputShape(r,e);if(r.length===0)return e;for(var i=e.slice(0,e.length-r.length),o=0;o<r.length;++o){var a=e[e.length-r.length+o],s=r[o];if(a==null||s==null||a<0||s<0)i.push(null);else if(a===1)i.push(s);else if(s===1)i.push(a);else{if(a!==s)throw new Y("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(r));i.push(a)}}return i},n.prototype.build=function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Lt(e)]),(e=e).length<2)throw new Y("A merge layer should be called on an Array of at least 2 inputs. Got "+e.length+" input(s).");for(var r=[],i=0,o=e;i<o.length;i++)(u=o[i])!=null&&u[0]!==null&&r.push(u[0]);if((r=es(r)).length>1)throw new Y("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(e)+".");for(var a=e[0]==null?null:e[0].slice(1),s=1;s<e.length;++s){var u=e[s]==null?null:e[s].slice(1);a=this.computeElementwiseOpOutputShape(a,u)}var l=e.map(function(c){return c.length});e.indexOf(null)===-1&&es(l).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},n.prototype.call=function(e,r){var i=this;return ee(function(){if(e=e,i.reshapeRequired){var o=[],a=e.map(function(S){return S.rank});if(a.indexOf(null)===-1){for(var s=ls(a),u=0,l=e;u<l.length;u++){for(var c=(v=l[u]).rank,d=0;d<s-c;++d)v=Sp(v,1);o.push(v)}return i.mergeFunction(o)}for(var f=!1,p=0,h=e;p<h.length;p++){var v;if((c=(v=h[p]).rank)==null){var g=v.shape,m=g[0],y=g.slice(1).concat([m]),b=v.reshape([m].concat(ts(g.slice(1))));b=(b=en(b,[1,0])).reshape(y),o.push(b),f=!0}else if(c>1){var w=Wi(1,c).concat([0]);o.push(en(v,w)),f=!0}else o.push(v)}var x=i.mergeFunction(o),C=x.rank;if(f)if(C==null){var E=x.shape;y=[m=E[E.length-1]].concat(E.slice(0,E.length-1)),x=en(x.reshape([-1,m]),[1,0]).reshape(y)}else C>1&&(w=[C-1].concat(Wi(0,C-1)),x=en(x,w));return x}return i.mergeFunction(e)})},n.prototype.computeOutputShape=function(e){var r;r=(e=e)[0]==null?null:e[0].slice(1);for(var i=1;i<e.length;++i){var o=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}for(var a=[],s=0,u=e;s<u.length;s++)(o=u[s])!=null&&o[0]!==null&&a.push(o[0]);return r=(a=es(a)).length===1?a.concat(r):[null].concat(r)},n.prototype.computeMask=function(e,r){return ee(function(){if(r==null)return null;if(!Array.isArray(r))throw new Y("`mask` should be an Array");if(!Array.isArray(e))throw new Y("`inputs` should be an Array");if(r.length!==e.length)throw new Y("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+e.length+" vs "+r.length+")");if(r.every(function(a){return a==null}))return null;for(var i=(r=r.map(function(a){return a==null?a:Hr(a,0)}))[0],o=1;o<r.length-1;++o)i=la(i,r[o]);return i})},n}(pt),l4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.mergeFunction=function(e){return ee(function(){for(var r=e[0].clone(),i=1;i<e.length;++i)r=st(r,e[i]);return r})},n.className="Add",n}(_u);he.registerClass(l4);var c4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.mergeFunction=function(e){return ee(function(){for(var r=e[0].clone(),i=1;i<e.length;++i)r=We(r,e[i]);return r})},n.className="Multiply",n}(_u);he.registerClass(c4);var d4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.mergeFunction=function(e){return ee(function(){for(var r=e[0].clone(),i=1;i<e.length;++i)r=st(r,e[i]);return We(1/e.length,r)})},n.className="Average",n}(_u);he.registerClass(d4);var f4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.mergeFunction=function(e){return ee(function(){for(var r=e[0],i=1;i<e.length;++i)r=To(r,e[i]);return r})},n.className="Maximum",n}(_u);he.registerClass(f4);var p4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.mergeFunction=function(e){return ee(function(){for(var r=e[0],i=1;i<e.length;++i)r=kc(r,e[i]);return r})},n.className="Minimum",n}(_u);he.registerClass(p4);var h4=function(t){function n(e){var r=t.call(this,e)||this;return r.DEFAULT_AXIS=-1,e==null&&(e={}),r.axis=e.axis==null?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return ue(n,t),n.prototype.build=function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||e.length===1)throw new Y("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var r=!0,i=0,o=e=e;i<o.length;i++)if((f=o[i])!=null){r=!1;break}if(!r){for(var a=[],s=0;s<e.length;++s){var u=e[s].slice();u.splice(this.axis,1);for(var l=!1,c=0,d=a;c<d.length;c++){var f=d[c];if(Fe.arraysEqual(f,u)){l=!0;break}}l||a.push(u)}if(a.length>1)throw new Y("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}},n.prototype.mergeFunction=function(e){var r=this;return ee(function(){return o3(e,r.axis)})},n.prototype.computeOutputShape=function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Y("A `Concatenate` layer should be called on a list of inputs.");for(var r=e,i=r[0].slice(),o=this.axis<0?i.length+this.axis:this.axis,a=0,s=r.slice(1);a<s.length;a++){var u=s[a];if(i[o]==null||u[o]==null){i[o]=null;break}i[o]+=u[o]}return i},n.prototype.computeMask=function(e,r){var i=this;if(r==null)return null;if(!Array.isArray(r))throw new Y("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Y("`inputs` should be an array for Concatenate");if(r.length!==e.length)throw new Y("Mismatch in the length of mask ("+r.length+") and the legnth of inputs ("+e.length+")");return ee(function(){var o=!0;if(r.forEach(function(l){l==null||(o=!1)}),o)return null;for(var a=[],s=0;s<e.length;++s)r[s]==null?a.push(ti(e[s]).asType("bool")):r[s].rank<e[s].rank?a.push(Hr(r[s],-1)):a.push(r[s]);var u=lr(a,i.axis);return Kg(u,-1,!1)})},n.prototype.getConfig=function(){var e={axis:this.axis},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="Concatenate",n}(_u);function dd(t,n){for(;t<0;)t+=n;return t}function SY(t,n,e){if(t.shape.length>3||n.shape.length>3)throw new Xe("batchDot is not implemented for tensors of 4D or higher rank yet");if(Fe.assert(t.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+t.shape.length}),Fe.assert(t.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+n.shape.length}),typeof e=="number"&&(e=[e,e]),t.dtype==="complex64"||n.dtype==="complex64")throw new Xe("batchDot is not implemented for complex64-type Tensors yet.");var r=t.shape.length,i=n.shape.length;e==null&&(e=[r-1,i-2]);var o=e;return ee(function(){var a,s;if(r>i){a=r-i;for(var u=[],l=0;l<a;++l)u.push(1);n=n.reshape(n.shape.concat(u))}else if(i>r){for(a=i-r,u=[],l=0;l<a;++l)u.push(1);t=t.reshape(t.shape.concat(u))}else a=0;if(t.shape.length===2&&n.shape.length===2)s=o[0]===o[1]?t.mulStrict(n).sum(o[0]):t.transpose([1,0]).mulStrict(n).sum(o[1]);else{var c=o[0]!==t.shape.length-1,d=o[1]===n.shape.length-1;s=t.matMul(n,c,d)}if(a>0){var f=void 0,p=[];for(l=f=r>i?r+i-3:r-1;l<f+a;++l)p.push(l);s=s.squeeze(p)}return s.shape.length===1&&(s=s.expandDims(1)),s})}he.registerClass(h4);var m4=function(t){function n(e){var r=t.call(this,e)||this;return r.axes=e.axes,r.normalize=e.normalize!=null&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return ue(n,t),n.prototype.build=function(e){Fe.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=e[0],i=e[1];if(r.length>3||i.length>3)throw new Xe("Dot layer does not support tensors of 4D or higher rank yet.");var o=this.interpretAxes(r,i);if(r[o[0]]!==i[o[1]])throw new Y("Dimension incompatibility: "+r[o[0]]+" !== "+i[o[1]])},n.prototype.mergeFunction=function(e){if(e.length!==2)throw new Y("A `Dot` layer must be called on exactly 2 inputs, but received "+e.length+" input(s).");var r,i=e[0],o=e[1];return r=Array.isArray(this.axes)?this.axes.map(function(a,s){return dd(a,e[s].shape.length)}):[dd(this.axes,i.shape.length),dd(this.axes,o.shape.length)],this.normalize&&(i=Sv(i,r[0]),o=Sv(o,r[1])),SY(i,o,r)},n.prototype.interpretAxes=function(e,r){return Array.isArray(this.axes)?this.axes:[dd(this.axes,e.length),dd(this.axes,r.length)]},n.prototype.computeOutputShape=function(e){Fe.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=e[0].slice(),i=e[1].slice();if(r.length>3||i.length>3)throw new Xe("Dot layer does not support tensors of 4D or higher rank yet.");var o=this.interpretAxes(r,i);r.splice(o[0],1),i.splice(o[1],1),i.splice(0,1);var a=r.concat(i);return a.length===1&&a.push(1),a},n.prototype.computeMask=function(e,r){return null},n.prototype.getConfig=function(){var e={axes:this.axes,normalize:this.normalize},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="Dot",n}(_u);he.registerClass(m4);var v4=function(t){function n(e){var r=t.call(this,e)||this;return r.supportsMasking=!0,r.stddev=e.stddev,r}return ue(n,t),n.prototype.computeOutputShape=function(e){return e},n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),r={stddev:this.stddev};return Object.assign(r,e),r},n.prototype.call=function(e,r){var i=this;return ee(function(){i.invokeCallHook(e,r);var o=Ye(e);return sc(function(){return oy(o.shape,0,i.stddev).add(o)},function(){return o},r.training||!1)})},n.className="GaussianNoise",n}(pt);he.registerClass(v4);var g4=function(t){function n(e){var r=t.call(this,e)||this;return r.supportsMasking=!0,r.rate=e.rate,r}return ue(n,t),n.prototype.computeOutputShape=function(e){return e},n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,e),r},n.prototype.call=function(e,r){var i=this;return ee(function(){i.invokeCallHook(e,r);var o=Ye(e);return i.rate>0&&i.rate<1?sc(function(){var a=Math.sqrt(i.rate/(1-i.rate));return o.mul(oy(o.shape,1,a))},function(){return o},r.training||!1):o})},n.className="GaussianDropout",n}(pt);he.registerClass(g4);var y4=function(t){function n(e){var r=t.call(this,e)||this;return r.supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return ue(n,t),n.prototype._getNoiseShape=function(e){return this.noiseShape||Ye(e).shape},n.prototype.computeOutputShape=function(e){return e},n.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,e),r},n.prototype.call=function(e,r){var i=this;return ee(function(){if(i.rate<1&&i.rate>0){var o=i._getNoiseShape(e);return sc(function(){var a=Ye(e),s=-1.7580993408473766,u=fp(Cu(o),i.rate);u=xp(u,"float32");var l=Math.pow((1-i.rate)*(1+i.rate*Math.pow(s,2)),-.5),c=-l*s*i.rate;return a.mul(u).add(u.add(-1).mul(s)).mul(l).add(c)},function(){return Ye(e)},r.training||!1)}return e})},n.className="AlphaDropout",n}(pt);function Wf(t,n,e,r,i,o){var a;if(o===void 0&&(o=.001),t.rank===2)a=HE(t,n,e,r,i,o);else if(t.rank===3)a=GE(t,n,e,r,i,o);else{if(t.rank!==4)throw new Xe("batchNormalization is not implemented for array of rank "+t.rank+" yet");a=qE(t,n,e,r,i,o)}return a}function EY(t,n,e,r,i){return i===void 0&&(i=.001),ee(function(){var o=mp(t,r),a=o.mean,s=o.variance;return[Wf(t,a,s,e,n,i),a,s]})}function CY(t,n,e,r,i){return i===void 0&&(i=.001),ee(function(){for(var o=mp(t,r),a=o.mean,s=o.variance,u=[],l=0,c=Wi(0,t.rank);l<c.length;l++){var d=c[l];r.indexOf(d)!==-1?u.push(1):u.push(t.shape[d])}var f=a.reshape(u),p=s.reshape(u),h=n==null?null:n.reshape(u),v=e==null?null:e.reshape(u);return[Wf(t,f,p,v,h,i),a,s]})}function RY(t,n,e,r,i){return i===void 0&&(i=.001),Fe.arraysEqual(r.slice().sort(),Wi(0,t.rank-1))?EY(t,n,e,r,i):CY(t,n,e,r,i)}he.registerClass(y4);var b4=function(t){function n(e){var r=this;return e==null&&(e={}),(r=t.call(this,e)||this).supportsMasking=!0,r.axis=e.axis==null?-1:e.axis,r.momentum=e.momentum==null?.99:e.momentum,r.epsilon=e.epsilon==null?.001:e.epsilon,r.center=e.center==null||e.center,r.scale=e.scale==null||e.scale,r.betaInitializer=Gt(e.betaInitializer||"zeros"),r.gammaInitializer=Gt(e.gammaInitializer||"ones"),r.movingMeanInitializer=Gt(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=Gt(e.movingVarianceInitializer||"ones"),r.betaConstraint=Cn(e.betaConstraint),r.gammaConstraint=Cn(e.gammaConstraint),r.betaRegularizer=qt(e.betaRegularizer),r.gammaRegularizer=qt(e.gammaRegularizer),r}return ue(n,t),n.prototype.build=function(e){var r;e=Lt(e);var i=this.axis>=0?this.axis:this.axis+e.length,o=e[i];if(o==null)throw new Y("Axis "+i+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(e)+".");this.inputSpec=[new Fn({ndim:e.length,axes:(r={},r[i]=o,r)})];var a=[o];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0},n.prototype.call=function(e,r){var i=this;return ee(function(){var o=r.training!=null&&r.training,a=Ye(e),s=a.shape,u=s.length,l=Wi(0,u),c=i.axis>=0?i.axis:i.axis+u;l.splice(c,1);var d=pu(1,u);d[c]=s[c];var f=l.slice();f.sort();var p=!Fe.arraysEqual(f,Wi(0,u).slice(0,u-1));if(!o)return function(){if(p){var b=i.movingMean.read().reshape(d),w=i.movingVariance.read().reshape(d),x=i.center?i.beta.read().reshape(d):null,C=i.scale?i.gamma.read().reshape(d):null;return Wf(a,b,w,x,C,i.epsilon)}return Wf(a,i.movingMean.read(),i.movingVariance.read(),i.beta==null?null:i.beta.read(),i.gamma==null?null:i.gamma.read(),i.epsilon)}();var h=RY(a,i.gamma.read(),i.beta.read(),l,i.epsilon),v=h[0],g=h[1],m=h[2],y=function(b,w,x){ee(function(){var C=1-x,E=b.read(),S=E.sub(w).mul(C);b.write(E.sub(S))})};return y(i.movingMean,g,i.momentum),y(i.movingVariance,m,i.momentum),v})},n.prototype.getConfig=function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Et(this.betaInitializer),gammaInitializer:Et(this.gammaInitializer),movingMeanInitializer:Et(this.movingMeanInitializer),movingVarianceInitializer:Et(this.movingVarianceInitializer),betaRegularizer:et(this.betaRegularizer),gammaRegularizer:et(this.gammaRegularizer),betaConstraint:Dt(this.betaConstraint),gammaConstraint:Dt(this.gammaConstraint)},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="BatchNormalization",n}(pt);he.registerClass(b4);var w4=function(t){function n(e){var r=this;if(e==null&&(e={}),(r=t.call(this,e)||this).axis=e.axis==null?-1:e.axis,typeof r.axis=="number"){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received "+r.axis)}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(r.axis));for(var i=0,o=r.axis;i<o.length;i++){var a=o[i];if(!Number.isInteger(a))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(r.axis))}}return r.epsilon=e.epsilon==null?.001:e.epsilon,r.center=e.center==null||e.center,r.scale=e.scale==null||e.scale,r.betaInitializer=Gt(e.betaInitializer||"zeros"),r.gammaInitializer=Gt(e.gammaInitializer||"ones"),r.betaRegularizer=qt(e.betaRegularizer),r.gammaRegularizer=qt(e.gammaRegularizer),r.supportsMasking=!0,r}return ue(n,t),n.prototype.build=function(e){var r=(e=Lt(e)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(var o=0,a=this.axis;o<a.length;o++){var s=a[o];if(s<0||s>=r)throw new Error("Invalid axis: "+s)}if(this.axis.length!==es(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var u=this.axis.map(function(l){return e[l]});this.scale?this.gamma=this.addWeight("gamma",u,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",u,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},n.prototype.call=function(e,r){var i=this,o=Ye(e),a=o.shape,s=a.length;return ee(function(){for(var u=mp(o,i.axis,!0),l=u.mean,c=u.variance,d=pu(1,s),f=0,p=i.axis;f<p.length;f++){var h=p[f];d[h]=a[h]}for(var v=function(x){return x!=null&&x.shape.length!==s&&i.axis!==[s-1]?x.reshape(d):x},g=v(i.gamma.read()),m=v(i.beta.read()),y=[],b=[],w=0;w<s;++w)i.axis.indexOf(w)!==-1?(y.push(a[w]),b.push(1)):(y.push(1),b.push(a[w]));return l=l.tile(y),c=c.tile(y),g=g.tile(b),m=m.tile(b),Wf(o,l,c,m,g,i.epsilon)})},n.prototype.getConfig=function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Et(this.betaInitializer),gammaInitializer:Et(this.gammaInitializer),betaRegularizer:et(this.betaRegularizer),gammaRegularizer:et(this.gammaRegularizer)},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="LayerNormalization",n}(pt);function TY(t,n,e){return ee(function(){if(t.rank!==4)throw new Y("temporalPadding expects input tensor to be 4-D, but received a "+t.rank+"-D tensor.");if(n==null&&(n=[[1,1],[1,1]]),n.length!==2||n[0].length!==2||n[1].length!==2)throw new Y("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(e==null&&(e=Ui()),e!=="channelsLast"&&e!=="channelsFirst")throw new Y("Unknown data format: "+e+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r=e==="channelsFirst"?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],ys(t,r)})}he.registerClass(w4);var x4=function(t){function n(e){var r=this;if(e==null&&(e={}),(r=t.call(this,e)||this).dataFormat=e.dataFormat==null?Ui():e.dataFormat,e.padding==null)r.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new Y("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+e.padding.length+" array.");var i=void 0,o=void 0;if(typeof e.padding[0]=="number")i=[e.padding[0],e.padding[0]],o=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new Y("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+e.padding[0].length+" array.");if(i=e.padding[0],e.padding[1].length!==2)throw new Y("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+e.padding[1].length+" array.");o=e.padding[1]}r.padding=[i,o]}return r.inputSpec=[new Fn({ndim:4})],r}return ue(n,t),n.prototype.computeOutputShape=function(e){var r,i;return e=Lt(e),this.dataFormat==="channelsFirst"?(r=e[2]!=null&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,i=e[3]!=null&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],r,i]):(r=e[1]!=null&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,i=e[2]!=null&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],r,i,e[3]])},n.prototype.call=function(e,r){var i=this;return ee(function(){return TY(Ye(e),i.padding,i.dataFormat)})},n.prototype.getConfig=function(){var e={padding:this.padding,dataFormat:this.dataFormat},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="ZeroPadding2D",n}(pt);function py(t,n,e,r,i,o){return ee(function(){var a;Tn(i),e3(o),Ci(r),e==null&&(e=[1,1]),r==null&&(r="valid"),i==null&&(i=Ui()),o==null&&(o="max"),t=HC(t,i);var s=r==="same"?"same":"valid";return a=o==="max"?Ug(t,n,e,s):Wg(t,n,e,s),i==="channelsFirst"&&(a=en(a,[0,3,1,2])),a})}function S4(t,n,e,r,i,o){return ee(function(){var a;Tn(i),e3(o),Ci(r),e==null&&(e=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Ui()),o==null&&(o="max"),t=H3(t,i);var s=r==="same"?"same":"valid";return a=o==="max"?Hg(t,n,e,s):Gg(t,n,e,s),i==="channelsFirst"&&(a=en(a,[0,4,1,2,3])),a})}he.registerClass(x4);var E4=function(t){function n(e){var r=this;if(e.poolSize==null&&(e.poolSize=2),r=t.call(this,e)||this,typeof e.poolSize=="number")r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||e.poolSize.length!==1||typeof e.poolSize[0]!="number")throw new Y("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.poolSize));r.poolSize=e.poolSize}if(wr(r.poolSize,"poolSize"),e.strides==null)r.strides=r.poolSize;else if(typeof e.strides=="number")r.strides=[e.strides];else{if(!Array.isArray(e.strides)||e.strides.length!==1||typeof e.strides[0]!="number")throw new Y("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.strides));r.strides=e.strides}return wr(r.strides,"strides"),r.padding=e.padding==null?"valid":e.padding,Ci(r.padding),r.inputSpec=[new Fn({ndim:3})],r}return ue(n,t),n.prototype.computeOutputShape=function(e){var r=Xo((e=Lt(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],r,e[2]]},n.prototype.call=function(e,r){var i=this;return ee(function(){i.invokeCallHook(e,r),e=Sp(Ye(e),2);var o=i.poolingFunction(Ye(e),[i.poolSize[0],1],[i.strides[0],1],i.padding,"channelsLast");return ap(o,[2])})},n.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n}(pt),C4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.poolingFunction=function(e,r,i,o,a){return Tn(a),Ci(o),py(e,r,i,o,a,"max")},n.className="MaxPooling1D",n}(E4);he.registerClass(C4);var R4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.poolingFunction=function(e,r,i,o,a){return Tn(a),Ci(o),py(e,r,i,o,a,"avg")},n.className="AveragePooling1D",n}(E4);he.registerClass(R4);var T4=function(t){function n(e){var r=this;if(e.poolSize==null&&(e.poolSize=[2,2]),(r=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new Y("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+e.strides.length+".");r.strides=e.strides}else r.strides=[e.strides,e.strides];return wr(r.poolSize,"poolSize"),wr(r.strides,"strides"),r.padding=e.padding==null?"valid":e.padding,r.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Tn(r.dataFormat),Ci(r.padding),r.inputSpec=[new Fn({ndim:4})],r}return ue(n,t),n.prototype.computeOutputShape=function(e){e=Lt(e);var r=this.dataFormat==="channelsFirst"?e[2]:e[1],i=this.dataFormat==="channelsFirst"?e[3]:e[2];return r=Xo(r,this.poolSize[0],this.padding,this.strides[0]),i=Xo(i,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],r,i]:[e[0],r,i,e[3]]},n.prototype.call=function(e,r){var i=this;return ee(function(){return i.invokeCallHook(e,r),i.poolingFunction(Ye(e),i.poolSize,i.strides,i.padding,i.dataFormat)})},n.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n}(pt),N4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.poolingFunction=function(e,r,i,o,a){return Tn(a),Ci(o),py(e,r,i,o,a,"max")},n.className="MaxPooling2D",n}(T4);he.registerClass(N4);var k4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.poolingFunction=function(e,r,i,o,a){return Tn(a),Ci(o),py(e,r,i,o,a,"avg")},n.className="AveragePooling2D",n}(T4);he.registerClass(k4);var I4=function(t){function n(e){var r=this;if(e.poolSize==null&&(e.poolSize=[2,2,2]),(r=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new Y("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+e.strides.length+".");r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return wr(r.poolSize,"poolSize"),wr(r.strides,"strides"),r.padding=e.padding==null?"valid":e.padding,r.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Tn(r.dataFormat),Ci(r.padding),r.inputSpec=[new Fn({ndim:5})],r}return ue(n,t),n.prototype.computeOutputShape=function(e){e=Lt(e);var r=this.dataFormat==="channelsFirst"?e[2]:e[1],i=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[4]:e[3];return r=Xo(r,this.poolSize[0],this.padding,this.strides[0]),i=Xo(i,this.poolSize[1],this.padding,this.strides[1]),o=Xo(o,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],r,i,o]:[e[0],r,i,o,e[4]]},n.prototype.call=function(e,r){var i=this;return ee(function(){return i.invokeCallHook(e,r),i.poolingFunction(Ye(e),i.poolSize,i.strides,i.padding,i.dataFormat)})},n.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n}(pt),_4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.poolingFunction=function(e,r,i,o,a){return Tn(a),Ci(o),S4(e,r,i,o,a,"max")},n.className="MaxPooling3D",n}(I4);he.registerClass(_4);var A4=function(t){function n(e){return t.call(this,e)||this}return ue(n,t),n.prototype.poolingFunction=function(e,r,i,o,a){return Tn(a),Ci(o),S4(e,r,i,o,a,"avg")},n.className="AveragePooling3D",n}(I4);he.registerClass(A4);var O4=function(t){function n(e){var r=t.call(this,e)||this;return r.inputSpec=[new Fn({ndim:3})],r}return ue(n,t),n.prototype.computeOutputShape=function(e){return[e[0],e[2]]},n.prototype.call=function(e,r){throw new Xe},n}(pt),D4=function(t){function n(e){return t.call(this,e||{})||this}return ue(n,t),n.prototype.call=function(e,r){return ee(function(){var i=Ye(e);return gn(i,1)})},n.className="GlobalAveragePooling1D",n}(O4);he.registerClass(D4);var M4=function(t){function n(e){return t.call(this,e||{})||this}return ue(n,t),n.prototype.call=function(e,r){return ee(function(){var i=Ye(e);return us(i,1)})},n.className="GlobalMaxPooling1D",n}(O4);he.registerClass(M4);var P4=function(t){function n(e){var r=t.call(this,e)||this;return r.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Tn(r.dataFormat),r.inputSpec=[new Fn({ndim:4})],r}return ue(n,t),n.prototype.computeOutputShape=function(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]},n.prototype.call=function(e,r){throw new Xe},n.prototype.getConfig=function(){var e={dataFormat:this.dataFormat},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n}(pt),L4=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.call=function(e,r){var i=this;return ee(function(){var o=Ye(e);return i.dataFormat==="channelsLast"?gn(o,[1,2]):gn(o,[2,3])})},n.className="GlobalAveragePooling2D",n}(P4);he.registerClass(L4);var F4=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n.prototype.call=function(e,r){var i=this;return ee(function(){var o=Ye(e);return i.dataFormat==="channelsLast"?us(o,[1,2]):us(o,[2,3])})},n.className="GlobalMaxPooling2D",n}(P4);function z4(t,n,e,r){if(Array.isArray(t)){if(n!=null||e!=null)throw new Y("When inputs is an array, neither initialState or constants should be provided");r!=null&&(e=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(n=t.slice(1,t.length)),t=t[0]}function i(o){return o==null||Array.isArray(o)?o:[o]}return{inputs:t,initialState:n=i(n),constants:e=i(e)}}function B4(t,n,e,r,i,o,a,s){return r===void 0&&(r=!1),a===void 0&&(a=!1),s===void 0&&(s=!1),ee(function(){var u=n.shape.length;if(u<3)throw new Y("Input should be at least 3D, but is "+u+"D.");var l=[1,0].concat(Wi(2,u));if(n=en(n,l),o!=null)throw new Xe("The rnn() functoin of the deeplearn.js backend does not support constants yet.");a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=Hr(i,-1)),i=en(i,l)),r&&(n=So(n,0),i!=null&&(i=So(i,0)));var c,d,f=[],p=e,h=n.shape[0],v=du(n);i!=null&&(d=du(i));for(var g,m=function(b){var w=v[b],x=ee(function(){return t(w,p)});if(i==null)c=x[0],p=x[1];else{var C=ee(function(){var E=d[b],S=ti(E).sub(E);return{output:x[0].mul(E).addStrict(p[0].mul(S)),newStates:p.map(function(k,N){return x[1][N].mul(E).addStrict(k.mul(S))})}});c=C.output,p=C.newStates}s&&f.push(c)},y=0;y<h;++y)m(y);return s&&(g=$i(f,1)),[c,g,p]})}he.registerClass(F4);var Au=function(t){function n(e){var r,i=t.call(this,e)||this;if(e.cell==null)throw new Y("cell property is missing for the constructor of RNN.");if((r=Array.isArray(e.cell)?new YC({cells:e.cell}):e.cell).stateSize==null)throw new Y("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return i.cell=r,i.returnSequences=e.returnSequences!=null&&e.returnSequences,i.returnState=e.returnState!=null&&e.returnState,i.goBackwards=e.goBackwards!=null&&e.goBackwards,i._stateful=e.stateful!=null&&e.stateful,i.unroll=e.unroll!=null&&e.unroll,i.supportsMasking=!0,i.inputSpec=[new Fn({ndim:3})],i.stateSpec=null,i.states_=null,i.numConstants=null,i.keptStates=[],i}return ue(n,t),n.prototype.getStates=function(){return this.states_==null?Wi(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(e){return null}):this.states_},n.prototype.setStates=function(e){this.states_=e},n.prototype.computeOutputShape=function(e){Dw(e)&&(e=e[0]),e=e;var r=this.cell.stateSize;Array.isArray(r)||(r=[r]);var i,o=r[0];if(i=this.returnSequences?[e[0],e[1],o]:[e[0],o],this.returnState){for(var a=[],s=0,u=r;s<u.length;s++){var l=u[s];a.push([e[0],l])}return[i].concat(a)}return i},n.prototype.computeMask=function(e,r){var i=this;return ee(function(){Array.isArray(r)&&(r=r[0]);var o=i.returnSequences?r:null;if(i.returnState){var a=i.states.map(function(s){return null});return[o].concat(a)}return o})},Object.defineProperty(n.prototype,"states",{get:function(){if(this.states_==null){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[],i=0;i<e;++i)r.push(null);return r}return this.states_},set:function(e){this.states_=e},enumerable:!0,configurable:!0}),n.prototype.build=function(e){if(this.numConstants!=null)throw new Xe("Constants support is not implemented in RNN yet.");Dw(e)&&(e=e[0]),e=e;var r=this.stateful?e[0]:null,i=e[e.length-1];this.inputSpec[0]=new Fn({shape:[r,null,i]});var o,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),o=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!Fe.arraysEqual(this.stateSpec.map(function(s){return s.shape[s.shape.length-1]}),o))throw new Y("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=o.map(function(s){return new Fn({shape:[null,s]})});this.stateful&&this.resetStates()},n.prototype.resetStates=function(e,r){var i=this;r===void 0&&(r=!1),ee(function(){if(!i.stateful)throw new Fs("Cannot call resetStates() on an RNN Layer that is not stateful.");var o=i.inputSpec[0].shape[0];if(o==null)throw new Y("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(i.states_==null)Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return _t([o,c])}):i.states_=[_t([o,i.cell.stateSize])];else if(e==null)Ze(i.states_),i.keptStates!=null&&(Ze(i.keptStates),i.keptStates=[]),Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return _t([o,c])}):i.states_[0]=_t([o,i.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==i.states_.length)throw new Y("Layer "+i.name+" expects "+i.states_.length+" state(s), but it received "+e.length+" state value(s). Input received: "+e);r===!0?i.keptStates.push(i.states_.slice()):Ze(i.states_);for(var a=0;a<i.states_.length;++a){var s=e[a],u=Array.isArray(i.cell.stateSize)?i.cell.stateSize[a]:i.cell.stateSize,l=[o,u];if(!Fe.arraysEqual(s.shape,l))throw new Y("State "+a+" is incompatible with layer "+i.name+": expected shape="+l+", received shape="+s.shape);i.states_[a]=s}}i.states_=i.states_.map(function(c){return wo(c.clone())})})},n.prototype.apply=function(e,r){var i=r==null?null:r.initialState,o=r==null?null:r.constants;r==null&&(r={});var a=z4(e,i,o,this.numConstants);e=a.inputs,i=a.initialState,o=a.constants;var s=[],u=[];if(i!=null){r.initialState=i,s=s.concat(i),this.stateSpec=[];for(var l=0,c=i;l<c.length;l++){var d=c[l];this.stateSpec.push(new Fn({shape:d.shape}))}u=u.concat(this.stateSpec)}if(o!=null&&(r.constants=o,s=s.concat(o),this.numConstants=o.length),s[0]instanceof Pi){var f=[e].concat(s),p=this.inputSpec.concat(u),h=this.inputSpec;this.inputSpec=p;var v=t.prototype.apply.call(this,f,r);return this.inputSpec=h,v}return t.prototype.apply.call(this,e,r)},n.prototype.call=function(e,r){var i=this;return ee(function(){var o=r==null?null:r.mask,a=r==null?null:r.training,s=r==null?null:r.initialState;e=Ye(e),s==null&&(s=i.stateful?i.states_:i.getInitialState(e));var u=Array.isArray(i.cell.stateSize)?i.cell.stateSize.length:1;if(s.length!==u)throw new Y("RNN Layer has "+u+" state(s) but was passed "+s.length+" initial state(s).");i.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var l={training:a},c=B4(function(v,g){var m=i.cell.call([v].concat(g),l);return[m[0],m.slice(1)]},e,s,i.goBackwards,o,null,i.unroll,i.returnSequences),d=c[0],f=c[1],p=c[2];i.stateful&&i.resetStates(p,a);var h=i.returnSequences?f:d;return i.returnState?[h].concat(p):h})},n.prototype.getInitialState=function(e){var r=this;return ee(function(){var i=_t(e.shape);return i=Sp(i=Br(i,[1,2])),Array.isArray(r.cell.stateSize)?r.cell.stateSize.map(function(o){return o>1?Aw(i,[1,o]):i}):r.cell.stateSize>1?[Aw(i,[1,r.cell.stateSize])]:[i]})},Object.defineProperty(n.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),n.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)},n.prototype.getConfig=function(){var e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(e.numConstants=this.numConstants);var r=this.cell.getConfig();e.cell={className:this.cell.getClassName(),config:r};var i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},n.fromConfig=function(e,r,i){i===void 0&&(i={});var o=ji(r.cell,i);return new e(Object.assign(r,{cell:o}))},n.className="RNN",n}(pt);he.registerClass(Au);var Rp=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return ue(n,t),n}(pt),qC=function(t){function n(e){var r=t.call(this,e)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,wr(r.units,"units"),r.activation=cs(e.activation==null?r.DEFAULT_ACTIVATION:e.activation),r.useBias=e.useBias==null||e.useBias,r.kernelInitializer=Gt(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Gt(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Gt(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=qt(e.kernelRegularizer),r.recurrentRegularizer=qt(e.recurrentRegularizer),r.biasRegularizer=qt(e.biasRegularizer),r.kernelConstraint=Cn(e.kernelConstraint),r.recurrentConstraint=Cn(e.recurrentConstraint),r.biasConstraint=Cn(e.biasConstraint),r.dropout=ac([1,ls([0,e.dropout==null?0:e.dropout])]),r.recurrentDropout=ac([1,ls([0,e.recurrentDropout==null?0:e.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return ue(n,t),n.prototype.build=function(e){e=Lt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},n.prototype.call=function(e,r){var i=this;return ee(function(){if((e=e).length!==2)throw new Y("SimpleRNNCell expects 2 input Tensors, got "+e.length+".");var o=e[1];e=e[0];var a,s=r.training!=null&&r.training;0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=lc(function(){return ti(e)},i.dropout,s)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=lc(function(){return ti(o)},i.recurrentDropout,s));var u=i.dropoutMask,l=i.recurrentDropoutMask;a=Ko(u!=null?We(e,u):e,i.kernel.read()),i.bias!=null&&(a=fa(a,i.bias.read())),l!=null&&(o=We(o,l));var c=st(a,Ko(o,i.recurrentKernel.read()));return i.activation!=null&&(c=i.activation.apply(c)),[c,c]})},n.prototype.getConfig=function(){var e={units:this.units,activation:ri(this.activation),useBias:this.useBias,kernelInitializer:Et(this.kernelInitializer),recurrentInitializer:Et(this.recurrentInitializer),biasInitializer:Et(this.biasInitializer),kernelRegularizer:et(this.kernelRegularizer),recurrentRegularizer:et(this.recurrentRegularizer),biasRegularizer:et(this.biasRegularizer),activityRegularizer:et(this.activityRegularizer),kernelConstraint:Dt(this.kernelConstraint),recurrentConstraint:Dt(this.recurrentConstraint),biasConstraint:Dt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="SimpleRNNCell",n}(Rp);he.registerClass(qC);var j4=function(t){function n(e){return e.cell=new qC(e),t.call(this,e)||this}return ue(n,t),n.prototype.call=function(e,r){var i=this;return ee(function(){i.cell.dropoutMask!=null&&(Ze(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ze(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var o=r==null?null:r.mask,a=r==null?null:r.training,s=r==null?null:r.initialState;return t.prototype.call.call(i,e,{mask:o,training:a,initialState:s})})},Object.defineProperty(n.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),n.prototype.getConfig=function(){var e={units:this.units,activation:ri(this.activation),useBias:this.useBias,kernelInitializer:Et(this.kernelInitializer),recurrentInitializer:Et(this.recurrentInitializer),biasInitializer:Et(this.biasInitializer),kernelRegularizer:et(this.kernelRegularizer),recurrentRegularizer:et(this.recurrentRegularizer),biasRegularizer:et(this.biasRegularizer),activityRegularizer:et(this.activityRegularizer),kernelConstraint:Dt(this.kernelConstraint),recurrentConstraint:Dt(this.recurrentConstraint),biasConstraint:Dt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=t.prototype.getConfig.call(this);return delete r.cell,Object.assign(e,r),e},n.fromConfig=function(e,r){return new e(r)},n.className="SimpleRNN",n}(Au);he.registerClass(j4);var KC=function(t){function n(e){var r=t.call(this,e)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,wr(r.units,"units"),r.activation=cs(e.activation===void 0?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=cs(e.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=e.useBias==null||e.useBias,r.kernelInitializer=Gt(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Gt(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Gt(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=qt(e.kernelRegularizer),r.recurrentRegularizer=qt(e.recurrentRegularizer),r.biasRegularizer=qt(e.biasRegularizer),r.kernelConstraint=Cn(e.kernelConstraint),r.recurrentConstraint=Cn(e.recurrentConstraint),r.biasConstraint=Cn(e.biasConstraint),r.dropout=ac([1,ls([0,e.dropout==null?0:e.dropout])]),r.recurrentDropout=ac([1,ls([0,e.recurrentDropout==null?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return ue(n,t),n.prototype.build=function(e){var r=(e=Lt(e))[e.length-1];this.kernel=this.addWeight("kernel",[r,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},n.prototype.call=function(e,r){var i=this;return ee(function(){if((e=e).length!==2)throw new Y("GRUCell expects 2 input Tensors (inputs, h, c), got "+e.length+".");var o=r.training!=null&&r.training,a=e[1];e=e[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=lc(function(){return ti(e)},i.dropout,o,3)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=lc(function(){return ti(a)},i.recurrentDropout,o,3));var s,u,l,c=i.dropoutMask,d=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(e=We(e,c[0]));var f=Ko(e,i.kernel.read());i.useBias&&(f=fa(f,i.bias.read())),0<i.recurrentDropout&&i.recurrentDropout<1&&(a=We(a,d[0]));var p=i.recurrentKernel.read(),h=qo(p,[2*i.units,i.units],p.rank-1),v=h[0],g=h[1],m=Ko(a,v),y=qo(f,3,f.rank-1),b=y[0],w=y[1],x=y[2],C=qo(m,2,m.rank-1),E=C[0],S=C[1];s=i.recurrentActivation.apply(st(b,E)),u=i.recurrentActivation.apply(st(w,S));var k=Ko(We(u,a),g);l=i.activation.apply(st(x,k));var N=st(We(s,a),We(st(1,Tu(s)),l));return[N,N]})},n.prototype.getConfig=function(){var e={units:this.units,activation:ri(this.activation),recurrentActivation:ri(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Et(this.kernelInitializer),recurrentInitializer:Et(this.recurrentInitializer),biasInitializer:Et(this.biasInitializer),kernelRegularizer:et(this.kernelRegularizer),recurrentRegularizer:et(this.recurrentRegularizer),biasRegularizer:et(this.biasRegularizer),activityRegularizer:et(this.activityRegularizer),kernelConstraint:Dt(this.kernelConstraint),recurrentConstraint:Dt(this.recurrentConstraint),biasConstraint:Dt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="GRUCell",n}(Rp);he.registerClass(KC);var V4=function(t){function n(e){return e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new KC(e),t.call(this,e)||this}return ue(n,t),n.prototype.call=function(e,r){var i=this;return ee(function(){i.cell.dropoutMask!=null&&(Ze(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ze(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var o=r==null?null:r.mask,a=r==null?null:r.training,s=r==null?null:r.initialState;return t.prototype.call.call(i,e,{mask:o,training:a,initialState:s})})},Object.defineProperty(n.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),n.prototype.getConfig=function(){var e={units:this.units,activation:ri(this.activation),recurrentActivation:ri(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Et(this.kernelInitializer),recurrentInitializer:Et(this.recurrentInitializer),biasInitializer:Et(this.biasInitializer),kernelRegularizer:et(this.kernelRegularizer),recurrentRegularizer:et(this.recurrentRegularizer),biasRegularizer:et(this.biasRegularizer),activityRegularizer:et(this.activityRegularizer),kernelConstraint:Dt(this.kernelConstraint),recurrentConstraint:Dt(this.recurrentConstraint),biasConstraint:Dt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=t.prototype.getConfig.call(this);return delete r.cell,Object.assign(e,r),e},n.fromConfig=function(e,r){return r.implmentation===0&&(r.implementation=1),new e(r)},n.className="GRU",n}(Au);he.registerClass(V4);var XC=function(t){function n(e){var r=t.call(this,e)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,wr(r.units,"units"),r.activation=cs(e.activation===void 0?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=cs(e.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=e.useBias==null||e.useBias,r.kernelInitializer=Gt(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Gt(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Gt(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=qt(e.kernelRegularizer),r.recurrentRegularizer=qt(e.recurrentRegularizer),r.biasRegularizer=qt(e.biasRegularizer),r.kernelConstraint=Cn(e.kernelConstraint),r.recurrentConstraint=Cn(e.recurrentConstraint),r.biasConstraint=Cn(e.biasConstraint),r.dropout=ac([1,ls([0,e.dropout==null?0:e.dropout])]),r.recurrentDropout=ac([1,ls([0,e.recurrentDropout==null?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return ue(n,t),n.prototype.build=function(e){var r,i,o=(e=Lt(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[o,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,s=this.units;i=new((r=function(u){function l(){return u!==null&&u.apply(this,arguments)||this}return ue(l,u),l.prototype.apply=function(c,d){var f=a.apply([s]),p=new _C().apply([s]),h=a.apply([2*s]);return yk(yk(f,p),h)},l}(Xi)).className="CustomInit",r)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},n.prototype.call=function(e,r){var i=this;return ee(function(){var o=r.training!=null&&r.training;if((e=e).length!==3)throw new Y("LSTMCell expects 3 input Tensors (inputs, h, c), got "+e.length+".");var a=e[1],s=e[2];e=e[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=lc(function(){return ti(e)},i.dropout,o,4)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=lc(function(){return ti(a)},i.recurrentDropout,o,4));var u,l,c,d,f=i.dropoutMask,p=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(e=We(e,f[0]));var h=Ko(e,i.kernel.read());0<i.recurrentDropout&&i.recurrentDropout<1&&(a=We(a,p[0])),h=st(h,Ko(a,i.recurrentKernel.read())),i.useBias&&(h=fa(h,i.bias.read()));var v=qo(h,4,h.rank-1),g=v[0],m=v[1],y=v[2],b=v[3];u=i.recurrentActivation.apply(g),l=i.recurrentActivation.apply(m),c=st(We(l,s),We(u,i.activation.apply(y))),d=i.recurrentActivation.apply(b);var w=We(d,i.activation.apply(c));return[w,w,c]})},n.prototype.getConfig=function(){var e={units:this.units,activation:ri(this.activation),recurrentActivation:ri(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Et(this.kernelInitializer),recurrentInitializer:Et(this.recurrentInitializer),biasInitializer:Et(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:et(this.kernelRegularizer),recurrentRegularizer:et(this.recurrentRegularizer),biasRegularizer:et(this.biasRegularizer),activityRegularizer:et(this.activityRegularizer),kernelConstraint:Dt(this.kernelConstraint),recurrentConstraint:Dt(this.recurrentConstraint),biasConstraint:Dt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.className="LSTMCell",n}(Rp);he.registerClass(XC);var $4=function(t){function n(e){return e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new XC(e),t.call(this,e)||this}return ue(n,t),n.prototype.call=function(e,r){var i=this;return ee(function(){i.cell.dropoutMask!=null&&(Ze(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ze(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var o=r==null?null:r.mask,a=r==null?null:r.training,s=r==null?null:r.initialState;return t.prototype.call.call(i,e,{mask:o,training:a,initialState:s})})},Object.defineProperty(n.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),n.prototype.getConfig=function(){var e={units:this.units,activation:ri(this.activation),recurrentActivation:ri(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Et(this.kernelInitializer),recurrentInitializer:Et(this.recurrentInitializer),biasInitializer:Et(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:et(this.kernelRegularizer),recurrentRegularizer:et(this.recurrentRegularizer),biasRegularizer:et(this.biasRegularizer),activityRegularizer:et(this.activityRegularizer),kernelConstraint:Dt(this.kernelConstraint),recurrentConstraint:Dt(this.recurrentConstraint),biasConstraint:Dt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=t.prototype.getConfig.call(this);return delete r.cell,Object.assign(e,r),e},n.fromConfig=function(e,r){return r.implmentation===0&&(r.implementation=1),new e(r)},n.className="LSTM",n}(Au);he.registerClass($4);var YC=function(t){function n(e){var r=t.call(this,e)||this;return r.cells=e.cells,r}return ue(n,t),Object.defineProperty(n.prototype,"stateSize",{get:function(){for(var e=[],r=0,i=this.cells.slice().reverse();r<i.length;r++){var o=i[r];Array.isArray(o.stateSize)?e.push.apply(e,o.stateSize):e.push(o.stateSize)}return e},enumerable:!0,configurable:!0}),n.prototype.call=function(e,r){var i=this;return ee(function(){for(var o=(e=e).slice(1),a=[],s=0,u=i.cells.slice().reverse();s<u.length;s++){var l=u[s];Array.isArray(l.stateSize)?a.push(o.splice(0,l.stateSize.length)):a.push(o.splice(0,1))}a.reverse();for(var c,d=[],f=0;f<i.cells.length;++f)l=i.cells[f],o=a[f],c=f===0?[e[0]].concat(o):[c[0]].concat(o),c=l.call(c,r),d.push(c.slice(1));o=[];for(var p=0,h=d.slice().reverse();p<h.length;p++){var v=h[p];o.push.apply(o,v)}return[c[0]].concat(o)})},n.prototype.build=function(e){var r;Dw(e)&&(e=e[0]),e=e,this.cells.forEach(function(i,o){tu("RNNCell_"+o,function(){i.build(e),r=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,e=[e[0],r]})}),this.built=!0},n.prototype.getConfig=function(){for(var e=[],r=0,i=this.cells;r<i.length;r++){var o=i[r];e.push({className:o.getClassName(),config:o.getConfig()})}var a={cells:e},s=t.prototype.getConfig.call(this);return Object.assign(a,s),a},n.fromConfig=function(e,r,i){i===void 0&&(i={});for(var o=[],a=0,s=r.cells;a<s.length;a++){var u=s[a];o.push(ji(u,i))}return new e({cells:o})},Object.defineProperty(n.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var e=[],r=0,i=this.cells;r<i.length;r++){var o=i[r];e.push.apply(e,o.trainableWeights)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nonTrainableWeights",{get:function(){for(var e=[],r=0,i=this.cells;r<i.length;r++){var o=i[r];e.push.apply(e,o.nonTrainableWeights)}if(!this.trainable){for(var a=[],s=0,u=this.cells;s<u.length;s++)o=u[s],a.push.apply(a,o.trainableWeights);return a.concat(e)}return e},enumerable:!0,configurable:!0}),n.prototype.getWeights=function(){for(var e=[],r=0,i=this.cells;r<i.length;r++){var o=i[r];e.push.apply(e,o.weights)}return Mw(e)},n.prototype.setWeights=function(e){for(var r=[],i=0,o=this.cells;i<o.length;i++)for(var a=o[i],s=a.weights.length,u=e.splice(s),l=0;l<a.weights.length;++l)r.push([a.weights[l],u[l]]);FC(r)},n.className="StackedRNNCells",n}(Rp);function lc(t,n,e,r){function i(){return s3(t(),n)}if(e===void 0&&(e=null),r===void 0&&(r=1),r>1){for(var o=[],a=0;a<r;a++)o.push(sc(i,t,e));return o.map(function(s){return wo(s.clone())})}return wo(sc(i,t,e).clone())}he.registerClass(YC);var U4=function(t){function n(e){var r=t.call(this,e)||this;return r.layer=e.layer,r}return ue(n,t),n.prototype.build=function(e){this.built=!0},Object.defineProperty(n.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(e){this.layer!=null&&(this.layer.trainable=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),n.prototype.getWeights=function(){return this.layer.getWeights()},n.prototype.setWeights=function(e){this.layer.setWeights(e)},n.prototype.getConfig=function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)},n.fromConfig=function(e,r,i){i===void 0&&(i={});var o=ji(r.layer,i);delete r.layer;var a={layer:o};return Object.assign(a,r),new e(a)},n}(pt),W4=function(t){function n(e){var r=t.call(this,e)||this;return r.supportsMasking=!0,r}return ue(n,t),n.prototype.build=function(e){if((e=Lt(e)).length<3)throw new Y("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(e));this.inputSpec=[{shape:e}];var r=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),t.prototype.build.call(this,e)},n.prototype.computeOutputShape=function(e){var r=[(e=Lt(e))[0]].concat(e.slice(2)),i=this.layer.computeOutputShape(r),o=e[1];return[i[0],o].concat(i.slice(1))},n.prototype.call=function(e,r){var i=this;return ee(function(){return B4(function(o,a){return[Ye(i.layer.call(o,r)),[]]},e=Ye(e),[],!1,null,null,!1,!0)[1]})},n.className="TimeDistributed",n}(U4);function NY(t){Dc(xK,"BidirectionalMergeMode",t)}he.registerClass(W4);var kY="concat",H4=function(t){function n(e){var r=t.call(this,e)||this,i=e.layer.getConfig(),o={};o.className=e.layer.getClassName(),o.config=i,r.forwardLayer=ji(o),i.goBackwards=i.goBackwards!==!0;var a={};if(a.className=e.layer.getClassName(),a.config=i,r.backwardLayer=ji(a),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=e.mergeMode===void 0?kY:e.mergeMode,NY(r.mergeMode),e.weights)throw new Xe("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return ue(n,t),Object.defineProperty(n.prototype,"trainable",{get:function(){return this._trainable},set:function(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)},enumerable:!0,configurable:!0}),n.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},n.prototype.setWeights=function(e){var r=e.length,i=Math.floor(r/2);this.forwardLayer.setWeights(e.slice(0,i)),this.backwardLayer.setWeights(e.slice(i))},n.prototype.computeOutputShape=function(e){var r,i,o,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),a=a,this.returnState&&(o=a.slice(1)),r=a[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):i=this.mergeMode==null?[r,r.slice()]:[r],this.returnState?this.mergeMode==null?i.concat(o).concat(o.slice()):[r].concat(o).concat(o.slice()):mr(i)},n.prototype.apply=function(e,r){var i=r==null?null:r.initialState,o=r==null?null:r.constants;r==null&&(r={});var a=z4(e,i,o,this.numConstants);if(e=a.inputs,i=a.initialState,o=a.constants,Array.isArray(e)&&(i=e.slice(1),e=e[0]),(i==null||i.length===0)&&o==null)return t.prototype.apply.call(this,e,r);var s=[],u=[];if(i!=null){var l=i.length;if(l%2>0)throw new Y("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,s.push.apply(s,i);var c=i.map(function(y){return new Fn({shape:y.shape})});this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),u.push.apply(u,c)}if(o!=null)throw new Xe("Support for constants in Bidirectional layers is not implemented yet.");for(var d=s[0]instanceof Pi,f=0,p=s;f<p.length;f++)if(p[f]instanceof Pi!==d)throw new Y("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(d){var h=[e].concat(s),v=this.inputSpec.concat(u),g=this.inputSpec;this.inputSpec=v;var m=t.prototype.apply.call(this,h,r);return this.inputSpec=g,m}return t.prototype.apply.call(this,e,r)},n.prototype.call=function(e,r){var i=this;return ee(function(){if(r.mask!=null)throw new Xe("The support for masking is not implemented for Bidirectional layers yet.");var o,a,s,u,l=r.initialState;if(l==null)o=i.forwardLayer.call(e,r),a=i.backwardLayer.call(e,r);else{var c=l.slice(0,l.length/2),d=l.slice(l.length/2);o=i.forwardLayer.call(e,Object.assign(r,{initialState:c})),a=i.backwardLayer.call(e,Object.assign(r,{initialState:d}))}return i.returnState&&(Array.isArray(o)&&(s=o.slice(1).concat(a.slice(1))),o=o[0],a=a[0]),i.returnSequences&&(a=So(a,1)),i.mergeMode==="concat"?u=o3([o,a]):i.mergeMode==="sum"?u=st(o,a):i.mergeMode==="ave"?u=We(.5,st(o,a)):i.mergeMode==="mul"?u=We(o,a):i.mergeMode==null&&(u=[o,a]),i.returnState?i.mergeMode==null?u.concat(s):[u].concat(s):u})},n.prototype.resetStates=function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},n.prototype.build=function(e){var r=this;tu(this.forwardLayer.name,function(){r.forwardLayer.build(e)}),tu(this.backwardLayer.name,function(){r.backwardLayer.build(e)}),this.built=!0},Object.defineProperty(n.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),n.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)},n.prototype.getConfig=function(){var e={mergeMode:this.mergeMode},r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},n.fromConfig=function(e,r){var i=ji(r.layer);if(delete r.layer,r.numConstants!=null)throw new Xe("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var o=r;return o.layer=i,new e(o)},n.className="Bidirectional",n}(U4);function IY(t){return new Cp(t)}function _Y(t){return new $3(t)}function AY(t){return new B3(t)}function OY(t){return new j3(t)}function DY(t){return new V3(t)}function MY(t){return new W3(t)}function PY(t){return new U3(t)}function LY(t){return new Y3(t)}function FY(t){return new GC(t)}function zY(t){return new K3(t)}function BY(t){return new q3(t)}function jY(t){return new X3(t)}function VY(t){return new J3(t)}function $Y(t){return new Q3(t)}function UY(t){return new Z3(t)}function WY(t){return new r4(t)}function HY(t){return new t4(t)}function GY(t){return new e4(t)}function qY(t){return new n4(t)}function KY(t){return new i4(t)}function XY(t){return new o4(t)}function YY(t){return new a4(t)}function JY(t){return new u4(t)}function QY(t){return new l4(t)}function ZY(t){return new d4(t)}function eJ(t){return new h4(t)}function tJ(t){return new f4(t)}function nJ(t){return new p4(t)}function rJ(t){return new c4(t)}function iJ(t){return new m4(t)}function oJ(t){return new b4(t)}function aJ(t){return new w4(t)}function sJ(t){return new x4(t)}function JC(t){return new R4(t)}function uJ(t){return JC(t)}function lJ(t){return JC(t)}function QC(t){return new k4(t)}function cJ(t){return QC(t)}function dJ(t){return QC(t)}function ZC(t){return new A4(t)}function fJ(t){return ZC(t)}function pJ(t){return ZC(t)}function hJ(t){return new D4(t)}function mJ(t){return new L4(t)}function G4(t){return new M4(t)}function q4(t){return new F4(t)}function K4(t){return new C4(t)}function X4(t){return new N4(t)}function vJ(t){return new _4(t)}function gJ(t){return new V4(t)}function yJ(t){return new KC(t)}function bJ(t){return new $4(t)}function wJ(t){return new XC(t)}function xJ(t){return new j4(t)}function SJ(t){return new qC(t)}function EJ(t){return new Au(t)}function CJ(t){return new YC(t)}function RJ(t){return new H4(t)}function TJ(t){return new W4(t)}he.registerClass(H4);var NJ=G4,kJ=q4,IJ=K4,_J=X4;function AJ(t){return new v4(t)}function OJ(t){return new g4(t)}function DJ(t){return new y4(t)}function MJ(t){return new s4(t)}var PJ=Object.freeze({inputLayer:IY,elu:_Y,reLU:AY,leakyReLU:OY,prelu:DY,softmax:MY,thresholdedReLU:PY,conv1d:LY,conv2d:FY,conv2dTranspose:zY,conv3d:BY,separableConv2d:jY,cropping2D:VY,upSampling2d:$Y,depthwiseConv2d:UY,activation:WY,dense:HY,dropout:GY,flatten:qY,repeatVector:KY,reshape:XY,permute:YY,embedding:JY,add:QY,average:ZY,concatenate:eJ,maximum:tJ,minimum:nJ,multiply:rJ,dot:iJ,batchNormalization:oJ,layerNormalization:aJ,zeroPadding2d:sJ,averagePooling1d:JC,avgPool1d:uJ,avgPooling1d:lJ,averagePooling2d:QC,avgPool2d:cJ,avgPooling2d:dJ,averagePooling3d:ZC,avgPool3d:fJ,avgPooling3d:pJ,globalAveragePooling1d:hJ,globalAveragePooling2d:mJ,globalMaxPooling1d:G4,globalMaxPooling2d:q4,maxPooling1d:K4,maxPooling2d:X4,maxPooling3d:vJ,gru:gJ,gruCell:yJ,lstm:bJ,lstmCell:wJ,simpleRNN:xJ,simpleRNNCell:SJ,rnn:EJ,stackedRNNCells:CJ,bidirectional:RJ,timeDistributed:TJ,globalMaxPool1d:NJ,globalMaxPool2d:kJ,maxPool1d:IJ,maxPool2d:_J,Layer:pt,RNN:Au,RNNCell:Rp,input:L3,gaussianNoise:AJ,gaussianDropout:OJ,alphaDropout:DJ,masking:MJ});function LJ(t,n){return BC(t,n)}function FJ(t,n){return k3(t,n)}function zJ(t,n){return I3(t,n)}function BJ(t,n){return jC(t,n)}function jJ(t,n){return VC(t,n)}function VJ(t,n){return N3(t,n)}function $J(t,n){return vX(t,n)}function UJ(t,n){return zC(t,n)}function WJ(t,n){return uy(t,n)}function HJ(t,n){return Mc(t,n)}function GJ(t,n){return Mc(t,n)}function qJ(t,n){return Mc(t,n)}function KJ(t,n){return Iu(t,n)}function XJ(t,n){return Iu(t,n)}function YJ(t,n){return Iu(t,n)}var JJ=Object.freeze({binaryAccuracy:LJ,binaryCrossentropy:FJ,sparseCategoricalAccuracy:zJ,categoricalAccuracy:BJ,categoricalCrossentropy:jJ,precision:VJ,recall:$J,cosineProximity:UJ,meanAbsoluteError:WJ,meanAbsolutePercentageError:HJ,MAPE:GJ,mape:qJ,meanSquaredError:KJ,MSE:XJ,mse:YJ}),QJ=Object.freeze({modelFromJSON:JX});function ZJ(t){return new dy(t)}function eQ(t){return vY(t)}function tQ(t){return gY(t)}var nQ=Object.freeze({l1l2:ZJ,l1:eQ,l2:tQ}),Y4=function(t){function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.model=null,e}return ue(n,t),n.prototype.setModel=function(e){if(!(e instanceof ru))throw new Error("model must be a LayersModel, not some other Container");this.model=e},n}(uc);function Ih(t,n){return t<n}function Pk(t,n){return t>n}var J4=function(t){function n(e){var r=t.call(this)||this;if(e==null&&(e={}),e.restoreBestWeights)throw new Xe("restoreBestWeights = True is not implemented in EarlyStopping yet.");return r.monitor=e.monitor||"val_loss",r.minDelta=Math.abs(e.minDelta||0),r.patience=e.patience||0,r.verbose=e.verbose||0,r.mode=e.mode||"auto",r.baseline=e.baseline,["auto","min","max"].indexOf(r.mode)===-1&&(console.warn("EarlyStopping mode '"+r.mode+"' is invalid. Falling back to mode 'auto'."),r.mode="auto"),r.mode==="min"?r.monitorFunc=Ih:r.mode==="max"||r.monitor.indexOf("acc")!==-1?r.monitorFunc=Pk:r.monitorFunc=Ih,r.monitorFunc===Ih&&(r.minDelta*=-1),r}return ue(n,t),n.prototype.onTrainBegin=function(e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===Ih?1/0:-1/0,[2]})})},n.prototype.onEpochEnd=function(e,r){return Ue(this,void 0,void 0,function(){var i;return ze(this,function(o){switch(o.label){case 0:return[4,Ea(r)];case 1:return o.sent(),(i=this.getMonitorValue(r))==null?[2]:(this.monitorFunc(i-this.minDelta,this.best)?(this.best=i,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)),[2])}})})},n.prototype.onTrainEnd=function(e){return Ue(this,void 0,void 0,function(){return ze(this,function(r){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},n.prototype.getMonitorValue=function(e){e==null&&(e={});var r=e[this.monitor];return r==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(e)),r},n}(Y4);function rQ(t){return new J4(t)}var iQ={earlyStopping:rQ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Fo,Lk,jw=function(){return(jw=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)};function hu(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(c){o(c)}}function s(l){try{u(r.throw(l))}catch(c){o(c)}}function u(l){l.done?i(l.value):new e(function(c){c(l.value)}).then(a,s)}u((r=r.apply(t,n||[])).next())})}function mu(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(l){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(c[0]===6&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=n.call(t,a)}catch(d){c=[6,d],r=0}finally{e=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(Fo||(Fo={})),function(t){(function(n){n[n.LEGACY=0]="LEGACY",n[n.V1=1]="V1",n[n.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(Lk||(Lk={}));var e2={};function oQ(t,n){var e={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:n};e2[t]=e}function Q4(t){return e2[t]}function aQ(t){delete e2[t]}function z(t,n,e,r){var i=n.inputParams[t];if(i&&i.inputIndexStart!==void 0){var o=i.inputIndexStart,a=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?o+1:i.inputIndexEnd;if(i.type==="tensor")return vr(n.inputNames[i.inputIndexStart],e,r);if(i.type==="tensors")return n.inputNames.slice(o,a).map(function(l){return vr(l,e,r)});var s=Array.prototype.slice.call(vr(n.inputNames.slice(o)[0],e,r).dataSync());return i.type==="number"?s[0]:s}var u=n.attrParams[t];return u&&u.value}function vr(t,n,e){var r=tf(t),i=r[0],o=r[1],a=e.currentContextIds.find(function(s){return!!n[Nv(i,s)]});return a!==void 0?n[Nv(i,a)][o]:void 0}function sQ(t,n,e){return n[Nv(t,e.currentContextId)]}function ym(t,n){var e=tf(t),r=e[0],i=e[1];return[Nv(r,n&&n.currentContextId),i]}function Nv(t,n){return n?t+"-"+n:t}function tf(t){var n=t.lastIndexOf(":");return n===-1?[t,0]:[t.substring(0,n),Number(t.substring(n+1))]}function y1(t,n){for(var e=[],r=0;r<t.length;r+=n)e.push(t.slice(r,r+n));return e}var uQ=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],lQ=Object.freeze({json:uQ}),cQ=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],dQ=Object.freeze({json:cQ}),fQ=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],pQ=Object.freeze({json:fQ}),hQ=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],mQ=Object.freeze({json:hQ}),vQ=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],gQ=Object.freeze({json:vQ}),yQ=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],bQ=Object.freeze({json:yQ}),wQ=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],xQ=Object.freeze({json:wQ}),SQ=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],EQ=Object.freeze({json:SQ}),CQ=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],RQ=Object.freeze({json:CQ}),TQ=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],NQ=Object.freeze({json:TQ}),kQ=[{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],IQ=Object.freeze({json:kQ}),_Q=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],AQ=Object.freeze({json:_Q}),OQ=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],DQ=Object.freeze({json:OQ}),MQ=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],PQ=Object.freeze({json:MQ}),LQ=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],FQ=Object.freeze({json:LQ}),zQ=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],BQ=Object.freeze({json:zQ}),jQ=function(){function t(){var n=[lQ,dQ,pQ,mQ,gQ,bQ,xQ,NQ,RQ,EQ,IQ,AQ,DQ,PQ,FQ,BQ],e=[].concat.apply([],n.map(function(r){return r.json}));this.opMappers=e.reduce(function(r,i){return r[i.tfOpName]=i,r},{})}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.transformGraph=function(n){var e=this,r=[],i=[],o=n.node.reduce(function(l,c){return l[c.name]=e.mapNode(c),c.op==="Placeholder"&&r.push(l[c.name]),c.op==="Const"&&i.push(l[c.name]),l},{}),a=[],s=[],u=Object.keys(o);return u.forEach(function(l){var c=o[l];c.inputNames.forEach(function(d){var f=ym(d)[0];c.inputs.push(o[f]),o[f].children.push(c)}),c.inputs.length===0&&a.push(c)}),u.forEach(function(l){var c=o[l];c.children.length===0&&s.push(c)}),{nodes:o,inputs:a,outputs:s,weights:i,placeholders:r}},t.prototype.mapNode=function(n){var e=Q4(n.op)||this.opMappers[n.op]||{};n.attr==null&&(n.attr={});var r={name:n.name,op:n.op,category:e.category,inputNames:(n.input||[]).map(function(i){return i.startsWith("^")?i.substr(1):i}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:n.attr};return e.inputs!=null&&(r.inputParams=e.inputs.reduce(function(i,o){return i[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},i},{})),e.attrs!=null&&(r.attrParams=e.attrs.reduce(function(i,o){var a=o.type,s=void 0;switch(o.type){case"string":(s=Vw(n.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Vw(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":(s=Kw(n.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Kw(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":(s=Uw(n.attr,o.tfName,o.defaultValue||0))===void 0&&o.tfDeprecatedName&&(s=Uw(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":(s=qw(n.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=qw(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":(s=$w(n.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=$w(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":(s=Yw(n.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Yw(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":(s=Gw(n.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Gw(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":(s=Xw(n.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Xw(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":(s=Ww(n.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Ww(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":(s=Hw(n.attr,o.tfName,o.defaultValue))===void 0&&o.tfDeprecatedName&&(s=Hw(n.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+o.type+" for op: "+n.op)}return i[o.name]={value:s,type:a},i},{})),r},t}();function VQ(t){var n=ie().global;if(n.atob!==void 0)return n.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Z4(t,n){var e=Array.isArray(t)?String.fromCharCode.apply(null,t):VQ(t);return n?e:e.toLowerCase()}function Vw(t,n,e,r){r===void 0&&(r=!1);var i=t[n];return i!=null?Z4(i.s,r):e}function $w(t,n,e){var r=t[n];return r?r.b:e}function Uw(t,n,e){var r=t[n]||{},i=r.i!=null?r.i:r.f!=null?r.f:e;return typeof i=="number"?i:parseInt(i,10)}function eF(t){switch(typeof t=="string"&&(t=Fo[t]),t){case Fo.DT_FLOAT:return"float32";case Fo.DT_INT32:case Fo.DT_INT64:return"int32";case Fo.DT_BOOL:return"bool";case Fo.DT_DOUBLE:return"float32";case Fo.DT_STRING:return"string";default:return null}}function Ww(t,n,e){var r=t[n];return r&&r.type?eF(r.type):e}function Hw(t,n,e){var r=t[n];return r&&r.list&&r.list.type?r.list.type.map(function(i){return eF(i)}):e}function tF(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(function(n){return typeof n.size=="number"?n.size:parseInt(n.size,10)}):[]}function Gw(t,n,e){var r=t[n];return r&&r.shape?tF(r.shape):e}function qw(t,n,e){var r=t[n];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(function(i){return typeof i=="number"?i:parseInt(i,10)}):e}function Kw(t,n,e,r){r===void 0&&(r=!1);var i=t[n];return i&&i.list&&i.list.s?i.list.s.map(function(o){return Z4(o,r)}):e}function Xw(t,n,e){var r=t[n];return r&&r.list&&r.list.shape?r.list.shape.map(function(i){return tF(i)}):e}function Yw(t,n,e){var r=t[n];return r&&r.list&&r.list.b?r.list.b:e}var $Q=function(){function t(n,e,r){var i=this;this.node=n,this.tensorMap=e,this.context=r,this.inputs=[],this.attrs={},this.inputs=n.inputNames.map(function(o){return i.getInput(o)}),n.rawAttrs!=null&&(this.attrs=Object.keys(n.rawAttrs).reduce(function(o,a){return o[a]=i.getAttr(a),o},{}))}return t.prototype.getInput=function(n){return vr(n,this.tensorMap,this.context)},t.prototype.getAttr=function(n,e){var r=this.node.rawAttrs[n];if(r.tensor!=null)return vr(n,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return Uw(this.node.rawAttrs,n,e);if(r.s!=null)return Vw(this.node.rawAttrs,n,e);if(r.b!=null)return $w(this.node.rawAttrs,n,e);if(r.shape!=null)return Gw(this.node.rawAttrs,n,e);if(r.type!=null)return Ww(this.node.rawAttrs,n,e);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return qw(this.node.rawAttrs,n,e);if(r.list.s!=null)return Kw(this.node.rawAttrs,n,e);if(r.list.shape!=null)return Xw(this.node.rawAttrs,n,e);if(r.list.b!=null)return Yw(this.node.rawAttrs,n,e);if(r.list.type!=null)return Hw(this.node.rawAttrs,n,e)}return e},t}(),UQ=function(t,n,e){switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[st(z("a",t,n,e),z("b",t,n,e))];case"AddN":return[XE(z("tensors",t,n,e))];case"FloorMod":case"Mod":return[JE(z("a",t,n,e),z("b",t,n,e))];case"Mul":return[We(z("a",t,n,e),z("b",t,n,e))];case"RealDiv":case"Div":return[cr(z("a",t,n,e),z("b",t,n,e))];case"FloorDiv":return[Fg(z("a",t,n,e),z("b",t,n,e))];case"Sub":return[jn(z("a",t,n,e),z("b",t,n,e))];case"Minimum":return[kc(z("a",t,n,e),z("b",t,n,e))];case"Maximum":return[To(z("a",t,n,e),z("b",t,n,e))];case"Pow":return[tc(z("a",t,n,e),z("b",t,n,e))];case"SquaredDifference":return[QE(z("a",t,n,e),z("b",t,n,e))];default:throw TypeError("Node type "+t.op+" is not implemented")}},WQ=function(t,n,e){switch(t.op){case"Abs":case"ComplexAbs":return[ss(z("x",t,n,e))];case"Acos":return[RE(z("x",t,n,e))];case"Acosh":return[TE(z("x",t,n,e))];case"Asin":return[NE(z("x",t,n,e))];case"Asinh":return[kE(z("x",t,n,e))];case"Atan":return[IE(z("x",t,n,e))];case"Atan2":return[YE(z("x",t,n,e),z("y",t,n,e))];case"Atanh":return[_E(z("x",t,n,e))];case"Ceil":return[AE(z("x",t,n,e))];case"Complex":return[Nn(z("real",t,n,e),z("imag",t,n,e))];case"Cos":return[OE(z("x",t,n,e))];case"Cosh":return[DE(z("x",t,n,e))];case"Elu":return[Oc(z("x",t,n,e))];case"Erf":return[ME(z("x",t,n,e))];case"Exp":return[PE(z("x",t,n,e))];case"Expm1":return[LE(z("x",t,n,e))];case"Floor":return[_g(z("x",t,n,e))];case"Log":return[ra(z("x",t,n,e))];case"Log1p":return[FE(z("x",t,n,e))];case"Imag":return[vi(z("x",t,n,e))];case"Neg":return[Tu(z("x",t,n,e))];case"Reciprocal":return[zE(z("x",t,n,e))];case"Real":return[_r(z("x",t,n,e))];case"Relu":return[ws(z("x",t,n,e))];case"Round":return[BE(z("x",t,n,e))];case"Selu":return[Zg(z("x",t,n,e))];case"Sigmoid":return[Og(z("x",t,n,e))];case"Sin":return[VE(z("x",t,n,e))];case"Sign":return[jE(z("x",t,n,e))];case"Sinh":return[$E(z("x",t,n,e))];case"Softplus":return[lp(z("x",t,n,e))];case"Sqrt":return[cp(z("x",t,n,e))];case"Square":return[CE(z("x",t,n,e))];case"Tanh":return[Dg(z("x",t,n,e))];case"Tan":return[UE(z("x",t,n,e))];case"Relu6":case"ClipByValue":return[br(z("x",t,n,e),z("clipValueMin",t,n,e),z("clipValueMax",t,n,e))];case"Rsqrt":return[Ag(vr(t.inputNames[0],n,e))];case"Prod":return[Yg(z("x",t,n,e),z("axes",t,n,e))];case"LeakyRelu":return[Jg(z("x",t,n,e),z("alpha",t,n,e))];default:throw TypeError("Node type "+t.op+" is not implemented")}},HQ=function(){function t(n,e,r,i,o,a,s){this.name=n,this.dtype=e,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=o,this.dynamicSize=a,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=t.nextId++}return Object.defineProperty(t.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),t.prototype.clearAndClose=function(){this.tensors.forEach(function(n){return n.tensor.dispose()}),this.tensors=[],this.closed_=!0},t.prototype.size=function(){return this.tensors.length},t.prototype.read=function(n){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(n<0||n>=this.tensors.length)throw new Error("Tried to read from index "+n+", but array size is: "+this.tensors.length);var e=this.tensors[n];if(e.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+n+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor},t.prototype.readMany=function(n){var e=this;return n.map(function(r){return e.read(r)})},t.prototype.write=function(n,e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(n<0||!this.dynamicSize&&n>=this.maxSize)throw new Error("Tried to write to index "+n+", but array is not resizeable and size is: "+this.maxSize);var r=this.tensors[n]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+n+`,
          because the value dtype is `+e.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+n+"."),r&&r.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+n+", because it has already been read.");if(r&&r.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+n+", because it has already been written.");r.tensor=e,r.written=!0,this.tensors[n]=r},t.prototype.writeMany=function(n,e){var r=this;if(n.length!==e.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+n.length+" is not the same as tensors size: "+e.length+".");n.forEach(function(i,o){return r.write(i,e[o])})},t.prototype.gather=function(n,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+e);if(!n){n=[];for(var r=0;r<this.size();r++)n.push(r)}if(n.length===0)return mn([],[0].concat(this.elementShape));var i=this.readMany(n);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: "),$i(i,0)},t.prototype.concat=function(n){if(n&&n!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+n);if(this.size()===0)return mn([],[0].concat(this.elementShape));for(var e=[],r=0;r<this.size();r++)e.push(r);var i=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+i[0].shape+")"),lr(i,0)},t.prototype.scatter=function(n,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);if(n.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+n.length+" vs. "+e.shape[0]);var r=Math.max.apply(Math,n);if(!this.dynamicSize&&r>=this.maxSize)throw new Error("Max index must be < array size ("+r+"  vs. "+this.maxSize+")");this.writeMany(n,du(e,0))},t.prototype.split=function(n,e){var r=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);var i=0,o=n.map(function(c){return i+=c});if(i!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+i+", and tensor's shape is: "+e.shape);if(!this.dynamicSize&&n.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+n.length+"), and the TensorArray is not marked as dynamically resizeable");var a=i===0?0:e.size/i,s=[];ee(function(){e=e.reshape([1,i,a]);for(var c=0;c<n.length;++c){var d=[0,c===0?0:o[c-1],0],f=[1,n[c],a];s[c]=ni(e,d,f).reshape(r.elementShape)}return s});for(var u=[],l=0;l<n.length;l++)u[l]=l;this.writeMany(u,s)},t.prototype.assertShapesMatchAllowUndefinedSize=function(n,e,r){r===void 0&&(r=""),Fe.assert(this.shapesEqualAllowUndefinedSize(n,e),function(){return r+" Shapes "+n+" and "+e+" must match"})},t.prototype.shapesEqualAllowUndefinedSize=function(n,e){if(n.length!==e.length)return!1;for(var r=0;r<n.length;r++)if(n[r]!==-1&&e[r]!==-1&&n[r]!==e[r])return!1;return!0},t.nextId=0,t}();function GQ(t,n,e){return hu(this,void 0,void 0,function(){var r,i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w,x,C,E,S,k,N,M,D,T,O,P,A,I,_,F,L,H;return mu(this,function(B){switch(B.label){case 0:switch(t.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[z("pred",t,n,e).clone()]];case 2:return r=z("pred",t,n,e),i=z("data",t,n,e),[4,r.data()];case 3:return[2,B.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(o=t.inputNames.find(function(q){return vr(q,n,e)!==void 0}))?[vr(o,n,e).clone()]:void 0];case 5:return a=z("frameName",t,n,e),s=z("tensor",t,n,e),e.enterFrame(a),[2,[s.clone()]];case 6:return u=z("tensor",t,n,e),e.exitFrame(),[2,[u.clone()]];case 7:return l=z("tensor",t,n,e),e.nextIteration(),[2,[l.clone()]];case 8:return c=z("size",t,n,e),d=z("dtype",t,n,e),f=z("elementShape",t,n,e),p=z("dynamicSize",t,n,e),h=z("clearAfterRead",t,n,e),v=z("identicalElementShapes",t,n,e),g=z("name",t,n,e),m=new HQ(g,d,c,f,v,p,h),e.addTensorArray(m),[2,[Ie(m.id),Ie(1)]];case 9:return y=z("tensorArrayId",t,n,e),b=z("index",t,n,e),w=z("tensor",t,n,e),e.getTensorArray(y).write(b,w),[2,[Ie(1)]];case 10:return x=z("tensorArrayId",t,n,e),C=z("index",t,n,e),[2,[e.getTensorArray(x).read(C)]];case 11:return E=z("tensorArrayId",t,n,e),S=z("indices",t,n,e),k=z("dtype",t,n,e),[2,[e.getTensorArray(E).gather(S,k)]];case 12:return N=z("tensorArrayId",t,n,e),M=z("indices",t,n,e),D=z("tensor",t,n,e),e.getTensorArray(N).scatter(M,D),[2,[Ie(1)]];case 13:return T=z("tensorArrayId",t,n,e),O=e.getTensorArray(T),P=z("dtype",t,n,e),[2,[O.concat(P)]];case 14:return A=z("tensorArrayId",t,n,e),I=z("tensor",t,n,e),_=z("lengths",t,n,e),e.getTensorArray(A).split(_,I),[2,[Ie(1)]];case 15:return F=z("tensorArrayId",t,n,e),L=e.getTensorArray(F),[2,[Ie(L.size(),"int32")]];case 16:return H=z("tensorArrayId",t,n,e),e.getTensorArray(H).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+t.op+" is not implemented")}})})}var qQ=function(t,n,e){var r,i;switch(t.op){case"Conv1D":var o=z("stride",t,n,e),a=z("pad",t,n,e),s=z("dataFormat",t,n,e).toUpperCase(),u=z("dilation",t,n,e);return[Bg(z("x",t,n,e),z("filter",t,n,e),o,a,s,u)];case"Conv2D":o=z("strides",t,n,e),a=z("pad",t,n,e),s=z("dataFormat",t,n,e).toUpperCase();var l=z("dilations",t,n,e);return[ku(z("x",t,n,e),z("filter",t,n,e),[o[1],o[2]],a,s,[l[1],l[2]])];case"_FusedConv2D":var c=(r=z("fusedOps",t,n,e))[0],d=r[1],f=c==="biasadd",p=d==="prelu",h=c==="fusedbatchnorm",v=z("numArgs",t,n,e);if(f){if(p&&v!==2)throw new Error("Fused Conv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!p&&v!==1)throw new Error("Fused Conv2d with BiasAdd must have one extra argument: bias.")}if(h)throw new Error("Fused Conv2d with FusedBatchNorm is not supported.");o=z("strides",t,n,e),a=z("pad",t,n,e),s=z("dataFormat",t,n,e).toUpperCase(),l=z("dilations",t,n,e);var g=(i=z("args",t,n,e))[0],m=i[1];return[oc.conv2d({x:z("x",t,n,e),filter:z("filter",t,n,e),strides:[o[1],o[2]],pad:a,dataFormat:s,dilations:[l[1],l[2]],bias:g,activation:d,preluActivationWeights:m})];case"Conv2DBackpropInput":case"Conv2dTranspose":var y=z("outputShape",t,n,e);return o=z("strides",t,n,e),a=z("pad",t,n,e),[Vg(z("x",t,n,e),z("filter",t,n,e),y,[o[1],o[2]],a)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return o=z("strides",t,n,e),a=z("pad",t,n,e),l=z("dilations",t,n,e),s=z("dataFormat",t,n,e).toUpperCase(),[Ac(z("input",t,n,e),z("filter",t,n,e),[o[1],o[2]],a,s,[l[1],l[2]])];case"Conv3D":return o=z("strides",t,n,e),a=z("pad",t,n,e),s=z("dataFormat",t,n,e).toUpperCase(),l=z("dilations",t,n,e),[jg(z("x",t,n,e),z("filter",t,n,e),[o[1],o[2],o[3]],a,s,[l[1],l[2],l[3]])];case"AvgPool":o=z("strides",t,n,e),a=z("pad",t,n,e);var b=z("kernelSize",t,n,e);return[Wg(z("x",t,n,e),[b[1],b[2]],[o[1],o[2]],a)];case"MaxPool":return o=z("strides",t,n,e),a=z("pad",t,n,e),b=z("kernelSize",t,n,e),[Ug(z("x",t,n,e),[b[1],b[2]],[o[1],o[2]],a)];case"AvgPool3D":return o=z("strides",t,n,e),a=z("pad",t,n,e),b=z("kernelSize",t,n,e),[Gg(z("x",t,n,e),[b[1],b[2],b[3]],[o[1],o[2],o[3]],a)];case"MaxPool3D":return o=z("strides",t,n,e),a=z("pad",t,n,e),b=z("kernelSize",t,n,e),[Hg(z("x",t,n,e),[b[1],b[2],b[3]],[o[1],o[2],o[3]],a)];default:throw TypeError("Node type "+t.op+" is not implemented")}},KQ=function(t,n,e){switch(t.op){case"Fill":var r=z("shape",t,n,e),i=z("dtype",t,n,e),o=z("value",t,n,e);return[Tc(r,o,i)];case"LinSpace":var a=z("start",t,n,e),s=z("stop",t,n,e),u=z("num",t,n,e);return[nE(a,s,u)];case"Multinomial":var l=z("logits",t,n,e),c=z("numSamples",t,n,e),d=z("seed",t,n,e);return[lE(l,c,d)];case"OneHot":var f=z("indices",t,n,e),p=z("depth",t,n,e),h=z("onValue",t,n,e),v=z("offValue",t,n,e);return[Zl(f,p,h,v)];case"Ones":return[Ro(z("shape",t,n,e),z("dtype",t,n,e))];case"OnesLike":return[ti(z("x",t,n,e))];case"RandomUniform":return[Cu(z("shape",t,n,e),z("minval",t,n,e),z("maxval",t,n,e),z("dtype",t,n,e))];case"Range":a=z("start",t,n,e);var g=z("stop",t,n,e),m=z("step",t,n,e);return[wg(a,g,m,z("dtype",t,n,e))];case"TruncatedNormal":r=z("shape",t,n,e);var y=z("mean",t,n,e),b=z("stdDev",t,n,e);return d=z("seed",t,n,e),[sp(r,y,b,z("dtype",t,n,e),d)];case"Zeros":return[_t(z("shape",t,n,e),z("dtype",t,n,e))];case"ZerosLike":return[dt(z("x",t,n,e))];default:throw TypeError("Node type "+t.op+" is not implemented")}};function XQ(t,n,e){return hu(this,void 0,void 0,function(){var r,i,o,a,s;return mu(this,function(u){switch(u.label){case 0:switch(t.op){case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,3];case"ListDiff":return[3,5]}return[3,6];case 1:return r=z("boxes",t,n,e),i=z("scores",t,n,e),o=z("maxOutputSize",t,n,e),a=z("iouThreshold",t,n,e),s=z("scoreThreshold",t,n,e),[4,eu.nonMaxSuppressionAsync(r,i,o,a,s)];case 2:return[2,[u.sent()]];case 3:return[4,Lg(z("condition",t,n,e).asType("bool"))];case 4:return[2,[u.sent()]];case 5:return[2,dE(z("x",t,n,e),z("y",t,n,e))];case 6:throw TypeError("Node type "+t.op+" is not implemented")}})})}var YQ=function(t,n,e){switch(t.op){case"TopKV2":var r=z("x",t,n,e),i=z("k",t,n,e),o=z("sorted",t,n,e),a=lC(r,i,o);return[a.values,a.indices];default:throw TypeError("Node type "+t.op+" is not implemented")}},JQ=function(t,n,e){switch(t.op){case"Const":return n[t.name];case"PlaceholderWithDefault":var r=z("default",t,n,e);return[vr(t.name,n,e)||r];case"Placeholder":return[vr(t.name,n,e)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[z("x",t,n,e).clone()];case"IdentityN":return z("x",t,n,e).map(function(l){return l.clone()});case"Snapshot":return[z("x",t,n,e).clone()];case"Shape":return[zr(z("x",t,n,e).shape,"int32")];case"ShapeN":return z("x",t,n,e).map(function(l){return zr(l.shape)});case"Size":return[Ie(z("x",t,n,e).size,"int32")];case"Rank":return[Ie(z("x",t,n,e).rank,"int32")];case"NoOp":return[];case"Print":var i=z("x",t,n,e),o=z("data",t,n,e),a=z("message",t,n,e),s=z("summarize",t,n,e);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(a);for(var u=0;u<o.length;u++)console.log(Array.prototype.slice.call(o[u].dataSync()).slice(0,s));return[i];default:throw TypeError("Node type "+t.op+" is not implemented")}},QQ=function(t,n,e){switch(t.op){case"ResizeBilinear":var r=z("images",t,n,e),i=z("size",t,n,e),o=z("alignCorners",t,n,e);return[eu.resizeBilinear(r,[i[0],i[1]],o)];case"ResizeNearestNeighbor":return r=z("images",t,n,e),i=z("size",t,n,e),o=z("alignCorners",t,n,e),[eu.resizeNearestNeighbor(r,[i[0],i[1]],o)];case"CropAndResize":var a=z("image",t,n,e),s=z("boxes",t,n,e),u=z("boxInd",t,n,e),l=z("cropSize",t,n,e),c=z("method",t,n,e),d=z("extrapolationValue",t,n,e);return[eu.cropAndResize(a,s,u,l,c,d)];default:throw TypeError("Node type "+t.op+" is not implemented")}},ZQ=function(t,n,e){switch(t.op){case"Equal":return[Nu(z("a",t,n,e),z("b",t,n,e))];case"NotEqual":return[nc(z("a",t,n,e),z("b",t,n,e))];case"Greater":return[Ic(z("a",t,n,e),z("b",t,n,e))];case"GreaterEqual":return[fp(z("a",t,n,e),z("b",t,n,e))];case"Less":return[ZE(z("a",t,n,e),z("b",t,n,e))];case"LessEqual":return[eC(z("a",t,n,e),z("b",t,n,e))];case"LogicalAnd":return[la(z("a",t,n,e),z("b",t,n,e))];case"LogicalNot":return[KE(z("a",t,n,e))];case"LogicalOr":return[Pg(z("a",t,n,e),z("b",t,n,e))];case"Select":return[ia(z("condition",t,n,e),z("a",t,n,e),z("b",t,n,e))];default:throw TypeError("Node type "+t.op+" is not implemented")}},eZ=function(t,n,e){switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[$g(z("a",t,n,e),z("b",t,n,e),z("transposeA",t,n,e),z("transposeB",t,n,e))];case"Transpose":return[en(z("x",t,n,e),z("perm",t,n,e))];default:throw TypeError("Node type "+t.op+" is not implemented")}},tZ=function(t,n,e){switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[WE(z("x",t,n,e),z("mean",t,n,e),z("variance",t,n,e),z("offset",t,n,e),z("scale",t,n,e),z("epsilon",t,n,e))];case"LRN":return[aC(z("x",t,n,e),z("radius",t,n,e),z("bias",t,n,e),z("alpha",t,n,e),z("beta",t,n,e))];case"Softmax":return[Ru(z("x",t,n,e))];case"LogSoftmax":return[kg(z("x",t,n,e))];case"SparseToDense":return[ty(z("sparseIndices",t,n,e),z("outputShape",t,n,e),z("sparseValues",t,n,e),z("defaultValue",t,n,e))];default:throw TypeError("Node type "+t.op+" is not implemented")}},nZ=function(t,n,e){switch(t.op){case"Max":var r=z("axis",t,n,e),i=z("keepDims",t,n,e);return[us(z("x",t,n,e),r,i)];case"Mean":return r=z("axis",t,n,e),i=z("keepDims",t,n,e),[gn(z("x",t,n,e),r,i)];case"Min":return r=z("axis",t,n,e),i=z("keepDims",t,n,e),[Xg(z("x",t,n,e),r,i)];case"Sum":return r=z("axis",t,n,e),i=z("keepDims",t,n,e),[Br(z("x",t,n,e),r,i)];case"All":return r=z("axis",t,n,e),i=z("keepDims",t,n,e),[Kg(z("x",t,n,e),r,i)];case"Any":return r=z("axis",t,n,e),i=z("keepDims",t,n,e),[jf(z("x",t,n,e),r,i)];case"ArgMax":return r=z("axis",t,n,e),[Vf(z("x",t,n,e),r)];case"ArgMin":return r=z("axis",t,n,e),[iC(z("x",t,n,e),r)];case"Prod":return r=z("axis",t,n,e),i=z("keepDims",t,n,e),[Yg(z("x",t,n,e),r,i)];default:throw TypeError("Node type "+t.op+" is not implemented")}},rZ=function(t,n,e){switch(t.op){case"ConcatV2":case"Concat":var r=z("axis",t,n,e),i=z("tensors",t,n,e);return[lr(i,r)];case"GatherV2":case"Gather":r=z("axis",t,n,e);var o=z("x",t,n,e),a=z("indices",t,n,e);return[_c(o,a.asType("int32"),r)];case"ReverseV2":case"Reverse":return r=z("axis",t,n,e),o=z("x",t,n,e),[So(o,r)];case"Slice":var s=z("begin",t,n,e),u=z("size",t,n,e);return[ni(z("x",t,n,e),s,u)];case"StridedSlice":s=z("begin",t,n,e);var l=z("end",t,n,e),c=z("strides",t,n,e),d=z("beginMask",t,n,e),f=z("endMask",t,n,e),p=z("ellipsisMask",t,n,e),h=z("newAxisMask",t,n,e),v=z("shrinkAxisMask",t,n,e),g=z("x",t,n,e);if(s.length===1&&g.shape.length>1)for(var m=1;m<g.shape.length;m++)s.push(0),l.push(g.shape[m]),c.push(c[0]);return[uC(g,s,l,c,d,f,p,h,v)];case"Pack":return ee(function(){var k=z("axis",t,n,e),N=z("tensors",t,n,e),M=N[0].shape,D=N[0].squeeze().shape,T=N.map(function(O){var P=Fe.arraysEqual(O.shape,M);if(!P&&!Fe.arraysEqual(O.squeeze().shape,D))throw new Error("the input tensors shape does not match");return P?O:O.reshape(M)});return[$i(T,k)]});case"Unpack":return ee(function(){var k=z("axis",t,n,e),N=z("tensor",t,n,e);return du(N,k)});case"Tile":var y=z("reps",t,n,e);return[Qa(z("x",t,n,e),y)];case"Split":case"SplitV":r=z("axis",t,n,e);var b=z("numOrSizeSplits",t,n,e);return qo(z("x",t,n,e),b,r);case"ScatterNd":a=z("indices",t,n,e);var w=z("values",t,n,e),x=z("shape",t,n,e);return[cC(a,w,x)];case"GatherNd":var C=z("x",t,n,e);return a=z("indices",t,n,e),[dC(C,a)];case"SparseToDense":a=z("sparseIndices",t,n,e),x=z("outputShape",t,n,e);var E=z("sparseValues",t,n,e),S=z("defaultValue",t,n,e);return[ty(a,E,x,E.dtype===S.dtype?S:S.asType(E.dtype))];default:throw TypeError("Node type "+t.op+" is not implemented")}},iZ=function(t,n,e){switch(t.op){case"FFT":return[vp(z("x",t,n,e))];case"IFFT":return[ic(z("x",t,n,e))];case"RFFT":return[gp(z("x",t,n,e))];case"IRFFT":return[ey(z("x",t,n,e))];default:throw TypeError("Node type "+t.op+" is not implemented")}},oZ=function(t,n,e){switch(t.op){case"Cast":return[Eg(z("x",t,n,e),z("dtype",t,n,e))];case"ExpandDims":var r=z("axis",t,n,e);return[Hr(z("x",t,n,e),r)];case"Squeeze":return r=z("axis",t,n,e),[ap(z("x",t,n,e),r)];case"Reshape":return[op(z("x",t,n,e),z("shape",t,n,e))];case"PadV2":case"Pad":return[ys(z("x",t,n,e),y1(z("padding",t,n,e),2),z("constantValue",t,n,e))];case"SpaceToBatchND":var i=z("blockShape",t,n,e),o=y1(z("paddings",t,n,e),2);return[Rg(z("x",t,n,e),i,o)];case"BatchToSpaceND":i=z("blockShape",t,n,e);var a=y1(z("crops",t,n,e),2);return[Sg(z("x",t,n,e),i,a)];case"DepthToSpace":var s=z("blockSize",t,n,e),u=z("dataFormat",t,n,e).toUpperCase();return[uE(z("x",t,n,e),s,u)];default:throw TypeError("Node type "+t.op+" is not implemented")}};function Fk(t,n,e){var r=function(i,o,a){switch(i.category){case"arithmetic":return UQ(i,o,a);case"basic_math":return WQ(i,o,a);case"control":return GQ(i,o,a);case"convolution":return qQ(i,o,a);case"creation":return KQ(i,o,a);case"dynamic":return XQ(i,o,a);case"evaluation":return YQ(i,o,a);case"image":return QQ(i,o,a);case"graph":return JQ(i,o,a);case"logical":return ZQ(i,o,a);case"matrices":return eZ(i,o,a);case"normalization":return tZ(i,o,a);case"reduction":return nZ(i,o,a);case"slice_join":return rZ(i,o,a);case"spectral":return iZ(i,o,a);case"transformation":return oZ(i,o,a);case"custom":var s=Q4(i.op);if(s&&s.customExecutor)return s.customExecutor(new $Q(i,o,a));throw TypeError("Custom op "+i.op+" is not registered.");default:throw TypeError("Unknown op '"+i.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,n,e);return r instanceof Promise?r.then(function(i){return[].concat(i)}):[].concat(r)}var zk=function(){function t(n,e){this.weightMap=n,this.tensorArrayMap=e,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return t.prototype.newFrame=function(n,e){return{id:n,frameName:e,iterationId:0}},Object.defineProperty(t.prototype,"currentContext",{get:function(){return this.contexts},set:function(n){this.contexts!==n&&(this.contexts=n,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),t.prototype.generateCurrentContextIds=function(){for(var n=[],e=0;e<this.contexts.length-1;e++){var r=this.contexts.slice(0,this.contexts.length-e);n.push(this.contextIdforContexts(r))}n.push(""),this._currentContextIds=n},t.prototype.contextIdforContexts=function(n){return n?n.map(function(e){return e.id===0&&e.iterationId===0?"":e.frameName+"-"+e.iterationId}).join("/"):""},t.prototype.enterFrame=function(n){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,n)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},t.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},t.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var n=Object.assign({},this.contexts[this.contexts.length-1]);n.iterationId+=1,n.id=this.lastId,this.contexts.splice(-1,1,n),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},t.prototype.getWeight=function(n){return this.weightMap[n]},t.prototype.addTensorArray=function(n){this.tensorArrayMap[n.id]=n},t.prototype.getTensorArray=function(n){return this.tensorArrayMap[n]},t}();function Bk(t,n,e){for(var r=new Set,i=[],o=null,a=null,s=new Set,u=n.slice();u.length>0;){var l=u.pop();(nF(l)||lZ(l))&&o==null&&(a=(o=l).children.map(function(c){return c.name}).filter(function(c){return r.has(c)})),r.add(l.name),e[l.name]==null&&t[l.name]==null&&(l.inputs.length!==0?l.inputs.forEach(function(c){s.has(c.name)||(s.add(c.name),u.push(c))}):i.push(l.name))}return{inputs:t,outputs:n,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:a}}function aZ(t,n,e){var r=e.usedNodes,i=e.inputs,o=[];Object.keys(i).map(function(l){return t.nodes[l]}).forEach(function(l){r.has(l.name)&&o.push(l)}),t.weights.forEach(function(l){r.has(l.name)&&o.push(l)});for(var a=new Set,s=[];o.length>0;){var u=o.pop();a.add(u.name),n[u.name]||s.push(u),u.children.forEach(function(l){!a.has(l.name)&&r.has(l.name)&&l.inputs.every(function(c){return a.has(c.name)})&&o.push(l)})}return s}var sZ=["Switch","Merge","Enter","Exit","NextIteration"],uZ=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"];function nF(t){return sZ.indexOf(t.op)>=0}function lZ(t){return uZ.indexOf(t.op)>=0}var cZ=function(){function t(n){this.graph=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=n.placeholders,this._outputs=n.outputs}return Object.defineProperty(t.prototype,"weightMap",{get:function(){return this._weightMap},set:function(n){var e=Object.keys(n).map(function(r){return n[r].map(function(i){return i.id})});this.weightIds=[].concat.apply([],e),this._weightMap=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.placeholders.map(function(n){return{name:n.name,shape:n.attrParams.shape?n.attrParams.shape.value:void 0,dtype:n.attrParams.dtype?n.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this._outputs.map(function(n){return{name:n.name,shape:n.attrParams.shape?n.attrParams.shape.value:void 0,dtype:n.attrParams.dtype?n.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.placeholders.map(function(n){return n.name})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.outputs.map(function(n){return n.name})},enumerable:!0,configurable:!0}),t.prototype.getCompilationKey=function(n,e){var r=n.map(function(o){return o.name}).sort(),i=e.map(function(o){return o.name}).sort();return r.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)},t.prototype.compile=function(n,e){var r=Bk(n,e,this.weightMap),i=r.missingInputs,o=r.dynamicNode,a=r.syncInputs;if(o!=null)throw new Error("This execution contains the node '"+o.name+"', which has the dynamic op '"+o.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+a+"]");if(i.length>0){var s=e.map(function(l){return l.name}),u=Object.keys(n);throw new Error("Cannot compute the outputs ["+s+"] from the provided inputs ["+u+"]. Missing the following inputs: ["+i+"]")}return aZ(this.graph,this.weightMap,r)},t.prototype.execute=function(n,e){var r=this,i=Object.keys(n).sort();this.checkInputs(n),this.checkInputShapeAndType(n),this.checkOutputs(e);var o=i.map(function(c){return r.graph.nodes[c]}),a=e.map(function(c){return r.graph.nodes[tf(c)[0]]}),s=this.getCompilationKey(o,a),u=this.compiledMap.get(s);u==null&&(u=this.compile(n,a),this.compiledMap.set(s,u));var l={};return ee(function(){var c=new zk(r._weightMap,l),d=jw({},r.weightMap);Object.keys(n).forEach(function(m){d[m]=[n[m]]});for(var f=r.getFrozenTensorIds(d),p={},h=0;h<u.length;h++){var v=u[h];if(!d[v.name]){var g=Fk(v,d,c);if(g instanceof Promise)throw new Error("The execution of the op '"+v.op+"' returned a promise. Please use model.executeAsync() instead.");d[v.name]=g,r.checkTensorForDisposal(v.name,v,d,c,f,e,p)}}return e.map(function(m){return vr(m,d,c)})})},t.prototype.getFrozenTensorIds=function(n){var e=[].concat.apply([],Object.keys(n).map(function(r){return n[r]}).map(function(r){return r.map(function(i){return i.id})}));return new Set(e)},t.prototype.checkTensorForDisposal=function(n,e,r,i,o,a,s){e.category!=="control"&&a.indexOf(n)===-1&&(r[n].forEach(function(u){u!=null&&(s[u.id]=(s[u.id]||0)+e.children.length)}),e.inputs.forEach(function(u){if(u.category!=="control"){var l=sQ(u.name,r,i);l!=null&&l.forEach(function(c){if(c&&!o.has(c.id)){var d=s[c.id];d===1?(c.dispose(),delete s[c.id]):d!=null&&s[c.id]--}})}}))},t.prototype.executeAsync=function(n,e){return hu(this,void 0,void 0,function(){var r,i,o,a,s,u,l=this;return mu(this,function(c){switch(c.label){case 0:return this.checkInputs(n),this.checkInputShapeAndType(n),this.checkOutputs(e),r={},i=new zk(this._weightMap,r),[4,this.executeWithControlFlow(n,i,e)];case 1:return o=c.sent(),a=e.map(function(d){return vr(d,o,i)}),s=new Set(a.map(function(d){return d.id})),u=new Set(Object.keys(n).map(function(d){return n[d].id})),Object.keys(o).forEach(function(d){o[d].forEach(function(f){!f||f.isDisposed||s.has(f.id)||u.has(f.id)||l.weightIds.indexOf(f.id)!==-1||f.dispose()})}),[2,a]}})})},t.prototype.executeWithControlFlow=function(n,e,r){return hu(this,void 0,void 0,function(){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,y,b,w=this;return mu(this,function(x){switch(x.label){case 0:i=Object.keys(n),o=i.map(function(C){return w.graph.nodes[C]}),a=r.map(function(C){return w.graph.nodes[tf(C)[0]]}),s=Bk(n,a,this.weightMap),u=s.usedNodes,l=s.missingInputs,c=s.dynamicNode,d=s.syncInputs,f=o.concat(this.graph.weights).map(function(C){return{node:C,contexts:e.currentContext}}),p=jw({},this.weightMap),Object.keys(n).forEach(function(C){p[C]=[n[C]]}),h={},v=this.getFrozenTensorIds(p),g={},x.label=1;case 1:return f.length>0?(m=this.processStack(o,f,e,p,g,v,r,h,u),[4,Promise.all(m)]):[3,3];case 2:return x.sent(),[3,1];case 3:if(c==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(y=a.filter(function(C){return!nF(C)&&!vr(C.name,p,e)}).map(function(C){return C.name})).length>0)throw b="",c!=null&&(b="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+d+"]"),new Error("Cannot compute the outputs ["+y+"] from the provided inputs ["+i+"]. Consider providing the following inputs: ["+l+"]. "+b);return[2,p]}})})},t.prototype.processStack=function(n,e,r,i,o,a,s,u,l){for(var c=this,d=[],f=function(){var h=e.pop();r.currentContext=h.contexts;var v="";if(h.node.op==="Enter"&&z("isConstant",h.node,i,r)&&(v=ym(h.node.name,r)[0]),n.indexOf(h.node)===-1){var g=Fk(h.node,i,r);v||(v=ym(h.node.name,r)[0]);var m=r.currentContext;g instanceof Promise?d.push(g.then(function(y){return i[v]=y,r.currentContext=m,c.checkTensorForDisposal(v,h.node,i,r,a,s,u),c.processChildNodes(h.node,e,r,i,o,l),y})):(i[v]=g,p.checkTensorForDisposal(v,h.node,i,r,a,s,u),p.processChildNodes(h.node,e,r,i,o,l))}else p.processChildNodes(h.node,e,r,i,o,l)},p=this;e.length>0;)f();return d},t.prototype.processChildNodes=function(n,e,r,i,o,a){n.children.forEach(function(s){var u=ym(s.name,r)[0];!o[u]&&a.has(s.name)&&(s.op==="Merge"?s.inputNames.some(function(l){return!!vr(l,i,r)})&&(o[u]=!0,e.push({contexts:r.currentContext,node:s})):s.inputNames.every(function(l){return!!vr(l,i,r)})&&(o[u]=!0,e.push({contexts:r.currentContext,node:s})))})},t.prototype.dispose=function(){var n=this;Object.keys(this.weightMap).forEach(function(e){return n.weightMap[e].forEach(function(r){return r.dispose()})})},t.prototype.checkInputShapeAndType=function(n){var e=this;Object.keys(n).forEach(function(r){var i=n[r],o=e.graph.nodes[r];if(o.attrParams.shape&&o.attrParams.shape.value){var a=o.attrParams.shape.value,s=a.length===i.shape.length&&i.shape.every(function(u,l){return a[l]===-1||a[l]===u});Fe.assert(s,function(){return"The shape of dict['"+o.name+"'] provided in model.execute(dict) must be ["+a+"], but was ["+i.shape+"]"})}o.attrParams.dtype&&o.attrParams.dtype.value&&Fe.assert(i.dtype===o.attrParams.dtype.value,function(){return"The dtype of dict['"+o.name+"'] provided in model.execute(dict) must be "+o.attrParams.dtype.value+", but was "+i.dtype})})},t.prototype.checkInputs=function(n){var e=this,r=Object.keys(n).filter(function(i){return!e.graph.nodes[i]});if(r.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+r+"] that are not part of graph")},t.prototype.checkOutputs=function(n){var e=this;n.forEach(function(r){var i=tf(r)[0];if(!e.graph.nodes[i])throw new Error("The output '"+r+"' is not found in the graph")})},t}(),dZ="?tfjs-format=file",fZ="model.json",rF=function(){function t(n,e){e===void 0&&(e={}),this.modelUrl=n,this.loadOptions=e,this.version="n/a",e==null&&(this.loadOptions={})}return Object.defineProperty(t.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),t.prototype.findIOHandler=function(){var n=this.modelUrl;if(n.load!=null)this.handler=n;else if(this.loadOptions.requestInit!=null)this.handler=Yr.browserHTTPRequest(n,this.loadOptions);else{var e=Yr.getLoadHandlers(n,this.loadOptions.onProgress);if(e.length===0)e.push(Yr.browserHTTPRequest(n,this.loadOptions));else if(e.length>1)throw new Error("Found more than one ("+e.length+") load handlers for URL '"+[n]+"'");this.handler=e[0]}},t.prototype.load=function(){return hu(this,void 0,void 0,function(){var n,e,r;return mu(this,function(i){switch(i.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return n=i.sent(),e=n.modelTopology,this.version=e.versions.producer+"."+e.versions.minConsumer,r=Yr.decodeWeights(n.weightData,n.weightSpecs),this.executor=new cZ(jQ.Instance.transformGraph(e)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),[2,!0]}})})},t.prototype.predict=function(n,e){return this.execute(n,this.outputNodes)},t.prototype.normalizeInputs=function(n){if(!(n instanceof At||Array.isArray(n)))return n;if((n=Array.isArray(n)?n:[n]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+n.length+" input tensors.");return this.inputNodes.reduce(function(e,r,i){return e[r]=n[i],e},{})},t.prototype.normalizeOutputs=function(n){return n=n||this.outputNodes,Array.isArray(n)?n:[n]},t.prototype.execute=function(n,e){n=this.normalizeInputs(n),e=this.normalizeOutputs(e);var r=this.executor.execute(n,e);return r.length>1?r:r[0]},t.prototype.executeAsync=function(n,e){return hu(this,void 0,void 0,function(){var r;return mu(this,function(i){switch(i.label){case 0:return n=this.normalizeInputs(n),e=this.normalizeOutputs(e),[4,this.executor.executeAsync(n,e)];case 1:return[2,(r=i.sent()).length>1?r:r[0]]}})})},t.prototype.convertTensorMapToTensorsMap=function(n){return Object.keys(n).reduce(function(e,r){return e[r]=[n[r]],e},{})},t.prototype.dispose=function(){this.executor.dispose()},t}();function pZ(t,n){return n===void 0&&(n={}),hu(this,void 0,void 0,function(){var e;return mu(this,function(r){switch(r.label){case 0:if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return n==null&&(n={}),n.fromTFHub&&t.load==null&&(t.endsWith("/")||(t+="/"),t=""+t+fZ+dZ),[4,(e=new rF(t,n)).load()];case 1:return r.sent(),[2,e]}})})}var iF="1.3.1";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var oF=function(t,n){return(oF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])})(t,n)};function It(t,n){function e(){this.constructor=t}oF(t,n),t.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}function Se(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(c){o(c)}}function s(l){try{u(r.throw(l))}catch(c){o(c)}}function u(l){l.done?i(l.value):new e(function(c){c(l.value)}).then(a,s)}u((r=r.apply(t,n||[])).next())})}function Ee(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(l){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){a.label=c[1];break}if(c[0]===6&&a.label<i[1]){a.label=i[1],i=c;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=n.call(t,a)}catch(d){c=[6,d],r=0}finally{e=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function Ou(t,n){return t(n={exports:{}},n.exports),n.exports}var hZ=Ou(function(t){(function(n,e,r){function i(a,s){return s.c=a.c,s.s0=a.s0,s.s1=a.s1,s.s2=a.s2,s}function o(a,s){var u=new function(d){var f,p=this,h=(f=4022871197,function(v){v=v.toString();for(var g=0;g<v.length;g++){var m=.02519603282416938*(f+=v.charCodeAt(g));m-=f=m>>>0,f=(m*=f)>>>0,f+=4294967296*(m-=f)}return 23283064365386963e-26*(f>>>0)});p.next=function(){var v=2091639*p.s0+23283064365386963e-26*p.c;return p.s0=p.s1,p.s1=p.s2,p.s2=v-(p.c=0|v)},p.c=1,p.s0=h(" "),p.s1=h(" "),p.s2=h(" "),p.s0-=h(d),p.s0<0&&(p.s0+=1),p.s1-=h(d),p.s1<0&&(p.s1+=1),p.s2-=h(d),p.s2<0&&(p.s2+=1),h=null}(a),l=s&&s.state,c=u.next;return c.int32=function(){return 4294967296*u.next()|0},c.double=function(){return c()+11102230246251565e-32*(2097152*c()|0)},c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(0,t,!1)}),mZ=Ou(function(t){(function(n,e,r){function i(a,s){return s.x=a.x,s.y=a.y,s.z=a.z,s.w=a.w,s}function o(a,s){var u=new function(d){var f=this,p="";f.x=0,f.y=0,f.z=0,f.w=0,f.next=function(){var v=f.x^f.x<<11;return f.x=f.y,f.y=f.z,f.z=f.w,f.w^=f.w>>>19^v^v>>>8},d===(0|d)?f.x=d:p+=d;for(var h=0;h<p.length+64;h++)f.x^=0|p.charCodeAt(h),f.next()}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(d===0);return d},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(0,t,!1)}),vZ=Ou(function(t){(function(n,e,r){function i(a,s){return s.x=a.x,s.y=a.y,s.z=a.z,s.w=a.w,s.v=a.v,s.d=a.d,s}function o(a,s){var u=new function(d){var f=this,p="";f.next=function(){var v=f.x^f.x>>>2;return f.x=f.y,f.y=f.z,f.z=f.w,f.w=f.v,(f.d=f.d+362437|0)+(f.v=f.v^f.v<<4^v^v<<1)|0},f.x=0,f.y=0,f.z=0,f.w=0,f.v=0,d===(0|d)?f.x=d:p+=d;for(var h=0;h<p.length+64;h++)f.x^=0|p.charCodeAt(h),h==p.length&&(f.d=f.x<<10^f.x>>>4),f.next()}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(d===0);return d},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(0,t,!1)}),gZ=Ou(function(t){(function(n,e,r){function i(a,s){return s.x=a.x.slice(),s.i=a.i,s}function o(a,s){a==null&&(a=+new Date);var u=new function(d){var f=this;f.next=function(){var p,h,v=f.x,g=f.i;return p=v[g],h=(p^=p>>>7)^p<<24,h^=(p=v[g+1&7])^p>>>10,h^=(p=v[g+3&7])^p>>>3,h^=(p=v[g+4&7])^p<<7,p=v[g+7&7],h^=(p^=p<<13)^p<<9,v[g]=h,f.i=g+1&7,h},function(p,h){var v,g=[];if(h===(0|h))g[0]=h;else for(h=""+h,v=0;v<h.length;++v)g[7&v]=g[7&v]<<15^h.charCodeAt(v)+g[v+1&7]<<13;for(;g.length<8;)g.push(0);for(v=0;v<8&&g[v]===0;++v);for(v==8?g[7]=-1:g[v],p.x=g,p.i=0,v=256;v>0;--v)p.next()}(f,d)}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(d===0);return d},c.int32=u.next,c.quick=c,l&&(l.x&&i(l,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(0,t,!1)}),yZ=Ou(function(t){(function(n,e,r){function i(a,s){return s.i=a.i,s.w=a.w,s.X=a.X.slice(),s}function o(a,s){a==null&&(a=+new Date);var u=new function(d){var f=this;f.next=function(){var p,h,v=f.w,g=f.X,m=f.i;return f.w=v=v+1640531527|0,h=g[m+34&127],p=g[m=m+1&127],h^=h<<13,p^=p<<17,h^=h>>>15,p^=p>>>12,h=g[m]=h^p,f.i=m,h+(v^v>>>16)|0},function(p,h){var v,g,m,y,b,w=[],x=128;for(h===(0|h)?(g=h,h=null):(h+="\0",g=0,x=Math.max(x,h.length)),m=0,y=-32;y<x;++y)h&&(g^=h.charCodeAt((y+32)%h.length)),y===0&&(b=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,y>=0&&(b=b+1640531527|0,m=(v=w[127&y]^=g+b)==0?m+1:0);for(m>=128&&(w[127&(h&&h.length||0)]=-1),m=127,y=512;y>0;--y)g=w[m+34&127],v=w[m=m+1&127],g^=g<<13,v^=v<<17,g^=g>>>15,v^=v>>>12,w[m]=g^v;p.w=b,p.X=w,p.i=m}(f,d)}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(d===0);return d},c.int32=u.next,c.quick=c,l&&(l.X&&i(l,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(0,t,!1)}),bZ=Ou(function(t){(function(n,e,r){function i(a,s){return s.a=a.a,s.b=a.b,s.c=a.c,s.d=a.d,s}function o(a,s){var u=new function(d){var f=this,p="";f.next=function(){var v=f.b,g=f.c,m=f.d,y=f.a;return v=v<<25^v>>>7^g,g=g-m|0,m=m<<24^m>>>8^y,y=y-v|0,f.b=v=v<<20^v>>>12^g,f.c=g=g-m|0,f.d=m<<16^g>>>16^y,f.a=y-v|0},f.a=0,f.b=0,f.c=-1640531527,f.d=1367130551,d===Math.floor(d)?(f.a=d/4294967296|0,f.b=0|d):p+=d;for(var h=0;h<p.length+20;h++)f.b^=0|p.charCodeAt(h),f.next()}(a),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var d=((u.next()>>>11)+(u.next()>>>0)/4294967296)/2097152;while(d===0);return d},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(0,t,!1)}),zs=Ou(function(t){(function(n,e){var r,i=this,o=256,a=6,s="random",u=e.pow(o,a),l=e.pow(2,52),c=2*l,d=o-1;function f(g,m,y){var b=[],w=h(function E(S,k){var N,M=[],D=typeof S;if(k&&D=="object")for(N in S)try{M.push(E(S[N],k-1))}catch{}return M.length?M:D=="string"?S:S+"\0"}((m=m==1?{entropy:!0}:m||{}).entropy?[g,v(n)]:g??function(){try{var E;return r&&(E=r.randomBytes)?E=E(o):(E=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(E)),v(E)}catch{var S=i.navigator,k=S&&S.plugins;return[+new Date,i,k,i.screen,v(n)]}}(),3),b),x=new function(E){var S,k=E.length,N=this,M=0,D=N.i=N.j=0,T=N.S=[];for(k||(E=[k++]);M<o;)T[M]=M++;for(M=0;M<o;M++)T[M]=T[D=d&D+E[M%k]+(S=T[M])],T[D]=S;(N.g=function(O){for(var P,A=0,I=N.i,_=N.j,F=N.S;O--;)P=F[I=d&I+1],A=A*o+F[d&(F[I]=F[_=d&_+P])+(F[_]=P)];return N.i=I,N.j=_,A})(o)}(b),C=function(){for(var E=x.g(a),S=u,k=0;E<l;)E=(E+k)*o,S*=o,k=x.g(1);for(;E>=c;)E/=2,S/=2,k>>>=1;return(E+k)/S};return C.int32=function(){return 0|x.g(4)},C.quick=function(){return x.g(4)/4294967296},C.double=C,h(v(x.S),n),(m.pass||y||function(E,S,k,N){return N&&(N.S&&p(N,x),E.state=function(){return p(x,{})}),k?(e[s]=E,S):E})(C,w,"global"in m?m.global:this==e,m.state)}function p(g,m){return m.i=g.i,m.j=g.j,m.S=g.S.slice(),m}function h(g,m){for(var y,b=g+"",w=0;w<b.length;)m[d&w]=d&(y^=19*m[d&w])+b.charCodeAt(w++);return v(m)}function v(g){return String.fromCharCode.apply(0,g)}if(e["seed"+s]=f,h(e.random(),n),t.exports){t.exports=f;try{r=require("crypto")}catch{}}})([],Math)});zs.alea=hZ,zs.xor128=mZ,zs.xorwow=vZ,zs.xorshift7=gZ,zs.xor4096=yZ,zs.tychei=bZ;var wZ=zs,aF=wZ.alea;function xZ(t,n){return kv(t,n)}function kv(t,n,e,r){if(e===void 0&&(e=new Map),r===void 0&&(r=new Set),t==null)return null;if(r.has(t))throw new Error("Circular references are not supported.");if(e.has(t))return e.get(t);var i=n(t);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(cc(t)){var o=Array.isArray(t)?[]:{};for(var a in r.add(t),t){var s=kv(t[a],n,e,r);o[a]=s}return r.delete(t),o}throw new Error("Can't recurse into non-iterable type: "+t)}return e.set(t,i.value),i.value}function SZ(t,n){return n===void 0&&(n=uF),sF(t,n)}function sF(t,n,e){e===void 0&&(e=new Set);var r=t[0];if(e.has(r))throw new Error("Circular references are not supported.");var i=n(t);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(cc(r)){var o=Array.isArray(r)?[]:{};e.add(r);var a=function(u){var l=sF(t.map(function(c){return c[u]}),n,e);o[u]=l};for(var s in r)a(s);return e.delete(r),o}throw new Error("Can't recurse into non-iterable type: "+r)}return i.value}function uF(t){return t===null?null:cc(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function lF(t,n){return Se(this,void 0,void 0,function(){var e,r,i,o,a,s;return Ee(this,function(u){switch(u.label){case 0:e=new Map,kv(t,n,e),r=0,i=Array.from(e.keys()),u.label=1;case 1:return r<i.length?(o=i[r],(a=e.get(o))instanceof Promise?[4,a]:[3,3]):[3,4];case 2:s=u.sent(),e.set(o,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,kv(t,n,e)]}})})}function cc(t){return t!=null&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||typeof t=="object"&&!(t instanceof At))}function EZ(t){return t==null||CZ(t)||Array.isArray(t)||typeof t=="object"&&t instanceof At||Fe.isTypedArray(t)}function CZ(t){return t===null||typeof t!="object"&&typeof t!="function"}function RZ(t){return xZ(t,TZ)}function TZ(t){return t instanceof At?{value:t.clone(),recurse:!1}:cc(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}var cF=function(){function t(n){if(this.capacity=n,this.begin=0,this.end=0,n==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(n<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(n),this.doubledCapacity=2*n}return t.prototype.wrap=function(n){for(;n<0;)n+=this.doubledCapacity;return n%this.doubledCapacity},t.prototype.get=function(n){if(n<0)throw new RangeError("Can't get item at a negative index.");return this.data[n%this.capacity]},t.prototype.set=function(n,e){if(n<0)throw new RangeError("Can't set item at a negative index.");this.data[n%this.capacity]=e},t.prototype.length=function(){var n=this.end-this.begin;return n<0&&(n=this.doubledCapacity+n),n},t.prototype.isFull=function(){return this.length()===this.capacity},t.prototype.isEmpty=function(){return this.length()===0},t.prototype.push=function(n){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,n),this.end=this.wrap(this.end+1)},t.prototype.pushAll=function(n){for(var e=0,r=n;e<r.length;e++){var i=r[e];this.push(i)}},t.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var n=this.get(this.end);return this.set(this.end,void 0),n},t.prototype.unshift=function(n){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,n)},t.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var n=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),n},t.prototype.shuffleExcise=function(n){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+n),r=this.get(e);return this.set(e,this.pop()),r},t}(),NZ=function(t){function n(){return t.call(this,n.INITIAL_CAPACITY)||this}return It(n,t),n.prototype.isFull=function(){return!1},n.prototype.push=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.push.call(this,e)},n.prototype.unshift=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.unshift.call(this,e)},n.prototype.expand=function(){for(var e=2*this.capacity,r=new Array(e),i=this.length(),o=0;o<i;o++)r[o]=this.get(this.wrap(this.begin+o));this.data=r,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=i},n.INITIAL_CAPACITY=32,n}(cF);function dF(t){return new _Z(t)}function t2(t){return new AZ(t)}function kZ(t,n){return new fF(t,n)}function IZ(t,n){return n===void 0&&(n=za.FAIL),new jZ(t,n)}var za,_n=function(){function t(){}return t.prototype.toArray=function(){return Se(this,void 0,void 0,function(){var n,e;return Ee(this,function(r){switch(r.label){case 0:return n=[],[4,this.next()];case 1:e=r.sent(),r.label=2;case 2:return e.done?[3,4]:(n.push(e.value),[4,this.next()]);case 3:return e=r.sent(),[3,2];case 4:return[2,n]}})})},t.prototype.toArrayForTest=function(){return Se(this,void 0,void 0,function(){var n,e,r;return Ee(this,function(i){switch(i.label){case 0:return n=this.prefetch(100),e=[],[4,n.next()];case 1:r=i.sent(),i.label=2;case 2:return r.done?[3,4]:(e.push(r.value),[4,n.next()]);case 3:return r=i.sent(),[3,2];case 4:return[2,e]}})})},t.prototype.resolveFully=function(){return Se(this,void 0,void 0,function(){var n;return Ee(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:n=e.sent(),e.label=2;case 2:return n.done?[3,4]:[4,this.next()];case 3:return n=e.sent(),[3,2];case 4:return[2]}})})},t.prototype.resolveWhile=function(n){return Se(this,void 0,void 0,function(){var e,r;return Ee(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:e=i.sent(),r=n(e.value),i.label=2;case 2:return e.done||!r?[3,4]:[4,this.next()];case 3:return e=i.sent(),r=n(e.value),[3,2];case 4:return[2]}})})},t.prototype.handleErrors=function(n){return new zZ(this,n)},t.prototype.filter=function(n){return new LZ(this,n)},t.prototype.map=function(n){return new FZ(this,n)},t.prototype.mapAsync=function(n){return new jk(this,n)},t.prototype.serialMapAsync=function(n){return new jk(this,n).serial()},t.prototype.flatmap=function(n){return new BZ(this,n)},t.prototype.forEachAsync=function(n){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return[2,this.map(n).resolveFully()]})})},t.prototype.serialForEach=function(n){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return[2,this.serialMapAsync(n).resolveWhile(function(r){return r===!0})]})})},t.prototype.rowMajorBatch=function(n,e){return e===void 0&&(e=!0),new PZ(this,n,e)},t.prototype.columnMajorBatch=function(n,e,r){return e===void 0&&(e=!0),r===void 0&&(r=uF),this.rowMajorBatch(n,e).map(function(i){return SZ(i,r)})},t.prototype.concatenate=function(n,e){return new fF(dF([this,n]),e)},t.prototype.take=function(n){return n<0||n==null?this:new MZ(this,n)},t.prototype.skip=function(n){return n<0||n==null?this:new DZ(this,n)},t.prototype.prefetch=function(n){return new pF(this,n)},t.prototype.shuffle=function(n,e){return new VZ(this,n,e)},t.prototype.serial=function(){return new OZ(this)},t}(),_Z=function(t){function n(e){var r=t.call(this)||this;return r.items=e,r.trav=0,r}return It(n,t),n.prototype.summary=function(){return"Array of "+this.items.length+" items"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e;return Ee(this,function(r){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(e=this.items[this.trav],this.trav++,[2,{value:RZ(e),done:!1}])})})},n}(_n),AZ=function(t){function n(e){var r=t.call(this)||this;return r.nextFn=e,r}return It(n,t),n.prototype.summary=function(){return"Function call"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){try{return[2,this.nextFn()]}catch(r){throw r.message="Error thrown while iterating through a dataset: "+r.message,r}return[2]})})},n}(_n),OZ=function(t){function n(e){var r=t.call(this)||this;return r.upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e=this;return Ee(this,function(r){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},n.prototype.serialNext=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return[2,this.upstream.next()]})})},n}(_n),DZ=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.maxCount=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e=this;return Ee(this,function(r){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},n.prototype.serialNext=function(){return Se(this,void 0,void 0,function(){var e;return Ee(this,function(r){switch(r.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(e=r.sent()).done?[2,e]:(Ze(e.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},n}(_n),MZ=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.maxCount=r,i.count=0,i}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> Take"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},n}(_n),PZ=function(t){function n(e,r,i){i===void 0&&(i=!0);var o=t.call(this)||this;return o.upstream=e,o.batchSize=r,o.enableSmallLastBatch=i,o.lastRead=Promise.resolve({value:null,done:!1}),o}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e=this;return Ee(this,function(r){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},n.prototype.serialNext=function(){return Se(this,void 0,void 0,function(){var e,r;return Ee(this,function(i){switch(i.label){case 0:e=[],i.label=1;case 1:return e.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(r=i.sent()).done?this.enableSmallLastBatch&&e.length>0?[2,{value:e,done:!1}]:[2,{value:null,done:!0}]:(e.push(r.value),[3,1]);case 3:return[2,{value:e,done:!1}]}})})},n}(_n),LZ=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.predicate=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e=this;return Ee(this,function(r){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},n.prototype.serialNext=function(){return Se(this,void 0,void 0,function(){var e;return Ee(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(e=r.sent()).done||this.predicate(e.value)?[2,e]:(Ze(e.value),[3,0]);case 2:return[2]}})})},n}(_n),FZ=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.transform=r,i}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> Map"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e,r,i,o,a,s,u;return Ee(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((e=l.sent()).done)return[2,{value:null,done:!0}];for(r=yo.getTensorsInContainer(e.value),i=this.transform(e.value),o=yo.getTensorsInContainer(i),a=0,s=r;a<s.length;a++)u=s[a],yo.isTensorInList(u,o)||u.dispose();return[2,{value:i,done:!1}]}})})},n}(_n),zZ=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.handler=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e=this;return Ee(this,function(r){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},n.prototype.serialNext=function(){return Se(this,void 0,void 0,function(){var e;return Ee(this,function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,r.sent()];case 3:return e=r.sent(),this.handler(e)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},n}(_n),jk=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.transform=r,i}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e,r,i,o,a,s,u;return Ee(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:return(e=l.sent()).done?[2,{value:null,done:!0}]:(r=yo.getTensorsInContainer(e.value),[4,this.transform(e.value)]);case 2:for(i=l.sent(),o=yo.getTensorsInContainer(i),a=0,s=r;a<s.length;a++)u=s[a],yo.isTensorInList(u,o)||u.dispose();return[2,{value:i,done:!1}]}})})},n}(_n),n2=function(t){function n(){var e=t.call(this)||this;return e.outputQueue=new NZ,e.lastRead=Promise.resolve({value:null,done:!1}),e}return It(n,t),n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e=this;return Ee(this,function(r){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},n.prototype.serialNext=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){switch(e.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return e.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},n}(_n),BZ=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.transform=r,i}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},n.prototype.pump=function(){return Se(this,void 0,void 0,function(){var e,r,i,o,a,s,u;return Ee(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((e=l.sent()).done)return[2,!1];for(r=yo.getTensorsInContainer(e.value),i=this.transform(e.value),o=yo.getTensorsInContainer(i),this.outputQueue.pushAll(i),a=0,s=r;a<s.length;a++)u=s[a],yo.isTensorInList(u,o)||u.dispose();return[2,!0]}})})},n}(n2),fF=function(t){function n(e,r){var i=t.call(this)||this;return i.baseErrorHandler=r,i.lastRead=null,i.iterator=null,i.moreIterators=e,i}return It(n,t),n.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},n.prototype.next=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},n.prototype.readFromChain=function(e){return Se(this,void 0,void 0,function(){var r,i;return Ee(this,function(o){switch(o.label){case 0:return[4,e];case 1:return o.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((r=o.sent()).done)return[2,{value:null,done:!0}];this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),o.label=3;case 3:return[4,this.iterator.next()];case 4:return(i=o.sent()).done?(this.iterator=null,[2,this.readFromChain(e)]):[2,i]}})})},n}(_n);(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(za||(za={}));var jZ=function(t){function n(e,r){r===void 0&&(r=za.FAIL);var i=t.call(this)||this;return i.iterators=e,i.mismatchMode=r,i.count=0,i.currentPromise=null,i}return It(n,t),n.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},n.prototype.nextState=function(e){return Se(this,void 0,void 0,function(){function r(s){return s instanceof _n?{value:s.next().then(function(u){return i++,u.done&&o++,u.value}),recurse:!1}:{value:null,recurse:!0}}var i,o,a;return Ee(this,function(s){switch(s.label){case 0:return[4,e];case 1:return s.sent(),i=0,o=0,[4,lF(this.iterators,r)];case 2:if(a=s.sent(),i===o)return[2,{value:null,done:!0}];if(o>0)switch(this.mismatchMode){case za.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case za.SHORTEST:return[2,{value:null,done:!0}];case za.LONGEST:}return this.count++,[2,{value:a,done:!1}]}})})},n.prototype.next=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},n}(_n),pF=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.bufferSize=r,i.buffer=new cF(r),i}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},n.prototype.refill=function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}},n.prototype.next=function(){return this.refill(),this.buffer.shift()},n}(_n),VZ=function(t){function n(e,r,i){var o=t.call(this,e,r)||this;return o.upstream=e,o.windowSize=r,o.upstreamExhausted=!1,o.random=aF(i||Fe.now().toString()),o.lastRead=Promise.resolve({value:null,done:!1}),o}return It(n,t),n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e=this;return Ee(this,function(r){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},n.prototype.randomInt=function(e){return Math.floor(this.random()*e)},n.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},n.prototype.serialNext=function(){return Se(this,void 0,void 0,function(){var e,r;return Ee(this,function(i){switch(i.label){case 0:this.upstreamExhausted||this.refill(),i.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(e=this.chooseIndex(),[4,this.buffer.shuffleExcise(e)]);case 2:return(r=i.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,r]);case 3:return[2,{value:null,done:!0}]}})})},n}(pF),Tp=function(){function t(){this.size=null}return t.prototype.batch=function(n,e){var r=this;e===void 0&&(e=!0);var i=this;return Fe.assert(n>0,function(){return`batchSize needs to be positive, but it is
      `+n}),Rr(function(){return Se(r,void 0,void 0,function(){return Ee(this,function(o){switch(o.label){case 0:return[4,i.iterator()];case 1:return[2,o.sent().columnMajorBatch(n,e,WZ)]}})})},this.size===1/0||this.size==null?this.size:e?Math.ceil(this.size/n):Math.floor(this.size/n))},t.prototype.concatenate=function(n){var e=this,r=this;return Rr(function(){return Se(e,void 0,void 0,function(){var i,o;return Ee(this,function(a){switch(a.label){case 0:return[4,r.iterator()];case 1:return o=(i=a.sent()).concatenate,[4,n.iterator()];case 2:return[2,o.apply(i,[a.sent()])]}})})},this.size===1/0||n.size===1/0?1/0:this.size!=null&&n.size!=null?this.size+n.size:null)},t.prototype.filter=function(n){var e=this,r=this;return Rr(function(){return Se(e,void 0,void 0,function(){return Ee(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().filter(function(o){return ee(function(){return n(o)})})]}})})},this.size===1/0?1/0:null)},t.prototype.forEachAsync=function(n){return Se(this,void 0,void 0,function(){return Ee(this,function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEachAsync(n)]}})})},t.prototype.forEach=function(n){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return yg("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(n)]})})},t.prototype.map=function(n){var e=this,r=this;return Rr(function(){return Se(e,void 0,void 0,function(){return Ee(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().map(function(o){return ee(function(){return n(o)})})]}})})},this.size)},t.prototype.mapAsync=function(n){var e=this,r=this;return Rr(function(){return Se(e,void 0,void 0,function(){return Ee(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().mapAsync(n)]}})})},this.size)},t.prototype.prefetch=function(n){var e=this;if(n==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var r=this;return Rr(function(){return Se(e,void 0,void 0,function(){return Ee(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().prefetch(n)]}})})},this.size)},t.prototype.repeat=function(n){var e=this,r=this;return Rr(function(){return Se(e,void 0,void 0,function(){var i=this;return Ee(this,function(o){return[2,kZ(t2(function(){return Se(i,void 0,void 0,function(){var a;return Ee(this,function(s){switch(s.label){case 0:return a={},[4,r.iterator()];case 1:return[2,(a.value=s.sent(),a.done=!1,a)]}})})}).take(n))]})})},this.size!=null&&n>0?this.size*n:n===0?0:this.size!=null&&(n===void 0||n<0)?1/0:null)},t.prototype.skip=function(n){var e=this,r=this;return Rr(function(){return Se(e,void 0,void 0,function(){return Ee(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().skip(n)]}})})},this.size!=null&&n>=0&&this.size>=n?this.size-n:this.size!=null&&(this.size<n||n===void 0||n<0)?0:null)},t.prototype.shuffle=function(n,e,r){var i=this;if(r===void 0&&(r=!0),n==null||n<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var o=this,a=aF(e||Fe.now().toString());return Rr(function(){return Se(i,void 0,void 0,function(){var s;return Ee(this,function(u){switch(u.label){case 0:return s=a.int32(),r&&(s+=a.int32()),[4,o.iterator()];case 1:return[2,u.sent().shuffle(n,s.toString())]}})})},this.size)},t.prototype.take=function(n){var e=this,r=this;return Rr(function(){return Se(e,void 0,void 0,function(){return Ee(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().take(n)]}})})},this.size!=null&&this.size>n?n:this.size!=null&&this.size<=n?this.size:null)},t.prototype.toArray=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(n){switch(n.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,n.sent().toArray()]}})})},t.prototype.toArrayForTest=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(n){switch(n.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,n.sent().toArrayForTest()]}})})},t.MAX_BUFFER_SIZE=1e4,t}();function Rr(t,n){return n===void 0&&(n=null),new(function(e){function r(){var i=e!==null&&e.apply(this,arguments)||this;return i.size=n,i}return It(r,e),r.prototype.iterator=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(i){return[2,t()]})})},r}(Tp))}function $Z(t){var n=this;return Rr(function(){return Se(n,void 0,void 0,function(){return Ee(this,function(e){return[2,dF(t)]})})},t.length)}function UZ(t){var n,e=this;if(!cc(t))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(t))for(var r=0;r<t.length;r++)n=n==null?t[r].size:Math.min(n,t[r].size);else if(t instanceof Object)for(var i in t)n=n==null?t[i].size:Math.min(n,t[i].size);return Rr(function(){return Se(e,void 0,void 0,function(){return Ee(this,function(o){switch(o.label){case 0:return[4,lF(t,function(a){if(a instanceof Tp)return{value:a.iterator(),recurse:!1};if(cc(a))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})];case 1:return[2,IZ(o.sent(),za.SHORTEST)]}})})},n)}function WZ(t){return t===null?null:EZ(t[0])?{value:HZ(t),recurse:!1}:{value:null,recurse:!0}}function HZ(t){if(t.length===0)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof At?$i(t):mn(t)}var hF=function(t){function n(e){var r=t.call(this)||this;return r.input=e,r}return It(n,t),n.prototype.iterator=function(){return Se(this,void 0,void 0,function(){var e,r;return Ee(this,function(i){switch(i.label){case 0:return[4,this.input.iterator()];case 1:return e=i.sent(),r=e.decodeUTF8(),[2,r.split(`
`).map(function(o){return o.endsWith("\r")&&(o=o.slice(0,-1)),o})]}})})},n}(Tp),_h='"',fd=Symbol("out"),Vk=Symbol("field"),Ah=Symbol("quote"),b1=Symbol("quoteafterquote"),$k=Symbol("quoteinquote"),mF=function(t){function n(e,r){var i=t.call(this)||this;return i.input=e,i.hasHeader=!0,i.fullColumnNames=null,i.columnNamesValidated=!1,i.columnConfigs=null,i.configuredColumnsOnly=!1,i.delimiter=",",i.delimWhitespace=!1,i.base=new hF(e),r||(r={}),i.hasHeader=r.hasHeader!==!1,i.fullColumnNames=r.columnNames,i.columnConfigs=r.columnConfigs,i.configuredColumnsOnly=r.configuredColumnsOnly,r.delimWhitespace?(Fe.assert(r.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),i.delimWhitespace=!0,i.delimiter=" "):i.delimiter=r.delimiter?r.delimiter:",",i}return It(n,t),n.prototype.columnNames=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){switch(e.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:e.sent(),e.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},n.prototype.setColumnNames=function(){return Se(this,void 0,void 0,function(){var e,r,i,o,a,s,u=this;return Ee(this,function(l){switch(l.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(e=l.sent(),!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&e&&Fe.assert(e.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+u.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=e),r=this.fullColumnNames.reduce(function(c,d){return c[d]=c[d]+1||1,c},{}),i=Object.keys(r).filter(function(c){return r[c]>1}),Fe.assert(i.length===0,function(){return"Duplicate column names found: "+i.toString()}),this.columnConfigs){for(o=0,a=Object.keys(this.columnConfigs);o<a.length;o++)if(s=a[o],this.fullColumnNames.indexOf(s)===-1)throw new Error('The key "'+s+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},n.prototype.maybeReadHeaderLine=function(){return Se(this,void 0,void 0,function(){var e,r;return Ee(this,function(i){switch(i.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,i.sent().next()];case 2:if((e=i.sent()).done)throw new Error("No data was found for CSV parsing.");return r=e.value,[2,this.parseRow(r,!1)];case 3:return[2,null]}})})},n.prototype.iterator=function(){return Se(this,void 0,void 0,function(){var e,r=this;return Ee(this,function(i){switch(i.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:i.sent(),i.label=2;case 2:return[4,this.base.iterator()];case 3:return e=i.sent(),this.hasHeader&&(e=e.skip(1)),[2,e.map(function(o){return r.makeDataElement(o)})]}})})},n.prototype.makeDataElement=function(e){for(var r=this.parseRow(e),i={},o={},a=0;a<this.fullColumnNames.length;a++){var s=this.fullColumnNames[a],u=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||u){var l=r[a],c=null;if(l==="")if(u&&u.default!==void 0)c=u.default;else{if(u&&(u.required||u.isLabel))throw new Error("Required column "+s+" is empty in this line: "+e);c=void 0}else{var d=Number(l);if(isNaN(d))c=u&&u.dtype==="bool"?this.getBoolean(l):l;else if(u&&u.dtype)switch(u.dtype){case"float32":c=d;break;case"int32":c=Math.floor(d);break;case"bool":c=this.getBoolean(l);break;default:c=d}else c=d}u&&u.isLabel?o[s]=c:i[s]=c}}return Object.keys(o).length===0?i:{xs:i,ys:o}},n.prototype.getBoolean=function(e){return e==="1"||e.toLowerCase()==="true"?1:0},n.prototype.parseRow=function(e,r){r===void 0&&(r=!0);for(var i=[],o=0,a=e.length,s=fd,u=0;u<a;u++)switch(s){case fd:switch(e.charAt(u)){case _h:o=u+1,s=Ah;break;case this.delimiter:if(o=u+1,this.delimiter===" "&&this.delimWhitespace)break;i.push(""),s=fd;break;default:s=Vk,o=u}break;case Vk:switch(e.charAt(u)){case this.delimiter:i.push(e.substring(o,u)),s=fd,o=u+1}break;case Ah:switch(e.charAt(u)){case _h:s=b1}break;case b1:switch(e.charAt(u)){case this.delimiter:i.push(e.substring(o,u-1)),s=fd,o=u+1;break;case _h:s=Ah;break;default:s=$k}break;case $k:switch(e.charAt(u)){case _h:s=Ah}}if(s===b1?i.push(e.substring(o,a-1)):i.push(e.substring(o)),r&&i.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+i);return i},n}(Tp),GZ=function(t){function n(e){var r=t.call(this)||this;r.microphoneConfig=e,r.isClosed=!1,r.fftSize=e.fftSize||1024;var i=Math.log2(r.fftSize);if(r.fftSize<0||i<4||i>14||!Number.isInteger(i))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+r.fftSize);if(r.numFrames=e.numFramesPerSpectrogram||43,r.sampleRateHz=e.sampleRateHz,r.columnTruncateLength=e.columnTruncateLength||r.fftSize,r.audioTrackConstraints=e.audioTrackConstraints,r.smoothingTimeConstant=e.smoothingTimeConstant||0,r.includeSpectrogram=e.includeSpectrogram!==!1,r.includeWaveform=e.includeWaveform===!0,!r.includeSpectrogram&&!r.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return r}return It(n,t),n.prototype.summary=function(){return"microphone"},n.create=function(e){return e===void 0&&(e={}),Se(this,void 0,void 0,function(){var r;return Ee(this,function(i){switch(i.label){case 0:if(ie().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(r=new n(e)).start()];case 1:return i.sent(),[2,r]}})})},n.prototype.start=function(){return Se(this,void 0,void 0,function(){var e,r,i,o;return Ee(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return e.stream=a.sent(),[3,3];case 2:throw r=a.sent(),new Error("Error thrown while initializing video stream: "+r.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(i=window.AudioContext||window.webkitAudioContext,this.audioContext=new i,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return o=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,o.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e,r,i,o,a;return Ee(this,function(s){switch(s.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return i=s.sent(),this.includeSpectrogram&&(o=this.flattenQueue(i.freqDataQueue),e=this.getTensorFromAudioDataArray(o,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(a=this.flattenQueue(i.timeDataQueue),r=this.getTensorFromAudioDataArray(a,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:e,waveform:r},done:!1}]}})})},n.prototype.capture=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:return[2,e.sent().value]}})})},n.prototype.getAudioData=function(){return Se(this,void 0,void 0,function(){var e,r,i,o=this;return Ee(this,function(a){return e=[],r=[],i=0,[2,new Promise(function(s){var u=setInterval(function(){o.includeSpectrogram&&(o.analyser.getFloatFrequencyData(o.freqData),o.freqData[0]===-1/0&&s({freqDataQueue:e,timeDataQueue:r}),e.push(o.freqData.slice(0,o.columnTruncateLength))),o.includeWaveform&&(o.analyser.getFloatTimeDomainData(o.timeData),r.push(o.timeData.slice())),++i===o.numFrames&&(clearInterval(u),s({freqDataQueue:e,timeDataQueue:r}))},o.fftSize/o.sampleRateHz*1e3)})]})})},n.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},n.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},n.prototype.getSampleRate=function(){return this.sampleRateHz},n.prototype.flattenQueue=function(e){var r=e[0].length,i=new Float32Array(e.length*r);return e.forEach(function(o,a){return i.set(o,a*r)}),i},n.prototype.getTensorFromAudioDataArray=function(e,r){var i=new Float32Array(Fe.sizeFromShape(r));return i.set(e,i.length-e.length),mn(i,r)},n}(_n),qZ=function(t){function n(e,r){var i=t.call(this)||this;if(i.webcamVideoElement=e,i.webcamConfig=r,i.isClosed=!0,i.resize=!1,i.needToResize())if(i.resize=!0,i.cropSize=[i.webcamConfig.resizeHeight,i.webcamConfig.resizeWidth],i.cropBoxInd=zr([0],"int32"),i.webcamConfig.centerCrop){var o=1*i.webcamConfig.resizeWidth/i.webcamVideoElement.width,a=1*i.webcamConfig.resizeHeight/i.webcamVideoElement.height,s=(1-o)/2,u=(1-a)/2,l=s+o,c=a+u;i.cropBox=Go([u,s,c,l],[1,4])}else i.cropBox=Go([0,0,1,1],[1,4]);return i}return It(n,t),n.prototype.summary=function(){return"webcam"},n.create=function(e,r){return r===void 0&&(r={}),Se(this,void 0,void 0,function(){var i;return Ee(this,function(o){switch(o.label){case 0:if(ie().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!r.resizeWidth||!r.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=r.resizeWidth,e.height=r.resizeHeight}return[4,(i=new n(e,r)).start()];case 1:return o.sent(),[2,i]}})})},n.prototype.start=function(){return Se(this,void 0,void 0,function(){var e,r,i=this;return Ee(this,function(o){switch(o.label){case 0:this.webcamConfig.facingMode&&Fe.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+i.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),o.label=1;case 1:return o.trys.push([1,3,,4]),e=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return e.stream=o.sent(),[3,4];case 3:throw(r=o.sent()).message="Error thrown while initializing video stream: "+r.message,r;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(a){console.log(a),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(a){i.webcamVideoElement.onloadedmetadata=function(){a()}})]}})})},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e;return Ee(this,function(r){if(this.isClosed)return[2,{value:null,done:!0}];try{e=$L.fromPixels(this.webcamVideoElement)}catch(i){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(i))}if(!this.resize)return[2,{value:e,done:!1}];try{return[2,{value:this.cropAndResizeFrame(e),done:!1}]}catch(i){throw new Error("Error thrown cropping the video: "+i.message)}finally{e.dispose()}return[2]})})},n.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},n.prototype.cropAndResizeFrame=function(e){var r=this;return ee(function(){var i,o=e.toFloat().expandDims(0),a=(i=eu.cropAndResize(o,r.cropBox,r.cropBoxInd,r.cropSize,"bilinear")).shape;return i.reshape(a.slice(1))})},n.prototype.capture=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:return[2,e.sent().value]}})})},n.prototype.stop=function(){this.stream.getTracks().forEach(function(e){return e.stop()});try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0},n.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},n}(_n),vF=function(){return function(){}}(),gF=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return It(n,t),n.prototype.split=function(e){return new KZ(this,e)},n}(_n),KZ=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.impl=new XZ(e,r),i}return It(n,t),n.prototype.summary=function(){return this.impl.summary()},n.prototype.next=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return[2,this.impl.next()]})})},n}(gF),XZ=function(t){function n(e,r){var i=t.call(this)||this;return i.upstream=e,i.separator=r,i.carryover="",i}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},n.prototype.pump=function(){return Se(this,void 0,void 0,function(){var e,r,i,o,a;return Ee(this,function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((e=s.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((r=e.value.split(this.separator))[0]=this.carryover+r[0],i=0,o=r.slice(0,-1);i<o.length;i++)a=o[i],this.outputQueue.push(a);return this.carryover=r[r.length-1],[2,!0]}})})},n}(n2),YZ=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return It(n,t),n.prototype.decodeUTF8=function(){return new JZ(this)},n}(_n),JZ=function(t){function n(e){var r=t.call(this)||this;return r.upstream=e,r.impl=new QZ(e),r}return It(n,t),n.prototype.summary=function(){return this.impl.summary()},n.prototype.next=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return[2,this.impl.next()]})})},n}(gF),QZ=function(t){function n(e){var r=t.call(this)||this;if(r.upstream=e,ie().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var i=require("string_decoder").StringDecoder;r.decoder=new i("utf8")}return r}return It(n,t),n.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},n.prototype.pump=function(){return Se(this,void 0,void 0,function(){var e,r,i;return Ee(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:return(e=o.sent()).done?[2,!1]:(r=e.value,i=ie().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(Buffer.from(r.buffer)),this.outputQueue.push(i),[2,!0])}})})},n}(n2),yF=function(t){function n(e,r){r===void 0&&(r={});var i=t.call(this)||this;return i.file=e,i.options=r,Fe.assert(e instanceof Uint8Array||!!ie().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),i.offset=r.offset||0,i.chunkSize=r.chunkSize||1048576,i}return It(n,t),n.prototype.summary=function(){return"FileChunks "+this.file},n.prototype.next=function(){return Se(this,void 0,void 0,function(){var e,r,i=this;return Ee(this,function(o){switch(o.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(e=new Promise(function(a,s){var u=i.offset+i.chunkSize;if(i.file instanceof Uint8Array)a(new Uint8Array(i.file.slice(i.offset,u)));else{var l=new FileReader;l.onload=function(d){var f=l.result;if(f instanceof ArrayBuffer&&(f=new Uint8Array(f)),!(f instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));a(f)},l.onabort=function(d){return s(new Error("Aborted"))},l.onerror=function(d){return s(new Error(d.type))};var c=i.file.slice(i.offset,u);l.readAsArrayBuffer(c)}i.offset=u}),r={},[4,e]);case 1:return[2,(r.value=o.sent(),r.done=!1,r)]}})})},n}(YZ);function ZZ(t,n){return n===void 0&&(n={}),Se(this,void 0,void 0,function(){var e,r,i,o,a;return Ee(this,function(s){switch(s.label){case 0:return typeof t=="string"?e=t:(e=t.url,r=eee(t)),[4,Fe.fetch(e,r)];case 1:return(i=s.sent()).ok?(a=Uint8Array.bind,[4,i.arrayBuffer()]):[3,3];case 2:return o=new(a.apply(Uint8Array,[void 0,s.sent()])),[2,new yF(o,n)];case 3:throw new Error(i.statusText)}})})}var eee=function(t){return{method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity}};function bF(t){return typeof t=="string"&&t.substr(0,7)==="file://"}var wF=function(t){function n(e,r){r===void 0&&(r={});var i=t.call(this)||this;return i.input=e,i.options=r,i}return It(n,t),n.prototype.iterator=function(){return Se(this,void 0,void 0,function(){var e;return Ee(this,function(r){return bF(this.input)&&ie().get("IS_NODE")&&(e=require("fs"),this.input=e.readFileSync(this.input.substr(7))),[2,new yF(this.input,this.options)]})})},n}(vF),xF=function(t){function n(e,r){r===void 0&&(r={});var i=t.call(this)||this;return i.url=e,i.fileOptions=r,i}return It(n,t),n.prototype.iterator=function(){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return bF(this.url)?[2,new wF(this.url,this.fileOptions).iterator()]:[2,ZZ(this.url,this.fileOptions)]})})},n}(vF);function tee(t,n){return n===void 0&&(n={}),new mF(new xF(t),n)}function nee(t){var n=this,e=t2(t);return Rr(function(){return Se(n,void 0,void 0,function(){return Ee(this,function(r){return[2,e]})})})}function ree(t){var n=this;return Rr(function(){return Se(n,void 0,void 0,function(){var e;return Ee(this,function(r){switch(r.label){case 0:return[4,t()];case 1:return e=r.sent(),[2,t2(function(){return e.next()})]}})})})}function iee(t,n){return Se(this,void 0,void 0,function(){return Ee(this,function(e){return[2,qZ.create(t,n)]})})}function oee(t){return Se(this,void 0,void 0,function(){return Ee(this,function(n){return[2,GZ.create(t)]})})}var SF="1.3.1";const aee=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:mF,Dataset:Tp,FileDataSource:wF,TextLineDataset:hF,URLDataSource:xF,array:$Z,csv:tee,func:nee,generator:ree,microphone:oee,version_data:SF,webcam:iee,zip:UZ},Symbol.toStringTag,{value:"Module"}));var see="1.3.1",uee={"tfjs-core":GL,"tfjs-data":SF,"tfjs-layers":cy,"tfjs-converter":iF,tfjs:see};const lee=Object.freeze(Object.defineProperty({__proto__:null,AdadeltaOptimizer:xC,AdagradOptimizer:SC,AdamOptimizer:EC,AdamaxOptimizer:CC,Callback:Y4,CallbackList:w3,CustomCallback:S3,DataStorage:hE,get ENV(){return WS},EarlyStopping:J4,Environment:qD,GraphModel:rF,History:x3,InputSpec:Fn,KernelBackend:mE,LayerVariable:v3,LayersModel:ru,MomentumOptimizer:RC,Optimizer:da,RMSPropOptimizer:TC,RNN:Au,get Rank(){return fw},get Reduction(){return Xn},SGDOptimizer:iy,Sequential:UC,SymbolicTensor:Pi,Tensor:At,TensorBuffer:Ql,Variable:Df,abs:ss,acos:RE,acosh:TE,add:st,addN:XE,addStrict:KP,all:Kg,any:jf,argMax:Vf,argMin:iC,asin:NE,asinh:kE,atan:IE,atan2:YE,atanh:_E,avgPool:Wg,avgPool3d:Gg,backend:PM,backend_util:F7,basicLSTMCell:TL,batchNorm:WE,batchNorm2d:HE,batchNorm3d:GE,batchNorm4d:qE,batchNormalization:GP,batchNormalization2d:UP,batchNormalization3d:WP,batchNormalization4d:HP,batchToSpaceND:Sg,booleanMaskAsync:uL,browser:$L,buffer:He,callbacks:iQ,cast:Eg,ceil:AE,clipByValue:br,clone:VM,complex:Nn,concat:lr,concat1d:rE,concat2d:iE,concat3d:oE,concat4d:aE,constraints:gK,conv1d:Bg,conv2d:ku,conv2dTranspose:Vg,conv3d:jg,conv3dTranspose:hL,cos:OE,cosh:DE,cumsum:$M,customGrad:Nc,data:aee,deprecationWarn:yg,depthToSpace:uE,depthwiseConv2d:Ac,deregisterOp:aQ,diag:_L,disableDeprecationWarnings:c7,dispose:Ze,disposeVariables:d7,div:cr,divStrict:XP,dot:mL,dropout:fC,elu:Oc,enableDebugMode:l7,enableProdMode:u7,engine:f7,env:ie,equal:Nu,equalStrict:nL,erf:ME,exp:PE,expandDims:Hr,expm1:LE,eye:Cg,fft:vp,fill:Tc,findBackend:b7,findBackendFactory:w7,floor:_g,floorDiv:Fg,frame:ry,fused:oc,gather:_c,gatherND:dC,getBackend:g7,getKernel:KD,getKernelsForBackend:uw,grad:D7,grads:M7,greater:Ic,greaterEqual:fp,greaterEqualStrict:rL,greaterStrict:iL,hammingWindow:pC,hannWindow:ny,ifft:ic,imag:vi,image:eu,inTopKAsync:DL,initializers:JK,input:L3,io:Yr,irfft:ey,isFinite:zP,isInf:FP,isNaN:LP,keep:wo,layers:PJ,leakyRelu:Jg,less:ZE,lessEqual:eC,lessEqualStrict:oL,lessStrict:aL,linalg:mC,linspace:nE,loadGraphModel:pZ,loadLayersModel:rY,localResponseNormalization:aC,log:ra,log1p:FE,logSigmoid:PP,logSoftmax:kg,logSumExp:RL,logicalAnd:la,logicalNot:KE,logicalOr:Pg,logicalXor:qP,losses:ML,matMul:$g,math:rK,max:us,maxPool:Ug,maxPool3d:Hg,maximum:To,maximumStrict:YP,mean:gn,memory:fv,metrics:JJ,min:Xg,minimum:kc,minimumStrict:JP,mod:JE,modStrict:QP,model:tY,models:QJ,moments:mp,movingAverage:kL,mul:We,mulStrict:zg,multiRNNCell:NL,multinomial:lE,neg:Tu,nextFrame:gm,norm:sC,notEqual:nc,notEqualStrict:sL,oneHot:Zl,ones:Ro,onesLike:ti,op:X,outerProduct:vL,pad:ys,pad1d:UM,pad2d:WM,pad3d:HM,pad4d:GM,pool:EL,pow:tc,powStrict:ZP,prelu:Qg,print:jM,prod:Yg,profile:p7,rand:qM,randomGamma:KM,randomNormal:cE,randomUniform:Cu,range:wg,ready:v7,real:_r,reciprocal:zE,registerBackend:x7,registerCallbackConstructor:iY,registerKernel:lw,registerOp:oQ,regularizers:nQ,relu:ws,relu6:oC,removeBackend:y7,reshape:op,reverse:So,reverse1d:gL,reverse2d:yL,reverse3d:bL,reverse4d:wL,rfft:gp,round:BE,rsqrt:Ag,scalar:Ie,scatterND:cC,selu:Zg,separableConv2d:rC,sequential:nY,serialization:he,setBackend:m7,setPlatform:S7,setdiff1dAsync:dE,sigmoid:Og,sign:jE,signal:OL,sin:VE,sinh:$E,slice:ni,slice1d:pp,slice2d:qg,slice3d:hp,slice4d:rc,slice_util:O7,softmax:Ru,softplus:lp,spaceToBatchND:Rg,sparseToDense:ty,spectral:IL,split:qo,sqrt:cp,square:CE,squaredDifference:QE,squaredDifferenceStrict:eL,squeeze:ap,stack:$i,step:BP,stft:hC,stridedSlice:uC,sub:jn,subStrict:tL,sum:Br,tan:UE,tanh:Dg,tensor:mn,tensor1d:zr,tensor2d:Go,tensor3d:eE,tensor4d:Ta,tensor5d:zM,tensor6d:BM,tensor_util:yo,test_util:aK,tidy:ee,tile:Qa,time:h7,topk:lC,train:Ls,transpose:en,truncatedNormal:sp,unregisterKernel:Q9,unsortedSegmentSum:tC,unstack:du,util:Fe,valueAndGrad:P7,valueAndGrads:L7,variable:tE,variableGrads:nP,version:uee,version_converter:iF,version_core:GL,version_layers:cy,webgl:sK,where:ia,whereAsync:Lg,zeros:_t,zerosLike:dt},Symbol.toStringTag,{value:"Module"})),Hf=jv(lee);var vu={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(vu,"__esModule",{value:!0});vu.cropTensor=vu.capture=void 0;var Xs=Hf;function cee(t,n){return Xs.tidy(function(){var e=Xs.browser.fromPixels(t),r=EF(e,n),i=r.expandDims(0);return i.toFloat().div(Xs.scalar(127)).sub(Xs.scalar(1))})}vu.capture=cee;function EF(t,n,e){var r=Math.min(t.shape[0],t.shape[1]),i=t.shape[0]/2,o=i-r/2,a=t.shape[1]/2,s=a-r/2;if(n&&!e){var u=t.slice([o,s,0],[r,r,3]);u=u.reshape([r*r,1,3]);var l=[.2989,.587,.114];return u=Xs.mul(u,l),u=u.reshape([r,r,3]),u=Xs.sum(u,-1),u=Xs.expandDims(u,-1),u}return t.slice([o,s,0],[r,r,3])}vu.cropTensor=EF;var Li={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Li,"__esModule",{value:!0});Li.cropTo=Li.resizeMinTo=Li.resizeMaxTo=Li.resize=void 0;var hy=function(){return document.createElement("canvas")};function r2(t,n,e){e===void 0&&(e=hy()),e.width=t.width*n,e.height=t.height*n;var r=e.getContext("2d");return r.drawImage(t,0,0,e.width,e.height),e}Li.resize=r2;function dee(t,n,e){e===void 0&&(e=hy());var r=Math.max(t.width,t.height);return r2(t,n/r,e)}Li.resizeMaxTo=dee;function fee(t,n,e){e===void 0&&(e=hy());var r=Math.min(t.width,t.height);return r2(t,n/r,e)}Li.resizeMinTo=fee;function pee(t,n,e,r){e===void 0&&(e=!1),r===void 0&&(r=hy());var i=t.width,o=t.height;t instanceof HTMLVideoElement&&(i=t.videoWidth,o=t.videoHeight);var a=Math.min(i,o),s=n/a,u=Math.ceil(i*s),l=Math.ceil(o*s),c=u-n,d=l-n;r.width=r.height=n;var f=r.getContext("2d");return f.drawImage(t,~~(c/2)*-1,~~(d/2)*-1,u,l),e&&(f.scale(-1,1),f.drawImage(r,n*-1,0)),r}Li.cropTo=pee;var Np={};/** @license See the LICENSE file. */Object.defineProperty(Np,"__esModule",{value:!0});Np.version=void 0;var hee="0.8.4-alpha2";Np.version=hee;(function(t){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var n=ve&&ve.__awaiter||function(E,S,k,N){function M(D){return D instanceof k?D:new k(function(T){T(D)})}return new(k||(k=Promise))(function(D,T){function O(I){try{A(N.next(I))}catch(_){T(_)}}function P(I){try{A(N.throw(I))}catch(_){T(_)}}function A(I){I.done?D(I.value):M(I.value).then(O,P)}A((N=N.apply(E,S||[])).next())})},e=ve&&ve.__generator||function(E,S){var k={label:0,sent:function(){if(D[0]&1)throw D[1];return D[1]},trys:[],ops:[]},N,M,D,T;return T={next:O(0),throw:O(1),return:O(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function O(A){return function(I){return P([A,I])}}function P(A){if(N)throw new TypeError("Generator is already executing.");for(;k;)try{if(N=1,M&&(D=A[0]&2?M.return:A[0]?M.throw||((D=M.return)&&D.call(M),0):M.next)&&!(D=D.call(M,A[1])).done)return D;switch(M=0,D&&(A=[A[0]&2,D.value]),A[0]){case 0:case 1:D=A;break;case 4:return k.label++,{value:A[1],done:!1};case 5:k.label++,M=A[1],A=[0];continue;case 7:A=k.ops.pop(),k.trys.pop();continue;default:if(D=k.trys,!(D=D.length>0&&D[D.length-1])&&(A[0]===6||A[0]===2)){k=0;continue}if(A[0]===3&&(!D||A[1]>D[0]&&A[1]<D[3])){k.label=A[1];break}if(A[0]===6&&k.label<D[1]){k.label=D[1],D=A;break}if(D&&k.label<D[2]){k.label=D[2],k.ops.push(A);break}D[2]&&k.ops.pop(),k.trys.pop();continue}A=S.call(E,k)}catch(I){A=[6,I],M=0}finally{N=D=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.loadFromFiles=t.load=t.loadTruncatedMobileNet=t.CustomMobileNet=t.getTopKClasses=t.IMAGE_SIZE=void 0;var r=Hf,i=Hf,o=vu,a=Li,s=Np,u=1,l="conv_pw_13_relu",c="out_relu",d=.25,f=.35;t.IMAGE_SIZE=224;var p=function(E){return E.packageVersion=E.packageVersion||s.version,E.packageName=E.packageName||"@teachablemachine/image",E.timeStamp=E.timeStamp||new Date().toISOString(),E.userMetadata=E.userMetadata||{},E.modelName=E.modelName||"untitled",E.labels=E.labels||[],E.imageSize=E.imageSize||t.IMAGE_SIZE,E},h=function(E){return!!E&&Array.isArray(E.labels)},v=function(E,S){if(E===1){if(S!==.25&&S!==.5&&S!==.75&&S!==1)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",d.toFixed(2)),d}else if(S!==.35&&S!==.5&&S!==.75&&S!==1)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",f.toFixed(2)),f;return S},g=function(E){if(E=E||{},E.checkpointUrl&&E.trainingLayer)return(E.alpha||E.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[E.checkpointUrl,E.trainingLayer];if(E.version=E.version||u,E.version===1){E.alpha=E.alpha||d,E.alpha=v(E.version,E.alpha),console.log("Loading mobilenet "+E.version+" and alpha "+E.alpha);var S=E.alpha.toFixed(2);return S==="1.00"&&(S="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_"+S+"_"+t.IMAGE_SIZE+"/model.json",l]}else{if(E.version===2)return E.alpha=E.alpha||f,E.alpha=v(E.version,E.alpha),console.log("Loading mobilenet "+E.version+" and alpha "+E.alpha),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_"+E.alpha.toFixed(2)+"_"+t.IMAGE_SIZE+"_no_top/model.json",c];throw new Error("MobileNet V"+E.version+" doesn't exist")}},m=function(E){return n(void 0,void 0,void 0,function(){var S,k;return e(this,function(N){switch(N.label){case 0:return typeof E!="string"?[3,3]:[4,fetch(E)];case 1:return k=N.sent(),[4,k.json()];case 2:return S=N.sent(),[3,4];case 3:if(h(E))S=E;else throw new Error("Invalid Metadata provided");N.label=4;case 4:return[2,p(S)]}})})};function y(E,S,k){return k===void 0&&(k=3),n(this,void 0,void 0,function(){var N;return e(this,function(M){switch(M.label){case 0:return[4,S.data()];case 1:return N=M.sent(),[2,r.tidy(function(){k=Math.min(k,N.length);for(var D=[],T=0;T<N.length;T++)D.push({value:N[T],index:T});D.sort(function(I,_){return _.value-I.value});for(var O=new Float32Array(k),P=new Int32Array(k),T=0;T<k;T++)O[T]=D[T].value,P[T]=D[T].index;for(var A=[],T=0;T<P.length;T++)A.push({className:E[P[T]],probability:O[T]});return A})]}})})}t.getTopKClasses=y;var b=function(){function E(S,k){this.model=S,this._metadata=p(k)}return Object.defineProperty(E,"EXPECTED_IMAGE_SIZE",{get:function(){return t.IMAGE_SIZE},enumerable:!1,configurable:!0}),E.prototype.getMetadata=function(){return this._metadata},E.prototype.getTotalClasses=function(){var S=this.model.output,k=S.shape[1];return k},E.prototype.getClassLabels=function(){return this._metadata.labels},E.prototype.predictTopK=function(S,k,N){return k===void 0&&(k=10),N===void 0&&(N=!1),n(this,void 0,void 0,function(){var M,D,T,O=this;return e(this,function(P){switch(P.label){case 0:return M=a.cropTo(S,this._metadata.imageSize,N),D=r.tidy(function(){var A=o.capture(M,O._metadata.grayscale);return O.model.predict(A)}),[4,y(this._metadata.labels,D,k)];case 1:return T=P.sent(),i.dispose(D),[2,T]}})})},E.prototype.predict=function(S,k){return k===void 0&&(k=!1),n(this,void 0,void 0,function(){var N,M,D,T,O,P=this;return e(this,function(A){switch(A.label){case 0:return N=a.cropTo(S,this._metadata.imageSize,k),M=r.tidy(function(){var I=o.capture(N,P._metadata.grayscale);return P.model.predict(I)}),[4,M.data()];case 1:for(D=A.sent(),T=[],O=0;O<D.length;O++)T.push({className:this._metadata.labels[O],probability:D[O]});return i.dispose(M),[2,T]}})})},E.prototype.dispose=function(){this.truncatedModel.dispose()},E}();t.CustomMobileNet=b;function w(E){return n(this,void 0,void 0,function(){var S,k,N,M,D,T,O,D,T,O;return e(this,function(P){switch(P.label){case 0:return S=g(E),k=S[0],N=S[1],[4,r.loadLayersModel(k)];case 1:return M=P.sent(),E&&E.version===1?(D=M.getLayer(N),T=r.model({inputs:M.inputs,outputs:D.output}),O=r.sequential(),O.add(T),O.add(r.layers.flatten()),[2,O]):(D=M.getLayer(N),T=r.model({inputs:M.inputs,outputs:D.output}),O=r.sequential(),O.add(T),O.add(r.layers.globalAveragePooling2d({})),[2,O])}})})}t.loadTruncatedMobileNet=w;function x(E,S){return n(this,void 0,void 0,function(){var k,N,M;return e(this,function(D){switch(D.label){case 0:return[4,r.loadLayersModel(E)];case 1:return k=D.sent(),S?[4,m(S)]:[3,3];case 2:return M=D.sent(),[3,4];case 3:M=null,D.label=4;case 4:return N=M,[2,new b(k,N)]}})})}t.load=x;function C(E,S,k){return n(this,void 0,void 0,function(){var N,M,D,T;return e(this,function(O){switch(O.label){case 0:return[4,r.loadLayersModel(r.io.browserFiles([E,S]))];case 1:return N=O.sent(),[4,new Response(k).json()];case 2:return M=O.sent(),k?[4,m(M)]:[3,4];case 3:return T=O.sent(),[3,5];case 4:T=null,O.label=5;case 5:return D=T,[2,new b(N,D)]}})})}t.loadFromFiles=C})(US);var dc={},i2={exports:{}};i2.exports;(function(t){(function(n,e,r){function i(u){var l=this,c=s();l.next=function(){var d=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=d|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(u),l.s0<0&&(l.s0+=1),l.s1-=c(u),l.s1<0&&(l.s1+=1),l.s2-=c(u),l.s2<0&&(l.s2+=1),c=null}function o(u,l){return l.c=u.c,l.s0=u.s0,l.s1=u.s1,l.s2=u.s2,l}function a(u,l){var c=new i(u),d=l&&l.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,d&&(typeof d=="object"&&o(d,c),f.state=function(){return o(c,{})}),f}function s(){var u=4022871197,l=function(c){c=c.toString();for(var d=0;d<c.length;d++){u+=c.charCodeAt(d);var f=.02519603282416938*u;u=f>>>0,f-=u,f*=u,u=f>>>0,f-=u,u+=f*4294967296}return(u>>>0)*23283064365386963e-26};return l}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(ve,t,!1)})(i2);var mee=i2.exports,o2={exports:{}};o2.exports;(function(t){(function(n,e,r){function i(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(s|0)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,p=(l.next()>>>0)/4294967296,h=(f+p)/(1<<21);while(h===0);return h},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(ve,t,!1)})(o2);var vee=o2.exports,a2={exports:{}};a2.exports;(function(t){(function(n,e,r){function i(s){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(d^d<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(s|0)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,p=(l.next()>>>0)/4294967296,h=(f+p)/(1<<21);while(h===0);return h},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(ve,t,!1)})(a2);var gee=a2.exports,s2={exports:{}};s2.exports;(function(t){(function(n,e,r){function i(s){var u=this;u.next=function(){var c=u.x,d=u.i,f,p;return f=c[d],f^=f>>>7,p=f^f<<24,f=c[d+1&7],p^=f^f>>>10,f=c[d+3&7],p^=f^f>>>3,f=c[d+4&7],p^=f^f<<7,f=c[d+7&7],f=f^f<<13,p^=f^f<<9,c[d]=p,u.i=d+1&7,p};function l(c,d){var f,p=[];if(d===(d|0))p[0]=d;else for(d=""+d,f=0;f<d.length;++f)p[f&7]=p[f&7]<<15^d.charCodeAt(f)+p[f+1&7]<<13;for(;p.length<8;)p.push(0);for(f=0;f<8&&p[f]===0;++f);for(f==8?p[7]=-1:p[f],c.x=p,c.i=0,f=256;f>0;--f)c.next()}l(u,s)}function o(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,p=(l.next()>>>0)/4294967296,h=(f+p)/(1<<21);while(h===0);return h},d.int32=l.next,d.quick=d,c&&(c.x&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(ve,t,!1)})(s2);var yee=s2.exports,u2={exports:{}};u2.exports;(function(t){(function(n,e,r){function i(s){var u=this;u.next=function(){var c=u.w,d=u.X,f=u.i,p,h;return u.w=c=c+1640531527|0,h=d[f+34&127],p=d[f=f+1&127],h^=h<<13,p^=p<<17,h^=h>>>15,p^=p>>>12,h=d[f]=h^p,u.i=f,h+(c^c>>>16)|0};function l(c,d){var f,p,h,v,g,m=[],y=128;for(d===(d|0)?(p=d,d=null):(d=d+"\0",p=0,y=Math.max(y,d.length)),h=0,v=-32;v<y;++v)d&&(p^=d.charCodeAt((v+32)%d.length)),v===0&&(g=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,v>=0&&(g=g+1640531527|0,f=m[v&127]^=p+g,h=f==0?h+1:0);for(h>=128&&(m[(d&&d.length||0)&127]=-1),h=127,v=4*128;v>0;--v)p=m[h+34&127],f=m[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,m[h]=p^f;c.w=g,c.X=m,c.i=h}l(u,s)}function o(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,p=(l.next()>>>0)/4294967296,h=(f+p)/(1<<21);while(h===0);return h},d.int32=l.next,d.quick=d,c&&(c.X&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(ve,t,!1)})(u2);var bee=u2.exports,l2={exports:{}};l2.exports;(function(t){(function(n,e,r){function i(s){var u=this,l="";u.next=function(){var d=u.b,f=u.c,p=u.d,h=u.a;return d=d<<25^d>>>7^f,f=f-p|0,p=p<<24^p>>>8^h,h=h-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-p|0,u.d=p<<16^f>>>16^h,u.a=h-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=s|0):l+=s;for(var c=0;c<l.length+20;c++)u.b^=l.charCodeAt(c)|0,u.next()}function o(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new i(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,p=(l.next()>>>0)/4294967296,h=(f+p)/(1<<21);while(h===0);return h},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&o(c,l),d.state=function(){return o(l,{})}),d}e&&e.exports?e.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(ve,t,!1)})(l2);var wee=l2.exports,CF={exports:{}};const xee={},See=Object.freeze(Object.defineProperty({__proto__:null,default:xee},Symbol.toStringTag,{value:"Module"})),Eee=jv(See);(function(t){(function(n,e){var r=(0,eval)("this"),i=256,o=6,a=52,s="random",u=e.pow(i,o),l=e.pow(2,a),c=l*2,d=i-1,f;function p(w,x,C){var E=[];x=x==!0?{entropy:!0}:x||{};var S=m(g(x.entropy?[w,b(n)]:w??y(),3),E),k=new h(E),N=function(){for(var M=k.g(o),D=u,T=0;M<l;)M=(M+T)*i,D*=i,T=k.g(1);for(;M>=c;)M/=2,D/=2,T>>>=1;return(M+T)/D};return N.int32=function(){return k.g(4)|0},N.quick=function(){return k.g(4)/4294967296},N.double=N,m(b(k.S),n),(x.pass||C||function(M,D,T,O){return O&&(O.S&&v(O,k),M.state=function(){return v(k,{})}),T?(e[s]=M,D):M})(N,S,"global"in x?x.global:this==e,x.state)}e["seed"+s]=p;function h(w){var x,C=w.length,E=this,S=0,k=E.i=E.j=0,N=E.S=[];for(C||(w=[C++]);S<i;)N[S]=S++;for(S=0;S<i;S++)N[S]=N[k=d&k+w[S%C]+(x=N[S])],N[k]=x;(E.g=function(M){for(var D,T=0,O=E.i,P=E.j,A=E.S;M--;)D=A[O=d&O+1],T=T*i+A[d&(A[O]=A[P=d&P+D])+(A[P]=D)];return E.i=O,E.j=P,T})(i)}function v(w,x){return x.i=w.i,x.j=w.j,x.S=w.S.slice(),x}function g(w,x){var C=[],E=typeof w,S;if(x&&E=="object")for(S in w)try{C.push(g(w[S],x-1))}catch{}return C.length?C:E=="string"?w:w+"\0"}function m(w,x){for(var C=w+"",E,S=0;S<C.length;)x[d&S]=d&(E^=x[d&S]*19)+C.charCodeAt(S++);return b(x)}function y(){try{var w;return f&&(w=f.randomBytes)?w=w(i):(w=new Uint8Array(i),(r.crypto||r.msCrypto).getRandomValues(w)),b(w)}catch{var x=r.navigator,C=x&&x.plugins;return[+new Date,r,C,r.screen,b(n)]}}function b(w){return String.fromCharCode.apply(0,w)}if(m(e.random(),n),t.exports){t.exports=p;try{f=Eee}catch{}}})([],Math)})(CF);var Cee=CF.exports,Ree=mee,Tee=vee,Nee=gee,kee=yee,Iee=bee,_ee=wee,Du=Cee;Du.alea=Ree;Du.xor128=Tee;Du.xorwow=Nee;Du.xorshift7=kee;Du.xor4096=Iee;Du.tychei=_ee;var Aee=Du;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Oee=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},t(n,e)};return function(n,e){t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Mo=ve&&ve.__awaiter||function(t,n,e,r){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?o(c.value):i(c.value).then(s,u)}l((r=r.apply(t,n||[])).next())})},Po=ve&&ve.__generator||function(t,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){e.label=l[1];break}if(l[0]===6&&e.label<o[1]){e.label=o[1],o=l;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(l);break}o[2]&&e.ops.pop(),e.trys.pop();continue}l=n.call(t,e)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(dc,"__esModule",{value:!0});dc.createTeachable=dc.TeachableMobileNet=void 0;var Un=Hf,Dee=Hf,Mee=vu,RF=US,Pee=Aee,Lee=.15,Fee=function(t){return typeof t.dataId=="object"&&typeof t.shape=="object"};function zee(t,n){var e=new Array(n).fill(0);return e[t]=1,e}function w1(t,n){for(var e,r=t.length,i=t.slice(),o=r-1;o>0;o-=1){var a=void 0;n?a=Math.floor(n()*(o+1)):a=Math.floor(Math.random()*(o+1)),e=[i[a],i[o]],i[o]=e[0],i[a]=e[1]}return i}var TF=function(t){Oee(n,t);function n(e,r){var i=t.call(this,Un.sequential(),r)||this;return i.totalSamples=0,i.examples=[],i.truncatedModel=e,i}return Object.defineProperty(n.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),n.prototype.addExample=function(e,r){return Mo(this,void 0,void 0,function(){var i,o,a;return Po(this,function(s){return i=Fee(r)?r:Mee.capture(r,this._metadata.grayscale),o=this.truncatedModel.predict(i),a=o.dataSync(),i.dispose(),o.dispose(),this.examples[e].push(a),this.totalSamples++,[2]})})},n.prototype.predict=function(e,r){return r===void 0&&(r=!1),Mo(this,void 0,void 0,function(){return Po(this,function(i){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,t.prototype.predict.call(this,e,r)]})})},n.prototype.predictTopK=function(e,r,i){return r===void 0&&(r=10),i===void 0&&(i=!1),Mo(this,void 0,void 0,function(){return Po(this,function(o){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,t.prototype.predictTopK.call(this,e,r,i)]})})},n.prototype.prepare=function(){for(var e in this.examples)if(e.length===0)throw new Error("Add some examples before training");var r=this.convertToTfDataset();this.trainDataset=r.trainDataset,this.validationDataset=r.validationDataset},n.prototype.convertToTfDataset=function(){for(var e=0;e<this.examples.length;e++)this.examples[e]=w1(this.examples[e],this.seed);for(var r=[],i=[],o=function(d){var f=zee(d,a.numClasses),p=a.examples[d].length,h=Math.ceil(Lee*p),v=p-h,g=a.examples[d].slice(0,v).map(function(y){return{data:y,label:f}}),m=a.examples[d].slice(v).map(function(y){return{data:y,label:f}});r=r.concat(g),i=i.concat(m)},a=this,e=0;e<this.examples.length;e++)o(e);r=w1(r,this.seed),i=w1(i,this.seed);var s=Un.data.array(r.map(function(d){return d.data})),u=Un.data.array(i.map(function(d){return d.data})),l=Un.data.array(r.map(function(d){return d.label})),c=Un.data.array(i.map(function(d){return d.label}));return{trainDataset:Un.data.zip({xs:s,ys:l}),validationDataset:Un.data.zip({xs:u,ys:c})}},n.prototype.save=function(e,r){return Mo(this,void 0,void 0,function(){return Po(this,function(i){return[2,this.model.save(e,r)]})})},n.prototype.train=function(e,r){return r===void 0&&(r={}),Mo(this,void 0,void 0,function(){var i,o,a,s,u,l,c,d,f,p=this;return Po(this,function(h){switch(h.label){case 0:if(i=r.onTrainEnd||function(){},r.onTrainEnd=function(v){p.__stopTrainingResolve&&(p.__stopTrainingResolve(),p.__stopTrainingResolve=null),i(v)},this.isPrepared||this.prepare(),o=this.getLabels().length,Dee.util.assert(o===this.numClasses,function(){return"Can not train, has "+o+" labels and "+p.numClasses+" classes"}),a=this.truncatedModel.outputs[0].shape.slice(1),s=Un.util.sizeFromShape(a),this.seed?u=Un.initializers.varianceScaling({seed:3.14}):u=Un.initializers.varianceScaling({}),this.trainingModel=Un.sequential({layers:[Un.layers.dense({inputShape:[s],units:e.denseUnits,activation:"relu",kernelInitializer:u,useBias:!0}),Un.layers.dense({kernelInitializer:u,useBias:!1,activation:"softmax",units:this.numClasses})]}),l=Un.train.adam(e.learningRate),this.trainingModel.compile({optimizer:l,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(e.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return c=this.trainDataset.batch(e.batchSize),d=this.validationDataset.batch(e.batchSize),[4,this.trainingModel.fitDataset(c,{epochs:e.epochs,validationData:d,callbacks:r})];case 1:return h.sent(),f=Un.sequential(),f.add(this.truncatedModel),f.add(this.trainingModel),this.model=f,l.dispose(),[2,this.model]}})})},n.prototype.prepareDataset=function(){for(var e=0;e<this.numClasses;e++)this.examples[e]=[]},n.prototype.setLabel=function(e,r){this._metadata.labels[e]=r},n.prototype.setLabels=function(e){this._metadata.labels=e,this.prepareDataset()},n.prototype.getLabel=function(e){return this._metadata.labels[e]},n.prototype.getLabels=function(){return this._metadata.labels},n.prototype.setName=function(e){this._metadata.modelName=e},n.prototype.getName=function(){return this._metadata.modelName},n.prototype.stopTraining=function(){var e=this,r=new Promise(function(i,o){e.trainingModel.stopTraining=!0,e.__stopTrainingResolve=i});return r},n.prototype.dispose=function(){this.trainingModel.dispose(),t.prototype.dispose.call(this)},n.prototype.calculateAccuracyPerClass=function(){return Mo(this,void 0,void 0,function(){var e,r,i,o,a,s,u,l,c,d,b,f,p,h,v,g,m,y,b,w=this;return Po(this,function(x){switch(x.label){case 0:return e=this.validationDataset.mapAsync(function(C){return Mo(w,void 0,void 0,function(){return Po(this,function(E){return[2,C.xs]})})}),r=this.validationDataset.mapAsync(function(C){return Mo(w,void 0,void 0,function(){return Po(this,function(E){return[2,C.ys]})})}),i=Math.min(r.size,32),o=Math.ceil(r.size/i),a=e.batch(i),s=r.batch(i),[4,a.iterator()];case 1:return u=x.sent(),[4,s.iterator()];case 2:l=x.sent(),c=[],d=[],b=0,x.label=3;case 3:return b<o?[4,u.next()]:[3,7];case 4:return f=x.sent(),p=this.trainingModel.predict(f.value),h=p.argMax(1),c.push(h),[4,l.next()];case 5:v=x.sent(),g=v.value.argMax(1),d.push(g),f.value.dispose(),p.dispose(),v.value.dispose(),x.label=6;case 6:return b++,[3,3];case 7:if(m=Un.concat(d),y=Un.concat(c),o!==1)for(b=0;b<c.length;b++)c[b].dispose(),d[b].dispose();return[2,{reference:m,predictions:y}]}})})},n.prototype.setSeed=function(e){this.seed=Pee(e)},n}(RF.CustomMobileNet);dc.TeachableMobileNet=TF;function Bee(t,n){return Mo(this,void 0,void 0,function(){var e;return Po(this,function(r){switch(r.label){case 0:return[4,RF.loadTruncatedMobileNet(n)];case 1:return e=r.sent(),[2,new TF(e,t)]}})})}dc.createTeachable=Bee;var my={};function bm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bm=function(e){return typeof e}:bm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bm(t)}function c2(t,n,e){var r=e.value;if(typeof r!="function")throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(bm(r)));var i=!1;return{configurable:!0,get:function(){if(i||this===t.prototype||this.hasOwnProperty(n)||typeof r!="function")return r;var a=r.bind(this);return i=!0,Object.defineProperty(this,n,{configurable:!0,get:function(){return a},set:function(u){r=u,delete this[n]}}),i=!1,a},set:function(a){r=a}}}function NF(t){var n;return typeof Reflect<"u"&&typeof Reflect.ownKeys=="function"?n=Reflect.ownKeys(t.prototype):(n=Object.getOwnPropertyNames(t.prototype),typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t.prototype)))),n.forEach(function(e){if(e!=="constructor"){var r=Object.getOwnPropertyDescriptor(t.prototype,e);typeof r.value=="function"&&Object.defineProperty(t.prototype,e,c2(t,e,r))}}),t}function jee(){return arguments.length===1?NF.apply(void 0,arguments):c2.apply(void 0,arguments)}const Vee=Object.freeze(Object.defineProperty({__proto__:null,boundClass:NF,boundMethod:c2,default:jee},Symbol.toStringTag,{value:"Module"})),$ee=jv(Vee);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ga=ve&&ve.__decorate||function(t,n,e,r){var i=arguments.length,o=i<3?n:r===null?r=Object.getOwnPropertyDescriptor(n,e):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,n,e,r);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(i<3?a(o):i>3?a(n,e,o):a(n,e))||o);return i>3&&o&&Object.defineProperty(n,e,o),o},Uee=ve&&ve.__awaiter||function(t,n,e,r){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?o(c.value):i(c.value).then(s,u)}l((r=r.apply(t,n||[])).next())})},Wee=ve&&ve.__generator||function(t,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){e.label=l[1];break}if(l[0]===6&&e.label<o[1]){e.label=o[1],o=l;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(l);break}o[2]&&e.ops.pop(),e.trys.pop();continue}l=n.call(t,e)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(my,"__esModule",{value:!0});my.Webcam=void 0;var ya=$ee,Hee=Li,x1={facingMode:"user",frameRate:24},Gee=function(t){return t.facingMode=t.facingMode||x1.facingMode,t.frameRate=t.frameRate||x1.frameRate,t.aspectRatio=t.aspectRatio||x1.aspectRatio,t},qee=function(){function t(n,e,r){n===void 0&&(n=400),e===void 0&&(e=400),r===void 0&&(r=!1),this.width=n,this.height=e,this.flip=r}return t.prototype.getWebcam=function(n){if(n===void 0&&(n={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");n.width=640;var e=Gee(n),r=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:e}).then(function(i){return r.srcObject=i,r.addEventListener("loadedmetadata",function(o){var a=r.videoWidth,s=r.videoHeight;r.width=a,r.height=s}),r},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},t.prototype.setup=function(n){return n===void 0&&(n={}),Uee(this,void 0,void 0,function(){var e;return Wee(this,function(r){switch(r.label){case 0:return this.webcam?[3,2]:(e=this,[4,this.getWebcam(n)]);case 1:e.webcam=r.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),r.label=2;case 2:return[2]}})})},t.prototype.play=function(){var n=this.webcam.play();return n},t.prototype.pause=function(){this.webcam.pause()},t.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},t.prototype.update=function(){this.renderCameraToCanvas()},t.prototype.stopStreamedVideo=function(n){var e=n.srcObject,r=e.getTracks();r.forEach(function(i){i.stop()}),n.srcObject=null},t.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var n=this.canvas.getContext("2d");if(this.webcam.videoWidth!==0){var e=Hee.cropTo(this.webcam,this.width,this.flip);n.drawImage(e,0,0)}}},ga([ya.default],t.prototype,"getWebcam",null),ga([ya.default],t.prototype,"setup",null),ga([ya.default],t.prototype,"play",null),ga([ya.default],t.prototype,"pause",null),ga([ya.default],t.prototype,"stop",null),ga([ya.default],t.prototype,"update",null),ga([ya.default],t.prototype,"stopStreamedVideo",null),ga([ya.default],t.prototype,"renderCameraToCanvas",null),t}();my.Webcam=qee;(function(t){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(t,"__esModule",{value:!0});var n=US;Object.defineProperty(t,"IMAGE_SIZE",{enumerable:!0,get:function(){return n.IMAGE_SIZE}}),Object.defineProperty(t,"CustomMobileNet",{enumerable:!0,get:function(){return n.CustomMobileNet}}),Object.defineProperty(t,"load",{enumerable:!0,get:function(){return n.load}}),Object.defineProperty(t,"loadFromFiles",{enumerable:!0,get:function(){return n.loadFromFiles}}),Object.defineProperty(t,"loadTruncatedMobileNet",{enumerable:!0,get:function(){return n.loadTruncatedMobileNet}});var e=dc;Object.defineProperty(t,"TeachableMobileNet",{enumerable:!0,get:function(){return e.TeachableMobileNet}}),Object.defineProperty(t,"createTeachable",{enumerable:!0,get:function(){return e.createTeachable}});var r=my;Object.defineProperty(t,"Webcam",{enumerable:!0,get:function(){return r.Webcam}});var i=Np;Object.defineProperty(t,"version",{enumerable:!0,get:function(){return i.version}})})(HD);const d2="/assets/backSymbol-A5W0hIK8.svg",pa=W.memo(({centerText:t,align:n="start",filter:e="none",prevPath:r=-1})=>{const i=Er(),o=()=>i(r,{state:r!==-1&&{data:r}});return R.jsxs("header",{className:"header",children:[R.jsx("img",{src:d2,alt:"Back Icon",style:{filter:e},onClick:o}),R.jsx("div",{className:"center-text",style:{justifyContent:n},children:t}),R.jsx("div",{className:"none"})]})}),Pc=({hidden:t})=>R.jsxs("div",{className:"dot-spinner",style:{display:t&&"none"},children:[R.jsx("div",{className:"dot-spinner__dot"}),R.jsx("div",{className:"dot-spinner__dot"}),R.jsx("div",{className:"dot-spinner__dot"}),R.jsx("div",{className:"dot-spinner__dot"}),R.jsx("div",{className:"dot-spinner__dot"}),R.jsx("div",{className:"dot-spinner__dot"}),R.jsx("div",{className:"dot-spinner__dot"}),R.jsx("div",{className:"dot-spinner__dot"})]});var f2={},Kee=yt;Object.defineProperty(f2,"__esModule",{value:!0});var p2=f2.default=void 0,Xee=Kee(bt()),Yee=R;p2=f2.default=(0,Xee.default)((0,Yee.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined");const Uk="/my_model/",Jee=()=>{const n=Si().state.value,e=W.useRef(null),r=W.useRef(null),[i,o]=W.useState(null),[a,s]=W.useState([]);W.useState(!1);const u=async()=>{if(console.log(r.current),console.log(e.current),r.current&&e.current)try{let c=e.current;const d=await r.current.predict(c,!1);d.sort((p,h)=>parseFloat(h.probability)-parseFloat(p.probability));const f=d[0].className;console.log(f),o(f)}catch(c){console.error("Prediction error:",c)}},l=async()=>{try{const c=Uk+"model.json",d=Uk+"metadata.json",f=await HD.load(c,d);r.current=f,await u()}catch(c){console.error("Model loading error:",c)}};return W.useEffect(()=>(l(),()=>{e.current=null}),[]),R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"result",style:{display:!i&&"none"},children:[R.jsx(pa,{centerText:"분석완료",align:"center"}),R.jsxs("div",{className:"result-body",children:[R.jsx("div",{className:"result-img",children:R.jsx("img",{className:"ml-result",src:n,ref:e,alt:""})}),R.jsxs("div",{className:"result-content",children:[R.jsxs("div",{className:"result-fish",children:[R.jsx("div",{className:"result-name",children:i}),R.jsx("div",{className:"result-detail",children:"자세히 보기"})]}),R.jsxs("div",{className:"fish-reviews",children:[R.jsxs("h3",{className:"reviews-title",children:[i,"의 리뷰"]}),R.jsx("div",{className:"wrapper",children:a.length?a.map(c=>R.jsxs("div",{children:[R.jsx("img",{src:"https://cdn.iconsumer.or.kr/news/photo/201806/7349_8772_1719.jpg"},c),R.jsx("div",{children:c})]})):R.jsx("div",{className:"none-data",children:"정보를 준비 중입니다."})})]})]})]})]}),R.jsx(Pc,{hidden:i})]})};var h2={},Qee=yt;Object.defineProperty(h2,"__esModule",{value:!0});var kF=h2.default=void 0,Zee=Qee(bt()),ete=R;kF=h2.default=(0,Zee.default)((0,ete.jsx)("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5m0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5m0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5M7 19h14v-2H7zm0-6h14v-2H7zm0-8v2h14V5z"}),"FormatListBulleted");var m2={},tte=yt;Object.defineProperty(m2,"__esModule",{value:!0});var IF=m2.default=void 0,nte=tte(bt()),rte=R;IF=m2.default=(0,nte.default)((0,rte.jsx)("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M10 5.47l4 1.4v11.66l-4-1.4zm-5 .99 3-1.01v11.7l-3 1.16zm14 11.08-3 1.01V6.86l3-1.16z"}),"MapOutlined");var v2={},ite=yt;Object.defineProperty(v2,"__esModule",{value:!0});var _F=v2.default=void 0,ote=ite(bt()),ate=R;_F=v2.default=(0,ote.default)((0,ate.jsx)("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDownOutlined");var g2={},ste=yt;Object.defineProperty(g2,"__esModule",{value:!0});var Jw=g2.default=void 0,ute=ste(bt()),lte=R;Jw=g2.default=(0,ute.default)((0,lte.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"CheckOutlined");var AF={};function cte(t){const n=new Error(t);if(n.stack===void 0)try{throw n}catch{}return n}var dte=cte,Qe=dte;function fte(t){return!!t&&typeof t.then=="function"}var Wt=fte;function pte(t,n){if(t!=null)return t;throw Qe(n??"Got unexpected null or undefined")}var Zt=pte;function Ke(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}class vy{getValue(){throw Qe("BaseLoadable")}toPromise(){throw Qe("BaseLoadable")}valueMaybe(){throw Qe("BaseLoadable")}valueOrThrow(){throw Qe(`Loadable expected value, but in "${this.state}" state`)}promiseMaybe(){throw Qe("BaseLoadable")}promiseOrThrow(){throw Qe(`Loadable expected promise, but in "${this.state}" state`)}errorMaybe(){throw Qe("BaseLoadable")}errorOrThrow(){throw Qe(`Loadable expected error, but in "${this.state}" state`)}is(n){return n.state===this.state&&n.contents===this.contents}map(n){throw Qe("BaseLoadable")}}class hte extends vy{constructor(n){super(),Ke(this,"state","hasValue"),Ke(this,"contents",void 0),this.contents=n}getValue(){return this.contents}toPromise(){return Promise.resolve(this.contents)}valueMaybe(){return this.contents}valueOrThrow(){return this.contents}promiseMaybe(){}errorMaybe(){}map(n){try{const e=n(this.contents);return Wt(e)?gu(e):fc(e)?e:kp(e)}catch(e){return Wt(e)?gu(e.next(()=>this.map(n))):gy(e)}}}class mte extends vy{constructor(n){super(),Ke(this,"state","hasError"),Ke(this,"contents",void 0),this.contents=n}getValue(){throw this.contents}toPromise(){return Promise.reject(this.contents)}valueMaybe(){}promiseMaybe(){}errorMaybe(){return this.contents}errorOrThrow(){return this.contents}map(n){return this}}class OF extends vy{constructor(n){super(),Ke(this,"state","loading"),Ke(this,"contents",void 0),this.contents=n}getValue(){throw this.contents}toPromise(){return this.contents}valueMaybe(){}promiseMaybe(){return this.contents}promiseOrThrow(){return this.contents}errorMaybe(){}map(n){return gu(this.contents.then(e=>{const r=n(e);if(fc(r)){const i=r;switch(i.state){case"hasValue":return i.contents;case"hasError":throw i.contents;case"loading":return i.contents}}return r}).catch(e=>{if(Wt(e))return e.then(()=>this.map(n).contents);throw e}))}}function kp(t){return Object.freeze(new hte(t))}function gy(t){return Object.freeze(new mte(t))}function gu(t){return Object.freeze(new OF(t))}function DF(){return Object.freeze(new OF(new Promise(()=>{})))}function vte(t){return t.every(n=>n.state==="hasValue")?kp(t.map(n=>n.contents)):t.some(n=>n.state==="hasError")?gy(Zt(t.find(n=>n.state==="hasError"),"Invalid loadable passed to loadableAll").contents):gu(Promise.all(t.map(n=>n.contents)))}function MF(t){const e=(Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(i=>t[i])).map(i=>fc(i)?i:Wt(i)?gu(i):kp(i)),r=vte(e);return Array.isArray(t)?r:r.map(i=>Object.getOwnPropertyNames(t).reduce((o,a,s)=>({...o,[a]:i[s]}),{}))}function fc(t){return t instanceof vy}const gte={of:t=>Wt(t)?gu(t):fc(t)?t:kp(t),error:t=>gy(t),loading:()=>DF(),all:MF,isLoadable:fc};var Mu={loadableWithValue:kp,loadableWithError:gy,loadableWithPromise:gu,loadableLoading:DF,loadableAll:MF,isLoadable:fc,RecoilLoadable:gte},yte=Mu.loadableWithValue,bte=Mu.loadableWithError,wte=Mu.loadableWithPromise,xte=Mu.loadableLoading,Ste=Mu.loadableAll,Ete=Mu.isLoadable,Cte=Mu.RecoilLoadable,Ip=Object.freeze({__proto__:null,loadableWithValue:yte,loadableWithError:bte,loadableWithPromise:wte,loadableLoading:xte,loadableAll:Ste,isLoadable:Ete,RecoilLoadable:Cte});const Qw={RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED:!0,RECOIL_GKS_ENABLED:new Set(["recoil_hamt_2020","recoil_sync_external_store","recoil_suppress_rerender_in_callback","recoil_memory_managament_2020"])};function Rte(t,n){var e,r;const i=(e=AF[t])===null||e===void 0||(r=e.toLowerCase())===null||r===void 0?void 0:r.trim();if(i==null||i==="")return;if(!["true","false"].includes(i))throw Qe(`process.env.${t} value must be 'true', 'false', or empty: ${i}`);n(i==="true")}function Tte(t,n){var e;const r=(e=AF[t])===null||e===void 0?void 0:e.trim();r==null||r===""||n(r.split(/\s*,\s*|\s+/))}function Nte(){var t;typeof process>"u"||((t=process)===null||t===void 0?void 0:t.env)!=null&&(Rte("RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED",n=>{Qw.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED=n}),Tte("RECOIL_GKS_ENABLED",n=>{n.forEach(e=>{Qw.RECOIL_GKS_ENABLED.add(e)})}))}Nte();var Lc=Qw;function yy(t){return Lc.RECOIL_GKS_ENABLED.has(t)}yy.setPass=t=>{Lc.RECOIL_GKS_ENABLED.add(t)};yy.setFail=t=>{Lc.RECOIL_GKS_ENABLED.delete(t)};yy.clear=()=>{Lc.RECOIL_GKS_ENABLED.clear()};var Pt=yy;function kte(t,n,{error:e}={}){return null}var Ite=kte,y2=Ite,S1,E1,C1;const _te=(S1=Ae.createMutableSource)!==null&&S1!==void 0?S1:Ae.unstable_createMutableSource,PF=(E1=Ae.useMutableSource)!==null&&E1!==void 0?E1:Ae.unstable_useMutableSource,LF=(C1=Ae.useSyncExternalStore)!==null&&C1!==void 0?C1:Ae.unstable_useSyncExternalStore;function Ate(){var t;const{ReactCurrentDispatcher:n,ReactCurrentOwner:e}=Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;return((t=n==null?void 0:n.current)!==null&&t!==void 0?t:e.currentDispatcher).useSyncExternalStore!=null}function Ote(){return Pt("recoil_transition_support")?{mode:"TRANSITION_SUPPORT",early:!0,concurrent:!0}:Pt("recoil_sync_external_store")&&LF!=null?{mode:"SYNC_EXTERNAL_STORE",early:!0,concurrent:!1}:Pt("recoil_mutable_source")&&PF!=null&&typeof window<"u"&&!window.$disableRecoilValueMutableSource_TEMP_HACK_DO_NOT_USE?Pt("recoil_suppress_rerender_in_callback")?{mode:"MUTABLE_SOURCE",early:!0,concurrent:!0}:{mode:"MUTABLE_SOURCE",early:!1,concurrent:!1}:Pt("recoil_suppress_rerender_in_callback")?{mode:"LEGACY",early:!0,concurrent:!1}:{mode:"LEGACY",early:!1,concurrent:!1}}function Dte(){return!1}var _p={createMutableSource:_te,useMutableSource:PF,useSyncExternalStore:LF,currentRendererSupportsUseSyncExternalStore:Ate,reactMode:Ote,isFastRefreshEnabled:Dte};class b2{constructor(n){Ke(this,"key",void 0),this.key=n}toJSON(){return{key:this.key}}}class FF extends b2{}class zF extends b2{}function Mte(t){return t instanceof FF||t instanceof zF}var by={AbstractRecoilValue:b2,RecoilState:FF,RecoilValueReadOnly:zF,isRecoilValue:Mte},Pte=by.AbstractRecoilValue,Lte=by.RecoilState,Fte=by.RecoilValueReadOnly,zte=by.isRecoilValue,pc=Object.freeze({__proto__:null,AbstractRecoilValue:Pte,RecoilState:Lte,RecoilValueReadOnly:Fte,isRecoilValue:zte});function Bte(t,n){return function*(){let e=0;for(const r of t)yield n(r,e++)}()}var wy=Bte;class BF{}const jte=new BF,yu=new Map,w2=new Map;function Vte(t){return wy(t,n=>Zt(w2.get(n)))}function $te(t){if(yu.has(t)){const n=`Duplicate atom key "${t}". This is a FATAL ERROR in
      production. But it is safe to ignore this warning if it occurred because of
      hot module replacement.`;console.warn(n)}}function Ute(t){Lc.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED&&$te(t.key),yu.set(t.key,t);const n=t.set==null?new pc.RecoilValueReadOnly(t.key):new pc.RecoilState(t.key);return w2.set(t.key,n),n}class jF extends Error{}function Wte(t){const n=yu.get(t);if(n==null)throw new jF(`Missing definition for RecoilValue: "${t}""`);return n}function Hte(t){return yu.get(t)}const Iv=new Map;function Gte(t){var n;if(!Pt("recoil_memory_managament_2020"))return;const e=yu.get(t);if(e!=null&&(n=e.shouldDeleteConfigOnRelease)!==null&&n!==void 0&&n.call(e)){var r;yu.delete(t),(r=VF(t))===null||r===void 0||r(),Iv.delete(t)}}function qte(t,n){Pt("recoil_memory_managament_2020")&&(n===void 0?Iv.delete(t):Iv.set(t,n))}function VF(t){return Iv.get(t)}var Vr={nodes:yu,recoilValues:w2,registerNode:Ute,getNode:Wte,getNodeMaybe:Hte,deleteNodeConfigIfPossible:Gte,setConfigDeletionHandler:qte,getConfigDeletionHandler:VF,recoilValuesForKeys:Vte,NodeMissingError:jF,DefaultValue:BF,DEFAULT_VALUE:jte};function Kte(t,n){n()}var Xte={enqueueExecution:Kte};function Yte(t,n){return n={exports:{}},t(n,n.exports),n.exports}var Jte=Yte(function(t){var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},e={},r=5,i=Math.pow(2,r),o=i-1,a=i/2,s=i/4,u={},l=function(J){return function(){return J}},c=e.hash=function(Q){var J=typeof Q>"u"?"undefined":n(Q);if(J==="number")return Q;J!=="string"&&(Q+="");for(var me=0,Ce=0,Re=Q.length;Ce<Re;++Ce){var _e=Q.charCodeAt(Ce);me=(me<<5)-me+_e|0}return me},d=function(J){return J-=J>>1&1431655765,J=(J&858993459)+(J>>2&858993459),J=J+(J>>4)&252645135,J+=J>>8,J+=J>>16,J&127},f=function(J,me){return me>>>J&o},p=function(J){return 1<<J},h=function(J,me){return d(J&me-1)},v=function(J,me,Ce,Re){var _e=Re;if(!J){var Ve=Re.length;_e=new Array(Ve);for(var Be=0;Be<Ve;++Be)_e[Be]=Re[Be]}return _e[me]=Ce,_e},g=function(J,me,Ce){var Re=Ce.length-1,_e=0,Ve=0,Be=Ce;if(J)_e=Ve=me;else for(Be=new Array(Re);_e<me;)Be[Ve++]=Ce[_e++];for(++_e;_e<=Re;)Be[Ve++]=Ce[_e++];return J&&(Be.length=Re),Be},m=function(J,me,Ce,Re){var _e=Re.length;if(J){for(var Ve=_e;Ve>=me;)Re[Ve--]=Re[Ve];return Re[me]=Ce,Re}for(var Be=0,je=0,at=new Array(_e+1);Be<me;)at[je++]=Re[Be++];for(at[me]=Ce;Be<_e;)at[++je]=Re[Be++];return at},y=1,b=2,w=3,x=4,C={__hamt_isEmpty:!0},E=function(J){return J===C||J&&J.__hamt_isEmpty},S=function(J,me,Ce,Re){return{type:y,edit:J,hash:me,key:Ce,value:Re,_modify:_}},k=function(J,me,Ce){return{type:b,edit:J,hash:me,children:Ce,_modify:F}},N=function(J,me,Ce){return{type:w,edit:J,mask:me,children:Ce,_modify:L}},M=function(J,me,Ce){return{type:x,edit:J,size:me,children:Ce,_modify:H}},D=function(J){return J===C||J.type===y||J.type===b},T=function(J,me,Ce,Re,_e){for(var Ve=[],Be=Re,je=0,at=0;Be;++at)Be&1&&(Ve[at]=_e[je++]),Be>>>=1;return Ve[me]=Ce,M(J,je+1,Ve)},O=function(J,me,Ce,Re){for(var _e=new Array(me-1),Ve=0,Be=0,je=0,at=Re.length;je<at;++je)if(je!==Ce){var Kt=Re[je];Kt&&!E(Kt)&&(_e[Ve++]=Kt,Be|=1<<je)}return N(J,Be,_e)},P=function Q(J,me,Ce,Re,_e,Ve){if(Ce===_e)return k(J,Ce,[Ve,Re]);var Be=f(me,Ce),je=f(me,_e);return N(J,p(Be)|p(je),Be===je?[Q(J,me+r,Ce,Re,_e,Ve)]:Be<je?[Re,Ve]:[Ve,Re])},A=function(J,me,Ce,Re,_e,Ve,Be,je){for(var at=_e.length,Kt=0;Kt<at;++Kt){var Cr=_e[Kt];if(Ce(Be,Cr.key)){var Dn=Cr.value,li=Ve(Dn);return li===Dn?_e:li===u?(--je.value,g(J,Kt,_e)):v(J,Kt,S(me,Re,Be,li),_e)}}var Ri=Ve();return Ri===u?_e:(++je.value,v(J,at,S(me,Re,Be,Ri),_e))},I=function(J,me){return J===me.edit},_=function(J,me,Ce,Re,_e,Ve,Be){if(me(Ve,this.key)){var je=Re(this.value);return je===this.value?this:je===u?(--Be.value,C):I(J,this)?(this.value=je,this):S(J,_e,Ve,je)}var at=Re();return at===u?this:(++Be.value,P(J,Ce,this.hash,this,_e,S(J,_e,Ve,at)))},F=function(J,me,Ce,Re,_e,Ve,Be){if(_e===this.hash){var je=I(J,this),at=A(je,J,me,this.hash,this.children,Re,Ve,Be);return at===this.children?this:at.length>1?k(J,this.hash,at):at[0]}var Kt=Re();return Kt===u?this:(++Be.value,P(J,Ce,this.hash,this,_e,S(J,_e,Ve,Kt)))},L=function(J,me,Ce,Re,_e,Ve,Be){var je=this.mask,at=this.children,Kt=f(Ce,_e),Cr=p(Kt),Dn=h(je,Cr),li=je&Cr,Ri=li?at[Dn]:C,Vu=Ri._modify(J,me,Ce+r,Re,_e,Ve,Be);if(Ri===Vu)return this;var Jp=I(J,this),Xc=je,Yc=void 0;if(li&&E(Vu)){if(Xc&=~Cr,!Xc)return C;if(at.length<=2&&D(at[Dn^1]))return at[Dn^1];Yc=g(Jp,Dn,at)}else if(!li&&!E(Vu)){if(at.length>=a)return T(J,Kt,Vu,je,at);Xc|=Cr,Yc=m(Jp,Dn,Vu,at)}else Yc=v(Jp,Dn,Vu,at);return Jp?(this.mask=Xc,this.children=Yc,this):N(J,Xc,Yc)},H=function(J,me,Ce,Re,_e,Ve,Be){var je=this.size,at=this.children,Kt=f(Ce,_e),Cr=at[Kt],Dn=(Cr||C)._modify(J,me,Ce+r,Re,_e,Ve,Be);if(Cr===Dn)return this;var li=I(J,this),Ri=void 0;if(E(Cr)&&!E(Dn))++je,Ri=v(li,Kt,Dn,at);else if(!E(Cr)&&E(Dn)){if(--je,je<=s)return O(J,je,Kt,at);Ri=v(li,Kt,C,at)}else Ri=v(li,Kt,Dn,at);return li?(this.size=je,this.children=Ri,this):M(J,je,Ri)};C._modify=function(Q,J,me,Ce,Re,_e,Ve){var Be=Ce();return Be===u?C:(++Ve.value,S(Q,Re,_e,Be))};function B(Q,J,me,Ce,Re){this._editable=Q,this._edit=J,this._config=me,this._root=Ce,this._size=Re}B.prototype.setTree=function(Q,J){return this._editable?(this._root=Q,this._size=J,this):Q===this._root?this:new B(this._editable,this._edit,this._config,Q,J)};var q=e.tryGetHash=function(Q,J,me,Ce){for(var Re=Ce._root,_e=0,Ve=Ce._config.keyEq;;)switch(Re.type){case y:return Ve(me,Re.key)?Re.value:Q;case b:{if(J===Re.hash)for(var Be=Re.children,je=0,at=Be.length;je<at;++je){var Kt=Be[je];if(Ve(me,Kt.key))return Kt.value}return Q}case w:{var Cr=f(_e,J),Dn=p(Cr);if(Re.mask&Dn){Re=Re.children[h(Re.mask,Dn)],_e+=r;break}return Q}case x:{if(Re=Re.children[f(_e,J)],Re){_e+=r;break}return Q}default:return Q}};B.prototype.tryGetHash=function(Q,J,me){return q(Q,J,me,this)};var G=e.tryGet=function(Q,J,me){return q(Q,me._config.hash(J),J,me)};B.prototype.tryGet=function(Q,J){return G(Q,J,this)};var re=e.getHash=function(Q,J,me){return q(void 0,Q,J,me)};B.prototype.getHash=function(Q,J){return re(Q,J,this)},e.get=function(Q,J){return q(void 0,J._config.hash(Q),Q,J)},B.prototype.get=function(Q,J){return G(J,Q,this)};var j=e.has=function(Q,J,me){return q(u,Q,J,me)!==u};B.prototype.hasHash=function(Q,J){return j(Q,J,this)};var ae=e.has=function(Q,J){return j(J._config.hash(Q),Q,J)};B.prototype.has=function(Q){return ae(Q,this)};var ne=function(J,me){return J===me};e.make=function(Q){return new B(0,0,{keyEq:Q&&Q.keyEq||ne,hash:Q&&Q.hash||c},C,0)},e.empty=e.make();var le=e.isEmpty=function(Q){return Q&&!!E(Q._root)};B.prototype.isEmpty=function(){return le(this)};var xe=e.modifyHash=function(Q,J,me,Ce){var Re={value:Ce._size},_e=Ce._root._modify(Ce._editable?Ce._edit:NaN,Ce._config.keyEq,0,Q,J,me,Re);return Ce.setTree(_e,Re.value)};B.prototype.modifyHash=function(Q,J,me){return xe(me,Q,J,this)};var se=e.modify=function(Q,J,me){return xe(Q,me._config.hash(J),J,me)};B.prototype.modify=function(Q,J){return se(J,Q,this)};var we=e.setHash=function(Q,J,me,Ce){return xe(l(me),Q,J,Ce)};B.prototype.setHash=function(Q,J,me){return we(Q,J,me,this)};var de=e.set=function(Q,J,me){return we(me._config.hash(Q),Q,J,me)};B.prototype.set=function(Q,J){return de(Q,J,this)};var Z=l(u),ge=e.removeHash=function(Q,J,me){return xe(Z,Q,J,me)};B.prototype.removeHash=B.prototype.deleteHash=function(Q,J){return ge(Q,J,this)};var be=e.remove=function(Q,J){return ge(J._config.hash(Q),Q,J)};B.prototype.remove=B.prototype.delete=function(Q){return be(Q,this)};var fe=e.beginMutation=function(Q){return new B(Q._editable+1,Q._edit+1,Q._config,Q._root,Q._size)};B.prototype.beginMutation=function(){return fe(this)};var On=e.endMutation=function(Q){return Q._editable=Q._editable&&Q._editable-1,Q};B.prototype.endMutation=function(){return On(this)};var pn=e.mutate=function(Q,J){var me=fe(J);return Q(me),On(me)};B.prototype.mutate=function(Q){return pn(Q,this)};var Me=function(J){return J&&tt(J[0],J[1],J[2],J[3],J[4])},tt=function(J,me,Ce,Re,_e){for(;Ce<J;){var Ve=me[Ce++];if(Ve&&!E(Ve))return wt(Ve,Re,[J,me,Ce,Re,_e])}return Me(_e)},wt=function(J,me,Ce){switch(J.type){case y:return{value:me(J),rest:Ce};case b:case x:case w:var Re=J.children;return tt(Re.length,Re,0,me,Ce);default:return Me(Ce)}},Te={done:!0};function nt(Q){this.v=Q}nt.prototype.next=function(){if(!this.v)return Te;var Q=this.v;return this.v=Me(Q.rest),Q},nt.prototype[Symbol.iterator]=function(){return this};var Le=function(J,me){return new nt(wt(J._root,me))},rt=function(J){return[J.key,J.value]},ot=e.entries=function(Q){return Le(Q,rt)};B.prototype.entries=B.prototype[Symbol.iterator]=function(){return ot(this)};var Ge=function(J){return J.key},Ct=e.keys=function(Q){return Le(Q,Ge)};B.prototype.keys=function(){return Ct(this)};var _o=function(J){return J.value},ui=e.values=B.prototype.values=function(Q){return Le(Q,_o)};B.prototype.values=function(){return ui(this)};var ju=e.fold=function(Q,J,me){var Ce=me._root;if(Ce.type===y)return Q(J,Ce.value,Ce.key);for(var Re=[Ce.children],_e=void 0;_e=Re.pop();)for(var Ve=0,Be=_e.length;Ve<Be;){var je=_e[Ve++];je&&je.type&&(je.type===y?J=Q(J,je.value,je.key):Re.push(je.children))}return J};B.prototype.fold=function(Q,J){return ju(Q,J,this)};var qc=e.forEach=function(Q,J){return ju(function(me,Ce,Re){return Q(Ce,Re,J)},null,J)};B.prototype.forEach=function(Q){return qc(Q,this)};var Kc=e.count=function(Q){return Q._size};B.prototype.count=function(){return Kc(this)},Object.defineProperty(B.prototype,"size",{get:B.prototype.count}),t.exports?t.exports=e:(void 0).hamt=e});class Qte{constructor(n){Ke(this,"_map",void 0),this._map=new Map(n==null?void 0:n.entries())}keys(){return this._map.keys()}entries(){return this._map.entries()}get(n){return this._map.get(n)}has(n){return this._map.has(n)}set(n,e){return this._map.set(n,e),this}delete(n){return this._map.delete(n),this}clone(){return S2(this)}toMap(){return new Map(this._map)}}class x2{constructor(n){if(Ke(this,"_hamt",Jte.empty.beginMutation()),n instanceof x2){const e=n._hamt.endMutation();n._hamt=e.beginMutation(),this._hamt=e.beginMutation()}else if(n)for(const[e,r]of n.entries())this._hamt.set(e,r)}keys(){return this._hamt.keys()}entries(){return this._hamt.entries()}get(n){return this._hamt.get(n)}has(n){return this._hamt.has(n)}set(n,e){return this._hamt.set(n,e),this}delete(n){return this._hamt.delete(n),this}clone(){return S2(this)}toMap(){return new Map(this._hamt)}}function S2(t){return Pt("recoil_hamt_2020")?new x2(t):new Qte(t)}var Zte={persistentMap:S2},ene=Zte.persistentMap,tne=Object.freeze({__proto__:null,persistentMap:ene});function nne(t,...n){const e=new Set;e:for(const r of t){for(const i of n)if(i.has(r))continue e;e.add(r)}return e}var nf=nne;function rne(t,n){const e=new Map;return t.forEach((r,i)=>{e.set(i,n(r,i))}),e}var _v=rne;function ine(){return{nodeDeps:new Map,nodeToNodeSubscriptions:new Map}}function one(t){return{nodeDeps:_v(t.nodeDeps,n=>new Set(n)),nodeToNodeSubscriptions:_v(t.nodeToNodeSubscriptions,n=>new Set(n))}}function R1(t,n,e,r){const{nodeDeps:i,nodeToNodeSubscriptions:o}=e,a=i.get(t);if(a&&r&&a!==r.nodeDeps.get(t))return;i.set(t,n);const s=a==null?n:nf(n,a);for(const u of s)o.has(u)||o.set(u,new Set),Zt(o.get(u)).add(t);if(a){const u=nf(a,n);for(const l of u){if(!o.has(l))return;const c=Zt(o.get(l));c.delete(t),c.size===0&&o.delete(l)}}}function ane(t,n,e,r){var i,o,a,s;const u=e.getState();r===u.currentTree.version||r===((i=u.nextTree)===null||i===void 0?void 0:i.version)||((o=u.previousTree)===null||o===void 0||o.version);const l=e.getGraph(r);if(R1(t,n,l),r===((a=u.previousTree)===null||a===void 0?void 0:a.version)){const d=e.getGraph(u.currentTree.version);R1(t,n,d,l)}if(r===((s=u.previousTree)===null||s===void 0?void 0:s.version)||r===u.currentTree.version){var c;const d=(c=u.nextTree)===null||c===void 0?void 0:c.version;if(d!==void 0){const f=e.getGraph(d);R1(t,n,f,l)}}}var Ap={cloneGraph:one,graph:ine,saveDepsToStore:ane};let sne=0;const une=()=>sne++;let lne=0;const cne=()=>lne++;let dne=0;const fne=()=>dne++;var xy={getNextTreeStateVersion:une,getNextStoreID:cne,getNextComponentID:fne};const{persistentMap:Wk}=tne,{graph:pne}=Ap,{getNextTreeStateVersion:$F}=xy;function UF(){const t=$F();return{version:t,stateID:t,transactionMetadata:{},dirtyAtoms:new Set,atomValues:Wk(),nonvalidatedAtoms:Wk()}}function hne(){const t=UF();return{currentTree:t,nextTree:null,previousTree:null,commitDepth:0,knownAtoms:new Set,knownSelectors:new Set,transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(t.version,pne()),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}}var WF={makeEmptyTreeState:UF,makeEmptyStoreState:hne,getNextTreeStateVersion:$F};class HF{}function mne(){return new HF}var Sy={RetentionZone:HF,retentionZone:mne};function vne(t,n){const e=new Set(t);return e.add(n),e}function gne(t,n){const e=new Set(t);return e.delete(n),e}function yne(t,n,e){const r=new Map(t);return r.set(n,e),r}function bne(t,n,e){const r=new Map(t);return r.set(n,e(r.get(n))),r}function wne(t,n){const e=new Map(t);return e.delete(n),e}function xne(t,n){const e=new Map(t);return n.forEach(r=>e.delete(r)),e}var GF={setByAddingToSet:vne,setByDeletingFromSet:gne,mapBySettingInMap:yne,mapByUpdatingInMap:bne,mapByDeletingFromMap:wne,mapByDeletingMultipleFromMap:xne};function*Sne(t,n){let e=0;for(const r of t)n(r,e++)&&(yield r)}var E2=Sne;function Ene(t,n){return new Proxy(t,{get:(r,i)=>(!(i in r)&&i in n&&(r[i]=n[i]()),r[i]),ownKeys:r=>Object.keys(r)})}var qF=Ene;const{getNode:Op,getNodeMaybe:Cne,recoilValuesForKeys:Hk}=Vr,{RetentionZone:Gk}=Sy,{setByAddingToSet:Rne}=GF,Tne=Object.freeze(new Set);class Nne extends Error{}function kne(t,n,e){if(!Pt("recoil_memory_managament_2020"))return()=>{};const{nodesRetainedByZone:r}=t.getState().retention;function i(o){let a=r.get(o);a||r.set(o,a=new Set),a.add(n)}if(e instanceof Gk)i(e);else if(Array.isArray(e))for(const o of e)i(o);return()=>{if(!Pt("recoil_memory_managament_2020"))return;const{retention:o}=t.getState();function a(s){const u=o.nodesRetainedByZone.get(s);u==null||u.delete(n),u&&u.size===0&&o.nodesRetainedByZone.delete(s)}if(e instanceof Gk)a(e);else if(Array.isArray(e))for(const s of e)a(s)}}function C2(t,n,e,r){const i=t.getState();if(i.nodeCleanupFunctions.has(e))return;const o=Op(e),a=kne(t,e,o.retainedBy),s=o.init(t,n,r);i.nodeCleanupFunctions.set(e,()=>{s(),a()})}function Ine(t,n,e){C2(t,t.getState().currentTree,n,e)}function _ne(t,n){var e;const r=t.getState();(e=r.nodeCleanupFunctions.get(n))===null||e===void 0||e(),r.nodeCleanupFunctions.delete(n)}function Ane(t,n,e){return C2(t,n,e,"get"),Op(e).get(t,n)}function KF(t,n,e){return Op(e).peek(t,n)}function One(t,n,e){var r;const i=Cne(n);return i==null||(r=i.invalidate)===null||r===void 0||r.call(i,t),{...t,atomValues:t.atomValues.clone().delete(n),nonvalidatedAtoms:t.nonvalidatedAtoms.clone().set(n,e),dirtyAtoms:Rne(t.dirtyAtoms,n)}}function Dne(t,n,e,r){const i=Op(e);if(i.set==null)throw new Nne(`Attempt to set read-only RecoilValue: ${e}`);const o=i.set;return C2(t,n,e,"set"),o(t,n,r)}function Mne(t,n,e){const r=t.getState(),i=t.getGraph(n.version),o=Op(e).nodeType;return qF({type:o},{loadable:()=>KF(t,n,e),isActive:()=>r.knownAtoms.has(e)||r.knownSelectors.has(e),isSet:()=>o==="selector"?!1:n.atomValues.has(e),isModified:()=>n.dirtyAtoms.has(e),deps:()=>{var a;return Hk((a=i.nodeDeps.get(e))!==null&&a!==void 0?a:[])},subscribers:()=>{var a,s;return{nodes:Hk(E2(XF(t,n,new Set([e])),u=>u!==e)),components:wy((a=(s=r.nodeToComponentSubscriptions.get(e))===null||s===void 0?void 0:s.values())!==null&&a!==void 0?a:[],([u])=>({name:u}))}}})}function XF(t,n,e){const r=new Set,i=Array.from(e),o=t.getGraph(n.version);for(let s=i.pop();s;s=i.pop()){var a;r.add(s);const u=(a=o.nodeToNodeSubscriptions.get(s))!==null&&a!==void 0?a:Tne;for(const l of u)r.has(l)||i.push(l)}return r}var Ss={getNodeLoadable:Ane,peekNodeLoadable:KF,setNodeValue:Dne,initializeNode:Ine,cleanUpNode:_ne,setUnvalidatedAtomValue_DEPRECATED:One,peekNodeInfo:Mne,getDownstreamNodes:XF};let YF=null;function Pne(t){YF=t}function Lne(){var t;(t=YF)===null||t===void 0||t()}var JF={setInvalidateMemoizedSnapshot:Pne,invalidateMemoizedSnapshot:Lne};const{getDownstreamNodes:Fne,getNodeLoadable:QF,setNodeValue:zne}=Ss,{getNextComponentID:Bne}=xy,{getNode:jne,getNodeMaybe:ZF}=Vr,{DefaultValue:R2}=Vr,{reactMode:Vne}=_p,{AbstractRecoilValue:$ne,RecoilState:Une,RecoilValueReadOnly:Wne,isRecoilValue:Hne}=pc,{invalidateMemoizedSnapshot:Gne}=JF;function qne(t,{key:n},e=t.getState().currentTree){var r,i;const o=t.getState();e.version===o.currentTree.version||e.version===((r=o.nextTree)===null||r===void 0?void 0:r.version)||(e.version,(i=o.previousTree)===null||i===void 0||i.version);const a=QF(t,e,n);return a.state==="loading"&&a.contents.catch(()=>{}),a}function Kne(t,n){const e=t.clone();return n.forEach((r,i)=>{r.state==="hasValue"&&r.contents instanceof R2?e.delete(i):e.set(i,r)}),e}function Xne(t,n,{key:e},r){if(typeof r=="function"){const i=QF(t,n,e);if(i.state==="loading"){const o=`Tried to set atom or selector "${e}" using an updater function while the current state is pending, this is not currently supported.`;throw Qe(o)}else if(i.state==="hasError")throw i.contents;return r(i.contents)}else return r}function Yne(t,n,e){if(e.type==="set"){const{recoilValue:i,valueOrUpdater:o}=e,a=Xne(t,n,i,o),s=zne(t,n,i.key,a);for(const[u,l]of s.entries())Zw(n,u,l)}else if(e.type==="setLoadable"){const{recoilValue:{key:i},loadable:o}=e;Zw(n,i,o)}else if(e.type==="markModified"){const{recoilValue:{key:i}}=e;n.dirtyAtoms.add(i)}else if(e.type==="setUnvalidated"){var r;const{recoilValue:{key:i},unvalidatedValue:o}=e,a=ZF(i);a==null||(r=a.invalidate)===null||r===void 0||r.call(a,n),n.atomValues.delete(i),n.nonvalidatedAtoms.set(i,o),n.dirtyAtoms.add(i)}else y2(`Unknown action ${e.type}`)}function Zw(t,n,e){e.state==="hasValue"&&e.contents instanceof R2?t.atomValues.delete(n):t.atomValues.set(n,e),t.dirtyAtoms.add(n),t.nonvalidatedAtoms.delete(n)}function ez(t,n){t.replaceState(e=>{const r=tz(e);for(const i of n)Yne(t,r,i);return nz(t,r),Gne(),r})}function Ey(t,n){if(rf.length){const e=rf[rf.length-1];let r=e.get(t);r||e.set(t,r=[]),r.push(n)}else ez(t,[n])}const rf=[];function Jne(){const t=new Map;return rf.push(t),()=>{for(const[n,e]of t)ez(n,e);rf.pop()}}function tz(t){return{...t,atomValues:t.atomValues.clone(),nonvalidatedAtoms:t.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(t.dirtyAtoms)}}function nz(t,n){const e=Fne(t,n,n.dirtyAtoms);for(const o of e){var r,i;(r=ZF(o))===null||r===void 0||(i=r.invalidate)===null||i===void 0||i.call(r,n)}}function rz(t,n,e){Ey(t,{type:"set",recoilValue:n,valueOrUpdater:e})}function Qne(t,n,e){if(e instanceof R2)return rz(t,n,e);Ey(t,{type:"setLoadable",recoilValue:n,loadable:e})}function Zne(t,n){Ey(t,{type:"markModified",recoilValue:n})}function ere(t,n,e){Ey(t,{type:"setUnvalidated",recoilValue:n,unvalidatedValue:e})}function tre(t,{key:n},e,r=null){const i=Bne(),o=t.getState();o.nodeToComponentSubscriptions.has(n)||o.nodeToComponentSubscriptions.set(n,new Map),Zt(o.nodeToComponentSubscriptions.get(n)).set(i,[r??"<not captured>",e]);const a=Vne();if(a.early&&(a.mode==="LEGACY"||a.mode==="MUTABLE_SOURCE")){const s=t.getState().nextTree;s&&s.dirtyAtoms.has(n)&&e(s)}return{release:()=>{const s=t.getState(),u=s.nodeToComponentSubscriptions.get(n);u===void 0||!u.has(i)||(u.delete(i),u.size===0&&s.nodeToComponentSubscriptions.delete(n))}}}function nre(t,n){var e;const{currentTree:r}=t.getState(),i=jne(n.key);(e=i.clearCache)===null||e===void 0||e.call(i,t,r)}var No={RecoilValueReadOnly:Wne,AbstractRecoilValue:$ne,RecoilState:Une,getRecoilValueAsLoadable:qne,setRecoilValue:rz,setRecoilValueLoadable:Qne,markRecoilValueModified:Zne,setUnvalidatedRecoilValue:ere,subscribeToRecoilValue:tre,isRecoilValue:Hne,applyAtomValueWrites:Kne,batchStart:Jne,writeLoadableToTreeState:Zw,invalidateDownstreams:nz,copyTreeState:tz,refreshRecoilValue:nre};function rre(t,n,e){const r=t.entries();let i=r.next();for(;!i.done;){const o=i.value;if(n.call(e,o[1],o[0],t))return!0;i=r.next()}return!1}var ire=rre;const{cleanUpNode:ore}=Ss,{deleteNodeConfigIfPossible:are,getNode:iz}=Vr,{RetentionZone:oz}=Sy,sre=12e4,az=new Set;function sz(t,n){const e=t.getState(),r=e.currentTree;if(e.nextTree)return;const i=new Set;for(const a of n)if(a instanceof oz)for(const s of dre(e,a))i.add(s);else i.add(a);const o=ure(t,i);for(const a of o)cre(t,r,a)}function ure(t,n){const e=t.getState(),r=e.currentTree,i=t.getGraph(r.version),o=new Set,a=new Set;return s(n),o;function s(u){const l=new Set,c=lre(t,r,u,o,a);for(const h of c){var d;if(iz(h).retainedBy==="recoilRoot"){a.add(h);continue}if(((d=e.retention.referenceCounts.get(h))!==null&&d!==void 0?d:0)>0){a.add(h);continue}if(uz(h).some(g=>e.retention.referenceCounts.get(g))){a.add(h);continue}const v=i.nodeToNodeSubscriptions.get(h);if(v&&ire(v,g=>a.has(g))){a.add(h);continue}o.add(h),l.add(h)}const f=new Set;for(const h of l)for(const v of(p=i.nodeDeps.get(h))!==null&&p!==void 0?p:az){var p;o.has(v)||f.add(v)}f.size&&s(f)}}function lre(t,n,e,r,i){const o=t.getGraph(n.version),a=[],s=new Set;for(;e.size>0;)u(Zt(e.values().next().value));return a;function u(l){if(r.has(l)||i.has(l)){e.delete(l);return}if(s.has(l))return;const c=o.nodeToNodeSubscriptions.get(l);if(c)for(const d of c)u(d);s.add(l),e.delete(l),a.push(l)}}function cre(t,n,e){if(!Pt("recoil_memory_managament_2020"))return;ore(t,e);const r=t.getState();r.knownAtoms.delete(e),r.knownSelectors.delete(e),r.nodeTransactionSubscriptions.delete(e),r.retention.referenceCounts.delete(e);const i=uz(e);for(const u of i){var o;(o=r.retention.nodesRetainedByZone.get(u))===null||o===void 0||o.delete(e)}n.atomValues.delete(e),n.dirtyAtoms.delete(e),n.nonvalidatedAtoms.delete(e);const a=r.graphsByVersion.get(n.version);if(a){const u=a.nodeDeps.get(e);if(u!==void 0){a.nodeDeps.delete(e);for(const l of u){var s;(s=a.nodeToNodeSubscriptions.get(l))===null||s===void 0||s.delete(e)}}a.nodeToNodeSubscriptions.delete(e)}are(e)}function dre(t,n){var e;return(e=t.retention.nodesRetainedByZone.get(n))!==null&&e!==void 0?e:az}function uz(t){const n=iz(t).retainedBy;return n===void 0||n==="components"||n==="recoilRoot"?[]:n instanceof oz?[n]:n}function fre(t,n){const e=t.getState();e.nextTree?e.retention.retainablesToCheckForRelease.add(n):sz(t,new Set([n]))}function pre(t,n,e){var r;if(!Pt("recoil_memory_managament_2020"))return;const i=t.getState().retention.referenceCounts,o=((r=i.get(n))!==null&&r!==void 0?r:0)+e;o===0?lz(t,n):i.set(n,o)}function lz(t,n){if(!Pt("recoil_memory_managament_2020"))return;t.getState().retention.referenceCounts.delete(n),fre(t,n)}function hre(t){if(!Pt("recoil_memory_managament_2020"))return;const n=t.getState();sz(t,n.retention.retainablesToCheckForRelease),n.retention.retainablesToCheckForRelease.clear()}function mre(t){return t===void 0?"recoilRoot":t}var Pu={SUSPENSE_TIMEOUT_MS:sre,updateRetainCount:pre,updateRetainCountToZero:lz,releaseScheduledRetainablesNow:hre,retainedByOptionWithDefault:mre};const{unstable_batchedUpdates:vre}=BO;var gre={unstable_batchedUpdates:vre};const{unstable_batchedUpdates:yre}=gre;var bre={unstable_batchedUpdates:yre};const{batchStart:wre}=No,{unstable_batchedUpdates:xre}=bre;let T2=xre||(t=>t());const Sre=t=>{T2=t},Ere=()=>T2,Cre=t=>{T2(()=>{let n=()=>{};try{n=wre(),t()}finally{n()}})};var Cy={getBatcher:Ere,setBatcher:Sre,batchUpdates:Cre};function*Rre(t){for(const n of t)for(const e of n)yield e}var cz=Rre;const dz=typeof Window>"u"||typeof window>"u",Tre=t=>!dz&&(t===window||t instanceof Window),Nre=typeof navigator<"u"&&navigator.product==="ReactNative";var Ry={isSSR:dz,isReactNative:Nre,isWindow:Tre};function kre(t,n){let e;return(...r)=>{e||(e={});const i=n(...r);return Object.hasOwnProperty.call(e,i)||(e[i]=t(...r)),e[i]}}function Ire(t,n){let e,r;return(...i)=>{const o=n(...i);return e===o||(e=o,r=t(...i)),r}}function _re(t,n){let e,r;return[(...a)=>{const s=n(...a);return e===s||(e=s,r=t(...a)),r},()=>{e=null}]}var Are={memoizeWithArgsHash:kre,memoizeOneWithArgsHash:Ire,memoizeOneWithArgsHashAndInvalidation:_re};const{batchUpdates:ex}=Cy,{initializeNode:Ore,peekNodeInfo:Dre}=Ss,{graph:Mre}=Ap,{getNextStoreID:Pre}=xy,{DEFAULT_VALUE:Lre,recoilValues:qk,recoilValuesForKeys:Kk}=Vr,{AbstractRecoilValue:Fre,getRecoilValueAsLoadable:zre,setRecoilValue:Xk,setUnvalidatedRecoilValue:Bre}=No,{updateRetainCount:wm}=Pu,{setInvalidateMemoizedSnapshot:jre}=JF,{getNextTreeStateVersion:Vre,makeEmptyStoreState:$re}=WF,{isSSR:Ure}=Ry,{memoizeOneWithArgsHashAndInvalidation:Wre}=Are;class Ty{constructor(n,e){Ke(this,"_store",void 0),Ke(this,"_refCount",1),Ke(this,"getLoadable",r=>(this.checkRefCount_INTERNAL(),zre(this._store,r))),Ke(this,"getPromise",r=>(this.checkRefCount_INTERNAL(),this.getLoadable(r).toPromise())),Ke(this,"getNodes_UNSTABLE",r=>{if(this.checkRefCount_INTERNAL(),(r==null?void 0:r.isModified)===!0){if((r==null?void 0:r.isInitialized)===!1)return[];const a=this._store.getState().currentTree;return Kk(a.dirtyAtoms)}const i=this._store.getState().knownAtoms,o=this._store.getState().knownSelectors;return(r==null?void 0:r.isInitialized)==null?qk.values():r.isInitialized===!0?Kk(cz([i,o])):E2(qk.values(),({key:a})=>!i.has(a)&&!o.has(a))}),Ke(this,"getInfo_UNSTABLE",({key:r})=>(this.checkRefCount_INTERNAL(),Dre(this._store,this._store.getState().currentTree,r))),Ke(this,"map",r=>{this.checkRefCount_INTERNAL();const i=new tx(this,ex);return r(i),i}),Ke(this,"asyncMap",async r=>{this.checkRefCount_INTERNAL();const i=new tx(this,ex);return i.retain(),await r(i),i.autoRelease_INTERNAL(),i}),this._store={storeID:Pre(),parentStoreID:e,getState:()=>n,replaceState:r=>{n.currentTree=r(n.currentTree)},getGraph:r=>{const i=n.graphsByVersion;if(i.has(r))return Zt(i.get(r));const o=Mre();return i.set(r,o),o},subscribeToTransactions:()=>({release:()=>{}}),addTransactionMetadata:()=>{throw Qe("Cannot subscribe to Snapshots")}};for(const r of this._store.getState().knownAtoms)Ore(this._store,r,"get"),wm(this._store,r,1);this.autoRelease_INTERNAL()}retain(){this._refCount<=0,this._refCount++;let n=!1;return()=>{n||(n=!0,this._release())}}autoRelease_INTERNAL(){Ure||window.setTimeout(()=>this._release(),10)}_release(){if(this._refCount--,this._refCount===0){if(this._store.getState().nodeCleanupFunctions.forEach(n=>n()),this._store.getState().nodeCleanupFunctions.clear(),!Pt("recoil_memory_managament_2020"))return}else this._refCount<0}isRetained(){return this._refCount>0}checkRefCount_INTERNAL(){Pt("recoil_memory_managament_2020")&&this._refCount<=0}getStore_INTERNAL(){return this.checkRefCount_INTERNAL(),this._store}getID(){return this.checkRefCount_INTERNAL(),this._store.getState().currentTree.stateID}getStoreID(){return this.checkRefCount_INTERNAL(),this._store.storeID}}function fz(t,n,e=!1){const r=t.getState(),i=e?Vre():n.version;return{currentTree:{version:e?i:n.version,stateID:e?i:n.stateID,transactionMetadata:{...n.transactionMetadata},dirtyAtoms:new Set(n.dirtyAtoms),atomValues:n.atomValues.clone(),nonvalidatedAtoms:n.nonvalidatedAtoms.clone()},commitDepth:0,nextTree:null,previousTree:null,knownAtoms:new Set(r.knownAtoms),knownSelectors:new Set(r.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(i,t.getGraph(n.version)),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map(wy(r.nodeCleanupFunctions.entries(),([o])=>[o,()=>{}]))}}function Hre(t){const n=new Ty($re());return t!=null?n.map(t):n}const[Yk,pz]=Wre((t,n)=>{var e;const r=t.getState(),i=n==="latest"?(e=r.nextTree)!==null&&e!==void 0?e:r.currentTree:Zt(r.previousTree);return new Ty(fz(t,i),t.storeID)},(t,n)=>{var e,r;return String(n)+String(t.storeID)+String((e=t.getState().nextTree)===null||e===void 0?void 0:e.version)+String(t.getState().currentTree.version)+String((r=t.getState().previousTree)===null||r===void 0?void 0:r.version)});jre(pz);function Gre(t,n="latest"){const e=Yk(t,n);return e.isRetained()?e:(pz(),Yk(t,n))}class tx extends Ty{constructor(n,e){super(fz(n.getStore_INTERNAL(),n.getStore_INTERNAL().getState().currentTree,!0),n.getStoreID()),Ke(this,"_batch",void 0),Ke(this,"set",(r,i)=>{this.checkRefCount_INTERNAL();const o=this.getStore_INTERNAL();this._batch(()=>{wm(o,r.key,1),Xk(this.getStore_INTERNAL(),r,i)})}),Ke(this,"reset",r=>{this.checkRefCount_INTERNAL();const i=this.getStore_INTERNAL();this._batch(()=>{wm(i,r.key,1),Xk(this.getStore_INTERNAL(),r,Lre)})}),Ke(this,"setUnvalidatedAtomValues_DEPRECATED",r=>{this.checkRefCount_INTERNAL();const i=this.getStore_INTERNAL();ex(()=>{for(const[o,a]of r.entries())wm(i,o,1),Bre(i,new Fre(o),a)})}),this._batch=e}}var Ny={Snapshot:Ty,MutableSnapshot:tx,freshSnapshot:Hre,cloneSnapshot:Gre},qre=Ny.Snapshot,Kre=Ny.MutableSnapshot,Xre=Ny.freshSnapshot,Yre=Ny.cloneSnapshot,ky=Object.freeze({__proto__:null,Snapshot:qre,MutableSnapshot:Kre,freshSnapshot:Xre,cloneSnapshot:Yre});function Jre(...t){const n=new Set;for(const e of t)for(const r of e)n.add(r);return n}var Qre=Jre;const{useRef:Zre}=Ae;function eie(t){const n=Zre(t);return n.current===t&&typeof t=="function"&&(n.current=t()),n}var Jk=eie;const{getNextTreeStateVersion:tie,makeEmptyStoreState:hz}=WF,{cleanUpNode:nie,getDownstreamNodes:rie,initializeNode:iie,setNodeValue:oie,setUnvalidatedAtomValue_DEPRECATED:aie}=Ss,{graph:sie}=Ap,{cloneGraph:uie}=Ap,{getNextStoreID:mz}=xy,{createMutableSource:T1,reactMode:vz}=_p,{applyAtomValueWrites:lie}=No,{releaseScheduledRetainablesNow:gz}=Pu,{freshSnapshot:cie}=ky,{useCallback:die,useContext:yz,useEffect:nx,useMemo:fie,useRef:pie,useState:hie}=Ae;function pd(){throw Qe("This component must be used inside a <RecoilRoot> component.")}const bz=Object.freeze({storeID:mz(),getState:pd,replaceState:pd,getGraph:pd,subscribeToTransactions:pd,addTransactionMetadata:pd});let rx=!1;function Qk(t){if(rx)throw Qe("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");const n=t.getState();if(n.nextTree===null){Pt("recoil_memory_managament_2020")&&Pt("recoil_release_on_cascading_update_killswitch_2021")&&n.commitDepth>0&&gz(t);const e=n.currentTree.version,r=tie();n.nextTree={...n.currentTree,version:r,stateID:r,dirtyAtoms:new Set,transactionMetadata:{}},n.graphsByVersion.set(r,uie(Zt(n.graphsByVersion.get(e))))}}const wz=Ae.createContext({current:bz}),Iy=()=>yz(wz),xz=Ae.createContext(null);function mie(){return yz(xz)}function N2(t,n,e){const r=rie(t,e,e.dirtyAtoms);for(const i of r){const o=n.nodeToComponentSubscriptions.get(i);if(o)for(const[a,[s,u]]of o)u(e)}}function Sz(t){const n=t.getState(),e=n.currentTree,r=e.dirtyAtoms;if(r.size){for(const[i,o]of n.nodeTransactionSubscriptions)if(r.has(i))for(const[a,s]of o)s(t);for(const[i,o]of n.transactionSubscriptions)o(t);(!vz().early||n.suspendedComponentResolvers.size>0)&&(N2(t,n,e),n.suspendedComponentResolvers.forEach(i=>i()),n.suspendedComponentResolvers.clear())}n.queuedComponentCallbacks_DEPRECATED.forEach(i=>i(e)),n.queuedComponentCallbacks_DEPRECATED.splice(0,n.queuedComponentCallbacks_DEPRECATED.length)}function vie(t){const n=t.getState();n.commitDepth++;try{const{nextTree:e}=n;if(e==null)return;n.previousTree=n.currentTree,n.currentTree=e,n.nextTree=null,Sz(t),n.previousTree!=null?n.graphsByVersion.delete(n.previousTree.version):y2("Ended batch with no previous state, which is unexpected","recoil"),n.previousTree=null,Pt("recoil_memory_managament_2020")&&e==null&&gz(t)}finally{n.commitDepth--}}function gie({setNotifyBatcherOfChange:t}){const n=Iy(),[,e]=hie([]);return t(()=>e({})),nx(()=>(t(()=>e({})),()=>{t(()=>{})}),[t]),nx(()=>{Xte.enqueueExecution("Batcher",()=>{vie(n.current)})}),null}function yie(t,n){const e=hz();return n({set:(r,i)=>{const o=e.currentTree,a=oie(t,o,r.key,i),s=new Set(a.keys()),u=o.nonvalidatedAtoms.clone();for(const l of s)u.delete(l);e.currentTree={...o,dirtyAtoms:Qre(o.dirtyAtoms,s),atomValues:lie(o.atomValues,a),nonvalidatedAtoms:u}},setUnvalidatedAtomValues:r=>{r.forEach((i,o)=>{e.currentTree=aie(e.currentTree,o,i)})}}),e}function bie(t){const n=cie(t),e=n.getStore_INTERNAL().getState();return n.retain(),e.nodeCleanupFunctions.forEach(r=>r()),e.nodeCleanupFunctions.clear(),e}let Zk=0;function wie({initializeState_DEPRECATED:t,initializeState:n,store_INTERNAL:e,children:r}){let i;const o=p=>{const h=i.current.graphsByVersion;if(h.has(p))return Zt(h.get(p));const v=sie();return h.set(p,v),v},a=(p,h)=>{if(h==null){const{transactionSubscriptions:v}=d.current.getState(),g=Zk++;return v.set(g,p),{release:()=>{v.delete(g)}}}else{const{nodeTransactionSubscriptions:v}=d.current.getState();v.has(h)||v.set(h,new Map);const g=Zk++;return Zt(v.get(h)).set(g,p),{release:()=>{const m=v.get(h);m&&(m.delete(g),m.size===0&&v.delete(h))}}}},s=p=>{Qk(d.current);for(const h of Object.keys(p))Zt(d.current.getState().nextTree).transactionMetadata[h]=p[h]},u=p=>{Qk(d.current);const h=Zt(i.current.nextTree);let v;try{rx=!0,v=p(h)}finally{rx=!1}v!==h&&(i.current.nextTree=v,vz().early&&N2(d.current,i.current,v),Zt(l.current)())},l=pie(null),c=die(p=>{l.current=p},[l]),d=Jk(()=>e??{storeID:mz(),getState:()=>i.current,replaceState:u,getGraph:o,subscribeToTransactions:a,addTransactionMetadata:s});e!=null&&(d.current=e),i=Jk(()=>t!=null?yie(d.current,t):n!=null?bie(n):hz());const f=fie(()=>T1==null?void 0:T1(i,()=>i.current.currentTree.version),[i]);return nx(()=>{const p=d.current;for(const h of new Set(p.getState().knownAtoms))iie(p,h,"get");return()=>{for(const h of p.getState().knownAtoms)nie(p,h)}},[d]),Ae.createElement(wz.Provider,{value:d},Ae.createElement(xz.Provider,{value:f},Ae.createElement(gie,{setNotifyBatcherOfChange:c}),r))}function xie(t){const{override:n,...e}=t,r=Iy();return n===!1&&r.current!==bz?t.children:Ae.createElement(wie,e)}function Sie(){return Iy().current.storeID}var ha={RecoilRoot:xie,useStoreRef:Iy,useRecoilMutableSource:mie,useRecoilStoreID:Sie,notifyComponents_FOR_TESTING:N2,sendEndOfBatchNotifications_FOR_TESTING:Sz};function Eie(t,n){if(t===n)return!0;if(t.length!==n.length)return!1;for(let e=0,r=t.length;e<r;e++)if(t[e]!==n[e])return!1;return!0}var Cie=Eie;const{useEffect:Rie,useRef:Tie}=Ae;function Nie(t){const n=Tie();return Rie(()=>{n.current=t}),n.current}var Ez=Nie;const{useStoreRef:kie}=ha,{SUSPENSE_TIMEOUT_MS:Iie}=Pu,{updateRetainCount:hd}=Pu,{RetentionZone:_ie}=Sy,{useEffect:Aie,useRef:Oie}=Ae,{isSSR:eI}=Ry;function Die(t){if(Pt("recoil_memory_managament_2020"))return Mie(t)}function Mie(t){const e=(Array.isArray(t)?t:[t]).map(a=>a instanceof _ie?a:a.key),r=kie();Aie(()=>{if(!Pt("recoil_memory_managament_2020"))return;const a=r.current;if(i.current&&!eI)window.clearTimeout(i.current),i.current=null;else for(const s of e)hd(a,s,1);return()=>{for(const s of e)hd(a,s,-1)}},[r,...e]);const i=Oie(),o=Ez(e);if(!eI&&(o===void 0||!Cie(o,e))){const a=r.current;for(const s of e)hd(a,s,1);if(o)for(const s of o)hd(a,s,-1);i.current&&window.clearTimeout(i.current),i.current=window.setTimeout(()=>{i.current=null;for(const s of e)hd(a,s,-1)},Iie)}}var k2=Die;function Pie(){return"<component name not available>"}var Dp=Pie;const{batchUpdates:Lie}=Cy,{DEFAULT_VALUE:Cz}=Vr,{currentRendererSupportsUseSyncExternalStore:Fie,reactMode:Fc,useMutableSource:zie,useSyncExternalStore:Bie}=_p,{useRecoilMutableSource:jie,useStoreRef:ko}=ha,{AbstractRecoilValue:ix,getRecoilValueAsLoadable:Mp,setRecoilValue:Av,setUnvalidatedRecoilValue:Vie,subscribeToRecoilValue:hc}=No,{useCallback:Lr,useEffect:mc,useMemo:Rz,useRef:of,useState:I2}=Ae,{setByAddingToSet:$ie}=GF,{isSSR:Uie}=Ry;function _2(t,n,e){if(t.state==="hasValue")return t.contents;throw t.state==="loading"?new Promise(i=>{const o=e.current.getState().suspendedComponentResolvers;o.add(i),Uie&&Wt(t.contents)&&t.contents.finally(()=>{o.delete(i)})}):t.state==="hasError"?t.contents:Qe(`Invalid value of loadable atom "${n.key}"`)}function Wie(){const t=Dp(),n=ko(),[,e]=I2([]),r=of(new Set);r.current=new Set;const i=of(new Set),o=of(new Map),a=Lr(u=>{const l=o.current.get(u);l&&(l.release(),o.current.delete(u))},[o]),s=Lr((u,l)=>{o.current.has(l)&&e([])},[]);return mc(()=>{const u=n.current;nf(r.current,i.current).forEach(l=>{if(o.current.has(l))return;const c=hc(u,new ix(l),f=>s(f,l),t);o.current.set(l,c),u.getState().nextTree?u.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{s(u.getState(),l)}):s(u.getState(),l)}),nf(i.current,r.current).forEach(l=>{a(l)}),i.current=r.current}),mc(()=>{const u=o.current;return nf(r.current,new Set(u.keys())).forEach(l=>{const c=hc(n.current,new ix(l),d=>s(d,l),t);u.set(l,c)}),()=>u.forEach((l,c)=>a(c))},[t,n,a,s]),Rz(()=>{function u(h){return v=>{Av(n.current,h,v)}}function l(h){return()=>Av(n.current,h,Cz)}function c(h){var v;r.current.has(h.key)||(r.current=$ie(r.current,h.key));const g=n.current.getState();return Mp(n.current,h,Fc().early&&(v=g.nextTree)!==null&&v!==void 0?v:g.currentTree)}function d(h){const v=c(h);return _2(v,h,n)}function f(h){return[d(h),u(h)]}function p(h){return[c(h),u(h)]}return{getRecoilValue:d,getRecoilValueLoadable:c,getRecoilState:f,getRecoilStateLoadable:p,getSetRecoilState:u,getResetRecoilState:l}},[r,n])}const Hie={current:0};function Gie(t){const n=ko(),e=Dp(),r=Lr(()=>{var s;const u=n.current,l=u.getState(),c=Fc().early&&(s=l.nextTree)!==null&&s!==void 0?s:l.currentTree;return{loadable:Mp(u,t,c),key:t.key}},[n,t]),i=Lr(s=>{let u;return()=>{var l,c;const d=s();return(l=u)!==null&&l!==void 0&&l.loadable.is(d.loadable)&&((c=u)===null||c===void 0?void 0:c.key)===d.key?u:(u=d,d)}},[]),o=Rz(()=>i(r),[r,i]),a=Lr(s=>{const u=n.current;return hc(u,t,s,e).release},[n,t,e]);return Bie(a,o,o).loadable}function qie(t){const n=ko(),e=Lr(()=>{var l;const c=n.current,d=c.getState(),f=Fc().early&&(l=d.nextTree)!==null&&l!==void 0?l:d.currentTree;return Mp(c,t,f)},[n,t]),r=Lr(()=>e(),[e]),i=Dp(),o=Lr((l,c)=>{const d=n.current;return hc(d,t,()=>{if(!Pt("recoil_suppress_rerender_in_callback"))return c();const p=e();u.current.is(p)||c(),u.current=p},i).release},[n,t,i,e]),a=jie();if(a==null)throw Qe("Recoil hooks must be used in components contained within a <RecoilRoot> component.");const s=zie(a,r,o),u=of(s);return mc(()=>{u.current=s}),s}function ox(t){const n=ko(),e=Dp(),r=Lr(()=>{var u;const l=n.current,c=l.getState(),d=Fc().early&&(u=c.nextTree)!==null&&u!==void 0?u:c.currentTree;return Mp(l,t,d)},[n,t]),i=Lr(()=>({loadable:r(),key:t.key}),[r,t.key]),o=Lr(u=>{const l=i();return u.loadable.is(l.loadable)&&u.key===l.key?u:l},[i]);mc(()=>{const u=hc(n.current,t,l=>{s(o)},e);return s(o),u.release},[e,t,n,o]);const[a,s]=I2(i);return a.key!==t.key?i().loadable:a.loadable}function Kie(t){const n=ko(),[,e]=I2([]),r=Dp(),i=Lr(()=>{var s;const u=n.current,l=u.getState(),c=Fc().early&&(s=l.nextTree)!==null&&s!==void 0?s:l.currentTree;return Mp(u,t,c)},[n,t]),o=i(),a=of(o);return mc(()=>{a.current=o}),mc(()=>{const s=n.current,u=s.getState(),l=hc(s,t,d=>{var f;if(!Pt("recoil_suppress_rerender_in_callback"))return e([]);const p=i();(f=a.current)!==null&&f!==void 0&&f.is(p)||e(p),a.current=p},r);if(u.nextTree)s.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{a.current=null,e([])});else{var c;if(!Pt("recoil_suppress_rerender_in_callback"))return e([]);const d=i();(c=a.current)!==null&&c!==void 0&&c.is(d)||e(d),a.current=d}return l.release},[r,i,t,n]),o}function A2(t){return Pt("recoil_memory_managament_2020")&&k2(t),{TRANSITION_SUPPORT:ox,SYNC_EXTERNAL_STORE:Fie()?Gie:ox,MUTABLE_SOURCE:qie,LEGACY:Kie}[Fc().mode](t)}function Tz(t){const n=ko(),e=A2(t);return _2(e,t,n)}function _y(t){const n=ko();return Lr(e=>{Av(n.current,t,e)},[n,t])}function Xie(t){const n=ko();return Lr(()=>{Av(n.current,t,Cz)},[n,t])}function Yie(t){return[Tz(t),_y(t)]}function Jie(t){return[A2(t),_y(t)]}function Qie(){const t=ko();return(n,e={})=>{Lie(()=>{t.current.addTransactionMetadata(e),n.forEach((r,i)=>Vie(t.current,new ix(i),r))})}}function Nz(t){return Pt("recoil_memory_managament_2020")&&k2(t),ox(t)}function kz(t){const n=ko(),e=Nz(t);return _2(e,t,n)}function Zie(t){return[kz(t),_y(t)]}var eoe={recoilComponentGetRecoilValueCount_FOR_TESTING:Hie,useRecoilInterface:Wie,useRecoilState:Yie,useRecoilStateLoadable:Jie,useRecoilValue:Tz,useRecoilValueLoadable:A2,useResetRecoilState:Xie,useSetRecoilState:_y,useSetUnvalidatedAtomValues:Qie,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:Nz,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:kz,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:Zie};function toe(t,n){const e=new Map;for(const[r,i]of t)n(i,r)&&e.set(r,i);return e}var noe=toe;function roe(t,n){const e=new Set;for(const r of t)n(r)&&e.add(r);return e}var ioe=roe;function ooe(...t){const n=new Map;for(let e=0;e<t.length;e++){const r=t[e].keys();let i;for(;!(i=r.next()).done;)n.set(i.value,t[e].get(i.value))}return n}var aoe=ooe;const{batchUpdates:soe}=Cy,{DEFAULT_VALUE:uoe,getNode:Iz,nodes:loe}=Vr,{useStoreRef:O2}=ha,{AbstractRecoilValue:coe,setRecoilValueLoadable:doe}=No,{SUSPENSE_TIMEOUT_MS:foe}=Pu,{cloneSnapshot:Ov}=ky,{useCallback:Ay,useEffect:_z,useRef:tI,useState:poe}=Ae,{isSSR:nI}=Ry;function Oy(t){const n=O2();_z(()=>n.current.subscribeToTransactions(t).release,[t,n])}function rI(t){const n=t.atomValues.toMap(),e=_v(noe(n,(r,i)=>{const a=Iz(i).persistence_UNSTABLE;return a!=null&&a.type!=="none"&&r.state==="hasValue"}),r=>r.contents);return aoe(t.nonvalidatedAtoms.toMap(),e)}function hoe(t){Oy(Ay(n=>{let e=n.getState().previousTree;const r=n.getState().currentTree;e||(e=n.getState().currentTree);const i=rI(r),o=rI(e),a=_v(loe,u=>{var l,c,d,f;return{persistence_UNSTABLE:{type:(l=(c=u.persistence_UNSTABLE)===null||c===void 0?void 0:c.type)!==null&&l!==void 0?l:"none",backButton:(d=(f=u.persistence_UNSTABLE)===null||f===void 0?void 0:f.backButton)!==null&&d!==void 0?d:!1}}}),s=ioe(r.dirtyAtoms,u=>i.has(u)||o.has(u));t({atomValues:i,previousAtomValues:o,atomInfo:a,modifiedAtoms:s,transactionMetadata:{...r.transactionMetadata}})},[t]))}function moe(t){Oy(Ay(n=>{const e=Ov(n,"latest"),r=Ov(n,"previous");t({snapshot:e,previousSnapshot:r})},[t]))}function voe(){const t=O2(),[n,e]=poe(()=>Ov(t.current)),r=Ez(n),i=tI(),o=tI();if(Oy(Ay(s=>e(Ov(s)),[])),_z(()=>{const s=n.retain();if(i.current&&!nI){var u;window.clearTimeout(i.current),i.current=null,(u=o.current)===null||u===void 0||u.call(o),o.current=null}return()=>{window.setTimeout(s,10)}},[n]),r!==n&&!nI){if(i.current){var a;window.clearTimeout(i.current),i.current=null,(a=o.current)===null||a===void 0||a.call(o),o.current=null}o.current=n.retain(),i.current=window.setTimeout(()=>{var s;i.current=null,(s=o.current)===null||s===void 0||s.call(o),o.current=null},foe)}return n}function Az(t,n){var e;const r=t.getState(),i=(e=r.nextTree)!==null&&e!==void 0?e:r.currentTree,o=n.getStore_INTERNAL().getState().currentTree;soe(()=>{const a=new Set;for(const l of[i.atomValues.keys(),o.atomValues.keys()])for(const c of l){var s,u;((s=i.atomValues.get(c))===null||s===void 0?void 0:s.contents)!==((u=o.atomValues.get(c))===null||u===void 0?void 0:u.contents)&&Iz(c).shouldRestoreFromSnapshots&&a.add(c)}a.forEach(l=>{doe(t,new coe(l),o.atomValues.has(l)?Zt(o.atomValues.get(l)):uoe)}),t.replaceState(l=>({...l,stateID:n.getID()}))})}function goe(){const t=O2();return Ay(n=>Az(t.current,n),[t])}var Oz={useRecoilSnapshot:voe,gotoSnapshot:Az,useGotoRecoilSnapshot:goe,useRecoilTransactionObserver:moe,useTransactionObservation_DEPRECATED:hoe,useTransactionSubscription_DEPRECATED:Oy};const{peekNodeInfo:yoe}=Ss,{useStoreRef:boe}=ha;function woe(){const t=boe();return({key:n})=>yoe(t.current,t.current.getState().currentTree,n)}var xoe=woe;const{reactMode:Soe}=_p,{RecoilRoot:Eoe,useStoreRef:Coe}=ha,{useMemo:Roe}=Ae;function Toe(){Soe().mode==="MUTABLE_SOURCE"&&console.warn("Warning: There are known issues using useRecoilBridgeAcrossReactRoots() in recoil_mutable_source rendering mode.  Please consider upgrading to recoil_sync_external_store mode.");const t=Coe().current;return Roe(()=>{function n({children:e}){return Ae.createElement(Eoe,{store_INTERNAL:t},e)}return n},[t])}var Noe=Toe;const{loadableWithValue:koe}=Ip,{initializeNode:Ioe}=Ss,{DEFAULT_VALUE:_oe,getNode:Aoe}=Vr,{copyTreeState:Ooe,getRecoilValueAsLoadable:Doe,invalidateDownstreams:Moe,writeLoadableToTreeState:Poe}=No;function iI(t){return Aoe(t.key).nodeType==="atom"}class Loe{constructor(n,e){Ke(this,"_store",void 0),Ke(this,"_treeState",void 0),Ke(this,"_changes",void 0),Ke(this,"get",r=>{if(this._changes.has(r.key))return this._changes.get(r.key);if(!iI(r))throw Qe("Reading selectors within atomicUpdate is not supported");const i=Doe(this._store,r,this._treeState);if(i.state==="hasValue")return i.contents;throw i.state==="hasError"?i.contents:Qe(`Expected Recoil atom ${r.key} to have a value, but it is in a loading state.`)}),Ke(this,"set",(r,i)=>{if(!iI(r))throw Qe("Setting selectors within atomicUpdate is not supported");if(typeof i=="function"){const o=this.get(r);this._changes.set(r.key,i(o))}else Ioe(this._store,r.key,"set"),this._changes.set(r.key,i)}),Ke(this,"reset",r=>{this.set(r,_oe)}),this._store=n,this._treeState=e,this._changes=new Map}newTreeState_INTERNAL(){if(this._changes.size===0)return this._treeState;const n=Ooe(this._treeState);for(const[e,r]of this._changes)Poe(n,e,koe(r));return Moe(this._store,n),n}}function Foe(t){return n=>{t.replaceState(e=>{const r=new Loe(t,e);return n(r),r.newTreeState_INTERNAL()})}}var zoe={atomicUpdater:Foe},Boe=zoe.atomicUpdater,Dz=Object.freeze({__proto__:null,atomicUpdater:Boe});function joe(t,n){if(!t)throw new Error(n)}var Voe=joe,Bd=Voe;const{atomicUpdater:$oe}=Dz,{batchUpdates:Uoe}=Cy,{DEFAULT_VALUE:Woe}=Vr,{useStoreRef:Hoe}=ha,{refreshRecoilValue:Goe,setRecoilValue:oI}=No,{cloneSnapshot:qoe}=ky,{gotoSnapshot:Koe}=Oz,{useCallback:Xoe}=Ae;class Mz{}const Yoe=new Mz;function Pz(t,n,e,r){let i=Yoe,o;if(Uoe(()=>{const s="useRecoilCallback() expects a function that returns a function: it accepts a function of the type (RecoilInterface) => (Args) => ReturnType and returns a callback function (Args) => ReturnType, where RecoilInterface is an object {snapshot, set, ...} and Args and ReturnType are the argument and return types of the callback you want to create.  Please see the docs at recoiljs.org for details.";if(typeof n!="function")throw Qe(s);const u=qF({...r??{},set:(c,d)=>oI(t,c,d),reset:c=>oI(t,c,Woe),refresh:c=>Goe(t,c),gotoSnapshot:c=>Koe(t,c),transact_UNSTABLE:c=>$oe(t)(c)},{snapshot:()=>{const c=qoe(t);return o=c.retain(),c}}),l=n(u);if(typeof l!="function")throw Qe(s);i=l(...e)}),i instanceof Mz&&Bd(!1),Wt(i))i=i.finally(()=>{var s;(s=o)===null||s===void 0||s()});else{var a;(a=o)===null||a===void 0||a()}return i}function Joe(t,n){const e=Hoe();return Xoe((...r)=>Pz(e.current,t,r),n!=null?[...n,e]:void 0)}var Lz={recoilCallback:Pz,useRecoilCallback:Joe};const{useStoreRef:Qoe}=ha,{refreshRecoilValue:Zoe}=No,{useCallback:eae}=Ae;function tae(t){const n=Qoe();return eae(()=>{const e=n.current;Zoe(e,t)},[t,n])}var nae=tae;const{atomicUpdater:rae}=Dz,{useStoreRef:iae}=ha,{useMemo:oae}=Ae;function aae(t,n){const e=iae();return oae(()=>(...r)=>{rae(e.current)(o=>{t(o)(...r)})},n!=null?[...n,e]:void 0)}var sae=aae;class uae{constructor(n){Ke(this,"value",void 0),this.value=n}}var lae={WrappedValue:uae},cae=lae.WrappedValue,Fz=Object.freeze({__proto__:null,WrappedValue:cae});const{isFastRefreshEnabled:dae}=_p;class aI extends Error{}class fae{constructor(n){var e,r,i;Ke(this,"_name",void 0),Ke(this,"_numLeafs",void 0),Ke(this,"_root",void 0),Ke(this,"_onHit",void 0),Ke(this,"_onSet",void 0),Ke(this,"_mapNodeValue",void 0),this._name=n==null?void 0:n.name,this._numLeafs=0,this._root=null,this._onHit=(e=n==null?void 0:n.onHit)!==null&&e!==void 0?e:()=>{},this._onSet=(r=n==null?void 0:n.onSet)!==null&&r!==void 0?r:()=>{},this._mapNodeValue=(i=n==null?void 0:n.mapNodeValue)!==null&&i!==void 0?i:o=>o}size(){return this._numLeafs}root(){return this._root}get(n,e){var r;return(r=this.getLeafNode(n,e))===null||r===void 0?void 0:r.value}getLeafNode(n,e){if(this._root==null)return;let r=this._root;for(;r;){if(e==null||e.onNodeVisit(r),r.type==="leaf")return this._onHit(r),r;const i=this._mapNodeValue(n(r.nodeKey));r=r.branches.get(i)}}set(n,e,r){const i=()=>{var o,a,s,u;let l,c;for(const[g,m]of n){var d,f,p;const y=this._root;if((y==null?void 0:y.type)==="leaf")throw this.invalidCacheError();const b=l;if(l=b?b.branches.get(c):y,l=(d=l)!==null&&d!==void 0?d:{type:"branch",nodeKey:g,parent:b,branches:new Map,branchKey:c},l.type!=="branch"||l.nodeKey!==g)throw this.invalidCacheError();b==null||b.branches.set(c,l),r==null||(f=r.onNodeVisit)===null||f===void 0||f.call(r,l),c=this._mapNodeValue(m),this._root=(p=this._root)!==null&&p!==void 0?p:l}const h=l?(o=l)===null||o===void 0?void 0:o.branches.get(c):this._root;if(h!=null&&(h.type!=="leaf"||h.branchKey!==c))throw this.invalidCacheError();const v={type:"leaf",value:e,parent:l,branchKey:c};(a=l)===null||a===void 0||a.branches.set(c,v),this._root=(s=this._root)!==null&&s!==void 0?s:v,this._numLeafs++,this._onSet(v),r==null||(u=r.onNodeVisit)===null||u===void 0||u.call(r,v)};try{i()}catch(o){if(o instanceof aI)this.clear(),i();else throw o}}delete(n){const e=this.root();if(!e)return!1;if(n===e)return this._root=null,this._numLeafs=0,!0;let r=n.parent,i=n.branchKey;for(;r;){var o;if(r.branches.delete(i),r===e)return r.branches.size===0?(this._root=null,this._numLeafs=0):this._numLeafs--,!0;if(r.branches.size>0)break;i=(o=r)===null||o===void 0?void 0:o.branchKey,r=r.parent}for(;r!==e;r=r.parent)if(r==null)return!1;return this._numLeafs--,!0}clear(){this._numLeafs=0,this._root=null}invalidCacheError(){const n=dae()?"Possible Fast Refresh module reload detected.  This may also be caused by an selector returning inconsistent values. Resetting cache.":"Invalid cache values.  This happens when selectors do not return consistent values for the same input dependency values.  That may also be caused when using Fast Refresh to change a selector implementation.  Resetting cache.";throw y2(n+(this._name!=null?` - ${this._name}`:"")),new aI}}var pae={TreeCache:fae},hae=pae.TreeCache,zz=Object.freeze({__proto__:null,TreeCache:hae});class mae{constructor(n){var e;Ke(this,"_maxSize",void 0),Ke(this,"_size",void 0),Ke(this,"_head",void 0),Ke(this,"_tail",void 0),Ke(this,"_map",void 0),Ke(this,"_keyMapper",void 0),this._maxSize=n.maxSize,this._size=0,this._head=null,this._tail=null,this._map=new Map,this._keyMapper=(e=n.mapKey)!==null&&e!==void 0?e:r=>r}head(){return this._head}tail(){return this._tail}size(){return this._size}maxSize(){return this._maxSize}has(n){return this._map.has(this._keyMapper(n))}get(n){const e=this._keyMapper(n),r=this._map.get(e);if(r)return this.set(n,r.value),r.value}set(n,e){const r=this._keyMapper(n);this._map.get(r)&&this.delete(n);const o=this.head(),a={key:n,right:o,left:null,value:e};o?o.left=a:this._tail=a,this._map.set(r,a),this._head=a,this._size++,this._maybeDeleteLRU()}_maybeDeleteLRU(){this.size()>this.maxSize()&&this.deleteLru()}deleteLru(){const n=this.tail();n&&this.delete(n.key)}delete(n){const e=this._keyMapper(n);if(!this._size||!this._map.has(e))return;const r=Zt(this._map.get(e)),i=r.right,o=r.left;i&&(i.left=r.left),o&&(o.right=r.right),r===this.head()&&(this._head=i),r===this.tail()&&(this._tail=o),this._map.delete(e),this._size--}clear(){this._size=0,this._head=null,this._tail=null,this._map=new Map}}var vae={LRUCache:mae},gae=vae.LRUCache,Bz=Object.freeze({__proto__:null,LRUCache:gae});const{LRUCache:yae}=Bz,{TreeCache:bae}=zz;function wae({name:t,maxSize:n,mapNodeValue:e=r=>r}){const r=new yae({maxSize:n}),i=new bae({name:t,mapNodeValue:e,onHit:o=>{r.set(o,!0)},onSet:o=>{const a=r.tail();r.set(o,!0),a&&i.size()>n&&i.delete(a.key)}});return i}var sI=wae;function Ii(t,n,e){if(typeof t=="string"&&!t.includes('"')&&!t.includes("\\"))return`"${t}"`;switch(typeof t){case"undefined":return"";case"boolean":return t?"true":"false";case"number":case"symbol":return String(t);case"string":return JSON.stringify(t);case"function":if((n==null?void 0:n.allowFunctions)!==!0)throw Qe("Attempt to serialize function in a Recoil cache key");return`__FUNCTION(${t.name})__`}if(t===null)return"null";if(typeof t!="object"){var r;return(r=JSON.stringify(t))!==null&&r!==void 0?r:""}if(Wt(t))return"__PROMISE__";if(Array.isArray(t))return`[${t.map((i,o)=>Ii(i,n,o.toString()))}]`;if(typeof t.toJSON=="function")return Ii(t.toJSON(e),n,e);if(t instanceof Map){const i={};for(const[o,a]of t)i[typeof o=="string"?o:Ii(o,n)]=a;return Ii(i,n,e)}return t instanceof Set?Ii(Array.from(t).sort((i,o)=>Ii(i,n).localeCompare(Ii(o,n))),n,e):Symbol!==void 0&&t[Symbol.iterator]!=null&&typeof t[Symbol.iterator]=="function"?Ii(Array.from(t),n,e):`{${Object.keys(t).filter(i=>t[i]!==void 0).sort().map(i=>`${Ii(i,n)}:${Ii(t[i],n,i)}`).join(",")}}`}function xae(t,n={allowFunctions:!1}){return Ii(t,n)}var Dy=xae;const{TreeCache:Sae}=zz,Oh={equality:"reference",eviction:"keep-all",maxSize:1/0};function Eae({equality:t=Oh.equality,eviction:n=Oh.eviction,maxSize:e=Oh.maxSize}=Oh,r){const i=Cae(t);return Rae(n,e,i,r)}function Cae(t){switch(t){case"reference":return n=>n;case"value":return n=>Dy(n)}throw Qe(`Unrecognized equality policy ${t}`)}function Rae(t,n,e,r){switch(t){case"keep-all":return new Sae({name:r,mapNodeValue:e});case"lru":return sI({name:r,maxSize:Zt(n),mapNodeValue:e});case"most-recent":return sI({name:r,maxSize:1,mapNodeValue:e})}throw Qe(`Unrecognized eviction policy ${t}`)}var Tae=Eae;function Nae(t){return()=>null}var kae={startPerfBlock:Nae};const{isLoadable:Iae,loadableWithError:Dh,loadableWithPromise:_ae,loadableWithValue:N1}=Ip,{WrappedValue:jz}=Fz,{getNodeLoadable:Mh,peekNodeLoadable:Aae,setNodeValue:Oae}=Ss,{saveDepsToStore:Dae}=Ap,{DEFAULT_VALUE:Mae,getConfigDeletionHandler:Pae,getNode:Lae,registerNode:uI}=Vr,{isRecoilValue:Fae}=pc,{markRecoilValueModified:lI}=No,{retainedByOptionWithDefault:zae}=Pu,{recoilCallback:Bae}=Lz,{startPerfBlock:jae}=kae;class Vz{}const md=new Vz,vd=[],Ph=new Map,Vae=(()=>{let t=0;return()=>t++})();function $z(t){let n=null;const{key:e,get:r,cachePolicy_UNSTABLE:i}=t,o=t.set!=null?t.set:void 0,a=new Set,s=Tae(i??{equality:"reference",eviction:"keep-all"},e),u=zae(t.retainedBy_UNSTABLE),l=new Map;let c=0;function d(){return!Pt("recoil_memory_managament_2020")||c>0}function f(B){return B.getState().knownSelectors.add(e),c++,()=>{c--}}function p(){return Pae(e)!==void 0&&!d()}function h(B,q,G,re,j){A(q,re,j),v(B,G)}function v(B,q){O(B,q)&&T(B),m(q,!0)}function g(B,q){O(B,q)&&(Zt(N(B)).stateVersions.clear(),m(q,!1))}function m(B,q){const G=Ph.get(B);if(G!=null){for(const re of G)lI(re,Zt(n));q&&Ph.delete(B)}}function y(B,q){let G=Ph.get(q);G==null&&Ph.set(q,G=new Set),G.add(B)}function b(B,q,G,re,j,ae){return q.then(ne=>{if(!d())throw T(B),md;const le=N1(ne);return h(B,G,j,le,re),ne}).catch(ne=>{if(!d())throw T(B),md;if(Wt(ne))return w(B,ne,G,re,j,ae);const le=Dh(ne);throw h(B,G,j,le,re),ne})}function w(B,q,G,re,j,ae){return q.then(ne=>{if(!d())throw T(B),md;ae.loadingDepKey!=null&&ae.loadingDepPromise===q?G.atomValues.set(ae.loadingDepKey,N1(ne)):B.getState().knownSelectors.forEach(we=>{G.atomValues.delete(we)});const le=E(B,G);if(le&&le.state!=="loading"){if((O(B,j)||N(B)==null)&&v(B,j),le.state==="hasValue")return le.contents;throw le.contents}if(!O(B,j)){const we=k(B,G);if(we!=null)return we.loadingLoadable.contents}const[xe,se]=C(B,G,j);if(xe.state!=="loading"&&h(B,G,j,xe,se),xe.state==="hasError")throw xe.contents;return xe.contents}).catch(ne=>{if(ne instanceof Vz)throw md;if(!d())throw T(B),md;const le=Dh(ne);throw h(B,G,j,le,re),ne})}function x(B,q,G,re){var j,ae,ne,le;if(O(B,re)||q.version===((j=B.getState())===null||j===void 0||(ae=j.currentTree)===null||ae===void 0?void 0:ae.version)||q.version===((ne=B.getState())===null||ne===void 0||(le=ne.nextTree)===null||le===void 0?void 0:le.version)){var xe,se,we;Dae(e,G,B,(xe=(se=B.getState())===null||se===void 0||(we=se.nextTree)===null||we===void 0?void 0:we.version)!==null&&xe!==void 0?xe:B.getState().currentTree.version)}for(const de of G)a.add(de)}function C(B,q,G){const re=jae(e);let j=!0,ae=!0;const ne=()=>{re(),ae=!1};let le,xe=!1,se;const we={loadingDepKey:null,loadingDepPromise:null},de=new Map;function Z({key:be}){const fe=Mh(B,q,be);switch(de.set(be,fe),j||(x(B,q,new Set(de.keys()),G),g(B,G)),fe.state){case"hasValue":return fe.contents;case"hasError":throw fe.contents;case"loading":throw we.loadingDepKey=be,we.loadingDepPromise=fe.contents,fe.contents}throw Qe("Invalid Loadable state")}const ge=be=>(...fe)=>{if(ae)throw Qe("Callbacks from getCallback() should only be called asynchronously after the selector is evalutated.  It can be used for selectors to return objects with callbacks that can work with Recoil state without a subscription.");return n==null&&Bd(!1),Bae(B,be,fe,{node:n})};try{le=r({get:Z,getCallback:ge}),le=Fae(le)?Z(le):le,Iae(le)&&(le.state==="hasError"&&(xe=!0),le=le.contents),Wt(le)?le=b(B,le,q,de,G,we).finally(ne):ne(),le=le instanceof jz?le.value:le}catch(be){le=be,Wt(le)?le=w(B,le,q,de,G,we).finally(ne):(xe=!0,ne())}return xe?se=Dh(le):Wt(le)?se=_ae(le):se=N1(le),j=!1,D(B,G,de),x(B,q,new Set(de.keys()),G),[se,de]}function E(B,q){let G=q.atomValues.get(e);if(G!=null)return G;const re=new Set;try{G=s.get(ae=>(typeof ae!="string"&&Bd(!1),Mh(B,q,ae).contents),{onNodeVisit:ae=>{ae.type==="branch"&&ae.nodeKey!==e&&re.add(ae.nodeKey)}})}catch(ae){throw Qe(`Problem with cache lookup for selector "${e}": ${ae.message}`)}if(G){var j;q.atomValues.set(e,G),x(B,q,re,(j=N(B))===null||j===void 0?void 0:j.executionID)}return G}function S(B,q){const G=E(B,q);if(G!=null)return T(B),G;const re=k(B,q);if(re!=null){var j;return((j=re.loadingLoadable)===null||j===void 0?void 0:j.state)==="loading"&&y(B,re.executionID),re.loadingLoadable}const ae=Vae(),[ne,le]=C(B,q,ae);return ne.state==="loading"?(M(B,ae,ne,le,q),y(B,ae)):(T(B),A(q,ne,le)),ne}function k(B,q){const G=cz([l.has(B)?[Zt(l.get(B))]:[],wy(E2(l,([j])=>j!==B),([,j])=>j)]);function re(j){for(const[ae,ne]of j)if(!Mh(B,q,ae).is(ne))return!0;return!1}for(const j of G){if(j.stateVersions.get(q.version)||!re(j.depValuesDiscoveredSoFarDuringAsyncWork))return j.stateVersions.set(q.version,!0),j;j.stateVersions.set(q.version,!1)}}function N(B){return l.get(B)}function M(B,q,G,re,j){l.set(B,{depValuesDiscoveredSoFarDuringAsyncWork:re,executionID:q,loadingLoadable:G,stateVersions:new Map([[j.version,!0]])})}function D(B,q,G){if(O(B,q)){const re=N(B);re!=null&&(re.depValuesDiscoveredSoFarDuringAsyncWork=G)}}function T(B){l.delete(B)}function O(B,q){var G;return q===((G=N(B))===null||G===void 0?void 0:G.executionID)}function P(B){return Array.from(B.entries()).map(([q,G])=>[q,G.contents])}function A(B,q,G){B.atomValues.set(e,q);try{s.set(P(G),q)}catch(re){throw Qe(`Problem with setting cache for selector "${e}": ${re.message}`)}}function I(B){if(vd.includes(e)){const q=`Recoil selector has circular dependencies: ${vd.slice(vd.indexOf(e)).join(" → ")}`;return Dh(Qe(q))}vd.push(e);try{return B()}finally{vd.pop()}}function _(B,q){const G=q.atomValues.get(e);return G??s.get(re=>{var j;return typeof re!="string"&&Bd(!1),(j=Aae(B,q,re))===null||j===void 0?void 0:j.contents})}function F(B,q){return I(()=>S(B,q))}function L(B){B.atomValues.delete(e)}function H(B,q){n==null&&Bd(!1);for(const re of a){var G;const j=Lae(re);(G=j.clearCache)===null||G===void 0||G.call(j,B,q)}a.clear(),L(q),s.clear(),lI(B,n)}return o!=null?n=uI({key:e,nodeType:"selector",peek:_,get:F,set:(q,G,re)=>{let j=!1;const ae=new Map;function ne({key:we}){if(j)throw Qe("Recoil: Async selector sets are not currently supported.");const de=Mh(q,G,we);if(de.state==="hasValue")return de.contents;if(de.state==="loading"){const Z=`Getting value of asynchronous atom or selector "${we}" in a pending state while setting selector "${e}" is not yet supported.`;throw Qe(Z)}else throw de.contents}function le(we,de){if(j)throw Qe("Recoil: Async selector sets are not currently supported.");const Z=typeof de=="function"?de(ne(we)):de;Oae(q,G,we.key,Z).forEach((be,fe)=>ae.set(fe,be))}function xe(we){le(we,Mae)}const se=o({set:le,get:ne,reset:xe},re);if(se!==void 0)throw Wt(se)?Qe("Recoil: Async selector sets are not currently supported."):Qe("Recoil: selector set should be a void function.");return j=!0,ae},init:f,invalidate:L,clearCache:H,shouldDeleteConfigOnRelease:p,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:u}):n=uI({key:e,nodeType:"selector",peek:_,get:F,init:f,invalidate:L,clearCache:H,shouldDeleteConfigOnRelease:p,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:u})}$z.value=t=>new jz(t);var vc=$z;const{isLoadable:$ae,loadableWithError:k1,loadableWithPromise:I1,loadableWithValue:Yu}=Ip,{WrappedValue:Uz}=Fz,{peekNodeInfo:Uae}=Ss,{DEFAULT_VALUE:js,DefaultValue:Na,getConfigDeletionHandler:Wz,registerNode:Wae,setConfigDeletionHandler:Hae}=Vr,{isRecoilValue:Gae}=pc,{getRecoilValueAsLoadable:qae,markRecoilValueModified:Kae,setRecoilValue:cI,setRecoilValueLoadable:Xae}=No,{retainedByOptionWithDefault:Yae}=Pu,gd=t=>t instanceof Uz?t.value:t;function Jae(t){const{key:n,persistence_UNSTABLE:e}=t,r=Yae(t.retainedBy_UNSTABLE);let i=0;function o(y){return I1(y.then(b=>(a=Yu(b),b)).catch(b=>{throw a=k1(b),b}))}let a=Wt(t.default)?o(t.default):$ae(t.default)?t.default.state==="loading"?o(t.default.contents):t.default:Yu(gd(t.default));a.contents;let s;const u=new Map;function l(y){return y}function c(y,b){const w=b.then(x=>{var C,E;return((E=((C=y.getState().nextTree)!==null&&C!==void 0?C:y.getState().currentTree).atomValues.get(n))===null||E===void 0?void 0:E.contents)===w&&cI(y,m,x),x}).catch(x=>{var C,E;throw((E=((C=y.getState().nextTree)!==null&&C!==void 0?C:y.getState().currentTree).atomValues.get(n))===null||E===void 0?void 0:E.contents)===w&&Xae(y,m,k1(x)),x});return w}function d(y,b,w){var x;i++;const C=()=>{var N;i--,(N=u.get(y))===null||N===void 0||N.forEach(M=>M()),u.delete(y)};if(y.getState().knownAtoms.add(n),a.state==="loading"){const N=()=>{var M;((M=y.getState().nextTree)!==null&&M!==void 0?M:y.getState().currentTree).atomValues.has(n)||Kae(y,m)};a.contents.finally(N)}const E=(x=t.effects)!==null&&x!==void 0?x:t.effects_UNSTABLE;if(E!=null){let N=function(L){if(O&&L.key===n){const H=T;return H instanceof Na?f(y,b):Wt(H)?I1(H.then(B=>B instanceof Na?a.toPromise():B)):Yu(H)}return qae(y,L)},M=function(L){return N(L).toPromise()},D=function(L){var H;const B=Uae(y,(H=y.getState().nextTree)!==null&&H!==void 0?H:y.getState().currentTree,L.key);return O&&L.key===n&&!(T instanceof Na)?{...B,isSet:!0,loadable:N(L)}:B},T=js,O=!0,P=!1,A=null;const I=L=>H=>{if(O){const B=N(m),q=B.state==="hasValue"?B.contents:js;T=typeof H=="function"?H(q):H,Wt(T)&&(T=T.then(G=>(A={effect:L,value:G},G)))}else{if(Wt(H))throw Qe("Setting atoms to async values is not implemented.");typeof H!="function"&&(A={effect:L,value:gd(H)}),cI(y,m,typeof H=="function"?B=>{const q=gd(H(B));return A={effect:L,value:q},q}:gd(H))}},_=L=>()=>I(L)(js),F=L=>H=>{var B;const{release:q}=y.subscribeToTransactions(G=>{var re;let{currentTree:j,previousTree:ae}=G.getState();ae||(ae=j);const ne=(re=j.atomValues.get(n))!==null&&re!==void 0?re:a;if(ne.state==="hasValue"){var le,xe,se,we;const de=ne.contents,Z=(le=ae.atomValues.get(n))!==null&&le!==void 0?le:a,ge=Z.state==="hasValue"?Z.contents:js;((xe=A)===null||xe===void 0?void 0:xe.effect)!==L||((se=A)===null||se===void 0?void 0:se.value)!==de?H(de,ge,!j.atomValues.has(n)):((we=A)===null||we===void 0?void 0:we.effect)===L&&(A=null)}},n);u.set(y,[...(B=u.get(y))!==null&&B!==void 0?B:[],q])};for(const L of E)try{const H=L({node:m,storeID:y.storeID,parentStoreID_UNSTABLE:y.parentStoreID,trigger:w,setSelf:I(L),resetSelf:_(L),onSet:F(L),getPromise:M,getLoadable:N,getInfo_UNSTABLE:D});if(H!=null){var S;u.set(y,[...(S=u.get(y))!==null&&S!==void 0?S:[],H])}}catch(H){T=H,P=!0}if(O=!1,!(T instanceof Na)){var k;const L=P?k1(T):Wt(T)?I1(c(y,T)):Yu(gd(T));L.contents,b.atomValues.set(n,L),(k=y.getState().nextTree)===null||k===void 0||k.atomValues.set(n,L)}}return C}function f(y,b){var w,x;return(w=(x=b.atomValues.get(n))!==null&&x!==void 0?x:s)!==null&&w!==void 0?w:a}function p(y,b){if(b.atomValues.has(n))return Zt(b.atomValues.get(n));if(b.nonvalidatedAtoms.has(n)){if(s!=null)return s;if(e==null)return a;const w=b.nonvalidatedAtoms.get(n),x=e.validator(w,js);return s=x instanceof Na?a:Yu(x),s}else return a}function h(){s=void 0}function v(y,b,w){if(b.atomValues.has(n)){const x=Zt(b.atomValues.get(n));if(x.state==="hasValue"&&w===x.contents)return new Map}else if(!b.nonvalidatedAtoms.has(n)&&w instanceof Na)return new Map;return s=void 0,new Map().set(n,Yu(w))}function g(){return Wz(n)!==void 0&&i<=0}const m=Wae({key:n,nodeType:"atom",peek:f,get:p,set:v,init:d,invalidate:h,shouldDeleteConfigOnRelease:g,dangerouslyAllowMutability:t.dangerouslyAllowMutability,persistence_UNSTABLE:t.persistence_UNSTABLE?{type:t.persistence_UNSTABLE.type,backButton:t.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0,retainedBy:r});return m}function D2(t){const{...n}=t,e="default"in t?t.default:new Promise(()=>{});return Gae(e)?Qae({...n,default:e}):Jae({...n,default:e})}function Qae(t){const n=D2({...t,default:js,persistence_UNSTABLE:t.persistence_UNSTABLE===void 0?void 0:{...t.persistence_UNSTABLE,validator:r=>r instanceof Na?r:Zt(t.persistence_UNSTABLE).validator(r,js)},effects:t.effects,effects_UNSTABLE:t.effects_UNSTABLE}),e=vc({key:`${t.key}__withFallback`,get:({get:r})=>{const i=r(n);return i instanceof Na?t.default:i},set:({set:r},i)=>r(n,i),cachePolicy_UNSTABLE:{eviction:"most-recent"},dangerouslyAllowMutability:t.dangerouslyAllowMutability});return Hae(e.key,Wz(t.key)),e}D2.value=t=>new Uz(t);var Hz=D2;class Zae{constructor(n){var e;Ke(this,"_map",void 0),Ke(this,"_keyMapper",void 0),this._map=new Map,this._keyMapper=(e=n==null?void 0:n.mapKey)!==null&&e!==void 0?e:r=>r}size(){return this._map.size}has(n){return this._map.has(this._keyMapper(n))}get(n){return this._map.get(this._keyMapper(n))}set(n,e){this._map.set(this._keyMapper(n),e)}delete(n){this._map.delete(this._keyMapper(n))}clear(){this._map.clear()}}var ese={MapCache:Zae},tse=ese.MapCache,nse=Object.freeze({__proto__:null,MapCache:tse});const{LRUCache:dI}=Bz,{MapCache:rse}=nse,Lh={equality:"reference",eviction:"none",maxSize:1/0};function ise({equality:t=Lh.equality,eviction:n=Lh.eviction,maxSize:e=Lh.maxSize}=Lh){const r=ose(t);return ase(n,e,r)}function ose(t){switch(t){case"reference":return n=>n;case"value":return n=>Dy(n)}throw Qe(`Unrecognized equality policy ${t}`)}function ase(t,n,e){switch(t){case"keep-all":return new rse({mapKey:e});case"lru":return new dI({mapKey:e,maxSize:Zt(n)});case"most-recent":return new dI({mapKey:e,maxSize:1})}throw Qe(`Unrecognized eviction policy ${t}`)}var Gz=ise;const{setConfigDeletionHandler:sse}=Vr;function use(t){var n,e;const r=Gz({equality:(n=(e=t.cachePolicyForParams_UNSTABLE)===null||e===void 0?void 0:e.equality)!==null&&n!==void 0?n:"value",eviction:"keep-all"});return i=>{var o,a;const s=r.get(i);if(s!=null)return s;const{cachePolicyForParams_UNSTABLE:u,...l}=t,c="default"in t?t.default:new Promise(()=>{}),d=Hz({...l,key:`${t.key}__${(o=Dy(i))!==null&&o!==void 0?o:"void"}`,default:typeof c=="function"?c(i):c,retainedBy_UNSTABLE:typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(i):t.retainedBy_UNSTABLE,effects:typeof t.effects=="function"?t.effects(i):typeof t.effects_UNSTABLE=="function"?t.effects_UNSTABLE(i):(a=t.effects)!==null&&a!==void 0?a:t.effects_UNSTABLE});return r.set(i,d),sse(d.key,()=>{r.delete(i)}),d}}var lse=use;const{setConfigDeletionHandler:cse}=Vr;let dse=0;function fse(t){var n,e;const r=Gz({equality:(n=(e=t.cachePolicyForParams_UNSTABLE)===null||e===void 0?void 0:e.equality)!==null&&n!==void 0?n:"value",eviction:"keep-all"});return i=>{var o;let a;try{a=r.get(i)}catch(f){throw Qe(`Problem with cache lookup for selector ${t.key}: ${f.message}`)}if(a!=null)return a;const s=`${t.key}__selectorFamily/${(o=Dy(i,{allowFunctions:!0}))!==null&&o!==void 0?o:"void"}/${dse++}`,u=f=>t.get(i)(f),l=t.cachePolicy_UNSTABLE,c=typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(i):t.retainedBy_UNSTABLE;let d;if(t.set!=null){const f=t.set;d=vc({key:s,get:u,set:(h,v)=>f(i)(h,v),cachePolicy_UNSTABLE:l,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:c})}else d=vc({key:s,get:u,cachePolicy_UNSTABLE:l,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:c});return r.set(i,d),cse(d.key,()=>{r.delete(i)}),d}}var Es=fse;const pse=Es({key:"__constant",get:t=>()=>t,cachePolicyForParams_UNSTABLE:{equality:"reference"}});function hse(t){return pse(t)}var mse=hse;const vse=Es({key:"__error",get:t=>()=>{throw Qe(t)},cachePolicyForParams_UNSTABLE:{equality:"reference"}});function gse(t){return vse(t)}var yse=gse;function bse(t){return t}var wse=bse;const{loadableWithError:qz,loadableWithPromise:Kz,loadableWithValue:Xz}=Ip;function My(t,n){const e=Array(n.length).fill(void 0),r=Array(n.length).fill(void 0);for(const[i,o]of n.entries())try{e[i]=t(o)}catch(a){r[i]=a}return[e,r]}function xse(t){return t!=null&&!Wt(t)}function Py(t){return Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(n=>t[n])}function ax(t,n){return Array.isArray(t)?n:Object.getOwnPropertyNames(t).reduce((e,r,i)=>({...e,[r]:n[i]}),{})}function Ll(t,n,e){const r=e.map((i,o)=>i==null?Xz(n[o]):Wt(i)?Kz(i):qz(i));return ax(t,r)}function Sse(t,n){return n.map((e,r)=>e===void 0?t[r]:e)}const Ese=Es({key:"__waitForNone",get:t=>({get:n})=>{const e=Py(t),[r,i]=My(n,e);return Ll(t,r,i)},dangerouslyAllowMutability:!0}),Cse=Es({key:"__waitForAny",get:t=>({get:n})=>{const e=Py(t),[r,i]=My(n,e);return i.some(o=>!Wt(o))?Ll(t,r,i):new Promise(o=>{for(const[a,s]of i.entries())Wt(s)&&s.then(u=>{r[a]=u,i[a]=void 0,o(Ll(t,r,i))}).catch(u=>{i[a]=u,o(Ll(t,r,i))})})},dangerouslyAllowMutability:!0}),Rse=Es({key:"__waitForAll",get:t=>({get:n})=>{const e=Py(t),[r,i]=My(n,e);if(i.every(a=>a==null))return ax(t,r);const o=i.find(xse);if(o!=null)throw o;return Promise.all(i).then(a=>ax(t,Sse(r,a)))},dangerouslyAllowMutability:!0}),Tse=Es({key:"__waitForAllSettled",get:t=>({get:n})=>{const e=Py(t),[r,i]=My(n,e);return i.every(o=>!Wt(o))?Ll(t,r,i):Promise.all(i.map((o,a)=>Wt(o)?o.then(s=>{r[a]=s,i[a]=void 0}).catch(s=>{r[a]=void 0,i[a]=s}):null)).then(()=>Ll(t,r,i))},dangerouslyAllowMutability:!0}),Nse=Es({key:"__noWait",get:t=>({get:n})=>{try{return vc.value(Xz(n(t)))}catch(e){return vc.value(Wt(e)?Kz(e):qz(e))}},dangerouslyAllowMutability:!0});var kse={waitForNone:Ese,waitForAny:Cse,waitForAll:Rse,waitForAllSettled:Tse,noWait:Nse};const{RecoilLoadable:Ise}=Ip,{DefaultValue:_se}=Vr,{RecoilRoot:Ase,useRecoilStoreID:Ose}=ha,{isRecoilValue:Dse}=pc,{retentionZone:Mse}=Sy,{freshSnapshot:Pse}=ky,{useRecoilState:Lse,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:Fse,useRecoilStateLoadable:zse,useRecoilValue:Bse,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:jse,useRecoilValueLoadable:Vse,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:$se,useResetRecoilState:Use,useSetRecoilState:Wse}=eoe,{useGotoRecoilSnapshot:Hse,useRecoilSnapshot:Gse,useRecoilTransactionObserver:qse}=Oz,{useRecoilCallback:Kse}=Lz,{noWait:Xse,waitForAll:Yse,waitForAllSettled:Jse,waitForAny:Qse,waitForNone:Zse}=kse;var Pp={DefaultValue:_se,isRecoilValue:Dse,RecoilLoadable:Ise,RecoilEnv:Lc,RecoilRoot:Ase,useRecoilStoreID:Ose,useRecoilBridgeAcrossReactRoots_UNSTABLE:Noe,atom:Hz,selector:vc,atomFamily:lse,selectorFamily:Es,constSelector:mse,errorSelector:yse,readOnlySelector:wse,noWait:Xse,waitForNone:Zse,waitForAny:Qse,waitForAll:Yse,waitForAllSettled:Jse,useRecoilValue:Bse,useRecoilValueLoadable:Vse,useRecoilState:Lse,useRecoilStateLoadable:zse,useSetRecoilState:Wse,useResetRecoilState:Use,useGetRecoilValueInfo_UNSTABLE:xoe,useRecoilRefresher_UNSTABLE:nae,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:$se,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:jse,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:Fse,useRecoilCallback:Kse,useRecoilTransaction_UNSTABLE:sae,useGotoRecoilSnapshot:Hse,useRecoilSnapshot:Gse,useRecoilTransactionObserver_UNSTABLE:qse,snapshot_UNSTABLE:Pse,useRetain:k2,retentionZone:Mse},eue=Pp.RecoilRoot,Lu=Pp.atom,Yz=Pp.useRecoilValue,Ba=Pp.useRecoilState,co=Pp.useSetRecoilState;const tue=Lu({key:"prevPathAtom",default:""}),M2=Lu({key:"activeMarkerAtom",default:null}),Jz=Lu({key:"searchTermAtom",default:""}),Ly=Lu({key:"centerChangeAtom",default:!1}),P2=Lu({key:"filterModeAtom",default:"dist"}),L2=Lu({key:"mapCenterAtom",default:{lat:0,lng:0}}),Fy=Lu({key:"myCenterAtom",default:{center:{lat:0,lng:0},errMsg:null,isLoading:!1}}),nue=({item:t,idx:n,mapRef:e,getDistance:r,setOpenList:i})=>{const o=Yz(Fy),a=co(M2),s=co(Ly),u=W.useMemo(()=>r(o.center.lat,o.center.lng,t.latlng.lat,t.latlng.lng),[]),l=()=>{i(!1),a(n);const c=new kakao.maps.LatLng(t.latlng.lat,t.latlng.lng);e.current.setLevel(4),e.current.setCenter(c),s(!1)};return console.log(t),R.jsxs("div",{className:"item",onClick:l,children:[R.jsxs("div",{className:"item-head",children:[R.jsx("div",{className:"fishing-name",children:t.content.name}),R.jsx("div",{className:"fishing-type",children:t.content.type})]}),R.jsxs("div",{className:"item-body",children:[R.jsx("div",{className:"fishing-dist",children:u>=1?`${u.toFixed(1)}km`:`${(u/1e3).toFixed()}`}),R.jsx("div",{className:"fishing-addr",children:t.content.addr})]}),R.jsxs("div",{className:"fishing-exp",children:[t.content.expense,"원"]})]})},rue=({addData:t,mapRef:n,getDistance:e,openList:r,setOpenList:i})=>{const[o,a]=W.useState(!1),[s,u]=Ba(P2),l=d=>{a(!1),u(d)},c=W.useMemo(()=>t.toSorted((d,f)=>s==="dist"?d.dist-f.dist:d.content.expense-f.content.expense),[s,t]);return R.jsxs("div",{className:`FishMapFooter ${r&&"expand"}`,children:[r&&R.jsxs(R.Fragment,{children:[R.jsxs("button",{className:"filter",onClick:()=>a(!0),children:[s==="dist"?"거리순":"비용순",R.jsx(_F,{})]}),o&&R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"filterOpen",onClick:()=>a(!1)}),R.jsxs("div",{className:"filter-content",children:[R.jsx("h2",{children:"검색 설정"}),R.jsx("div",{className:"filter-b",children:R.jsxs("button",{className:`${s==="dist"?"pick":""}`,onClick:()=>l("dist"),children:["거리순"," ",R.jsx("div",{children:s==="dist"&&R.jsx(Jw,{})})]})}),R.jsx("div",{className:"filter-b",children:R.jsxs("button",{className:`${s==="money"?"pick":""}`,onClick:()=>l("money"),children:["비용순",R.jsx("div",{children:s==="money"&&R.jsx(Jw,{})})]})}),R.jsx("div",{children:R.jsx("button",{className:"cancel",onClick:()=>a(!1),children:"취소"})})]})]}),t.length?c.map((d,f)=>R.jsx(nue,{item:d,idx:f,mapRef:n,setOpenList:i,getDistance:e},f)):R.jsxs("div",{className:"noneData",children:[R.jsx(p2,{}),R.jsx("div",{children:"조건에 맞는 낚시터가 없습니다."})]})]}),R.jsx("div",{className:"mode",onClick:()=>i(d=>!d),children:r?R.jsxs(R.Fragment,{children:[R.jsx(IF,{}),R.jsx("div",{children:"지도보기"})]}):R.jsxs(R.Fragment,{children:[R.jsx(kF,{}),R.jsx("div",{children:"목록보기"})]})})]})};var F2={},iue=yt;Object.defineProperty(F2,"__esModule",{value:!0});var Qz=F2.default=void 0,oue=iue(bt()),aue=R;Qz=F2.default=(0,oue.default)((0,aue.jsx)("path",{d:"m17.27 6.73-4.24 10.13-1.32-3.42-.32-.83-.82-.32-3.43-1.33zM21 3 3 10.53v.98l6.84 2.65L12.48 21h.98z"}),"NearMeOutlined");var z2={},sue=yt;Object.defineProperty(z2,"__esModule",{value:!0});var B2=z2.default=void 0,uue=sue(bt()),lue=R;B2=z2.default=(0,uue.default)((0,lue.jsx)("path",{d:"M20 10V8h-4V4h-2v4h-4V4H8v4H4v2h4v4H4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4zm-6 4h-4v-4h4z"}),"TagOutlined");var j2={},cue=yt;Object.defineProperty(j2,"__esModule",{value:!0});var V2=j2.default=void 0,due=cue(bt()),fue=R;V2=j2.default=(0,due.default)((0,fue.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"CloseOutlined");const pue=({hashTags:t,mapRef:n})=>{const[e,r]=W.useState(!1),[i,o]=Ba(Jz),a=co(Ly),s=()=>{r(d=>!d),o("")},u=d=>{const f=n.current;f&&(f.setLevel(13),f.setCenter(new kakao.maps.LatLng(36.172823447489336,127.8675122717897)),a(!1))},l=d=>{d.preventDefault(),u()},c=W.useMemo(()=>t.map((d,f)=>R.jsxs("div",{className:"input-container",onClick:u,children:[R.jsx("input",{id:`${d}`,className:"radio-button",type:"radio",name:"radio",checked:i===d.substring(1),value:d.substring(1),onChange:p=>o(p.target.value)}),R.jsx("div",{className:"radio-tile",children:R.jsx("label",{htmlFor:`${d}`,className:"radio-tile-label",children:d})})]},f)),[t,u,i]);return R.jsxs("div",{className:`FishMapHeader ${e&&"expand"}`,children:[R.jsxs("div",{className:`wrapper ${e&&"expand"}`,children:[R.jsx("button",{className:"chmode",onClick:s,children:e?R.jsx(B2,{}):R.jsx(Qz,{})}),R.jsx("form",{onSubmit:l,children:R.jsx("input",{type:"text",placeholder:e?"해시태그 검색":"지역, 장소 검색",value:i,onChange:d=>o(d.target.value)})}),R.jsx("div",{className:"search",onClick:()=>o(""),children:i&&R.jsx(V2,{})})]}),e&&R.jsx("div",{className:"hashTags",children:c})]})},Ys=typeof window<"u"&&typeof document<"u"?W.useLayoutEffect:W.useEffect,Ut=(t,n,e)=>{Ys(()=>{if(!t||!e)return;const r=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return o===void 0?e(t):e(t,...o)};return kakao.maps.event.addListener(t,n,r),()=>{kakao.maps.event.removeListener(t,n,r)}},[t,n,e])},Zz="__react-kakao-maps-sdk__";let yd=function(t){return t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE",t}({});const hue=`${Zz}_Loader`,$t=class $t{constructor(n){dr(this,"callbacks",[]);dr(this,"done",!1);dr(this,"loading",!1);dr(this,"errors",[]);let{appkey:e,id:r=hue,libraries:i=[],nonce:o,retries:a=3,url:s="//dapi.kakao.com/v2/maps/sdk.js"}=n;if(this.id=r,this.appkey=e,this.libraries=i,this.nonce=o,this.retries=a,this.url=s,$t.instance&&!$t.equalOptions(this.options,$t.instance.options)&&!$t.equalOptions(this.options,$t.instance.options))switch($t.instance.status){case yd.FAILURE:throw new Error(`Loader must not be called again with different options. 
${JSON.stringify(this.options,null,2)}
!==
${JSON.stringify($t.instance.options,null,2)}`);default:$t.instance.reset(),$t.instance=this;break}return $t.instance||($t.instance=this),$t.instance}get options(){return{appkey:this.appkey,id:this.id,libraries:this.libraries,nonce:this.nonce,retries:this.retries,url:this.url}}static addLoadEventLisnter(n){return window.kakao&&window.kakao.maps&&window.kakao.maps.load(n),$t.loadEventCallback.add(n),n}static removeLoadEventLisnter(n){return $t.loadEventCallback.delete(n)}load(){return new Promise((n,e)=>{this.loadCallback(r=>{r?e(r):n(window.kakao)})})}get status(){return this.onEvent?yd.FAILURE:this.done?yd.SUCCESS:this.loading?yd.LOADING:yd.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}loadCallback(n){this.callbacks.push(n),this.execute()}resetIfRetryingFailed(){this.failed&&this.reset()}reset(){this.deleteScript(),this.done=!0,this.loading=!1,this.errors=[],this.onEvent=void 0}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.kakao&&window.kakao.maps){console.warn("Kakao Maps이 이미 외부 요소에 의해 로딩되어 있습니다.설정한 옵션과 일치 하지 않을 수 있으며, 이에 따른 예상치 동작이 발생할 수 있습니다."),window.kakao.maps.load(this.callback);return}this.loading||(this.loading=!0,this.setScript())}}setScript(){document.getElementById(this.id)&&this.callback();const n=this.createUrl(),e=document.createElement("script");e.id=this.id,e.type="text/javascript",e.src=n,e.onerror=this.loadErrorCallback.bind(this),e.onload=this.callback.bind(this),e.defer=!0,e.async=!0,this.nonce&&(e.nonce=this.nonce),document.head.appendChild(e)}loadErrorCallback(n){if(this.errors.push(n),this.errors.length<=this.retries){const e=this.errors.length*2**this.errors.length;console.log(`Failed to load Kakao Maps script, retrying in ${e} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},e)}else this.done=!0,this.loading=!1,this.onEvent=this.errors[this.errors.length-1],this.callbacks.forEach(e=>{e(this.onEvent)}),this.callbacks=[],$t.loadEventCallback.forEach(e=>{e(this.onEvent)})}createUrl(){let n=this.url;return n+=`?appkey=${this.appkey}`,this.libraries.length&&(n+=`&libraries=${this.libraries.join(",")}`),n+="&autoload=false",n}deleteScript(){const n=document.getElementById(this.id);n&&n.remove()}callback(){kakao.maps.load(()=>{$t.instance.done=!0,$t.instance.loading=!1,$t.instance.callbacks.forEach(n=>{n($t.instance.onEvent)}),$t.instance.callbacks=[],$t.loadEventCallback.forEach(n=>{n($t.instance.onEvent)})})}static equalOptions(n,e){if(n.appkey!==e.appkey||n.id!==e.id||n.libraries.length!==e.libraries.length)return!1;for(let r=0;r<n.libraries.length;++r)if(n.libraries[r]!==e.libraries[r])return!1;return!(n.nonce!==e.nonce||n.retries!==e.retries||n.url!==e.url)}};dr($t,"loadEventCallback",new Set);let Dv=$t;const kt=function(t,n){for(var e=arguments.length,r=new Array(e>2?e-2:0),i=2;i<e;i++)r[i-2]=arguments[i];Ys(()=>{!t||r.every(o=>typeof o>"u")||t[n].call(t,...r)},[t,n,...r])},eB=Ae.createContext(void 0),mue=Ae.forwardRef(function(n,e){let{id:r,as:i,children:o,center:a,isPanto:s=!1,padding:u=32,disableDoubleClick:l,disableDoubleClickZoom:c,draggable:d,zoomable:f,keyboardShortcuts:p,level:h,maxLevel:v,minLevel:g,mapTypeId:m,projectionId:y,scrollwheel:b,tileAnimation:w,onBoundsChanged:x,onCenterChanged:C,onClick:E,onDoubleClick:S,onDrag:k,onDragEnd:N,onDragStart:M,onIdle:D,onMaptypeidChanged:T,onMouseMove:O,onRightClick:P,onTileLoaded:A,onZoomChanged:I,onZoomStart:_,onCreate:F,...L}=n;const H=i||"div",[B,q]=W.useState(!1),[G,re]=W.useState(),j=W.useRef(null);return Ys(()=>{const ae=Dv.addLoadEventLisnter(ne=>q(!ne));return()=>{Dv.removeLoadEventLisnter(ae)}},[]),Ys(()=>{if(!B)return;const ae=j.current;if(!ae)return;const ne="lat"in a?new kakao.maps.LatLng(a.lat,a.lng):new kakao.maps.Coords(a.x,a.y),le=new kakao.maps.Map(ae,{center:ne,disableDoubleClick:l,disableDoubleClickZoom:c,draggable:d,keyboardShortcuts:p,level:h,mapTypeId:typeof m=="string"?kakao.maps.MapTypeId[m]:m,projectionId:y,scrollwheel:b,tileAnimation:w});return re(le),()=>{ae.innerHTML=""}},[B,l,c,w]),W.useImperativeHandle(e,()=>G,[G]),Ys(()=>{!G||!F||F(G)},[G,F]),Ys(()=>{if(!G)return;let ae=G.getCenter();ae instanceof kakao.maps.Coords&&(ae=ae.toLatLng());const ne="lat"in a?new kakao.maps.LatLng(a.lat,a.lng):new kakao.maps.Coords(a.x,a.y);ne instanceof kakao.maps.LatLng&&ne.equals(ae)||ne instanceof kakao.maps.Coords&&ne.toLatLng().equals(ae)||(s?G.panTo(ne,u):G.setCenter(ne))},[G,a.lat,a.lng,a.x,a.y]),kt(G,"setDraggable",d),kt(G,"setZoomable",f),kt(G,"setKeyboardShortcuts",p),kt(G,"setLevel",h),kt(G,"setMapTypeId",B?typeof m=="string"?kakao.maps.MapTypeId[m]:m:void 0),kt(G,"setProjectionId",y),kt(G,"setMinLevel",v),kt(G,"setMaxLevel",g),Ut(G,"bounds_changed",x),Ut(G,"center_changed",C),Ut(G,"click",E),Ut(G,"dblclick",S),Ut(G,"drag",k),Ut(G,"dragstart",M),Ut(G,"dragend",N),Ut(G,"idle",D),Ut(G,"maptypeid_changed",T),Ut(G,"mousemove",O),Ut(G,"rightclick",P),Ut(G,"tilesloaded",A),Ut(G,"zoom_changed",I),Ut(G,"zoom_start",_),R.jsxs(R.Fragment,{children:[R.jsx(H,{id:r||`${Zz}_Map`,...L,ref:j}),G&&R.jsx(eB.Provider,{value:G,children:o})]})}),$2=t=>{const n=W.useContext(eB);if(!n)throw new Error(`${t?t+" Component":"useMap"} must exist inside Map Component!`);return n},vue=Ae.forwardRef(function(n,e){let{map:r,position:i,marker:o,children:a,altitude:s,disableAutoPan:u,range:l,removable:c,zIndex:d,onCreate:f}=n;const p=W.useRef(document.createElement("div")),h=W.useMemo(()=>{const v=new kakao.maps.InfoWindow({altitude:s,disableAutoPan:u,range:l,removable:c,zIndex:d,content:p.current,position:i});return p.current.style.display="none",v},[u,c]);return W.useImperativeHandle(e,()=>h,[h]),W.useLayoutEffect(()=>(h.open(r,o),()=>{h.close()}),[r,o]),W.useLayoutEffect(()=>{f&&f(h)},[h,f]),kt(h,"setPosition",i),kt(h,"setAltitude",s),kt(h,"setRange",l),kt(h,"setZIndex",d),p.current.parentElement&&BO.createPortal(a,p.current.parentElement)}),U2=Ae.createContext(void 0),gue=Ae.forwardRef(function(n,e){let{onClusterclick:r,onClusterdblclick:i,onClustered:o,onClusterout:a,onClusterover:s,onClusterrightclick:u,onCreate:l,...c}=n;const{children:d,averageCenter:f,calculator:p,clickable:h,disableClickZoom:v,gridSize:g,hoverable:m,minClusterSize:y,minLevel:b,styles:w,texts:x}=c,C=$2("MarkerClusterer"),E=W.useMemo(()=>{if(!window.kakao.maps.MarkerClusterer){console.warn("clusterer 라이브러리를 별도 로드 해야 사용 가능합니다. `https://apis.map.kakao.com/web/guide/#loadlibrary`");return}return new kakao.maps.MarkerClusterer({averageCenter:f,calculator:p,clickable:h,disableClickZoom:v,gridSize:g,hoverable:m,minClusterSize:y,minLevel:b,styles:w,texts:x})},[]);return W.useImperativeHandle(e,()=>E,[E]),W.useLayoutEffect(()=>{if(E)return E.setMap(C),()=>{E.setMap(null)}},[C,E]),W.useLayoutEffect(()=>{E&&l&&l(E)},[E,l]),kt(E,"setGridSize",g),kt(E,"setMinClusterSize",y),kt(E,"setAverageCenter",f),kt(E,"setAverageCenter",f),kt(E,"setMinLevel",b),kt(E,"setTexts",x),kt(E,"setCalculator",p),kt(E,"setStyles",w),Ut(E,"clustered",o),Ut(E,"clusterclick",r),Ut(E,"clusterover",s),Ut(E,"clusterout",a),Ut(E,"clusterdblclick",i),Ut(E,"clusterrightclick",u),E?R.jsxs(U2.Provider,{value:E,children:[d,R.jsx(yue,{...c})]}):null}),yue=()=>{const t=W.useContext(U2);return Ys(()=>{t.redraw()}),null},bue=Ae.forwardRef(function(n,e){let{map:r,position:i,children:o,altitude:a,clickable:s,draggable:u,image:l,infoWindowOptions:c,onCreate:d,onClick:f,onDragEnd:p,onDragStart:h,onMouseOut:v,onMouseOver:g,opacity:m,range:y,title:b,zIndex:w}=n;const x=W.useContext(U2),C=W.useMemo(()=>{var S,k,N,M,D,T,O,P,A,I,_,F;return l&&new kakao.maps.MarkerImage(l.src,new kakao.maps.Size(l.size.width,l.size.height),{alt:(S=l.options)==null?void 0:S.alt,coords:(k=l.options)==null?void 0:k.coords,offset:((N=l.options)==null?void 0:N.offset)&&new kakao.maps.Point((M=l.options)==null?void 0:M.offset.x,(D=l.options)==null?void 0:D.offset.y),shape:(T=l.options)==null?void 0:T.shape,spriteOrigin:((O=l.options)==null?void 0:O.spriteOrigin)&&new kakao.maps.Point((P=l.options)==null?void 0:P.spriteOrigin.x,(A=l.options)==null?void 0:A.spriteOrigin.y),spriteSize:((I=l.options)==null?void 0:I.spriteSize)&&new kakao.maps.Size((_=l.options)==null?void 0:_.spriteSize.width,(F=l.options)==null?void 0:F.spriteSize.height)})},[JSON.stringify(l)]),E=W.useMemo(()=>new kakao.maps.Marker({altitude:a,clickable:s,draggable:u,image:C,opacity:m,range:y,title:b,zIndex:w,position:i}),[]);return W.useImperativeHandle(e,()=>E,[E]),W.useLayoutEffect(()=>x?(x.addMarker(E,!0),()=>x.removeMarker(E,!0)):(E.setMap(r),()=>E.setMap(null)),[r,x,E]),W.useLayoutEffect(()=>{d&&d(E)},[E,d]),kt(E,"setPosition",i),kt(E,"setImage",C),kt(E,"setAltitude",a),kt(E,"setClickable",s),kt(E,"setDraggable",u),kt(E,"setOpacity",m),kt(E,"setRange",y),kt(E,"setRange",y),kt(E,"setTitle",b),kt(E,"setTitle",b),kt(E,"setZIndex",w),Ut(E,"click",f),Ut(E,"dragstart",h),Ut(E,"dragend",p),Ut(E,"mouseout",v),Ut(E,"mouseover",g),o?R.jsx(vue,{position:i,map:r,marker:E,altitude:c==null?void 0:c.altitude,disableAutoPan:c==null?void 0:c.disableAutoPan,range:c==null?void 0:c.range,removable:c==null?void 0:c.removable,zIndex:c==null?void 0:c.zIndex,children:o}):null}),tB=Ae.forwardRef(function(n,e){let{position:r,...i}=n;const o=$2("MapMarker"),a=W.useMemo(()=>"lat"in r?new kakao.maps.LatLng(r.lat,r.lng):new kakao.maps.Coords(r.x,r.y).toLatLng(),[r.lat,r.lng,r.x,r.y]);return R.jsx(bue,{map:o,position:a,...i,ref:e})}),wue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAsCAYAAAAEuLqPAAAAAXNSR0IArs4c6QAABM1JREFUWAm9WEtsG1UUvW88duJgmhQFpXXSqiBQEbBl0x1rJJDYgZBYIqiEKoEq0fKJQCoLWreAVInuSysQlZAQO4TEbwFbhKjUT5oQx2md2IntePx9nPNmbE8Sf8ZO7CvZ8/zeveecd+e9+8ajJKh9pcPy78rzIvol0fppUSouWuKi8C2ygr4k+v4RUd/LU4d/ljdUJQi06ul0ZnVGitUPQfMayA/09KeDkg18XZWo/bGcm1ntFtNZwBd6TBaS70ld3gFxjCDRsYhMxcbl4eiYhMOWhEMhg12p1aRSqUuuWJJs3pFiqexxqrxYckGOxT+Vt1XJ69x2aS/AnfUNpPUEvadiUZmdPiDjEXtbcKcfTrkqy+lNiCm6Lkr9gWy83C4buwW8m3pWarUfQX4kYtvy2OGDEotGOnF17c8Xy3J3JSPlahV+alHs0Aty/tDf/qDtAtyZ/0XyGNL8ePwRpNny+/fdrtTqcie5LnncHizSJWTiOX8mWujzOoLFxrQb8ifnpvdMTrWcALE4IWIbDnJ51hKwmTwDhxNMO2dubc9Nw3+gK7GISWxyCLk8c2mY+q3qLa7240ceHfieN0A7Xbkmbi49wDB2x4T9BG+FmwGn+gHJudoHXXCdSP39xCYHucRwCnYpK5zWKDJitpo/YBhtbmdj5AS3ZcqrlkkWmaD7fC/CyEEuVNZJclui9IsEZIUblTW5wG1JXT9DYpbXUVmTC9zIAE41WNhu7chhC2lygdsyR6oR4B4swyYnftj2uHCcc9pm6pqn+ohMt8gskqfJ61R4YIzGnEqtQZTmLjCnUwlH6KisyQVuZMD6lcQbBe/sHoGKJpdSv0BA6BvUZp3JO7pcrQ+dnhzkIqdo+1tLLs7cwTPcTyjH6kG2MHQBhgNchhPcZgdgK86T+X42r51yc4Hsuxhik8MAe5yugEuzv6MgXa/X62ohlYGe/TdiLqTWhRzkEnLCXAFsTU68iYF7BackqbUce/bViFlw8LQMDsPlobcEzB/M4jEIx7KqJddyOr2xtW8CiEVMYhsOcu0SwI4L8d/E0qdxVqp797N6bXPvW5MYxCKmwSaHz1oZaHQm5hKirLPcFVgPOpNzGiN9XxlLDGIZTGLvsN0C6HAxfg736iOqJkCpVTp3hHf+yRhDzpkTi5htrPuz76nlryHilYfGx+T40Wls3WDGFX9zMY1Fx39j6hpW/KudIttnoOE9NfEW1C+ZnbEefGek4GvI+UeEGF2suwCuVmW9jlnoZDqnt5ze/7jpQ1/GmFjfim+no7sARiTwX1/051wPWM1YT+1g3D6O0Ye+JsbEdvbnSG8B9LLt9zGjxS0Ukm7nBcfoQ183hsHdLZiA84cK2MMnCbW8ttn21OQpxzFDR1/GBLBgAgiUmPsB3zdYy5fTeAGyw9hn6jx8PN8dHu1/BhfA+HAYVVIq67miLvqeoNhmH8c8H3oHsv4EfDZzG7X8CitbEm9AGmbarHYco08f1p8AAo/bn6A2FPj6pYAtx495FYM+M9YHOV37F+C+9brM4NVM3nzYhl32v/lwu3p/9y+AmEq+RBaqmXwRz5K492ibvt58uzwGE5CYXcJj03fmlOO9Z5t9A9hgAkhkhS41+fztZucoGqf++1P42YP9D7SQLhmdOHqxAAAAAElFTkSuQmCC",xue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABUCAYAAADeW1RFAAAAAXNSR0IArs4c6QAAC/NJREFUeAHlXG2IXFcZfs+987Hf2XztzoSE1kYMoiCYUD/jB/ijsQWlhZTml9IfahURbfRHSb1NMGKigiLY/tFYJJIIFbXVgoFEqdWEtBJQamtC0mbJJrshO7OzMzuzM/cen+fMnO3sx0zm497Nrr4we+89533f8zz3fL3n3HtXSUSy09N9k8HER0T0Li16hxbZoURSWutBpWSQxWotOaVUDnnXkfe6EvW6iDq/2Rn56yueKkQBDeWEJ9u96yNlX/ZpFTwIrx8AoUQn3nFD5mB3Vmnnubgrxy95qYlO/CxnEwrhbd61j2lf7Rcl96HaYtWClI4n4iqeSEjMjYkbc8V1XXGUg0qsFYs7EuhAfN8Xv+JLxa9IeW4OvzIqXVeVlKqIlheVq49e9bb8ZTkS7aR1Rfhub/wTfqAPAfdHLclkT1L19vZKIpkEr87co9nLXKkks7OzUiqW5snD3Uuuow5c8dJn2iFZr9sRoru9iZTvV34AJPvoDMR0X3+/6u8fEOV05LIe04JzHWjJ52ekkM/jPlRrHSUcd93YN654I9cXKLdw0Ta6u54c3xOIPo5KGAZVjdpU/UOD4jpoqhGKHwSSn86x1k2No7Yzjqh9bx5M/7GdYtsivO3Ata9rpY6inzqJZI8MgmgsVuuy7ZTahW6lUpEciM+VimxagdJ6/9VDW37YqsuWCL/H04lp//ozmF4+x1odGBxQ/QMDrZYRiV5+ZkZmcjPV2hZ1bMhNfeFfnuLo3lRuS/hd3vSmQjDzW4yUH1bK0euGhxUGpqZOVyoTA5pkMxl07QBTuLzc5wx85g1v6Gaz8psSZs1mg/HTJItBQobXr5dYfGWbcDPwzKuUK5KZmsLUVkHjk5fXOelPNqvppiMNm7Elu2HTxlVHloRZAcTGCiFWg5kZDaQhYTNAoc+yGbNmnYhH4Qb4WkomNmIkVo4zxN7IcNkmvdW7dp/46nkYOXC0avpsIxI2nX0azRsDmQTi6gfGvC0v2jx7XELYBBVB5TXOswODg3KnR2MLtNVjdfTOobYl4zqxdy8OTpY0aRNBgWwS8+xaI8ubQszEzgojl8U3agHhrQfGP27CRYSKAwgq1qoY7OBALuRUz2MBYegcYmZvT69a6QiqHlS358RODvRjOVmf84TNEk/Lbi4E2HfXupADuaCad287MLHb8pknLIF6nIlc9Tju28lWca0dyaEXXAxu5e+3+A0z7lSgve9hnMwl3v+KDBgupi/vIUfyMnFiOZBHuFPB0S3s9ay9ebpclAA/7ZdRVGCSESiIcuPixFEufmELuSSTSVUqFWPlQD0C/z8yNYzohHtQ0tvXG3aZIFmSSm5SKoUpnM+KDhDzkjB+PGca86hD3bDFcrIcFXcXJ4LxKWwmxEdSo+jnS2KRjjH4xZwEpRlj/87NcXnwfX3yoXckJD3kmrTxaV/+dnlOnrtQkIuTZZPmJAfE7Qlv0OSoNXH9BpbxujzipNfHuJWKtAQ23DiqdUxusaElG0Oz+uanhmTv+/uwmFko92yMCX/7dvXJyVcLcuTUtFRqNygs0uTEzURsDibI1UGH2kkY8XhHO6oLGdSu2DRZsyT704c3yMPLkK035I2gDnVpQ9swm/c8N3B10LZ3sPAwA42gOG34sGbvvav1G0ld2lCsD3PR5R/LjVwd7AMawtw3DkM4GnMwYp9lM25XaENb+qCvMMRyI1c0IEnTKTfJwxBOPRQOUIv7bCv+aUNbivVlLrr4Y7mRK1bM2gyJ5olAF06tKedZCkfjTsXaWl+d+rF2lhu5OhjEqnNASCO0DSrs1GMLbedoba2vdmyX1a1xI1cMWoJI4P9DyJWRltnWDLCzH4YwXKQwqOhUrK311akfa1fH7aajtEwyI6zmw9iYwgiqU7G21lenfqyd5UauaNJqnBk+HmGEIVwIUBguogm1LbShLcX6Mhdd/JnnptQ1TEv6LH2Vy9XRtQu/xpSrHuXETGzMcLFdoQ3javoIawU1z03rc47rqpcIam4uHML05fRUoyXGxufebL1pU5c29T7MRZd/LDdydSpDqbN4MIObMIem3kkjXIrGiSeFq54K/H3pxC05gVpr5pl51KEubWhLH2EIOZEbOVa5wuvWJ8efx6h1/9DwsPDpfVhiV0z0d6eWh3yLYDqT4W7eC2MH0w+YHQ9MJL/ApHR/EZlhEuYST7kJsxBgvzxyKtvwXrLPsiuEVbO2IHKi4GnMMR4N4cSm1O9Kk+NTeK9iPZ/GhfmE0DTv+GazEFjpLR5y4bsiiKGnEhtSvydhEyVc/Koq4fWanzOhgAfNUQhHXLdvWGKDmyU+NGp+PGdaWKPxYtzzXJT6meEIhWpYhJNYwjmCOzE7Wypqvka01oUcyIWcYknnqOUzT/jyE6M3MPk9jcFL5bLVqcEqrcWj4cC3fsDJcKuRmCfM61hSfQ/DWQ7bmpiXW58/V9sNIXZyIJcqp7cRLiDMO4HdvW8zm3eIT6PWmhCzbaHkUl+75LKAMBM++N70j3G4UKmUJZ/LMWlNCTETO+RCjcsC/EsI/3qv8mOu80U0Bz9fyGu897jAYDVfECsxEzs5kMtivEsIU+GKl/o7dgcOcwDLZjM4rP62TYzESszETg6LyfJ6WcLM2O6kDiIcO8ulVXYKjla5EKNZBgKzwd4AL6apxrLt0I3tUvbP4+YNDw4OSd9Af2PlO5hTmMlLLjeN+pGMxN1dVw+MXmoEp2EN04CGSty97BO5XE7PlVbfVEVMxEaMxNqMLDk1JUyFtw6O/gmHr6FzqEx2SvPlztUixEJMxEaMNaxN4d2WMK3HDqV/gg21Z7QfqMzULR344Wz4NUV2m0xiIBZiIjZivI2JyW6JMDW3O6NfQSc5jVf1VSYzdUeDEk4a5v1KYCEmg60VttBpOmgt9rHVy25QfuEcHkpt7+ntk3XD6xarrMh1NpOV4mwB4NUl7fbdO+atu9VqwS3XMB0ax676LO5TngUW8u1v0rUKrJEey2TZxCDA0g5Z+myLMA2ueql/otM8yvPc9LS2G2S8jlpYFstkOcRALO2W2TZhFnD1YOoEXhjBa/eIxDJTGDeiH8RYBstimSybGNolS/2OCNNwu0p9C/f5TOD7KosXtKOMPuk7ewsvxaAsllktmyjal7YGrcXu+e5TKQhewR7sVrzQho8+qvvRi/W6vUYz5mc84CpjScfZ2c2Xah3XMEmYgh31EEK6OQwmkaysuAKib5aBfbeHuiFLzF0RpoMxL31OtPMU+9Z0tvE2LHU7kapPRFIow5TViZM6m64J09eQO/p9NLd/m00DBPJhSR6+zGIevk0ZITgOhTC/InFFPUY8+ZlcKLue3HWkL/qk72ZfqlCnVQmFMAvDJ3Gn0UN+iYU4dj27b9r0QV/0WfXdKqXmeqERZjHxHvU416Ql7PYXZzt/5Yi29EFf9NmcQnu5oRI2O4RaPUEIM7npjnaGOOfS1tCAr8W7ju3RW6odKmG6f9RNPY2w7zz6oJottB9r04a29EFfSyF3l9JV4NGoaH5y62v9Bzxtl02bR9g0WxLW7s3JCUZUWBeoT7f7qWwrhYRewyyUQEHyVQKvrmxagSJGlzaQf0RBlo4jIVxzfJhHzqVNH/9TiYLaNbo4dZV8x6RF8CcywleeSj+HBfpr/Opztlh9KN0MP3WoS5vPO+nfNNPtJi8ywhh0+Bb6dwkun7v9M2erQxvPU5GtNyMjTKL3OOlfocYus+aKxcbzMufdWu1epg1to5JICZ/x8D84RB8h+GbbQYX56UsfqdpERTfCQctCHnHTz2Ihm8M3B8vG2IyZmUedqq61jOYYaQ0TMv+nDvrlSdS0KhaWDl7VND4A0yej+v879bcucsIsDK8kHeNxlruN1aCRl+bcpOHU6pj0CP+sCOG3vBG+3vgfNt/6Vyl4zjTm1XQipFp1vSKEWZQS5xiPtkbrz20e06KWFSOcdOPPIqgOSsWiDvD+I388Z5rJi5ppzf+KEb7obRzDd56nuKifLeSFP54zjXkrxDe6WHo5AqjOw6zRGbx4wh/PTdpyyhGlrVgNEz8eaf4ZNfpldOg3+MN3gI8xLSJuy7r9LyKqpzm0iOL3AAAAAElFTkSuQmCC";function fI(t){return SS({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(t)}function Sue(t){return SS({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M568.482 177.448L424.479 313.433C409.3 327.768 384 317.14 384 295.985v-71.963c-144.575.97-205.566 35.113-164.775 171.353 4.483 14.973-12.846 26.567-25.006 17.33C155.252 383.105 120 326.488 120 269.339c0-143.937 117.599-172.5 264-173.312V24.012c0-21.174 25.317-31.768 40.479-17.448l144.003 135.988c10.02 9.463 10.028 25.425 0 34.896zM384 379.128V448H64V128h50.916a11.99 11.99 0 0 0 8.648-3.693c14.953-15.568 32.237-27.89 51.014-37.676C185.708 80.83 181.584 64 169.033 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48v-88.806c0-8.288-8.197-14.066-16.011-11.302a71.83 71.83 0 0 1-34.189 3.377c-7.27-1.046-13.8 4.514-13.8 11.859z"},child:[]}]})(t)}var W2={},Eue=yt;Object.defineProperty(W2,"__esModule",{value:!0});var nB=W2.default=void 0,Cue=Eue(bt()),Rue=R;nB=W2.default=(0,Cue.default)((0,Rue.jsx)("path",{d:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99"}),"Call");const Tue=({position:t,content:n,isActive:e,onClick:r,getDistance:i})=>{const o=Yz(Fy),a=co(L2),s=$2(),u=Er(),l=f=>{s.panTo(f.getPosition()),r()},c=W.useMemo(()=>i(o.center.lat,o.center.lng,t.lat,t.lng),[o,t]),d=()=>{const f=s.getCenter();a({lat:f.getLat(),lng:f.getLng()}),u(`${t.lat}-${t.lng}`,{state:{data:{content:n,position:t}}})};return R.jsxs(R.Fragment,{children:[R.jsx(tB,{position:t,onClick:l,image:e?{src:xue,size:{width:28,height:40}}:{src:wue,size:{width:18,height:25}}}),e&&R.jsxs("div",{className:"info",children:[R.jsxs("div",{className:"info_header",children:[R.jsx("div",{className:"info_name",onClick:d,children:n.name}),R.jsx("div",{className:"info_type",children:n.type})]}),R.jsxs("div",{className:"info_body",children:[R.jsx("div",{className:"info_distance",children:c>=1?`${c.toFixed(1)}km`:`${(c/1e3).toFixed()}`}),R.jsx("div",{className:"info_addr",children:n.addr})]}),R.jsxs("div",{className:"info_footer",children:[R.jsx("hr",{}),R.jsxs("div",{className:"info_icons",children:[n.tel&&R.jsx("a",{href:`tel:${n.tel}`,children:R.jsx(nB,{})}),R.jsx(Sue,{})]})]})]})]})};var H2={},Nue=yt;Object.defineProperty(H2,"__esModule",{value:!0});var rB=H2.default=void 0,kue=Nue(bt()),Iue=R;rB=H2.default=(0,kue.default)((0,Iue.jsx)("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"GpsFixed");var G2={},_ue=yt;Object.defineProperty(G2,"__esModule",{value:!0});var iB=G2.default=void 0,Aue=_ue(bt()),Oue=R;iB=G2.default=(0,Aue.default)((0,Oue.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"RefreshOutlined");const Due=({mapRef:t,addData:n,getDistance:e,openList:r})=>{const[i,o]=Ba(Ly),[a,s]=Ba(M2),[u,l]=Ba(Fy),[c,d]=Ba(L2),f=co(P2),p=()=>{const v=t.current;if(!v)return;const g=v.getCenter();v.setCenter(g),o(!1),s(null),f("dist"),d({lat:g.getLat(),lng:g.getLng()})};console.log(c);const h=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(v=>{const g=v.coords.latitude,m=v.coords.longitude,y=new kakao.maps.LatLng(g,m);t.current.setCenter(y),o(!1),l(b=>({...b,center:{lat:g,lng:m},isLoading:!0}))}):window.alert("이 브라우저에서는 Geolocation을 지원하지 않습니다.")};return R.jsxs("div",{className:"FishMapBody",children:[i&&!r&&R.jsxs("div",{className:"reSearch",onClick:p,children:[R.jsx(iB,{}),"이 지역 검색"]}),R.jsxs(mue,{center:c,ref:t,level:9,onClick:()=>s(null),onCenterChanged:()=>o(!0),children:[R.jsx(gue,{minLevel:12,averageCenter:!0,children:n.map((v,g)=>R.jsx(Tue,{position:v.latlng,content:v.content,isActive:a===g,onClick:()=>s(g),getDistance:e},`EventMarkerContainer-${v.latlng.lat}-${v.latlng.lng}`))}),u.isLoading&&R.jsx(tB,{position:u.center,clickable:!0,image:{src:"https://cdn4.iconfinder.com/data/icons/small-n-flat/24/map-marker-512.png",size:{width:25,height:25}}}),!r&&R.jsx("button",{style:{bottom:a!==null?"10rem":"1.5rem"},className:"FishMap_btn",onClick:h,children:R.jsx(rB,{})})]})]})},Mue=[{content:{name:"상무낚시터",type:"기타낚시",addr:"광주광역시 서구 유덕로141번길 31-1",tel:"062-373-0558",hashTag:["월척"],expense:1e4,fishes:["용치놀래기","가다랑어","붉바리","보리멸","자리돔","참돔"]},latlng:{lat:35.16357724,lng:126.8386542}},{content:{name:"땅끝낚시터",type:"바다낚시",addr:"전라남도 해남군 송지면 갈산길 93, 땅끝낚시터",tel:"061-536-1234",hashTag:["사진맛집","월척"],expense:2e4,fishes:["가다랑어","보리멸"]},latlng:{lat:34.30556,lng:126.516116}},{content:{name:"정남진 해양낚시공원",type:"바다낚시",addr:"전라남도 장흥군 회진면 해양낚시길 135",tel:"061-867-0555",hashTag:["사진맛집"],expense:15e3,fishes:["자리돔","참돔"]},latlng:{lat:34.4706335,lng:126.9740566}},{content:{name:"거금해양낚시공원",type:"바다낚시",addr:"전라남도 고흥군 금산면 신촌내동길 18-132",tel:"061-843-6060",hashTag:["#사진맛집","#노을맛집","#월척"],expense:14e3,fishes:["가다랑어","붉바리"]},latlng:{lat:34.46942797,lng:127.104524}},{content:{name:"홀통낚시터",type:"바다낚시",addr:"전라남도 무안군 현경면 홀통길 198-1",tel:"",hashTag:["#노을맛집","#월척"],expense:1e4,fishes:["가다랑어","붉바리"]},latlng:{lat:35.0616396163,lng:126.3321694341}},{content:{name:"늘푸른낚시",type:"바다낚시",addr:"전라남도 무안군 운남면 운해로 1",tel:"061-452-5660",hashTag:["#노을맛집"],expense:2e4,fishes:["가다랑어","붉바리"]},latlng:{lat:34.9153538678,lng:126.3384728811}}],Pue=["#사진맛집","#노을맛집","#월척","#고기맛집","#산책하기좋은곳"],Lue=()=>{const t=co(Jz),n=co(P2),e=co(Ly),r=co(Fy),[i,o]=Ba(L2),[a,s]=Ba(M2),[u,l]=W.useState(!1),c=Si();console.log(c);const d=W.useRef(null),f=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(g=>{var b;const{latitude:m,longitude:y}=g.coords;r(w=>({...w,center:{lat:m,lng:y},isLoading:!0})),e(!1),(!i.lat&&!i.lng||!((b=c.state)!=null&&b.data))&&p(m,y)},g=>{console.log(g),r(m=>({...m,errMsg:g.message,isLoading:!1}))}):r(g=>({...g,errMsg:"geolocation을 사용할수 없어요..",isLoading:!1}))},p=(g,m)=>{o({lat:g,lng:m}),s(null),t(""),n("dist")},h=(g,m,y,b)=>{const w=M=>M*(Math.PI/180),C=w(y-g),E=w(b-m),S=Math.sin(C/2)*Math.sin(C/2)+Math.cos(w(g))*Math.cos(w(y))*Math.sin(E/2)*Math.sin(E/2);return 6371*(2*Math.atan2(Math.sqrt(S),Math.sqrt(1-S)))},v=W.useMemo(()=>Mue.map(g=>{const m=h(i.lat,i.lng,g.latlng.lat,g.latlng.lng);return m<=20?{...g,dist:m}:null}).filter(Boolean),[i]);return W.useEffect(()=>{f()},[]),R.jsxs("div",{className:"FishMap",children:[R.jsx(pue,{hashTags:Pue,mapRef:d}),R.jsx(Due,{openList:u,mapRef:d,addData:v,getDistance:h}),a===null&&R.jsx(rue,{openList:u,setOpenList:l,addData:v,mapRef:d,getDistance:h})]})},Fue=["일","월","화","수","목","금","토"],zue=({weatherData:t,sunrise:n,sunset:e})=>{const r=new Date,i=(r.getMonth()+1).toString().padStart(2,"0"),o=r.getDate().toString().padStart(2,"0"),a=u=>u.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1}),s=u=>u<12?`오전${u||12}시`:`오후${u===12?u:u-12}시`;return R.jsxs("div",{className:"MapDetailWeather",children:[R.jsx("div",{className:"todays-date",children:`${i}.${o} ${Fue[r.getDay()]}`}),R.jsxs("div",{className:"sun-rs",children:[`일출 ${a(n)}`,R.jsx("span",{children:"•"}),`일몰 ${a(e)}`]}),R.jsx("div",{className:"weather-data",children:t.map((u,l)=>R.jsxs("div",{className:"weather-total",children:[R.jsx("div",{className:"weather-time",children:s(new Date(u.dt_txt).getHours())}),R.jsx("img",{className:"weather-icon",src:`http://openweathermap.org/img/wn/${u.weather[0].icon}@2x.png`,alt:"날씨 아이콘"}),R.jsxs("div",{children:[u.main.temp.toFixed(0),"°"]}),R.jsx("div",{children:`${(u.pop*100).toFixed()}%`})]},l))})]})};function oB(t,n){return function(){return t.apply(n,arguments)}}const{toString:Bue}=Object.prototype,{getPrototypeOf:q2}=Object,zy=(t=>n=>{const e=Bue.call(n);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),Io=t=>(t=t.toLowerCase(),n=>zy(n)===t),By=t=>n=>typeof n===t,{isArray:zc}=Array,Gf=By("undefined");function jue(t){return t!==null&&!Gf(t)&&t.constructor!==null&&!Gf(t.constructor)&&bi(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const aB=Io("ArrayBuffer");function Vue(t){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(t):n=t&&t.buffer&&aB(t.buffer),n}const $ue=By("string"),bi=By("function"),sB=By("number"),jy=t=>t!==null&&typeof t=="object",Uue=t=>t===!0||t===!1,xm=t=>{if(zy(t)!=="object")return!1;const n=q2(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Wue=Io("Date"),Hue=Io("File"),Gue=Io("Blob"),que=Io("FileList"),Kue=t=>jy(t)&&bi(t.pipe),Xue=t=>{let n;return t&&(typeof FormData=="function"&&t instanceof FormData||bi(t.append)&&((n=zy(t))==="formdata"||n==="object"&&bi(t.toString)&&t.toString()==="[object FormData]"))},Yue=Io("URLSearchParams"),Jue=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Lp(t,n,{allOwnKeys:e=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),zc(t))for(r=0,i=t.length;r<i;r++)n.call(null,t[r],r,t);else{const o=e?Object.getOwnPropertyNames(t):Object.keys(t),a=o.length;let s;for(r=0;r<a;r++)s=o[r],n.call(null,t[s],s,t)}}function uB(t,n){n=n.toLowerCase();const e=Object.keys(t);let r=e.length,i;for(;r-- >0;)if(i=e[r],n===i.toLowerCase())return i;return null}const lB=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,cB=t=>!Gf(t)&&t!==lB;function sx(){const{caseless:t}=cB(this)&&this||{},n={},e=(r,i)=>{const o=t&&uB(n,i)||i;xm(n[o])&&xm(r)?n[o]=sx(n[o],r):xm(r)?n[o]=sx({},r):zc(r)?n[o]=r.slice():n[o]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Lp(arguments[r],e);return n}const Que=(t,n,e,{allOwnKeys:r}={})=>(Lp(n,(i,o)=>{e&&bi(i)?t[o]=oB(i,e):t[o]=i},{allOwnKeys:r}),t),Zue=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),ele=(t,n,e,r)=>{t.prototype=Object.create(n.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:n.prototype}),e&&Object.assign(t.prototype,e)},tle=(t,n,e,r)=>{let i,o,a;const s={};if(n=n||{},t==null)return n;do{for(i=Object.getOwnPropertyNames(t),o=i.length;o-- >0;)a=i[o],(!r||r(a,t,n))&&!s[a]&&(n[a]=t[a],s[a]=!0);t=e!==!1&&q2(t)}while(t&&(!e||e(t,n))&&t!==Object.prototype);return n},nle=(t,n,e)=>{t=String(t),(e===void 0||e>t.length)&&(e=t.length),e-=n.length;const r=t.indexOf(n,e);return r!==-1&&r===e},rle=t=>{if(!t)return null;if(zc(t))return t;let n=t.length;if(!sB(n))return null;const e=new Array(n);for(;n-- >0;)e[n]=t[n];return e},ile=(t=>n=>t&&n instanceof t)(typeof Uint8Array<"u"&&q2(Uint8Array)),ole=(t,n)=>{const r=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=r.next())&&!i.done;){const o=i.value;n.call(t,o[0],o[1])}},ale=(t,n)=>{let e;const r=[];for(;(e=t.exec(n))!==null;)r.push(e);return r},sle=Io("HTMLFormElement"),ule=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,r,i){return r.toUpperCase()+i}),pI=(({hasOwnProperty:t})=>(n,e)=>t.call(n,e))(Object.prototype),lle=Io("RegExp"),dB=(t,n)=>{const e=Object.getOwnPropertyDescriptors(t),r={};Lp(e,(i,o)=>{let a;(a=n(i,o,t))!==!1&&(r[o]=a||i)}),Object.defineProperties(t,r)},cle=t=>{dB(t,(n,e)=>{if(bi(t)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const r=t[e];if(bi(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},dle=(t,n)=>{const e={},r=i=>{i.forEach(o=>{e[o]=!0})};return zc(t)?r(t):r(String(t).split(n)),e},fle=()=>{},ple=(t,n)=>(t=+t,Number.isFinite(t)?t:n),_1="abcdefghijklmnopqrstuvwxyz",hI="0123456789",fB={DIGIT:hI,ALPHA:_1,ALPHA_DIGIT:_1+_1.toUpperCase()+hI},hle=(t=16,n=fB.ALPHA_DIGIT)=>{let e="";const{length:r}=n;for(;t--;)e+=n[Math.random()*r|0];return e};function mle(t){return!!(t&&bi(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const vle=t=>{const n=new Array(10),e=(r,i)=>{if(jy(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[i]=r;const o=zc(r)?[]:{};return Lp(r,(a,s)=>{const u=e(a,i+1);!Gf(u)&&(o[s]=u)}),n[i]=void 0,o}}return r};return e(t,0)},gle=Io("AsyncFunction"),yle=t=>t&&(jy(t)||bi(t))&&bi(t.then)&&bi(t.catch),ce={isArray:zc,isArrayBuffer:aB,isBuffer:jue,isFormData:Xue,isArrayBufferView:Vue,isString:$ue,isNumber:sB,isBoolean:Uue,isObject:jy,isPlainObject:xm,isUndefined:Gf,isDate:Wue,isFile:Hue,isBlob:Gue,isRegExp:lle,isFunction:bi,isStream:Kue,isURLSearchParams:Yue,isTypedArray:ile,isFileList:que,forEach:Lp,merge:sx,extend:Que,trim:Jue,stripBOM:Zue,inherits:ele,toFlatObject:tle,kindOf:zy,kindOfTest:Io,endsWith:nle,toArray:rle,forEachEntry:ole,matchAll:ale,isHTMLForm:sle,hasOwnProperty:pI,hasOwnProp:pI,reduceDescriptors:dB,freezeMethods:cle,toObjectSet:dle,toCamelCase:ule,noop:fle,toFiniteNumber:ple,findKey:uB,global:lB,isContextDefined:cB,ALPHABET:fB,generateString:hle,isSpecCompliantForm:mle,toJSONObject:vle,isAsyncFn:gle,isThenable:yle};function vt(t,n,e,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",n&&(this.code=n),e&&(this.config=e),r&&(this.request=r),i&&(this.response=i)}ce.inherits(vt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ce.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const pB=vt.prototype,hB={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{hB[t]={value:t}});Object.defineProperties(vt,hB);Object.defineProperty(pB,"isAxiosError",{value:!0});vt.from=(t,n,e,r,i,o)=>{const a=Object.create(pB);return ce.toFlatObject(t,a,function(u){return u!==Error.prototype},s=>s!=="isAxiosError"),vt.call(a,t.message,n,e,r,i),a.cause=t,a.name=t.name,o&&Object.assign(a,o),a};const ble=null;function ux(t){return ce.isPlainObject(t)||ce.isArray(t)}function mB(t){return ce.endsWith(t,"[]")?t.slice(0,-2):t}function mI(t,n,e){return t?t.concat(n).map(function(i,o){return i=mB(i),!e&&o?"["+i+"]":i}).join(e?".":""):n}function wle(t){return ce.isArray(t)&&!t.some(ux)}const xle=ce.toFlatObject(ce,{},null,function(n){return/^is[A-Z]/.test(n)});function Vy(t,n,e){if(!ce.isObject(t))throw new TypeError("target must be an object");n=n||new FormData,e=ce.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,g){return!ce.isUndefined(g[v])});const r=e.metaTokens,i=e.visitor||c,o=e.dots,a=e.indexes,u=(e.Blob||typeof Blob<"u"&&Blob)&&ce.isSpecCompliantForm(n);if(!ce.isFunction(i))throw new TypeError("visitor must be a function");function l(h){if(h===null)return"";if(ce.isDate(h))return h.toISOString();if(!u&&ce.isBlob(h))throw new vt("Blob is not supported. Use a Buffer instead.");return ce.isArrayBuffer(h)||ce.isTypedArray(h)?u&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function c(h,v,g){let m=h;if(h&&!g&&typeof h=="object"){if(ce.endsWith(v,"{}"))v=r?v:v.slice(0,-2),h=JSON.stringify(h);else if(ce.isArray(h)&&wle(h)||(ce.isFileList(h)||ce.endsWith(v,"[]"))&&(m=ce.toArray(h)))return v=mB(v),m.forEach(function(b,w){!(ce.isUndefined(b)||b===null)&&n.append(a===!0?mI([v],w,o):a===null?v:v+"[]",l(b))}),!1}return ux(h)?!0:(n.append(mI(g,v,o),l(h)),!1)}const d=[],f=Object.assign(xle,{defaultVisitor:c,convertValue:l,isVisitable:ux});function p(h,v){if(!ce.isUndefined(h)){if(d.indexOf(h)!==-1)throw Error("Circular reference detected in "+v.join("."));d.push(h),ce.forEach(h,function(m,y){(!(ce.isUndefined(m)||m===null)&&i.call(n,m,ce.isString(y)?y.trim():y,v,f))===!0&&p(m,v?v.concat(y):[y])}),d.pop()}}if(!ce.isObject(t))throw new TypeError("data must be an object");return p(t),n}function vI(t){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function K2(t,n){this._pairs=[],t&&Vy(t,this,n)}const vB=K2.prototype;vB.append=function(n,e){this._pairs.push([n,e])};vB.toString=function(n){const e=n?function(r){return n.call(this,r,vI)}:vI;return this._pairs.map(function(i){return e(i[0])+"="+e(i[1])},"").join("&")};function Sle(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function gB(t,n,e){if(!n)return t;const r=e&&e.encode||Sle,i=e&&e.serialize;let o;if(i?o=i(n,e):o=ce.isURLSearchParams(n)?n.toString():new K2(n,e).toString(r),o){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class gI{constructor(){this.handlers=[]}use(n,e,r){return this.handlers.push({fulfilled:n,rejected:e,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){ce.forEach(this.handlers,function(r){r!==null&&n(r)})}}const yB={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ele=typeof URLSearchParams<"u"?URLSearchParams:K2,Cle=typeof FormData<"u"?FormData:null,Rle=typeof Blob<"u"?Blob:null,Tle={isBrowser:!0,classes:{URLSearchParams:Ele,FormData:Cle,Blob:Rle},protocols:["http","https","file","blob","url","data"]},bB=typeof window<"u"&&typeof document<"u",Nle=(t=>bB&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),kle=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Ile=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:bB,hasStandardBrowserEnv:Nle,hasStandardBrowserWebWorkerEnv:kle},Symbol.toStringTag,{value:"Module"})),fo={...Ile,...Tle};function _le(t,n){return Vy(t,new fo.classes.URLSearchParams,Object.assign({visitor:function(e,r,i,o){return fo.isNode&&ce.isBuffer(e)?(this.append(r,e.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function Ale(t){return ce.matchAll(/\w+|\[(\w*)]/g,t).map(n=>n[0]==="[]"?"":n[1]||n[0])}function Ole(t){const n={},e=Object.keys(t);let r;const i=e.length;let o;for(r=0;r<i;r++)o=e[r],n[o]=t[o];return n}function wB(t){function n(e,r,i,o){let a=e[o++];if(a==="__proto__")return!0;const s=Number.isFinite(+a),u=o>=e.length;return a=!a&&ce.isArray(i)?i.length:a,u?(ce.hasOwnProp(i,a)?i[a]=[i[a],r]:i[a]=r,!s):((!i[a]||!ce.isObject(i[a]))&&(i[a]=[]),n(e,r,i[a],o)&&ce.isArray(i[a])&&(i[a]=Ole(i[a])),!s)}if(ce.isFormData(t)&&ce.isFunction(t.entries)){const e={};return ce.forEachEntry(t,(r,i)=>{n(Ale(r),i,e,0)}),e}return null}function Dle(t,n,e){if(ce.isString(t))try{return(n||JSON.parse)(t),ce.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(e||JSON.stringify)(t)}const X2={transitional:yB,adapter:["xhr","http"],transformRequest:[function(n,e){const r=e.getContentType()||"",i=r.indexOf("application/json")>-1,o=ce.isObject(n);if(o&&ce.isHTMLForm(n)&&(n=new FormData(n)),ce.isFormData(n))return i?JSON.stringify(wB(n)):n;if(ce.isArrayBuffer(n)||ce.isBuffer(n)||ce.isStream(n)||ce.isFile(n)||ce.isBlob(n))return n;if(ce.isArrayBufferView(n))return n.buffer;if(ce.isURLSearchParams(n))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let s;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return _le(n,this.formSerializer).toString();if((s=ce.isFileList(n))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Vy(s?{"files[]":n}:n,u&&new u,this.formSerializer)}}return o||i?(e.setContentType("application/json",!1),Dle(n)):n}],transformResponse:[function(n){const e=this.transitional||X2.transitional,r=e&&e.forcedJSONParsing,i=this.responseType==="json";if(n&&ce.isString(n)&&(r&&!this.responseType||i)){const a=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(n)}catch(s){if(a)throw s.name==="SyntaxError"?vt.from(s,vt.ERR_BAD_RESPONSE,this,null,this.response):s}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:fo.classes.FormData,Blob:fo.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ce.forEach(["delete","get","head","post","put","patch"],t=>{X2.headers[t]={}});const Y2=X2,Mle=ce.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ple=t=>{const n={};let e,r,i;return t&&t.split(`
`).forEach(function(a){i=a.indexOf(":"),e=a.substring(0,i).trim().toLowerCase(),r=a.substring(i+1).trim(),!(!e||n[e]&&Mle[e])&&(e==="set-cookie"?n[e]?n[e].push(r):n[e]=[r]:n[e]=n[e]?n[e]+", "+r:r)}),n},yI=Symbol("internals");function bd(t){return t&&String(t).trim().toLowerCase()}function Sm(t){return t===!1||t==null?t:ce.isArray(t)?t.map(Sm):String(t)}function Lle(t){const n=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=e.exec(t);)n[r[1]]=r[2];return n}const Fle=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function A1(t,n,e,r,i){if(ce.isFunction(r))return r.call(this,n,e);if(i&&(n=e),!!ce.isString(n)){if(ce.isString(r))return n.indexOf(r)!==-1;if(ce.isRegExp(r))return r.test(n)}}function zle(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,e,r)=>e.toUpperCase()+r)}function Ble(t,n){const e=ce.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+e,{value:function(i,o,a){return this[r].call(this,n,i,o,a)},configurable:!0})})}class $y{constructor(n){n&&this.set(n)}set(n,e,r){const i=this;function o(s,u,l){const c=bd(u);if(!c)throw new Error("header name must be a non-empty string");const d=ce.findKey(i,c);(!d||i[d]===void 0||l===!0||l===void 0&&i[d]!==!1)&&(i[d||u]=Sm(s))}const a=(s,u)=>ce.forEach(s,(l,c)=>o(l,c,u));return ce.isPlainObject(n)||n instanceof this.constructor?a(n,e):ce.isString(n)&&(n=n.trim())&&!Fle(n)?a(Ple(n),e):n!=null&&o(e,n,r),this}get(n,e){if(n=bd(n),n){const r=ce.findKey(this,n);if(r){const i=this[r];if(!e)return i;if(e===!0)return Lle(i);if(ce.isFunction(e))return e.call(this,i,r);if(ce.isRegExp(e))return e.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,e){if(n=bd(n),n){const r=ce.findKey(this,n);return!!(r&&this[r]!==void 0&&(!e||A1(this,this[r],r,e)))}return!1}delete(n,e){const r=this;let i=!1;function o(a){if(a=bd(a),a){const s=ce.findKey(r,a);s&&(!e||A1(r,r[s],s,e))&&(delete r[s],i=!0)}}return ce.isArray(n)?n.forEach(o):o(n),i}clear(n){const e=Object.keys(this);let r=e.length,i=!1;for(;r--;){const o=e[r];(!n||A1(this,this[o],o,n,!0))&&(delete this[o],i=!0)}return i}normalize(n){const e=this,r={};return ce.forEach(this,(i,o)=>{const a=ce.findKey(r,o);if(a){e[a]=Sm(i),delete e[o];return}const s=n?zle(o):String(o).trim();s!==o&&delete e[o],e[s]=Sm(i),r[s]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const e=Object.create(null);return ce.forEach(this,(r,i)=>{r!=null&&r!==!1&&(e[i]=n&&ce.isArray(r)?r.join(", "):r)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,e])=>n+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...e){const r=new this(n);return e.forEach(i=>r.set(i)),r}static accessor(n){const r=(this[yI]=this[yI]={accessors:{}}).accessors,i=this.prototype;function o(a){const s=bd(a);r[s]||(Ble(i,a),r[s]=!0)}return ce.isArray(n)?n.forEach(o):o(n),this}}$y.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ce.reduceDescriptors($y.prototype,({value:t},n)=>{let e=n[0].toUpperCase()+n.slice(1);return{get:()=>t,set(r){this[e]=r}}});ce.freezeMethods($y);const Yo=$y;function O1(t,n){const e=this||Y2,r=n||e,i=Yo.from(r.headers);let o=r.data;return ce.forEach(t,function(s){o=s.call(e,o,i.normalize(),n?n.status:void 0)}),i.normalize(),o}function xB(t){return!!(t&&t.__CANCEL__)}function Fp(t,n,e){vt.call(this,t??"canceled",vt.ERR_CANCELED,n,e),this.name="CanceledError"}ce.inherits(Fp,vt,{__CANCEL__:!0});function jle(t,n,e){const r=e.config.validateStatus;!e.status||!r||r(e.status)?t(e):n(new vt("Request failed with status code "+e.status,[vt.ERR_BAD_REQUEST,vt.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}const Vle=fo.hasStandardBrowserEnv?{write(t,n,e,r,i,o){const a=[t+"="+encodeURIComponent(n)];ce.isNumber(e)&&a.push("expires="+new Date(e).toGMTString()),ce.isString(r)&&a.push("path="+r),ce.isString(i)&&a.push("domain="+i),o===!0&&a.push("secure"),document.cookie=a.join("; ")},read(t){const n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function $le(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Ule(t,n){return n?t.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):t}function SB(t,n){return t&&!$le(n)?Ule(t,n):n}const Wle=fo.hasStandardBrowserEnv?function(){const n=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let r;function i(o){let a=o;return n&&(e.setAttribute("href",a),a=e.href),e.setAttribute("href",a),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return r=i(window.location.href),function(a){const s=ce.isString(a)?i(a):a;return s.protocol===r.protocol&&s.host===r.host}}():function(){return function(){return!0}}();function Hle(t){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}function Gle(t,n){t=t||10;const e=new Array(t),r=new Array(t);let i=0,o=0,a;return n=n!==void 0?n:1e3,function(u){const l=Date.now(),c=r[o];a||(a=l),e[i]=u,r[i]=l;let d=o,f=0;for(;d!==i;)f+=e[d++],d=d%t;if(i=(i+1)%t,i===o&&(o=(o+1)%t),l-a<n)return;const p=c&&l-c;return p?Math.round(f*1e3/p):void 0}}function bI(t,n){let e=0;const r=Gle(50,250);return i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,s=o-e,u=r(s),l=o<=a;e=o;const c={loaded:o,total:a,progress:a?o/a:void 0,bytes:s,rate:u||void 0,estimated:u&&a&&l?(a-o)/u:void 0,event:i};c[n?"download":"upload"]=!0,t(c)}}const qle=typeof XMLHttpRequest<"u",Kle=qle&&function(t){return new Promise(function(e,r){let i=t.data;const o=Yo.from(t.headers).normalize();let{responseType:a,withXSRFToken:s}=t,u;function l(){t.cancelToken&&t.cancelToken.unsubscribe(u),t.signal&&t.signal.removeEventListener("abort",u)}let c;if(ce.isFormData(i)){if(fo.hasStandardBrowserEnv||fo.hasStandardBrowserWebWorkerEnv)o.setContentType(!1);else if((c=o.getContentType())!==!1){const[v,...g]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([v||"multipart/form-data",...g].join("; "))}}let d=new XMLHttpRequest;if(t.auth){const v=t.auth.username||"",g=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";o.set("Authorization","Basic "+btoa(v+":"+g))}const f=SB(t.baseURL,t.url);d.open(t.method.toUpperCase(),gB(f,t.params,t.paramsSerializer),!0),d.timeout=t.timeout;function p(){if(!d)return;const v=Yo.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders()),m={data:!a||a==="text"||a==="json"?d.responseText:d.response,status:d.status,statusText:d.statusText,headers:v,config:t,request:d};jle(function(b){e(b),l()},function(b){r(b),l()},m),d=null}if("onloadend"in d?d.onloadend=p:d.onreadystatechange=function(){!d||d.readyState!==4||d.status===0&&!(d.responseURL&&d.responseURL.indexOf("file:")===0)||setTimeout(p)},d.onabort=function(){d&&(r(new vt("Request aborted",vt.ECONNABORTED,t,d)),d=null)},d.onerror=function(){r(new vt("Network Error",vt.ERR_NETWORK,t,d)),d=null},d.ontimeout=function(){let g=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const m=t.transitional||yB;t.timeoutErrorMessage&&(g=t.timeoutErrorMessage),r(new vt(g,m.clarifyTimeoutError?vt.ETIMEDOUT:vt.ECONNABORTED,t,d)),d=null},fo.hasStandardBrowserEnv&&(s&&ce.isFunction(s)&&(s=s(t)),s||s!==!1&&Wle(f))){const v=t.xsrfHeaderName&&t.xsrfCookieName&&Vle.read(t.xsrfCookieName);v&&o.set(t.xsrfHeaderName,v)}i===void 0&&o.setContentType(null),"setRequestHeader"in d&&ce.forEach(o.toJSON(),function(g,m){d.setRequestHeader(m,g)}),ce.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),a&&a!=="json"&&(d.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&d.addEventListener("progress",bI(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",bI(t.onUploadProgress)),(t.cancelToken||t.signal)&&(u=v=>{d&&(r(!v||v.type?new Fp(null,t,d):v),d.abort(),d=null)},t.cancelToken&&t.cancelToken.subscribe(u),t.signal&&(t.signal.aborted?u():t.signal.addEventListener("abort",u)));const h=Hle(f);if(h&&fo.protocols.indexOf(h)===-1){r(new vt("Unsupported protocol "+h+":",vt.ERR_BAD_REQUEST,t));return}d.send(i||null)})},lx={http:ble,xhr:Kle};ce.forEach(lx,(t,n)=>{if(t){try{Object.defineProperty(t,"name",{value:n})}catch{}Object.defineProperty(t,"adapterName",{value:n})}});const wI=t=>`- ${t}`,Xle=t=>ce.isFunction(t)||t===null||t===!1,EB={getAdapter:t=>{t=ce.isArray(t)?t:[t];const{length:n}=t;let e,r;const i={};for(let o=0;o<n;o++){e=t[o];let a;if(r=e,!Xle(e)&&(r=lx[(a=String(e)).toLowerCase()],r===void 0))throw new vt(`Unknown adapter '${a}'`);if(r)break;i[a||"#"+o]=r}if(!r){const o=Object.entries(i).map(([s,u])=>`adapter ${s} `+(u===!1?"is not supported by the environment":"is not available in the build"));let a=n?o.length>1?`since :
`+o.map(wI).join(`
`):" "+wI(o[0]):"as no adapter specified";throw new vt("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:lx};function D1(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Fp(null,t)}function xI(t){return D1(t),t.headers=Yo.from(t.headers),t.data=O1.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),EB.getAdapter(t.adapter||Y2.adapter)(t).then(function(r){return D1(t),r.data=O1.call(t,t.transformResponse,r),r.headers=Yo.from(r.headers),r},function(r){return xB(r)||(D1(t),r&&r.response&&(r.response.data=O1.call(t,t.transformResponse,r.response),r.response.headers=Yo.from(r.response.headers))),Promise.reject(r)})}const SI=t=>t instanceof Yo?t.toJSON():t;function gc(t,n){n=n||{};const e={};function r(l,c,d){return ce.isPlainObject(l)&&ce.isPlainObject(c)?ce.merge.call({caseless:d},l,c):ce.isPlainObject(c)?ce.merge({},c):ce.isArray(c)?c.slice():c}function i(l,c,d){if(ce.isUndefined(c)){if(!ce.isUndefined(l))return r(void 0,l,d)}else return r(l,c,d)}function o(l,c){if(!ce.isUndefined(c))return r(void 0,c)}function a(l,c){if(ce.isUndefined(c)){if(!ce.isUndefined(l))return r(void 0,l)}else return r(void 0,c)}function s(l,c,d){if(d in n)return r(l,c);if(d in t)return r(void 0,l)}const u={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(l,c)=>i(SI(l),SI(c),!0)};return ce.forEach(Object.keys(Object.assign({},t,n)),function(c){const d=u[c]||i,f=d(t[c],n[c],c);ce.isUndefined(f)&&d!==s||(e[c]=f)}),e}const CB="1.6.7",J2={};["object","boolean","number","function","string","symbol"].forEach((t,n)=>{J2[t]=function(r){return typeof r===t||"a"+(n<1?"n ":" ")+t}});const EI={};J2.transitional=function(n,e,r){function i(o,a){return"[Axios v"+CB+"] Transitional option '"+o+"'"+a+(r?". "+r:"")}return(o,a,s)=>{if(n===!1)throw new vt(i(a," has been removed"+(e?" in "+e:"")),vt.ERR_DEPRECATED);return e&&!EI[a]&&(EI[a]=!0,console.warn(i(a," has been deprecated since v"+e+" and will be removed in the near future"))),n?n(o,a,s):!0}};function Yle(t,n,e){if(typeof t!="object")throw new vt("options must be an object",vt.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const o=r[i],a=n[o];if(a){const s=t[o],u=s===void 0||a(s,o,t);if(u!==!0)throw new vt("option "+o+" must be "+u,vt.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new vt("Unknown option "+o,vt.ERR_BAD_OPTION)}}const cx={assertOptions:Yle,validators:J2},ba=cx.validators;class Mv{constructor(n){this.defaults=n,this.interceptors={request:new gI,response:new gI}}async request(n,e){try{return await this._request(n,e)}catch(r){if(r instanceof Error){let i;Error.captureStackTrace?Error.captureStackTrace(i={}):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}throw r}}_request(n,e){typeof n=="string"?(e=e||{},e.url=n):e=n||{},e=gc(this.defaults,e);const{transitional:r,paramsSerializer:i,headers:o}=e;r!==void 0&&cx.assertOptions(r,{silentJSONParsing:ba.transitional(ba.boolean),forcedJSONParsing:ba.transitional(ba.boolean),clarifyTimeoutError:ba.transitional(ba.boolean)},!1),i!=null&&(ce.isFunction(i)?e.paramsSerializer={serialize:i}:cx.assertOptions(i,{encode:ba.function,serialize:ba.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let a=o&&ce.merge(o.common,o[e.method]);o&&ce.forEach(["delete","get","head","post","put","patch","common"],h=>{delete o[h]}),e.headers=Yo.concat(a,o);const s=[];let u=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(e)===!1||(u=u&&v.synchronous,s.unshift(v.fulfilled,v.rejected))});const l=[];this.interceptors.response.forEach(function(v){l.push(v.fulfilled,v.rejected)});let c,d=0,f;if(!u){const h=[xI.bind(this),void 0];for(h.unshift.apply(h,s),h.push.apply(h,l),f=h.length,c=Promise.resolve(e);d<f;)c=c.then(h[d++],h[d++]);return c}f=s.length;let p=e;for(d=0;d<f;){const h=s[d++],v=s[d++];try{p=h(p)}catch(g){v.call(this,g);break}}try{c=xI.call(this,p)}catch(h){return Promise.reject(h)}for(d=0,f=l.length;d<f;)c=c.then(l[d++],l[d++]);return c}getUri(n){n=gc(this.defaults,n);const e=SB(n.baseURL,n.url);return gB(e,n.params,n.paramsSerializer)}}ce.forEach(["delete","get","head","options"],function(n){Mv.prototype[n]=function(e,r){return this.request(gc(r||{},{method:n,url:e,data:(r||{}).data}))}});ce.forEach(["post","put","patch"],function(n){function e(r){return function(o,a,s){return this.request(gc(s||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:a}))}}Mv.prototype[n]=e(),Mv.prototype[n+"Form"]=e(!0)});const Em=Mv;class Q2{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(o){e=o});const r=this;this.promise.then(i=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](i);r._listeners=null}),this.promise.then=i=>{let o;const a=new Promise(s=>{r.subscribe(s),o=s}).then(i);return a.cancel=function(){r.unsubscribe(o)},a},n(function(o,a,s){r.reason||(r.reason=new Fp(o,a,s),e(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const e=this._listeners.indexOf(n);e!==-1&&this._listeners.splice(e,1)}static source(){let n;return{token:new Q2(function(i){n=i}),cancel:n}}}const Jle=Q2;function Qle(t){return function(e){return t.apply(null,e)}}function Zle(t){return ce.isObject(t)&&t.isAxiosError===!0}const dx={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(dx).forEach(([t,n])=>{dx[n]=t});const ece=dx;function RB(t){const n=new Em(t),e=oB(Em.prototype.request,n);return ce.extend(e,Em.prototype,n,{allOwnKeys:!0}),ce.extend(e,n,null,{allOwnKeys:!0}),e.create=function(i){return RB(gc(t,i))},e}const xt=RB(Y2);xt.Axios=Em;xt.CanceledError=Fp;xt.CancelToken=Jle;xt.isCancel=xB;xt.VERSION=CB;xt.toFormData=Vy;xt.AxiosError=vt;xt.Cancel=xt.CanceledError;xt.all=function(n){return Promise.all(n)};xt.spread=Qle;xt.isAxiosError=Zle;xt.mergeConfig=gc;xt.AxiosHeaders=Yo;xt.formToJSON=t=>wB(ce.isHTMLForm(t)?new FormData(t):t);xt.getAdapter=EB.getAdapter;xt.HttpStatusCode=ece;xt.default=xt;const tce=()=>{const t=Si();Er();const{content:n,position:e}=t.state.data,{lat:r,lng:i}=t.state.data.position,o="87246d75e1ce26e1392a087b3d1d88c5",a=co(tue);console.log(n,e);const[s,u]=W.useState([]),[l,c]=W.useState([]),[d,f]=W.useState(""),[p,h]=W.useState(""),v=async()=>{try{const g=await xt.get(`https://api.openweathermap.org/data/2.5/forecast?lat=${r}&lon=${i}&appid=${o}&units=metric&lang=kr`);f(new Date(g.data.city.sunrise*1e3)),h(new Date(g.data.city.sunset*1e3)),c(g.data.list)}catch(g){console.log(g)}finally{a(t.pathname)}};return W.useEffect(()=>{v()},[]),l.length?R.jsxs("div",{className:"FishMapDetailPage",children:[R.jsx(pa,{prevPath:"/fish/map"}),R.jsxs("div",{className:"body",children:[R.jsxs("div",{className:"fishing-info",children:[R.jsxs("div",{className:"fishing-name",children:[R.jsx("h2",{children:n.name}),R.jsx("div",{children:n.type})]}),R.jsx("div",{children:n.addr})]}),R.jsx(zue,{weatherData:l,sunrise:d,sunset:p}),R.jsxs("div",{className:"fish-species",children:[R.jsxs("h3",{className:"name",children:[n.name,"의 주요어종"]}),R.jsx("div",{className:"wrapper",children:n.fishes.map(g=>R.jsxs("div",{children:[R.jsx("img",{src:"https://img.freepik.com/premium-photo/a-colorful-fish-with-a-white-and-blue-tail_899894-16102.jpg"},g),R.jsx("div",{children:g})]},g))})]}),R.jsxs("div",{className:"fishing-reviews",children:[R.jsxs("h3",{className:"name",children:[n.name,"의 리뷰"]}),R.jsx("div",{className:"wrapper",children:s.length?s.map(g=>R.jsxs("div",{children:[R.jsx("img",{src:"https://cdn.iconsumer.or.kr/news/photo/201806/7349_8772_1719.jpg"},g),R.jsx("div",{children:g})]})):R.jsx("div",{className:"none-data",children:"정보를 준비 중입니다."})})]})]})]}):R.jsx(Pc,{})};/*!
 * Cropper.js v1.6.1
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-09-17T03:44:19.860Z
 */function CI(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,r)}return e}function TB(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?CI(Object(e),!0).forEach(function(r){ice(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):CI(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}function fx(t){"@babel/helpers - typeof";return fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},fx(t)}function nce(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function RI(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kB(r.key),r)}}function rce(t,n,e){return n&&RI(t.prototype,n),e&&RI(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function ice(t,n,e){return n=kB(n),n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function NB(t){return oce(t)||ace(t)||sce(t)||uce()}function oce(t){if(Array.isArray(t))return px(t)}function ace(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function sce(t,n){if(t){if(typeof t=="string")return px(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return px(t,n)}}function px(t,n){(n==null||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function uce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lce(t,n){if(typeof t!="object"||t===null)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var r=e.call(t,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function kB(t){var n=lce(t,"string");return typeof n=="symbol"?n:String(n)}var Uy=typeof window<"u"&&typeof window.document<"u",Eo=Uy?window:{},Z2=Uy&&Eo.document.documentElement?"ontouchstart"in Eo.document.documentElement:!1,eR=Uy?"PointerEvent"in Eo:!1,Yt="cropper",tR="all",IB="crop",_B="move",AB="zoom",Ns="e",ks="w",Ju="s",wa="n",wd="ne",xd="nw",Sd="se",Ed="sw",hx="".concat(Yt,"-crop"),TI="".concat(Yt,"-disabled"),kr="".concat(Yt,"-hidden"),NI="".concat(Yt,"-hide"),cce="".concat(Yt,"-invisible"),Pv="".concat(Yt,"-modal"),mx="".concat(Yt,"-move"),qf="".concat(Yt,"Action"),Fh="".concat(Yt,"Preview"),nR="crop",OB="move",DB="none",vx="crop",gx="cropend",yx="cropmove",bx="cropstart",kI="dblclick",dce=Z2?"touchstart":"mousedown",fce=Z2?"touchmove":"mousemove",pce=Z2?"touchend touchcancel":"mouseup",II=eR?"pointerdown":dce,_I=eR?"pointermove":fce,AI=eR?"pointerup pointercancel":pce,OI="ready",DI="resize",MI="wheel",wx="zoom",PI="image/jpeg",hce=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,mce=/^data:/,vce=/^data:image\/jpeg;base64,/,gce=/^img|canvas$/i,MB=200,PB=100,LI={viewMode:0,dragMode:nR,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:MB,minContainerHeight:PB,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},yce='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',bce=Number.isNaN||Eo.isNaN;function ct(t){return typeof t=="number"&&!bce(t)}var FI=function(n){return n>0&&n<1/0};function M1(t){return typeof t>"u"}function bu(t){return fx(t)==="object"&&t!==null}var wce=Object.prototype.hasOwnProperty;function wl(t){if(!bu(t))return!1;try{var n=t.constructor,e=n.prototype;return n&&e&&wce.call(e,"isPrototypeOf")}catch{return!1}}function Tr(t){return typeof t=="function"}var xce=Array.prototype.slice;function LB(t){return Array.from?Array.from(t):xce.call(t)}function Sn(t,n){return t&&Tr(n)&&(Array.isArray(t)||ct(t.length)?LB(t).forEach(function(e,r){n.call(t,e,r,t)}):bu(t)&&Object.keys(t).forEach(function(e){n.call(t,t[e],e,t)})),t}var Jt=Object.assign||function(n){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return bu(n)&&r.length>0&&r.forEach(function(o){bu(o)&&Object.keys(o).forEach(function(a){n[a]=o[a]})}),n},Sce=/\.\d*(?:0|9){12}\d*$/;function Fl(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Sce.test(t)?Math.round(t*n)/n:t}var Ece=/^width|height|left|top|marginLeft|marginTop$/;function ja(t,n){var e=t.style;Sn(n,function(r,i){Ece.test(i)&&ct(r)&&(r="".concat(r,"px")),e[i]=r})}function Cce(t,n){return t.classList?t.classList.contains(n):t.className.indexOf(n)>-1}function Pn(t,n){if(n){if(ct(t.length)){Sn(t,function(r){Pn(r,n)});return}if(t.classList){t.classList.add(n);return}var e=t.className.trim();e?e.indexOf(n)<0&&(t.className="".concat(e," ").concat(n)):t.className=n}}function bo(t,n){if(n){if(ct(t.length)){Sn(t,function(e){bo(e,n)});return}if(t.classList){t.classList.remove(n);return}t.className.indexOf(n)>=0&&(t.className=t.className.replace(n,""))}}function xl(t,n,e){if(n){if(ct(t.length)){Sn(t,function(r){xl(r,n,e)});return}e?Pn(t,n):bo(t,n)}}var Rce=/([a-z\d])([A-Z])/g;function rR(t){return t.replace(Rce,"$1-$2").toLowerCase()}function xx(t,n){return bu(t[n])?t[n]:t.dataset?t.dataset[n]:t.getAttribute("data-".concat(rR(n)))}function Kf(t,n,e){bu(e)?t[n]=e:t.dataset?t.dataset[n]=e:t.setAttribute("data-".concat(rR(n)),e)}function Tce(t,n){if(bu(t[n]))try{delete t[n]}catch{t[n]=void 0}else if(t.dataset)try{delete t.dataset[n]}catch{t.dataset[n]=void 0}else t.removeAttribute("data-".concat(rR(n)))}var FB=/\s\s*/,zB=function(){var t=!1;if(Uy){var n=!1,e=function(){},r=Object.defineProperty({},"once",{get:function(){return t=!0,n},set:function(o){n=o}});Eo.addEventListener("test",e,r),Eo.removeEventListener("test",e,r)}return t}();function Ni(t,n,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=e;n.trim().split(FB).forEach(function(o){if(!zB){var a=t.listeners;a&&a[o]&&a[o][e]&&(i=a[o][e],delete a[o][e],Object.keys(a[o]).length===0&&delete a[o],Object.keys(a).length===0&&delete t.listeners)}t.removeEventListener(o,i,r)})}function fi(t,n,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=e;n.trim().split(FB).forEach(function(o){if(r.once&&!zB){var a=t.listeners,s=a===void 0?{}:a;i=function(){delete s[o][e],t.removeEventListener(o,i,r);for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];e.apply(t,c)},s[o]||(s[o]={}),s[o][e]&&t.removeEventListener(o,s[o][e],r),s[o][e]=i,t.listeners=s}t.addEventListener(o,i,r)})}function zl(t,n,e){var r;return Tr(Event)&&Tr(CustomEvent)?r=new CustomEvent(n,{detail:e,bubbles:!0,cancelable:!0}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(n,!0,!0,e)),t.dispatchEvent(r)}function BB(t){var n=t.getBoundingClientRect();return{left:n.left+(window.pageXOffset-document.documentElement.clientLeft),top:n.top+(window.pageYOffset-document.documentElement.clientTop)}}var P1=Eo.location,Nce=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function zI(t){var n=t.match(Nce);return n!==null&&(n[1]!==P1.protocol||n[2]!==P1.hostname||n[3]!==P1.port)}function BI(t){var n="timestamp=".concat(new Date().getTime());return t+(t.indexOf("?")===-1?"?":"&")+n}function af(t){var n=t.rotate,e=t.scaleX,r=t.scaleY,i=t.translateX,o=t.translateY,a=[];ct(i)&&i!==0&&a.push("translateX(".concat(i,"px)")),ct(o)&&o!==0&&a.push("translateY(".concat(o,"px)")),ct(n)&&n!==0&&a.push("rotate(".concat(n,"deg)")),ct(e)&&e!==1&&a.push("scaleX(".concat(e,")")),ct(r)&&r!==1&&a.push("scaleY(".concat(r,")"));var s=a.length?a.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function kce(t){var n=TB({},t),e=0;return Sn(t,function(r,i){delete n[i],Sn(n,function(o){var a=Math.abs(r.startX-o.startX),s=Math.abs(r.startY-o.startY),u=Math.abs(r.endX-o.endX),l=Math.abs(r.endY-o.endY),c=Math.sqrt(a*a+s*s),d=Math.sqrt(u*u+l*l),f=(d-c)/c;Math.abs(f)>Math.abs(e)&&(e=f)})}),e}function zh(t,n){var e=t.pageX,r=t.pageY,i={endX:e,endY:r};return n?i:TB({startX:e,startY:r},i)}function Ice(t){var n=0,e=0,r=0;return Sn(t,function(i){var o=i.startX,a=i.startY;n+=o,e+=a,r+=1}),n/=r,e/=r,{pageX:n,pageY:e}}function Va(t){var n=t.aspectRatio,e=t.height,r=t.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",o=FI(r),a=FI(e);if(o&&a){var s=e*n;i==="contain"&&s>r||i==="cover"&&s<r?e=r/n:r=e*n}else o?e=r/n:a&&(r=e*n);return{width:r,height:e}}function _ce(t){var n=t.width,e=t.height,r=t.degree;if(r=Math.abs(r)%180,r===90)return{width:e,height:n};var i=r%90*Math.PI/180,o=Math.sin(i),a=Math.cos(i),s=n*a+e*o,u=n*o+e*a;return r>90?{width:u,height:s}:{width:s,height:u}}function Ace(t,n,e,r){var i=n.aspectRatio,o=n.naturalWidth,a=n.naturalHeight,s=n.rotate,u=s===void 0?0:s,l=n.scaleX,c=l===void 0?1:l,d=n.scaleY,f=d===void 0?1:d,p=e.aspectRatio,h=e.naturalWidth,v=e.naturalHeight,g=r.fillColor,m=g===void 0?"transparent":g,y=r.imageSmoothingEnabled,b=y===void 0?!0:y,w=r.imageSmoothingQuality,x=w===void 0?"low":w,C=r.maxWidth,E=C===void 0?1/0:C,S=r.maxHeight,k=S===void 0?1/0:S,N=r.minWidth,M=N===void 0?0:N,D=r.minHeight,T=D===void 0?0:D,O=document.createElement("canvas"),P=O.getContext("2d"),A=Va({aspectRatio:p,width:E,height:k}),I=Va({aspectRatio:p,width:M,height:T},"cover"),_=Math.min(A.width,Math.max(I.width,h)),F=Math.min(A.height,Math.max(I.height,v)),L=Va({aspectRatio:i,width:E,height:k}),H=Va({aspectRatio:i,width:M,height:T},"cover"),B=Math.min(L.width,Math.max(H.width,o)),q=Math.min(L.height,Math.max(H.height,a)),G=[-B/2,-q/2,B,q];return O.width=Fl(_),O.height=Fl(F),P.fillStyle=m,P.fillRect(0,0,_,F),P.save(),P.translate(_/2,F/2),P.rotate(u*Math.PI/180),P.scale(c,f),P.imageSmoothingEnabled=b,P.imageSmoothingQuality=x,P.drawImage.apply(P,[t].concat(NB(G.map(function(re){return Math.floor(Fl(re))})))),P.restore(),O}var jB=String.fromCharCode;function Oce(t,n,e){var r="";e+=n;for(var i=n;i<e;i+=1)r+=jB(t.getUint8(i));return r}var Dce=/^data:.*,/;function Mce(t){var n=t.replace(Dce,""),e=atob(n),r=new ArrayBuffer(e.length),i=new Uint8Array(r);return Sn(i,function(o,a){i[a]=e.charCodeAt(a)}),r}function Pce(t,n){for(var e=[],r=8192,i=new Uint8Array(t);i.length>0;)e.push(jB.apply(null,LB(i.subarray(0,r)))),i=i.subarray(r);return"data:".concat(n,";base64,").concat(btoa(e.join("")))}function Lce(t){var n=new DataView(t),e;try{var r,i,o;if(n.getUint8(0)===255&&n.getUint8(1)===216)for(var a=n.byteLength,s=2;s+1<a;){if(n.getUint8(s)===255&&n.getUint8(s+1)===225){i=s;break}s+=1}if(i){var u=i+4,l=i+10;if(Oce(n,u,4)==="Exif"){var c=n.getUint16(l);if(r=c===18761,(r||c===19789)&&n.getUint16(l+2,r)===42){var d=n.getUint32(l+4,r);d>=8&&(o=l+d)}}}if(o){var f=n.getUint16(o,r),p,h;for(h=0;h<f;h+=1)if(p=o+h*12+2,n.getUint16(p,r)===274){p+=8,e=n.getUint16(p,r),n.setUint16(p,1,r);break}}}catch{e=1}return e}function Fce(t){var n=0,e=1,r=1;switch(t){case 2:e=-1;break;case 3:n=-180;break;case 4:r=-1;break;case 5:n=90,r=-1;break;case 6:n=90;break;case 7:n=90,e=-1;break;case 8:n=-90;break}return{rotate:n,scaleX:e,scaleY:r}}var zce={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var n=this.element,e=this.options,r=this.container,i=this.cropper,o=Number(e.minContainerWidth),a=Number(e.minContainerHeight);Pn(i,kr),bo(n,kr);var s={width:Math.max(r.offsetWidth,o>=0?o:MB),height:Math.max(r.offsetHeight,a>=0?a:PB)};this.containerData=s,ja(i,{width:s.width,height:s.height}),Pn(n,kr),bo(i,kr)},initCanvas:function(){var n=this.containerData,e=this.imageData,r=this.options.viewMode,i=Math.abs(e.rotate)%180===90,o=i?e.naturalHeight:e.naturalWidth,a=i?e.naturalWidth:e.naturalHeight,s=o/a,u=n.width,l=n.height;n.height*s>n.width?r===3?u=n.height*s:l=n.width/s:r===3?l=n.width/s:u=n.height*s;var c={aspectRatio:s,naturalWidth:o,naturalHeight:a,width:u,height:l};this.canvasData=c,this.limited=r===1||r===2,this.limitCanvas(!0,!0),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),c.left=(n.width-c.width)/2,c.top=(n.height-c.height)/2,c.oldLeft=c.left,c.oldTop=c.top,this.initialCanvasData=Jt({},c)},limitCanvas:function(n,e){var r=this.options,i=this.containerData,o=this.canvasData,a=this.cropBoxData,s=r.viewMode,u=o.aspectRatio,l=this.cropped&&a;if(n){var c=Number(r.minCanvasWidth)||0,d=Number(r.minCanvasHeight)||0;s>1?(c=Math.max(c,i.width),d=Math.max(d,i.height),s===3&&(d*u>c?c=d*u:d=c/u)):s>0&&(c?c=Math.max(c,l?a.width:0):d?d=Math.max(d,l?a.height:0):l&&(c=a.width,d=a.height,d*u>c?c=d*u:d=c/u));var f=Va({aspectRatio:u,width:c,height:d});c=f.width,d=f.height,o.minWidth=c,o.minHeight=d,o.maxWidth=1/0,o.maxHeight=1/0}if(e)if(s>(l?0:1)){var p=i.width-o.width,h=i.height-o.height;o.minLeft=Math.min(0,p),o.minTop=Math.min(0,h),o.maxLeft=Math.max(0,p),o.maxTop=Math.max(0,h),l&&this.limited&&(o.minLeft=Math.min(a.left,a.left+(a.width-o.width)),o.minTop=Math.min(a.top,a.top+(a.height-o.height)),o.maxLeft=a.left,o.maxTop=a.top,s===2&&(o.width>=i.width&&(o.minLeft=Math.min(0,p),o.maxLeft=Math.max(0,p)),o.height>=i.height&&(o.minTop=Math.min(0,h),o.maxTop=Math.max(0,h))))}else o.minLeft=-o.width,o.minTop=-o.height,o.maxLeft=i.width,o.maxTop=i.height},renderCanvas:function(n,e){var r=this.canvasData,i=this.imageData;if(e){var o=_ce({width:i.naturalWidth*Math.abs(i.scaleX||1),height:i.naturalHeight*Math.abs(i.scaleY||1),degree:i.rotate||0}),a=o.width,s=o.height,u=r.width*(a/r.naturalWidth),l=r.height*(s/r.naturalHeight);r.left-=(u-r.width)/2,r.top-=(l-r.height)/2,r.width=u,r.height=l,r.aspectRatio=a/s,r.naturalWidth=a,r.naturalHeight=s,this.limitCanvas(!0,!1)}(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCanvas(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,ja(this.canvas,Jt({width:r.width,height:r.height},af({translateX:r.left,translateY:r.top}))),this.renderImage(n),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(n){var e=this.canvasData,r=this.imageData,i=r.naturalWidth*(e.width/e.naturalWidth),o=r.naturalHeight*(e.height/e.naturalHeight);Jt(r,{width:i,height:o,left:(e.width-i)/2,top:(e.height-o)/2}),ja(this.image,Jt({width:r.width,height:r.height},af(Jt({translateX:r.left,translateY:r.top},r)))),n&&this.output()},initCropBox:function(){var n=this.options,e=this.canvasData,r=n.aspectRatio||n.initialAspectRatio,i=Number(n.autoCropArea)||.8,o={width:e.width,height:e.height};r&&(e.height*r>e.width?o.height=o.width/r:o.width=o.height*r),this.cropBoxData=o,this.limitCropBox(!0,!0),o.width=Math.min(Math.max(o.width,o.minWidth),o.maxWidth),o.height=Math.min(Math.max(o.height,o.minHeight),o.maxHeight),o.width=Math.max(o.minWidth,o.width*i),o.height=Math.max(o.minHeight,o.height*i),o.left=e.left+(e.width-o.width)/2,o.top=e.top+(e.height-o.height)/2,o.oldLeft=o.left,o.oldTop=o.top,this.initialCropBoxData=Jt({},o)},limitCropBox:function(n,e){var r=this.options,i=this.containerData,o=this.canvasData,a=this.cropBoxData,s=this.limited,u=r.aspectRatio;if(n){var l=Number(r.minCropBoxWidth)||0,c=Number(r.minCropBoxHeight)||0,d=s?Math.min(i.width,o.width,o.width+o.left,i.width-o.left):i.width,f=s?Math.min(i.height,o.height,o.height+o.top,i.height-o.top):i.height;l=Math.min(l,i.width),c=Math.min(c,i.height),u&&(l&&c?c*u>l?c=l/u:l=c*u:l?c=l/u:c&&(l=c*u),f*u>d?f=d/u:d=f*u),a.minWidth=Math.min(l,d),a.minHeight=Math.min(c,f),a.maxWidth=d,a.maxHeight=f}e&&(s?(a.minLeft=Math.max(0,o.left),a.minTop=Math.max(0,o.top),a.maxLeft=Math.min(i.width,o.left+o.width)-a.width,a.maxTop=Math.min(i.height,o.top+o.height)-a.height):(a.minLeft=0,a.minTop=0,a.maxLeft=i.width-a.width,a.maxTop=i.height-a.height))},renderCropBox:function(){var n=this.options,e=this.containerData,r=this.cropBoxData;(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCropBox(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,n.movable&&n.cropBoxMovable&&Kf(this.face,qf,r.width>=e.width&&r.height>=e.height?_B:tR),ja(this.cropBox,Jt({width:r.width,height:r.height},af({translateX:r.left,translateY:r.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),zl(this.element,vx,this.getData())}},Bce={initPreview:function(){var n=this.element,e=this.crossOrigin,r=this.options.preview,i=e?this.crossOriginUrl:this.url,o=n.alt||"The image to preview",a=document.createElement("img");if(e&&(a.crossOrigin=e),a.src=i,a.alt=o,this.viewBox.appendChild(a),this.viewBoxImage=a,!!r){var s=r;typeof r=="string"?s=n.ownerDocument.querySelectorAll(r):r.querySelector&&(s=[r]),this.previews=s,Sn(s,function(u){var l=document.createElement("img");Kf(u,Fh,{width:u.offsetWidth,height:u.offsetHeight,html:u.innerHTML}),e&&(l.crossOrigin=e),l.src=i,l.alt=o,l.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',u.innerHTML="",u.appendChild(l)})}},resetPreview:function(){Sn(this.previews,function(n){var e=xx(n,Fh);ja(n,{width:e.width,height:e.height}),n.innerHTML=e.html,Tce(n,Fh)})},preview:function(){var n=this.imageData,e=this.canvasData,r=this.cropBoxData,i=r.width,o=r.height,a=n.width,s=n.height,u=r.left-e.left-n.left,l=r.top-e.top-n.top;!this.cropped||this.disabled||(ja(this.viewBoxImage,Jt({width:a,height:s},af(Jt({translateX:-u,translateY:-l},n)))),Sn(this.previews,function(c){var d=xx(c,Fh),f=d.width,p=d.height,h=f,v=p,g=1;i&&(g=f/i,v=o*g),o&&v>p&&(g=p/o,h=i*g,v=p),ja(c,{width:h,height:v}),ja(c.getElementsByTagName("img")[0],Jt({width:a*g,height:s*g},af(Jt({translateX:-u*g,translateY:-l*g},n))))}))}},jce={bind:function(){var n=this.element,e=this.options,r=this.cropper;Tr(e.cropstart)&&fi(n,bx,e.cropstart),Tr(e.cropmove)&&fi(n,yx,e.cropmove),Tr(e.cropend)&&fi(n,gx,e.cropend),Tr(e.crop)&&fi(n,vx,e.crop),Tr(e.zoom)&&fi(n,wx,e.zoom),fi(r,II,this.onCropStart=this.cropStart.bind(this)),e.zoomable&&e.zoomOnWheel&&fi(r,MI,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&fi(r,kI,this.onDblclick=this.dblclick.bind(this)),fi(n.ownerDocument,_I,this.onCropMove=this.cropMove.bind(this)),fi(n.ownerDocument,AI,this.onCropEnd=this.cropEnd.bind(this)),e.responsive&&fi(window,DI,this.onResize=this.resize.bind(this))},unbind:function(){var n=this.element,e=this.options,r=this.cropper;Tr(e.cropstart)&&Ni(n,bx,e.cropstart),Tr(e.cropmove)&&Ni(n,yx,e.cropmove),Tr(e.cropend)&&Ni(n,gx,e.cropend),Tr(e.crop)&&Ni(n,vx,e.crop),Tr(e.zoom)&&Ni(n,wx,e.zoom),Ni(r,II,this.onCropStart),e.zoomable&&e.zoomOnWheel&&Ni(r,MI,this.onWheel,{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&Ni(r,kI,this.onDblclick),Ni(n.ownerDocument,_I,this.onCropMove),Ni(n.ownerDocument,AI,this.onCropEnd),e.responsive&&Ni(window,DI,this.onResize)}},Vce={resize:function(){if(!this.disabled){var n=this.options,e=this.container,r=this.containerData,i=e.offsetWidth/r.width,o=e.offsetHeight/r.height,a=Math.abs(i-1)>Math.abs(o-1)?i:o;if(a!==1){var s,u;n.restore&&(s=this.getCanvasData(),u=this.getCropBoxData()),this.render(),n.restore&&(this.setCanvasData(Sn(s,function(l,c){s[c]=l*a})),this.setCropBoxData(Sn(u,function(l,c){u[c]=l*a})))}}},dblclick:function(){this.disabled||this.options.dragMode===DB||this.setDragMode(Cce(this.dragBox,hx)?OB:nR)},wheel:function(n){var e=this,r=Number(this.options.wheelZoomRatio)||.1,i=1;this.disabled||(n.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){e.wheeling=!1},50),n.deltaY?i=n.deltaY>0?1:-1:n.wheelDelta?i=-n.wheelDelta/120:n.detail&&(i=n.detail>0?1:-1),this.zoom(-i*r,n)))},cropStart:function(n){var e=n.buttons,r=n.button;if(!(this.disabled||(n.type==="mousedown"||n.type==="pointerdown"&&n.pointerType==="mouse")&&(ct(e)&&e!==1||ct(r)&&r!==0||n.ctrlKey))){var i=this.options,o=this.pointers,a;n.changedTouches?Sn(n.changedTouches,function(s){o[s.identifier]=zh(s)}):o[n.pointerId||0]=zh(n),Object.keys(o).length>1&&i.zoomable&&i.zoomOnTouch?a=AB:a=xx(n.target,qf),hce.test(a)&&zl(this.element,bx,{originalEvent:n,action:a})!==!1&&(n.preventDefault(),this.action=a,this.cropping=!1,a===IB&&(this.cropping=!0,Pn(this.dragBox,Pv)))}},cropMove:function(n){var e=this.action;if(!(this.disabled||!e)){var r=this.pointers;n.preventDefault(),zl(this.element,yx,{originalEvent:n,action:e})!==!1&&(n.changedTouches?Sn(n.changedTouches,function(i){Jt(r[i.identifier]||{},zh(i,!0))}):Jt(r[n.pointerId||0]||{},zh(n,!0)),this.change(n))}},cropEnd:function(n){if(!this.disabled){var e=this.action,r=this.pointers;n.changedTouches?Sn(n.changedTouches,function(i){delete r[i.identifier]}):delete r[n.pointerId||0],e&&(n.preventDefault(),Object.keys(r).length||(this.action=""),this.cropping&&(this.cropping=!1,xl(this.dragBox,Pv,this.cropped&&this.options.modal)),zl(this.element,gx,{originalEvent:n,action:e}))}}},$ce={change:function(n){var e=this.options,r=this.canvasData,i=this.containerData,o=this.cropBoxData,a=this.pointers,s=this.action,u=e.aspectRatio,l=o.left,c=o.top,d=o.width,f=o.height,p=l+d,h=c+f,v=0,g=0,m=i.width,y=i.height,b=!0,w;!u&&n.shiftKey&&(u=d&&f?d/f:1),this.limited&&(v=o.minLeft,g=o.minTop,m=v+Math.min(i.width,r.width,r.left+r.width),y=g+Math.min(i.height,r.height,r.top+r.height));var x=a[Object.keys(a)[0]],C={x:x.endX-x.startX,y:x.endY-x.startY},E=function(k){switch(k){case Ns:p+C.x>m&&(C.x=m-p);break;case ks:l+C.x<v&&(C.x=v-l);break;case wa:c+C.y<g&&(C.y=g-c);break;case Ju:h+C.y>y&&(C.y=y-h);break}};switch(s){case tR:l+=C.x,c+=C.y;break;case Ns:if(C.x>=0&&(p>=m||u&&(c<=g||h>=y))){b=!1;break}E(Ns),d+=C.x,d<0&&(s=ks,d=-d,l-=d),u&&(f=d/u,c+=(o.height-f)/2);break;case wa:if(C.y<=0&&(c<=g||u&&(l<=v||p>=m))){b=!1;break}E(wa),f-=C.y,c+=C.y,f<0&&(s=Ju,f=-f,c-=f),u&&(d=f*u,l+=(o.width-d)/2);break;case ks:if(C.x<=0&&(l<=v||u&&(c<=g||h>=y))){b=!1;break}E(ks),d-=C.x,l+=C.x,d<0&&(s=Ns,d=-d,l-=d),u&&(f=d/u,c+=(o.height-f)/2);break;case Ju:if(C.y>=0&&(h>=y||u&&(l<=v||p>=m))){b=!1;break}E(Ju),f+=C.y,f<0&&(s=wa,f=-f,c-=f),u&&(d=f*u,l+=(o.width-d)/2);break;case wd:if(u){if(C.y<=0&&(c<=g||p>=m)){b=!1;break}E(wa),f-=C.y,c+=C.y,d=f*u}else E(wa),E(Ns),C.x>=0?p<m?d+=C.x:C.y<=0&&c<=g&&(b=!1):d+=C.x,C.y<=0?c>g&&(f-=C.y,c+=C.y):(f-=C.y,c+=C.y);d<0&&f<0?(s=Ed,f=-f,d=-d,c-=f,l-=d):d<0?(s=xd,d=-d,l-=d):f<0&&(s=Sd,f=-f,c-=f);break;case xd:if(u){if(C.y<=0&&(c<=g||l<=v)){b=!1;break}E(wa),f-=C.y,c+=C.y,d=f*u,l+=o.width-d}else E(wa),E(ks),C.x<=0?l>v?(d-=C.x,l+=C.x):C.y<=0&&c<=g&&(b=!1):(d-=C.x,l+=C.x),C.y<=0?c>g&&(f-=C.y,c+=C.y):(f-=C.y,c+=C.y);d<0&&f<0?(s=Sd,f=-f,d=-d,c-=f,l-=d):d<0?(s=wd,d=-d,l-=d):f<0&&(s=Ed,f=-f,c-=f);break;case Ed:if(u){if(C.x<=0&&(l<=v||h>=y)){b=!1;break}E(ks),d-=C.x,l+=C.x,f=d/u}else E(Ju),E(ks),C.x<=0?l>v?(d-=C.x,l+=C.x):C.y>=0&&h>=y&&(b=!1):(d-=C.x,l+=C.x),C.y>=0?h<y&&(f+=C.y):f+=C.y;d<0&&f<0?(s=wd,f=-f,d=-d,c-=f,l-=d):d<0?(s=Sd,d=-d,l-=d):f<0&&(s=xd,f=-f,c-=f);break;case Sd:if(u){if(C.x>=0&&(p>=m||h>=y)){b=!1;break}E(Ns),d+=C.x,f=d/u}else E(Ju),E(Ns),C.x>=0?p<m?d+=C.x:C.y>=0&&h>=y&&(b=!1):d+=C.x,C.y>=0?h<y&&(f+=C.y):f+=C.y;d<0&&f<0?(s=xd,f=-f,d=-d,c-=f,l-=d):d<0?(s=Ed,d=-d,l-=d):f<0&&(s=wd,f=-f,c-=f);break;case _B:this.move(C.x,C.y),b=!1;break;case AB:this.zoom(kce(a),n),b=!1;break;case IB:if(!C.x||!C.y){b=!1;break}w=BB(this.cropper),l=x.startX-w.left,c=x.startY-w.top,d=o.minWidth,f=o.minHeight,C.x>0?s=C.y>0?Sd:wd:C.x<0&&(l-=d,s=C.y>0?Ed:xd),C.y<0&&(c-=f),this.cropped||(bo(this.cropBox,kr),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}b&&(o.width=d,o.height=f,o.left=l,o.top=c,this.action=s,this.renderCropBox()),Sn(a,function(S){S.startX=S.endX,S.startY=S.endY})}},Uce={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&Pn(this.dragBox,Pv),bo(this.cropBox,kr),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=Jt({},this.initialImageData),this.canvasData=Jt({},this.initialCanvasData),this.cropBoxData=Jt({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(Jt(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),bo(this.dragBox,Pv),Pn(this.cropBox,kr)),this},replace:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&n&&(this.isImg&&(this.element.src=n),e?(this.url=n,this.image.src=n,this.ready&&(this.viewBoxImage.src=n,Sn(this.previews,function(r){r.getElementsByTagName("img")[0].src=n}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(n))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,bo(this.cropper,TI)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,Pn(this.cropper,TI)),this},destroy:function(){var n=this.element;return n[Yt]?(n[Yt]=void 0,this.isImg&&this.replaced&&(n.src=this.originalUrl),this.uncreate(),this):this},move:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,r=this.canvasData,i=r.left,o=r.top;return this.moveTo(M1(n)?n:i+Number(n),M1(e)?e:o+Number(e))},moveTo:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,r=this.canvasData,i=!1;return n=Number(n),e=Number(e),this.ready&&!this.disabled&&this.options.movable&&(ct(n)&&(r.left=n,i=!0),ct(e)&&(r.top=e,i=!0),i&&this.renderCanvas(!0)),this},zoom:function(n,e){var r=this.canvasData;return n=Number(n),n<0?n=1/(1-n):n=1+n,this.zoomTo(r.width*n/r.naturalWidth,null,e)},zoomTo:function(n,e,r){var i=this.options,o=this.canvasData,a=o.width,s=o.height,u=o.naturalWidth,l=o.naturalHeight;if(n=Number(n),n>=0&&this.ready&&!this.disabled&&i.zoomable){var c=u*n,d=l*n;if(zl(this.element,wx,{ratio:n,oldRatio:a/u,originalEvent:r})===!1)return this;if(r){var f=this.pointers,p=BB(this.cropper),h=f&&Object.keys(f).length?Ice(f):{pageX:r.pageX,pageY:r.pageY};o.left-=(c-a)*((h.pageX-p.left-o.left)/a),o.top-=(d-s)*((h.pageY-p.top-o.top)/s)}else wl(e)&&ct(e.x)&&ct(e.y)?(o.left-=(c-a)*((e.x-o.left)/a),o.top-=(d-s)*((e.y-o.top)/s)):(o.left-=(c-a)/2,o.top-=(d-s)/2);o.width=c,o.height=d,this.renderCanvas(!0)}return this},rotate:function(n){return this.rotateTo((this.imageData.rotate||0)+Number(n))},rotateTo:function(n){return n=Number(n),ct(n)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=n%360,this.renderCanvas(!0,!0)),this},scaleX:function(n){var e=this.imageData.scaleY;return this.scale(n,ct(e)?e:1)},scaleY:function(n){var e=this.imageData.scaleX;return this.scale(ct(e)?e:1,n)},scale:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,r=this.imageData,i=!1;return n=Number(n),e=Number(e),this.ready&&!this.disabled&&this.options.scalable&&(ct(n)&&(r.scaleX=n,i=!0),ct(e)&&(r.scaleY=e,i=!0),i&&this.renderCanvas(!0,!0)),this},getData:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.options,r=this.imageData,i=this.canvasData,o=this.cropBoxData,a;if(this.ready&&this.cropped){a={x:o.left-i.left,y:o.top-i.top,width:o.width,height:o.height};var s=r.width/r.naturalWidth;if(Sn(a,function(c,d){a[d]=c/s}),n){var u=Math.round(a.y+a.height),l=Math.round(a.x+a.width);a.x=Math.round(a.x),a.y=Math.round(a.y),a.width=l-a.x,a.height=u-a.y}}else a={x:0,y:0,width:0,height:0};return e.rotatable&&(a.rotate=r.rotate||0),e.scalable&&(a.scaleX=r.scaleX||1,a.scaleY=r.scaleY||1),a},setData:function(n){var e=this.options,r=this.imageData,i=this.canvasData,o={};if(this.ready&&!this.disabled&&wl(n)){var a=!1;e.rotatable&&ct(n.rotate)&&n.rotate!==r.rotate&&(r.rotate=n.rotate,a=!0),e.scalable&&(ct(n.scaleX)&&n.scaleX!==r.scaleX&&(r.scaleX=n.scaleX,a=!0),ct(n.scaleY)&&n.scaleY!==r.scaleY&&(r.scaleY=n.scaleY,a=!0)),a&&this.renderCanvas(!0,!0);var s=r.width/r.naturalWidth;ct(n.x)&&(o.left=n.x*s+i.left),ct(n.y)&&(o.top=n.y*s+i.top),ct(n.width)&&(o.width=n.width*s),ct(n.height)&&(o.height=n.height*s),this.setCropBoxData(o)}return this},getContainerData:function(){return this.ready?Jt({},this.containerData):{}},getImageData:function(){return this.sized?Jt({},this.imageData):{}},getCanvasData:function(){var n=this.canvasData,e={};return this.ready&&Sn(["left","top","width","height","naturalWidth","naturalHeight"],function(r){e[r]=n[r]}),e},setCanvasData:function(n){var e=this.canvasData,r=e.aspectRatio;return this.ready&&!this.disabled&&wl(n)&&(ct(n.left)&&(e.left=n.left),ct(n.top)&&(e.top=n.top),ct(n.width)?(e.width=n.width,e.height=n.width/r):ct(n.height)&&(e.height=n.height,e.width=n.height*r),this.renderCanvas(!0)),this},getCropBoxData:function(){var n=this.cropBoxData,e;return this.ready&&this.cropped&&(e={left:n.left,top:n.top,width:n.width,height:n.height}),e||{}},setCropBoxData:function(n){var e=this.cropBoxData,r=this.options.aspectRatio,i,o;return this.ready&&this.cropped&&!this.disabled&&wl(n)&&(ct(n.left)&&(e.left=n.left),ct(n.top)&&(e.top=n.top),ct(n.width)&&n.width!==e.width&&(i=!0,e.width=n.width),ct(n.height)&&n.height!==e.height&&(o=!0,e.height=n.height),r&&(i?e.height=e.width/r:o&&(e.width=e.height*r)),this.renderCropBox()),this},getCroppedCanvas:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var e=this.canvasData,r=Ace(this.image,this.imageData,e,n);if(!this.cropped)return r;var i=this.getData(n.rounded),o=i.x,a=i.y,s=i.width,u=i.height,l=r.width/Math.floor(e.naturalWidth);l!==1&&(o*=l,a*=l,s*=l,u*=l);var c=s/u,d=Va({aspectRatio:c,width:n.maxWidth||1/0,height:n.maxHeight||1/0}),f=Va({aspectRatio:c,width:n.minWidth||0,height:n.minHeight||0},"cover"),p=Va({aspectRatio:c,width:n.width||(l!==1?r.width:s),height:n.height||(l!==1?r.height:u)}),h=p.width,v=p.height;h=Math.min(d.width,Math.max(f.width,h)),v=Math.min(d.height,Math.max(f.height,v));var g=document.createElement("canvas"),m=g.getContext("2d");g.width=Fl(h),g.height=Fl(v),m.fillStyle=n.fillColor||"transparent",m.fillRect(0,0,h,v);var y=n.imageSmoothingEnabled,b=y===void 0?!0:y,w=n.imageSmoothingQuality;m.imageSmoothingEnabled=b,w&&(m.imageSmoothingQuality=w);var x=r.width,C=r.height,E=o,S=a,k,N,M,D,T,O;E<=-s||E>x?(E=0,k=0,M=0,T=0):E<=0?(M=-E,E=0,k=Math.min(x,s+E),T=k):E<=x&&(M=0,k=Math.min(s,x-E),T=k),k<=0||S<=-u||S>C?(S=0,N=0,D=0,O=0):S<=0?(D=-S,S=0,N=Math.min(C,u+S),O=N):S<=C&&(D=0,N=Math.min(u,C-S),O=N);var P=[E,S,k,N];if(T>0&&O>0){var A=h/s;P.push(M*A,D*A,T*A,O*A)}return m.drawImage.apply(m,[r].concat(NB(P.map(function(I){return Math.floor(Fl(I))})))),g},setAspectRatio:function(n){var e=this.options;return!this.disabled&&!M1(n)&&(e.aspectRatio=Math.max(0,n)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(n){var e=this.options,r=this.dragBox,i=this.face;if(this.ready&&!this.disabled){var o=n===nR,a=e.movable&&n===OB;n=o||a?n:DB,e.dragMode=n,Kf(r,qf,n),xl(r,hx,o),xl(r,mx,a),e.cropBoxMovable||(Kf(i,qf,n),xl(i,hx,o),xl(i,mx,a))}return this}},Wce=Eo.Cropper,VB=function(){function t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(nce(this,t),!n||!gce.test(n.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=n,this.options=Jt({},LI,wl(e)&&e),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return rce(t,[{key:"init",value:function(){var e=this.element,r=e.tagName.toLowerCase(),i;if(!e[Yt]){if(e[Yt]=this,r==="img"){if(this.isImg=!0,i=e.getAttribute("src")||"",this.originalUrl=i,!i)return;i=e.src}else r==="canvas"&&window.HTMLCanvasElement&&(i=e.toDataURL());this.load(i)}}},{key:"load",value:function(e){var r=this;if(e){this.url=e,this.imageData={};var i=this.element,o=this.options;if(!o.rotatable&&!o.scalable&&(o.checkOrientation=!1),!o.checkOrientation||!window.ArrayBuffer){this.clone();return}if(mce.test(e)){vce.test(e)?this.read(Mce(e)):this.clone();return}var a=new XMLHttpRequest,s=this.clone.bind(this);this.reloading=!0,this.xhr=a,a.onabort=s,a.onerror=s,a.ontimeout=s,a.onprogress=function(){a.getResponseHeader("content-type")!==PI&&a.abort()},a.onload=function(){r.read(a.response)},a.onloadend=function(){r.reloading=!1,r.xhr=null},o.checkCrossOrigin&&zI(e)&&i.crossOrigin&&(e=BI(e)),a.open("GET",e,!0),a.responseType="arraybuffer",a.withCredentials=i.crossOrigin==="use-credentials",a.send()}}},{key:"read",value:function(e){var r=this.options,i=this.imageData,o=Lce(e),a=0,s=1,u=1;if(o>1){this.url=Pce(e,PI);var l=Fce(o);a=l.rotate,s=l.scaleX,u=l.scaleY}r.rotatable&&(i.rotate=a),r.scalable&&(i.scaleX=s,i.scaleY=u),this.clone()}},{key:"clone",value:function(){var e=this.element,r=this.url,i=e.crossOrigin,o=r;this.options.checkCrossOrigin&&zI(r)&&(i||(i="anonymous"),o=BI(r)),this.crossOrigin=i,this.crossOriginUrl=o;var a=document.createElement("img");i&&(a.crossOrigin=i),a.src=o||r,a.alt=e.alt||"The image to crop",this.image=a,a.onload=this.start.bind(this),a.onerror=this.stop.bind(this),Pn(a,NI),e.parentNode.insertBefore(a,e.nextSibling)}},{key:"start",value:function(){var e=this,r=this.image;r.onload=null,r.onerror=null,this.sizing=!0;var i=Eo.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Eo.navigator.userAgent),o=function(l,c){Jt(e.imageData,{naturalWidth:l,naturalHeight:c,aspectRatio:l/c}),e.initialImageData=Jt({},e.imageData),e.sizing=!1,e.sized=!0,e.build()};if(r.naturalWidth&&!i){o(r.naturalWidth,r.naturalHeight);return}var a=document.createElement("img"),s=document.body||document.documentElement;this.sizingImage=a,a.onload=function(){o(a.width,a.height),i||s.removeChild(a)},a.src=r.src,i||(a.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",s.appendChild(a))}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var e=this.element,r=this.options,i=this.image,o=e.parentNode,a=document.createElement("div");a.innerHTML=yce;var s=a.querySelector(".".concat(Yt,"-container")),u=s.querySelector(".".concat(Yt,"-canvas")),l=s.querySelector(".".concat(Yt,"-drag-box")),c=s.querySelector(".".concat(Yt,"-crop-box")),d=c.querySelector(".".concat(Yt,"-face"));this.container=o,this.cropper=s,this.canvas=u,this.dragBox=l,this.cropBox=c,this.viewBox=s.querySelector(".".concat(Yt,"-view-box")),this.face=d,u.appendChild(i),Pn(e,kr),o.insertBefore(s,e.nextSibling),bo(i,NI),this.initPreview(),this.bind(),r.initialAspectRatio=Math.max(0,r.initialAspectRatio)||NaN,r.aspectRatio=Math.max(0,r.aspectRatio)||NaN,r.viewMode=Math.max(0,Math.min(3,Math.round(r.viewMode)))||0,Pn(c,kr),r.guides||Pn(c.getElementsByClassName("".concat(Yt,"-dashed")),kr),r.center||Pn(c.getElementsByClassName("".concat(Yt,"-center")),kr),r.background&&Pn(s,"".concat(Yt,"-bg")),r.highlight||Pn(d,cce),r.cropBoxMovable&&(Pn(d,mx),Kf(d,qf,tR)),r.cropBoxResizable||(Pn(c.getElementsByClassName("".concat(Yt,"-line")),kr),Pn(c.getElementsByClassName("".concat(Yt,"-point")),kr)),this.render(),this.ready=!0,this.setDragMode(r.dragMode),r.autoCrop&&this.crop(),this.setData(r.data),Tr(r.ready)&&fi(e,OI,r.ready,{once:!0}),zl(e,OI)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var e=this.cropper.parentNode;e&&e.removeChild(this.cropper),bo(this.element,kr)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Wce,t}},{key:"setDefaults",value:function(e){Jt(LI,wl(e)&&e)}}]),t}();Jt(VB.prototype,zce,Bce,jce,Vce,$ce,Uce);var Vs=function(){return Vs=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t},Vs.apply(this,arguments)};function L1(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]])}return e}var Hce=["aspectRatio","autoCrop","autoCropArea","background","center","checkCrossOrigin","checkOrientation","cropBoxMovable","cropBoxResizable","data","dragMode","guides","highlight","initialAspectRatio","minCanvasHeight","minCanvasWidth","minContainerHeight","minContainerWidth","minCropBoxHeight","minCropBoxWidth","modal","movable","preview","responsive","restore","rotatable","scalable","toggleDragModeOnDblclick","viewMode","wheelZoomRatio","zoomOnTouch","zoomOnWheel","zoomable","cropstart","cropmove","cropend","crop","zoom","ready"],Gce={opacity:0,maxWidth:"100%"},qce=Ae.forwardRef(function(t,n){var e=L1(t,[]),r=e.dragMode,i=r===void 0?"crop":r,o=e.src,a=e.style,s=e.className,u=e.crossOrigin,l=e.scaleX,c=e.scaleY,d=e.enable,f=e.zoomTo,p=e.rotateTo,h=e.alt,v=h===void 0?"picture":h,g=e.ready,m=e.onInitialized,y=L1(e,["dragMode","src","style","className","crossOrigin","scaleX","scaleY","enable","zoomTo","rotateTo","alt","ready","onInitialized"]),b={scaleY:c,scaleX:l,enable:d,zoomTo:f,rotateTo:p},w=function(){for(var C=[],E=0;E<arguments.length;E++)C[E]=arguments[E];var S=W.useRef(null);return Ae.useEffect(function(){C.forEach(function(k){k&&(typeof k=="function"?k(S.current):k.current=S.current)})},[C]),S}(n,W.useRef(null));W.useEffect(function(){var C;!((C=w.current)===null||C===void 0)&&C.cropper&&typeof f=="number"&&w.current.cropper.zoomTo(f)},[e.zoomTo]),W.useEffect(function(){var C;!((C=w.current)===null||C===void 0)&&C.cropper&&o!==void 0&&w.current.cropper.reset().clear().replace(o)},[o]),W.useEffect(function(){if(w.current!==null){var C=new VB(w.current,Vs(Vs({dragMode:i},y),{ready:function(E){E.currentTarget!==null&&function(S,k){k===void 0&&(k={});var N=k.enable,M=N===void 0||N,D=k.scaleX,T=D===void 0?1:D,O=k.scaleY,P=O===void 0?1:O,A=k.zoomTo,I=A===void 0?0:A,_=k.rotateTo;M?S.enable():S.disable(),S.scaleX(T),S.scaleY(P),_!==void 0&&S.rotateTo(_),I>0&&S.zoomTo(I)}(E.currentTarget.cropper,b),g&&g(E)}}));m&&m(C)}return function(){var E,S;(S=(E=w.current)===null||E===void 0?void 0:E.cropper)===null||S===void 0||S.destroy()}},[w]);var x=function(C){return Hce.reduce(function(E,S){var k=E,N=S;return k[N],L1(k,[typeof N=="symbol"?N:N+""])},C)}(Vs(Vs({},y),{crossOrigin:u,src:o,alt:v}));return Ae.createElement("div",{style:a,className:s},Ae.createElement("img",Vs({},x,{style:Gce,ref:w})))});const Kce=({cropperRef:t})=>{const[n,e]=W.useState(1);return R.jsxs("div",{className:"Aspect",children:[R.jsxs("div",{className:"Aspect_header",children:[R.jsx("div",{className:`Aspect_length ${n&&"active"}`,onClick:()=>e(1),children:R.jsx(fI,{style:{color:"#191919"}})}),R.jsx("div",{className:`Aspect_width ${!n&&"active"}`,onClick:()=>e(0),children:R.jsx(fI,{style:{color:"#191919"}})})]}),R.jsxs("div",{className:"Aspect_body",children:[R.jsx("button",{onClick:()=>t.current.cropper.setAspectRatio(NaN),children:"원본"}),R.jsx("button",{onClick:()=>t.current.cropper.setAspectRatio(1),children:"1:1"}),n?R.jsxs(R.Fragment,{children:[R.jsx("button",{onClick:()=>t.current.cropper.setAspectRatio(3/4),children:"3:4"}),R.jsx("button",{onClick:()=>t.current.cropper.setAspectRatio(9/16),children:"9:16"})]}):R.jsxs(R.Fragment,{children:[R.jsx("button",{onClick:()=>t.current.cropper.setAspectRatio(4/3),children:"4:3"}),R.jsx("button",{onClick:()=>t.current.cropper.setAspectRatio(16/9),children:"16:9"})]})]})]})};function Xce(){const t=Si(),n=Er(),e=t.state.value,r=W.useRef(null);console.log(e);const i=()=>{var o;n("/fish/image/result",{replace:!0,state:{value:(o=r.current)==null?void 0:o.cropper.getCroppedCanvas().toDataURL()}})};return R.jsxs("div",{className:"Demo",children:[R.jsx(pa,{filter:"invert(1)"}),R.jsx("div",{className:"crop",onClick:i,children:"자르기"}),R.jsx("div",{className:"Demo_body",children:R.jsx(qce,{ref:r,style:{height:"100%",width:"100%"},dragMode:"none",viewMode:1,highlight:!1,background:!1,autoCropArea:1,minCropBoxWidth:150,minCropBoxHeight:150,src:e})}),R.jsx("div",{className:"Demo_footer",children:R.jsx(Kce,{cropperRef:r})})]})}const Yce=[{id:1,name:"가다랑어",tabooStartAt:null,tabooEndAt:null,minimumSize:null,imageUrl:""},{id:2,name:"갈치",tabooStartAt:"2024-07-01",tabooEndAt:"2024-07-31",minimumSize:null,imageUrl:""},{id:3,name:"감성돔",tabooStartAt:"2024-05-01",tabooEndAt:"2024-05-31",minimumSize:25,imageUrl:""},{id:4,name:"갑오징어",tabooStartAt:null,tabooEndAt:null,minimumSize:null,imageUrl:""},{id:5,name:"까치상어",tabooStartAt:null,tabooEndAt:null,minimumSize:null,imageUrl:""},{id:6,name:"넙치",tabooStartAt:null,tabooEndAt:null,minimumSize:35,imageUrl:""}],Jce={fishbook:Yce};function Qce(){return R.jsx("ul",{className:"fish-list",children:Jce.fishbook.map(t=>R.jsx(Ho,{to:`/fishbook/${t.id}`,children:R.jsxs("li",{className:"fish-item",children:[R.jsx("div",{children:t.name}),R.jsx("div",{children:t.endangeredSpecies}),R.jsx("div",{children:t.minimumSize}),R.jsx("div",{children:t.tabooStartAt}),R.jsx("div",{children:t.tabooEndAt})]})},t.id))})}function Zce(t){return R.jsxs(R.Fragment,{children:[R.jsx("div",{children:"FishBook"}),";",R.jsx(Qce,{}),R.jsx("div",{className:""})]})}const ede=({fish:t})=>{const[n,e]=W.useState(!1),r=()=>{e(!n)};return R.jsx(R.Fragment,{children:R.jsxs("div",{className:n?"card-rotate":"back-rotate",onClick:r,children:[R.jsxs("div",{className:"front",children:[R.jsx("div",{className:"detail-title",children:"Mulgogi"}),R.jsxs("div",{className:"size",children:["size",R.jsx("div",{children:t.size})]}),R.jsx("img",{className:"fish-img",src:t.imageUrl}),R.jsx("div",{className:"sub-one",children:"the fish"}),R.jsx("div",{className:"sub-two",children:"we love"}),R.jsx("div",{className:"fish-name",children:t.name}),R.jsxs("div",{className:"science-name",children:["학명",R.jsx("div",{style:{whiteSpace:"pre-line"},children:t.scientificName})]}),R.jsxs("div",{className:"food",children:["Food",R.jsx("div",{style:{whiteSpace:"pre-line"},children:t.bait})]}),R.jsxs("div",{className:"live",children:["Where",R.jsx("br",{}),"you live"]}),R.jsx("div",{className:"habitat",style:{whiteSpace:"pre-line"},children:t.habitat})]}),R.jsxs("div",{className:"back",children:[R.jsxs("div",{className:"question",children:["Q. ",t.interview.FirstQuestion,R.jsx("div",{style:{whiteSpace:"pre-line"},children:t.interview.FirstAnswer})]}),R.jsxs("div",{className:"question",children:["Q. ",t.interview.SecondQuestion,R.jsx("div",{style:{whiteSpace:"pre-line"},children:t.interview.SecondAnswer})]}),R.jsxs("div",{className:"question",children:["Q. ",t.interview.thirdQuestion,R.jsx("div",{style:{whiteSpace:"pre-line"},children:t.interview.thirdAnswer})]})]})]})})},tde="/assets/감성돔-1jgNHgKu.jpg",nde=()=>{xS();const[t,n]=W.useState({id:1,name:"감성돔",scientificName:`Acantopagrus
scblegeli`,fishType:"SEA",size:"30~50cm이상",habitat:`흐르지 않는 연못, 저수지, 늪지 등의 탁한 물 밑
물풀이 무성한 곳`,bait:`참갯지렁이
크릴
쏙
조개류
갯지렁이`,interview:{FirstQuestion:"이름이 무슨뜻인가요?",FirstAnswer:`검은 돔에서 변화한 것입니다.
감상어, 먹도미, 감성도미, 감셍이,
구릿, 맹이, 남정바리 등으로
불리기도 합니다.`,SecondQuestion:"외모자랑 한번 해주세요",SecondAnswer:"몸이 크고 긴 원통 모양이며 옆으로 납작합니다. 눈은 작은 편이며 아래턱이 위턱보다 조금 짧고 입 둘레에 두 쌍의 수염이 있습니다.몸은 누른빛을 띤 녹색이고 등 쪽은 짙고 배 쪽은 연한 색이며 옆구리는 갈색입니다.",thirdQuestion:"특별한 능력이 있다구요?",thirdAnswer:`성전환이 가능합니다.
1년생동안은 대부분 수컷이지만,
이후 암수한몸이었다가
4~5년부터는 암수로 완전히 분리되요.
대부분이 암컷으로 성전환합니다.`},imageUrl:tde,detailImageUrl:""});return R.jsx(ede,{fish:t})},rde="/assets/naver_logo-8-qEmV51.png",ide=()=>{const r="https://nid.naver.com/oauth2.0/authorize?client_id=w88WA5fuXobhPaQEmw1p&response_type=code&redirect_uri=http://localhost:5173/login/naver&state=niwXgvCl5E",i=()=>{window.location.href=r};return R.jsx(R.Fragment,{children:R.jsx("img",{src:rde,alt:"네이버로그인",onClick:i})})},ode="/assets/kakao_logo-F_W8h3hn.png",ade=()=>{const e="https://kauth.kakao.com/oauth/authorize?client_id=db5b74e6c640443403b9705680d9dbac&redirect_uri=https://i10c203.p.ssafy.io/login/kakao&response_type=code",r=()=>{window.location.href=e};return R.jsx(R.Fragment,{children:R.jsx("img",{src:ode,alt:"카카오로그인",onClick:r})})},sde="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAI2AAACNgElQaYmAAAHT0lEQVR4nO2dTWwTRxTHX+wEh5R0I6GqMkJNaKVWRaJEtjhUVV2skkNPgMyhFhIQ5daqarjQm4Hc6AVz6K1V3JNPFkEqpxwczKWqZCdUFUipEA6qcNWqxabgfJG4mu1zMZY3mZmdmR1v5idFSZzN7Hj/nvfevPkCg8FgMBgMBoPBYDDsbHq66d1X4tFRABgBgFF86aMtLq8CwB38eQ4AyuF8saygmq7QWhAU4AQ++KMCiqyiOLfI93C+uCCgTKFoJ0glHiUP/iwKMST5dqTFzADANV1ajxaCVOJR8uDPAcCXaJK8gLSc78P5YsbLZ+GpICjEJAohuzXQQlrKZa+E8UyQSjxKhLiokRDtzKEwcypvqlwQ9BFXWyIl3UmjMFUV9VQqSCUevYStotsgZmxcRWtRIkglHiWO+noXtQonzofzxbTMG0gXBE3UdY19BSuZcL44LqtwqYJU4lESyk7LvIdHkA5lXIZfCch6Pz4Wg7Agy8lLaSE+F6O7TJYRwx1CBUEHnpdZYQ+RLgaIFAQzs3kfRVOtKBEDRAmCOam8B/2MMn51YlTQh0OZGIReQeVcVCRGM11+gybSwQ4pqddxznS+UjFARAtR5DcyOGbhakCpEo+ewMwyzWCXcjHArSBoquYljmFkMLEndPCIIsHpiRggQBBZyUIlyTyH+nsmBrgRBO3zvISoKoNJPCXp7rbo0FMxwKUg0zjsKhLp2VSH92JPpgjni5dU37sdLkFWZ2GksRJ88DT3FqwvDYqqCzFRno5n6wBvcvFcT/8GDJ5ehP4jf4h4G0YMhLeFPG71HWuLQ/DshxForAR5ikuH88XzPP/oR5if4Oqs7Tc+bX0tuHcFQgf/hvWHg9B41sdSHJmsltyBz90RHpN1vNOLAWsNXj29CKH3/qIth0RRnkY0OsJkslZnbTP1eNvrft5rm7Bt8CSi0h3WFnKC5iLSSqyJe3arcaBsxOgMqyBbzTZ/ieDrdbAm7kLf8D+d/nyZv8r+htVkPeDJWy3f3gfLt8PNX0nrOLDTH7wT1C2EdAZ5k4i7P3wEe07dB9J3IROaXdbZ17CMh7jK6O56uwq9E3eh+s0hKR3A2FRtREIqRxSZQsqiylizCOJ6wUzAWpO5imlE42mqVZwjvC0sTn1YQMVmBJTRjVBnxFkEETEIdYfiGj9CHZ1Km7nogPaLLr2GRRDXPiQ0BkoXv2iEFJNl4Id6Ro4RRDOMIJphBNEMI4hmsAjiOkJanRWyPYavUd1CvNqlwWuop8CyCCKiU3dYQBndCPWkPxZBlgQ8CKoRx52MUh9CTBaOq+w0btG+X5b0uyuT9bTRB+lnh+HmyvA5gJyMKZtlSUPDIvbqojZZSoZwK5sD8NWT9+HX53ZKp1xK5rpmCDc2VbsuwNTGCymLysKwRlnMZquwtg/OPD7WFIMwEskmdB3Z64QIvyclygIWW0j4rn7QbhnEXLXRFRvQxKZqIj44C4WUJSXKAtoRPyLA57UYfFt/1+kS0komGe/tBWcF3JNpGR6TIKEx2zltKQoxTWeqx6C0/tp2xV2MZBPaRlyxqdpRQRtv3mC5mKen7niDm6vDcKb6MVQ2BmjKGdJ8xwdRZpXJ7wpZjtAS0vIUly4lc1otR4hN1SZxUahbZgop6yRLGby5rGvNH4iJ+qwW4xWDMKlT1BWbqo0KEgNYzRW4EMSe7EZCWiJGS0jLy7QOoqAYotbcb+tvO8ElSGgMyleeRjIOIS0vRBTPIq8WMUStKp5hCXebcK/CxQhJ2rLoUjKnZFk0vIioRG9DeIB2+mgr3OMhpWSu3OpLBEJM13wkm5A+mBXJJoaOTF+42gjURe9iRD2Xtx23A1RpSZPfSOvLR7KJaVl9FfRZ8xv99yeX938Nm6GHIovnTnK63nwGP8lKNp8pJXOuNp8hLcJpj/mezQEI/ZmE3icfuK1rupCyuMN4IftlRbKJq7iHu2xe2p6Jxs/gB2YU0+jbJgr7qmO2MJxU0Xdw+z9Rgui4gRn3AqPA6huw+7cLdqth5GQhZbma4S9si79INuGrLf6IGP2PvoDg8ju0/8LcK++EsFknaN9dV0gXGoE6LO+/AutDszQ1WhC15p5rLwwnKrl75fCpg0t+msyw8covdgQWrB+Cns6d4CqaKiHRplBB4D9RFvwmyuau321hgitvQs+G1f7nTwop60dR9xIuCPhUlEZvDZ4P/gSBDct2+si4WyfejhRBwKeiQM86PN8zD41gHXrrh4gYwlcUSz+uAvsBfjquwvYZpWROymowJQe6YPrDDwe6lFEMaecfKj3yKJJNdOuRR4AZgnHZWWjlh4KhCeumQ8GqKISSNfaeHZuHg1E6H5sHXozNeHqwJObAdDtYEpo7auOYj1K0OHp1q7S4Qppj4J4I0US7w4nRx6g6nBha0vkzKk2TE1of340ZZJHHdwMmAv8/wlsHEVrpqgPuUSDaA+6hZXL4Ai6D0O78dIPBYDAYDAaDwWAwGF4AAP8CR9JwtW2tQjkAAAAASUVORK5CYII=",ude=()=>{const e="https://accounts.google.com/o/oauth2/v2/auth?scope=email%20openid&response_type=code&redirect_uri=http://localhost:5173/login/google&client_id=68067767440-hri2501h11p1d08asfsfaf6t2705u9cr.apps.googleusercontent.com",r=()=>{window.location.href=e};return R.jsx(R.Fragment,{children:R.jsx("img",{src:sde,alt:"구글로그인",onClick:r})})},lde=()=>{var i;const t=Er(),e=(i=Si().state)==null?void 0:i.path,r=sessionStorage.getItem("jwt");return W.useEffect(()=>{r&&t("/")},[]),R.jsxs("div",{className:"LoginPage",children:[R.jsx(pa,{centerText:"Login",prevPath:e}),R.jsx("div",{className:"LoginPage_body",children:R.jsx("img",{src:Xd,alt:""})}),R.jsxs("div",{className:"LoginPage_footer",children:[R.jsx(ide,{}),R.jsx(ade,{}),R.jsx(ude,{})]})]})},iR="/assets/Group-cDp7Suxl.svg",cde="/assets/Sort-ccnrWBQT.svg";function dde({state:t,sortBy:n}){const e=W.useRef();W.useEffect(()=>{e.current.showModal()});const r=a=>{const u=a.target.getBoundingClientRect();(u.left>a.clientX||u.right<a.clientX||u.top>a.clientY||u.bottom<a.clientY)&&(e.current.close(),t(!t))},i=()=>{e.current.close(),n(1),t(!t)},o=()=>{e.current.close(),n(0),t(!t)};return R.jsx(R.Fragment,{children:R.jsxs("dialog",{ref:e,onClick:r,className:"room-filter-modal",children:[R.jsx("header",{className:"room-filter-header",children:R.jsx("span",{children:"정렬"})}),R.jsxs("div",{className:"room-filter-body",children:[R.jsxs("div",{onClick:i,children:[R.jsx("img",{src:iR,alt:""}),R.jsx("span",{children:"인원순"})]}),R.jsxs("div",{onClick:o,children:[R.jsx("img",{src:cde,alt:""}),R.jsx("span",{children:"최신순"})]})]})]})})}var oR={},fde=yt;Object.defineProperty(oR,"__esModule",{value:!0});var $B=oR.default=void 0,pde=fde(bt()),jI=R;$B=oR.default=(0,pde.default)([(0,jI.jsx)("path",{d:"m7.3 14.7 1.2-1.2c-1-1-1.5-2.3-1.5-3.5 0-1.3.5-2.6 1.5-3.5L7.3 5.3c-1.3 1.3-2 3-2 4.7s.7 3.4 2 4.7M19.1 2.9l-1.2 1.2c1.6 1.6 2.4 3.8 2.4 5.9 0 2.1-.8 4.3-2.4 5.9l1.2 1.2c2-2 2.9-4.5 2.9-7.1 0-2.6-1-5.1-2.9-7.1"},"0"),(0,jI.jsx)("path",{d:"M6.1 4.1 4.9 2.9C3 4.9 2 7.4 2 10c0 2.6 1 5.1 2.9 7.1l1.2-1.2c-1.6-1.6-2.4-3.8-2.4-5.9 0-2.1.8-4.3 2.4-5.9m10.6 10.6c1.3-1.3 2-3 2-4.7-.1-1.7-.7-3.4-2-4.7l-1.2 1.2c1 1 1.5 2.3 1.5 3.5 0 1.3-.5 2.6-1.5 3.5zM14.5 10c0-1.38-1.12-2.5-2.5-2.5S9.5 8.62 9.5 10c0 .76.34 1.42.87 1.88L7 22h2l.67-2h4.67l.66 2h2l-3.37-10.12c.53-.46.87-1.12.87-1.88m-4.17 8L12 13l1.67 5z"},"1")],"CellTowerOutlined");const UB="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAA3CAYAAACo29JGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAOLSURBVHgB7ZpbiE1RGMf/jpmQwRAaGZkYklt5kCmXEimX8ICUB8QrXnjgAS/S4MmLJFJK8iAveBAPRG5D7iGZzCCkxv0wxvj+rXNqn7XWsfc5s885a53Or/6n9m3t7ztrr29969sbAJpED0R/Rd1lIPrxSbS+l/zcFU1D+dGRkJ9hKE9q6dw3lCfdVVDPZ5Bzov3wjwWiHYHtJJ17LZoZ2DlIdE30B36xSNt+xceyRds5HspBn2AnzdL2PeHPVFEnMkPpUvjFKNEXZE4JG3mgv6hVO3AGfsGxFrSfQbIhfbBZO8ienAA/6Cd6g0z7L4mq0ydMgtmt7L3ecJ9tMLOUNfpJJ2D23jy4zUSoqSxo933RYP3ERtEP7cQ20Ti4yUDRZZh5ZdZguB1mF98UjYBbcJydgmnrFVEi20U1okeWi25BhVsXoI0nYa5iGFQawy7mCW0wHXwhmoLSMhwq0Om2fRctj9rIXNF7SyPtKF2QaYAaIrpNSagJu1cujdHBr5bG3olW5NpYD+F6s8Viy0/R1nxtYaPPYf+3NqHw8yCNni/6YLGhQ7QWPfyTx0AFFL1xrhp2iQagMNDoZTCTC+otYhwe9aILsA/kw1D5aZzwidical+/5zPRHMQMHTgu6rLc8KJoKOKhj2hflvtcF41GgWAyylV60nJjJqs9TbY5hx2BvaLF9oegwHCMMVlNWgy4IRqL/KiDPetgDx4V1aKIMFJ1wJ6u5ToGmTIdQ+aimfot2oMiO5aGSepLmA4eQG4wKurpFJP4vOewOOA/PhtmusZ5aXLENviY34Hp2AY4AstqnPeCBjZHvHad5drdUFHTGc4i08DHCI9uCct1rVBLGqdYCDPvawq5ZqToqXbdTsREAvHBdeDnwHZfqNTtf9SlFOQqYiJO55gqtWv7wkI4p4wabV8bYiJO5xjKO7V91Qi/f1Vgu9vSRt7E6ZxzVJzzlYpzvlJxzlcqzvlKxbkCwZwycn0/H6pQfFg2mCE6KJquHetKKRaK7Rw/AWFNchXsK4bzoo9wEBp7D5kLzy2pY1wdsPz9EGYxKV3lOgT1ispJsjnHsbUX9jdGFL9gWokSVrmiYHPutOg2sn/Lyeq1s70VxOacTXSUJYnF8IgozrGEx3cBXvRWkDDn+EJ+NcJLD05C5/hJse7UL6hIWAePYSVL/9KAkXAJHI+EUeE7dH6exPol37jWo4T8A7CzoWgJ7WGLAAAAAElFTkSuQmCC";var aR={},hde=yt;Object.defineProperty(aR,"__esModule",{value:!0});var WB=aR.default=void 0,mde=hde(bt()),vde=R;WB=aR.default=(0,mde.default)((0,vde.jsx)("path",{d:"m19 8-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4z"}),"Cached");function gde(){const t=Er(),[n,e]=W.useState([]),[r,i]=W.useState([]),[o,a]=W.useState(!1),[s,u]=W.useState(0),[l,c]=W.useState(!0),d=!1,f="https://i10c203.p.ssafy.io",p="wearegitaehasam";W.useEffect(()=>{v()},[]);const h=()=>{a(!o)},v=()=>{c(!0),xt.get(f+"/api/lives").then(m=>{xt.get(f+"/openvidu/api/sessions",{headers:{Authorization:"Basic "+btoa("OPENVIDUAPP:"+p),"Content-Type":"application/json"}}).then(y=>{e(m.data),i(y.data),c(!1)})}).catch(m=>{console.log(m)})},g=m=>{console.log("enterLive-liveRoomId: ",m.liveRoomId),console.log("enterLive-sessionId: ",m.sessionId);const y=m.liveRoomId,b=m.sessionId;t(`/live/${m.sessionId}`,{state:{isHost:d,roomId:y,subscriberSession:b}})};return console.log(n),console.log(r),R.jsx(R.Fragment,{children:l?R.jsx(Pc,{}):R.jsxs("div",{children:[R.jsx(pa,{centerText:"낚시 라이브"}),R.jsx(WB,{className:"room-list-reload-btn",onClick:v}),n.liveRooms&&n.liveRooms.length>0?R.jsxs("div",{onClick:h,className:"roomList-filter",children:[s===1?R.jsx("span",{children:"참여인원순"}):R.jsx("span",{children:"최신순"}),R.jsx("img",{src:UB,alt:""}),o&&R.jsx(dde,{state:a,sortBy:u})]}):R.jsxs("div",{className:"no-live",children:[R.jsx($B,{}),R.jsx("span",{children:"진행중인 라이브가 없습니다."})]}),n.liveRooms&&n.liveRooms.map((m,y)=>R.jsxs("div",{className:"roomList-info",onClick:()=>g(m),children:[R.jsx("img",{src:m.thumbnailURL?m.thumbnailURL:Xd,alt:"room thumbnail",className:"thumbnail"}),R.jsxs("div",{className:"roomList-info-header",children:[R.jsx("p",{children:m.name}),R.jsxs("div",{className:"roomList-info-body",children:[R.jsx("span",{children:m.nickName}),R.jsxs("p",{children:[R.jsx("img",{className:"subscriber",src:iR,alt:"group"})," "]})]})]})]},y)),R.jsx(Dd,{to:"/media/roomList/create",className:"nav-item createLive-btn",children:R.jsx("span",{children:"라이브 켜기"})})]})})}var sR={},yde=yt;Object.defineProperty(sR,"__esModule",{value:!0});var HB=sR.default=void 0,bde=yde(bt()),wde=R;HB=sR.default=(0,bde.default)((0,wde.jsx)("path",{d:"M21 6h-3.17L16 4h-6v2h5.12l1.83 2H21v12H5v-9H3v9c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2M8 14c0 2.76 2.24 5 5 5s5-2.24 5-5-2.24-5-5-5-5 2.24-5 5m5-3c1.65 0 3 1.35 3 3s-1.35 3-3 3-3-1.35-3-3 1.35-3 3-3M5 6h3V4H5V1H3v3H0v2h3v3h2z"}),"AddAPhotoOutlined");var uR={},xde=yt;Object.defineProperty(uR,"__esModule",{value:!0});var GB=uR.default=void 0,Sde=xde(bt()),Ede=R;GB=uR.default=(0,Sde.default)((0,Ede.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m4.17-5.24-1.1-1.1c.71-1.33.53-3.01-.59-4.13C13.79 8.84 12.9 8.5 12 8.5c-.03 0-.06.01-.09.01L13 9.6l-1.06 1.06-2.83-2.83L11.94 5 13 6.06l-.96.96c1.27.01 2.53.48 3.5 1.44 1.7 1.71 1.91 4.36.63 6.3m-1.28 1.41L12.06 19 11 17.94l.95-.95c-1.26-.01-2.52-.5-3.48-1.46-1.71-1.71-1.92-4.35-.64-6.29l1.1 1.1c-.71 1.33-.53 3.01.59 4.13.7.7 1.63 1.04 2.56 1.01L11 14.4l1.06-1.06z"}),"ChangeCircleOutlined");function Cde(){const t=Er(),n=!0,e="https://i10c203.p.ssafy.io/api",[r,i]=W.useState(""),[o,a]=W.useState(""),[s,u]=W.useState(null),[l,c]=W.useState(null),d=W.useRef(),f=y=>{i(y.target.value)},p=y=>{y.preventDefault(),d.current.click()};W.useEffect(()=>{o&&u(R.jsx("img",{className:"room-create-upload-img",src:o}))},[o]);const h=y=>{y.preventDefault();const b=y.target.files[0],w=new FileReader;w.onloadend=()=>{a(w.result)},b&&(w.readAsDataURL(b),v(b))},v=y=>{xt.post(e+"/images/presigned",{filename:y.name}).then(b=>{console.log(b.data),c(b.data.imageUrl),g(b.data.preSignedUrl,y)}).catch(b=>console.error(b))},g=(y,b)=>{xt.put(y,b,{headers:{"Content-Type":b==null?void 0:b.type}}).then(w=>{console.log(w)}).catch(w=>{console.log(w)})},m=y=>{const b=Math.floor(Math.random()*1e6);t(`/live/Gitaehasam${b}`,{state:{isHost:n,roomId:b,imageUrl:l||null,name:r}})};return R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"roomList-header",onClick:()=>t("/media/roomList"),children:[R.jsx("img",{src:d2,alt:""}),R.jsx("span",{children:"라이브 생성"})]}),R.jsxs("form",{className:"room-create-form",onSubmit:m,children:[R.jsxs("div",{className:"room-create-header",children:[R.jsx("div",{className:"room-create-thumbnail-title",children:"특별한 사진으로 라이브를 표현해보세요"}),R.jsxs("div",{className:"room-create-thumbnail",children:[s,o?R.jsx("div",{className:"room-create-thumbnail-btn-bottom",onClick:p,children:R.jsx(GB,{})}):R.jsx("div",{className:"room-create-thumbnail-btn",onClick:p,children:R.jsx(HB,{})})]}),R.jsx("input",{ref:d,hidden:!0,type:"file",onChange:h})]}),R.jsxs("div",{className:"room-create-header",children:[R.jsx("div",{className:"room-create-thumbnail-title",children:"제목"}),R.jsx("input",{className:"room-create-title",type:"text",maxLength:15,value:r,onChange:f,placeholder:"라이브 제목을 적어주세요.",required:!0})]}),R.jsx("div",{className:"room-create-btn",children:R.jsx("button",{type:"submit",children:"라이브 켜기"})})]})]})}var qB={},lR={};(function(t){var n=ve&&ve.__extends||function(){var r=function(i,o){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(a[u]=s[u])},r(i,o)};return function(i,o){r(i,o);function a(){this.constructor=i}i.prototype=o===null?Object.create(o):(a.prototype=o.prototype,new a)}}();function e(r){if(!r)return e.__;Array.prototype.reduce||(Array.prototype.reduce=function(a,s){for(var u=s,l=0;l<this.length;l++)u=a(u,this[l],l,this);return u});var i="",o=("."+r).split(".").reduce(function(a,s,u,l){i?i+="."+s:i=s;var c=a["__"+i];return c===void 0&&(e.Logger.prototype=a,c=new e.Logger(i),a["__"+i]=c),c},e.__);return o}(function(r){r.requestId="",r.entryId=0,r._createXMLHttpRequest=function(){return new XMLHttpRequest},r._getTime=function(){return new Date().getTime()},r._console=console,r._appenderNames=[];function i(A,I,_){if(I[A]!==void 0){if(I[A]===null){delete _[A];return}_[A]=I[A]}}function o(A){if(r.enabled!=null&&!r.enabled)return!1;try{if(A.userAgentRegex&&!new RegExp(A.userAgentRegex).test(navigator.userAgent))return!1}catch{}try{if(A.ipRegex&&r.clientIP&&!new RegExp(A.ipRegex).test(r.clientIP))return!1}catch{}return!0}function a(A,I){try{if(A.disallow&&new RegExp(A.disallow).test(I))return!1}catch{}return!0}function s(A){return typeof A=="function"?A instanceof RegExp?A.toString():A():A}var u=function(){function A(I,_,F){this.msg=I,this.meta=_,this.finalString=F}return A}();function l(A){var I=s(A),_;switch(typeof I){case"string":return new u(I,null,I);case"number":return _=I.toString(),new u(_,null,_);case"boolean":return _=I.toString(),new u(_,null,_);case"undefined":return new u("undefined",null,"undefined");case"object":return I instanceof RegExp||I instanceof String||I instanceof Number||I instanceof Boolean?(_=I.toString(),new u(_,null,_)):(typeof r.serialize=="function"?_=r.serialize.call(this,I):_=JSON.stringify(I),new u("",I,_));default:return new u("unknown",null,"unknown")}}function c(A){return i("enabled",A,this),i("maxMessages",A,this),i("defaultAjaxUrl",A,this),i("clientIP",A,this),i("requestId",A,this),i("defaultBeforeSend",A,this),i("serialize",A,this),this}r.setOptions=c;function d(){return-2147483648}r.getAllLevel=d;function f(){return 1e3}r.getTraceLevel=f;function p(){return 2e3}r.getDebugLevel=p;function h(){return 3e3}r.getInfoLevel=h;function v(){return 4e3}r.getWarnLevel=v;function g(){return 5e3}r.getErrorLevel=g;function m(){return 6e3}r.getFatalLevel=m;function y(){return 2147483647}r.getOffLevel=y;function b(A){return A<=1e3?"trace":A<=2e3?"debug":A<=3e3?"info":A<=4e3?"warn":A<=5e3?"error":"fatal"}var w=function(){function A(I,_){this.inner=_,this.name="JL.Exception",this.message=l(I).finalString}return A}();r.Exception=w,w.prototype=new Error;var x=function(){function A(I,_,F,L,H){this.l=I,this.m=_,this.n=F,this.t=L,this.u=H}return A}();r.LogItem=x;function C(A,I,_){return r.entryId++,new x(A,I,_,r._getTime(),r.entryId)}function E(A){A.id&&(clearTimeout(A.id),A.id=null)}function S(A,I,_){var F=this;A.id||(A.id=setTimeout(function(){_.call(F)},I))}var k=function(){function A(I,_){this.appenderName=I,this.sendLogItems=_,this.level=r.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var F="Trying to create an appender without a name or with an empty name";if(I==null)throw F;if(r._appenderNames.indexOf(I)!=-1)throw I?"Multiple appenders use the same name "+I:F;r._appenderNames.push(I)}return A.prototype.addLogItemsToBuffer=function(I){if(this.batchBuffer.length>=this.maxBatchSize){this.nbrLogItemsSkipped+=I.length;return}if(r.maxMessages!=null){if(r.maxMessages<1)return;r.maxMessages-=I.length}this.batchBuffer=this.batchBuffer.concat(I);var _=this;S(this.batchTimeoutTimer,this.batchTimeout,function(){_.sendBatch.call(_)})},A.prototype.batchBufferHasOverdueMessages=function(){for(var I=0;I<this.batchBuffer.length;I++){var _=r._getTime()-this.batchBuffer[I].t;if(_>this.batchTimeout)return!0}return!1},A.prototype.batchBufferHasStrandedMessage=function(){return r.maxMessages!=null&&r.maxMessages<1&&this.batchBuffer.length>0},A.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},A.prototype.onSendingEnded=function(){E(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},A.prototype.setOptions=function(I){if(i("level",I,this),i("ipRegex",I,this),i("userAgentRegex",I,this),i("disallow",I,this),i("sendWithBufferLevel",I,this),i("storeInBufferLevel",I,this),i("bufferSize",I,this),i("batchSize",I,this),i("maxBatchSize",I,this),i("batchTimeout",I,this),i("sendTimeout",I,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new r.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},A.prototype.log=function(I,_,F,L,H,B,q){var G;if(o(this)&&a(this,B)&&!(H<this.storeInBufferLevel)){if(G=C(H,B,q),H<this.level){this.bufferSize>0&&(this.buffer.push(G),this.buffer.length>this.bufferSize&&this.buffer.shift());return}this.addLogItemsToBuffer([G]),H>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete()}},A.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(E(this.batchTimeoutTimer),this.batchBuffer.length!=0)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var I=this;S(this.sendTimeoutTimer,this.sendTimeout,function(){I.onSendingEnded.call(I)}),this.sendLogItems(this.batchBuffer,function(){I.batchBuffer.splice(0,I.nbrLogItemsBeingSent),I.nbrLogItemsSkipped>0&&(I.batchBuffer.push(C(v(),"Lost "+I.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",I.appenderName)),I.nbrLogItemsSkipped=0),I.onSendingEnded.call(I)})}},A}();r.Appender=k;var N=function(A){n(I,A);function I(_){return A.call(this,_,I.prototype.sendLogItemsAjax)||this}return I.prototype.setOptions=function(_){return i("url",_,this),i("beforeSend",_,this),A.prototype.setOptions.call(this,_),this},I.prototype.sendLogItemsAjax=function(_,F){try{if(!o(this))return;this.xhr&&this.xhr.readyState!=0&&this.xhr.readyState!=4&&this.xhr.abort(),this.xhr=r._createXMLHttpRequest();var L="/jsnlog.logger";r.defaultAjaxUrl!=null&&(L=r.defaultAjaxUrl),this.url&&(L=this.url),this.xhr.open("POST",L),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",r.requestId);var H=this;this.xhr.onreadystatechange=function(){H.xhr.readyState==4&&H.xhr.status>=200&&H.xhr.status<300&&F()};var B={r:r.requestId,lg:_};typeof this.beforeSend=="function"?this.beforeSend.call(this,this.xhr,B):typeof r.defaultBeforeSend=="function"&&r.defaultBeforeSend.call(this,this.xhr,B);var q=JSON.stringify(B);this.xhr.send(q)}catch{}},I}(k);r.AjaxAppender=N;var M=function(A){n(I,A);function I(_){return A.call(this,_,I.prototype.sendLogItemsConsole)||this}return I.prototype.clog=function(_){r._console.log(_)},I.prototype.cerror=function(_){r._console.error?r._console.error(_):this.clog(_)},I.prototype.cwarn=function(_){r._console.warn?r._console.warn(_):this.clog(_)},I.prototype.cinfo=function(_){r._console.info?r._console.info(_):this.clog(_)},I.prototype.cdebug=function(_){r._console.debug?r._console.debug(_):this.cinfo(_)},I.prototype.sendLogItemsConsole=function(_,F){try{if(!o(this)||!r._console)return;var L;for(L=0;L<_.length;++L){var H=_[L],B=H.n+": "+H.m;typeof window>"u"&&(B=new Date(H.t)+" | "+B),H.l<=r.getDebugLevel()?this.cdebug(B):H.l<=r.getInfoLevel()?this.cinfo(B):H.l<=r.getWarnLevel()?this.cwarn(B):this.cerror(B)}}catch{}F()},I}(k);r.ConsoleAppender=M;var D=function(){function A(I){this.loggerName=I,this.seenRegexes=[]}return A.prototype.setOptions=function(I){return i("level",I,this),i("userAgentRegex",I,this),i("disallow",I,this),i("ipRegex",I,this),i("appenders",I,this),i("onceOnly",I,this),this.seenRegexes=[],this},A.prototype.buildExceptionObject=function(I){var _={};return I.stack?_.stack=I.stack:_.e=I,I.message&&(_.message=I.message),I.name&&(_.name=I.name),I.data&&(_.data=I.data),I.inner&&(_.inner=this.buildExceptionObject(I.inner)),_},A.prototype.log=function(I,_,F){var L=0,H,B;if(!this.appenders)return this;if(I>=this.level&&o(this)&&(F?(B=this.buildExceptionObject(F),B.logData=s(_)):B=_,H=l(B),a(this,H.finalString))){if(this.onceOnly)for(L=this.onceOnly.length-1;L>=0;){if(new RegExp(this.onceOnly[L]).test(H.finalString)){if(this.seenRegexes[L])return this;this.seenRegexes[L]=!0}L--}for(H.meta=H.meta||{},L=this.appenders.length-1;L>=0;)this.appenders[L].log(b(I),H.msg,H.meta,function(){},I,H.finalString,this.loggerName),L--}return this},A.prototype.trace=function(I){return this.log(f(),I)},A.prototype.debug=function(I){return this.log(p(),I)},A.prototype.info=function(I){return this.log(h(),I)},A.prototype.warn=function(I){return this.log(v(),I)},A.prototype.error=function(I){return this.log(g(),I)},A.prototype.fatal=function(I){return this.log(m(),I)},A.prototype.fatalException=function(I,_){return this.log(m(),I,_)},A}();r.Logger=D;function T(A){return new N(A)}r.createAjaxAppender=T;function O(A){return new M(A)}r.createConsoleAppender=O;var P;typeof window<"u"?P=new N(""):P=new M(""),r.__=new r.Logger(""),r.__.setOptions({level:r.getDebugLevel(),appenders:[P]})})(e||(e={})),t.__esModule=!0,t.JL=e,typeof __jsnlog_configure=="function"&&__jsnlog_configure(e),typeof window<"u"&&!window.onerror&&(window.onerror=function(r,i,o,a,s){return e("onerrorLogger").fatalException({msg:"Uncaught Exception",errorMsg:r?r.message||r:"",url:i,"line number":o,column:a},s),!1}),typeof window<"u"&&!window.onunhandledrejection&&(window.onunhandledrejection=function(r){e("onerrorLogger").fatalException({msg:"unhandledrejection",errorMsg:r.reason?r.reason.message:r.message||null},r.reason)})})(lR);var Wy={},zp={},cR={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorderState=void 0,function(n){n.READY="READY",n.RECORDING="RECORDING",n.PAUSED="PAUSED",n.FINISHED="FINISHED"}(t.LocalRecorderState||(t.LocalRecorderState={}))})(cR);var An={},Hy={};Object.defineProperty(Hy,"__esModule",{value:!0});Hy.ConsoleLogger=void 0;var Rde=function(){function t(n){this.logger=n,this.log=n.log,this.info=n.info,this.debug=n.debug,this.warn=n.warn,this.error=n.error}return t}();Hy.ConsoleLogger=Rde;var dR={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLoggerConfiguration=void 0,function(n){n.disabled="disabled",n.debug="debug",n.debug_app="debug_app"}(t.OpenViduLoggerConfiguration||(t.OpenViduLoggerConfiguration={}))})(dR);Object.defineProperty(An,"__esModule",{value:!0});An.OpenViduLogger=void 0;var di=lR,Tde=Hy,F1=dR,Nde=function(){function t(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new Tde.ConsoleLogger(globalThis.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return t.configureJSNLog=function(n,e){var r=this;try{if(globalThis.LOG_JSNLOG_RESULTS||this.instance&&n.isAtLeastPro&&this.instance.isOpenViduBrowserLogsDebugActive(n)&&this.instance.canConfigureJSNLog(n,this.instance)){n.sendBrowserLogs===F1.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var i=n.finalUserId,o=n.session.sessionId,a=function(u){var l=u.onreadystatechange;u.onreadystatechange=function(){r.isInvalidResponse(u)&&(Object.defineProperty(u,"readyState",{value:4}),Object.defineProperty(u,"status",{value:200}),r.instance.disableLogger()),l()},u.setRequestHeader("Authorization","Basic "+btoa("".concat(i,"%/%").concat(o)+":"+e)),u.setRequestHeader("X-Requested-With","XMLHttpRequest"),u.setRequestHeader("OV-Final-User-Id",i),u.setRequestHeader("OV-Session-Id",o),u.setRequestHeader("OV-Token",e)};this.instance.currentAppender=di.JL.createAjaxAppender("appender-".concat(i,"-").concat(o)),this.instance.currentAppender.setOptions({beforeSend:a,maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES});var s=function(u){var l=function(){var d=new WeakSet;return function(f,p){if(typeof p=="object"&&p!=null){if(d.has(p)||globalThis.HTMLElement&&p instanceof HTMLElement)return;d.add(p)}return p}},c=JSON.stringify(u,l());return c.length>r.instance.MAX_LENGTH_STRING_JSON&&(c="".concat(c.substring(0,r.instance.MAX_LENGTH_STRING_JSON),"...")),globalThis.LOG_JSNLOG_RESULTS&&console.log(c),c};di.JL.setOptions({defaultAjaxUrl:n.httpUri+this.instance.JSNLOG_URL,serialize:s,enabled:!0}),(0,di.JL)().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=o,this.instance.info("JSNLog configured.")}}catch(u){console.error("Error configuring JSNLog: "),console.error(u),this.instance.disableLogger()}},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.isInvalidResponse=function(n){return n.status==401||n.status==403||n.status==404||n.status==0},t.prototype.canConfigureJSNLog=function(n,e){return n.session.sessionId!=e.loggingSessionId},t.prototype.isOpenViduBrowserLogsDebugActive=function(n){return n.sendBrowserLogs===F1.OpenViduLoggerConfiguration.debug||n.sendBrowserLogs===F1.OpenViduLoggerConfiguration.debug_app},t.prototype.getConsoleWithJSNLog=function(){return function(n){return{log:function(){n.defaultConsoleLogger.log.apply(n.defaultConsoleLogger.logger,arguments),n.isJSNLogSetup&&(0,di.JL)().info(arguments)},info:function(){n.defaultConsoleLogger.info.apply(n.defaultConsoleLogger.logger,arguments),n.isJSNLogSetup&&(0,di.JL)().info(arguments)},debug:function(){n.defaultConsoleLogger.debug.apply(n.defaultConsoleLogger.logger,arguments)},warn:function(){n.defaultConsoleLogger.warn.apply(n.defaultConsoleLogger.logger,arguments),n.isJSNLogSetup&&(0,di.JL)().warn(arguments)},error:function(){n.defaultConsoleLogger.error.apply(n.defaultConsoleLogger.logger,arguments),n.isJSNLogSetup&&(0,di.JL)().error(arguments)}}}(this)},t.prototype.replaceWindowConsole=function(){globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.getConsoleWithJSNLog().log,globalThis.console.info=this.getConsoleWithJSNLog().info,globalThis.console.debug=this.getConsoleWithJSNLog().debug,globalThis.console.warn=this.getConsoleWithJSNLog().warn,globalThis.console.error=this.getConsoleWithJSNLog().error},t.prototype.disableLogger=function(){di.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.defaultConsoleLogger.log,globalThis.console.info=this.defaultConsoleLogger.info,globalThis.console.debug=this.defaultConsoleLogger.debug,globalThis.console.warn=this.defaultConsoleLogger.warn,globalThis.console.error=this.defaultConsoleLogger.error},t.prototype.log=function(){this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,di.JL)().info(arguments)},t.prototype.debug=function(){this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},t.prototype.info=function(){this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,di.JL)().info(arguments)},t.prototype.warn=function(){this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,di.JL)().warn(arguments)},t.prototype.error=function(){this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,di.JL)().error(arguments)},t.prototype.flush=function(){this.isJSNLogSetup&&this.currentAppender!=null&&this.currentAppender.sendBatch()},t.prototype.enableProdMode=function(){this.isProdMode=!0},t}();An.OpenViduLogger=Nde;var Yi={},Lv={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */Lv.exports;(function(t,n){(function(){var e={function:!0,object:!0},r=e[typeof window]&&window||this,i=n,o=t&&!t.nodeType&&t,a=i&&o&&typeof ve=="object"&&ve;a&&(a.global===a||a.window===a||a.self===a)&&(r=a);var s=Math.pow(2,53)-1,u=/\bOpera/,l=Object.prototype,c=l.hasOwnProperty,d=l.toString;function f(S){return S=String(S),S.charAt(0).toUpperCase()+S.slice(1)}function p(S,k,N){var M={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return k&&N&&/^Win/i.test(S)&&!/^Windows Phone /i.test(S)&&(M=M[/[\d.]+$/.exec(S)])&&(S="Windows "+M),S=String(S),k&&N&&(S=S.replace(RegExp(k,"i"),N)),S=v(S.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),S}function h(S,k){var N=-1,M=S?S.length:0;if(typeof M=="number"&&M>-1&&M<=s)for(;++N<M;)k(S[N],N,S);else g(S,k)}function v(S){return S=x(S),/^(?:webOS|i(?:OS|P))/.test(S)?S:f(S)}function g(S,k){for(var N in S)c.call(S,N)&&k(S[N],N,S)}function m(S){return S==null?f(S):d.call(S).slice(8,-1)}function y(S,k){var N=S!=null?typeof S[k]:"number";return!/^(?:boolean|number|string|undefined)$/.test(N)&&(N=="object"?!!S[k]:!0)}function b(S){return String(S).replace(/([ -])(?!$)/g,"$1?")}function w(S,k){var N=null;return h(S,function(M,D){N=k(N,M,D,S)}),N}function x(S){return String(S).replace(/^ +| +$/g,"")}function C(S){var k=r,N=S&&typeof S=="object"&&m(S)!="String";N&&(k=S,S=null);var M=k.navigator||{},D=M.userAgent||"";S||(S=D);var T=N?!!M.likeChrome:/\bChrome\b/.test(S)&&!/internal|\n/i.test(d.toString()),O="Object",P=N?O:"ScriptBridgingProxyObject",A=N?O:"Environment",I=N&&k.java?"JavaPackage":m(k.java),_=N?O:"RuntimeObject",F=/\bJava/.test(I)&&k.java,L=F&&m(k.environment)==A,H=F?"a":"α",B=F?"b":"β",q=k.document||{},G=k.operamini||k.opera,re=u.test(re=N&&G?G["[[Class]]"]:m(G))?re:G=null,j,ae=S,ne=[],le=null,xe=S==D,se=xe&&G&&typeof G.version=="function"&&G.version(),we,de=On([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Z=Me(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),ge=wt([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),be=pn({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),fe=tt(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function On(rt){return w(rt,function(ot,Ge){return ot||RegExp("\\b"+(Ge.pattern||b(Ge))+"\\b","i").exec(S)&&(Ge.label||Ge)})}function pn(rt){return w(rt,function(ot,Ge,Ct){return ot||(Ge[ge]||Ge[/^[a-z]+(?: +[a-z]+\b)*/i.exec(ge)]||RegExp("\\b"+b(Ct)+"(?:\\b|\\w*\\d)","i").exec(S))&&Ct})}function Me(rt){return w(rt,function(ot,Ge){return ot||RegExp("\\b"+(Ge.pattern||b(Ge))+"\\b","i").exec(S)&&(Ge.label||Ge)})}function tt(rt){return w(rt,function(ot,Ge){var Ct=Ge.pattern||b(Ge);return!ot&&(ot=RegExp("\\b"+Ct+"(?:/[\\d.]+|[ \\w.]*)","i").exec(S))&&(ot=p(ot,Ct,Ge.label||Ge)),ot})}function wt(rt){return w(rt,function(ot,Ge){var Ct=Ge.pattern||b(Ge);return!ot&&(ot=RegExp("\\b"+Ct+" *\\d+[.\\w_]*","i").exec(S)||RegExp("\\b"+Ct+" *\\w+-[\\w]*","i").exec(S)||RegExp("\\b"+Ct+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(S))&&((ot=String(Ge.label&&!RegExp(Ct,"i").test(Ge.label)?Ge.label:ot).split("/"))[1]&&!/[\d.]+/.test(ot[0])&&(ot[0]+=" "+ot[1]),Ge=Ge.label||Ge,ot=v(ot[0].replace(RegExp(Ct,"i"),Ge).replace(RegExp("; *(?:"+Ge+"[_-])?","i")," ").replace(RegExp("("+Ge+")[-_.]?(\\w)","i"),"$1 $2"))),ot})}function Te(rt){return w(rt,function(ot,Ge){return ot||(RegExp(Ge+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(S)||0)[1]||null})}function nt(){return this.description||""}if(de&&(de=[de]),/\bAndroid\b/.test(fe)&&!ge&&(j=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(S))&&(ge=x(j[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),be&&!ge?ge=wt([be]):be&&ge&&(ge=ge.replace(RegExp("^("+b(be)+")[-_.\\s]","i"),be+" ").replace(RegExp("^("+b(be)+")[-_.]?(\\w)","i"),be+" $2")),(j=/\bGoogle TV\b/.exec(ge))&&(ge=j[0]),/\bSimulator\b/i.test(S)&&(ge=(ge?ge+" ":"")+"Simulator"),Z=="Opera Mini"&&/\bOPiOS\b/.test(S)&&ne.push("running in Turbo/Uncompressed mode"),Z=="IE"&&/\blike iPhone OS\b/.test(S)?(j=C(S.replace(/like iPhone OS/,"")),be=j.manufacturer,ge=j.product):/^iP/.test(ge)?(Z||(Z="Safari"),fe="iOS"+((j=/ OS ([\d_]+)/i.exec(S))?" "+j[1].replace(/_/g,"."):"")):Z=="Konqueror"&&/^Linux\b/i.test(fe)?fe="Kubuntu":be&&be!="Google"&&(/Chrome/.test(Z)&&!/\bMobile Safari\b/i.test(S)||/\bVita\b/.test(ge))||/\bAndroid\b/.test(fe)&&/^Chrome/.test(Z)&&/\bVersion\//i.test(S)?(Z="Android Browser",fe=/\bAndroid\b/.test(fe)?fe:"Android"):Z=="Silk"?(/\bMobi/i.test(S)||(fe="Android",ne.unshift("desktop mode")),/Accelerated *= *true/i.test(S)&&ne.unshift("accelerated")):Z=="UC Browser"&&/\bUCWEB\b/.test(S)?ne.push("speed mode"):Z=="PaleMoon"&&(j=/\bFirefox\/([\d.]+)\b/.exec(S))?ne.push("identifying as Firefox "+j[1]):Z=="Firefox"&&(j=/\b(Mobile|Tablet|TV)\b/i.exec(S))?(fe||(fe="Firefox OS"),ge||(ge=j[1])):!Z||(j=!/\bMinefield\b/i.test(S)&&/\b(?:Firefox|Safari)\b/.exec(Z))?(Z&&!ge&&/[\/,]|^[^(]+?\)/.test(S.slice(S.indexOf(j+"/")+8))&&(Z=null),(j=ge||be||fe)&&(ge||be||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(fe))&&(Z=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(fe)?fe:j)+" Browser")):Z=="Electron"&&(j=(/\bChrome\/([\d.]+)\b/.exec(S)||0)[1])&&ne.push("Chromium "+j),se||(se=Te(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",b(Z),"(?:Firefox|Minefield|NetFront)"])),(j=de=="iCab"&&parseFloat(se)>3&&"WebKit"||/\bOpera\b/.test(Z)&&(/\bOPR\b/.test(S)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(S)&&!/^(?:Trident|EdgeHTML)$/.test(de)&&"WebKit"||!de&&/\bMSIE\b/i.test(S)&&(fe=="Mac OS"?"Tasman":"Trident")||de=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Z)&&"NetFront")&&(de=[j]),Z=="IE"&&(j=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(S)||0)[1])?(Z+=" Mobile",fe="Windows Phone "+(/\+$/.test(j)?j:j+".x"),ne.unshift("desktop mode")):/\bWPDesktop\b/i.test(S)?(Z="IE Mobile",fe="Windows Phone 8.x",ne.unshift("desktop mode"),se||(se=(/\brv:([\d.]+)/.exec(S)||0)[1])):Z!="IE"&&de=="Trident"&&(j=/\brv:([\d.]+)/.exec(S))&&(Z&&ne.push("identifying as "+Z+(se?" "+se:"")),Z="IE",se=j[1]),xe){if(y(k,"global"))if(F&&(j=F.lang.System,ae=j.getProperty("os.arch"),fe=fe||j.getProperty("os.name")+" "+j.getProperty("os.version")),L){try{se=k.require("ringo/engine").version.join("."),Z="RingoJS"}catch{(j=k.system)&&j.global.system==k.system&&(Z="Narwhal",fe||(fe=j[0].os||null))}Z||(Z="Rhino")}else typeof k.process=="object"&&!k.process.browser&&(j=k.process)&&(typeof j.versions=="object"&&(typeof j.versions.electron=="string"?(ne.push("Node "+j.versions.node),Z="Electron",se=j.versions.electron):typeof j.versions.nw=="string"&&(ne.push("Chromium "+se,"Node "+j.versions.node),Z="NW.js",se=j.versions.nw)),Z||(Z="Node.js",ae=j.arch,fe=j.platform,se=/[\d.]+/.exec(j.version),se=se?se[0]:null));else m(j=k.runtime)==P?(Z="Adobe AIR",fe=j.flash.system.Capabilities.os):m(j=k.phantom)==_?(Z="PhantomJS",se=(j=j.version||null)&&j.major+"."+j.minor+"."+j.patch):typeof q.documentMode=="number"&&(j=/\bTrident\/(\d+)/i.exec(S))?(se=[se,q.documentMode],(j=+j[1]+4)!=se[1]&&(ne.push("IE "+se[1]+" mode"),de&&(de[1]=""),se[1]=j),se=Z=="IE"?String(se[1].toFixed(1)):se[0]):typeof q.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Z)&&(ne.push("masking as "+Z+" "+se),Z="IE",se="11.0",de=["Trident"],fe="Windows");fe=fe&&v(fe)}if(se&&(j=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(se)||/(?:alpha|beta)(?: ?\d)?/i.exec(S+";"+(xe&&M.appMinorVersion))||/\bMinefield\b/i.test(S)&&"a")&&(le=/b/i.test(j)?"beta":"alpha",se=se.replace(RegExp(j+"\\+?$"),"")+(le=="beta"?B:H)+(/\d+\+?/.exec(j)||"")),Z=="Fennec"||Z=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(fe))Z="Firefox Mobile";else if(Z=="Maxthon"&&se)se=se.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(ge))ge=="Xbox 360"&&(fe=null),ge=="Xbox 360"&&/\bIEMobile\b/.test(S)&&ne.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(Z)||Z&&!ge&&!/Browser|Mobi/.test(Z))&&(fe=="Windows CE"||/Mobi/i.test(S)))Z+=" Mobile";else if(Z=="IE"&&xe)try{k.external===null&&ne.unshift("platform preview")}catch{ne.unshift("embedded")}else(/\bBlackBerry\b/.test(ge)||/\bBB10\b/.test(S))&&(j=(RegExp(ge.replace(/ +/g," *")+"/([.\\d]+)","i").exec(S)||0)[1]||se)?(j=[j,/BB10/.test(S)],fe=(j[1]?(ge=null,be="BlackBerry"):"Device Software")+" "+j[0],se=null):this!=g&&ge!="Wii"&&(xe&&G||/Opera/.test(Z)&&/\b(?:MSIE|Firefox)\b/i.test(S)||Z=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(fe)||Z=="IE"&&(fe&&!/^Win/.test(fe)&&se>5.5||/\bWindows XP\b/.test(fe)&&se>8||se==8&&!/\bTrident\b/.test(S)))&&!u.test(j=C.call(g,S.replace(u,"")+";"))&&j.name&&(j="ing as "+j.name+((j=j.version)?" "+j:""),u.test(Z)?(/\bIE\b/.test(j)&&fe=="Mac OS"&&(fe=null),j="identify"+j):(j="mask"+j,re?Z=v(re.replace(/([a-z])([A-Z])/g,"$1 $2")):Z="Opera",/\bIE\b/.test(j)&&(fe=null),xe||(se=null)),de=["Presto"],ne.push(j));(j=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(S)||0)[1])&&(j=[parseFloat(j.replace(/\.(\d)$/,".0$1")),j],Z=="Safari"&&j[1].slice(-1)=="+"?(Z="WebKit Nightly",le="alpha",se=j[1].slice(0,-1)):(se==j[1]||se==(j[2]=(/\bSafari\/([\d.]+\+?)/i.exec(S)||0)[1]))&&(se=null),j[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(S)||0)[1],j[0]==537.36&&j[2]==537.36&&parseFloat(j[1])>=28&&de=="WebKit"&&(de=["Blink"]),!xe||!T&&!j[1]?(de&&(de[1]="like Safari"),j=(j=j[0],j<400?1:j<500?2:j<526?3:j<533?4:j<534?"4+":j<535?5:j<537?6:j<538?7:j<601?8:j<602?9:j<604?10:j<606?11:j<608?12:"12")):(de&&(de[1]="like Chrome"),j=j[1]||(j=j[0],j<530?1:j<532?2:j<532.05?3:j<533?4:j<534.03?5:j<534.07?6:j<534.1?7:j<534.13?8:j<534.16?9:j<534.24?10:j<534.3?11:j<535.01?12:j<535.02?"13+":j<535.07?15:j<535.11?16:j<535.19?17:j<536.05?18:j<536.1?19:j<537.01?20:j<537.11?"21+":j<537.13?23:j<537.18?24:j<537.24?25:j<537.36?26:de!="Blink"?"27":"28")),de&&(de[1]+=" "+(j+=typeof j=="number"?".x":/[.+]/.test(j)?"":"+")),Z=="Safari"&&(!se||parseInt(se)>45)?se=j:Z=="Chrome"&&/\bHeadlessChrome/i.test(S)&&ne.unshift("headless")),Z=="Opera"&&(j=/\bzbov|zvav$/.exec(fe))?(Z+=" ",ne.unshift("desktop mode"),j=="zvav"?(Z+="Mini",se=null):Z+="Mobile",fe=fe.replace(RegExp(" *"+j+"$"),"")):Z=="Safari"&&/\bChrome\b/.exec(de&&de[1])?(ne.unshift("desktop mode"),Z="Chrome Mobile",se=null,/\bOS X\b/.test(fe)?(be="Apple",fe="iOS 4.3+"):fe=null):/\bSRWare Iron\b/.test(Z)&&!se&&(se=Te("Chrome")),se&&se.indexOf(j=/[\d.]+$/.exec(fe))==0&&S.indexOf("/"+j+"-")>-1&&(fe=x(fe.replace(j,""))),fe&&fe.indexOf(Z)!=-1&&!RegExp(Z+" OS").test(fe)&&(fe=fe.replace(RegExp(" *"+b(Z)+" *"),"")),de&&!/\b(?:Avant|Nook)\b/.test(Z)&&(/Browser|Lunascape|Maxthon/.test(Z)||Z!="Safari"&&/^iOS/.test(fe)&&/\bSafari\b/.test(de[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Z)&&de[1])&&(j=de[de.length-1])&&ne.push(j),ne.length&&(ne=["("+ne.join("; ")+")"]),be&&ge&&ge.indexOf(be)<0&&ne.push("on "+be),ge&&ne.push((/^on /.test(ne[ne.length-1])?"":"on ")+ge),fe&&(j=/ ([\d.+]+)$/.exec(fe),we=j&&fe.charAt(fe.length-j[0].length-1)=="/",fe={architecture:32,family:j&&!we?fe.replace(j[0],""):fe,version:j?j[1]:null,toString:function(){var rt=this.version;return this.family+(rt&&!we?" "+rt:"")+(this.architecture==64?" 64-bit":"")}}),(j=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(ae))&&!/\bi686\b/i.test(ae)?(fe&&(fe.architecture=64,fe.family=fe.family.replace(RegExp(" *"+j),"")),Z&&(/\bWOW64\b/i.test(S)||xe&&/\w(?:86|32)$/.test(M.cpuClass||M.platform)&&!/\bWin64; x64\b/i.test(S))&&ne.unshift("32-bit")):fe&&/^OS X/.test(fe.family)&&Z=="Chrome"&&parseFloat(se)>=39&&(fe.architecture=64),S||(S=null);var Le={};return Le.description=S,Le.layout=de&&de[0],Le.manufacturer=be,Le.name=Z,Le.prerelease=le,Le.product=ge,Le.ua=S,Le.version=Z&&se,Le.os=fe||{architecture:null,family:null,version:null,toString:function(){return"null"}},Le.parse=C,Le.toString=nt,Le.version&&ne.unshift(se),Le.name&&ne.unshift(Z),fe&&Z&&!(fe==String(fe).split(" ")[0]&&(fe==Z.split(" ")[0]||ge))&&ne.push(ge?"("+fe+")":"on "+fe),ne.length&&(Le.description=ne.join(" ")),Le}var E=C();i&&o?g(E,function(S,k){i[k]=S}):r.platform=E}).call(ve)})(Lv,Lv.exports);var kde=Lv.exports;Object.defineProperty(Yi,"__esModule",{value:!0});Yi.PlatformUtils=void 0;var qe=kde,Ide=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),t.instance},t.prototype.isChromeBrowser=function(){return qe.name==="Chrome"},t.prototype.isSafariBrowser=function(){return qe.name==="Safari"},t.prototype.isChromeMobileBrowser=function(){return qe.name==="Chrome Mobile"},t.prototype.isFirefoxBrowser=function(){return qe.name==="Firefox"},t.prototype.isFirefoxMobileBrowser=function(){return qe.name==="Firefox Mobile"||qe.name==="Firefox for iOS"},t.prototype.isOperaBrowser=function(){return qe.name==="Opera"},t.prototype.isOperaMobileBrowser=function(){return qe.name==="Opera Mobile"},t.prototype.isEdgeBrowser=function(){var n=qe!=null&&qe.version?parseFloat(qe.version):-1;return qe.name==="Microsoft Edge"&&n>=80},t.prototype.isEdgeMobileBrowser=function(){var n,e,r=qe!=null&&qe.version?parseFloat(qe.version):-1;return qe.name==="Microsoft Edge"&&(((n=qe.os)===null||n===void 0?void 0:n.family)==="Android"||((e=qe.os)===null||e===void 0?void 0:e.family)==="iOS")&&r>45},t.prototype.isAndroidBrowser=function(){return qe.name==="Android Browser"},t.prototype.isElectron=function(){return qe.name==="Electron"},t.prototype.isNodeJs=function(){return qe.name==="Node.js"},t.prototype.isSamsungBrowser=function(){return qe.name==="Samsung Internet Mobile"||qe.name==="Samsung Internet"},t.prototype.isMotorolaEdgeDevice=function(){var n;return((n=qe.product)===null||n===void 0?void 0:n.toLowerCase().includes("motorola edge"))||!1},t.prototype.isIPhoneOrIPad=function(){var n=qe.ua?qe.ua:navigator.userAgent,e="ontouchend"in document,r=/\b(\w*Macintosh\w*)\b/.test(n)&&e,i=/\b(\w*iPhone\w*)\b/.test(n)&&/\b(\w*Mobile\w*)\b/.test(n)&&e;return r||i},t.prototype.isIOSWithSafari=function(){var n=qe.ua?qe.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(n)&&!/\b(\w*CriOS\w*)\b/.test(n)&&!/\b(\w*FxiOS\w*)\b/.test(n)},t.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&qe.ua.indexOf("Safari")===-1},t.prototype.isIonicAndroid=function(){return qe.os.family==="Android"&&qe.name=="Android Browser"},t.prototype.isMobileDevice=function(){return qe.os.family==="iOS"||qe.os.family==="Android"},t.prototype.isReactNative=function(){return!1},t.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()||this.isMotorolaEdgeDevice()},t.prototype.canScreenShare=function(){var n=qe!=null&&qe.version?parseFloat(qe.version):-1;return this.isMobileDevice()?!1:this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&n>=13},t.prototype.getName=function(){return qe.name||""},t.prototype.getVersion=function(){return qe.version||""},t.prototype.getFamily=function(){return qe.os.family||""},t.prototype.getDescription=function(){return qe.description||""},t}();Yi.PlatformUtils=Ide;function Gy(){this._types=Object.create(null),this._extensions=Object.create(null);for(let t=0;t<arguments.length;t++)this.define(arguments[t]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Gy.prototype.define=function(t,n){for(let e in t){let r=t[e].map(function(i){return i.toLowerCase()});e=e.toLowerCase();for(let i=0;i<r.length;i++){const o=r[i];if(o[0]!=="*"){if(!n&&o in this._types)throw new Error('Attempt to change mapping for "'+o+'" extension from "'+this._types[o]+'" to "'+e+'". Pass `force=true` to allow this, otherwise remove "'+o+'" from the list of extensions for "'+e+'".');this._types[o]=e}}if(n||!this._extensions[e]){const i=r[0];this._extensions[e]=i[0]!=="*"?i:i.substr(1)}}};Gy.prototype.getType=function(t){t=String(t);let n=t.replace(/^.*[/\\]/,"").toLowerCase(),e=n.replace(/^.*\./,"").toLowerCase(),r=n.length<t.length;return(e.length<n.length-1||!r)&&this._types[e]||null};Gy.prototype.getExtension=function(t){return t=/^\s*([^;\s]*)/.test(t)&&RegExp.$1,t&&this._extensions[t.toLowerCase()]||null};var _de=Gy,Ade={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};let Ode=_de;var Dde=new Ode(Ade);Object.defineProperty(zp,"__esModule",{value:!0});zp.LocalRecorder=void 0;var Mn=cR,Mde=An,Pde=Yi,VI=Dde,Is=Mde.OpenViduLogger.getInstance(),$I,Lde=function(){function t(n){this.stream=n,this.chunks=[],$I=Pde.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=Mn.LocalRecorderState.READY}return t.prototype.record=function(n){var e=this;return new Promise(function(r,i){try{if(typeof n=="string"||n instanceof String)return i(`When calling LocalRecorder.record(options) parameter 'options' cannot be a string. Must be an object like { mimeType: "`.concat(n,'" }'));if(typeof MediaRecorder>"u")throw Is.error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder");if(e.state!==Mn.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+e.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");Is.log("Starting local recording of stream '"+e.stream.streamId+"' of connection '"+e.connectionId+"'"),n?n.mimeType||(n.mimeType="video/webm"):n={mimeType:"video/webm"},e.mediaRecorder=new MediaRecorder(e.stream.getMediaStream(),n),e.mediaRecorder.start()}catch(o){return i(o)}return e.mediaRecorder.ondataavailable=function(o){o.data.size>0&&e.chunks.push(o.data)},e.mediaRecorder.onerror=function(o){Is.error("MediaRecorder error: ",o)},e.mediaRecorder.onstart=function(){Is.log("MediaRecorder started (state="+e.mediaRecorder.state+")")},e.mediaRecorder.onstop=function(){e.onStopDefault()},e.mediaRecorder.onpause=function(){Is.log("MediaRecorder paused (state="+e.mediaRecorder.state+")")},e.mediaRecorder.onresume=function(){Is.log("MediaRecorder resumed (state="+e.mediaRecorder.state+")")},e.state=Mn.LocalRecorderState.RECORDING,r()})},t.prototype.stop=function(){var n=this;return new Promise(function(e,r){try{if(n.state===Mn.LocalRecorderState.READY||n.state===Mn.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+n.state+"'). Call 'LocalRecorder.start()' before");n.mediaRecorder.onstop=function(){return n.onStopDefault(),e()},n.mediaRecorder.stop()}catch(i){return r(i)}})},t.prototype.pause=function(){var n=this;return new Promise(function(e,r){try{return n.state!==Mn.LocalRecorderState.RECORDING?r(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+n.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before")):(n.mediaRecorder.pause(),n.state=Mn.LocalRecorderState.PAUSED,e())}catch(i){return r(i)}})},t.prototype.resume=function(){var n=this;return new Promise(function(e,r){try{if(n.state!==Mn.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+n.state+"'). Call 'LocalRecorder.pause()' before");return n.mediaRecorder.resume(),n.state=Mn.LocalRecorderState.RECORDING,e()}catch(i){return r(i)}})},t.prototype.preview=function(n){if(this.state!==Mn.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,$I.isSafariBrowser()&&(this.videoPreview.playsInline=!0),typeof n=="string"){var e=document.getElementById(n);e&&(this.videoPreview=e.appendChild(this.videoPreview))}else this.videoPreview=n.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},t.prototype.clean=function(){var n=this,e=function(){delete n.blob,n.chunks=[],n.state=Mn.LocalRecorderState.READY};this.state===Mn.LocalRecorderState.RECORDING||this.state===Mn.LocalRecorderState.PAUSED?this.stop().then(function(){return e()}).catch(function(){return e()}):e()},t.prototype.download=function(){if(this.state!==Mn.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var n=document.createElement("a");n.style.display="none",document.body.appendChild(n);var e=globalThis.URL.createObjectURL(this.blob);n.href=e,n.download=this.id+"."+VI.getExtension(this.blob.type),n.click(),globalThis.URL.revokeObjectURL(e),document.body.removeChild(n)},t.prototype.getBlob=function(){if(this.state!==Mn.LocalRecorderState.FINISHED)throw Error("Call 'LocalRecord.stop()' before getting Blob file");return this.blob},t.prototype.uploadAsBinary=function(n,e){var r=this;return new Promise(function(i,o){if(r.state!==Mn.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+r.state+"'). Call 'LocalRecorder.stop()' before"));var a=new XMLHttpRequest;if(a.open("POST",n,!0),typeof e=="object")for(var s=0,u=Object.keys(e);s<u.length;s++){var l=u[s];a.setRequestHeader(l,e[l])}a.onreadystatechange=function(){if(a.readyState===4)return a.status.toString().charAt(0)==="2"?i(a.responseText):o(a.status)},a.send(r.blob)})},t.prototype.uploadAsMultipartfile=function(n,e){var r=this;return new Promise(function(i,o){if(r.state!==Mn.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+r.state+"'). Call 'LocalRecorder.stop()' before"));var a=new XMLHttpRequest;if(a.open("POST",n,!0),typeof e=="object")for(var s=0,u=Object.keys(e);s<u.length;s++){var l=u[s];a.setRequestHeader(l,e[l])}var c=new FormData;c.append("file",r.blob,r.id+"."+VI.getExtension(r.blob.type)),a.onreadystatechange=function(){if(a.readyState===4)return a.status.toString().charAt(0)==="2"?i(a.responseText):o(a.status)},a.send(c)})},t.prototype.onStopDefault=function(){Is.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:this.mediaRecorder.mimeType}),this.chunks=[],this.videoPreviewSrc=globalThis.URL.createObjectURL(this.blob),this.state=Mn.LocalRecorderState.FINISHED},t}();zp.LocalRecorder=Lde;var Cd={},Rd={},Bp={},Bc={},jc={},ma={},$n={};Object.defineProperty($n,"__esModule",{value:!0});$n.Event=void 0;var Fde=function(){function t(n,e,r){this.hasBeenPrevented=!1,this.cancelable=n,this.target=e,this.type=r}return t.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},t.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},t}();$n.Event=Fde;var zde=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(ma,"__esModule",{value:!0});ma.StreamPropertyChangedEvent=void 0;var Bde=$n,jde=function(t){zde(n,t);function n(e,r,i,o,a,s){var u=t.call(this,!1,e,"streamPropertyChanged")||this;return u.stream=r,u.changedProperty=i,u.newValue=o,u.oldValue=a,u.reason=s,u}return n.prototype.callDefaultBehavior=function(){},n}(Bde.Event);ma.StreamPropertyChangedEvent=jde;var Fu={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduError=t.OpenViduErrorName=void 0,function(e){e.BROWSER_NOT_SUPPORTED="BROWSER_NOT_SUPPORTED",e.DEVICE_ACCESS_DENIED="DEVICE_ACCESS_DENIED",e.DEVICE_ALREADY_IN_USE="DEVICE_ALREADY_IN_USE",e.SCREEN_CAPTURE_DENIED="SCREEN_CAPTURE_DENIED",e.SCREEN_SHARING_NOT_SUPPORTED="SCREEN_SHARING_NOT_SUPPORTED",e.SCREEN_EXTENSION_NOT_INSTALLED="SCREEN_EXTENSION_NOT_INSTALLED",e.SCREEN_EXTENSION_DISABLED="SCREEN_EXTENSION_DISABLED",e.INPUT_VIDEO_DEVICE_NOT_FOUND="INPUT_VIDEO_DEVICE_NOT_FOUND",e.INPUT_AUDIO_DEVICE_NOT_FOUND="INPUT_AUDIO_DEVICE_NOT_FOUND",e.INPUT_AUDIO_DEVICE_GENERIC_ERROR="INPUT_AUDIO_DEVICE_GENERIC_ERROR",e.NO_INPUT_SOURCE_SET="NO_INPUT_SOURCE_SET",e.PUBLISHER_PROPERTIES_ERROR="PUBLISHER_PROPERTIES_ERROR",e.OPENVIDU_PERMISSION_DENIED="OPENVIDU_PERMISSION_DENIED",e.OPENVIDU_NOT_CONNECTED="OPENVIDU_NOT_CONNECTED",e.VIRTUAL_BACKGROUND_ERROR="VIRTUAL_BACKGROUND_ERROR",e.GENERIC_ERROR="GENERIC_ERROR"}(t.OpenViduErrorName||(t.OpenViduErrorName={}));var n=function(){function e(r,i){this.name=r,this.message=i}return e}();t.OpenViduError=n})(Fu);Object.defineProperty(jc,"__esModule",{value:!0});jc.Filter=void 0;var UI=ma,er=Fu,Vde=An,Qi=Vde.OpenViduLogger.getInstance(),$de=function(){function t(n,e){this.handlers=new Map,this.type=n,this.options=e}return t.prototype.execMethod=function(n,e){var r=this;return new Promise(function(i,o){var a;Qi.info("Executing filter method to stream "+r.stream.streamId);var s,u=function(d){Qi.info("Filter method successfully executed on Stream "+r.stream.streamId);var f=Object.assign({},r.stream.filter);return r.stream.filter.lastExecMethod={method:n,params:s},d&&(r.stream.session.emitEvent("streamPropertyChanged",[new UI.StreamPropertyChangedEvent(r.stream.session,r.stream,"filter",r.stream.filter,f,"execFilterMethod")]),r.stream.streamManager.emitEvent("streamPropertyChanged",[new UI.StreamPropertyChangedEvent(r.stream.streamManager,r.stream,"filter",r.stream.filter,f,"execFilterMethod")])),i()};if(r.type.startsWith("VB:")){if(typeof e=="string")try{e=JSON.parse(e)}catch(d){return o(new er.OpenViduError(er.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Wrong params syntax: "+d))}if(s=e,n==="update")if(!((a=r.stream.virtualBackgroundSinkElements)===null||a===void 0)&&a.VB)r.stream.virtualBackgroundSinkElements.VB.updateValues(e).then(function(){return u(!1)}).catch(function(d){return d.name===er.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?o(new er.OpenViduError(d.name,d.message)):o(new er.OpenViduError(er.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Error updating values on Virtual Background filter: "+d))});else return o(new er.OpenViduError(er.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"There is no Virtual Background filter applied"));else return o(new er.OpenViduError(er.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Unknown Virtual Background method "'.concat(n,'"')))}else{var l=void 0;if(typeof e!="string")try{l=JSON.stringify(e)}catch{var c="'params' property must be a JSON formatted object";return Qi.error(c),o(c)}else l=e;s=l,r.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:r.stream.streamId,method:n,params:l},function(d,f){return d?(Qi.error("Error executing filter method for Stream "+r.stream.streamId,d),d.code===401?o(new er.OpenViduError(er.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):o(d)):u(!0)})}})},t.prototype.addEventListener=function(n,e){var r=this;return new Promise(function(i,o){Qi.info("Adding filter event listener to event "+n+" to stream "+r.stream.streamId),r.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:r.stream.streamId,eventType:n},function(a,s){return a?(Qi.error("Error adding filter event listener to event "+n+"for Stream "+r.stream.streamId,a),a.code===401?o(new er.OpenViduError(er.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):o(a)):(r.handlers.set(n,e),Qi.info("Filter event listener to event "+n+" successfully applied on Stream "+r.stream.streamId),i())})})},t.prototype.removeEventListener=function(n){var e=this;return new Promise(function(r,i){Qi.info("Removing filter event listener to event "+n+" to stream "+e.stream.streamId),e.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:e.stream.streamId,eventType:n},function(o,a){return o?(Qi.error("Error removing filter event listener to event "+n+"for Stream "+e.stream.streamId,o),o.code===401?i(new er.OpenViduError(er.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):i(o)):(e.handlers.delete(n),Qi.info("Filter event listener to event "+n+" successfully removed on Stream "+e.stream.streamId),r())})})},t}();jc.Filter=$de;var Vc={},$c={},Uc={},KB={exports:{}};/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(t){(function(n){function e(){}var r=e.prototype,i=n.EventEmitter;function o(u,l){for(var c=u.length;c--;)if(u[c].listener===l)return c;return-1}function a(u){return function(){return this[u].apply(this,arguments)}}r.getListeners=function(l){var c=this._getEvents(),d,f;if(l instanceof RegExp){d={};for(f in c)c.hasOwnProperty(f)&&l.test(f)&&(d[f]=c[f])}else d=c[l]||(c[l]=[]);return d},r.flattenListeners=function(l){var c=[],d;for(d=0;d<l.length;d+=1)c.push(l[d].listener);return c},r.getListenersAsObject=function(l){var c=this.getListeners(l),d;return c instanceof Array&&(d={},d[l]=c),d||c};function s(u){return typeof u=="function"||u instanceof RegExp?!0:u&&typeof u=="object"?s(u.listener):!1}r.addListener=function(l,c){if(!s(c))throw new TypeError("listener must be a function");var d=this.getListenersAsObject(l),f=typeof c=="object",p;for(p in d)d.hasOwnProperty(p)&&o(d[p],c)===-1&&d[p].push(f?c:{listener:c,once:!1});return this},r.on=a("addListener"),r.addOnceListener=function(l,c){return this.addListener(l,{listener:c,once:!0})},r.once=a("addOnceListener"),r.defineEvent=function(l){return this.getListeners(l),this},r.defineEvents=function(l){for(var c=0;c<l.length;c+=1)this.defineEvent(l[c]);return this},r.removeListener=function(l,c){var d=this.getListenersAsObject(l),f,p;for(p in d)d.hasOwnProperty(p)&&(f=o(d[p],c),f!==-1&&d[p].splice(f,1));return this},r.off=a("removeListener"),r.addListeners=function(l,c){return this.manipulateListeners(!1,l,c)},r.removeListeners=function(l,c){return this.manipulateListeners(!0,l,c)},r.manipulateListeners=function(l,c,d){var f,p,h=l?this.removeListener:this.addListener,v=l?this.removeListeners:this.addListeners;if(typeof c=="object"&&!(c instanceof RegExp))for(f in c)c.hasOwnProperty(f)&&(p=c[f])&&(typeof p=="function"?h.call(this,f,p):v.call(this,f,p));else for(f=d.length;f--;)h.call(this,c,d[f]);return this},r.removeEvent=function(l){var c=typeof l,d=this._getEvents(),f;if(c==="string")delete d[l];else if(l instanceof RegExp)for(f in d)d.hasOwnProperty(f)&&l.test(f)&&delete d[f];else delete this._events;return this},r.removeAllListeners=a("removeEvent"),r.emitEvent=function(l,c){var d=this.getListenersAsObject(l),f,p,h,v,g;for(v in d)if(d.hasOwnProperty(v))for(f=d[v].slice(0),h=0;h<f.length;h++)p=f[h],p.once===!0&&this.removeListener(l,p.listener),g=p.listener.apply(this,c||[]),g===this._getOnceReturnValue()&&this.removeListener(l,p.listener);return this},r.trigger=a("emitEvent"),r.emit=function(l){var c=Array.prototype.slice.call(arguments,1);return this.emitEvent(l,c)},r.setOnceReturnValue=function(l){return this._onceReturnValue=l,this},r._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},r._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return n.EventEmitter=i,e},t.exports?t.exports=e:n.EventEmitter=e})(typeof window<"u"?window:ve||{})})(KB);var fR=KB.exports;Object.defineProperty(Uc,"__esModule",{value:!0});Uc.EventDispatcher=void 0;var Ude=An,Wde=fR,Bh=Ude.OpenViduLogger.getInstance(),Hde=function(){function t(){this.userHandlerArrowHandler=new WeakMap,this.ee=new Wde}return t.prototype.onAux=function(n,e,r){var i=function(o){o?Bh.debug(e,o):Bh.debug(e),r(o)};return this.userHandlerArrowHandler.set(r,i),this.ee.on(n,i),this},t.prototype.onceAux=function(n,e,r){var i=this,o=function(a){a?Bh.debug(e,a):Bh.debug(e),r(a),i.userHandlerArrowHandler.delete(r)};return this.userHandlerArrowHandler.set(r,o),this.ee.once(n,o),this},t.prototype.offAux=function(n,e){if(!e)this.ee.removeAllListeners(n);else{var r=this.userHandlerArrowHandler.get(e);r&&this.ee.off(n,r),this.userHandlerArrowHandler.delete(e)}return this},t}();Uc.EventDispatcher=Hde;var Wc={},Gde=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Wc,"__esModule",{value:!0});Wc.StreamManagerEvent=void 0;var qde=$n,Kde=function(t){Gde(n,t);function n(e,r,i){var o=t.call(this,!1,e,r)||this;return o.value=i,o}return n.prototype.callDefaultBehavior=function(){},n}(qde.Event);Wc.StreamManagerEvent=Kde;var jp={},Xde=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(jp,"__esModule",{value:!0});jp.VideoElementEvent=void 0;var Yde=$n,Jde=function(t){Xde(n,t);function n(e,r,i){var o=t.call(this,!1,r,i)||this;return o.element=e,o}return n.prototype.callDefaultBehavior=function(){},n}(Yde.Event);jp.VideoElementEvent=Jde;var zu={};(function(t){var n=ve&&ve.__extends||function(){var i=function(o,a){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,u){s.__proto__=u}||function(s,u){for(var l in u)Object.prototype.hasOwnProperty.call(u,l)&&(s[l]=u[l])},i(o,a)};return function(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");i(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ExceptionEvent=t.ExceptionEventName=void 0;var e=$n;(function(i){i.ICE_CANDIDATE_ERROR="ICE_CANDIDATE_ERROR",i.ICE_CONNECTION_FAILED="ICE_CONNECTION_FAILED",i.ICE_CONNECTION_DISCONNECTED="ICE_CONNECTION_DISCONNECTED",i.NO_STREAM_PLAYING_EVENT="NO_STREAM_PLAYING_EVENT",i.SPEECH_TO_TEXT_DISCONNECTED="SPEECH_TO_TEXT_DISCONNECTED"})(t.ExceptionEventName||(t.ExceptionEventName={}));var r=function(i){n(o,i);function o(a,s,u,l,c){var d=i.call(this,!1,a,"exception")||this;return d.name=s,d.origin=u,d.message=l,d.data=c,d}return o.prototype.callDefaultBehavior=function(){},o}(e.Event);t.ExceptionEvent=r})(zu);var Vp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.VideoInsertMode=void 0,function(n){n.AFTER="AFTER",n.APPEND="APPEND",n.BEFORE="BEFORE",n.PREPEND="PREPEND",n.REPLACE="REPLACE"}(t.VideoInsertMode||(t.VideoInsertMode={}))})(Vp);var Qde=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty($c,"__esModule",{value:!0});$c.StreamManager=void 0;var Zde=Uc,z1=Wc,jh=jp,WI=zu,_s=Vp,efe=An,tfe=Yi,B1=efe.OpenViduLogger.getInstance(),fr,nfe=function(t){Qde(n,t);function n(e,r){var i=t.call(this)||this;if(i.videos=[],i.lazyLaunchVideoElementCreatedEvent=!1,fr=tfe.PlatformUtils.getInstance(),i.stream=e,i.stream.streamManager=i,i.remote=!i.stream.isLocal(),r){var o=void 0;typeof r=="string"?o=document.getElementById(r):r instanceof HTMLElement&&(o=r),o&&(i.firstVideoElement={targetElement:o,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(fr.isSafariBrowser()||fr.isIPhoneOrIPad()&&(fr.isChromeMobileBrowser()||fr.isEdgeMobileBrowser()||fr.isOperaMobileBrowser()||fr.isFirefoxMobileBrowser()))&&(i.firstVideoElement.video.playsInline=!0),i.targetElement=o,i.element=o)}return i.canPlayListener=function(){i.deactivateStreamPlayingEventExceptionTimeout(),i.ee.emitEvent("streamPlaying",[new z1.StreamManagerEvent(i,"streamPlaying",void 0)])},i}return n.prototype.on=function(e,r){return t.prototype.onAux.call(this,e,"Event '"+e+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",r),e==="videoElementCreated"&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new jh.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),e==="streamPlaying"&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&this.ee.emitEvent("streamPlaying",[new z1.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&(e==="publisherStartSpeaking"&&this.stream.enableHarkSpeakingEvent(),e==="publisherStopSpeaking"&&this.stream.enableHarkStoppedSpeakingEvent(),e==="streamAudioVolumeChange"&&this.stream.enableHarkVolumeChangeEvent(!1)),this},n.prototype.once=function(e,r){return t.prototype.onceAux.call(this,e,"Event '"+e+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",r),e==="videoElementCreated"&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new jh.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),e==="streamPlaying"&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&this.videos[0].video.paused===!1&&this.videos[0].video.ended===!1&&this.videos[0].video.readyState===4&&this.ee.emitEvent("streamPlaying",[new z1.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&(e==="publisherStartSpeaking"&&this.stream.enableOnceHarkSpeakingEvent(),e==="publisherStopSpeaking"&&this.stream.enableOnceHarkStoppedSpeakingEvent(),e==="streamAudioVolumeChange"&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},n.prototype.off=function(e,r){if(t.prototype.offAux.call(this,e,r),e==="publisherStartSpeaking"){var i=this.ee.getListeners(e).length+this.stream.session.ee.getListeners(e).length;i===0&&this.stream.disableHarkSpeakingEvent(!1)}if(e==="publisherStopSpeaking"){var o=this.ee.getListeners(e).length+this.stream.session.ee.getListeners(e).length;o===0&&this.stream.disableHarkStoppedSpeakingEvent(!1)}if(e==="streamAudioVolumeChange"){var a=this.ee.getListeners(e).length;a===0&&this.stream.disableHarkVolumeChangeEvent(!1)}return this},n.prototype.addVideoElement=function(e){this.initializeVideoProperties(e),!this.remote&&this.stream.displayMyRemote()&&e.srcObject!==this.stream.getMediaStream()&&(e.srcObject=this.stream.getMediaStream());for(var r=0,i=this.videos;r<i.length;r++){var o=i[r];if(o.video===e)return 0}for(var a=1,s=0,u=this.stream.session.streamManagers;s<u.length;s++){var l=u[s];if(l.disassociateVideo(e)){a=-1;break}}return this.stream.session.streamManagers.forEach(function(c){c.disassociateVideo(e)}),this.pushNewStreamManagerVideo({video:e,id:e.id,canplayListenerAdded:!1}),B1.info("New video element associated to ",this),a},n.prototype.createVideoElement=function(e,r){var i;if(typeof e=="string"){if(i=document.getElementById(e),!i)throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e)}else if(e instanceof HTMLElement)i=e;else throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e);var o=this.createVideo();this.initializeVideoProperties(o);var a=r||_s.VideoInsertMode.APPEND;switch(a){case _s.VideoInsertMode.AFTER:i.parentNode.insertBefore(o,i.nextSibling);break;case _s.VideoInsertMode.APPEND:i.appendChild(o);break;case _s.VideoInsertMode.BEFORE:i.parentNode.insertBefore(o,i);break;case _s.VideoInsertMode.PREPEND:i.insertBefore(o,i.childNodes[0]);break;case _s.VideoInsertMode.REPLACE:i.parentNode.replaceChild(o,i);break;default:a=_s.VideoInsertMode.APPEND,i.appendChild(o);break}var s={targetElement:i,video:o,insertMode:a,id:o.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(s),this.ee.emitEvent("videoElementCreated",[new jh.VideoElementEvent(s.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,o},n.prototype.updatePublisherSpeakingEventsOptions=function(e){var r=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},i=typeof e.interval=="number"?e.interval:typeof r.interval=="number"?r.interval:100,o=typeof e.threshold=="number"?e.threshold:typeof r.threshold=="number"?r.threshold:-50;this.stream.harkOptions={interval:i,threshold:o},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(i),this.stream.speechEvent.setThreshold(o))},n.prototype.initializeVideoProperties=function(e){!this.remote&&this.stream.displayMyRemote()||e.srcObject!==this.stream.getMediaStream()&&(e.srcObject=this.stream.getMediaStream()),e.autoplay=!0,e.controls=!1,(fr.isSafariBrowser()||fr.isIPhoneOrIPad()&&(fr.isChromeMobileBrowser()||fr.isEdgeMobileBrowser()||fr.isOperaMobileBrowser()||fr.isFirefoxMobileBrowser()))&&(e.playsInline=!0),e.id||(e.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,!this.id&&this.targetElement&&(this.id=e.id)),this.remote&&this.isMirroredVideo(e)?this.removeMirrorVideo(e):!this.remote&&!this.stream.displayMyRemote()&&(e.muted=!0,this.isMirroredVideo(e)&&!this.stream.outboundStreamOpts.publisherProperties.mirror?this.removeMirrorVideo(e):this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(e))},n.prototype.removeAllVideos=function(){for(var e=this,r=this.stream.session.streamManagers.length-1;r>=0;--r)this.stream.session.streamManagers[r]===this&&this.stream.session.streamManagers.splice(r,1);this.videos.forEach(function(i){i.video&&i.video.removeEventListener&&i.video.removeEventListener("canplay",e.canPlayListener),i.canplayListenerAdded=!1,i.targetElement&&(i.video.parentNode.removeChild(i.video),e.ee.emitEvent("videoElementDestroyed",[new jh.VideoElementEvent(i.video,e,"videoElementDestroyed")])),e.removeSrcObject(i),e.videos.filter(function(o){return!o.targetElement})})},n.prototype.disassociateVideo=function(e){for(var r=!1,i=0;i<this.videos.length;i++)if(this.videos[i].video===e){this.videos[i].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(i,1),r=!0,B1.info("Video element disassociated from ",this);break}return r},n.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},n.prototype.updateMediaStream=function(e){this.videos.forEach(function(r){if(r.video.srcObject=e,fr.isIonicIos()){var i=r.video.parentElement,o=r.video;i.replaceChild(o,r.video),r.video=o}})},n.prototype.emitEvent=function(e,r){this.ee.emitEvent(e,r)},n.prototype.createVideo=function(){return document.createElement("video")},n.prototype.removeSrcObject=function(e){e.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},n.prototype.pushNewStreamManagerVideo=function(e){this.videos.push(e),this.addPlayEventToFirstVideo(),this.stream.session.streamManagers.indexOf(this)===-1&&this.stream.session.streamManagers.push(this)},n.prototype.mirrorVideo=function(e){fr.isIonicIos()||(e.style.transform="rotateY(180deg)",e.style.webkitTransform="rotateY(180deg)")},n.prototype.removeMirrorVideo=function(e){e.style.transform="unset",e.style.webkitTransform="unset"},n.prototype.isMirroredVideo=function(e){return e.style.transform==="rotateY(180deg)"||e.style.webkitTransform==="rotateY(180deg)"},n.prototype.activateStreamPlayingEventExceptionTimeout=function(){var e=this;if(this.remote&&this.streamPlayingEventExceptionTimeout==null){var r=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout(function(){var i="StreamManager of Stream "+e.stream.streamId+" ("+(e.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+r+" ms";B1.warn(i),e.stream.session.emitEvent("exception",[new WI.ExceptionEvent(e.stream.session,WI.ExceptionEventName.NO_STREAM_PLAYING_EVENT,e,i)]),delete e.streamPlayingEventExceptionTimeout},r)}},n.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},n}(Zde.EventDispatcher);$c.StreamManager=nfe;var rfe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Vc,"__esModule",{value:!0});Vc.Subscriber=void 0;var ife=$c,ofe=An,HI=ofe.OpenViduLogger.getInstance(),afe=function(t){rfe(n,t);function n(e,r,i){var o=t.call(this,e,r)||this;return o.element=o.targetElement,o.stream=e,o.properties=i,o}return n.prototype.subscribeToAudio=function(e){return this.stream.getMediaStream().getAudioTracks().forEach(function(r){r.enabled=e}),this.stream.audioActive=e,HI.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its audio stream"),this},n.prototype.subscribeToVideo=function(e){return this.stream.getMediaStream().getVideoTracks().forEach(function(r){r.enabled=e}),this.stream.videoActive=e,HI.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its video stream"),this},n.prototype.replaceTrackInMediaStream=function(e,r){var i=this.stream.getMediaStream(),o;e.kind==="video"?(o=i.getVideoTracks()[0],r&&(this.stream.lastVideoTrackConstraints=e.getConstraints())):o=i.getAudioTracks()[0],i.removeTrack(o),o.stop(),i.addTrack(e)},n}(ife.StreamManager);Vc.Subscriber=afe;var po={},GI=["stun:","turn:"],sfe=function(t){var n=(t||{}).url||t,e,r,i={};return typeof n!="string"&&!(n instanceof String)||(n=n.trim(),e=GI[GI.indexOf(n.slice(0,5))],!e)?t:(n=n.slice(5),r=n.split("@"),i.username=t.username,i.credential=t.credential,r.length>1&&(n=r[1],r=r[0].split(":"),i.username=r[0],i.credential=(t||{}).credential||r[1]||""),i.url=e+n,i.urls=[i.url],i)};const ufe=["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"],lfe=[];var cfe=sfe,dfe=function(t){var n={stun:(t||{}).stun||ufe,turn:(t||{}).turn||lfe},e=(t||{}).stunCount||2,r=(t||{}).turnCount||0,i;function o(a,s){for(var u=[],l=[].concat(n[a]),c;l.length&&u.length<s;)c=Math.random()*l.length|0,u=u.concat(l.splice(c,1));return u.map(function(d){return typeof d!="string"&&!(d instanceof String)?d:cfe(a+":"+d)})}return i=[].concat(o("stun",e)),r&&(i=i.concat(o("turn",r))),i},ffe=dfe,pR={},qy={},Ky={};Object.defineProperty(Ky,"__esModule",{value:!0});Ky.default=hfe;let Vh;const pfe=new Uint8Array(16);function hfe(){if(!Vh&&(Vh=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Vh))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Vh(pfe)}var Cs={},Bu={},Xy={};Object.defineProperty(Xy,"__esModule",{value:!0});Xy.default=void 0;var mfe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;Xy.default=mfe;Object.defineProperty(Bu,"__esModule",{value:!0});Bu.default=void 0;var vfe=gfe(Xy);function gfe(t){return t&&t.__esModule?t:{default:t}}function yfe(t){return typeof t=="string"&&vfe.default.test(t)}var bfe=yfe;Bu.default=bfe;Object.defineProperty(Cs,"__esModule",{value:!0});Cs.default=void 0;Cs.unsafeStringify=XB;var wfe=xfe(Bu);function xfe(t){return t&&t.__esModule?t:{default:t}}const Wn=[];for(let t=0;t<256;++t)Wn.push((t+256).toString(16).slice(1));function XB(t,n=0){return(Wn[t[n+0]]+Wn[t[n+1]]+Wn[t[n+2]]+Wn[t[n+3]]+"-"+Wn[t[n+4]]+Wn[t[n+5]]+"-"+Wn[t[n+6]]+Wn[t[n+7]]+"-"+Wn[t[n+8]]+Wn[t[n+9]]+"-"+Wn[t[n+10]]+Wn[t[n+11]]+Wn[t[n+12]]+Wn[t[n+13]]+Wn[t[n+14]]+Wn[t[n+15]]).toLowerCase()}function Sfe(t,n=0){const e=XB(t,n);if(!(0,wfe.default)(e))throw TypeError("Stringified UUID is invalid");return e}var Efe=Sfe;Cs.default=Efe;Object.defineProperty(qy,"__esModule",{value:!0});qy.default=void 0;var Cfe=Tfe(Ky),Rfe=Cs;function Tfe(t){return t&&t.__esModule?t:{default:t}}let qI,j1,V1=0,$1=0;function Nfe(t,n,e){let r=n&&e||0;const i=n||new Array(16);t=t||{};let o=t.node||qI,a=t.clockseq!==void 0?t.clockseq:j1;if(o==null||a==null){const f=t.random||(t.rng||Cfe.default)();o==null&&(o=qI=[f[0]|1,f[1],f[2],f[3],f[4],f[5]]),a==null&&(a=j1=(f[6]<<8|f[7])&16383)}let s=t.msecs!==void 0?t.msecs:Date.now(),u=t.nsecs!==void 0?t.nsecs:$1+1;const l=s-V1+(u-$1)/1e4;if(l<0&&t.clockseq===void 0&&(a=a+1&16383),(l<0||s>V1)&&t.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");V1=s,$1=u,j1=a,s+=122192928e5;const c=((s&268435455)*1e4+u)%4294967296;i[r++]=c>>>24&255,i[r++]=c>>>16&255,i[r++]=c>>>8&255,i[r++]=c&255;const d=s/4294967296*1e4&268435455;i[r++]=d>>>8&255,i[r++]=d&255,i[r++]=d>>>24&15|16,i[r++]=d>>>16&255,i[r++]=a>>>8|128,i[r++]=a&255;for(let f=0;f<6;++f)i[r+f]=o[f];return n||(0,Rfe.unsafeStringify)(i)}var kfe=Nfe;qy.default=kfe;var Yy={},ds={},$p={};Object.defineProperty($p,"__esModule",{value:!0});$p.default=void 0;var Ife=_fe(Bu);function _fe(t){return t&&t.__esModule?t:{default:t}}function Afe(t){if(!(0,Ife.default)(t))throw TypeError("Invalid UUID");let n;const e=new Uint8Array(16);return e[0]=(n=parseInt(t.slice(0,8),16))>>>24,e[1]=n>>>16&255,e[2]=n>>>8&255,e[3]=n&255,e[4]=(n=parseInt(t.slice(9,13),16))>>>8,e[5]=n&255,e[6]=(n=parseInt(t.slice(14,18),16))>>>8,e[7]=n&255,e[8]=(n=parseInt(t.slice(19,23),16))>>>8,e[9]=n&255,e[10]=(n=parseInt(t.slice(24,36),16))/1099511627776&255,e[11]=n/4294967296&255,e[12]=n>>>24&255,e[13]=n>>>16&255,e[14]=n>>>8&255,e[15]=n&255,e}var Ofe=Afe;$p.default=Ofe;Object.defineProperty(ds,"__esModule",{value:!0});ds.URL=ds.DNS=void 0;ds.default=Ffe;var Dfe=Cs,Mfe=Pfe($p);function Pfe(t){return t&&t.__esModule?t:{default:t}}function Lfe(t){t=unescape(encodeURIComponent(t));const n=[];for(let e=0;e<t.length;++e)n.push(t.charCodeAt(e));return n}const YB="6ba7b810-9dad-11d1-80b4-00c04fd430c8";ds.DNS=YB;const JB="6ba7b811-9dad-11d1-80b4-00c04fd430c8";ds.URL=JB;function Ffe(t,n,e){function r(i,o,a,s){var u;if(typeof i=="string"&&(i=Lfe(i)),typeof o=="string"&&(o=(0,Mfe.default)(o)),((u=o)===null||u===void 0?void 0:u.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+i.length);if(l.set(o),l.set(i,o.length),l=e(l),l[6]=l[6]&15|n,l[8]=l[8]&63|128,a){s=s||0;for(let c=0;c<16;++c)a[s+c]=l[c];return a}return(0,Dfe.unsafeStringify)(l)}try{r.name=t}catch{}return r.DNS=YB,r.URL=JB,r}var Jy={};Object.defineProperty(Jy,"__esModule",{value:!0});Jy.default=void 0;function zfe(t){if(typeof t=="string"){const n=unescape(encodeURIComponent(t));t=new Uint8Array(n.length);for(let e=0;e<n.length;++e)t[e]=n.charCodeAt(e)}return Bfe(jfe(Vfe(t),t.length*8))}function Bfe(t){const n=[],e=t.length*32,r="0123456789abcdef";for(let i=0;i<e;i+=8){const o=t[i>>5]>>>i%32&255,a=parseInt(r.charAt(o>>>4&15)+r.charAt(o&15),16);n.push(a)}return n}function QB(t){return(t+64>>>9<<4)+14+1}function jfe(t,n){t[n>>5]|=128<<n%32,t[QB(n)-1]=n;let e=1732584193,r=-271733879,i=-1732584194,o=271733878;for(let a=0;a<t.length;a+=16){const s=e,u=r,l=i,c=o;e=tr(e,r,i,o,t[a],7,-680876936),o=tr(o,e,r,i,t[a+1],12,-389564586),i=tr(i,o,e,r,t[a+2],17,606105819),r=tr(r,i,o,e,t[a+3],22,-1044525330),e=tr(e,r,i,o,t[a+4],7,-176418897),o=tr(o,e,r,i,t[a+5],12,1200080426),i=tr(i,o,e,r,t[a+6],17,-1473231341),r=tr(r,i,o,e,t[a+7],22,-45705983),e=tr(e,r,i,o,t[a+8],7,1770035416),o=tr(o,e,r,i,t[a+9],12,-1958414417),i=tr(i,o,e,r,t[a+10],17,-42063),r=tr(r,i,o,e,t[a+11],22,-1990404162),e=tr(e,r,i,o,t[a+12],7,1804603682),o=tr(o,e,r,i,t[a+13],12,-40341101),i=tr(i,o,e,r,t[a+14],17,-1502002290),r=tr(r,i,o,e,t[a+15],22,1236535329),e=nr(e,r,i,o,t[a+1],5,-165796510),o=nr(o,e,r,i,t[a+6],9,-1069501632),i=nr(i,o,e,r,t[a+11],14,643717713),r=nr(r,i,o,e,t[a],20,-373897302),e=nr(e,r,i,o,t[a+5],5,-701558691),o=nr(o,e,r,i,t[a+10],9,38016083),i=nr(i,o,e,r,t[a+15],14,-660478335),r=nr(r,i,o,e,t[a+4],20,-405537848),e=nr(e,r,i,o,t[a+9],5,568446438),o=nr(o,e,r,i,t[a+14],9,-1019803690),i=nr(i,o,e,r,t[a+3],14,-187363961),r=nr(r,i,o,e,t[a+8],20,1163531501),e=nr(e,r,i,o,t[a+13],5,-1444681467),o=nr(o,e,r,i,t[a+2],9,-51403784),i=nr(i,o,e,r,t[a+7],14,1735328473),r=nr(r,i,o,e,t[a+12],20,-1926607734),e=rr(e,r,i,o,t[a+5],4,-378558),o=rr(o,e,r,i,t[a+8],11,-2022574463),i=rr(i,o,e,r,t[a+11],16,1839030562),r=rr(r,i,o,e,t[a+14],23,-35309556),e=rr(e,r,i,o,t[a+1],4,-1530992060),o=rr(o,e,r,i,t[a+4],11,1272893353),i=rr(i,o,e,r,t[a+7],16,-155497632),r=rr(r,i,o,e,t[a+10],23,-1094730640),e=rr(e,r,i,o,t[a+13],4,681279174),o=rr(o,e,r,i,t[a],11,-358537222),i=rr(i,o,e,r,t[a+3],16,-722521979),r=rr(r,i,o,e,t[a+6],23,76029189),e=rr(e,r,i,o,t[a+9],4,-640364487),o=rr(o,e,r,i,t[a+12],11,-421815835),i=rr(i,o,e,r,t[a+15],16,530742520),r=rr(r,i,o,e,t[a+2],23,-995338651),e=ir(e,r,i,o,t[a],6,-198630844),o=ir(o,e,r,i,t[a+7],10,1126891415),i=ir(i,o,e,r,t[a+14],15,-1416354905),r=ir(r,i,o,e,t[a+5],21,-57434055),e=ir(e,r,i,o,t[a+12],6,1700485571),o=ir(o,e,r,i,t[a+3],10,-1894986606),i=ir(i,o,e,r,t[a+10],15,-1051523),r=ir(r,i,o,e,t[a+1],21,-2054922799),e=ir(e,r,i,o,t[a+8],6,1873313359),o=ir(o,e,r,i,t[a+15],10,-30611744),i=ir(i,o,e,r,t[a+6],15,-1560198380),r=ir(r,i,o,e,t[a+13],21,1309151649),e=ir(e,r,i,o,t[a+4],6,-145523070),o=ir(o,e,r,i,t[a+11],10,-1120210379),i=ir(i,o,e,r,t[a+2],15,718787259),r=ir(r,i,o,e,t[a+9],21,-343485551),e=$a(e,s),r=$a(r,u),i=$a(i,l),o=$a(o,c)}return[e,r,i,o]}function Vfe(t){if(t.length===0)return[];const n=t.length*8,e=new Uint32Array(QB(n));for(let r=0;r<n;r+=8)e[r>>5]|=(t[r/8]&255)<<r%32;return e}function $a(t,n){const e=(t&65535)+(n&65535);return(t>>16)+(n>>16)+(e>>16)<<16|e&65535}function $fe(t,n){return t<<n|t>>>32-n}function Qy(t,n,e,r,i,o){return $a($fe($a($a(n,t),$a(r,o)),i),e)}function tr(t,n,e,r,i,o,a){return Qy(n&e|~n&r,t,n,i,o,a)}function nr(t,n,e,r,i,o,a){return Qy(n&r|e&~r,t,n,i,o,a)}function rr(t,n,e,r,i,o,a){return Qy(n^e^r,t,n,i,o,a)}function ir(t,n,e,r,i,o,a){return Qy(e^(n|~r),t,n,i,o,a)}var Ufe=zfe;Jy.default=Ufe;Object.defineProperty(Yy,"__esModule",{value:!0});Yy.default=void 0;var Wfe=ZB(ds),Hfe=ZB(Jy);function ZB(t){return t&&t.__esModule?t:{default:t}}const Gfe=(0,Wfe.default)("v3",48,Hfe.default);var qfe=Gfe;Yy.default=qfe;var Zy={},e0={};Object.defineProperty(e0,"__esModule",{value:!0});e0.default=void 0;const Kfe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var Xfe={randomUUID:Kfe};e0.default=Xfe;Object.defineProperty(Zy,"__esModule",{value:!0});Zy.default=void 0;var KI=ej(e0),Yfe=ej(Ky),Jfe=Cs;function ej(t){return t&&t.__esModule?t:{default:t}}function Qfe(t,n,e){if(KI.default.randomUUID&&!n&&!t)return KI.default.randomUUID();t=t||{};const r=t.random||(t.rng||Yfe.default)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,n){e=e||0;for(let i=0;i<16;++i)n[e+i]=r[i];return n}return(0,Jfe.unsafeStringify)(r)}var Zfe=Qfe;Zy.default=Zfe;var t0={},n0={};Object.defineProperty(n0,"__esModule",{value:!0});n0.default=void 0;function epe(t,n,e,r){switch(t){case 0:return n&e^~n&r;case 1:return n^e^r;case 2:return n&e^n&r^e&r;case 3:return n^e^r}}function U1(t,n){return t<<n|t>>>32-n}function tpe(t){const n=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){const a=unescape(encodeURIComponent(t));t=[];for(let s=0;s<a.length;++s)t.push(a.charCodeAt(s))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const r=t.length/4+2,i=Math.ceil(r/16),o=new Array(i);for(let a=0;a<i;++a){const s=new Uint32Array(16);for(let u=0;u<16;++u)s[u]=t[a*64+u*4]<<24|t[a*64+u*4+1]<<16|t[a*64+u*4+2]<<8|t[a*64+u*4+3];o[a]=s}o[i-1][14]=(t.length-1)*8/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=(t.length-1)*8&4294967295;for(let a=0;a<i;++a){const s=new Uint32Array(80);for(let p=0;p<16;++p)s[p]=o[a][p];for(let p=16;p<80;++p)s[p]=U1(s[p-3]^s[p-8]^s[p-14]^s[p-16],1);let u=e[0],l=e[1],c=e[2],d=e[3],f=e[4];for(let p=0;p<80;++p){const h=Math.floor(p/20),v=U1(u,5)+epe(h,l,c,d)+f+n[h]+s[p]>>>0;f=d,d=c,c=U1(l,30)>>>0,l=u,u=v}e[0]=e[0]+u>>>0,e[1]=e[1]+l>>>0,e[2]=e[2]+c>>>0,e[3]=e[3]+d>>>0,e[4]=e[4]+f>>>0}return[e[0]>>24&255,e[0]>>16&255,e[0]>>8&255,e[0]&255,e[1]>>24&255,e[1]>>16&255,e[1]>>8&255,e[1]&255,e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,e[2]&255,e[3]>>24&255,e[3]>>16&255,e[3]>>8&255,e[3]&255,e[4]>>24&255,e[4]>>16&255,e[4]>>8&255,e[4]&255]}var npe=tpe;n0.default=npe;Object.defineProperty(t0,"__esModule",{value:!0});t0.default=void 0;var rpe=tj(ds),ipe=tj(n0);function tj(t){return t&&t.__esModule?t:{default:t}}const ope=(0,rpe.default)("v5",80,ipe.default);var ape=ope;t0.default=ape;var r0={};Object.defineProperty(r0,"__esModule",{value:!0});r0.default=void 0;var spe="00000000-0000-0000-0000-000000000000";r0.default=spe;var i0={};Object.defineProperty(i0,"__esModule",{value:!0});i0.default=void 0;var upe=lpe(Bu);function lpe(t){return t&&t.__esModule?t:{default:t}}function cpe(t){if(!(0,upe.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}var dpe=cpe;i0.default=dpe;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return a.default}});var n=c(qy),e=c(Yy),r=c(Zy),i=c(t0),o=c(r0),a=c(i0),s=c(Bu),u=c(Cs),l=c($p);function c(d){return d&&d.__esModule?d:{default:d}}})(pR);var hR=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fv=ve&&ve.__assign||function(){return Fv=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Fv.apply(this,arguments)},W1=ve&&ve.__awaiter||function(t,n,e,r){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?o(c.value):i(c.value).then(s,u)}l((r=r.apply(t,n||[])).next())})},H1=ve&&ve.__generator||function(t,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(e=0)),e;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){e.label=l[1];break}if(l[0]===6&&e.label<o[1]){e.label=o[1],o=l;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(l);break}o[2]&&e.ops.pop(),e.trys.pop();continue}l=n.call(t,e)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(po,"__esModule",{value:!0});po.WebRtcPeerSendrecv=po.WebRtcPeerSendonly=po.WebRtcPeerRecvonly=po.WebRtcPeer=void 0;var fpe=ffe,ppe=pR,XI=zu,hpe=An,mpe=Yi,sn=hpe.OpenViduLogger.getInstance(),o0=function(){function t(n){var e=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],mpe.PlatformUtils.getInstance(),this.configuration=Fv(Fv({},n),{iceServers:n.iceServers&&n.iceServers.length>0?n.iceServers:fpe(),mediaStream:n.mediaStream!==void 0?n.mediaStream:null,mode:n.mode?n.mode:"sendrecv",id:n.id?n.id:this.generateUniqueId()}),sn.debug(`[WebRtcPeer] configuration:
`.concat(JSON.stringify(this.configuration,null,2))),this.pc=new RTCPeerConnection({iceServers:this.configuration.iceServers}),this.pc.addEventListener("icecandidate",function(r){if(r.candidate!==null){var i=r.candidate,o=new RTCIceCandidate(i);e.configuration.onIceCandidate(o),o.candidate!==""&&e.localCandidatesQueue.push(o)}}),this.pc.addEventListener("signalingstatechange",function(){return W1(e,void 0,void 0,function(){var r,i;return H1(this,function(o){switch(o.label){case 0:if(this.pc.signalingState!=="stable")return[3,6];o.label=1;case 1:if(!(this.iceCandidateList.length>0))return[3,6];r=this.iceCandidateList.shift(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.pc.addIceCandidate(r)];case 3:return o.sent(),[3,5];case 4:return i=o.sent(),sn.error("Error when calling RTCPeerConnection#addIceCandidate for RTCPeerConnection "+this.getId(),i),[3,5];case 5:return[3,1];case 6:return[2]}})})})}return t.prototype.getId=function(){return this.configuration.id},t.prototype.dispose=function(){if(sn.debug("Disposing WebRtcPeer"),this.pc){if(this.pc.signalingState==="closed")return;this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[]}},t.prototype.createOfferLegacy=function(){this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi();var n=this.configuration.mediaConstraints.audio,e=this.configuration.mediaConstraints.video,r={offerToReceiveAudio:this.configuration.mode!=="sendonly"&&n,offerToReceiveVideo:this.configuration.mode!=="sendonly"&&e};return sn.debug("[createOfferLegacy] RTCPeerConnection.createOffer() options:",JSON.stringify(r)),this.pc.createOffer(r)},t.prototype.createOffer=function(){var n,e,r,i,o,a,s,u;return W1(this,void 0,void 0,function(){var l,c,d,f,p,h,v,g,m,y,b,w,x,C,E,S,k,P,N,M,D,T,O,P;return H1(this,function(A){switch(A.label){case 0:if("addTransceiver"in this.pc)sn.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it");else return sn.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),[2,this.createOfferLegacy()];if(this.configuration.mode==="recvonly")return[3,7];if(!this.configuration.mediaStream)throw new Error("[WebRtcPeer.createOffer] Direction is '".concat(this.configuration.mode,"', but no stream was configured to be sent"));l=0,c=this.configuration.mediaStream.getTracks(),A.label=1;case 1:if(!(l<c.length))return[3,6];if(d=c[l],f={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},d.kind==="video"&&this.configuration.simulcast)for(p=d.getSettings(),h=d.getConstraints(),v=(r=(e=(n=p.width)!==null&&n!==void 0?n:h.width.ideal)!==null&&e!==void 0?e:h.width)!==null&&r!==void 0?r:0,g=(a=(o=(i=p.height)!==null&&i!==void 0?i:h.height.ideal)!==null&&o!==void 0?o:h.height)!==null&&a!==void 0?a:0,sn.info("[createOffer] Video track dimensions: ".concat(v,"x").concat(g)),m=v*g,y=0,m>=960*540?y=3:m>=480*270?y=2:y=1,f.sendEncodings=[],b=0;b<y;b++)w=Math.pow(2,y-b-1),x={rid:"rdiv"+w.toString(),scalabilityMode:"L1T1"},["detail","text"].includes(d.contentHint)?(x.scaleResolutionDownBy=1,x.maxFramerate=Math.floor(30/w)):x.scaleResolutionDownBy=w,f.sendEncodings.push(x);if(C=this.pc.addTransceiver(d,f),d.kind!=="video")return[3,5];if(E=C.sender.getParameters(),S=!1,!((s=E.degradationPreference)===null||s===void 0)&&s.length||(["detail","text"].includes(d.contentHint)?E.degradationPreference="maintain-resolution":E.degradationPreference="balanced",sn.info("[createOffer] Video sender Degradation Preference set: ".concat(E.degradationPreference)),S=!0),this.configuration.simulcast&&((u=E.encodings)===null||u===void 0?void 0:u.length)!==f.sendEncodings.length&&(E.encodings=f.sendEncodings,S=!0),!S)return[3,5];sn.debug("[createOffer] Setting new RTCRtpSendParameters to video sender"),A.label=2;case 2:return A.trys.push([2,4,,5]),[4,C.sender.setParameters(E)];case 3:return A.sent(),[3,5];case 4:throw k=A.sent(),P="[WebRtcPeer.createOffer] Cannot set RTCRtpSendParameters to video sender",k instanceof Error&&(P+=": ".concat(k.message)),new Error(P);case 5:return l++,[3,1];case 6:return[3,8];case 7:for(N=0,M=["audio","video"];N<M.length;N++)D=M[N],this.configuration.mediaConstraints[D]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(D,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));A.label=8;case 8:return A.trys.push([8,10,,11]),[4,this.pc.createOffer()];case 9:return T=A.sent(),[3,11];case 10:throw O=A.sent(),P="[WebRtcPeer.createOffer] Browser failed creating an SDP Offer",O instanceof Error&&(P+=": ".concat(O.message)),new Error(P);case 11:return[2,T]}})})},t.prototype.deprecatedPeerConnectionTrackApi=function(){for(var n=0,e=this.configuration.mediaStream.getTracks();n<e.length;n++){var r=e[n];this.pc.addTrack(r,this.configuration.mediaStream)}},t.prototype.createAnswer=function(){var n=this;return new Promise(function(e,r){if("getTransceivers"in n.pc){sn.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var i=function(f){if(!n.configuration.mediaConstraints[f])return"continue";var p=n.pc.getTransceivers().find(function(h){return h.receiver.track.kind===f});if(p)p.direction=n.configuration.mode;else return{value:r(new Error("".concat(f," requested, but no transceiver was created from remote description")))}},o=0,a=["audio","video"];o<a.length;o++){var s=a[o],u=i(s);if(typeof u=="object")return u.value}n.pc.createAnswer().then(function(f){return e(f)}).catch(function(f){return r(f)})}else{var l=void 0,c=!0;if(n.configuration.mediaConstraints){l=typeof n.configuration.mediaConstraints.audio=="boolean"?n.configuration.mediaConstraints.audio:!0,c=typeof n.configuration.mediaConstraints.video=="boolean"?n.configuration.mediaConstraints.video:!0;var d={offerToReceiveAudio:l,offerToReceiveVideo:c};n.pc.createAnswer(d).then(function(f){return e(f)}).catch(function(f){return r(f)})}}})},t.prototype.processLocalOffer=function(n){var e=this;return new Promise(function(r,i){e.pc.setLocalDescription(n).then(function(){var o=e.pc.localDescription;return o?(sn.debug("Local description set",o.sdp),r()):i("Local description is not defined")}).catch(function(o){return i(o)})})},t.prototype.processRemoteOffer=function(n){var e=this;return new Promise(function(r,i){var o={type:"offer",sdp:n};if(sn.debug("SDP offer received, setting remote description",o),e.pc.signalingState==="closed")return i("RTCPeerConnection is closed when trying to set remote description");e.setRemoteDescription(o).then(function(){return r()}).catch(function(a){return i(a)})})},t.prototype.processLocalAnswer=function(n){var e=this;return new Promise(function(r,i){if(sn.debug("SDP answer created, setting local description"),e.pc.signalingState==="closed")return i("RTCPeerConnection is closed when trying to set local description");e.pc.setLocalDescription(n).then(function(){return r()}).catch(function(o){return i(o)})})},t.prototype.processRemoteAnswer=function(n){var e=this;return new Promise(function(r,i){var o={type:"answer",sdp:n};if(sn.debug("SDP answer received, setting remote description"),e.pc.signalingState==="closed")return i("RTCPeerConnection is closed when trying to set remote description");e.setRemoteDescription(o).then(function(){r()}).catch(function(a){return i(a)})})},t.prototype.setRemoteDescription=function(n){return W1(this,void 0,void 0,function(){return H1(this,function(e){return[2,this.pc.setRemoteDescription(n)]})})},t.prototype.addIceCandidate=function(n){var e=this;return new Promise(function(r,i){switch(sn.debug("Remote ICE candidate received",n),e.remoteCandidatesQueue.push(n),e.pc.signalingState){case"closed":i(new Error("PeerConnection object is closed"));break;case"stable":e.pc.remoteDescription?e.pc.addIceCandidate(n).then(function(){return r()}).catch(function(o){return i(o)}):(e.iceCandidateList.push(n),r());break;default:e.iceCandidateList.push(n),r()}})},t.prototype.addIceConnectionStateChangeListener=function(n){var e=this;this.pc.addEventListener("iceconnectionstatechange",function(){var r=e.pc.iceConnectionState;switch(r){case"disconnected":var i="IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+n+') change to "disconnected". Possible network disconnection';sn.warn(i),e.configuration.onIceConnectionStateException(XI.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,i);break;case"failed":var o="IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+n+') to "failed"';sn.error(o),e.configuration.onIceConnectionStateException(XI.ExceptionEventName.ICE_CONNECTION_FAILED,o);break;case"closed":sn.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+n+') change to "closed"');break;case"new":sn.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+n+') change to "new"');break;case"checking":sn.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+n+') change to "checking"');break;case"connected":sn.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+n+') change to "connected"');break;case"completed":sn.log("IceConnectionState of RTCPeerConnection "+e.configuration.id+" ("+n+') change to "completed"');break}})},t.prototype.generateUniqueId=function(){return(0,ppe.v4)()},t}();po.WebRtcPeer=o0;var vpe=function(t){hR(n,t);function n(e){return e.mode="recvonly",t.call(this,e)||this}return n}(o0);po.WebRtcPeerRecvonly=vpe;var gpe=function(t){hR(n,t);function n(e){return e.mode="sendonly",t.call(this,e)||this}return n}(o0);po.WebRtcPeerSendonly=gpe;var ype=function(t){hR(n,t);function n(e){return e.mode="sendrecv",t.call(this,e)||this}return n}(o0);po.WebRtcPeerSendrecv=ype;var a0={},Qu=ve&&ve.__awaiter||function(t,n,e,r){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?o(c.value):i(c.value).then(s,u)}l((r=r.apply(t,n||[])).next())})},Zu=ve&&ve.__generator||function(t,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(e=0)),e;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){e.label=l[1];break}if(l[0]===6&&e.label<o[1]){e.label=o[1],o=l;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(l);break}o[2]&&e.ops.pop(),e.trys.pop();continue}l=n.call(t,e)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(a0,"__esModule",{value:!0});a0.WebRtcStats=void 0;var bpe=An,wpe=Yi,As=bpe.OpenViduLogger.getInstance(),el,xpe=function(){function t(n){this.stream=n,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,el=wpe.PlatformUtils.getInstance()}return t.prototype.isEnabled=function(){return this.webRtcStatsEnabled},t.prototype.initWebRtcStats=function(){var n=this,e;try{e=localStorage.getItem(this.STATS_ITEM_NAME)}catch{}if(e){this.webRtcStatsEnabled=!0;var r=JSON.parse(e);As.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),As.warn("localStorage item: "+JSON.stringify(r)),this.POST_URL=r.httpEndpoint,this.statsInterval=r.interval,this.webRtcStatsIntervalId=setInterval(function(){return Qu(n,void 0,void 0,function(){return Zu(this,function(i){switch(i.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return i.sent(),[2]}})})},this.statsInterval*1e3)}else As.debug("WebRtc stats not enabled")},t.prototype.getSelectedIceCandidateInfo=function(){var n=this;return new Promise(function(e,r){return Qu(n,void 0,void 0,function(){var i,o,a,s,u,l,c,d,f,p,h,v,g,m,x,C,y,b,k,w,x,C,E,S,k;return Zu(this,function(N){switch(N.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(i=N.sent(),a=new Map,s=new Map,u=new Map,i.forEach(function(M){switch(M.type==="transport"&&(el.isChromium()||el.isSafariBrowser()||el.isReactNative())&&(o=M),M.type){case"candidate-pair":a.set(M.id,M);break;case"local-candidate":s.set(M.id,M);break;case"remote-candidate":u.set(M.id,M);break}}),o!=null)c=o.selectedCandidatePairId,l=a.get(c);else for(d=a.size,f=a.values(),p=0;p<d;p++)if(h=f.next().value,h.selected){l=h;break}if(v=l.localCandidateId,g=l.remoteCandidateId,m=s.get(v),m)for(x=this.stream.getLocalIceCandidateList(),C=x.filter(function(M){return!!M.candidate&&(M.candidate.indexOf(m.ip)>=0||M.candidate.indexOf(m.address)>=0)&&M.candidate.indexOf(m.port)>=0}),m.raw=[],y=0,b=C;y<b.length;y++)k=b[y],m.raw.push(k.candidate);else m="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(w=u.get(g),w)for(x=this.stream.getRemoteIceCandidateList(),C=x.filter(function(M){return!!M.candidate&&(M.candidate.indexOf(w.ip)>=0||M.candidate.indexOf(w.address)>=0)&&M.candidate.indexOf(w.port)>=0}),w.raw=[],E=0,S=C;E<S.length;E++)k=S[E],w.raw.push(k.candidate);else w="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return[2,e({localCandidate:m,remoteCandidate:w})]}})})})},t.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),As.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},t.prototype.sendStats=function(n,e){return Qu(this,void 0,void 0,function(){var r,i;return Zu(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r={headers:{"Content-type":"application/json"},body:JSON.stringify(e),method:"POST"},[4,fetch(n,r)];case 1:return o.sent(),[3,3];case 2:return i=o.sent(),As.error("sendStats error: ".concat(JSON.stringify(i))),[3,3];case 3:return[2]}})})},t.prototype.sendStatsToHttpEndpoint=function(){return Qu(this,void 0,void 0,function(){var n,e,r;return Zu(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return n=i.sent(),e=this.generateJSONStatsResponse(n),[4,this.sendStats(this.POST_URL,e)];case 2:return i.sent(),[3,4];case 3:return r=i.sent(),As.log(r),[3,4];case 4:return[2]}})})},t.prototype.getCommonStats=function(){return Qu(this,void 0,void 0,function(){var n=this;return Zu(this,function(e){return[2,new Promise(function(r,i){return Qu(n,void 0,void 0,function(){var o,a,s,u,l,c=this;return Zu(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return o=d.sent(),a=this.getWebRtcStatsResponseOutline(),s=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],u=["availableOutgoingBitrate","currentRoundTripTime"],o.forEach(function(f){var p=f.mediaType!=null?f.mediaType:f.kind,h=function(v,g){f[g]!=null&&a[v]!=null&&(!p&&s.indexOf(g)>-1&&(p="video"),v!=null&&p!=null&&g!=null&&a[v][p]!=null?a[v][p][g]=Number(f[g]):v!=null&&g!=null&&u.includes(g)&&(a[v][g]=Number(f[g])))};switch(f.type){case"outbound-rtp":h("outbound","bytesSent"),h("outbound","packetsSent"),h("outbound","framesEncoded"),h("outbound","nackCount"),h("outbound","firCount"),h("outbound","pliCount"),h("outbound","qpSum");break;case"inbound-rtp":h("inbound","bytesReceived"),h("inbound","packetsReceived"),h("inbound","packetsLost"),h("inbound","jitter"),h("inbound","framesDecoded"),h("inbound","nackCount"),h("inbound","firCount"),h("inbound","pliCount");break;case"track":h("inbound","jitterBufferDelay"),h("inbound","framesReceived"),h("outbound","framesDropped"),h("outbound","framesSent"),h(c.stream.isLocal()?"outbound":"inbound","frameHeight"),h(c.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":h("candidatepair","currentRoundTripTime"),h("candidatepair","availableOutgoingBitrate");break}}),(!(a!=null&&a.candidatepair)||Object.keys(a.candidatepair).length===0)&&delete a.candidatepair,[2,r(a)];case 2:return l=d.sent(),As.error("Error getting common stats: ",l),[2,i(l)];case 3:return[2]}})})})]})})},t.prototype.generateJSONStatsResponse=function(n){return{"@timestamp":new Date().toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:el.getName(),platform_description:el.getDescription(),stream:"webRTC",webrtc_stats:n}},t.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},t}();a0.WebRtcStats=xpe;var Up={},Spe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Up,"__esModule",{value:!0});Up.PublisherSpeakingEvent=void 0;var Epe=$n,Cpe=function(t){Spe(n,t);function n(e,r,i,o){var a=t.call(this,!1,e,r)||this;return a.type=r,a.connection=i,a.streamId=o,a}return n.prototype.callDefaultBehavior=function(){},n}(Epe.Event);Up.PublisherSpeakingEvent=Cpe;var s0={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOfVideo=void 0,function(n){n.CAMERA="CAMERA",n.SCREEN="SCREEN",n.CUSTOM="CUSTOM",n.IPCAM="IPCAM"}(t.TypeOfVideo||(t.TypeOfVideo={}))})(s0);var Rpe=zv;function zv(){}zv.mixin=function(t){var n=t.prototype||t;n.isWildEmitter=!0,n.on=function(e,r,i){this.callbacks=this.callbacks||{};var o=arguments.length===3,a=o?arguments[1]:void 0,s=o?arguments[2]:arguments[1];return s._groupName=a,(this.callbacks[e]=this.callbacks[e]||[]).push(s),this},n.once=function(e,r,i){var o=this,a=arguments.length===3,s=a?arguments[1]:void 0,u=a?arguments[2]:arguments[1];function l(){o.off(e,l),u.apply(this,arguments)}return this.on(e,s,l),this},n.releaseGroup=function(e){this.callbacks=this.callbacks||{};var r,i,o,a;for(r in this.callbacks)for(a=this.callbacks[r],i=0,o=a.length;i<o;i++)a[i]._groupName===e&&(a.splice(i,1),i--,o--);return this},n.off=function(e,r){this.callbacks=this.callbacks||{};var i=this.callbacks[e],o;return i?arguments.length===1?(delete this.callbacks[e],this):(o=i.indexOf(r),o!==-1&&(i.splice(o,1),i.length===0&&delete this.callbacks[e]),this):this},n.emit=function(e){this.callbacks=this.callbacks||{};var r=[].slice.call(arguments,1),i=this.callbacks[e],o=this.getWildcardCallbacks(e),a,s,u;if(i)for(u=i.slice(),a=0,s=u.length;a<s&&u[a];++a)u[a].apply(this,r);if(o)for(s=o.length,u=o.slice(),a=0,s=u.length;a<s&&u[a];++a)u[a].apply(this,[e].concat(r));return this},n.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var r,i,o=[];for(r in this.callbacks)i=r.split("*"),(r==="*"||i.length===2&&e.slice(0,i[0].length)===i[0])&&(o=o.concat(this.callbacks[r]));return o}};zv.mixin(zv);var Tpe=Rpe;function Npe(t,n){var e=-1/0;t.getFloatFrequencyData(n);for(var r=4,i=n.length;r<i;r++)n[r]>e&&n[r]<0&&(e=n[r]);return e}var Sx;typeof window<"u"&&(Sx=window.AudioContext||window.webkitAudioContext);var ki=null,kpe=function(t,r){var e=new Tpe;if(!Sx)return e;var r=r||{},i=r.smoothing||.1,o=r.interval||50,a=r.threshold,s=r.play,u=r.history||10,l=!0;ki=r.audioContext||ki||new Sx;var c,d,f;f=ki.createAnalyser(),f.fftSize=512,f.smoothingTimeConstant=i,d=new Float32Array(f.frequencyBinCount),t.jquery&&(t=t[0]),t instanceof HTMLAudioElement||t instanceof HTMLVideoElement?(c=ki.createMediaElementSource(t),typeof s>"u"&&(s=!0),a=a||-50):(c=ki.createMediaStreamSource(t),a=a||-50),c.connect(f),s&&f.connect(ki.destination),e.speaking=!1,e.suspend=function(){return ki.suspend()},e.resume=function(){return ki.resume()},Object.defineProperty(e,"state",{get:function(){return ki.state}}),ki.onstatechange=function(){e.emit("state_change",ki.state)},e.setThreshold=function(v){a=v},e.setInterval=function(v){o=v},e.stop=function(){l=!1,e.emit("volume_change",-100,a),e.speaking&&(e.speaking=!1,e.emit("stopped_speaking")),f.disconnect(),c.disconnect()},e.speakingHistory=[];for(var p=0;p<u;p++)e.speakingHistory.push(0);var h=function(){setTimeout(function(){if(l){var v=Npe(f,d);e.emit("volume_change",v,a);var g=0;if(v>a&&!e.speaking){for(var m=e.speakingHistory.length-3;m<e.speakingHistory.length;m++)g+=e.speakingHistory[m];g>=2&&(e.speaking=!0,e.emit("speaking"))}else if(v<a&&e.speaking){for(var m=0;m<e.speakingHistory.length;m++)g+=e.speakingHistory[m];g==0&&(e.speaking=!1,e.emit("stopped_speaking"))}e.speakingHistory.shift(),e.speakingHistory.push(0+(v>a)),h()}},o)};return h(),e},Zi=ve&&ve.__awaiter||function(t,n,e,r){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?o(c.value):i(c.value).then(s,u)}l((r=r.apply(t,n||[])).next())})},eo=ve&&ve.__generator||function(t,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(e=0)),e;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){e.label=l[1];break}if(l[0]===6&&e.label<o[1]){e.label=o[1],o=l;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(l);break}o[2]&&e.ops.pop(),e.trys.pop();continue}l=n.call(t,e)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Bc,"__esModule",{value:!0});Bc.Stream=void 0;var G1=jc,Ipe=Vc,q1=po,_pe=a0,Td=zu,xa=Up,YI=Wc,$h=ma,hn=Fu,Sa=s0,Ape=An,Ope=Yi,Dpe=pR,Mpe=kpe,JI=fR,Rt=Ape.OpenViduLogger.getInstance(),QI,Ppe=function(){function t(n,e){var r=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new JI,QI=Ope.PlatformUtils.getInstance(),this.session=n,e.hasOwnProperty("id")?(this.inboundStreamOpts=e,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=this.inboundStreamOpts.frameRate===-1?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length===0&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=e,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,typeof MediaStreamTrack<"u"&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo=Sa.TypeOfVideo.CUSTOM:this.typeOfVideo=this.isSendScreen()?Sa.TypeOfVideo.SCREEN:Sa.TypeOfVideo.CAMERA),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",function(){var i;r.streamManager.updateMediaStream(r.mediaStream),Rt.debug("Video srcObject ["+((i=r.mediaStream)===null||i===void 0?void 0:i.id)+"] updated in stream ["+r.streamId+"]")})}return t.prototype.reconnect=function(){return this.reconnectStream("API")},t.prototype.applyFilter=function(n,e){var r=this;return new Promise(function(i,o){return Zi(r,void 0,void 0,function(){var a,s,u,l,c,d,f=this;return eo(this,function(p){if(this.filter)return[2,o(new hn.OpenViduError(hn.OpenViduErrorName.GENERIC_ERROR,"There is already a filter applied to Stream "+this.streamId))];if(a=function(h,v){if(h)return Rt.error("Error applying filter for Stream "+f.streamId,h),h.code===401?o(new hn.OpenViduError(hn.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):o(h);Rt.info("Filter successfully applied on Stream "+f.streamId);var g=f.filter;return f.filter=new G1.Filter(n,e),f.filter.stream=f,v&&(f.session.emitEvent("streamPropertyChanged",[new $h.StreamPropertyChangedEvent(f.session,f,"filter",f.filter,g,"applyFilter")]),f.streamManager.emitEvent("streamPropertyChanged",[new $h.StreamPropertyChangedEvent(f.streamManager,f,"filter",f.filter,g,"applyFilter")])),i(f.filter)},n.startsWith("VB:")){if(!this.hasVideo)return[2,o(new hn.OpenViduError(hn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The Virtual Background filter requires a video track to be applied"))];if(!this.mediaStream||this.streamManager.videos.length===0)return[2,o(new hn.OpenViduError(hn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The StreamManager requires some video element to be attached to it in order to apply a Virtual Background filter"))];if(this.session.token?s=this.session.token:s=e.token,!s)return[2,o(new hn.OpenViduError(hn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Virtual Background requires the client to be connected to a Session or to have a "token" property available in "options" parameter with a valid OpenVidu token'))];if(u=this.session.getTokenParams(s),u.edition!=="pro"&&u.edition!=="enterprise")return[2,o(new hn.OpenViduError(hn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"OpenVidu Virtual Background API is available from OpenVidu Pro edition onwards"))];s=encodeURIComponent(btoa(s)),Rt.info("Applying Virtual Background to stream "+this.streamId),l=function(){return Zi(f,void 0,void 0,function(){var h,v,g,m,y,b,w;return eo(this,function(x){switch(x.label){case 0:return x.trys.push([0,8,,9]),h=this.streamId+"_"+(0,Dpe.v4)(),v=this.mediaStream.clone(),g=this.streamManager.videos[0].video.cloneNode(!1),g.id=VirtualBackground.VirtualBackground.SOURCE_VIDEO_PREFIX+h,g.srcObject=v,g.muted=!0,this.virtualBackgroundSourceElements={videoClone:g,mediaStreamClone:v},VirtualBackground.VirtualBackground.hideHtmlElement(g,!1),VirtualBackground.VirtualBackground.appendHtmlElementToHiddenContainer(g,h),[4,g.play()];case 1:switch(x.sent(),m=new VirtualBackground.VirtualBackground({id:h,openviduServerUrl:new URL(u.httpUri),openviduToken:s,inputVideo:g,inputResolution:"160x96",outputFramerate:24}),y=void 0,b=n,b){case"VB:blur":return[3,2];case"VB:image":return[3,4]}return[3,6];case 2:return[4,m.backgroundBlur(e)];case 3:return y=x.sent(),[3,7];case 4:return[4,m.backgroundImage(e)];case 5:return y=x.sent(),[3,7];case 6:throw new Error("Unknown Virtual Background filter: "+n);case 7:return this.virtualBackgroundSinkElements={VB:m,video:y},g.style.display="none",this.streamManager.remote?this.streamManager.replaceTrackInMediaStream(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1):this.streamManager.replaceTrackAux(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1),a(void 0,!1),[3,9];case 8:return w=x.sent(),w.name===hn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?a(new hn.OpenViduError(hn.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,w.message),!1):a(w,!1),[3,9];case 9:return[2]}})})},typeof VirtualBackground>"u"?(c=document.createElement("script"),c.type="text/javascript",c.src=u.httpUri+"/openvidu/virtual-background/openvidu-virtual-background.js?token="+s,c.onload=function(){return Zi(f,void 0,void 0,function(){var h;return eo(this,function(v){switch(v.label){case 0:return v.trys.push([0,2,,3]),[4,l()];case 1:return v.sent(),i(new G1.Filter(n,e)),[3,3];case 2:return h=v.sent(),o(h),[3,3];case 3:return[2]}})})},document.body.appendChild(c)):l().then(function(){return i(new G1.Filter(n,e))}).catch(function(h){return o(h)})}else{if(!this.session.sessionConnected())return[2,o(this.session.notConnectedError())];Rt.info("Applying server filter to stream "+this.streamId),e=e??{},d=e,typeof d!="string"&&(d=JSON.stringify(d)),this.session.openvidu.sendRequest("applyFilter",{streamId:this.streamId,type:n,options:d},function(h,v){a(h,!0)})}return[2]})})})},t.prototype.removeFilter=function(){return Zi(this,void 0,void 0,function(){return eo(this,function(n){switch(n.label){case 0:return[4,this.removeFilterAux(!1)];case 1:return[2,n.sent()]}})})},t.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},t.prototype.getMediaStream=function(){return this.mediaStream},t.prototype.removeFilterAux=function(n){var e=this;return new Promise(function(r,i){return Zi(e,void 0,void 0,function(){var o,a,s,u=this,l;return eo(this,function(c){switch(c.label){case 0:if(o=function(d,f){if(d)return delete u.filter,Rt.error("Error removing filter for Stream "+u.streamId,d),d.code===401?i(new hn.OpenViduError(hn.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):i(d);Rt.info("Filter successfully removed from Stream "+u.streamId);var p=u.filter;return delete u.filter,f&&(u.session.emitEvent("streamPropertyChanged",[new $h.StreamPropertyChangedEvent(u.session,u,"filter",u.filter,p,"applyFilter")]),u.streamManager.emitEvent("streamPropertyChanged",[new $h.StreamPropertyChangedEvent(u.streamManager,u,"filter",u.filter,p,"applyFilter")])),r()},!this.filter)return[3,11];if(!(!((l=this.filter)===null||l===void 0)&&l.type.startsWith("VB:")))return[3,9];c.label=1;case 1:return c.trys.push([1,7,,8]),a=this.virtualBackgroundSourceElements.mediaStreamClone,n?[3,5]:this.streamManager.remote?(this.streamManager.replaceTrackInMediaStream(a.getVideoTracks()[0],!1),[3,4]):[3,2];case 2:return[4,this.streamManager.replaceTrackAux(a.getVideoTracks()[0],!1)];case 3:c.sent(),c.label=4;case 4:return[3,6];case 5:a.getTracks().forEach(function(d){return d.stop()}),c.label=6;case 6:return this.virtualBackgroundSinkElements.VB.cleanUp(),delete this.virtualBackgroundSinkElements,delete this.virtualBackgroundSourceElements,[2,o(void 0,!1)];case 7:return s=c.sent(),[2,o(s,!1)];case 8:return[3,10];case 9:if(!this.session.sessionConnected())return[2,i(this.session.notConnectedError())];Rt.info("Removing filter of stream "+this.streamId),this.session.openvidu.sendRequest("removeFilter",{streamId:this.streamId},function(d,f){return o(d,!0)}),c.label=10;case 10:return[3,12];case 11:return[2,i(new hn.OpenViduError(hn.OpenViduErrorName.GENERIC_ERROR,"Stream "+this.streamId+" has no filter applied"))];case 12:return[2]}})})})},t.prototype.setMediaStream=function(n){this.mediaStream=n},t.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},t.prototype.getWebRtcPeer=function(){return this.webRtcPeer},t.prototype.subscribeToMyRemote=function(n){this.isSubscribeToRemote=n},t.prototype.setOutboundStreamOptions=function(n){this.outboundStreamOpts=n},t.prototype.subscribe=function(){var n=this;return new Promise(function(e,r){n.initWebRtcPeerReceive(!1).then(function(){return e()}).catch(function(i){return r(i)})})},t.prototype.publish=function(){var n=this;return new Promise(function(e,r){n.isLocalStreamReadyToPublish?n.initWebRtcPeerSend(!1).then(function(){return e()}).catch(function(i){return r(i)}):n.ee.once("stream-ready-to-publish",function(){n.publish().then(function(){return e()}).catch(function(i){return r(i)})})})},t.prototype.disposeWebRtcPeer=function(){var n;this.webRtcPeer&&(this.webRtcPeer.dispose(),n=this.webRtcPeer.getId()),this.stopWebRtcStats(),Rt.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+n+"] from 'Stream' with id ["+this.streamId+"] is now closed")},t.prototype.disposeMediaStream=function(){return Zi(this,void 0,void 0,function(){var n;return eo(this,function(e){switch(e.label){case 0:if(!(this.filter&&this.filter.type.startsWith("VB:")))return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.removeFilterAux(!0)];case 2:return e.sent(),console.debug("Success removing Virtual Background filter for stream ".concat(this.streamId)),[3,4];case 3:return n=e.sent(),console.error("Error removing Virtual Background filter for stream ".concat(this.streamId),n),[3,4];case 4:return this.mediaStream&&(this.mediaStream.getAudioTracks().forEach(function(r){r.stop()}),this.mediaStream.getVideoTracks().forEach(function(r){r.stop()}),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach(function(r){r.stop()}),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach(function(r){r.stop()}),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),Rt.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed"),[2]}})})},t.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},t.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&this.outboundStreamOpts.publisherProperties.audioSource!==null&&this.outboundStreamOpts.publisherProperties.audioSource!==!1},t.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&this.outboundStreamOpts.publisherProperties.videoSource!==null&&this.outboundStreamOpts.publisherProperties.videoSource!==!1},t.prototype.isSendScreen=function(){var n=!1;if(typeof MediaStreamTrack<"u"&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack){var e=this.outboundStreamOpts.publisherProperties.videoSource.getSettings();e.displaySurface&&(n=["monitor","window","browser"].includes(e.displaySurface))}return!n&&QI.isElectron()&&(n=typeof this.outboundStreamOpts.publisherProperties.videoSource=="string"&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),n||(n=this.outboundStreamOpts.publisherProperties.videoSource==="screen"),!!this.outboundStreamOpts&&n},t.prototype.enableHarkSpeakingEvent=function(){var n=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabled&&this.speechEvent&&(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",function(){n.session.emitEvent("publisherStartSpeaking",[new xa.PublisherSpeakingEvent(n.session,"publisherStartSpeaking",n.connection,n.streamId)]),n.streamManager.emitEvent("publisherStartSpeaking",[new xa.PublisherSpeakingEvent(n.streamManager,"publisherStartSpeaking",n.connection,n.streamId)]),n.harkSpeakingEnabledOnce=!1}))},t.prototype.enableOnceHarkSpeakingEvent=function(){var n=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabledOnce&&this.speechEvent&&(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",function(){n.harkSpeakingEnabledOnce&&(n.session.emitEvent("publisherStartSpeaking",[new xa.PublisherSpeakingEvent(n.session,"publisherStartSpeaking",n.connection,n.streamId)]),n.streamManager.emitEvent("publisherStartSpeaking",[new xa.PublisherSpeakingEvent(n.streamManager,"publisherStartSpeaking",n.connection,n.streamId)])),n.disableHarkSpeakingEvent(!0)}))},t.prototype.disableHarkSpeakingEvent=function(n){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,n){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},t.prototype.enableHarkStoppedSpeakingEvent=function(){var n=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabled&&this.speechEvent&&(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",function(){n.session.emitEvent("publisherStopSpeaking",[new xa.PublisherSpeakingEvent(n.session,"publisherStopSpeaking",n.connection,n.streamId)]),n.streamManager.emitEvent("publisherStopSpeaking",[new xa.PublisherSpeakingEvent(n.streamManager,"publisherStopSpeaking",n.connection,n.streamId)]),n.harkStoppedSpeakingEnabledOnce=!1}))},t.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var n=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabledOnce&&this.speechEvent&&(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",function(){n.harkStoppedSpeakingEnabledOnce&&(n.session.emitEvent("publisherStopSpeaking",[new xa.PublisherSpeakingEvent(n.session,"publisherStopSpeaking",n.connection,n.streamId)]),n.streamManager.emitEvent("publisherStopSpeaking",[new xa.PublisherSpeakingEvent(n.streamManager,"publisherStopSpeaking",n.connection,n.streamId)])),n.disableHarkStoppedSpeakingEvent(!0)}))},t.prototype.disableHarkStoppedSpeakingEvent=function(n){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,n){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},t.prototype.enableHarkVolumeChangeEvent=function(n){var e=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabled||n)&&(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",function(r){var i=e.speechEvent.oldVolumeValue,o={newValue:r,oldValue:i};e.speechEvent.oldVolumeValue=r,e.streamManager.emitEvent("streamAudioVolumeChange",[new YI.StreamManagerEvent(e.streamManager,"streamAudioVolumeChange",o)])})):this.harkVolumeChangeEnabled=!0},t.prototype.enableOnceHarkVolumeChangeEvent=function(n){var e=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabledOnce||n)&&(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",function(r){var i=e.speechEvent.oldVolumeValue,o={newValue:r,oldValue:i};e.speechEvent.oldVolumeValue=r,e.disableHarkVolumeChangeEvent(!0),e.streamManager.emitEvent("streamAudioVolumeChange",[new YI.StreamManagerEvent(e.streamManager,"streamAudioVolumeChange",o)])})):this.harkVolumeChangeEnabledOnce=!0},t.prototype.disableHarkVolumeChangeEvent=function(n){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,n){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},t.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},t.prototype.getSelectedIceCandidate=function(){var n=this;return new Promise(function(e,r){n.webRtcStats.getSelectedIceCandidateInfo().then(function(i){return e(i)}).catch(function(i){return r(i)})})},t.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},t.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},t.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return Rt.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '.concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") will force a reconnection")),!0;var n=this.getRTCPeerConnection().iceConnectionState;return n!=="connected"&&n!=="completed"},t.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var n=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};n.interval=typeof n.interval=="number"?n.interval:100,n.threshold=typeof n.threshold=="number"?n.threshold:-50,this.speechEvent=Mpe(this.mediaStream,n)}return!0}return!1},t.prototype.setupReconnectionEventEmitter=function(n,e){return this.reconnectionEventEmitter==null?(this.reconnectionEventEmitter=new JI,!1):(console.warn("Trying to reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but an ongoing reconnection process is active. Waiting for response...")),this.reconnectionEventEmitter.once("success",function(){return n()}),this.reconnectionEventEmitter.once("error",function(r){return e(r)}),!0)},t.prototype.initWebRtcPeerSend=function(n){var e=this;return new Promise(function(r,i){var o;if(n){if(e.setupReconnectionEventEmitter(r,i))return}else e.initHarkEvents();var a=function(){var c;return n&&((c=e.reconnectionEventEmitter)===null||c===void 0||c.emitEvent("success"),delete e.reconnectionEventEmitter),r()},s=function(c){var d;return n&&((d=e.reconnectionEventEmitter)===null||d===void 0||d.emitEvent("error",[c]),delete e.reconnectionEventEmitter),i(c)},u=function(c){Rt.debug("Sending SDP offer to publish as "+e.streamId,c);var d=n?"reconnectStream":"publishVideo",f;if(n)f={stream:e.streamId,sdpString:c};else{var p=void 0;e.isSendVideo()&&(p=typeof MediaStreamTrack<"u"&&e.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?Sa.TypeOfVideo.CUSTOM:e.isSendScreen()?Sa.TypeOfVideo.SCREEN:Sa.TypeOfVideo.CAMERA),f={doLoopback:e.displayMyRemote()||!1,hasAudio:e.isSendAudio(),hasVideo:e.isSendVideo(),audioActive:e.audioActive,videoActive:e.videoActive,typeOfVideo:p,frameRate:e.frameRate?e.frameRate:-1,videoDimensions:JSON.stringify(e.videoDimensions),filter:e.outboundStreamOpts.publisherProperties.filter,sdpOffer:c}}e.session.openvidu.sendRequest(d,f,function(h,v){h?h.code===401?s(new hn.OpenViduError(hn.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):s("Error on publishVideo: "+JSON.stringify(h)):e.webRtcPeer.processRemoteAnswer(v.sdpAnswer).then(function(){e.streamId=v.id,e.creationTime=v.createdAt,e.isLocalStreamPublished=!0,e.publishedOnce=!0,e.displayMyRemote()&&(e.localMediaStreamWhenSubscribedToRemote=e.mediaStream,e.remotePeerSuccessfullyEstablished(n)),n?e.ee.emitEvent("stream-reconnected-by-publisher",[]):e.ee.emitEvent("stream-created-by-publisher",[]),e.initWebRtcStats(),Rt.info("'Publisher' ("+e.streamId+") successfully "+(n?"reconnected":"published")+" to session"),a()}).catch(function(g){s(g)})})},l={mediaConstraints:{audio:e.hasAudio,video:e.hasVideo},simulcast:(o=e.outboundStreamOpts.publisherProperties.videoSimulcast)!==null&&o!==void 0?o:e.session.openvidu.videoSimulcast,onIceCandidate:e.connection.sendIceCandidate.bind(e.connection),onIceConnectionStateException:e.onIceConnectionStateExceptionHandler.bind(e),iceServers:e.getIceServersConf(),mediaStream:e.mediaStream,mediaServer:e.session.openvidu.mediaServer,typeOfVideo:e.typeOfVideo?Sa.TypeOfVideo[e.typeOfVideo]:void 0};e.session.openvidu.mediaServer!=="mediasoup"&&(l.simulcast=!1),n&&e.disposeWebRtcPeer(),e.displayMyRemote()?e.webRtcPeer=new q1.WebRtcPeerSendrecv(l):e.webRtcPeer=new q1.WebRtcPeerSendonly(l),e.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+e.connection.connectionId),e.webRtcPeer.createOffer().then(function(c){e.webRtcPeer.processLocalOffer(c).then(function(){u(c.sdp)}).catch(function(d){s(new Error("(publish) SDP process local offer error: "+JSON.stringify(d)))})}).catch(function(c){s(new Error("(publish) SDP create offer error: "+JSON.stringify(c)))})})},t.prototype.finalResolveForSubscription=function(n,e){var r;return Rt.info("'Subscriber' ("+this.streamId+") successfully "+(n?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(n),this.initWebRtcStats(),n&&((r=this.reconnectionEventEmitter)===null||r===void 0||r.emitEvent("success"),delete this.reconnectionEventEmitter),e()},t.prototype.finalRejectForSubscription=function(n,e,r){var i;return Rt.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(n?"reconnect":"subscribe")+": "+e.toString()),n&&((i=this.reconnectionEventEmitter)===null||i===void 0||i.emitEvent("error",[e]),delete this.reconnectionEventEmitter),r(e)},t.prototype.initWebRtcPeerReceive=function(n){var e=this;return new Promise(function(r,i){n&&e.setupReconnectionEventEmitter(r,i)||(e.session.openvidu.mediaServer==="mediasoup"?e.initWebRtcPeerReceiveFromServer(n).then(function(){return e.finalResolveForSubscription(n,r)}).catch(function(o){return e.finalRejectForSubscription(n,o,i)}):e.initWebRtcPeerReceiveFromClient(n).then(function(){return e.finalResolveForSubscription(n,r)}).catch(function(o){return e.finalRejectForSubscription(n,o,i)}))})},t.prototype.initWebRtcPeerReceiveFromClient=function(n){var e=this;return new Promise(function(r,i){e.completeWebRtcPeerReceive(n,!1).then(function(o){e.webRtcPeer.processRemoteAnswer(o.sdpAnswer).then(function(){return r()}).catch(function(a){return i(a)})}).catch(function(o){return i(o)})})},t.prototype.initWebRtcPeerReceiveFromServer=function(n){var e=this;return new Promise(function(r,i){e.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:e.streamId,reconnect:n},function(o,a){if(o)return i(new Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(o)));e.completeWebRtcPeerReceive(n,!1,a.sdpOffer).then(function(){return r()}).catch(function(s){return i(s)})})})},t.prototype.completeWebRtcPeerReceive=function(n,e,r){var i=this;return new Promise(function(o,a){Rt.debug("'Session.subscribe(Stream)' called");var s=function(l){Rt.debug("Sending local SDP ".concat(r?"answer":"offer"," to subscribe to ").concat(i.streamId),l);var c=n?"reconnectStream":"receiveVideoFrom",d={};d[n?"stream":"sender"]=i.streamId,r?d[n?"sdpString":"sdpAnswer"]=l:d.sdpOffer=l,n&&(d.forciblyReconnect=e),i.session.openvidu.sendRequest(c,d,function(f,p){return f?a(new Error("Error on "+c+" : "+JSON.stringify(f))):o(p)})},u={mediaConstraints:{audio:i.hasAudio,video:i.hasVideo},simulcast:!1,onIceCandidate:i.connection.sendIceCandidate.bind(i.connection),onIceConnectionStateException:i.onIceConnectionStateExceptionHandler.bind(i),iceServers:i.getIceServersConf(),mediaServer:i.session.openvidu.mediaServer,typeOfVideo:i.typeOfVideo?Sa.TypeOfVideo[i.typeOfVideo]:void 0};n&&i.disposeWebRtcPeer(),i.webRtcPeer=new q1.WebRtcPeerRecvonly(u),i.webRtcPeer.addIceConnectionStateChangeListener(i.streamId),r?i.webRtcPeer.processRemoteOffer(r).then(function(){i.webRtcPeer.createAnswer().then(function(l){i.webRtcPeer.processLocalAnswer(l).then(function(){s(l.sdp)}).catch(function(c){return a(new Error("(subscribe) SDP process local answer error: "+JSON.stringify(c)))})}).catch(function(l){return a(new Error("(subscribe) SDP create answer error: "+JSON.stringify(l)))})}).catch(function(l){return a(new Error("(subscribe) SDP process remote offer error: "+JSON.stringify(l)))}):i.webRtcPeer.createOffer().then(function(l){i.webRtcPeer.processLocalOffer(l).then(function(){s(l.sdp)}).catch(function(c){return a(new Error("(subscribe) SDP process local offer error: "+JSON.stringify(c)))})}).catch(function(l){return a(new Error("(subscribe) SDP create offer error: "+JSON.stringify(l)))})})},t.prototype.remotePeerSuccessfullyEstablished=function(n){n&&this.mediaStream!=null&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var e,r=0,i=this.webRtcPeer.pc.getReceivers();r<i.length;r++)e=i[r],e.track&&this.mediaStream.addTrack(e.track);if(Rt.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof Ipe.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var o=n?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=o}if(this.mediaStream.getVideoTracks()[0]){var o=n?this.videoActive:!!this.videoActive&&!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=o}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},t.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},t.prototype.onIceConnectionStateExceptionHandler=function(n,e,r){switch(n){case Td.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case Td.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected();break}this.session.emitEvent("exception",[new Td.ExceptionEvent(this.session,n,this,e,r)])},t.prototype.onIceConnectionFailed=function(){Rt.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",")")),this.reconnectStreamAndLogResultingIceConnectionState(Td.ExceptionEventName.ICE_CONNECTION_FAILED)},t.prototype.onIceConnectionDisconnected=function(){var n=this;Rt.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") if not possible"));var e=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(e).then(function(r){switch(r){case"failed":Rt.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(n.streamId," (").concat(n.isLocal()?"Publisher":"Subscriber",") is now failed after ICE_CONNECTION_DISCONNECTED"));break;case"connected":case"completed":Rt.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(n.streamId," (").concat(n.isLocal()?"Publisher":"Subscriber",") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: ").concat(r));break;case"closed":case"checking":case"new":case"disconnected":Rt.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(n.streamId," (").concat(n.isLocal()?"Publisher":"Subscriber",") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after ").concat(e," ms: ").concat(r)),n.reconnectStreamAndLogResultingIceConnectionState(Td.ExceptionEventName.ICE_CONNECTION_DISCONNECTED);break}})},t.prototype.reconnectStreamAndLogResultingIceConnectionState=function(n){return Zi(this,void 0,void 0,function(){var e,r;return eo(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(n)];case 1:switch(e=i.sent(),e){case"connected":case"completed":Rt.log("[".concat(n,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") successfully reconnected after ").concat(n,". Current ICE connection state: ").concat(e));break;default:Rt.error("[".concat(n,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") failed to reconnect after ").concat(n,". Current ICE connection state: ").concat(e));break}return[3,3];case 2:return r=i.sent(),Rt.error("[".concat(n,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after ").concat(n,": ").concat(r)),[3,3];case 3:return[2]}})})},t.prototype.reconnectStreamAndReturnIceConnectionState=function(n){return Zi(this,void 0,void 0,function(){var e,r;return eo(this,function(i){switch(i.label){case 0:Rt.log("[".concat(n,"] Reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after event ").concat(n)),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.reconnectStream(n)];case 2:return i.sent(),e=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(e)];case 3:return r=i.sent(),Rt.warn("[".concat(n,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber","). Reason: ").concat(r)),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}})})},t.prototype.awaitWebRtcPeerConnectionState=function(n){return Zi(this,void 0,void 0,function(){var e,r,i,o;return eo(this,function(a){switch(a.label){case 0:e=this.getRTCPeerConnection().iceConnectionState,r=150,i=Math.ceil(n/r),o=0,a.label=1;case 1:return o<i?(e=this.getRTCPeerConnection().iceConnectionState,e==="connected"||e==="completed"?[3,4]:[4,new Promise(function(s){return setTimeout(s,r)})]):[3,4];case 2:a.sent(),a.label=3;case 3:return o++,[3,1];case 4:return[2,e]}})})},t.prototype.reconnectStream=function(n){return Zi(this,void 0,void 0,function(){var e,r;return eo(this,function(i){switch(i.label){case 0:return[4,this.isWebsocketConnected(n,3e3)];case 1:if(e=i.sent(),e)return Rt.log("[".concat(n,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") and the websocket is opened")),this.isLocal()?[2,this.initWebRtcPeerSend(!0)]:[2,this.initWebRtcPeerReceive(!0)];throw r="[".concat(n,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but the websocket wasn't opened"),Rt.error(r),Error(r)}})})},t.prototype.isWebsocketConnected=function(n,e){var r=this;return new Promise(function(i,o){var a=r.session.openvidu.getWsReadyState();if(a===1){var s=setTimeout(function(){return console.warn("[".concat(n,"] Websocket timeout of ").concat(e,"ms")),i(!1)},e);r.session.openvidu.sendRequest("echo",{},function(u,l){return clearTimeout(s),u?(console.warn("[".concat(n,"] Websocket 'echo' returned error: ").concat(u)),i(!1)):i(!0)})}else return console.warn("[".concat(n,"] Websocket readyState is ").concat(a)),i(!1)})},t.prototype.initWebRtcStats=function(){this.webRtcStats=new _pe.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},t.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},t.prototype.getIceServersConf=function(){var n;return this.session.openvidu.advancedConfiguration.iceServers?n=this.session.openvidu.advancedConfiguration.iceServers==="freeice"?void 0:this.session.openvidu.advancedConfiguration.iceServers:this.session.openvidu.iceServers?n=this.session.openvidu.iceServers:n=void 0,n},t.prototype.gatherStatsForPeer=function(){var n=this;return new Promise(function(e,r){n.isLocal()?n.getRTCPeerConnection().getSenders().forEach(function(i){return i.getStats().then(function(o){o.forEach(function(a){if(n.isReportWanted(a)){var s={};s.type=a.type,s.timestamp=a.timestamp,s.id=a.id,a.type==="outbound-rtp"&&(s.ssrc=a.ssrc,s.firCount=a.firCount,s.pliCount=a.pliCount,s.nackCount=a.nackCount,s.qpSum=a.qpSum,a.kind?s.mediaType=a.kind:a.mediaType?s.mediaType=a.mediaType:s.mediaType=a.id.indexOf("VideoStream")!==-1?"video":"audio",s.mediaType==="video"&&(s.framesEncoded=a.framesEncoded),s.packetsSent=a.packetsSent,s.bytesSent=a.bytesSent),a.type==="candidate-pair"&&a.totalRoundTripTime!==void 0&&(s.availableOutgoingBitrate=a.availableOutgoingBitrate,s.rtt=a.currentRoundTripTime,s.averageRtt=a.totalRoundTripTime/a.responsesReceived),a.type==="remote-inbound-rtp"||a.type,Rt.log(s)}})})}):n.getRTCPeerConnection().getReceivers().forEach(function(i){return i.getStats().then(function(o){o.forEach(function(a){if(n.isReportWanted(a)){var s={};s.type=a.type,s.timestamp=a.timestamp,s.id=a.id,a.type==="inbound-rtp"&&(s.ssrc=a.ssrc,s.firCount=a.firCount,s.pliCount=a.pliCount,s.nackCount=a.nackCount,s.qpSum=a.qpSum,a.kind?s.mediaType=a.kind:a.mediaType?s.mediaType=a.mediaType:s.mediaType=a.id.indexOf("VideoStream")!==-1?"video":"audio",s.mediaType==="video"&&(s.framesDecoded=a.framesDecoded),s.packetsReceived=a.packetsReceived,s.packetsLost=a.packetsLost,s.jitter=a.jitter,s.bytesReceived=a.bytesReceived),a.type==="candidate-pair"&&a.totalRoundTripTime!==void 0&&(s.availableIncomingBitrate=a.availableIncomingBitrate,s.rtt=a.currentRoundTripTime,s.averageRtt=a.totalRoundTripTime/a.responsesReceived),a.type==="remote-inbound-rtp"||a.type,Rt.log(s)}})})})})},t.prototype.isReportWanted=function(n){return n.type==="inbound-rtp"&&!this.isLocal()||n.type==="outbound-rtp"&&this.isLocal()||n.type==="candidate-pair"&&n.nominated&&n.bytesSent>0},t}();Bc.Stream=Ppe;Object.defineProperty(Bp,"__esModule",{value:!0});Bp.Connection=void 0;var Lpe=Bc,Fpe=An,ZI=zu,Nd=Fpe.OpenViduLogger.getInstance(),zpe=function(){function t(n,e){this.session=n,this.disposed=!1;var r="'Connection' created ";e.role?(this.localOptions=e,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,r+="(local)"):(this.remoteOptions=e,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),r+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),Nd.info(r)}return t.prototype.sendIceCandidate=function(n){var e=this;this.disposed?Nd.warn("Connection ".concat(this.connectionId," disposed when trying to send an ICE candidate. ICE candidate not sent")):(Nd.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,n),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex},function(r,i){r&&(Nd.error("Error sending ICE candidate: "+JSON.stringify(r)),e.session.emitEvent("exception",[new ZI.ExceptionEvent(e.session,ZI.ExceptionEventName.ICE_CANDIDATE_ERROR,e.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",r)]))}))},t.prototype.initRemoteStreams=function(n){var e=this;n.forEach(function(r){var i={id:r.id,createdAt:r.createdAt,connection:e,hasAudio:r.hasAudio,hasVideo:r.hasVideo,audioActive:r.audioActive,videoActive:r.videoActive,typeOfVideo:r.typeOfVideo,frameRate:r.frameRate,videoDimensions:r.videoDimensions?JSON.parse(r.videoDimensions):void 0,filter:r.filter?r.filter:void 0},o=new Lpe.Stream(e.session,i);e.addStream(o)}),Nd.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},t.prototype.addStream=function(n){n.connection=this,this.stream=n},t.prototype.removeStream=function(){delete this.stream},t.prototype.dispose=function(){this.disposed=!0,this.removeStream()},t}();Bp.Connection=zpe;var Wp={},Bpe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Wp,"__esModule",{value:!0});Wp.ConnectionEvent=void 0;var jpe=$n,Vpe=function(t){Bpe(n,t);function n(e,r,i,o,a){var s=t.call(this,e,r,i)||this;return s.connection=o,s.reason=a,s}return n.prototype.callDefaultBehavior=function(){},n}(jpe.Event);Wp.ConnectionEvent=Vpe;var Hp={},$pe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Hp,"__esModule",{value:!0});Hp.FilterEvent=void 0;var Upe=$n,Wpe=function(t){$pe(n,t);function n(e,r,i){var o=t.call(this,!1,e,r)||this;return o.data=i,o}return n.prototype.callDefaultBehavior=function(){},n}(Upe.Event);Hp.FilterEvent=Wpe;var Gp={},Hpe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Gp,"__esModule",{value:!0});Gp.RecordingEvent=void 0;var Gpe=$n,qpe=function(t){Hpe(n,t);function n(e,r,i,o,a){var s=t.call(this,!1,e,r)||this;return s.id=i,o!==i&&(s.name=o),s.reason=a,s}return n.prototype.callDefaultBehavior=function(){},n}(Gpe.Event);Gp.RecordingEvent=qpe;var Hc={},Kpe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Hc,"__esModule",{value:!0});Hc.SessionDisconnectedEvent=void 0;var Xpe=$n,Ype=An,Jpe=Ype.OpenViduLogger.getInstance(),Qpe=function(t){Kpe(n,t);function n(e,r){var i=t.call(this,!0,e,"sessionDisconnected")||this;return i.reason=r,i}return n.prototype.callDefaultBehavior=function(){Jpe.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var e=this.target;e.remoteConnections.forEach(function(r){var i,o,a,s,u,l,c,d,f=r.connectionId;if(!((i=e.remoteConnections.get(f))===null||i===void 0)&&i.stream){(o=e.remoteConnections.get(f))===null||o===void 0||o.stream.disposeWebRtcPeer(),(a=e.remoteConnections.get(f))===null||a===void 0||a.stream.disposeMediaStream(),!((s=e.remoteConnections.get(f))===null||s===void 0)&&s.stream.streamManager&&((u=e.remoteConnections.get(f))===null||u===void 0||u.stream.streamManager.removeAllVideos());var p=(c=(l=e.remoteConnections.get(f))===null||l===void 0?void 0:l.stream)===null||c===void 0?void 0:c.streamId;p&&e.remoteStreamsCreated.delete(p),(d=e.remoteConnections.get(f))===null||d===void 0||d.dispose()}e.remoteConnections.delete(f)})},n}(Xpe.Event);Hc.SessionDisconnectedEvent=Qpe;var qp={},Zpe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(qp,"__esModule",{value:!0});qp.SignalEvent=void 0;var ehe=$n,the=function(t){Zpe(n,t);function n(e,r,i,o){var a=t.call(this,!1,e,"signal")||this;return r&&(a.type="signal:"+r),a.data=i,a.from=o,a}return n.prototype.callDefaultBehavior=function(){},n}(ehe.Event);qp.SignalEvent=the;var Kp={},nhe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Kp,"__esModule",{value:!0});Kp.SpeechToTextEvent=void 0;var rhe=$n,ihe=function(t){nhe(n,t);function n(e,r,i,o,a,s){var u=t.call(this,!1,e,"speechToTextMessage")||this;return u.connection=r,u.text=i,u.reason=o,u.raw=a,u.lang=s,u}return n.prototype.callDefaultBehavior=function(){},n}(rhe.Event);Kp.SpeechToTextEvent=ihe;var kd={},e_;function mR(){if(e_)return kd;e_=1;var t=ve&&ve.__extends||function(){var s=function(u,l){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(c[f]=d[f])},s(u,l)};return function(u,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");s(u,l);function c(){this.constructor=u}u.prototype=l===null?Object.create(l):(c.prototype=l.prototype,new c)}}();Object.defineProperty(kd,"__esModule",{value:!0}),kd.StreamEvent=void 0;var n=$n,e=vR(),r=u0(),i=An,o=i.OpenViduLogger.getInstance(),a=function(s){t(u,s);function u(l,c,d,f,p){var h=s.call(this,l,c,d)||this;return h.stream=f,h.reason=p,h}return u.prototype.callDefaultBehavior=function(){if(this.type==="streamDestroyed"){if(this.target instanceof r.Session)o.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof e.Publisher){o.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var l=this.target.openvidu.publishers,c=0;c<l.length;c++)if(l[c]===this.target){l.splice(c,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var d=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(d&&d.remoteOptions)for(var f=d.remoteOptions.streams,c=f.length-1;c>=0;--c)f[c].id===this.stream.streamId&&f.splice(c,1)}},u}(n.Event);return kd.StreamEvent=a,kd}var Xp={},ohe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Xp,"__esModule",{value:!0});Xp.ConnectionPropertyChangedEvent=void 0;var ahe=$n,she=function(t){ohe(n,t);function n(e,r,i,o,a){var s=t.call(this,!1,e,"connectionPropertyChanged")||this;return s.connection=r,s.changedProperty=i,s.newValue=o,s.oldValue=a,s}return n.prototype.callDefaultBehavior=function(){},n}(ahe.Event);Xp.ConnectionPropertyChangedEvent=she;var Yp={},uhe=ve&&ve.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Yp,"__esModule",{value:!0});Yp.NetworkQualityLevelChangedEvent=void 0;var lhe=$n,che=function(t){uhe(n,t);function n(e,r,i,o){var a=t.call(this,!1,e,"networkQualityLevelChanged")||this;return a.newValue=r,a.oldValue=i,a.connection=o,a}return n.prototype.callDefaultBehavior=function(){},n}(lhe.Event);Yp.NetworkQualityLevelChangedEvent=che;var K1={};const dhe=typeof process=="object"&&K1&&K1.NODE_DEBUG&&/\bsemver\b/i.test(K1.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};var nj=dhe;const fhe="2.0.0",phe=256,hhe=Number.MAX_SAFE_INTEGER||9007199254740991,mhe=16;var rj={SEMVER_SPEC_VERSION:fhe,MAX_LENGTH:phe,MAX_SAFE_INTEGER:hhe,MAX_SAFE_COMPONENT_LENGTH:mhe},Ex={exports:{}};(function(t,n){const{MAX_SAFE_COMPONENT_LENGTH:e}=rj,r=nj;n=t.exports={};const i=n.re=[],o=n.src=[],a=n.t={};let s=0;const u=(l,c,d)=>{const f=s++;r(l,f,c),a[l]=f,o[f]=c,i[f]=new RegExp(c,d?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${o[a.NUMERICIDENTIFIER]}|${o[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${o[a.NUMERICIDENTIFIERLOOSE]}|${o[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${o[a.PRERELEASEIDENTIFIER]}(?:\\.${o[a.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${o[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[a.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${o[a.BUILDIDENTIFIER]}(?:\\.${o[a.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${o[a.MAINVERSION]}${o[a.PRERELEASE]}?${o[a.BUILD]}?`),u("FULL",`^${o[a.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${o[a.MAINVERSIONLOOSE]}${o[a.PRERELEASELOOSE]}?${o[a.BUILD]}?`),u("LOOSE",`^${o[a.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${o[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${o[a.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:${o[a.PRERELEASE]})?${o[a.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:${o[a.PRERELEASELOOSE]})?${o[a.BUILD]}?)?)?`),u("XRANGE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${e}})(?:\\.(\\d{1,${e}}))?(?:\\.(\\d{1,${e}}))?(?:$|[^\\d])`),u("COERCERTL",o[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${o[a.LONETILDE]}\\s+`,!0),n.tildeTrimReplace="$1~",u("TILDE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${o[a.LONECARET]}\\s+`,!0),n.caretTrimReplace="$1^",u("CARET",`^${o[a.LONECARET]}${o[a.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${o[a.LONECARET]}${o[a.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${o[a.GTLT]}\\s*(${o[a.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]}|${o[a.XRANGEPLAIN]})`,!0),n.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${o[a.XRANGEPLAIN]})\\s+-\\s+(${o[a.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${o[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[a.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Ex,Ex.exports);var vhe=Ex.exports;const ghe=["includePrerelease","loose","rtl"],yhe=t=>t?typeof t!="object"?{loose:!0}:ghe.filter(n=>t[n]).reduce((n,e)=>(n[e]=!0,n),{}):{};var bhe=yhe;const t_=/^[0-9]+$/,ij=(t,n)=>{const e=t_.test(t),r=t_.test(n);return e&&r&&(t=+t,n=+n),t===n?0:e&&!r?-1:r&&!e?1:t<n?-1:1},whe=(t,n)=>ij(n,t);var xhe={compareIdentifiers:ij,rcompareIdentifiers:whe};const Uh=nj,{MAX_LENGTH:n_,MAX_SAFE_INTEGER:Wh}=rj,{re:r_,t:i_}=vhe,She=bhe,{compareIdentifiers:tl}=xhe;let Ehe=class to{constructor(n,e){if(e=She(e),n instanceof to){if(n.loose===!!e.loose&&n.includePrerelease===!!e.includePrerelease)return n;n=n.version}else if(typeof n!="string")throw new TypeError(`Invalid Version: ${n}`);if(n.length>n_)throw new TypeError(`version is longer than ${n_} characters`);Uh("SemVer",n,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const r=n.trim().match(e.loose?r_[i_.LOOSE]:r_[i_.FULL]);if(!r)throw new TypeError(`Invalid Version: ${n}`);if(this.raw=n,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Wh||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Wh||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Wh||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const o=+i;if(o>=0&&o<Wh)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(n){if(Uh("SemVer.compare",this.version,this.options,n),!(n instanceof to)){if(typeof n=="string"&&n===this.version)return 0;n=new to(n,this.options)}return n.version===this.version?0:this.compareMain(n)||this.comparePre(n)}compareMain(n){return n instanceof to||(n=new to(n,this.options)),tl(this.major,n.major)||tl(this.minor,n.minor)||tl(this.patch,n.patch)}comparePre(n){if(n instanceof to||(n=new to(n,this.options)),this.prerelease.length&&!n.prerelease.length)return-1;if(!this.prerelease.length&&n.prerelease.length)return 1;if(!this.prerelease.length&&!n.prerelease.length)return 0;let e=0;do{const r=this.prerelease[e],i=n.prerelease[e];if(Uh("prerelease compare",e,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return tl(r,i)}while(++e)}compareBuild(n){n instanceof to||(n=new to(n,this.options));let e=0;do{const r=this.build[e],i=n.build[e];if(Uh("prerelease compare",e,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return tl(r,i)}while(++e)}inc(n,e){switch(n){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(tl(this.prerelease[0],e)===0?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error(`invalid increment argument: ${n}`)}return this.format(),this.raw=this.version,this}};var oj=Ehe;const Che=oj,Rhe=(t,n)=>new Che(t,n).major;var The=Rhe;const Nhe=oj,khe=(t,n)=>new Nhe(t,n).minor;var Ihe=khe,o_;function u0(){if(o_)return Rd;o_=1;var t=ve&&ve.__extends||function(){var M=function(D,T){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,P){O.__proto__=P}||function(O,P){for(var A in P)Object.prototype.hasOwnProperty.call(P,A)&&(O[A]=P[A])},M(D,T)};return function(D,T){if(typeof T!="function"&&T!==null)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");M(D,T);function O(){this.constructor=D}D.prototype=T===null?Object.create(T):(O.prototype=T.prototype,new O)}}(),n=ve&&ve.__awaiter||function(M,D,T,O){function P(A){return A instanceof T?A:new T(function(I){I(A)})}return new(T||(T=Promise))(function(A,I){function _(H){try{L(O.next(H))}catch(B){I(B)}}function F(H){try{L(O.throw(H))}catch(B){I(B)}}function L(H){H.done?A(H.value):P(H.value).then(_,F)}L((O=O.apply(M,D||[])).next())})},e=ve&&ve.__generator||function(M,D){var T={label:0,sent:function(){if(A[0]&1)throw A[1];return A[1]},trys:[],ops:[]},O,P,A,I;return I={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(I[Symbol.iterator]=function(){return this}),I;function _(L){return function(H){return F([L,H])}}function F(L){if(O)throw new TypeError("Generator is already executing.");for(;I&&(I=0,L[0]&&(T=0)),T;)try{if(O=1,P&&(A=L[0]&2?P.return:L[0]?P.throw||((A=P.return)&&A.call(P),0):P.next)&&!(A=A.call(P,L[1])).done)return A;switch(P=0,A&&(L=[L[0]&2,A.value]),L[0]){case 0:case 1:A=L;break;case 4:return T.label++,{value:L[1],done:!1};case 5:T.label++,P=L[1],L=[0];continue;case 7:L=T.ops.pop(),T.trys.pop();continue;default:if(A=T.trys,!(A=A.length>0&&A[A.length-1])&&(L[0]===6||L[0]===2)){T=0;continue}if(L[0]===3&&(!A||L[1]>A[0]&&L[1]<A[3])){T.label=L[1];break}if(L[0]===6&&T.label<A[1]){T.label=A[1],A=L;break}if(A&&T.label<A[2]){T.label=A[2],T.ops.push(L);break}A[2]&&T.ops.pop(),T.trys.pop();continue}L=D.call(M,T)}catch(H){L=[6,H],P=0}finally{O=A=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}};Object.defineProperty(Rd,"__esModule",{value:!0}),Rd.Session=void 0;var r=Bp,i=jc,o=Vc,a=Uc,s=Wp,u=Hp,l=Gp,c=Hc,d=qp,f=Kp,p=mR(),h=ma,v=Xp,g=Yp,m=Fu,y=Vp,b=An,w=Yi,x=The,C=Ihe,E=zu,S=b.OpenViduLogger.getInstance(),k,N=function(M){t(D,M);function D(T){var O=M.call(this)||this;return O.streamManagers=[],O.remoteStreamsCreated=new Map,O.remoteConnections=new Map,k=w.PlatformUtils.getInstance(),O.openvidu=T,O}return D.prototype.connect=function(T,O){var P=this;return new Promise(function(A,I){if(P.processToken(T),P.openvidu.checkSystemRequirements())P.options={sessionId:P.sessionId,participantId:T,metadata:O?P.stringClientMetadata(O):""},P.connectAux(T).then(function(){return A()}).catch(function(_){return I(_)});else return I(new m.OpenViduError(m.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+k.getName()+" (version "+k.getVersion()+") for "+k.getFamily()+" is not supported in OpenVidu"))})},D.prototype.disconnect=function(){this.leave(!1,"disconnect")},D.prototype.subscribe=function(T,O,P,A){var I={};P&&typeof P!="function"?I={insertMode:typeof P.insertMode<"u"?typeof P.insertMode=="string"?y.VideoInsertMode[P.insertMode]:I.insertMode:y.VideoInsertMode.APPEND,subscribeToAudio:typeof P.subscribeToAudio<"u"?P.subscribeToAudio:!0,subscribeToVideo:typeof P.subscribeToVideo<"u"?P.subscribeToVideo:!0}:I={insertMode:y.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var _=void 0;if(P&&typeof P=="function"?_=P:A&&(_=A),!this.sessionConnected())throw _!==void 0&&_(this.notConnectedError()),this.notConnectedError();S.info("Subscribing to "+T.connection.connectionId),T.subscribe().then(function(){S.info("Subscribed correctly to "+T.connection.connectionId),_!==void 0&&_(void 0)}).catch(function(L){_!==void 0&&_(L)});var F=new o.Subscriber(T,O,I);return F.targetElement&&T.streamManager.createVideoElement(F.targetElement,I.insertMode),F},D.prototype.subscribeAsync=function(T,O,P){var A=this;return new Promise(function(I,_){if(!A.sessionConnected())return _(A.notConnectedError());var F,L=function(H){return H?_(H):I(F)};P?F=A.subscribe(T,O,P,L):F=A.subscribe(T,O,L)})},D.prototype.unsubscribe=function(T){var O=this;return new Promise(function(P,A){if(O.sessionConnected()){var I=T.stream.connection.connectionId;S.info("Unsubscribing from "+I),O.openvidu.sendRequest("unsubscribeFromVideo",{sender:T.stream.connection.connectionId},function(_,F){return _?(S.error("Error unsubscribing from "+I),A(_)):(S.info("Unsubscribed correctly from "+I),T.stream.streamManager.removeAllVideos(),T.stream.disposeWebRtcPeer(),T.stream.disposeMediaStream(),P())})}else return A(O.notConnectedError())})},D.prototype.publish=function(T){var O=this;return new Promise(function(P,A){if(!O.sessionConnected())return A(O.notConnectedError());T.session=O,T.stream.session=O,T.stream.publishedOnce?T.initialize().then(function(){O.connection.addStream(T.stream),T.reestablishStreamPlayingEvent(),T.stream.publish().then(function(){return O.sendVideoData(T,8,!0,5),P()}).catch(function(I){return A(I)})}).catch(function(I){return A(I)}):(O.connection.addStream(T.stream),T.stream.publish().then(function(){return O.sendVideoData(T,8,!0,5),P()}).catch(function(I){return A(I)}))})},D.prototype.unpublish=function(T){var O=this;return new Promise(function(P,A){if(!O.sessionConnected())throw O.notConnectedError();var I=T.stream;if(I.connection){if(I.connection!==O.connection)return A(new Error("The associated Connection object of this Publisher is not your local Connection.  Only moderators can force unpublish on remote Streams via 'forceUnpublish' method"));S.info("Unpublishing local media ("+I.connection.connectionId+")"),O.openvidu.sendRequest("unpublishVideo",function(_,F){if(_)return A(_);S.info("Media unpublished correctly"),I.disposeWebRtcPeer(),I.connection.stream==I&&delete I.connection.stream;var L=new p.StreamEvent(!0,T,"streamDestroyed",T.stream,"unpublish");return T.emitEvent("streamDestroyed",[L]),L.callDefaultBehavior(),P()})}else return A(new Error("The associated Connection object of this Publisher is null"))})},D.prototype.forceDisconnect=function(T){var O=this;return new Promise(function(P,A){if(!O.sessionConnected())return A(O.notConnectedError());S.info("Forcing disconnect for connection "+T.connectionId),O.openvidu.sendRequest("forceDisconnect",{connectionId:T.connectionId},function(I,_){return I?(S.error("Error forcing disconnect for Connection "+T.connectionId,I),I.code===401?A(new m.OpenViduError(m.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):A(I)):(S.info("Forcing disconnect correctly for Connection "+T.connectionId),P())})})},D.prototype.forceUnpublish=function(T){var O=this;return new Promise(function(P,A){if(!O.sessionConnected())return A(O.notConnectedError());S.info("Forcing unpublish for stream "+T.streamId),O.openvidu.sendRequest("forceUnpublish",{streamId:T.streamId},function(I,_){return I?(S.error("Error forcing unpublish for Stream "+T.streamId,I),I.code===401?A(new m.OpenViduError(m.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):A(I)):(S.info("Forcing unpublish correctly for Stream "+T.streamId),P())})})},D.prototype.signal=function(T){var O=this;return new Promise(function(P,A){if(!O.sessionConnected())return A(O.notConnectedError());var I={};if(T.to&&T.to.length>0){var _=[];T.to.forEach(function(L){L.connectionId&&_.push(L.connectionId)}),I.to=_}else I.to=[];I.data=T.data?T.data:"";var F=T.type?T.type:"signal";F&&F.substring(0,7)!=="signal:"&&(F="signal:"+F),I.type=F,O.openvidu.sendRequest("sendMessage",{message:JSON.stringify(I)},function(L,H){return L?A(L):P()})})},D.prototype.subscribeToSpeechToText=function(T,O){var P=this;return new Promise(function(A,I){P.openvidu.sendRequest("subscribeToSpeechToText",{connectionId:T.connection.connectionId,lang:O},function(_,F){return _?I(_):A()})})},D.prototype.unsubscribeFromSpeechToText=function(T){var O=this;return new Promise(function(P,A){O.openvidu.sendRequest("unsubscribeFromSpeechToText",{connectionId:T.connection.connectionId},function(I,_){return I?A(I):P()})})},D.prototype.on=function(T,O){var P,A,I,_;return M.prototype.onAux.call(this,T,"Event '"+T+"' triggered by 'Session'",O),T==="publisherStartSpeaking"&&(this.remoteConnections.forEach(function(F){var L;!((L=F.stream)===null||L===void 0)&&L.hasAudio&&F.stream.enableHarkSpeakingEvent()}),!((A=(P=this.connection)===null||P===void 0?void 0:P.stream)===null||A===void 0)&&A.hasAudio&&this.connection.stream.enableHarkSpeakingEvent()),T==="publisherStopSpeaking"&&(this.remoteConnections.forEach(function(F){var L;!((L=F.stream)===null||L===void 0)&&L.hasAudio&&F.stream.enableHarkStoppedSpeakingEvent()}),!((_=(I=this.connection)===null||I===void 0?void 0:I.stream)===null||_===void 0)&&_.hasAudio&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},D.prototype.once=function(T,O){var P,A,I,_;return M.prototype.onceAux.call(this,T,"Event '"+T+"' triggered once by 'Session'",O),T==="publisherStartSpeaking"&&(this.remoteConnections.forEach(function(F){var L;!((L=F.stream)===null||L===void 0)&&L.hasAudio&&F.stream.enableOnceHarkSpeakingEvent()}),!((A=(P=this.connection)===null||P===void 0?void 0:P.stream)===null||A===void 0)&&A.hasAudio&&this.connection.stream.enableOnceHarkSpeakingEvent()),T==="publisherStopSpeaking"&&(this.remoteConnections.forEach(function(F){var L;!((L=F.stream)===null||L===void 0)&&L.hasAudio&&F.stream.enableOnceHarkStoppedSpeakingEvent()}),!((_=(I=this.connection)===null||I===void 0?void 0:I.stream)===null||_===void 0)&&_.hasAudio&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},D.prototype.off=function(T,O){var P=this,A,I,_,F;return M.prototype.offAux.call(this,T,O),T==="publisherStartSpeaking"&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)||(this.remoteConnections.forEach(function(L){var H;!((H=L.stream)===null||H===void 0)&&H.streamManager&&(P.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,L.stream.streamManager)||L.stream.disableHarkSpeakingEvent(!1))}),!((I=(A=this.connection)===null||A===void 0?void 0:A.stream)===null||I===void 0)&&I.streamManager&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkSpeakingEvent(!1)))),T==="publisherStopSpeaking"&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)||(this.remoteConnections.forEach(function(L){var H;!((H=L.stream)===null||H===void 0)&&H.streamManager&&(P.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,L.stream.streamManager)||L.stream.disableHarkStoppedSpeakingEvent(!1))}),!((F=(_=this.connection)===null||_===void 0?void 0:_.stream)===null||F===void 0)&&F.streamManager&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkStoppedSpeakingEvent(!1)))),this},D.prototype.onParticipantJoined=function(T){var O=this;this.getConnection(T.id,"").then(function(P){S.warn("Connection "+P.connectionId+" already exists in connections list")}).catch(function(P){var A=new r.Connection(O,T);O.remoteConnections.set(T.id,A),O.ee.emitEvent("connectionCreated",[new s.ConnectionEvent(!1,O,"connectionCreated",A,"")])})},D.prototype.onParticipantLeft=function(T){var O=this;this.getRemoteConnection(T.connectionId,"onParticipantLeft").then(function(P){if(P.stream){var A=P.stream,I=new p.StreamEvent(!0,O,"streamDestroyed",A,T.reason);O.ee.emitEvent("streamDestroyed",[I]),I.callDefaultBehavior(),O.remoteStreamsCreated.delete(A.streamId)}P.dispose(),O.remoteConnections.delete(P.connectionId),O.ee.emitEvent("connectionDestroyed",[new s.ConnectionEvent(!1,O,"connectionDestroyed",P,T.reason)])}).catch(function(P){S.error(P)})},D.prototype.onParticipantPublished=function(T){var O=this,P=function(I){O.remoteConnections.set(I.connectionId,I),O.remoteStreamsCreated.get(I.stream.streamId)||O.ee.emitEvent("streamCreated",[new p.StreamEvent(!1,O,"streamCreated",I.stream,"")]),O.remoteStreamsCreated.set(I.stream.streamId,!0)},A;this.getRemoteConnection(T.id,"onParticipantPublished").then(function(I){A=I,T.metadata=I.data,A.remoteOptions=T,A.initRemoteStreams(T.streams),P(A)}).catch(function(I){A=new r.Connection(O,T),P(A)})},D.prototype.onParticipantUnpublished=function(T){var O=this;T.connectionId===this.connection.connectionId?this.stopPublisherStream(T.reason):this.getRemoteConnection(T.connectionId,"onParticipantUnpublished").then(function(P){var A=new p.StreamEvent(!0,O,"streamDestroyed",P.stream,T.reason);if(O.ee.emitEvent("streamDestroyed",[A]),A.callDefaultBehavior(),P.stream!=null){var I=P.stream.streamId;O.remoteStreamsCreated.delete(I),P.removeStream()}}).catch(function(P){S.error(P)})},D.prototype.onParticipantEvicted=function(T){T.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,T.reason)},D.prototype.onNewMessage=function(T){var O=this;S.info("New signal: "+JSON.stringify(T));var P=T.type?T.type.replace(/^(signal:)/,""):void 0;T.from?this.getConnection(T.from,"Connection '"+T.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then(function(A){O.ee.emitEvent("signal",[new d.SignalEvent(O,P,T.data,A)]),T.type&&T.type!=="signal"&&O.ee.emitEvent(T.type,[new d.SignalEvent(O,P,T.data,A)])}).catch(function(A){S.error(A)}):(this.ee.emitEvent("signal",[new d.SignalEvent(this,P,T.data,void 0)]),T.type&&T.type!=="signal"&&this.ee.emitEvent(T.type,[new d.SignalEvent(this,P,T.data,void 0)]))},D.prototype.onStreamPropertyChanged=function(T){var O=this,P=function(A){var I,_;if(A.stream&&A.stream.streamId===T.streamId){var F=A.stream,L=void 0;switch(T.property){case"audioActive":L=F.audioActive,T.newValue=T.newValue==="true",F.audioActive=T.newValue;break;case"videoActive":L=F.videoActive,T.newValue=T.newValue==="true",F.videoActive=T.newValue;var H=(_=(I=F==null?void 0:F.getMediaStream())===null||I===void 0?void 0:I.getVideoTracks())===null||_===void 0?void 0:_[0];H&&!H.enabled&&F.videoActive&&(H.enabled=!0);break;case"videoTrack":T.newValue=JSON.parse(T.newValue);break;case"audioTrack":T.newValue=JSON.parse(T.newValue);break;case"videoDimensions":L=F.videoDimensions,T.newValue=JSON.parse(JSON.parse(T.newValue)),F.videoDimensions=T.newValue;break;case"filter":L=F.filter,T.newValue=Object.keys(T.newValue).length>0?T.newValue:void 0,T.newValue!==void 0?(F.filter=new i.Filter(T.newValue.type,T.newValue.options),F.filter.stream=F,T.newValue.lastExecMethod&&(F.filter.lastExecMethod=T.newValue.lastExecMethod)):delete F.filter,T.newValue=F.filter;break}O.ee.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(O,F,T.property,T.newValue,L,T.reason)]),F.streamManager&&F.streamManager.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(F.streamManager,F,T.property,T.newValue,L,T.reason)])}else S.error("No stream with streamId '"+T.streamId+"' found for connection '"+T.connectionId+"' on 'streamPropertyChanged' event")};T.connectionId===this.connection.connectionId?P(this.connection):this.getRemoteConnection(T.connectionId,"onStreamPropertyChanged").then(function(A){P(A)}).catch(function(A){S.error(A)})},D.prototype.onConnectionPropertyChanged=function(T){var O;switch(T.property){case"role":O=this.connection.role.slice(),this.connection.role=T.newValue,this.connection.localOptions.role=T.newValue;break;case"record":O=this.connection.record,T.newValue=T.newValue==="true",this.connection.record=T.newValue,this.connection.localOptions.record=T.newValue;break}this.ee.emitEvent("connectionPropertyChanged",[new v.ConnectionPropertyChangedEvent(this,this.connection,T.property,T.newValue,O)])},D.prototype.onNetworkQualityLevelChangedChanged=function(T){var O=this;T.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new g.NetworkQualityLevelChangedEvent(this,T.newValue,T.oldValue,this.connection)]):this.getConnection(T.connectionId,"Connection not found for connectionId "+T.connectionId).then(function(P){O.ee.emitEvent("networkQualityLevelChanged",[new g.NetworkQualityLevelChangedEvent(O,T.newValue,T.oldValue,P)])}).catch(function(P){S.error(P)})},D.prototype.recvIceCandidate=function(T){var O={candidate:T.candidate,sdpMLineIndex:T.sdpMLineIndex,sdpMid:T.sdpMid},P=new RTCIceCandidate(O);this.getConnection(T.senderConnectionId,"Connection not found for connectionId "+T.senderConnectionId+" owning endpoint "+T.endpointName+". Ice candidate will be ignored: "+P).then(function(A){var I=A.stream;I.getWebRtcPeer().addIceCandidate(P).catch(function(_){S.error("Error adding candidate for "+I.streamId+" stream of endpoint "+T.endpointName+": "+_)})}).catch(function(A){S.error(A)})},D.prototype.onSessionClosed=function(T){S.info("Session closed: "+JSON.stringify(T));var O=T.sessionId;O!==void 0?this.ee.emitEvent("session-closed",[{session:O}]):S.warn("Session undefined on session closed",T)},D.prototype.onLostConnection=function(T){S.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,T)},D.prototype.onRecoveredConnection=function(){S.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},D.prototype.onMediaError=function(T){S.error("Media error: "+JSON.stringify(T));var O=T.error;O?this.ee.emitEvent("error-media",[{error:O}]):S.warn("Received undefined media error:",T)},D.prototype.onRecordingStarted=function(T){this.ee.emitEvent("recordingStarted",[new l.RecordingEvent(this,"recordingStarted",T.id,T.name)])},D.prototype.onRecordingStopped=function(T){this.ee.emitEvent("recordingStopped",[new l.RecordingEvent(this,"recordingStopped",T.id,T.name,T.reason)])},D.prototype.onBroadcastStarted=function(){this.ee.emitEvent("broadcastStarted",[])},D.prototype.onBroadcastStopped=function(){this.ee.emitEvent("broadcastStopped",[])},D.prototype.onFilterEventDispatched=function(T){var O=this,P=T.connectionId;this.getConnection(P,"No connection found for connectionId "+P).then(function(A){S.info('Filter event of type "'.concat(T.eventType,'" dispatched'));var I=A.stream;if(!I||!I.filter)return S.error('Filter event of type "'.concat(T.eventType,'" dispatched for stream ').concat(I.streamId," but there is no ").concat(I?"filter":"stream"," defined"));var _=I.filter.handlers.get(T.eventType);if(!_||typeof _!="function"){var F=Array.from(I.filter.handlers.keys());return S.error('Filter event of type "'.concat(T.eventType,'" not handled or not a function! Active filter events: ').concat(F.join(",")))}else _.call(O,new u.FilterEvent(I.filter,T.eventType,T.data))})},D.prototype.onForciblyReconnectSubscriber=function(T){var O=this;return new Promise(function(P,A){O.getRemoteConnection(T.connectionId,"onForciblyReconnectSubscriber").then(function(I){if(I.stream&&I.stream.streamId===T.streamId){var _=I.stream;if(_.setupReconnectionEventEmitter(P,A)){if(_.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent!=null)return _.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=T,A("Ongoing forced subscriber reconnection");_.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=T;var F=function(){var H=_.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent;delete _.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent,O.onForciblyReconnectSubscriber(H)};_.reconnectionEventEmitter.once("success",function(){F()}),_.reconnectionEventEmitter.once("error",function(){F()});return}_.completeWebRtcPeerReceive(!0,!0,T.sdpOffer).then(function(){return _.finalResolveForSubscription(!0,P)}).catch(function(H){return _.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream ".concat(T.streamId,": ").concat(H.toString()),A)})}else{var L="No stream with streamId '"+T.streamId+"' found for connection '"+T.connectionId+"' on 'streamPropertyChanged' event";return S.error(L),A(L)}}).catch(function(I){return S.error(I),A(I)})})},D.prototype.reconnectBrokenStreams=function(){S.info("Re-establishing media connections...");var T=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(S.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),T=!0),this.remoteConnections.forEach(function(O){O.stream&&O.stream.streamIceConnectionStateBroken()&&(S.warn("Re-establishing Subscriber "+O.stream.streamId),O.stream.initWebRtcPeerReceive(!0),T=!0)}),T||S.info("There were no media streams in need of a reconnection")},D.prototype.onSpeechToTextMessage=function(T){return n(this,void 0,void 0,function(){var O,P;return e(this,function(A){switch(A.label){case 0:return[4,this.getConnection(T.connectionId,"No connection found for connectionId "+T.connectionId)];case 1:return O=A.sent(),P=new f.SpeechToTextEvent(this,O,T.text,T.reason.toLowerCase(),T.raw,T.lang),this.ee.emitEvent("speechToTextMessage",[P]),[2]}})})},D.prototype.onSpeechToTextDisconnected=function(T){return n(this,void 0,void 0,function(){return e(this,function(O){return this.emitEvent("exception",[new E.ExceptionEvent(this,E.ExceptionEventName.SPEECH_TO_TEXT_DISCONNECTED,this,T.message)]),[2]})})},D.prototype.emitEvent=function(T,O){this.ee.emitEvent(T,O)},D.prototype.leave=function(T,O){var P=this;if(T=!!T,S.info("Leaving Session (forced="+T+")"),this.stopVideoDataIntervals(),this.connection){if(!this.connection.disposed&&!T?this.openvidu.sendRequest("leaveRoom",function(I,_){I&&S.error("leaveRoom error: ".concat(JSON.stringify(I))),P.openvidu.closeWs()}):this.openvidu.closeWs(),this.stopPublisherStream(O),!this.connection.disposed){var A=new c.SessionDisconnectedEvent(this,O);this.ee.emitEvent("sessionDisconnected",[A]),A.callDefaultBehavior()}}else S.warn("You were not connected to the session "+this.sessionId);S.flush()},D.prototype.initializeParams=function(T){var O={token:T||"",session:this.sessionId,platform:k.getDescription()?k.getDescription():"unknown",sdkVersion:this.openvidu.libraryVersion,metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder(),stt:this.openvidu.getStt()};return O},D.prototype.sendVideoData=function(T,O,P,A){var I=this,_,F;if(O===void 0&&(O=1),P===void 0&&(P=!1),A===void 0&&(A=1),k.isChromeBrowser()||k.isChromeMobileBrowser()||k.isOperaBrowser()||k.isOperaMobileBrowser()||k.isEdgeBrowser()||k.isEdgeMobileBrowser()||k.isElectron()||k.isSafariBrowser()&&!k.isIonicIos()||k.isAndroidBrowser()||k.isSamsungBrowser()||k.isIonicAndroid()||k.isIOSWithSafari()){var L=function(){return n(I,void 0,void 0,function(){var B,q,G;return e(this,function(re){switch(re.label){case 0:return B=T.stream.getRTCPeerConnection(),B.connectionState!=="connected"?[3,2]:[4,B.getStats()];case 1:q=re.sent(),G=[],q.forEach(function(j){"frameWidth"in j&&"frameHeight"in j&&G.length===0&&G.push(j)}),G.length>0&&this.openvidu.sendRequest("videoData",{height:G[0].frameHeight,width:G[0].frameWidth,videoActive:T.stream.videoActive!=null?T.stream.videoActive:!1,audioActive:T.stream.audioActive!=null?T.stream.audioActive:!1},function(j,ae){j&&S.error("Error sending 'videoData' event",j)}),re.label=2;case 2:return[2]}})})};if(P){var H=1;this.videoDataInterval=setInterval(function(){H<A?(H++,L()):clearInterval(I.videoDataInterval)},O*1e3)}else this.videoDataTimeout=setTimeout(L,O*1e3)}else k.isFirefoxBrowser()||k.isFirefoxMobileBrowser()||k.isIonicIos()||k.isReactNative()?this.openvidu.sendRequest("videoData",{height:((_=T.stream.videoDimensions)===null||_===void 0?void 0:_.height)||0,width:((F=T.stream.videoDimensions)===null||F===void 0?void 0:F.width)||0,videoActive:T.stream.videoActive!=null?T.stream.videoActive:!1,audioActive:T.stream.audioActive!=null?T.stream.audioActive:!1},function(B,q){B&&S.error("Error sending 'videoData' event",B)}):S.error("Browser "+k.getName()+" (version "+k.getVersion()+") for "+k.getFamily()+" is not supported in OpenVidu for Network Quality")},D.prototype.sessionConnected=function(){return this.connection!=null},D.prototype.notConnectedError=function(){return new m.OpenViduError(m.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},D.prototype.anySpeechEventListenerEnabled=function(T,O,P){var A=this.ee.getListeners(T);O&&(A=A.filter(function(L){return L.once}));var I=A.length;if(I>0)return!0;var _=0;if(P){var F=P.ee.getListeners(T);O&&(F=F.filter(function(L){return L.once})),_=F.length}return _>0},D.prototype.getTokenParams=function(T){var O=T.match(/^(wss?)\:\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(O){var P={protocol:O[1],host:O[2],hostname:O[3],port:O[4],pathname:O[5],search:O[6],hash:O[7]},A=T.split("?"),I=decodeURI(A[1]).split("&").map(function(_){return _.split("=")}).reduce(function(_,F){var L=F[0],H=F[1];return _[L]=H,_},{});return{sessionId:I.sessionId,secret:I.secret,recorder:I.recorder,stt:I.stt,webrtcStatsInterval:I.webrtcStatsInterval,sendBrowserLogs:I.sendBrowserLogs,edition:I.edition,wsUri:P.protocol+"://"+P.host+"/openvidu",httpUri:"https://"+P.host}}else throw new Error('Token not valid: "'.concat(T,'"'))},D.prototype.connectAux=function(T){var O=this;return new Promise(function(P,A){O.openvidu.startWs(function(I){if(I)return A(I);var _=O.initializeParams(T);O.openvidu.sendRequest("joinRoom",_,function(F,L){if(F)return A(F);O.processJoinRoomResponse(L,T),O.connection=new r.Connection(O,L);var H={connections:new Array,streams:new Array},B=L.value;return B.forEach(function(q){var G=new r.Connection(O,q);O.remoteConnections.set(G.connectionId,G),H.connections.push(G),G.stream&&(O.remoteStreamsCreated.set(G.stream.streamId,!0),H.streams.push(G.stream))}),O.ee.emitEvent("connectionCreated",[new s.ConnectionEvent(!1,O,"connectionCreated",O.connection,"")]),H.connections.forEach(function(q){O.ee.emitEvent("connectionCreated",[new s.ConnectionEvent(!1,O,"connectionCreated",q,"")])}),H.streams.forEach(function(q){O.ee.emitEvent("streamCreated",[new p.StreamEvent(!1,O,"streamCreated",q,"")])}),L.recordingId&&L.recordingName&&O.ee.emitEvent("recordingStarted",[new l.RecordingEvent(O,"recordingStarted",L.recordingId,L.recordingName)]),P()})})})},D.prototype.stopPublisherStream=function(T){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[T]))},D.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},D.prototype.stringClientMetadata=function(T){return typeof T!="string"?JSON.stringify(T):T},D.prototype.getConnection=function(T,O){var P=this;return new Promise(function(A,I){var _=P.remoteConnections.get(T);return _?A(_):P.connection.connectionId===T?A(P.connection):I(new m.OpenViduError(m.OpenViduErrorName.GENERIC_ERROR,O))})},D.prototype.getRemoteConnection=function(T,O){var P=this;return new Promise(function(A,I){var _=P.remoteConnections.get(T);if(_)return A(_);var F="Remote connection "+T+" unknown when '"+O+"'. Existing remote connections: "+JSON.stringify(P.remoteConnections.keys());return I(new m.OpenViduError(m.OpenViduErrorName.GENERIC_ERROR,F))})},D.prototype.processToken=function(T){var O=this.getTokenParams(T);this.sessionId=O.sessionId,O.secret&&(this.openvidu.secret=O.secret),O.recorder&&(this.openvidu.recorder=!0),O.stt&&(this.openvidu.stt=!0),O.webrtcStatsInterval&&(this.openvidu.webrtcStatsInterval=O.webrtcStatsInterval),O.sendBrowserLogs&&(this.openvidu.sendBrowserLogs=O.sendBrowserLogs),this.openvidu.isAtLeastPro=O.edition==="pro"||O.edition==="enterprise",this.openvidu.isEnterprise=O.edition==="enterprise",this.openvidu.wsUri=O.wsUri,this.openvidu.httpUri=O.httpUri},D.prototype.processJoinRoomResponse=function(T,O){if(this.sessionId=T.session,T.customIceServers!=null&&T.customIceServers.length>0){this.openvidu.iceServers=[];for(var P=0,A=T.customIceServers;P<A.length;P++){var I=A[P],_={urls:[I.url]};S.log("STUN/TURN server IP: "+I.url),I.username!=null&&I.credential!=null&&(_.username=I.username,_.credential=I.credential,S.log("TURN credentials ["+I.username+":"+I.credential+"]")),this.openvidu.iceServers.push(_)}}this.openvidu.role=T.role,this.openvidu.finalUserId=T.finalUserId,this.openvidu.mediaServer=T.mediaServer,this.openvidu.videoSimulcast=T.videoSimulcast,this.capabilities={subscribe:!0,publish:this.openvidu.role!=="SUBSCRIBER",forceUnpublish:this.openvidu.role==="MODERATOR",forceDisconnect:this.openvidu.role==="MODERATOR"},S.info("openvidu-server version: "+T.version),T.life!=null&&(this.openvidu.life=T.life);var F=C(T.version)-C(this.openvidu.libraryVersion);x(T.version)!==x(this.openvidu.libraryVersion)||!(F==0||F==1)?S.error("openvidu-browser (".concat(this.openvidu.libraryVersion,") and openvidu-server (").concat(T.version,") versions are incompatible. ")+"Errors are likely to occur. openvidu-browser SDK is only compatible with the same version or the immediately following minor version of an OpenVidu deployment"):F==1&&S.warn("openvidu-browser version ".concat(this.openvidu.libraryVersion," does not match openvidu-server version ").concat(T.version,". ")+"These versions are still compatible with each other, but openvidu-browser version must be updated as soon as possible to ".concat(x(T.version),".").concat(C(T.version),".x. ")+"This client using openvidu-browser ".concat(this.openvidu.libraryVersion," will become incompatible with the next release of openvidu-server")),b.OpenViduLogger.configureJSNLog(this.openvidu,O),this.token=O},D}(a.EventDispatcher);return Rd.Session=N,Rd}var a_;function vR(){if(a_)return Cd;a_=1;var t=ve&&ve.__extends||function(){var v=function(g,m){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,b){y.__proto__=b}||function(y,b){for(var w in b)Object.prototype.hasOwnProperty.call(b,w)&&(y[w]=b[w])},v(g,m)};return function(g,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");v(g,m);function y(){this.constructor=g}g.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}(),n=ve&&ve.__awaiter||function(v,g,m,y){function b(w){return w instanceof m?w:new m(function(x){x(w)})}return new(m||(m=Promise))(function(w,x){function C(k){try{S(y.next(k))}catch(N){x(N)}}function E(k){try{S(y.throw(k))}catch(N){x(N)}}function S(k){k.done?w(k.value):b(k.value).then(C,E)}S((y=y.apply(v,g||[])).next())})},e=ve&&ve.__generator||function(v,g){var m={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},y,b,w,x;return x={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function C(S){return function(k){return E([S,k])}}function E(S){if(y)throw new TypeError("Generator is already executing.");for(;x&&(x=0,S[0]&&(m=0)),m;)try{if(y=1,b&&(w=S[0]&2?b.return:S[0]?b.throw||((w=b.return)&&w.call(b),0):b.next)&&!(w=w.call(b,S[1])).done)return w;switch(b=0,w&&(S=[S[0]&2,w.value]),S[0]){case 0:case 1:w=S;break;case 4:return m.label++,{value:S[1],done:!1};case 5:m.label++,b=S[1],S=[0];continue;case 7:S=m.ops.pop(),m.trys.pop();continue;default:if(w=m.trys,!(w=w.length>0&&w[w.length-1])&&(S[0]===6||S[0]===2)){m=0;continue}if(S[0]===3&&(!w||S[1]>w[0]&&S[1]<w[3])){m.label=S[1];break}if(S[0]===6&&m.label<w[1]){m.label=w[1],w=S;break}if(w&&m.label<w[2]){m.label=w[2],m.ops.push(S);break}w[2]&&m.ops.pop(),m.trys.pop();continue}S=g.call(v,m)}catch(k){S=[6,k],b=0}finally{y=w=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.Publisher=void 0;var r=u0(),i=Bc,o=$c,a=mR(),s=ma,u=Fu,l=An,c=Yi,d=s0,f=l.OpenViduLogger.getInstance(),p,h=function(v){t(g,v);function g(m,y,b){var w=v.call(this,new i.Stream(b.session?b.session:new r.Session(b),{publisherProperties:y,mediaConstraints:{}}),m)||this;return w.accessAllowed=!1,w.isSubscribedToRemote=!1,w.accessDenied=!1,p=c.PlatformUtils.getInstance(),w.properties=y,w.openvidu=b,w.stream.ee.on("local-stream-destroyed",function(x){w.stream.isLocalStreamPublished=!1;var C=new a.StreamEvent(!0,w,"streamDestroyed",w.stream,x);w.emitEvent("streamDestroyed",[C]),C.callDefaultBehavior()}),w}return g.prototype.publishAudio=function(m){var y=this;if(this.stream.audioActive!==m){var b=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();b.getAudioTracks().forEach(function(w){w.enabled=m}),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:m,reason:"publishAudio"},function(w,x){w?f.error("Error sending 'streamPropertyChanged' event",w):(y.session.emitEvent("streamPropertyChanged",[new s.StreamPropertyChangedEvent(y.session,y.stream,"audioActive",m,!m,"publishAudio")]),y.emitEvent("streamPropertyChanged",[new s.StreamPropertyChangedEvent(y,y.stream,"audioActive",m,!m,"publishAudio")]),y.session.sendVideoData(y.stream.streamManager))}),this.stream.audioActive=m,f.info("'Publisher' has "+(m?"published":"unpublished")+" its audio stream")}},g.prototype.publishVideo=function(m,y){var b=this;return new Promise(function(w,x){return n(b,void 0,void 0,function(){var C,E,S,k,N,M,D=this;return e(this,function(T){switch(T.label){case 0:return this.stream.videoActive===m?[3,9]:(C=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),E=!1,C.getVideoTracks().forEach(function(O){O.enabled=m,!m&&y===!0?O.stop():m&&O.readyState==="ended"&&(E=!0)}),!m&&y===!0&&this.stream.filter&&this.stream.filter.type.startsWith("VB:")?(this.stream.lastVBFilter=this.stream.filter,[4,this.stream.removeFilterAux(!0)]):[3,2]);case 1:T.sent(),T.label=2;case 2:return E?(S=C.getVideoTracks()[0],C.removeTrack(S),k=function(O){return n(D,void 0,void 0,function(){var P=this;return e(this,function(A){switch(A.label){case 0:return C.addTrack(O),this.stream.isLocalStreamPublished?[4,this.replaceTrackInRtcRtpSender(O)]:[3,2];case 1:A.sent(),A.label=2;case 2:return this.stream.lastVBFilter&&setTimeout(function(){return n(P,void 0,void 0,function(){var I,_;return e(this,function(F){switch(F.label){case 0:return I=this.stream.lastVBFilter.options,_=this.stream.lastVBFilter.lastExecMethod,_&&_.method==="update"&&(I=Object.assign({},I,_.params)),[4,this.stream.applyFilter(this.stream.lastVBFilter.type,I)];case 1:return F.sent(),delete this.stream.lastVBFilter,[2]}})})},1),[2]}})})},y&&y instanceof MediaStreamTrack?[4,k(y)]:[3,4]):[3,8];case 3:return T.sent(),[3,8];case 4:return T.trys.push([4,7,,8]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:this.stream.lastVideoTrackConstraints})];case 5:return N=T.sent(),[4,k(N.getVideoTracks()[0])];case 6:return T.sent(),[3,8];case 7:return M=T.sent(),[2,x(M)];case 8:return this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:m,reason:"publishVideo"},function(O,P){O?f.error("Error sending 'streamPropertyChanged' event",O):(D.session.emitEvent("streamPropertyChanged",[new s.StreamPropertyChangedEvent(D.session,D.stream,"videoActive",m,!m,"publishVideo")]),D.emitEvent("streamPropertyChanged",[new s.StreamPropertyChangedEvent(D,D.stream,"videoActive",m,!m,"publishVideo")]),D.session.sendVideoData(D.stream.streamManager))}),this.stream.videoActive=m,f.info("'Publisher' has "+(m?"published":"unpublished")+" its video stream"),[2,w()];case 9:return[2]}})})})},g.prototype.subscribeToRemote=function(m){m=m!==void 0?m:!0,this.isSubscribedToRemote=m,this.stream.subscribeToMyRemote(m)},g.prototype.on=function(m,y){var b=this;return v.prototype.on.call(this,m,y),m==="streamCreated"&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new a.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",function(){b.emitEvent("streamCreated",[new a.StreamEvent(!1,b,"streamCreated",b.stream,"")])})),m==="accessAllowed"&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),m==="accessDenied"&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},g.prototype.once=function(m,y){var b=this;return v.prototype.once.call(this,m,y),m==="streamCreated"&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new a.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",function(){b.emitEvent("streamCreated",[new a.StreamEvent(!1,b,"streamCreated",b.stream,"")])})),m==="accessAllowed"&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),m==="accessDenied"&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},g.prototype.off=function(m,y){return v.prototype.off.call(this,m,y),this},g.prototype.replaceTrack=function(m){return n(this,void 0,void 0,function(){return e(this,function(y){return[2,this.replaceTrackAux(m,!0)]})})},g.prototype.initialize=function(){var m=this;return new Promise(function(y,b){return n(m,void 0,void 0,function(){var w,x,C,E,S,k,N,M,D,T,O,P,P,A,I,_=this,F,L;return e(this,function(H){switch(H.label){case 0:w={},x={},C=2e3,S=function(B){return _.accessDenied=!0,_.accessAllowed=!1,f.error("Publisher initialization failed. ".concat(B.name,": ").concat(B.message)),b(B)},k=function(B){var q,G;if(_.accessAllowed=!0,_.accessDenied=!1,typeof MediaStreamTrack<"u"&&_.properties.audioSource instanceof MediaStreamTrack&&(B.removeTrack(B.getAudioTracks()[0]),B.addTrack(_.properties.audioSource)),typeof MediaStreamTrack<"u"&&_.properties.videoSource instanceof MediaStreamTrack&&(B.removeTrack(B.getVideoTracks()[0]),B.addTrack(_.properties.videoSource)),B.getAudioTracks()[0]){var re=_.stream.audioActive!==void 0&&_.stream.audioActive!==null?_.stream.audioActive:!!_.stream.outboundStreamOpts.publisherProperties.publishAudio;B.getAudioTracks()[0].enabled=re}if(B.getVideoTracks()[0]){var re=_.stream.videoActive!==void 0&&_.stream.videoActive!==null?_.stream.videoActive:!!_.stream.outboundStreamOpts.publisherProperties.publishVideo;B.getVideoTracks()[0].enabled=re}for(var j=0,ae=B.getAudioTracks();j<ae.length;j++){var ne=ae[j];!((q=ne.contentHint)===null||q===void 0)&&q.length||(ne.contentHint="",f.info("Audio track Content Hint set: '".concat(ne.contentHint,"'")))}for(var le=0,xe=B.getVideoTracks();le<xe.length;le++){var ne=xe[le];if(!(!((G=ne.contentHint)===null||G===void 0)&&G.length)){switch(_.stream.typeOfVideo){case d.TypeOfVideo.SCREEN:ne.contentHint="detail";break;case d.TypeOfVideo.CUSTOM:f.warn("CUSTOM type video track was provided without Content Hint!"),ne.contentHint="motion";break;case d.TypeOfVideo.CAMERA:case d.TypeOfVideo.IPCAM:default:ne.contentHint="motion";break}f.info("Video track Content Hint set: '".concat(ne.contentHint,"'"))}}return _.initializeVideoReference(B),_.stream.displayMyRemote()||_.stream.updateMediaStreamInVideos(),delete _.firstVideoElement,_.stream.isSendVideo()?_.getVideoDimensions().then(function(se){_.stream.videoDimensions={width:se.width,height:se.height},_.stream.isSendScreen()&&(_.stream.isSendAudio()&&B.getAudioTracks().length===0&&(_.stream.audioActive=!1,_.stream.hasAudio=!1,_.stream.outboundStreamOpts.publisherProperties.publishAudio=!1,_.stream.outboundStreamOpts.publisherProperties.audioSource=!1),_.screenShareResizeInterval=setInterval(function(){var we=B.getVideoTracks()[0].getSettings(),de=we.width,Z=we.height,ge=de!=null&&de!==_.stream.videoDimensions.width,be=Z!=null&&Z!==_.stream.videoDimensions.height;_.stream.isLocalStreamPublished&&(ge||be)&&_.openvidu.sendVideoDimensionsChangedEvent(_,"screenResized",_.stream.videoDimensions.width,_.stream.videoDimensions.height,de||0,Z||0)},650)),_.stream.isLocalStreamReadyToPublish=!0,_.stream.ee.emitEvent("stream-ready-to-publish",[])}):(_.stream.isLocalStreamReadyToPublish=!0,_.stream.ee.emitEvent("stream-ready-to-publish",[])),y()},N=function(B,q){return n(_,void 0,void 0,function(){var G,re;return e(this,function(j){switch(j.label){case 0:if(this.clearPermissionDialogTimer(E,C),!(this.stream.isSendScreen()&&this.properties.audioSource!=="screen"&&this.stream.isSendAudio()))return[3,5];x.audio=q,x.video=!1,E=Date.now(),this.setPermissionDialogTimer(C),j.label=1;case 1:return j.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(x)];case 2:return G=j.sent(),this.clearPermissionDialogTimer(E,C),B.addTrack(G.getAudioTracks()[0]),k(B),[3,4];case 3:return re=j.sent(),this.clearPermissionDialogTimer(E,C),B.getAudioTracks().forEach(function(ae){ae.stop()}),B.getVideoTracks().forEach(function(ae){ae.stop()}),S(this.openvidu.generateAudioDeviceError(re,w)),[2];case 4:return[3,6];case 5:k(B),j.label=6;case 6:return[2]}})})},M=function(B){return n(_,void 0,void 0,function(){var q,G,re,ae,j,ae,ne;return e(this,function(le){switch(le.label){case 0:switch(f.error("getMediaError: ".concat(B.toString())),this.clearPermissionDialogTimer(E,C),B.name==="Error"&&(B.name=B.constructor.name),re=B.name.toLowerCase(),re){case"notfounderror":return[3,1];case"notallowederror":return[3,5];case"overconstrainederror":return[3,6];case"aborterror":return[3,10];case"notreadableerror":return[3,10]}return[3,11];case 1:return le.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:w.video})];case 2:return ae=le.sent(),ae.getVideoTracks().forEach(function(xe){xe.stop()}),q=u.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,G=B.toString(),S(new u.OpenViduError(q,G)),[3,4];case 3:return j=le.sent(),q=u.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,G=j.toString(),S(new u.OpenViduError(q,G)),[3,4];case 4:return[3,12];case 5:return q=this.stream.isSendScreen()?u.OpenViduErrorName.SCREEN_CAPTURE_DENIED:u.OpenViduErrorName.DEVICE_ACCESS_DENIED,G=B.toString(),S(new u.OpenViduError(q,G)),[3,12];case 6:return le.trys.push([6,8,,9]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:w.video})];case 7:return ae=le.sent(),ae.getVideoTracks().forEach(function(xe){xe.stop()}),B.constraint.toLowerCase()==="deviceid"?(q=u.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,G="Audio input device with deviceId '"+w.audio.deviceId.exact+"' not found"):(q=u.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,G="Audio input device doesn't support the value passed for constraint '"+B.constraint+"'"),S(new u.OpenViduError(q,G)),[3,9];case 8:return ne=le.sent(),ne.constraint.toLowerCase()==="deviceid"?(q=u.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,G="Video input device with deviceId '"+w.video.deviceId.exact+"' not found"):(q=u.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,G="Video input device doesn't support the value passed for constraint '"+ne.constraint+"'"),S(new u.OpenViduError(q,G)),[3,9];case 9:return[3,12];case 10:return q=u.OpenViduErrorName.DEVICE_ALREADY_IN_USE,G=B.toString(),S(new u.OpenViduError(q,G)),[3,12];case 11:return q=u.OpenViduErrorName.GENERIC_ERROR,G=B.toString(),S(new u.OpenViduError(q,G)),[3,12];case 12:return[2]}})})},H.label=1;case 1:return H.trys.push([1,14,,15]),[4,this.openvidu.generateMediaConstraints(this.properties)];case 2:return D=H.sent(),D.videoTrack&&D.audioTrack||D.audioTrack&&((F=D.constraints)===null||F===void 0?void 0:F.video)===!1||D.videoTrack&&((L=D.constraints)===null||L===void 0?void 0:L.audio)===!1?(k(this.openvidu.addAlreadyProvidedTracks(D,new MediaStream,this.stream)),[3,13]):[3,3];case 3:w=D.constraints,T={mediaConstraints:w,publisherProperties:this.properties},this.stream.setOutboundStreamOptions(T),O=w.audio===void 0?!0:w.audio,x.audio=this.stream.isSendScreen()?!1:O,x.video=w.video,E=Date.now(),this.setPermissionDialogTimer(C),H.label=4;case 4:return H.trys.push([4,11,,13]),this.stream.isSendScreen()&&navigator.mediaDevices.getDisplayMedia&&!p.isElectron()?[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:this.properties.audioSource==="screen"})]:[3,7];case 5:return P=H.sent(),this.openvidu.addAlreadyProvidedTracks(D,P),[4,N(P,O)];case 6:return H.sent(),[3,10];case 7:return this.stream.lastVideoTrackConstraints=x.video,[4,navigator.mediaDevices.getUserMedia(x)];case 8:return P=H.sent(),this.openvidu.addAlreadyProvidedTracks(D,P,this.stream),[4,N(P,O)];case 9:H.sent(),H.label=10;case 10:return[3,13];case 11:return A=H.sent(),[4,M(A)];case 12:return H.sent(),[3,13];case 13:return[3,15];case 14:return I=H.sent(),S(I),[3,15];case 15:return[2]}})})})},g.prototype.replaceTrackAux=function(m,y){return n(this,void 0,void 0,function(){var b,w;return e(this,function(x){switch(x.label){case 0:b=m.enabled,m.kind==="video"?m.enabled=this.stream.videoActive:m.kind==="audio"&&(m.enabled=this.stream.audioActive),x.label=1;case 1:return x.trys.push([1,5,,6]),this.stream.isLocalStreamPublished?(this.replaceTrackInMediaStream(m,y),[4,this.replaceTrackInRtcRtpSender(m)]):[3,3];case 2:return[2,x.sent()];case 3:return[2,this.replaceTrackInMediaStream(m,y)];case 4:return[3,6];case 5:throw w=x.sent(),m.enabled=b,w;case 6:return[2]}})})},g.prototype.getVideoDimensions=function(){var m=this;return new Promise(function(y,b){var w=(p.isIonicIos()||p.isIOSWithSafari())&&m.videoReference.readyState<1,x,C=function(){var E,S;if(typeof m.stream.getMediaStream().getVideoTracks()[0].getSettings=="function"){var k=m.stream.getMediaStream().getVideoTracks()[0].getSettings();E=k.width||m.videoReference.videoWidth,S=k.height||m.videoReference.videoHeight}else f.warn("MediaStreamTrack does not have getSettings method on "+p.getDescription()),E=m.videoReference.videoWidth,S=m.videoReference.videoHeight;return x!=null&&m.videoReference.removeEventListener("loadedmetadata",x),w&&document.body.removeChild(m.videoReference),y({width:E,height:S})};m.videoReference.readyState>=1?C():(x=function(){if(m.videoReference.videoWidth)C();else var E=setInterval(function(){m.videoReference.videoWidth&&(clearInterval(E),C())},40)},m.videoReference.addEventListener("loadedmetadata",x),w&&document.body.appendChild(m.videoReference))})},g.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},g.prototype.initializeVideoReference=function(m){this.videoReference=document.createElement("video"),this.videoReference.style.display="none",this.videoReference.muted=!0,this.videoReference.autoplay=!0,this.videoReference.controls=!1,(p.isSafariBrowser()||p.isIPhoneOrIPad()&&(p.isChromeMobileBrowser()||p.isEdgeMobileBrowser()||p.isOperaMobileBrowser()||p.isFirefoxMobileBrowser()))&&(this.videoReference.playsInline=!0),this.stream.setMediaStream(m),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=this.stream.getMediaStream()},g.prototype.replaceTrackInMediaStream=function(m,y){var b=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),w;m.kind==="video"?(w=b.getVideoTracks()[0],y&&(this.stream.lastVideoTrackConstraints=m.getConstraints())):w=b.getAudioTracks()[0],w.enabled=!1,w.stop(),b.removeTrack(w),b.addTrack(m);var x={oldLabel:(w==null?void 0:w.label)||"",newLabel:(m==null?void 0:m.label)||""};m.kind==="video"&&y?(this.openvidu.sendNewVideoDimensionsIfRequired(this,"trackReplaced",50,30),this.openvidu.sendTrackChangedEvent(this,x.oldLabel,x.newLabel,"videoTrack"),this.stream.isLocalStreamPublished&&this.session.sendVideoData(this.stream.streamManager,5,!0,5)):m.kind==="audio"&&y&&this.openvidu.sendTrackChangedEvent(this,x.oldLabel,x.newLabel,"audioTrack"),m.kind==="audio"&&(this.stream.disableHarkSpeakingEvent(!1),this.stream.disableHarkStoppedSpeakingEvent(!1),this.stream.disableHarkVolumeChangeEvent(!1),this.stream.initHarkEvents())},g.prototype.setPermissionDialogTimer=function(m){var y=this;this.permissionDialogTimeout=setTimeout(function(){y.emitEvent("accessDialogOpened",[])},m)},g.prototype.clearPermissionDialogTimer=function(m,y){clearTimeout(this.permissionDialogTimeout),Date.now()-m>y&&this.emitEvent("accessDialogClosed",[])},g.prototype.replaceTrackInRtcRtpSender=function(m){return n(this,void 0,void 0,function(){var y,b;return e(this,function(w){switch(w.label){case 0:if(y=this.stream.getRTCPeerConnection().getSenders(),m.kind==="video"){if(b=y.find(function(x){return!!x.track&&x.track.kind==="video"}),!b)throw new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else if(m.kind==="audio"){if(b=y.find(function(x){return!!x.track&&x.track.kind==="audio"}),!b)throw new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else throw new Error("Unknown track kind "+m.kind);return[4,b.replaceTrack(m)];case 1:return w.sent(),[2]}})})},g}(o.StreamManager);return Cd.Publisher=h,Cd}var aj={};globalThis.getScreenId=function(t,n,e){if(navigator.userAgent.indexOf("Edge")!==-1&&(navigator.msSaveOrOpenBlob||navigator.msSaveBlob)){n({video:!0});return}if(navigator.mozGetUserMedia){n(null,"firefox",{video:{mozMediaSource:t,mediaSource:t}});return}globalThis.addEventListener("message",r);function r(i){i.data&&(i.data.chromeMediaSourceId&&(i.data.chromeMediaSourceId==="PermissionDeniedError"?n("permission-denied"):n(null,i.data.chromeMediaSourceId,s_(null,i.data.chromeMediaSourceId,i.data.canRequestAudioTrack)),globalThis.removeEventListener("message",r)),i.data.chromeExtensionStatus&&(n(i.data.chromeExtensionStatus,null,s_(i.data.chromeExtensionStatus)),globalThis.removeEventListener("message",r)))}setTimeout(e?function(){Bv(e)}:Bv,100)};function s_(t,n,e){var r={audio:!1,video:{mandatory:{chromeMediaSource:t?"screen":"desktop",maxWidth:globalThis.screen.width>1920?globalThis.screen.width:1920,maxHeight:globalThis.screen.height>1080?globalThis.screen.height:1080},optional:[]}};return e&&(r.audio={mandatory:{chromeMediaSource:t?"screen":"desktop"},optional:[]}),n&&(r.video.mandatory.chromeMediaSourceId=n,r.audio&&r.audio.mandatory&&(r.audio.mandatory.chromeMediaSourceId=n)),r}function Bv(t){if(!hr){gR(function(){Bv(t)});return}if(!hr.isLoaded){setTimeout(function(){Bv(t)},100);return}t?t.forEach?hr.contentWindow.postMessage({captureCustomSourceId:t},"*"):hr.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):hr.contentWindow.postMessage({captureSourceId:!0},"*")}var hr;globalThis.getScreenConstraints=function(t){gR(function(){getScreenId(function(n,e,r){r||(r={video:!0}),t(n,r.video)})})};function gR(t){if(hr){t();return}hr=document.createElement("iframe"),hr.onload=function(){hr.isLoaded=!0,t()},hr.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",hr.style.display="none",(document.body||document.documentElement).appendChild(hr)}globalThis.getChromeExtensionStatus=function(t){if(navigator.mozGetUserMedia){t("installed-enabled");return}globalThis.addEventListener("message",n);function n(e){e.data&&e.data.chromeExtensionStatus&&(t(e.data.chromeExtensionStatus),globalThis.removeEventListener("message",n))}setTimeout(Cx,100)};function Cx(){if(!hr){gR(Cx);return}if(!hr.isLoaded){setTimeout(Cx,100);return}hr.contentWindow.postMessage({getChromeExtensionStatus:!0},"*")}aj.getScreenId=globalThis.getScreenId;var Gc={},ns="screen",rs,Sl;if(typeof window<"u"&&typeof navigator<"u"&&typeof navigator.userAgent<"u"){var sj=typeof window.InstallTrigger<"u";window.opera||navigator.userAgent.indexOf(" OPR/")>=0,window.addEventListener("message",function(t){t.origin==window.location.origin&&_he(t.data)})}function _he(t){if(t=="PermissionDeniedError"){if(Sl)return Sl("PermissionDeniedError");throw new Error("PermissionDeniedError")}t=="rtcmulticonnection-extension-loaded"&&(ns="desktop"),t.sourceId&&Sl&&Sl(rs=t.sourceId,t.canRequestAudioTrack===!0)}function Ahe(t){if(t){if(ns=="desktop")return t(!0);window.postMessage("are-you-there","*"),setTimeout(function(){ns=="screen"?t(!1):t(!0)},2e3)}}function uj(t){if(!t)throw'"callback" parameter is mandatory.';if(rs)return t(rs);Sl=t,window.postMessage("get-sourceId","*")}function Ohe(t){if(!t)throw'"callback" parameter is mandatory.';if(rs)return t(rs);Sl=t,window.postMessage("audio-plus-tab","*")}function Dhe(t,n){if(sj)return n("not-chrome");arguments.length!=2&&(n=t,t="lfcgfepafnobdloecchnfaclibenjold");var e=document.createElement("img");e.src="chrome-extension://"+t+"/icon.png",e.onload=function(){ns="screen",window.postMessage("are-you-there","*"),setTimeout(function(){ns=="screen"?n("installed-disabled"):n("installed-enabled")},2e3)},e.onerror=function(){n("not-installed")}}function Mhe(t){lj(t,!0)}function lj(t,n){rs="";var e={mozMediaSource:"window",mediaSource:"window"};if(sj)return t(null,e);var r={mandatory:{chromeMediaSource:ns,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};if(ns=="desktop"&&!rs){n?Ohe(function(i,o){r.mandatory.chromeMediaSourceId=i,o&&(r.canRequestAudioTrack=!0),t(i=="PermissionDeniedError"?i:null,r)}):uj(function(i){r.mandatory.chromeMediaSourceId=i,t(i=="PermissionDeniedError"?i:null,r)});return}ns=="desktop"&&(r.mandatory.chromeMediaSourceId=rs),t(null,r)}Gc.getScreenConstraints=lj;Gc.getScreenConstraintsWithAudio=Mhe;Gc.isChromeExtensionAvailable=Ahe;Gc.getChromeExtensionStatus=Dhe;Gc.getSourceId=uj;var yR={exports:{}},Bl=typeof Reflect=="object"?Reflect:null,u_=Bl&&typeof Bl.apply=="function"?Bl.apply:function(n,e,r){return Function.prototype.apply.call(n,e,r)},Cm;Bl&&typeof Bl.ownKeys=="function"?Cm=Bl.ownKeys:Object.getOwnPropertySymbols?Cm=function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Cm=function(n){return Object.getOwnPropertyNames(n)};function Phe(t){console&&console.warn&&console.warn(t)}var cj=Number.isNaN||function(n){return n!==n};function Mt(){Mt.init.call(this)}yR.exports=Mt;yR.exports.once=Bhe;Mt.EventEmitter=Mt;Mt.prototype._events=void 0;Mt.prototype._eventsCount=0;Mt.prototype._maxListeners=void 0;var l_=10;function l0(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Mt,"defaultMaxListeners",{enumerable:!0,get:function(){return l_},set:function(t){if(typeof t!="number"||t<0||cj(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l_=t}});Mt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Mt.prototype.setMaxListeners=function(n){if(typeof n!="number"||n<0||cj(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this};function dj(t){return t._maxListeners===void 0?Mt.defaultMaxListeners:t._maxListeners}Mt.prototype.getMaxListeners=function(){return dj(this)};Mt.prototype.emit=function(n){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=n==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[n];if(u===void 0)return!1;if(typeof u=="function")u_(u,this,e);else for(var l=u.length,c=vj(u,l),r=0;r<l;++r)u_(c[r],this,e);return!0};function fj(t,n,e,r){var i,o,a;if(l0(e),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",n,e.listener?e.listener:e),o=t._events),a=o[n]),a===void 0)a=o[n]=e,++t._eventsCount;else if(typeof a=="function"?a=o[n]=r?[e,a]:[a,e]:r?a.unshift(e):a.push(e),i=dj(t),i>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(n)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=n,s.count=a.length,Phe(s)}return t}Mt.prototype.addListener=function(n,e){return fj(this,n,e,!1)};Mt.prototype.on=Mt.prototype.addListener;Mt.prototype.prependListener=function(n,e){return fj(this,n,e,!0)};function Lhe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function pj(t,n,e){var r={fired:!1,wrapFn:void 0,target:t,type:n,listener:e},i=Lhe.bind(r);return i.listener=e,r.wrapFn=i,i}Mt.prototype.once=function(n,e){return l0(e),this.on(n,pj(this,n,e)),this};Mt.prototype.prependOnceListener=function(n,e){return l0(e),this.prependListener(n,pj(this,n,e)),this};Mt.prototype.removeListener=function(n,e){var r,i,o,a,s;if(l0(e),i=this._events,i===void 0)return this;if(r=i[n],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[n],i.removeListener&&this.emit("removeListener",n,r.listener||e));else if(typeof r!="function"){for(o=-1,a=r.length-1;a>=0;a--)if(r[a]===e||r[a].listener===e){s=r[a].listener,o=a;break}if(o<0)return this;o===0?r.shift():Fhe(r,o),r.length===1&&(i[n]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",n,s||e)}return this};Mt.prototype.off=Mt.prototype.removeListener;Mt.prototype.removeAllListeners=function(n){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[n]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[n]),this;if(arguments.length===0){var o=Object.keys(r),a;for(i=0;i<o.length;++i)a=o[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[n],typeof e=="function")this.removeListener(n,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(n,e[i]);return this};function hj(t,n,e){var r=t._events;if(r===void 0)return[];var i=r[n];return i===void 0?[]:typeof i=="function"?e?[i.listener||i]:[i]:e?zhe(i):vj(i,i.length)}Mt.prototype.listeners=function(n){return hj(this,n,!0)};Mt.prototype.rawListeners=function(n){return hj(this,n,!1)};Mt.listenerCount=function(t,n){return typeof t.listenerCount=="function"?t.listenerCount(n):mj.call(t,n)};Mt.prototype.listenerCount=mj;function mj(t){var n=this._events;if(n!==void 0){var e=n[t];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}Mt.prototype.eventNames=function(){return this._eventsCount>0?Cm(this._events):[]};function vj(t,n){for(var e=new Array(n),r=0;r<n;++r)e[r]=t[r];return e}function Fhe(t,n){for(;n+1<t.length;n++)t[n]=t[n+1];t.pop()}function zhe(t){for(var n=new Array(t.length),e=0;e<n.length;++e)n[e]=t[e].listener||t[e];return n}function Bhe(t,n){return new Promise(function(e,r){function i(a){t.removeListener(n,o),r(a)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),e([].slice.call(arguments))}gj(t,n,o,{once:!0}),n!=="error"&&jhe(t,i,{once:!0})})}function jhe(t,n,e){typeof t.on=="function"&&gj(t,"error",n,e)}function gj(t,n,e,r){if(typeof t.on=="function")r.once?t.once(n,e):t.on(n,e);else if(typeof t.addEventListener=="function")t.addEventListener(n,function i(o){r.once&&t.removeEventListener(n,i),e(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Vhe=yR.exports,Rx={exports:{}};typeof Object.create=="function"?Rx.exports=function(n,e){e&&(n.super_=e,n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}))}:Rx.exports=function(n,e){if(e){n.super_=e;var r=function(){};r.prototype=e.prototype,n.prototype=new r,n.prototype.constructor=n}};var $he=Rx.exports,bR={},wR={};function Uhe(t,n){var e={jsonrpc:"2.0"};if(t.method)e.method=t.method,t.params&&(e.params=t.params),n!=null&&(e.id=n);else if(n!=null){if(t.error){if(t.result!==void 0)throw new TypeError("Both result and error are defined");e.error=t.error}else if(t.result!==void 0)e.result=t.result;else throw new TypeError("No result or error is defined");e.id=n}return JSON.stringify(e)}function Whe(t){var n=t;(typeof t=="string"||t instanceof String)&&(n=JSON.parse(t));var e=n.jsonrpc;if(e!=="2.0")throw new TypeError("Invalid JsonRPC version '"+e+"': "+t);if(n.method==null){if(n.id==null)throw new TypeError("Invalid message: "+t);var r=n.result!==void 0,i=n.error!==void 0;if(r&&i)throw new TypeError("Both result and error are defined: "+t);if(!r&&!i)throw new TypeError("No result or error is defined: "+t);n.ack=n.id,delete n.id}return n}wR.pack=Uhe;wR.unpack=Whe;var xR={};function Hhe(t){throw new TypeError("Not yet implemented")}function Ghe(t){throw new TypeError("Not yet implemented")}xR.pack=Hhe;xR.unpack=Ghe;var qhe=wR,Khe=xR;bR.JsonRPC=qhe;bR.XmlRPC=Khe;function yj(){var t={};this.forEach=function(n){for(var e in t){var r=t[e];for(var i in r)n(r[i])}},this.get=function(n,e){var r=t[e];if(r!=null)return r[n]},this.remove=function(n,e){var r=t[e];if(r!=null){delete r[n];for(var i in r)return!1;delete t[e]}},this.set=function(n,e,r){if(n==null)return this.remove(e,r);var i=t[r];i==null&&(t[r]=i={}),i[e]=n}}yj.prototype.pop=function(t,n){var e=this.get(t,n);if(e!=null)return this.remove(t,n),e};var Xhe=yj,X1={},Y1,c_;function bj(){if(c_)return Y1;c_=1;var t=An.OpenViduLogger,n=t.getInstance(),e=2e3,r=3e3,i=3;function o(a){var s=!1,u,l=a.uri,c=!1,d=new WebSocket(l);d.onopen=function(){n.debug("WebSocket connected to "+l),a.onconnected&&a.onconnected()},d.onerror=function(g){n.error("Could not connect to "+l+" (invoking onerror if defined)",g),a.onerror&&a.onerror(g)};var f=function(){d.readyState===i?s?n.debug("Connection closed by user"):a.ismasternodecrashed()?n.error("Master Node has crashed. Stopping reconnection process"):(n.debug("Connection closed unexpectedly. Reconnecting..."),p(e,1)):n.debug("Close callback from previous websocket. Ignoring it")};d.onclose=f;function p(g,m){if(n.debug("reconnect (attempt #"+m+", max="+g+")"),m===1){if(c){n.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");return}else c=!0;a.onreconnecting&&a.onreconnecting()}v(g,m)}function h(g){var m=new URLSearchParams(new URL(g).search);return m.has("reconnect")||(g=Array.from(m).length>0?g+"&reconnect=true":g+"?reconnect=true"),g}function v(g,m){n.debug("Reconnection attempt #"+m),d.close(4104,"Connection closed for reconnection"),l=h(l),d=new WebSocket(l),d.onopen=function(){n.debug("Reconnected to "+l+" after "+m+" attempts..."),c=!1,u(),a.onreconnected&&a.onreconnected(),d.onclose=f},d.onerror=function(y){n.warn("Reconnection error: ",y),m===g?a.ondisconnect&&a.ondisconnect():setTimeout(function(){p(g,m+1)},r)}}this.close=function(g,m){s=!0,d.close(g,m)},this.reconnectWs=function(){n.debug("reconnectWs"),p(e,1)},this.send=function(g){d.send(g)},this.addEventListener=function(g,m){u=function(){d.addEventListener(g,m)},u()},this.getReadyState=function(){return d.readyState}}return Y1=o,Y1}var J1,d_;function Yhe(){if(d_)return J1;d_=1;var t=wj(),n=bj(),e=An.OpenViduLogger;Date.now=Date.now||function(){return+new Date};var r=5e3,i="RECONNECTING",o="CONNECTED",a="DISCONNECTED",s=e.getInstance();function u(l){var c=this,d=l.ws,f=-1,p=0,h=!0,v=!1,g,m=a,y=d.onreconnecting,b=d.onreconnected,w=d.onconnected,x=d.onerror;l.rpc.pull=function(T,O){O.reply(null,"push")},d.onreconnecting=function(){if(s.debug("--------- ONRECONNECTING -----------"),m===i){s.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it");return}D(),m=i,y&&y()},d.onreconnected=function(){if(s.debug("--------- ONRECONNECTED -----------"),m===o){s.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it");return}m=o,k(),b&&b()},d.onconnected=function(){if(s.debug("--------- ONCONNECTED -----------"),m===o){s.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it");return}m=o,h=!0,M(),w&&w()},d.onerror=function(T){s.debug("--------- ONERROR -----------"),m=a,D(),x&&x(T)};var C=new n(d);s.debug("Connecting websocket to URI: "+d.uri);var E={request_timeout:l.rpc.requestTimeout,ping_request_timeout:l.rpc.heartbeatRequestTimeout},S=new t(t.packers.JsonRPC,E,C,function(T){s.debug("Received request: "+JSON.stringify(T));try{var O=l.rpc[T.method];O===void 0?s.error("Method "+T.method+" not registered in client"):O(T.params,T)}catch(P){s.error("Exception processing request: "+JSON.stringify(T)),s.error(P)}});this.send=function(T,O,P){var A=Date.now();S.encode(T,O,function(I,_){if(I){try{s.error("ERROR:"+I.message+" in Request: method:"+T+" params:"+JSON.stringify(O)+" request:"+I.request),I.data&&s.error("ERROR DATA:"+JSON.stringify(I.data))}catch{}I.requestTime=A}P&&(_!=null&&_.value!=="pong"&&s.debug("Response: "+JSON.stringify(_)),P(I,_))})};function k(){s.debug("notReconnectIfNumLessThan = "+p+" (old="+f+")"),f=p}function N(){if(h){var T=null;(p==0||p==f)&&(T={interval:l.heartbeat||r}),p++,c.send("ping",T,function(O){return function(P,A){P&&(s.debug("Error in ping request #"+O+" ("+P.message+")"),O>f&&(h=!1,k(),s.debug("Server did not respond to ping message #"+O+". Reconnecting... "),C.reconnectWs()))}}(p))}else s.debug("Trying to send ping, but ping is not enabled")}function M(){v||(s.debug("Starting ping (if configured)"),v=!0,l.heartbeat!=null&&(g=setInterval(N,l.heartbeat),N()))}function D(){clearInterval(g),v=!1,h=!1,p=-1,S.cancel()}this.close=function(T,O){s.debug("Closing  with code: "+T+" because: "+O),g!=null&&(s.debug("Clearing ping interval"),clearInterval(g)),v=!1,h=!1,C.close(T,O)},this.reconnect=function(){C.reconnectWs()},this.resetPing=function(){h=!0,p=0,M()},this.getReadyState=function(){return C.getReadyState()}}return J1=u,J1}var f_;function Jhe(){if(f_)return X1;f_=1;var t=Yhe();return X1.JsonRpcClient=t,X1}var Q1={},p_;function Qhe(){if(p_)return Q1;p_=1;var t=bj();return Q1.WebSocketWithReconnection=t,Q1}var Z1,h_;function wj(){if(h_)return Z1;h_=1;var t=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch{t=!0}Function.prototype.bind||(Function.prototype.bind=function(f){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var p=Array.prototype.slice.call(arguments,1),h=this,v=function(){},g=function(){return h.apply(this instanceof v&&f?this:f,p.concat(Array.prototype.slice.call(arguments)))};return v.prototype=this.prototype,g.prototype=new v,g});var n=Vhe.EventEmitter,e=$he,r=bR,i=Xhe,o=5e3;function a(f){if(!f)return{};for(var p in f){var h=f[p];typeof h=="string"&&(f[p]={response:h})}return f}function s(f){if(f){if(f instanceof Function)return{send:f};if(f.send instanceof Function)return f;if(f.postMessage instanceof Function)return f.send=f.postMessage,f;if(f.write instanceof Function)return f.send=f.write,f;if(f.onmessage===void 0&&!(f.pause instanceof Function))throw new SyntaxError("Transport is not a function nor a valid object")}}function u(f,p){t?(this.method=f,this.params=p):(Object.defineProperty(this,"method",{value:f,enumerable:!0}),Object.defineProperty(this,"params",{value:p,enumerable:!0}))}function l(f,p,h,v){var g=this;if(!f)throw new SyntaxError("Packer is not defined");if(!f.pack||!f.unpack)throw new SyntaxError("Packer is invalid");var m=a(f.responseMethods);if(p instanceof Function){if(h!=null)throw new SyntaxError("There can't be parameters after onRequest");v=p,h=void 0,p=void 0}if(p&&p.send instanceof Function){if(h&&!(h instanceof Function))throw new SyntaxError("Only a function can be after transport");v=h,h=p,p=void 0}if(h instanceof Function){if(v!=null)throw new SyntaxError("There can't be parameters after onRequest");v=h,h=void 0}if(h&&h.send instanceof Function&&v&&!(v instanceof Function))throw new SyntaxError("Only a function can be after transport");p=p||{},n.call(this),v&&this.on("request",v),t?this.peerID=p.peerID:Object.defineProperty(this,"peerID",{value:p.peerID});var y=p.max_retries||0;function b(I){g.decode(I.data||I)}this.getTransport=function(){return h},this.setTransport=function(I){h&&(h.removeEventListener?h.removeEventListener("message",b):h.removeListener&&h.removeListener("data",b)),I&&(I.addEventListener?I.addEventListener("message",b):I.addListener&&I.addListener("data",b)),h=s(I)},t||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(h);var w=p.request_timeout||o,x=p.ping_request_timeout||w,C=p.response_timeout||o,E=p.duplicates_timeout||o,S=0,k=new i,N=new i,M=new i,D={};function T(I,_,F){var L={message:I,timeout:setTimeout(function(){N.remove(_,F)},C)};N.set(L,_,F)}function O(I,_){var F=setTimeout(function(){M.remove(I,_)},E);M.set(F,I,_)}function P(I,_,F,L,H){u.call(this,I,_),this.getTransport=function(){return H},this.setTransport=function(G){H=s(G)},t||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var B=N.get(F,L);H||g.getTransport()||(t?this.duplicated=!!B:Object.defineProperty(this,"duplicated",{value:!!B}));var q=m[I];this.pack=f.pack.bind(f,this,F),this.reply=function(G,re,j){if(G instanceof Function||G&&G.send instanceof Function){if(re!=null)throw new SyntaxError("There can't be parameters after callback");j=G,re=null,G=void 0}else if(re instanceof Function||re&&re.send instanceof Function){if(j!=null)throw new SyntaxError("There can't be parameters after callback");j=re,re=null}j=s(j),B&&clearTimeout(B.timeout),L!=null&&(G&&(G.dest=L),re&&(re.dest=L));var ae;if(G||re!=null){if(g.peerID!=null&&(G?G.from=g.peerID:re.from=g.peerID),q)if(q.error==null&&G)ae={error:G};else{var ne=G?q.error:q.response;ae={method:ne,params:G||re}}else ae={error:G,result:re};ae=f.pack(ae,F)}else B?ae=B.message:ae=f.pack({result:null},F);return T(ae,F,L),j=j||this.getTransport()||g.getTransport(),j?j.send(ae):ae}}e(P,u);function A(I){var _=D[I];if(_){delete D[I];var F=k.pop(_.id,_.dest);F&&(clearTimeout(F.timeout),O(_.id,_.dest))}}this.cancel=function(I){if(I)return A(I);for(var I in D)A(I)},this.close=function(){var I=this.getTransport();I&&I.close&&I.close(4003,"Cancel request"),this.cancel(),M.forEach(clearTimeout),N.forEach(function(_){clearTimeout(_.timeout)})},this.encode=function(I,_,F,L,H){if(_ instanceof Function){if(F!=null)throw new SyntaxError("There can't be parameters after callback");H=_,L=void 0,F=void 0,_=void 0}else if(F instanceof Function){if(L!=null)throw new SyntaxError("There can't be parameters after callback");H=F,L=void 0,F=void 0}else if(L instanceof Function){if(H!=null)throw new SyntaxError("There can't be parameters after callback");H=L,L=void 0}g.peerID!=null&&(_=_||{},_.from=g.peerID),F!=null&&(_=_||{},_.dest=F);var B={method:I,params:_};if(H){let se=function(ge,be){g.cancel(B),H(ge,be)},we=function(ge){var be=I==="ping"?x:w;return re.timeout=setTimeout(Z,be*Math.pow(2,G++)),D[B]={id:q,dest:F},k.set(re,q,F),ge=ge||j||g.getTransport(),ge?ge.send(B):B},de=function(ge){ge=s(ge),console.warn(G+" retry for request message:",B);var be=M.pop(q,F);return clearTimeout(be),we(ge)},Z=function(){if(G<y)return de(L);var ge=new Error("Request has timed out");ge.request=B,ge.retry=de,se(ge)};var ae=se,ne=we,le=de,xe=Z,q=S++,G=0;B=f.pack(B,q);var re={message:B,callback:se,responseMethods:m[I]||{}},j=s(L);return we(L)}return B=f.pack(B),L=L||this.getTransport(),L?L.send(B):B},this.decode=function(I,_){if(!I)throw new TypeError("Message is not defined");try{I=f.unpack(I)}catch(Z){return console.debug(Z,I)}var F=I.id,L=I.ack,H=I.method,B=I.params||{},q=B.from,G=B.dest;if(g.peerID!=null&&q==g.peerID)return;if(F==null&&L==null){var re=new u(H,B);return g.emit("request",re)?void 0:re}function j(){if(_=s(_)||g.getTransport(),_){var Z=N.get(F,q);if(Z)return _.send(Z.message)}var ge=F??L,be=new P(H,B,ge,q,_);if(!g.emit("request",be))return be}function ae(Z,ge,be){Z.callback(ge,be)}function ne(Z){console.warn("Response already processed",I),clearTimeout(Z),O(L,q)}if(H){if(G==null||G==g.peerID){var de=k.get(L,q);if(de){var le=de.responseMethods;return H==le.error?ae(de,B):H==le.response?ae(de,null,B):j()}var xe=M.get(L,q);if(xe)return ne(xe)}return j()}var se=I.error,we=I.result;if(!(se&&se.dest&&se.dest!=g.peerID)&&!(we&&we.dest&&we.dest!=g.peerID)){var de=k.get(L,q);if(!de){var xe=M.get(L,q);return xe?ne(xe):console.warn("No callback was defined for this message",I)}ae(de,se,we)}}}e(l,n),l.RpcNotification=u,Z1=l;var c=Jhe(),d=Qhe();return l.clients=c,l.clients.transports=d,l.packers=r,Z1}const Zhe="OpenVidu",eme={freeice:"2.2.2",hark:"1.2.3",jsnlog:"2.30.0",mime:"3.0.0",platform:"1.3.6",semver:"7.3.8",uuid:"9.0.0","wolfy87-eventemitter":"5.2.9",events:"3.3.0",inherits:"2.0.4"},tme="OpenVidu Browser",nme={"@types/node":"18.11.9","@types/platform":"1.3.4",browserify:"17.0.0",grunt:"1.5.3","grunt-cli":"1.4.3","grunt-contrib-copy":"1.0.0","grunt-contrib-sass":"2.0.0","grunt-contrib-uglify":"5.2.2","grunt-contrib-watch":"1.1.0","grunt-postcss":"0.9.0","grunt-string-replace":"1.3.3","grunt-ts":"6.0.0-beta.22",terser:"5.15.1",tsify:"5.0.4",tslint:"6.1.3",typedoc:"0.23.21",typescript:"4.9.3"},rme="Apache-2.0",ime="lib/index.js",ome="openvidu-browser",ame={type:"git",url:"git://github.com/OpenVidu/openvidu"},sme={browserify:"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js",build:"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost && rm -rf ./ts4.4 && mkdir -p ./ts4.4/lib && cp -r ./lib ./ts4.4 && find ./ts4.4/lib -type f ! -iname '*.d.ts' -delete && ./config/replace_for_ts44.sh",docs:"./generate-docs.sh"},ume="lib/index.d.ts",lme={"<4.4":{"*":["ts4.4/*"]}},cme="2.29.1",dme={author:Zhe,dependencies:eme,description:tme,devDependencies:nme,license:rme,main:ime,name:ome,repository:ame,scripts:sme,types:ume,typesVersions:lme,version:cme};var m_=ve&&ve.__awaiter||function(t,n,e,r){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?o(c.value):i(c.value).then(s,u)}l((r=r.apply(t,n||[])).next())})},v_=ve&&ve.__generator||function(t,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(e=0)),e;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){e.label=l[1];break}if(l[0]===6&&e.label<o[1]){e.label=o[1],o=l;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(l);break}o[2]&&e.ops.pop(),e.trys.pop();continue}l=n.call(t,e)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Wy,"__esModule",{value:!0});Wy.OpenVidu=void 0;var fme=zp,pme=vR(),g_=u0(),hme=Hc,nl=ma,mt=Fu,eb=Vp,mme=An,vme=Yi,gme=aj,y_=Gc,yme=dR,bme=fR,wme=wj(),xme=dme,Ft=mme.OpenViduLogger.getInstance(),ut,Sme=function(){function t(){var n=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.stt=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=yme.OpenViduLoggerConfiguration.disabled,this.isAtLeastPro=!1,this.isEnterprise=!1,this.ee=new bme,ut=vme.PlatformUtils.getInstance(),this.libraryVersion=xme.version,Ft.info("OpenVidu initialized"),Ft.info("Platform detected: "+ut.getDescription()),Ft.info("openvidu-browser version: "+this.libraryVersion),(ut.isMobileDevice()||ut.isReactNative())&&this.onOrientationChanged(function(){n.publishers.forEach(function(e){e.stream.isLocalStreamPublished&&e.stream&&e.stream.hasVideo&&n.sendNewVideoDimensionsIfRequired(e,"deviceRotated",75,10)})})}return t.prototype.initSession=function(){return this.session=new g_.Session(this),this.session},t.prototype.initPublisher=function(n,e,r){var i;e&&typeof e!="function"?(i=e,i={audioSource:typeof i.audioSource<"u"?i.audioSource:void 0,frameRate:typeof MediaStreamTrack<"u"&&i.videoSource instanceof MediaStreamTrack?void 0:typeof i.frameRate<"u"?i.frameRate:void 0,insertMode:typeof i.insertMode<"u"?typeof i.insertMode=="string"?eb.VideoInsertMode[i.insertMode]:i.insertMode:eb.VideoInsertMode.APPEND,mirror:typeof i.mirror<"u"?i.mirror:!0,publishAudio:typeof i.publishAudio<"u"?i.publishAudio:!0,publishVideo:typeof i.publishVideo<"u"?i.publishVideo:!0,resolution:typeof MediaStreamTrack<"u"&&i.videoSource instanceof MediaStreamTrack?void 0:typeof i.resolution<"u"?i.resolution:"640x480",videoSource:typeof i.videoSource<"u"?i.videoSource:void 0,videoSimulcast:i.videoSimulcast,filter:i.filter}):i={insertMode:eb.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var o=new pme.Publisher(n,i,this),a;return e&&typeof e=="function"?a=e:r&&(a=r),o.initialize().then(function(){a!==void 0&&a(void 0),o.emitEvent("accessAllowed",[])}).catch(function(s){a!==void 0&&a(s),o.emitEvent("accessDenied",[s])}),this.publishers.push(o),o},t.prototype.initPublisherAsync=function(n,e){var r=this;return new Promise(function(i,o){var a,s=function(u){return u?o(u):i(a)};e?a=r.initPublisher(n,e,s):a=r.initPublisher(n,s)})},t.prototype.initLocalRecorder=function(n){return new fme.LocalRecorder(n)},t.prototype.checkSystemRequirements=function(){return ut.isIPhoneOrIPad()?ut.isIOSWithSafari()||ut.isChromeMobileBrowser()||ut.isFirefoxMobileBrowser()||ut.isOperaMobileBrowser()||ut.isEdgeMobileBrowser()||ut.isIonicIos():ut.isChromeBrowser()||ut.isChromeMobileBrowser()||ut.isFirefoxBrowser()||ut.isFirefoxMobileBrowser()||ut.isOperaBrowser()||ut.isOperaMobileBrowser()||ut.isEdgeBrowser()||ut.isEdgeMobileBrowser()||ut.isSamsungBrowser()||ut.isSafariBrowser()||ut.isAndroidBrowser()||ut.isElectron()||ut.isNodeJs()||ut.isMotorolaEdgeDevice()},t.prototype.checkScreenSharingCapabilities=function(){return ut.canScreenShare()},t.prototype.getDevices=function(){return new Promise(function(n,e){navigator.mediaDevices.enumerateDevices().then(function(r){var i,o=[];if(ut.isIonicAndroid()&&typeof cordova<"u"&&(!((i=cordova==null?void 0:cordova.plugins)===null||i===void 0)&&i.EnumerateDevicesPlugin))cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then(function(a){var s=[],u=[],l=[];return s=a.filter(function(c){return c.kind==="audioinput"}),u=r.filter(function(c){return c.kind==="videoinput"}),l=r.filter(function(c){return c.kind==="audioinput"}),u.forEach(function(c,d){if(c.label)o.push({kind:c.kind,deviceId:c.deviceId,label:c.label});else{var f="";d===0?f="Front Camera":d===1?f="Back Camera":f="Unknown Camera",o.push({kind:c.kind,deviceId:c.deviceId,label:f})}}),l.forEach(function(c,d){if(c.label)o.push({kind:c.kind,deviceId:c.deviceId,label:c.label});else{var f="";switch(d){case 0:f="Default";break;case 1:var p=s.filter(function(g){return g.label.includes("Built")})[0];f=p?p.label:"Built-in Microphone";break;case 2:var h=s.filter(function(g){return g.label.includes("Wired")})[0];h?f=h.label:f="Headset earpiece";break;case 3:var v=s.filter(function(g){return g.label.includes("Bluetooth")})[0];f=v?v.label:"Wireless";break;default:f="Unknown Microphone";break}o.push({kind:c.kind,deviceId:c.deviceId,label:f})}}),n(o)});else return r.forEach(function(a){(a.kind==="audioinput"||a.kind==="videoinput")&&o.push({kind:a.kind,deviceId:a.deviceId,label:a.label})}),n(o)}).catch(function(r){return Ft.error("Error getting devices",r),e(r)})})},t.prototype.getUserMedia=function(n){var e,r;return m_(this,void 0,void 0,function(){var i,o,a,l,s,d,f,u,l,c,d,f,p,h=this;return v_(this,function(v){switch(v.label){case 0:i=function(g,m){return m_(h,void 0,void 0,function(){var y,b,w,x;return v_(this,function(C){switch(C.label){case 0:y=m.audio===void 0?!0:m.audio,b={audio:y,video:!1},C.label=1;case 1:return C.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(b)];case 2:return w=C.sent(),g.addTrack(w.getAudioTracks()[0]),[2,g];case 3:throw x=C.sent(),g.getAudioTracks().forEach(function(E){E.stop()}),g.getVideoTracks().forEach(function(E){E.stop()}),this.generateAudioDeviceError(x,b);case 4:return[2]}})})},v.label=1;case 1:return v.trys.push([1,20,,21]),[4,this.generateMediaConstraints(n)];case 2:return o=v.sent(),o.videoTrack&&o.audioTrack||o.audioTrack&&((e=o.constraints)===null||e===void 0?void 0:e.video)===!1||o.videoTrack&&((r=o.constraints)===null||r===void 0?void 0:r.audio)===!1?[2,this.addAlreadyProvidedTracks(o,new MediaStream)]:[3,3];case 3:if(o.videoTrack&&delete o.constraints.video,o.audioTrack&&delete o.constraints.audio,a=!1,typeof n.videoSource!="string")return[3,12];if(!(n.videoSource==="screen"||n.videoSource==="window"||ut.isElectron()&&n.videoSource.startsWith("screen:")))return[3,12];if(a=!o.audioTrack&&n.audioSource!==null&&n.audioSource!==!1,!(navigator.mediaDevices.getDisplayMedia&&!ut.isElectron()))return[3,11];v.label=4;case 4:return v.trys.push([4,9,,10]),[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:n.audioSource==="screen"})];case 5:return l=v.sent(),this.addAlreadyProvidedTracks(o,l),a?[4,i(l,o.constraints)]:[3,7];case 6:return[2,v.sent()];case 7:return[2,l];case 8:return[3,10];case 9:throw s=v.sent(),d=mt.OpenViduErrorName.SCREEN_CAPTURE_DENIED,f=s.toString(),new mt.OpenViduError(d,f);case 10:return[3,11];case 11:return[3,12];case 12:u=a?{video:o.constraints.video}:o.constraints,v.label=13;case 13:return v.trys.push([13,18,,19]),[4,navigator.mediaDevices.getUserMedia(u)];case 14:return l=v.sent(),this.addAlreadyProvidedTracks(o,l),a?[4,i(l,o.constraints)]:[3,16];case 15:return[2,v.sent()];case 16:return[2,l];case 17:return[3,19];case 18:throw c=v.sent(),d=void 0,f=c.toString(),n.videoSource!=="screen"?d=mt.OpenViduErrorName.DEVICE_ACCESS_DENIED:d=mt.OpenViduErrorName.SCREEN_CAPTURE_DENIED,new mt.OpenViduError(d,f);case 19:return[3,21];case 20:throw p=v.sent(),p;case 21:return[2]}})})},t.prototype.enableProdMode=function(){Ft.enableProdMode()},t.prototype.setAdvancedConfiguration=function(n){this.advancedConfiguration=n},t.prototype.onOrientationChanged=function(n){globalThis.addEventListener("orientationchange",n)},t.prototype.sendNewVideoDimensionsIfRequired=function(n,e,r,i){var o=this,a,s,u,l,c=0,d=((s=(a=n==null?void 0:n.stream)===null||a===void 0?void 0:a.videoDimensions)===null||s===void 0?void 0:s.width)||0,f=((l=(u=n==null?void 0:n.stream)===null||u===void 0?void 0:u.videoDimensions)===null||l===void 0?void 0:l.height)||0,p=setInterval(function(){c++,c>i&&clearTimeout(p),n.getVideoDimensions().then(function(h){(h.width!==d||h.height!==f)&&(clearTimeout(p),o.sendVideoDimensionsChangedEvent(n,e,d,f,h.width,h.height))})},r)},t.prototype.sendVideoDimensionsChangedEvent=function(n,e,r,i,o,a){var s=this;n.stream.videoDimensions={width:o||0,height:a||0},this.sendRequest("streamPropertyChanged",{streamId:n.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(n.stream.videoDimensions),reason:e},function(u,l){u?Ft.error("Error sending 'streamPropertyChanged' event",u):(s.session.emitEvent("streamPropertyChanged",[new nl.StreamPropertyChangedEvent(s.session,n.stream,"videoDimensions",n.stream.videoDimensions,{width:r,height:i},e)]),n.emitEvent("streamPropertyChanged",[new nl.StreamPropertyChangedEvent(n,n.stream,"videoDimensions",n.stream.videoDimensions,{width:r,height:i},e)]),s.session.sendVideoData(n))})},t.prototype.sendTrackChangedEvent=function(n,e,r,i){var o=this,a={label:e},s={label:r},u="trackReplaced";n.stream.isLocalStreamPublished?this.sendRequest("streamPropertyChanged",{streamId:n.stream.streamId,property:i,newValue:s,reason:u},function(l,c){l?Ft.error("Error sending 'streamPropertyChanged' event",l):(o.session.emitEvent("streamPropertyChanged",[new nl.StreamPropertyChangedEvent(o.session,n.stream,i,s,a,u)]),n.emitEvent("streamPropertyChanged",[new nl.StreamPropertyChangedEvent(n,n.stream,i,s,a,u)]))}):(this.session.emitEvent("streamPropertyChanged",[new nl.StreamPropertyChangedEvent(this.session,n.stream,i,s,a,u)]),n.emitEvent("streamPropertyChanged",[new nl.StreamPropertyChangedEvent(n,n.stream,i,s,a,u)]))},t.prototype.generateMediaConstraints=function(n){var e=this;return new Promise(function(r,i){var o={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},a=n.audioSource,s=n.videoSource;if((a===null||a===!1)&&(o.constraints.audio=!1),(s===null||s===!1)&&(o.constraints.video=!1),o.constraints.audio===!1&&o.constraints.video===!1)return i(new mt.OpenViduError(mt.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time"));if(typeof MediaStreamTrack<"u"&&a instanceof MediaStreamTrack&&(o.audioTrack=a),typeof MediaStreamTrack<"u"&&s instanceof MediaStreamTrack&&(o.videoTrack=s),a===void 0&&(o.constraints.audio=!0),s===void 0&&(o.constraints.video={width:{ideal:640},height:{ideal:480}}),s!==null&&s!==!1){if(n.resolution){var u=n.resolution.toLowerCase().split("x"),l=Number(u[0]),c=Number(u[1]);o.constraints.video={width:{ideal:l},height:{ideal:c}}}n.frameRate&&(o.constraints.video.frameRate={ideal:n.frameRate})}return e.configureDeviceIdOrScreensharing(o,n,r,i),r(o)})},t.prototype.startWs=function(n){var e={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:n,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,heartbeatRequestTimeout:5e3,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),broadcastStarted:this.session.onBroadcastStarted.bind(this.session),broadcastStopped:this.session.onBroadcastStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session),speechToTextMessage:this.session.onSpeechToTextMessage.bind(this.session),speechToTextDisconnected:this.session.onSpeechToTextDisconnected.bind(this.session)}};this.jsonRpcClient=new wme.clients.JsonRpcClient(e)},t.prototype.onMasterNodeCrashedNotification=function(n){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},t.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},t.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},t.prototype.sendRequest=function(n,e,r){var i;e&&e instanceof Function&&(r=e,e={}),Ft.debug('Sending request: {method:"'+n+'", params: '+JSON.stringify(e)+"}"),(i=this.jsonRpcClient)===null||i===void 0||i.send(n,e,r)},t.prototype.getWsUri=function(){return this.wsUri},t.prototype.getSecret=function(){return this.secret},t.prototype.getRecorder=function(){return this.recorder},t.prototype.getStt=function(){return this.stt},t.prototype.generateAudioDeviceError=function(n,e){n.name==="Error"&&(n.name=n.constructor.name);var r,i;switch(n.name.toLowerCase()){case"notfounderror":return r=mt.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,i=n.toString(),new mt.OpenViduError(r,i);case"notallowederror":return r=mt.OpenViduErrorName.DEVICE_ACCESS_DENIED,i=n.toString(),new mt.OpenViduError(r,i);case"overconstrainederror":return n.constraint.toLowerCase()==="deviceid"?(r=mt.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,i="Audio input device with deviceId '"+e.audio.deviceId.exact+"' not found"):(r=mt.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,i="Audio input device doesn't support the value passed for constraint '"+n.constraint+"'"),new mt.OpenViduError(r,i);case"notreadableerror":return r=mt.OpenViduErrorName.DEVICE_ALREADY_IN_USE,i=n.toString(),new mt.OpenViduError(r,i);default:return new mt.OpenViduError(mt.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,n.toString())}},t.prototype.addAlreadyProvidedTracks=function(n,e,r){return n.videoTrack&&(e.addTrack(n.videoTrack),r&&(n.constraints.video?r.lastVideoTrackConstraints=n.constraints.video:r.lastVideoTrackConstraints=n.videoTrack.getConstraints())),n.audioTrack&&e.addTrack(n.audioTrack),e},t.prototype.configureDeviceIdOrScreensharing=function(n,e,r,i){var o=this,a=e.audioSource,s=e.videoSource;if(typeof a=="string"&&a!=="screen"&&(n.constraints.audio={deviceId:{exact:a}}),typeof s=="string")if(!this.isScreenShare(s))this.setVideoSource(n,s),a==="screen"&&(Ft.warn('Parameter "audioSource" is set to "screen", which means rquesting audio from screen sharing source. But "videoSource" is not set to "screen". No audio source will be requested'),n.constraints.audio=!1);else if(this.checkScreenSharingCapabilities())if(ut.isElectron()){var l="screen:",c=s,d=c.substr(c.indexOf(l)+l.length);return n.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:d}},r(n)}else if(this.advancedConfiguration.screenShareChromeExtension&&!(ut.isFirefoxBrowser()||ut.isFirefoxMobileBrowser())&&!navigator.mediaDevices.getDisplayMedia){y_.getScreenConstraints(function(p,h){if(p||h.mandatory&&h.mandatory.chromeMediaSource==="screen")if(p==="permission-denied"||p==="PermissionDeniedError"){var v=new mt.OpenViduError(mt.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return Ft.error(v),i(v)}else{var g=o.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();y_.getChromeExtensionStatus(g,function(m){if(m==="installed-disabled"){var y=new mt.OpenViduError(mt.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return Ft.error(y),i(y)}if(m==="not-installed"){var b=new mt.OpenViduError(mt.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,o.advancedConfiguration.screenShareChromeExtension);return Ft.error(b),i(b)}});return}else return n.constraints.video=h,r(n)});return}else{if(navigator.mediaDevices.getDisplayMedia)return r(n);var f=ut.isFirefoxBrowser()||ut.isFirefoxMobileBrowser()?e.videoSource:void 0;gme.getScreenId(f,function(p,h,v){if(p)if(p==="not-installed"){var g=o.advancedConfiguration.screenShareChromeExtension?o.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",m=new mt.OpenViduError(mt.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,g);return Ft.error(m),i(m)}else if(p==="installed-disabled"){var m=new mt.OpenViduError(mt.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return Ft.error(m),i(m)}else if(p==="permission-denied"){var m=new mt.OpenViduError(mt.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return Ft.error(m),i(m)}else{var m=new mt.OpenViduError(mt.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");return Ft.error(m),Ft.error(p),i(m)}else return n.constraints.video=v.video,r(n)});return}else{var u=new mt.OpenViduError(mt.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+ut.getName()+" "+ut.getVersion());return Ft.error(u),i(u)}},t.prototype.setVideoSource=function(n,e){n.constraints.video||(n.constraints.video={}),n.constraints.video.deviceId={exact:e}},t.prototype.disconnectCallback=function(){Ft.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},t.prototype.reconnectingCallback=function(){Ft.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},t.prototype.reconnectWebsocketThroughRpcConnectMethod=function(n){var e=this;this.sendRequest("connect",{sessionId:n,reconnect:!0},function(r,i){if(r)if(e.isMasterNodeCrashed())Ft.warn("Master Node has crashed!");else{Ft.error(r);var o=function(s,u){Ft.warn(u),e.session.onLostConnection(s),e.jsonRpcClient.close(4101,"Reconnection fault: "+u)},a=function(){e.life===-1?o("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):e.sendRequest("sessionStatus",{sessionId:e.session.sessionId},function(s,u){s!=null?console.error("Error checking session status",s):e.life===u.life?o("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):o("nodeCrashed","WS successfully reconnected to OpenVidu Server but your Master Node crashed")})};r.code===40007&&r.message==="reconnection error"&&console.error("Invalid RPC sessionId. Client network disconnection or Master Node crash"),a()}else e.jsonRpcClient.resetPing(),e.session.onRecoveredConnection()})},t.prototype.reconnectedCallback=function(){if(Ft.warn("Websocket reconnected"),this.isRoomAvailable())if(this.session.connection)this.reconnectWebsocketThroughRpcConnectMethod(this.session.connection.rpcSessionId);else{Ft.warn("There was no previous connection when running reconnection callback");var n=new hme.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[n]),n.callDefaultBehavior()}else alert("Connection error. Please reload page.")},t.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},t.prototype.isRoomAvailable=function(){return this.session!==void 0&&this.session instanceof g_.Session?!0:(Ft.warn("Session instance not found"),!1)},t.prototype.isScreenShare=function(n){return n==="screen"||n==="window"||ut.isElectron()&&n.startsWith("screen:")},t}();Wy.OpenVidu=Sme;var xj={};Object.defineProperty(xj,"__esModule",{value:!0});(function(t){var n=ve&&ve.__createBinding||(Object.create?function(I,_,F,L){L===void 0&&(L=F);var H=Object.getOwnPropertyDescriptor(_,F);(!H||("get"in H?!_.__esModule:H.writable||H.configurable))&&(H={enumerable:!0,get:function(){return _[F]}}),Object.defineProperty(I,L,H)}:function(I,_,F,L){L===void 0&&(L=F),I[L]=_[F]}),e=ve&&ve.__exportStar||function(I,_){for(var F in I)F!=="default"&&!Object.prototype.hasOwnProperty.call(_,F)&&n(_,I,F)};Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=t.ExceptionEventName=t.ExceptionEvent=t.SpeechToTextEvent=t.NetworkQualityLevelChangedEvent=t.FilterEvent=t.ConnectionPropertyChangedEvent=t.StreamPropertyChangedEvent=t.VideoElementEvent=t.StreamManagerEvent=t.StreamEvent=t.SignalEvent=t.SessionDisconnectedEvent=t.RecordingEvent=t.PublisherSpeakingEvent=t.ConnectionEvent=t.Event=t.VideoInsertMode=t.TypeOfVideo=t.OpenViduErrorName=t.OpenViduError=t.LocalRecorderState=t.Filter=t.LocalRecorder=t.Connection=t.Stream=t.StreamManager=t.Subscriber=t.Publisher=t.Session=t.OpenVidu=void 0;var r=lR,i=Wy;Object.defineProperty(t,"OpenVidu",{enumerable:!0,get:function(){return i.OpenVidu}});var o=u0();Object.defineProperty(t,"Session",{enumerable:!0,get:function(){return o.Session}});var a=vR();Object.defineProperty(t,"Publisher",{enumerable:!0,get:function(){return a.Publisher}});var s=Vc;Object.defineProperty(t,"Subscriber",{enumerable:!0,get:function(){return s.Subscriber}});var u=$c;Object.defineProperty(t,"StreamManager",{enumerable:!0,get:function(){return u.StreamManager}});var l=Bc;Object.defineProperty(t,"Stream",{enumerable:!0,get:function(){return l.Stream}});var c=Bp;Object.defineProperty(t,"Connection",{enumerable:!0,get:function(){return c.Connection}});var d=zp;Object.defineProperty(t,"LocalRecorder",{enumerable:!0,get:function(){return d.LocalRecorder}});var f=jc;Object.defineProperty(t,"Filter",{enumerable:!0,get:function(){return f.Filter}});var p=cR;Object.defineProperty(t,"LocalRecorderState",{enumerable:!0,get:function(){return p.LocalRecorderState}});var h=Fu;Object.defineProperty(t,"OpenViduError",{enumerable:!0,get:function(){return h.OpenViduError}}),Object.defineProperty(t,"OpenViduErrorName",{enumerable:!0,get:function(){return h.OpenViduErrorName}});var v=s0;Object.defineProperty(t,"TypeOfVideo",{enumerable:!0,get:function(){return v.TypeOfVideo}});var g=Vp;Object.defineProperty(t,"VideoInsertMode",{enumerable:!0,get:function(){return g.VideoInsertMode}});var m=$n;Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return m.Event}});var y=Wp;Object.defineProperty(t,"ConnectionEvent",{enumerable:!0,get:function(){return y.ConnectionEvent}});var b=Up;Object.defineProperty(t,"PublisherSpeakingEvent",{enumerable:!0,get:function(){return b.PublisherSpeakingEvent}});var w=Gp;Object.defineProperty(t,"RecordingEvent",{enumerable:!0,get:function(){return w.RecordingEvent}});var x=Hc;Object.defineProperty(t,"SessionDisconnectedEvent",{enumerable:!0,get:function(){return x.SessionDisconnectedEvent}});var C=qp;Object.defineProperty(t,"SignalEvent",{enumerable:!0,get:function(){return C.SignalEvent}});var E=mR();Object.defineProperty(t,"StreamEvent",{enumerable:!0,get:function(){return E.StreamEvent}});var S=Wc;Object.defineProperty(t,"StreamManagerEvent",{enumerable:!0,get:function(){return S.StreamManagerEvent}});var k=jp;Object.defineProperty(t,"VideoElementEvent",{enumerable:!0,get:function(){return k.VideoElementEvent}});var N=ma;Object.defineProperty(t,"StreamPropertyChangedEvent",{enumerable:!0,get:function(){return N.StreamPropertyChangedEvent}});var M=Xp;Object.defineProperty(t,"ConnectionPropertyChangedEvent",{enumerable:!0,get:function(){return M.ConnectionPropertyChangedEvent}});var D=Hp;Object.defineProperty(t,"FilterEvent",{enumerable:!0,get:function(){return D.FilterEvent}});var T=Yp;Object.defineProperty(t,"NetworkQualityLevelChangedEvent",{enumerable:!0,get:function(){return T.NetworkQualityLevelChangedEvent}});var O=Kp;Object.defineProperty(t,"SpeechToTextEvent",{enumerable:!0,get:function(){return O.SpeechToTextEvent}});var P=zu;Object.defineProperty(t,"ExceptionEvent",{enumerable:!0,get:function(){return P.ExceptionEvent}}),Object.defineProperty(t,"ExceptionEventName",{enumerable:!0,get:function(){return P.ExceptionEventName}});var A=Uc;Object.defineProperty(t,"EventDispatcher",{enumerable:!0,get:function(){return A.EventDispatcher}}),e(xj,t),r.JL.setOptions({enabled:!1})})(qB);class Eme{constructor(){dr(this,"connectionId");dr(this,"audioActive");dr(this,"videoActive");dr(this,"screenShareActive");dr(this,"nickname");dr(this,"streamManager");dr(this,"type");this.connectionId="",this.audioActive=!0,this.videoActive=!0,this.screenShareActive=!1,this.nickname="",this.streamManager=null,this.type="local"}isAudioActive(){return this.audioActive}isVideoActive(){return this.videoActive}isScreenShareActive(){return this.screenShareActive}getConnectionId(){return this.connectionId}getNickname(){return this.nickname}getStreamManager(){return this.streamManager}isLocal(){return this.type==="local"}isRemote(){return!this.isLocal()}setAudioActive(n){this.audioActive=n}setVideoActive(n){this.videoActive=n}setScreenShareActive(n){this.screenShareActive=n}setStreamManager(n){this.streamManager=n}setConnectionId(n){this.connectionId=n}setNickname(n){this.nickname=n}setType(n){n==="local"|n==="remote"&&(this.type=n)}}class Cme{constructor(){dr(this,"layoutContainer");dr(this,"opts")}fixAspectRatio(n,e){const r=n.querySelector(".OT_root");if(r){const i=r.style.width;r.style.width=e+"px",r.style.width=i||""}}positionElement(n,e,r,i,o,a){const s={left:e+"px",top:r+"px",width:i+"px",height:o+"px"};this.fixAspectRatio(n,i),a&&$?($(n).stop(),$(n).animate(s,a.duration||200,a.easing||"swing",()=>{this.fixAspectRatio(n,i),a.complete&&a.complete.call(this)})):$(n).css(s),this.fixAspectRatio(n,i)}getVideoRatio(n){if(!n)return 3/4;const e=n.querySelector("video");return e&&e.videoHeight&&e.videoWidth?e.videoHeight/e.videoWidth:n.videoHeight&&n.videoWidth?n.videoHeight/n.videoWidth:3/4}getCSSNumber(n,e){const r=$(n).css(e);return r?parseInt(r,10):0}cheapUUID(){return(Math.random()*1e8).toFixed(0)}getHeight(n){const e=$(n).css("height");return e?parseInt(e,10):0}getWidth(n){const e=$(n).css("width");return e?parseInt(e,10):0}getBestDimensions(n,e,r,i,o,a){let s,u,l,c,d,f,p;for(let h=1;h<=r;h++){const v=h,g=Math.ceil(r/v);f=Math.floor(o/g),d=Math.floor(i/v),p=f/d,p>e?(p=e,f=d*p):p<n&&(p=n,d=f/p);const m=d*f*r;(s===void 0||m>s)&&(s=m,a=f,c=d,u=v,l=g)}return{maxArea:s,targetCols:u,targetRows:l,targetHeight:a,targetWidth:c,ratio:a/c}}arrange(n,e,r,i,o,a,s,u,l){let c;const d=n.length;let f;if(!a)f=this.getBestDimensions(s,u,d,e,r,c);else{const b=this.getVideoRatio(n.length>0?n[0]:null);f=this.getBestDimensions(b,b,d,e,r,c)}let p=0,h=0;const v=[];let g;for(let b=0;b<n.length;b++){b%f.targetCols===0&&(g={children:[],width:0,height:0},v.push(g));const w=n[b];g.children.push(w);let x=f.targetWidth;c=f.targetHeight,a&&(x=c/this.getVideoRatio(w)),g.width+=x,g.height=c}let m=0,y=0;for(let b=0;b<v.length;b++)g=v[b],g.width>e?(g.height=Math.floor(g.height*(e/g.width)),g.width=e):g.width<e&&(y+=1),m+=g.height;if(m<r&&y>0){let b=r-m;m=0;for(let w=0;w<v.length;w++){if(g=v[w],g.width<e){let x=b/y;x/g.height>(e-g.width)/g.width&&(x=Math.floor((e-g.width)/g.width*g.height)),g.width+=Math.floor(x/g.height*g.width),g.height+=x,b-=x,y-=1}m+=g.height}}h=(r-m)/2;for(let b=0;b<v.length;b++){g=v[b],p=(e-g.width)/2;for(let x=0;x<g.children.length;x++){const C=g.children[x];let E=f.targetWidth;c=g.height,a&&(E=Math.floor(c/this.getVideoRatio(C))),C.style.position="absolute";const S=E-this.getCSSNumber(C,"paddingLeft")-this.getCSSNumber(C,"paddingRight")-this.getCSSNumber(C,"marginLeft")-this.getCSSNumber(C,"marginRight")-this.getCSSNumber(C,"borderLeft")-this.getCSSNumber(C,"borderRight"),k=c-this.getCSSNumber(C,"paddingTop")-this.getCSSNumber(C,"paddingBottom")-this.getCSSNumber(C,"marginTop")-this.getCSSNumber(C,"marginBottom")-this.getCSSNumber(C,"borderTop")-this.getCSSNumber(C,"borderBottom");this.positionElement(C,p+i,h+o,S,k,l),p+=E}h+=c}}filterDisplayNone(n){return n.style.display!=="none"}updateLayout(){if(this.layoutContainer.style.display==="none")return;let n=this.layoutContainer.id;n||(n="OT_"+this.cheapUUID(),this.layoutContainer.id=n);const e=this.getHeight(this.layoutContainer)-this.getCSSNumber(this.layoutContainer,"borderTop")-this.getCSSNumber(this.layoutContainer,"borderBottom"),r=this.getWidth(this.layoutContainer)-this.getCSSNumber(this.layoutContainer,"borderLeft")-this.getCSSNumber(this.layoutContainer,"borderRight"),i=e/r;let o=0,a=0,s=0,u=0;const l=Array.prototype.filter.call(this.layoutContainer.querySelectorAll("#"+n+">."+this.opts.bigClass),this.filterDisplayNone),c=Array.prototype.filter.call(this.layoutContainer.querySelectorAll("#"+n+">*:not(."+this.opts.bigClass+")"),this.filterDisplayNone);if(l.length>0&&c.length>0){let d,f;i>this.getVideoRatio(l[0])?(d=r,f=Math.floor(e*this.opts.bigPercentage),a=f,s=e-a):(f=e,d=Math.floor(r*this.opts.bigPercentage),o=d,u=r-o),this.opts.bigFirst?(this.arrange(l,d,f,0,0,this.opts.bigFixedRatio,this.opts.bigMinRatio,this.opts.bigMaxRatio,this.opts.animate),this.arrange(c,r-o,e-a,o,a,this.opts.fixedRatio,this.opts.minRatio,this.opts.maxRatio,this.opts.animate)):(this.arrange(c,r-o,e-a,0,0,this.opts.fixedRatio,this.opts.minRatio,this.opts.maxRatio,this.opts.animate),this.arrange(l,d,f,u,s,this.opts.bigFixedRatio,this.opts.bigMinRatio,this.opts.bigMaxRatio,this.opts.animate))}else l.length>0&&c.length===0?this.arrange(l,r,e,0,0,this.opts.bigFixedRatio,this.opts.bigMinRatio,this.opts.bigMaxRatio,this.opts.animate):this.arrange(c,r-o,e-a,o,a,this.opts.fixedRatio,this.opts.minRatio,this.opts.maxRatio,this.opts.animate)}initLayoutContainer(n,e){this.opts={maxRatio:e.maxRatio!=null?e.maxRatio:3/2,minRatio:e.minRatio!=null?e.minRatio:9/16,fixedRatio:e.fixedRatio!=null?e.fixedRatio:!1,animate:e.animate!=null?e.animate:!1,bigClass:e.bigClass!=null?e.bigClass:"OT_big",bigPercentage:e.bigPercentage!=null?e.bigPercentage:.8,bigFixedRatio:e.bigFixedRatio!=null?e.bigFixedRatio:!1,bigMaxRatio:e.bigMaxRatio!=null?e.bigMaxRatio:3/2,bigMinRatio:e.bigMinRatio!=null?e.bigMinRatio:9/16,bigFirst:e.bigFirst!=null?e.bigFirst:!0},this.layoutContainer=typeof n=="string"?$(n):n}setLayoutOptions(n){this.opts=n}}class Rme extends W.Component{constructor(n){super(n),this.videoRef=Ae.createRef(),console.log(n)}componentDidUpdate(n){n&&this.videoRef&&this.props.streamManager.addVideoElement(this.videoRef.current)}componentDidMount(){this.props&&this.videoRef&&this.props.streamManager.addVideoElement(this.videoRef.current)}render(){return R.jsx("video",{autoPlay:!0,ref:this.videoRef})}}class b_ extends W.Component{constructor(n){super(n),console.log(n)}render(){return R.jsx("div",{children:this.props.streamManager!==void 0?R.jsx("div",{className:"streamcomponent",children:R.jsx(Rme,{streamManager:this.props.streamManager})}):R.jsx("span",{children:"호스트가 없습니다."})})}}var SR={},Tme=yt;Object.defineProperty(SR,"__esModule",{value:!0});var Sj=SR.default=void 0,Nme=Tme(bt()),kme=R;Sj=SR.default=(0,Nme.default)((0,kme.jsx)("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1zm6 6c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92z"}),"MicNoneOutlined");var ER={},Ime=yt;Object.defineProperty(ER,"__esModule",{value:!0});var Ej=ER.default=void 0,_me=Ime(bt()),Ame=R;Ej=ER.default=(0,_me.default)((0,Ame.jsx)("path",{d:"M10.8 4.9c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2l-.01 3.91L15 10.6V5c0-1.66-1.34-3-3-3-1.54 0-2.79 1.16-2.96 2.65l1.76 1.76zM19 11h-1.7c0 .58-.1 1.13-.27 1.64l1.27 1.27c.44-.88.7-1.87.7-2.91M4.41 2.86 3 4.27l6 6V11c0 1.66 1.34 3 3 3 .23 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.55-.9l4.2 4.2 1.41-1.41z"}),"MicOffOutlined");var CR={},Ome=yt;Object.defineProperty(CR,"__esModule",{value:!0});var Cj=CR.default=void 0,Dme=Ome(bt()),Mme=R;Cj=CR.default=(0,Dme.default)((0,Mme.jsx)("path",{d:"M15 8v8H5V8zm1-2H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4V7c0-.55-.45-1-1-1"}),"VideocamOutlined");var RR={},Pme=yt;Object.defineProperty(RR,"__esModule",{value:!0});var Rj=RR.default=void 0,Lme=Pme(bt()),Fme=R;Rj=RR.default=(0,Lme.default)((0,Fme.jsx)("path",{d:"m9.56 8-2-2-4.15-4.14L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.55-.18L19.73 21l1.41-1.41-8.86-8.86zM5 16V8h1.73l8 8zm10-8v2.61l6 6V6.5l-4 4V7c0-.55-.45-1-1-1h-5.61l2 2z"}),"VideocamOffOutlined");var TR={},zme=yt;Object.defineProperty(TR,"__esModule",{value:!0});var Tj=TR.default=void 0,Bme=zme(bt()),jme=R;Tj=TR.default=(0,Bme.default)((0,jme.jsx)("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8m0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4z"}),"LoopOutlined");const Nj="/assets/profileImg-y16nwSgO.jpg",Vme=({sessionId:t,user:n,isHost:e,micStatusChanged:r,camStatusChanged:i,switchCamera:o,leaveSession:a,hostNickname:s,hostProfileImg:u,setLeaveModal:l,totalUsers:c})=>{const[d,f]=W.useState(!0),[p,h]=W.useState(!0);return W.useEffect(()=>{f(n.stream.audioActive)},[n.stream.audioActive]),W.useEffect(()=>{h(n.stream.videoActive)},[n.stream.videoActive]),R.jsxs("div",{className:"toolbar-container",children:[R.jsxs("div",{className:"toolbar-host-info",children:[R.jsx("img",{src:Nj,alt:"toolbar-Host profile"}),R.jsxs("span",{children:[s,"yxwxwq"]})]}),R.jsxs("div",{className:"toolbar-count-subscribers",children:[R.jsx("img",{src:iR,alt:""}),c]}),R.jsxs("div",{className:"toolbar-option-btn",children:[R.jsx(V2,{onClick:()=>l(!0),className:"toolbar-option-icon"}),e&&R.jsxs(R.Fragment,{children:[d?R.jsx(Sj,{onClick:r,className:"toolbar-option-icon"}):R.jsx(Ej,{onClick:r,className:"toolbar-option-icon"}),p?R.jsx(Cj,{onClick:i,className:"toolbar-option-icon"}):R.jsx(Rj,{onClick:i,className:"toolbar-option-icon"}),R.jsx(Tj,{onClick:o,className:"toolbar-option-icon"})]})]})]})},$me=t=>{const n=W.useRef(),e=W.useRef(null),r=W.useRef(null),[i,o]=W.useState(!0),a=()=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{const u=e.current.scrollTop,l=e.current.clientHeight,c=e.current.scrollHeight;o(u+l>=c-100)},100)},s=W.useCallback(()=>{a()},[]);return W.useEffect(()=>{i&&n.current.scrollIntoView({behavior:"smooth"})},[t.messageList]),W.useEffect(()=>(e.current.addEventListener("scroll",s),()=>{r.current&&clearTimeout(r.current),e.current&&e.current.removeEventListener("scroll",s)}),[s]),t.chatDisplay,R.jsxs("div",{className:"chatContainer",ref:e,children:[R.jsx("div",{children:t.messageList.map((u,l)=>R.jsx("div",{children:R.jsxs("div",{className:"chat-box",children:[R.jsx("img",{src:Nj,alt:"",className:"user-img"}),R.jsxs("div",{className:"msg-detail",children:[R.jsx("div",{className:"msg-info",children:R.jsx("p",{children:u.split(":")[0]})}),R.jsxs("div",{className:"msg-content",children:[R.jsx("span",{className:"triangle"}),R.jsx("p",{className:"text",children:u.split(":")[1]})]})]})]})},l))}),R.jsx("div",{ref:n})]})},Ume=t=>{const[n,e]=W.useState(""),r=a=>{a.preventDefault(),n.trim()!==""&&t.onMessage(`${t.myUserName}: `+n.trim(),t.currentSession),e("")},i=a=>{e(a.target.value)},o=a=>{a.key==="Enter"&&(a.preventDefault(),r(a))};return R.jsx(R.Fragment,{children:R.jsx("div",{id:"messageInput",children:R.jsx("input",{placeholder:"댓글 달기",id:"chatInput",value:n,onChange:i,onKeyPress:o,onpaste:"return false;"})})})},Wme=()=>{const[t,n]=W.useState({width:window.innerWidth,height:window.innerHeight});return W.useEffect(()=>{const e=()=>{n({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),t};function Hme({state:t,leaveSession:n}){const e=W.useRef();W.useEffect(()=>{e.current.showModal()});const r=a=>{const u=a.target.getBoundingClientRect();(u.left>a.clientX||u.right<a.clientX||u.top>a.clientY||u.bottom<a.clientY)&&(e.current.close(),t(!t))},i=a=>{e.current.close(),t(!t)},o=a=>{t(!t),n()};return R.jsx(R.Fragment,{children:R.jsxs("dialog",{ref:e,onClick:r,className:"leave-modal",children:[R.jsx("header",{className:"leave-modal-header",children:R.jsx("h3",{children:"라이브를 종료하시겠어요?"})}),R.jsxs("div",{className:"leave-modal-body",children:[R.jsx("div",{onClick:i,children:"취소"}),R.jsx("div",{onClick:o,children:"나가기"})]})]})})}function Gme({open:t,close:n}){return R.jsxs("dialog",{open:t,children:[R.jsx("div",{children:"라이브가 종료되었습니다."}),R.jsx("div",{onClick:n,children:"확인"})]})}var NR={},qme=yt;Object.defineProperty(NR,"__esModule",{value:!0});var kj=NR.default=void 0,Kme=qme(bt()),Xme=R;kj=NR.default=(0,Kme.default)((0,Xme.jsx)("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"}),"Favorite");const Yme=()=>{const[t,n]=W.useState([]),e=()=>{n(r=>[...r,{id:Date.now(),y:100}])};return W.useEffect(()=>{const r=setInterval(()=>{n(i=>i.filter(o=>o.y>50))},2e3);return()=>clearInterval(r)},[]),R.jsxs("div",{children:[R.jsx("button",{onClick:e,children:"Heart"}),R.jsx("div",{children:t.map(r=>R.jsx("div",{className:"heart-icon",children:R.jsx(kj,{})},r.id))})]})};var tb=new Eme;const Hh="https://i10c203.p.ssafy.io",nb="wearegitaehasam",Jme=t=>{const n=Er(),e=Si();Wme();const r="https://i10c203.p.ssafy.io/api",i=e.state.roomId,o=e.state.isHost,a=e.state.imageUrl?e.state.imageUrl:null,s=e.state.name?e.state.name:null,u=e.state.subscriberSession?e.state.subscriberSession:null,[l,c]=W.useState(null),[d,f]=W.useState("Gitaehasam"),[p,h]=W.useState("Participant"+Math.floor(Math.random()*100)),[v,g]=W.useState(void 0),[m,y]=W.useState(void 0),[b,w]=W.useState([]),[x,C]=W.useState(void 0),[E,S]=W.useState([]),[k,N]=W.useState(0),[M,D]=W.useState(!0);W.useState(null);const[T,O]=W.useState(!0),[P,A]=W.useState(!0),[I,_]=W.useState(!1),[F,L]=W.useState(""),[H,B]=W.useState(""),[q,G]=W.useState(!1),[re,j]=W.useState(!0);let ae;W.useEffect(()=>{v&&m&&j(!1)},[v,m]);const ne=W.useCallback(()=>o?le(d).then(Me=>xe(Me)):xe(u),[d,o]),le=Me=>o?new Promise((tt,wt)=>{console.log(i);let Te=JSON.stringify({customSessionId:Me});xt.post(Hh+"/openvidu/api/sessions",Te,{headers:{Authorization:"Basic "+btoa("OPENVIDUAPP:"+nb),"Content-Type":"application/json"}}).then(nt=>{console.log("CREATE SESION",nt),xt.post(r+"/lives",{imageUrl:a,name:s,sessionId:nt.data.sessionId},{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}}).then(Le=>{console.log("apiRoomId: ",Le.data.id),console.log(Le.data),c(Le.data.id),tt(nt.data.id)}).catch(Le=>{console.log("Error on /lives request:",Le)})}).catch(nt=>{var rt;var Le=Object.assign({},nt);((rt=Le==null?void 0:Le.response)==null?void 0:rt.status)===409?tt(Me):console.log(Le)})}):Promise.resolve(u),xe=Me=>{let tt=o?"PUBLISHER":"SUBSCRIBER";return console.log(Me),new Promise((wt,Te)=>{const nt={role:tt,sessionId:Me};xt.post(Hh+"/openvidu/api/sessions/"+Me+"/connection",nt,{headers:{Authorization:"Basic "+btoa("OPENVIDUAPP:"+nb),"Content-Type":"application/json"}}).then(Le=>{console.log("TOKEN",Le),wt(Le.data.token)}).catch(Le=>Te(Le))})};let se;W.useEffect(()=>{f(`Gitaehasam${i}`)},[i]),W.useEffect(()=>{se=new Cme;const Me={maxRatio:1,minRatio:1,fixedRatio:!0,bigClass:"OV_big",bigPercentage:1,bigFixedRatio:!1,bigMaxRatio:1,bigMinRatio:1,bigFirst:!0,animate:!0};se.initLayoutContainer(document.getElementById("layout"),Me),se.setLayoutOptions(Me),window.addEventListener("beforeunload",onbeforeunload),d!=="Gitaehasam"&&we()},[d]);const we=async()=>{ae=new qB.OpenVidu;let Me=ae.initSession();g(Me);let tt;try{tt=await ne()}catch(Te){console.log(Te);return}const wt=ae.initPublisher(void 0,{audioSource:void 0,videoSource:void 0,publishAudio:P,publishVideo:T,resolution:"640x480",frameRate:30,insertMode:"APPEND",mirror:!1});Me.connect(tt,{clientData:p}).then(()=>{Me.publish(wt).then(()=>{tb.setNickname(p),tb.setConnectionId(Me.connection.connectionId),tb.setStreamManager(wt)}),C(wt),y(wt)}),Me.on("streamCreated",Te=>{const nt=Me.subscribe(Te.stream,"publisher");S(nt)}),Me.on("exception",Te=>{console.warn(Te)}),Me.on("connectionCreated",({stream:Te})=>{N(nt=>nt+1)}),Me.on("connectionDestroyed",({stream:Te})=>{N(nt=>nt-1)}),Me.on("signal:chat",Te=>{w(nt=>[...nt,Te.data])}),xt.get(Hh+"/openvidu/api/sessions/"+d,{headers:{Authorization:"Basic "+btoa("OPENVIDUAPP:"+nb),"Content-Type":"application/json"}}).then(Te=>{const nt=Te.data.publisher;nt&&(L(nt.nickname),B(nt.thumbnail))}).catch(Te=>{console.log(Te)})},de=()=>{x.publishVideo(!x.stream.videoActive),O(!T),C(x)},Z=()=>{x.publishAudio(!x.stream.audioActive),A(!P),C(x)},ge=async()=>{try{const tt=(await ae.getDevices()).filter(wt=>wt.kind==="videoinput");if(tt&&tt.length>1){const wt=tt.find(Te=>Te.deviceId!==x.stream.videoSource.deviceId);if(wt){const Te=ae.initPublisher(void 0,{audioSource:void 0,videoSource:wt.deviceId,publishAudio:x.stream.audioActive,publishVideo:x.stream.videoActive,mirror:!0});await v.unpublish(x),await v.publish(Te),C(Te)}}}catch(Me){console.error(Me)}},be=async()=>{const Me=v;Me&&(ae=null,g(void 0),S([]),f("SessionA"),h("Participant"+Math.floor(Math.random()*100)),y(void 0),C(void 0),w([]),D(!0),N(tt=>0),await fe(Me))},fe=async Me=>{console.log(Me);try{await xt.delete(r+`/api/lives/${l}`,{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}}),xt.delete(Hh+`/openvidu/api/sessions/${Me}`,{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}}),Me.disconnect()}catch(tt){console.error(tt)}finally{n("/media/roomList")}};W.useEffect(()=>{h("Participant"+Math.floor(Math.random()*100))},[]),W.useEffect(()=>{const Me=tt=>{be()};return window.addEventListener("beforeunload",Me),()=>{window.removeEventListener("beforeunload",Me)}},[be]),W.useEffect(()=>{if(v){const Me=()=>{G(!0)};return v.on("sessionDisconnected",Me),()=>{v.off("sessionDisconnected",Me)}}},[v]);const On=()=>{G(!1),n("/media/roomList")},pn=(Me,tt)=>{tt.signal({data:Me,to:[],type:"chat"}).then(()=>{console.log("Message successfully sent")}).catch(wt=>{console.error(wt)})};return R.jsx(R.Fragment,{children:re?R.jsx(Pc,{}):R.jsxs("div",{className:"bounds",children:[v!==void 0&&m!==void 0?R.jsxs("div",{children:[R.jsx(Vme,{sessionId:d,user:x,isHost:o,micStatusChanged:Z,camStatusChanged:de,switchCamera:ge,leaveSession:be,setLeaveModal:_,hostNickname:F,hostProfileImg:H,totalUsers:k}),o&&R.jsx(b_,{streamManager:x}),!o&&R.jsx(b_,{streamManager:E}),M&&R.jsxs("div",{className:"chatting",children:[R.jsx($me,{messageList:b}),R.jsx(Ume,{myUserName:p,onMessage:pn,currentSession:v})]}),R.jsx(Yme,{})]}):R.jsxs("div",{className:"noneData",children:[R.jsx(p2,{}),R.jsx("div",{children:"존재하지 않는 방송입니다."}),R.jsx("button",{onClick:()=>n("/media/roomList"),children:"나가기"})]}),I?R.jsx(Hme,{state:_,leaveSession:be}):null,R.jsx(Gme,{open:q,onClose:On})]})})},w_=()=>R.jsxs(R.Fragment,{children:[R.jsx(pa,{}),R.jsxs("div",{className:"choose-list",children:[R.jsx(Ho,{to:"/media/roomlist",children:R.jsx("div",{className:"choose-item",children:R.jsx("div",{className:"bg-blue liveroom",children:"Live"})})}),R.jsx(Ho,{to:"/media/board",children:R.jsx("div",{className:"choose-item",children:R.jsx("div",{className:"bg-blue card photo",children:"Photo"})})})]})]});var kR={},Qme=yt;Object.defineProperty(kR,"__esModule",{value:!0});var Ij=kR.default=void 0,Zme=Qme(bt()),eve=R;Ij=kR.default=(0,Zme.default)((0,eve.jsx)("path",{d:"M11 11V3H5c-1.1 0-2 .9-2 2v6zm2 0h8V5c0-1.1-.9-2-2-2h-6zm-2 2H3v6c0 1.1.9 2 2 2h6zm2 0v8h6c1.1 0 2-.9 2-2v-6z"}),"Window");var IR={},tve=yt;Object.defineProperty(IR,"__esModule",{value:!0});var _R=IR.default=void 0,nve=tve(bt()),rve=R;_R=IR.default=(0,nve.default)((0,rve.jsx)("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3m-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05"}),"FavoriteBorder");var AR={},ive=yt;Object.defineProperty(AR,"__esModule",{value:!0});var _j=AR.default=void 0,ove=ive(bt()),ave=R;_j=AR.default=(0,ove.default)((0,ave.jsx)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 14H6l-2 2V4h16z"}),"ChatBubbleOutline");const sve=({data:t})=>{const n=e=>{const r=new Date(e),o=Math.floor((new Date().getTime()-r.getTime())/1e3);if(o<60)return"방금 전";const a=o/60;if(a<60)return`${Math.floor(a)}분 전`;const s=a/60;if(s<24)return`${Math.floor(s)}시간 전`;const u=s/24;return u<7?`${Math.floor(u)}일 전`:`${r.toLocaleDateString()}`};return R.jsxs("li",{className:"shadow board-contents",children:[R.jsxs("div",{className:"board-title-area",children:[R.jsx("img",{className:"board-profile",src:t.profileImageUrl,alt:""}),R.jsx("div",{className:"nick",children:t.nickName})]}),R.jsx("img",{className:"main-img",src:t.boardImageUrl,alt:""}),R.jsxs("div",{className:"content",children:[R.jsx("div",{className:"hashtag-list",children:t.hashtags.map((e,r)=>R.jsx("div",{className:"hashtag",children:e},r))}),R.jsx("div",{className:"post-text",children:t.content}),R.jsxs("div",{className:"post-bottom",children:[R.jsx("div",{className:"time",children:n(t.createdAt)}),R.jsxs("div",{className:"post-info",children:[R.jsx("div",{className:"post-icon",children:R.jsx(_j,{})}),R.jsx("div",{className:"comment",children:t.commentCnt}),R.jsx("div",{className:"post-icon",children:R.jsx(_R,{})}),R.jsx("div",{className:"like",children:t.likeCnt})]})]})]})]})},uve=[{nickName:"귀여운돌돔",profileImageUrl:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FtEMUl%2FbtrDc6957nj%2FNwJoDw0EOapJNDSNRNZK8K%2Fimg.jpg",boardId:2,boardImageUrl:"https://img.hankyung.com/photo/202307/99.28885943.1.jpg",hashtags:["#돌돔"],content:"첫 게시글",createdAt:"2024-01-25T21:58:14",commentCnt:2,likeCnt:1},{nickName:"슬픈도다리",profileImageUrl:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FtEMUl%2FbtrDc6957nj%2FNwJoDw0EOapJNDSNRNZK8K%2Fimg.jpg",boardId:10,boardImageUrl:"https://img.hankyung.com/photo/202307/99.28885943.1.jpg",hashtags:["#돌돔","#돌돔","#돌돔"],content:"잡은 물고기 게시글 ",createdAt:"2024-01-26T21:59:20",commentCnt:3,likeCnt:2},{nickName:"매력적인오징어",profileImageUrl:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FtEMUl%2FbtrDc6957nj%2FNwJoDw0EOapJNDSNRNZK8K%2Fimg.jpg",boardId:11,boardImageUrl:"https://img.hankyung.com/photo/202307/99.28885943.1.jpg",hashtags:["#돌돔","#돌돔"],content:"잡은 물고기 게시글",createdAt:"2024-01-27T21:59:20",commentCnt:3,likeCnt:1},{nickName:"까칠한가물치",profileImageUrl:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FtEMUl%2FbtrDc6957nj%2FNwJoDw0EOapJNDSNRNZK8K%2Fimg.jpg",boardId:12,boardImageUrl:"https://img.hankyung.com/photo/202307/99.28885943.1.jpg",hashtags:["#돌돔"],content:"잡은 물고기 게시글",createdAt:"2024-01-28T21:59:20",commentCnt:1,likeCnt:2},{nickName:"까칠한가물치",profileImageUrl:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FtEMUl%2FbtrDc6957nj%2FNwJoDw0EOapJNDSNRNZK8K%2Fimg.jpg",boardId:13,boardImageUrl:"https://img.hankyung.com/photo/202307/99.28885943.1.jpg",hashtags:["#돌돔","#돌돔"],content:"잡은 물고기 게시글",createdAt:"2024-01-29T21:59:20",commentCnt:5,likeCnt:10},{nickName:"까칠한가물치",profileImageUrl:"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FtEMUl%2FbtrDc6957nj%2FNwJoDw0EOapJNDSNRNZK8K%2Fimg.jpg",boardId:14,boardImageUrl:"https://img.hankyung.com/photo/202307/99.28885943.1.jpg",hashtags:["#돌돔","#물반고기반"],content:"잡은 물고기 게시글",createdAt:"2024-01-30T21:59:20",commentCnt:3,likeCnt:0}],lve=!1,cve={boards:uve,hasNext:lve},dve="https://i10c203.p.ssafy.io/api",fve=()=>{const t=xt.create({baseURL:dve});return t.defaults.headers.common.Authorization="",t.defaults.headers.post["Content-Type"]="application/json",t.defaults.headers.put["Content-Type"]="application/json",t.defaults.headers.delete["Content-Type"]="application/json",t};fve();const x_=({category:t,viewType:n})=>{const[e,r]=W.useState([]);return W.useEffect(()=>{t==1||t==2&&r(cve.boards)},[t]),R.jsx(R.Fragment,{children:R.jsx("ul",{className:`${n==0?"full-size":"mini-size"}`,children:e.map(i=>R.jsx(Ho,{to:`/media/board/${i.boardId}`,children:R.jsx(sve,{data:i})},i.boardId))})})};var OR={},pve=yt;Object.defineProperty(OR,"__esModule",{value:!0});var Aj=OR.default=void 0,hve=pve(bt()),mve=R;Aj=OR.default=(0,hve.default)((0,mve.jsx)("path",{d:"M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z"}),"EditNote");const S_=()=>{const[t,n]=W.useState(1),[e,r]=W.useState(0),i=l=>{n(l)},o=l=>{r(l)},a=Er(),s=()=>{a("/media/board/create",{state:{categoryId:t}})},u=()=>{console.log("ss")};return R.jsxs(R.Fragment,{children:[R.jsx("img",{className:"backfish",src:d2,alt:"",onClick:()=>history.back()}),R.jsxs("div",{className:"category-header",children:[R.jsx("div",{className:`category-title ${t==1?"active":""}`,onClick:()=>i(1),children:"물고기"}),R.jsx("div",{className:`category-title ${t==2?"active":""}`,onClick:()=>i(2),children:"장소자랑"})]}),R.jsxs("div",{className:"type-select",children:[R.jsx("div",{className:`full ${e==0&&"active"}`,onClick:()=>o(0)}),R.jsx("div",{className:`divide ${e==1&&"active"}`,onClick:()=>o(1),children:R.jsx(Ij,{})}),R.jsx("div",{className:"filter",children:R.jsx("img",{src:UB,alt:"",onClick:()=>u()})})]}),t==1&&R.jsx(x_,{category:t,viewType:e}),t==2&&R.jsx(x_,{category:t,viewType:e}),R.jsx("div",{className:"create-post-btn bg-blue",onClick:()=>s(),children:R.jsx(Aj,{})})]})};var DR={},vve=yt;Object.defineProperty(DR,"__esModule",{value:!0});var Oj=DR.default=void 0,gve=vve(bt()),yve=R;Oj=DR.default=(0,gve.default)((0,yve.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"AddOutlined");const bve=({type:t,categoryId:n})=>{const[e,r]=W.useState(""),[i,o]=W.useState(""),[a,s]=W.useState(null),u=W.useRef();W.useEffect(()=>(e!==""&&s(R.jsx("img",{className:"img_preview",src:i})),()=>{}),[i]);const l=f=>{console.log("2w"),f.preventDefault();let p=f.target.files[0],h=new FileReader;h.onloadend=v=>{r(p),o(h.result)},p&&h.readAsDataURL(p)},c=f=>{console.log("cleick"),console.log(a),f.preventDefault(),u.current.click()},d=()=>{console.log("s")};return R.jsx(R.Fragment,{children:R.jsxs("div",{className:"post-area",children:[R.jsxs("div",{className:"post-item",children:[R.jsxs("div",{className:"post-sub",children:[n==1&&R.jsx("div",{children:"잡은 물고기를 등록해 주세요"}),n==2&&R.jsx("div",{children:"리뷰를 작성해 주세요."})]}),R.jsxs("div",{className:"post-image-upload",children:[a,R.jsx("input",{ref:u,hidden:!0,id:"file",type:"file",onChange:l}),R.jsxs("div",{className:`shadow bg-blue ${e?"reupload-btn":"upload-btn"}`,onClick:c,children:[!e&&R.jsx(Oj,{}),e&&"이미지 다시 선택하기"]})]})]}),R.jsxs("div",{className:"post-item",children:[R.jsx("div",{className:"post-sub",children:"장소"}),R.jsx("div",{className:"position",children:R.jsx("div",{})})]}),R.jsxs("div",{className:"post-item",children:[R.jsxs("div",{className:"post-sub",children:[n==1&&R.jsx("div",{children:"물고기종류"}),n==2&&R.jsx("div",{children:"해시태그"})]}),R.jsxs("div",{className:"hashtag-add",children:[R.jsx("div",{className:"hashtag-icon shadow bg-blue",children:R.jsx(B2,{})}),n==1&&R.jsx("input",{className:"hashtag-search",type:"text",onKeyUp:()=>d(),placeholder:"물고기이름"}),n==2&&R.jsx("input",{className:"hashtag-search",type:"text",onKeyUp:()=>d(),placeholder:"최대 5개까지 입력할 수 있어요"})]})]}),R.jsxs("div",{className:"post-item",children:[R.jsx("div",{className:"post-sub",children:"하고싶은 말"}),R.jsx("textarea",{})]})]})})},uo="/assets/공유-NUwAFK4H.jpg";var MR={},wve=yt;Object.defineProperty(MR,"__esModule",{value:!0});var PR=MR.default=void 0,xve=wve(bt()),Sve=R;PR=MR.default=(0,xve.default)((0,Sve.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");const E_=()=>{xS();const[t,n]=W.useState({nickName:"강민정0173",socialId:"1234",profileImageUrl:uo,boardId:9,boardImageUrl:"https://www.thesprucepets.com/thmb/cQPbLr_MPjBgKpiWVbSbtgmxH4k=/750x0/filters:no_upscale():max_bytes(150000):strip_icc():format(webp)/low-maintenance-freshwater-fish-4770223-hero-ffb66c229c194e2db4916e88bbd17a15.jpg",fishName:null,hashtags:["#여수","#뷰 맛집"],content:"장소 게시글 베타 너무 예뻐용요요용 집가고 싶어요 담주까지 이거 끝날까여",createdAt:"2024-01-26T21:47:49",commentCnt:0,comments:[{id:4,profileImageUrl:uo,nickName:"강민정0173",content:"안녕",createdAt:"2024-01-28T03:33:53"},{id:5,profileImageUrl:uo,nickName:"귀여운도다리",content:"너무이뻐염",createdAt:"2024-01-28T03:33:53"}],likeCnt:20,longitude:128.29192,latitude:37.522514}),e=r=>{const i=r+"",o=i.substring(0,10),a=i.substring(11,16);return console.log(o),o+" "+a};return R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:"board-detail-area",children:[R.jsxs("div",{className:"board-detail-item",children:[R.jsxs("div",{className:"board-title",children:[R.jsx("img",{className:"board-detail-profile",src:t.profileImageUrl,alt:"프로필"}),R.jsx("div",{className:"board-nickname",children:t.nickName}),R.jsxs("div",{className:"like-area",children:[R.jsx(_R,{}),R.jsx("div",{children:t.likeCnt})]})]}),R.jsx("img",{className:"board-content-img",src:t.boardImageUrl,alt:""}),R.jsx("div",{className:"board-text",children:t.content}),R.jsx("div",{className:"board-hashtag-area",children:t.hashtags.map((r,i)=>R.jsx("div",{className:"blue-bd",children:R.jsx("div",{children:r})},i))})]}),R.jsx("div",{className:"line bg-blue"}),R.jsxs("div",{className:"board-detail-item",children:[R.jsx("div",{className:"board-place",children:"Place Info"}),R.jsx("div",{className:"board-map"})]}),R.jsx("div",{className:"line bg-blue"}),R.jsxs("div",{className:"reply-area",children:[R.jsxs("div",{className:"reply-title",children:[R.jsx("div",{children:"댓글"}),R.jsx("div",{className:"blue-fc",children:t.comments.length})]}),R.jsx("div",{className:"reply-line bg-blue"}),R.jsx("div",{className:"reply-list",children:t.comments.map((r,i)=>R.jsxs("div",{className:"reply",children:[R.jsx("img",{src:r.profileImageUrl,alt:""}),R.jsx("div",{children:r.nickName}),R.jsx("div",{children:e(r.createdAt)}),R.jsx("div",{children:r.content})]},i))})]})]}),R.jsxs("div",{className:"reply-add",children:[R.jsx("div",{className:"reply-line bg-blue"}),R.jsx("img",{src:uo,alt:""}),R.jsxs("div",{className:"reply-add-area",children:[R.jsx("input",{type:"text",placeholder:"댓글작성하기"}),R.jsx("div",{className:"send-reply bg-blue",children:R.jsx(PR,{})})]})]})]})},Eve=()=>{var r;const t=Si(),[n,e]=W.useState((r=t.state)==null?void 0:r.categoryId);return R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"post-title",children:"글쓰기"}),R.jsx("div",{className:"post-btn",children:"등록하기"}),R.jsx("div",{children:R.jsx(bve,{type:"create",categoryId:n})})]})},Cve=()=>{const{social:t}=xS(),e=new URL(document.URL).searchParams.get("code"),r=Er();e||r("/");const i=async()=>{console.log(e),console.log(t),console.log("https://i10c203.p.ssafy.io/api");try{const a=(await xt.post(`https://i10c203.p.ssafy.io/api/login/${t}`,{code:e})).data.accessToken;localStorage.setItem("jwt",a),r("/",{replace:!0}),console.log(a)}catch(o){console.log(o)}};return W.useEffect(()=>{i()},[]),R.jsx(Pc,{})};var LR={},Rve=yt;Object.defineProperty(LR,"__esModule",{value:!0});var Dj=LR.default=void 0,Tve=Rve(bt()),Nve=R;Dj=LR.default=(0,Tve.default)((0,Nve.jsx)("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98 0-.34-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.09-.16-.26-.25-.44-.25-.06 0-.12.01-.17.03l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.06-.02-.12-.03-.18-.03-.17 0-.34.09-.43.25l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98 0 .33.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.09.16.26.25.44.25.06 0 .12-.01.17-.03l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.06.02.12.03.18.03.17 0 .34-.09.43-.25l2-3.46c.12-.22.07-.49-.12-.64zm-1.98-1.71c.04.31.05.52.05.73 0 .21-.02.43-.05.73l-.14 1.13.89.7 1.08.84-.7 1.21-1.27-.51-1.04-.42-.9.68c-.43.32-.84.56-1.25.73l-1.06.43-.16 1.13-.2 1.35h-1.4l-.19-1.35-.16-1.13-1.06-.43c-.43-.18-.83-.41-1.23-.71l-.91-.7-1.06.43-1.27.51-.7-1.21 1.08-.84.89-.7-.14-1.13c-.03-.31-.05-.54-.05-.74s.02-.43.05-.73l.14-1.13-.89-.7-1.08-.84.7-1.21 1.27.51 1.04.42.9-.68c.43-.32.84-.56 1.25-.73l1.06-.43.16-1.13.2-1.35h1.39l.19 1.35.16 1.13 1.06.43c.43.18.83.41 1.23.71l.91.7 1.06-.43 1.27-.51.7 1.21-1.07.85-.89.7zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"}),"SettingsOutlined");const kve=()=>{const t=Er();localStorage.getItem("user");const n=()=>{t("edit")};return R.jsxs("div",{className:"mypage",children:[R.jsx(pa,{centerText:"My 낚시",align:"center"}),R.jsx(Dj,{onClick:n})]})},Ive=()=>{const t=W.useRef([]),n=W.useRef([]),[e,r]=W.useState(50),[i,o]=W.useState(0),[a,s]=W.useState(0),[u,l]=W.useState(!1),[c,d]=W.useState([{title:"제목",num:1,imageSrc:uo},{title:"제목",num:2,imageSrc:uo},{title:"제목",num:3,imageSrc:uo},{title:"제목",num:4,imageSrc:uo},{title:"제목",num:5,imageSrc:uo}]),f=.02,p=-.1;W.useEffect(()=>{const v=t.current,g=n.current,m=(E,S,k)=>{const N=h([...v],k)[S];E.style.setProperty("--zIndex",N),E.style.setProperty("--active",(S-k)/v.length)},y=()=>{const E=Math.max(0,Math.min(e,100)),S=Math.floor(E/100*(v.length-1));s(S),v.forEach((k,N)=>m(k,N,S))};y();const b=E=>{const S=E.deltaY*f;r(k=>k+S),y()},w=E=>{if(E.type==="mousemove"&&g.forEach(N=>{N.style.transform=`translate(${E.clientX}px, ${E.clientY}px)`}),!u)return;const S=E.clientX||E.touches&&E.touches[0].clientX||0,k=(S-i)*p;r(N=>N+k),o(S),y()},x=E=>{l(!0);const S=E.clientX||E.touches&&E.touches[0].clientX||0;o(S)},C=()=>{l(!1)};return document.addEventListener("mousewheel",b),document.addEventListener("mousedown",x),document.addEventListener("mousemove",w),document.addEventListener("mouseup",C),document.addEventListener("touchstart",x),document.addEventListener("touchmove",w),document.addEventListener("touchend",C),()=>{document.removeEventListener("mousewheel",b),document.removeEventListener("mousedown",x),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",C),document.removeEventListener("touchstart",x),document.removeEventListener("touchmove",w),document.removeEventListener("touchend",C)}},[e,u,i]);const h=(v,g)=>v.map((m,y)=>g===y?v.length:v.length-Math.abs(g-y));return R.jsx(R.Fragment,{children:R.jsx("div",{className:"carousel",children:c.map((v,g)=>R.jsx("div",{ref:m=>t.current[g]=m,className:"carousel-item",children:R.jsxs("div",{className:"carousel-box",children:[R.jsx("div",{className:"title",children:v.title}),R.jsx("div",{className:"num",children:v.num}),R.jsx("img",{src:v.imageSrc,alt:v.title})]})},g))})})},_ve="/assets/fish_king-dNUI1omU.png";function Ave(t){const[n,e]=W.useState(""),r=a=>{e(a.target.value)},i=a=>{a.key==="Enter"&&a.target.value.trim()!==""&&(a.preventDefault(),o(a))},o=a=>{a.preventDefault(),t.onChat(n),e("")};return R.jsx(R.Fragment,{children:R.jsx("div",{children:R.jsxs("div",{className:"reply-add",children:[R.jsx("div",{className:"reply-line bg-blue"}),R.jsx("img",{src:uo,alt:""}),R.jsxs("div",{className:"reply-add-area",children:[R.jsx("input",{className:"chatbot-input",value:n,type:"text",placeholder:"메세지 보내기...",onChange:r,onKeyPress:i}),n.trim()!==""&&R.jsx("div",{className:"send-reply bg-blue",onClick:o,children:R.jsx(PR,{})})]})]})})})}function Ove(t){const n=t.chattingList,e=W.useRef(),r=W.useRef(null),i=W.useRef(null),[o,a]=W.useState(!1),[s,u]=W.useState(!0),l=()=>{i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{const d=r.current.scrollTop,f=r.current.clientHeight,p=r.current.scrollHeight;u(d+f>=p-100)},100)},c=W.useCallback(()=>{l()},[]);return W.useEffect(()=>{a(!0),s&&e.current.scrollIntoView({behavior:"smooth"}),a(!1)},[n,s]),W.useEffect(()=>(r.current.addEventListener("scroll",c),()=>{i.current&&clearTimeout(i.current),r.current&&r.current.removeEventListener("scroll",c)}),[c]),R.jsx(R.Fragment,{children:R.jsxs("div",{ref:r,className:"message-box",children:[n.map((d,f)=>R.jsx("div",{className:`message ${d.user}`,children:R.jsx("div",{children:d.chat})},f)),R.jsx("div",{ref:e}),o&&R.jsx(Pc,{})]})})}function Dve(){const t=Er(),[n,e]=W.useState([]);W.useState("");const[r,i]=W.useState(["봉돌","합사","캐스팅","미끼","물고기 잘 잡히는 곳"]),o=s=>{e([...n,{user:"user",chat:s,imgURL:null,move:null}])},a=s=>{o(s.target.textContent);const u=r.filter(l=>l!==s.target.textContent);i(u)};return R.jsx(R.Fragment,{children:R.jsxs("div",{className:"chatbot-Demo",children:[R.jsx("div",{onClick:()=>t("/"),children:R.jsx(pa,{})}),R.jsxs("div",{className:"chatbot-header",children:[R.jsx("img",{src:_ve,className:"chatbot-fishking"}),R.jsx("span",{children:"낚시왕"})]}),R.jsxs("div",{children:[R.jsxs("div",{className:"chat-list-container",children:[R.jsxs("div",{className:"chatbot-startChat",children:[R.jsxs("p",{children:[R.jsx("span",{children:"따뜻한 갈치"}),"님, 안녕하세요."]}),R.jsx("p",{children:"저는 낚시왕입니다."}),R.jsx("p",{children:"어떤 사항이 궁금하신가요?"})]}),R.jsxs("div",{children:["자주 묻는 질문",r.map((s,u)=>R.jsx("div",{onClick:a,children:s},u))]}),R.jsx(Ove,{chattingList:n})]}),R.jsx(Ave,{onChat:o})]})]})})}const Mve=()=>{const t="https://i10c203.p.ssafy.io/api";JSON.parse(localStorage.getItem("user"));const n=Er(),e=()=>{xt.delete(`${t}/log-out`,{headers:{Authorization:localStorage.getItem("jwt"),"Content-Type":"application/json"}}).then(r=>{console.log(r),localStorage.removeItem("jwt"),n("/")}).catch(r=>{console.log(r)})};return R.jsxs("div",{className:"mypage-edit",children:[R.jsx(pa,{centerText:"My 정보수정",align:"center"}),R.jsx("div",{className:"complete",children:"완료"}),R.jsx("div",{className:"profile"}),R.jsxs("div",{className:"user-info",children:[R.jsx("div",{className:"info-title",children:"닉네임"}),R.jsx("input",{className:"info-nick",type:"text"})]}),R.jsxs("div",{className:"user-change",children:[R.jsx("button",{className:"logout",onClick:e,children:"로그아웃"}),R.jsx("button",{className:"resign",children:"회원탈퇴"})]})]})};function Pve(){return R.jsxs(J5,{children:[R.jsxs(it,{path:"/",element:R.jsx(dH,{}),children:[R.jsx(it,{index:!0,element:R.jsx(J9,{})}),R.jsxs(it,{path:"fish",children:[R.jsx(it,{path:"image/result",element:R.jsx(Jee,{})}),R.jsx(it,{path:"map",element:R.jsx(Lue,{})})]}),R.jsxs(it,{path:"media",children:[R.jsx(it,{index:!0,element:R.jsx(w_,{})}),R.jsxs(it,{path:"roomList",children:[R.jsx(it,{index:!0,element:R.jsx(gde,{})}),R.jsx(it,{path:"create",children:R.jsx(it,{index:!0,element:R.jsx(Cde,{})})})]}),R.jsxs(it,{path:"board",children:[R.jsx(it,{index:!0,element:R.jsx(S_,{})}),R.jsx(it,{path:":id",element:R.jsx(E_,{})})]})]}),R.jsxs(it,{path:"user/mypage",children:[R.jsx(it,{index:!0,element:R.jsx(kve,{})}),R.jsx(it,{path:"edit",element:R.jsx(Mve,{})})]})]}),R.jsxs(it,{path:"media",children:[R.jsx(it,{index:!0,element:R.jsx(w_,{})}),R.jsxs(it,{path:"board",children:[R.jsx(it,{index:!0,element:R.jsx(S_,{})}),R.jsx(it,{path:"create",element:R.jsx(Eve,{})}),R.jsx(it,{path:":id",element:R.jsx(E_,{})})]})]}),R.jsx(it,{path:"/tutorial",children:R.jsx(it,{index:!0,element:R.jsx(Ive,{})})}),R.jsxs(it,{path:"/fish",children:[R.jsx(it,{path:"map",children:R.jsx(it,{path:":idx",element:R.jsx(tce,{})})}),R.jsx(it,{path:"image/edit",element:R.jsx(Xce,{})})]}),R.jsxs(it,{path:"/fishbook",children:[R.jsx(it,{index:!0,element:R.jsx(Zce,{})}),R.jsx(it,{path:":id",element:R.jsx(nde,{})})]}),R.jsxs(it,{path:"/login",children:[R.jsx(it,{index:!0,element:R.jsx(lde,{})}),R.jsx(it,{path:":social",element:R.jsx(Cve,{})})]}),R.jsx(it,{path:"/live/:id",element:R.jsx(Jme,{})}),R.jsx(it,{path:"/chatBot",children:R.jsx(it,{index:!0,element:R.jsx(Dve,{})})})]})}Zb.createRoot(document.getElementById("root")).render(R.jsx(eue,{children:R.jsx(iU,{children:R.jsx(Pve,{})})}));
