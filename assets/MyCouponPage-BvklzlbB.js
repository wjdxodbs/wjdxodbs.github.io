import{r as c,a as C,R as v,j as s,L as g,H as T}from"./index-BDR06oeM.js";import{d as t}from"./dayjs.min-CTNoxMyC.js";import{g as I,p as M}from"./MyCouponAPi-CjITK9rf.js";import{d as S}from"./atoms-B83_Vc9s.js";import{T as E,t as m}from"./toastMsg-BcySJQIG.js";const w=()=>{const[n,N]=c.useState([]),h=C(),y=v(S),[x,i]=c.useState(!1);c.useEffect(()=>{i(!0),d()},[]);const d=async()=>{const e=await I();N(e),i(!1)},f=async e=>{const o=n.find(p=>p.couponId===e);if(!o)return;if(window.confirm(`${o.couponName}을 적용하시겠어요?`)){if(o.couponName==="닉네임 변경 쿠폰"){y(o.couponId),h("/user/mypage/change-nickname");return}if(n.some(a=>a.couponName===o.couponName&&a.couponStatus==="사용 중")){m("동일한 쿠폰을 사용중이에요");return}const u=["THROWNG_INF","THROWNG_TWICE","THROWNG_LEVEL","THROWNG_FIVE"];if(u.includes(o.couponType)&&n.some(l=>u.includes(l.couponType)&&l.couponStatus==="사용 중")){m("같은 유형의 쿠폰을 사용중이에요");return}const j={couponId:e,couponType:o.couponType};await M(j),d()}};return s.jsxs("div",{className:"MyCouponBody",children:[x?s.jsx(g,{}):n.length>0?n.map(e=>{const o=Math.ceil(t(e.couponEndDate).diff(t(),"day",!0)),r=o<=1;return s.jsxs("div",{className:"coupon-body",children:[s.jsxs("div",{className:"coupon-header",children:[s.jsx("div",{className:"coupon-title",children:e.couponName}),s.jsx("div",{className:"coupon-desc",children:e.couponDescription})]}),s.jsx("div",{className:`coupon-apply ${e.couponStatus==="사용 전"?"":"inactive"}`,onClick:()=>e.couponStatus==="사용 전"&&f(e.couponId),children:s.jsx("div",{className:`coupon-apply-btn ${e.couponStatus!=="사용 전"&&"coupon-apply-active"}`,children:e.couponStatus})}),s.jsx("hr",{}),s.jsxs("div",{className:"coupon-end-date",children:[s.jsx("div",{className:`${r&&"coupon-end-date-how-imminent"}`,children:`D-${o}`}),s.jsxs("div",{className:"coupon-end-date-when",children:[t(e.couponEndDate).format("YY/MM/DD HH:mm:ss"),"까지"]})]})]},e.couponId)}):s.jsx("div",{className:"SearchedWords",children:s.jsxs("div",{className:"no-word-container",children:[s.jsx("div",{className:"title",children:"앗!"}),s.jsx("div",{className:"subtitle",children:"사용 가능한 쿠폰이 없습니다."})]})}),s.jsx(E,{})]})},_=()=>s.jsxs("div",{className:"MyCouponPage",children:[s.jsx(T,{centerText:"쿠폰함"}),s.jsx("div",{className:"body none-scroll",children:s.jsx(w,{})})]});export{_ as default};
